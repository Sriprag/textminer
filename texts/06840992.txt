2848

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Developing a Stereotypical Drosophila Brain Atlas
Hao-Chiang Shao∗ , Member, IEEE, Cheng-Chi Wu, Guan-Yu Chen, Hsiu-Ming Chang, Ann-Shyn Chiang,
and Yung-Chang Chen, Fellow, IEEE

Abstract—Brain research requires a standardized brain atlas to
describe both the variance and invariance in brain anatomy and
neuron connectivity. In this study, we propose a system to construct
a standardized 3D Drosophila brain atlas by integrating labeled images from different preparations. The 3D fly brain atlas consists
of standardized anatomical global and local reference models, e.g.,
the inner and external brain surfaces and the mushroom body.
The averaged global and local reference models are generated by
the model averaging procedure, and then the standard Drosophila
brain atlas can be compiled by transferring the averaged neuropil
models into the averaged brain surface models. The main contribution and novelty of our study is to determine the average 3D brain
shape based on the isosurface suggested by the zero-crossings of a
3D accumulative signed distance map. Consequently, in contrast
with previous approaches that also aim to construct a stereotypical brain model based on the probability map and a user-specified
probability threshold, our method is more robust and thus capable
to yield more objective and accurate results. Moreover, the obtained
3D average shape is useful for defining brain coordinate systems
and will be able to provide boundary conditions for volume registration methods in the future. This method is distinguishable from
those focusing on 2D + Z image volumes because its pipeline is
designed to process 3D mesh surface models of Drosophila brains.
Index Terms—Brain atlas, drosophila, stereotypical model, surface model averaging.

I. INTRODUCTION
STANDARD brain atlas that can act as a calibrated space
is required to accommodate neural images acquired from
different experiments. However, there are two barriers to construct such a network. One is how to accurately align an arbitrary
input image volume to the standardized space, and the other
is how to define a standard atlas that is representative of the
invariable anatomy and beneficial for data alignment. In general, the answer to the first problem depends on user-selected
similarity measures, feature spaces, and the defined standardized space. The solution may be ambiguous unless the standard
space required for the registration and warping process is defined
explicitly. Hence, we aim in this paper to resolve the second

A

Manuscript received October 24, 2013; revised May 13, 2014; accepted June
12, 2014. Date of publication June 20, 2014; date of current version November
18, 2014. Asterisk indicates corresponding author.
∗ H.-C. Shao is with the Institute of Information Science, Academia Sinica,
Taipei 115, Taiwan (e-mail: shao.haochiang@gmail.com).
C.-C. Wu, G.-Y. Chen, and Y.-C. Chen are with the Department of Electrical Engineering, National Tsing Hua University, Hsinchu 30013, Taiwan
(e-mail: dennis@benz.ee.nthu.edu.tw; cgu@benz.ee.nthu.edu.tw; ycchen@
ee.nthu.edu.tw).
H.-M. Chang and A.-S. Chiang are with the Brain Research Center,
National Tsing Hua University, Hsinchu 300, Taiwan (e-mail: hmchang@
life.nthu.edu.tw; aschiang@life.nthu.edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2332175

problem: how to construct a faithful atlas of the Drosophila
brain. The idea of deriving average shape is straightforward.
Shape is what is left after filtering out effects resulting from
translations, changes of scale, and rotations, as noted by Kendall
[1]. Consequently, 3D shape information has to be introduced
into atlas design so that the obtained atlas can be representative
anatomically.
The conventional solution to this issue is to build a 2D + Z
probabilistic map for brain image volumes. As reported in [2], a
common approach has been to create the probabilistic atlas from
labeled image data rather than from source images because the
latter’s image intensity (gray-level intensity) would vary from
sample to sample. Two previous methods for this purpose are
virtual insect brain (VIB) [2], [3] and iterative shape averaging
(ISA) [4]. Both of them were designed to build an impartial
probability map that can indicate how neurons and neuropils
distribute over the brain. The probabilistic map helps to describe the likelihood that brain tissues appear in certain regions;
however, it does not help derive representative shapes. VIB and
ISA generate the average shape based on the isoline defined
by a given probability threshold. Thus, all average boundaries
derived from rational thresholds are deemed reasonable, and
it is unclear which threshold produces more accurate average
shapes. For example, the average shape boundary in [5] was
defined according to a threshold of 40%, and the threshold was
set to be 50% in [6] and [7]. Furthermore, because the probabilistic atlas is 2D + Z rather than 3D, it presents the difficulty
in assuring the depth correspondence between any two image
stacks. To construct a 2D + Z brain atlas from image stacks is
not arduous, but if the Z-correspondence is not guaranteed, it
will be hard to ascertain the fidelity of the resulting probabilistic
map on each slice. Another concern is that brain samples may
be rotated. No matter how accurately technicians mount brains,
no true correspondence exists without accounting first for these
rotations. As a result, it is difficult to propose even hypothetical neural circuitry from a probabilistic atlas in the presence of
shape uncertainty, uncertified Z-correspondence, and unknown
rotations.
In order to address these difficulties, the brain atlas has to
be derived more objectively, based on 3D surface information.
Compared with conventional probabilistic strategies, the proposed method has several advantages. First, rather than defining
shape contours by a user-defined probability threshold, the proposed scheme derives the average boundary surface objectively,
according to the zero-crossings on the cumulative signed distance map, such that the sum of signed distances between the
standard atlas and the input data is expected to be zero. Second,
the obtained averaged standard surface contains 3D anatomical
structure features, hence making it useful for constructing the

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

SHAO et al.: DEVELOPING A STEREOTYPICAL DROSOPHILA BRAIN ATLAS

2849

brain coordinate system. Third, whenever the average brain atlas is updated, all processed image volumes can be aligned to
the new atlas by simply applying the necessary transformation
matrices.
II. RELATED WORK
A. Brain Atlasing
Several representative brain atlases have been developed
based on either the VIB protocol or the ISA method. ISA generally eliminates individual shape variability and has been applied
to integrating data from different preparations, e.g., [8]–[10]. In
contrast, VIB preserves individual shape variance for further
comparison, e.g., [2], [5], [7]. Additionally, Kurylas et al. [6]
created two average models by using ISA and VIB to handle
different tasks.
Rein et al. and Jenett et al. developed the VIB method to generate the population-based quantitative Drosophila brain atlas
under the requirement that the between-individual shape differences should be preserved [2], [3]. VIB is implemented in three
primary steps. First, reduce between-individual disparities by
global rigid transformation. Next, align labeled structures inside each datum independently, via local rigid transformation.
Third, merge the local transformations obtained in the previous
step, to yield a transformation that applies to all data. The desired probabilistic atlas is comprised of all pairs of input datum
and its transformation.
In contrast, the main idea of ISA was to update the average
shape iteratively toward the population centroid [4]. ISA also
consists of three steps. First, affinely transform all input labeled
data to a predefined reference model to construct an initial average shape. Second, register the input labeled data to the just
obtained average shape via nonrigid transformation, to yield a
new average shape. Third, repeat the second step until the result converges. The design goal of ISA is to remove individual
variabilities gradually. Therefore, input labeled data can be integrated into the same probabilistic atlas, and the average shape
can be defined accordingly.
Because the shape boundary of a probabilistic atlas is determined by a user-selected probability threshold, it cannot be
objective. Hence, the mapping of the source image volumes into
such standard space might be skewed due to a lack of appropriate boundary conditions on shapes. An example is BrainAligner
(BA) [11], one of the most respected recent techniques for
integrating image data into a standard atlas. BA focuses on
aligning—that is, registering and warping—volume data into
the same reference coordinate system, and the average target
brain (atlas) used in BA is derived in a way very similar to ISA.
With the obtained average target brain and the predefined feature
points, BA first evaluates the feature correspondences between
the input data and the average target, and then it warps the input data by discerning the thin-plate-spline (TPS) deformation
field [12] on the image domain. Although the average target
brain used in BA is derived from hundreds of samples and, thus,
should be consistent with anatomically invariant structures, the
boundary of the average brain atlas still contradicts volume registration results. As shown in Fig. 1, several aligned fibers exceed

Fig. 1. Aligned neurons and the Drosophila inner brain surface (also known
as INS). The INS (gray region) is the outermost boundary that neurons can
reach. However, in this figure, several neurons exceed the boundary of the INS.
The scale bar denotes 100 μm. Reprinted from Peng et al. [11].

the boundary of the Drosophila inner brain surface. The premise
that the variance of aligned neurons’ positions is not greater than
several microns [11] casts doubt on the representativeness of a
shape boundary suggested by a probability threshold.
In order to attenuate the uncertainty resulting from a probability threshold, Rohlfing and Maurer [13] proposed a shape-based
averaging (SBA) method based on a signed Euclidean distance
transform (EDT) [14]. In contrast with the user-defined probability threshold used in VIB and ISA, zero-crossings on the cumulative signed distance map are relatively impartial. In short,
SBA determines a best-fit average boundary contour set or an
averaged boundary surface that minimizes the expected distance
between averaged standard atlas and input data.
Drawing upon VIB and SBA, we design a system to generate
the standardized Drosophila brain atlas by taking into account
the 3D surface shape and EDT. The brain atlas derived by our
system consists of a series of average 3D surface models. For
each average surface, the sum of signed distances between it
and input models is expected to be zero. The obtained standard models are stereotypical rather than probabilistic, thereby
eliminating boundary uncertainty. Consequently, our standard
model may be used to define a coordinate system according
to anatomical structure features in the brain. Also, the derived
standard surface model is compatible to volumetric registration
and warping, similar to the idea proposed by Lerios et al. for
metamorphosing voxelized surface models [15].
B. Shape Averaging
Several methods or tools were developed to map either 2D
images or 2D + Z image volumes in a standard space, e.g., [11],
[16], [17]. This section will briefly review Qu and Peng [16] and
Ahammad et al. [17] and compare them with our strategies for
deriving a 3D standard brain composed of mesh surface models.
The principal skeleton (PS) algorithm [16] aims to extract
skeletons of the articulated structure from a 2D maximum intensity projection image of a confocal image stack, so that an
image stack can be warped to another, in a slice-by-slice manner, based on the 2D deformation field between their PSs. Qu
et al. modeled the PS as a set of control points, and they used

2850

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

a user-specified shape prior to define the connectivity among
the control points. The energy function of the PS algorithm is
analogous to that of the active contour model (snake algorithm).
In order to shift control points toward suitable positions, Qu
et al. define the external energy to be the within-cluster sum
of squares (WCSS) by regarding control points as cluster centroids in the pixel domain, and they define the internal energy
to be the weighted sum of centroid-to-centroid distances. Although the PS algorithm is one of the best known free tools
(downloadable from [18]), it is difficult to extend the PS algorithm from 2D to 2D + Z and 3D cases. Because microscopy
image stacks are relatively sparsely sampled in the Z direction,
the PS algorithm’s external energy—WCSS denotes K-mean
clustering—would tend to halt control points on slices containing a large area of valid pixels. This would result in an improper
skeleton. A simple solution to this problem might be to take
account of only contour pixels, rather than all nonzero pixels,
on each slice. Since contour pixels are those we use to reconstruct a 3D mesh surface model, this solution is conceptually
very similar to our approach: to extract principal axes from the
articulated axial-structured surface model via principal component analysis (PCA) [19]. We also aim to construct a local
coordinate system (which we will discuss in Section VI-A), and
vectors derived by PCA are more suitable to be coordinate axes
than piecewise linear curves derived by the PS algorithm.
Ahammad et al. [17] aimed to align the imaginal disc images, and they derived the most probable average 2D shape by
minimizing Shannon entropy. In their design, a penalty function
measuring the dissimilarity between the deformation parameters
suggested from input models is integrated into the minimization
process, to prevent deriving an overdeformed result, such as
those produced by ISA. However, because Ahammad et al.’s
method needs to parameterize the transformation matrix first,
a suitable average shape might not be yielded if there are inconsistent local deformations that cannot be formulated by the
transformation matrix.1 Consequently, we adopt the two-level
model averaging (TLMA) technique [20] and 3D EDT to derive
the standard average 3D model. Finally, the primary difference
between Ahammad et al.’s method and ours is that Ahammad
et al. aimed to derive the average shape via MAP (maximum
a posteriori probability), whereas we aim to derive an average
shape by minimizing the average surface-to-surface distance.
III. METHODS
A. System Overview
The proposed system consists of two primary components:
model averaging technique and model positioning strategy. The
model averaging technique has two branches. One is designed
for axial structures, and the other is for nonaxial ones. These two
branches share the same fine-level model averaging method, and
the difference between them is how they generate the coarselevel models. As for the model positioning strategy, the key idea
is to place the standardized local reference model at its own
1 For example, in Fig. 4(b), if the Y–axis and y–axis incline to opposite
directions, it is hard to formulate the deformation as a transformation matrix.

Fig. 2. Flowchart of the proposed system, which aims to position the average
local reference models in the average INS model that is generated by the nonaxial
model averaging process.

average position, which would then be evaluated based on 1)
the transformations between the average global reference model
and the input data, and 2) the local reference models’ positions
in all data sets. We will describe our model averaging methods
in Section III-B and depict how to transfer a local reference
model into the global reference models in Section III-C. The
flowchart of the proposed system is shown in Fig. 2.
The Drosophila brain atlas comprises a set of standardized
reference surface models. The external brain surface (EBS)
model and the inner neuropil surface (INS, also known as inner brain surface) model serve as global references, and the
neuropil regions, e.g., the mushroom body (MB), are considered local references. At the beginning, the average models of
the global and local references are generated by the improved
two-level model averaging technique (iTLMA) [20]. Then, the
average model of the neuropil, i.e., the local reference model,
is placed into the global reference models with appropriate average position and orientation. The complete Drosophila brain
atlas can be compiled after positioning all the local references
inside the global references. Thereafter, it would be able to compare neural images taken from different individuals by warping
them into the same atlas system.
We created a procedure to guarantee that the source images
are adequate for reconstructing 3D mesh surface models. In
our approach, the contours of the EBS, INS, and neuropils of
each Drosophila are labeled under user supervision from the
whole fly brain images taken by confocal microscope. Then,
3D surface models are reconstructed from the labeled 2D image
stacks using Amira 4.1.2 (now Avizo, Visualization Science

SHAO et al.: DEVELOPING A STEREOTYPICAL DROSOPHILA BRAIN ATLAS

2851

Group, Merignac Cedex, France). All reconstructed models have
to be verified by biologists. Samples with obvious distortion
that resulted from dissection artifacts are discarded. Each local
reference model is generated and processed independently. In
order to acquire high-quality source images, each brain sample
is imaged twice under a 20X objective lens. First, the brain
is scanned with settings optimized for visualizing the internal
neuropils. Then, imaging is performed under conditions most
suited for the INS. The photobleaching effect caused by repeated
imaging can be alleviated by using a lower powered excitation
laser with the aid of FocusClear [21], [22].

B. The Improved Two-level Model Averaging Method
We developed improved two-level model averaging (iTLMA)
method [20] by introducing 3D EDT and SBA into the original
framework of two-level model averaging (TLMA) technique
[23]. TLMA aims to construct an average surface model from
several surface models. In that work, global characteristics of
different models were aligned in the coarse-level model averaging phase; then, the average model was built by regarding
the voxel-based geometric median obtained from thresholding
the cumulative volume in the fine-level model averaging phase.
The main difference between TLMA and iTLMA is that TLMA
generates an averaged surface model by thresholding, whereas
iTLMA is based on a signed distance map and shape averaging procedure. Consequently, the globally registered triangular
mesh models derived by iTLMA can yield a stereotypical averaged model.
Two categories of structures must be averaged to create a
reference brain: axial and nonaxial. Each of these requires a different strategy to derive its coarse reference model. For nonaxial
objects, e.g., olfactory glomeruli inside the antennal lobes, the
INS, and the EBS, the transformation relationship between two
objects can be found only through surface registration. On the
other hand, for models with axial structures, their coarse-level
average can be evaluated by exploiting axial features. The MB
in the Drosophila brain is a representative of neuropils with a
pair of triaxial structures [24]. The MB is formed by tangled
neural fibers from about 2,500 neurons [25], most of which
are responsible for olfactory functions related to learning and
memory [24], [26]. It is well posed to study neural circuit
structure-function relationships in the fly brain.
The following two sections will describe in detail how to
derive the averaged models of both axial and nonaxial structures.
The EBS and INS models are nonaxial, whereas the MB model
is axial.
1) Coarse-Level Model Averaging for Axial Structures:
Fig. 3 shows the process used to average the coarse-level model
of axial structures. This method is designed to align global features and yield the global registration result, denoted as the
“pseudo-average model.”
To average an axial model at coarse level, this procedure is
implemented in three stages. The first involves manually partitioning each input surface model into disjoint axial components.
The second determines the skeleton of each partitioned sub-

Fig. 3.

Coarse-level model averaging process for axial structures.

model, i.e., the jth axial component, by PCA. Finally, the third
averages skeletons from those of each individual’s submodels.
Let Sj denote the sample covariance matrix of the jth submodel as follows:
1 
(xj,k − μj )(xj,k − μj )T .
m−1
m

Sj =

(1)

k =1

Here, xj,k is the position vector of the kth vertex in the
jth submodel, m is the number of vertices, and μj = (1/m) m
k =1 xj,k
denotes the sample mean vector of the jth submodel. Then,
Di,j , the normalized principal axis of the jth sub-model of the
ith input model, is the eigenvector of Si,j with the smallest
eigenvalue.
Next, let vi,j be the principal axis of the ith input’s jth
submodel. Because an axis in 3D space is precisely a vector
passing through a reference point, vi,j can be represented as
a parametric line segment in terms of a parameter ti,j , a unit
vector Di,j , and a reference point μi,j as follows:
vi,j (t) = μi,j + ti,j · Di,j

(2)

where ti,j is the projection length determined by projecting all
the vertices in the submodel onto the principal axis, and μi,j
denotes the barycenter of the submodel. As explained earlier, a
set of principal axes is extracted from the partitioned submodels,
and this set is referred to as the skeleton of the individual model.
The average skeleton of an axial model is determined by regarding the average principal axes of all the submodels. The
average principal axis of a specific submodel is evaluated according to the average position of the barycenters, the average
direction, and the length of the average principal axis of the
specific submodel of all samples. The average principal axis of
the jth submodel is then defined as

where μ̄j =

1
n

n

v̄j (t) = μ̄j + tj · D̄j

i=1

jth submodel, D̄j =

(3)

μi,j
denotes the average barycenter of the



n
 in= 1 D i , j
i= 1 Di,j 

is the average unit direction

2852

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig. 4. Example for average skeleton extraction. (a) MB model, an axial
structure with six axes. (b) Set of six principal axes extracted from the MB
model. (c) Principal axes set of all the individual MB models. (d) Alignment of
the principal axes sets. (e) Average skeleton of the MB model. X, Y, and Z
denote, respectively, the medial lobes, the peduncles, and the vertical lobes.

Fig. 6. Flowchart for generating an estimation of a local reference’s position
and orientation from a sample.

Fig. 5.

Process used to average coarse-level models of nonaxial structures.


vector, tj = n1 ni=1 ti,j is the average parameter, and n is the
number of input individual models. Fig. 4 illustrates the example
of deriving average skeletons of an axial model.
Finally, each input model is warped using the 3D field-based
warping algorithm [27], by aligning its skeletons to the average
skeletons. The warping function of the ith model is defined as
r
−2
j =1 di,j (x) [Wi,j (x) − x]
r
(4)
Wi (x) = x +
−2
j =1 di,j (x)
where di,j (x) is the distance from a point x to the jth principal axis of the ith individual model; r denotes the number
of submodels of the axial structures; and Wi,j (x) is the affine
warping function derived from the jth principal axis, i.e., vi,j ,
and its corresponding average principal axis, i.e., v̄j . In sum, Eq.
(4) means that the overall 3D displacement field is an inversedistance-weighted sum of the displacement field suggested
by Wi,j (x).
2) Coarse-Level Model Averaging of Nonaxial Structures:
To average the coarse-level models of nonaxial structures, we
used rigid and scaling transformations, which allow only translation, rotation, and isotropic scaling of the target model and
preserve the geometric properties of the model. Although affine
registration can generally derive a better alignment than rigid
registration, it is not robust enough when there exists an improper reference model in the input data sets. For example,
if the reference model is tilted, all the other models will be
tilted and consequently distorted after the affine process. Fig. 5

shows the process of deriving coarse-level nonaxial models. The
reference model used for registration is the individual model
whose volume is closest to the average volume.
3) Fine-Level Model Averaging: This step aims to generate
the final average model from the pseudoaverage models obtained
in the previous step. The fine-level model averaging procedure
is designed to align local details. As mentioned before, axial and
nonaxial model averaging processes share the same fine-level
model averaging procedure.
The main idea of this step is straightforward. Given K input
isosurfaces Si , we want to derive the optimal solution S ∗ that
1
2
∗
K
minimizes ΣK
i=1 S − Si  . Obviously, S = K Σi=1 Si . As a
result, the surface boundary of the final average model can be
determined by the zero-crossings of the cumulative signed distance map R(x)
R(x) =

K


SDM(x)i

(5)

i=1

where K is the number of pseudoaverage models, and SDM(x)i
is the signed distance map of the ith isosurface, that is, the ith
pseudoaverage model. For each voxel x, SDM(x)i records the
signed Euclidean distance d(x) from x to the nearest vertex on
the surface. The value of d(x) is positive if x is outside the
model, and negative if x is inside. Because the average surface
passes through the zero-crossings of R(x), the sum of the signed
distances between the average surface and the input surfaces is
expected to be zero.
C. Positioning Local Reference Models
A local reference model is the average model of a specific
internal volume, such as the MB. After generating the average
model of a neuropil using iTLMA, the next step is to determine
where the average neuropil is supposed to be in the average

SHAO et al.: DEVELOPING A STEREOTYPICAL DROSOPHILA BRAIN ATLAS

2853

TABLE I
STATISTICS OF THE GLOBAL/LOCAL REFERENCE MODELS CONSIDERED IN THIS STUDY: NUMBER OF SAMPLES, VOLUME OF THE AVERAGE MODEL, AVERAGE
VOLUME OF THE SAMPLES, SAMPLE STANDARD DEVIATION AND STANDARD ERROR OF THE MEAN
# Samples

Volume of
the average model
(μm 3 )

Average volume
of the samples
(μm 3 )

Sample
standard deviation
(μm 3 )

Stand error
of the mean
(μm 3 )

34
22
37

1.34 × 10 7
8.11 × 10 6
2.30 × 10 5

1.31 × 10 7
8.30 × 10 6
2.35 × 10 5

2.74 × 10 6
1.28 × 10 6
3.55 × 10 4

4.70 × 10 5
2.73 × 10 5
5.83 × 10 3

27
27
33

1.16 × 10 7
7.11 × 10 6
1.97 × 10 5

1.20 × 10 7
7.34 × 10 6
2.00 × 10 5

2.25 × 10 6
1.57 × 10 6
4.26 × 10 4

4.32 × 10 5
3.02 × 10 5
7.42 × 10 3

Female
EBS
INS
MB
Male
EBS
INS
MB

global reference model, i.e., the INS. For a specific neuropil,
each sample can generate its own suggested values of the neuropil’s position and orientation by taking the average INS and
the average neuropil model into account, as shown in Fig. 6. This
process can be decomposed into three primary components: 1)
deriving the rigid transformation Fi between the average INS
and the INS of the ith sample; 2) warping the ith neuropil into
the average INS using Fi ; and 3) estimating the rigid transformation between the average neuropil and the warped ith neuropil, and then deriving the suggested position and orientations.
Finally, by averaging all suggested positions and orientation parameters, the average local reference model can be positioned
into the global reference.
The rigid transform matrix Fi is comprised of a rotation
matrix and a translation vector. The mean translation vector is
the average of those suggested by the input brain samples. For
averaging the rotation matrices, several methods are discussed
in [28] and [29]; we adopt the strategy proposed in the latter
reference.
IV. RESULTS
The average EBS and INS were constructed from 37 female
flies and 33 male flies; and brain atlases were generated for sixday-old adult Drosophila females and males, accordingly. The
brain samples used in this study were stained against Drosophila
Discs Large (DLG) and transparentized by using FocusClear
[21], [22]. The obtained images then have sharper and clearer
shape boundaries than those acquired by conventional schemes.
Source fluorescent image stacks were acquired by the Zeiss
LSM 510 confocal microscope system (Carl Zeiss, Jena) using a 20X C-Apochromat water immersion objective lens (N.A.
0.75, working distance 660 μm). The optical slicing was adjusted to 2 μm thickness for each section, with an overlap of 1
μm between adjacent slices.2 The voxel size was approximately
0.64 μm × 0.64 μm × 2 μm; the volume correction factor was
0.826, calibrated according to spherical beads with a standard
diameter of 15 μm; and LSM510 software (Version 2.8, Carl
2 Image information in the overlapped part can enhance the detailed neuronal
structure, making it easier to find the relationships among fibers; meanwhile, the
50% overlap is an empirical value. Images acquired in this way can be viewed in
http://www.flycircuit.tw/, and discussions about image properties can be found
in [30].

Fig. 7. Drosophila brain atlases composed of (1) average EBS, (2) average
INS, and (3) correctly positioned average MB. (a) Female Drosophila brain
atlas, and (b) Male Drosophila brain atlas.

Zeiss, Jena) was used for the gallery display. The labeled images we used to reconstruct 3D mesh surface models were all
manually processed by the biologists, and the reconstructed 3D
surface models that we used to generate standard brain models
were verified as well.
The Drosophila brain atlas is comprised of global reference
models and correctly positioned local reference models. In this
paper, the average EBS and average INS served as global reference models, and one of the neuropils, the MB, served as the
local reference. Table I shows the statistics of the global/local
reference models considered in this study. The volume of the
generated average model is very close to the numerical average
volume.
We compiled two Drosophila brain atlases, one for female
Drosophila and the other for male, as shown in Fig. 7. Our
experiments focus on three reference models: EBS, INS, and
MB. Because biologists on our team concentrate on exploring
olfactory and memory neural circuitry around MBs [31], [32],
the standardized MB model is an indispensable local reference.
Although MB alone is not sufficient [33], we chose it because
it effectively contrasts neural pathways. For the ventral part or
the two lateral sides of the fly brain, MB may fail as a reference.
This is why we proposed here a system to build a 3D Drosophila
brain atlas rather than developed a complete atlas model of a
whole brain. As long as our biologists collect enough qualified
source images of other neuropils, the corresponding averaged
local landmark models can be reconstructed and positioned into
the standard fly brain. Finally, all EBS, INS, and MB models
were processed by mesh simplification; each EBS or INS model
used in our experiment contains about 20 000 vertices, and each
input MB model has about 9 000 vertices.

2854

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

V. DISCUSSION
A. Validation of Average Shape
The average shape property of the average model was validated using 34 female EBSs and the derived average EBS
model. The shape difference was measured by the surface distance between two surface models. Specifically, the surface
distance between two surface models was defined to be the
mean Euclidean distance of all point pairs (pi , qi ). Here, pi
denotes the vertex belonging to the input model, and qi is the
closest corresponding point in the reference model. Shown in
Fig. 8 is the comparison of surface distances among the EBS
models. The box-and-whisker plots demonstrate the surface
distances between the ith EBS and other 33 EBSs; the diamonds indicate the surface distance values between the ith EBS
and the average EBS. The box-and-whisker plots visualize the
minimum, maximum, median, 25th percentile, and 75th percentile of the surface distances. Fig. 8 shows that the surface
distance between the ith input model and the averaged model
is less than the median distance between ith and other EBSs
for almost all EBSs (32/34). This result demonstrates that the
average surface model is suitable to describe the anatomical
similarity of brain shapes. Besides, based on our experimental
results, the maximal distance between an arbitrary point inside
the brain volume (whose dimension is about 1024 × 1024 × 60)
and its nearest projection point on the average inner brain surface
(INS) is 25.0 voxels, and the maximum (minimum) Hausdorff
distance between all input INS models and the average INS is
39.75 (18.14) voxels.
B. Robustness Against Model Individuality
In Section III-B2, we asserted that for nonaxial structures the
coarse-level model averaging process will be more robust if it
is accomplished using rigid and scaling transformations. The
robustness is validated by using 34 EBS models. Specifically,
each EBS model, i.e., the ith individual, is used as an initial
reference in turn to generate the ith average model first, and then
we measure the average distance between the ith average and
the 34 rigidly aligned input EBS models. The average distances
range from 5.487 to 5.703 μm, a difference of about 0.22 μm.
Because the voxel size of our experimental data is 0.64 μm ×
0.64 m × 2 μm, a difference of 0.22 μm is only about 10% of
the voxel diagonal length. This fact evidences that the proposed
system is indeed robust against the user-selected initial template.
ISA would generate a less representative average model if an
improper initial reference were chosen, as we will discuss in the
next section.
C. Comparison With ISA and VIB Methods
As shown in [34], when there are only a few input samples, the iTLMA technique aided by a user-specified feature
identification mechanism outperforms VIB and ISA. Here, the
proposed scheme (averaging nonaxial structure using iTLMA
without user intervention) is compared with VIB and ISA by using 22 female INS models. Because the nonrigid transformation
makes ISA computationally time consuming, the 22 INS mod-

els were downsampled in advance for this experiment. Fig. 9
illustrates the average INS models generated by the proposed
scheme, VIB, and ISA. The average model derived by ISA is
narrower in the horizontal direction than the other two models,
whereas the average models generated by VIB and the proposed
method are very similar, as shown in Fig. 9(d). Moreover, the
volumes of the average models generated by ISA, VIB, and the
proposed system are, respectively, 82.9%, 95%, and 95.2% of
the numerical average volume. The volume of the ISA-based
average model is relatively small compared to the numerical
average.
The proposed system can be further compared with VIB and
ISA by using the two-sided mean surface-to-surface distance
between the sample models and the averaged one. Let S1 and
S2 be two surface models, where the two-sided mean distance is
the average of forward (S1 → S2 ) mean distance and backward
(S2 → S1 ) mean distance. In this section, the distances are calculated by METRO [35], one of the best-known downloadable
algorithms measuring surface-to-surface distances.
The global registration processes differ for ISA, VIB, and
the proposed schemes. In order to make a complete comparison, we generated average INS models in four ways: ISA, VIB,
Proposed-1, and Proposed-2. ISA affinely transforms the input
samples to a prechosen reference to carry out the global registration process; VIB and Proposed-1 adopt rigid and scaling
transformations; and Proposed-2 uses only rigid transformation.
Fig. 10 shows the mean distances between input samples and
each of the four average models. The figure shows that Proposed1 has the smallest average mean distance in most cases, which
indicates that the proposed method can generate a more representative average surface model than VIB or ISA. The average
mean distance for ISA is the largest because ISA introduces
bias toward the prechosen reference. As a result, the average
model derived by ISA will be less representative if an improper
initial reference is selected. Furthermore, the average mean distances of Proposed-2 and VIB are similar yet slightly larger
than that of Proposed-1. This implies that the rigid transformation (Proposed-2) is the most efficient strategy and is adequate
for globally registering nonaxial objects if the number of input
samples is sufficient.
D. Coarse-Level Model Averaging: Axial Versus Nonaxial
Models of axial structures require a coarse-level model averaging strategy that differs from that required by models of
nonaxial structures. Herein, we derive two average MB models
from 37 female samples: one for axial structures and the other
for nonaxial structures.
The volume of the average MB generated by axial coarselevel model averaging is 98.1% of the numerical average volume; however, the volume of the average MB generated by
nonaxial coarse-level model averaging is only 86.3% of the numerical average volume. Fig. 11 depicts the two average MB
models. The right-hand-side average model, generated by nonaxial coarse-level model averaging, shrinks because the rigid
alignment aligns only the overall shape, and thus local details
are overflattened. Through partitioning a multiaxial structure

SHAO et al.: DEVELOPING A STEREOTYPICAL DROSOPHILA BRAIN ATLAS

2855

Fig. 8. Comparison of the surface distances among EBS (numbered 1–34) models. (1) Box-and-whisker plots demonstrate the distributions of distances between
the ith EBS and other 33 EBSs. (2) Diamonds denote the distances between the ith EBS and the average EBS models.

Fig. 9. Comparison of the average INS surface models generated by different average methods: (a) average INS model generated by the proposed method,
(b) average INS model generated by VIB, and (c) average INS model generated by ISA. (d) Comparison.

Fig. 10. Comparison of the two-sided mean surface distances between each INS (numbered 1–22) and the average INS generated by different methods. AVG
indicates the average of the 22 mean distances. The probability threshold used to derive average surfaces from ISA and VIB is 50%.

2856

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig. 11. Comparison of the average models derived by different ways in the
coarse-level model averaging phase: (a) average MB model generated by axial
coarse-level model averaging, and (b) average model generated by nonaxial
coarse-level model averaging. The MB on the right-hand-side shrinks.
TABLE II
EVALUATION RESULTS OF THE REGISTRATION ACCURACY (RELATIVE
DISTANCE, UNIT: μm). THE VOXEL DIAGONAL LENGTH IS ABOUT 2.2 μm
Test point

Global

Global-plus-local

MB tip (left)
MB tip (right)

3.73 ± 0.49
4.16 ± 0.57

1.11 ± 0.22
1.02 ± 0.25

into several disjoint axial components and aligning the skeleton of each component, models with axial structures can be
registered much better and yield a more trustworthy average.
E. Registration Accuracy
In order to integrate neuron images into the brain atlas, the
global registration process is usually followed by an additional
local registration procedure, e.g., [36], driven by local control
points. Therefore, for the derived brain atlas, the accuracy of
both global registration and global-plus-local registration has to
be examined. We estimated the accuracy of global registration
by using the female Drosophila brain atlas and 34 female brain
samples. After automatic global affine registration, the mean
volumetric overlap ratio of the sample brains and the averaged
EBS was 93% ± 2%. As for internal neuropils, although their
volumetric overlap ratios may vary after global alignment, their
deformation field is constrained by that of the affinely registered
EBS, and consequently the spatial relationship among them
would be largely preserved.
Next, by selecting a test point, the accuracy of global-pluslocal registration was appraised by measuring the distance between the test point of the warped input sample brain and that of
the brain atlas. We chose the tip points of MB’s α−lobe as our
test points. Because the α−lobe is the longest lobe of MB, its tip
point would have the largest displacement if the local registration was not stable or precise enough. As shown in Table II, the
average distances after local registration are at subvoxel level,
and thus the accuracy is sufficient.
VI. APPLICATIONS
A. Brain Coordinate System
Two brain coordinate systems have been developed: the global
coordinate system for the INS and EBS models, and the local
coordinate system for the MB model. Similar to the concept of
defining the AC–PC line in the Talairach atlas [37], the proposed coordinate systems are defined based on the anatomical

structural features of the Drosophila brain. The three principal
axes of the global coordinate system are the principal axis of
the esophagus, namely nz , and the two longest principal components of EBS model, nx and ny . The origin of the global
coordinate system is the intersection of nz and the XY plane,
which best fits the EBS model’s vertices. The XY plane equation
is
nz , x = d

(6)

where d can be determined by
1 
nz , vi .
m i=1
m

d=

(7)

Here, m denotes the number of vertices, and vi denotes the ith
vertex’s position.
Meanwhile, the local MB coordinate system is defined according to MB’s triaxial structure. The XY plane is first fitted
by medial lobes and peduncles; then, the YZ plane is fitted by
peduncles and vertical lobes under the constraint that the YZ and
XY planes be orthogonal. As illustrated in Fig. 4(b), we labeled
the principal axes of peduncle, medial lobe, and vertical lobe by
Y, X, and Z, respectively.
B. Surface-Constrained Volumetric Registration
Typical registration approaches are driven by control points,
which can cause poor alignment of regions far from control
points. To overcome this, an intuitive counterplot is to constrain
the deformation field using additional boundary conditions. Recently, a prototype registration method was developed for mesh
surface models based on TPS deformation [38]. Vertices on a
warped surface model can act as additional control points and
boundary conditions for registering and warping the whole image volumes. The derived stereotypical average surface models
are beneficial for registering and warping image volumes, and
one possible future application or extension of the proposed
system is surface-constrained volumetric registration for image
stacks.
C. Automatic Neuropil Segmentation
Because regions of interest in biomedical images commonly
have low contrast and blurred boundaries, they usually cannot
be processed using conventional intensity-based segmentation
schemes. By regarding the average neuropil model as a template or a 3D shape prior, a template-based or knowledge-based
automatic segmentation method can be developed for processing microscopic image stacks. For example, Chen et al. proposed a template-based method for automatically segmenting
Drosophila mushroom bodies from confocal microscope imagery [39]. Typical template-based segmentation strategies are
problematic in the representativeness of the template and the
accuracy of the registration process. However, our experiments
show that these difficulties are overcome by the standard average
model derived by our system.

SHAO et al.: DEVELOPING A STEREOTYPICAL DROSOPHILA BRAIN ATLAS

2857

Fig. 9 and described in Section V-C, these three neurons exceed
the boundary of the INS model built by ISA.
VII. LIMITATION AND IMPROVEMENT

Fig. 12. Variance and invariance in anatomy. Each of the three neurons comes
from a different individual, and except for the difference in positions of cell
bodies, the pathway and distribution of neuron fibers are quite similar. The
volumetric warping method and the program (3D viewer) used to generate
this figure were all implemented by the National Center for High-Performance
Computing, Hsinchu, Taiwan.

D. Databasing and Data Integration
The derived Drosophila brain atlas provides a standardized
space to visualize and compile neuron images taken from different flies. Based on the obtained atlas, an open-access database,
named FlyCircuit (http://www.flycircuit.tw) [40], has been developed. For each set of neuron images in FlyCircuit, at least
one local reference neuropil was imaged in it. Single-neuron images can be transformed into the standardized space by aligning
the individual neuropil model, e.g., MB, with the standard one.
Consequently, cross-lab validation and analysis are achievable,
and the wiring patterns of independent neurons can be visualized
and compared through the user interface.
Finally, Fig. 12 shows an example that demonstrates anatomical variance and invariance through average surface models
built by the proposed system. Although the three neurons’ cell
bodies are located in different places (anatomical variance), the
distributions of their neural fibers are almost the same (anatomical invariance). Based on this kind of visualization, the standard average models can assist biologists to propose hypotheses
for neuron pathways and connectivity. The EBS, INS, and MB
shown in Fig. 12 are derived based on the proposed system; for
other neuropils, their models are collected from the fly brain
whose EBS, INS, MB, and volume sizes best fit the standard
average models. Also, these three neurons just reach and do not
pierce the INS surface [see Fig. 12(d)] derived by the proposed
method. Because the INS models generated by ISA and VIB are
narrower, flatter, and smaller than our INS model, as shown in

The proposed system has a primary limitation. The proposed
system requires very clear shape information, which means that
the source image stack must be imaged twice, under different settings, for reconstructing and positioning the standard 3D
mesh surface models, as mentioned in Section III-A. For focal
stacks not being imaged in this way, it is hard to label the boundaries of inner/external brain surfaces and the target neuropil at
the same time, and thus the average mesh surface models might
not be mapped into the right places. Moreover, this limitation
imposes a restriction on warping images; volumes from one laboratory can hardly fit into the atlas generated from the source
images of another laboratory unless these two laboratories adopt
the same stain process and imaging procedures. For example,
because the brain samples prepared for us were stained against
DLG and imaged within FocusClear, the neuropil shape boundaries, as well as the brightness and the contrast, in our images
may differ from those in images prepared by using NC82, e.g.,
images from the FlyLight database [41]. Hence, although the
proposed system is designed to process common mesh surface
models, the applicability of obtained average atlas models depends on the sample preparation stage.
Consequently, there is a potential improvement for the proposed system. A volumetric registration/warping scheme compatible with the average mesh surface models obtained by the
proposed system should be designed, so that the gap between
image volumes and standard brain models produced by different
laboratories can be bridged by shape information. Such registration/warping scheme is also a necessity for enabling standard
brain atlas to accommodate neural images acquired from different experiments.
VIII. CONCLUDING REMARKS
We proposed a system to build a 3D Drosophila brain atlas
consisting of standardized global and local reference models.
The system was implemented in three components: nonaxial
model averaging method, axial model averaging method, and
model positioning method. The two model averaging strategies differ in the coarse-level processing methods and share the
same fine-level processing procedure. For models of nonaxial
structure, coarse-level averaging is accomplished via rigid and
scaling transformations. For axial models, coarse-level averaging method is achieved by registering and warping skeletons of
partitioned submodels. We completed the fine-level model averaging method by regarding the zero-crossings of the cumulative
signed distance map so that the sum of signed distances between
the average surface and the input data is expected to be zero.
Experiments demonstrated that the performance, robustness,
and accuracy of the proposed scheme are better than those of
probabilistic methods. Due to the robustness of the derived deterministic model, the proposed framework could be extended

2858

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

to various applications, such as surface-based volumetric registration and automatic 3D segmentation.
ACKNOWLEDGMENT
This study was a branch of the Academia Sinica Thematic Research Project, “Building a map of wiring diagrams for olfactory computation in the Drosophila brain,” directed by Prof. Wen-Liang Hwang. The authors would like to
thank the National Center for High-Performance Computing
(http://www.nchc.org.tw/en/) for providing their “3D Viewer”
program and for warping source image volumes into the standard atlas. Finally, the authors also would like to thank Dr. YingCheng Chen for his efforts in developing prototype algorithms
for brain model reconstruction and analysis.
REFERENCES
[1] D. G. Kendall, “A survey of the statistical theory of shape,” Statistical
Sci., vol. 4, no. 2, pp. 87–99, 1989.
[2] K. Rein, M. Zockler, M. T. Mader, C. Grubel, and M. Heisenberg, “The
Drosophila standard brain,” Curr. Biol., vol. 12, pp. 227–231, 2002.
[3] A. Jenett, J. E. Schindelin, and M. Heisenberg, “The virtual insect brain
protocol: Creating and comparing standardized neuroanatomy,” BMC
Bioinformatics, vol. 7, no. 1, p. 544, 2006.
[4] T. Rohlfing, R. Brandt, C. R. Maurer Jr., and R. Menzel, “Bee brains,
b-splines and computational democracy: Generating an average shape
atlas,” in Proc. IEEE Workshop Math. Methods Biomed. Image Anal.,
Dec. 2001, pp. 187–194.
[5] D. Dreyer, H. Vitt, S. Dippel, B. Goetz, B. El Jundi, M. Kollmann,
W. Huetteroth, and J. Schachtner, “3d standard brain of the red flour
beetle tribolium castaneum: A tool to study metamorphic development
and adult plasticity,” Front. Syst. Neurosci., vol. 4, no. 3, 2010.
[6] A. E. Kurylas, T. Rohlfing, S. Krofczik, A. Jenett, and U. Homberg,
“Standardized atlas of the brain of the desert locust, schistocerca gregaria,”
Cell Tissue Res., vol. 333, no. 1, pp. 125–145, Jul. 2008.
[7] B. El Jundi, W. Huetteroth, A. Kurylas, and J. Schachtner, “Anisometric
brain dimorphism revisited: Implementation of a volumetric 3d standard
brain in manduca sexta,” J. Comp. Neurol., vol. 517, no. 2, pp. 210–225,
2009.
[8] R. Brandt, T. Rohlfing, J. Rybak, S. Krofczik, A. Maye, M. Westerhoff,
H.-C. Hege, and R. Menzel, “Three-dimensional average-shape atlas of
the honeybee brain and its applications,” J. Comp. Neurol., vol. 492,
pp. 1–19, 2005.
[9] B. B. Løfaldli, P. Kvello, and H. Mustaparta, “Integration of the antennal
lobe glomeruli and three projection neurons in the standard brain atlas
of the moth heliothis virescens,” Front. Syst. Neurosci., vol. 4, pp. 1–12,
2010.
[10] H. Wei, B. el Jundi, U. Homberg, and M. Stengl, “Implementation of
pigment-dispersing factor-immunoreactive neurons in a standardized atlas
of the brain of the cockroach leucophaea maderae,” J. Comp. Neurol.,
vol. 518, no. 20, pp. 4113–4133, 2010.
[11] H. Peng, P. Chung, F. Long, L. Qu, A. Jenett, A. M. Seeds, E. W. Myers,
and J. H. Simpson, “Brainaligner: 3d registration atlases of Drosophila
brains,” Nature Methods, vol. 8, no. 6, pp. 493–498, 2011.
[12] F. L. Bookstein, “Principal warps: Thin-plate splines and the decomposition of deformations,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 11,
no. 6, pp. 567–585, Jun. 1989.
[13] T. Rohlfing and C. Maurer, “Shape-based averaging,” IEEE Trans. Image
Process., vol. 16, no. 1, pp. 153–161, Jan. 2007.
[14] C. R. Maurer Jr., R. Qi, and V. Raghavan, “A linear time algorithm for
computing exact euclidean distance transforms of binary images in arbitrary dimensions,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 25, no. 2,
pp. 265–270, Feb. 2003.
[15] A. Lerios, C. D. Garfinkle, and M. Levoy, “Feature-based volume metamorphosis,” in Proc. SIGGRAPH: 22nd Annu. Conf. Comput. Graph.
Interactive Tech., 1995, pp. 449–456.
[16] L. Qu and H. Peng, “A principal skeleton algorithm for standardizing
confocal images of fruit fly nervous systems,” Bioinformatics, vol. 26,
no. 8, pp. 1091–1097, 2010.

[17] P. Ahammad, C. L. Harmon, A. Hammonds, S. Shankar Sastry, and
G. M. Rubin, “Joint nonparametric alignment for analyzing spatial gene
expression patterns in Drosophila imaginal discs,” in Proc. IEEE Comput.
Soc. Conf. Comput. Vision Pattern Recog., 2005, vol. 2, pp. 755–760.
[18] Vaa3D [Online]. Available: http://www.vaa3d.org/
[19] I. T. Jolliffe, Principal Component Analysis. New York, NY, USA:
Springer, 2002.
[20] C. C. Wu, C. Y. Chen, H. M. Chang, A. S. Chiang, and Y. C. Chen,
“Improved two-level model averaging techniques in Drosophila brain
modeling,” in Proc. 3rd Pacific Rim Symp. Advances Image Video Technol.,
2009, pp. 921–931.
[21] A.-S. Chiang, “Aqueous tissue clearing solution,” US Patent 6 472 216,
Oct. 29 2002, .
[22] Y.-C. Liu and A.-S. Chiang, “High-resolution confocal imaging and
three-dimensional rendering,” Methods, vol. 30, no. 1, pp. 86–93,
2003.
[23] Y.-C. Chen, Y.-C. Chen, and A.-S. Chiang, “Two-level model averaging techniques in Drosophila brain imaging,” in Proc. Int. Conf. Image
Process., 2002, pp. II: 941–944.
[24] S. E. McGuire, P. T. Le, and R. L. Davis, “The role of Drosophila mushroom body signaling in olfactory memory,” Science, vol. 293, no. 5533,
pp. 1330–1333, 2001.
[25] H. A. Johard, L. E. Enell, E. Gustafsson, P. Trifilieff, J. A. Veenstra, and
D. R. Nssel, “Intrinsic neurons of Drosophila mushroom bodies express
short neuropeptide F: relations to extrinsic neurons expressing different
neurotransmitters,” J. Comp. Neurol., vol. 507, no. 4, pp. 1479–1496,
2008.
[26] R. L. Davis, “Traces of Drosophila memory,” Neuron, vol. 70, no. 1,
pp. 8–19, 2011.
[27] J. Gomes, L. Darsa, B. Costa, and L. Velho, Warping and Morphing of
Graphical Objects. San Francisco, CA, USA: Morgan Kaufmann, 1998.
[28] M. Moakher, “Means and averaging in the group of rotations,” SIAM J.
Matrix Anal. Appl., vol. 24, no. 1, pp. 1–16, 2002.
[29] I. Sharf, A. Wolf, and M. Rubin, “Arithmetic and geometric solutions
for average rigid-body rotation,” Mech. Mach. Theory, vol. 45, no. 9,
pp. 1239–1251, 2010.
[30] H.-C. Shao, W.-L. Hwang and Y.-C. Chen, “Optimal multiresolution
blending of confocal microscope images,” IEEE Trans. Biomed. Eng.,
vol. 59, no. 2, pp. 531–541, Feb. 2012.
[31] C.-C. Chen, J.-K. Wu, H.-W. Lin, T.-P. Pai, T.-F. Fu, C.-L. Wu, T. Tully,
and A.-S. Chiang, “Visualizing long-term memory formation in two neurons of the Drosophila brain,” Science, vol. 335, no. 6069, pp. 678–685,
2012.
[32] H.-H. Lin, L.-A. Chu, T.-F. Fu, B. J. Dickson, and A.-S. Chiang, “Parallel neural pathways mediate co2 avoidance responses in Drosophila,”
Science, vol. 340, no. 6138, pp. 1338–1341, 2013.
[33] A. Cardona, S. Saalfeld, I. Arganda, W. Pereanu, J. Schindelin, and
V. Hartenstein, “Identifying neuronal lineages of Drosophila by sequence
analysis of axon tracts,” J. Neurosci., vol. 30, no. 22, pp. 7538–7553,
2010.
[34] G.-Y. Chen, C.-C. Wu, H.-C. Shao, H.-M. Chang, A.-S. Chiang, and
Y.-C. Chen, “Retention of features on a mapped Drosophila brain surface using a Bezier-tube-based surface model averaging technique,” IEEE
Trans. Biomed. Eng., vol. 59, no. 12, pp. 3314–3326, Dec. 2012.
[35] P. Cignoni, C. Rocchini, and R. Scopigno, “Metro: Measuring error on
simplified surfaces,” Comput. Graph. Forum, vol. 17, no. 2, pp. 167–174,
1998.
[36] Y.-Z. Chang and Z.-R. Tsai, “Efficient 3d registration using two-stage
scheme and spatial filter,” Int. J. Innov. Comput. I., vol. 6, no. 2,
pp. 641–653, Feb. 2010.
[37] A. W. Toga, Brain Warping. New York, NY, USA: Academic, 1998.
[38] H.-C. Shao, C.-C. Wu, L.-H. Hsu, W.-L. Hwang, and Y.-C. Chen, “3d
thin-plate spline registration for Drosophila brain surface model,” in Proc.
IEEE Int. Conf. Image Process., 2013, pp. 1438–1442.
[39] G. Y. Chen, Y. C. Chen, C. F. Lin, A. C. Hu, C. C. Wu, and
Y. C. Chen, “Template-based automatic segmentation of Drosophila mushroom bodies,” J. Inf. Sci. Eng., vol. 24, no. 1, pp. 99–113, 2008.
[40] A.-S. Chiang, et al., “Three-dimensional reconstruction of brain-wide
wiring networks in Drosophila at single-cell resolution” Curr. Biol., vol.
21, no. 1, pp. 1–11, 2011.
[41] A. Jenett, et al., “A GAL4-driver line resource for Drosophila neur obiology,” Cell Reports, vol. 2, pp. 991–1001, 2012.
Authors’ photographs and biographies not available at the time of publication.

