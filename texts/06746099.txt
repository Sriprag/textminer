IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

1787

Real-time Microwave Imaging of Differential
Temperature for Thermal Therapy Monitoring
Mark Haynes∗ , Member, IEEE, John Stang, Member, IEEE, and Mahta Moghaddam, Fellow, IEEE

Abstract—A microwave imaging system for real-time 3-D imaging of differential temperature has been developed for the monitoring and feedback of thermal therapy systems. Design parameters
are constrained by features of a prototype-focused microwave thermal therapy system for the breast, operating at 915 MHz. Real-time
imaging is accomplished with a precomputed linear inverse scattering solution combined with continuous vector network analyzer
(VNA) measurements of a 36-antenna, HFSS-modeled, cylindrical
cavity. Volumetric images of differential change of dielectric constant due to temperature are formed with a refresh rate as fast
as 1 frame/s and 1 ◦ C resolution. Procedures for data segmentation and postprocessed S-parameter error-correction are developed. Antenna pair VNA calibration is accelerated by using the
cavity as the unknown thru standard. The device is tested on water
targets and a simple breast phantom. Differentially heated targets are successfully imaged in cluttered environments. The rate of
change of scattering contrast magnitude correlates 1:1 with target
temperature.
Index Terms—Biomedical imaging, biomedical monitoring,
Born approximation (BA), calibration, distorted Born approximation (DBA), inverse scattering, microwave breast hyperthermia,
microwave breast imaging, microwave imaging, temperature measurement, vector network analyzer (VNA).

I. INTRODUCTION
N RECENT years, thermal therapies have seen increased
use in the treatment of a variety of diseases, particularly in
cases of subcutaneous cancers of the soft tissue, [1]. In general,
these treatments can be classified into two types: 1) thermal
ablation, which employs extreme temperatures to induce rapid
and localized tissue destruction and 2) hyperthermia, which
employs moderately elevated temperatures (typically between
40–45 ◦ C) to sensitize tumor cells to the effects of radiation
or chemotherapy. Ablative methods include cryoablation, high
intensity-focused ultrasound, radio frequency ablation, and microwave ablation [2]–[4]. Hyperthermia is typically induced us-

I

Manuscript received August 19, 2013; revised November 9, 2013 and January 8, 2014; accepted February 8, 2014. Date of publication February 20, 2014;
date of current version May 15, 2014. This work was supported in part by the
Department of Defense, Breast Cancer Research Program, DoD/BCRP Award
BC095397 and by the National Institute of Health under Grant T32 EB005172.
Asterisk indicates corresponding author.
∗ M. Haynes is with the Department of Electrical Engineering-Electrophysics,
University of Southern California, Los Angeles, CA 90089 USA (e-mail:
mshaynes@usc.edu).
J. Stang and M. Moghaddam are with the Department of Electrical
Engineering-Electrophysics, University of Southern California, Los Angeles,
CA 90089 USA (e-mail: jstang@usc.edu; mahta@usc.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2307072

ing radio frequencies [5], nonfocused ultrasound, and focused
microwaves which have been used as an adjuvant to radiation
therapy or chemotherapy [6], [7]. For overviews on hyperthermia, heating methods, and the physiological effects of hyperthermia, see [8]–[10].
As thermal treatment systems evolve, the need for thermal
monitoring has motivated research in several modalities. The use
of fiber optic catheter temperature sensors dates back decades
across a range of treatment methods [11]–[13]. Probes are fast
and accurate, but coverage is limited to the sensor tip and inherently invasive. MRI has been extensively studied for thermal
monitoring [14]–[16], especially in ultrasound ablation [17] and
microwave hyperthermia [18]. MRI provides full coverage of a
treatment region, but is limited by expense, access, and the requirement that a thermal delivery system be MRI compatible.
Ultrasonic thermal monitoring has received attention in shearwave, speed of sound, backscatter variation, and optoacoustic
thermal imaging [19]–[22]. Also, microwave thermal imaging in
a medical setting has been reported for 2-D antenna geometries
with inverse scattering techniques [23]. The same system was
used to monitor HIFU with 35 s refresh rates [24]. Finally, monitoring provides a mechanism for controlled feedback, which
has been reported using real-time MRI-guided microwave hyperthermia [25], [26].
Our interest is the development of microwave-based realtime thermal monitoring within the constraints of focused microwave thermal therapy system parameters in order to avoid the
cost and complexities of dual modality implementations. This
is done within the design parameters of a previously developed
preclinical-focused microwave prototype for breast cancer therapy [27]. The imaging system here is composed of a cavity-like
antenna array at 915 MHz with a coupling fluid, vector network
analyzer (VNA), and solid-state switching matrix, shown in
Fig. 1. Using a VNA in this context, with experimental features
we developed to do so, obviates the need for custom radar hardware in order to accomplish real-time thermal monitoring. Note
that this system, as presented, is designed to image changes in
the dielectric constant due to the application of microwave heating, rather than image the structure of the breast for diagnostic
purposes.
Microwave imaging of differential temperature is predicated
on the change in dielectric properties of water with temperature.
It is well known that the dielectric properties of water change
as a function of temperature [29], [30]. The relative permittivity
and conductivity of distilled water as a function of temperature
at 915 MHz are plotted in Fig. 2. Within the range of thermal
therapy temperatures (35 ◦ C–60 ◦ C), the relative permittivity of
water changes by as much as a few units, and the conductivity

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1788

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

Fig. 1. Cavity-imaging system for differential temperature imaging with the
switching matrix, VNA, Labview control, and fluid circulation.

Fig. 3. 36-port unknown “thru” calibration. (a) Calibration diagram and instrumentation setup. (b) Fluid-filled cavity used as the unknown thru standard.
(c) 3 × 1:12 power divider network also tested as an unknown thru.

II. METHODS
Fig. 2. Relative permittivity and conductivity of distilled water as a function
of temperature at 915 MHz, measured with the Agilent 85070E dielectric probe.

up to a factor of 2. The dielectric change of the animal liver tissue has been reported to be approximately 1% per ◦ C between
28 ◦ C and 53 ◦ C at 915 MHz, [31]. Studies of the excised breast
tissue show that soft-tissue dielectric properties are dominated
by water fraction, [32], and are expected to change proportionally with temperature. Thus, even though the dielectric change
is small, the ability to detect it has been reported in both medical
and nonmedical settings [23], [33].
This paper is organized as follows: system design and formulations are given in some detail throughout Section II. We
develop new procedures to accelerate VNA calibration by using the cavity itself as an unknown thru standard. Full-wave
imaging is enabled by a complete electromagnetic model of
the cavity electric fields using Ansys HFSS that is linked to
the scattered field integral equations [28]. Real-time imaging is
accomplished through a precomputed linear inverse scattering
solution that is applied continuously to an updating VNA data
stream. Finally, procedures for data stream segmentation and
VNA error-correction are developed. Section III contains imaging results and discussions, where the system is tested on a target
with changing temperature in different cluttered environments,
including a simple breast phantom. The major findings of this
study are listed in the conclusions of Section IV.

A. Imaging System
The imaging enclosure is a cavity shown in Fig. 1. It consists
of 12 vertical panels of microwave substrate soldered to each
other and to a conducting base. Opposing panels are separated
by 15 cm, and the cavity is 17 cm tall. There are three antennas per panel for a total of 36 antennas, designed to operate at
915 MHz in a coupling fluid. Two-port S-parameter measurements are taken with an Agilent PNA-5230A VNA between
antenna pairs. Pair-wise measurements are routed through 18
transmit (T) antennas and 18 receive (R) antennas using two
SP18T solid state switching matrices that connect to Ports 1
and 2, respectively, of the VNA, providing 182 = 324 pair-wise
measurements. T/R antennas alternate around the rows of the
cavity and between the rows as shown in Fig. 4.
The coupling medium is a mixture of isopropyl alcohol and
water designed to couple microwave energy into the breast tissue. Other fluids have been investigated in the literature: safflower oil [34], oil/water emulsion [28], glycerin [35], and acetone [36], to name a few. The medium is usually chosen to
balance conductive loss, relative permittivity, toxicity, antenna
match, and ease of use. An alcohol/water mixture is inexpensive, clean, controllable, and not prohibitively lossy at 915 MHz.
A 20:7 alcohol:water ratio is used. The dielectric properties of
the fluid are measured with the Agilent 85070E dielectric probe
kit; at 915 MHz, the relative permittivity and conductivity are
(r , σ) = (24.5, 0.460 S/m).

HAYNES et al.: REAL-TIME MICROWAVE IMAGING OF DIFFERENTIAL TEMPERATURE FOR THERMAL THERAPY MONITORING

Fig. 4. HFSS CAD model of the cavity. Antenna shading designates transmitter and receiver. Fluid is filled to 0.5 cm below the top.

Because the medium is a mixture, it must be circulated to
prevent separation. An external aquarium pump recirculates the
fluid through a drain in the bottom of the cavity to a nozzle at
the top. The drain consists of seven 3-mm holes, mimicking a
wire mesh, and thus a continuous boundary at 915 MHz. The
fluid exchanges once per minute.
The antennas are bow-tie patch antennas designed originally
to operate at 915 MHz in an oil/water emulsion with (r , σ) =
(23, 0.05 S/m), [27], [37]. In the current coupling medium, the
resonance remains, but the impedance match is degraded to
about −6 dB.
The SP18T switches each consist of one SP16T switch with
two Minicircuits ZYSWA-2-50DR SPDT switches connected
to two of the paths. The SP16T switches are described in [28].
The ensemble is controlled via computer parallel port. Path
isolation is better than 60 dB, except for the Minicircuits switch
paths, which are isolated to 40 dB. Differences in attenuation
between individual paths are not critical, because each path is
individually calibrated.
To maximize the signal to noise ratio, +13-dBm output power
is used, which is the maximum-leveled output power of the
VNA. In addition, the VNA’s two-port testset is configured to bypass the Port 2 receiver (RCVR) coupler. This increases the Port
2 receiver sensitivity, and thus S21 measurements, by +15 dB,
while degrading S12 by −15 dB. However, only S21 is used for
imaging.
B. Imaging Cavity Used as Unknown “Thru”
In order to compare cavity S-parameter measurements to
HFSS and forward scattering predictions (below), a unique twoport calibration is required between every T/R combination, 324
in total. To accelerate the process, we use the two-port unknown
“thru” calibration, [38], [39], wherein the cavity itself provides
“thru” paths for every T/R pair. Thru measurements are spliced
with individual one-port calibrations to complete the calibration
sets (calsets), diagrammed in Fig. 3.

1789

The calibration procedure follows.
1) One-port short-open-load (SOL) calibrations are saved for
each of the 18 transmit and 18 receive paths.
2) The paths are connected to the fluid-filled cavity.
3) A Labview routine selects and switches to a T/R
combination.
4) The VNA loads the one-port SOL calibrations for that
combination, completes the unknown thru measurement,
computes the error terms, and saves the calset.
5) Process repeats at 3).
Excluding the time taken for one-port SOL calibrations, all
324 two-port calsets are completed in 5 min.
Unknown thru calibration is accurate to within the sign of
S12 and S21 . The sign ambiguity is resolved by having rough
knowledge of the corrected thru measurement phase, which we
do by comparing the phase of corrected S12 and S21 to that
predicted by the HFSS cavity model.
The method is validated by comparing cavity measurements
collected with two calibration sets. The first set uses the fluidfilled cavity as the thru, the second set uses a 36-port powerdivider network shown in Fig. 3(b) and (c), respectively. The
divider network is created by connecting three Minicircuits
ZN12PD-252-S+ 1:12 power dividers with a tee. The power divider thru provides nearly equal transmission between all ports,
which is not the case for the cavity. Data collection, switching,
and calset loading are all automated with Labview. We find that
cavity measurements of the incident field S-parameters using
either calibration set are identical to within a sign of S12 and
S21 , confirming that either the cavity or power divider can be
used as a multiway unknown thru standard.
In general, any 36-port device with reasonable transmission
characteristics can be used as the thru; the advantage of using
the cavity itself is that the thru measurements can be repeated
without disassembling the setup. However, recalibration is only
necessary if the system configuration changes. Overall, this addresses for the first time the unsolved problem in microwave
medical imaging of how to efficiently and repeatedly calibrate
multisensor systems for VNA measurements.
C. HFSS Numerical Model
We use Ansys HFSS to numerically model the cavity, similar
to our works in [27] and [28], which requires us to match the
S-parameter reference planes between simulation and experiment. We use HFSS to estimate the incident fields throughout
the cavity, which include all background multiple scattering not
present between the object and the cavity, and are used in the
forward scattering model (below). Fig. 4 shows the HFSS CAD
model; antennas are shaded as transmitters and receivers. Fig. 5
shows the incident field of one antenna. The drain is assumed
to be a continuous copper sheet.
We compare measured and simulated incident S-parameters
to assess the accuracy of the HFSS model. Fig. 6 shows the
magnitude and phase, respectively, of the measured and simulated incident S21 S-parameters. The plots overlay circularsymmetric T/R paths, grouped according to the six row–row
interaction combinations. The groupings from left to right

1790

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

presence of an object is given by [28], [40]

Sj i,sca = C Einc,j (r ) · O(r )Ei (r )dV 

(1)

where Ei is the total object field produced by the transmitter
and Einc,j is the incident field of the receiver.
The object function is defined as
δσ(r)
(2)
b ω
where ω is the operating frequency in radians, and the background permittivity is b = o r b with relative permittivity r b .
The contrasts are given by
O(r) = δ(r) + i

δ(r) =
Fig. 5. Cross cuts of log(|e(E z )|) of the normalized incident field for an
antenna in the middle row. The walls are PEC; the top surface radiates to air.

(r)
−1
b

δσ(r) = σ(r) − σb

(3)
(4)

where σb is the background conductivity, δ(r) is unitless, and
δσ(r) is an absolute measure of conductivity with units of S/m.
The constant is given by, [40]
C=−

(a)

ko2 Zoj
2iωμaio ajo

(5)

where ko is the lossless background wave number, ko2 =
ω 2 μo b , Zoj is the characteristic impedance of the receiver
transmission line, and aio and ajo are the excitations at the Sparameter reference planes of the transmit and receive antennas,
respectively.
When we estimate the cavity fields with HFSS, the constant
simplifies. In simulation, the average transmit power is set to
1 W, thus, the line voltage is


(6)
ao = 2Pave Zo = 2Zo
where the phase of ao is zero because the S-parameter reference
planes of the HFSS model and the cavity are the same. Equation
(5) reduces to
C=−

(b)
Fig. 6. Measured and HFSS incident S-parameters: (a) magnitude and
(b) phase. Symmetric combinations are overlaid and grouped by row–row
interaction.

are: middle–middle, middle–top, middle–bottom, top–top, top–
bottom, bottom–bottom. We plot the data this way to assess the
symmetry of both the cavity measurements and HFSS simulation, as well as compare them. In general, the magnitude agrees
to within 2 dB, and the phase agrees as well as 5◦ but no worse
than 30◦ . Agreement is best between antennas in the same row.

ko2
.
4iωμ

(7)

Finally, in measurement, the scattered field S-parameters are
obtained by subtracting the S-parameters for the total and incident fields
Sj i,sca = Sj i,tot − Sj i,inc .

(8)

To increase the accuracy of (1) when we compare it with
measurement, we normalize both sides by the incident field
S-parameters, careful to distinguish simulation from measurement

eas
Sjmi,sca
C


HFSS 
∼
EHFSS
(r )dV  . (9)
inc,j (r ) · O(r )Ei
eas =
Sjmi,inc
SjHFSS
i,inc
This helps eliminate multiplicative systematic errors, such as
a phase shifts.

D. Forward Scattering Model

E. Differential Scattering

The forward scattering model predicting the scattered field
S-parameter between a transmitter i and receiver j in the

Because the change in the dielectric constant of water due
to temperature is small, we can formulate the inverse scattering

HAYNES et al.: REAL-TIME MICROWAVE IMAGING OF DIFFERENTIAL TEMPERATURE FOR THERMAL THERAPY MONITORING

problem as a perturbation about a background object, where a
distorted-type volume integral equation (VIE) is most natural
[41], [42]. Formulating the inverse scattering problem this way
permits the use of differential total field measurements between
heated and unheated objects, which helps eliminate additive
systematic errors. We further augment the distorted VIE with the
normalizations and multiplying constant of (9). Also, real-time
imaging relies on precomputing the inverse scattering solution,
as described in the next section. This can only be done with a
constant field estimate: two such estimates are provided in this
section.
Let the unheated background object be designated Ob (r), with
total field Eb , and scattered fields Sjbi,sca , and let the heated objected be Oh (r), with total field Eh , and scattered fields Sjhi,sca .
For the case of a differential object measured against a background inhomogeneity, (1) becomes [41]

ΔSj i,sca = C Ebj (r ) · ΔO(r )Ehi (r )dV 
(10)
where the volumetric differential scattering contrast between
the heated and unheated objects is given by
ΔO(r) = Oh (r) − Ob (r)

(11)

and the differential scattered field is given by
ΔSj i,sca = Sjhi,sca − Sjbi,sca = Sjhi,tot − Sjbi,tot .

(12)

The right side of (12) results from cancellation of the incident S-parameters, where Sjbi,tot is the baseline object measurement and Sjhi,tot changes with temperature. Note that Sjbi,tot and
Sjhi,tot are direct measurements.
Two approximations of (10) are possible. The first is the traditional Born approximation (BA), in which the total fields are
equal to the incident field. The second is the distorted Born
approximation (DBA), where Eh = Eb . Both are conceptually
similar: in the BA, the incident fields are those of the empty cavity; in the DBA, the incident fields are those in the background
object. Differential scattered fields for the two cases are given
by

BA
ΔSj i,sca ≈ C Einc,j (r ) · ΔO(r )Einc,i (r )dV  (13)

ΔSjDBA
i,sca ≈ C

Ebj (r ) · ΔO(r )Ebi (r )dV  .

(14)

The choice of approximation depends largely on the information available. The BA requires simulation of only the empty
cavity. The DBA requires knowledge of the total fields in the
background object, and thus the dielectric properties of the unheated object. These properties can be estimated through a full
inverse scattering treatment (e.g., BIM, DBIM, [41]), that simultaneously estimates the total fields. Alternatively, the object
properties can be inferred, for instance, from an MRI study, [43],
after which the total fields are computed with one pass of a fullwave solver that captures object-cavity scattering interactions.
In general, the DBA is preferred because it is the appropriate
approximation for differential scattered field measurements. For
simplicity, we use the BA in the experiments below, and show
that it yields reasonable results.

1791

F. Precomputed Linear Inverse Scattering Solution
The crux of real-time quantitative imaging is precomputing
the inverse scattering solution. This can only be done with a
fixed field approximation, such as before. Linearization consists of discretizing the integral equation, after which the object
is estimated by comparing forward model predictions to differential scattered field measurements. The cost function we use to
measure the difference between forward model predictions and
data is [44]
F (m) = Gm − d2D + m2M .

(15)

The vector norms  · 2D and  · 2M are defined by the inverse
−1
data and model covariance operators, C−1
D and CM , respectively. G is the discretized linear forward operator, the vector d
contains S-parameter measurements, and m is a complex vector
of pixels of the differential object.
The least-squares solution of (15) in matrix form is [44]


−1 −1
 = G∗ C−1
m
G∗ C−1
(16)
D G + CM
D d
 is the object estimate. If the data and image pixels are
where m
separately independent, and the noise and pixel uncertainties are
constant, then the inverse covariance matrices are scalars equal
2
, respectively. Equation (16) reduces to
to 1/σd2 and 1/σm
−1 ∗

 = G∗ G + λ 2 I
Gd
(17)
m
which is the familiar regularized normal equations solution with
Tikhonov parameter λ = σd /σm .
Given an SVD decomposition G = USV∗ , (17) can be written as

where

 = Md
m

(18)

−1

SU∗ .
M = V S2 + λ2 I

(19)

The matrix M, once computed and stored, is applied in real
time to d to obtain a new object estimate.
G. Real-Time Data Processing
We use LabVIEW and MATLAB in tandem to collect the
scattered field measurements and process and display images
in real time. LabVIEW controls the VNA and the switches;
MATLAB processes the data and computes the image. We trigger the VNA to save a single data stream as the switches cycle
through every T/R pair. MATLAB actively checks for new data
files, and then segments the data stream and produces the image.
Details are as follows.
1) VNA Data Stream: All pair-wise scattering parameters
are collected by the VNA in a single measurement. The VNA
triggers a 4000 point, 2.1-s CW measurement at 915 MHz with
an IF bandwidth of 2 kHz. The switches are cycled through
all 324 T/R combinations throughout the duration of the measurement to produce a data stream of S-parameters for all T/R
combinations. 6 ms per path yields approximately ten points per
T/R pair. In actuality, the VNA triggers twice: the first trigger
sources Port 1 to record S11 and S21 , the second trigger sources
Port 2 to record S22 and S12 . As a result, the switches are cycled

1792

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

(a)

(b)

(c)
Fig. 7. VNA data stream of a single two-port S-parameter measurement while
the switching matrix cycles over all 324 T/R combination. Sweep is 4000 points,
2.1 s at 915 MHz. (a) S 1 1 (transmitters) and S 2 2 (receivers). (b) S 2 1 and S 1 2
(30 dB differential from RCVR bypass). (c) Insets of (a) and (b).

twice, and an entire dataset is collected every 4 s. Because the
data stream is a single measurement and captures the response
of all T/R paths, S-parameter error correction must be turned off
and applied in postprocessing.
Fig. 7 shows the magnitude of a raw incident field data stream
of all four S-parameters. S22 and S12 are retrospectively aligned
with S11 and S21 . S11 measures the reflection coefficients of the
transmit antennas, while S22 measures the reflection coefficients
of the receive antennas. Receivers are cycled per transmitter,
hence the 18 × 18 nested pattern in Fig. 7(a). Lower reflection coefficient magnitudes are due to longer uncorrected paths
through the SPDT Minicircuits switches. Fig. 7(b) shows S21
and S12 . S21 is approximately 30 dB higher than S12 , due to
the power level asymmetry created by the Port 2 RCVR coupler
bypass and the fact that error correction is off. Fig. 7(c) shows
insets of the same.
2) S-parameter Error Correction: As mentioned, error correction is turned off during the sweep and applied after segmentation (below). The 12-term error model is given in the
Appendix. The error terms for all T/R 2-port calibrations are
downloaded with LabVIEW using Agilent VNA-SCPI commands. The 12-term model was cross checked against VNAcalibrated datasets, including those from the unknown thru tests,
with identical results.

Technically, all four S-parameters are required in the 12-term
error model, but for imaging we only use S21 . In the equation
for corrected S21 , the contribution of S12 is third order, so it
is safely set to zero since it is already 30 dB lower. In future
work, we will investigate the possibility of treating S11 and S22
as constant in differential scattering scenarios to reduce data
collection time. In initial tests not reported here, we have been
able to refine the data collection to less than 1 s.
3) Data Stream Segmentation: After a new dataset is detected and loaded by MATLAB, the data streams for S11 , S21 ,
and S22 are segmented to extract individual T/R measurements
as follows.
1) Separate real and imaginary parts.
2) Apply a fast 1-D total variation (TV) filter [45]. This
preserves the block-like pattern of the data stream while
smoothing the steps.
3) Compute the next-neighbor discrete difference. Take the
absolute value. Spikes denote segment transitions. The
TV filter is necessary to prevent noise from corrupting
this step.
4) Threshold the combined discrete differences of the real
and imaginary parts.
5) Check for 324 segments; discard the dataset if fewer are
detected.
6) Average the points within a segment, excluding transitions.
7) Apply error correction to the segmented T/R data (see the
Appendix).
8) Correct the S21 phase ambiguity with the HFSS model
(correction is predetermined).
Fig. 8(a) illustrates the segmentation of the real and imaginary
parts of a portion of the S21 data stream. Transition points are
highlighted and excluded. Fig. 8(b) shows the absolute value of
the next-neighbor discrete differences with the threshold. The
threshold was chosen by trial and error.
Because segmentation is based on a discrete-difference, it
is robust to timing inconsistencies. This is important because
the exact number of points per segment can vary due to VNA
triggering, CPU allocation, or parallel port signaling. However,
it is now sensitive to noise, hence the need for the TV filter.
Also, counting errors can occur if two adjacent data are exactly
the same. Practically speaking, this is rare and usually due to bit
errors, and will be handled in future versions of this system.
After segmentation and error correction, data are mapped to
the vector d in (18) and a new image is formed by multiplying
it with the precomputed inverse scattering solution. The entire
postprocessing and image formation sequence takes a fraction
of a second.
III. RESULTS AND DISCUSSION
The target used to create a differential change in dielectric
properties due to a change in temperature is a 4-cm diameter
ping-pong ball that is filled with water and sealed. This is meant
to emulate the size and shape of a thermal therapy focal spot in
this cavity at 915 MHz, which is approximately 3 cm in diameter,
[27]. The target is heated to approximately 55 ◦ C in a water bath

HAYNES et al.: REAL-TIME MICROWAVE IMAGING OF DIFFERENTIAL TEMPERATURE FOR THERMAL THERAPY MONITORING

(a)

1793

(a)

(b)
Fig. 8. Example of segmentation. (a) Real and imaginary parts of S 2 1 , large
circles are transition samples. (b) Threshold of absolute value of next-neighbor
discrete difference.

then placed in the cavity and imaged while it cools. The target
is held with a thin plastic straw and suspended from a piece of
rigid, low-dielectric ROHACELL foam as shown in Fig. 9(a).
As a control, we measure the change in temperature with an
embedded thermistor as the target cools to the ambient cavity
temperature of about 22.5 ◦ C, the plot is shown in Fig. 9(b). In
reality, the time-dependent temperature profile of the target is
more complicated than can be represented by a single thermistor
measurement; improvements to this method are listed in the
conclusion.
In the examples that follow, the thermistor is removed and we
assume that the target cools at the same rate as the control. Also,
the heated object at time zero is taken as the background object.
Thus, we track a differential change in dielectric properties as the
target goes from a higher temperature to lower temperature. This
is the reverse of what occurs in most thermal therapy systems.
We do this for experimental convenience since the temperature
dependence of dielectric constant of water remains the same
whether the water heats up or cools down, which we will detect
as an overall change in scattering contrast.
In addition, although the inversion estimates complex ΔO(r),
we display images of |ΔO(r)|. This is because |ΔO(r)| is a
measure of the overall change in scattering contrast relative to
the background. It avoids ambiguity in simultaneous inversion
of both relative permittivity and conductivity, without the need
to assert stringent a priori relations between them. In its current
form, the inversion obtains the correct sign of the complex contrast for nondifferential images of simple targets. For differential
imaging and the BA, we have found that the inversion can split
the scattering contribution differently between the two prop-

(b)
Fig. 9. (a) Control target: water-filled ping-pong ball with embedded thermistor, shown here cooling in the cavity from approximately 55 ◦ C to 22.5 ◦ C.
(b) Plot of ping-pong ball control target temperature versus time in the cavity.
Dotted line is the ambient temperature of the cavity fluid of 22.5 ◦ C.

Fig. 10. Image of |ΔO(r)| after the target has cooled from 55 ◦ C to 22.5 ◦ C.
The initial heated object is taken as the background object at time zero. The
time series is shown in Fig. 11.

erties for different objects. This issue will be improved upon
in future versions. Despite this, the relation between |ΔO(r)|
and the total scattered field power is conserved through the L2
norm of the cost function. Thus, it is theoretically sufficient to
correlate |ΔO(r)| with temperature to accomplish differential
thermal monitoring provided that the contrast changes. This is
verified empirically in the following examples.
In all the examples that follow, 3-D images of |ΔO(r)| are
computed every 4 s, pixelated at 2 mm. The imaging regions are
cylindrical, and we note that the images are not interpolated.
Example 1: We first image one 4-cm isolated water-filled
ping-pong ball as it cools from 55 ◦ C to about 22.5 ◦ C. This
is the same ball as shown in Fig. 9(a) without the thermistor.

1794

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

(a)

(b)

(c)
Fig. 12. a) Cluster of four targets; only the left target is heated. b) Targets in
the cavity. c) |ΔO(r)| after the water target in clutter has cooled from 55 ◦ C
to 22.5 ◦ C. Cluster with heated target is taken as the background object at time
zero. Time series shown in Fig. 13.
Fig. 11. Time series of |ΔO(r)| for the water target in Fig. 10 as it cools from
55 ◦ C to 22.5 ◦ C over 10 min. Images are formed every 4 s. The heated sphere at
time zero is taken as the background object. Cuts are through the peak contrast.

The heated ball is taken as the background object and the BA is
appropriate for the field estimate. A 3-D slice view of the final
image in the sequence, after the ball has reached the ambient
cavity temperature, is shown in Fig. 10. This represents the
maximum differential change in the scattering contrast. A time
series at {1,4,7,10} min is shown in Fig. 11. The magnitude
of the contrast clearly increases and settles after 10 min. The
sphere is well resolved, demonstrating a resolution of 3–4 cm,
which is in the order of the thermal therapy focal spot size in
this cavity.
Example 2: The same 4-cm water-filled ping-pong ball is
heated and imaged as it cools while in the presence of three other
objects. These objects consist of two water filled ping-pong balls
and a 1-in diameter acrylic sphere that acts as clutter shown in
Fig. 12(a). Again, the BA is used for the fields. This example is
meant to test how well the differential contrast can be detected
under the BA in the presence of clutter. A 3-D slice of the
final image and its time series are shown in Figs. 12(c) and 13,
respectively. The change in contrast with temperature is clearly
visible. The peak contrast is slightly lower than Example 1
and more artifacts are present. The artifacts are likely due to
decreased accuracy of the BA as well as the fact that the imaging
domain encroaches on the near-field of the antennas, where
fields have high spatial gradients. The latter effect can be reduced
with a larger diameter cavity. Overall, this shows that a change
in temperature can be imaged in the presence of clutter and that
the differential measurement successfully subtracted most of the
unwanted object scattering.
Example 3: The final example is a simple breast phantom
with a heated target shown in Fig. 14. The phantom consists

Fig. 13. Time series of |ΔO(r)| for the water target in clutter in Fig. 12(c) as
it cools from 55 ◦ C to 22.5 ◦ C over 10 min. Cuts are through the peak contrast.

of two plastic bottles creating inner and outer chambers. The
inner chamber is filled with the cavity fluid meant to mimic
the dielectric properties of the glandular breast tissue; the outer
chamber is filled with vegetable oil to mimic the lower dielectric
properties of the fatty breast tissue. A 3-D slice view of the final
image and the time series are shown in Figs. 14(c) and 15. The

HAYNES et al.: REAL-TIME MICROWAVE IMAGING OF DIFFERENTIAL TEMPERATURE FOR THERMAL THERAPY MONITORING

1795

Fig. 14. Double chambered breast phantom with vegetable oil and coupling
fluid. Heated target placed in inner chamber. (a) Breast phantom with target. (b)
Phantom in cavity. (c) |ΔO(r)| after the water sphere has cooled. Time series
shown in Fig. 15. Only differential temperature is detected.

target and time-varying contrast are clearly distinguishable. The
peak magnitude is slightly lower than that in examples 1 and
2. Similar to example 2, the decrease in the contrast magnitude
and target blurring is attributed to decreased accuracy of the BA,
with the additional possibility that the heat from the object is
not convected from the immediate surroundings of the target as
it was in the other examples. Still, the ability of the differential
formulation to successfully subtract the background scattering
of the phantom is apparent. It also demonstrates that the BA
is actually sufficient for an object where we might otherwise
expect the BA to fail. Thus, it is reasonable to conclude that
the system, as realized, has met the requirements for practical
thermal monitoring.
To correlate the image with temperature, we compared the
pixel intensity at the center of the detected target in each example
over time against the temperature curve of the control target in
Fig. 9(b). We have normalized the curves in order to compare the
rates of change with time. Again, complete images are formed
every 4 s, from which we take the pixel of peak contrast. As
shown in Fig. 16, we find that the scattering contrast of all three
targets correlates nearly 1:1 with temperature as a function of
time. We can also infer from these plots that the change in
scattering contrast of water is nearly linear with temperature
in the range of hyperthermia temperatures, which is consistent
with the findings in [23]. Furthermore, this relation is observed
across all of the imaged scenarios (sphere, clutter, phantom),
despite using the BA for the field estimate.
To determine the temperature resolution, we fit a fourth-order
polynomial to each of the three pixel intensity curves of Fig. 16,
and compute the standard deviations of the residuals. For Examples {1, 2, 3}, respectively, the standard deviations are σ =

Fig. 15. Time series of |ΔO(r)| for the phantom in Fig. 14(c). Phantom and
heated target are taken as the background object at time zero. Cuts are through
the peak contrast.

Fig. 16. Normalized pixel intensity at the center of the detected target in
Figs. 11, 13, and 15 at every time step plotted against the normalized temperature
of the control target in Fig. 9(b). Pixel intensity rate of change tracks 1:1 with
temperature.

{0.0062, 0.0045, 0.0163}. The temperature resolution is taken
as ΔT = 2σ|T∞ − To |. The temperature of the target ranges
from approximately 55 ◦ C to 22 ◦ C; thus, we conclude that we
can resolve a temperature change in each case to ΔT = {0.41,
0.30, 1.1} ◦ C.
IV. CONCLUSION
We have developed a real-time microwave imaging system to
image differential temperature based on the change in dielectric properties of water with the goal of achieving noninvasive
temperature monitoring for thermal therapy systems.
The system and method consist of a cavity-like imaging
structure that is fully modeled in HFSS and coupled with a

1796

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 6, JUNE 2014

precomputed linear inverse scattering solution. The solution
is applied in real time to a segmented VNA data stream that
captures all pairwise scattered field measurements. VNA calibration of T/R antenna pairs is accelerated by using the cavity
as an unknown thru standard. The system is tested on water
targets with changing temperature. Changes in scattering contrast due to temperature were successfully imaged in cluttered
environments, including a simple breast phantom.
This study has produced five findings: 1) the dielectric change
of water over the hyperthermia temperature range (35 ◦ C–60 ◦ C)
is easily detectable with the proposed noninvasive setup at
915 MHz, 2) real-time microwave imaging of differential temperature is possible within the constraints of microwave thermal
therapy system parameters using a VNA, 3) The spatial resolution of thermal imaging is in the order of the thermal therapy
focal spot size in this cavity, 4) 3-D images of differential temperature can be formed with 1 ◦ C sensitivity at refresh rates of 4 s
or better, 5) the rate of change of scattering contrast magnitude
correlates 1:1 with target temperature for a variety of objects.
Future work will expand on these findings to hone the system
for clinical use. In particular, we will evaluate the sensitivity
of the system in moderate-temperature hyperthermia regimes
(3–8 ◦ C change above the background), as different from the
large temperature gradients used in thermal ablation. We will
investigate integration of this system with a focused microwave
heating system, such as [27]. Also, metrics needed to quantitatively relate differential scattering contrast to absolute temperature will be further developed. This will be done by reexamining
the inverse scattering formulation together with more extensive
empirical testing of dielectric–temperature relationships. In addition, work will also include more detailed temperature mapping of the control target by using multiple thermistors as well
as comparison with theoretical heat-diffusion profiles. We will
also investigate the effects on image quality of having better
knowledge of the object fields through full-wave modeling of
numerically realistic phantoms in order to assess the benefits of
the DBA versus the BA. Finally, faster limits of data collection
and image formation will be investigated. The refresh rate is
limited primarily by the data acquisition system, and initial investigations suggest that the current system can provide refresh
times better than 1 s.
APPENDIX
AVNA 12-TERM ERROR MODEL
Given uncorrected two-port measurements S11m , S21m ,
S12m , and S22m , the corrected S-parameters computed with
the standard 12-term error model are [46]
A [1 + e22 D] − e22 BC
E
B
= [1 + (e22 − e22 ) D]
E
C
= [1 + (e11 − e11 ) A]
E
D [1 + e11 A] − e11 BC
=
E

S11 =

(20)

S21

(21)

S12
S22

(22)
(23)

TABLE I

where
A=

S11m − e00
e10 e01

(24)

B=

S21m − e30
e10 e32

(25)

C=

S12m − e03
e23 e01

(26)

D=

S22m − e33
e23 e32

(27)

E = [1 + e11 A] [1 + e22 D] − e22 e11 BC.

(28)

For convenience, Table I lists the error terms and their corresponding SCPI designations in Agilent PNA-type network
analyzers at the time of publication.
REFERENCES
[1] P. R. Stauffer, “Evolving technology for thermal therapy of cancer,” Int.
J. Hyperthermia, vol. 21, no. 8, pp. 731–744, 2005.
[2] C. J. Diederich, “Thermal ablation and high-temperature thermal therapy:
Overview of technology and clinical implementation,” Int. J. Hyperthermia, vol. 21, no. 8, pp. 745–753, 2005.
[3] J. E. Kennedy, “High-intensity focused ultrasound in the treatment of solid
tumours,” Nature Rev. Cancer, vol. 5, pp. 321–327, 2005.
[4] Y. Ni, S. Mulier, Y. Miao, L. Michel, and G. Marchal, “A review of the
general aspects of radiofrequency ablation,” Abdominal Imag., vol. 30,
no. 4, pp. 381–400, 2005.
[5] Y. Nagata, H. Masahiro, Y. Nishimura, S. Masunaga, M. Mitumori,
Y. Okuno, and M. Fujishiro, “Clinical results of radiofrequency hyperthermia for malignant liver tumors,” Int. J. Radiation Oncol., vol. 38,
no. 2, pp. 359–365, 1997.
[6] B. Hildebrandt, P. Wust, O. Ahlers, A. Dieing, G. Sreenivasa, T. Kerner,
R. Felix, and H. Riess, “The cellular and molecular basis of hyperthermia,”
Crit. Rev. Oncol./Hematol., vol. 43, no. 1, pp. 33–56, 2002.
[7] C. C. Vernon, J. W. Hand, S. B. Field, D. Machin, J. B. Whaley, J. van
der Zee, W. L. J. van Putten, G. C. van Rhoon, J. D. P. van Dijk,
D. G. Gonzalez, F. Liu, P. Goodman, and M. Sherar, “Radiotherapy with
or without hyperthermia in the treatment of superficial localized breast
cancer: Results from five randomized controlled trials,” Int. J. Radiat.
Oncol. Biol. Phys., vol. 35, pp. 731–744, 1996.
[8] R. Hoppe, T. L. Phillips, and M. Roach III, “Hyperthermia,” in Textbook
of Radiation Oncology: Expert Consult. 3rd ed. Amsterdam, The Netherlands: Elsevier, 2010, ch. 74, pp. 1564–1593.
[9] M. Dewhirst, E. L. Jones, T. Samulski, S. Das, O. Craciunescu,
Z. Vujaskovic, C. Li, and L. Prosnitz, “Hyperthermia,” in Clinical Radiation Oncology, L. Gunderson and J. Tepper, Eds., 3rd ed. Philadelphia,
PA, USA: Elsevier-Saunders, 2012, pp. 385–403.
[10] R. Habash, Bioeffects and Therapeutic Applications of Electromagnetic
Energy. Boca Raton, FL, USA: CRC press, 2010.

HAYNES et al.: REAL-TIME MICROWAVE IMAGING OF DIFFERENTIAL TEMPERATURE FOR THERMAL THERAPY MONITORING

[11] K. A. Wickersheim and M. H. Sun, “Fiberoptic thermometry and its applications.,” J. Microw. Power, vol. 22, no. 2, pp. 85–94, 1987.
[12] A. Katzir, H. F. Bowman, Y. Asfour, A. Zur, and C. R. Valeri, “Infrared
fibers for radiometer thermometry in hypothermia and hyperthermia treatment,” IEEE Trans. Biomed. Eng., vol. 36, no. 6, pp. 634–637, Jun. 1989.
[13] T. V. Samulski and P. Fessenden, “Thermometry in therapeutic hyperthermia,” in Methods of Hyperthermia Control. Berlin, Germany: Springer,
1990, pp. 1–34.
[14] J. Gellermann, B. Hildebrandt, R. Issels, H. Ganter, W. Wlodarczyk,
V. Budach, R. Felix, P. U. Tunn, P. Reichardt, and P. Wust, “Noninvasive magnetic resonance thermography of soft tissue sarcomas during
regional hyperthermia,” Cancer, vol. 107, no. 6, pp. 1373–1382, 2006.
[15] J. Gellermann, W. Wlodarczyk, H. Ganter, J. Nadobny, H. Fahling,
M. Seebass, R. Felix, and P. Wust, “A practical approach to thermography in a hyperthermia/magnetic resonance hybrid system: Validation
in a heterogeneous phantom,” Int. J. Radiation Oncol., vol. 61, no. 1,
pp. 267–277, 2005.
[16] D. Denis de Senneville, B. Quesson, and C. T. W. Moonen, “Magnetic
resonance temperature imaging.,” Int. J. Hyperthermia, vol. 21, no. 6,
pp. 515–531, 2005.
[17] K. Hynynen and N. McDannold, “MRI guided and monitored focused
ultrasound thermal ablation methods: a review of progress,” Int. J. Hyperthermia, vol. 20, no. 7, pp. 725–737, 2004.
[18] S. K. Das, E. A. Jones, and T. V. Samulski, “A method of MRI-based
thermal modelling for a RF phased array,” Int. J. Hyperthermia, vol. 17,
no. 6, pp. 465–482, 2001.
[19] B, Arnal, M. Pernot, and M. Tanter, “Monitoring of thermal therapy based
on shear modulus changes: II. Shear wave imaging of thermal lesions,”
IEEE Trans. Ultrason., Ferroelect. Frequency Control, vol. 58, no. 8,
pp. 1603–1611, Aug. 2011.
[20] R. L. Nasoni, T. Bowen, W. G. Connor, and R. R. Sholes, “In vivo temperature dependence of ultrasound speed in tissue and its application
to noninvasive temperature monitoring,” Ultrason. Imag., vol. 1, no. 1,
pp. 34–43, 1979.
[21] R. M. Arthur, W. L. Straube, J. W. Trobaugh, and E. G. Moros, “Noninvasive estimation of hyperthermia temperatures with ultrasound,” Int. J.
Hyperthermia, vol. 21, no. 6, pp. 589–600, 2005.
[22] I. V. Larina, K. V. Larin, and R. O. Esenaliev, “Real-time optoacoustic
monitoring of temperature in tissues,” J. Phys. D, vol. 38, no. 15, pp. 2633–
2639, 2003.
[23] P. M. Meaney, M. W. Fanning, K. D. Paulsen, D. Li, S. A. Pendergrass,
Q. Fang, and K. L. Moodie, “Microwave thermal imaging: Initial in vivo
experience with a single heating zone,” Int. J. Hyperthermia, vol. 19, no. 6,
pp. 617–641, 2003.
[24] P. M. Meaney, T. Zhou, M. W. Fanning, S. D. Geimer, and K. D. Paulsen,
“Microwave thermal imaging of scanned focused ultrasound heating:
Phantom results,” Int. J. Hyperthermia, vol. 24, no. 7, pp. 523–536, 2008.
[25] K. S. Cheng, V. Stakhursky, P. Stauffer, M. Dewhirst, and S. K. Das,
“Online feedback focusing algorithm for hyperthermia cancer treatment,”
Int. J. Hyperthermia, vol. 23, no. 7, pp. 539–554, 2007.
[26] B. Behnia, M. Suthar, and A. G. Webb, “Closed loop feedback control
of phased array microwave heating using thermal measurements from
magnetic resonance imaging,” Concepts Magn. Resonance, vol. 15, no. 1,
pp. 101–110, 2002.
[27] J. Stang, M. Haynes, P. Carson, and M. Moghaddam, “A preclinical system
prototype for focused microwave thermal therapy of the breast,” IEEE
Trans. Biomed. Eng., vol. 59, no. 9, pp. 2431–2438, Sep. 2012.
[28] M. Haynes, J. Stang, and M. Moghaddam, “Microwave breast imaging
system prototype with integrated numerical characterization,” J. Biomed.
Imag., vol. 2012, art. ID 706365, pp. 1–18, 2012.

1797

[29] V. Komarov, S. Wang, and J. Tang, “Permittivity and measurements,”
Encyclopaedia RF Microw. Eng., vol. 308, pp. 1–20, 2005.
[30] V. Komarov and J. Tang, “Dielectric permittivity and loss factor of tap
water at 915 MHz,” Microw. Opt. Technol. Lett., vol. 42, no. 5, pp. 419–
420, Sep. 2004.
[31] M. Lazebnik, M. C. Converse, J. H. Booske, and S. C. Hagness, “Ultrawideband temperature-dependent dielectric properties of animal liver tissue
in the microwave frequency range,” Phys. Med. Biol., vol. 51, pp. 1941–
1955, 2006.
[32] M. Lazebnik, L. McCartney, D. Popovic, C. B. Watkins, M. J. Lindstrom,
J. Harter, S. Sewall, A. Magliocco, J. H. Booske, M. Okoniewski, and
S. C. Hagness, “A large-scale study of the ultrawideband microwave dielectric properties of normal breast tissue obtained from reduction surgeries,” Physics Med. Biol., vol. 52, pp. 2637–2656, 2007.
[33] J. C. Bolomey, L. Jofre, and G. Peronnet, “On the possible use of
microwave-active imaging for remote thermal sensing,” IEEE Trans. Microw. Theory Techn., vol. 31, no. 9, pp. 777–781, Sep. 1983.
[34] M. A Al-Joumayly, S. M. Aguilar, N. Behdad, and S. C. Hagness, “Dualband miniaturized patch antennas for microwave breast imaging,” IEEE
Antennas Wireless Propag. Lett., vol. 9, pp. 268–271, Mar. 2010.
[35] P. M. Meaney, M. W. Fanning, L. Dun, S. P. Poplack, and K. D. Paulsen,
“A clinical prototype for active microwave imaging of the breast,” IEEE
Trans. Microw. Theory Techn., vol. 48, no. 11, pp. 1841–1853, Nov. 2000.
[36] J. Stang, “A 3D active microwave imaging system for breast cancer screening,” Ph.D. dissertation, Dept. Elect. Comp. Eng., Duke Univ., Durham,
NC, USA, 2008.
[37] J. Stang and W. T. Joines, “Tapered microstrip patch antenna array for
microwave breast imaging,” IEEE MTT-S Int. Microw. Symp. Dig., Jun.
2008, pp. 1313–1316.
[38] A. Ferrero and U. Pisani, “Two-port network analyzer calibration using
an unknown “thru”,” IEEE Microw. Guided Wave Lett., vol. 2, no. 12,
pp. 505–507, Dec. 1992.
[39] S. Rehnmark, “On the calibration process of automatic network analyzer systems,” IEEE Trans. Microw. Theory Techn., vol. MTT-22, no. 4,
pp. 457–458, Apr. 1974.
[40] M. Haynes and M. Moghaddam, “Vector green’s function for S-parameter
measurements of the electromagnetic volume integral equation,” IEEE
Trans. Antennas Propagation, vol. 60, no. 3, pp. 1400–1413, Mar. 2012.
[41] W. C. Chew, Waves and Fields in Inhomogeneous Media. New York,
NY, USA: IEEE, 1995.
[42] W. C. Chew and Y. M. Wang, “Reconstruction of two-dimensional permittivity distribution using the distorted Born iterative method,” IEEE.
Trans. Med. Imag., vol. 9, no. 2, pp. 218–225, Jun. 1990.
[43] E. Zastrow, S. K. Davis, M. Lazebnik, F. Kelcz, B. D. Van Veen, and
S. C. Hagness, “Development of anatomically realistic numerical breast
phantoms with accurate dielectric properties for modeling microwave interactions with the human breast,” IEEE Trans. Biomed. Eng., vol. 55,
no. 12, pp. 2792–2800, Dec. 2008.
[44] A. Tarantola, Inverse Problem Theory. Philadelphia, PA, USA: SIAM,
2005.
[45] I. W. Selesnick and I. Bayram, “Total variation filtering,” White paper,
NYU-Poly, 2010.
[46] D. Rytting, “Network analyzer error models and calibration methods,”
White paper, Infineon Technologies AG, Santa Clara, CA, USA, Sep.
1998.

Authors’ photographs and biographies not available at the time of publication.

