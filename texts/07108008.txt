IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

2465

A Segmentation Algorithm for Quantitative Analysis
of Heterogeneous Tumors of the Cervix
With 18F-FDG PET/CT
Wei Mu, Zhe Chen, Wei Shen, Feng Yang, Ying Liang, Ruwei Dai, Ning Wuâˆ— , and Jie Tianâˆ— , Fellow, IEEE

Abstractâ€”As positron-emission tomography (PET) images have
low spatial resolution and much noise, accurate image segmentation is one of the most challenging issues in tumor quantification.
Tumors of the uterine cervix present a particular challenge because of urine activity in the adjacent bladder. Here, we propose
and validate an automatic segmentation method adapted to cervical tumors. Our proposed methodology combined the gradient
field information of both the filtered PET image and the level set
function into a level set framework by constructing a new evolution
equation. Furthermore, we also constructed a new hyperimage to
recognize a rough tumor region using the fuzzy c-means algorithm
according to the tissue specificity as defined by both PET (uptake)
and computed tomography (attenuation) to provide the initial zero
level set, which could make the segmentation process fully automatic. The proposed method was verified based on simulation and
clinical studies. For simulation studies, seven different phantoms,
representing tumors with homogenous/heterogeneousâ€”low/high
uptake patterns and different volumes, were simulated with five
different noise levels. Twenty-seven cervical cancer patients at different stages were enrolled for clinical evaluation of the method.
Dice similarity coefficients (DSC) and Hausdorff distance (HD)
were used to evaluate the accuracy of the segmentation method,
while a Blandâ€“Altman analysis of the mean standardized uptake value (SUVmean) and metabolic tumor volume (MTV) was
used to evaluate the accuracy of the quantification. Using this
Manuscript received December 23, 2014; revised May 9, 2015; accepted
May 9, 2015. Date of publication May 14, 2015; date of current version
September 16, 2015. This work was supported by the National Basic Research Program of China (973 Program) under Grant 2011CB707700, the
National Natural Science Foundation of China under Grant 81227901, Grant
61231004, the Chinese Academy of Sciences Fellowship for Young International Scientists under Grant 2013Y1GB0005, the National High Technology
Research and Development Program of China (863 Program) under Grant
2012AA021105, the â€œGuangdong Province-Chinese Academy of Sciencesâ€
comprehensive strategic cooperation program under Grant 2010A090100032
and Grant 2012B090400039, the NSFC-NIH Biomedical collaborative research
program under Grant 81261120414, the Beijing Natural Science Foundation
under Grant 4132080, the Fundamental Research Funds for the Central Universities under Grant 2013JBZ014, the National Basic Research Program of
China under Grant 61301002 and Grant 61302025, the Chinese Academy of
Sciences Visiting Professorship for Senior International Scientists under Grant
2010T2G36, and the Chinese Academy of Sciences Key deployment program
under Grant KGZD-EW-T03. Asterisk indicates corresponding author.
W. Mu, Z. Chen, W. Shen, R. Dai are with the Key Laboratory of Molecular
Imaging, Institute of Automation, Chinese Academy of Sciences.
F. Yang is with the School of Computer and Information Technology, Beijing
Jiaotong University.
Y. Liang is with the Cancer Institute and Hospital, Chinese Academy of
Medical Sciences.
âˆ— N. Wu is with the Cancer Institute and Hospital, Chinese Academy of
Medical Sciences, Beijing 100190, China (e-mail: cjr.wuning@vip.163.com).
âˆ— J. Tian is with the Key Laboratory of Molecular Imaging, Institute of Automation, Chinese Academy of Sciences, Beijing 100190, China (e-mail: tian@
ieee.org).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2433397

method, the DSCs and HDs of the homogenous and heterogeneous
phantoms under clinical noise level were 93.39 Â± 1.09% and
6.02 Â± 1.09 mm, 93.59 Â± 1.63% and 8.92 Â± 2.57 mm, respectively. The DSCs and HDs in patients measured 91.80 Â± 2.46%
and 7.79 Â± 2.18 mm. Through Blandâ€“Altman analysis, the SUVmean and the MTV using our method showed high correlation
with the clinical gold standard. The results of both simulation and
clinical studies demonstrated the accuracy, effectiveness, and robustness of the proposed method. Further assessment of the quantitative indices indicates the feasibility of this algorithm in accurate
quantitative analysis of cervical tumors in clinical practice.
Index Termsâ€”Cervical tumor segmentation, Fuzzy-C-Means
(FCM), improved level set method, Positron-emission tomography/computed tomography (PET/CT) images.

I. INTRODUCTION
ERVICAL cancer was the third most common cancer and
the fourth most common cause of cancer death in women
worldwide in 2012 [1]. Accurate diagnosis of cervical cancer
is very important. Positron-emission tomography/computed tomography (PET/CT) has played an important role in oncology
because of its high specificity and sensitivity. As a noninvasive functional imaging modality, PET can reflect the metabolic
characteristics of the tumors at the molecular level, especially
the quantitative analysis characteristic can provide diagnostic
information and assist in planning therapy.
One of the most widely used indices for uptake quantification
in PET images is the standardized uptake value (SUV), which
quantifies the metabolism of tumors by measuring the 18 F-FDG
uptake within the tumor region and normalizing to the dosage
of injected 18 F-FDG and a scale factor representing the patientâ€™s
size (such as body weight or body surface area). Another important index is the metabolic tumor volume (MTV), which
has been proved to be an independent prognostic factor for tumor recurrence in patients with cervical cancer [2]. Recently,
another series of semiquantitative indices, textural parameters,
focusing on describing the relationships between the intensity
of the voxels and their spatial position within the region of interest (ROI) [3], have been shown to reflect the heterogeneity
of tumors, and can be used to predict therapy response [4] and
patient outcome [5]. Unfortunately, although some of these indices are robust to segmentation, some are greatly dependent on
the accurate delineation of the target volumes [6]. In addition,
the definition of the tumor boundary plays a vital role in radiation therapy, which is a common treatment in oncology. On the
one hand, the boundary should be kept as compact as possible
to minimize damage to the nearby healthy tissues. On the other

C

0018-9294 Â© 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2466

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

hand, the boundary must include the entire extent of the tumors
[7]. In clinical practice, the widely used segmentation method
is manually delineation by physicians. However, this method
is time consuming and subjective, and the introduced interobserver variance causes difficulty in comparing the quantitative
indices acquired in different institutions. Therefore, automatic
and accurate segmentation is desirable.
Currently, the segmentation methods for PET images are divided into four main categories. First, due to the nature of PET
images (i.e., low spatial resolution but high contrast), thresholdbased segmentation techniques are proposed, and become the
most widely used methods mainly because of their simplicity
of implementation and use. These methods are usually divided
into two main groups: fixed thresholding and adaptive thresholding. For fixed thresholding, the common used thresholds are
SUV = 2.5 and 40% of the SUVmax (the maximum SUV of
the ROI) in clinical use [8]. For adaptive thresholding, many
techniques try to find a more optimal threshold by minimizing the intraclass variance (i.e., Otsu method [9]), or applying
an iterative thresholding method based on calibrated thresholdâ€“
volume curves at varying S/B ratio acquired through phantoms
[10]â€“[12]. Nevertheless, finding an optimal threshold is still a
challenging task for threshold-based segmentation techniques.
Second, taking advantage of the fuzzy boundaries of uptake regions in PET images, a series of methods based on fuzzy set
theory have been developed, such as fuzzy-c-means (FCM) [13],
fuzzy locally adaptive Bayesian [14], [15], fuzzy connectedness,
and fuzzy hidden Markov models [16], [17]. These methods are
quite suitable for fuzzy boundaries, and usually perform well on
the segmentation of PET images. Third, region-based segmentation methods, which include region growing [18] and graphbased [19] methods, also attract much attention. Most of these
methods are based on the assumption that the lesions should
be homogeneous [20], and may not obtain a satisfied results on
heterogeneous tumors usually. Therefore, many researches are
focused on improving the traditional region-based method to
adapt to the heterogeneous tumors in recent years, and some of
them obtained stratified results [21]. The fourth kind of methods, represented by level set and active contours [22]â€“[25], are
based on the boundary of the object. Though how to locate the
boundaries in the noisy and low-resolution PET images is challenging, these methods could overcome the restricted condition
of homogeneity and obtain more accurate results.
Compared to other tumors, cervical tumor segmentation
presents more challenges because the tumor is isoattenuating
to the normal cervical stroma on CT images [26], and the urine
in the adjacent bladder has a similar signal intensity to the tumor on PET images [27]. It is difficult to localize the tumor
from CT images and to isolate the tumor region from the effect of the bladder on PET images with most of the present
algorithms alone. Until now, there is a little literature concerning the cervical tumor segmentation. Miller and Grigsby
used the traditional threshold-based segmentation techniques,
but manual ROI placement to eliminate the bladder was needed
in many cases [28]. Roman-Jimenez et al. proposed a fusionand Gaussian-mixture-based classification (FGMC) method to
separate the bladder and tumor semiautomatically on the basis

of visual interpretation [29]. ArboneÌ€s et al. applied a level set
method based on the Chanâ€“Vese (CV) model [30] to delineate
heterogeneous PET-positive areas, but postprocessing was also
needed to exclude the bladder [31].
In this study, we propose a cervical tumor segmentation algorithm that can separate the bladder automatically and delineate
the cervical tumor accurately. This method consists of two major steps: first, recognizing the rough tumor region (RTR) on a
newly constructed hyperimage according to the tissue specificity
to provide the initial contour of the tumor; second, delineating
the accurate boundaries of the cervical tumor with an improved
level set method based on the gradient fields of the PET image and the level set function (LSF). The proposed method is
validated on both phantom simulation and clinical studies to
demonstrate its effectiveness and robustness.
II. MATERIALS AND METHODS
A. CV Model
The traditional level set method is suitable for the delineation
of the heterogeneous and multicentric PET-positive volumes, as
it can represent contours of complex topology and handle topological changes during evolution, such as merging of multiple
regions. As a typical region-based active contour model, the CV
model [30] is widely used in segmentation. This model extracts
the objects by minimizing the Mumfordâ€“Shah [32] energy function using region properties in a level set framework, and the
LSF evolution equation is
âˆ‚Ï†
= Î´(Ï†)
âˆ‚t


Ã— Î± Â· div(âˆ‡Ï†/|âˆ‡Ï†|) âˆ’ v âˆ’ Î»1 (I âˆ’ c1 )2 + Î»2 (I âˆ’ c2 )2
(1)
where Ï† is the LSF, I is the image data (i.e., the PET images in
this work), Î±, Î½, Î»1 , and Î»2 are positive parameters. c1 and c2
are the average intensities of the regions inside and outside of
the zero level set, respectively,

c1 (Ï†) = average(I(Ï† > 0))
(2)
c1 (Ï†) = average(I(Ï† < 0))
which can be expressed as follows:
	
âŽ§
Â· H(Ï†(x)) dx
âŽª
Î© I(x)
âŽª
	
âŽª
âŽ¨ c1 (Ï†) =
H(Ï†(x))
dx
Î©
	
âŽª
Â· (1 âˆ’ H(Ï†(x))) dx
âŽª
âŽª c2 (Ï†) = Î© I(x)
	
âŽ©
Î© (1 âˆ’ H(Ï†(x))) dx
where Î© is the domain of the image, and H is
âŽ§
1
âŽª
âŽª
âŽ¨
HÎµ (z) = 0
âŽª
âŽª
âŽ©
1/2 [1 + z/Îµ + 1/Ï€sin(Ï€z/Îµ)]

(3)

if z > Îµ
if z < Îµ
if|z| < Îµ.
(4)

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2467

Fig. 1. Top left corners of (a) and (c) are the slices of the Gaussian-filtered PET images, and the top left corners of (b) and (d) are their gradient fields. The main
parts of the four figures are the corresponding partial enlargements of the areas enclosed by the red squares.

The Dirac delta function Î´ is approximated by the following
smooth function Î´Îµ [33]:
âŽ§


 
âŽ¨ 1 1 + cos Ï€x , |x| â‰¤ Îµ
Îµ
Î´Îµ (x) = 2Îµ
(5)
âŽ©
0,
|x| > Îµ.
However, due to the accumulation of the urine, the cervical
tumor has similar signal intensity to the adjacent bladder on PET
images. Therefore, the classical CV model cannot separate the
bladder and tumor. That is to say, when the evolution reaches the
convergence, the segmentation results may include the bladder.
Therefore, an improvement is greatly desired.
B. Modified Level Set Method
The level set method delineates the contour by the zero level
set in higher dimension, and formulates the motion of the contour as the evolution of the LSF [34]. For a given initial contour
(i.e., the zero level set, ZLS), the evolution should push the zero
level set to the boundary of the object. Given the fact that the
centers of the bladder lumen and the tumor have a higher intensity than the periphery on the Gaussian filtered PET images
[see Fig. 1(a) and (c)], the gradient fields of the boundary of
the bladder and tumor should be opposite [see Fig. 1(b) and
(d)]. Therefore, an evolution equation adapted to cervical tumor
segmentation could be constructed as follows:


âˆ‚Ï†(x)
= âˆ’Î» (IÏƒ âˆ’ c1 )2 + (IÏƒ âˆ’ c2 )2
âˆ‚t
Â·tanh( cot < âˆ‡Ï†(x), âˆ‡IÏƒ > ) Â· sgn(Î´Îµ 1 (Ï†)) (6)
where IÏƒ represents the Gaussian filtered PET images using
a Gaussian kernel with a standard deviation Ïƒ, Î» > 0, < âˆ— >

stands for the angle between the two vectors (within the range
of 0â€“Ï€), and | âˆ— | stands for the magnitude of the vector. The
definition of c1 and c2 are similar to CV model, and can be
represented as the following equations in the 3D PET image
segmentations:
	
âŽ§
y, z) Â· HÎµ 2 (Ï†(x, y, z))dxdydz
âŽª
Î© IÏƒ (x,
âŽª
	
âŽª
âŽ¨ c1 (Ï†) =
Î© HÎµ 2 (Ï†(x, y, z))dxdydz
	
âŽª
IÏƒ (x, y, z) Â· (1 âˆ’ HÎµ 2 (Ï†(x, y, z)))dxdydz
âŽª
âŽª
	
.
âŽ© c2 (Ï†) = Î©
Î© (1 âˆ’ HÎµ 2 (Ï†(x, y, z)))dxdydz
(7)
The term sgn(Î´[Ï†]) is to ensure the expansion is performed
in the narrow band around the ZLS. In order to regularize the
LSF, Gaussian filter is applied after each iteration according to
[35]
Ï† = GÏƒ âˆ— Ï†

(8)

where GÏƒ is a Gaussian kernel also with a standard deviation
Ïƒ as the aforementioned, and âˆ— stands for the convolution operation. The initial function Ï†0 is a binary step function, and
defined by

c0 ,
if x âˆˆ R0
Ï†0 (x) =
(9)
âˆ’c0 , otherwise
where c0 is a positive constant (we set c0 to 2 in this study), and
R0 is the area inside the initial contour of tumor.
The curve of the evolution function
L = tanh ( cot(Î¸)),
as plotted in Fig. 2, has the following properties:

(10)

2468

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

The final LSF can be obtained by the aforesaid iterative process, and the voxels within the region where Ï• > 0 are extracted.
The step length Î”t was set to equal to Ïƒ in our study.
C. Automatic Definition of the Initial Tumor Contour
In order to define the initial tumor contour (i.e., ZLS), the
RTR is needed to be recognized first. Taking advantage of the
fuzzy boundaries of uptake regions in PET images, the FCM
algorithm could be used. The FCM method was proposed by
Dunn [36] and later improved by Bezdek [37]. In general, the
FCM method divides the image into c clusters by minimizing
the following objective function:
JFCM =

N 
C


(uij )m xi âˆ’ cj 2 , 1 â‰¤ m < âˆž

(13)

i=1 j =1

Fig. 2.

Curve of the function L.

1) For Î¸ within 0â€“Ï€/2, which means the gradient field of
IÏƒ and the LSF is coincident, the sign of this function is
positive. The smaller the angle is, the larger the increment
of L is.
2) For Î¸ within the range of Ï€/2â€“Ï€, which means the gradient
fields of IÏƒ and the LSF is opposite, the expansion of the
ZLS will be stopped. The larger the angle is, the larger the
decrement of L is.
At the beginning of the evolution, the voxels of the narrow
band around the ZLS has similar intensities with the voxels
inside of the initial contour, making the magnitude adjustment
term {âˆ’Î»(I âˆ’ c1 )2 + (I âˆ’ c2 )2 } positive, which is similar to
the CV model. At the same time, the gradient fields of the LSF
and the IÏƒ around the ZLS are coincident, and L is also positive.
Both of the two positive terms increase the LSF, and the ZLS
could expand. The smaller the angle is, the larger the increment
of the LSF is, and the larger the probability of the expansion of
the ZLS is. When the ZLS reaches the boundary of the tumor
and the bladder, the magnitude adjustment term is positive, but
L is negative for the gradient fields of LSF and IÏƒ around the
ZLS are opposite. Therefore, the expansion of the ZLS will be
stopped. When the ZLS reaches the boundary of the tumor and
the background, L is near to zero, and the magnitude adjustment
term is negative. Both of them can ensure the termination of the
expansion more effectively at the boundary of the tumors.
Finally, the largest connected region constituted by the voxels, whose LSFs are positive, is the ROI. By applying median
filtering, we can delineate the cervical tumor.
The aforesaid evolution equation can be implemented with
a finite-difference scheme. Considering the 3-D case, the timedependent LSF Ï†(x, y, z, t) can be given in discretized form
Ï†ni,j,k with spatial index (i, j, k) and temporal index n. Then, (6)
can be discretized as the following finite-difference equation:
+1
âˆ’ Ï†ni,j,k
Ï†ni,j,k

Î”t

= L(Ï†ni,j,k )

(11)

which can be expressed as follows:
+1
= Ï†ni,j,k + Î”t Â· L(Ï†ni,j,k ), n = 0, 1, 2, ...
Ï†ni,j,k

(12)

where xi is the ith measured data of dimension d, cj is the
d-dimension center of the jth cluster, uij is the degree to which
data element xi belongs to cluster cj , m is the factor to adjust the
membership degree weighting effect (m = 2 in this study), and
âˆ— stands for the Euclidian norm. The fuzzy clustering result is
calculated by iteratively optimizing this objective function with
the update of uij and cj by
uij =

C
k =1



1
x i âˆ’c j 
x i âˆ’c k 

 m 2âˆ’1 ,

N
cj =

m
i=1 uij xj
N
m
i=1 uij

, 1 â‰¤ i â‰¤ N, 1 â‰¤ j â‰¤ C.

(14)



The iteration will not stop until maxij ukij+1 âˆ’ ukij  < Îµ,
where Îµ is the termination criterion within the range of 0â€“1
(10âˆ’5 was used in our study), and k is the iteration steps.
According to the tissue specificity, which refers to the fact
that bladder content and the cervical tumor have similar degrees
of FDG uptake compared with other surrounding tissues, but
different structural information due to different levels of attenuation on CT, we could construct a hyperimage utilizing both
the metabolic and anatomic information. For each voxel of this
hyperimage, three features are considered: the SUV normalized to the SUVmax on PET images, the Hounsfield unit (HU)
density values normalized to the maximum HU values on CT
images, and the product of the aforesaid two features. Then, the
constructed hyperimage can be divided into four regions (see
Fig. 3) based on the tissue specificity: 1) a region with high
SUV and moderate HU that corresponds to the tumor (regions
delineated in blue); 2) a region with high SUV and low HU
that corresponds to the bladder contents (regions delineated in
green); 3) a region with low SUV and moderate HU that corresponds to the other soft tissues (regions delineated in red); and
4) a region with low SUV and low HU that corresponds to the
background.
The detailed description of the proposed methodology to define the initial tumor contour is given as follows.
1) Localization of the cervical tumor: The whole PET images
were processed by Gaussian filtering. Then, SUVpeak (a
local average SUV value in a group of voxels surrounding

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2469

commonly used in clinical practice) [8] in the RTR were
regarded as R0 in the initial LSF Ï†0 to ensure the inclusion
of the all the center of the tumor.
D. Datasets and Validation

Fig. 3. Diagram of the four different kinds of regions in the constructed
hyperimage.

2)

3)

4)

5)

6)

the voxel with SUVmax [38]) of each slice along the axial
direction was calculated, and the corresponding curve was
smoothed and plotted as Fig. 4(a). The slices corresponding to the two adjacent valleys in front of and after the last
significant peaks [pointed by the red arrows in Fig. 4(a)]
were the slices including cervical tumor. Similarly, the
SUVpeak of each slice along the coronal and sagittal directions could also be obtained, and the slices between
two adjacent valleys in front of and after the main peaks
[pointed by the red arrows in Fig. 4(b) and (c)] were used
to define a smaller region (as Fig. 3).
Constructing the hyper-image: The construction needed
to up sample the PET images to CT resolution first so that
each voxel in PET images corresponded to only one voxel
in CT images. Then, the hyperimage was constructed using the normalized SUV, HU, and their product.
Separation of the RTR: The constructed hyperimage was
partitioned into four clusters using the FCM method. For
each of the obtained clusters, a simple morphological operation (erosion and dilation with a proper kernel) was
performed, and the largest connected component was extracted.
Distinction of the RTR: In order to find the RTR from the
four clusters, the mean attribute values of each cluster was
calculated. The cluster with the largest sum of the SUV
and HU was the RTR in our study. For some exceptional
cases, we needed to consider the location of each cluster
as the cervix is close to the back of the body.
Determination of the final RTR: Given that the obtained
RTR may include the bladder wall, as it has similar intensity with the tumor both in CT images and PET images due
to their similar attenuation and the partial volume effect,
an erosion operation was performed. Then, we acquired
the final RTR by down sampling to the PET resolution.
Definition of the initial tumor contour: The voxels
with SUV larger than 40% of the SUVmax (threshold

1) Phantom Simulation Study: Since it is difficult to obtain
the ground truth in PET imaging, phantom simulations were
used to validate the efficiency of segmentation methods. We
used a part of an anthropomorphic abdomen phantom containing a urinary bladder and a cervix, which was derived from a
whole-body CT scan of a human patient. In order to verify the
efficiency and robustness of the proposed method, we simulated
both homogeneous and heterogeneous tumors, whose groundtruth segmentations were available from CT images.
a) Homogeneous Tumor Phantoms: The SUV of the background compartment (the normal part of the cervix) was set to
0.5. Two spheres with 4-voxel radii (with volumes of 268 voxels)
representing tumors were both set with SUVs equal to 4, making tumor-to-background ratios (TBRs) equal to 8, and bladder
lumen-to-tumor ratios (BTRs) equal to 1 and 2. Another two tumors, represented by spheres with 6-voxel radii (with volumes
of 905 voxels) were set with SUVs equal to 8, making TBRs
equal to 16, and BTRs equal to 1 and 2. These four phantoms
were referred to phantom a, b, c, and d, respectively.
b) Heterogeneous Tumor Phantoms: To isolate the effects
of tumor shape and homogeneity, we created three irregularly
shaped tumor phantoms of different volumes (349, 934, and
2105 voxels) with an averaged intensity histogram generated
from 27 clinical cervical tumors, which were represented by
phantom e, f, and g, respectively. Each voxel of the simulated
tumors was chosen randomly to have an SUV drawn from this
histogram [39]. The shape and volume of the tumors were based
on clinical PET images. The simulation of the bladder was
similar to that of the tumor. The SUV of the cervix was set to
10% of the SUVmin of the tumor.
The simulation, which was done with a PET camera (ECAT
EXACT HR+, CTI Siemens, Knoxville TN, USA), was reconstructed using the ordered subsets expectation maximization algorithm with five iterations, and the anisotropic resolution was
5.47 mm Ã— 5.47 mm Ã— 3.27 mm. Considering the noise in the
raw PET data (i.e., the sinogram data), we used a common noise
model to simulate the noise in the simulation study as follows:
S âˆ— = S + Ïƒ Ã— N (0, 1),

(15)

where S is the simulated noise-free raw PET data, S âˆ— is the simulated noise raw PET data, and N(0,1) represents the standard
normal distribution. Assuming the measurement noise is subject
to a Poisson distribution, Ïƒ can be modeled by

S
Ïƒ=Î±
,
(16)
Î”T
where Î± is a proportionality constant that determines the noise
level and Î”T is the scan time. In our study, Î± was set to 0,
0.4, 0.8, 1.0, and 1.2, and 20 realizations for each noise level
were simulated. Fig. 5 illustrated the simulation results of the

2470

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

Fig. 4. Per-slice SUVpeak of a PET scan, where the horizontal axis indicates the slice number along the axial, coronal, and sagittal directions, respectively, the
vertical axis represents the SUVpeak of the corresponding slice. The slices between the two red arrows include the cervical tumor.

Fig. 5.

Simulation results of the homogenous and heterogeneous phantoms on different noise levels before Gaussian filtering.

homogenous and heterogeneous phantoms on different noise
levels before Gaussian filtering.
2) Clinical PET/CT Studies: This retrospective study was
approved by the institutional review board of Cancer Institute
and Hospital, Chinese Academy of Medical Sciences, and the
absence of informed consent was also approved for the anonymous analysis of the data. Clinical PET/CT datasets were from
27 patients with squamous cell carcinoma of the uterine cervix at
different stages. Patients had been injected with 200â€“400 MBq
of 18 F-FDG, depending on body weight. The PET/CT images
(GE Discovery ST16 PET-CT, GE Healthcare, Milwaukee WI,
USA) were acquired 50â€“90 min after the intravenous administration of the radioactive tracer. Each PET acquisition measured 128 Ã— 128 Ã— 207 voxels with anisotropic resolution of
5.47 mm Ã— 5.47 mm Ã— 3.27 mm, while each CT acquisition
measured 512 Ã— 512 Ã— 207 voxels with anisotropic resolution
of 0.98 mm Ã— 0.98 mm Ã— 3.27 mm.
The PET images were converted into SUV by normalizing
the activity of the voxel to the dosage of injected 18 F-FDG and
the patient body weight. The ground-truth segmentations were
constructed by averaging the segmentations results delineated
by two experienced physicians.

3) Evaluation Criteria: To evaluate the accuracy of the segmentation, two common metrics, dice similarity coefficient
(DSC) [40], and Hausdorf distance (HD) [41] were used to
perform direct comparison between the segmented volume and
the ground truth.
Assuming the autosegmented tumor and the ground truth are
denoted by U1 and U2 , respectively. DSC is expressed as follows:
DSC(U1 , U2 ) = 2
=

|U1 âˆ© U2 |
|U1 | + |U2 |

2 Â· TPFV
(FPVF + TPVF) + (FNVF + TPVF)
(17)

where TPVF, FPVF, and FNVF stands for the true positive,
false positive, and false negative volume fractions, respectively.
This metric measures the spatial overlap between the segmented
object and the ground truth. The higher the DSC is, the more
accurate the segmentation method is.
HD is a metric that measures the distance of the most mismatched boundary points between the segmented tumor and the

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2471

Fig. 6. Mean DSCs and HDs and the relative standard deviations obtained over different phantoms using the LSâ€“GF method (a)â€“(g) at different noise levels.
(a)â€“(d) are homogeneous phantoms with different radii, TBRs and BTRs: (a) four voxels, 8:1,1:1; (b) four voxels, 8:1, 2:1; (c) six voxels, 16:1,1:1; (d) six voxels,
16:1. 2:1. (e)â€“(g) are heterogeneous phantoms with volumes of 349, 934, and 2,105 voxels, respectively.

ground truth, and is defined as follows:
HD(X, Y ) = H(âˆ‚U1 , âˆ‚U2 )


= max sup inf d(x, y), sup inf d(x, y)
xâˆˆX y âˆˆY

y âˆˆY xâˆˆX

(18)
where âˆ‚ denotes the boundary of segmented volumes such that
X = âˆ‚U1 and Y = âˆ‚U2 , d is the Euclidean distance between x
and y, sup and inf denote supremum and infimum. As a shape dissimilarity metric, the lower HD means the segmented volumes
has a more similar shape to the ground truth, which indicates
that the segmentation method is more accurate.
To evaluate the accuracy of the quantification of the cervical
tumors based on the proposed method, the clinically significant
quantitative measures, the SUVmean (the mean SUV of the delineated volume) and the MTV obtained from the autosegmented
tumors were compared with the reference values obtained from
the ground-truth segmentation using Blandâ€“Altman analysis,

which calculates the mean and 95% confidence interval (CI) of
the difference.
III. EXPERIMENTS AND RESULTS
The proposed method was implemented in Matlab R2012a on
a desktop with an Intel(R) Core(TM) i5â€“650 @ 3.20-GHz CPU
using 4 GB of RAM, and the reconstruction of the simulated
PET images was implemented in Matlab R2012a on an Intel(R)
Xeon(R) CPU E5â€“2420 v2 @ 2.20 GHz-CPU using 32 GB of
RAM.
We compared the proposed method with several traditional
methods, such as the classical level set method based on CV
models, the traditional fixed thresholding method using 40% of
the SUVmax (T40%), the Otsu method [9], and random walk
(RW) [19]. Given the segmentation results obtained by the CV
method may include the bladder, which leads to the inaccurate
quantitative analysis, we compared it with our method (hereafter, referred to as the â€œLSâ€“GF methodâ€) in qualitative. Given

2472

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

Fig. 7. Quantitative comparison of the DSCs and HDs among different methods using different RTRs on heterogeneous phantom g. The horizontal axis, RTR%
represents for the area of RTR/area of cervix Ã—100%, the vertical axis of (a) represents the mean and standard deviation of DSCs of the 20 realizations of phantom
g at noise 0.4, and the vertical axis of (b) represents the mean and standard deviation of HDs.

the T40%, Otsu, and RW methods did not possess the ability to
separate tumor from the bladder lumen, we performed them in
the cervix region for the quantitative comparison.
A. Phantom Simulation Study
Since the simulated tumor was placed in the area of the eroded
cervix, we regarded the eroded cervix as the RTR, and the phantom simulation study was mainly used to evaluate the proposed
LSâ€“GF method in terms of delineating the cervical tumor. Similarly, T40%, Otsu, and RW methods were also performed in
the cervix of the simulated PET images.
Fig. 6 displays the mean DSCs, HDs, and the corresponding
standard deviations of the 20 realizations for each phantom at
different noise levels using the proposed method. As the figure
illustrates, the proposed LSâ€“GF method performs better with
DSC rates higher than 90% for the larger simulated tumors
(phantoms c, d, f, and g), while the HDs are less than 11 mm
(about 2 voxel) at all noise levels. For the smaller simulated
tumors (phantoms a, b, and e), the proposed method can obtain
nice results with DSC larger than 90% and HD smaller than
11 mm at the low noise levels.
In order to present the improvement of the proposed LSâ€“GF
method compared to traditional level set method, we performed
the two methods on the same case with the same ZLS under
a series of different iteration numbers, which was shown in
Fig. 8(a). From this figure, we can see that the evolution of
the proposed method could be stopped at the boundary of the
tumor adjacent to the bladder, while the CV model could not.
The segmentation results obtained with the proposed method
and other three different methods based on simulated phantom
g are given in Fig. 9(a), from which we can see the edge of the
segmentation result obtained by the proposed method is more
closely to the gold standard.
The quantitative comparisons of different methods based on
homogeneous phantoms and heterogeneous phantoms are listed
in Tables I and II. It is apparent that the proposed method performs well for both homogeneous and heterogeneous phantoms

with DSCs high than 92% and DSCs less than 11 mm, which
is much better than the other three methods under all of the different noise levels. At the same time, Studentsâ€™ t-test was also
performed to validate the significance of the proposed method.
For both the homogeneous and heterogeneous phantoms, the
differences of DSCs and HDs are statistically significant at
all the different noise levels: between the LSâ€“GF and T40%
(p < 0.05), between the LSâ€“GF and RW (p < 0.05), and between the LSâ€“GF and Otsu (p < 0.05).
The aforeasaid experiments were performed assuming that
the RTR was appropriate, including the entire tumor but excluding the bladder, which is difficult to achieve using current
algorithms in clinical use. The RTR is usually obtained with erosion to exclude the signal produced by the bladder, which may
cause the RTR to be too small to include the entire object. The
dependence on RTR of these methods should be evaluated. We
extracted RTRs of different sizes from the cervix in our study,
and performed a group of experiments based on these RTRs.
Fig. 7 shows the quantitative comparison of the mean DSCs and
HDs obtained by the different methods on different RTRs on the
heterogeneous phantom with the largest tumor at clinical noise
level (i.e., Î± = 0.4).
From this figure, we find that even when the RTR is very small
(40% of the real cervix mask), the proposed LSâ€“GF method also
gives a good result (the DSC is nearly 90%) compared to other
methods (the DSC is less than 80%), which means our method
is more robust for different RTRs.
B. Clinical PET/CT Studies
The automatic recognition method of the RTR based on the
improved FCM method was satisfactory in 24 of 27 datasets.
For the other three cases that part of the tumor was excluded, R0
could be substituted by rough manual delineation, which did not
affect the final segmentation results. Based on the extracted R0 ,
the proposed LSâ€“GF method produced satisfactory segmentation results in all of the clinical studies. The cervix region that
the other three methods were performed in was segmented from

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2473

Fig. 8. Qualitative comparisons of the evolution results under different iteration numbers between the proposed LSâ€“GF method and the traditional level set
method based on CV model: (a) and (b) are the segmentation results based on simulated phantom g at noise 0.4; (c) and (d) are the segmentation results based on
a clinical case.

Fig. 9. Cervical tumor segmentation results (delineated in blue) obtained with different methods in simulated phantom g at noise 0.4 (a) and three different
clinical cases (b)â€“(d). For each case from left to right: a random slice of input PET images, the gold standard and the corresponding segmentation by our LSâ€“GF
method, T40%, Otsu, and RW.

2474

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

TABLE I
QUANTITATIVE COMPARISONS OF DIFFERENT METHODS ON HOMOGENEOUS PHANTOMS UNDER DIFFERENT NOISE LEVEL

@

@
@

Noise 0
P-value
Noise 0.4
P-value
Noise 0.8
P-value
Noise 1.0
P-value
Noise 1.2
P-value
âˆ—

DSC(%)

HD(mm)

LS-GF

T40%

Otsu

RW

LS-GF

T40%

Otsu

RW

93.23 Â± 1.32

92.10 Â± 0.21
< 10 âˆ’6 âˆ—
91.02 Â± 0.61
< 10 âˆ’6 âˆ—
90.40 Â± 1.57
1.50 Ã— 10 âˆ’2 âˆ—
88.13 Â± 1.91
6.57 Ã— 10 âˆ’6 âˆ—
85.95 Â± 4.00
< 10 âˆ’6 âˆ—

89.45 Â± 2.69
< 10 âˆ’6 âˆ—
90.56 Â± 1.94
< 10 âˆ’6 âˆ—
88.71 Â± 1.91
< 10 âˆ’6 âˆ—
86.42 Â± 2.82
< 10 âˆ’6 âˆ—
86.48 Â± 4.37
3.96 Ã— 10 âˆ’3 âˆ—

88.36 Â± 1.41
< 10 âˆ’6 âˆ—
90.38 Â± 1.41
< 10 âˆ’6 âˆ—
90.24 Â± 1.75
1.74 Ã— 10 âˆ’5 âˆ—
88.13 Â± 1.91
6.65 Ã— 10 âˆ’4 âˆ—
85.95 Â± 4.00
< 10 âˆ’6 âˆ—

6.02 Â± 1.09

7.71 Â± 0
< 10 âˆ’6 âˆ—
7.71 Â± 0
< 10 âˆ’6 âˆ—
11.05 Â± 8.81
1.50 Ã— 10 âˆ’2 âˆ—
16.19 Â± 8.75
< 10 âˆ’6 âˆ—
20.40 Â± 10.94
< 10âˆ’6 âˆ—

7.71 Â± 0
3.37 Ã— 10 âˆ’6 âˆ—
7.71 Â± 0
3.92 Ã— 10 âˆ’5 âˆ—
14.93 Â± 9.30
5.56 Ã— 10 âˆ’4 âˆ—
22.26 Â± 11.21
< 10 âˆ’6 âˆ—
23.47 Â± 11.87
1.07 Ã— 10 âˆ’6 âˆ—

7.71 Â± 0
9.08 Ã— 10 âˆ’6 âˆ—
7.71 Â± 0
7.73 Ã— 10 âˆ’5 âˆ—
11.05 Â± 8.81
1.10 Ã— 10 âˆ’3 âˆ—
16.14 Â± 8.75
7.54 Ã— 10 âˆ’6 âˆ—
20.40 Â± 10.94
3.96 Ã— 10 âˆ’6 âˆ—

93.39 Â± 1.09
91.71 Â± 2.34
90.40 Â± 2.49
88.67 Â± 2.83

6.02 Â± 1.09
7.27 Â± 1.42
7.88 Â± 0.60
9.08 Â± 0.27

The difference between the T40% (or Otsu, RW) and the LS-GF is significant at the 0.05 level.

TABLE II
QUANTITATIVE COMPARISONS OF DIFFERENT METHODS ON HETEROGENEOUS PHANTOMS UNDER DIFFERENT NOISE LEVEL

@

@
@

Noise 0
P-value
Noise 0.4
P-value
Noise 0.8
P-value
Noise 1.0
P-value
Noise 1.2
P-value
âˆ—

DSC(%)

HD(mm)

LS-GF

T40%

Otsu

RW

LS-GF

T40%

Otsu

RW

93.07 Â± 2.00

90.91 Â± 2.32
2.38Ã—10âˆ’5 âˆ—
90.84 Â± 2.53
< 10âˆ’6 âˆ—
87.87 Â± 2.36
< 10âˆ’6 âˆ—
86.58 Â± 2.74
< 10âˆ’6 âˆ—
83.95 Â± 4.35
< 10âˆ’6 âˆ—

90.77 Â± 2.10
< 10âˆ’6 âˆ—
91.55 Â± 1.54
< 10âˆ’6 âˆ—
89.86 Â± 3.35
< 10âˆ’6 âˆ—
88.61 Â± 3.48
7.76Ã—10âˆ’5 âˆ—
87.01 Â± 6.63
2.65Ã—10âˆ’4 âˆ—

90.60 Â± 2.60
2.53Ã—10âˆ’6 âˆ—
91.36 Â± 1.74
< 10âˆ’6 âˆ—
89.68 Â± 2.29
< 10âˆ’6 âˆ—
87.94 Â± 3.00
< 10âˆ’6 âˆ—
87.53 Â± 3.54
< 10âˆ’6 âˆ—

8.64 Â± 2.84

12.74 Â± 3.12
< 10âˆ’6 âˆ—
13.18 Â± 2.84
< 10âˆ’6 âˆ—
12.47 Â± 4.92
1.78Ã—10âˆ’6 âˆ—
14.39 Â± 2.08
4.99Ã—10âˆ’6 âˆ—
15.04 Â± 3.83
< 10âˆ’6 âˆ—

10.12 Â± 1.91
< 10âˆ’6 âˆ—
10.61 Â± 2.73
1.26 Ã— 10âˆ’6 âˆ—
10.77 Â± 4.32
< 10âˆ’6 âˆ—
14.44 Â± 2.46
3.63 Ã— 10âˆ’6 âˆ—
14.60 Â± 4.38
1.20 Ã— 10âˆ’3 âˆ—

9.35 Â± 1.86
4.70 Ã— 10âˆ’3 âˆ—
9.35 Â± 1.86
0.039 âˆ—
10.99 Â± 4.70
10âˆ’6 âˆ—
13.73 Â± 2.79
2.60 Ã— 10âˆ’3 âˆ—
16.14 Â± 1.26
< 10âˆ’6 âˆ—

93.59 Â± 1.63
92.02 Â± 2.88
90.93 Â± 3.35
89.27 Â± 3.66

8.92 Â± 2.57
9.08 Â± 2.14
10.75 Â± 2.95
10.94 Â± 2.73

The difference between the T40% (or Otsu, RW) and the LS-GF is significant at the 0.05 level.

the CT images by a semiautomated Skeleton cuts method [42],
and the segmentation results obtained by the three methods were
based on the best parameters for our datasets.
Fig. 8(c) and (d) show the segmentation results of the clinical
cases based on the proposed LSâ€“GF method and the traditional
level set method. Similar to the simulation studies, we could
also find that the proposed method could separate the tumor
from the adjacent bladder while the CV model could not.
Another series of qualitative comparisons between the proposed method and the T40%, Otsu, RW are provided in
Fig. 9(b)â€“(d), which shows the initial PET images of three typical patients and their corresponding segmentation results. Tumor b represents the tumors with obvious heterogeneity, tumor
c has the similar intensity with the bladder, while the concentration of bladder is much higher than tumor d. Segmentations
of both tumors c and d are affected by the adjacent bladders to a
large extent. Due to the heterogeneity, the segmentation results
of T40% method only include part of the tumors. Due to the
partial volume effect, the segmentation results of the other three
methods include the signal of the bladder. In brief, our method
brings more competitive results than others.
In order to test the robustness of the LSâ€“GF method, quantitative comparisons of the DSC and HD between it, T40%,
Otsu, RW, and the standard reference of the 27 clinical datasets
with the gold standard are shown in Table III. We can see that
our LSâ€“GF method produces an obviously larger DSC (more

TABLE III
QUANTITATIVE COMPARISON OF DIFFERENT METHODS ON CLINICAL STUDIES
Method

DSC (%)

HD (mm)

LS-GF
T40%
P-value
Otsu
P-value
RW
P-value

91.80 Â± 2.46
67.00 Â± 12.90
< 10âˆ’6 âˆ—
80.48 Â± 6.78
1.13 Ã— 10 âˆ’6 âˆ—
82.10 Â± 5.50
2.34 Ã— 10 âˆ’5 âˆ—

7.79 Â± 2.18
15.59 Â± 10.78
6.41 Ã— 10 âˆ’4 âˆ—
16.24 Â± 9.17
2.32 Ã— 10âˆ’4 âˆ—
13.87 Â± 7.12
7.23 Ã— 10 âˆ’3 âˆ—

âˆ—
The difference between the T40% (or Otsu, RW) and the LS-GF is
significant at the 0.05 level.

than 90%, which is generally accepted as excellent) and smaller
HD (5.61â€“9.97 mm, about 1â€“2 voxel), while the DSCs of other
methods are less than 85%, and the HDs are more than 11 mm
(2 voxel). The Studentâ€™s t-test of the DSCs and HDs between
the LSâ€“GF method and T40% (p < 0.05), Otsu (p < 0.05), RW
(p < 0.05) both indicated significant differences.
Additionally, the LSâ€“GF method has the smallest standard
deviation, which means it was stable across all the 27 tested
clinical studies.
Figs. 10 and 11 show the Blandâ€“Altman analysis of the
SUVmean and the MTV obtained from different methods performed on the 27 clinical datasets versus the reference values. As

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2475

Fig. 10. Blandâ€“Altman plots of the difference of the SUVmean of tumors obtained by different automatic methods and the gold standard. The red solid line is the
zero difference line. (a)â€“(d) show the SUVmean agreement between the LSâ€“GF method, T40% method, Otsu method, RW method, and gold standard, respectively.

illustrated in Fig. 10(a), Blandâ€“Altman analysis of SUVmean
obtained by the proposed method compared with the gold standard shows 96% (26 of 27) points within 1.96 SDs (i.e., the 95%
limits of agreement), with a bias of 0.10 and 1.96 SD limits of
agreement of âˆ’0.24 and 0.43. Fig. 10(b)â€“(d) show the Blandâ€“
Altman analysis of SUVmean obtained by the T40% method,
Otsu method, and RW method compared with gold standard.
Only the Otsu method has 96% points within CI, with the bias,
and the Â±1.96 SD of 0.27, âˆ’0.77, and 1.32, respectively. Fig. 11
gives the Blandâ€“Altman analysis of MTV obtained by the proposed method and the other three methods compared with the
gold standard. For the proposed method shown in Fig. 11(a),
only one difference outside the 95% limits of agreement, the bias
is only âˆ’1.67 cm3 , and the 1.96 SD is âˆ’16.37 to 13.10 cm3 . All
of the rest three plots also have 96% points within CI, with biases of âˆ’39.70 cm3 , âˆ’15.90 cm3 , âˆ’16.03 cm3 , and the Â±1.96
SD of âˆ’98.84 and 19.45 cm3 , âˆ’67.71 and 35.90 cm3 , âˆ’57.18
and 25.12 cm3 , respectively. From the aforesaid description,
we can find that both the proposed method and the Otsu method
have a good agreement with the gold standard, but the proposed
method produces the smallest bias. Additionally, according to
Figs. 10(a) and 11(a), the max absolute differences of SUVmean
and MTV within the CI are âˆ’0.14 and âˆ’16.37 cm3 (both represented by solid blue circles), which are negligible compared
to the corresponding average values 3.54 and 104.9 cm3 , and
are acceptable in clinical practice. Therefore, we can conclude

that our method has the best agreement with the gold standard
compared to other three methods.
IV. DISCUSSION
In this paper, we have proposed an automatic cervical tumor
segmentation algorithm for the delineation of cervical tumors in
PET/CT images. This method can be summarized as follows: 1)
the construction of a novel evolution equation based on gradient
fields to delineate the object automatically; 2) the construction
of a hyperimage utilizing the anatomical and metabolic information to define the initial contour of the tumor. Owing to the
aforesaid innovations, we were able to segment cervical tumors
accurately and automatically, which is clinically relevant. Furthermore, we have also evaluated the feasibility of this algorithm
in clinical practice by assessing the quantitative indices.
For the proposed LSâ€“GF method, two hyperparameters, i.e., Î»
and Ïƒ, need to be determined for a given c0 (c0 = 2 in our study).
In fact, the larger the Î» is, the larger the probability that the voxel
belongs to the background is, which results to partitioning the
fuzzy boundary of the tumor to the background with larger
probability. In other words, the segmented tumor is smaller. On
the contrary, the smaller the Î» is, the larger the segmented tumor
is, which is shown in Fig. 12. Therefore, it is important to set Î»
properly. The choice of Î» is influenced by the quality of the PET
image and the size of the tumor. In real clinical applications, a

2476

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

Fig. 11. Blandâ€“Altman plots of the difference of the MTV of tumors obtained by different automatic methods and gold standard versus the mean of the two
variables. The red solid line is the zero difference line. (a)â€“(d) show the MTV agreement between the LSâ€“GF method, T40% method, Otsu method, RW method,
and the gold standard, respectively.

Fig. 12. Relationship between Î» and the size of the segmented tumor on the
clinical datasets. The horizontal axis represents the different value of Î», and the
vertical axis represents the ratio of the segmented tumor volume to the gold
standard.

certain amount of training datasets (five random patients were
chosen in this study) are needed to find the proper Î». For different
Î», the mean DSCs and HDs can be obtained as shown in Fig. 13.
From this figure, we could find when Î» was set around 0.5,
we could obtain nice results with larger DSC and smaller HD.
Additionally, because of the introduction of the Gaussian filter,
the effect of the noise on LSâ€“GF method is largely removed,

especially for larger tumors, which can be seen from Fig. 6.
Even if the image is degenerated seriously at noise level of 1.2 as
Fig. 5, we could also obtain an acceptable segmentation results.
In order to investigate the effect of the standard deviation Ïƒ,
we performed additional experiments using a series of different
Ïƒ values on five random clinical datasets. The obtained mean
DSCs, HDs, and the corresponding standard deviations of five
random patients under different Ïƒ are shown in Fig. 14. The
figure illustrates that when Ïƒ was set within the range [0.5, 1],
the DSCs approached greater than 90% (accepted as excellent),
and the HDs are also small (about 1â€“2 voxels) and stable.
Tables Iâ€“III show that our method gives a much better results both in simulated studies and clinical studies compared to
traditional T40%, Otsu, and RW methods, and the differences
between our method and the traditional methods are statistically
significant based on the Studentâ€™s t-test both in the simulated
studies at all the different noise levels and the clinical studies,
which means the improvement of the new method is significant.
However, when comparing the three tables, we can find that all
the four methods perform well in the simulated studies. This is
because the RTRs in the simulated studies include little signal
of the bladder in our simulation, since the original intent of the
simulation studies is to validate the accuracy of the method in
the isolated tumors without the effect of the surrounding tissues.
However, due to the short distance between the bladder and the
cervix and the partial volume effect in the clinical studies, the

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

2477

Fig. 13. Profiles of mean DSCs and HDs obtained under different Î». The horizontal axis stands for Î», the vertical axis of (a) represents the mean and standard
deviation of DSCs of the five cases, and the vertical axis of (b) represents the mean and standard deviation of HDs obtained from the five cases.

Fig. 14. Mean DSCs and HDs of the random five cases obtained under different Ïƒ. The horizontal axis stands for sigma, the vertical axis of (a) represents the
mean and standard deviation of DSCs, and the vertical axis of (b) represents the mean and standard deviation of HDs obtained from the five cases.

border of the cervix may include the signal belonging to bladder,
which means, even if the RTR is exactly the accurate cervix, the
three traditional methods T40%, Otsu, and RW might not delineate the tumor accurately, as illustrated by the segmentation
results shown in Fig. 9(c) and (d). This effect can be decreased
by the erosion of RTR, which may lead to the RTR too small to
include the whole tumor. However, the three traditional methods could only be performed in the given region, which leads to
insufficient segmentations. On the contrary, the LSâ€“GF method
achieves the final segmentation by expanding the ZLS centered
on the RTR, and acting on the whole image rather than just the
given regions, which could guarantee the sufficient segmentation under the premise of excluding the bladder. Fig. 7 shows the
quantitative comparison between these methods using different
RTRs. Therefore, no matter how small the RTR is, the proposed
method could obtain good results as long as RTR includes all
the centers of the tumor.
Due to the introduction of the L term into the classical CV
model, the proposed method possesses the advantage of separating the tumor and bladder automatically. Fig. 8 shows the
detailed evolution processes of the proposed method and the
classical CV model, from which we can see the LSâ€“GF method

could exclude the bladder lumen successfully when the method
achieves the convergence compared to traditional CV models.
In other words, another important improvement of the proposed
method is its automatic separating capacity besides its accuracy.
To validate the clinical application significance of the proposed method, we conducted indirect comparison of clinically
significant quantitative measures SUVmean and MTV with
Blandâ€“Altman plots. From Figs. 10 and 11, we can find that
the proposed method produces the smallest bias and standard
deviation, and more than 95% points are within the consistent interval. Additionally, the max absolute differences of SUVmean
and MTV within the consistent interval are too small (only
3.95% and 15.6%) to be neglected compared to the corresponding average values. In brief, the proposed method has a high
agreement with the clinical gold standard, and can be applied in
clinical cervical tumor segmentation.
The most common used method in the CC segmentation is the
traditional threshold-based segmentation techniques. However,
the interactive morphologic operation and manual operation are
needed to eliminate the bladder for every cases as Miller and
Grigsby used [28], which is time consuming and subjective.
Subsequently, Roman-Jimenez et al. proposed a semiautomatic

2478

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 10, OCTOBER 2015

Fig. 15. Cervical tumor segmentation results obtained with different methods of two typical clinical cases. The red part means the tumor while the green part
means the bladder. For each case from left to right are: the gold standard, the corresponding segmentation by Arbonesâ€™s Method and our LSâ€“GF method.

method by combining the region-growing adaptive threshold
method (RGAT) and fusion- and Gaussian-mixture-based classification (FGMC) method to separate the bladder and tumor. On
the one hand, the RGAT suffers from poor reproducibility [43];
on the other hand, it was necessary to decide whether to perform FGMC visually for each case. In addition, the voxel seed,
the location of which may affect the final segmentation results,
was needed to be selected by interactive program. Compared to
the aforesaid methods, our method could obtain the final segmentation results automatically and quickly without interactive
manual interpretation, which is meaningful for the following
quantitative analysis of large datasets. Recently, ArboneÌ€s et al.
proposed an automatic tumor segmentation in cervical cancer
based on the CV models and post-processing [31]. This method
obtains the final tumor through detecting and removing the bladder from the positive areas (i.e., the results of the CV method).
The detection of the bladder is based on the assumption that it
is the largest segmented object. When we tested this method on
one of our clinical dataset whose tumor is larger than the bladder in the positive areas, we found this method may confuse
the bladder and tumor, such as Fig. 15(a2). Additionally, this
method only segmented part of the tumors in many of our cases,
such as Fig. 15(b2). Moreover, this method performs poor on
our datasets due to the low resolution. Though it could obtain the
tumor through interpolation, it takes much longer time (about
40 min) compared to our method (about 4 s) for every cases
under the same environment. Therefore, our method performs
better both in accuracy and efficiency.
This method could also work well in the experiments of
segmenting rectum cancer, which is also affected by the adjacent bladder in some cases. For other pathologies, such as
lung tumors with heart or mediastinum physiological uptake

and head and neck tumors with nearby uptake, the proposed
LSâ€“GF method could also work well based on the accurate initial contour. It should be noted that the automatic definition of
the initial contour based on the FCM may not be applicable
because of the different tissue specificities, which needs further
study in the future.
V. CONCLUSION
An automatic segmentation algorithm for the quantitative
analysis of cervical tumors was proposed and evaluated. Experiments on both phantom and clinical studies demonstrate the
accuracy, effectiveness, and robustness of the LSâ€“GF method.
Further assessment of the quantitative indices indicates the feasibility of this method for accurate quantitative analysis of cervical
tumors in clinical practice.
REFERENCES
[1] I. A. f. R. o. Cancer, World Cancer Report 2014, Lyon, France: International Agency for Research on Cancer Press, 2014.
[2] B. S. Kim et al., â€œThe prognostic value of the metabolic tumor volume in
FIGO stage IA to IIB cervical cancer for tumor recurrence: Measured by
F-18 FDG PET/CT,â€ Nucl. Med. Mol. Imag., vol. 45, pp. 36â€“42, 2011.
[3] S. Chicklore et al., â€œQuantifying tumour heterogeneity in 18F-FDG
PET/CT imaging by texture analysis,â€ Eur. J. Nucl. Med. Mol. Imag.,
vol. 40, pp. 133â€“140, 2013.
[4] I. El Naqa et al., â€œExploring feature-based approaches in PET images for predicting cancer treatment outcomes,â€ Attern Recog., vol. 42,
pp. 1162â€“1171, 2009.
[5] M. Hatt et al., â€œ18F-FDG PET uptake characterization through texture
analysis: Investigating the complementary nature of heterogeneity and
functional tumor volume in a multi-cancer site patient cohort,â€ J. Nucl.
Med., vol. 56, pp. 38â€“44, 2015.
[6] M. Hatt et al., â€œRobustness of intratumour 18F-FDG PET uptake heterogeneity quantification for therapy response prediction in oesophageal
carcinoma,â€ Eur. J. Nucl. Med. Mol. Imag., vol. 40, pp. 1662â€“1671, Oct.
1, 2013.

MU et al.: SEGMENTATION ALGORITHM FOR QUANTITATIVE ANALYSIS OF HETEROGENEOUS TUMORS OF THE CERVIX

[7] M. MacManus et al., â€œUse of PET and PET/CT for radiation therapy
planning: IAEA expert report 2006â€“2007,â€ Radiother. Oncol., vol. 91,
pp. 85â€“94, 2009.
[8] U. Nestle et al., â€œPractical integration of [18 F]-FDG-PET and PET-CT in
the planning of radiotherapy for non-small cell lung cancer (NSCLC): The
technical basis, ICRU-target volumes, problems, perspectives,â€ Radiother.
Oncol., vol. 81, pp. 209â€“225, 2006.
[9] N. Otsu, â€œA threshold selection method from gray-level histograms,â€ Automatica, vol. 11, pp. 23â€“27, 1975.
[10] L. Drever et al., â€œIterative threshold segmentation for PET target volume
delineation,â€ Med. Phys., vol. 34, pp. 1253â€“1265, 2007.
[11] J. A. van Dalen et al., â€œA novel iterative method for lesion delineation and
volumetric quantification with FDG PET,â€ Nucl. Med. Commun., vol. 28,
pp. 485â€“493, 2007.
[12] W. Jentzen et al., â€œSegmentation of PET volumes by iterative image thresholding,â€ J. Nucl. Med., vol. 48, pp. 108â€“114, 2007.
[13] S. Belhassen and H. Zaidi, â€œA novel fuzzy C-means algorithm for unsupervised heterogeneous tumor quantification in PET,â€ Med. Phys., vol. 37,
pp. 1309â€“1324, 2010.
[14] M. Hatt et al., â€œA fuzzy locally adaptive Bayesian segmentation approach
for volume determination in PET,â€ IEEE Trans. Med. Imag., vol. 28, no.
6, pp. 881â€“893, Jun. 2009.
[15] M. Hatt et al., â€œAccurate automatic delineation of heterogeneous functional volumes in positron emission tomography for oncology applications,â€ Int. J. Radiation Oncol. Biol. Phys., vol. 77, pp. 301â€“308, May 1
2010.
[16] M. Hatt et al., â€œFuzzy hidden Markov chains segmentation for volume determination and quantitation in PET,â€ Phys. Med. Biol., vol. 52,
p. 3467, 2007.
[17] Y. Guo et al., â€œAutomatic lung tumor segmentation on PET/CT images
using fuzzy Markov random field model,â€ Comput. Math. Method Med.,
vol. 2014, art. id. 401201, 6 pages, 2014. doi: 10.1155/2014/401201
[18] E. Day et al., â€œA region growing method for tumor volume segmentation
on PET images for rectal and anal cancer patients,â€ Med. Phys., vol. 36,
pp. 4349â€“4358, 2009.
[19] U. Bagci et al., â€œJoint segmentation of anatomical and functional images:
Applications in quantification of lesions from PET, PET-CT, MRI-PET,
and MRI-PET-CT images,â€ Med. Image Anal., vol. 17, pp. 929â€“945, 2013.
[20] B. Foster et al., â€œA review on segmentation of positron emission tomography images,â€ Comput. Biol. Med., vol. 50, pp. 76â€“96, 2014.
[21] F. Hofheinz et al., â€œAn automatic method for accurate volume delineation
of heterogeneous tumors in PET,â€ Med. Phys., vol. 40, p. 082503, 2013.
[22] M. Abdoli et al., â€œContourlet-based active contour model for PET image
segmentation,â€ Med. Phys., vol. 40, p. 082507, 2013.
[23] D. Markel et al., â€œNovel multimodality segmentation using level sets and
Jensen-ReÌnyi divergence,â€ Med. Phys., vol. 40, p. 121908, 2013.
[24] C.-Y. Hsu et al., â€œAutomatic segmentation of liver PET images,â€ Comput.
Med. Imag Graph., vol. 32, pp. 601â€“610, 2008.
[25] X. Geets et al., â€œA gradient-based method for segmenting FDG-PET
images: Methodology and validation,â€ Eur. J. Nucl. Med. Mol. Imag.,
vol. 34, pp. 1427â€“1438, Sep. 1, 2007.
[26] H. K. Pannu et al., â€œCT evaluation of cervical cancer: Spectrum of disease
1,â€ Radiographics, vol. 21, pp. 1155â€“1168, 2001.

2479

[27] K.-P. Wong et al., â€œImproved derivation of input function in dynamic
mouse [18 F] FDG PET using bladder radioactivity kinetics,â€ Mol. Imag.
Biol., vol. 15, pp. 486â€“496, 2013.
[28] T. R. Miller and P. W. Grigsby, â€œMeasurement of tumor volume by PET
to evaluate prognosis in patients with advanced cervical cancer treated by
radiation therapy,â€ Int. J. Radiat. Oncol., vol. 53, pp. 353â€“359, 2002.
[29] G. Roman-Jimenez et al., â€œSegmentation and characterization of tumors
in 18F-FDG PET-CT for outcome prediction in cervical cancer radiochemotherapy,â€ presented at the Image-Guidance and Multimodal Dose
Planning in Radiation Therapy: A MICCAI Workshop, Nice, France, 2012.
[30] T. F. Chan and L. A. Vese, â€œActive contours without edges,â€ IEEE Trans.
Image Process., vol. 10, no. 2, pp. 266â€“277, Feb. 2001.
[31] D. R. ArboneÌ€s et al., â€œAutomatic FDG-PET-based tumor and metastatic
lymph node segmentation in cervical cancer,â€ in Proc. SPIE Med. Imag.,
2014, pp. 903441â€“903441â€“8.
[32] D. Mumford and J. Shah, â€œOptimal approximations by piecewise smooth
functions and associated variational problems,â€ Commun. Pure Appl.
Math., vol. 42, pp. 577â€“685, 1989.
[33] C. Li et al., â€œDistance regularized level set evolution and its application to image segmentation,â€ IEEE Trans. Image Process., vol. 19,
no. 12, pp. 3243â€“3254, Dec. 2010.
[34] J. A. Sethian, Level Set Methods and Fast Marching Methods: Evolving
Interfaces in Computational Geometry, Fluid Mechanics, Computer Vision, and Materials Science, vol. 3. Cambridge, U.K.: Cambridge Uni.
Press, 1999.
[35] K. Zhang et al., â€œActive contours driven by local image fitting energy,â€
Attern. Recogn, vol. 43, pp. 1199â€“1206, 2010.
[36] J. C. Dunn, â€œA fuzzy relative of the ISODATA process and its use in
detecting compact well-separated clusters,â€ J. Cybern., vol. 3, pp. 32â€“57,
1973.
[37] J. C. Bezdek, Pattern Recognition With Fuzzy Objective Function Algorithms. Norwell, MA, USA: Kluwer, 1981.
[38] M. C. Adams et al., â€œA systematic review of the factors affecting accuracy of SUV measurements,â€ Am. J. Roentgenol, vol. 195,
pp. 310â€“320, 2010.
[39] F. J. Brooks and P. W. Grigsby, â€œThe effect of small tumor volumes on
studies of intratumoral heterogeneity of tracer uptake,â€ J. Nucl. Med.,
vol. 55, pp. 37â€“42, 2014.
[40] L. R. Dice, â€œMeasures of the amount of ecologic association between
species,â€ Ecology, vol. 26, pp. 297â€“302, 1945.
[41] P. Cignoni et al., â€œMetro: Measuring error on simplified surfaces,â€ Comput.
Graph. Forum, vol. 17, pp. 167â€“174, 1998.
[42] D. Xiang et al., â€œSkeleton cutsâ€”An efficient segmentation method for
volume rendering,â€ IEEE Trans. Vis. Comput. Graph., vol. 17, no. 9,
pp. 1295â€“1306, Sep. 2011.
[43] M. Hatt et al., â€œMetabolically active volumes automatic delineation
methodologies in PET imaging: Review and perspectives,â€ Cancer/RadiotheÌrapie, vol. 16, pp. 70â€“81, 2011.

Authorsâ€™, photographs and biographies not available at the time of publication.

