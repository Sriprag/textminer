IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

1853

An Inflection Point Method for the Determination
of Pulmonary Transit Time From
Contrast Echocardiography
Steven M. Boronyak, Ken Monahan∗ , Evan L. Brittain, and W. David Merryman

Abstract—Objective: Indicator-dilution curves (IDCs) for the estimation of pulmonary transit times (PTTs) can be generated noninvasively using contrast echocardiography. Currently, these IDCs
are analyzed by manual inspection, which is not feasible in a clinical setting, or fit to a statistical model to derive parameters of
interest. However, IDCs generated from patients are frequently
subject to significant low-frequency noise and recirculation artifacts that obscure the first-pass signal and render model fitting
impractical or inaccurate. Thus, the objective of this paper was to
develop alternative computational methods to determine PTT using noisy clinical data in which the signal decay is not adequately
visible. Methods: We report on a method that uses a model fit
to the rise portion of the IDCs to determine the signal inflection
point. Additionally, a signal truncation algorithm was developed
that enables automated analysis of the IDCs. Results: We compare
PTTs derived from our inflection point method to those obtained
by manual inspection in 25 patients (R2 = 0.86) and to those obtained by mean transit time calculation following fitting to a local
density random walk model (R2 = 0.80) in a subset of this cohort. Conclusion: Combined with a signal truncation algorithm,
the inflection point method provides robust, automated determination of PTT from noisy IDCs containing recirculation artifacts.
Significance: The inflection point method addresses the need for
computational analysis of IDCs obtained from contrast echocardiograms that are not amenable to first-pass model fitting.
Index Terms—Echocardiography, indicator-dilution curves,
pulmonary transit time, signal processing.

I. INTRODUCTION
NDICATOR dilution curves (IDCs) have a long history of
use in hemodynamic assessment; contrast dye agents and
cold-saline thermodilution have been used to invasively generate
IDCs for the estimation of transit times (TTs), blood volumes,
and cardiac output [1]–[3]. More recently, contrast echocardiography has been used to generate IDCs, noninvasively [4]–[6]

I

Manuscript received June 9, 2014; revised January 6, 2015 and February 5,
2015; accepted February 14, 2015. Date of publication February 19, 2015; date
of current version June 16, 2015. This work was supported by the American
Heart Association (Pre-Doctoral Fellowship 13PRE16340018 and Fellow-toFaculty Award #13FTF16070002), the Wallace H. Coulter Foundation, the National Institute of Health (R01 HL115103), and the National Science Foundation
(NSF CAREER 1055384). Asterisk indicates corresponding author.
S. M. Boronyak and W. D. Merryman are with the Department of Biomedical
Engineering, Vanderbilt University.
∗ K. Monahan is with the Division of Cardiovascular Medicine, Vanderbilt Medical Center, Nashville, TN 37232 USA (e-mail: ken.monahan@
vanderbilt.edu).
E. L. Brittain is with the Division of Cardiovascular Medicine, Vanderbilt
University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2405764

by injecting small doses of a contrast agent into a peripheral
vein and monitoring acoustic intensity within regions of interest
(ROIs) on 4-chamber echocardiographic views. For example,
ROIs are placed in the right ventricle (RV) and left atrium (LA)
when measuring pulmonary transit time (PTT), the time needed
for a volume of blood to traverse the pulmonary circulation.
Blood volume estimation from contrast echocardiography has
been found to be strongly correlated with the standard of thermodilution [7], with the added benefit that contrast echocardiography is far less invasive.
Various methods have been used to estimate PTT from contrast echocardiography IDCs. The most crude of these is by
manual inspection, in which the number of frames is counted
between appearance of contrast in each ROI and a PTT is calculated from the frame count and knowledge of the frame rate of
image acquisition [5], [8]. Additional information can be gained
by IDC model fitting of the first pass of contrast agent through
the cardiac chambers. IDC statistical models have historically
been used with contrast dye agents and thermodilution IDCs to
derive model parameters that describe the distribution of particle TTs; the models are then used to determine mean transit
time (MTT) [9]. These models require idealized IDCs in which
both the rise and a significant portion of decay in the first-pass
signal can be seen prior to appearance of contrast recirculation.
The remainder of the first-pass signal decay (typically <30%)
is then extrapolated from the slope of the decay curve [2].
Several IDC models, combined with nonlinear regression and
maximum-likelihood statistical approaches, have been applied
to analyze contrast echocardiography IDCs [4], [10], [11]. The
local density random walk (LDRW) model, from which MTT
can be determined, is a Gaussian statistical model that considers
the dispersion of contrast agent [12], [13]. One major shortcoming of the LDRW and other models is that they require a significant portion of the first-pass decay be clearly distinguishable
from recirculation. However, most clinically measured IDCs are
subject to significant noise and ambiguity near the beginning of
the recirculation portion of the IDC.
In this paper, we describe an alternative approach to estimate
PTT from contrast echocardiography by automatically identifying signal appearance in a ROI given a truncated acoustic intensity signal. We report on an inflection point method
that uses model fits of the first-pass portion of the RV and LA
IDCs to determine the inflection points of the rise portions of
those signals. This inflection point method automates the manual technique of identifying contrast appearance times or peaks
and is applicable to contrast echocardiography IDCs containing

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1854

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

low-frequency noise that mars recirculation onset. We demonstrate the feasibility of the inflection point method with data
from a group of 25 patients, and we compare this new method
to (1) PTTs obtained from manual inspection of IDCs; and (2)
MTTs derived from a subset of nine patients with IDCs suitable
for first-pass LDRW model fitting. We chose MTT determined
from first-pass model fitting for comparison with our inflection point method, as MTT-determination is currently the most
prevalent computational method for the determination of PTT
from contrast echocardiograms [4], [11].
II. METHODS
A. Patient Data Acquisition and Manual Inspection of PTT
The Vanderbilt Institutional Review Board approved this
study and all patients gave written informed consent. We
prospectively enrolled patients undergoing clinically indicated
echocardiography or stress echocardiography ordered by a referring physician.
All patients received commercially available ultrasound contrast agents (UCA) for technically difficult studies according to
American Society of Echocardiography guidelines [14]. Definity (Perflutren lipid microsphere, Lantheus Medical Imaging,
Billerica, Massachusetts) and Optison (Perflutren Protein-Type
A microspheres, GE Healthcare, Buckinghamshire, U.K.) were
used for UCAs according to availability in our echocardiography laboratory. Prior to contrast injection, all patients received
injection of agitated saline to exclude an intracardiac shunt.
UCAs were suspended for administration according to manufacturer instructions and were administered through a peripheral intravenous catheter (IV) via manual bolus injection of 1- to
2-mL. This protocol resulted in UCA concentrations of less than
10 μL/kg; at these doses, signal peak intensity has been shown
to increase linearly with UCA concentration in animal models
[15].
The beginning of clip acquisition and UCA administration
were synchronized to begin simultaneously. The entry of contrast into the right heart and subsequent appearance in the left
heart were recorded in the apical 4-chamber view. Images were
analyzed offline using QLab 9.1 software (Philips, Amsterdam,
The Netherlands) with signal output in decibels (dB). Regions
of interest (ROI; 5 mm square) were placed in the RV and the
LA. The RV ROI was placed approximately 1 cm distal to the
tricuspid valve leaflet tips equidistant from the interventricular
septum and RV free wall. The LA ROI was placed approximately 1 cm from the posterior wall of the LA equidistant from
the interatrial septum and LA free wall. PTT was calculated by
manual inspection of the resulting IDCs as the period between
the first RV peak and first LA peak (see Fig. 1). The “peak” for
each ROI was defined as a sudden increase in amplitude occurring simultaneously to chamber opacification. For each method,
interobserver variability of PTT was assessed by two investigators (ELB, KM) based on a subgroup of randomly selected
studies and was found to be excellent (intraclass correlation
coefficient = 0.94; 95% CI 0.74–0.99).
IDCs from four patients were excluded due to unusual patterns. For completeness, the excluded IDCs are shown in the
Appendix. Additionally, two patients were enrolled in the study

Fig. 1. Apical 4-chamber view of the heart with ROIs placed in the RV and
LA for estimation of PTT. Below: representative raw IDCs are displayed with
PTT marked by manual inspection.

Fig. 2. (a) Representative IDC demonstrating low-frequency artifacts obscuring the first-pass RV signal, blue, patient #25. Open-faced circles indicate peaks
detected by the peak detection search. tsta rt , tp e a k , and ttru n c are also plotted, as determined from the truncation algorithm. (b) Corresponding frequency
spectrum of the RV signal for unfiltered and filtered signals. The dc component
is cropped out to show detail.

but did not receive contrast due to a contraindication (interatrial
shunting), and in four patients, contrast administration and clip
acquisition were mistimed.
B. Filtering and Signal Truncation Algorithm
IDCs provide a measure of the contrast concentration (i.e.,
acoustic intensity) within the ROI as a function of time. Mathematical modeling has been extensively used in order to obtain parameter measurements from IDCs, which generally have
low signal-to-noise ratio (SNR). In order to provide meaningful
measurements, and to estimate MTT, the signal must contain
only the first pass of contrast agent. However, IDCs obtained
from clinical echocardiograms contain regions, where contrast
agent recirculation overlaps the first-pass signal. When the onset of recirculation occurs after the first-pass intensity signal has
significantly decayed, extrapolation of the model can be used
to provide a reasonable estimate of the entire first-pass signal
[16], [17]. In our experience, contrast recirculation often occurs
much sooner than this or, due to low-frequency noise and background artifacts, the onset of recirculation is often ambiguous
(see Fig. 2). To address this problem, we propose an inflection

BORONYAK et al.: INFLECTION POINT METHOD FOR THE DETERMINATION OF PULMONARY TRANSIT TIME

1855

Fig. 3. Inflection point method, patient #10. (a) Inflection fit of the RV signal of patient #10 by fitting the LDRW model (solid blue line) to filtered data (red
circles). Signal shown in full color was included in the model fit. (b) The first time-derivative of the LDRW model fit for identification of the inflection point. (c)
Inflection points (dashed lines) for the RV and LA ROIs. The regions of the signal used to fit the LDRW model are shown in bold between black dots.

point method wherein an LDRW model is fit to the rise portion
of each IDC and the inflection point of the rise is taken to be the
point of interest for that curve.
Prior to application of the inflection point identification methods, IDCs were filtered using a low-pass finite impulse response
filter of 100 coefficients at a cutoff frequency of 0.5 Hz, and the
signal offset was adjusted to set the background signal to 0.
A truncation algorithm was then used to confine the model
fit to the rise portion of each signal [see Fig. 2(a)]. For use
with the truncation algorithm, each IDC was filtered again at a
cutoff frequency of 0.1 Hz. Next, the IDC signal peak tp eak was
identified; due.
Fig. 3. Inflection point method, patient #10. A: Inflection fit
of the RV signal of patient #10 by fitting the LDRW model (solid
blue line) to filtered data (red circles). Signal shown in full color
was included in the model fit. B: The 1st time-derivative of the
LDRW model fit for identification of the inflection point. C:
Inflection points (dashed lines) for the RV and LA ROIs. The
regions of the signal used to fit the LDRW model are shown in
bold between black dots. to artifacts, this peak is often not the
maximum amplitude of the IDC signal. To identify tp eak , a peak
detection search was performed on the IDC to find each local
maximum, which was bounded on each side by a value less than
a chosen threshold. In this application, the threshold was taken to
be 2% of the maximum value of the IDC. A second search is then
performed, beginning at t = 0, to locate the first local maximum
that appears after the IDC signal has risen above 50% of its
maximum value, and this local maximum is taken to be tp eak .
The truncation point ttrunc was subsequently identified using
a modification of the method in [18] to systemically identify the
onset of indicator (contrast) recirculation. As the IDC decay after tp eak is approximately exponential, transforming the signal
into the logarithmic domain makes the decay region approximately linear. In order to identify the appropriate truncation
point, a line is fit from tp eak to every point in the signal after
tp eak . The R2 value of each line is then plotted, and the first
peak in the R2 value is taken to be ttrunc , the signal truncation point. The selection of ttrunc is restricted to include only
signal that occurs prior to decay below 70% of the value at
tp eak , in order to confine the model fit primarily to the signal
rise.

The IDC signal start tstart is also identified as background
signal and low-frequency noise before the IDC signal rise can
confound model fitting. tstart is identified by searching the signal in reverse in time, beginning at tp eak . tstart is taken to be
the point at which the signal intensity is <10% of the signal
intensity at tp eak .
C. Inflection Point Method
In order to identify the signal inflection point, a LDRW model
was selected to fit the signal rise, as LDRW models have been
extensively used for the analysis of IDCs and have only one
time-derivative maximum:

λ − 2λ ( μt + μt )
λ
e
I (t) = Ae
(1)
2πμt
where I(t) is the observed signal intensity with the ROI at time
t, and A, λ, and μ are model parameters. For an IDC described
by (1) above, A is the area under the IDC (dB s), μ represents
the TT of the median particle (s), and λ is a skewness parameter.
The signal truncation algorithm described above primarily confines the model fit to the rise portion of the IDCs [see Fig. 3(a)].
This is done to produce the best fit of the LDRW model to
the signal rise and to ignore any signal artifacts that may be
present in the IDC decay region. Nonlinear least squares regression was performed on the filtered and truncated data using the
Levenberg–Marquardt method with the initial guesses for each
model parameter A = λ = μ = 10 [19]. The signal inflection
was then determined by taking the first time-derivative of the
model fit [see Fig. 3(b)]:


dI(t)
.
(2)
inﬂection = max
dt
The PTT is taken as the interval between occurrences of the
inflection points estimated from the RV and LA signals [see
Fig. 3(c)].
D. Determination of Mean Transit Time
MTT was also determined from LDRW model fits (1) to
the IDCs to compare the inflection point method to current

1856

Fig. 4. Model fit of first-pass signal. (a) MTT determined from LDRW model
fits, patient #22. Solid, bold lines indicate where filtered data were used to
fit the model. Dashed lines indicate where the model was extrapolated. (b)
Inflection fit and CUSUM onset from filtered data plotted on LDRW model fits
for comparison. Open-faced circles: inflection points, solid triangles: CUSUM
change-points.

computational approaches. In order for the estimation of MTT
to be considered accurate, the fit of the LDRW model must be
sufficient to both the rise and decay portions of the IDC. However, due to signal noise and artifacts, MTT could not adequately
be determined for each patient dataset. Thus, in order to be included for comparison with the inflection point method, each
IDC was required to meet the following inclusion criteria: 1) the
R2 -value between the LDRW model fit and 0.5-Hz filtered signal was ࣙ0.90, 2) the onset of recirculation ttrunc occurred after
the signal had decayed to <75% of the value at tp eak , and 3) if
MTT was significantly different than the manually determined
TT (error >40%), these IDCs were excluded. Only one patient
dataset was excluded based on criteria 3 alone. Based on these
selection criteria, MTT determination was deemed sufficient in
9 out of 25 patients; MTTs were compared to TTs derived from
the inflection point method in this subgroup.
To optimize the signal for the LDRW model fit (from which
MTT is determined), the signal truncation algorithm as described above was performed on the 0.5-Hz filtered data. This
step was designed to leave more salient features available for
the identification and to facilitate inclusion of more patients in
the MTT analysis based on the selection criteria. Additionally,
the selection of ttrunc was expanded to include any signal that
occurred prior to decay to <30% of the value at tp eak , to improve the model fit to the decay region. The truncated signal
from tstart to ttrunc was then fit to the LDRW model using
a Levenberg–Marquardt nonlinear least squares regression as
described above. The MTT was identified [see Fig. 4(a)] and
compared to the inflection point method [see Fig. 4(b)].
E. Cumulative Sum Algorithm
In order to provide a secondary computational method of
comparison that is more readily applicable to noisy signals than
MTT, a cumulative sum (CUSUM) algorithm, commonly used
as a statistical method of step detection in time series data,
was implemented. Raw signals from each ROI were first filtered and truncated as with the inflection point method. For
each signal measurement Ii , a CUSUM statistic Si is generated
[see Fig. 5(a)], which is comprised of sequential additions of
the difference between the observed signal intensities and the

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Fig. 5. CUSUM algorithm, patient #10. (a) CUSUM statistic for the RV and
LA signals with the minimized MSEs indicated by black circles. The CUSUM
statistic is only shown for the portions of the IDCs selected by the truncation
algorithm. (b) Signal onsets, determined by the CUSUM algorithm, indicated
by dashed lines and open-faced circles.

¯
signal mean I:



Si = Si−1 + Ii − I¯ i = {1 . . . N }

(3)

where S0 = 0. After the CUSUM statistic is generated for the
length of each signal N, the largest change-point is determined
by identifying the point m which minimizes the mean-squared
error when the signal is divided into two subsets [see Fig. 5(a)]:
MSE (m) =

m
N



2

2
Ii − IL +
Ii − IU
i=1

(4)

i=m +1

where IL is all signal for i = {1 . . . m} and IU is all signal for
i = {m + 1 . . . N }. The PTT is taken as the interval between
occurrences of the CUSUM change-points identified for the RV
and LA signals [see Fig. 5(b)].
F. Effect of Signal Truncation on Transit Time (TT)
Calculation
The effect of truncating the IDCs prior to the identified recirculation point ttrunc was investigated for each of the n = 9
patients found to be amenable to the MTT determination. The
truncation algorithm was performed as described in Section II-D
to identify ttrunc . Then, with tstart held constant, each IDC was
truncated early, prior to ttrunc , and the inflection point, MTTdetermination, and CUSUM methods were performed. These
analyses were repeated over each IDC for every time point between tp eak + 0.03 s and ttrunc . For IDCs truncated at each
of these early time points, the variation in the measurement of
interest (MTT, inflection point, CUSUM change-point) was calculated as a percentage of the total TT measurement determined
from the signals truncated at ttrunc . The maximum and minimum variations for the RV and LA IDCs were summed for each
patient to determine the total variation in the TT estimate.
G. Simulations
In order to more completely evaluate the estimation error induced by different signal truncation points and varying levels of
noise, simulated IDCs were generated using the LDRW model.
Theoretical IDCs It (t) were created using the LDRW model
by varying parameters μ and λ over the ranges μ = {5 . . . 20s}

BORONYAK et al.: INFLECTION POINT METHOD FOR THE DETERMINATION OF PULMONARY TRANSIT TIME

Fig. 6. Comparison of manually identified TTs with TTs determined by the
inflection point method and CUSUM algorithm.

and λ = {2 . . . 120}, for 10 and 15 evenly spaced values, respectively. About 25 simulated IDCs were generated for every
combination of μ and λ within these sets (15 × 10 × 25 = 3750
simulations). This resulted in IDCs with MTTs occurring over
the range of approximately 5 to 20 s. Similar to previous work
[20], white noise was added to the IDCs to simulate noisy IDCs
such that
IN (t) = It (t) + N (t)

1857

absolute difference was 4.53%. For patients with PTTs >6 s,
the difference increased to 20.4% and 15.9% for the inflection
point method and CUSUM algorithm, respectively.
Linear regression and Bland–Altman analyses demonstrate
that as PTT increases, the difference between any two methods
also increases, and the differences between methods for shorter
PTTs are clustered more closely together (see Fig. 7). The bias
between the automated methods and the manually determined
PTT was 0.30 and 0.12 s for the inflection point method and
CUSUM algorithm, respectively. The corresponding standard
deviations were 0.92 and 1.01 s. The inflection point method
demonstrated good linear agreement with the manually determined PTTs (R2 = 0.86), while the CUSUM method did not
perform as well (R2 = 0.73). In addition, regression analysis
of the inflection point method with the CUSUM algorithm
demonstrates better agreement between those two techniques
(R2 = 0.93, bias of 0.18 s, standard deviation of differences,
0.58 s) relative to the agreement of either method with manually determined PTT.

(5)

where N (t) is random white noise and IN (t) is the noisy
simulated IDC. Based on experimental observations, IDC signal
noise is related to the amplitude of the IDC signal. Thus, N (t)
was generated such that the variance of N (t) was proportional
to kIt (t)2 , where k is approximately SNR−1 . As the mean value
of SNR measured in the 25 experimentally obtained IDCs was
12.4 dB, SNR was simulated over the range of 6 to 14 dB.
The estimation error was then averaged over all simulations
for the mean time, inflection point, and CUSUM change-point
at truncation cutoff percentages of 10%, 30%, 50%, 70%, and
90%. The estimation error is expressed as a percentage of the
true values obtained from It (t).
H. Data Analysis
All code development and data analysis were performed using MATLAB. To quantify the agreement between the inflection point, CUSUM, and manual methods, linear regression and
Bland–Altman plots were constructed. The coefficients of determination (R2 ) are reported with respect to the regression line
and not the identity line. For the Bland–Altman plots, the bias
reported is the mean of the differences and dashed lines report
the 95% confidence interval.
III. RESULTS
A. Comparison of Methods
Fig. 6 provides a graphical comparison of manually determined PTTs with those determined by the inflection point
method and CUSUM algorithm for all 25 patients. In general,
all three methods demonstrated agreement on the PTT, with the
exception of patients with long (>6 s) PTTs. For all patients
with a manually determined PTT under 6 s, the average absolute difference between the automated methods and the manually determined PTT was 13.0% and 15.5% for the inflection
point method and CUSUM algorithm, respectively. In comparing the inflection method to the CUSUM algorithm, the average

B. Comparison to Mean TT
Table I displays the comparison of manually determined TTs
and those obtained from the automated methods with MTTs of
two subsets of the nine patients found to be amenable to firstpass model fitting. When the onset of recirculation is identified
to occur after the IDC signal has decayed to less than approximately 50% of the peak value, all TT estimation methods agree
well with the MTT estimation (R2 ≥ 0.93, n = 5). The average
absolute percent difference with MTT was found to be 4.00%,
2.85%, and 3.84% for the manual, inflection point, and CUSUM
algorithm, respectively.
When additional patients are included in the MTT analysis
(total n = 9) with recirculation that occurs before substantial
IDC signal decay, differences can be seen between the estimation methods. Notably, the inflection point method and CUSUM
algorithm yield PTTs that agree more closely with the MTT
(7.45% and 7.48% average absolute difference, respectively)
than do the manually determined PTTs (11.4%). Additionally,
the inflection fit method and CUSUM algorithm produce PTTs
that correlate with the MTT sample (R2 = 0.80 and 0.82, respectively), while the manual PTTs do not (R2 = 0.42).
C. Sensitivity to Early Signal Truncation
When the IDC is truncated early, before the onset of recirculation, a significant amount of variation can be introduced in
the TT estimation when determined using the MTT or CUSUM
methods (see Fig. 8). However, the inflection point method is
relatively insensitive to variations in the signal truncation point.
Fig. 8 reports the range of TT estimations obtained when the
IDCs are truncated early, for all possible truncation points between tp eak + 0.03 s and ttrunc . The maximum and minimum
variations in the RV and LA IDC signal points of interest are
summed to produce the total variation in TT estimation. The
variation is reported as a percentage of the TT estimate that results from application of the signal truncation algorithm to the
IDCs. The average bias of the measurement points of interest

1858

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Fig. 7. Linear regression analysis (a)–(c) and Bland–Altman plots (d)–(f). R 2 values are with respect to the regression line and not the identity line. (a), (d)
Inflection point method versus manually determined TTs. (b), (e): CUSUM algorithm versus manually determined TTs. (c), (f) CUSUM algorithm versus inflection
point method.

TABLE I
COMPARISON TO MTTS
Signal Truncation Decay
Patient
15
16
22
26
34

Inflection Point

CUSUM

MTT (s)

RV (%)

LA (%)

TT (s)

|%Δ |

TT (s)

|%Δ |

TT (s)

|%Δ |

3.93
3.62
3.78
4.43
3.06

49.3
46.9
41.2
30.1
51.1

50.5
30.9
30.3
31.8
32.1

3.80
3.43
3.46
4.29
3.14
AVG

3.31
2.20
8.50
3.16
2.61
4.00

3.87
3.68
3.89
4.33
3.24
AVG

1.53
1.66
2.91
2.26
5.88
2.85

3.90
3.73
3.90
4.25
3.31
AVG

0.76
3.04
3.17
4.06
8.17
3.84

R2
0.93

(y 0 , a)
(0.51,0.83)

R2
0.98

(y 0 , a)
(0.84, 0.79)

R2
0.98

(y 0 , a)
(1.3, 0.68)

3.93
3.54
3.21
3.68
AVG

16.4
35.0
17.1
14.6
11.4

4.93
3.01
3.55
3.89
AVG

4.89
18.5
8.27
21.1
7.45

4.86
2.97
3.52
3.81
AVG

3.40
16.9
9.04
18.7
7.48

R2
0.42

(y 0 , a)
(2.3, 0.35)

R2
0.80

(y 0 , a)
(1.0, 0.76)

R2
0.82

(y 0 , a)
(1.1, 0.73)

Linear regression versus MTT (n = 5)
y = y 0 + ax
14
19
29
33

Manual

4.70
2.54
3.87
3.21

73.7
69.1
73.7
63.9

30.4
30.1
48.5
40.2

Linear regression versus MTT (n = 9)
y = y 0 + ax

with respect to the estimations made at the truncation points
were −0.04, 0.01, and 0.09 s for the MTT, inflection point
method, and CUSUM algorithm, respectively. Corresponding
standard deviations were 0.06, 0.01, and 0.03 s.

and inflection point at various truncation points indicates that
MTT may be sensitive to the amount of decay signal available,
while the inflection point method is not.
IV. DISCUSSION

D. Simulation Estimation Errors
Simulations of noisy IDCs and a range of truncation points
resulted in little error between the estimation methods and true
simulated values (see Fig. 9). The maximum absolute estimation
error for all methods was 0.83%. Evaluation of the mean time

PTT has diagnostic and prognostic value when obtained from
cardiac MRI [21]–[23]. Contrast echocardiography is a more
readily available and less expensive noninvasive technique for
the determination of PTT. However, currently used computational methods, such as a model fitting to a first-pass LDRW

BORONYAK et al.: INFLECTION POINT METHOD FOR THE DETERMINATION OF PULMONARY TRANSIT TIME

Fig. 8. Variation of the TT estimates when IDCs are truncated early, between
tp e a k + 0.03 s and ttru n c , compared to the TT estimates obtained when the
truncation algorithm is used.

Fig. 9. Average estimation error, expressed as a percentage of true values,
for a range of truncation cutoffs. A lower truncation cutoff percentage indicates
a greater decay of the signal toward background levels. Error bars indicate
standard deviation.

statistical model, are often insufficient for the analysis of clinical data due to UCA recirculation and low-frequency artifacts
that obscure the first-pass IDC signal in the decay region. In our
cohort of 25 patients, only 9 were found to be amenable to MTT
calculation from LDRW model fitting, demonstrating a need for
alternative computational methods. Others have similarly had
to reject MTT calculations as a result of signal artifacts, even
under more controlled conditions; in one in vitro study, 8 out
of 79 datasets were rejected due to poor model fits [11]. PTTs
can also be estimated by inspecting the IDCs concurrently with
the corresponding echocardiographic image of contrast passage
through ROIs and manually marking the peak of each signal,
but this analysis must be done offline and is time consuming.
Thus, computational methods are needed that are robust enough
to determine PTT using noisy clinical data. To address this challenge, we have presented an alternative computational approach,
an inflection point method, that determines PTT by automatically identifying the onset of contrast agent signal within a ROI.
A. Need for Alternative Methods
IDCs can vary depending on the injection rate, injection volume, patient anatomy, placement of ROIs, quality of the echocardiographic images, and how well mixed the contrast agent is
in solution. As a result, many IDCs generated from clinical

1859

Fig. 10. Representative IDCs not amenable for first-pass model fitting. (a) IDC
from patient #28 with significant recirculation artifacts and noise, postfiltering.
(b) IDC from patient #30 demonstrating ambiguous recirculation onset. Solid
lines indicate regions used for model fitting. Dashed lines indicate extrapolated
fits.

echocardiograms are not amenable to fitting models, such as the
LDRW model, to the entire first-pass signal because recirculation and low-frequency artifacts can obscure the decay region
(see Fig. 10). This renders the determination of MTT unreliable
when adequate signal in the decay region is not available for
model fitting. However, these signals still commonly demonstrate reasonable model agreement in the rise portion of the
IDCs. The advantage of the inflection point method over MTT
calculation is that it confines the model fit to the signal rise,
without requiring that a significant portion of the decay region
be available for fitting. The inflection point, determined from
partial fits of the LDRW model to the filtered IDCs, then supersedes the LDRW model and model parameters, accurate values
of which can be indeterminate in the clinical setting due to lowfrequency artifacts unless a sufficient amount of signal decay
is available for fitting. Given the location of the IDC inflection
point, it can be thought of as more of an indicator of the first
appearance time of UCA within the ROI, rather than the average
appearance time/MTT.
The robustness of the inflection point method over calculation of MTT can be seen in Fig. 8 where the inflection point
calculation is far less sensitive to variations in signal truncation than MTT. Since the adverse features that most commonly
confound model fitting are often located in the decay region of
IDCs, the inflection point method is more likely to be applicable to clinically generated IDCs than techniques that depend on
availability of the entire curve.
B. Variability Between Methods
Several sources of error could be contributing to the differences in PTT between methods. As contrast agent advances
through the circulatory system, the distribution of particles becomes more disperse. Therefore, the body of the LDRW model,
which can be treated as a probability density function, becomes
wider as contrast progresses from the site of injection. The
longer it takes for contrast to traverse the pulmonary circulation,
the more dispersed the distribution will become and the greater
the distance between the inflection point of the LA signal rise
and the analogous component of MTT.
Another source of error is the quality of the LDRW model
fits in the inflection point method and for calculation of MTT.

1860

Many of the IDCs used for MTT determination experienced
recirculation onset before the first-pass signal decayed to <50%
of the peak value. The agreement between methods, including
MTT, is much stronger when recirculation onset occurs after
the signal has decayed to <50% of the peak value, as evidenced
by the group of n = 5 patients in Table I. When IDCs must
be truncated sooner, either due to recirculation or artifacts, the
linear agreement between MTT and the other computational
methods is lessened. In previous calculations of cardiac output
from thermodilution IDCs, the extrapolation procedure for the
decay region resulted in underestimations of cardiac output by
up to 8% [16].
As only 9 out of 25 sets of IDCs were found to be acceptable for MTT calculation, we included a CUSUM algorithm
to provide a secondary method of comparison to the inflection
point method. Agreement between the inflection point method
and CUSUM algorithm is maintained, regardless of when the
IDCs must be truncated (see Table I and Fig. 7). Additionally,
the inflection point method and CUSUM algorithm attained
better linear agreement on TT than either method’s agreement
with the manually determined TTs, implying that computational
methods are potentially more precise. Given that the inflection
point method provided better linear agreement with manually
determined TTs, the relative insensitivity of the inflection point
method to variations in signal truncation, and that model parameters may provide additional characterization of the IDC system
if sufficient signal decay is present, the inflection point method
outperforms the CUSUM algorithm in PTT determination.
It is important to consider that no method presented here
is a gold standard, and that each has its strengths and inherent
sources of error. We chose MTT as the reference for comparison
between techniques primarily because it is the only published
computational method for determination of PTT from contrast
echocardiography [4], [11]. When IDCs with sufficient discernable signal decay were selected (n = 5), the inflection point
method provided excellent agreement with MTT (average absolute difference 2.85% R2 = 0.98).

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

cardiac MRI [22], [23], for example, indicate that MTT from
first-pass model fitting produces the most accurate PTT estimations, then MTT may be the default method used when IDCs
are of sufficient quality. If the measured IDCs are found to be
incompatible with MTT, then the inflection fit method can be
used to provide an alternate estimate of PTT.
V. CONCLUSION
The inflection point method provides robust automated determination of PTT from contrast echocardiogram IDCs obtained
in a clinical setting, and is applicable to IDCs in which the decay
region is compromised by signal artifacts commonly encountered in clinical echocardiography. Future implementation of
the inflection point method within echocardiographic imaging
systems may enable near real-time determination of PTT with
minimal input from the operator.
APPENDIX A
IDCs excluded from analysis due to unusual signals.

C. Study Limitations
The small group of patients (n = 9) with IDCs compatible
with first-pass model fitting and MTT calculation limit comparison of this method with PTTs determined by the inflection
point and CUSUM algorithm. However, the fact that only 9 out
of 25 IDCs were compatible with MTT calculation further supports the notion that alternative methods of determining PTT
are necessary.
A current limitation of the inflection point method and MTT
calculation is that both techniques must be performed offline.
However, unlike the manual inspection technique, both methods
have the potential to become automated if implemented within
the echocardiographic imaging platform. For example, the beginning of the signal window can be triggered simultaneously
with the start of contrast injection, and the truncation algorithm
can automatically identify the signal truncation point.
The inflection point method has the added benefit of being easily adaptable to MTT estimation. If future studies, with

REFERENCES
[1] G. N. Stewart, “Researches on the circulation time in organs and on the
influences which affect it—Parts I.–III,” J. Physiol., vol. 15, pp. 1–89, Jul.
1893.
[2] W. Hamilton et al., “Simultaneous determination of the pulmonary and
systemic circulation times in man and of a figure related to the cardiac
output,” Amer. J. Physiol., vol. 84, pp. 338–344, 1928.
[3] W. Ganz et al., “A new technique for measurement of cardiac output by
thermodilution in man,” Amer. J. Cardiol., vol. 27, pp. 392–396, 1971.
[4] M. Mischi et al., “Contrast echocardiography for pulmonary blood volume
quantification,” IEEE Trans. Ultrason., Ferroelectr. Freq. Control, vol. 51,
no. 9, pp. 1137–47, Sep. 2004.
[5] G. Galanti et al., “Transpulmonary transit of microbubbles during contrast echocardiography: Implications for estimating cardiac output and
pulmonary blood volume,” J. Amer. Soc. Echocardiogr., vol. 6, pp. 272–8,
May/Jun. 1993.
[6] E. Brittain et al., “Abstract 11380: Reproducibility and diagnostic potential of pulmonary transit time derived from contrast echocardiography,” in
Proc. Amer. Heart Assoc. Sci. Sessions Resuscitation Sci. Symp., 2012.
[7] I. H. Herold et al., “Volume quantification by contrast-enhanced ultrasound: An in-vitro comparison with true volumes and thermodilution,”
Cardiovasc. Ultrasound, vol. 11, pp. 11–36, 2013.

BORONYAK et al.: INFLECTION POINT METHOD FOR THE DETERMINATION OF PULMONARY TRANSIT TIME

[8] A. Streitberger et al., “Measurement of pulmonary transit time in healthy
cats by use of ultrasound contrast media “Sonovue(R)”: Feasibility, reproducibility, and values in 42 cats,” J. Vet. Cardiol., vol. 15, pp. 181–187,
Sep. 2013.
[9] P. Meier and K. L. Zierler, “On the theory of the indicator-dilution method
for measurement of blood flow and volume,” J. Appl. Physiol., vol. 6, pp.
731–44, Jun. 1954.
[10] M. Mischi et al., “Identification of cardiovascular dilution systems by
contrast ultrasound,” Ultrasound Med. Biol., vol. 33, pp. 439–51, Mar.
2007.
[11] M. P. Kuenen et al., “Maximum-likelihood estimation for indicator dilution analysis,” IEEE Trans. Biomed. Eng., vol. 61, no. 3, pp. 821–31, Mar.
2014.
[12] J. M. Bogaard et al., “Physiological interpretation of the skewness of
indicator-dilution curves; theoretical considerations and a practical application,” Basic Res. Cardiol., vol. 79, pp. 479–93, Jul./Aug. 1984.
[13] J. M. Bogaard et al., “Random walk type models for indicator-dilution
studies: Comparison of a local density random walk and a first passage
times distribution,” Cardiovasc. Res., vol. 20, pp. 789–96, Nov. 1986.
[14] S. L. Mulvagh et al., “American society of echocardiography consensus statement on the clinical applications of ultrasonic contrast agents in
echocardiography,” J. Amer. Soc. Echocardiogr., vol. 21, pp. 1179–201,
Nov. 2008.
[15] S. Stapleton et al., “Acoustic and kinetic behaviour of definity in mice
exposed to high frequency ultrasound,” Ultrasound Med. Biol., vol. 35,
pp. 296–307, Feb. 2009.
[16] R. K. Millard, “Indicator-dilution dispersion models and cardiac output
computing methods,” Amer. J. Physiol., vol. 272, pp. H2004– H20012,
1997.

1861

[17] K. Zierler, “Indicator dilution methods for measuring blood flow, volume,
and other properties of biological systems: A brief history and memoir,”
Ann. Biomed. Eng., vol. 28, pp. 836–48, Aug. 2000.
[18] M. P. Kuenen et al., “Contrast-ultrasound diffusion imaging for localization of prostate cancer,” IEEE Trans. Med. Imaging, vol. 30, no. 8,
pp. 1493–502, Aug. 2011.
[19] J. Moré, “The Levenberg–Marquardt algorithm: Implementation and theory,” in Proc. Numer. Analysis Conf., 1978, pp. 105–116.
[20] M. Mischi et al., “Videodensitometric methods for cardiac output measurements,” EURASIP J. Appl. Signal Process., vol. 2003, pp. 479–489,
2003.
[21] J. Skrok et al., “Pulmonary arterial hypertension: MR imaging-derived
first-pass bolus kinetic parameters are biomarkers for pulmonary hemodynamics, cardiac function, and ventricular remodeling,” Radiology,
vol. 263, pp. 678–87, Jun. 2012.
[22] M. Mischi et al., “Intra-thoracic blood volume measurement by contrast
magnetic resonance imaging,” Magn. Reson. Med., vol. 61, pp. 344–53,
Feb. 2009.
[23] M. Ugander et al., “Pulmonary blood volume variation decreases after
myocardial infarction in pigs: A quantitative and noninvasive MR imaging
measure of heart failure,” Radiology, vol. 256, pp. 415–23, Aug. 2010.

Authors’ photographs and biographies not available at the time of publication.

