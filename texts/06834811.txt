2830

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

A Wavelet-Based Electrogram Onset Delineator
for Automatic Ventricular Activation Mapping
Alejandro Alcaine∗ , David Soto-Iglesias, Mireia Calvo, Esther Guiu, David Andreu, Juan Fernández-Armenta,
Antonio Berruezo, Pablo Laguna, Senior Member, IEEE, Oscar Camara, and Juan Pablo Martı́nez

Abstract—Electroanatomical mapping (EAM) systems are
commonly used in clinical practice for guiding catheter ablation
treatments of common arrhythmias. In focal tachycardias, the
ablation target is defined by locating the earliest activation area
determined by the joint analysis of electrogram (EGM) signals at
different sites. However, this is currently a manual time-consuming
and experience-dependent task performed during the intervention
and thus prone to stress-related errors. In this paper, we present an
automatic delineation strategy that combines electrocardiogram
(ECG) information with the wavelet decomposition of the EGM
signal envelope to identify the onset of each EGM signal for activation mapping. Fourteen electroanatomical maps corresponding to
ten patients suffering from non-tolerated premature ventricular
contraction (PVC) beats and admitted for ablation procedure
were used for evaluation. We compared the results obtained
automatically with two types of manual annotations: one during
the intervention by an expert technician (on-procedure) and
other after the intervention (off-procedure), free from time and
procedural constraints, by two other technicians. The automatic
annotations show a significant correlation (0.95, p < 0.01) with the
evaluation reference (off-procedure annotation sets combination)
and has an error of 2.1 ± 10.9 ms, around the order of magnitude
of the on-procedure annotations error (−2.6 ± 6.8 ms). The results
suggest that the proposed methodology could be incorporated
into EAM systems to considerably reduce processing time during
ablation interventions.
Index Terms—Activation mapping, bipolar electrogram,
catheter ablation, electrophysiology, focal ventricular tachycardia,
local activation time, signal envelope, wavelet analysis.
Manuscript received March 10, 2014; revised May 9, 2014; accepted June
4, 2014. Date of publication June 13, 2014; date of current version November
18, 2014. This work was supported by a personal grant to A.A. ref: BES2011-046644, by projects TEC2010-21703-C03-02, TEC2013-42140-R, and
TIN2011-28067 from Ministerio de Economı́a y Competitividad, and also
by Aragón Government (Spain) and European Social Fund (EU) through
Grupo Consolidado BSICoS and by CIBER de Bioingenierı́a, Biomateriales
y Nanomedicina through Instituto de Salud Carlos III. Asterisk indicates corresponding author.
∗ A. Alcaine is with the BSICoS Group, Aragón Institute of Engineering
Research (I3A), IIS Aragón, Universidad de Zaragoza, 50018 Zaragoza, Spain,
and is also with the Centro de Investigación Biomédica en Red de Bioingenierı́a,
Biomateriales y Nanomedicina (CIBER-BBN), 28029 Madrid, Spain (e-mail:
aalcaineo@unizar.es).
D. Soto-Iglesias and O. Camara are with the PhySense Group, Department
of Information and Communication Technologies, Universitat Pompeu Fabra,
08018 Barcelona, Spain (e-mail: david.soto@upf.edu; oscar.camara@upf.edu).
M. Calvo, E. Guiu, D. Andreu, J. Fernández-Armenta, and A. Berruezo
are with the Arrhythmia Section, Cardiology Department, Thorax Institute, Hospital Clı́nic, Universitat de Barcelona, 08036 Barcelona, Spain
(e-mail: calvo@clinic.ub.es; esguiu@clinic.ub.es; dandreu@clinic.ub.es;
jufernan@clinic.ub.es; berruezo@clinic.ub.es).
P. Laguna and J. P. Martı́nez are with the BSICoS Group, Aragón Institute
of Engineering Research (I3A), IIS Aragón, Universidad de Zaragoza, 50018
Zaragoza, Spain, and also with the Centro de Investigación Biomédica en Red de
Bioingenierı́a, Biomateriales y Nanomedicina (CIBER-BBN), 28029 Madrid,
Spain (e-mail: laguna@unizar.es; jpmart@unizar.es).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2330847

I. INTRODUCTION
ATHETER ablation is the recommended treatment for
patients with or without structural heart disease who suffer from ventricular tachycardia (VT) in which antiarrhythmic
drug therapy is ineffective [1]. Mechanisms underlying focal
VTs are related with trigger activity, automatisms [2], [3], and
microreentry [1], [4]. Focal VTs are candidates for radiofrequency ablation treatment since ablating targets determined by
the location of the earliest activation area often terminates the
arrhythmia [1], [5], [6].
Activation mapping is commonly used to determine the earliest activation area in focal arrhythmias [5], [7], and has been
proved to be more accurate in focus localization than other mapping strategies [8]. The aim of activation mapping is to create
a representation of the excitation sequence of the heart. To do
so, an EAM system is commonly used. It allows to have the
3-D location of the ablation catheter within the patient’s heart
displaying the electrical EGM characteristics as well as minimizing the fluoroscopy exposition of the patient and clinical
staff [1].
The local activation time (LAT) is defined as the time when
the catheter electrodes sense an activation wavefront with respect to a stable time point [1], [5] and it is typically used for
activation mapping. Different LAT definitions are found in the
literature according to the EGM signal acquisition, i.e., unipolar or bipolar EGMs. In unipolar EGMs, the maximum negative
slope of the signal coincides with the upstroke of the cardiac
action potential and therefore, with the true activation time [9],
[10]. However, unipolar EGMs are not so commonly used in
the clinical practice because they are prone to be disrupted by
baseline wander, far field, and other electrical sources. Common
LAT surrogates in bipolar EGM signals are 1) the maximal peak
of the signal, 2) the maximal slope, and 3) the EGM activation
onset, usually considered as the time instant when the potential
changes more than 45◦ from the isoelectric line at recording paper speed of 100 mm/s [10]. However, there is not an established
consensus on these surrogates. The first two cannot be reliably
estimated when fractionated potentials are present [1] and the
definition of the EGM onset is ambiguous since it depends on
the used amplitude scale. Nevertheless, the EGM onset is a better marker for activation mapping than the maximal peak and
slope estimates [11].
For activation mapping, EAM system software generally locates by default the single maximal peak of the bipolar EGM
activation in a given window of interest. In order to perform
activation mapping based on EGM onsets, EAM system operators need to manually identify it for each EGM signal [12],

C

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

ALCAINE et al.: WAVELET-BASED ELECTROGRAM ONSET DELINEATOR FOR AUTOMATIC VENTRICULAR ACTIVATION MAPPING

which can easily be available in more than 100 different mapping points. This process becomes a very time-consuming task
that may compromise the accuracy of the mapping procedure
due to the stressing conditions during the intervention. Once
this procedure is achieved for all the acquired mapping points,
it is straightforward to identify the earliest activation area that
will guide the ablation procedure using a color-coded scale of
the activation pattern.
On the other hand, noninvasive imaging techniques to obtain
the activation sequence in the heart have been recently shown
to be a promising tool for planning ablation procedures by solving the inverse problem using body surface potential mapping.
Currently, this is under investigation in animals and simulation
models [13], [14].
Automatic analysis of EGM signals can significantly reduce
intervention times and increase the robustness of the mapping
procedure. In continuous recordings, some techniques have been
used for activation cycle length detection and analysis [15]–[19],
frequency analysis and organization [20], [21], cross-correlation
measurements [22], activation morphology analysis [23], and
nonlinear analysis [24]. Most of these techniques have been
applied for atrial fibrillation analysis and characterization. In
recordings using EAM systems, dominant frequency is typically
used to guide the ablation procedure [25], [26].
Detection and delineation of the surface ECG signals are
well-known tasks and numerous approaches for it can be found
in the literature [27]. Nevertheless, this task is more challenging in the case of EGM signals due to the noisy and variable
nature of the data and only a few approaches can be found
in the literature. Oesterlein et al. [28] proposed the nonlinear
energy operator for LAT computation but was only applied in
simulated data. El Haddad et al. [29] also proposed an algorithm
focused on detecting the onset and end of electrograms for atrial
tachycardias.
In this paper, we present an automatic delineation strategy that
combines information from the surface ECG with the wavelet
decomposition of the EGM activation envelope in order to delineate the onset of the EGM activation, therefore obtaining fast
and observer-independent activation maps for guiding the ablation treatment of focal VTs. The proposed method is evaluated in
fourteen electroanatomical maps from ten patients undergoing
catheter ablation due to non-tolerated PVC beats. For each map,
two types of manual annotations are available, one obtained
during the intervention and other obtained after the intervention
by two other experts. Some preliminary results were already
presented in [30].
This paper is organized as follows. In Section II, we present
the clinical data used in this paper, the signal characteristics, and
the validation data. The methods for delineation of the EGM
onset and the evaluation protocol are described in Section III. In
Section IV, we present the results. Discussion and conclusions
are given in Sections V and VI, respectively.

2831

admitted for ablation treatment at Hospital Clı́nic de Barcelona
(Barcelona, Spain) and signed their informed consent. Fourteen electroanatomical maps were studied (ten right ventricle
maps, four left ventricle maps). Each map was acquired using
the CARTO 3 system (Biosense Webster, Inc., Diamond Bar,
CA, USA). It uses low-power electromagnetic fields from three
coils located in the back of the patient in order to triangulate
the position of the catheter within the heart and display it in a
computer screen [31].
For each patient, different number of mapping points were
acquired, large enough to have sufficient anatomical and electrical information to support the clinical decision. The EGM
onsets were manually obtained by the operator during the intervention in order to generate activation maps based on LATs and
to identify the early activation area defining the ablation target.
The total number of studied mapping points was 2138 (153 ±
67 points per map). Each point included 12-lead ECG signals
and bipolar EGM signals from a 4-pole NaviStar Thermocool
irrigated tip catheter (Biosense Webster, Inc., Diamond Bar, CA,
USA). For mapping and ablation purposes, the distal EGM signal from the catheter was used. Those signals were acquired
in a stepwise fashion with 1 kHz sampling frequency during
2.5 s assuring that the contact of the catheter tip was stable with
the myocardial wall and having at least one PVC beat in the
recording excerpt. The CARTO system stores the signal within
a window spanning 2 s before and 0.5 s after the fiducial point
of the PVC beat of interest. Bipolar EGM signals were bandpass filtered between 16 and 500 Hz with a 50 Hz power-line
suppression notch filter.
In addition to the manual annotations obtained during the
procedure (referred to in this paper as “on-procedure” annotations), a second type of annotations from two other expert technicians (blinded to the initial on-procedure annotation) were
obtained after the intervention (referred to in this paper as “offprocedure” annotations). For each point, the technician annotated the EGM activation onset as the start of the first steep
deflection. The LAT is then defined as the difference between
the EGM activation onset and the fiducial point of the QRS
complex.
III. METHODS
A. EGM Preprocessing: Signal Envelope

II. MATERIALS

During arrhythmias, a large variety of activation morphologies could be present in EGM signals with different causes
such as the passing of different activation wavefronts through
the catheter sensors, wavefront collisions, blocked or slow conductions, the relative position between the activation focus and
the electrodes or the contact of the electrode with the cardiac
tissue [32], [33]. Thus, in order to minimize the influence of
EGM morphological variations in detection performance, an
envelope-based preprocessing step is proposed.
Let an EGM activation x[n] be modeled as a positive valued
low-pass signal e[n] modulated by a cosine with modulation
frequency ωm and phase angle φ

The clinical database used in this study is composed of
ten patients suffering from non-tolerated PVC beats who were

x[n] = e[n] · cos(ωm n + φ).

(1)

2832

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig.1. EGM activations (bold line) and its envelope computation (dashed line): (a) Normal EGM activation, (b) noisy wide EGM activation, (c) low amplitude
EGM activation, and (d) fractionated EGM activation.

The envelope e[n] can be extracted by means of the analytic
signal of x[n] defined as in [34]
xa [n] = x[n] + j x̆[n]

(2)

where j is the imaginary unit and x̆[n] stands for the Hilbert
transform of the signal x[n], defined by
x̆[n] = H{x[n]} =

∞
1  x[k]
π
n−k

(3)

k =−∞

which is the convolution of x[n] with an impulse response
h[n] = 1/πn, known as the Hilbert transformer, whose transfer
function is

j, −π ≤ ω < 0
jω
H(e ) =
(4)
−j, 0 ≤ ω < π
thus x̆[n] is a 90◦ phase-shifted version of x[n]. Therefore, the
analytic signal xa [n] represents a frequency-shifted version of
the envelope e[n]
xa [n] = e[n] · ej w m n

(5)

from which the envelope e[n] can be directly obtained, without
any previous knowledge of the modulation frequency ωm or
phase angle φ, by means of the modulus

(6)
e[n] = |xa [n]| = x2 [n] + x̆2 [n].
Fig.1 shows representative examples of different EGM morphologies from the processed data and the computation of its
envelope. It is noteworthy the heterogeneity of activation morphologies and amplitude levels that can be found in EGM
signals.
B. Wavelet Transform
The continuous wavelet transform (CWT) is the decomposition of a given signal x(t) into a set of basis functions created
by dilation and translation of a single prototype function ψ(t)
called mother wavelet [35]. The CWT can be written as


 +∞
t−b
1
x(t)ψ
dt, a > 0
(7)
Wa x(b) = √
a
a −∞
where a is the expansion factor and b is the translation factor.
The CWT can be interpreted as the filtering of x(t) with an

√
impulse response h(t) = ψ(−t/a)/ a. The expansion factor
a modifies the bandwidth of the signal representation in the
CWT domain, i.e., the larger is a, the wider is ψ(t/a), and more
information about lower frequencies is included in the CWT
signal representation and vice versa.
If the prototype wavelet ψ(t) is the derivative of a smoothing
function θ(t), then (7) can be written as [36]
   +∞
d
x(t)θa (t − b)dt
(8)
Wa x(b) = −a
db
−∞
√
where θa (t) = (1/ a)θ(t/a) is the scaled version of the
smoothing function. Therefore, the CWT at scale a is proportional to the derivative of the convolution of x(t) with a smoothing impulse response at scale a. Then, the zero-crossings of the
CWT correspond to local maxima or minima of the smoothed
signal at different scales, and maximum or minimum values in
the CWT are respectively associated with maximum upward or
downward slopes in the smoothed signal.
Regarding our application, we are interested in locating the
EGM activation onset in order to automatically compute LATs
for activation maps. Therefore, these properties of the CWT
combined with the positive valued low-pass EGM activation
envelope e[n] allow to have a representation of signal peaks as
zero-crossings and its upward and downward slopes as maximum or minimum values in the CWT domain.
Given that the CWT is highly redundant, for implementation purposes, we consider a discrete signal e[n] and discretize the CWT by means of the “dyadic discrete wavelet
transform” (DWT). This consists of discretizing the timescale plane parameters a and b following a dyadic sampling
grid (a = 2m , b = 2m l; m ∈ N, l ∈ Z). Mallat and Zhong [36]
demonstrates that the DWT is equivalent to an octave filterbank that can be implemented as a cascade of identical cells of
low-pass and high-pass finite impulse response (FIR) filters followed by decimation stages. We used the algorithme à trous for
removing those decimation stages, keeping the time-invariance
representation of the signal and the temporal resolution of the
different scales while preserving the sampling rate [37]. The implemented analysis filter-bank of the Mallat’s algorithm using
the algorithme à trous is shown in Fig. 2.
We used the derivative of a quadratic spline as prototype
wavelet ψ(t) that was already proposed for QRS detection and

ALCAINE et al.: WAVELET-BASED ELECTROGRAM ONSET DELINEATOR FOR AUTOMATIC VENTRICULAR ACTIVATION MAPPING

Fig. 2. Mallat’s algorithm filter-bank implementation without decimation
stages (algorithme à trous) where G(z) and H(z) are low-pass and high-pass
FIR filters, respectively.

Fig. 3. Equivalent frequency responses of the DWT at scales 2m , m = 1 . . . 4
for 1 kHz interpolation sampling frequency.

delineation in ECG signals [27] and atrial fibrillation cycle
length analysis [19]. Using the algorithme à trous with this
prototype wavelet, the transfer function of the first four scales
for an interpolation sampling frequency of 1 kHz are shown in
Fig. 3. These transfer functions behave as low-pass differentiator
filters with linear phase [27]. Hence, the wavelet-based activation onset delineator presented in this paper can be considered
as a low-pass differentiator filter-bank.
C. Description of the Detection Algorithm
The algorithm presented in this paper is based in the outcomes
of a two-step signal analysis strategy, as illustrated in Fig. 4.
1) QRS Delineation of the Reference Beat: The main goal of
this detection step is to characterize the beat of interest and then
provide a reference window for the EGM delineation algorithm.
A single-lead wavelet-based QRS detector and delineator were
applied on each surface ECG lead [27]. This process identify
three time instants for each lead l and beat i within the recording
excerpt: 1) the onset of the ith QRS complex nl,i
o , 2) the fiducial
point of the ith QRS complex nl,i
(usually
related
with the R
f
.
wave), and 3) the end of the ith QRS complex nl,i
e

2833

Fig. 4. Block diagram of the signal analysis strategy. The EGM delineation
algorithm uses the DWT of the bipolar EGM activation envelope (top branch)
aided by the QRS delineation of the reference beat (bottom branch).

In this step, we are mainly interested in obtaining a global
view of each beat. Therefore, a multilead delineation is
performed using the rule algorithm described in [38]. These
rules were designed to include the spatiotemporal information
of each ECG lead while avoiding errors and miss-detections,
obtaining temporal marks that were in agreement across the
different leads of the recording.
After obtaining the multilead delineation, the nearest QRS
fiducial point to the reference time (2000 ms) defines the reference beat fiducial point nR
f . This point and its related onset and
and
nR
end time instants (nR
o
e ) describe the reference beat. The
onset and end time points of the reference QRS beat are used
to define the basic searching window S (marked as blue dotted
vertical lines in each panel of Fig. 5).
2) EGM Delineation Algorithm: After QRS detection and
delineation of the reference beat, an EGM delineation strategy
is applied to the DWT of the bipolar EGM signal envelope.
The strategy presented here is inspired on the multiscale approach used in [27], whose objective is to locate a set of local
maxima and minima across the different scales of the DWT,
called “Maximum Modulus Lines” (MML) [39]. The first step
of the algorithm is to locate the highest peak of the EGM signal envelope that define the “activation main wave”. Since the
EGM activation envelope is a positive peaked signal, the activation main wave is related with the zero-crossings between a pair
of positive and negative MMLs in the DWT domain. A local
maximum or minimum value at scale 2m can be considered a
part of a MMLs if it is higher than a threshold defined as

1
m
εEGM = m
(W2 m e[n])2 , m = 1 . . . 4
(9)
L
n ∈S

where 4 = 3/4 and m = 3/8, m = 1 . . . 3 are the threshold
scaling factors of each scale and L stands for the length of the
window S. Given the frequency content of the EGM envelope,
their frequency components are more likely to lie at scales 24
and 23 (see Fig. 3).
In this paper, we were mainly interested in locating EGM
activations during PVCs, and these can occur outside the QRS
complex boundaries of the reference beat. Therefore, S is extended in both ends by 30 ms defining the extended window S  .
Within S  , those local maxima and minima values exceeding at
scale 24 the threshold ε4EGM defined by (9) were detected.

2834

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig. 5. Automatic detection results in four representative EGM activation shapes: (a) Normal EGM activation, (b) noisy wide EGM activation, (c) low amplitude
EGM activation, and (d) fractionated EGM activation. Each panel shows, centered at the reference beat and from top to bottom: V5 surface ECG lead, distal EGM
lead from mapping catheter x[n], its envelope e[n] and the four first scales of the wavelet transform W 2 m e[n], m = 1 . . . 4 with the detected MMLs marked in
R
black dots. Blue dotted vertical lines shows the estimated QRS complex width (from n R
o to n e ) which serves as the search window S. Purple dashed vertical lines
connect the DWT characteristic landmarks (each one obtained from the crossing with the red dotted horizontal lines that represent for scale 21 the zero level and
G M and n E G M , respectively.
for scale 2 2 thresholds ξoE G M and ξeE G M ) with their resulting annotations: the main wave n E G M and its onset and end points n E
o
e

ALCAINE et al.: WAVELET-BASED ELECTROGRAM ONSET DELINEATOR FOR AUTOMATIC VENTRICULAR ACTIVATION MAPPING

If the extended search window was inadequate for finding at
least a pair of local maximum–minimum (LMM) at scale 24 ,
a new searching procedure was performed by extending 30 ms
S  , forward or backward depending on the sign of the already
detected local maxima and minima, and applying a threshold
reduction by 50% of the previous value. If there was no success
in the LMMs searching procedure at scale 24 , then scale 23
was used for LMM detection in combination with the threshold ε3EGM defined by (9). This scale includes higher frequency
components of the signal than scale 24 but it is usually noisier.
Once LMM pairs were located at the appropriate detection
scale (either 24 or 23 ), MML searching across the rest of the
scales was performed by connecting the local maxima and minima detected using their corresponding thresholds defined by
(9), followed by rejection of those isolated and redundant lines
in the same way as in [27].
When a single zero-crossing between a pair of positive and
negative MMLs at scale 21 is present, it is marked as the main
activation wave nEGM as shown in the two upper panels of
Fig. 5. In case that more than one zero-crossings exist between
a pair of positive and negative MMLs at scale 21 , the main wave
nEGM is determined by selecting among the possible pairs of
LMM candidates, the zero-crossing at scale 21 whose associated
LMM pair presents higher maximum-to-minimum value. The
result of this procedure can be seen in the two lower panels of
Fig. 5.
Once the activation main wave is detected, the next step of
the algorithm is to delineate the onset and end points of the
current EGM activation. The algorithm starts from the formerly
detected nEGM , which will be flanked by a pair of positive
and negative MMLs at scale 22 . Local maximum or minimum
values at scale 22 are related to up and down slopes of the EGM
signal envelope, respectively. Therefore, the EGM activation
is detected as the single first sample below a
onset point nEGM
o
threshold defined as
ξoEGM = γo · max(W2 2 e[n]), n ∈ So

(10)

where γo = 0.1 is the proportional threshold factor. This threshold is computed within a window So that spans 30 ms before
nEGM . An example of this delineation process is shown in
Fig. 5(a). In order to protect the method against fractionated
and noisy EGM activations, as those shown in Fig. 5(b)–(d), the
algorithm only considers those candidate samples lying within
the biggest upward slope at scale 24 . This scale is related with
the overall shape of the EGM activation envelope. Detection of
is done using a similar but
the EGM activation end point nEGM
e
symmetric procedure.
D. Evaluation Protocol
In the absence of a systematic well-established rule for LAT
measurement as “gold standard” for activation mapping, we
considered the manual annotations performed after the intervention (off-procedure annotations) as the reference for evaluation. The difference between annotations performed during
the procedure (on-procedure) with respect to the off-procedure

2835

TABLE I
ERRORS COMPARED WITH THE AVERAGED OFF-PROCEDURE ANNOTATIONS
SET INCLUDING THE INTEREXPERT DIFFERENCE (MEAN ± SD) AND
SPEARMAN’S RANK CORRELATION VALUE ρs
Map
(#)

Points
(#)

Automatic
(ms)

ρs

On-procedure
(ms)

ρs

Difference
(ms)

ρs

1
2
4
5
6
8
9
10
11
Total

134
116
190
220
234
208
172
197
202
1673

0.1 ± 7.1
1.2 ± 9
0.5 ± 6.3
0.7 ± 8.8
1.6 ± 8.4
5 ± 10.3
3.8 ± 12.6
4.1 ± 11.2
1.5 ± 17.9
2.1 ± 10.9

0.97∗
0.9∗
0.82∗
0.94∗
0.92∗
0.93∗
0.83∗
0.95∗
0.89∗
0.95∗

−3.3 ± 5.9
−2.9 ± 4.8
−3.1 ± 4.2
−6.7 ± 7.4
0.4 ± 3.8
−1.8 ± 7
−3.1 ± 6.2
−4.7 ± 8.1
1.4 ± 7.5
−2.6 ± 6.8

0.98∗
0.96∗
0.92∗
0.96∗
0.98∗
0.96∗
0.94∗
0.97∗
0.95∗
0.98∗

−2.2 ± 4.1
−0.8 ± 3.6
−1.3 ± 3.6
−1.7 ± 4.4
−0.3 ± 3.9
−1.1 ± 3.3
−1.1 ± 3.4
−0.6 ± 2.8
1.1 ± 8.0
−0.8 ± 4.5

0.99∗
0.97∗
0.95∗
0.99∗
0.97∗
0.98∗
0.98∗
0.99∗
0.95∗
0.99∗

∗

Indicates a p-value < 0.01.

annotations was considered as a reference for performance comparison.
Due to technician availability, only nine maps with annotations performed by both technicians were available. Therefore,
in order to have more reliable annotations for performance evaluation, we computed the average value between both sets of
annotations and create the “averaged off-procedure” annotation set which serves as evaluation reference. Additionally, we
defined the set of annotations performed by a single technician
named “off-procedure annotation set 1” (with fourteen maps
annotated) and “off-procedure annotation set 2” (with nine
maps annotated).
Errors between annotations were computed and mean ± standard deviation (SD) were presented. Due to the ordered nature of
LATs (i.e., from earliest to latest activated point) and in order to
estimate the agreement in the sequences of activations obtained
with the different LAT annotations, Spearman’s rank correlation
ρs has been computed. Additionally, we use Lin’s concordance
correlation factor ρc [40] and Bland–Altman analysis for assessing agreement between the different LAT annotations. A p-value
≤ 0.05 was considered as a threshold for statistical significance.
IV. RESULTS
A. Double Expert Assessment
The error of the proposed algorithm compared with the evaluation reference is shown in the third column of Table I. It is
noteworthy to point out that the bias of the error is positive,
thus meaning that the automatic method provides slightly later
LATs than the reference. For comparison purposes, the error of
the on-procedure annotations is shown in the fifth column of
Table I. This error has a negative bias thus meaning that the
on-procedure annotations provide slightly earlier LATs than the
reference.
Spearman’s rank correlation value ρs is shown in columns
four and six of Table I. The correlation of the automatic annotations with the evaluation reference is high (ρs = 0.95) but inferior than the on-procedure annotations (ρs = 0.98). Moreover,
all correlation values are statistically significant (p < 0.05).

2836

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

TABLE II
CLASSIFICATION OF ANNOTATIONS ACCURACY COMPARED WITH THE
AVERAGED OFF-PROCEDURE ANNOTATION SET
Automatic (% )

On-Procedure (% )

51
23
26

74
16
10

Highly accurate
Accurate
Inaccurate

Fig. 6. Lin’s concordance correlation factor ρc (left panels) and Bland–
Altman plots (right panels) for: (a) LAT assessment of the automatic annotations with the “averaged off-procedure” annotations, (b) LAT assessment of the
on-procedure annotations with the “averaged off-procedure” annotations, and
(c) interexpert LAT assessment. Pink line indicates the unitary slope line for
Lin’s ρc assessment. ∗ Indicates a p-value < 0.01. Red continuum line indicates mean error/difference and red slashed lines indicates mean ± 2SD of
error/difference.

The difference between off-procedure annotation sets, i.e.,
the interexpert variability, is shown in columns seven and eight
of Table I. The variability between experts can be considered
as a lower bound for automatic and on-procedure annotations
since a difference smaller than this could mean that the method
over adapt to one of the experts. Spearman’s correlation factor ρs shows a high correlation values (ρs = 0.99) indicating
the high level of agreement between technicians in the same
conditions.
Fig. 6 shows the Lin’s concordance correlation factor ρc (left
panels) and Bland–Altman plot analysis (right panels) for the
error (panels of rows (a) and (b) of Fig. 6) and the interexpert
variability (panels of row (c) of Fig. 6). Lin’s ρc confirm the
correlation found with Spearman’s ρs . Bland–Altman plots also
confirm the agreement found in Table I and show that the LATs
computed with the presented algorithm has a slight linear tendency (Pearson’s ρ = 0.37, p < 0.01) toward early estimation

of the early LATs with activation times from −150 to −50 ms
from the QRS fiducial point.
Inspired by the accuracy evaluation proposed by El Haddad
et al. [29], Table II shows the three-level accuracy distribution
of the automatic and on-procedure annotations compared with
the evaluation reference: 1) highly accurate annotations (error
≤ ± 5 ms), 2) accurate annotations (error within ± 5 ms and
± 10 ms), and 3) inaccurate annotations (error > ± 10 ms).
This table shows that the 74% of the mapping points annotation
obtained with the automatic algorithm are considered as accurate or highly accurate compared with the evaluation reference.
Nevertheless, the performance of the automatic detection is still
inferior to the 90% of on-procedure mapping point annotations
considered as accurate or highly accurate annotations.
These results demonstrate an agreement of the proposed
method with the expert manual annotations that is acceptable for
clinical application. Fig. 7 shows two representative examples
of 3-D activation maps obtained with all the LAT annotation
sets of this study. Those 3-D maps are generated by discretizing
the colorscale into 10 ms isochrone areas (defined as those areas
whose mapping point LATs lie within a temporal interval of 10
ms starting from the earliest activated EGM mapping point in
10 ms steps) as it is usually done in clinical practice [6]. The
earliest activation area is located in the right ventricle outflow
tract for all maps, since data are mainly coming from idiopathic
cardiomyopathy patients. Moreover, in both examples, a concentric spreading of the activation is more clearly seen in the
automatic reconstructed map, as it would be expected in case
of focal activity [11]. The effective ablation point (pink spheres
pointed by white arrows) lies within the two first isochrone areas in all cases. In those examples, errors of 3.8 ± 12.6 ms and
5 ± 10.3 ms for maps #9 and #8, respectively, do not result in a
lack of precision in determining the earliest activation area for
ablation of focal VTs.

B. Single Expert Assessment
As previously mentioned in Section III, the off-procedure
annotation set 1 has annotated all patients and maps of the
study database. In order to evaluate the performance of the
automatic method in all maps, we compute the error using this
set as an additional reference. This error as well as the error of
the on-procedure annotation are shown in Table III. It shows an
increment of the error, especially in the case of the automatic
annotations (2.2 ± 12.4 ms), as compared with results shown in
Table I.

ALCAINE et al.: WAVELET-BASED ELECTROGRAM ONSET DELINEATOR FOR AUTOMATIC VENTRICULAR ACTIVATION MAPPING

2837

Fig. 7. Example of two activation map #9 (labeled as 1) and #8 (labeled as 2) corresponding to the right ventricle shown in anterior-posterior (AP) view including
a zoom view (white square) of the earliest activation area: (a) LATs from the on-procedure annotation set, (b) obtained LATs with the automatic algorithm
presented in this paper, and (c) using the “averaged off-procedure” LATs annotation considered as evaluation reference. LATs are shown in 10 ms isochrone areas
color-coded from red (earlier) to pink (later) referenced to the QRS complex. White crosses indicate the acquired mapping points and pink spheres pointed by
white arrows indicate the effective ablation point/s that terminated the arrhythmia.

TABLE III
ERRORS COMPARED WITH THE OFF-PROCEDURE ANNOTATION SET 1 (MEAN ±
SD) AND SPEARMAN’S RANK CORRELATION VALUE ρs .
Map
(#)

Points
(#)

Automatic
(ms)

ρs

On-Procedure
(ms)

ρs

1
2
3
4
5
6
7
8
9
10
11
12
13
14
Total

134
116
163
190
220
264
49
208
172
197
202
96
87
40
2138

−1.2 ± 7.9
0.6 ± 9.4
10.8 ± 11.8
−0.3 ± 6.6
−0.3 ± 9.4
1.2 ± 8.8
7.4 ± 14.1
4.2 ± 10.7
3.0 ± 13
−4.6 ± 7.7
1.9 ± 18.7
5.2 ± 17.3
−1.0 ± 12.4
−7.3 ± 20.7
2.2 ± 12.4

0.96∗
0.9∗
0.9∗
0.82∗
0.94∗
0.91∗
0.68∗
0.92∗
0.82∗
0.95∗
0.86∗
0.68∗
0.59∗
0.4†
0.93∗

−4.6 ± 6.4
−3.5 ± 5.4
3.3 ± 5
−4.0 ± 5.5
−7.8 ± 8
0.2 ± 4.8
0 ± 5.3
−2.6 ± 7.4
−3.9 ± 6.8
−5.3 ± 8.5
1.7 ± 7.8
3.4 ± 6.7
2.1 ± 6.3
4.1 ± 5.4
−1.9 ± 7.5

0.97∗
0.94∗
0.98∗
0.9∗
0.95∗
0.97∗
0.96∗
0.95∗
0.93∗
0.96∗
0.96∗
0.91∗
0.81∗
0.93∗
0.97∗

∗

Indicates a p-value < 0.01 and † indicates a p-value < 0.05

C. Execution Time
A low-computational time of the algorithm is important for
being included into an EAM system software and for its application in real time during clinical routine. The complete process
of ECG and EGM detection and delineation is done in 760 ±
24 ms/mapping point with a regular computer (Windows 7 based
PC, Intel Core i7 3.4 GHz, 8 Gb RAM with MATLAB R2010a)
where only 14.7% of that time correspond to the EGM detection
and delineation itself (112 ± 6 ms/mapping point).

V. DISCUSSION
There is no clear consensus regarding the measurement of
LATs in bipolar EGMs [5], [10], especially when fractionated
or split potentials are present [1]. However, detection of the
earliest activation area by means of locating the onset of the
bipolar EGM has been shown to be useful for the treatment of
focal arrhythmias [5], [6]. In addition, some definitions of the
activation onset [10] seem to be arbitrary as they depend on the
amplitude scale of the activation. Hence, the identification of
the activation onset for LAT computation in activation mapping
is a strongly observer-dependent task that complicates the selection of a reliable reference annotations for evaluation.
EAM systems are useful tools for cardiac mapping as they
allow to have a 3-D location of the mapping catheter within
the patient’s heart combined with the electrical properties of the
cardiac substrate [1]. However, they do not provide an automatic
measurement of LATs using the EGM activation onset. Therefore, this must be made manually by the operator, turning into
a highly time-consuming task.
In this paper, we have presented an automatic wavelet-based
EGM delineation algorithm for activation mapping of focal VTs.
The complete process is the combination of a two-step signal
analysis. First, detection and delineation of the beat of interest in the surface ECG is performed. The second step uses
this delineation as a basic window for the EGM delineation
algorithm. The proposed algorithm exploits the DWT timescale characteristics of the EGM activation envelope signal in
order to identify the EGM activation onset providing an automatic activation mapping based on LATs. As a secondary

2838

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

result, the end of the activation is delineated in a symmetric manner and can be a useful measurement in further studies. In addition, this algorithm uses the same filter-bank structure as the QRS detector, hence providing unified scheme and
criteria.
Recently, an algorithmic detection of the onset and end of
bipolar EGM signal based in a four-state machine was presented for atrial tachycardias [29]. This algorithm identifies the
activation onset and end by counting the samples where a rectified band-pass filtered bipolar EGM activation is above or
below a set of thresholds adapted to the studied database by
trial-error process and its accuracy evaluation was done by visual inspection in a small set of electroanatomical mapping
points from randomized patients. Due to the lack of standard
databases with reference annotations by expert physicians and
the different objectives of both methodologies, its comparison
is rather difficult. Moreover, our method shows a simplest and
direct relation between threshold factor γ0 and annotation outcomes, making it more simple to adjust its performance. To our
knowledge, this paper is the first work comparing automatic
annotations with manual references of LAT based on EGM
onsets obtained during and after the intervention by different
experts.
Results suggest a good agreement between the proposed
method with expert annotations for clinical purposes. The error
compared with the combination of annotations from two experts
(average off-procedure annotation set) is 2.1 ± 10.9 ms and correlation with the evaluation reference is high (ρs = 0.95). The
error bias is positive, meaning that our method provides slightly
later LATs than the reference. In terms of the accuracy of the
annotations, 74% of the evaluated mapping points are considered as accurate or highly accurate. The error increases up to
2.2 ± 12.4 ms and the correlation decreases to ρs = 0.93 when
only the annotation set from a single expert is considered as
reference.
The automatic method does not perform better than the onprocedure annotations when compared with the evaluation reference (error of −2.6 ± 6.8 ms and ρs = 0.98). The negative
error bias indicates that the on-procedure annotations provide
slightly earlier LATs than the reference. Moreover, 90% of the
evaluated mapping points are considered as accurate or highly
accurate annotated. This better accuracy of the on-procedure
annotations can be explained by the fact that the three technicians use the same software for manual annotations that displays
in real time the activation map and signals, allowing to compare
the current measured onsets with those already acquired points
in the vicinity. This process allows the technicians to modify
their decision in order to obtain a smoothed spatially coherent
activation map, especially in the earliest activation area which
usually has the higher concentration of mapping points. This
is clearly an advantage with respect to the automatic method
since, at the time being, it does not exploit the anatomy or location of the mapping points and its vicinity relations. Future
work should be focused on adding spatially coherent constraints
in the delineation algorithm.
In terms of computational cost, our algorithm detects the
bipolar EGM activation onset in 112 ± 6 ms, a small percentage

of the total processing time per mapping point (760 ± 24 ms). It
also should be noted that the computation time associated with
the surface ECG delineation can be neglected in real applications
since it can be performed online. Based on the experience of
our technicians, the manual on-procedure annotations were performed within 3 to 4 s per point. Moreover, note that the larger
part of the acquisition time is due to the necessary operations of
the physician for positioning and stabilizing the catheter and the
occurrence of a PVC beat during the intervention. Therefore, the
computational time of the proposed signal processing method
can be considered negligible.
Threshold factors and intervals shown in this paper were selected based on our electrophysiological background and technical experience with surface ECG detection and delineation,
thus being a limitation of this study since we did not perform a
sensitivity analysis of them. Therefore, further investigation of
its influence and generalization to other datasets is needed.
VI. CONCLUSION
This paper presents an automatic wavelet-based strategy to
identify EGM activation onset for activation mapping during
focal VTs. If integrated with EAM systems, the proposed automatic method and its associated low computation costs could
help physicians and technicians to reduce signal acquisition
time and intervention since it is able to automatically identify
the EGM activation onset in less than 1 s. This could eventually be more beneficial when applied on EAM data acquired
with multielectrode catheters. These catheters are able to acquire multiple EGM signals at one single beat and thus generate
high-density activation maps, making the creation of accurate
activation maps based on LAT onsets unaffordable without automatic or semiautomatic signal processing techniques.
This paper is initially focused on focal VTs since more complex tachycardias, like those driven by conduction channels
in big areas of myocardium scar, require more complex and
adapted detection and characterization algorithms. Nevertheless, the presented algorithm can be a good starting point and
will be specifically adapted for the detection of conduction channels on ischemic patients [41].
REFERENCES
[1] E. M. Aliot, W. G. Stevenson, J. M. Almendral-Garrote, F. Bogun, C. H.
Calkins, E. Delacretaz, P. D. Bella, G. Hindricks, P. Jaı̈s, M. E. Josephson, J. Kautzner, G. N. Kay, K.-H. Kuck, B. B. Lerman, F. Marchlinski, V. Reddy, M.-J. Schalij, R. Schilling, K. Soejima, and D. Wilber,
“EHRA/HRS expert consensus on catheter ablation of ventricular arrhythmias: Developed in a partnership with the European Heart Rhythm
Association (EHRA), a registered branch of the European Society of
Cardiology (ESC), and the heart rhythm society (HRS); in collaboration
with the American College of Cardiology (ACC) and the American Heart
Association (AHA),” Europace, vol. 11, no. 6, pp. 771–817, 2009.
[2] H. Tada, K. Tadokoro, S. Ito, S. Naito, T. Hashimoto, K. Kaseno,
K. Miyaji, A. Sugiyasu, T. Tsuchiya, Y. Kutsumi, A. Nogami, S. Oshima, and K. Taniguchi, “Idiopathic ventricular arrhythmias originating
from the tricuspid annulus: Prevalence, electrocardiographic characteristics, and results of radiofrequency catheter ablation,” Heart Rhythm,
vol. 4, no. 1, pp. 7–16, 2007.
[3] B. B. Lerman, “Mechanism of outflow tract tachycardia,” Heart Rhythm,
vol. 4, no. 7, pp. 973–976, 2007.

ALCAINE et al.: WAVELET-BASED ELECTROGRAM ONSET DELINEATOR FOR AUTOMATIC VENTRICULAR ACTIVATION MAPPING

[4] B. Philips, S. Madhavan, C. James, C. Tichnell, B. Murray, M.
Needleman, A. Bhonsale, S. Nazarian, K. R. Laurita, H. Calkins, and
H. Tandri, “High prevalence of catecholamine-facilitated focal ventricular tachycardia in patients with arrhythmogenic right ventricular dysplasia/cardiomyopathy,” Circulation: Arrhythmia Electrophysiol.,
vol. 6, no. 1, pp. 160–166, 2013.
[5] C. Weiss, S. Willems, R. Rueppel, M. Hoffmann, and T. Meinertz, “ElecR
troanatomical mapping (CARTO	
) of ectopic atrial tachycardia: impact
of bipolar and unipolar local electrogram annotation for localization the
focal origin,” J. Int. Cardiac Electrophysiol., vol. 5, no. 1, pp. 101–107,
2001.
[6] C. Herczku, A. Berruezo, D. Andreu, J. Fernández-Armenta, L. Mont,
R. Borràs, E. Arbelo, J. M. Tolosana, E. Trucco, J. Rı́os, and J. Brugada, “Mapping data predictors of a left ventricular outflow tract origin of idiopathic ventricular tachycardia with V3 transition and septal
earliest activation,” Circulation: Arrhythmia Electrophysiol., vol. 5, no. 3,
pp. 484–491, 2012.
[7] R. John and W. Stevenson, “Catheter-based ablation for ventricular arrhythmias,” Current Cardiol. Rep., vol. 13, no. 5, pp. 399–406, 2011.
[8] F. Morady, A. H. Kadish, L. Di Carlo, W. H. Kou, S. Winston, M. deBuitlier, H. Calkins, S. Rosenheck, and J. Sousa, “Long-term results of
catheter ablation of idiopathic right ventricular tachycardia.” Circulation,
vol. 82, no. 6, pp. 2093–2099, 1990.
[9] M. S. Spach, W. T. Miller, E. Miller-Jones, R. B. Warren, and R. C. Barr,
“Extracellular potentials related to intracellular action potentials during
impulse conduction in anisotropic canine cardiac muscle.” Circulation
Res., vol. 45, no. 2, pp. 188–204, 1979.
[10] T. Paul, J. P. Moak, C. Morris, and A. Garson, Jr., “Epicardial mapping:
How to measure local activation?.” Pacing Clin. Electrophysiol., vol. 13,
no. 3, pp. 285–292, 1990.
[11] Z. Issa, J. M. Miller, and D. P. Zipes, Clinical Arrhythmology and Electrophysiology: A Companion to Braunwald’s Heart Disease. 2nd ed.
Philadelphia, PA, USA: Saunders, 2012.
[12] J. M. Hsing, P. Zei, H. H. Hsia, P. J. Wang, and A. Al-Ahmad, Cardiac
Mapping. 3rd ed. Hoboken, NJ, USA: Wiley, 2009, ch. 10.
[13] C. Han, S. M. Pogwizd, C. R. Killingsworth, and B. He, “Noninvasive
imaging of three-dimensional cardiac activation sequence during pacing
and ventricular tachycardia,” Heart Rhythm, vol. 8, no. 8, pp. 1266–1272,
2011.
[14] C. Liu and B. He, “Noninvasive estimation of global activation sequence
using the extended Kalman filter,” IEEE Trans. Biomed. Eng., vol. 58,
no. 3, pp. 541–549, Mar. 2011.
[15] V. Barbaro, P. Bartolini, G. Calcagnini, F. Censi, and A. Michelucci, “Measure of synchronisation of right atrial depolarisation wavefronts during
atrial fibrillation,” Med. Biol. Eng. Comput., vol. 40, pp. 56–62, 2002.
[16] U. Richter, A. Bollmann, D. Husser, and M. Stridh, “Right atrial organization and wavefront analysis in atrial fibrillation,” Med. Biol. Eng. Comput.,
vol. 47, no. 12, pp. 1237–1246, 2009.
[17] C. Schilling, M. Nguyen, A. Luik, C. Schmitt, and O. Dössel, “Non-linear
energy operator for the analysis of intracardial electrograms,” in Proc.
World Congress on Medical Physics and Biomedical Engineering 2010,
pp. 872–875.
[18] R. Houben, N. de Groot, and M. Allessie, “Analysis of fractionated atrial
fibrillation electrograms by wavelet decomposition,” IEEE Trans. Biomed.
Eng., vol. 57, no. 6, pp. 1388–1398, 2010.
[19] A. Alcaine, F. Simón, A. Arenal, P. Laguna, and J. P. Martı́nez, “A waveletbased activation detector for bipolar electrogram analysis during atrial
fibrillation,” in Proc. Comput. Cardiology, 2012, pp. 717–720.
[20] J. Ng, A. H. Kadish, and J. J. Goldberger, “Effect of electrogram characteristics on the relationship of dominant frequency to atrial activation rate
in atrial fibrillation,” Heart Rhythm, vol. 3, no. 11, pp. 1295–1305, 2006.
[21] G. Fischer, M. Stuhlinger, C.-N. Nowak, L. Wieser, B. Tilg, and F. Hintringer, “On computing dominant frequency from bipolar intracardiac
electrograms,” IEEE Trans. Biomed. Eng., vol. 54, no. 1, pp. 165–169,
2007.
[22] G. W. Botteron and J. M. Smith, “A technique for measurement of the
extent of spatial organization of atrial activation during atrial fibrillation
in the intact human heart,” IEEE Trans. Biomed. Eng., vol. 42, no. 6,
pp. 579–586, 1995.
[23] L. Faes, G. Nollo, R. Antolini, F. Gaita, and F. Ravelli, “A method for
quantifying atrial fibrillation organization based on wave-morphology
similarity,” IEEE Trans. Biomed. Eng., vol. 49, no. 12, pp. 1504–1513,
2002.

2839

[24] R. Alcaraz and J. J. Rieta, “Review: Application of non-linear methods in
the study of atrial fibrillation organization,” J. Med. Biological Eng., vol.
33, no. 3, pp. 239–252, 2013.
[25] P. Sanders, O. Berenfeld, M. Hocini, P. Jaı̈s, R. Vaidyanathan, L.-F. Hsu,
S. Garrigue, Y. Takahashi, M. Rotter, F. Sacher, C. Scavée, R. PloutzSnyder, J. Jalife, and M. Haı̈ssaguerre, “Spectral analysis identifies sites
of high-frequency activity maintaining atrial fibrillation in humans,” Circulation, vol. 112, no. 6, pp. 789–797, 2005.
[26] J. L. Salinet, Sr, G. N. Oliveira, F. J. Vanheusden, J. L. D. Comba,
G. A. Ng, and F. S. Schlindwein, “Visualizing intracardiac atrial fibrillation
electrograms using spectral analysis,” Comput. Sci. Eng., vol. 15, no. 2,
pp. 79–87, 2013.
[27] J. P. Martı́nez, R. Almeida, S. Olmos, A. P. Rocha, and P. Laguna, “A
wavelet-based ECG delineator: Evaluation on standard databases,” IEEE
Trans. Biomed. Eng., vol. 51, no. 4, pp. 570–581, Apr. 2004.
[28] T. Oesterlein, M. Keller, S. Schuler, A. Luik, M. Krüger, G. Seemann,
G. Seemann, C. Schmitt, and O. Dössel, “Determination of local activation time in bipolar endocardial electrograms: A comparison of clinical
criteria and a new method based on the non-linear energy operator,” J.
Electrocardiol., vol. 46, no. 4, Paper e18, 2013.
[29] M. E. Haddad, R. Houben, R. Stroobandt, F. V. Heuverswyn, R. Tavernier,
and M. Duytschaever, “Algorithmic detection of the beginning and end of
bipolar electrograms: Implications for novel methods to assess local activation time during atrial tachycardia,” Biomed. Signal Process. Control,
vol. 8, no. 6, pp. 981–991, 2013.
[30] A. Alcaine, D. Soto-Iglesias, D. Andreu, J. Fernández-Armenta, A.
Berruezo, P. Laguna, O. Camara, and J. P. Martı́nez, “Wavelet-based electrogram onset identification for ventricular electroanatomical mapping,”
in Proc. Comput. Cardiol., 2013, pp. 615–618.
[31] L. Gepstein, G. Hayam, and S. A. Ben-Haim, “A novel method for nonfluoroscopic catheter-based electroanatomical mapping of the heart: In vitro
and in vivo accuracy results,” Circulation, vol. 95, no. 6, pp. 1611–1622,
1997.
[32] J. L. Wells, R. B. Karp, N. T. Kouchoukos, W. A. Maclean, T. N. James,
and A. L. Waldo, “Characterization of atrial fibrillation in man: Studies following open heart surgery*,” Pacing Clin. Electrophysiol., vol. 1,
no. 4, pp. 426–438, 1978.
[33] K. T. Konings, J. L. Smeets, O. C. Penn, H. J. Wellens, and M. A. Allessie,
“Configuration of unipolar atrial electrograms during electrically induced
atrial fibrillation in humans,” Circulation, vol. 95, no. 5, pp. 1231–1241,
1997.
[34] J. G. Proakis, Digital Communications. 4th ed. Englewood Cliffs, NJ,
USA: Prentice-Hall, 2001.
[35] S. Mallat, A Wavelet Tour of Signal Processing. New York, NY, USA:
Academic, 1999.
[36] S. Mallat and S. Zhong, “Characterization of signals from multiscale
edge,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 14, pp. 710–732,
1992.
[37] A. Cohen and J. Kovačević, “Wavelets: The mathematical background,”
Proc. IEEE, vol. 84, pp. 514–522, 1996.
[38] P. Laguna, R. Jané, and P. Caminal, “Automatic detection of wave boundaries in multilead ECG signals: Validation with the CSE database,” Comput. Biomed. Res., vol. 27, no. 1, pp. 45–60, 1994.
[39] C. Li, C. Zheng, and C. Tai, “Detection of ECG characteristic points using
wavelet transforms,” IEEE Trans. Biomed. Eng., vol. 42, no. 1, pp. 21–28,
1995.
[40] L. Lin, A. S. Hedayat, B. Sinha, and M. Yang, “Statistical methods in
assessing agreement: Models, issues and tools,” J. Am. Statist. Assoc.,
vol. 97, no. 457, pp. 257–270, 2002.
[41] J. Fernández-Armenta, A. Berruezo, D. Andreu, O. Camara, E. Silva, L.
Serra, V. Barbarito, L. Carotenutto, R. Evertz, J. T. Ortiz-Pérez, T. M.
De Caralt, R. J. Perea, M. Sitges, L. Mont, A. Frangi, and J. Brugada,
“Three-dimensional architecture of scar and conducting channels based
on high resolution ce-cmr: Insights for ventricular tachycardia ablation,”
Circulation: Arrhythmia Electrophysiol., vol. 6, no. 3, pp. 528–537, 2013.

Authors’ photograps and biographies not available at the time of publication.

