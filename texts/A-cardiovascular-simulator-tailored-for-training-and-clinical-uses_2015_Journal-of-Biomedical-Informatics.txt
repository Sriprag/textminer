Journal of Biomedical Informatics 57 (2015) 100–112

Contents lists available at ScienceDirect

Journal of Biomedical Informatics
journal homepage: www.elsevier.com/locate/yjbin

A cardiovascular simulator tailored for training and clinical uses
L. Fresiello a,b,⇑, G. Ferrari b, A. Di Molfetta b, K. Zieliński c, A. Tzallas d, S. Jacobs a, M. Darowski c,
M. Kozarski c, B. Meyns a, N.S. Katertsidis d, E.C. Karvounis d, M.G. Tsipouras d, M.G. Trivella b
a

Department of Cardiac Surgery, Catholic University of Leuven, Leuven, Belgium
Institute of Clinical Physiology of the National Research Council, Rome and Pisa, Italy
c
Nałe˛cz Institute of Biocybernetics and Biomedical Engineering Polish Academy of Sciences, Warsaw, Poland
d
Biomedical Research Institute-FORTH, Ioannina, Greece
b

a r t i c l e

i n f o

Article history:
Received 1 December 2014
Revised 10 June 2015
Accepted 6 July 2015
Available online 11 July 2015
Keywords:
Ventricular assist device
Cardiovascular simulator
Training tool
Decision support system

a b s t r a c t
Objective: In the present work a cardiovascular simulator designed both for clinical and training use is
presented.
Method: The core of the simulator is a lumped parameter model of the cardiovascular system provided
with several modules for the representation of baroreﬂex control, blood transfusion, ventricular assist
device (VAD) therapy and drug infusion. For the training use, a Pre-Set Disease module permits to select
one or more cardiovascular diseases with a different level of severity. For the clinical use a Self-Tuning
module was implemented. In this case, the user can insert patient’s speciﬁc data and the simulator will
automatically tune its parameters to the desired hemodynamic condition.
The simulator can be also interfaced with external systems such as the Specialist Decision Support
System (SDSS) devoted to address the choice of the appropriate level of VAD support based on the clinical
characteristics of each patient.
Results: The Pre-Set Disease module permits to reproduce a wide range of pre-set cardiovascular diseases
involving heart, systemic and pulmonary circulation. In addition, the user can test different therapies as
drug infusion, VAD therapy and volume transfusion. The Self-Tuning module was tested on six different
hemodynamic conditions, including a VAD patient condition. In all cases the simulator permitted to
reproduce the desired hemodynamic condition with an error < 10%.
Conclusions: The cardiovascular simulator could be of value in clinical arena. Clinicians and students can
utilize the Pre-Set Diseases module for training and to get an overall knowledge of the pathophysiology of
common cardiovascular diseases. The Self-Tuning module is prospected as a useful tool to visualize
patient’s status, test different therapies and get more information about speciﬁc hemodynamic
conditions. In this sense, the simulator, in conjunction with SDSS, constitutes a support to clinical
decision – making.
Ó 2015 Elsevier Inc. All rights reserved.

1. Introduction
Due to the complexity of the cardiovascular system, computational and hydraulic simulators are becoming nowadays
more and more appreciated to get an overall understanding of
different pathophysiological conditions. In general, the use of
simulators for training and educational purposes is growing, so
that open source applications [1] or even mobile applications have
been developed [2].
⇑ Corresponding author at: Department of Cardiac Surgery, Catholic University of
Leuven, UZ Herestraat 49, Box 7003, 3000 Leuven, Belgium. Tel.: +32 484145286.
E-mail address: libera.fresiello@gmail.com (L. Fresiello).
http://dx.doi.org/10.1016/j.jbi.2015.07.004
1532-0464/Ó 2015 Elsevier Inc. All rights reserved.

Simulators can be either computational [3,4] or mock systems,
devoted to the testing and training of speciﬁc applications as perfusion techniques and ventricular assist devices (VADs1) [5–7].
1
List of abbreviations: AOP: mean systemic arterial pressure; AOPdias: diastolic
systemic arterial pressure; AOPsys: systolic systemic arterial pressure; CI: cardiac
index; CO: cardiac output; Diamed: ventricular end-diastolic diameter; Diames:
ventricular end-systolic diameter; EF%: ejection fraction; HR: heart rate; KVi?P:
coefﬁcient regulating the effect of Vi on P; LAP: left atrial pressure; LVed: left
ventricular end-diastolic volume; LVes: left ventricular end-systolic volume; Pa (Pp):
actual (previous) value of the parameter P; PAP: pulmonary arterial pressure; PCW:
pulmonary wedge pressure; PV loop: ventricular pressure–volume loop; RAP: right
atrial pressure; Rptot: total pulmonary resistance; Rstot: total peripheral resistance;
Tdecay: duration of diastole within a heart cycle; DP: mean aortic-ventricular
pressure difference.

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

101

Other simulators are partly numerical and partly computational and
are devoted either to the test of new devices or to the study of
patient–device interaction [8–10]. In addition, simulators can also
be used as a support to clinical decision – making. In this case, the
model is tailored to a patient’s data to reproduce the corresponding
hemodynamic condition. Then, one or more clinical therapies or
interventions can be simulated to check patient’s reaction and introduce possible improvements [11].
To be suitable for both training and clinical use, these models
have to meet the requirements of high ﬂexibility, low execution
time and intuitive user interface.
The present work is focused on developing a cardiovascular
simulator (CVS) for training and clinical use. CVS is developed as
a modular system offering a wide range of scenarios dedicated to
speciﬁc tasks and applications both for the training and the clinical
use. For the training use, the simulator can reproduce a wide range
of Pre-Set Diseases and can provide the hemodynamic outcome to
the user. Concerning the clinical use, the user feeds CVS with
patient’s speciﬁc data and the simulator performs a Self-Tuning
procedure to reproduce the desired patient’s condition. In addition,
CVS permits to simulate several therapeutical interventions as
drug infusion, ventricular mechanical assistance device and blood
loss or infusion.

by arterial resistance, compliance, vascular tone and venous resistance [12,14]. The pulmonary circulation is also split into arterial
and venous sections, each of them represented by a Windkessel
model [12]. Atria are represented as compliances while for both
ventricles the time-varying elastance model is used [15]. The ﬁlling
characteristic of the ventricle is represented with a series of
exponential functions [12]. A complete list of all the parameters
and their values used to simulate a standard subject is reported
in Table 1. These values refer to a standard healthy subject of
75–80 kg, therefore they will be indicated in the text as ‘‘reference’’
values (with subscript ref).

2. Materials and methods

2.4. Blood volume control module

2.1. Cardiovascular simulator overview

Blood volume can be either tailored to the patient’s weight or
changed manually by the user. In the latter case, the user can specify the rate and the total amount of blood to be infused/withdrawn
and observe the reaction in terms of hemodynamics output.

The cardiovascular simulator was developed under LabVIEW™
(National Instruments, Austin, TX, USA) and has a modular structure (see Fig. A1 for further details). The core of the simulator is
the numerical circulatory model, integrated with several modules,
each of them devoted to a speciﬁc application. Some of the
modules of the simulator were already described in previous works
[12,13]. Therefore a brief overview of the already published
modules and a detailed description of the new ones are provided
in this manuscript.
The user interface was also developed in LabVIEW™ (see
Fig. A2) and it is divided into four windows. The main window
contains the general interface providing pressure waveforms as
well as left and right ventricular pressure–volume loops (PV loops).
In addition, mean values of the main pressures and ﬂows are
calculated and presented at the end of each simulated cardiac
cycle. This interface includes also some control buttons to
activate/deactivate some applications of the simulator.
The other three interfaces are devoted to: Preset and Random
diseases modules, Self-Tuning module and therapies module (this
latter including VAD, drug administration and blood transfusion).
These three windows can be opened or closed from the main
interface, according to user needs.
To improve the readability of the present manuscript, it is useful
to specify that authors use the term ‘‘parameters’’ to indicate
CVS data as: resistances, compliances, inertances, elastances,
zero-pressure ﬁlling volumes and total blood volume. The term
‘‘variables’’ is used to indicate CVS outputs like ﬂows and pressures.
2.2. Cardiovascular module
The cardiovascular module is a lumped parameter model
providing a representation of left and right hearts, systemic and
pulmonary circulations. A detailed description of it was already
provided in [12]. The systemic circulation is split into: ascending
and descending aorta, upper body, renal, splanchnic, lower limbs
circulatory subsystems. Both sections of the aorta are represented
as a Windkessel model. The other vascular districts are represented

2.3. Baroreﬂex module
Baroreﬂex model was mainly taken from Ursino [16] and further adapted by the authors [12]. The model compares the actual
aortic pressure with a set-point value. This difference is used to
calculate both afferent and efferent nervous pathways. These latter
are split into sympathetic and vagal pathways regulating the
cardiovascular parameters through a ﬁrst order system. More in
detail, the sympathetic nerve activity controls heart rate, ventricular contractility, arterial peripheral resistance and venous tone. The
vagal nerve activity controls only heart rate.

2.5. VAD module
The VAD module includes a representation of three types of
ventricular assist devices: HeartMate II (Thoratec CorporationÒ,
Pleasanton, CA, USA), HeartWare and CircuLite Synergy
Micropump (HeartWareÒ, Framingham, MA, USA). For each VAD,
the relationship between pump head and ﬂow is represented
according to a polynomial equation:

DP ¼ a  Q 2 þ b  Q þ c

ð1Þ

where Q is the VAD ﬂow and DP is the pressure drop across the
VAD. The parameters a, b, c were estimated from VAD
pressure-ﬂow static characteristics and their values change
according to the VAD speed selected by the user. As HeartMate II
and HeartWare have an apical insertion, DP will be the pressure
drop between the left ventricular pressure and aortic pressure. In
the case of CircuLite Synergy Micropump, the DP will be the pressure drop between the left atrial pressure and the aortic pressure.
2.6. Drug infusion module
This module is an extension of Gopinath model [17] and was
already described in [13]. The user can select the rate of infusion
and then the model provides the concentration of the drug in each
vascular compartment as well as its rate of consumption (according to drug half-life) as output. The drug module provides a
description of the main effects of sodium nitroprusside (SNP) on
systemic vascular resistance.
2.7. Preset diseases module
This module is conceived to provide users with a speciﬁc interface
where one or more pathological conditions can be activated. The user
can activate one or more diseases and also select the level of severity.

102

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112
Table 1
Cardiovascular parameters – reference values.
Symbol

Parameter

Default value

LV0ref/RV0ref

Left/Right rest volume

5/5 cm3 [15]

Emaxlref/Emaxrref

Left/Right systolic Elastance

2.5/1.01 mmHg/cm3 [12]

Edlref/Edrref

Left/Right diastolic function
al-b-cl-dl
ar-br-cr-dr
Left/Right atrioventricular valve resistance
Aortic/Pulmonary valve resistance

0.035–0.035–0.03–0.3
0.042–0.042–0.045–0.3
0.02/0.02 mmHg s/cm3 [12]
0.02/0.02 mmHg s/cm3 [12]

Resistance
Inertance
Compliance

0.01 mmHg s/cm3 [12]
5  105 mmHg s2/cm3 [4]
0.8 cm3/mmHg

Zero-pressure ﬁlling volume

400 cm3

Resistance
Inertance
Compliance

0.07 mmHg s/cm3 [12]
5  105 mmHg s2/cm3 [4]
0.6 cm3/mmHg [12]

Zero-pressure ﬁlling volume

315 cm3

Arterial resistance

3.9 mmHg s/cm3 [14]

Cubref

Venous resistance
Compliance

0.23 mmHg s/cm3 [14]
8 cm3/mmHg [14]

Vub0ref

Zero-pressure ﬁlling volume

650 cm3 [14]

Arterial resistance

4.1 mmHg s/cm3[14]

Ckidref

Venous resistance
Compliance

0.3 mmHg s/cm3 [14]
15 cm3/mmHg [14]

Vkid0ref

Zero-pressure ﬁlling volume

150 cm3 [14]

Arterial resistance

3.0 mmHg s/cm3 [14]

Cspref

Venous resistance
Compliance

0.18 mmHg s/cm3 [14]
55 cm3/mmHg [14]

Vsp0ref

Zero-pressure ﬁlling volume

1300 cm3 [14]

Arterial resistance

3.6 mmHg s/cm3[14]

Cllref

Venous resistance
Compliance

0.3 mmHg s/cm3 [14]
19 cm3/mmHg [14]

Vll0ref

Zero-pressure ﬁlling Volume

350 cm3 [14]

Csupref

Resistance
Compliance

0.06 mmHg s/cm3 [14]
15 cm3/mmHg [14]

Vsup0ref

Zero-pressure ﬁlling volume

10 cm3 [14]

Cinfref

Resistance
Compliance

0.015 mmHg s/cm3 [14]
27 cm3/mmHg [14]

Vinf0ref

Zero-pressure ﬁlling volume

325 cm3[14]

Charact. resistance
Arterial compliance
Arterial resistance
Arterial inertance
Zero-pressure ﬁlling volume

0.005 mmHg s/cm3 [4]
3 cm3/mmHg [14]
0.075 mmHg s/cm3 [4]
3.6  105 mmHg s2/cm3 [4]
90 cm3 [14]

Vap0ref

Venous resistance
Venous compliance
Zero-pressure ﬁlling volume

0.005 mmHg s/cm3 [4]
3 cm3/mmHg [14]
580 cm3 [14]

Total circulation
TOTVolref
BodyWeightref

Total blood volume
Total body weight

5425 cm3
77.5 kg

Baroreﬂex control
PasSETref

Baroreﬂex set point pressure

98 mmHg

Left (Right) ventricle

Rliref/Rriref
Rloref/Rroref
Ascending aorta and aortic arch
Ra1ref
La1ref
Ca1ref
Va10ref
Descending aorta
Ra2ref
La2ref
Ca2ref
Va20ref
Upper body circulation
Rubaref
Rubvref

Kidney circulation
Rkidaref
Rkidvref

Splanchnic circulation
Rsparef
Rspvref

Lower limbs circulation
Rllaref
Rllvref

Superior Vena Cava
Rsupref

Lower Vena Cava
Rinfref

Pulmonary arterial circulation
Rcpref
Capref
Rapref
Lapref
Vap0ref
Pulmonary venous circulation
Rvpref
Cvpref

Underlined parameters are changed during the Self-Tuning procedure.

103

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

The selected diseases included in the module are: ischemic cardiomyopathy, dilated cardiomyopathy, hypertrophic cardiomyopathy, right
heart failure, aortic regurgitation, aortic stenosis, mitral regurgitation,
systemic hypertension, pulmonary hypertension. Diseases not compatible each other (i.e. dilated and hypertrophic cardiomyopathy) cannot be activated simultaneously.
2.8. Random Disease module
As a second option, the user can activate the Random Disease
module, meaning the simulator will automatically generate one
or more diseases in a blind modality and provide to the user the
resulting hemodynamic condition. The idea behind this is that
the user does not know in advance the combination of diseases
generated by the simulator, so he/she will try to disclose the hemodynamic condition provided by the simulator, adopting the proper
therapeutic actions.
Parameters values used to simulate different diseases are
reported in Table 2. Some comments about the choice of parameters are reported in the discussion section.

The simulator performs the Self-Tuning also in case of VAD
assistance, both for apical and atrio–aortic connections. For apical
VAD, the user will have to insert also the VAD ﬂow (VADﬂow⁄)
and patient total cardiac output (CO⁄). The difference
CO⁄–VADﬂow⁄ will correspond to the left ventricular output ﬂow
in the aorta (Qol⁄).
For atrio–aortic assistance, the user will have to insert only
VADﬂow⁄. In this case, in fact, Qol⁄ can be estimated from ventricular volumes (LVes⁄ and LVed⁄) and from HR⁄.
The Self-Tuning is a two steps procedure, they are described in
the following paragraphs.
2.9.1. STEP 1
Initially, the following volumes are estimated from the target
data:
 Total blood volume (TOTVol⁄): estimated according to the ‘‘normal’’ ratio blood volume/weight of 75 cm3/kg [18].
 LVes⁄ and LVed⁄: estimated on the basis of echocardiographic
measurements. If the ventricular diameter alone is available,
the ventricular volume is estimated using the Teicholz
formula:

2.9. Self-Tuning module

3



LVed ¼ 7  ðDiamed Þ =ð2:4 þ Diamed Þ
This module is devoted to the representation of a patient’s
speciﬁc hemodynamic condition. When activated, a dedicated
window appears where the user can insert the patient’s data
that will be used as target data by the simulator. More in detail,
target data are used to calculate model parameters and to perform the Self-Tuning procedure. At the end of the operation,
the simulated data are compared with the corresponding target
data. If they differ less than the tolerance level, the model is
tuned and the procedure is ended (the tolerance level is the
maximum acceptable difference between the target data and
the simulated one).
The Self-Tuning procedure requires as input the following
haemodynamic data (they are marked with ‘‘⁄’’ to indicate they
are the patient’s speciﬁc data): heart rate (HR⁄) – BodyWeight⁄ –
Height⁄ – mean systemic arterial pressure (AOP⁄) – systolic
systemic arterial pressure (AOPsys⁄) – diastolic systemic arterial
pressure (AOPdias⁄) – left atrial pressure (LAP⁄) – pulmonary arterial pressure (PAP⁄) – right atrial pressure (RAP⁄) – left ventricular
end-systolic (end-diastolic) volume LVes⁄ (LVed⁄), duration of
diastole within a heart cycle (Tdecay⁄).

ð2Þ

3

LVes ¼ 7  ðDiames Þ =ð2:4 þ Diames Þ









With Diames (Diamed) left ventricular at end-systolic
(end-diastolic) diameter.
Left ventricular zero pressure ﬁlling volume (LV0): a ﬁrst preliminary estimation is done using an empirical equation
obtained from [19]. Data concerning LVes and LV0 taken from
[19] were used to perform a linear regression analysis. The
resulting equation is LV0 = 1.344  LVes-138.2.
Left ventricular end-systolic elastance (Emaxl): estimated on the
basis of the Suga–Sagawa model [15] using as input data LV0
previously estimated, LVes⁄ and AOPsys⁄ (if the peak systolic
ventricular pressure is not available).
Left ventricular diastolic function (Edl): a linearization of the
ﬁlling characteristic is performed. The diastolic line is calculated
using the ratio between the end-diastolic left ventricular pressure and volume.
Total pulmonary resistance (Rptot) and total systemic resistance
(Rstot): estimated as the ratio between the pressure drop across
the circulation itself and CO⁄.

Table 2
Preset diseases – parameters values.
Disease

Ischemic cardiom.
Dilated cardiom.
Hypertrophic cardiom.
Right heart failure
Aortic regurgitation
Aortic stenosis
Mitral regurgitation
Systemic hypertension

Pulmonary hypertension

Param.

Els
LV0
al-bl-cl-dl
al-bl-cl-dl
Emaxr
RV0
Rloinv
Rli
Rliinv
Ca1
Ca2
Ruba
Rkida
Rspa
Rlla
Rap

Values refer to 3 different levels of severity of the disease.

Values
Mild

Moderate

Severe

1.5
25
0.03–0.03–0.03–0.3
0.05–0.05–0.035–0.3
0.9
15
500
40
500
0.06
0.78
5.07
5.33
3.9
4.68
0.1

1
50
0.03–0.028–0.03–0.3
0.06–0.06–0.350.3
0.7
30
300
80
300
0.45
0.3
6.24
6.56
4.8
5.76
0.14

0.5
75
0.0025–0.025–0.03–0.3
0.07–0.07–0.35–0.3
0.4
45
150
120
150
0.25
0.15
7.41
7.79
5.7
6.84
0.2

104

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

 Aortic compliance split into aortic arch – ascending aorta (Ca1)
and descending aorta (Ca2): they are estimated on the basis of
the aortic pressure decay method [20]. The formula used is
reported in Fig. A3 and it involves the following parameters:
AOPsys⁄, AOPdias⁄, Rstot (calculated as indicated above) and
Tdecay⁄. AOPsys⁄ is an approximation of AOP⁄ at the dicrotic
notch (as invasive pressure measurements are not always available). If electrocardiographic data are not available and therefore Tdecay⁄ is not measured, the model estimates it
automatically on the basis of HR⁄, according to the following
empirical formula derived from [21]:
2

S=D ¼ HR  0:0001  HR  0:017 þ 1:297
Tdecay ¼ 60=HR  ð1 þ S=DÞ

ð3Þ

where S/D is the systole to diastole duration ratio.
 Arterial peripheral resistances in speciﬁc circulatory districts as
upper body (Ruba), kidneys (Rkida), splanchnic (Rspa), lower
limbs (Rlla): they are estimated on the basis of Rstot and considering a repartition of total cardiac output of 23% for upper body,
22% for kidneys, 30% for splanchnic circulation and 25% for
lower limbs [14].
 Venous systemic resistances (Rubv, Rkidv, Rspv, Rllv): their values are taken from [14].
 Venous compliances (Cub, Ckid, Csp, Cll, Cinf, Csup): their reference values, reported in Table 1, are characterized according
to [14] that refer to a subject of 75–80 kg. The resulting reference total venous systemic compliance is 139 cm3/mmHg that
divided by body weight provides a ratio of 1.80 cm3/
(mmHg kg)1. This value is in agreement with the ratio of
2.3 ± 0.7 cm3/(mmHg kg)1 reported by Takatsu et al. [22]. On
the basis of this relationship present in the literature, the
venous compliance is tuned according to patient’s body weight
as it follows:

Ci ¼ Ciref  BodyWeight=BodyWeightref

ð4Þ

 Where Ci is the venous compliance of the ith vascular district at
patient’s speciﬁc body weight (BodyWeight), Ciref is the corresponding value at the reference BodyWeightref of 77.5 kg (see
Table 1).
 Venous tones (Vaa0, Vabd0, Vub0, Vkid0, Vsp0, Vll0, Vsup0, Vinf0,
Vap0, Vvp0) are estimated on the basis of a reference value for
each of them (see Table 1) and then adapting their values
according to BodyWeight⁄ as it follows.


Vi ¼ Viref  BodyWeight =BodyWeightref

ð5Þ

2.9.2. STEP 2
The recursive procedure is executed and: on the basis of the
comparison between target and simulated data, some parameters
are further tuned. These parameters are: TOTVol, Emaxl, Emaxr,
Edr and LV0. Parameters are usually changed as it follows:

P a ¼ Pp þ DViP þ DViiP þ   




DViP ¼ ðVi  Vi Þ  K Vi!P =Vi

ð6Þ

where Pa (Pp) is the actual (previous) value of the generic parameter
P, DViP is the variation of P due to the variable Vi. The variation DViP
is calculated on the basis of the target data (Vi*) and the value Vi
obtained from the simulation. In addition the coefﬁcient KVi?P is
used to regulate the weight with which a variable affects a
parameter.
At the end of the tuning procedure, an overall check of all the
variables is made. The procedure for this is the following:

m

Vi



¼ ð100  tolÞ  Vi =100

M



¼ ð100 þ tolÞ  Vi =100


m
M
if Vi < Vi < Vi
model is tuned else repeat step 2

Vi

ð7Þ

where Vi is the value of the variable obtained from the simulation.
Vi*M (Vi*m) is the upper (lower) value that is accepted for Vi, tol is the
tolerance (usually a tol = 10 is considered). If all variables Vi are
within the range, then the simulation is considered acceptable
and the Self-Tuning procedure is stopped. If the simulated variable
is still too different from the target data, a new tuning loop is executed. A block diagram of the Self-Tuning procedure is reported in
the Appendix A section (Fig. A3).
2.10. Specialist Decision Support System (SDSS)
The SDSS is a Web 2.0 application (based on HTML5, CSS and
Ajax) connectable to the CVS [23] and developed in the frame of
SensorART EU project [24,25]. The SDSS provides advanced functionalities that emphasize user-generated content, usability, and
interoperability through a standard Web browser [26]. Thus, the
specialists are able to have access from multiple locations utilizing
familiar procedures and intuitive interfaces. The SDSS consists of a
set of tools, and enables authorized access to the corresponding
functionalities. Rather than addressing a single issue, it provides
specialists with advanced
data-driven techniques and
expert-knowledge techniques and is composed of the following
tools:
 Association rules tool: It adopts intelligent data-mining techniques in order to enable the specialists to easily search for
trends and shifts, as well as identify interesting interrelations
and extract new knowledge from multiple and heterogeneous
data.
 Statistics tool: It provides to the specialists a complete set of
statistics tools in order to analyze and interpret patient data;
examine the results of previous therapeutic regimens, and
obtain quantitative explanations of the observations.
 Weaning tool: It combines expert knowledge with multivariate
statistical analysis, in order to support the specialists on the
weaning decision. It enables them to create and maintain expert
models (in the form of clinical rules related to the overall health
and cardiovascular status of a subject), and run these models
against their patients. Data driven techniques are also employed
in order to enhance the models and effectively exploit past
patient data.
 Treatment tool: It includes several acknowledged risk scores and
models allowing the specialists to build risk proﬁles for their
patients, take rapid decisions, and foresee possible complications after VAD implant.
 Speed Optimization Tool: Using simulated data from the Speed
Optimization Tool enables the specialists to investigate the
potential effect of different VAD speeds on important hemodynamic variables, and determine an optimal pump speed that
maintains a safe physiological operating point, while providing
adequate cardiac output for the patient. This application was
already shown in [23].
3. Results
3.1. Pre-Set Diseases
In this section some examples of Pre-Set Diseases are shown.
The diseases activated on the simulator and the relative level of
severity are indicated in italic, for the corresponding parameters
values please refer to Table 2.

105

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

In Fig. 1 some Pre-Set Diseases of the left ventricle are
shown. Data refer to left ventricular pressure–volume (PV) loops
in: (1) physiological condition, (2) severe post-ischemic cardiomyopathy (severe ischemic cardiomyopathy + severe dilated
cardiomyopathy) causing an extreme dilation of the left
ventricle, (3) the previous pathological condition combined with
a moderate systemic hypertension, (4) severe hypertrophic
cardiomyopathy.
In Fig. 2 the PV loops of the cardiovascular model relative to
valve diseases simulation are shown. Data refer to: (1) moderate
post-ischemic cardiomyopathy (moderate ischemic cardiomyopathy + moderate dilated cardiomyopathy), (2) condition at point 1
plus severe aortic regurgitation, (3) condition at point 1 plus severe
mitral regurgitation, (4) mild hypertrophic cardiomyopathy plus severe aortic stenosis.
In Fig. 3 the right ventricular PV loops are shown: (1) physiological condition, (2) severe right heart failure and (3) condition at
point 2 plus a moderate pulmonary hypertension.

3.2. Therapeutic interventions
As previously mentioned, therapeutic interventions mainly concern VAD, drug infusion and blood volume control.
As an example, the effects of different VADs in a dilated left ventricle, due to a severe degree of ischemic disease (severe ischemic
cardiomyopathy + moderate dilated cardiomyopathy), are provided
in Fig. 4. Results concern the effects of the three different numerical
models of VADs: HeartMate II, HeartWare in apical connection and
CircuLite Synergy Micropump in atrio–aortic connection. The
HeartMate II is activated at a speed of 10,500 rpm to provide a ﬂow
of 5.3 l/min, the HeartWare is activated at a speed of 2200 rpm to
provide a ﬂow of 4.6 l/min and the CircuLite Synergy Micropump
is activated at a speed of 24,000 rpm to provide a ﬂow of
3.6 l/min. In this latter case the CircuLite provides a partial support
so that the left ventricle is still contributing to the total cardiac output with a ﬂow of 0.6 l/min.
The effects of blood transfusion and of sodium nitroprusside
(SNP) infusion are shown in Fig. 5. SNP was provided with a rate
of 3 lg/kg/min, while the total amount of blood transfused was
500 ml.

140

1

Plv [mmHg]

120
100

3
80

35

2

4

30

1

60

Prv [mmHg]

25

40
20
0
0

50

100

150

200

250

300

3

20

2

15
10

350

Vlv [cm3]

5

(1) Physiological Condion
(3) Ischemic Cardiom. + Dilated Cardiom. + Systemic Hypertension
Emaxl Ischemic Cardiom.
Edl Hypertrophic Cardiom.
Edl Dilated Cardiom.

(2) Ischemic Cardiom. + Dilated Cardiom.
(4) Hypertrophic Cardiom.
Emaxl Physiological
Eld Physiological

0

0

20

40

60

80

100

120

140

Vrv [cm 3]

Fig. 1. Left ventricular PV loop in four different conditions: (1) physiological
condition, (2) severe ischemic cardiomyopathy + severe dilated cardiomyopathy,
(3) severe ischemic cardiomyopathy + severe dilated cardiomyopathy + moderate
hypertension, (4) severe hypertrophic cardiomyopathy. Dashed lines indicate the
end-systolic elastance and the diastolic function for each condition.

Physiological condion

Right Heart Failure

Emaxr Physiological

Emaxr Right Heart Failure

Right Heart Failure + Pulm. Hypertension

Fig. 3. Right ventricular PV loops in three different conditions: (1) physiological
condition, (2) right heart failure, (3) right heart failure + pulmonary hypertension.

160
90

4

140

80

100

2
3

80

2
3 1

70

1
Plv [mmHg]

Plv [mmHg]

120

60
40

60

4

50
40
30
20

20

10
0

0
0

50

100

150

200

250

300

Ischemic Cardiom. + Dilated Cardiom
Ischemic Cardiom. + Dilated Cardiom.+ Mitral Reg.
Emaxl Ischemic Cardiom.

120

140

160

180

200

220

240

260

280

Vlv [cm3 ]

Vlv [cm3]
Ischemic Cardiom. + Dilated Cardiom. + Aorc Reg.
Hypetrophic Cardiom.+ Aorc Stenosis
Emaxl Hypertrophic Cardiom.

Fig. 2. Left ventricular PV loops in four different conditions: (1) moderate ischemic
cardiomyopathy + moderate dilated cardiomyopathy, (2) moderate dilated cardiomyopathy + moderate ischemic cardiomyopathy + severe aortic regurgitation,
(3) moderate ischemic cardiomyopathy + moderate ischemic cardiomyopathy + severe mitral regurgitation, (4) mild hypertrophic cardiomyopathy + severe
aortic stenosis.

Ischemic Cardiom. + Dilated Cardiom.
Ischemic Cardiom. + Dilated Cardiom. + HeartWare
Emaxl Ischemic Cardiom.

Ischemic Cardiom. + Dilated Cardiom. + Circulite
Ischemic Cardiom. + Dilated Cardiom. + HeartMate II

Fig. 4. Left ventricular PV loops in four different conditions: (1) severe ischemic
cardiomyopathy + moderate dilated cardiomyopathy, (2) severe post-ischemic
cardiomyopathy + moderate dilated cardiomyopathy + CircuLite (24,000 rpm), (3)
severe post-ischemic cardiomyopathy + moderate dilated cardiomyopathy +
HeartWare (2200 rpm), (4) severe post-ischemic cardiomyopathy + moderate
dilated cardiomyopathy + HeartMate II (10,500 rpm).

106

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

160
140

2b

1

2a

Plv [mmHg]

120

3b
100

3a

80
60
40
20
0
0

50

100

150

200

If we consider the same experiments but including also the
baroreﬂex control (conditions 2b and 3b in Fig. 5), we observe
smaller changes of the PV loops, due to the action of both sympathetic and parasympathetic nerves that try to keep homeostasis by
changing parameters as HR and Rstot. As for example during blood
infusion HR decreases from 65 bpm to 62 bpm to counteract the
increment of blood pressure. During SNP infusion the baroreﬂex
counteracts the vasodilation: without baroreﬂex control the decrement of Rstot is 43%, while with the baroreﬂex control the total
decrement of Rstot is 36%.
Some additional data of the hemodynamic conditions shown in
Figs. 1–5 are summarized in Table 3.

Vlv [cm 3]
Physiological Condion

SNP 3μg/kg/min + Baroreﬂex

Blood infusion (500 ml) +Baroreﬂex

Emaxl Physiological

SNP 3μg/kg/min

Blood infusion (500 ml)

Fig. 5. Left ventricular PV loops in three different conditions: (1) physiological
condition, (2a) physiological condition + blood transfusion of 500 ml, (2b)
physiological condition + blood transfusion of 500 ml + baroreﬂex control, (3a)
physiological condition + SNP infusion, (3b) physiological condition + SNP infusion +
baroreﬂex control.

Experiments were performed two times, the second time also
the effect of baroreﬂex control was considered (for more details
about this modules please refer to [13]).
Blood transfusion (condition 2a in Fig. 5) mainly affects
ventricular preload, resulting in an increment of LVed (from
141 cm3 in physiological condition to 164 cm3). As a consequence, ventricular stroke volume increases as well (from
89 cm3 in physiological condition to 102 cm3 after blood
transfusion).
SNP administration (condition 3a in Fig. 5) provokes a systemic
vasodilation thus reducing the outﬂow pressure the left ventricle
has to overcome in systole (peak ventricular pressure of
131 mmHg in physiological condition vs. 118 mmHg after SNP).
As a consequence, the left ventricle can easier eject blood in the
aorta, so that stroke volumes increases from 86 cm3 in physiological condition to 109 cm3 after SNP.

3.3. Self-Tuning module
The veriﬁcation of the model Self-Tuning module was performed using literature and clinical data. Different diseases have
been chosen, in order to test model performance in a wide range
of hemodynamic conditions. A list of these conditions is reported
in Table 4 with the relative hemodynamic data. They refer to:
Left ventricular Ischemic Cardiomyopathy (LIC-CASE 1), Left ventricular Dilated Cardiomyopathy (LDC-CASE 2, LDC-CASE 3,
LDC-CASE 4), Right Ventricular Dysfunction (RVD-CASE 5).
Furthermore, a VAD implanted patient condition was considered
(CircuLite-CASE 6). This latter case was not taken from literature,
but was provided by the Cardiac Surgery Department of the
Catholic University of Leuven. Data refer to VAD implantation
and were acquired just during the implanting surgery at VAD
onset.
All data mentioned above were used to feed and to test the
Self-Tuning module; the results are reported in Table 5. Data in
brackets indicate the percentage difference between the simulated
data and the corresponding target data.
4. Discussion
Aim of the presented work is to develop a computational simulator both for training and clinical use. This simulator is conceived

Table 3
Hemodynamic data corresponding to conditions in Figs. 1–5.
Fig. 1

Left EF%

LVes/LVed [cm3]

CO [l/min]

AOP sys/dias(mean) [mmHg]

PAP sys/dias(mean) [mmHg]

PCW [mmHg]

1
2
3
4

63
20
16
61

141/52
281/225
290/244
89/34

5.7
3.6
2.9
3.5

119/80 (99)
73/48 (60)
82/62 (72)
74/51 (62)

27/6 (14)
43/29 (33)
47/35 (39)
48/34 (39)

6
28
35
34

Fig. 2

Left EF% – regurgitation fraction

LVes/LVed [cm3]

CO [l/min]

AOP sys/dias(mean) [mmHg] – DP

PAP sys/dias(mean) [mmHg]

PCW [mmHg]

1
2
3
4

33
45–56
59–57
60

224/150
264/146
243/106
120/48

4.7
3.4
3.8
4.6

99/67
95/44
80/54
95/66

35/17
46/32
43/28
38/21

16
32
28
20

Fig. 3

Right EF%

RVes/RVed [cm3]

CO [l/min]

AOP sys/dias(mean) [mmHg]

PAP sys/dias(mean) [mmHg]

RAP [mmHg]

1
2
3

74
33
29

118/30
123/82
129/91

5.7
4.2
3.0

119/80 (99)
91/63 (77)
68/48 (58)

27/6 (14)
15/7 (9)
18/9 (12)

6
8
10

(82)
(59)
(66)
(80) – DP = 42

(23)
(37)
(33)
(27)

Fig. 4

Qol/VADﬂow [l/min]

LVes/LVed [cm3]

CO [l/min]

AOP sys/dias(mean) [mmHg]

PAP sys/dias(mean) [mmHg]

PCW [mmHg]

1
2
3
4

3.1/0 (EF% = 19)
0.6/3.6
0/4.6
0/5.3

253/206
237/227
226/194
201/168

3.1
4.2
4.6
5.3

64/44 (53)
75/70 (72)
82/78 (80)
93/90/91

49/36
39/23
35/18
30/11

36
23
18
10

Fig. 5

Left EF%

LVes/LVed [cm3]

CO [l/min]

AOP sys/dias(mean) [mmHg]

PAP sys/dias(mean) [mmHg]

PCW [mmHg]

2a
2b
3a
3b

62
63
70
70

164/62
150/55
155/46
157/47

6.6
6.1
7
7

143/98
126/85
103/57
111/64

36/13 (21)
30/8 (16)
34/11 (18)
35/12 (19)

11
7
8
9

(120)
(105)
(78)
(86)

(40)
(28)
(24)
(17)

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112
Table 4
Literature data used for the Self-Tuning module.

HR [bpm]
AOP [mmHg]
AOPsys [mmHg]
AOPdias [mmHg]
LVes [cm3]
LVed [cm3]
CI [(l/min)/m2]
PCW [mmHg]
CO [l/min]
RAP [mmHg]
PAP [mmHg]

HR [bpm]
AOP [mmHg]
AOPsys [mmHg]
AOPdias [mmHg]
LVes [cm3]
LVed [cm3]
CI [(l/min)/m2]
PCW [mmHg]
CO [l/min]
RAP [mmHg]
PAP [mmHg]

LIC [27]
CASE 1

LDC [29]
CASE 2

LDC [29]
CASE 3

72
77.7
113
60
200
266
2.0
27
4.75
–
–

91
89
–
–
178
217
1.9
30
3.55
–
–

100
77
–
–
137
167
1.6
33
3.0
–
–

LDC [27]
CASE 4

RVD [28]
CASE 5

CircuLite
CASE 6

77
82.3
119
64
218
284
1.9
30
5.08
–
–

86
102
–
–
–
–
–
12
3.49
14
60

94
68
89
56
147
174
2.5
9
4.4
7
7

Data refer to 5 different cases with a total of three different pathologies: Left
Ischemic Cardiomyopathy (LIC), Left Dilated Cardiomyopathy (LDC), Right
Ventricular Dysfunction (RVD). The sixth condition refers to a CircuLite
implantation.

Table 5
Data obtained from the Self-Tuning module.

HR [bpm]
AOP [mmHg]
AOPsys [mmHg]
AOPdias [mmHg]
LVes [cm3]
LVed [cm3]
CI [(l/min)/m2]
PCW [mmHg]
CO [l/min]
RAP [mmHg]
PAP [mmHg]
Emaxl [mmHg/cm3]
LV0 [cm3]
Edl [mmHg/cm3]
Emaxr [mmHg/cm3]

HR [bpm]
AOP [mmHg]
AOPsys [mmHg]
AOPdias [mmHg]
LVes [cm3]
LVed [cm3]
CI [(l/min)/m2]
PCW [mmHg]
CO [l/min]
RAP [mmHg]
PAP [mmHg]
Emaxl [mmHg/cm3]
LV0 [cm3]
Edl [mmHg/cm3]
Emaxr [mmHg/cm3]

CASE 1

CASE 2

CASE 3

72 (0.0)
76 (2.2)
101 (10.9)
55 (8.3)
193 (3.5)
256 (3.8)
1.88 (6.0)
26 (3.7)
4.5 (5.3)
6 (–)
33 (–)
1.63 (–)
131 (–)
0.102 (–)
1.01 (–)

91 (0.0)
92 (3.4)
101 (–)
83 (–)
189 (6.2)
230 (6.0)
1.98 (4.1)
32 (6.7)
3.7 (4.2)
5 (–)
37 (–)
1.16 (–)
101 (–)
0.138 (–)
1.01 (–)

100 (0.0)
73 (5.2)
80 (–)
67 (–)
142 (3.6)
171 (2.4)
1.55 (3.3)
34 (3.0)
2.9 (3.3)
4 (–)
38 (–)
0.85 (–)
46 (–)
0.197 (–)
1.01 (–)

CASE 4

CASE 5

CASE 6

77 (0.0)
78 (5.2)
103 (13.4)
56 (12.5)
209 (4.1)
270 (4.9)
1.76 (7.4)
29 (3.3)
4.7 (7.5)
6 (–)
35 (–)
1.88 (–)
155 (–)
0.106 (–)
1.01 (–)

86 (0.0)
107 (4.9)
117 (–)
97 (–)
62 (–)
106 (–)
(–)
13 (8.3)
3.8 (8.9)
13 (7.1)
65 (8.3)
2.05 (–)
5 (–)
0.126 (–)
0.33 (–)

94 (0)
74 (8.8)
83 (6.7)
66 (17.9)
142 (3.4)
168 (3.4)
2.8 (10.6)
9 (0)
4.7 (6.8)
7 (0)
18 (5.9)
0.78 (–)
33 (–)
0.052 (–)
0.33 (–)

Results of Self-Tuning module that has been fed with the hemodynamic parameters
of Table 4. Data in brackets refer to the percentage error between the literature data
in Table 4 and the results of simulations.

107

as a practical tool, easy to be used and with a low execution time.
Using a 4th generation IntelREG Core i7-4702HQ processor and a
time step for equations solving of 0.002 s the execution time for
a heart cycle is 1 s.
The main user interface provides the hemodynamic data usually available on a cardio monitor (pressure waveforms and mean
values in a heart cycle) plus some other information (PV loops,
etc.).
As authors wanted to keep the main interface simple, some
modules were developed on different windows that can be opened
or closed according to the needs.
A special effort was devoted to the Self-Tuning interface as
authors tried to insert only data that are commonly used in the
clinical environment. That is to say that instead of ventricular elastance or systemic resistance, the user will have to insert data like
mean pressures, mean ﬂow, ventricular volumes, etc. The translation between these clinical data into ‘‘simulator data’’ is automatically done and hidden to the user thanks to the Self-Tuning
module. The user can specify the amount of input data to insert
by ticking from a predeﬁned list the types of measurements available for the speciﬁc patient to be simulated (see Fig. A2).
4.1. Training use
The training module is conceived as a tool able to offer an ‘‘interactive’’ learning procedure. That is to say that the user can
autonomously select one or more diseases, simulate therapies,
make comparisons with other therapies and other diseases, try to
characterize a speciﬁc hemodynamic condition (see Random diseases module).
As an example the simulator can facilitate the understanding of
how one or more diseases can change shape, dimension and position of pressure volume loops on the PV plane and the hemodynamic of a patient in toto. Then, the user can also simulate
different therapies and see possible improvements of patient’s condition (especially in complex pathologies where the simultaneous
use of different therapies is likely).
Some examples of the implemented diseases for the left ventricle are reported in Fig. 1, other hemodynamic results (i.e. AOP, CO,
etc.) are summarized in Table 3. In general, the decreasing of Emaxl
(conditions 2 and 3) provokes a shift of the PV loop to higher volumes values and lower pressure values. To overcome this condition
the cardiovascular system reacts chronically by changing the ventricular diastolic function (decrease of Edl) and increasing the systemic peripheral resistance. Data of conditions 2 and 3 in Table 3
are in agreement with the ACCF/AHA guideline [30] associating
advanced heart failure with reduced EF% (630), a PCW > 16
mmHg and a RAP > 12 mmHg (estimated from PAP).
In addition, the effects of an increment of Edl are shown (condition 4), with the associated reduction of ventricular volumes, LVed
in particular. Such a condition is an example of hypertrophic cardiomyopathy, a disease characterized by an increased left ventricular thickness (P15 mm) associated with nondilated and stiffer
ventricular chambers [30].
The effects of ventricular valve diseases are shown in Fig. 2. The
implemented diseases concern mitral valve regurgitation, aortic
valve regurgitation and stenosis. Results show how the shape of
PV loops is strongly affected by valvular diseases. As for example
in case of valve regurgitation, the PV loop does not show an isovolumetric relaxation/contraction because of the blood volume
loss/increment through the leaking valve. An important parameter
for the evaluation of such a valvular disease is the regurgitation
fraction that corresponds to the percentage of blood that regurgitates back through the aortic or mitral valve. In simulations 2
and 3 (see Fig. 2 and in Table 3) we reported an ischemic + dilated
cardiomyopathy with a regurgitation fraction of 56% in case of

108

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

aortic insufﬁciency and of 57% in case of mitral insufﬁciency. These
results are in agreement with [31], indicating, in the case of a severe chronic mitral or aortic insufﬁciency, a regurgitation fraction > 50% and a left ventricular dilatation.
Condition 4 in Fig. 2 and Table 3 is an example of severe aortic
stenosis combined with a mild hypertrophic cardiomyopathy
(EF% = 60, DP = 42 mmHg). This simulation is in agreement the definition of severe aortic stenosis characterized by a high pressure
drop across the aortic valve (DP P 40 mmHg) and usually associated with left ventricular hypertrophy [32].
In Fig. 3 the effects of the decrement of right ventricular
end-systolic elastance are shown, also combined with pulmonary
hypertension. The trends of right ventricular PV loops are much
similar to those illustrated for the left ventricle in Fig. 1.
In Fig. 4 some examples of VAD therapies are shown. As
starting hemodynamic condition (condition 1 in Fig. 4) we represented an advanced heart failure with an EF% 6 25 (that is
listed in the recommendation for mechanical circulatory support
[30]).
The user can select and activate different VADs in order to check
the speciﬁc reaction of the cardiovascular system. From Fig. 4 it is
evident how two pumps (Heart Ware and Heart Mate II), in apical
connection, provoke an unloading of the ventricle, by draining
blood from it. As a consequence, the PV loop assumes a
non-rectangular shape, with non isovolumetric ventricular
relaxation/contraction. In the case of the CircuLite Synergy
Micropump, in atrio–aortic connection, the blood is drained from
the left atrium. Therefore the PV loop keeps the typical rectangular
shape. For any type of assistance, the reduction of ventricular volume is evident, and the level of volume reduction depends on VAD
characteristics and on the speed set.
The other interventions that can be simulated are: drug infusion
and blood transfusion/loss. In Fig. 5 the effects of 3 lg/kg/min of
SNP are shown, consisting in a vasodilatation of peripheral resistances with a consequent increment of ventricular stroke volume
and a reduction of ventricular pressure in systole. A different trend
is observed during blood volume transfusion, whose effects mainly
concern an increment of ventricular ﬁlling with a consequent
increment of LVed and of ventricular pressure. The model offers
also the possibility to study the combined effects of SNP infusion
and baroreﬂex control: the ﬁrst reducing blood pressure by vasodilation, the second counteracting with vasoconstriction and by
increasing heart rate.
Some considerations need to be done concerning the choice of
parameters values for different types of diseases (Table 2). The
association of parameters values – level of severity is not very
immediate since most of pathologies are clinically classiﬁed on
the basis of patient’s perception and on individual physician’s
judgment (i.e. the NYHA classiﬁcation [33]). These data are only
indirectly linked with mere cardiovascular parameters. Moreover
a cardiovascular condition, especially in its chronic state, is usually
associated with a series of phenomena naturally occurring to compensate the impaired patient’s hemodynamic status (i.e. ventricular remodeling, systemic/pulmonary hypertension, etc.). From a
simulation point of view this means that a speciﬁc disease is usually associated with the alteration of more than one parameter,
both ventricular and circulatory ones. Such a representation goes
beyond the aim of Pre-Set Diseases that is not to recreate a heart
failure condition in toto but to simulate the effects that a single
parameter can induce on the overall hemodynamic condition.
Such an approach permits to better visualize the link cause effect
of a single parameter on patients’ hemodynamics (an analysis difﬁcult to be performed in clinics). For the simulation of a more
likely chronic patient’s status, the user will have to select more
than one disease from the list as it was shown already in the results
section.

4.2. Clinical use
The use of a cardiovascular simulator as a clinical tool is a
challenging and complex task that requires a strict cooperation
between model developers and clinicians (end users). The present work is aimed at illustrating a model that is conceived for
clinical purposes and developed on the basis of clinical needs.
Its use in clinical practice is still not systematic but hopefully
will be in a near future. Nevertheless some examples of the clinical use of the simulator and of how it can be easily adapted to
different clinical needs was already showed in previous works
[11,24,34].
The simulator is conceived as a tool able to provide additional
info to be integrated with other info the clinician has. The SDSS
is an example of how the simulator can be integrated into a wider
structure including intelligent data mining, statistical data, etc.
Such an approach, makes the simulator a component of the information ﬂow chart that from a diagnosis leads to a therapy
administration.
In this frame, an important characteristic the simulator should
have is the ﬂexibility and the easiness in being adapted to different
hemodynamic conditions. The personalization of the simulator to
patients’ data is a crucial point to assure its clinical exploitability.
Therefore, special attention was given to this issue, developing a
dedicated module to tailor the simulator on single patient (see
below).
4.2.1. The Self-Tuning module
The tuning of a simulator to a speciﬁc hemodynamic condition
is a process that raises different issues as the lack of clinical data
and the translation of clinical measurements into model parameters. The Self-Tuning module is aimed at overcoming these limitations with an automatized procedure so that the user can insert
patient data, activate the Self-Tuning procedure and simulate a
speciﬁc patient’s hemodynamic autonomously. Such a tool might
encourage the use of the simulator in the clinical arena.
In this paper, the Self-Tuning module was tested on 6 different
conditions (CASE 1–6), 5 taken from literature, and 1 obtained from
a VAD implanted patient. These 6 cases have been used to test the
Self-Tuning module in different conditions, with left and right ventricular failure, or during VAD assistance. Results, summarized in
Table 5, evidence a percentage error among target data and simulated data lower than 10%, which correspond to the tolerance set
by the authors. The tolerance was set to 10%, as this value is a reasonable estimation of the percentage error characterizing hemodynamic measurements in clinics [35]. The only exceptions are
AOPsys and AOPdias errors that can assume higher values. In this
case probably a measurement of Tdecay (that in our case has been
only estimated according to Eq. (3)) would have led to a better
approximation of both variables.
Some considerations should be given to the choice of the target
data to be provided to the simulator. Some data are commonly and
easily measurable in clinic as: HR⁄, BodyWeight⁄, Height⁄, AOP⁄,
AOPsys⁄, AOPdias⁄. Some other data (LAP⁄, PAP⁄, RAP⁄) require invasive measurements or electrographic and echocardiographic measurements (Tdecay⁄, LVes⁄ and LVed⁄). These latter are less feasible
in clinical environment unless a patient undergoes a VAD implantation surgery. To overcome this issue, the present Self-Tuning
module can be adapted to different sets of data: as example, if
PAP⁄ is not available, DPAP in Eq. (5) will be equal to zero and will
not affect any parameter tuning. Of course the quality and reliability of the simulation will increase with the number of target data
inserted in CVS.
In the overall Self-Tuning module strategy, these target data are
used to set model parameters, in addition to speciﬁc relationship
taken from literature whenever possible (‘‘e.g.’’ Teicholz formula).

109

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

The remaining parameters are changed according to the iterative
procedure. These parameters, automatically changed, refer to left
ventricular condition (Emaxl, LV0), the right ventricular condition
(Emaxr, Edr) and to the total volume of blood (TOTVol). The choice
of tuning these parameters is due to different reasons:
 Emaxl and LV0 parameters are difﬁcult to be estimated in clinics
therefore after an initial setting a better tuning is necessary.
 Emaxr, Edr: the right ventricle is not that often investigated in
clinics. Therefore it is unlikely that right ventricular parameters
are measured.

 The total volume of blood is initially estimated using a relationship taken from literature (see 3.9.1). Despite this, we know that
blood volume can vary according to the amount of liquid taken
by the patient. Therefore a further tuning is requested.
4.2.2. Specialist Decision Support System (SDSS)
The SDSS is an example of how the simulator can be integrated
into a wider structure aimed at supporting clinicians in the
treatment of VAD patients. The SDSS creates a hallmark in the ﬁeld,
supporting medical and VAD experts through the different phases
of VAD therapy [23,26]. Rather than addressing a single issue, the

Pre-set
diseases
VAD
Liquid
transfusion

Cardiovascular
model

Random
diseases

Drugs
Infusion

Data input

Self-Tuning

SDSS

Baroreflex
module

Fig. A1. Overall structure of the simulator. The main core of the system is the cardiovascular model. Then, in the second level the baroreﬂex model and all modules for
therapeutic interventions are grouped (liquid infusion/withdrawal, drug administration, VAD). At the third level the running modalities are speciﬁed: Self-Tuning procedure
to reproduce patient’s speciﬁc conditions, Pre-Set Diseases to reproduce one or more diseases on demand and the Random diseases modality according to which the simulator
reproduces randomly one or more diseases. In the most external level the interfaces of the simulator are listed: the hemodynamic data input developed for the user to feed
the simulator with patient’s speciﬁc data and the SDSS.

G
E

A

L

F
H

B

C

D

I

J

K

Fig. A2. The user interface of the simulator. Section A refers to systemic arterial pressure, pulmonary arterial pressure and central venous pressure waveforms. Section B
refers to VAD ﬂow waveform, section C (D) refers to left (right) pressure – volume loop, section E refers to hemodynamic data averaged on one heart cycle, section F refers to
control buttons, section G refers to Random diseases module, section H refers to predeﬁned diseases module, section I refers to VADs, section J refers to Drug Infusion module,
section K refers to blood transfusion, section L refers to model Self-Tuning (each input parameter can be ticked or not according if the user has the measurement on patient).

110

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

SDSS enables specialists with advanced data-driven techniques
and expert-knowledge techniques, in order to effectively assess
and exploit real patient data, as well as simulated patient data

for: treatment support and, in case, weaning of VAD, knowledge
discovery and statistics support derived from the collection of data
in time and their association with clinically relevant events,

Fig. A3. Block diagram of the Self-Tuning module. At ﬁrst the user inserts the input data in the dedicated interface (see section L of Fig. A2). These data will be used as target
parameters during the Self-Tuning procedure (they are marked with the symbol ‘‘⁄’’). At STEP 1 the cardiovascular parameters are calculated on the basis of the input data and
on the reference parameters values (marked with subscript ‘‘ref’’, see Table 1). At STEP 2 the recursive procedure is performed. In this phase the parameters adjusted are:
TOTVol, Emaxl, Emaxr, Edr, LV0.

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

suction and speed optimization support and ﬁnally selection of the
best VAD candidates on the basis of individual risk/beneﬁt proﬁles.
5. Limitations
Concerning clinical applications it is important to specify that a
systematic use of the simulator in clinical practice is a task that
goes beyond the aim of the present work ant that will require further efforts from both medical and engineering sides. The aim of
this work is to offer a new automatized methodology of model personalization and of model interface to other systems that might
encourage the use of simulators in the clinical arena.
6. Conclusion
The proposed computational cardiovascular simulator is conceived as a tool addressed to clinical applications. The core of the
CVS, made by a lumped parameters model, assures a low execution
time and a low model complexity. The modular structure permits
to include or exclude some modules according to users’ speciﬁc
needs thus contributing to keep the level of complexity to the minimum necessary.
Thanks to its structure, the present simulator is a valid tool for
both training and clinical uses. The ﬁrst application is devoted to
all clinicians and students that want to get an overall understanding of the most common cardiovascular diseases, with the relative
effects of therapeutic interventions.
The second application is devoted to clinical arena where the
clinician can reproduce ‘‘virtually’’ the hemodynamic condition of
a speciﬁc patient. In this case, the simulator can be used to provide
a more detailed analysis of patient’s hemodynamics and to test different therapies.
According to what is stated above, the innovation of this simulator stands in its structure and in the idea behind its exploitability.
The simulator structure permitted to collect and put together a
wide set of diseases, therapies and applications.
Conﬂict of interest
None declared.
Acknowledgments
This work was supported by SensorART EU project (No. 248763)
and by the Marie Curie Scholarship (GA No. PIEF-GA-2013-624296).
The authors thank the Catholic University of Leuven and CircuLite
for providing VAD data.
Appendix A
See Figs. A1–A3.
References
[1] T. Heldt, R. Mukkamala, G.B. Moody, R.G. Mark, CVSim. An open-source
cardiovascular simulator for teaching and research, Open Pacing
Electrophysiol. Ther. J. 3 (2010) 45–54.
[2] Harvi By PVLoops LLC. <http://danielburkhoff.com/simulation/> (last accessed
25.11.2014).
[3] A. Goodwin, W.L. van Meurs, C.D. Sá Couto, J.E. Beneken, S.A. Graves, A model
for educational simulation of infant cardiovascular physiology, Anesth. Analg.
99 (6) (2004) 1655–1664.
[4] G. Ferrari, M. Kozarski, K. Zieliński, L. Fresiello, A. Di Molfetta, K. Górczyńska,
K.J. Pałko, M. Darowski, A modular computational circulatory model applicable
to VAD testing and training, J. Artif. Organs 15 (2012) 32–43.

111

[5] M. Tokaji, S. Ninomiya, T. Kurosaki, K. Orihashi, T. Sueda, An educational
training simulator for advanced perfusion techniques using a high-ﬁdelity
virtual patient model, Artif. Organs 36 (12) (2012) 1026–1035.
[6] S. Ninomiya, A. Tokumin, T. Yasuda, Y. Tomizawa, Development of an
educational simulator system, ECCSIM-Lite, for the acquisition of basic
perfusion techniques and evaluation, J. Artif. Organs 10 (4) (2007) 201–205.
[7] D.L. Timms, S.D. Gregory, N.A. Greatrex, M.J. Pearcy, J.F. Fraser, U. Steinseifer, A
compact mock circulation loop for the in vitro testing of cardiovascular
devices, Artif. Organs 35 (4) (2011) 384–391.
[8] G. Ochsner, R. Amacher, A. Amstutz, A. Plass, M.S. Daners, H. Tevaearai, S.
Vandenberghe, M.J. Wilhelm, L. Guzzella, A novel interface for hybrid mock
circulations to evaluate ventricular assist devices, IEEE Trans. Biomed. Eng. 60
(2) (2012) 507–516.
[9] M. Kozarski, G. Ferrari, K. Zieliński, K. Górczyńska, K.J. Pałko, L. Fresiello, A. Di
Molfetta, M. Darowski, A hybrid (hydro-numerical) cardiovascular model:
application to investigate continuous – ﬂow pump assistance effect, Biocybern.
Biomed. Eng. 32 (4) (2012) 77–91.
[10] L. Fresiello, K. Zieliński, S. Jacobs, A. Di Molfetta, K.J. Pałko, F. Bernini, M.
Martin, P. Claus, G. Ferrari, M.G. Trivella, K. Górczyńska, M. Darowski, B.
Meyns, M. Kozarski, Reproduction of continuous ﬂow left ventricular assist
device experimental data by means of a hybrid cardiovascular model with
baroreﬂex control, Artif. Organs 38 (6) (2014) 456–468.
[11] A. Di Molfetta, S. Jacobs, L. Fresiello, T. Verbelen, M.G. Trivella, B. Meyns, G.
Ferrari, Simulation of apical and atrio–aortic VAD in patients with
transposition or congenitally corrected transposition of the great arteries,
Int. J. Artif. Organs 37 (1) (2014) 58–70.
[12] L. Fresiello, A.W. Khir, A. Di Molfetta, M. Kozarski, G. Ferrari, Effects of intraaortic balloon pump timing on baroreﬂex activities in a closed-loop
cardiovascular hybrid model, Artif. Organs 37 (3) (2013) 237–247.
[13] N.M. Mohammad, L. Fresiello, A. Di Molfetta, G. Ferrari, A modelling tool to
study the combined effects of drug administration and LVAD assistance in
pathophysiological circulatory conditions, Int. J. Artif. Organs 37 (11) (2014)
824–833.
[14] T. Heldt, E.B. Shim, R.D. Kamm, R.G. Mark, Computational modeling of
cardiovascular response to orthostatic stress, J. Appl. Physiol. 92 (2002)
1239–1254.
[15] K. Sagawa, L. Maughan, H. Suga, K. Sunagawa, Chamber pressure–volume
relation versus muscle tension-length relaxation, in: K. Sagawa, L. Maughan,
H. Suga, K. Sunagawa (Eds.), Cardiac Contraction and the Pressure–Volume
Relationship, Oxford University Press, New York, 1988, pp. 61–94.
[16] M. Ursino, Interaction between carotid baroregulation and the pulsating heart:
a mathematical model, Am. J. Physiol. 275 (1998) 1733–1747.
[17] R. Gopinath, B.W. Bequette, R.J. Roy, H. Kaufman, C. Yu, Issues in the design of a
multirate model-based controller for a nonlinear drug infusion system,
Biotechnol. Prog. 11 (3) (1995) 318–332.
[18] R.K. Funkhouser, W.H. Pritchard, A.S. Littell, Change in relationship of blood
volume to weight in congestive heart failure, Circulation 16 (1957) 548–557.
[19] L. Abboud, A. Battler, S. Rath, S. Sideman, R. Beyar, The slope of the end-systolic
pressure–volume relationship compared with the global end-systolic
pressure–volume ratio in humans, Clin. Cardiol. 13 (1) (1990) 19–22.
[20] J. Tyberg, J.E. Davies, Z. Wang, W.A. Whitelaw, J.A. Flewitt, N.G. Shrive, D.P.
Francis, A.D. Hughes, K.H. Parker, J.J. Wang, Wave intensity analysis and the
development of the reservoir-wave approach, Med. Biol. Eng. Comput. 47 (2)
(2009) 221–232.
[21] S. Spitaels, R. Arbogast, J.C. Fouron, A. Davignon, The inﬂuence of heart rate and
age on the systolic and diastolic time intervals in children, Circulation 49
(1974) 1107–1115.
[22] H. Takatsu, K. Gotoh, T. Suzuki, Y. Ohsumi, Y. Yagi, T. Tsukamoto, Y. Terashima,
K. Nagashima, S. Hirakawa, Quantitative estimation of compliance of human
systemic veins by occlusion plethysmography with radionuclide –
methodology and the effect of nitroglycerin, Jpn. Circ. J. 53 (3) (1989) 245–254.
[23] A.T. Tzallas, N.S. Katertsidis, E.C. Karvounis, M.G. Tsipouras, G. Rigas, Y.
Goletsis, K. Zielinski, L. Fresiello, A. Di Molfetta, G. Ferrari, J.V. Terrovitis, M.G.
Trivella, D.I. Fotiadis, Modeling and simulation of speed selection on left
ventricular assist devices, Comput. Biol. Med. 51 (2014) 128–139.
[24] Pan European Networks, Science and Technology, March 2014; vol. 10, pp.
160–161. <http://www.paneuropeannetworks.com/ST9/#166>.
[25] Pan European Networks, Science and Technology, December 2013; vol. 9, pp.
166–167. <http://www.paneuropeannetworkspublications.com/ST10/#160>.
[26] E.C. Karvounis, M.G. Tsipouras, A.T. Tzallasv, N.S. Katertsidis, K. Stefanou, Y.
Goletsis, M. Frigerio, A. Verde, R. Caruso, B. Meyns, J. Terrovitis, M.G. Trivella,
D.I. Fotiadis, A decision support system for the treatment of patients with
ventricular assist device support, Methods Inf. Med. 53 (2) (2014) 121–136.
[27] J. Mansourati, Y. Etienne, M. Gilard, V. Valls-Bertault, J. Boschat, D.G. Benditt,
K.G. Lurie, J.J. Blanc, Left ventricular-based pacing in patients with chronic
heart failure: comparison of acute hemodynamic beneﬁts according to
underlying heart disease, Eur. J. Heart Fail. 2 (2) (2000) 195–199.
[28] S. Rich, M. Seidlitz, E. Dodin, D. Osimani, D. Judd, D. Genthner, V. McLaughlin,
G. Francis, The short-term effects of digoxin in patients with right ventricular
dysfunction from pulmonary hypertension, Chest 114 (3) (1998) 787–792.
[29] L.W. Stevenson, J.H. Tillisch, Maintenance of cardiac output with normal ﬁlling
pressures in patients with dilated heart failure, Circulation 74 (6) (1986)
1303–1308.
[30] C.W. Yancy, M. Jessup, B. Bozkurt, J. Butler, D.E. Casey Jr, M.H. Drazner, G.C.
Fonarow, S.A. Geraci, T. Horwich, J.L. Januzzi, M.R. Johnson, E.K. Kasper, W.C.

112

L. Fresiello et al. / Journal of Biomedical Informatics 57 (2015) 100–112

Levy, F.A. Masoudi, P.E. McBride, J.J. McMurray, J.E. Mitchell, P.N. Peterson, B.
Riegel, F. Sam, L.W. Stevenson, W.H. Tang, E.J. Tsai, B.L. Wilkoff, American
College of Cardiology Foundation; American Heart Association Task Force on
Practice Guidelines, ACCF/AHA guideline for the management of heart failure,
J. Am. Coll. Cardiol. 62 (16) (2013) 147–239.
[31] B.J. Gersh, B.J. Maron, R.O. Bonow, J.A. Dearani, M.A. Fifer, M.S. Link, S.S. Naidu,
R.A. Nishimura, S.R. Ommen, H. Rakowski, C.E. Seidman, J.A. Towbin, J.E.
Udelson, C.W. Yancy, American College of Cardiology Foundation/American
Heart Association Task Force on Practice Guidelines, ACCF/AHA guideline for
the diagnosis and treatment of hypertrophic cardiomyopathy, J. Am. Coll.
Cardiol. 58 (25) (2011) 212–260.
[32] R.A. Nishimura, C.M. Otto, R.O. Bonow, B.A. Carabello, J.P. Erwin 3rd, R.A.
Guyton, P.T. O’Gara, C.E. Ruiz, N.J. Skubas, P. Sorajja, T.M. Sundt 3rd, J.D.
Thomas, American College of Cardiology/American Heart Association Task

Force on Practice Guidelines, AHA/ACC guideline for the management of
patients with valvular heart disease, J. Am. Coll. Cardiol. 63 (22) (2014) 57–
185.
[33] The Criteria Committee of the New York Heart Association, Nomenclature and
Criteria for Diagnosis of Diseases of the Heart and Great Vessels, 9th ed., Little,
Brown & Co, Boston, Mass, 1994. pp. 253–256.
[34] A. Di Molfetta, A. Amodeo, L. Fresiello, M.G. Trivella, R. Iacobelli, M. Pilati, G.
Ferrari, Simulation of ventricular, Cavo-pulmonary, and biventricular
ventricular assist devices in failing Fontan, Artif. Organs (2015), http://
dx.doi.org/10.1111/aor.12434 (Epub ahead of print).
[35] J.G. Chase, C. Starﬁnger, C.E. Hann, J.A. Revie, D. Stevenson, G.M. Shaw, T.
Desaive, Model-based prediction of the patient-speciﬁc response to
adrenaline, Open Med. Inform. J. 4 (2010) 149–163.

