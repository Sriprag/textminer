904

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Toward Balance Recovery With Leg Prostheses
Using Neuromuscular Model Control
Nitish Thatte∗ , Member, IEEE, and Hartmut Geyer, Member, IEEE

Abstract—Objective: Lower limb amputees are at high risk of
falling as current prosthetic legs provide only limited functionality
for recovering balance after unexpected disturbances. For
instance, the most established control method used on powered leg
prostheses tracks local joint impedance functions without taking
the global function of the leg in balance recovery into account. Here,
we explore an alternative control policy for powered transfemoral
prostheses that considers the global leg function and is based on
a neuromuscular model of human locomotion. Methods: We adapt
this model to describe and simulate an amputee walking with a
powered prosthesis using the proposed control, and evaluate the
gait robustness when confronted with rough ground and swing leg
disturbances. We then implement and partially evaluate the resulting controller on a leg prosthesis prototype worn by a nonamputee
user. Results: In simulation, the proposed prosthesis control leads
to gaits that are more robust than those obtained by the impedance
control method. The initial hardware experiments with the prosthesis prototype show that the proposed control reproduces normal
walking patterns qualitatively and effectively responds to disturbances in early and late swing. However, the response to midswing
disturbances neither replicates human responses nor averts falls.
Conclusions: The neuromuscular model control is a promising alternative to existing prosthesis controls, although further research
will need to improve on the initial implementation and determine
how well these results transfer to amputee gait. Significance:
This paper provides a potential avenue for future development of
control policies that help to improve amputee balance recovery.
Index Terms—Neuromuscular model, powered prosthesis, prosthesis control, transfemoral prosthesis.

I. INTRODUCTION
HERE are currently an estimated 600 000 lower limb amputees in the United States, a number expected to rise in the
coming decades due to a growing diabetes epidemic [1]. A major
problem that confronts this population is falls, which can cause
bodily harm and trigger a fear of physical activity. This issue especially affects transfemoral amputees due to limited actuation
and control in commercial prostheses. For instance, manufacturers have released a number of prosthetic devices, such as the
Ottobock C-leg and the Ossur Rheo Knee [2], which employ
microprocessor-controlled knee dampers that improve steady

T

Manuscript received March 3, 2015; revised July 14, 2015; accepted August
13, 2015. Date of publication August 25, 2015; date of current version May
19, 2016. This work was supported in part by the Eunice Kennedy Shriver
National Institute of Child Health and Human Development under Award
1R01HD075492 and by the National Science Foundation Graduate Research
Fellowship under Grant 0946825. Asterisk indicates corresponding author.
∗ N. Thatte is with the Robotics Institute, Carnegie Mellon University, Pittsburgh, PA 15213 USA (e-mail: nitisht@cs.cmu.edu).
H. Geyer is with Carnegie Mellon University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2472533

gait characteristics over passive mechanical prostheses. However, without active components, these products cannot match
the performance of human limbs as they cannot generate positive net work over a gait cycle. Consequently, transfemoral amputees wearing these prostheses suffer from increased energy
consumption, slower ambulation speeds, and a limited ability
to respond to unexpected disturbances, such as trips, slips, and
pushes [3], [4].
To address the kinematic, energetic, and robustness problems
caused by mechanical passivity, researchers have developed
powered knee–ankle prostheses and controllers that generate
desired walking motions. One recent example is Vanderbilt University’s powered lower limb prosthesis [5]–[7], which features
motors at both the ankle and knee joints that enable it to generate positive net work over a gait cycle. Research efforts have
produced several control methods for this prosthesis: One such
method is quasi-stiffness control, which uses the torque versus angle relationships seen during intact walking to produce
torque references for the prosthesis. This control strategy can
also achieve speed adaptation via interpolation between two sets
of quasi-stiffness profiles, one for slow walking and one for fast
walking [8]. Another method, minimum jerk swing control, uses
the estimated swing duration and the joint angles and velocities
at toe off to generate smooth torque trajectories that dorsiflex
the ankle, flex the knee in order to achieve ground clearance,
and then extend the knee before heel strike [9]. Finally, virtual
constraint control enforces biomimetic ankle–foot and knee–
ankle–foot rollover shapes via a partial feedback linearizing
controller [10].
The most established control method used on this and similar
powered prostheses is impedance control. This strategy uses
piecewise impedance functions to approximate the torque versus
joint angle relationships for each phase of the intact human gait
cycle. With this control method, Sup and colleagues produced
joint angles and torques for the knee and ankle similar to those
seen during normal level-ground walking [7]. However, they
also found that the required impedance functions vary greatly
with the environment [11] and need to be augmented with a
separate stumble classifier and recovery controller to react to
disturbances [12].
An alternative approach to joint control in prostheses is to
mimic the underlying dynamics and control policies of the
human neuromuscular system. Instead of replicating recorded
torque profiles with impedance or similar functions, modeling
the human system that generates these torques may yield more
natural motions. Moreover, the human neuromuscular system
may provide guidance for integrating high-level objectives
and, thus, for generalizing a prosthesis control to unexpected

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

THATTE AND GEYER: TOWARD BALANCE RECOVERY WITH LEG PROSTHESES USING NEUROMUSCULAR MODEL CONTROL

Fig. 1. Snapshots following a simulated tripping event. Response of the proposed (a) prosthetic control and (b) impedance control to a 15 N · s impulse
applied shortly after toe off (red arrow). The proposed neuromuscular model
control successfully responds to the trip and continues walking. In contrast,
impedance control cannot effectively react to the same disturbance and subsequently falls.

situations. This approach has been successfully applied to a
powered ankle prosthesis [13], which mimics the kinematics
and kinetics of the ankle joint in human walking including its
adaptation to sloped environments. It remains unclear, however,
whether the approach generalizes to the more complex function
of the knee joint in gait and balance recovery.
Here, we extend the neuromuscular control approach to knee–
ankle prostheses for transfemoral amputees. First, we review and
modify a neuromuscular model of intact human locomotion to
design a prosthesis controller based on muscle reflexes and local
feedbacks (see Section II). Next, to evaluate the neuromuscular
prosthesis control, we construct a simulation of an amputee
walking on a powered prosthesis and perform optimizations to
identify parameters that lead to robust locomotion over rough
terrain (see Section III). We then compare the performance of
the proposed control to that of impedance control and find that
the proposed control improves robustness to elevation changes
and unexpected deviations from nominal walking, suggesting
that it may help amputees prevent trips and falls (see Fig. 1).
Finally, we present preliminary results toward implementing the
proposed control on a powered leg prosthesis currently under
development. We investigate the resulting controller’s ability to
reproduce the leg behavior of human gait in steady walking and
probe the response of the prosthesis to impulse disturbances
during swing (Section IV).
II. REFLEXIVE WALKING CONTROL
We propose a prosthesis control based on a neuromuscular
model of unimpaired human locomotion similar to that presented in [14]. This paper uses approximate models of muscle
dynamics and hypothesized reflex pathways to generate joint
torques for a seven-link planar biped, producing gaits that are
kinetically, kinematically, and electromyographically similar to
observed human locomotion patterns.

905

Fig. 2. Unimpaired human walking model with labeled muscles and definitions of hip and knee angles, leg length, and current and target swing leg angles.

A drawback of the model presented in [14] is a lack of robust
foot placement during swing, which is essential for balance recovery [15]–[17]. To address this issue, Desai and Geyer [18]
analyzed the passive double-pendulum dynamics of a leg during swing and proposed a heuristic control that shapes these
dynamics to achieve ground clearance and placement of the
foot into target positions. Integrating this swing leg control
with the previous muscle reflex control during stance allows
the model to walk across terrain featuring unexpected steps
with elevation changes in the range of −9 to +12 cm [19]. We
adapt this hybrid neuromuscular model to derive a transfemoral
prosthesis control.
A. Neuromuscular Stance Control
In stance, a leg of the hybrid model is actuated by seven Hilltype muscle tendon units [20] (soleus, gastrocnemius (GAS),
tibialis anterior, vastus (VAS), hamstring (HAM), hip flexors,
and gluteus) illustrated in Fig. 2. These muscles produce torques
about the ankle, knee, and hip
τim = F m (S, lmtc , lce )rm (φi )

(1)

where rm (φi ) is the variable moment arm of muscle m about
joint i, and F m (S, lmtc , lce ) is the force produced by the muscletendon unit given stimulation S, muscle-tendon unit length lmtc ,
and contractile element length lce .
The muscles of the stance leg are stimulated by reflexes primarily in the form of muscle length and force feedbacks. In
general, the stimulation S m (t) of muscle m is modeled as

m
m
S m (t) = S0m +
Gm
(2)
n Pn (t − Δtn )
n

where S0m is a constant prestimulation, Pnm (t − Δtm
n ) is the
time-delayed length or force signal from muscle n acting on
muscle m, and Gm
n is the gain on that signal. The reflexes
encode several key functions of legged locomotion: Generating compliant leg behavior, preventing knee overextension, and
balancing the trunk.

906

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

The first function, generating compliant leg behavior, is
achieved by positive force feedback reflexes on leg extensors:
the soleus, VAS, and gluteus. For example, the VAS is stimulated
in part by
vas
vas
S vas (t) = S0vas + Gvas
vas Fvas (t − Δtvas ) + · · · .

(3)

The second function, preventing knee overextension, is implemented via two mechanisms. The first mechanism is positive
force feedback of biarticular muscles, the GAS and HAM, which
helps to counteract the tendency for knee overextension caused
by ankle plantarflexion and hip extension torques, respectively.
For example, the HAM has a force feedback reflex
ham
ham
S ham (t) = S0ham + Gham
ham Fham (t − Δtham ) + · · ·

(4)

which helps to prevent both knee extension and hip flexion
caused by heel strike. A second mechanism further protects the
knee by inhibiting the VAS stimulation in proportion to knee
extension beyond a threshold, resulting in the complete VAS
stimulation
vas
vas
S vas (t) = S0vas + Gvas
vas Fvas (t − Δtvas )

− kφ (φk (t − Δtk ) − φoﬀ )
(5)


× (φk (t − Δtk ) < φoﬀ ) φ˙k (t − Δtk ) < 0
where φoﬀ is the angle beyond which the VAS is inhibited.
The final function of balancing the trunk is accomplished by
a proportional-derivative control, which produces stimulations
for the hip muscles (hip flexors, gluteus, and HAM) to stabilize
the trunk at a reference lean. Because muscles can only pull but
not push, the proportional derivative control signal is distributed
as hip flexor stimulation if the signal represents flexion torque,
and as simultaneous stimulation for the gluteus and HAM if
it represents hip extension torque. For example, the complete
HAM stimulation becomes
ham
ham
S ham (t) = S0ham + Gham
ham Fham (t − Δtham )


+ kp (φtrunk − φref ) + kd φ̇trunk



(6)
×
kp (φtrunk − φref ) + kd φ̇trunk > 0

where the last two terms are the reflex contributions from the
trunk balance control. A more detailed description of the stance
reflex control can be found in [19].
B. Swing Leg Placement Control
The swing control comprises two layers. In the first layer, a
leg placement policy
αtgt = α0 + cd d + cv v

(7)

prescribes desired foot placement locations, where αtgt is the
target leg angle, α0 is the default leg angle, d is the horizontal
distance between the stance leg ankle and the model’s center
of mass, v is the velocity of the center of mass, and cd and
cv are constants. This policy is taken from [21] and presents
an empirical generalization of the leg placement strategies that

recover the linear inverted pendulum model of human walking
from disturbances [16], [17].
The target angle generated by this policy forms a central input to the second layer, the swing limb control detailed in [18].
The portion of this control that governs the knee action uses a
finite state machine to switch between three phases. The first
phase allows the knee to passively flex in response to hip moments generated at the onset of swing. If the passive knee flexion
is insufficient (the foot swings forward with a tendency to scuff
the ground), the control produces active flexion torque of the
knee in proportion to the rate α̇ of forward leg motion

0,
α̇ > 0
i
(8)
τk =
i
−k α̇, α̇ ≤ 0
where k i is the flexion gain, and the leg angle α is defined as
the angle between the horizontal and the hip–ankle line.
The second phase activates when the leg length, defined as the
distance between the hip and ankle, contracts below a threshold.
In this phase, the knee torque is given by
⎧ ii
˙
⎪
⎨ −k1 φk , φ̇k ≥ 0
(9)
τkii = −k2ii φ˙k (α − αtgt )(α̇ − φ˙k ), φ˙k < 0 & φ̇k < α̇
⎪
⎩
0, otherwise
where k1ii and k2ii are damping coefficients. The first case dampens knee flexion, while the second case dampens knee extension, but allows progressively more extension as the leg angle
approaches its target. The modulation term (α̇ − φ˙k ) prevents
premature landing of the leg by damping the knee if it extends
faster than the overall leg angle.
The third phase engages when the leg angle gets within a
threshold of the target leg angle. The control then applies torque
to stop and extend the knee


⎧
α̇
iii
⎪
⎨ k (αthr − α) 1 − α̇ m a x , α < αthr
τkiii =
(10)
α̇ < α̇m ax
⎪
⎩
0,
otherwise
where α̇m ax is the maximum leg retraction velocity for which
the stopping knee torque is applied. When this torque brings the
leg velocity to zero, a knee extension torque is added


τkiii = τkiii − k ext (l0 − l)

(11)

where l0 is the rest leg length, l is the current leg length, and
k ext is a proportional gain.
The swing leg control also specifies a hip torque in the form
of a proportional derivative control on the leg angle
τhα = kp (αtgt − α) − kd α̇.

(12)

This hip torque is supplemented by a feedforward term
τh = τhα − 2τkiii

(13)

that neutralizes the coupling dynamics between the knee and
hip during the knee’s stop and extend phase [see (10)].
The torques produced by the swing controller augment the net
torques produced by the Hill-type muscles and reflexes during
stance. At heel strike, the control policy switches from using

THATTE AND GEYER: TOWARD BALANCE RECOVERY WITH LEG PROSTHESES USING NEUROMUSCULAR MODEL CONTROL

Fig. 3. Prosthesis prototype. (a) CAD render of the proposed design of powered knee and ankle prosthesis used in simulated experiments. (b) Current stage
of prototype with active knee and passive ankle used for hardware evaluation
experiments.

the swing leg control torques to the stance torques generated by
the muscle models. In late stance, the policy mixes the torques
specified by the stance and swing controllers by scaling the
stance and swing torques and muscle stimulations in proportion
to the normalized ground reaction force
τlate stance = τstance (GRF) + τswing (1 − GRF)

(14)

m
m
Slate
stance = S (GRF).

(15)

During swing, only the swing leg torques are used.
C. Reflex Prosthesis Design and Control
Balance recovery in humans can require peak torques and
speeds at the knee joint of about 120 N · m and 1.8 rev/s,
respectively, [22], [23]. Fig. 3 shows a CAD rendering and an
initial prototype of a powered knee–ankle prosthesis designed
to achieve this performance envelope. The design includes two
identical series elastic actuators (SEAs), each consisting of a
brushless motor (TQ-Group ILM85-13HS), a Harmonic Drive
gearset (CSG-25-50), and a series composite leaf spring. One
actuator drives the knee joint and the other drives the ankle
joint [see Fig. 3(a)]. Both are designed to produce peak joint
speeds of about 1.67 rev/s, and peak joint torques of about
170 N · m, assuming 75% gear efficiency. In addition, the ankle
has a parallel spring that can store and release energy during
the gait cycle. The design also includes two absolute encoders
(Renishaw Resolute) per joint located on either side of each
joint’s series elastic spring. These encoders measure the knee
and ankle angles (θk and θa ), and the deflection of the series
springs, thereby providing an estimate of joint torques (τk and
τa ). Finally, the prosthesis also includes an IMU (YEI Technology 3-Space Sensor) mounted on the thigh side of the knee joint

907

to estimate the thigh angle θt with respect to the vertical axis
(see Fig. 7). The complete prototype will weigh about 6 kg with
an additional 5 kg carried in a backpack for batteries and motor
controllers. Fig. 3(b) shows our current development stage of
the prototype with the powered knee joint and a passive ankle
foot.
The control of the prosthesis distinguishes between a lower
level and a behavior level. At the lower level, each actuator is
controlled by a SEA control [24], [25] that regulates a desired
joint torque by commanding motor torque. The desired joint
torques for the knee and ankle are generated at the behavior
level by the control reviewed in Sections II-A and II-B.
During stance, the behavior control simulates five virtual muscles that span the knee and ankle joints (Fig. 4; virtual soleus,
GAS, tibialis anterior, VAS, and HAM shown in blue). These
muscles and their reflex controls realize the net torques at the
knee and ankle joints required to generate compliant behavior and to prevent knee joint overextension (see Section II-A).
The virtual stimulations of these muscles require information
about the knee and ankle angles of the prosthesis, which is
provided by the joint position encoders. In addition, the biarticular HAM stimulation requires knowledge of the amputee’s
hip angle, which is estimated by the IMU mounted on the thigh
(θh ≈ θt ).
During swing, the prosthesis uses the reviewed swing leg
control to specify the knee torque (see Section II-B). However,
there is an important difference between the previously reviewed control and the control implemented on the prosthesis.
As the prosthesis does not have access to information about the
user’s center of mass and stance leg ankle position, we replace
the adaptive leg placement policy [see (7)] with a constant target
leg angle αtgt = const. The prosthesis obtains information
about the leg length and leg angle from the knee encoder and
a thigh-mounted IMU using l2 = lt2 + ls2 − 2lt ls cos θk and
α = π/2 − θh + arcsin ((ls sin θk )/l), respectively. In addition, during swing, a length feedback reflex on a virtual tibialis
anterior muscle dorsiflexes the ankle and improves foot ground
clearance.

III. BALANCE RECOVERY IN SIMULATED EXPERIMENTS
A. Amputee Walking Simulation
We study the performance of the proposed transfemoral prosthesis controller in a simulation model of a unilateral amputee
equipped with the proposed powered prosthesis. To more accurately model an amputee’s anatomy, we sever the femur of the
unimpaired human model 11 cm above the knee and attach the
HAM muscle to the distal end of the shortened bone, as recommended in [26]. This change converts the biarticular HAM
into a monoarticular muscle that only extends the hip. Next, we
attach a model of the full prosthesis [see Fig. 3(a)] to the severed
femur (see Fig. 4). The prosthesis model includes SEAs for the
knee and ankle, the electrical dynamics of the motors, gearbox
ratios and resultant reflected inertias, and current-based SEA
control for these actuators [24].

908

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 4. Control overview of the amputee walking model. The amputee and the prosthesis are driven by nearly identical neuromuscular controls. During stance,
reflex stimulations of Hill-type muscles generate torques about the joints. During swing, the control specifies torques that drive the legs to desired landing angles
α tg t (compare Fig. 2). To control the prosthesis, the torques produced by the muscles and the swing control are converted to motor voltages by SEA controllers.

The reference torques for the SEAs are generated by the
behavior control. The behavior control implements the hybrid
neuromuscular control with one modification. Because the attachment of the HAM muscle is relocated, the hip swing control
on the prosthesis side does not have the feedforward term neutralizing the disturbance created by the knee’s stop and extend
phases [see (13)].
To compare the performance of the proposed control, we
also simulate the state-of-the-art impedance control method at
the behavior level [5]–[7], [11]. Specifically, we implement the
impedance control presented in [6] as it tended to perform better
than other versions in our simulations. This control partitions
the gait cycle into four phases. In each phase i, the torque of an
actuated joint is governed by an impedance function
τi = −k1,i (θ − θ1,i ) − k2,i (θ − θ2,i )3 − bi θ̇

(16)

where θ is the joint angle, θ1,i and θ2,i are angle offsets, and
k1,i , k2,i , and bi are the impedance parameters.
B. Controller Optimization for Natural and Robust Walking
For both the hybrid neuromuscular controller and the
impedance controller, we use optimization to search for gaits
that appear natural and are robust to disturbances. For the hybrid neuromuscular model, we optimize 53 parameters that include reflex feedback gains and swing leg control parameters
for both the amputee and prosthesis as well as the SEA control gains. To reduce the number of parameters to optimize, we
use fixed values for many parameters, such as the muscle properties and prestimulations. For the impedance controller, we
optimize 59 parameters that include the reflex feedback gains
and the swing leg control parameters for the amputee model, and
the impedance parameters and SEA controller gains for the prosthesis. Again, to reduce the number of parameters to optimize,
the impedance parameters that are set to zero according to [6]
are fixed to zero during the optimization.
We rely on the covariance matrix adaptation evolution strategy [27] and perform optimization in two steps. In the first step,
we search for control parameters that generate a gait with natural kinematics and kinetics. To this end, we take advantage
of the observation that human gait seems to result from minimizing metabolic energy consumption [28], and use the cost of

transport
1
W
+
Cost =
mgx mgx






2
2
c1 τcm
d + c2 τlim it dt

(17)

as the optimization criterion. In the cost, W accounts for the
energy consumption of both the modeled amputee’s muscles
and the prosthesis’ virtual muscles according to [29], τcm d
is the sum of the torques commanded by the neuromuscular
swing control or the impedance control, τlim it is the sum of
torques produced by the model’s mechanical hardstops, which
prevent knee and ankle hyperextension, m is the mass of the
amputee, g is the gravitational acceleration, and x is the distance travelled in 20 s. The hand tuned constants c1 = 0.1 and
c2 = 0.01 ensure that the terms of the cost function have similar
order-of-magnitude.
We run the above optimization for 300 iterations, and use the
best resulting set of control parameters to seed an optimization
for robustness to unexpected changes in ground height. For this
second step, the cost function becomes

2
(18)
Cost = −x + c3 τlim
it dt
rewarding the distance travelled and penalizing joint hyperextension (c3 = 0.0005). Instead of level ground, we evaluate the
cost using terrain that is flat for the first 10 m (to allow the
model to reach steady walking) and then features steps, spaced
1 m apart and drawn from a uniform random distribution. The
width of the distribution grows at a rate of 2.5-cm/m distance
travelled, resulting in steps that grow progressively rougher
the farther the model walks. To avoid overfitting, we perform
the evaluation on five different terrains, resulting in an average
cost. Like in the first step, we stop the optimization after 300
iterations, resulting in the final best set of control parameters.
C. Prosthesis Performance on Rough Terrain
We evaluate the performance of the proposed control and of
impedance control by subjecting the amputee model to terrains
that are flat for 10 m and then feature steps drawn from uniform
distributions for another 90 m. The widths of the distributions
are constant but vary among the terrains to test the control
performance on steps of increasing steepness (0 to ±14 cm,
2 cm increments, total of eight terrains).

THATTE AND GEYER: TOWARD BALANCE RECOVERY WITH LEG PROSTHESES USING NEUROMUSCULAR MODEL CONTROL

Fig. 5. Control performance of simulated prosthesis on rough terrain. The
distances walked over terrains with different ground roughness are compared
between the amputee model using a powered knee–ankle prosthesis with
impedance control (green) and hybrid neuromuscular control (blue) as well
as with the unimpaired human model (red). Shown are the median and range
(25th and 75th percentiles) of the covered distances for 50 terrains sampled at
each roughness level.

Fig. 5 shows the distances the amputee model walks over 50
trials at each roughness level (proposed neuromuscular control
in blue, impedance control in green). Most of the trials with the
impedance-controlled prosthesis cover the full distance up to a
roughness of 2 cm. At a roughness of 4 cm, however, the median
distance drops to 34 m, which further declines as the roughness
increases. In contrast, the prosthesis using the neuromuscular
control allows the amputee model to walk the full distance up
to a roughness of 6 cm. Moreover, neuromuscular control has a
similar distribution of distances walked at a roughness of 8 cm
as impedance control has at a roughness of 4 cm.
Although the prosthesis using neuromuscular control significantly improves the robustness of the amputee model on rough
terrain, the performance trails by a large margin that of an unimpaired model (see Fig. 5, red line), for which most of the trials
covered the full distance up to a roughness of 10 cm. Limiting
the swing leg placement targets in the neuromuscular prosthesis
control to constant angles may account for some of this performance gap. In future work, we may overcome this limitation
by estimating the amputee’s center of mass velocity and stance
ankle position so that the prosthesis control can take advantage
of the full leg placement policy [see (7)]. Other sources for
the performance gap could stem from differences in the inertial
properties between the prosthesis and the healthy leg, delay and
inaccuracy in the SEA torque tracking, and the increased number of parameters in the asymmetric amputee model, which can
reduce the quality of the optimized solutions.

909

Fig. 6. Tripping response of the amputee model with (a) neuromuscular and
(b) impedance control of the prosthesis. Shown are the prosthetic toe trajectories
during undisturbed gait (dashed line) and when disturbed by a 15 N · s impulse
(solid line). The neuromuscular controller effectively responds to the disturbance
and maintains a qualitatively similar toe trajectory. The impedance controller
leads to foot scuffing and an eventual fall (compare Fig. 1).

Fig. 6(a) shows the toe trajectory of the prosthesis using neuromuscular control both in the undisturbed and disturbed cases.
While the impulse causes a large deviation from the nominal
trajectory in early swing, the controller quickly recovers. From
midswing onward, the foot follows a qualitatively similar path,
maintains adequate ground clearance, and successfully reaches a
similar foot placement as in the undisturbed case. In contrast, the
prosthesis with impedance control does not respond adequately
when subjected to the disturbance [see Fig. 6(b)]. This is illustrated by the prosthesis behavior in midswing, during which
it does not react appropriately to maintain ground clearance of
the toe. Rather, the joint-based impedance functions drive the
knee into extension prematurely, and the prosthetic foot scuffs
the ground resulting in a trip and subsequent fall (compare
also Fig. 1).
IV. INITIAL CONTROL EVALUATION ON HARDWARE
Our simulation results suggest that the proposed prosthesis
design and control can improve balance recovery in transfemoral
amputee walking in some situations. Toward a full realization
and study on amputee subjects, we present a partial implementation and evaluation of the control on the current prosthesis
prototype worn by a nonamputee user.

D. Prosthesis Response to Simulated Trips

A. Experimental Testbed

A possible explanation for why the neuromuscular control
produces more robust behavior than impedance control is the
former’s attempt to mimic the underlying dynamics and goals
of human motor control rather than to track impedance behavior
about a predefined motion for each individual joint. To illustrate
this difference, we subject the amputee model with both control
strategies to a simulated trip in the form of a 15 N · s impulse
applied at 5% of the undisturbed swing duration.

Fig. 7 shows an able-bodied user wearing our current prosthesis prototype. The current prosthesis prototype has an active
knee SEA unit and an unpowered spring-loaded ankle [compare
Fig. 3(b)]. We connect the prosthesis to a knee crutch (iWalk
2.0 Hands Free Crutch) in order to allow a nonamputee experimenter to test the control. Additionally, the experimenter wears
a lift shoe to compensate for the added thigh length of the knee
crutch and prosthesis.

910

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 7. Nonamputee experimenter tests the prosthesis using an iWalk Crutch
as a knee adaptor. The experimenter wears a lift shoe on the contralateral leg to
compensate for the added thigh length of the prosthesis and knee adaptor.

To control the prosthesis knee, we use Simulink Real-Time
(Mathworks, USA), which samples all sensors (joint encoders,
IMU on thigh, force sensors in foot), runs a low-level SEA
control [25], and sends commands to the motor controller at a
rate of 1 kHz (compare Section II-C). In addition, the real time
software executes the hybrid neuromuscular behavior control
at a rate of 5 kHz, ensuring that the integration (ode1) of the
simulated muscle dynamics remains stable.
The behavior control of the knee is identical in swing to the
one used in the simulation experiments [see (8)–(11)]; however,
the missing ankle actuation in the current prosthesis prototype
restricts the neuromuscular stance control to those muscles that
span the knee: the VAS, HAM, and GAS. The HAM and VAS
are stimulated according to (4) and (5), respectively. Similarly,
the GAS is stimulated by positive force feedback (compare
Section II-A). (The torso balance contribution of the complete
HAM stimulation, (6), is neglected.)
B. Slow Walking Behavior
We first test if the prosthesis control can reproduce normal
stance and swing behavior of the lower limb in steady-state
walking. For this purpose, we capture joint kinematics and kinetics as well as the virtual muscle activations of the prosthesis
control, while an experimenter walks for ten trials with the
crutch and prosthesis system on a treadmill. Because the fit of

Fig. 8. Prosthesis behavior at walking speed of 0.5 m/s. Shown are the hip
and knee trajectories, the knee controller torque, and the activations of the VAS,
HAM, and GAS muscles generated by the prosthesis control in the testbed. Solid
black lines show averaged data of ten trials with the individual trials depicted in
gray. Dashed lines show corresponding data from human walking at preferred
speed (joint angles and knee torque: [30], muscle surface electromyograms:
[31]). Solid and dashed vertical lines indicate median toe off times for the
prosthesis and human data, respectively.

the crutch to the experimenter’s leg is not very tight, we limit
the walking speed to 0.5 m/s and the experimenter holds onto
handrails for safety (see Fig. 7).
The control generates steady-state prosthesis behavior that
qualitatively reproduces human leg behavior in walking. Fig. 8
compares the observed prosthesis leg behavior (solid lines)
to corresponding human data at the preferred walking speed
(dashed lines, adapted from [30], [31]). The hip and knee kinematics match overall, although later transitions from stance to
swing are observed in both joints (θh and θk ) and the prosthesis
knee flexes less in stance (θk ). The knee torque follows trends

THATTE AND GEYER: TOWARD BALANCE RECOVERY WITH LEG PROSTHESES USING NEUROMUSCULAR MODEL CONTROL

911

similar to human data, but the peak flexion and extension torques
in the early stance phase are diminished (τk ). These lower peaks
are caused by reduced activations of the virtual VAS and HAM
muscles in this phase, a clear difference to these muscles’ activations in humans, in which bursts of activity at heel strike are
followed by relative silence. Finally, the activity of the virtual
GAS muscle bears strong similarity to the activity of this muscle
in human walking.
To some extent, limitations of our current experimental
testbed may account for observed discrepancies. The imposed
slow walking speed of 0.5 m/s required less energy absorption
in early stance than a normal walking speed. Moreover, the experimenter held onto the handrails to assist with lateral balance,
which may have channeled some impact energy through the
arms. In addition, the hybrid nature of the proposed control prevents the virtual muscles from activating in swing, which is the
case in humans (Fig. 8, VAS and HAM activities from 80% to
100% of gait cycle), and would alter the response of the virtual
muscles at heel strike. Finally, the lack of an active ankle and
its control in the current prosthesis prototype further limits how
closely the leg behaviors can match.
C. Response to Swing Leg Tripping
In a second set of experiments, we evaluate the response of the
prosthesis controller to trip disturbances. We apply disturbances
during treadmill walking by commanding flexion knee torques
to the prosthesis in addition to its swing leg control torque.
The added torque simulates an obstacle encounter modeled in
the same way as the stopping torque of the swing leg control [see
(10)], with αthr replaced by a disturbance leg angle. The foot can
pass the simulated obstacle if the leg length contracts beyond a
threshold of 94 cm. For an early-, mid-, or late-swing encounter,
the disturbance angle is set to 110◦ , 95◦ , or 80◦ , respectively. In
addition, anticipation of the trip by the experimenter is prevented
by applying the disturbance only with a probability of 25%.
The experiments reveal that in response to disturbances during
early and late swing, the prosthesis control places the swing leg
with high repeatability and produces leg elevating and lowering
strategies observed in humans. Fig. 9 shows the Cartesian ankle
trajectory in swing over ten trials for the undisturbed (a) and
disturbed conditions (b)–(d). In the undisturbed condition, the
leg placement is repeatable with an interquartile range (IQR)
of landing positions of 3.1 cm and a bias of 2.7 cm (median)
from the target (dashed line). (Further tuning of the control
parameters should improve the landing position accuracy.)
In the early disturbance condition [see Fig. 9(b)], the prosthesis generates large knee flexion roughly doubling the peak
ground clearance. Nonetheless, the median landing position remains within 5.3 cm of the target (IQR: 10.2 cm) demonstrating
the knee control’s ability to compensate for early swing disturbances. This response is similar to the leg elevating strategy observed in humans when disturbed shortly after toe off [32], [33].
The biological strategy, however, shows active knee flexor muscle contributions, while the prosthesis knee flexion is entirely
passive, as the leg angular velocity does not become negative
during the disturbance [see (8), Section II-B].

Fig. 9. Response to simulated tripping disturbance. (a) Undisturbed ankle
trajectory calculated from hip and knee angles assuming constant hip height.
(b)–(d) Ankle trajectories with disturbance applied in early, mid, and late swing
(arrows). The vertical dashed line shows the target landing position of the foot,
which corresponds to a 75◦ landing angle.

In the late disturbance condition [see Fig. 9(d)], the prosthesis
leg behavior resembles the lowering strategy of humans [33],
in which knee extensor muscles quickly extend the leg. This
behavior is triggered on the prosthesis in the third phase of the
swing control before the leg angle starts to retract [see (11)].
The prosthesis achieves ground contact slightly earlier with a
median landing point of 8.8 cm before the target (IQR: 3 cm).
Finally, Fig. 9(c) shows the response of the prosthesis to a
midswing disturbance. When humans are confronted with disturbances in midswing, they may use either elevating or lowering
strategies [32], [33]. However, the prosthesis response resembles
neither strategy. During midswing, the prosthesis control uses
a holding policy, damping both knee flexion and extension [see
(9)]. Consequently, in most cases, the knee angle neither flexes
adequately to clear the obstacle nor extends quickly enough to
make timely ground contact. In these trials, falling was only
prevented via support from the treadmill handrails.
V. DISCUSSION
Our simulation results suggest that the hybrid neuromuscular
control policy can improve amputee gait stability over existing
impedance control methods. An amputee model walking with
a powered prosthesis showed substantial improvements in balance recovery on rough ground and after swing leg trips when
using the hybrid neuromuscular control policy as opposed to
impedance control. One possible reason for the improvement is
that the proposed controller considers global leg information,

912

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

such as the target leg angle [see (8)–(10)], and it is well known
that without placing the feet into proper target points on the
ground, legged systems fail to balance [15]–[17], [34]–[36]. A
second reason could be that the design of the swing leg control
policy explicitly accounts for large disturbances to the lower
limb dynamics in order to achieve the desired leg placements
[18]. Neither is the case for current impedance control policies;
however, future research may show that impedance or other
control policies can equally make use of this global information
and design criterion.
Whether the simulation results transfer to amputee gait remains to be determined. In an initial test with a nonamputee
experimenter wearing the prosthesis via a knee adaptor, we
found that the hybrid neuromuscular control reproduces normal
walking patterns qualitatively and effectively responds to disturbances in early and late swing. To understand if these initial
results generalize to amputee locomotion requires further research. First, we only simulated disturbances in the hardware
tests by commanding disturbance torques to the prosthesis knee.
This approach allowed us to apply reproducible disturbances,
but it does not capture real tripping or obstacle encounters, which
will, for instance, exert torques about the hip joint as well. Second, the use of the knee adaptor creates abnormal kinematics
and inertias and provides only a loose fit between user and prosthesis. In consequence, we only tested slow walking at 0.5 m/s
holding onto hand rails.
Finally, the simulation and hardware tests captured only a
small portion of the balance disturbances that humans typically encounter [37]. Other disturbances may evoke amputee
responses that the simulation model does not capture; especially since it is driven solely by a reflexive walking controller
that ignores conscious interventions. In addition, the hardware
experiments revealed that the control’s response to midswing
disturbances does not match the observed human responses and
risks allowing the user to fall. This result suggests that the model
and corresponding hardware implementation require additional
reflexes or structural changes in the control to better capture human locomotion and balance recovery. Foot placement into target points, while beneficial in particular for responding to early
swing disturbances and for rough ground walking, may not be
a goal that the human system prioritizes in response to other
disturbances. Identifying human objectives in these situations
could lead to improved leg prosthesis behaviors independent
of the proposed approach, impedance-like approaches, or other
control design approaches.
VI. CONCLUSION
We extended a neuromuscular model to formulate a control
policy for powered knee–ankle prostheses. The proposed
control approach differs from existing methods like impedance
control as it incorporates high-level goals such as the target leg
angle, which may help to improve amputee gait stability and
stumble recovery.
We evaluated the proposed control in simulation experiments
with an amputee gait model and presented preliminary results
captured from a nonamputee experimenter wearing a prototype

of a powered leg prosthesis with a knee adaptor. Our simulation
results suggest that the proposed control enables an amputee to
walk over rougher terrain and recover from larger disturbances
than an amputee walking with an otherwise identical impedance
controlled prosthesis. Our results from the initial hardware implementation of the proposed control indicate that it qualitatively
reproduces human leg behavior of steady walking and shows biological responses to disturbances to the swing leg during early
and late swing. However, evaluating if these results truly lead
to improved balance recovery as performed by amputees will
require more experiments. In addition, improving the control’s
response to midswing disturbances and investigating how well
it extends to other types of balance disturbances that humans
typically encounter will require further research.

REFERENCES
[1] K. Ziegler-Graham et al., “Estimating the prevalence of limb loss in the
united states: 2005 to 2050,” Arch. Phys. Med. Rehabil., vol. 89, no. 3,
pp. 422–429, 2008.
[2] P. F. Pasquina et al., “Advances in amputee care,” Arch. Phys. Med.
Rehabil., vol. 87, no. 3 Supp. 1, pp. 34–3, 2006.
[3] R. Waters et al., “Energy cost of walking of amputees: The influence of
level of amputation,” J. Bone Joint Surg Amer., vol. 58, no. 1, pp. 42–46,
1976.
[4] M. Bellmann et al., “Comparative biomechanical analysis of current
microprocessor-controlled prosthetic knee joints,” Arch. Phys. Med. Rehabil., vol. 91, no. 4, pp. 644–652, 2010.
[5] F. Sup, et al., “Design and control of a powered knee and ankle prosthesis,”
in Proc. IEEE Int. Conf. Robot. Autom., 2007, pp. 4134–4139.
[6] F. Sup et al., “Design and control of a powered transfemoral prosthesis,”
Int. J. Robot. Res., vol. 27, no. 2, pp. 263–273, 2008.
[7] F. Sup et al., “Preliminary evaluations of a self-contained anthropomorphic transfemoral prosthesis,” IEEE/ASME Trans. Mechatron., vol. 14,
no. 6, pp. 667–676, Dec. 2009.
[8] T. Lenzi et al., “Speed-adaptation mechanism: Robotic prostheses can
actively regulate joint torque,” IEEE Robot. Autom. Mag., vol. 21, no. 4,
pp. 94–107, Dec. 2014.
[9] T. Lenzi et al., “Minimum jerk swing control allows variable cadence
in powered transfemoral prostheses,” in Proc. IEEE Ann. Int. Conf. Eng.
Med. Biol. Soc., 2014, pp. 2492–2495.
[10] R. D. Gregg et al., “Virtual constraint control of a powered prosthetic
leg: From simulation to experiments with transfemoral amputees,” IEEE
Trans. Robot., vol. 30, no. 6, pp. 1455–1471, Dec. 2014.
[11] F. Sup, “Upslope walking with a powered knee and ankle prosthesis: Initial
results with an amputee subject,” IEEE Trans. Neural Syst. Rehabil. Eng.,
vol. 19, no. 1, pp. 71–78, Feb. 2011.
[12] B. E. Lawson, et al., “Stumble detection and classification for an intelligent transfemoral prosthesis,” in Proc. IEEE Annu. Int. Conf. Eng. Med.
Biol. Soc., 2010, pp. 511–514.
[13] M. F. Eilenberg, et al., “Control of a powered ankle–foot prosthesis based
on a neuromuscular model,” IEEE Trans. Neural Syst. Rehabil. Eng., vol.
18, no. 2, pp. 164–173, Jan. 2010.
[14] H. Geyer and H. Herr, “A muscle-reflex model that encodes principles of
legged mechanics produces human walking dynamics and muscle activities,” IEEE Trans. Neural Syst. Rehabil. Eng., vol. 18, no. 3, pp. 263–273,
Jun. 2010.
[15] M. H. Raibert, Legged Robots That Balance. Cambridge, MA, USA: MIT
press, 1986.
[16] S. Kajita et al., “The 3D linear inverted pendulum mode: a simple modeling for a biped walking pattern generation,” in Proc. IEEE/RSJ Int. Conf.
Intell. Robot. Syst., 2001, pp. 239–246.
[17] J. Pratt et al., “Capture point: A step toward humanoid push recovery,” in
Proc. IEEE-RAS 6th Int. Conf Humanoid Robot., 2006, pp. 200–207.
[18] R. Desai and H. Geyer, “Robust swing leg placement under large disturbances,” in Proc. IEEE Int. Conf. Robot. Biomimetics, 2012, pp. 265–270.
[19] S. Song et al., “Integration of an adaptive swing control into a neuromuscular human walking model,” in Proc. IEEE 35th Annu. Int. Conf. Eng.
Med. Biol. Soc., 2013, pp. 4915–4918.

THATTE AND GEYER: TOWARD BALANCE RECOVERY WITH LEG PROSTHESES USING NEUROMUSCULAR MODEL CONTROL

[20] J. L. van Leeuwen, “Muscle function in locomotion,” in Mechanics of
Animal Locomotion, R. Alexander, Ed. New York, NY, USA: SpringerVerlag, 1992, pp. 191–249.
[21] K. Yin et al., “Simbicon: Simple biped locomotion control,” ACM Trans.
Graph., vol. 26, no. 3, pp. 105-1–105-10, 2007.
[22] M. L. Madigan and E. M. Lloyd, “Age-related differences in peak joint
torques during the support phase of single-step recovery from a forward
fall,” J. Gerontol. A, Biol. Sci. Med. Sci., vol. 60, no. 7, pp. 910–914, 2005.
[23] M. D. Grabiner et al., “Kinematics of recovery from a stumble,” J.
Gerontol., vol. 48, no. 3, pp. M97–M102, 1993.
[24] G. Pratt and M. Williamson, “Series elastic actuators,” in Proc. IEEE/RSJ
Int. Conf. Intell. Robot. Syst. Human Robot Interact. Cooperative Robots,
1995, vol. 1, pp. 399–406.
[25] A. Schepelmann et al., (2012). Development of a testbed for robotic
neuromuscular controllers. presented at Robotics, Science Systems VIII.
[Online]. Available: http://www.roboticsproceedings.org/rss08/p49.html
[26] B. J. Brown et al., “Amputation in the diabetic to maximize function,”
Seminars Vascular Surg., vol. 25, no. 2, pp. 115–121, 2012.
[27] N. Hansen, “The cma evolution strategy: A comparing review,” in Towards
a New Evolutionary Computation (ser. Studies in Fuzziness and Soft
Computing), J. Lozano, P. Larraaga, I. Inza, and E. Bengoetxea, Eds.
Berlin, Germany: Springer-Verlag, 2006, vol. 192, pp. 75–102.
[28] R. McNeill Alexander, “Energetics and optimization of human walking
and running: The 2000 raymond pearl memorial lecture,” Amer. J. Human
Biol., vol. 14, no. 5, pp. 641–648, 2002.
[29] B. R. Umberger et al., “A model of human muscle energy expenditure,”
Comput. Methods Biomech. Biomed. Eng., vol. 6, no. 2, pp. 99–111, 2003.

913

[30] D. A. Winter, Biomechanics and Motor Control of Human Movement.
New York, NY, USA: Wiley, 2009.
[31] J. Perry and J. Burnfield (2010). Gait Analysis: Normal and Pathological Function. SLACK. [Online]. Available: https://books.google.com/
books?id=DICTQAAACAAJ
[32] J. J. Eng et al., “Strategies for recovery from a trip in early and late swing
during human walking,” Exp. Brain Res., vol. 102, no. 2, pp. 339–349,
1994.
[33] A. Schillings et al., “Muscular responses and movement strategies during
stumbling over obstacles,” J. Neurophysiol., vol. 83, no. 4, pp. 2093–2102,
2000.
[34] M. A. Townsend, “Biped gait stabilization via foot placement,” J.
Biomech., vol. 18, no. 1, pp. 21–38, 1985.
[35] A. Seyfarth et al., “A movement criterion for running,” J. Biomech., vol.
35, pp. 649–655, 2002.
[36] A. Wu and H. Geyer, “The 3-D spring-mass model reveals a time-based
deadbeat control for highly robust running and steering in uncertain environments,” IEEE Trans. Robot., vol. 29, no. 5, pp. 1114–1124, Oct.
2013.
[37] S. N. Robinovitch et al., “Video capture of the circumstances of falls in
elderly people residing in long-term care: An observational study,” Lancet,
vol. 381, no. 9860, pp. 47–54, 2013.

Authors’ photographs and biographies not available at the time of publication.

