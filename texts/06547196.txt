3194

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

An Automated Method for Retinal Arteriovenous
Nicking Quantification From Color Fundus Images
Uyen T. V. Nguyen, Alauddin Bhuiyan, Laurence A. F. Park, Ryo Kawasaki, Tien Y. Wong, Jie Jin Wang,
Paul Mitchell, and Kotagiri Ramamohanarao∗

Abstract—Retinal arteriovenous (AV) nicking is one of the
prominent and significant microvascular abnormalities. It is characterized by the decrease in the venular caliber at both sides of
an artery-vein crossing. Recent research suggests that retinal AV
nicking is a strong predictor of eye diseases such as branch retinal
vein occlusion and cardiovascular diseases such as stroke. In this
study, we present a novel method for objective and quantitative AV
nicking assessment. From the input retinal image, the vascular network is first extracted using the multiscale line detection method.
The crossover point detection method is then performed to localize all AV crossing locations. At each detected crossover point, the
four vessel segments, two associated with the artery and two associated with the vein, are identified and two venular segments
are then recognized through the artery-vein classification method.
The vessel widths along the two venular segments are measured
and analyzed to compute the AV nicking severity of that crossover.
The proposed method was validated on 47 high-resolution retinal
images obtained from two population-based studies. The experimental results indicate a strong correlation between the computed
AV nicking values and the expert grading with a Spearman correlation coefficient of 0.70. Sensitivity was 77% and specificity was
92% (Kappa κ = 0.70) when comparing AV nicking detected using the proposed method to that detected using a manual grading
method, performed by trained photographic graders.
Index Terms—Arteriovenous (AV) nicking, blood vessel segmentation, crossover point detection, retinal image, vessel width
measurement.

Manuscript received March 7, 2013; revised May 20, 2013; accepted June
16, 2013. Date of publication June 25, 2013; date of current version October
16, 2013. Asterisk indicates corresponding author.
U. T. V. Nguyen is with the Department of Computing and Information Systems, The University of Melbourne, Parkville, VIC 3010, Australia (e-mail:
thivun@student.unimelb.edu.au).
A. Bhuiyan is with the ICT Centre, Australian E-Health Research Centre,
Commonwealth Scientific and Industrial Research Organization (CSIRO), Perth
WA 6014, Australia (e-mail: alauddin.bhuiyan@csiro.au).
L. A. F. Park is with the School of Computing, Engineering and Mathematics, The University of Western Sydney, NSW 2751, Australia (e-mail:
lapark@scm.uws.edu.au).
R. Kawasaki is with the Department of Public Health, Yamagata University Faculty of Medicine, Yamagata 990-9585, Japan (e-mail: ryok@med.id.
yamagata-u.ac.jp).
T. Y. Wong is with the Singapore Eye Research Institute, National University
of Singapore, Singapore (e-mail: tien_yin_wong@nuhs.edu.sg).
J. J. Wang and P. Mitchell are with the Centre for Vision Research, Department of Ophthalmology, Westmead Millennium Institute, University of Sydney (C24), Sydney, NSW 2006, Australia (e-mail: jiejin.wang@sydney.edu.au;
paul.mitchell@sydney.edu.au).
∗ K. Ramamohanarao is with the Department of Computing and Information
Systems, The University of Melbourne,Parkville, VIC 3010, Australia (e-mail:
kotagiri@unimelb.edu.au).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2271035

Fig. 1. Examples of AV crossings: (a) normal AV crossing and (b) AV nicking
crossing. (Please refer to the color version of the paper for a clear view of the
images.)

I. INTRODUCTION
ETINAL arteriovenous nicking (AV nicking or AVN) is
the phenomenon where the vein is compressed by a stiff
artery at their crossing location in response to a rise in blood
pressure (i.e., hypertension) [1], [2]. In retinal photographs, AV
nicking exhibits itself as the decrease in the venular caliber at
both sides of an artery-vein (AV) crossing (see Fig. 1). The
prevalence of moderate to severe AV nicking is reported as
2.2% in the Beaver Dam Eye population [3] while this number
is found higher (7.7%) in the older population of the Cardiovascular Health Study [4]. It was claimed that AV nicking is
associated with not only current blood pressure but also past
blood pressure, implying that it is a persistent and long-term
marker of hypertension [2]. Strong and consistent association
between AV nicking and systemic diseases has also been found
by recent population-based studies [5]–[13]. The Atherosclerosis Risk in Communities (ARIC) study reported that people
with AV nicking are two times more likely to develop an incident stroke than those without (relative risk 2.21, 95% confidence interval [CI] 1.44–3.38) [6]. In addition, AV nicking was
also found strongly associated to retinal vein occlusion, a common sight-threatening ocular disorder (odds ratio 16.75, 95%
CI 7.33–38.24) [14]. Therefore, the assessment of AV nicking
is extremely important in order to identify people at high risk of
cardiovascular diseases for early and in-time treatment.
Currently, the assessment of AV nicking is done by human
graders in a subjective and qualitative manner. In this process,
a grader examines all AV crossing points in a retinal image
and compares each of them with standard photographs to assess
the presence and severity of AV nicking for that image [15].
This grading process, however, depends heavily on the graders’
expertise and, thus, its accuracy and reproducibility are of concerns. The ARIC study reported that only a fair to moderate

R

0018-9294 © 2013 IEEE

NGUYEN et al.: AN AUTOMATED METHOD FOR RETINAL ARTERIOVENOUS NICKING QUANTIFICATION FROM COLOR FUNDUS IMAGES

agreement is achieved with the manual AV nicking assessment
(inter- and intragrader Kappa value κ = 0.40 to 0.61 [15] and
κ = 0.56 to 0.57 in a more dedicated study [16]). In addition,
the current manual grading process is very time consuming,
which makes it infeasible for large-scale screening and clinical
applications. In [17], we have proposed a computerized method
for AV nicking measurement which helps to reduce the grading
time substantially. However, this method also requires human
intervention as the user needs to select the crossover positions
in each retinal image. Motivated by this, we propose in this
paper a fully automated method, which is to the best of our
knowledge, the first computerized method proposed for automated AV nicking assessment. The proposed method produces
a continuous value, implying the AV nicking severity level, for
each AV crossing point in a retinal image. The advantages of
the proposed method include:
1) The measurements produced are objective, reproducible,
and repeatable.
2) The computed measurements reveal more details on AV
nicking severity, which are not available in the human
grading system. Such information may help to strengthen
the relationship between AV nicking and known diseases
such as hypertension and stroke.
3) The computed measurements provide an important basis
toward the development of a computer system for automatic AV nicking detection for large-scale screening
systems.
The rest of this paper is organized as follows. In Section II, the
details of the proposed method are described. The experimental
results to demonstrate the performance of the proposed method
are presented in Section III. Finally, the paper is concluded with
Section IV.
II. METHODOLOGY
The overall framework of the proposed AV nicking quantification method is illustrated in Fig. 2. The system takes as input
the retinal image and returns a real number quantifying the severity level for each AV crossing point detected from that image.
From the input retinal image, the vessel segmentation method is
applied to extract the blood vessels from the image background
for further analysis. A crossover point detection method is then
performed to detect AV crossing locations within the retinal image. At each detected crossing position, the four major vessel
segments constituting the two vessels (i.e., the artery and the
vein) are localized and the two venular segments are identified
through an artery-vein classification process. The vessel widths
of each venular segment are then measured and analyzed for
AV nicking measurement. The following sections describe each
step of the system in details.
A. Vessel Segmentation
Blood vessel segmentation from high-resolution retinal color
images is complicated by retinal vessel central light reflex,
choroidal vascularization, and image artifacts such as background homogenization and other impulse noises. Although
many methods have been proposed for retinal vessel extraction,

3195

they are not effective for detecting blood vessels in our image
set that includes high-resolution images with the presence of
vessel central light reflex (i.e., the bright strip along the middle
of a vessel). Motivated by this, we have proposed a new method
for effective retinal vascular network extraction using multiscale line detection technique, which is described in [18]. The
proposed segmentation method combines line detectors at varying scales to produce an enhanced retinal image and the final
segmentation is obtained by a thresholding operator. The proposed method was proven to be effective in dealing with central
light reflex problem while providing accurate vessel boundary
detection.
Fig. 3 shows a cropped retinal image with the presence of
central light reflex and the segmented image obtained using our
method. It can be seen that the proposed method can correctly
segment all blood vessels, even on vessels with the presence
of central light reflex. Hence, it was used in our system for
automatic blood vessel extraction.
B. Artery-Vein Crossover Point Detection
The vascular network is constructed of three important landmark points: branching, bifurcation, and crossover. A crossover
is the place where two vessels (i.e., a vein and an artery) cross
each other while a branching or a bifurcation is the place where
one vessel splits into two vessels. Since AV nicking happens
at the AV crossing locations, the method first needs to detect
all crossover points within a retinal image. For this task, an
efficient method for automated crossover point detection has
been proposed and described in details in [19]. This section provides a brief summary of the proposed method for the sake of
completeness.
To detect AV crossover points, the vascular skeleton and edge
images are first extracted from the segmented image using binary morphological operators. The vessel skeleton is extracted
using an iterative thinning process [20] which successively
erodes away pixels on the boundary of the objects while preserving its connectivity until no more thinning is possible. In
contrast, the vessel edge image is achieved by a morphological
operator that removes interior pixels and retains only pixels on
the vessel boundaries [20]. The crossover locations are then detected by an extensive analysis on the extracted vascular skeleton
and edge images as follows.
At each skeleton pixel P , we compute the cross-point number
(cpn) [21] as follows:
1
|Ni (P ) − Ni+1 (P )|
2 i=1
8

cpn(P ) =

(1)

where Ni (P ) are the neighbor pixels of P (in a 3 × 3 neighborhood) named in an anticlockwise order and N9 (P ) = N1 (P ).
The cpn number computed for each skeleton pixel represents
the number of vessel segments connected to that pixel in the
skeleton image. Hence, all skeleton pixels with cpn equal to 3
are initially marked as bifurcation candidates while those with
cpn equal to 4 are labeled as crossover candidates. Then, two bifurcation candidates are further grouped as one crossover if they
are connected by at most T pixels. The segment that connects

3196

Fig. 2.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

Main steps of the proposed method for automated AV nicking quantification.

Fig. 3. Example showing the vessel segmentation result: (a) cropped retinal
image with the presence of center light reflex (pointed by black arrows) and
(b) segmented image.

Fig. 4. Geometrical features of two vessels constituting a crossover: (a) α 1 and
α 2 represent intersection angles formed by the two vessels; (b) representation
of α 1 , α 2 in the skeleton image; and (c) β1 and β 2 represent the curvature of
each vessel at the crossing.

the two bifurcation points is then identified and its middle point
is located and served as the true position of that crossover. This
step helps to detect crossover points that are represented by two
bifurcation points in the skeleton image when two vessels intersect at an acute angle. However, this process also falsely detects
those points that have the same configuration in the skeleton image as crossovers. To distinguish true crossovers from spurious
results, two geometrical features of each detected crossover are
analyzed:
1) The intersection angles formed by the two vessels at the
crossing (α1 and α2 in Fig. 4(a) and (b)).
2) The two angles representing the curvature of each vessel
at the crossing (β1 and β2 in Fig. 4(c)).
A detected crossover is valid if it satisfies:
(max(α1 , α2 ) < αm ax ) and

(min(β1 , β2 ) > βm in )

(2)

where αm ax and βm in are two parameters to be set. We used
five retinal images for parameter tuning and the experimental results show that with our image set (see Section III-A),
{T = 75, αm ax = 110, βm in = 140} is a suitable setting. The
performance of the proposed method was assessed on a subset

Fig. 5. Performance of the proposed crossover point detection method in terms
of precision, recall, and F1-measure on 15 test images when T changes from 0
to 100 pixels.

of 15 test images randomly selected from our image set (different from five training images). The results show that out of 41
crossover points detected, 38 of them are correct, which indicates an accuracy (or precision) of 93%. In addition, our method
has missed four crossovers, which means that the recall of our
method is 90%. This has demonstrated the effectiveness of our
method for crossover point detection. The detected crossing locations are then fed directly to the AV nicking quantification
method so that their AV nicking severity can be assessed.
It should be noted that among the three parameters (T, αm ax ,
and βm in ), T is the only parameter that is dependent on the image
set (i.e., image resolution). Hence, the same values of αm ax
and βm in can be used for a new image set. To investigate the
dependence of the system on T , we examined the performance
achieved in terms of precision, recall, and F1-measure (F1 =
2×precision×recall
precision+recall ) on 15 test images when T changes from 0 to
100 pixels (see Fig. 5). This figure shows that similar results are
obtained for a long range values of T (65 < T < 100), which
implies that the performance of the proposed method is not very
sensitive to the setting of T .

NGUYEN et al.: AN AUTOMATED METHOD FOR RETINAL ARTERIOVENOUS NICKING QUANTIFICATION FROM COLOR FUNDUS IMAGES

3197

C. AV Nicking Quantification
At each detected crossover, a subimage centered on the crossing location is identified and used for all subsequent analysis
for computational efficiency. Since AV nicking is characterized
by the decrease in the venular width at the crossing location, the
two vessel segments constituting the vein are extracted and their
vessel widths are measured and analyzed for AV nicking computation. To achieve this, the segmented image at each crossover
is applied to a sequence of the following steps:
1) Major vessel identification
2) Venular segment identification
3) Vessel width measurement
4) AV nicking measurement
The details of each step are described in the following
sections:
1) Major Vessel Identification: This step aims to identify the
main vessels constituting the crossover and isolate them from
unnecessary structures such as small branches or noisy artifacts.
To achieve this, the system first examines both vessel skeleton
and edge images to detect and classify all feature points as
crossover (C), bifurcation (Bi) or branching point (Br). We have
described the method for crossover point detection in Section IIB. Branching point is the place where one small vessel comes
out from a main vessel while a bifurcation point is the place
where one vessel splits into two similar vessels. To distinguish
branching point from the bifurcation point, the vessel widths of
the three vessel segments associated with that point are measured and recorded as Wc (the vessel width of the trunk vessel),
Wa (the vessel width of the smaller branch), and Wb (the vessel
width of the larger branch). A feature point is classified as a
a
bifurcation if W
W b ≥ fb (0 < fb < 1) and as a branching point
otherwise. For example, fb = 0.5 means that at a branching location, if the vessel width of the smaller branch is equal to or
greater than half of the vessel width of the bigger branch, that
feature point is considered as a bifurcation. This setting guarantees that two branches of a bifurcation are of similar diameter.
To identify a suitable setting for fb , we randomly selected ten
bifurcation and ten branching points in the working image set
Wa
and examined fb values (fb = W
b ) of these selected landmark
points. For this, at each selected landmark point, we manually
measured the vessel width of its smaller branch (Wa ) and the
a
bigger branch (Wb ). fb is then computed as the ratio of W
Wb .
Fig. 6 shows the distribution of fb values of these 20 landmark
points and it is shown that there is a clear separation in fb values
of bifurcation and branching points: all bifurcation points have
fb ≥ 0.8 while all branching points have fb ≤ 0.73. Hence, fb is
set as 0.8 in our system for bifurcation/branching classification.
The process of major vessel identification is then performed as
follows. From the extracted vascular network, the system traces
from the crossing position through its four connected vessel
segments and performs appropriate action when a branching, a
crossover, or a bifurcation is encountered. If a crossover or a bifurcation is found, the system stops its traversal and terminates
the vessel along that direction. Otherwise, if a branching point
is found, the smaller branch is trimmed off and the system continues its traversal along the main vessel until a bifurcation or a

Fig. 6. Distribution of fb values over 20 randomly selected landmark points
(ten branching and ten bifurcation points).

Fig. 7. Example showing the cutoffs at: (a) crossover point C; (b) bifurcation
point Bi; and (c) branching point Br.

crossover point is encountered. To realize this, at each crossover
(except the crossover to be examined) or bifurcation point, cutoffs are performed to separate its constituting segments while
at a branching point, the cutoff is to separate the smaller branch
from the main vessel. This process is demonstrated in Fig. 7.
Once the cutoffs are performed at all detected feature points, the
simplified segmentation is obtained by a morphological reconstruction starting at the crossing position, following the direction
of its four segments and stopping when a cutoff is met.
This major vessel identification process helps to retain important vessel structure while removing unnecessary structures
to simplify the subsequent analysis. Fig. 8 shows the example
results obtained through this process on the two crossover points
in Fig. 1. We can see that this process has effectively removed
small branches and noisy segments from the vascular network,
retaining only important vessels constituting the crossover for
accurate AV nicking assessment.
To illustrate the effect of fb value on the resulting segmentation, Fig. 9 shows the results obtained with two different settings
of fb on a crossover. On this example crossover, there are two
branching points (Br1 and Br2 ) on the vein vessel close to
the crossing region. The results show that if fb is set too small
(i.e., fb = 0.1, Fig. 9(b)), the two small branches of the vein are
incorrectly classified as bifurcation and this leads to the early
termination of the system near the crossing location. This results
in an inadequacy in the vascular network obtained since only a
small portion of the two venular segments are retained for further

3198

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

Fig. 10. Example showing the individual vessel identification process:
(a) cutoff at the crossing region to separate the vascular network into four vessel
segments, labeled in a clockwise order (from S 1 to S 4 ); (b) and (c) two opposite segments are paired to represent each vessel: VSS1 = (S 1 , S 3 ), VSS2 =
(S 2 , S 4 ).
Fig. 8. Example results of the major vessel identification process: (a) initial segmentation; (b) skeleton image with detected branching points marked
with cross signs and detected bifurcation points marked with circles; (c) segmented image with cutoffs at branching and bifurcation points; (d) simplified
segmentation.

Fig. 11. Example results of the venular segment identification process: (a)
simplified segmentation with the cut-off at the crossover point; (b) AV classified
image (artery is in red, vein is in green); (c) extracted venular segments; (d)
extracted venular skeleton and edge superimposed on the original image.

Fig. 9. Example results obtained after the major vessel identification process
with two different settings of fb : (a) cropped retinal image at a crossover
point (top) and its initial segmentation (bottom), (b) and (c): (top) segmentation
with cutoffs at the detected bifurcation and branching points and (bottom) its
simplified segmentation when (b) fb = 0.1 and (c) fb = 0.8.

analysis. On the other hand, when fb is set as 0.8 (see Fig. 9(c)),
the two small branches of the vein are correctly identified and
they are successfully trimmed off from the main vessel. This
helps to retain the most important parts of the vein and make
them available for the subsequent AV nicking measurement.
2) Venular Segment Identification: The simplified segmentation provides us with a vascular network containing four segments; two associated with the vein and two associated with
the artery. Our analysis is performed on the vein, therefore we
need to determine which pair is associated to the vein. This is
done by an analysis on the vessel skeleton and edge images extracted from the simplified segmentation. The vascular skeleton
divides the boundary into four sections. For each section, the
edge point closest to the crossing position is identified, resulting
in four edge points: E1 , E2 , E3 , E4 (see Fig. 10(a)). Connecting these four points in a convex hull order will divide the whole
segmentation into five parts: the four vessel segments and the intersection region. The four segments are labeled in a clockwise
order from S1 to S4 . Then, two opposite segments are paired to
represent each vessel, i.e., VSS1 = (S1 , S3 ), VSS2 = (S2 , S4 ).
Fig. 10 depicts this identification process.

The AV classification process is then performed to distinguish
the vein from the artery. For the majority of crossover points, it
is observed that the artery appears brighter than its vein counterpart. This is due to the fact that the artery contains oxygenated
blood which is pumped from the heart, making it red, while
the vein carries deoxygenated blood back to the heart, which
makes it darker. Hence, the color information of the two vessels
is computed and the artery is assigned to the vessel with higher
intensity value. Different color spaces, RGB and HSV as well
as the gray level, were used to identify the most discriminative
feature. The median intensity value of each vessel is computed
as
fVSS i = median(X(VSSi ))

(3)

where i ∈ {1, 2}, X ∈ {R, G, B, H, S, V, Gray} representing
different color components. For example, R(VSS1 ) contains
the intensity values of the red channel of the first vessel. Then,
the vein is identified as the vessel with lower intensity level.
Once the vein is correctly recognized, its two segments are
extracted for subsequent analysis. The results achieved through
this process are shown in Fig. 11(a)–(d).
The artery-vein classification accuracy (ACC) is used to evaluate the performance of our system at this stage. ACC is defined
as the fraction of the number of crossover points where the
artery and vein were correctly classified over the total number
of crossovers that were considered. Table I presents the ACC on
90 working crossovers (described in Section III-A) using different color features. It is shown that the green channel provides

NGUYEN et al.: AN AUTOMATED METHOD FOR RETINAL ARTERIOVENOUS NICKING QUANTIFICATION FROM COLOR FUNDUS IMAGES

3199

TABLE I
ARTERY-VEIN CLASSIFICATION ACCURACY (ACC) OF DIFFERENT COLOR
FEATURES ON 90 WORKING CROSSOVERS

Fig. 13. Example showing the effect of δ on vessel width measurements
achieved: (a) cropped retinal image with superimposed vessel edge (white)
and vessel skeleton (black); (b) vessel width measurements achieved without
constraint on φ m n (δ = +∞); and (c) vessel width measurements achieved
if δ is set as 5 o . Invalid measurements are observed if no constraint is put on
φ m n while the setting of a small value of δ has effectively removed incorrect
measurements.

Fig. 12. Method for identifying vessel boundary pixels representing the vessel
width at a skeleton pixel.

highest accuracy, followed by the gray level. The red channel
and the value component (in HSV space) yield similar good
performance while the blue channel gives lowest accuracy. This
result is in accordance with previous studies ( [22]–[24]) where
the green channel is found most effective for blood vessel extraction as it provides best contrast between the vessel and the
background. This result further confirms that the green channel
provides best contrast between artery and vein and being the
most discriminative feature for AV classification.
3) Vessel Width Measurement: In this step, the vessel widths
of the two venular segments are measured using the vessel skeleton and edge images extracted in the previous step. For each
skeleton pixel Ci , a set of pairs of edge pixels whose connected
line going through Ci is identified (see Fig. 12)
E = {(E1j , E2k ) : Ci ∈ γE1j + (1 − γ)E2k }

(4)

where Exi ∈ Ex , γ ∈ [0, 1], E1 , and E2 are the set of edge
pixels at two sides of the vessel skeleton [see Fig. 12(a)]. Let
Ci−K and Ci+K be the two skeleton pixels at K pixel distance
to either side of Ci , the gradient at Ci can be estimated by the
vector Ci−KCi+K . For each pair of edge points {E1j , E2k }, the
angle of intersection with the skeleton is given as
|Ci−KCi+K · E1jE2k |

.
cos (φj k ) = 



Ci−KCi+K  E1jE2k 

(5)

The two edge points {E1m , E2n }, where
{m, n} = argmin cos (φj k )

(6)

j,k

construct the line that is most perpendicular to the skeleton
gradient.
We

 use the distance between these two edge points
 

E1m E2n  as the vessel width at Ci .
However, the vessel width at Ci is considered as valid only
if φm n is close to 90o (i.e., |90 − φm n | ≤ δ). Otherwise, it is
marked as invalid and Ci is removed from the result to ex-

Fig. 14. Example results of vessel width measurements produced by the proposed method on two example crossovers shown in Fig. 1: imaginary lines
connecting two edge points represent the vessel width at each skeleton pixel.

clude from further analysis. A small value of δ ensures that the
vessel width achieved is perpendicular to the vessel axis. If no
constraint is put on φm n , the vessel width obtained might be
incorrect due to the insufficient number of edge points to match
the vessel width, which often happens at the skeleton pixels
close to the crossing region, an example of which is shown in
Fig. 13.
Fig. 13(a) shows the vessel skeleton and vessel edge superimposed on a venular segment while the vessel widths obtained
if no constraint is put on φm n (i.e., δ = +∞) is shown in
Fig. 13(b). Invalid measurements are found at the skeleton pixels close to the crossover since they do not reflect the true width
of the vessel (they are not perpendicular to the vessel axis).
These invalid measurements have been removed when δ is set
as 5◦ (see Fig. 13(c)). Hence, it is set as 5o in our system. However, it should be noted that similar results were observed for
a range values of δ (5 ≤ δ ≤ 20). The vessel widths achieved
on two example crossover points are shown in Fig. 14. We can
see that the straight lines representing the vessel width at each
skeleton pixel are perpendicular to the vessel axis while its two
edge points are fitted well on the true vessel boundary. This has
indicated that vessel widths were accurately measured.
4) AV Nicking Measurement: As each vein is composed of
two segments at two sides of the crossing, the severity of AV
nicking is assessed separately for each segment and the final AV
nicking index of the crossover point is obtained by a combination

3200

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

of these two individual measures:
AVN(C) = fA (AVN(V1 ), AVN(V2 ))

(7)

where fA is a coalescing function, AVN(V1 ) and AVN(V2 ) are
the AV nicking severity levels of the two venular segments,
V1 and V2 , respectively. The method for computing the AV
nicking severity level of each venular segment (at one side of
the crossing) is as follows.
For each venular segment, four important measurements
(W, WC , S, and Sm issing ) are automatically derived from the
vessel widths of that segment. W is the measurement representing the normal vessel width of the segment while WC represents
the vessel width at the region close to the crossing location. S
represents the total number vessel pixels at region close to the
crossover if there is no decrease in the vessel width (or the absence of AV nicking), while Sm issing represents the number of
vessel pixels that is missing due to the presence of AV nicking.
These measurements are inspired based on the fact that there is a
decrease in vessel width at the crossing region in the presence of
AV nicking, while this phenomenon is absent in normal cases.
Hence, in the presence of AV nicking, WC is much lower than
the normal vessel width W while the difference is not much
in the normal cases. Similarly, the number of missing pixels
Sm issing is much higher in AV nicking crossovers than in normal ones. The method for computing these measurements from
the vessel widths is as follows.
Suppose that the segment is made up of n vessel width measurements, w = {wi |i ∈ {1, . . . , n}} (the vessel widths wi are
indexed and ordered so that w1 is the width closest to the
crossover point, while wn is the furthest). W is approximated
as the median value of its measurements, or W = median(w).
Suppose that N is the number of successive cross sections,
starting from the first measurement w1 , with the measurements lower than normal vessel width W, WC is approximated as the minimum value of the first N vessel widths, or
WC = min{wi |i ∈ {1, . . . , N }}. The number of vessel pixels at the crossing region in the normal case, S, is estimated
as N × W . Let S1 and S2 represent the number of missing
pixels at both side of the vessel at the crossing region (see
Fig. 15(a)), while S3 represents the number ofvessel pixels
composed by the first N cross sections (S3 = N
i=1 wi ), the
total number of missing pixels Sm issing can be computed as

Sm issing = S1 + S2 = S − S3 = N × W − N
i=1 wi . The illustration of these measurements is shown in Fig. 15.
From the four critical measurements (W, WC , S, and
Sm issing ), three measures are derived to compute the AN nicking
severity of each venular segment as follows:
Sm issing
S
WC
MR = 1 −
W
MS = W − WC .

MM F =

(8)
(9)
(10)

All of these measures yield high values for AV nicking
crossovers and low values for normal cases. The first measure
MM F evaluates the proportion of the missing pixels due to the

Fig. 15. Illustration of the measurements used for AV nicking computation
on (a) synthetic vessels and (b) vessel width measurements. The definition of
the annotations in this figure is as follows: W represents the vessel width in the
normal case; W C represents the vessel width at the crossing region; N is the
number of successive cross sections, starting from the first measurement w 1 ,
with the measurements lower than normal vessel width W ; S represents the
number of vessel pixels at the crossing region in the normal case (i.e., without
AV nicking); S 1 and S 2 represent the number of missing pixels at both side
of the vessel at the crossing region; S 3 represents the number of vessel pixels
composed by the first N cross sections.

presence of AV nicking while MR measures the ratio of the vessel width at the crossing region compared to the normal width.
MS measure computes the difference in the vessel widths at the
crossing region and the normal vessel width. For all of these
measures, the higher the value, the greater the severity of AV
nicking at that crossover.
III. EXPERIMENTAL RESULTS
A. Material
The proposed method was evaluated using 47 high-resolution
retinal images obtained from two population-based studies, the
Blue Mountain Eye Study (BMES) [25]–[27] and the Singapore
Malay Eye Study (SiMES) [28], [29]. BMES photos were taken
in 35-mm color film, then digitized using CanoScan FS2710
(Canon, Tokyo, Japan) set to automatic exposure and focus. Images were converted to 24-bit (8-bit for each color space of red,
green, and blue, with resolution 2720 dpi without enhancement,
in Tagged Image File Format, image resolution of 3888 × 2592
pixels). Retinal images in SiMES set were captured using a digital nonmydriatic retinal camera (Canon CR-DGi, Japan) with
the image resolution of 3072 × 2048 pixels.
From these images, 90 detected crossover points were selected to evaluate the performance of the proposed method for
AV nicking assessment. Each crossover point was manually
graded by two experts at the Centre for Eye Research Australia
(Melbourne, Australia) independently, using 4-scale grading
system (from 0 = normal to 3 = most severe). Disagreement between two experts was then reassessed in a joint session, which
resulted in a single grading for each crossing point. We note that
this evaluation process is very time consuming and expensive
with respect to graders time. Table II summarizes the distribution
of AV nicking levels within 90 crossover points in this dataset.
A set of four example crossover points with varying nicking
levels are shown in Fig. 16. The dataset of these 90 crossover
points with the manual assessment has been made publicly available at: http://people.eng.unimelb.edu.au/thivun/projects/AV_
nicking_quantification/.

NGUYEN et al.: AN AUTOMATED METHOD FOR RETINAL ARTERIOVENOUS NICKING QUANTIFICATION FROM COLOR FUNDUS IMAGES

3201

TABLE II
DISTRIBUTION OF AV NICKING LEVELS ACROSS 90 WORKING CROSSOVERS

Fig. 16. Examples of crossover points with increasing AV nicking level, from
(a) = 0 (normal) to (d) = 3 (most severe).
TABLE III
PERFORMANCE IN TERMS OF SPEARMAN CORRELATION COEFFICIENT ρ
ACHIEVED BY THREE PROPOSED MEASURES ON 90 WORKING CROSSOVERS

Fig. 17. Box plot showing the linear relationship between the AV nicking
values computed using MS measure against manual grading.

B. Results and Discussions
In the first experiment, we examine the applicability of the
three proposed measures (MM F , MS , and MR ) for AV nicking
assessment. For this, the correlation of the computed values
and the manual grading was computed using the Spearman’s
rank correlation coefficient ρ. The Spearman coefficient ρ measures the strength of association between two variables and it
assesses how well the relationship between two variables can be
described using a monotonic function [30]. In addition, the signification test result (P value) was reported to indicate if the correlation is significantly different from zero. The correlation scores
achieved by the three measures with different coalescing functions fA = {MIN, MAX, MEAN} are presented in Table III. It
should be noted that fA is the coalescing function (7) that is used
to produce a single AV nicking level for each crossover using
the AV nicking measurements of its two venular segments. The
results show that the MS measure achieves highest correlation
with a correlation score of ρ = 0.70 (P < 0.0001) and when
MAX is used as the coalescing function. This means that the
raw difference in the vessel width at crossing region and the
normal vessel width, which is captured by MS measure, is a
good measurement of AV nicking. In addition, the severity level
at a crossover point should be assigned as the most severe of
its two individual segments (i.e., fA = MAX). It is interesting
to see that MR measure is far less effective than MS measure.
This means that the ratio between the normal vessel width and
the width at the crossing region (MR measures) is not effective
for AV nicking measurement compared to the raw difference

(MS measure). Finally, the fraction of the missing pixels at the
crossing region seems to be a poor measure for AV nicking
assessment.
From the experiment above, we can see that MS is the most
effective measure for AV nicking assessment. To visually assess
the results, the box plot in Fig. 17 shows the AV nicking values
computed using MS measure against the manual grading values.
Each box in the box plot graphically summarizes the computed
AV nicking values of crossovers with the same manual grading
level using five numbers: the red central mark is the median, the
edges of the box are the 25th and 75th percentiles, the lowest
and highest lines are the smallest, and largest computed values,
respectively. It is shown that there is a clear linear association
between the subjective grading and objective measurements.
In addition, it also indicates that the computed values differ
from subjective assessment mostly by one grading level, which
is reflected by small overlap in the computed values of two
successive grades, while they are well separated for grades of
two level apart.
To roughly assess the performance of our system in terms of
classification accuracy, we divide all crossovers into two classes
(we refer to this as binary separation) by performing thresholding on the manual grading. With different threshold values,
different separations are obtained. For example, the separation
([0] vs. [1, 2, 3]) means that crossover points manually marked
as 0 are classified as the first class while the remaining points are
classified as the second class. The performance in terms of ROC
curve is then evaluated for each such separation. In addition, the
separations are classified as 1-level separation and 2-level separation if the difference in the upper bound value of the first
class is one or two levels apart from the lower bound value

3202

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

TABLE IV
THE PERFORMANCE OBTAINED BY THE SYSTEM ON DIFFERENT BINARY
SEPARATIONS IN TERMS OF MA, SEN, SPEC, AND κ

Fig. 18.

ROC curves obtained on 1-level separations.

Fig. 19.

ROC curves obtained on 2-level separations.

Table IV presents the performance of the proposed method
in terms of maximum accuracy (MA), sensitivity (SEN), specificity (SPEC), and Kappa measure (κ) on different binary separations. MA is defined as the maximum accuracy obtained in
classifying crossover points into two classes using the computed
AV nicking values when compared with the expert grading. The
SEN, SPEC, and Kappa value are reported at the threshold
value that yields highest classification accuracy (i.e., MA). SEN
measures the proportion of actual positives which are correctly
identified, while SPEC measures the proportion of negatives
which are correctly identified. Kappa value κ is used to measure
the agreement in the grading of AV nicking produced by the
system when compared with expert judgment [31].
The results show that the accuracy of our method at all separations is higher than 80%. In addition, the system can separate
moderate to severe cases from normal or mild cases (i.e., at ([0,
1] vs. [2, 3]) separation) with an accuracy of 88% (SEN = 0.77,
SPEC = 0.92, κ = 0.70). Higher performance is achieved in
classifying moderate to severe cases from normal cases (i.e.,
at ([0] vs. [2, 3]) separation) with an accuracy of 89% (SEN
= 0.85, SPEC = 0.92, κ = 0.76). Moderate agreements are
achieved at two separations, ([0] vs. [1, 2, 3], κ = 0.59) and
([0, 1, 2] vs. [3], κ = 0.52), while substantial agreements are
observed for the remaining separations (κ ≥ 0.70) (according
to the interpretation of Kappa value κ in [31]).
IV. CONCLUSION

of the second class, respectively. For example, the separation
([0, 1] vs. [2, 3]) is considered as 1-level separation while ([0]
vs. [2, 3]) is considered as 2-level separation.
Figs. 18 and 19 show the ROC curves together with the area
under the ROC curve (AUC) obtained on 1-level and 2-level separations, respectively. The results show that high-classification
performance are achieved for all separations (AUC ≥ 0.86). In
addition, the ROC curves in Fig. 18 show that the separations
(([0, 1] vs. [2, 3]) and ([0, 1, 2] vs. [3])) achieve higher performance than the ([0] vs. [1, 2, 3]) separation, which reflects
that the system is more effective in detecting moderate to severe
AV nicking cases than the mild cases. This is of clinical importance since more severe AV nicking cases need to be effectively
identified for further examination. The results also show that the
performance achieved with 2-level separations are much higher
than with 1-level separations, which further confirms that the
computed AV nicking values differ from subjective assessment
mostly at one grading level.

We have proposed and validated a new method for automated
AV nicking assessment. The accuracy of the method was evaluated on 90 AV crossover points of 47 high-resolution retinal
images. The results show that the computed AV nicking measurements are strongly correlated with human judgment with a
correlation score of 0.70. In addition, the box plot and the ROC
curves indicate that the predicted values differ from manual
grading mostly at one grading level. In terms of classification
accuracy, the proposed system can detect moderate and severe
AV nicking cases with an accuracy of 88% (SEN of 0.77, SPEC
of 0.92, Kappa value κ of 0.70). These have demonstrated the
reliability and accuracy of the proposed system for AV nicking assessment. The measurements produced by the proposed
method provide the basis toward the development of a system for
automatic AV nicking detection for a large-scale screening system. Moreover, since the quantified values provide more details
on the AV nicking severity level, the computed measurements
may help to enhance the relationship between AV nicking and

NGUYEN et al.: AN AUTOMATED METHOD FOR RETINAL ARTERIOVENOUS NICKING QUANTIFICATION FROM COLOR FUNDUS IMAGES

known diseases such as hypertension and stroke. At present, we
are applying our method on a large number of images to determine AV nicking severity level associated with cardiovascular
diseases. The results will be reported later to the appropriate
clinical journal.
ACKNOWLEDGMENT
The authors wish to thank to K. Y. Lee and L. Hodgson at the
Centre for Eye Research Australia (Melbourne, Australia) for
kindly providing us with the arteriovenous nicking grading and
clinical advice.
REFERENCES
[1] T. Y. Wong and P. Mitchell, “Hypertensive retinopathy,” New Engl. J.
Med., vol. 351, no. 22, pp. 2310–2317, 2004.
[2] T. Wong and P. Mitchell, “The eye in hypertension,” Lancet, vol. 369,
no. 9559, pp. 425–435, 2007.
[3] R. Klein, B. Klein, S. Moss, and Q. Wang, “Hypertension and retinopathy,
arteriolar narrowing, and arteriovenous nicking in a population,” Arch.
Ophthalmol., vol. 112, no. 1, pp. 92–98, 1994.
[4] T. Y. Wong, R. Klein, A. R. Sharrett, T. A. Manolio, L. D. Hubbard,
E. K. Marino, L. Kuller, G. Burke, R. P. Tracy, and J. F. Polak, “The
prevalence and risk factors of retinal microvascular abnormalities in older
persons: The cardiovascular health study,” Ophthalmology, vol. 110, no. 4,
pp. 658–666, 2003.
[5] P. Mitchell, J. Wang, T. Wong, W. Smith, R. Klein, and S. Leeder, “Retinal
microvascular signs and risk of stroke and stroke mortality,” Neurology,
vol. 65, no. 7, pp. 1005–1009, 2005.
[6] T. Wong, R. Klein, D. Couper, L. Cooper, E. Shahar, L. Hubbard,
M. Wofford, and A. Sharrett, “Retinal microvascular abnormalities and
incident stroke: The atherosclerosis risk in communities study,” Lancet,
vol. 358, no. 9288, pp. 1134–1140, 2001.
[7] T. Wong, R. Klein, B. Klein, J. Tielsch, L. Hubbard, and F. Nieto, “Retinal microvascular abnormalities and their relationship with hypertension,
cardiovascular disease, and mortality,” Survey Ophthalmol., vol. 46, no. 1,
pp. 59–80, 2001.
[8] N. Roper, S. R. Patel, and C. O’Donnell, “Signs of stroke in the retina,”
Optometry Practice, vol. 13, no. 1, pp. 9–18, 2012.
[9] T. Wong, R. Klein, A. Sharrett, B. Duncan, D. Couper, B. Klein,
L. Hubbard, and F. Nieto, “Retinal arteriolar diameter and risk for hypertension,” Ann. Internal Med., vol. 140, no. 4, pp. 248–255, 2004.
[10] L. S. Cooper, T. Y. Wong, R. Klein, A. R. Sharrett, R. N. Bryan,
L. D. Hubbard, D. J. Couper, G. Heiss, and P. D. Sorlie, “Retinal microvascular abnormalities and MRI-defined subclinical cerebral infarction the atherosclerosis risk in communities study,” Stroke, vol. 37, no. 1,
pp. 82–86, 2006.
[11] M. Baker, P. Hand, J. Wang, and T. Wong, “Retinal signs and stroke,”
Stroke, vol. 39, no. 4, pp. 1371–1379, 2008.
[12] T. Wong and R. McIntosh, “Hypertensive retinopathy signs as risk indicators of cardiovascular morbidity and mortality,” Brit. Med. Bull., vol. 73,
no. 1, pp. 57–70, 2005.
[13] H. Yatsuya, A. R. Folsom, T. Y. Wong, R. Klein, B. E. K. Klein, and
A. R. Sharrett, “Retinal microvascular abnormalities and risk of lacunar
stroke atherosclerosis risk in communities study,” Stroke, vol. 41, no. 7,
pp. 1349–1355, 2010.
[14] R. Klein, B. E. Klein, S. E. Moss, and S. M. Meuer, “The epidemiology of retinal vein occlusion: The BeaverDam Eye Study,” Trans. Amer.
Ophthalmol. Soc., vol. 98, pp. 133–143, 2000.
[15] L. D. Hubbard, R. J. Brothers, W. N. King, L. X. Clegg, R. Klein,
L. S. Cooper, A. R. Sharrett, M. D. Davis, and J. Cai, “Methods for evaluation of retinal microvascular abnormalities associated with hypertension/sclerosis in the atherosclerosis risk in communities study,” Ophthalmology, vol. 106, no. 12, pp. 2269–2280, 1999.

3203

[16] D. J. Couper, R. Klein, L. D. Hubbard, T. Y. Wong, P. D. Sorlie,
L. S. Cooper, R. J. Brothers, and F. J. Nieto, “Reliability of retinal photography in the assessment of retinal microvascular characteristics: The
atherosclerosis risk in communities study,” Amer. J. Ophthalmol., vol. 133,
no. 1, pp. 78–88, 2002.
[17] U. T. V. Nguyen, A. Bhuiyan, L. A. F. Park, R. Kawasaki, T. Y. Wong,
J. J. Wang, P. Mitchell, and K. Ramamohanarao, “Automated quantification of retinal arteriovenous nicking from colour fundus images,” in Proc.
IEEE 35th Annu. Int. Conf. Eng. Med. Biol. Soc., 2013, pp. 5865–5868.
[18] U. T. V. Nguyen, A. Bhuiyan, L. A. F. Park, and K. Ramamohanarao, “An
effective retinal blood vessel segmentation method using multi-scale line
detection,” Pattern Recognit., vol. 46, no. 3, pp. 703–715, 2012.
[19] U. T. V. Nguyen, A. Bhuiyan, L. A. F. Park, R. Kawasaki, T. Y. Wong,
and K. Ramamohanarao, “Automatic detection of retinal vascular landmark features for colour fundus image matching and patient longitudinal
study,” presented at the IEEE Int. Conf. Image Process., Melbourne, VIC,
Australia, 2013.
[20] R. Gonzalez, R. Woods, and S. Eddins, Digital Image Processing Using
MATLAB. Noida, India: Pearson Education India, 2004.
[21] V. Bevilacqua, S. Camb, L. Cariello, and G. Mastronardi, “A combined
method to detect retinal fundus features,” in Proc. IEEE Eur. Conf. Emergent Aspects Clin. Data Anal., 2005.
[22] E. Ricci and R. Perfetti, “Retinal blood vessel segmentation using line
operators and support vector classification,” IEEE Trans. Med. Imag.,
vol. 26, no. 10, pp. 1357–1365, Oct. 2007.
[23] S. Chaudhuri, S. Chatterjee, N. Katz, M. Nelson, and M. Goldbaum, “Detection of blood vessels in retinal images using two-dimensional matched
filters,” IEEE Trans. Med. Imag., vol. 8, no. 3, pp. 263–269, Sep. 1989.
[24] X. You, Q. Peng, Y. Yuan, Y. Cheung, and J. Lei, “Segmentation of retinal
blood vessels using the radial projection and semi-supervised approach,”
Pattern Recognit., vol. 44, pp. 2314–2324, 2011.
[25] P. Mitchell, W. Smith, K. Attebo, and J. J. Wang, “Prevalence of agerelated maculopathy inAustralia. the Blue Mountains Eye Study,” Ophthalmology, vol. 102, no. 10, pp. 1450–60, 1995.
[26] J. J. Wang, P. Mitchell, R. G. Cumming, and R. Lim, “Cataract and
age-related maculopathy: The Blue Mountains Eye study,” NeuroOphthalmol., vol. 6, no. 4, pp. 317–326, 1999.
[27] S. Cugati, R. G. Cumming, W. Smith, G. Burlutsky, P. Mitchell,
and J. J. Wang, “Visual impairment, age-related macular degeneration,
cataract, and long-term mortality: The BlueMountainsEye Study,” Arch.
Ophthalmol., vol. 125, no. 7, pp. 917–924, 2007.
[28] A. W. P. Foong, S. M. Saw, J. L. Loo, S. Shen, S. C. Loon, M. Rosman,
T. Aung, D. T. H. Tan, E. S. Tai, and T. Y. Wong, “Rationale and methodology for a population-based study of eye diseases in Malay people: The
Singapore Malay eye study (SiMES),” Ophthalm. Epidemiol., vol. 14,
no. 1, pp. 25–35, 2007.
[29] C. Y. Cheung, W. T. Tay, P. Mitchell, J. J. Wang, W. Hsu, M. L. Lee,
Q. P. Lau, A. L. Zhu, R. Klein, and S. M. Saw, “Quantitative and qualitative retinal microvascular characteristics and blood pressure,” J. Hypertension, vol. 29, no. 7, pp. 1380–1391, 2011.
[30] Wikipedia—a free encylopedia, (2013, May 08). [Online]. Available:http:
//en.wikipedia.org/wiki/Spearman’s rank correlation coefficient
[31] A. J. Viera and J. M. Garrett, “Understanding interobserver agreement:
The kappa statistic,” Fam. Med., vol. 37, no. 5, pp. 360–363, 2005.

Authors’ photographs and biographies not available at the time of publication.

