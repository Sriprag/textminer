2828

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

Automatic Fascicle Length Estimation on Muscle
Ultrasound Images With an Orientation-Sensitive
Segmentation
Guang-Quan Zhou and Yong-Ping Zheng∗ , Senior Member, IEEE

Abstract—Goal: The fascicle length obtained by ultrasound
imaging is one of the crucial muscle architecture parameters for
understanding the contraction mechanics and pathological conditions of muscles. However, the lack of a reliable automatic measurement method restricts the application of the fascicle length
for the analysis of the muscle function, as frame-by-frame manual
measurement is time-consuming. In this study, we propose an automatic measurement method to preclude the influence of nonfascicle
components on the estimation of the fascicle length by using motion
estimation of fascicle structures. Methods: The method starts with
image segmentation using the cohesiveness of fascicle orientation
as a feature, obtaining the fascicle change by tracking manually
marked points on the fascicular path with the Lucas–Kanade optical flow algorithm applied on the segmented image. Results: The
performance of this method was evaluated on ultrasound images
of the gastrocnemius obtained from seven healthy subjects (34.4 ±
5.0 years). Waveform similarity between the manual and dynamic
measurements was assessed by calculating the overall similarity
with the coefficient of multiple correlations (CMC). In vivo experiments demonstrated that fascicle tracking with the orientationsensitive segmentation (CMC = 0.97 ± 0.01) was more consistent
with the manual measurements than existing automatic methods
(CMC = 0.87 ± 0.10). Conclusion: Our method was robust to the
interference of nonfascicle components, resulting in a more reliable
measurement of the fascicle length. Significance: The proposed
method may facilitate further research and applications related to
real-time architectural change of muscles.
Index Terms—Effective fascicle region, fascicle length, image
segmentation, muscle, optical flow, orientation-sensitive segmentation, ultrasound imaging.

I. INTRODUCTION
USCLE imaging is a promising field of research in understanding the biological and bioelectrical characteristics of muscles, as well as assessing their function and pathological conditions through the observation of muscle architectural
change, since muscle activation is closely related to its structure
[1]. Recently, sonomyography (SMG), representing the real-

M

Manuscript received March 12, 2015; revised May 18, 2015; accepted June
9, 2015. Date of publication June 16, 2015; date of current version November
20, 2015. This work was partially supported by the Hong Kong Polytechnic
University (G-YL74) and the Research Grant Council of Hong Kong (PolyU
152220/14E). Asterisk indicates corresponding author.
G.-Q. Zhou is with the Interdisciplinary Division of Biomedical Engineering,
Hong Kong Polytechnic University.
∗ Y.-P. Zheng is with the Interdisciplinary Division of Biomedical Engineering, Hong Kong Polytechnic University, Hung Hom, Hong Kong (e-mail:
ypzheng@ieee.org).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2445345

time change of muscle architecture obtained using ultrasound
imaging, has been proposed as a noninvasive option to measure
muscle activation under different contractions [2]. It has been
reported that the muscle architecture, primarily delineated by
the geometric layout of the fascicles within the skeletal muscle,
including the fascicle length and the pennation angle, is highly
correlated with muscle contraction [3]–[9]. SMG has showed
its potential in both diagnosis and rehabilitation assessment in
vivo, as a reliable research and clinical tool. It has been used to
monitor treatment outcomes for patients with motor problems
[10], [11], prepare rehabilitation plans for patients with surgical
operations [12], [13], and control powered prostheses [14], [15].
Fascicle length is the most often used SMG parameter to
quantify changes in the fascicle geometry of muscle. Since the
ability of muscle to generate the force is largely determined by
its fascicle length, the change of the fascicle length has been
examined in response to contraction [16], [17], aging [18], [19],
fatigue [20], and physical training [21], [22]. Moreover, modulation of the fascicle–tendinous tissue interaction, which occurs
to make the movement more economic via effective utilization
of tendinous tissue elasticity for specific movement tasks [23]–
[27], can also be estimated from changes of the fascicle and
tendon length. This morphometric skeletal muscle parameter is
therefore of great importance to understanding the mechanism
of muscle contraction. Although the manual measurement of the
fascicle length was reported to be reproducible [28], the method
is time-consuming and subjective, restricting the application of
the fascicle length in the dynamic analysis of the muscle function, especially when dealing with a sequence of ultrasound
images. Since fascicles are usually nonuniformly distributed as
line-like structures in ultrasound images [5], [29], some automatic fascicle detection approaches based on the Hough or
Radon transforms [30]–[32] have been proposed for estimating
the fascicle length. However, the fascicle structures are often
obscured by speckle noise, making it difficult to locate them accurately. Moreover, intramuscular blood vessels are also visible
as line-like structures in the fascicle region of some ultrasound
images [33], [34], resulting in incorrect measurements of the
fascicle length.
Motion between successive images has also been used to estimate the fascicle length by observing the continuous changes
in the fascicle region [34]–[38]. Under the assumption that homogeneous affine transformations are applicable in the muscle
region, Cronin, et al. [36] estimated global affine transform parameters with the Lucas–Kanade optical flow algorithm [39], by
regarding a selected fascicle region as a whole patch to derive

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

ZHOU AND ZHENG: AUTOMATIC FASCICLE LENGTH ESTIMATION ON MUSCLE ULTRASOUND IMAGES

the changes in the fascicle length. Based on the assumption of
straight fascicles, the fascicle length was identified by calculating the displacement of predefined points on the fascicular path
using the global affine transform parameters. In this approach,
the accumulation of errors in tracking small regions of interest (ROI) was avoided by estimating global movement over a
large region [38]. Nonetheless the nonfascicle components of
speckle noise that can violate the assumption of homogeneous
affine transformations were not taken into account which could
lead to inaccurate estimation of the fascicle length in some images. Using the framework of Bayesian multiple hypotheses,
the Kanade–Lucas–Tomasi (KLT) feature trackers [40] combined with visible fascicle structures have also been proposed to
estimate the changing fascicle shape [37]. About 200 nonoverlapping square feature templates with a size 15 × 15 pixels,
derived in the fascicle region using multiresolution active shape
model training, were tracked using KLT weighted by a multiscale vessel enhancement map [41]. This map was used to
obtain global fascicle displacements and changes of the fascicle length with the particle filter, thus allowing recovery from
small tracking errors. However, the weight of nonfascicle components, such as visible intramuscular blood vessels, was also
increased in the calculation, possibly influencing the estimation
of the fascicle length. Moreover, the time-consuming multiresolution active shape model segmentation and particle filter also
restricted the application of this approach.
In this study, under the assumption of homogeneous affine
transformations, we propose an automatic method for estimating
the change of the fascicle length in consecutive ultrasound images by calculating global affine transform parameters over the
effective fascicle region obtained with an orientation-sensitive
segmentation algorithm, in order to address the limitations of
currently available approaches. The orientation-sensitive segmentation algorithm was designed to segment visible fascicle
structures from the whole muscle region based on the observation of similar orientations of fascicles in muscles. The automatic method for fascicle length estimation is described in
detail in Section II, and was tested with real ultrasound image sequences of the human gastrocnemius (GM) during cyclic
plantar flexion.
II. METHODS
Based on the observation of similar fascicular orientations in
muscle ultrasound images [42], the region containing the visible
fascicle structure, termed as the effective fascicle region, can be
derived from the whole ultrasound image using our orientationsensitive segmentation algorithm described in Section II-A. Under the assumptions of straight fascicles and homogeneous affine
transformations, the global affine transform parameters were
then estimated between consecutive images from the Lucas–
Kanade optical flow algorithm [39] over the effective fascicle
region. The flowchart of our proposed method is illustrated in
Fig. 1. After the displacement of the predefined points on the
fascicular path were calculated from the global affine transform
parameters, the fascicle length was then derived as the distance
along the fascicular path from the superficial aponeurosis to the

Fig. 1.

2829

Flowchart of the proposed tracking algorithm.

deep aponeurosis. In cases where the fascicle extended beyond
the view of the image, the whole fascicle length was estimated
by linearly extrapolating both the paths of the fascicles and the
aponeuroses.

A. Effective Fascicle Region Segmentation
The fascicle region in the ultrasound image contains patterns
of ridges and valleys, similar to that of a fingerprint image.
However, the image speckles often disguise these ridges and
valleys increasing the difficulty of accurate fascicle recognition. Fig. 2(a) shows a typical GM ultrasound image containing
parallel fascicles with speckle noise. Moreover, the visible nonfascicle components in the muscle such as intramuscular blood
vessels [33], [34], having completely different orientations from
the fascicles, would also affect fascicle identification. Fig. 3(a)
shows an example of a GM ultrasound image with visible intramuscular blood vessels. Motivated by the similar fascicular
orientations in muscle ultrasound images and images for fingerprint enhancement [43], the primary local orientation calculated
using an intensity gradient [44] could be used to identify the effective fascicle region for the estimation of the fascicle length.
An orientation-sensitive segmentation algorithm was then designed with a set of intermediate steps applied on the input ultrasound image to obtain the effective fascicle region. As shown
in Fig. 4, the main steps of the algorithm included.
1) Normalization: An input image was normalized with
mean = 0 and variance = 1.
2) Local orientation estimation: The local orientation was
estimated from the normalized image to form a local orientation map.

2830

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

Fig. 2. Example of segmentation for the ultrasound image containing parallel fascicles with speckle noise. (a) Original GM ultrasound image containing parallel fascicles with speckle noise. (b) Orientation flow of the image.
(c) Orientation-sensitive segmentation result.

Fig. 4.

Flowchart of the proposed segmentation algorithm.

size w × w (16 × 16, in this study), and σim g denote the variance
of the whole image. An empirically predefined threshold, σT =
0.1 σim g , was further used to identify homogeneous regions in
the image with

1, σ0 ≥ σT
(1)
H (x, y) =
0, otherwise.
The mean f¯ and variance σ of f were estimated from all
pixels having H (x, y) = 1. Then, the final normalized graylevel image at pixel (x, y) was defined as follows:
√
fnorm (x, y) = (f (x, y) − f¯)/ σ.
(2)

Fig. 3. Example of ultrasound image segmentation with visible intramuscular
blood vessels. (a) Original GM ultrasound image with visible intramuscular
blood vessels. (b) Orientation flow of the image. (c) Orientation-sensitive segmentation result.

3) Dominant fascicle orientation estimation: The dominant
fascicle orientation was estimated from all local orientations in the whole image.
4) Effective fascicle region segmentation: The image was
segmented using the dominant fascicle orientation and a
predefined threshold on the local orientation.
1) Normalization: Let f (x, y) denote the gray-level value at
pixel (x, y), σ0 denote the estimated variance of pixel blocks of

This pixel-wise normalization operation reduced the variations in gray-level values along fascicles but did not change the
fascicle structures.
2) Local Orientation Estimation: The local orientation defines invariant coordinates for fascicles in a neighborhood, delineating an inherent property of the structure. Given the normalized image, fnorm (x, y), the estimation of the local orientation
field was accomplished as follows.
a) The image fnorm (x, y) was smoothed with a Gaussian
filter.
b) The gradients ∂x (x, y) and ∂y (x, y) were computed at
each pixel using the rotation invariant Scharr operator
[45], [46].
c) The image was divided into nonoverlapping blocks Γ of
size w × w to estimate the local orientation of each block
centered at pixel (x, y) using the following equations [44]:


x+w /2

gx (x, y) =



y +w /2

u =x−w /2 v =y −w / 2

∂x (u, v) ∂y (u, v)

(3)

ZHOU AND ZHENG: AUTOMATIC FASCICLE LENGTH ESTIMATION ON MUSCLE ULTRASOUND IMAGES



x+w /2

gy (x, y) =



y +w /2

(∂x2 (u, v) − ∂y2 (u, v))

u =x−w /2 v =y −w / 2

θ (x, y) =

π π
+ tan−1
2
2



gy (x, y)
gx (x, y)



(4)

2831

to previous studies [6] and [50], the threshold To was empirically
determined to be 5°. Figs. 2(c) and 3(c) show an example of the
orientation-sensitive segmentation with a threshold To of 5° on
the GM ultrasound images as shown in Figs. 2(a) and 3(a),
respectively.

(5)

where θ (x, y) is the least-squares estimate of the dominant orientation of the image block centered at pixel (x, y).
Since mean fascicle perimeters have been reported to be
around 0.8 mm [47], [48], w was set to span 1.6 mm, equivalent to 16 pixels for the image resolution of 0.1 mm/pixel
used in this study.
d) The reliability of the orientation estimation could also be
measured by the reliability coefficient [44]
 
	

2
2
2
Γ ∂x − ∂y + 4 (
Γ ∂x ∂y )
	
  2
(6)
r (x, y) =
2
Γ ∂x + ∂y
which lies in the range [0, 1]. The maximum reliability
implies a region having a strongly oriented pattern, with all
orientations parallel to each other. In contrast, a minimum
coherence means that the region is isotropic.
Using the above steps, a local orientation field estimate and
a reliability map could be obtained for the subsequent processing steps. Figs. 2(b) and 3(b) illustrate the local orientation
flow map on the GM ultrasound image without and with the
visible intramuscular blood vessels [see Figs. 2(a) and 3(a)],
respectively.
3) Dominant Orientation Estimation: The reliability measure was used to generate a mask image with a predefined
threshold Tr , using

1, r (x, y) ≥ Tr
M (x, y) =
(7)
0, otherwise.
According to the results reported in [49], the threshold Tr was
set to be 0.6.
The median value of the local orientations for remaining pixels (M (x, y) = 1) was then chosen as the dominant fascicle
orientation Θ [49]. This dominant fascicle orientation was then
used to identify the effective fascicle region in the subsequent
step.
4) Effective Fascicle Region Segmentation: Fascicles were
observed to be distributed with similar orientations. The maximum difference of mean fascicle orientation obtained at different muscle sites has been reported to be about 8° [6], [50].
A predefined threshold To was then used to segment the effective fascicle region from the whole sequence of ultrasound
images. The final effective fascicle region ΓE (x, y) was derived
as follows:

1, if M (x, y) = 1 and abs (θ(x, y) − Θ) ≤ To
ΓE (x, y) =
0, otherwise.
(8)
This effective fascicle region facilitates fascicle detection,
improving the accuracy of fascicle length estimation. According

B. Fascicle Length Estimation With
Orientation-Sensitive Segmentation
The fascicles could be identified as straight lines between the
superficial and deep aponeuroses. The points on the fascicular
path were used to determine the fascicle length from the superficial to the deep aponeuroses, which could be manually defined
by identifying the fascicular skeleton in the first frame, and
then tracked using the optical flow algorithm for the subsequent
frames. Cronin et al. [36] determined the fascicle length in a
sequence of ultrasound images by applying the Lucas–Kanade
optical flow algorithm over a manually selected fascicle region.
The six affine transform parameters were first determined from
a least-squares fit using the given spatial and temporal gradients over the whole fascicle region between adjacent frames.
The affine transform parameters were then applied to derive the
displacement of two specific points, (xi , yi ) , i = 1, 2, on the
fascicular path by adopting the following first-order model:
⎡
⎤
d + s1 s2 + r
⎢
⎥
(vxi , vyi ) = [xi yi 1] × ⎣ s2 − r d − s1 ⎦ i = 1, 2 (9)
vxt

vyt

where the affine flow parameters vxt and vyt are the optical
flow at the origin in the x- and y-directions, respectively, d is the
rate of dilation, r is the rate of rotation, and s1 is the shear along
the main image axis and s2 is the shear along the diagonal axis.
The changes of the fascicle length were then obtained from the
displacements of these points from one frame to the next.
The x- and y-grids along with the spatial and temporal gradients were resampled (every 3 pixels) to reduce the computation
cost in the least-squares fit [36]. However, the visible nonfascicle components and speckle noise in the selected fascicle region
were not taken into account in this resampling method. The spatial and temporal gradients of the nonfascicle components and
speckle noise may violate the hypothesis of homogenous affine
transformations in the whole fascicle region, which could result
in the inaccurate estimation of the global affine flow parameters.
Therefore, we proposed a simple and automatic method to calculate the affine transform parameters over the effective fascicle
region ΓE obtained with the orientation-sensitive segmentation in order to achieve both reliable calculation and economic
computation cost for the least-squares fitting process. Only the
spatial and temporal gradients in ΓE were applied to calculate
the affine transform parameters via a least-squares fit, which
could reduce the error caused by the nonfascicle components
and speckle noises. The predefined points were then applied to
determine the fascicular path by calculating their displacements
from the affine transform parameters. Moreover, considering
the distribution of aponeuroses in ultrasound images [42], they
were recognized using the normalized Radon transform defined

2832

as [51]
N R(ρ, θ) =

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015



I(x, y)δ(ρ − x cos θ − y sin θ)dxdy
L(ρ, θ)

TABLE I
CMC VALUES BETWEEN THE MANUAL AND AUTOMATIC METHODS FOR THE
MEASUREMENT OF THE FASCICLE LENGTH

(10)
Subject

where I(x, y) is the image intensity at position (x, y), and δ is
the Dirac delta function. ρ and θ denote the distance from the
center of the image to an arbitrary line and the angle between
the x-axis and the line perpendicular to this line, respectively.
L (ρ, θ) represents the length of line (ρ, θ) lying in the ROI.
Peaks in N R (ρ, θ) were identified to detect the position of
the aponeuroses using the same strategy introduced in localized
Radon transform [32]. Finally, the fascicle length was calculated as the length along the estimated fascicular path from the
superficial to the deep aponeuroses.
C. Experiment
Seven adult normal subjects (Age: 34.4 ± 5.0 years; Weight:
66.4 ± 16.2 kg; Body Mass Index: 22.1 ± 4.7 kg/m2 ) with
no history of musculoskeletal injury were recruited for an experimental study to demonstrate the feasibility of the proposed
method. This study was approved by the institutional ethical
committee and all subjects signed informed consent prior to
participation in the study.
The subject was instructed to stand straight at the beginning of the examination and then conduct the motion of cyclic
plantar flexion while keeping the knee angle unchanged. All
three-dimensional (3-D) spatial information of their body was
obtained from a motion capture system (VICON MX, VICON Corp., Los Angeles, CA, USA). Reflective markers were
attached on the subject’s left leg with medical proof fabric
for recording ankle movement. These reflective markers were
placed on the lower lateral surface of the thigh, the lateral and
medial epicondyle of the knee, the lower shank, the lateral and
medial malleolus, heel, and the first and fifth metatarsal head. A
portable ultrasound scanner (SIUI-1100, SIUI Company, Shantou, Guangdong, China) was utilized to simultaneously collect
the ultrasound images of the GM with a linear probe. Since
the measurements along the midsagittal axis were found to be
representative for fascicle measurements both at rest and in the
contracted state [6], the probe with a frequency of 5–10 MHz
and a field of view of 38 mm was secured steadfastly on the
GM midbelly with bandage, and carefully adjusted to visualize fascicles from the superficial to deep aponeuroses with
an image resolution of 0.1 mm/pixel and an imaging depth of
4.7 cm. All measurements of the fascicle length were automatically achieved by a custom-designed software developed using
Visual Studio (Microsoft, Corporation, Washington, DC, USA).
The proposed approach with the orientation-sensitive segmentation, as well as the approach proposed by Cronin et al. [36],
was applied to estimate the fascicle length in the present study.
Moreover, manual measurements of the fascicle length were
also performed three times in each image by a single expert who
was experienced in ultrasound imaging of muscles and blind to
the automatic measurement results. According to the definition
of the fascicle length, line segments representing aponeuroses
and fascicle were manually drawn in each ultrasound image to

CMC value between manual
measurement and automatic
measurement by the method of
Cronin et al. (2011) [36]

CMC value between manual
measurement and automatic
measurement using the
proposed method

0.97
0.67
0.90
0.92
0.87
0.80
0.96

0.97
0.95
0.95
0.96
0.97
0.98
0.97

A
B
C
D
E
F
G

obtain an estimate of the fascicle length. The mean value of
the manual measurements was used to compare with the automatic measurements. According to Iwanuma et al. [52], the
ankle angle was also calculated using the 3-D spatial information from the reflective markers to further validate the dynamic
measurements.
D. Data Analysis
Values were reported as mean (±S.D.) for all subjects unless otherwise stated. The manual measurements of the fascicle
length were used as reference for comparison with the dynamic
measurements. In addition, waveform similarity between the
manual and dynamic measurements was assessed by calculating the overall similarity with the coefficient of multiple correlation (CMC) [53], [54]. The CMC was employed as a way of
quantifying the percentage variance in fascicle length estimates
accounted for within and between the data [53], with a range
of 0 and 1. More similar waveforms have higher CMC values,
whereas highly dissimilar waveforms can result in a CMC near
0. A Student’s paired t-test was applied to test the difference between the CMC values of the proposed method and the approach
proposed by Cronin et al. [36]. Moreover, a linear regression
analysis with zero intercept (y = kx; k = regression coefficient) was implemented to describe the relationship between
the manual and proposed methods, and a polynomial regression
analysis was applied to describe the association between the
ankle angle and the fascicle length, considering the viscosity of
the fascicles during continuous ankle plantar flexion movement.
Pearson product-moment correlations (r) were calculated for the
regression analysis. The level of significance was accepted at
p < 0.05.
III. RESULTS
As shown in Table I, the CMC value (0.87 ± 0.1) determined
by Cronin’s approach ranged from 0.67 to 0.97, while the proposed method had CMC value (0.97 ± 0.01) ranging from 0.95
to 0.98. The difference in the CMC value between these two
methods was significant (p = 0.048). Fig. 5 shows the changes
of the fascicle length in the GM images without nonfascicle
components during cyclic plantar flexion for one typical subject.
The high-CMC values suggested a good agreement between the

ZHOU AND ZHENG: AUTOMATIC FASCICLE LENGTH ESTIMATION ON MUSCLE ULTRASOUND IMAGES

2833

Fig. 5. Change of fascicle length obtained with the proposed method, the
approach proposed by Cronin et al. [36], and the manual method during plantar
flexion for subject A.

Fig. 7. Measurement of the fascicle length for subject A using the proposed
approach. (a) Fascicle in the first frame manually defined with the fascicle end
points (white circles). (b) Measurement of the fascicle length at frame 145.
(c) Measurement of the fascicle length at frame 470.

Fig. 6. Measurement of the fascicle length for subject A using the approach
proposed by Cronin et al. [36]. (a) Fascicle in the first frame manually defined
with the fascicle end points (white circles). (b) Measurement of the fascicle
length at frame 145. (c) Measurement of the fascicle length at frame 470.

manual and dynamic measurements for both the proposed and
Cronin’s methods. These results demonstrated the comparable
performance between the two methods when dealing with a sequence of ultrasound images without nonfascicle components.
As shown in Figs. 6 and 7, the fascicular path determined by
Cronin’s approach in comparison with the proposed approach
exhibited slight deviation from the actual, targeted fascicle in
some frames, which can be ascribed to speckle noise. Even
worse, the changes in orientation and location of the fascicles
could not be accurately estimated using the affine transform
parameters estimated from the whole fascicle patch when non-

Fig. 8. Change of fascicle length obtained with the proposed method, the
approach proposed by Cronin et al. [36], and the manual method during plantar
flexion for subject B.

fascicle components were observed in the images. Fig. 8 shows
a typical example of the fascicle length measured with the proposed approach, for which Cronin’s method failed to track the
change in fascicles. As shown in Fig. 9(b), the target points
deviated from the predefined fascicular path due to the visible
intramuscular blood vessels, and this deviation was accumulated in subsequent frames [see Fig. 9(c)]. Since the fascicle
structures in the image were not taken into account, such errors
could not be avoided when the whole fascicle region was used
to estimate the affine transform parameters. On the other hand,

2834

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

Fig. 9. Measurement of the fascicle length for subject B using the approach
proposed by Cronin et al. [36]. (a) Fascicle in the first frame manually defined
with the fascicle end points (white circles). (b) Measurement of the fascicle
length at frame 133. (c) Measurement of the fascicle length at frame 398.

Fig. 10. Measurement of the fascicle length for subject B using the proposed
approach. (a) Fascicle in the first frame manually defined with the fascicle end
points (white circles). (b) Measurement of the fascicle length at frame 133.
(c) Measurement of the fascicle length at frame 398.

our proposed tracking approach only used the effective fascicle region to calculate the affine transform parameters, thus
avoiding the influence of nonfascicle components and speckle
noise [see Fig. 10(b) and (c)]. The CMC values also suggested
that the dynamic measurement with the proposed method was
more consistent with the manual measurement compared with
Cronin’s approach. Moreover, the results revealed a positive
linear correlation between the proposed method and the manual
measurement (r = 0.94 ± 0.04; all p < 0.001; see Table II), and
the average regression coefficient (slope) between the manual
measurements and the proposed method (slope = 0.99 ± 0.03)
was close to 1.0. These results support the conclusion that the
proposed approach was reliable for the estimation of the fascicle
length. When the plantar flexion angle was increased to 33.1 ±
5.0°, the fascicle length measured with the proposed method was
shortened from 70.4 ± 6.8 mm to 39.3 ± 8.8 mm, and was negatively correlated with the ankle joint angle (r = −0.93 ± 0.02,
all p < 0.001). In addition, the average computation time for the
estimation of the fascicle length with the proposed method in the
∼300 × 300 pixel ROI was about 4 ∼ 5 s for each frame using a
computer with an Intel Core 2 Q8400 2.66-GHz processor and
2048 MB of memory.

TABLE II
LINEAR REGRESSION ANALYSIS BETWEEN THE MANUAL AND PROPOSED
METHOD FOR THE MEASUREMENT OF THE FASCICLE LENGTH

IV. DISCUSSION
The proposed orientation-sensitive segmentation algorithm
utilized prior knowledge of the geometric arrangement of fascicles to identify the effective fascicle region from ultrasound
images, which can therefore be applied as a preprocessing step

Subject

A
B
C
D
E
F
G

Regression coefficient (slope)
between manual and automatic
measurements of fascicle length
1.04
0.94
1.00
1.00
1.00
1.00
0.96

Correlation between manual and
automatic measurements of
fascicle length
0.96 (p
0.98 (p
0.86 (p
0.92 (p
0.95 (p
0.96 (p
0.96 (p

<
<
<
<
<
<
<

0.001)
0.001)
0.001)
0.001)
0.001)
0.001)
0.001)

for the estimation of the fascicle length. The Lucas–Kanade optical flow algorithm over the effective fascicle region rendered
the estimation of global affine transform parameters more reliable, since it obviated the influence of nonfascicle components
and speckle noise on the motion estimation of points on the
fascicular path. The preliminary results demonstrated that the
proposed method could reliably track the change of the fascicle
length in continuous ultrasound images, which were in good
agreement with those obtained by manual measurement and
correlated well with kinematic data, such as the ankle angle.
The affine flow parameters estimated over the whole fascicle
region avoided the accumulation of small errors caused by tracking a small ROI [38]. However, this approach could still exhibit
a tracking error due to inhomogeneous deformation across the

ZHOU AND ZHENG: AUTOMATIC FASCICLE LENGTH ESTIMATION ON MUSCLE ULTRASOUND IMAGES

region of interest between consecutive images, as demonstrated
using Cronin’s approach (CMC = 0.87 ± 0.10), which may be
due to the nonfascicle components and speckle noise. The spatial and temporal gradients of the nonfascicle components and
speckle noise made the estimation of global affine transform
parameters imprecise, resulting in accumulated tracking errors.
Moreover, it was observed that the deformation of nonfascicle
components, such as intramuscular blood vessels, was usually
inconsistent with that of the fascicles, which contributed to the
incorrect estimations using Cronin’s approach. On the other
hand, the proposed method using orientation-sensitive segmentation may eliminate the contribution from nonfascicle components and speckle noise in the estimation of global affine flow
parameters, because it segments visible fascicle structures from
the whole image for the calculation of global affine transform
parameters. The overall high CMC value (0.97 ± 0.01) and
very close regression (r = 0.94 ± 0.04; slope = 0.99 ± 0.03)
demonstrated that the results of the proposed method were consistent with the manual measurements. Moreover, the significantly larger CMC value for the proposed method (p = 0.048),
compared with Cronin’s approach, suggested that this method
had a better performance in tracking fascicles, thus was more
robust in the measurement of the fascicle length. Additionally,
the processing time is currently between 4 and 5 s/frame, making real-time application possible. The computational time may
even be further greatly reduced, since block-wise calculation in
the effective fascicle region can be processed by parallel computation techniques using a graphics processing unit (GPU).
The changes and values of fascicle lengths measured with
the proposed method were consistent with previous reports [7],
[25], and [55]. In this study, the average fascicle length for an
ankle angle of 0° was 70.4 ± 6.8 mm, and was reduced to
39.3 ± 8.8 mm with the plantar flexion angle reaching 33.1 ±
5.0°. The average absolute values of maximum and minimum
fascicle length were reported to be 71 and 64 mm during the
stance phase [55]. The fact that the GM fascicles maintained
a near-constant length around the plateau region of the force–
length curve has been reported when the muscle was active
during a major part of stance in walking [24]. The shortest
mean GM fascicle length for walking and running has been
reported to be 44.1 ± 1.0 mm and 40.1 ± 0.6 mm, respectively
[25]. The high correlation between the ankle angle and fascicle
length (r = −0.93 ± 0.02; all p < 0.001) found in this study
also suggested that the fascicle length is dependent on the ankle
joint angle, in agreement with the previous reports [7] and [17].
As the ankle angle increased to 30°, the GM fascicle length was
shortened by about 32% at rest [7]. In addition, the muscle size
in elderly humans, including the fascicle length, is known to
be enlarged with resistive training programs [56]. This finding
indicates an increase in the number of sarcomeres in series,
resulting in a larger force generation capability [21]. Therefore,
it is feasible to generalize the use of the fascicle length into
whole motion analysis with the proposed method, which would
facilitate an improved understanding of the architectural and
bioelectrical properties of muscle.
Nonetheless, the method proposed in this study still had some
limitations. First, it was assumed that the fascicles being tracked

2835

conform to homogeneous affine transformations. This assumption may not hold in some movement tasks where changes in the
local muscle shape instead of global shape are more of interest
[36], making this approach unreliable. The initialization may
also affect the estimation accuracy of the fascicle length. Moreover, although the fascicle structures had been taken into account
in our method, it still lacked the ability to examine possible
tracking errors by identifying individual fascicles. Furthermore,
a two-point fascicle representation may not properly account
for the fascicle curvature. Fascicles are nearly straight at rest, as
the contraction level increases, fascicles become slightly curved
and muscle length decreases, resulting in an approximately 6%
underestimation of the fascicle length during a maximum voluntary contraction [57]. Thus, this effect is likely to be a minor
factor in measuring the fascicle length in human daily dynamic
tasks. Nevertheless, it would be ideal if the algorithm was able to
track multiple points along a fascicle for curvature measurement
in future.
V. CONCLUSION
We have successfully developed a new approach using
orientation-sensitive segmentation for automatically estimating the fascicle length in a series of ultrasound images utilizing prior knowledge of the orientations of fascicles. The
orientation-sensitive segmentation algorithm precluded the influence of nonfascicle components on the calculation of affine
transform parameters, resulting in a more reliable measurement
of the fascicle length. The results obtained using the proposed
approach showed good agreement with those obtained by manual measurements. The method therefore provides an alternative dynamic measurement of muscle activation with ultrasound
imaging to analyze the muscle function in human motion analysis. Future studies with a large group of subjects and other
types of motion such as walking will be conducted to further
demonstrate the potential of this new method for full understanding of muscle activation. The performance of the newly
proposed method can also be further enhanced by using GPU
programming to achieve real-time application in future studies.
REFERENCES
[1] V. M. Zatsiorsky and B. I. Prilutsky, Biomechanics of Skeletal Muscles.
Champaign, IL, USA: Human Kinetics, 2012.
[2] Y. P. Zheng et al., “Sonomyography: Monitoring morphological changes
of forearm muscles in actions with the feasibility for the control of powered
prosthesis,” Med. Eng. Phys., vol. 28, no. 5, pp. 405–415, Jun. 2006.
[3] G. R. Adams et al., “Magnetic resonance imaging and electromyography
as indexes of muscle function,” J. Appl. Physiol., vol. 73, no. 4, pp. 1578–
1589, Oct. 1992.
[4] G. R. Adams et al., “Mapping of electrical muscle stimulation using MRI,”
J. Appl. Physiol., vol. 74, no. 2, pp. 532–537, Feb. 1993.
[5] C. J. Zuurbier and P. A. Huijing, “Changes in geometry of actively shortening unipennate rat gastrocnemius muscle,” J. Morphol., vol. 218, no. 2,
pp. 167–80, Nov. 1993.
[6] M. V. Narici et al., “In vivo human gastrocnemius architecture with changing joint angle at rest and during graded isometric contraction,” J. Physiol.,
vol. 496, no. 1, pp. 287–297, Oct. 1996.
[7] C. N. Maganaris et al., “In vivo measurements of the triceps surae complex architecture in man: Implications for muscle function,” J. Physiol.,
vol. 512, no. 2, pp. 603–614, Oct. 15, 1998.
[8] P. W. Hodges et al., “Measurement of muscle contraction with ultrasound
imaging,” Muscle Nerve, vol. 27, no. 6, pp. 682–692, Jun. 2003.

2836

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

[9] K. Manal et al., “Can pennation angles be predicted from EMGs for the
primary ankle plantar and dorsiflexors during isometric contractions?” J.
Biomechanics, vol. 41, no. 11, pp. 2492–2497, Aug. 2008.
[10] A. A. Mohagheghi et al., “In vivo gastrocnemius muscle fascicle length
in children with and without diplegic cerebral palsy,” Dev. Med. Child
Neurol., vol. 50, no. 1, pp. 44–50, Jan. 2008.
[11] L. Barber et al., “Medial gastrocnemius muscle fascicle active torquelength and Achilles tendon properties in young adults with spastic cerebral
palsy,” J. Biomechanics, vol. 45, no. 15, pp. 2526–2530, Oct. 2012.
[12] K. Reardon et al., “Quadriceps muscle wasting persists 5 months after
total hip arthroplasty for osteoarthritis of the hip: A pilot study,” Internal
Med. J., vol. 31, no. 1, pp. 7–14, Jan.-Feb., 2001.
[13] C. Suetta et al., “Resistance training induces qualitative changes in muscle morphology, muscle architecture, and muscle function in elderly
postoperative patients,” J. Appl. Physiol., vol. 105, no. 1, pp. 180–186,
Jul. 2008.
[14] X. Chen et al., “Sonomyography (SMG) control for powered prosthetic
hand: A study with normal subjects,” Ultrasound Med. Biol., vol. 36, no. 7,
pp. 1076–1088, Jul. 2010.
[15] J. Y. Guo et al., “Towards the application of one-dimensional sonomyography for powered upper-limb prosthetic control using machine learning
models,” Prosthetics Orthotics Int., vol. 37, no. 1, pp. 43–49, Feb. 2013.
[16] T. Fukunaga et al., “Determination of fascicle length and pennation in
a contracting human muscle in vivo,” J. Appl. Physiol., vol. 82, no. 1,
pp. 354–358, Jan. 1997.
[17] Y. Kawakami et al., “Architectural and functional features of human triceps surae muscles during contraction,” J. Appl. Physiol., vol. 85, no. 2,
pp. 398–404, Aug. 1998.
[18] M. V. Narici et al., “Ageing of human muscles and tendons,” Disability
Rehabil., vol. 30, no. 20–22, pp. 1548–1554, 2008.
[19] M. V. Narici et al., “Effect of aging on human muscle architecture,” J.
Appl. Physiol., vol. 95, no. 6, pp. 2229–2234, Dec. 2003.
[20] L. Mademli and A. Arampatzis, “Behaviour of the human gastrocnemius
muscle architecture during submaximal isometric fatigue,” Eur. J. Appl.
Physiol., vol. 94, no. 5–6, pp. 611–617, Aug. 2005.
[21] J. Duclay et al., “Behavior of fascicles and the myotendinous junction
of human medial gastrocnemius following eccentric strength training,”
Muscle Nerve, vol. 39, no. 6, pp. 819–827, Jun. 2009.
[22] A. J. Blazevich, “Effects of physical training and detraining, immobilisation, growth and aging on human fascicle geometry,” Sports Med., vol. 36,
no. 12, pp. 1003–1017, 2006.
[23] T. Fukunaga et al., “In vivo behaviour of human muscle tendon during
walking,” Proc. Roy. Soc. B—Biological Sci., vol. 268, no. 1464, pp. 229–
233, Feb. 2001.
[24] T. Fukunaga et al., “Muscle and tendon interaction during human movements,” Exercise Sport Sci. Rev., vol. 30, no. 3, pp. 106–110, Jul. 2002.
[25] G. A. Lichtwark and A. M. Wilson, “Interactions between the human
gastrocnemius muscle and the Achilles tendon during incline, level and
decline locomotion,” J. Exp. Biol., vol. 209, no. 21, pp. 4379–4388, Nov.
2006.
[26] A. Ishikawa et al., “Medial gastrocnemius muscle behavior during human
running and walking,” Gait Posture, vol. 25, no. 3, pp. 380–384, Mar.
2007.
[27] D. J. Farris and G. S. Sawicki, “Human medial gastrocnemius forcevelocity behavior shifts with locomotion speed and gait,” Proc. Nat. Acad.
Sci. United States Amer., vol. 109, no. 3, pp. 977–982, Jan. 2012.
[28] N. Aggeloussis et al., “Reproducibility of fascicle length and pennation
angle of gastrocnemius medialis in human gait in vivo,” Gait Posture,
vol. 31, no. 1, pp. 73–77, Jan. 2010.
[29] G. P. Pappas et al., “Nonuniform shortening in the biceps brachii during
elbow flexion,” J. Appl. Physiol., vol. 92, no. 6, pp. 2381–2389, Jun. 1,
2002.
[30] Y. J. Zhou and Y. P. Zheng, “Estimation of muscle fiber orientation in
ultrasound images using revoting Hough transform (RVHT),” Ultrasound
Med. Biol., vol. 34, no. 9, pp. 1474–1481, Sep. 2008.
[31] M. Rana et al., “Automated tracking of muscle fascicle orientation in
B-mode ultrasound images,” J. Biomechanics, vol. 42, no. 13, pp. 2068–
2073, Sep. 2009.
[32] H. Zhao and L. Q. Zhang, “Automatic tracking of muscle fascicles in
ultrasound images using localized radon transform,” IEEE Trans. Biomed.
Eng., vol. 58, no. 7, pp. 2094–2101, Jul. 2011.
[33] S. Bianchi et al., Ultrasound of the Musculoskeletal System. New York,
NY, USA: Springer, 2007.
[34] J. Darby et al., “Automated regional analysis of B-mode ultrasound images
of skeletal muscle movement,” J. Appl. Physiol., vol. 112, no. 2, pp. 313–
327, Jan. 2012.

[35] I. D. Loram et al., “Use of ultrasound to make noninvasive in vivo measurement of continuous changes in human muscle contractile length,” J.
Appl. Physiol., vol. 100, no. 4, pp. 1311–1323, Apr. 2006.
[36] N. J. Cronin et al., “Automatic tracking of medial gastrocnemius fascicle length during human locomotion,” J. Appl. Physiol., vol. 111, no. 5,
pp. 1491–1496, Nov. 2011.
[37] J. Darby et al., “Estimating skeletal muscle fascicle curvature from Bmode ultrasound image sequences,” IEEE Trans. Biomed. Eng., vol. 60,
no. 7, pp. 1935–1945, Jul. 2013.
[38] J. G. Gillett et al., “Reliability and accuracy of an automated tracking
algorithm to measure controlled passive and active muscle fascicle length
changes from ultrasound,” Comput. Methods Biomechanics Biomed. Eng.,
vol. 16, no. 6, pp. 678–687, Jun. 2013.
[39] B. D. Lucas and T. Kanade, “An iterative image registration technique
with an application to stereo vision,” in Proc. 7th Int. Joint Conf. Artif.
Intell., Vancouver, BC, Canada, 1981, vol. 2, pp. 674–679.
[40] J. Shi and C. Tomasi, “Good features to track,” in Proc. IEEE Comput.
Soc. Conf. Comput. Vision Pattern Recog., 1994, pp. 593–600.
[41] A. F. Frangi et al., “Multiscale vessel enhancement filtering,” in Medical Image Computing and Computer-Assisted Intervention, W. M. Wells,
A. Colchester, and S. Delp, Eds. Berlin: Springer-Verlag Berlin, 1998,
pp. 130–137.
[42] S. Bianchi and C. Martinoli, Ultrasound of the Musculoskeletal System,
Berlin, Germany: Springer, 2007.
[43] L. Hong et al., “Fingerprint image enhancement: Algorithm and performance evaluation,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 20, no. 8,
pp. 777–789, Aug. 1998.
[44] A. R. Rao, A Taxonomy for Texture Description and Identification. Berlin,
Germany: Springer-Verlag, 1990.
[45] H. Scharr, “Optimal filters for extended optical flow,” in Complex Motion,
B. Jähne, R. Mester, E. Barth, and H. Scharr, Eds. Berlin, Germany:
Springer, 2007, pp. 14–29.
[46] J. Weickert and H. Scharr, “A scheme for coherence-enhancing diffusion
filtering with optimized rotation invariance,” J. Vis. Commun. Image R.,
vol. 13, no. 1-2, pp. 103–118, Mar-Jun 2002.
[47] P. E. Williams et al., “Relationship between fascicle size and perineurial
collagen IV content in diabetic and control human peripheral nerve,”
Histopathology, vol. 36, no. 6, pp. 551–555, Jun. 2000.
[48] R. T. Kohrs et al., “Tendon fascicle gliding in wild type, heterozygous, and
lubricin knockout mice,” J. Orthopaedic Res., vol. 29, no. 3, pp. 384–389,
2011.
[49] Y. J. Zhou, J. Z. Li, G. Q. Zhou, et al., “Dynamic measurement of pennation angle of gastrocnemius muscles during contractions based on ultrasound imaging,” Biomed. Eng. Online, vol. 11, p. 63, (Sep. 2012).
[Online]. Available: http://www.biomedical-engineering-online.com/
content/11/1/63
[50] R. D. Herbert et al., “Changes in the length and three-dimensional orientation of muscle fascicles and aponeuroses with passive length changes in
human gastrocnemius muscles,” J. Physiol., vol. 593, pp. 441–455, Jan.
2015.
[51] G.-Q. Zhou et al., “Automatic measurement of pennation angle and fascicle length of gastrocnemius muscles using real-time ultrasound imaging,”
Ultrasonics, vol. 57, pp. 72–83, Mar. 2015.
[52] S. Iwanuma et al., “Triceps surae muscle-tendon unit length changes as
a function of ankle joint angles and contraction levels: The effect of foot
arch deformation,” J. Biomechanics, vol. 44, no. 14, pp. 2579–2583, Sep.
2011.
[53] M. P. Kadaba et al., “Repeatability of kinematic, kinetic, and electromyographic data in normal adult gait,” J. Orthopaedic Res., vol. 7, no. 6,
pp. 849–860, Nov. 1989.
[54] J. J. Kavanagh et al., “Reliability of segmental accelerations measured
using a new wireless gait analysis system,” J. Biomechanics, vol. 39,
no. 15, pp. 2863–2872, 2006.
[55] O. S. Mian et al., “Gastrocnemius muscle-tendon behaviour during walking in young and older adults,” Acta Physiologica, vol. 189, no. 1, pp. 57–
65, Jan. 2007.
[56] N. D. Reeves et al., “Effect of resistance training on skeletal musclespecific force in elderly humans,” J. Appl. Physiol., vol. 96, no. 3, pp. 885–
892, Mar. 2004.
[57] T. Muramatsu et al., “In vivo determination of fascicle curvature in contracting human skeletal muscles,” J. Appl. Physiol., vol. 92, no. 1, pp. 129–
134, Jan. 2002.

Authors’ photographs and biographies not available at the time of publication.

