IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

1813

Analysis and Classification of Sleep Stages
Based on Difference Visibility Graphs
From a Single-Channel EEG Signal
Guohun Zhu, Yan Li, Member, IEEE, and Peng (Paul) Wen, Member, IEEE

Abstract—The existing sleep stages classification methods are
mainly based on time or frequency features. This paper classifies
the sleep stages based on graph domain features from a singlechannel electroencephalogram (EEG) signal. First, each epoch
(30 s) EEG signal is mapped into a visibility graph (VG) and a
horizontal VG (HVG). Second, a difference VG (DVG) is obtained
by subtracting the edges set of the HVG from the edges set of the
VG to extract essential degree sequences and to detect the gaitrelated movement artifact recordings. The mean degrees (MDs)
and degree distributions (DDs) P (k) on HVGs and DVGs are analyzed epoch-by-epoch from 14,963 segments of EEG signals. Then,
the MDs of each DVG and HVG and seven distinguishable DD values of P (k) from each DVG are extracted. Finally, nine extracted
features are forwarded to a support vector machine to classify the
sleep stages into two, three, four, five, and six states. The accuracy
and kappa coefficients of six-state classification are 87.5% and 0.81,
respectively. It was found that the MDs of the VGs on the deep sleep
stage are higher than those on the awake and light sleep stages, and
the MDs of the HVGs are just the reverse.
Index Terms—Classification, degree distribution (DD), difference visibility graph (DVG), electroencephalogram (EEG), single
channel.

I. INTRODUCTION
FFICIENTLY identifying sleep stages is beneficial for
the treatment of sleep apnea, insomnia and narcolepsy.
Polysomnogram (PSG) techniques are applied to the diagnosis and treatment of sleep disorders. The classification of sleep
stages is traditionally performed by experts based on the visual interpretation of the PSG according to Rechtschaffen’s and
Kales’s (R&K) recommendations [1] or a new guideline developed by the American academy of sleep medicine (AASM) [2].
This study uses six-state sleep stages in R&K standard: awake
(Awa), stage 1 (S1), stage 2 (S2), stage 3 (S3), stage 4 (S4),
and rapid eye movement (REM). The five-state stages combine
S3 and S4 as a slow wave sleep (SWS) stage in six-state, the
four-state stages join S1 and S2 in five-state. And stages S1, S2,

E

Manuscript received June 7, 2013; revised November 9, 2013 and January
24, 2014; accepted January 27, 2014. Date of publication February 6, 2014; date
of current version November 3, 2014.
G. Zhu is with the University of Southern Queensland, Toowoomba, Qld.
4350, Australia, and also with the Guilin University of Electronic Technology,
Guangxi 541004, China (e-mail: Guohun.Zhu@usq.edu.au).
Y. Li and P. Wen are with the University of Southern Queensland, Toowoomba,
Qld. 4350, Australia (e-mail: Yan.Li@usq.edu.au; Peng.Wen@usq.edu.au).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2303991

S3 and S4 are denoted as non-REM (NREM). The three-state
stages include Awa, NREM, and REM.
The manual scoring is subject to human errors and it is
time consuming. An automatic identification of the sleep stages
would reduce time dramatically and generate reliable results.
The existing sleep stages analysis and classifying methods are
mainly based on time or frequency domain features from electroencephalogram (EEG), electrooculogram (EOG), and electromyogram (EMG) signals [3]–[7]. Using discriminant analysis techniques based on different frequency bands of EEG,
power of EMG, and variances of EOG, the accuracy of the sleep
stages scoring can reach 74% for five-state classification [3].
Anderer et al. [4] applied EEG, EOG and EMG features to obtain 80% accuracy six-state sleep classification. Chapotot and
Becq [5] applied EEG and EMG as features and obtained a 78%
accuracy for six-state sleep classification. Charbonnier et al. [6]
employed EEG, EMG, and EOG as features and obtained 85.5%
accuracy for five-state classification. Zhu et al. [7] presented a
visibility graph (VG) similarity method to perform a sevenstate (six-state plus body movements stage) classification with
an 82.64% accuracy based on EEG and EOG features.
Multichannel EEG equipment often place limitations on the
subject’s movement and it is more difficult to use in ambulatory environment than those employed single-channel devices.
Therefore, more researchers have focused on classifying sleep
stages with a single-channel EEG signal [8]–[14] or single lead
ECG (electrocardiogram) signal [15]. Flexer et al. [9] used a
hidden Markov model to obtain 80% accuracy for three-state
sleep stages. Berthomier et al. [10] presented a fuzzy logic iterative method to perform a five-state sleep stages classification
with a 82.9% accuracy. Jo et al. [14] introduced a fuzzy classifier to identify four-state sleep stages with a 84.6% accuracy.
Ronzhina et al. [8] used power spectral density (PSD) features
and an artificial neural network (ANN) classifier to obtain an
accuracy of 76.7% for six-state sleep stages classification. Fraiwan et al. [13] applied a random forest classifier and wavelet
features to identify the wakeful state with a 90% accuracy. However, unless applying an extensive number of diverse extracted
features, it is difficult to obtain a higher accuracy that is even
close to the accuracy levels achieved by experts using manual
techniques [16], [17], which is 83 ± 3% [5]. Therefore, automatic sleep classification is still a challenge [17], especially for
identifying sleep stages with a single-channel EEG signal.
Recently, VGs, which were first proposed by Lacasa et al. [18]
have been employed to analyze EEG signals [7], [19], [20]. VGs
have also been employed by Shao [21] to study heartbeat interval

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1814

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

signals and applied by Xiang et al. [22] to analyze ECG signals.
In addition, one of the modified VG, the horizontal VGs (HVGs),
have been used to distinguish chaotic series from random series
[23]. Since EEG signals demonstrate chaotic behaviors [24],
HVGs are able to represent the chaotic characteristics of EEGs
according to the results from Luque et al. [23].
This paper presents a novel VG model to classify the sleep
stages based on a single-channel EEG signal. First, each segment
EEG signal (Pz-Oz channel) is mapped into a VG and a HVG.
Then, a difference VG (DVG) is constructed epoch-by-epoch
by subtracting the edges set of the HVG from the edges set of
the VG. The mean degrees (MDs) of the VGs and the HVGs are
evaluated and the degree distributions (DDs) of the DVGs are
studied. In total, there are 14,963 EEG segments to be analyzed.
Then, the features of the MDs of the HVGs and the DVGs and
the seven optimal DDs of the DVGs are selected. Finally all the
extracted features are forwarded to a support vector machine
(SVM) to perform two-state, three-state, four-state, five-state,
and six-state sleep stages EEG classification, respectively.
The remaining sections of this paper are organized as follows:
the experimental data are described in the next section. The VG,
the horizontal VG, and the difference visibility graph (DVG)
are introduced in Section III. Section IV presents the experimental results. The performances of the proposed method on
two-state, three-state, four-state, five-state, and six-state sleep
stages classifications are also compared with the results reported
from other existing methods. Finally, the conclusions are drawn
in Section V.
II. EXPERIMENTAL DATA
The experimental data used in this study were obtained from
the Sleep-EDF database [25], [26], which was part of Physionet data bank [27]. The eight data recordings from subjects:
sc4002e0, sc4012e0, sc4102e0, sc4112e0, st7022j0, st7052j0,
st7121j0, and st7132j0, were used in this paper. The first four
sets of data were recorded in 1989 from ambulatory healthy volunteers and the last four sets of data were recorded in 1994 from
subjects with mild difficulty falling asleep. The recorded data
from each subject was saved in an EDF-File [28] and each
recording included one horizontal EOG, two EEG channels
(Fpz-Cz and Pz-Oz). These three channel signals were sampled in 100 Hz. In this study, the Pz-Oz channel EEG signal was
selected to analyze and identify the sleep stages because it can
provide better automatic classification accuracy than the Fpz-Cz
channel [8], [10], [12]. Since the hypnogram was generated by
experts following the R&K recommendations [1] on every 30 s
of EEG data, the interval of each segment (or epoch) in this
study is defined as 30 s, and contains 3000 data points.
The original sleep stages of these segments are labeled with
one of the eight classes: AWA, S1, S2, S3, S4, REM and MVT
(Movement time) and UNS (unknown states). Note that only
the recordings: sc4002e0, sc4102e0 and st7121j0 have the MVT
data in the original EDF file. This study only deals with AWA,
S1 to S4 and REM sleep stages.
The whole EEG data was divided into a training set and a
testing set except for analyzing and 10-cross-validation classi-

TABLE I
INFORMATION OF THE EXPERIMENTAL DATA

fying. The odd numbers of epochs were in the training set and
the others were in the testing set. The six sleep stages of the
training and testing data are listed in Table I. It can be seen
that the numbers of the training epochs and testing epochs were
approximately balanced.
III. METHODOLOGY
The structural diagram of the automatic sleep stages classification method proposed in this study is shown in Fig. 1. Each
segment of the raw EEG signal was mapped into a VG and
a HVG, without any frequency domain preprocessing. Then,
a DVG was constructed based on the VG and HVG for each
of the EEG segments. The MDs of the DVG and the HVG
were calculated and the DDs of the DVG were evaluated. Seven
distinguishable DD values for each DVG were selected as the
representative features. Then, the extracted features were forwarded to an SVM algorithm to perform two-state, three-state,
four-state, five-state, and six-state sleep EEG classification, respectively.
The details of the methodology are described in the following
subsections.
A. Visibility Graphs
Let G(V, E) be a graph, where V and E are the nodes and
edges of the graph, respectively. A time series {xt }(t=1,...,n ) is
mapped into a graph G(V, E), while a data point xi is converted
into a node vi in G. For any two points vi (i, xi ) and vj (j, xj ),
the edge between vi and vj is connected based on the rule
proposed by Lacasa et al. [18], that is
∀k ∈ (i, j) ;

(xj − xi )
(xj − xk )
>
.
j−k
j−i

(1)

Fig. 2 shows how a time series (7.3, 5.0, 6.2, 6.6, 5.7, 5.0,
9.1) is transferred into a VG. v1 is the first node of the graph
corresponding to the first point with a value of 7.3. The degree
k(i) is the number of connected edges of vi in a graph. The time
series can be characterized with its degree sequence, MD, and
DD of the VG. For example, the degree sequence of the VG in
Fig. 2 is (4, 2, 4, 5, 3, 3, 5). The MD kv g is the average of the
degree sequence, which is 3.71 in Fig. 2.

ZHU et al.: ANALYSIS AND CLASSIFICATION OF SLEEP STAGES BASED ON DIFFERENCE VISIBILITY GRAPHS

Fig. 1.

1815

Automatic sleep stages classification structural diagram.

following equation:



khvg

1
=4 1−
2T


.

(3)

Equation (3) implies that the MD khvg is close to 4 if the
period T of a time series is large enough.
C. Difference Visibility Graphs

Fig. 2.
part).

Fig. 3.
part).

Illustration of a time series (upper part) converted into its VG (bottom

Let Gv g (V, E1 ) and Ghvg (V, E2 ) be a VG and a HVG associated with a time series {xt }, where, V is the node set, and E1
and E2 are the edge sets of the VG and HVG.
The DVG Gdvg (V, E3 ) is a graph defined by E3 = E1 − E2 .
For the same time series {xt } , Ghvg is a subset of Gv g , the
degree kdvg (i) of a DVG associated with a time point xi satisfies
kdvg (i) = kv g (i) − khvg (i)

Illustration of a time series (upper part) converted into its HVG (bottom

(4)

where kdvg (i), kv g (i), and khvg (i) are the degrees of node vi of
the DVG, VG, and HVG, respectively. Thus, the MD of a DVG
is equal to the MD of a VG minus the MD of a HVG.
DVGs could be beneficial to obtain the essential features of
input signals than VGs and HVGs. It overcomes a pitfall that
there are often many nodes with the degree value k = 2 on HVGs
and VGs [31], which are not distinguishable enough to analyze
the different sleep stages using EEGs. For example, the degree
sequence of HVG in Figs. 2 and 3 is (4, 2, 3, 4, 3, 2, 4), if nodes
v1 , v4 , and v7 are considered as essential features. The degree
sequence of a DVG in Figs. 2 and 3 is (0, 0, 1, 1, 0, 1, 1). Then, the
nodes v3 , v4 , v6 , and v7 are obtained by selected the value one.
The degree sequence of DVG is more essential in representing
EEGs. Moreover, if a time series is constant, kdvg (i) is always
zero, which can detect the disconnected telemetry link event
from EEG recordings.

B. Horizontal Visibility Graphs

D. Degree Distributions

The horizontal visibility graph (HVG) was first introduced by
Luque et al. [23]. It is a subset of a VG [29]. The nodes, vi and
vj , in a HVG are connected if and only if

The DD is a probability that a node has a degree of k. It
is obtained by counting the number of nodes having degree k
divided by the total number of nodes. Let Pv g (k) be denoted as
the DD of a VG, Phvg (k) as the DD of a HVG, and Pdvg (k) as
the DD of a DVG.


2, Pv g (k) = 0, 0, 17 , 27 , 27 , 27 , and in Fig. 3, Phvg (k) =
 In Fig.
0, 0, 27 , 27 , 27 . Therefore,
for the time series in Figs. 2 and 3,

Pdvg (k) = 37 , 47 . Unlike (4), Pdvg (k) = Pv g (k) − Phvg (k).
Phvg (k) has been used to distinguish correlated stochastic,
uncorrelated and chaotic processes by Lacasa and Toral [32].
It has been shown by Shao [21] that Pv g (k) associated with
ECG approximately satisfies the power-law. Luque et al. [23]

∀k ∈ (i, j) ;

xj > xk

and

xi > xk .

(2)

Fig. 3 shows the HVG of the same time series in Fig. 2. The
MD khvg in Fig. 3 is 3.14. It is noted that for the same time
series, the nodes in a VG are the same as the nodes in a HVG.
HVGs have been characterized with some rigorous mathematical analysis by Gutin et al. [29]. Núñez et al. [30] reported
that the MD of a periodic time series (period is T ) satisfies the

1816

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

TABLE II
FEATURES SELECTED IN EACH MULTISLEEP STAGES CLASSIFICATION

proved that the HVGs on random signals satisfy exponential
distribution rules. This study considers it as efficient features
for sleep stage classification.

The accuracy is the sum of the diagonal values in the confusion matrix divided by the sum of all the values in the confusion
matrix. The sensitivity is the number of a sleep stage was positively identified by the proposed method divided by the total
number obtained by experts’ scoring for the same sleep stage.
The Kappa coefficient κ was used as a means of assessing the
performance agreement between the proposed method and the
experts. If the value of κ is greater than 0.80, it means a perfect
agreement as suggested by Landis and Koch [34]. Otherwise a
κ value between 0.61 to 0.80, 0.41 to 0.60, 0.21 to 0.40, and 0
to 0.20 ranges, would represent substantial, moderate, fair, and
slight agreement, respectively.
To test the differences between the MDs of the VGs and
HVGs of six stages of sleep data, a non-parametric Wilcoxon
test was also used because the distribution of sleep EEG data
does not satisfy a normal distribution.

E. Extracted Features for the Multisleep Stages Classification
Choosing appropriate features to represent the original EEG
data is the most important and difficult task in pattern recognition and classification. For multisleep stages classification, it
is difficult to obtain high accuracies with the same feature set
that is used to identify different sleep stages, such as classifying
two-state sleep stages or classifying five-state sleep stages.
This study selected nine features: kdvg , khvg and seven other
DD values from Pdvg (k), in association with degrees (k) ranging from 0 to 12, to classify two-state to six-state sleep stages.
Let p(k) be the value of the DD Pdvg (k) for a degree k. A specific p(k) is selected due to its distinguishable difference from
other degree distribution values. The features used on each multisleep stages classification are listed in Table II.

H. Multiclass SVM Classification
An SVM was applied to perform the multiple sleep stages
classification. SVMs have been used in sleep stages classification by other researchers [7], [15], [35] previously. Using an
SVM classifier, it is possible to conduct a linear space discrimination or nonlinear classification by choosing a kernel function.
There are four kernel functions: linear, polynomial kernel, radical basis function (RBF), and sigmoid.
There are several types of SVMs. The LIBSVM [36] classifier
is applied to identify the sleep stages in this paper. The SVM
model was created by an R package e1071 [37] with RBF as a
kernel K(xi , xj ) = e−r |x i −x j | , where r = 0.78 in this study.
IV. EXPERIMENTS AND RESULTS

F. Reject Disconnected Telemetry Link EEGs With DVGs
As for the EEG data in PSG, it always contains some artifacts
and the telemetry link was disconnected during recording in
some cases. Some of artifacts or disconnected links were marked
as UNS stage by experts in sleep-EDF database. However, not
all disconnected links were defined as UNS stage. For example,
in third epoch of the subject st7502j0, the state is AWA stage.
Therefore, this study used the MD of DVGs to reject the artifact
EEGs, when MD of DVGs associated with epoch EEGs is less
5, the epoch is assigned as UNS even it is marked as AWA stage
in EDF files.

To evaluate the performances of the proposed approach discussed in Section III, a set of experiments were conducted. The
features extraction program was implemented in C.
The experiments consisted of four parts: 1) comparing the
DDs of VGs, HVGs and DVGs; 2) analyzing the MD of the
DVGs and HVGs; 3) conducting the two-state, three-state, fourstate, five-state, and six-state sleep stages classifications based
on the extracted features; and 4) comparing the performances
of the proposed method with the results reported by the existing
methods.
A. Compared the DD of VG, HVG, and DVG

G. Statistical Analysis
In order to evaluate the performance of the proposed method,
the confusion matrix, accuracy, sensitivity and kappa coefficient
(κ) proposed by Cohen [33] were computed to assess each multistate sleep stages classification. The confusion matrix is a square
matrix showing the relation between experts scoring on sleep
EEG classification and the outcomes obtained using the proposed algorithm. The values in the diagonal elements represent
the number of correctly identified stages and the off-diagonal
values are the number of misclassified ones. An element value
in row i and column j indicates the number of times sleep stage
i was misclassified as sleep stage j.

First, an example is provided to show that the DD could be
used in sleep stage classification. Fig. 4 illustrates a VG, HVG,
and DVG associated with two raw EEGs, which are comes from
epochs 312 and 346 of subject St7022j0, respectively. Fig. 4(c)
and (e) illustrates how the differences among the DDs of a VG,
an HVG, and a DVG can be used to classify the sleep stages S2
and awake. Both X-axis and Y -axis in Fig. 4(c) and (e) on both
epochs are in log–log plot but Y -axis in Fig. 4(d) is in semi-log
plot. In Fig. 4(c), the trajectory of epoch 312 for subject st7022j0
from k = 6 to k = 50 is different from that in epoch 346. Phvg (k)
of epoch 312 from k = 4 to k = 15 is also different from that in
epoch 346. Note that the values of pdvg (k) from its trajectory

ZHU et al.: ANALYSIS AND CLASSIFICATION OF SLEEP STAGES BASED ON DIFFERENCE VISIBILITY GRAPHS

1817

Fig. 5. Log–log plot of P d v g (k) on six-state sleep classification associated
with the Pz-Oz channel EEG data. X -axis and Y -axis use logarithmic scale.

Fig. 6. Box plot of the MDs of the VGs associated with six sleep stages of the
Pz-Oz channel EEG.
Fig. 4. The illustration of p v g (k), p hv g (k), and p d v g (k) on epochs 312 and
346 (AWA and S2 stages, respectively) of subject St7022j0. (The solid line and
dashed line in (c), (d), and (e) are the trajectories of DD values on the two VGs,
two HVGs, and two DVGs from epochs 312 and 346, respectively.)

are more distinguishable than those of Pv g (k) and Phvg (k) to
separate epochs 312 and 346. The phenomenon in Fig. 4(e)
indicates that the DD of a DVG (Pdvg (k)) represents the original
EEGs better than the DD of a VG or a HVG (Pv g (k) or Phvg (k))
for the sleep EEG classification. Therefore, this paper selected
seven extra distinguishable DD values from each DVG as the
optimal features to perform the sleep stages classification.
Second, the statistical (mean ± SD) Pdvg (k) of six-state sleep
stages from Pz-Oz channel EEG are shown in Fig. 5. It is noted
that the trajectories of Pdvg (k) of all sleep stages had good
potential to represent the original sleeping EEG data when the
degree was from 0 to 3. As shown in Table II, Pdvg (k), p(0),
p(1), p(2), and p(3) (for degrees 0 to 3) were chosen as the key
features for each two-state classification, while p(4) was ignored
because p(4) in awake stage was overlapped by p(4) of other
sleep stages. The DDs, p(0) to p(6), for degrees 0 to 6 were
selected for three-state and four-state classifications because
p(4) of the awake stage was not overlapped by p(4) of REM
stage. During five-state and six-state classifications, p(11) was
selected as the representative features as it was quite different
in sleep stages S2, S3 and S4 with this degree (degree 11).

Fig. 7. Box plot of the MDs of the HVGs on six sleep stages of the Pz-Oz
channel EEG data.

B. Significant Characteristics of the MDs of DVGs and HVGs
on Two-Sleep Stages
The MDs from the HVGs and DVGs are the key features
representing the original EEG signal. The statistical MDs of
the DVGs and HVGs associated with six-state sleep stages are
shown in Figs. 6 and 7, respectively. Fig. 6 shows the MD
population on the DVGs associated with the Pz-Oz channel
EEG data, obtained from 14,963 segments. It shows that the
REM stage is similar to S1 stage.
Fig. 7 presents the statistical MD population on HVGs associated with the same EEG data, obtained from the 14 963

1818

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

TABLE III
RESULTS OF THE WILCOXON TEST ON THE MDS OF THE DVGS AND HVGS FOR
THREE PAIRS OF SLEEP STAGES

TABLE V
SLEEP STAGES CLASSIFICATION FOR TWO-STATE PAIRS WITH k d v g , k hv g , AND
NINE DDS

TABLE IV
ACCURACY OF TWO-STATE SEEP STAGES CLASSIFICATION BASED ON TWO
FEATURES, k d v g AND k hv g

TABLE VI
CONFUSION MATRIX AND SENSITIVITY ON FIVE-STATE SLEEP STAGES

epochs. It shows that 3 < khvg < 4, which is consistent with
the theoretical analysis by Núñez et al. [30]. According to (3),
the raw EEGs in the sleep stages include more low frequency
components than those in wake stage. The outcome is consistent
with the result reported by Achermann et al. [38] that the EEG
is dominated by slow wave activities in the low frequency range
when sleeping.
The nonparametric Wilcoxon rank sum test was conducted
again to test the difference of the MDs of DVGs and HVGs
associated with three pairs of sleep stages: AWA and S1, S1
and REM, S2 and REM. The results are listed in Table III. The
results indicate that both MDs of the DVGs and HVGs on AWA
and S1, S1 and REM, and S2 and REM were also significantly
different (p < 0.05).
Given the outcomes reported in Table III, the two features
kdvg and khvg were selected to perform the two-state sleep stages
classification between the pairs of: awake and sleep, AWA and
REM, S1 and REM, (S1, S2) and SWS, S1 and S2, and S3 and
S4. Their accuracies are listed in Table IV.
C. Two-State, Three-State, Four-State, Five-State, and
Six-State Sleep Stages Classifying Using MDs and DDs
To investigate the performance of the proposed method, the
sleep-awake and other pairs of two-state sleep classifications
were evaluated. The accuracies of Awa-REM, NREM-REM,
(S1, S2)-SWS, S1-S2, and S3-S4 are listed in Table V. Compared with Table IV, kappa coefficient of S1-REM sleep stage
classification increased nearly two times in Table V.
To demonstrate the performance of the proposed method, the
three-state to six-state classifications were evaluated. The classification sensitivities of three-state (AWA, NREM, and REM
stages) were 97.1%, 91.1%, and 74.1%, respectively, the kappa

TABLE VII
CONFUSION MATRIX AND SENSITIVITY ON FIVE-STATE SLEEP STAGES
(WITHOUT AWAKE)

κ was 0.87 and accuracy was 92.6%. The recognition rates of
four-state sleep stages were 97.0%, 73.4%, 81.3%, and 86.5%,
respectively, while kappa κ was 0.83 and accuracy was 89.3%.
The confusion matrix and sensitivities of five-state sleep scoring are listed in Table VI. The accuracy was 88.9% and kappa
κ was 0.83. The accuracy was 87.5% in six-state classification
and kappa κ was 0.81.
A tenfold cross-validation was applied to evaluate the average accuracy of five-state sleep stages classification, where the
dataset included the training data and testing data.
The average 10 times of accuracy was 89.0%. The sensitivity
of awake in Table VI achieves 98.8%, which imply the proposed
method with Pz-Oz channel is efficient to identify the awake
from sleep stages. This result confirms that the recommendation
in AASM Manual [2] that arousal scoring is better detected from
occipital and central EEG derivations. Now, let us only consider
the five-state sleep stages: S1, S2, S3, S4 and REM stages sleep
classification. The confusion matrix and sensitivities are listed
in Table VII, the accuracy is 76.6% and kappa is 0.63. When
tenfold cross-validation was applied, 10 times average accuracy
is 77.2%.

ZHU et al.: ANALYSIS AND CLASSIFICATION OF SLEEP STAGES BASED ON DIFFERENCE VISIBILITY GRAPHS

TABLE VIII
COMPARISON ACCURACIES OF THREE METHODS

Based on Tables V–VII, the results show that distinguishing
S1 stage from REM, five-state with awake, and five-state without
awake by the proposed method is 78.8%, 15.8%, and 27.4%,
respectively. These results indicate that it is much harder to
distinguish S1 and REM stages by using DVGs. However, our
results agree with the conclusions reported by Corsi-Cabrera
et al. in [39] that S1 stage was easily mistakenly categorized as
any of AWA, S2 and REM stages.

D. Comparison of the Proposed Method With Other
Single-channel Sleep Classification
To verify the performance of the proposed approach, the
comparisons of the classification results for two-state to sixstate were conducted with two existing methods proposed by
Ronzhina et al. [8] and Berthomier et al. [10]. Both studies
used the same EEG datasets as in this paper. The comparison
performances are listed in Table VIII.
The performances of the proposed method from two-state to
six-state sleep classifying were better than those in [8] and [10].
Berthornier et al. [10] reported their sleep stages classification
results using two sleep datasets: the sleep EDF dataset and
their own sleeping recording data. Their reported accuracies
with first dataset were listed in Table VIII. The accuracies with
their own sleep data were 96%, 92.1%, 84.9%, and 82.9%,
respectively, for the two-state, three-state, four-state and fivestate classifications. Both are lower than the results obtained
in this study. In additional, our testing results were obtained
from more EEG data segments and more numbers of epochs
and subjects than those in [8], [10]
In addition, the accuracy of AWA-REM state classification
shown in Table V is better than that reported by Vatankhah
et al. [35] using the same sleep-EDF database. Their accuracy
is 98.15%. In fact, even only comparing the five-states sleep
scoring without awake, our proposed method on is better than
the reported by Tagluk et al. [40], which was 74.7% by cross
validation and tested 265 epochs.
Finally, the proposed method of classifying performance on
five-state sleep scoring was compared with other existing results

1819

TABLE IX
COMPARISON ACCURACIES OF KNOWN METHODS

on five-state sleep stages. The results are shown in Table IX. The
research reported by Liang et al. [12] and Hsu et al. [11] used
the same EEG dataset. However, their classification accuracies
were lower than the proposed method and the number of epochs
on the data sets was also smaller than those used in this paper.
The average accuracies between deep sleep and paradoxical
sleep stages in Tables V and VI are higher than the accuracy
obtained in inter-expert agreement, which is 83 ± 3% [5] and
76.9% in [4]. The outcomes demonstrate that the features extracted from DVGs are more robust and accurate.

V. CONCLUSION
This paper applies DVGs to study the sleep EEG signals, and
identifies the significant differences of MDs between DVGs and
HVGs associated with the sleep EEG signals. It was found that
the MDs of DVGs on the deep sleep stage are higher than those
in awake and light sleep states, while the MDs of HVGs are just
the opposite.
Based on the analyses from this study, the MDs from each
HVG and DVG and seven optimal values of the DD of a DVG
associated with sleep EEG signals were extracted to perform
two-state, three-state, four-state, five-state, and six-state sleep
stages classifications. The tenfold cross-validation of five-state
sleep scoring showed that the average accuracy was 89.0% with
14,963 epochs EEGs. The accuracies are by far the best accuracy reported on the sleep stages classification using more than
10,000 epochs from the public sleep EEG dataset.
More important, this paper suggests that the graph domain
features can be efficiently used to analyze and classify sleep
EEG without any frequency domain preprocessing or time domain analysis. And it can also detect disconnected telemetry link
recordings. The 97.9% accuracy sleep-wake classification suggests that our proposed method is efficient for single-channel
sleep classification during human locomotion. However, this
study detects the EEG recordings in disconnected telemetry

1820

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

link only by checking the MD of DVGs. Future work aims to
denoise artifacts of EEGs effectively in graph domain.
ACKNOWLEDGMENT
The authors would like to thank B. Kemp for helping with
data discussions and three anonymous reviewers for helpful
comments regarding the paper.
REFERENCES
[1] A. Rechtschaffen and A. Kales, A Manual Of Standardized Terminology,
Techniques and Scoring Systems for Sleep Stages of Human Subjects,
U. G. P. Office, Washington DC Public Health Service, 1968.
[2] C. Iber, S. Ancoli-Israel, A. L. Chesson, and S. F. Quan, The AASM Manual
for the Scoring of Sleep and Associated Events: Rules, Terminology and
Technical Specification, Westchester, USA: American Academy of Sleep
Medicine, 2007.
[3] A. Krakovská and K. Mezeiová, “Automatic sleep scoring: A search for an
optimal combination of measures,” Artif. Intell. Med., vol. 53, pp. 25–33,
2011.
[4] P. Anderer, G. Gruber, S. Parapatics, M. Woertz, T. Miazhynskaia,
G. Klösch, B. Saletu, J. Zeitlhofer, M. J. Barbanoj, and H. Danker-Hopfe,
“An E-health solution for automatic sleep classification according to
Rechtschaffen and Kales: validation study of the Somnolyzer 24 × 7
utilizing the Siesta database,” Neuropsychobiology, vol. 51, pp. 115–133,
2005.
[5] F. Chapotot and G. Becq, “Automated sleep–wake staging combining robust feature extraction, artificial neural network classification, and flexible
decision rules,” Int. J. Adaptive Control Signal Process., vol. 24, pp. 409–
423, 2010.
[6] S. Charbonnier, L. Zoubek, S. Lesecq, and F. Chapotot, “Self-evaluated
automatic classifier as a decision-support tool for sleep/wake staging,”
Comput. Biol. Med., vol. 41, pp. 380–389, 2011.
[7] G. Zhu, Y. Li, and P. P. Wen, “An efficient visibility graph similarity algorithm and its application on sleep stages classification,” in Brain Informatics, F. Zanzotto, S. Tsumoto, N. Taatgen, and Y. Yao, Eds. vol. 7670,
Berlin, Germany: Springer, 2012, pp. 185–195.
[8] M. Ronzhina, O. Janoušek, J. Kolářová, M. Nováková, P. Honzı́k, and
I. Provaznı́k, “Sleep scoring using artificial neural networks,” Sleep Med.
Rev., vol. 16, pp. 251–263, 2012.
[9] A. Flexer, G. Gruber, and G. Dorffner, “A reliable probabilistic sleep
stager based on a single EEG signal,” Artif. Intell. Med., vol. 33, pp. 199–
207, 2005.
[10] C. Berthomier, X. Drouot, M. Herman-Stoı̈ca, P. Berthomier, J. Prado,
D. Bokar-Thire, O. Benoit, J. Mattout, and M.-P. D’ortho, “Automatic
analysis of single-channel sleep EEG: Validation in healthy individuals,”
Sleep, vol. 30, pp. 1587–1595, Nov. 2007.
[11] Y.-L. Hsu, Y.-T. Yang, J.-S. Wang, and C.-Y. Hsu, “Automatic sleep stage
recurrent neural classifier using energy features of EEG signals,” Neurocomputing, vol. 104, pp. 105–114, 2013.
[12] S.-F. Liang, C.-E. Kuo, Y.-H. Hu, Y.-H. Pan, and Y.-H. Wang, “Automatic
stage scoring of single-channel sleep EEG by using multiscale entropy
and autoregressive models,” IEEE Trans. Instrum. Meas., vol. 61, no. 6,
pp. 1649–1657, Jun. 2012.
[13] L. Fraiwan, K. Lweesy, N. Khasawneh, H. Wenz, and H. Dickhaus, “Automated sleep stage identification system based on time–frequency analysis
of a single EEG channel and random forest classifier,” Comput. Methods
Programs Biomed., vol. 108, pp. 10–19, 2012.
[14] H. G. Jo, J. Y. Park, C. K. Lee, S. K. An, and S. K. Yoo, “Genetic fuzzy
classifier for sleep stage identification,” Comput. Biol. Med., vol. 40,
pp. 629–634, 2010.
[15] M. Adnane, Z. Jiang, and Z. Yan, “Sleep–wake stages classification and
sleep efficiency estimation using single-lead electrocardiogram,” Expert
Syst. Appl., vol. 39, pp. 1401–1413, 2012.
[16] N. Sukhorukova, A. Stranieri, B. Ofoghi, P. Vamplew, M. Saleem, L. Ma,
A. Ugon, J. Ugon, N. Muecke, H. Amiel, C. Philippe, A. Bani-Mustafa,
S. Huda, M. Bertoli, P. Lévy, and J.-G. Ganascia, “Automatic sleep stage
identification: difficulties and possible solutions,” presented at the 4th Australasian Workshop Health Informat. Knowl. Manag., vol. 108, Brisbane,
Australia, 2010.

[17] C. Berthomier and M. Brandewinder, “Sleep scoring: man versus machine?” Sleep Breathing, vol. 17, pp. 461–462, May
2013.
[18] L. Lacasa, B. Luque, F. Ballesteros, J. Luque, and J. C. Nuño, “From time
series to complex networks: The visibility graph,” in Proc. Nat. Academy
Sci., Apr. 1 2008, vol. 105, pp. 4972–4975.
[19] X. Tang, L. Xia, Y. Liao, W. Liu, Y. Peng, T. Gao, and Y. Zeng, “New
approach to epileptic diagnosis using visibility graph of high-frequency
signal,” Clinical EEG Neuroscience, vol. 44, pp. 150–156, Mar. 17, 2013.
[20] M. Ahmadlou, H. Adeli, and A. Adeli, “New diagnostic EEG markers
of the Alzheimer’s disease using visibility graph,” J. Neural Transmiss.,
vol. 117, pp. 1099–1109, 2010.
[21] Z.-G. Shao, “Network analysis of human heartbeat dynamics,” Appl. Phys.
Lett., vol. 96, pp. 073703-1–073703-3, 2010.
[22] L. Xiang, Y. Dong, L. Xin, and W. Xiao-Mei, “Bridging time series dynamics and complex network theory with application to electrocardiogram analysis,” IEEE Circuits Syst. Mag., vol. 12, no. 4, pp. 33–46, Nov.
2012.
[23] B. Luque, L. Lacasa, F. Ballesteros, and J. Luque, “Horizontal visibility
graphs: Exact results for random time series,” Phys. Rev. E, vol. 80,
pp. 046103-1–046103-11, 2009.
[24] H. Korn and P. Faure, “Is there chaos in the brain? II. Experimental
evidence and related models,” Comptes Rendus Biol., vol. 326, pp. 787–
840, 2003.
[25] B. Kemp. (2013, Jun.). The Sleep-EDF Database [Onlne]. Available:
http://www.physionet.org/physiobank/database/sleep-edf/
[26] B. Kemp, A. H. Zwinderman, B. Tuk, H. A. C. Kamphuisen, and
J. J. L. Oberye, “Analysis of a sleep-dependent neuronal feedback loop:
the slow-wave microcontinuity of the EEG,” IEEE Trans. Biomed. Eng.,
vol. 47, no. 9, pp. 1185–1194, Sep. 2000.
[27] A. L. Goldberger, L. A. N. Amaral, L. Glass, J. M. Hausdorff,
P. C. Ivanov, R. G. Mark, J. E. Mietus, G. B. Moody, C.-K. Peng, and
H. E. Stanley, “PhysioBank, physiotoolkit, and physionet: components of
a new research resource for complex physiologic signals,” Circulation,
vol. 101, pp. e215–e220, Jun. 13, 2000.
[28] B. Kemp, A. Värri, A. C. Rosa, K. D. Nielsen, and J. Gade, “A
simple format for exchange of digitized polygraphic recordings,”
Electroencephalogr. Clinical Neurophysiol., vol. 82, pp. 391–393,
1992.
[29] G. Gutin, T. Mansour, and S. Severini, “A characterization of horizontal
visibility graphs and combinatorics on words,” Phys. A: Stat. Mechan.
Appl., vol. 390, pp. 2421–2428, 2011.
[30] A. M. Núñez, L. Lacasa, E. Valero, J. P. Gómez, and B. Luque, “Detecting
series periodicity with horizontal visibility graphs,” Int. J. Bifurcation
Chaos, vol. 22, pp. 1250160-1–1250160-10, 2012.
[31] R. Donner and J. Donges, “Visibility graph analysis of geophysical time
series: Potentials and possible pitfalls,” Acta Geophysica, vol. 60, pp. 589–
623, Jun. 1, 2012.
[32] L. Lacasa and R. Toral, “Description of stochastic and chaotic series using
visibility graphs,” Phys. Rev. E, vol. 82, pp. 036120-1–036120-11, 2010.
[33] J. Cohen, “A coefficient of agreement for nominal scales,” Educational
Psychol. Meas., vol. 20, pp. 37–46, 1960.
[34] J. R. Landis and G. G. Koch, “The measurement of observer agreement for categorical data,” Biometrics, vol. 33, pp. 159–174,
1977.
[35] M. Vatankhah, M. Akbarzadeh Totonchi, A. Moghimi, and V. Asadpour,
“GA/SVM for diagnosis sleep stages using non-linear and spectral features,” in Soft Computing in Industrial Applications, vol. 75, X.-Z. Gao,
A. Gaspar-Cunha, M. Köppen, G. Schaefer, and J. Wang, Eds. Berlin,
Germany: Springer, 2010, pp. 175–184.
[36] C.-C. Chang and C.-J. Lin, “LIBSVM: A library for support vector machines,” ACM Trans. Intell. Syst. Technol., vol. 2, pp. 1–27,
2011.
[37] A. Karatzoglou, D. Meyer, and K. Hornik, “Support vector machines in
R,” J. Statistical Softw., vol. 15, pp. 1–28, 2006.
[38] P. Achermann and A. A. Borbély, “Low-frequency (<1 Hz) oscillations in
the human sleep electroencephalogram,” Neuroscience, vol. 81, pp. 213–
222, 1997.
[39] M. Corsi-Cabrera, Z. Muñoz-Torres, Y. Del Rı́o-Portilla, and
M. A. Guevara, “Power and coherent oscillations distinguish REM sleep,
stage 1 and wakefulness,” Int. J. Psychophysiol., vol. 60, pp. 59–66,
2006.
[40] M. E. Tagluk, N. Sezgin, and M. Akin, “Estimation of sleep stages by an
artificial neural network employing EEG, EMG and EOG,” J. Med. Syst.,
vol. 34, pp. 717–725, 2010.

ZHU et al.: ANALYSIS AND CLASSIFICATION OF SLEEP STAGES BASED ON DIFFERENCE VISIBILITY GRAPHS

Guohun Zhu received the B.S. degree in automation from Guilin University of Electronic Technology,
Guangxi, China, in 1994. He is currently working toward the Ph.D. degree in Faculty of Health, Engineering and Sciences, University of Southern Queensland,
Toowoomba, Qld., Australia.
Since 2006, he has been an Associate Professor
with the School of Electronic Engineering and Automation, Guilin University of Electronic Technology. His current research interests include biomedical
signal and image processing, computation biology,
graph theory and complex network, computer networks, machine learning, and
pattern recognition.

Yan Li (M’06) received the B.Sc. and M.Sc. degrees
from Huazhong University of Science and Technology, Wuhan, China, and the Ph.D. degree from the
Flinders University, Bedford Park, SA, Australia.
She is currently an Associate Professor in the
School of Agricultural, Computational and Environmental Sciences, University of Southern Queensland,
Toowoomba, Qld., Australia. Her research interests
include blind signal processing, pattern recognition,
computational intelligence, and EEG research.

1821

Peng (Paul) Wen (M’06) received the B.S. and M.S.
degrees from Huazhong University of Science and
Technology, Wuhan, China, in 1983 and 1986, respectively, and the Ph.D. degree from the Flinders
University, Bedford Park, SA, Australia, in 2001.
He is currently an Associate Professor in the
School of Mechanical and Electrical Engineering,
University of Southern Queensland, Toowoomba,
Qld., Australia. His current research interests include
control and instrument, modeling and simulation, artificial intelligence, and biomedical engineering.

