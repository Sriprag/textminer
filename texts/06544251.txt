IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

3103

Noninvasive Estimation of the Input Function for
Dynamic Mouse 18F-FDG MicroPET Studies
Wei Mu, Zhe Chen, Xiaoqian Dai, and Jie Tian∗ , Fellow, IEEE

Abstract—A new noninvasive estimation method for the plasma
time-activity curve, i.e., input function (IF) of the tracer kinetic
model in dynamic 1 8 F-FDG microPET mouse studies, is proposed
and validated. This estimation method comprises of four steps.
First, a novel constraint nonnegative matrix factorization segmentation algorithm was applied to extract the left ventricle (Lv) and
myocardium (Myo) time activity curves (TACs). Second, we modeled the IF as a seven-parameter mathematical equation and constructed a dual-output model of the real TAC in Lv and Myo accounting for the partial-volume and spillover effects. Then, we fit
the image-derived Lv and Myo TACs to the dual-output model to
estimate the parameters of the IF. Finally, the IF was validated by
comparing it to the gold standard IF while considering the delay
and dispersion effects. Our method was verified based on 20 mice
datasets from the Mouse Quantitation Program database, provided
by UCLA. The error of the areas under the curves between the delayed and dispersed estimated IF and the gold standard IF was
7.237% ± 6.742% (r = 0.969), and the error of the 1 8 F-FDG influx constant Ki of the Myo was 4.910% ± 6.810% (r = 0.992).
The results demonstrated the effectiveness of the proposed method.
Index Terms—Bayesian penalty term, constraint nonnegative
matrix factorization (CNMF), delay and dispersion effects, input
function, partial-volume and spillover effects.

I. INTRODUCTION
HE tracer kinetic modeling techniques are widely applied
in positron emission tomography (PET) 18 F-FDG imaging
for the quantitative glucose metabolism estimation, in which the
18
F-FDG plasma time-activity curve (PTAC) and tissue time-

T

Manuscript received February 8, 2013; revised May 9, 2013; accepted June
3, 2013. Date of publication June 19, 2013; date of current version October
16, 2013. This work was supported in part by the National Basic Research
Program of China (973 Program) under Grant 2011CB707700, in part by the
Instrument Developing Project of the Chinese Academy of Sciences under Grant
YZ201164, in part by the National Natural Science Foundation of China under
Grant 81227901, Grant 61231004, Grant 81027002, Grant 81071205, Grant
81071129, Grant 81101095, in part by the National Key Technology R&D Program under Grant 2012BAI23B01, Grant 2012BAI23B06, in part by the Beijing
Natural Science Foundation under Grant 4111004, in part by the Fellowship
for Young International Scientists of the Chinese Academy of Sciences under
Grant 2010Y2GA03, in part by the Chinese Academy of Sciences Visiting Professorship for Senior International Scientists under Grant 2012T1G0036, Grant
2010T2G36, Grant 2012T1G0039, and in part by the NSFC-NIH Biomedical
collaborative research program under Grant 81261120414. Asterisk indicates
corresponding author.
W. Mu, Z. Chen, and X. Dai are with the Key Laboratory of Molecular Imaging
and Functional Imaging, Institute of Automation, Chinese Academy of Sciences,
Beijing 100190, China (e-mail: wei.mu@ia.ac.cn; zhe.chen@siemens.com;
daixq.casia@gmail.com).
∗ J. Tian is with the Key Laboratory of Molecular Imaging and Functional
Imaging, Institute of Automation, Chinese Academy of Sciences, Beijing
100190, China (e-mail: tian@ieee.org).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2267778

activity curve (TTAC) are required as the input function (IF) and
output function (OF) to fit certain tracer kinetic model parameters, i.e., the meaningful physiological parameters. Typically, to
obtain the gold standard of the IF, the radioactivity of the arterial plasma samples is measured by the insertion of the catheter
into the arterial lines with subsequent collections. However, it
is invasive, which limits its routine use in research, especially
for small animals such as in mouse studies because of the small
size of blood vessels and the limited blood volume [1]. Many
alternative methods to estimate the IF noninvasively have been
proposed as a result. Those methods can be divided into four
categories. The first approach extracts the IF from the image
by drawing regions of interest (ROIs) over the major vascular
structures [2], [3], such as the left ventricle (Lv) and the abdominal aorta, whereas this method was more challenging by using
a mouse due to the small size of the mouse and partial-volume
and spillover effects. The second approach standardizes the IF
over a large population under the assumption that the individual
IF has an identical curve shape and can be approximated by
scaling the standard IF to a proper scale with one or two blood
samples [4]. However, this method does not account for the
variety of curve shapes and has not been validated for small animals, which influences its accuracy. The third approach attempts
to extract the IF using a statistical analysis, such as the factor
analysis [5] and independent component analysis (ICA) [6]–[8],
while the extracted blood vessel component that reveals the IF
cannot completely eliminate the spillover and partial-volume
effects, especially for mice. The fourth approach models the IF
by a mathematical equation, whose parameters can be simultaneously estimated by fitting the IF to several specific organs
data [1], [9]. So far, this method gives the most accurate results, but requires two or three late blood samples in the fitting
process.
In this study, we proposed and validated a novel noninvasive method that belongs to the fourth approach. The proposed
method consisted of four major steps (shown in Fig. 1): first, extract TACs of Lv, myocardium (Myo) and liver; second, model
the IF and OFs by taking into account the partial-volume and
spillover effects; third, construct the objective function and simultaneously estimate the IF and OFs parameters; finally, validate the estimated IF compared with gold standard IF based
on the consideration of the delay and dispersion effects. In step
1, a constraint nonnegative matrix factorization (CNMF)-based
method was proposed to automatically extract TACs of Lv and
Myo since it is difficult and complicated to draw their ROIs manually. The partial-volume and spillover effects were corrected
in step 2 by introducing two mixing coefficients and modeling
the outputs of Lv and Myo as a linear combination of blood

0018-9294 © 2013 IEEE

3104

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

Fig. 2.
Fig. 1.

Overall flowchart of the proposed method.

and tissue activities. Since it has been indicated by Tantawy and
Peterson that the scaled TAC of the liver at a later time can be
used as an approximation of the cardiac whole-blood TAC [10],
we utilized this approximated whole-blood TAC in step 3 to
construct a Bayesian (a priori) penalty term and incorporate it
into the objective function, in which three adaptive weighing
factors were introduced and estimated during the optimization
process in order to improve accuracy. The parameters of the
IF and OFs were then estimated by fitting the Lv and Myo
TACs to their corresponding compartment outputs. The delay
and dispersion effects were finally taken into consideration by a
two-compartment model. We tested the proposed method with
20 mouse studies to demonstrate its effectiveness.
II. METHOD
A. TACs Extraction of the Liver, Lv and Myo
Liver VOI was manually drawn on the summed slice since
the liver could be clearly visible, and then the liver TAC was
generated. However, because of the small size of Lv and Myo
as well as the partial-volume and spillover effects, an accurate definition of their VOIs was difficult, which would affect
the subsequent TACs extraction. We proposed a CNMF-based
method to automatically extract the TACs of Lv and Myo.
1) Constraint of Nonnegative Matrix Factorization: The
nonnegative matrix factorization (NMF) method was proposed
by Lee and Seung in [11]. In general, NMF factorizes a nonnegative matrix into two nonnegative matrix factors Wn ×k
and Hk ×n (k < n, k < m) while minimizing the object function f (W, H) =  V − W H 2 :
V = WH .

(1)

The multiplicative updates for NMF are given by
V HT
WT V
, W ←W
H←H T
W WH
W HH T

Illustration of NMF decomposition on dynamic cardiac PET data.

images, and this is a linear combination of three tissue (Lv, right
ventricle (Rv), and Myo, i.e., k = 3) concentrations under the
assumption that the tissue TAC is the same during the whole
acquisition inside the same tissue, while different tissues behave differently. Wn Voxel×3 can be regarded as the probability
distribution map matrix of the three tissues; and H3×n Fram e
can be regarded as their corresponding tissue TACs matrix. An
illustration of the decomposition is shown in Fig. 2.
Even if NMF is physically intuitive and has been used as a
method capable of finding the underlying part-based structure
of the complex data, the solution of NMF is not unique, and not
necessarily localized [12]. Thus, more constraints are needed to
confine the factorization solution.
Two constraints were applied as follows.
1) Orthogonality Constraint: Different tissue maps (W )
should be orthogonal, so as to minimize redundancy between different tissue maps (i.e., different tissues should
not be overlapped)
WT W = I .
2) Scale Constraint: The sum of the probability of a given
voxel belonging to different tissues should be equal to 1,
so as to rescale W and H to a proper scale
k


Wij = 1 , for all rows i .

j =1

For the first constraint, the multiplicative updates can be given
by [12]:
H←H

WT V
V HT
, W ←W
.
T
W WH
W HV T W

(3)

For the second constraint, suppose α = [α1 , α2 , α3 ]T , and
Wi = Wi  α, for all rows i
Hl
, for all columns l
αT
then, we have the solution
n Voxel 

α=
Wi (W T W )−1 .
Hl =

(2)

A
means dot divide, i.e.,
where  means dot product, and B
A 
Aij
B ij = B i j .
When applying NMF to dynamic cardiac PET data
Vn Voxel×n Fram e (nVoxel represents the number of the voxels of
each frame and nFrame represents the number of the frames),
Vn Voxel×n Fram e , which can be regarded as dynamic cardiac PET

(4)

i=1

2) Subalgorithm Flowchart: The proposed methodology to
extracted TACs of Lv and Myo is shown in Fig. 3. A detailed
description of the steps is given as follows.

MU et al.: NONINVASIVE ESTIMATION OF THE INPUT FUNCTION FOR DYNAMIC MOUSE 1 8 F-FDG MICROPET STUDIES

3105

mouse heart
⎧ d
⎪
⎨ Ce (t) = K1 Cp Lv (t) − (k2 + k3 )Ce (t) + k4 Cm (t)
dt
⎪
⎩ d C (t) = k C (t) − k C (t)
m
3 e
4 m
dt

(5)
where Cp Lv (t), Ce (t), and Cm (t) are the ideal 18 F-FDG
plasma TAC in Lv, the 18 F-FDG concentration and the phosphorylated 18 F-FDG (18 F-FDG-6P) concentration in Myo tissue,
respectively. K1 , k2 , k3 , and k4 are the transfer rate constants
between compartments. The metabolic rate of glucose can be
calculated by

Fig. 3.

MRGlu =

Flowchart of automatically extracting TACs of Rv, Lv and Myo.

K1 k3
Cglu
Cglu
· Ki =
·
LC
LC k2 + k3

(6)

where Cglu is the glucose concentration in blood, LC is the
lumped constant, and Ki is the 18 F-FDG influx constant.
Because of the partial-volume and spillover effects, the measured TACs of Lv (PETLv ) and Myo (PETM yo ) were modeled
as a linear combination of tissue activities, i.e., the Myo uptake
(Ce (t) + Cm (t)) and the ideal TAC in Lv (Ca Lv (t)):

mLv = Ca Lv (t) + a × (Ce (t) + Cm (t))
(7)
mM yo = b × Ca Lv (t) + (Ce (t) + Cm (t))

Fig. 4.

Spatial and temporal specificity profiles of tissue TACs.

1) Masking of the Mouse Cardiac Region: The mouse heart
was segmented based on Otsu [13] to exclude the background and tissues with lower activity. With this masking,
only three cardiac tissue components (Lv, Rv, and Myo)
were separated. After masking, the masked dynamic cardiac PET images were reorganized into its vector form
Xn Voxel×n Fram e .
2) Smoothing and denoising: Xn Voxel×n Fram e was then
smoothed and denoised by means of the discrete cosine
transform [14], and was denoted by Vn Voxel×n Fram e .
3) Separation of cardiac tissue components: Then, CNMF
was applied to decompose Vn Voxel×n Fram e into two matrices: three tissue probability distribution map matrices (Wn Voxel×3 ) and their corresponding TACs matrix
(H3×n Fram e ).
4) Distinction of each tissue component: After the decomposition, since the CNMF decomposition order was unfixed,
we utilized the spatial and temporal specificity of the tissue TACs to distinguish each tissue component. The tissue
TACs’ spatial and temporal specificity means that the 18 FFDG concentration reaches the peak value first in Rv, then
in Lv, and at last accumulates in Myo, as shown in Fig. 4;
see [15] for more details. Then, the TACs of Lv (PETLv )
and Myo (PETM yo ) were obtained from H3×n Fram e .
B. Modeling the IF and OFs
We used the well-established two-tissue compartment model
here to describe the rates of changes in concentration in the

where mLv and mM yo are the model-predicted outputs of TACs
of Lv and Myo, respectively. The mixing coefficients a and b are
within the range [0 1]. Ca Lv (t) is the 18 F-FDG whole-blood
TAC in Lv, and can be modeled as [15]:
⎧
⎪
⎨0, if t < τ
Ca Lv (t) = [A1 (t − τ ) − A2 − A3 ] eλ1 (t−τ ) + A2 eλ2 (t−τ )
⎪
⎩
+A3 eλ3 (t−τ ) , otherwise.
(8)
18

The IF that indicates the F-FDG plasma TAC in Lv, i.e.,
Cp Lv (t) can be calculated by [16] :
Cp

Lv (t)

= Ca

Lv (t)

× RPB

(9)

where RPB is the ratio of the plasma to the whole-blood TAC
as a function of blood-sampling time (in minutes) after tracer
injection, and RPB = 0.386e−0.191t + 1.165.
C. Simultaneous Estimation
1) Objective Function: The parameters of the IF and OFs
can be estimated by fitting the Lv and Myo TACs to their corresponding compartment outputs, that is to solve the minus value
of the objective function as
O(p) =

n Fram
e

[(mLv,i −PETLv,i )2 +(mM yo,i −PETM yo,i )2 ].

i=1

(10)
However, since this objective function is insufficient to obtain accurate parameter values, traditionally two2 or three 3
extra blood samples at a later time were incorporated into the
objective function to ensure the estimation accuracy. However,
it is still invasive. To overcome this drawback, we utilized the
liver TAC to construct the Bayesian (a priori) penalty term to

3106

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

TABLE II
INITIAL VALUES AND BOUNDS FOR ALL PARAMETERS TO BE ESTIMATED

Fig. 5.

Relationship between the arterial blood samples and liver TAC.
TABLE I
MEAN AND SD OF THE RATIOS

be incorporated into the objective function, since it has been
reported that the liver has relatively low 18 F-FDG retention because it is highly vascularized and the liver TAC at a later time
can be used as an approximation of the whole-blood TAC [10].
Fig. 5 illustrates the relationship between the arterial blood samples and the liver TAC, which shows that the liver TAC has an
exponentially decaying part similar to that of whole-blood TAC.
Based on the relations between the arterial blood samples and
the liver TAC, we define a random variable θ:
θj = Ca (tj )/PETliver , j = 1, 2, . . . , m .

(11)

Here, θ can be assumed to be subordinate to the normal distribution according to the Bayesian probability theory. The mean
and the standard deviation (SD) of θ were calculated using five
randomly chosen studies (m10438, m10660, m17437, m17464,
and m17822) as the training datasets at five time points (see
Table I) in this study.
The Bayesian penalty term can be given by [17]:

m 

Ca Lv (tj ) − PETliver,j × Meanθ j 2
.
Bay(Ca Lv ) =
PETliver,j × SDθ j
j =1
(12)
The reason it uses ratios in multiple time points but not a unified ratio to construct the Bayesian penalty term is: the tested
mice datasets from MQP database were collected over a period
of several years. Due to changes in the experimental environment, large differences existed among individuals, which made
a unified ratio less accurate.
Incorporating the Bayesian penalty term into the objective
function, the objective function can be expressed as
O(p) = ω1

n Fram
e



mLv,i − PETLv,i

2

i=1

+ ω2

n Fram
e
i=1





mM yo,i − PETM yo,i + ω3 Bay(Ca

Lv )

(13)

where ω1 , ω2 , and ω3 indicate the self-adaptive weighing factors corresponding to the three terms of the objective function. The values of the weighing factors are also estimated
during the optimization process by the nonlinear least-squares
method. Thus, the parameters to be estimated are noted as
p = [τ, A1 , A2 , A3 , λ1 , λ2 , λ3 , K1 , k2 , k3 , k4 , a, b, ω1 , ω2 , ω3 ].
2) Initialization: The initial value and bound for p influence
the iterative speed and computation complexity; therefore, it is
important to choose suitable initial values.
For each dataset, the initial values of the parameters of IF,
i.e., A1 , A2 , A3 , λ1 , λ2 , λ3 , τ , were acquired by fitting an approximate curve of Ca Lv (t) (Ca Lv approx (t)) to the wholeblood TAC model. First, Ca Lv approx (t) was constructed with
the image-derived Lv TAC (PETLv ) and the average values
of the real arterial blood samples of the training datasets. The
early time (the first 30 s) points of the approximate curve were
obtained by the interpolation of PETLv , while the later part
was acquired by averaging the interpolated real arterial blood
samples of five randomly chosen training datasets at a later
time (after 60 s). Then, we utilized the Ca Lv approx (t) to
fit the parameters of the whole-blood TAC model, described
in (8), to obtain the initial values of the parameters, i.e.,
A1 , A2 , A3 , λ1 , λ2 , λ3 , τ which could help to reduce computational complexity and avoid falling into the local minimum
during optimization. Taking m17919 for example, the initial values of A1 , A2 , A3 , λ1 , λ2 , λ3 , τ , were 5703.27 MBq/min/mL,
4.9953 MBq/mL, 2.7580 MBq/mL, −144.2 min−1 , −13.62
min−1 , −0.034 min−1 , 0.080 min respectively. We did not give
the general initial values of these parameters in Table II, for they
vary with datasets.
Initial values for parameters K1 , k2 , k3 , k4 , a, b, listed in
Table II, were manually set according to the estimated results
in [9], and used for all the tested microPET images in our study.
Additionally, in order to acquire the initial values of the selfadaptive weighing factors (ω1 , ω2 , ω3 ), we performed many
trials for each of the aforementioned five chosen training
datasets with a series of different initial values. For each of
the training dataset, we set a series of different weighting
values as the initial values of (ω1 , ω2 , ω3 ), and completed
the optimization of the objective function [described in (13)].
The values of (ω1 , ω2 , ω3 ), that minimized the value of the
objective function were the proper values for this dataset. Then,

MU et al.: NONINVASIVE ESTIMATION OF THE INPUT FUNCTION FOR DYNAMIC MOUSE 1 8 F-FDG MICROPET STUDIES

3107

16 ∗ 0.5 s, 1 ∗ 2 s, 1 ∗ 4 s, 1 ∗ 6 s, 1 ∗ 15 s, 3 ∗ 30 s, 1 ∗
60 s, 1 ∗ 2 min, 3 ∗ 3 min, and 5 ∗ 15 min, and each frame of
the image data was reconstructed by FBP with 128 ∗ 128 ∗ 95
voxels. Several blood samples (5–22) were taken from a femoral
catheter to obtain the wholeblood TACs. Blood-to-plasma conversion was performed as described in (9). Twenty fasted or
nonfasted C57/BL6 mice datasets randomly chosen from the
database were used to verify our method.
B. Evaluation Criteria
Fig. 6.

Real IF in Lv and the blood samples during the whole scan.

Fig. 7.

Two-compartment model to describe the delay and dispersion effects.

we used the average of the five corresponding proper values for
(ω1 , ω2 , ω3 ) as the initial values for the weighing factors. The
initial values of weighing factors listed in Table II were used for
all the tested microPET images in our study.
3) Optimization: The Compartment Model Kinetic Analysis
Tool (COMKAT) [18], [19] was used to solve the models and
estimate parameters.
D. Input Function Validation
Following the optimization process after the parameters
A1 , A2 , A3 , λ1 , λ2 , λ3 , τ were obtained, the IF can be calculated from (9).
When comparing the estimated IF (EIF) with the gold standard blood samples, the delay and dispersion effects should be
considered. Because the blood samples were drawn from the
right femoral artery and not directly from the Lv cavity, there
was a time interval between the peak of Lv and the femoral
artery, as shown in Fig. 6. We constructed a two-compartment
model to describe these effects (shown in Fig. 7)
dCp (t)
= k1 Cp
dt

Lv (t

− Δt) −

k1 Cp (t)

(14)

where k1 is the dispersion rate constant and Δt indicates the
time delay. Five datasets with the most abundant early-time
(<1 min) blood sample data were used as training sets to calculate mean values of both k1 and Δt. Then, these mean values
were applied for all datasets. Finally, the delayed and dispersed
EIF (DDEIF) is compared with the gold standard IF.
III. EXPERIMENTAL RESULTS
A. Data Acquisition
The tested microPET images were downloaded from
the Mouse Quantitation Program (MQP) database [20]
(http://dragon.nuc.ucla.edu/mqp/index.html), as provided by
UCLA. These microPET images were obtained by about a 60min PET scan (microPET Focus 220; Siemens Medical Solutions USA, Inc.,) immediately after the injection of 18 F-FDG
(tail vein bolus) into the mouse. The typical frame rates were:

The extracted TACs of Lv and Myo were validated by calculating the area under curves error
(AUCE) and the root mean square error (RMSE), and comparing them with TACs extracted from manually drawn ROIs as
the standard reference.
To evaluate the performance of our proposed estimation
method, both the direct and indirect comparisons between
DDEIF and gold standard blood samples were conducted in
terms of visual comparison, such as the AUCE and the 18 F-FDG
influx constant Ki . Three kinds of influx constants Ki solved
by two different widely used methods were compared, that is,
Ki,DDEIF and Ki,GS were calculated with the gold standard IF
and DDEIF by the Patlak method, and Ki,M o del was computed
1 k3
). The Patlak
by the model-based method (Ki,M o del = kK2 +k
3
method is preferred to be used for its efficiency in computation and easy implementation; while the model-based method
is well known for the fact that it can estimate all of the transfer rate constants. By comparing the Ki,DDEIF and Ki,GS , we
could validate the accuracy of EIF directly, while by comparing the Ki,M o del to Ki,GS , we could validate the accuracy of
individual transfer rate constants (K1 , k2 , k3 , k4 ), and prove
the correctness of the estimated IF indirectly. By both comparisons, we could verify our proposed estimation method more
comprehensively.
C. Results
1) Extraction of Lv and Myo TACs: The extraction of probability distribution maps (Lv, Rv, and Myo) and their TACs with
our proposed CNMF method was satisfactory in all of the 20
normal mouse studies. Fig. 8 shows the segmentation results (the
probability distribution maps, PDM) and corresponding TACs
extracted using the traditional NMF method and the CNMF
method in one sample study (m10610). It can be observed that
the CNMF method provided more localized, part-based probability distribution maps and more reasonable TACs than the
traditional NMF.
In order to get insight into the robustness of our proposed
CNMF method, both qualitative and quantitative comparisons
of TACs were performed. Fig. 9 demonstrates the differences
of TACs extracted by the traditional NMF method, our CNMF
method, and the standard reference. It can be noted that the
TACs of our proposed CNMF method were much closer to the
standard references than the traditional NMF method, especially
for those of the Lv and Myo. Quantitative comparisons of the
AUCE and RRMSE between the traditional NMF method, our
CNMF method, and the standard reference with 20 datasets are

3108

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

Fig. 8. Comparison of probability distribution maps and TACs extracted with NMF and CNMF methods for the dataset m10610. The first three rows separately
demonstrate the segmentation results (PDM) of the Rv, Lv, and Myo, followed by their TACs at different times. (a) NMF. (b) CNMF.

Fig. 9. Visual comparison of TACs extracted by NMF and CNMF (indicated by H_RvTAC, LvTAC, H_MyoTAC) with the standard reference (indicated by
ROI_RvTAC, ROI_LvTAC, ROI_MyoTAC), respectively. (a) NMF. (b) CNMF.
TABLE III
MEAN AND STANDARD DEVIATION OF AUCE AND RMSE OF TACS FOR 20
DATASETS EXTRACTED BY NMF AND CNMF COMPARED WITH THE
STANDARD REFERENCE

shown in TABLE III. We can see that our proposed CNMF
method produced an obviously smaller AUCE (2.8–3.5%) and
RRMSE (3.1–4.3%) for both Lv and Rv TACs than the NMF
method (4.8–12.0%, 10.1–30.1%, respectively), while for the

Myo TAC, the proposed CNMF method did not have many
differences with the NMF method on the AUCE, but generated
a smaller RRMSE.
2) Validation of the Input Function: To compare our EIF
with the gold standard blood samples, the dispersion and delay
were considered. In this study, the five random datasets used
to calculate the average values of the dispersion factor k1 and
the delay Δt using the delay and dispersion correction model
were m17385, m17437, m17464, m17709 and m17822. The
estimated mean values of k1 and Δt were 84.034 and 0.079 min,
respectively.
Fig. 10 compares the plots of DDEIF and the gold standard blood samples with two sample datasets (1 unfasted+1
fasted). Taken the delay and dispersion into account, the estimated IF shows a good coincidence between the blood samples
and DDEIF. The width of the peak was very similar and the tail

MU et al.: NONINVASIVE ESTIMATION OF THE INPUT FUNCTION FOR DYNAMIC MOUSE 1 8 F-FDG MICROPET STUDIES

3109

Fig. 10. Estimation plots of the estimated IF for two sample studies (1 unfasted study + 1 fasted study). (a) and (b) are image-extracted Lv/Myo TACs and
model-fitted Lv/Myo TACs. (c) Comparison of the EIF (the ideal TAC in Lv cavity), the DDEIF and gold standard blood samples.

of the DDEIF coincided well. Fig. 12(a) plots the correlation
between the areas under curves (AUCs) of gold standard IFs and
DDEIFs, with a correlation coefficient of 0.969, and the average
value of AUCE was 7.237% ± 6.742%.
Table IV shows parameters estimated for all 20 datasets as
well as three kinds ofKi . It is noted that the average Ki error between Ki,DDEIF and Ki,GS was 4.910% ± 9.810%, and
10.621% ± 13.121% between Ki,M o del and Ki,GS . The correlation coefficients were 0.992 and 0.970, respectively (see
Fig. 11 (b) and (c) shows this correlation.) The results of the
t-test yielded a p > 0.05, indicating that the differences in the
Ki estimates did not reach a level of statistical significance. All
of these results proved the correctness and effectiveness of the
proposed method.

IV. DISCUSSION
In this paper, we proposed a noninvasive estimation method of
the IF in dynamic mouse 18 F-FDG microPET studies. Comparing with the traditional simultaneous estimations in [1] and [9],
the innovation of our method could be summarized as follows:
1) the incorporation of the orthogonality and scale constraint in
NMF to extract LvTAC and MyoTAC automatically and accurately; 2) the construction of the Bayesian (a priori) term based
on the strong correlation between the liver TAC and the wholeblood TAC at a later time during optimization; 3) the introduction of three self-adaptive weighing factors for optimization;
4) the correction of the partial-volume, spillover, delay and dispersion effects to perform an accurate comparison between EIF
and the gold standard IF. Owing to the aforementioned innovations, we estimated the IF noninvasively and accurately, which
could be helpful in the clinical application of dynamic PET.

The accurate extraction of the tissue TACs is the precondition
of the following fitting process and it affects the estimation
results. In order to analyze the issue clearly, we performed some
additional experiments by fitting the less accurate TACs, which
were constructed by multiplying the accurate TACs extracted
from manually drawn ROIs (standard references) by a series
of error factors (1.05, 1.1, and 1.2), to the objective function
and then acquired the kinetic parameters and DDEIF. When
the errors of TACs were small (the error factor was 1.05), the
average error between Ki,DDEIF and Ki,GS was 7.073% ±
5.844%, and 11.4 ± 21.8% between Ki,M o del and Ki,GS . The
errors are relatively small, which means that small errors of
TACs do not have significant effect on the estimated parameters.
However, when the errors of TACs were larger, e.g., the error
factors were 1.1 and 1.2, the average errors between Ki,DDEIF
and Ki,GS were 11.3% ± 8.69% and 18.0% ± 16.4%, and
the average errors between Ki,M o del and Ki,GS were 12.6 ±
12.0% and 24.2 ± 23.0%. This means the large error of TACs
affects the accuracy of the estimated parameters to a large extent.
Therefore, the accuracy of the tissue TACs is very important in
the estimation process.
Considering that the manual definition of the ROIs is subjective and requires a lot of clinical experience, an automatic
segmentation and extraction method are quite necessary. Many
matrix decomposition-based methods have been proposed in
the segmentation of images, such as the Principal Component
Analysis (PCA) [21] and ICA [22]. However, these methods allow negative entries in the matrix factors W and H, even if the
elements of the initial input matrix element are positive. This
makes the combination of eigenvectors possibly be involved in
a complex cancellation between positive and negative numbers,
which means that many individual eigenvectors lack intuitive
meaning. On the contrary, NMF makes the nonzero elements of

3110

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

TABLE IV
ESTIMATED PARAMETERS AND STANDARD DEVIATION FOR ALL MOUSE STUDIES

Fig. 11. (a) Correlation plot of the AUCs of gold standard IFs versus the DDEIFs (r = 0.969, with AUCE = 7.237% ± 6.742%). (b) Correlation plot of
K i , D D E IF versus K i , G S (r = 0.992, with the average error as 4.910% ± 9.810%). (c) Correlation plot of K i , M o d e l versus K i , G S (r = 0.970, with the average
error as 10.621% ± 13.121%).

W and H all positive with the connectivity constraints, which
leads to the parts-based eigenvectors with intuitive meaning,
for only additive combinations are allowed. Thus, only NMFbased methods were used and compared in the extraction of the
tissue TACs. Based on the traditional NMF method, we added
both an orthogonality constraint and scale constraint to improve
the extraction of TACs in accuracy, which can be seen clearly
in Fig. 9 and Table III, especially for the Lv and Rv. For the
AUCE of the Myo, the two methods seem to have few differences, whereas from the RRMSE and Fig. 9, it is confirmed that
our method generated better segmentation results and thus had

more accurate TACs for Myo. The accuracy and robustness of
the proposed method could also be observed from the CNMF
method which gives localized and part-based probability distribution maps and reasonable TACs in Table III. From Table III,
we can see that CNMF provides TACs automatically with sufficiently small errors to accomplish the fitting process without
affecting the accuracy of the estimated parameters.
In order to simulate the actual process in vivo and apply the
kinetic model accurately, we modeled the TACs of Lv and Myo
by taking the partial-volume and spillover effects between the
two tissues into consideration. The reason why we did not take

MU et al.: NONINVASIVE ESTIMATION OF THE INPUT FUNCTION FOR DYNAMIC MOUSE 1 8 F-FDG MICROPET STUDIES

the effect of Rv into consideration was that we did not get better
results when the effects of Rv were added into the modeling,
possibly due to the introduction of more free variables. Besides,
it increased the complexity and reduced the efficiency during
the estimation.
In our experience, the impact of TACs was less than IF, for the
introduction of mixing coefficients a and b partially eliminated
the effects brought on by the inaccuracy of TACs. The inaccuracy of IF, especially the tail of IF, affected the estimation of the
kinetic parameters to a large extent. In our previous work about
the simultaneous estimation, at least 1 later blood sample was
required in the fitting process to improve accuracy [23]. In this
study, a Bayesian term utilizing the ratios (θ) of the whole-blood
TAC and the liver TAC was constructed instead to calibrate the
EIF. In order to fulfill the completely noninvasive estimation of
the input function, we took the average value and variance of
the ratios θ at multiple time points from five randomly chosen
studies as a priori knowledge to construct the Bayesian term.
After a large number of trials, the use of the five time points [1,
10, 20, 30, and 40 min] produced the most accurate estimation
of the whole-blood TAC. The inclusion of an additional time
point did not improve accuracy, but the removal of any time
point would reduce accuracy.
Furthermore, during the estimation, the choice of ω1 , ω2 , and
ω3 became very important for the estimation. The larger ω1 and
ω2 are, the more accurate the EIF curve is at early time points,
while the larger ω3 is, the more accurate the EIF curve is at a
later time. Therefore, a compromise must be made to get the
best results for the EIF in both the early time and the later time.
For this purpose, we set the adaptive weighing factors during
the estimation. The AUC of the DDEIF and Ki,EIF are not only
highly correlated (correlation coefficients close to 1) to, but also
highly comparable (regression slopes close to 1 and intercepts
close to 0) with the AUC of the gold standard IF and Ki,GS ,
which can be seen in Figs. 10 and 11. Table IV shows that the
Ki,GS and Ki,DDEIF , as well as theKi,GS and Ki,M o del , did not
statistically detect the exception according to the results of the
t-test. All of these show that the DDEIF has a good coincidence
with the gold standard blood samples. Note that Table IV shows
that the error between Ki,M o del and Ki,GS was approximately
10.62%, which was much larger than that between Ki,DDEIF
and Ki,GS . This is partly due to the assumption of k4 = 0 when
calculating Ki,GS and Ki,DDEIF using the Patlak method. In
contrast, the nonlinear least-squares method was used for the
simultaneous estimation on condition of k4 = 0, which can be
seen in column k4 in Table IV. Additionally, in some studies, the
blood samples were so few that solving Ki,GS and Ki,DDEIF
using the Patlak method would generate errors. This may be
another reason for the large errors between Ki,DDEIF and Ki,GS ,
and probably Ki,M o del and Ki,GS .
For the quantitative analysis of dynamic PET images, the 18 FFDG PTAC that measured by frequent blood sampling, is generally required as the input function for the tracer kinetic modeling
technique. This invasive feature greatly limits its clinical application. Our study provides an alternative noninvasive method
to quantify the metabolic rate of glucose and other meaningful
physiological parameters for dynamic 18 F-FDG PET studies.

3111

The calculation of the physiological parameters, especially the
metabolic rate of glucose, could aid the diagnosis of the malignancy, myocardial infarction, and are important for the development of new drug research and development. This could
accelerate the clinical application for the dynamic PET.
V. CONCLUSION
In this paper, we first proposed a new CNMF-based method
to automatically segment dynamic mouse cardiac 18 F-FDG MicroPET images (Lv, Rv, and Myo) while simultaneously extracting their TACs. The proposed CNMF method not only utilizes
tissue specificity, i.e., the time-dependent behavior is the same
inside the same tissue during the whole acquisition, while different tissues behave differently, but also imposes the orthogonality
and scale constraints when applying the CNMF to dynamic PET
images. The orthogonality constraint minimizes redundancy between different tissue maps, and the scale constraint recovers
the original scale of TACs.
Based on the extracted TACs of Lv and Myo, we then proposed a novel noninvasive input function estimation method via
the simultaneous estimation of kinetic model parameters in dynamic mouse 18 F-FDG MicroPET studies. Since it has been reported that liver TAC at a later time is strongly correlated with the
input function, a Bayesian penalty formulation was constructed
and incorporated into the optimization function. The proposed
estimation method also takes the partial-volume, spillover, delay, and dispersion effects into consideration. Experimental results on 20 mouse datasets demonstrated the effectiveness and
robustness of the proposed method.
ACKNOWLEDGMENT
The authors would like to thank W. Mu, Z. Chen, X. Dai who
contributed equally to this studyand wrote the paper together.
X. Dai defined the research theme and designed the methods.
W. Mu designed, carried out the experiments and analyzed the
results.
REFERENCES
[1] Y. H. Fang and R. F. Muzic, Jr., “Spillover and partial-volume correction for image-derived input functions for small-animal 1 8 F-FDG PET
studies,” J. Nucl. Med., vol. 49, pp. 606–14, Apr. 2008.
[2] K. Chen, D. Bandy, E. Reimann, S. C. Huang, M. Lawson, D. Feng,
L. S. Yun, and A. Palant, “Noninvasive quantification of the cerebral
metabolic rate for glucose using positron emission tomography, 1 8 Ffluoro-2-deoxyglucose, the Patlak method, and an image-derived input
function,” J. Cereb. Blood F. Met., vol. 18, pp. 716–723, 1998.
[3] A. P. Van Der Weerd, L. J. Klein, R. Boellaard, C. A. Visser, F. C. Visser,
and A. A. Lammertsma, “Image-derived input functions for determination of MRGlu in cardiac 1 8 F-FDG PET scans,” J. Nucl. Med., vol. 42,
pp. 1622–1629, 2001.
[4] P. T. Meyer, V. Circiumaru, C. A. Cardi, D. H. Thomas, H. Bal, and
P. D. Acton, “Simplified quantification of small animal [18 F]FDG PET
studies using a standard arterial input function,” Eur. J. Nucl. Med., vol. 33,
pp. 948–54, Aug. 2006.
[5] J. Kim, P. Herrero, T. Sharp, R. Laforest, D. J. Rowland, Y. C. Tai,
J. S. Lewis, and M. J. Welch, “Minimally invasive method of determining
blood input function from PET images in rodents,” J. Nucl. Med., vol. 47,
pp. 330–336, Feb. 2006.
[6] K. Chen, X. Chen, R. Renaut, G. E. Alexander, D. Bandy, H. Guo, and
E. M. Reiman, “Characterization of the image-derived carotid artery input
function using independent component analysis for the quantitation of

3112

[7]

[8]

[9]

[10]
[11]
[12]
[13]
[14]
[15]

[16]

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

[18 F] Fluorodeoxyglucose positron emission tomography images,” Phys.
Med. Biol., vol. 52, pp. 7055–7071, Dec. 7, 2007.
J. S. Lee, D. S. Lee, J. Y. Ahn, G. J. Cheon, S. K. Kim, J. S. Yeo, K. Seo,
K. S. Park, J. K. Chung, and M. C. Lee, “Blind separation of cardiac components and extraction of input function from h215 o dynamic myocardial pet using independent component analysis,” J. Nucl. Med., vol. 42,
pp. 938–943, 2001.
K. H. Su, J. S. Lee, J. H. Li, Y. W. Yang, R. S. Liu, and J. C. Chen, “Partial
volume correction of the MicroPET blood input function using ensemble
learning independent component analysis,” Phys. Med. Biol., vol. 54,
pp. 1823–46, Mar. 21, 2009.
G. Z. Ferl, X. Zhang, H. M. Wu, and S. C. Huang, “Estimation of the
1 8 F-FDG input function in mice by use of dynamic small-animal PET
and minimal blood sample data,” J. Nucl. Med., vol. 48, pp. 2037–2045,
2007.
M. N. Tantawy and T. E. Peterson, “Simplified [18 F] FDG image-derived
input function using the left ventricle, liver, and one venous blood sample,”
Mol. Imag., vol. 9, pp. 76–86, 2010.
D. D. Lee and H. S. Seung, “Learning the parts of objects by non-negative
matrix factorization,” Nature, vol. 401, pp. 788–791, Oct. 21, 1999.
C. Ding, T. Li, W. Peng, and H. Park, “Orthogonal nonnegative matrix
t-factorizations for clustering,” in Proc. 12th ACM SIGKDD Int. Conf.
Knowl. Discovery Data Mining, 2006, pp. 126–135.
N. Otsu, “A threshold selection method from gray-level histograms,” Automatica, vol. 11, pp. 285–296, 1975.
D. Garcia, “Robust smoothing of gridded data in one and higher dimensions with missing values,” Comput. Stat. Data Anal., vol. 54, pp. 1167–
1178, Jun. 2012.
D. Feng, S. C. Huang, and X. Wang, “Models for computer simulation
studies of input functions for tracer kinetic modeling with positron emission tomography,” Int. J. Biomed. Comput., vol. 32, pp. 95–110, Mar.
1993.
H. M. Wu, D. Troung, M. C. Kreissl, M. Prins, H. R. Schelbert,
M. E. Phelps, and S. C. Huang, “Mouse plasma and whole blood difference in concentration 2-[18 F] fluoro-2-deoxy-D-glucose (18 F-FDG)
concentration: Implication for quantitative mouse 1 8 F-FDG PET studies,”
J. Nucl. Med., vol. 46, p. 204, 2005.

[17] T. Callegari, A. Caumo, and C. Cobelli, “Generalization of map estimation
in SAAM II: Validation against ADAPT II in a glucose model case study,”
Ann. Biomed. Eng., vol. 30, pp. 961–8, Jul./Aug. 2002.
[18] R. F. Muzic Jr. and S. Cornelius, “COMKAT: Compartment model kinetic
analysis tool,” J. Nucl. Med., vol. 42, pp. 636–645, 2001.
[19] Y. H. Fang, P. Asthana, C. Salinas, H. M. Huang, and R. F. Muzic, Jr.,
“Integrated software environment based on COMKAT for analyzing tracer
pharmacokinetics with molecular imaging,” J. Nucl. Med., vol. 51, pp. 77–
84, Jan. 2010.
[20] S. C. Huang, H. M. Wu, D. Truong, X. Zhang, M. Prins, D. B. Stout,
A. F. Chatziioannou, and H. R. Schelbert, “A public domain dynamic
mouse FDG MicroPET image data set for evaluation and validation of
input function derivation methods,” in Proc. IEEE Nucl. Sci. Conf. Rec.,
2006, pp. 2681–2683.
[21] M. Lopez, J. Ramirez, J. M. Gorriz, D. Salas-Gonzalez, I. Alvarez,
F. Segovia, and C. G. Puntonet, “Automatic tool for Alzheimer’s disease
diagnosis using PCA and Bayesian classification rules,” Electron. Lett.,
vol. 45, pp. 389–390, Apr. 9, 2009.
[22] M. Margadan-Mendez, A. Juslin, S. V. Nesterov, K. Kalliokoski, J. Knuuti,
and U. Ruotsalainen, “ICA based automatic segmentation of dynamic
(H2 O)-O-15 cardiac PET images,” IEEE Trans. Inform. Technol. Biomed.,
vol. 14, pp. 795–802, May 2010.
[23] X. Q. Dai, J. Tian, and Z. Chen, “An input function estimation method for
dynamic mouse F-18-FDG microPET studies,” in Proc. IEEE Nul. Sci.
Symp. Med. Imag. Conf., New York, NY, USA, 2011, pp. 3091–3096.

Authors’ photographs and biographies not available at the time of publication.

