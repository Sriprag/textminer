848

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

Separating Arterial and Venous-Related Components
of Photoplethysmographic Signals for Accurate
Extraction of Oxygen Saturation
and Respiratory Rate
Rasoul Yousefi, Student Member, IEEE, and Mehrdad Nourani, Senior Member, IEEE

Abstract—We propose an algorithm for separating arterial and
venous-related signals using second-order statistics of red and infrared signals in a blind source separation technique. The separated arterial signal is used to compute accurate arterial oxygen
saturation. We have also introduced an algorithm for extracting the
respiratory pattern from the extracted venous-related signal. In addition to real-time monitoring, respiratory rate is also extracted.
Our experimental results from multiple subjects show that the
proposed separation technique is extremely useful for extracting
accurate arterial oxygen saturation and respiratory rate. Specifically, the breathing rate is extracted with average root mean square
deviation of 1.89 and average mean difference of −0.69.
Index Terms—Approximate joint diagonalization, blind source
separation, photoplethysmography, PPG, pulse oximetry, respiratory rate, second-order statistics.

I. INTRODUCTION
A. Background
NE of the main applications of the photoplethysmographic (PPG) biosensors is measuring blood oxygen saturation. The commercial device built based upon this technology
is called pulse oximeter. Pulse oximetry may be used to quantify various blood flow characteristics including arterial oxygen
saturation, the volume of blood pulsation carried to the tissues,
and the heart rate. A pulse oximeter typically uses two lightemitting diodes (LEDs) with wavelengths in red and infrared
(IR) regions, which emit light at the measurement site on body.
A photodetector captures the transmitted or reflected light. The
analog front-end hardware uses a time-multiplexed approach
with three phases: 1) activated red LED, 2) activated IR LED,
and 3) dark phase. A transimpedance amplifier amplifies the
current generated in photodetector due to optical density during
active phases and provides a voltage signal. This signal will be
filtered, amplified, and then sampled with an analog-to-digital
converter for further processing.
At the site of measurement (e.g., finger, ear, forehead, nose),
the tissues slightly expands during each heart beat as blood

O

Manuscript received February 3, 2014; revised May 19, 2014; accepted June
27, 2014. Date of publication July 18, 2014; date of current version May 7,
2015.
The authors are with the Quality of Life Technology Laboratory,
The University of Texas at Dallas, Richardson TX 75080 USA (e-mail:
r.yousefi@utdallas.edu; nourani@utdallas.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2334697

Fig. 1. Different components of the PPG signal coming from arterial blood
flow, venous blood flow, and tissue.

enters via arteries during systole. Then, the site of sensor contracts as blood leaves during diastole. As a result, the path length
of the light will periodically change. Absorption is proportional
to the optical path length according to the Lambert law of optical density [1], [2] and the volume change will be reflected
in photodetector’s output. The light absorbance in the sensor
site has three main components as shown in Fig. 1: 1) a nonpulsatile component originated from nonpulsatile blood, tissue
pigmentation (e.g., skin, bone, muscle), which results in a direct
current (dc) signal in photodetector; 2) a supposedly weaker
signal caused by blood return in veins; and 3) a dominant alternating current (ac) caused by blood volume change in arteries.
In order to extract oxygen saturation using two-wavelength
PPG sensor, parameter R is computed, which represents the
ratio of normalized red signal to normalized IR signal [1]. Light
absorption is a function of the hemoglobin concentration in
blood and “ratio of ratios” technique computes R as an intensityindependent parameter. When R is large, the blood saturation is
low and vice versa. An empirical linear calibration curve relates
the measured R to oxygen saturation where R is mathematically
expressed as
R=

ACR /DCR
.
ACIR /DCIR

(1)

Here, AC and DC are the ac and dc power of the PPG signals and
indices R and IR refer to red and infrared, respectively [1], [2].
The existence of venous component that has the information of
blood return to the heart has been verified with different modalities including imaging-based techniques such as phase-contrast
magnetic resonance angiography. For instance, the authors in
[3] set the noise level in the phase image at a threshold level
above the venous signal but below arterial during systolic period
of cardiac cycle to acquire the arterial signal. The threshold is

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

YOUSEFI AND NOURANI: SEPARATING ARTERIAL AND VENOUS-RELATED COMPONENTS OF PPG SIGNALS

also changed to a value below venous signal and above arterial
signal to suppress arterial signal and capture the venous signal.
Similar to other modalities, the PPG biosensors also capture
blood volume change in veins. The sensor’s output ac current
will be a mixture of arterial and venous signals. Existence of
venous component causes the ac power of the PPG signals to
change, which leads to inaccuracy and false alarms in readings
such as oxygen saturation level. There has been reports from
clinical settings that the venous signal has significant effect on
the shape of PPG signal and the SpO2 readings [4]–[6]. Another
study was done on 25 patients in hospital setting using finger
sensor, forehead, and ear sensors. The study published in [4]
shows that a complex waveform can be created by the prominent
venous component. The power of venous signal also differs in
various sensor sites. This is confirmed by applying pressure
dressing, which weakens the effect of the venous signal on PPG
signal [4].
Updated standards recommend consideration of accurate experimental results on various inaccuracies of PPG sensors [7],
[8]. Based on negative role of venous pulsation on accuracy,
reported in the literature, there is a dire need for algorithms with
two features. First, they should address the inaccuracy issue in
measurements such as SpO2 by extracting the high-quality signal. Second, they should take advantage of venous signal on PPG
for extracting other medically relevant features and information
such as respiration rate.

B. Prior Art
Venous pulsation is one of the sources of inaccuracy in various
applications of PPG sensors such as arterial oxygen saturation.
Researchers have collected clinical data on effect of venous
signal/pulsation on PPG signal or pulse oximetry readings [5],
[9], [10]. The main idea is to observe occurrences of venous
signal/pulsation on PPG signal and understand how it affects the
oxygen saturation readings [11]–[13]. The main experimental
solution suggested and experimented is the control of the amount
of pressure on the sensor during signal acquisition [14]–[16].
In order to address such issues related to venous pulsation,
Nellcor pulse oximetry defines and adjusts a sensitivity level
in [5] for their technology. The sensitivity level is adjusted
based on the sensor type and location of the measurement to
cease display of measurements and the PPG signal and to notify the user. A comparison is also made between current R
value and historical R values. The historical value may include measurement from the same patient or average value
from other subjects. However, in this technology, the prominent venous is detected and the reading is stopped or ignored.
In many applications such as anesthesia during surgery, the
intermittent and temporary changes of the oxygen saturation
need to be monitored in real time and readings cannot be
stopped.
Other view in the literature is to extract information from
venous pulsation of the PPG signal by adding a mechanical
vibrator to the sensing part. The mechanical vibrator basically
works as an actuator that creates an external artificial perturba-

849

tions close to the PPG probe [17]–[19]. This method deploys
a pressure transducer at a first site on a body, applying a drive
signal to the external pressure transducer at a predetermined
frequency, to cause a series of pulsations of a predetermined
magnitude in veins [18], [20], [21]. Then, the blood volume
variations in veins are captured by an optical sensor and used to
estimate venous oxygen saturation.
One of the shortcomings of this technology is that a mechanical pressure pulsation is needed and the pulsation of venous
is artificial. Since this pulsation is artificial (generated by external pressure), it does not provide any insight into the actual
blood return and natural venous functionality. So far, these approaches failed to provide accurate venous oxygen saturation as
the main goal of this technology because even with the artificial
mechanical pulse, the output is a mixture of venous and arterial
signal and it results in a mixed oxygen saturation with limited
accuracy [17]. Also, once a mechanical vibration is used, it
acts itself as an artifact on the original PPG signal and prevents
extracting useful information such as respiration signal, heart
abnormalities, and apneas with PPG sensor. In all such applications, small variations of the PPG signal are quite important for
accurately extracting the relevant metrics. However, in presence
of mechanical vibrations, these variations will be concealed by
mechanical artifacts and the key information may be distorted
or lost.
Another useful application of PPG sensors is extraction of
respiration rate along with oxygen saturation and pulse rate
with a single sensor. Simultaneous monitoring of these three
parameters provides a useful tool for assessment of cardiorespiratory system. Prior art on derivation of respiratory rate from
PPG signal includes techniques based on 1) low-frequency
respiratory-induced intensity variation (RIIV) on the baseline
of the PPG signal, 2) respiratory-induced amplitude variation
(RIAV), and 3) respiratory-induced frequency variation (RIFV).
An automated algorithm based on continuous wavelet transform
is developed in [22]. This approach mainly suffers from lowfrequency artifacts and oscillations on respiratory frequency
band [23]. Wavelet-based approaches identify time–frequency
features associated with patient’s respiration in the wavelet decomposition of the original PPG signal. The authors in [22]
and [24] apply wavelet transform to extract two signals showing amplitude and frequency variations. Amplitude perturbation
signal captures RIIV and frequency perturbation signal captures
RIFV. Other time–frequency techniques are also introduced
to improve spectral estimation for respiration rate extraction
[25], [26].
Methods based on principal component analysis (PCA) [27]
and empirical mode decomposition [28] are also proposed.
These approaches resulted in surrogate respiratory signals having a higher degree of correlation with the originally recorded
respiratory signal by classical methods. To refine their results, a
technique based on multiscale PCA is introduced in [23], which
combines wavelets for time–frequency spectral characterization
with the PCA. In this approach, wavelet of the original PPG signal is extracted to capture RIIV effect on the signal and PCA is
used to reduce the effect of artifact that exist in low-frequency
band.

850

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

C. Key Contribution and Paper Organization
We have previously shown the effect of venous blood movement during motion and developed motion-tolerant algorithms
to address venous blood movement on the PPG signal [29], [30].
In this paper, we propose a novel algorithm that separates the
venous and arterial components from red and IR signals. The
proposed algorithm uses the second-order statistics of venous
and arterial signals to separate them. After reliable separation of
venous and arterial signals, they can be used for different purposes. In this paper, we extract the respiratory signal/rate from
separated venous-related signal and reliable “ratio of ratios” for
SpO2 using only the arterial component of the PPG signals.
This paper is organized as follows. In Section II, an arterial
venous mixing model is introduced. In Section III, first, we
introduce the generic approach of solving the separation problem and, then, we describe proposed algorithm for arterial and
venous-related signal extraction. Next, we explain respiration
signal extraction in Section IV. The experimental setup and
validation of the algorithm are in Section V. The concluding
remarks are presented in Section VI.
II. INSTANTANEOUS ARTERIAL VENOUS (IAV) MIXING MODEL
The operation of PPG biosensors can be described by the
Beer–Lambert law wherein transmitted light, I, resulting from
an incident source light, I0 , traveling through a substance with
concentration c, and path length l at the site of measurement,
can be modeled as
I = I0 e−(λ)cl

(2)

where  is called the extinction coefficient of the absorbance
substance at the site of measurement and is a function of the
wavelength λ. The optical density, A = (λ)cl, is the negative
natural log of the transmitted light I0 to incident light defined for
both scatterer and nonscatterer. The Schuster’s theory of optical
scattering has been applied to pulse oximetry, which provides
more insight to the improvement of the pulse oximeters compared to the Beer–Lambert law which gives a rough estimation
about scatterer [31], [32]. According to new formulation [20],
[31], [32], the optical density changes (ΔA) resulting from arterial blood thickness change, ΔDa is

ΔAa = Ea (Ea + F )Hba ΔDa
(3)
where Ea = Sa Eo + (1 − Sa )Er , F is the scattering coefficient, Eo is the extinction coefficient of oxyhemoglobin, Er is
the extinction coefficient of deoxyhemoglobin, and Sa is the
oxygen saturation rate. When measured in at least two wavelengths, this optical density change can be used to derive parameters such as SpO2 . However, the venous pulsation will be
present in the measured optical density and affect the quality
and reliability of the measurement as we discussed in Section I.
When more than one substance (e.g., vein with variable blood
volume) absorbs light in a medium, the total optical density can
be modeled as


ΔA = Ea (Ea + F )Hba ΔDa + Ev (Ev + F )Hbv ΔDv
(4)

where indices a and v denote artery and vein. Tissue pigmentation including skin, bone, and muscle results in wavelengthindependent fixed absorption, which can be removed or has no
effect on the parameter extraction. To formulate the problem, we
assume that we have a two wavelength PPG sensor producing
two mixed signals xr (n) and xir (n) corresponding to red and
IR LEDs and optical density changes of ΔAr (n) and ΔAir (n),
respectively. xr (n) and xir (n) are both linear combination of
arterial source signal and venous components where the extinction coefficient is different at each wavelength. The observation
signal corresponding to LEDs can be written as
x(n) = A s(n)

(5)

where x(n) = [xr (n) xir (n)]T is sensor’s output corresponding to different wavelengths, s(n) = [sa (n) sv (n)]T is a vector
comprising of arterial signal and venous noise source, and A is
the 2 × 2 mixing matrix.
Every major vessel in the human body has a characteristic
flow pattern that is visible in time-domain signal. These patterns
that are representable in modalities such as spectral waveforms
obtained with the Doppler ultrasonography have been used as
diagnosis tool in current practices [33]. So, there is always a
time coherence and structure in source signals s(n) coming
from vein and artery of the measurement site. This time coherence and structure will be reflected in the second-order statistics
(e.g., autocorrelation) of the source signals and, thus, can be
considered as second-order stationary signal in the time interval
of measurement. In the next section, we use the second-order
statistics of the arterial and venous signals to separate them.
III. ARTERIAL VENOUS SIGNAL SEPARATION
A. Approach
Knowing the linear IVA mixing model of (5), we apply an
unsupervised data analysis technique, Blind Source Separation
(BSS), to process the two-channel recording of PPG signals.
The BSS technique uses observed signals x and the IVA mixing
model in (5) to extract underlying sources of the mixed signals.
Solution to BSS problem is found by approximating the generalized eigenvectors of a set of target matrices representing signal
statistics. So, the BSS of arterial and venous sources can be done
by solving a joint diagonalization problem. Basically, given a
set of k target matrices of size N × N (i.e., C1 , C2 , . . . , Ck ),
the joint diagonalization problem finds a nonsingular matrix V
such that the transformed matrices VCk VT becomes as diagonal as possible for all k values. By suitably defining the target
matrices of the observation x, this approach allows us to efficiently use the time coherence and time structure of arterial and
venous source signals to separate the observed mixture.
Second-order statistics of the source signals that capture the
time structure and coherence of vein and arterial source signals
are used to define the target matrices. As employed in different applications [34], [35], covariance matrices Cτ (x) of the
delayed mixed signals are an appropriate choice for joint diagonalization in BSS. Thus, Cτ (x) is defined as
d

Cτ (x) = E{x(t)x(t + τ )T }

(6)

YOUSEFI AND NOURANI: SEPARATING ARTERIAL AND VENOUS-RELATED COMPONENTS OF PPG SIGNALS

Fig. 2.

851

Dataflow of proposed algorithm for suppression of venous effect and extraction of respiratory information.

and used as target matrices where E is the expectation over t
and τ is a shift in time-domain. Using IAV mixing model, it can
be shown that the covariance of mixed observation signals, x,
is related to covariance of source signals s by

covariance matrix at time lag τ = 0. Prewhitening is applied on
mixed signal vector x(n) to prepare input signals for robust separation. The sensor signals x(n) is processed by the following
transformation:

Cτ (x) = ACτ (s)AT

y(n) = Wx(n)

(7)

where off diagonal cross correlation elements of Cτ (s) are zero
due to lack of correlation among source signals and Cτ (s) can
be assumed to be a diagonal matrix. Hence, mixing matrix A in
the BSS problem can be found by diagonalizing the covariance
matrices Cτ (x) [36]. Assuming A is invertible, this can be
expressed as
Cτ (s) = VCτ (x)VT

(8)

where V diagonalizes all target matrices Cτ (x) simultaneously.
This means that we have converted the problem of venous noise
effect in the PPG signal to a BSS problem. The BSS problem
can be effectively solved by approximate joint diagonalization
(AJD) of time-lagged covariance matrices of mixed PPG observation signal in two red and IR wavelengths. In order to solve
AJD problem, we use a two-stage algorithm called second-order
blind identification (SOBI) that is explained next.
B. Algorithm
The proposed algorithm is shown in Fig. 2. The preprocessing step mainly applies a low-pass filter with cutoff frequency
of 8Hz on both red and IR channels to remove unwanted frequency content of the PPG signals. Then, the SOBI technique
separates signal components. Arterial and venous components
are separated by the SOBI technique but a permutation indeterminacy resolution is needed to label them. In fact, it is not known
that which of the outputs is related to artery and which one to
vein. A permutation ambiguity technique is added to label the
separated components. The postprocessing step uses separated
arterial and venous components to derive arterial oxygen saturation. Any further feature extraction technique on clean PPG
signal can be added in postprocessing step.
SOBI technique capitalizing diagonalization of several covariance matrices introduced and used in literature in different
applications. The first step in this procedure is whitening. The
sensor signals xr (n) and xir (n) are generally mutually correlated and the covariance matrix is a full but not diagonal matrix.
Prewhitening is done by singular value decomposition of the

(9)

and the covariance matrix of zero mean vector y becomes
E{y(n)y(n)T } = WC0 (x)WH = WAAH WH = I2
(10)
where I2 is a unity 2 × 2 matrix as a result of this transformation.
Consequently, for the whitening matrix W, a unitary matrix L
exists such that WA = L and hence
A = W−1 L

(11)

where W−1 is the inverse of W.
Exploiting the time structure of source signals, the unitary
factor L can be obtained from covariance matrices at nonzero
time lags, in other words
Cτ (y) = WCτ (x)WH

(12)

where Cτ (y) is the covariance matrix of y, whitened red and
IR observation signals. Using (7) and (11), we have Cτ (y) =
LCτ (s)LH . This means that L can be obtained as a unitary
diagonalizing matrix Cτ (y) for nonzero lag τ .
SOBI technique uses this fact with a set of lagged covariance
matrices C = [Cτ 1 (y),...,Cτ k (y)] where Cτ i (y)i = 1, ...k is a
covariance matrix of y at lag τi . This technique defines a cost
function
Q(C, V ) =

k


Off(VH Cτ i V)

(13)

i=1

for joint diagonalization of the lagged covariance matrices.
Off(VH Cτ i V) is the summation of square of absolute value
of off diagonal elements in Cτ i . Minimization of cost function
Q leads to AJD of covariance matrices where it uses information
of a set of covariance matrices and, it is not required that all Cτ i ’s
be exactly simultaneously diagonalized. There are different numerically efficient techniques for computation of AJD. Jacobi
technique is generalized for minimization of Q and finding the
unitary matrix L. The generalized Jacobi approach used in our
work computes L using product of given rotations. “Whitening” block in Fig. 2 provides matrix W and AJD block finds the
unitary matrix L for computation of mixing matrix A in (11).

852

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

C. Ambiguity Resolution
The BSS problem is basically a factoring process that factors
the mixed observed signal x into a mixing matrix A and a vector
s. A scalar factor can be exchanged between sa (n) and sv (n)
in s and the corresponding columns of A. This is called scaling
ambiguity, which means that the amplitude of the source signals
is not uniquely defined. In other words, the mixing matrix can
be rewritten as
x = As =

N

j =1

Aj s =

N


(αj Aj ) (1/αj s)

Fig. 3.

Adaptive filter with NLMS update algorithm used in postprocessing.

(14)

j =1

where Aj is the jth column of matrix A. Moreover, this means
that the sign of the sources cannot be derived. Similarly, there
is also a permutation ambiguity meaning that the order of the
sources is not unique. This is because equation
x = AP−1 Ps

(15)

is indistinguishable from (5), where here P is a permutation
matrix.
Our proposed approach results in separation of the arterial
and venous signals with the linear system of the form

s1 (n) = h11 xr (n) + h12 xir (n)
(16)
s2 (n) = h21 xr (n) + h22 xir (n).
where H is a demixing matrix derived from AJD of secondorder statistics. Due to permutation ambiguity, it is not known
which source (s1 or s2 ) is the arterial source. In order to automatically find arterial and venous components after separation,
time-domain characteristics of arterial and venous components
are used. Venous and arterial signals have different time-domain
behaviors, and so the statistical properties of these two signals
are different. We have used kurtosis of s1 and s2 (shown as
Ks1 and Ks2 ) to label them. The arterial signal is more correlated to sinusoidal signal. So, the absolute value of difference
of each source and 1.5 (kurtosis of sinusoidal) is computed,
i.e., δsource = |Ksource − 1.5|. Therefore, the 2 × 2 permutation matrix P is defined to be a unity matrix when δs1 < δs2 ,
and


0 1
P =
(17)
1 0
otherwise.

Fig. 4. Postprocessing for signal monitoring: Extraction of arterial and
venous-related signal from original red and IR signals using separated venous
reference.

In the postprocessing algorithm of Fig. 4, the arterial red and
IR signals will be used for monitoring SpO2 . The venous signal
is filtered with a notch IIR filter to suppress the signal power in
the fundamental frequency of the PPG signal.
The notch filter is an adaptive comb filter tuning the location
of zeros and poles with fundamental frequency (e.g., heart rate)
of the signal. The fundamental frequency is extracted using
an autocorrelation-based technique described in our previous
work [29], [30]. IR signal is used for heart rate calculation due
to its larger signal amplitude and higher signal-to-noise ratio
compared to R signal. The fundamental frequency is used in
transfer function
H(z) =

(1 + αz −1 + z −2 )
,
(1 + ραz −1 + ρ2 z −2 )

(18)

which has two zeros at e±j k ω 0 on the unit circle and two poles
on with the same angle and radii of ρ in the range of 0.95 to
0.995.

D. Postprocessing
The previous step focuses on separating the venous and arterial sources from red and IR input signals and resolving the
ambiguity issue (see Fig. 4). The venous component is now
used as a reference noise source in an adaptive filter to separate
arterial and venous portions of the signal from input red and
IR signals. Adaptive filters use normalized least mean square
(NLMS) algorithm to minimize error power at the output and
update the coefficient of the FIR filter. Order of adaptive filters
are 32 and NLMS is used to consider power variations at the
input. Each adaptive filter in Fig. 4 provides two output signals,
a venous signal, and an arterial signal shown in Fig. 3.

IV. RESPIRATORY SIGNAL EXTRACTION
The venous return/signal (back flow of blood to the heart) is
mainly due to skeletal muscle pump and respiratory pump. When
muscles contracts, one way valves are open and when muscles
relax valves close to prevent back flow of blood. Open valve during muscle contraction is shown in Fig. 5(b). Another main contributing factor in venous return is the respiratory pump, which
causes compression and decompression of veins. As shown in
example of Fig. 5(a), during inhalation, the diaphragm moves
downward that causes a low pressure state in thoracic cavity
and high pressure in abdominal cavity. Hence, the abdominal

YOUSEFI AND NOURANI: SEPARATING ARTERIAL AND VENOUS-RELATED COMPONENTS OF PPG SIGNALS

Fig. 5. Venous return (pulsation) (a) respiratory pump and (b) muscle pump
(Modified from [37]).

Fig. 6. Sample PPG signal and sampling window for respiratory signal extraction.

veins are compressed and blood moves to decompressed thoracic veins and to the right atrium. Pressure reverses during exhalation and valves prevents back flow of the blood. Therefore,
blood flow in veins are affected by respiration and one of the
applications of our successful separation of arterial and venous
signals is extraction of respiratory related information. In this
section, we propose a novel algorithm, which uses respiratoryinduced venous return variations to extract respiratory signal.
After extracting respiratory signal, a correlation-based respiration rate extractor is used to extract the respiration (breathing)
rate.
In order to extract the respiratory signal, we find beat-to-beat
variation of the venous return using a cardiac gating approach
[38]. As shown in Fig. 6, the biphasic activity of cardiac cycle
includes systole and diastole portions. Fig. 7(a) shows different
activities during a cardiac cycle. When the ventricular is not
contracted during diastole, the arterial blood flow and hydrodynamic pressure is minimum. Decreased blood pressure during
diastole results in a weak and low amplitude arterial signal.
During this time duration, the venous return is still in progress
by both respiratory and skeletal muscle pumps. If we look at
the arterial signal as an interference added to the venous signal,
diastole time duration is the interference or noise free portion
of the biphasic cardiac cycle. Therefore, we sample the noise

853

free portion of the extracted venous signal in each cardiac cycle
as shown in Fig. 7(b) and (c) to extract the respiratory signal.
Fig. 7(c) shows active time duration of sampling during a signal cardiac cycle. The experimental results in [39] also show
that the amplitude of diastole has the a stronger correlation with
respiration than the amplitude of systole. During this sampling
window, the venous pressure changes rapidly to its maximum
value while the arterial signal has a low amplitude. Respiration
changes the morphological features of this upward back flow
of the blood return including maximum signal value in point
“a.” Fig. 7(b) shows the sampling window of interest during
consecutive cardiac cycles. Therefore, we need an algorithm to
find the active sampling window in each cardiac cycle.
Fig. 8 shows the algorithm proposed for cardiac gating of
extracted venous signal and extracting respiratory signal. In
this algorithm, the first derivative of the original red signal
and extracted red venous signal are taken. Then, we create a
square window signal whose value is 1 during diastole and zero
elsewhere. The window is created as follows: If the first-order
derivative of the original red signal is greater than zero, then the
window signal takes zero value. Otherwise, it remains one. This
operation makes the starting point of the PPG signal up to peak
systolic points of the window zero in each cardiac cycle (see
Fig. 6). Next, if the first-order derivative of the venous signal is
less than zero, the corresponding window value becomes zero.
This operation will remove the time duration between systolic
peak and diastolic peak pressures shown in Fig. 6. After creating
time-domain window, which implements the cardiac gating approach, the window is multiplied with the first-order derivative
of venous signal. Then, in each beat cycle and during diastole,
the peak finder finds the maximum amplitude of the windowed
first-order derivative venous signal. The peak value of the windowed first-order derivative venous signal will change as the
respiratory pump changes the venous return in every beat cycle.
Sampling rate of the extracted respiratory induced venous return
variations is lower compared to original signal. In fact, there is
one sample per cardiac cycle; hence, a spline interpolator is used
to interpolate the extracted variation and build the respiratory
signal. The interpolation factor is 20 and a bandpass filter limits
the interpolated signal to 0.08 to 0.7 Hz.
V. EXPERIMENTAL RESULTS
An experimental platform is developed using finger and forehead probes with red and IR LEDs. Analog conditioning circuit
limits the bandwidth of the signal to 70 Hz, and data are acquired
with sampling rate of 150 Hz using a TMS320C5515 processor
by Texas Instrument. The proposed algorithm removes the venous component from red and IR signals and provides arterial
red and arterial IR signals. So, the ratio of red to IR signal is
computed using arterial signals by (1). After extraction of ratio
R an empirical calibration curve is used to compute the arterial
oxygen saturation level SpO2 . Experimentation is done on male
and female healthy subjects from 21 to 59 years old. Data are
collected in sitting position to prevent noisy data due to motion
artifacts.

854

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

Fig. 7. Cardiac gating approach for respiratory signal extraction from extracted venous signal and position of window with respect to arterial pressure, heart
function, and ECG signal.

Fig. 8.

Respiratory signal extraction using cardiac gated venous return signal.

A. Venous Effect on SpO2 Measurement

Fig. 9. Variance of error in “ratio of ratios” due to respiratory induced venous
return changes.

Prominent venous component can cause inaccurate SpO2
readings and the power of venous component varies in different locations of the body. So, venous effect is location sensitive and for example forehead sensors are shown to be more
sensitive to venous signal/return. Also, for the same site of measurement, the power of venous component may change over
time depending on volume of blood return due motion, respiration, etc. The proven cause of venous return change are skeletal muscle pumping and respiratory pumping as discussed in
Section IV. Therefore, in order to change venous return and see
the effect of venous return/signal changes on the “ratio of ratios”
(i.e., SpO2 ), we can either change the respiratory pump component or skeletal muscle pump. Skeletal muscle pumping can
be changed by motion or exercise. Rate of flow through exercising skeletal muscles can be 15 to 20 times greater than resting
muscles. Despite dramatic change of venous return/signal during exercise, the motion artifact significantly reduces the signal
quality and changes will be buried in noise. Therefore, the effect of such changes on “ratio of ratios” or related SpO2 cannot
be easily studied. Hence, we focused on respiratory pump and
designed an experimentation to validate our algorithm in terms
of removal of venous related inaccuracies in “ratio of ratios”

YOUSEFI AND NOURANI: SEPARATING ARTERIAL AND VENOUS-RELATED COMPONENTS OF PPG SIGNALS

855

TABLE I
VARIANCE OF RATIO DIFFERENCE BETWEEN FOREHEAD AND FINGER SENSOR
Method/Subject
Standard
Our Algorithm

M-32

M-44

M-50

F-29

M-29

M-21

M-31

F-50

M-59

F-41

F-29

M-25

Average

0.003
0.020
0.040
0.017
0.032
0.086
0.008
0.019
0.0235
0.035
0.078
0.053
0.04
2.0e − 5 1.07e − 4 1.3e − 4 7.23e − 5 4.5e − 4 3.53e − 4 7.12e − 5 5.4e − 5 4.34e − 5 1.81e − 4 3.42e − 5 0.51e − 4 1.3e − 4

TABLE II
COMPARISON OF “RATIO OF RATIOS” WITH REFERENCE SENSOR
Subject

1

2

3

4

5

Average

RMSD

0.001

0.003

0.010

0.007

0.015

0.0072

measurement. Data are collected from 12 subjects from both
a finger sensor and a forehead sensor simultaneously. Twenty
minutes of data are collected from each subject. In order to
change venous return, we basically ask subjects to change respiration rate over time in a wide range. Fig. 9 shows the pattern
of respiratory rate changes over the course of our experiment
for one of the subjects and corresponding variance of difference
between reading from forehead and finger sensors. In Fig. 9,
variance of error between forehead and finger “ratio of ratios”
is computed every 26 s of recording. The variance of the error is
much less for our algorithm which means that despite changes
in venous signal due to respiration, our algorithm gives similar
readings at the output.
Table I summarizes the variance of difference between readings using our algorithm and standard “ratio of ratios” on original PPG signal for all subjects. Since proposed algorithm separates the arterial component and the ratio is computed based
on arterial component, it significantly reduces the error between
forehead and finger sensors. Two-sample Kolmogorov–Smirnov
statistical test is performed on measurement results and it rejects
the null hypothesis at the 5% significance level with p-value of
1.3e-5. It should be noted that this is a controlled breathing
exercise so the actual accuracy is higher than what we would
anticipate under spontaneous circumstances.
To validate computation of “ratio of ratios” using extracted
arterial signal, we have collected data from five healthy subjects
with a commercial sensor analog front-end from Nonin Medical
and our sensor on right and left index fingers, respectively. Data
are collected for 15 min from each subject. The assumption is
that venous pulsation is weak on index finger for computation of
oxygen saturation. “ratio of ratios” is calculated on original PPG
signal from commercial sensor and extracted arterial signal in
our system. The error between two systems is shown in Table II.
The average root mean square deviation (RMSD) of error is
small in all cases and our experimental results show that both
systems result in the same “ratio of ratios” on a site with weak
venous signal for oxygen saturation calculation.
B. Extracting Respiratory Information
The proposed algorithm extracts the venous signal and can
be employed to provide other features related to venous signal. In this paper, we have focused on extraction of respiratory

Fig. 10.
signal.

Autocorrelation-based respiration rate extraction from respiratory

signal. Here, we extracted respiration rate (number of breaths
per minute) from the respiratory signal. Fig. 10 shows the algorithm for respiration rate extraction.
The correlation-based respiration rate extractor works similar
to our heart rate extractor [29], [30]. After computing the autocorrelation function in the lag range corresponding to human
respiration rate, the first dominant peak of the autocorrelation
function is found. Dividing the fundamental period corresponding to the first peak by interpolation factor gives us the number
of heart beats (cardiac cycles) in a single respiratory cycle (inspiration and expiration). Dividing the heart rate per minute by
number of beats per respiratory cycle gives us the breathing rate
per minute.
In this experimentation, data are collected from 12 subjects.
Each subject wore the finger sensor and the PPG signals are
captured for 20 min. Simultaneously, the respiration rate is monitored and recorded using a commercial nasal thermistor. The
algorithm reports the breathing rate every 7 s based on the last
20 s of the collected red and IR signals. When compared with
the reference sensor, the algorithm uses a controlled breathing
pattern that covers a wide range of respiratory rate from 5 to
35 beats/min. Fig. 11 shows an example of the mixed arterialvenous PPG signal with a moderate venous effect. Extreme examples from clinical data can be found in [16]. Separated arterial
and venous-related signals are also shown. Feature signal shown
in Fig. 11 is the first-order derivative of the venous-related signal
which is windowed by our algorithm of Fig. 8. The RIAVs on
the peaks of this signal shown by circle is used to generate the
respiratory feature signal. After interpolation and filtering of the
feature signal, respiratory signal will be generated and provided
to the algorithm of Fig. 10 for breathing rate extraction.
Accuracy of the breathing rate extraction algorithm is summarized in Table III. RMSD measure of difference between
calculated and reference respiration rates, is 1.89 breaths per
minute and average standard deviation is 1.54. The average
mean of difference (Diff. Mean) and mean of absolute value of
difference (Abs. Diff. Mean) for 12 subjects are −0.69 and 1.26
breaths per minutes, respectively. Two-sample Kolmogorov–
Smirnov statistical test on measurement results rejects the null
hypothesis at the 5% significance level with p-value of 2.8e-11.

856

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

Fig. 11. Example of mixed arterial-venous PPG signal, separated arterial signal, separated venous-related signal and RIAVs extracted from venous-related signal
(Feature signal).

TABLE III
BREATHING RATE ACCURACY
Parameter/Subject

M-32

M-44

M-50

F-29

M-29

M-21

M-31

F-50

M-59

F-41

F-29

M-25

Average

RMSD
Diff. Mean
Abs. Diff. Mean
Std. Dev.

0.87
−0.28
0.65
0.82

2.03
−0.56
1.32
1.95

1.87
−0.35
0.79
1.12

2.05
−1.27
1.65
1.6

1.54
−0.83
1.08
1.29

2.06
0.12
1.43
2.05

2.45
−1.26
1.57
2.10

1.17
0.61
0.92
1.00

2.66
−1.89
1.95
1.87

2.17
−1.27
1.38
1.76

2.35
−0.97
1.24
1.36

1.56
−0.30
1.23
1.53

1.89
−0.69
1.26
1.54

The experimental results show that first, the separated venous
component has the respiratory pump and respiratory induced
venous return variation. Second, the respiratory signal can be
successfully extracted from the separated venous signal, and
finally, the respiration rate can be successfully computed from
the respiratory waveform.
Compared to the previous works on respiration rate extraction, our algorithm uses RIAV on an extracted secondary signal and venous-related signal using second-order statistics BSS
technique. RIAV is more tolerant to low-frequency noise and
oscillations because the variations modulate the amplitude of
the signal at higher frequencies (i.e., fundamental frequency
associated with human heart rate and its harmonics). Also, extraction of the respiratory variations from diastole portion of
venous-related signal and taking time derivative magnify the
hidden respiratory variations that exist in a raw PPG signal.
VI. CONCLUSION
In this paper, we proposed techniques to address venous
signal/pulsation. Specifically, the proposed algorithm separates
arterial and venous signal in photoplethysmography based on
second-order statistics. Separation of arterial and venous signals
has several potential applications including accurate extraction
of arterial oxygen saturation and breathing rate and pattern. As
one of the applications of our venous arterial separation algorithm, we also proposed an algorithm to extract the respiratory

signal from the separated venous signal and provide the breathing rate for monitoring purposes. The experimental results show
that compared to standard technique the variance of difference
between forehead and finger sensor is negligible. This enables
us to have a measurement site independent accurate arterial
oxygen saturation monitoring. The experimental results shows
that on average the respiration rate can be computed with 1.89
RMSD compared to commercial available technologies.
REFERENCES
[1] J. G. Webster, Design of Pulse Oximeters. New York, NY, USA: Taylor &
Francis, 1997.
[2] J. E. Sinex, “Pulse oximetry: Principles and limitations,” Amer. J. Emergency Med., vol. 17, no. 1, pp. 59–66, 1999.
[3] T. K. F. Foo and V. B. Ho, “Method and system for acquisition of preferential arterial and venous images for MR angiography,” U.S. Patent
6 246 897 B1, Jun. 12, 2001.
[4] H. M. Sami, B. S. Kleinman, and V. A. Lonchyna, “Central venous pulsations associated with a falsely low oxygen saturation measured by pulse
oximetry,” J. Clin. Monit., vol. 7, no. 4pp. 309–312, 1991.
[5] K. H. Shelley, M. Dickstein, and S. M. Shulman, “The detection of peripheral venous pulsation using the pulse oximeter as a plethysmograph,”
J. Clin. Monit., vol. 9, no. 4, pp. 283–287, 1993.
[6] C. R. Baker and P. Manneheimer, “Systems and methods for detection of
venous pulsation,” U.S. Patent 8 229 530 B2, Jul. 24, 2012.
[7] International Organization for Standardization, “Particular requirements
for basic safety and essential performance of pulse oximeter equipment,”
ISO 80601-2-61, 2011. Available: http://www.iso.org
[8] Food and Drug Administration, “Pulse Oximeters-Premarket Notification
Submissions [510(k)s] Guidance for Industry and Food and Drug Administration Staff,” 2013.

YOUSEFI AND NOURANI: SEPARATING ARTERIAL AND VENOUS-RELATED COMPONENTS OF PPG SIGNALS

[9] A. Casati, G. Squicciarini, M. Baciarello, M. Putzu, A. Salvadori, and
G. Fanelli, “Forehead reflectance oximetry: A clinical comparison with
conventional digit sensors during laparotomic and laparoscopic abdominal
surgery,” J. Clin. Monit. Comput., vol. 21, no. 5, pp. 271–276, 2007.
[10] H. A. Smithline, N. Rudnitzky, S. Macomber, and F. S. J. Blank, “Pulse
oximetry using a disposable finger sensor placed on the forehead in hypoxic patients,” J. Emergency Med., vol. 39, no. 1, pp. 121–125, 2010.
[11] J. E. Cooke and J. E. Scharf, “Forehead pulse oximetry in the trendelenburg
position,” Anesthesiology, vol. 101, p. A-583, 2004.
[12] R. D. Branson and P. D. Mannheimer, “Forehead oximetry in critically
ill patients: The case for a new monitoring site,” Respir. Care Clin. North
Amer., vol. 10, pp. 359–367, 2004.
[13] M. Fernandez, K. Burns, B. Calhoun, S. George, B. Martin, and C. Weaver,
“Evaluation of a new pulse oximeter sensor,” Amer. J. Crit. Care., vol. 16,
no. 2, pp. 146–152, 2004.
[14] P. D. Mannheimer, M. P. O’Neil, and E. Konecny, “The influence of larger
subcutaneous blood vessels on pulse oximetry,” J. Clin. Monit. Comput.,
vol. 18, pp. 179–188, 2004.
[15] G. S. Agashe, J. Coakley, and P. D. Mannheimer, “Forehead pulse oximetry: Headband use helps alleviate false low readings likely related to
venous pulsation artifact,” J. Anesthesiol., vol. 105, pp. 1111–1116, 2006.
[16] K. H. Shelley, D. Tamai, D. Jablonka, M. Gesquiere, R. G. Stout, and
D. G. Silverman, “The effect of venous pulsation on the forehead pulse
oximeter wave form as a possible source of error in SpO2 calculation,”
J. Anesthesia Analgesia, vol. 100, pp. 743–747, 2005.
[17] G. Cloete, P. R. Fourie, and C. Scheffer, “Development and testing of an
artificial arterial and venous pulse oximeter,” in Proc. IEEE 35th Annu.
Int. Conf. Eng. Med. Biol. Soc., 2013, pp. 4042–4045.
[18] A. S. Echiadis, V. P. Crabtree, J. Bence, L. Hadjinikolaou, C. Alexiou, T. J.
Spyt, and S. Hu, “Non-invasive measurement of peripheral venous oxygen
saturation using a new venous oximetry method: Evaluation during bypass
in heart surgery,” Physiol. Meas., vol. 28, no. 8, pp. 897–911, 2007.
[19] P. Shaltis and H. H. Asada, “Monitoring of venous oxygen saturation using a novel vibratory oximetry sensor,” in Proc. 2nd Joint 24th Annu.
Conf. Eng. Med. Biol. Annu. Fall Meeting Biomed. Eng. Soc., 2002,
vol. 2, pp. 1722–1723.
[20] T. Aoyagi and K. Miyasaka, “Pulse oximetry: Its invention, contribution
to medicine, and future tasks,” Anesthesia Analgesia, vol. 94, pp. 51–53,
2002.
[21] D. Chan, M. Hayes, and P. R. Smith, “Venous Pulse Oximetry,” World
Patent, WO 03/063 697, Aug. 2003.
[22] P. A. Leonard, J. G. Douglas, N. R. Grubb, D. Clifton, P. S. Addison,
and J. N. Watson, “A fully automated algorithm for the determination of
respiratory rate from the photoplethysmogram,” J. Clin. Monit. Comput.,
vol. 20, no. 1 pp. 33–36, Feb. 2006.
[23] K. V. Madhav, M. R. Ram, E. H. Krishna, N. R. Komalla, and K. A. Reddy,
“Robust extraction of respiratory activity from PPG signals using modified
MSPCA,” IEEE Trans. Instrum. Meas., vol. 62, no. 5. pp. 1094–1106, May
2013.
[24] P. S. Addison and J. N. Watson, “Secondary wavelet feature decoupling
(SWFD) and its use in detecting patient respiration from the photoplethysmogram,” in Proc. IEEE Int. Conf. Eng. Med. Biol. Soc., Sep. 2003,
vol. 3, pp. 2602–2605.
[25] K. Chon, S. Dash, and J. Kihwan, “Estimation of respiratory rate from photoplethysmogram data using time-Frequency spectral estimation,” IEEE
Trans. Biomed. Eng., vol. 56, no. 8 pp. 2054–2063, Aug. 2009.
[26] A. Garde, W. Karlen, J. Ansermino, and G. Dumont, “Estimating respiratory and heart rates from the correntropy spectral density of the photoplethysmogram,” PLoS One, vol. 9, no. 1 pp. e86427.1–e86427.11, Jan.
2014.
[27] K. V. Madhav, M. R. Ram, E. H. Krishna, K. A. Reddy, and K. N.
Reddy, “Estimation of respiration rate from principle components of photoplethysmographic signals,” in Proc. 2010 IEEE EMBS Conf. Biomed.
Eng. Sci., Dec. 2010, pp. 311–314.
[28] K. V. Madhav, M. R. Ram, E. H. Krishna, K. N. Reddy, and K. A.
Reddy, “Estimation of respiratory rate from ECG, BP and PPG signals
using empirical mode decomposition,” in Proc. 28th IEEE Instrum. Meas.
Technol. Conf., May 2011, pp. 1611–1664.
[29] R. Yousefi, M. Nourani, S. Ostadabbas, and I. Panahi, “A motiontolerant adaptive algorithm for wearable photoplethysmographic biosensors,” IEEE J. Biomed. Health Informat., vol. 18, no. 2 pp. 670–681, Mar.
2014.

857

[30] R. Yousefi, M. Nourani, and I. Panahi, “Adaptive cancellation of motion
artifact in wearable biosensors,” in Proc. IEEE Annu. Int. Conf. Eng. Med.
Biol. Soc., 2012, pp. 2004–2008.
[31] T. Aoyagi, M. Fuse, N. Kobayashi, K. Machida, and K. Miyasaka, “Multiwavelength pulse oximetry: Theory for the future,” Anesthesia Analgesia,
vol. 105, no. 6, pp. S53–S58, 2007.
[32] T. Aoyagi, “Pulse oximetry: Its invention, theory, and future,” J. Anesthesia, vol. 17, no. 4, pp. 259–266, 2003.
[33] M. M. Wood, L. E. Romine, Y. K. Lee, K. M. Richman, M. K. O’Boyle,
D. A. Paz, P. K. Chu, and D. H. Pretorius, “Spectral doppler signature
waveforms in ultrasonography: A review of normal and abnormal waveforms,” Ultrasound Quaterly, vol. 26, no. 2, pp. 83–99, 2010.
[34] A. Belouchrani, A. Abed-Meraim, J. F. Cardoso, and E. Moulines, “A
blind source separation technique using second-order statistics,” IEEE
Trans. Signal Process., vol. 45, no. 2 pp. 434–444, Feb. 1997.
[35] M. Wax, and J. Sheinvald, “A least-squares approach to joint diagonalization,” IEEE Signal Process. Lett., vol. 4, no. 2. pp. 52–53, Feb. 1997.
[36] F. J. Theis, and Y. Inouye, “On the use of joint diagonalization in blind
signal processing,” in Proc. IEEE Int. Symp. Circuits Syst., May 2006,
pp. 3586–3589.
[37] G. J. Tortora and B. H. Derrickson, Principles of Anatomy and Physiology.
New York, NY, USA: Wiley, 2011.
[38] B. Desjardins and E. A. Kazerooni, “ECG-gated cardiac CT,” Amer. J.
Roentgenol., vol. 182, no. 4. pp. 993–1010, 2014.
[39] J. Li, J. Jin, X. Chen, W. Sun, and P. Guo, “Comparison of respiratoryinduced variations in photoplethysmographic signals,” vol. 3, no. 31.
pp. 415–425, 2010.

Rasoul Yousefi (S’11) received the B.S. degree in
electrical engineering from Shiraz University, Shiraz, Iran, and the M.Sc. degree in circuits and systems from the University of Tehran, Tehran, Iran,
in 2006 and 2009, respectively. In 2014, he graduated from the University of Texas at Dallas, Dallas,
TX, USA, with a Doctoral degree in electrical
engineering.
Since 2010, as a member of SoC Design and Test
laboratory and Quality of Life Technology laboratory, University of Texas, he has been working on
biomedical signal processing for wearable sensors and systems and processing
algorithms for monitoring and prevention of pressure ulcers. His research interest includes digital circuits and systems and signal processing.

Mehrdad Nourani (SM’05) received the B.Sc. and
M.Sc. degree in electrical engineering from the University of Tehran, Tehran, Iran, and the Ph.D. degree
in computer engineering from Case Western Reserve
University, Cleveland, OH, USA.
He is currently a Professor of electrical engineering, The University of Texas, Dallas, TX, USA. He
is a Cofounder of the Quality of Life Technology
(QoLT) laboratory, The University of Texas, where he
conducts an interdisciplinary research lab focused on
developing innovative technology and systems that
improve peoples’ quality of life. He has published more than 200 papers in journals and refereed conference proceedings. His current research interests include
fault-tolerant architectures, system-on-chip testing, design for reliability, and
special-purpose IC system design for biomedical/biological applications.
Dr. Nourani received multiple awards from Clark Foundation Research Initiation Grant, National Science Foundation Career, Cisco Systems Inc., and
Semiconductor Research Corporation.

