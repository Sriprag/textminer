IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

1535

Analysis of Transcranial Magnetic Stimulation Based
on the Surface Integral Equation Formulation
Mario Cvetković∗ , Student Member, IEEE, Dragan Poljak, Senior Member, IEEE, and Jens Haueisen, Member, IEEE

Abstract— Goal: The aim of this paper is to provide a rigorous
model and, hence, a more accurate description of the transcranial
magnetic stimulation (TMS) induced fields and currents, respectively, by taking into account the inductive and capacitive effects,
as well as the propagation effects, often being neglected when using quasi-static approximation. Methods: The formulation is based
on the surface integral equation (SIE) approach. The model of a
lossy homogeneous brain has been derived from the equivalence
theorem and using the appropriate boundary conditions for the
electric field. The numerical solution of the SIE has been carried
out using the method of moments. Results: Numerical results for
the induced electric field, electric current density, and the magnetic flux density distribution inside the human brain, presented
for three typical TMS coils, are in a good agreement with some
previous analysis as well as to the results obtained by analytical
approach. Conclusion: The future work should be related to the
development of a more detailed geometrical model of the human
brain that will take into account complex cortical columnar structures, as well as some additional brain tissues. Significance: To the
best of authors knowledge, similar approach in modeling TMS has
not been previously reported, albeit integral equation methods are
seeing a revival in computational electromagnetics community.
Index Terms—Electromagnetic model, numerical solution, surface integral equation (SIE) approach, transcranial magnetic stimulation (TMS).

I. INTRODUCTION
RANSCRANIAL magnetic stimulation (TMS) is a noninvasive and painless technique for stimulation or inhibition
of certain brain regions. A stimulation coil placed near the surface of a patient’s head is energized by a very short current pulse,
generating the time-varying magnetic field of high intensity penetrating into nearby tissues such as skull and brain. According
to the differential form of Faraday’s law, the time-varying magnetic field induces an electric field, thus depolarizing or hyperpolarizing the neuronal cell membranes located within a few
centimeters of the cortex. When the membrane potential reaches
certain threshold value, the action potential is generated. Macroscopically, brain activation occurs in the regions with the highest
values of the induced electric field [1]–[4].

T

Manuscript received April 4, 2014; revised January 9, 2015; accepted January
10, 2015. Date of publication January 16, 2015; date of current version May 18,
2015. Asterisk indicates corresponding author.
* M. Cvetković is with the Faculty of Electrical Engineering, Mechanical
Engineering, and Naval Architecture, University of Split, 21000 Split, Croatia (e-mail: mcvetkov@fesb.hr).
D. Poljak is with the Faculty of Electrical Engineering, Mechanical Engineering, and Naval Architecture, University of Split.
J. Haueisen is with the Institute of Biomedical Engineering and Informatics,
Ilmenau University of Technology, and the Biomagnetic Centre, Jena University
Hospital.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2393557

Although the technology necessary for the TMS development
has been known for some time, the technique obtained a huge
impetus in 1985, today considered as the birth year of TMS,
when Barker et al. [5] from the University of Sheffield demonstrated the first stimulation of spinal cord having also arrived
to the idea of direct and noninvasive stimulation of brain. From
those days on, the basic technique for magnetic stimulation
practically has remained almost the same. A few years later, the
group led by Ueno showed [6], [7] that the localized stimulation
of the brain could be achieved by using a pair of coils, thus the
figure-of-eight coil (8-coil) was introduced.
During the following thirty years, TMS has become a valuable tool in not only the study of specific cortex areas but also
in diagnostics and for therapeutic purposes. In addition to the
treatment of depression, which is so far the most commonly
studied application of TMS, this technique can be applied in
various other neurological and psychiatric disorders.
Although TMS is a widely used technique, much more research is needed on the distribution of the electromagnetic fields
induced in the human brain. Modeling of brain stimulation is
important for determining the exact location and the level of
stimulation, as well as to clarify the related underlying mechanisms. The modeling is also helpful in the interpretation of the
experimental results and in the design of a new, more efficient
stimulation systems, such as multicoil designs for focused and
deep brain stimulation [8]–[10].
There were many attempts to develop brain models, varying
in complexity from homogeneous spherical ones [11], [12], to
a more recent realistic three-dimensional (3-D) models using a
number of various tissues [13]–[15].
The advantage of simple canonical models is the available
analytical solution [11], [16], thus making them useful for initial assessment of the distribution of the induced field. For more
realistic representations, the solution can be attained using numerical methods.
Regarding the formulation of the problem, there are approaches based on the differential and integral equation, respectively. From the early days, the differential approach has
become the method of choice in the mathematical formulation
of the problems related to the determination of induced electric fields inside biological tissues, and TMS modeling is no
exception.
One of the drawbacks of the differential equation approach is
a need for the entire domain discretization. In case of an open
boundary problems, such as radiation and scattering, one needs
to artificially limit the boundary of the problem or use concepts such as infinite elements, absorbing boundary conditions,
etc. On the other hand, integral equation-based formulations require only discretization of the boundary, allowing an additional

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1536

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

benefit of reducing the dimensionality of the problem. Furthermore, since boundary conditions are implicit within the integral
formulation, open boundary problems are treated in an exact
way.
In recent decades, integral equation-based approach is seeing
a revival in computational electromagnetics community [17].
There is some reported work where the TMS problem is treated
by the boundary element method [14], [18]. Nevertheless, an
application of surface integral equation (SIE) analysis methods
to TMS has not been reported in the relevant available literature.
The development of a rigorous TMS model using the integral
equations would, thus, provide a means for an alternative more
accurate physical description of the problem.
Since electromagnetic fields related to TMS are of low frequency, the so called quasi-static approximation is frequently
used. Under quasi-static approximation, usually some of the assumptions are adopted, usually these being either the neglection
of the inductive or the capacitive effects, as well as the propagation effects, thus allowing simplification of the expressions
used for determining induced field and currents. Although the
approximation is valid for low frequencies, as originally formulated in [19], the frequency spectrum of modern stimulators
frequently exceeds 1 kHz.
Many authors eventually showed that the approximation is
inappropriate at higher frequencies, i.e., propagation effects at
very high values [20] of tissues permittivity [21], [22], as well as
capacitive effects [23] are no longer negligible, and their exclusion could lead to an incorrect determination of the stimulated
area [24]–[26].
Nevertheless, the majority of the present methods use quasistatic approximation in determining the distribution of TMS
induced electric fields and electric currents in the human brain
[6], [11], [13]–[16], [20], [27]–[33].
This paper presents a rigorous integral equation-based model
of TMS that will enable a more accurate physical description of
the problem, thus, avoiding the use of quasi-static approximation. This paper is organized as follows: Derivation of an electromagnetic model using the equivalence theorem and appropriate
boundary conditions is carried out in the first part. Furthermore, the numerical method based on the scheme of method of
moments (MoMs) is presented, followed by the related numerical solution of the coupled set of electric field integral equations
(EFIEs). The numerical results obtained via the proposed model
are presented for three typical TMS coils. The final part of this
paper gives a brief discussion and a conclusion containing some
suggestions for a future work. This paper could be viewed as
an opener to the subject regarding the integral equation-based
approach in modeling bioelectromagnetics phenomena.
II. METHODS
A. Formulation
If the problem of the human brain exposed to TMS coil is
approached as a classical scattering problem, the equivalence
theorem and the appropriate boundary conditions for the electric and/or magnetic field can be used for derivation of the
electromagnetic model based on the SIE.

To apply the equivalence theorem, the human brain is first
replaced by an arbitrarily-shaped dielectric body S of a homogeneous properties (ε1 , μ1 ), placed in free space, as shown in
Fig. 1(a).
As the present study represents the first implementation of
the proposed model, to facilitate the solution process, we consider a brain compartment model only and neglect the skull and
scalp because the majority of the current is flowing inside the
skull [34].
To account for inductive and capacitive effects, the brain is
considered as a lossy material with complex permittivity and
permeability (ε2 , μ2 ). Due to the fact that biological tissues do
not possess magnetic properties, the value for the permeability
of the brain is taken to be μ0 , i.e., the free space permeability,
while the complex permittivity of the brain is given by
ε 2 = ε0 ε r − j

σ
ω

(1)

where ε0 is the permittivity of the free space, εr is the relative
permittivity, σ is the electrical conductivity of the brain, and
ω = 2πf is the operating frequency.
 inc ) is incident on the lossy
 inc , H
The electromagnetic field (E
homogeneous object representing the brain. Due to the presence
of the scattering object, i.e., brain, a scattered field denoted by
 sca ) is also present. The fields exterior and interior to the
 sca , H
(E
 1 ) and (E
2, H
 2 ), respectively.
1, H
surface S of the object are (E
Also, on the surface S, unit vector n̂ is placed, pointing from
region 2 into region 1, as seen in Fig. 1.
Applying the equivalence theorem for regions 1 and 2, two
equivalent problems can be formulated, in terms of the equiv placed
alent electric and magnetic current densities J and M
on the surface S [17], [35]–[37]. These equivalent problems are
shown in Fig. 1(b) and (c), for the external and internal region,
respectively.
In the case of an external equivalent problem, shown in
2 =
 2 = 0, H
Fig. 1(b), the field inside is assumed to be zero, (E
0), so that material properties of this region could be chosen
arbitrarily. Selecting the same properties as that of an exterior
region, leads to the homogeneous domain of (ε1 , μ1 ), allowing
one to use the Green’s function for free space. To satisfy the
boundary conditions on the surface S, equivalent surface cur 1 are introduced at this surface. Following the
rents J1 and M
same procedure for the interior equivalent problem, another homogeneous domain with properties (ε2 , μ2 ) is obtained. Again,
 2 = −M
 1 are
the equivalent surface currents J2 = −J1 and M
introduced to the surface S, as indicated in Fig. 1(c).
Since the obtained equivalent problems represent equivalent
current densities radiating in a homogeneous medium, the following expressions for the scattered fields due to these sources
can be used
 sca (J,
 M
 ) = −jω A
 i − ∇ϕi − 1 ∇ × Fi
E
i
εi
 isca (J,
 M
 ) = −jω Fi − ∇ψi + 1 ∇ × A
i
H
μi

(2)
(3)

CVETKOVIĆ et al.: ANALYSIS OF TRANSCRANIAL MAGNETIC STIMULATION BASED ON THE SURFACE INTEGRAL EQUATION

1537

 in c , H
 in c ) of a TMS coil. (a) Original problem, (b) Equivalent
Fig. 1. Human brain as a lossy homogeneous dielectric (ε2 , μ 2 ) placed in the incident field (E
problem for region 1. (c) Equivalent problem for region 2.

where the index i = 1, 2 denotes medium where equivalent sur are scalar and vector,
face currents radiate, and ϕ, F , ψ, and A
electric and magnetic potentials, respectively.
These potentials are given in terms of surface integrals over
the sources, i.e.,

 r  )Gi (r, r  ) dS 
 i (r) = μi
J(
A
(4)


S


Fi (r) = εi



 (r )Gi (r, r ) dS
M



(5)

S

1
ϕi (r) =
εi
ψi (r) =

1
μi



ρ(r  )Gn (r, r  ) dS 

(6)

m(r  )Gn (r, r  ) dS 

(7)

S



S

where ρ and m are the electric and magnetic charge density,
respectively, and Gi (r, r  ) is the Green’s function for the homogeneous medium i given by
e−j k i R
;
Gi (r, r  ) =
4πR

R = |r − r  |.

(8)

In (8), R is the distance from the observation point r to
√
the source point r  , and ki = ω μi εi is a wave number of a
medium i.
Using (4)–(7), the scattered field from (2) and (3) can be
expressed in terms of the equivalent surface currents. Applying
the boundary conditions at the surface S being interface of
the two equivalent problems, a set of four equations for the
electric and magnetic field, respectively, is obtained. Choosing
two expressions for the electric field

 inc , i = 1
n̂ × E
sca
 M
)=
 i (J,
(9)
−n̂ × E
0,
i=2
the EFIE formulation in the frequency domain for the lossy
 inc is the known
homogeneous human brain is obtained. In (9), E

incident field, e.g., generated by a TMS coil, while J and M
represent unknown surface currents.
Using the continuity equation, the electric and magnetic
charge in (6) and (7) can be replaced with the divergence of the
electric and magnetic current, respectively, and after inserting

(4)–(7) in (2), the set of coupled integral equations is obtained

 r  )Gi (r, r  ) dS 
J(
jωμi
S


j
 r  )Gi (r, r  ) dS 
∇
∇S · J(
ωεi
S


 inc ,
E




M (r )Gi (r, r ) dS =
+∇ ×
S
0,
−

i=1

(10)

i = 2.

Performing certain mathematical manipulations on the second and third integral of (10), the nabla operator can be transferred to the Green’s function, leading to

 r  )Gi (r, r  ) dS 
jωμi
J(
S


j
 r  )∇Gi (r, r  ) dS 
−
∇S · J(
ωεi
S


 inc ,
E




 (r ) × ∇ Gi (r, r ) dS =
M
+
S
0,

i=1

(11)

i = 2.

Details of the above procedure can be found in Appendix A.
B. Numerical Solution
The set of coupled integral (11) cannot be solved analytically
for a complex geometry of the surface S, therefore a numerical
approach must be used. This paper features the use of the MoM.
The unknown currents are expanded by
 r) =
J(

N


Jn fn (r)

(12)

Mn gn (r)

(13)

n =1

 (r) =
M

N

n =1

where Jn and Mn are unknown coefficients, fn and gn are
known expansion or basis functions, and N stands for the total
number of elements used in the discretization of surface S.
C. Human Brain Model
The brain model was generated from a freely available Google
Sketchup rendering of the human brain, as shown on Fig. 2(a).

1538

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

vector ρ
n+ = r − rn+ is directed from the free vertex of Tn+ and
−
ρ
n = rn− − r is directed to the free vertex of Tn− .
The surface electric current J is approximated by the RWG
 is approxifunction fn , while the surface magnetic current M
mated by the pointwise orthogonal function gn , where
gn = n̂ × fn .

(15)

 r )
Using (14) and (15), the unknown equivalent currents J(


and M (r ) from (11) can be approximated by (12) and (13). Multiplying (11) by the set of a test functions fm , where fm = fn ,
and integrating over surface S, followed by a rather demanding
procedure described in more details in Appendix B, yields

jωμi

N


+

S

N



Mn

Dimensions of the brain are: Length: 167 mm, width: 140 mm,
height: 93 mm, and volume: 1400 cm3 [38].
The brain model is imported into an open source program
called MeshLab [39] where meshing using the triangular elements has been performed. The brain surface is discretized
using the T = 696 triangular elements and N = 1044 edgeelements. The final model, shown in Fig. 2(b), was imported
into MATLAB where the processing part has been carried out.

fn (r  )Gi dS  dS

N


fm (r) · [n̂ × gn (r  )] dS

S




fm (r) ·

Mn
S

n =1

Fig. 2. Human brain model for SIE formulation. (a) Detailed 3-D model from
Google Sketchup. (b) Final model discretized using the triangular elements
imported into MATLAB.

S



N
j 
Jn
∇S · fm (r)
∇S · fn (r  )Gi dS  dS
ωεi n =1
S
S

n =1

+

fm (r) ·

Jn

n =1

+





⎧ 
⎨
 inc dS,
fm (r) · E
=
S
⎩
0,

S

gn (r ) × ∇ Gi dS  dS
i=1

(16)

i=2

where the subscript i is index of the medium, i = 1, 2. Extracting
two sums, (16) can be written as the following system of linear
equations
N 

n =1

+

N

n =1

	
j
Bm n ,i Jn
ωεi

Vm ,
+ Dm n ,i ) Mn =
0,

jωμi Am n ,i +

(Cm n ,i

i=1
i = 2.

(17)

D. Expansion of Surface Currents
Triangular discretization of the brain surface enables one to
use the so called Rao–Wilton–Glisson (RWG) expansion function [40] in (12) and (13). The RWG function fn is defined on
a pair of triangles Tn+ and Tn− sharing a common edge (hence,
sometimes called edge element), while the function vanishes on
the rest of the surface S. The function is given by
⎧
⎨ ln ρ
±
r ∈ Tn±
n,
±

(14)
fn (r) = 2A±
n
⎩
0,
r ∈
/ Tn±
where ln is the length at the interface of triangles Tn+ and Tn− ,
−
while A+
n and An are the surface areas of those triangles. The

Expression (17) can be written in the compact matrix form
[Z] · {I} = {V}

(18)

where Z represents the 2N × 2N matrix of a system, while V
is the source vector of a dimension 2N .
The vector I containing the unknown coefficients Jn and Mn
is the solution of the matrix (18). From these coefficients, the
 placed on
equivalent electric and magnetic currents J and M
the surface S of the dielectric object, i.e., the human brain, can
be determined using (12) and (13). Obtaining these currents, the
electric and magnetic field can be easily determined at arbitrary

CVETKOVIĆ et al.: ANALYSIS OF TRANSCRANIAL MAGNETIC STIMULATION BASED ON THE SURFACE INTEGRAL EQUATION

points in brain, using



 2 (r) = −jωμ2
E

1539

TABLE I
HOMOGENEOUS HUMAN BRAIN PARAMETERS, FROM [43]

 r  )G2 (r, r  ) dS 
J(

S


j
 r  )G2 (r, r  ) dS 
−
∇S · J(
ωε2
S

 (r  ) × ∇G2 (r, r  ) dS 
M
−

Frequency

(19)

Relative permittivity [-]
εr
46 940

2.44 kHz
Electrical conductivity [S/m]
σ
0.08595

S

and



 at an arbitrary
On the other hand, the magnetic flux density B
point in space can be determined from the Biot–Savart’s law
 
d l × r̂0
 r) = μ0 M I
B(
(24)
4π
r − r  |3
l |

 (r  )G2 (r, r  ) dS 
M

 2 (r) = −jωε2
H
S

−

j
ωμ2


+



 (r  )G2 (r, r  ) dS 
∇s · M

S

 r  ) × ∇ G2 (r, r  ) dS 
J(

(20)

S

respectively.
E. Field of a TMS Coil
 inc from (9) is due to some exterThe incident electric field E
nal sources, and exists regardless of the presence of a dielectric
object, i.e., the brain. Usually, for the case of a plane-wave incidence, these sources are placed at infinity. On the other hand,
TMS coil placed in the vicinity of the head can be considered
as a near field source, hence posing a coupled problem. Consequently, the induced eddy currents in the brain will in turn
generate a secondary field superimposed to the primary field
due to coil current.
The electric field due to TMS can be expressed as follows:
 = −jω A
 − ∇ϕ
E

(21)

 and ϕ are the magnetic vector potential and electric
where A
scalar potential, respectively. The first term in (21) is due to current flowing in the coil, while the second one is the consequence
of the accumulation of electric charge on the boundary of the
medium [41]. If TMS coil is placed in free space, the second
term in (21) is zero, hence, the electric field due to coil can be
calculated from
 = −jω A.

E

(22)

Assuming a uniform current density I over a coil cross section, magnetic vector potential at an arbitrary point can be determined from integral

dl
 r) = μ0 M I
(23)
A(
4π
r − r  |
l |
where μ0 is the free space permeability, M is the number of
coil windings, and |r − r  | is the distance from the observation
to the source point on the coil. The differential element of the
curve dl depicts the direction of the current flow through the
coil. Expression (23) can be solved by discretizing the coil with
linear segments [42]. Assembling the contributions from all
linear segments, the magnetic vector potential can be determined
at an arbitrary point in space.

where r̂0 is the unit vector pointing from the source point r 
to the field point r. It should be noted that, due to the simple form, (21) and (24) often serve as the first estimation of
TMS coil induced electric field and the magnetic flux density.
In this paper, expressions (21)–(24) are used only for comparison purposes to the results obtained using a rigorous approach.
In this paper, the term involving incident field (due to TMS
coil) is calculated under the assumption that the coil is placed in
free space. It should be noted that the coil description via linear
approximation is not a novelty itself.
F. Calculation of the Induced Field and Current Density
In the presented model, (22) with (23) are used only to deter inc generated by the TMS coil, which
mine the incident field E
serves as the input data for the SIE formulation (11). By using
these expressions, the TMS coil is assumed to be decoupled
from the human brain, i.e., its presence does not disturb the
field.
The electric and magnetic field, generated by the induced
equivalent surface currents itself, at an arbitrary point inside
the brain are calculated using (19) and (20), respectively. The
magnetic flux density in the brain is calculated from

 = μ0 H.
B

(25)

 inside the brain, the distribution of the curFrom the field E

rent density Jind for the lossy homogeneous brain is determined
by

Jind = (σ + jωε0 εr ) E

(26)

where σ and εr are the electric conductivity and relative permittivity of the human brain, respectively. Frequency-dependent
parameters of the homogeneous brain tissue, given in Table I,
were taken from database [43], [44], as an average of white
matter (WM) and gray matter (GM).
The literature values for brain conductivity vary largely.
While the value for CSF is relatively well known [45], the
values for white and gray matter for low frequencies have been
reported between 0.01 and 1 S/m [46]. The specific conductivity value chosen for this study is well within this range. In
future studies, we plan to investigate the influence of different
conductivity values in a three compartment head model.

1540

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

TABLE II
COIL PARAMETERS

Frequency
Radius of turn
No. of turns
Coil current

Circular

8-coil

Butterfly

2.44 kHz
4.5 cm
14
2843 A

2.44 kHz
3.5 cm
15
2843 A

2.44 kHz
3.5 cm
15
2843 A

TABLE III
COMPARISON OF MAXIMUM ELECTRIC FIELD OBTAINED VIA ANALYTICAL
EXPRESSION AND VIA PROPOSED MODEL
Circular

Em a x
Em a x

8-coil

Butterfly

Analytical
161.15
321.94
Proposed SIE model
[V/m]
86.83
118.28
[V/m]

328.01
138.41

III. NUMERICAL RESULTS
The computational examples are based on the three generic
coils used in TMS, namely, the standard circular coil, the 8-coil,
and the butterfly coil (8-coil with wings inclined at 10◦ ). The
circular coil is discretized into 80 linear segments, the same
as the wings of other two coils. In order to facilitate a direct
comparison, the parameters of the three coils, i.e., operating
frequency, radius, number of turns, and impressed current, given
in Table II, were taken from [47]. The analysis undertaken in
[47] showed the maximum of the induced current normalized
amplitude to occur at this frequency.
Contrary to the detailed geometrical coil model [32], the presented model does not account for the spacings between the
multiple coil windings.
In all cases, the coils were placed over the primary motor
cortex area, with a distance of 1 cm between surface of the
brain and the geometric center of the coil. Since the actual coil
geometry, i.e., the windings separation, the thickness of the coil
insulation, as well as the casing, are neglected in this study, the
chosen separation from the coil geometric center should be valid
in this case. In case of a detailed coil model, the distance from
the surface of the coil should be given.
A. Electric Field

Fig. 3. Comparison of induced electric field in the human brain (coronal cross
section). The results on the left are obtained via analytical expressions for the
(a) circular, (b) 8-coil, and (c) butterfly coil, while the results on the right are
obtained via proposed model for the (d) circular, (e) 8-coil, and (f) butterfly coil.

The results obtained via the proposed model are compared
to the analytical results obtained via (22) and (23). Calculated
values for the maximum electric field are presented in Table III,
while in Fig. 3, the induced electric field in coronal cross section
is shown.
The comparison of the results shows that the distribution
of the electric field in both cases is similar. Quantitatively, the
results obtained via the proposed model show significantly lower
values than the analytical ones, but this was expected, since the
analytical method does not account for the electric field due to
accumulation of charges. It is shown in [31] that the electric field

can decrease due to the shielding effect of the surface charges
being accumulated at the surface.
Fig. 3 confirms the well-known fact that maximum electric
field of the 8-coil is under the coil center, while for the circular
coil, it is under the windings. Also, by tilting the windings of
the 8-coil by as much as 10◦ , as it is the case for the used butterfly coil, a higher value of the electric field is obtained. Fig. 4
shows the calculated electric field at the brain surface in greater
detail.

CVETKOVIĆ et al.: ANALYSIS OF TRANSCRANIAL MAGNETIC STIMULATION BASED ON THE SURFACE INTEGRAL EQUATION

Fig. 4.
cortex.

1541

Induced electric field on the brain surface due to: (a) Circular coil, (b) 8-coil, and (c) butterfly coil. All coils are placed 1 cm over the primary motor

TABLE IV
COMPARISON OF THE MAXIMUM VALUE OF INDUCED ELECTRIC CURRENT

Em a x
Jm a x , i n d

[V/m]
[A/m2 ]

Circular

8-coil

Butterfly

86.8302
7.483

118.2815
10.194

138.4188
11.929

TABLE V
COMPARISON OF MAXIMUM MAGNETIC FLUX DENSITY OBTAINED VIA
ANALYTICAL EXPRESSION AND VIA PROPOSED MODEL
Circular

Bm a x
Bm a x

8-coil

Analytical
0.679
0.672
Proposed SIE model
[T]
0.750
0.656
[T]

Butterfly

0.826
0.792

B. Current Density
From distribution of the electric field inside the brain, the
induced current density J can be obtained using (26). The results for the maximum electric current density Jm ax,ind , for the
homogeneous brain model, are given in Table IV.
The obtained current density value for the first coil is comparable to the results reported in [47], where a circular coil of
similar parameters was used, but on a four tissue brain model.
Kowalski et al. [47] determined the current density threshold
value of 6 A/m2 for the excitation of motor cortex area, while
the proposed model in this paper obtained maximum value of
7.483 A/m2 .
C. Magnetic Flux Density
Finally, the results for the magnetic flux density, calculated by
using (20) and (25), are compared to the analytical results. The
obtained results for the maximum values are given in Table V,

while Fig. 5 shows comparison of the magnetic flux density in
the coronal cross section. The results indicate that the presence
of the brain does not significantly disturb the magnetic field
of the coil, although a lower maximum value of the magnetic
flux density was obtained for the 8-coil and butterfly coil. The
coronal distribution of the magnetic flux density obtained using
the proposed SIE model shows some discontinuities. This is
related to the interpolation method used. Namely, the magnetic
field obtained via (20) is calculated at the discrete points in the
brain from which the value at neighboring area is determined by
the interpolation. This numerical artifact could be overcome by
determining the field at more finer resolution. The distribution
of the magnetic flux density B on the surface of the brain is
presented in more detail in Fig. 6.
As a final comparison between the results for three coils
calculated by the proposed SIE-based method of this study, the
Fig. 7 can be used, where the dependence of the induced electric
field E and magnetic flux density B on the distance from the
brain surface is shown. From Fig. 7, the rapid decrease of both E
and B under the geometric center of the brain is clearly evident.
The increase in the amplitude seen at the bottom of the brain is
due to the vicinity of these points, where the field is calculated
to the source point on the ventral brain surface. This is known
in computational electromagnetics as the near singularity. The
solution is to increase the number of integration points or to
carefully choose the place of the integration points.

IV. DISCUSSION
Some of the limitations of the present model should be addressed at this point. The homogeneous brain model insulated
in the free space does not represent a realistic scenario. The
actual brain is surrounded by various tissues such as e.g., cerebrospinal fluid (CSF), adipose, skull, and scalp. The presence of
these tissues will affect the overall distribution of the fields as
well as induced current densities. Although the analysis in [48]

1542

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Fig. 5. Comparison of magnetic flux density in the human brain (coronal cross
section). The results on the left are obtained via analytical expressions for the
(a) circular, (b) 8-coil, and (c) butterfly coil, while the results on the right are
obtained via proposed model for the (d) circular, (e) 8-coil, and (f) butterfly coil.

showed that the inclusion of the skull or CSF would not affect
the distribution of currents in the adjacent cortex of the brain,
other models showed the contrary [31], hence, an additional
verification using the integral equation-based formulation could
be beneficial. The future work should therefore be related to the
inclusion of the surrounding tissues such as skull and scalp.
Another important thing to consider is the heterogeneity of the
actual brain. The presented paper uses properties of the single
homogeneous tissue whose value is given as the average between
the WM and the GM. Given that WM and GM properties differ,

Fig. 6. Magnetic flux density on the brain surface due to: (a) Circular coil,
(b) 8-coil, and (c) butterfly coil. All coils are placed 1 cm over the primary motor
cortex.

CVETKOVIĆ et al.: ANALYSIS OF TRANSCRANIAL MAGNETIC STIMULATION BASED ON THE SURFACE INTEGRAL EQUATION

1543

Fig. 7. Dependence of induced electric field E and magnetic flux density B on the distance from the brain surface. The values given are on the points directly
under the coil geometric center.

one may expect the induced electric field values to increase or
decrease at the boundaries between different tissues [31].
The brain surface model presented in this paper is smoothed
out neglecting the detailed structures such as gyri and sulci. The
proposed SIE formulation is applicable to an arbitrarily-shaped
biological tissue, including a more detailed brain model taking
the cortex foldings into account. The downside of the detailed
description of the brain is the total number of elements required
to accurately represent the geometry. This would consequently
lead to a very large matrix system (18) whose solution would
require the use of advanced techniques such as multilevel fast
multipole method [49].
In addition to the detailed brain model, a more detailed description of the stimulating coil is also necessary, in order to give
more accurate results. The simple description of the actual TMS
coil is used in this paper, neglecting the separation between coil
windings, the thickness of the coil insulation, and the casing.
The model developed in [32] could be used to improve on the
coil description.
V. CONCLUSION

APPENDIX A
Applying the vector identity
(27)

on the second integral in (10), where φ and ψ are two arbitrary
scalar functions, the integrand can be written as






 r  )Gn (r, r  ) = ∇ ∇ · J(
 r  ) Gn (r, r  )
∇ ∇S · J(
S
 r  )∇Gn (r, r  ).
+ ∇S · J(

 = ∇φ × A
 + φ∇ × A

∇ × (φA)

(29)

 is arbitrary vector function,
on the third integral in (10), where A
the integrand can be written as



 (r  )
 (r  )Gn (r, r  ) = Gn (r, r  )∇ × M
∇× M
 (r  ) (30)
+ ∇Gn (r, r  ) × M
where, again, the first term on the right-hand side of (30) van (r  ) is defined
ishes due to the fact that curl operator acting on M
with respect to the observation point r.
×B
 = −B
 ×A
 of the vector product,
Using the property A
as well as the property for the gradient of Green’s function
∇Gn (r, r  ) = −∇ Gn (r, r  )

(31)

one can obtain the expression (11).

This paper deals with the SIE-based model for TMS. The
formulation is based on the coupled set of integral equations
for the electric field. The corresponding SIE set is handled by
a MoM scheme. The developed model takes into account the
inductive and capacitive effects via the parameters of a homogeneous brain tissue, as well as propagation effects, often being
neglected when quasi-static approximation is used. The numerical results obtained for the induced electric field, current density,
and magnetic flux density are in a good agreement with the analysis from [47] as well as to the results obtained by analytical
approach. The future work will be related to the development of
a more detailed geometrical model of the human brain, which
will take into account complex cortical columnar structures, as
well as some additional brain tissues.

∇(φψ) = φ∇ψ + ψ∇φ

The first term on the right-hand side of (28) is zero due to the
fact that the surface gradient operator acts with respect to the
observation point r.
Similarly, applying the vector identity

(28)

APPENDIX B
Multiplying (11) by the set of a test functions fm , where

fm = fn , and integrating over surface S, yields


N

Jn
fm (r) ·
fn (r  )Gi (r, r  ) dS  dS
jωμi
S

S

n =1



N
j 

Jn
∇S · fn (r  )∇Gi (r, r  ) dS dS
−
fm (r) ·
ωεi n =1
S
S
+

N

n =1




fm (r) ·

Mn
S

S

⎧ 
⎨
 inc dS,
fm (r) · E
=
S
⎩
0,

gn (r ) × ∇ Gi (r, r  ) dS  dS
i=1

(32)

i=2

where i represents the index of the medium.
From the second term of (32), the gradient operator acting
on the Green’s function can be transferred to the test function.
Reversing the order of integration in the double surface integral
leads to





∇S · fn (r )
(33)
fm (r) · ∇Gi (r, r  ) dS dS  .
S

S

1544

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Using the vector identity
 =A
 · ∇φ + φ∇ · A

∇ · (φA)

(34)

enables one to rewrite the inner integral of (33) as


∇S · (fm (r)Gi (r, r  )) dS
fm (r) · ∇Gi (r, r  ) dS =
S



S

Gi (r, r  )∇S · fm (r) dS

−
S

(35)
where ∇S is the surface divergence operator.
Next, the surface divergence theorem can be applied on the
first right-hand side term of (35), transferring the surface integral to the boundary integral. Using the definition of the RWG
function (14), one can easily show that this boundary integral
vanishes


∇S · (fm (r)Gi (r, r  )) dS = (fm (r)Gi (r, r  )) · û dl = 0
S

c

(36)
leaving only the second term of (35). In (36), the normal on the
boundary is represented by û.
After rearranging, the double surface integral from (33) can
be written as


∇S · fm (r)
∇S · fn (r  )Gi (r, r  ) dS  dS. (37)
−
S

S

The last term from the left-hand side of (32) is a bit trickier. In
the limiting case when R → 0, i.e., when the observation point r
is near the source point r  , this integral becomes hypersingular,
while the other two integrals become singular. It could be shown
that in the limiting case R → 0, the latter ones vanish, while for
the former one, it is not the case.
Therefore, one needs to exclude very small hemispherical
region around the source point on surface S and determine the
residual value of this integral on it. The integration domain S
is hence split in two parts, the excluded part δ and the original
part reduced by δ, i.e., S − δ.
Separating the third integral from (11) in this way









M (r ) × ∇ G(r, r ) dS =
[. . .] dS +
[. . .] dS 
S −δ

S

δ

(38)

the limiting case value can be determined

 (r  ) × ∇ G(r, r  ) dS 
M
lim
R →0

δ



−j k R

 (r  ) × R̂(1 + jkR) e
M
ε2 sin θ dθ dϕ
2
R →0
4πR
δ
 2π  π
2
1
 (r  ) × R̂ sin θ dθ dϕ
M
=
4π 0
0
 π
2
1
 (r  ) × R̂ sin θ dθ
M
2π
=
4π
0
= lim

1
 (r  ).
= ± n̂ × M
2

The sign in (39) depends from which side the observation
point is approaching the source point on S. If the observation
point is in medium 1, the sign is positive, otherwise it is negative.
Inserting (39) into (38), it leads to the integral equation
set (16).

(39)

REFERENCES
[1] E. Wassermann et al., Eds., Oxford Handbook of Transcranial Stimulation,
1st ed. New York, NY, USA: Oxford Univ. Press, 2008.
[2] A. Pascual-Leone et al., Eds., Handbook of Transcranial Magnetic Stimulation, 1st ed. London, U.K.: Hodder Arnold, 2002.
[3] M. Hallett, “Transcranial magnetic stimulation and the human brain,”
Nature, vol. 406, no. 6792, pp. 147–150, 2000.
[4] R. Plonsey and R. C. Barr, Bioelectricity: A Quantitative Approach, 3rd
ed. New York, NY, USA: Springer, 2007.
[5] A. T. Barker et al., “Non-invasive magnetic stimulation of the human
motor cortex,” Lancet, vol. 1, pp. 1106–1107, 1985.
[6] S. Ueno et al., “Localized stimulation of neural tissues in the brain by
means of a paired configuration of time varying magnetic fields,” J. Appl.
Phys., vol. 64, no. 10, pp. 5862–5864, 1988.
[7] S. Ueno et al., “Functional mapping of the human motor cortex obtained
by focal and vectorial magnetic stimulation of the brain,” IEEE Trans.
Magn., vol. 26, no. 5, pp. 1539–1544, Sep. 1990.
[8] J. Ruohonen and R. J. Ilmoniemi, “Focusing and targeting of magnetic
brain stimulation using multiple coils,” Med. Biol. Eng. Comput., vol. 36,
no. 3, pp. 297–301, 1998.
[9] J. Ruohonen et al., “Theory of multichannel magnetic stimulation: Toward functional neuromuscular rehabilitation,” IEEE Trans. Biomed. Eng.,
vol. 46, no. 6, pp. 646–651, Jun. 1999.
[10] L. Gomez et al., “Numerical analysis and design of single-source multicoil
TMS for deep and focused brain stimulation,” IEEE Trans. Biomed. Eng.,
vol. 60, no. 10, pp. 2771–2782, Oct. 2013.
[11] F. Grandori and P. Ravazzani, “Magnetic stimulation of the motor cortextheoretical considerations,” IEEE Trans. Biomed. Eng., vol. 38, no. 2,
pp. 180–191, Feb. 1991.
[12] N. M. Branston and P. S. Tofts, “Analysis of the distribution of currents
induced by a changing magnetic field in a volume conductor,” Phys. Med.
Biol., vol. 36, no. 2, pp. 161–168, 1991.
[13] M. Nadeem et al., “Computation of electric and magnetic stimulation
in human head using the 3-D impedance method,” IEEE Trans. Biomed.
Eng., vol. 50, no. 7, pp. 900–907, Jul. 2003.
[14] F. S. Salinas et al., “3D modeling of the total electric field induced by
transcranial magnetic stimulation using the boundary element method,”
Phys. Med. Biol., vol. 54, pp. 3631–3647, 2009.
[15] M. Chen and D. J. Mogul, “Using increased structural detail of the cortex
to improve the accuracy of modeling the effects of transcranial magnetic
stimulation on neocortical activation,” IEEE Trans. Biomed. Eng., vol. 57,
no. 5, pp. 1216–1226, May 2010.
[16] H. Eaton, “Electric field induced in a spherical volume conductor from
arbitrary coils: Application to magnetic stimulation and MEG,” Med. Biol.
Eng. Comput., vol. 30, no. 4, pp. 433–440, 1992.
[17] W. C. Chew et al., Integral Equation Methods for Electromagnetic and
Elastic Waves. San Rafael, CA, USA: Morgan & Claypol, 2009.
[18] A. Nummenmaa et al.. (2013, Oct.). Comparison of spherical and
realistically shaped boundary element head models for transcranial
magnetic stimulation navigation. Clin. Neurophysiol. [Online]. 124(10),
pp. 1995–2007. Available: http://dx.doi.org/10.1016/j.clinph.2013.04.019
[19] R. Plonsey and D. B. Heppner, “Considerations of quasi-stationarity
in electrophysiological systems,” Bull. Math. Biol., vol. 29, no. 4,
pp. 657–664, 1967.
[20] T. Wagner et al., “Three-dimensional head model simulation of transcranial magnetic stimulation,” IEEE Trans. Biomed. Eng., vol. 51, no. 9,
pp. 1586–1598, Sep. 2004.
[21] C. Gabriel et al., “The dielectric properties of biological tissues: I. Literature survey,” Phys. Med. Biol., vol. 41, pp. 2231–2248, 1996.
[22] S. Gabriel et al., “The dielectric properties of biological tissues: III.
Parametric models for the dielectric spectrum of tissues,” Phys. Med.
Biol., vol. 41, pp. 2271–2293, 1996.
[23] N. S. Stoykov et al., “Frequency- and time-domain FEM models of EMG:
Capacitive effects and aspects of dispersion,” IEEE Trans. Biomed. Eng.,
vol. 49, no. 8, pp. 763–772, Aug. 2002.

CVETKOVIĆ et al.: ANALYSIS OF TRANSCRANIAL MAGNETIC STIMULATION BASED ON THE SURFACE INTEGRAL EQUATION

[24] C. Butson and C. C. McIntyre, “Tissue and electrode capacitance reduce
neural activation volumes during deep brain stimulation,” Clin. Neurophysiol., vol. 116, no. 10, pp. 2490–2500, 2005.
[25] B. Tracey and M. Williams, “Computationally efficient bioelectric field
modeling and effects of frequency-dependent tissue capacitance,” J. Neural Eng., vol. 8, pp. 1–7, 2011.
[26] C. A. Bossetti et al., “Analysis of the quasi-static approximation for
calculating potentials generated by neural stimulation,” J. Neural Eng.,
vol. 5, pp. 44–53, 2008.
[27] P. Tofts, “The distribution of induced currents in magnetic stimulation
of the nervous system,” Phys. Med. Biol., vol. 35, no. 8, pp. 1119–1128,
1990.
[28] K. R. Davey et al., “Prediction of magnetically induced electric fields in
biological tissue,” IEEE Trans. Biomed. Eng., vol. 38, no. 5, pp. 418–422,
May 1991.
[29] P. Ravazzani et al., “Magnetic stimulation of the nervous system: Induced electric field in unbounded, semi-infinite, spherical, and cylindrical
media,” Ann. Biomed. Eng., vol. 24, no. 5, pp. 606–616, 1996.
[30] J. Starzynski et al., “Simulation of magnetic stimulation of the brain,”
IEEE Trans. Magn., vol. 38, no. 2, pp. 1237–1240, Mar. 2002.
[31] P. C. Miranda et al., “The electric field induced in the brain by magnetic
stimulation: A 3-D finite-element analysis of the effect of tissue heterogeneity and anisotropy,” IEEE Trans. Biomed. Eng., vol. 50, no. 9, pp.
1074–1085, Sep. 2003.
[32] F. S. Salinas et al., “Detailed 3D models of the induced electric field
of transcranial magnetic stimulation coils,” Phys. Med. Biol., vol. 52,
pp. 2879–2892, 2007.
[33] N. De Geeter et al., “An efficient 3-D eddy-current solver using an
independent impedance method for transcranial magnetic stimulation,”
IEEE Trans. Biomed. Eng., vol. 58, no. 2, pp. 310–320, Feb. 2011.
[34] M. Stenroos et al. (2014, Mar.). Comparison of three-shell and
simplified volume conductor models in magnetoencephalography.
NeuroImage [Online]. pp. 1–12. Available: http://dx.doi.org/10.1016/
j.neuroimage.2014.01.006
[35] R. Harrington, “Boundary integral formulations for homogeneous material
bodies,” J. Electromagn. Waves Appl., vol. 3, no. 1, pp. 1–15, 1989.
[36] A. J. Poggio and E. K. Miller, “Integral equation solutions of three–
dimensional scattering problems,” in Computer Techniques for Electromagnetics, 2nd ed., R. Mittra, Ed. Bristol, PA, USA: Hemisphere, 1987,
ch. 4, pp. 159–264.
[37] K. Umashankar et al., “Electromagnetic scattering by arbitrary shaped
three-dimensional homogeneous lossy dielectric objects,” IEEE Trans.
Antennas Propagation, vol. 34, no. 6, pp. 758–766, Jun. 1986.

1545

[38] S. M. Blinkov and I. I. Glezer, The Human Brain in Figures and Tables.
A Quantitative Handbook. New York, NY, USA: Plenum, 1968.
[39] P. Cignoni et al., “Meshlab: an opensource mesh processing tool,” in
Proc. IEEE Eurographics Italian Chapter Conf., pp. 129–136, 2008.
[40] S. Rao et al., “Electromagnetic scattering by surfaces of arbitrary shape,”
IEEE Trans. Antennas Propag., vol. 30, no. 3, pp. 409–418, May 1982.
[41] B. J. Roth et al., “A theoretical calculation of the electric field induced
in the cortex during magnetic stimulation,” Electroencephalography Clin.
Neurophysiol., vol. 81, no. 1, pp. 47–56, 1991.
[42] L. G. Cohen et al., “Effects of coil design on delivery of focal
magnetic stimulation. Technical considerations,” Electroencephalography
Clin. Neurophysiol., vol. 75, no. 4, pp. 350–357, 1990.
[43] C. Gabriel and S. Gabriel, “Compilation of the dielectric properties of
body tissues at RF and microwave frequencies,” King’s College London,
London, U.K., Tech. Rep. AL/OE-TR-1996-0037, 1996.
[44] S. Gabriel et al. (1996, Nov.). The dielectric properties of biological tissues: II. Measurements in the frequency range 10 Hz to 20
GHz. Phys. Med. Biol. [Online]. 41(11), pp. 2251–2269. Available:
http://stacks.iop.org/0031-9155/41/i=11/a=002
[45] S. B. Baumann et al., “The electrical conductivity of human cerebrospinal fluid at body temperature,” Bioelectromagnetics, vol. 44, no. 3,
pp. 220–223, 1997.
[46] C. Gabriel et al.. (2009, Aug.). Electrical conductivity of tissue
at frequencies below 1 MHz. Physics Med. Biol. [Online]. 54(16),
p. 4863. Available: http://stacks.iop.org/0031-9155/54/i=16/a=002
[47] T. Kowalski et al., “Current density threshold for the stimulation of
neurons in the motor cortex area,” Bioelectromagnetics, vol. 23, no. 6,
pp. 421–428, 2002.
[48] L. Golestanirad et al., “Effect of the model accuracy on the result of
computed current densities in the simulation of transcranial magnetic
stimulation,” IEEE Trans. Magn., vol. 46, no. 12, pp. 4046–4051, Dec.
2010.
[49] V. Rokhlin, “Rapid solution of integral equations of classic potential theory,” J. Comput. Phys., vol. 60, no. 2, pp. 187–207, 1985.

Authors’ photographs and biographies not available at the time of publication.

