1044

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Spectral CT Image Restoration via an Average
Image-Induced Nonlocal Means Filter
Dong Zeng, Jing Huang∗ , Hua Zhang, Zhaoying Bian, Shanzhou Niu, Zhang Zhang, Qianjin Feng,
Wufan Chen, Senior Member, IEEE, and Jianhua Ma∗ , Member, IEEE

Abstract—Goal: Spectral computed tomography (SCT) images
reconstructed by an analytical approach often suffer from a poor
signal-to-noise ratio and strong streak artifacts when sufficient
photon counts are not available in SCT imaging. In reducing noiseinduced artifacts in SCT images, in this study, we propose an
average image-induced nonlocal means (aviNLM) filter for each
energy-specific image restoration. Methods: The present aviNLM
algorithm exploits redundant information in the whole energy domain. Specifically, the proposed aviNLM algorithm yields the restored results by performing a nonlocal weighted average operation
on the noisy energy-specific images with the nonlocal weight matrix between the target and prior images, in which the prior image
is generated from all of the images reconstructed in each energy
bin. Results: Qualitative and quantitative studies are conducted
to evaluate the aviNLM filter by using the data of digital phantom, physical phantom, and clinical patient data acquired from
the energy-resolved and -integrated detectors, respectively. Experimental results show that the present aviNLM filter can achieve
promising results for SCT image restoration in terms of noiseinduced artifact suppression, cross profile, and contrast-to-noise
ratio and material decomposition assessment. Conclusion and Significance: The present aviNLM algorithm has useful potential for
radiation dose reduction by lowering the mAs in SCT imaging,
and it may be useful for some other clinical applications, such as
in myocardial perfusion imaging and radiotherapy.
Index Terms—Energy-resolved and -integrated detectors, image restoration, nonlocal means, spectral computed tomography
(SCT).

I. INTRODUCTION
PECTRAL computed tomography (SCT) has attracted considerable clinical interest because of its ability to identify
and differentiate different materials by generating the atomic

S

Manuscript received September 1, 2014; revised May 11, 2015 and July
18, 2015; accepted August 31, 2015. Date of publication September 3, 2015;
date of current version May 19, 2016. This work was supported in part by
the National Natural Science Foundation of China under Grants 81371544,
61571214, 81501466 and 81501541, and the National Science and Technology Major Project of the Ministry of Science and Technology of China under
Grant 2014BAI17B02. Guangdong Natural Science Foundation under Grants
2015A030313271, 2014A030310243 and 2015A030310018, and the Science
and Technology Program of Guangzhou, China under Grant 201510010039.
Asterisk indicates corresponding author.
D. Zeng, H. Zhang, Z. Bian, S. Niu, Q. Feng, and W. Chen are with the
School of Biomedical Engineering, Southern Medical University, Guangzhou
510515, China (e-mail: zd1989@smu.edu.cn; xinsier@smu.edu.cn; zybian@
smu.edu.cn; szniu@smu.edu.cn; fengqj99@fimmu.com; chenwf@smu.edu.cn).
Z. Zhang is with the Department of Radiology, Tianjin Medical University
General Hospital, Tianjin 300052, China (e-mail: filea1249@gmail.com).
∗ J. Huang is with the School of Biomedical Engineering, Southern Medical
University, Guangzhou 510515, China (e-mail: hjing@fimmu.com).
∗ J. Ma is with the School of Biomedical Engineering, Southern Medical
University, Guangzhou 510515, China (e-mail: jhma@smu.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2476371

number and electronic density of objective materials and/or
basis material images [1]–[6]. In SCT imaging, the simplest
implementation entails performing dual-energy CT scans with
an energy-integrated detector at two different X-ray kVps [7],
[8]. Another way involves performing CT scans with an energyresolved detector at full X-ray energies [9], [10]. Because the
energy-resolved detector can effectively eliminate electronic
noise, Swank noise, and afterglow effect [11], the associative
gains for SCT imaging are more noticeable compared with those
from the energy-integrated detector in different clinical applications. These gains include new material contrast detection
(e.g., gold nanoparticle accumulated in atherosclerotic plaque)
and quantification of intrinsic tissue contrast (e.g., pathological
versus normal tissue) [12]. Meanwhile, because of the limited
photon count from the narrow energy bins in energy-resolved
detector, SCT images reconstructed by an analytical approach
often suffer from a poor signal-to-noise ratio (SNR) and strong
streak artifacts if noise controls are not applied in image reconstruction. As a result, severe noise boost can be observed in the
material-decomposed images.
Up to now, several noise reduction strategies have been explored to suppress noise-induced artifacts in SCT images and
material-decomposed images [13]–[23]. Among these strategies, statistical iterative reconstruction (SIR) methods offer flexibility in accurately modeling the system and accounting for the
properties of noise statistics, as well as allow the incorporation of a dedicated prior model into a cost function [13]–[17].
The associative SIR-based material-decomposed images can be
obtained by numerical minimization of the cost function. An
alternative strategy is to model the noise property by a cost function in sinogram domain, which estimates an optimal material
sinogram data by minimizing the cost function in a statistical
sense, and then reconstructs the material-decomposed images
by a conventional filtered backprojection (FBP) algorithm [18],
[19]. In addition, the material-decomposed sinograms can also
be directly estimated from the dual-energy data in the transmission domain with the use of the penalized likelihood method
[20]. Different from the aforementioned methods, another category typically conducts a noise reduction method directly on the
reconstructed SCT images [21]–[23]. However, although these
noise suppression algorithms are computationally efficient, unsuccessful low-contrast region recovery often results from the
complex noise-induced artifacts in the SCT images. For example, Leng et al. proposed a local highly constrained backprojection reconstruction (HYPR-LR) algorithm with remarkable
gains over the other existing methods in SCT image restoration
[3]. The basic idea of the HYPR-LR algorithm is to incorporate
the redundant information between the images from each energy

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

bin, which breaks free from the tradeoff between the contrast
and the noise of the aligned SCT images. However, a major
drawback of the HYPR-LR algorithm is the required alignment
of SCT images, which would hinder the wide applications of
the algorithm in slow-kVp-based SCT imaging.
Inspired by the normal-dose scan-induced nonlocal means
(ndiNLM) algorithm in conventional low-dose CT image rest
oration [24] and the HYPR-LR algorithm in SCT image restoration [3], in this study, we propose an average image-induced
nonlocal means (aviNLM) filter for each energy-specific image
restoration by exploiting redundant information in the whole
energy domain. Specifically, the present aviNLM filter yields
the restored results by performing a nonlocal weighted average
operation on the noisy energy-specific images with the nonlocal
weight matrix between the target and prior images. The prior
image is generated from all of the images reconstructed in
each energy bin. Qualitative and quantitative evaluations were
conducted on the digital phantom, physical phantom, and
clinical patient data in terms of cross profile, noise reduction,
and contrast-to-noise ratio (CNR) and material decomposition
assessment.
The remaining parts of this paper are organized as follows. In
Section II, the ndiNLM and aviNLM algorithms are presented,
and then the evaluation designs are described. In Section III,
experimental results are reported. Finally, the discussion and
conclusion are given in Sections IV and V, respectively.
II. METHODS AND MATERIALS
A. Brief View of the ndiNLM Algorithm
The ndiNLM algorithm, proposed by our group for low-dose
image restoration [24], uses data redundancies in the previous
normal-dose scan instead of the low-dose image itself because
the normal-dose scan can provide a reference image to construct
more reasonable nonlocal weights than those used in the original
NLM algorithm. Mathematically, the ndiNLM algorithm can be
expressed as follows:

w(i, j)μnd (j),
(1)
ndiNLM(μ(i)) =
j ∈N i

where μ(i) denotes the image intensity at the pixel i in the object
image domain, and μnd (j) denotes the image density at the pixel
j in the reference image domain. Ni denotes the search-window
centered at the pixel i in the reference image domain. The weight
w(i, j) quantities the similarity between the pixel i in the object
image μ and the pixel j in the reference image μnd , which can
be expressed as follows:


μ(Vi ) − μnd (Vj )22,a
1
exp −
, (2)
w(i, j) =
Z(i)
h2

where Z(i) = j ∈N i exp{−μ(Vi ) − μnd (Vj )22,a /h2 } is a
normalizing factor. Vi and Vj denote two local similarity neighborhoods (named patch-windows) centered at the pixel i and j,
respectively. μ(Vi ) and μnd (Vj ) denote the vector of neighborhood pixel values restricted in the patch-windows Vi and Vj , respectively. The notation ·22,a denotes a Gaussian-weighted Euclidean distance between two similarity patch-windows, where

1045

a is the standard deviation (SD) of Gaussian function [25]. h is
a parameter that controls the decay of the exponential function.
B. Description of the aviNLM Algorithm
Borrowing the nature of the ndiNLM algorithm for low-dose
CT image restoration in our previous study [24], we propose,
in this paper, an aviNLM algorithm to exploit the high degree
of data redundancy in whole energy domains. Specifically, the
aviNLM algorithm is performed in the image domain and contains three major steps: 1) composite image (μav ) generation by
averaging all of the images from each energy bin, 2) optimal nonlocal weight construction with the use of each energy-specific
image μbin and composite image μav , and 3) nonlocal weighted
average with the use of the optimal nonlocal means weights.
Each step is described in detail in the following sections.
1) Composite Image Generation: In this paper, the aviNLM
algorithm is adapted to fully exploit the redundant information
in the energy domains, where the dataset is measured at the
same patient anatomy. The composite image μav was produced
by averaging the images from each energy bin, which utilizes
all the available photons with the relative low image noise level.
2) Nonlocal Weights Construction: Because of the averaging operation, the associative composite image μav contains
less noise and artifacts compared with each energy-specific
image μbin . Therefore, optimal nonlocal weights could be
determined from the image μav instead of the energy-specific
image μbin itself to improve the performance of the following
nonlocal weighted average. Similar to the expression in (2),
the proposed optimal nonlocal weight construction can be
developed as follows:


μbin (Vi ) − C(i, j) · μav (Vj )22,a
C(i, j)
· exp −
,
w(i, j) =
Z(i, j)
h2

Z(i, j) =




exp −

μbin (Vi ) − C(i, j) ·

j ∈N i



μav (Vj )22,a

h2

(3)
, (4)

where Vi and Vj denote two similarity patch-windows centered
at the pixel i in the energy-specific image μbin and at the pixel
j in the composite priori image μav that utilizes all available
photons, respectively. Ni represents the search-window in the
image volume μav .
In SCT imaging, the different photon counts in each energyspecific bin leads to the attenuation coefficient changes in each
resulting energy-specific image. Fig. 1(a) shows a simulated Xray beam spectra at 120-kV tube potentials [26]. The 120-kV
spectrum was divided into five equally distributed energy bins
having equal width. Fig. 1(b) shows that the difference in the
attenuation coefficient ratio can be observed among the five regions of interest (ROIs) in Fig. 2 from Bin 2 (i.e., 40–60 keV)
and Bin 5 (i.e., 100–120 keV). Therefore, a local compensation
factor C is naturally needed in Eq (3) to account for local intensity change. In this study, the compensation factor C is defined
as follows:
C (μbin (Vi ) , μav (Vj )) =

E (μbin (Vi ))
,
E (μav (Vj ))

(5)

1046

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 1. (a) Simulated X-ray beam spectra at 120-kV tube potentials. The
120-kV spectrum was divided into five equally distributed energy bins having
equal width (20 keV); and (b) attenuation coefficient ratio difference between
Bin2 (i.e., 40–60 keV) and Bin5 (i.e., 100–120 keV) images of the five ROIs in
Fig. 2.

ideal phantom or high-quality reference image. The related results showed that a 17 × 17 search-window Ni is adequate for
effective noise and artifact suppression while retaining computational efficiency. In the implementation, the similarity of two
patch-windows with the size of 5 × 5 was measured by the
conventional Euclidean distance, wherein the selected patch in
the μav contains additional information from the spectral component.
2) Selection of the Smoothing Parameter: The smoothing
parameter h in the NLM filter is usually designed as a function
of the SD σ of the image noise (i.e., h = ασ) with a free scalar
parameter α [25]. In addition, the average image μav has less
noise level compared with the energy-specific image μbin . With
the aforementioned observation, h was empirically determined
in this study with h2 = 2τ σ̄ 2 |Ni |, wherein σ̄ denotes the SD
of the average image μav . |Ni | denotes the size of the searchwindow Ni , and τ is a scale factor.
D. Image-Domain Material Decomposition

Fig. 2.

Modified clock phantom for numerical simulation study.

where E(·) denotes the expected value or mean of the intensity
in the patch-window V .
3) Nonlocal Weighted Average: With the constructed nonlocal weights w(i, j), the proposed aviNLM algorithm for SCT
image restoration can be performed through a nonlocal weighted
average operation as follows:

w(i, j)μav (j).
(6)
aviNLM(μbin (i)) =
j ∈N i

From the weighted average of (6), the restored intensity values for the restored SCT images are from the average images.
As a result, the noise-induced artifacts in the current SCT image
are considerably suppressed in the restored SCT image because
of the average image as a reference, which provides data redundancies for the restoration operation.
C. Parameter Selections in the aviNLM Algorithm
For SCT image restoration, three parameters in the aviNLM
algorithm would be determined, i.e., the sizes of the search
and patch-windows (i.e., Ni , Vi , and Vj ) and the value of the
smoothing parameter h.
1) Selection of the Search- and Patch-Windows: In this
study, we ran several preliminary experiments with different
search-windows Ni (i.e., 11 × 11, 15 × 15, 17 × 17, and
21 × 21) and performed quantitative measurements [i.e., the
peak signal-to noise ratio (PSNR), the CNR, and the universal
quality index (UQI)] and visual inspection compared with the

For the image-based basis material decomposition, the measurement in the CT image domain can be approximate as a linear
combination of two basis materials [9], and the formulation of
the material decomposition can be written as follows:
 
 

μ1H μ2H
d1
μH
=
,
(7)
μL
μ1L μ2L
d2
where μH /L denotes the reconstructed CT image at high- or lowenergy spectrum, and the subscript H/L represents the high/lowenergy spectrum. d1/2 denotes the basis material image, and
the subscripts 1 and 2 indicate two basis materials. μij is the
linear attenuation coefficient of material i (i = 1 or 2) in mm−1
under energy spectrum j (j = H or L). The decomposition
can be solved by directly performing signal decomposition via
numerical matrix inversion or other superior techniques, such
as the least square method [7] and the iterative decomposition
method [27]. In this study, the decomposition is realized by
numerical matrix inversion.
E. Experimental Data Acquisition
Numerical digital phantom, physical phantom, and clinical
patient data were used in the experiments to evaluate the performance of the present aviNLM algorithm for SCT image restoration. For the numerical simulation study, a modified clock phantom as shown in Fig. 2 that contains four different tissues (i.e.,
iodine, polyethylene, brain, and adipose) was used to generate
the projection data with an energy-resolved detector. The modified clock phantom consists of a circular water background
with the diameter of 28.0 cm and four large circular inserts,
two medium circular inserts, and one small circular insert with
varying material (C1, C7: Iodine, 4.99 g/cm3 , C2, C6: Polyethylene, 0.97 g/cm3 , C3, C5: Brain, 1.039 g/cm3 , C4: Adipose,
0.95 g/cm3 ). For the physical phantom study, a cylindrical phantom (QSP-1, FUYO Corporation) with nine cylindrical tubes as
shown in Fig. 3 was used to generate the SCT images with a
commercial dual-energy CT. The diameter and length of the

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

1047

CT images can be yielded by a standard FBP approach with a
Ramp filter [30]
 
		
D(B)S(B)
,
(12)
μbin = FBP log
Np oi (B)

Fig. 3. Cylindrical phantom for real data study. (a) Phantom picture; and (b)
one slice of CT images.

phantom is 20.0 and 13.0 cm, respectively. The outer and inner
diameter of each tube is 2.5 and 1.80 cm with the length of 10.0
cm, respectively. The tubes #9 was filled with water located at
the center of the phantom, whereas the other eight cylindrical
tubes (#1 to #8) were filled with 50.0, 40.0, 30.0, 20.0, 15.0,
10.0, 5.0, 1.0 mg/mL of iodine contrast medium (Omnipaque,
GE Healthcare) located symmetrically in the periphery of the
phantom.
1) Numerical Simulation Study: The numerical simulation
method is similar to the energy-resolved CT projection generation methods described in [7] and[28]. For each attenuation
map of the phantom at each energy (F (E)), Radon transform
(R) was applied to obtain a noise-free sinogram data (G(E))
G(E) = R {F (E)} .

(8)

Then, the detected spectrum (N (E)) was first calculated from
the noise-free sinogram data according to the Beer–Lambert law
N (E) = D(E)S(E)e−G (E ) ,

(9)

where D(E) is the absorption efficiency of the detector, which
is set to 1 in this study, and S(E) is the primary X-ray tube
spectrum. Finally, Poisson noise to N (E) was injected into the
detected spectrum to simulate the noisy transmission measurement Np oi (E), i.e.,
Np oi (E) = Poisson(N (E)),

(10)

where Poisson(λ) generates a random number from the Poisson
distribution with a mean λ. In our study, an ideal energy-resolved
detector was simulated with five different discriminator units to
allow a binning of the detected pulses into the user-selectable
energy bins [29]. Fig. 1(a) shows the five energy bins with
[21, 40], [41, 60], [61, 80], [81,100], and [101,120] keV. The
assumption here is that those photons with energy lower than
20 keV were totally absorbed by the intrinsic filters. The five
energy bins are referred to as Bin 1 to Bin 5 for simplicity. The
noisy sinogram for each energy bin was calculated with


F. Evaluation Merits
1) Evaluation by Noise Reduction: The following metrics
were used to measure the noise reduction on the restored images
from the low-dose SCT images: 1) PSNR; and 2) normalized
mean square error (NMSE), i.e.,

	
max2 (μGS )
,
PSNR = 10 log10 
2
k (μ(k) − μGS (k)) /(K − 1)
 

NMSE =

E f (B )

Np oi (B) =

where D(B) denotes the mean absorption efficiency at specific
energy bin and is set to 1 in our study, and S(B) denotes the
number of incident X-ray intensity at each energy bin, and is
set to be 2.8 × 105 , 3.2 × 105 , 3.5 × 105 , 2.1 × 105 , and 2.0 ×
105 , respectively. A geometry that was a representative for a
fan-beam CT scanner setup with a circular orbit to acquire 1160
views over 2π was chosen. The number of channels per view
was 672 and the distance from the X-ray source to the detector
was 104.0 cm. The distance from the rotation center to the
curved detector was 47.0 cm. All the reconstructed images were
represented with 512 × 512 array with 0.625-mm pixel size.
2) Physical Phantom Data Study: A 64-detector dualenergy CT scanner (Discovery CT750 HD GE) was used to
scan the cylindrical phantom with four different tube potentials
(i.e., 80, 100, 120, and 140 kVp) to acquire the SCT images.
In all of the cases, the remaining CT parameters were set as
follows: 0.6-s tube rotation time, 1.25 mm collimation, 600-mA
tube current, 5-mm/5 mm slice thickness and interval for the
axial images, and 500-mm scan field of view (FOV). Gemstone
spectral imaging viewer software (GE Healthcare) was used to
process the projection data and review the images. The four
sets of different energy projections registered in time and space
were used to reconstruct CT images by using the manufacturer’s
“standard” reconstruction kernel.
3) Clinical Patient Data Study: The patient scan was scheduled for a head dual-energy CT study for medical reasons. All
head CT images were acquired with the 64-detector dual-energy
CT scanner (Discovery CT750 HD GE). In all of the cases, the
scanning parameters were as follows: 0.6 s per gantry rotation, 1.25 mm collimation, 630-mA tube current, 5 mm/5 mm
slice thickness and interval for the axial images, and “standard
reconstruction kernel”. Moreover, virtual monochromatic spectral (VMS) image with 60 keV was produced with the acquired
dual-energy CT images for comparison study.

Np oi (E),

(11)

E =E s (B )

where B denotes a range of energy, and Es denotes the starting
photon energy and Ef denotes the final energy. The resultant

k

μ(k) − μGS (k)

2
k (μGS (k))

(13)

2
,

(14)

where μ(k) is the intensity value at pixel k in the image μ,
μGS (k) is the intensity value at pixel k in the ideal phantom
image, and K is the number of image pixels. max(μGS ) denotes
the maximum intensity value of the ideal phantom image.

1048

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 4. Images at the first [(21–40) keV]–third [(61–80) keV] (from left to right) energy bins obtained from simulation of a energy-resolved detector CT system.
The 120-kVp spectrum was divided into five energy bins of equivalent width (20 keV). Images were reconstructed by a standard FBP technique, and restored by
the HYPR-LR, NLM (α b in 1 = 1.5 × 10 −3 , α b in 2 = 2.6 × 10 −3 , α b in 3 = 1.0 × 10 −3 ), and aviNLM algorithms (τ b in 1 = 2.0 × 10 −3 , τ b in 2 = 3.0 × 10 −3 ,
τ b in 3 = 1.5 × 10 −3 ). Two zoomed regions indicated by the marks with C5 and C6 are also shown. All the images are displayed with the same window: [0.005,
0.035] mm −1 .

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

Fig. 5.

1049

MTF curves from the HYPR-LR, NLM, and aviNLM algorithms in: (a) (21–40) keV, (b) (41–60) keV, and (c) (61–80) keV energy bins.

Fig. 6. Image noise measured at the five ROIs in each of the five energy bins. (a) noise measure of ROI A; (b) noise measure of ROI B; (c) noise measure of ROI
C; (d) noise measure of ROI D; and (e) noise measure of ROI E.

Fig. 7. Horizontal profiles through the center of both the brain insert (C5) and the polyethylene insert (C6) in the reconstructed clock phantom images
corresponding to five energy bins. (a) Profile of the first energy bin; (b) profile of the second energy bin; (c) profile of the third energy bin; (d) profile of the
fourth energy bin; and (e) profile of the fifth energy bin. The profiles located at the pixel position x from 192 to 315 and y = 256. The “black solid line” denotes
the profiles of the ground truth; the “green solid line” donates the profiles of the HYPR-LR algorithm; the “dot-dashed line” denotes the profiles from the NLM
algorithm; and the “dashed line” denotes the profiles from the aviNLM algorithm. The unit is mm−1 .

2) Evaluation by CNR Measure: Since a low-contrast region
is of interest in the SCT imaging, we selected four ROIs (as
indicated by squares with a size of 8 × 8 pixels in Fig. 2) to
calculate the CNR
|μ̄ROI − μ̄BG |
,
CNR =  2
2
σROI + σBG

(15)

where μ̄ROI is the mean of the pixels inside the ROI, and μ̄BG is
the mean of the pixels in the background. The terms σROI and
σBG denote the SDs of the pixel values inside the ROI and in
the background region, respectively.
3) Image-Similarity Metric: The UQI [31] was used in our
study to measure the similarity between the reconstructed and
truth samples. Given the aligned ROI within the reconstructed
and ideal phantom images, the associated mean, variance, and

covariance over the ROI can be calculated as follows:
μ̄ =

M
1 
μ(m),
M m =1

Cov {μ, μGS } =

σ2 =

M

1
(μ(m) − μ̄)2 , (16)
M − 1 m =1

M

1
(μGS (m) − μ̄GS )(μ(m) − μ̄),
M − 1 m =1

(17)
where M denotes the number of pixels in the ROI. The UQI can
be written as follows:
4Cov {μ, μGS } μ̄ · μ̄GS
· 2
,
(18)
UQI =
2
σ 2 + σGS
μ̄ + μ̄2GS
where μ and μGS denote the reconstructed and ideal phantom
images, respectively. The value of UQI ranges between 0 and 1,

1050

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

TABLE I
CNR MEASURE OF FIRST ENERGY BIN IMAGES FROM DIFFERENT ALGORITHMS
Methods

ROI A

ROI B

ROI C

ROI D

FBP
HYPR-LR
NLM
aviNLM

1.9687
2.0310
2.1953
2.3842

1.3994
1.6272
1.8907
1.9056

1.1574
1.9193
2.3273
2.4246

1.2236
1.6538
1.7247
2.0653

and the value of UQI is closer to 1 when the reconstructed image
is more similar to the original image.
4) Modulation Transfer Function (MTF): The resolution
property of the present aviNLM algorithm was studied using
an MTF, which characterizes the spatial resolution of images.
For the MTF computation, an edge spread function (ESF) was
first obtained along the profile at one axial direction on the
insert as indicated by the red arrows in Figs. 2(b) and 3(b), respectively. The ESF was resampled using first-order polynomial
interpolation. The resampled ESF was averaged across multiple
ESF realizations (measured at 3, 6, 9, and 12 o’clock positions)
to yield the ensemble ESF aiming to reduce noise in ESF. A line
spread function (LSF) was then obtained from the derivation
of the ensemble ESF. The resultant LSF was multiplied by a
Hann window to remove the noise in tails [32]. By applying the
Fourier transformation of the LSF, the MTF could be obtained.
In this case, normalization may be needed so that MTF(0)=1.
5) Subjective Assessment: For subjective assessment, five
radiologists with at least five years of experience in CT imaging
scored the four VMS images by using different algorithms for
each of the following attributes: image noise, artifacts, edge and
structure, overall monochromatic image quality, and cylindrical
tube size and boundary estimation with the same width, window
level, and FOV. The scoring was done on a five-point scale:
excellent is 5; good is 4; adequate is 3; suboptimal is 2; poor is
1.
G. Other Experiments’ Settings
To validate and evaluate the performance of the present
aviNLM algorithm, the FBP algorithm with the Ramp filter,
the HYPR-LR algorithm [3], and the NLM algorithm [25] were
adopted for comparison.
In the implementation of the HYPR-LR algorithm, we generated a composite image μav by averaging all of the images in the
energy domain, and then performed an image filter operation on
each individual energy image μbin and the composite image μav ,
and finally yielded a weighting image by the ratio between these
two filtered images. Mathematically, the HYPR-LR algorithm
is written as follows:
μbin ⊗ T
· μav ,
(19)
HYPR(μbin ) =
μav ⊗ T
where T is a low-pass filter kernel. The symbol ⊗ denotes
the convolution process. According to the analysis in [3], the
noise variance of HYPR-LR images is mainly determined by the
composite images, and streaks are reduced by normalizing each
individual energy image to the composite image. In this study,

TABLE II
CNR MEASURE OF SECOND ENERGY BIN IMAGES FROM
DIFFERENT ALGORITHMS
Methods

ROI A

ROI B

ROI C

ROI D

FBP
HYPR-LR
NLM
aviNLM

0.8201
1.2352
1.6377
2.4865

0.9312
1.9575
2.0891
2.1324

1.0578
1.8570
2.1214
2.1817

1.6538
1.7547
2.0817
2.1654

TABLE III
CNR MEASURE OF THIRD ENERGY BIN IMAGES FROM
DIFFERENT ALGORITHMS
Methods

ROI A

ROI B

ROI C

ROI D

FBP
HYPR-LR
NLM
aviNLM

1.1499
1.4191
1.5374
1.6458

0.8449
1.0476
1.4809
1.5277

1.2439
1.2568
1.6507
2.0330

1.6014
1.7854
1.8475
1.9687

TABLE IV
NMSES (×10 −3 ) MEASURED IN EACH OF THE THREE ENERGY BINS FROM
DIFFERENT ALGORITHMS
Methods

FBP

HYPR-LR

NLM

aviNLM

Bin 1
Bin 2
Bin 3
Bin 4
Bin 5

1.25
1.26
1.10
1.21
1.16

1.18
1.22
1.09
1.10
1.17

1.06
1.07
0.978
0.957
0.987

0.667
0.686
0.970
0.945
0.969

TABLE V
PSNRS (DB) MEASURED IN EACH OF THE THREE ENERGY BINS FROM
DIFFERENT ALGORITHMS
Methods
Bin 1
Bin 2
Bin 3
Bin 4
Bin 5

FBP

HYPR-LR

NLM

aviNLM

39.686
40.001
39.614
38.768
38.887

39.957
40.133
39.624
39.184
38.861

40.432
40.691
40.138
39.793
39.597

42.425
42.629
40.170
39.849
39.677

we ran several preliminary experiments with different filter sizes
(i.e., 7 × 7, 9 × 9, and 11 × 11) and performed extensive
experiments by quantitative measurements (i.e., PSNR, CNR,
and UQI) and visual inspection compared to the ideal phantom
and high-quality reference image, and we found that a Gaussian
filter kernel with the size of 9 × 9 pixels was adequate to suppress
noise and artifacts for all the cases in this study.
In the implementation of the NLM algorithm, we modified its
nonlocal weights by using the equation h2 = 2ασ 2 |Ni |, which
considers the size of the search-window centered at pixel i. The
SD σ of the energy-specific image μbin was estimated with a
robust median estimator [33]. Extensive experiments showed
that the search- and patch-windows with 17 × 17 and 5 × 5
sizes were also proper for the original NLM algorithm. The
scale factors α for the NLM and τ for aviNLM algorithms were

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

1051

Fig. 8. UQIs of four regions indicated by the squares with the symbol Ci (i = 1, 2, 3, 4) in Fig. 2 from the reconstructed images by four different algorithms
from five energy bin. (a) UQI measure of first energy bin images; (b) UQI measure of second energy bin images; (c) UQI measure of third energy bin images; (d)
UQI measure of fourth energy bin images; and (e) UQI measure of fifth energy bin images.

Fig. 9. Decomposed images of basis materials and comparison of basis material concentration obtained using different algorithms. Left column: Iodine images
from the material decomposition method after the (a) FBP algorithm, (b) HYPR-LR algorithm, (c) NLM algorithm, and (d) aviNLM algorithm processing. All
iodine images are displayed at the same window: [0, 5.4] g/cm3 . Right column: Decomposed iodine concentration as a function of different algorithm. The iodine
concentration during simulations was 4.99 g/cm3 . The error bars represent the SD.

determined with the trial-and-error method for visually appealing results compared with the ideal phantom or the high-quality
reference image. All the algorithms were implemented in MATLAB R2011a (The MathWorks, Inc.,) programing environment.
The codes were run on a typical desktop computer with Intel(R)
Core (TM) i5-2400 Processor, 3.10 GHz, and 4 GB of RAM
memory.
III. RESULTS
A. Numerical Simulation Study
Fig. 4 shows the images of the clock phantom reconstructed
with four different algorithms. The upper row images show
that the noise levels of the FBP image varied from one energy
bin to another because the noise level of the FBP images not
only depends on the different photon numbers available in each
energy bin, but also depends on the energy-dependent linear
attenuation coefficients of different materials. The images from
the right energy ranges (e.g., 60–80 keV) had relatively lower

noise levels than those from other energy ranges (e.g., 20–40
keV). The results from the second row to the fourth row demonstrate that the proposed aviNLM algorithm can yield remarkable
gains over the other three algorithms in terms of noise-induced
artifact suppression and resolution preservation at any energy
range. Zoomed images of two ROIs, marked by the symbols
C5 and C6 in Fig. 2, are drawn in Fig. 4 to further illustrate the
gains of the aviNLM algorithm. Fig. 5 shows the MTFs obtained
by the HYPR-LR, NLM, and aviNLM algorithms in the first,
second, and third energy bin. We can observe that the aviNLM
algorithm can yield a better image resolution than the other two
algorithms in all the cases. Fig. 6 presents the results of the noise
measures at the five ROIs (as indicated by squares with a size
of 8 × 8 pixels in Fig. 2) from the five bin images yielded by
four different algorithms. The figure depicts that the HYPR-LR,
NLM, and aviNLM algorithms can achieve significant noise reduction; however, the aviNLM algorithm slightly outperforms
the other two algorithms in that it achieved approximately 60%
noise reduction in the five ROIs compared with the 30% and

1052

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 10. Images reconstructed using the standard FBP, HYPR-LR, NLM (α 8 0 = 1.0 × 10 −3 , α 1 0 0 = 1.5 × 10 −3 , α 1 2 0 = 1.2 × 10 −3 , α 1 4 0 = 1.9 × 10 −3 ),
and aviNLM algorithms (τ 8 0 = 8.0 × 10 −2 , τ 1 0 0 = 4.0 × 10 −2 , τ 1 2 0 = 1.5 × 10 −2 , τ 1 4 0 = 3.0 × 10 −2 ) from a clinical dual-energy CT scanner using an
integrating detector system with tube potentials of 80, 100, 120, and 140 kVp from left to right. The ROIs indicated by the dashed squares in Fig. 3 are zoomed in
to display the image details. All the images are displayed with the same window: [500, 2000] HU.

50% noise reduction of the HYPR-LR and NLM algorithms,
respectively.
Fig. 7 shows the horizontal profiles through the center of both
the brain insert (C5) and the polyethylene insert (C6) in the reconstructed images at five energy bins. The aviNLM algorithm
yielded a profile closer to the truth compared with those of the
other algorithms, especially in the edge region, as indicated by a
black arrow in Fig. 7. The profile comparisons show that higher
low-contrast detectability and more noticeable edge preservation can be achieved by the aviNLM algorithm than those of
the other three algorithms. Tables I, II, and III show the CNR
measures at the four ROIs (ROI A–ROI D) as indicated by

squares in Fig. 2, wherein ROI E was used to measure the background noise level. It can be observed that the aviNLM filter
can yield higher CNRs than the other three algorithms in all the
cases.
Tables IV and V show the NMSEs and PSNRs of the images
reconstructed with the four different algorithms. The gains from
the aviNLM algorithm are more noticeable compared with those
from the other three algorithms in terms of NMSE and PSNR.
In other words, the aviNLM algorithm can yield higher noise
reduction than the other three algorithms in SCT image filtering.
Fig. 8 shows the UQI values of the four regions indicated by
the squares with the symbol Ci (i = 1, 2, 3, 4) in Fig. 2. The

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

1053

Fig. 11. Mean image density and image noise measured at the three ROIs (i.e., squares A, B, and C) in each of the four tube potentials in Fig. 10 using the
standard FBP, HYPR-LR, NLM, and aviNLM algorithms. The error bars represent one SD. The unit is HU.

Fig. 12. MTF curves from the HYPR-LR, NLM, and aviNLM algorithms in four different cases. (a) Case of 80 kVp; (b) case of 100 kVp; (c) case of 120 kVp;
and (d) case of 140 kVp.

gains from the aviNLM algorithm are more noticeable compared
with those from the other three algorithms in terms of the UQI
measure in the four regions.
Fig. 9 shows the decomposed images of basis materials from
four different algorithms. In the implementation of decomposition, the iodine (material of the heighten area) and the water
(material of the background) are chosen as the basis materials. The mean and SDs in iodine are calculated on the ROI as

indicated by a square in Fig. 9(a) and the associated results are
shown in Fig. 9(e). It can be seen that the direct matrix inversion
of the FBP images results in a high noise level of the decomposed image, but the noise level in the iodine images from the
aviNLM algorithm is much lower than that from the HYPR-LR
and NLM algorithms. In other words, the aviNLM algorithm can
outperform the other three algorithms in differentiating iodine
and water with a low noise level.

1054

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 13. Decomposed images of basis materials. Row one: The water images from the material decomposition algorithm after the FBP, HYPR-LR, NLM, and
aviNLM processing. Row two: The iodine images from material decomposition method after the FBP, HYPR-LR, NLM, and aviNLM processing, respectively.
All water image are displayed at the same window: [0, 1000] mg/mL and all iodine image are displayed at the same window: [−5, 30] mg/mL.

Fig. 14. Histograms of material concentrations measured in the #1 and #8 tubes through the HYPR-LR, NLM, and aviNLM algorithms. (a) Histograms of
material concentrations of iodine in the #1, wherein a purple vertical line in the histogram indicates the known concentration of iodine in #1. (b) Histograms of mate
rial concentrations of iodine in the #8, wherein a cyan vertical line in the histogram indicates the known concentration of iodine in #8. (c) Histograms of material
concentrations of water in the #1, wherein a purple vertical line in the histogram indicates the known concentration of water in #1. (d) Histograms of material
concentrations of water in the #8, wherein a cyan vertical line in the histogram indicates the known concentration of water in #8.

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

1055

Fig. 15. Images from the standard FBP, HYPR-LR, NLM (α 8 0 = 3.0 × 10 −3 , α 1 4 0 = 5.0 × 10 −3 ), and aviNLM algorithms (τ 8 0 = 8.0 × 10 −2 , τ 1 4 0 =
4.0 × 10 −2 ) where the original data were acquired by using a dual-energy CT scanner with tube potentials of 80 and 140 kVp from top to bottom. All the images
are displayed with the same window: [900, 1250] HU.

TABLE VI
LSNR MEASUREMENTS OF 80-KVP IMAGES FROM DIFFERENT ALGORITHMS
Methods
LSNR (ROI 1)
LSNR (ROI 2)

FBP

HYPR-LR

NLM

aviNLM

20.369
11.145

50.558
32.605

80.269
33.591

100.125
33.845

TABLE VII
LSNR MEASUREMENTS OF 140-KVP IMAGES FROM DIFFERENT ALGORITHMS
Methods
LSNR (ROI 1)
LSNR (ROI 2)

FBP

HYPR-LR

NLM

aviNLM

11.371
17.445

22.041
32.105

23.345
33.592

34.163
43.145

B. Physical Phantom Data Study
Fig. 10 shows the images of the real phantom from four
different algorithms. From the upper row to the bottom row,
it can be seen that the images reconstructed by the HYPRLR, NLM, and aviNLM algorithms were better than that from
the FBP algorithm in terms of visual inspection. Noticeable
differences among the results can be observed at the two selected
ROIs marked by the symbols C1 and C2 in Fig. 3(b). As a
result, the aviNLM algorithm achieves significant gains over the
other algorithms in terms of both noise suppression and edge
preservation. In addition, we calculated the mean and SD of the
CT number of three red square ROIs (i.e., squares A, B, and
C) in Fig. 3(b) to quantitatively evaluate image quality, and the
associated results are shown in Fig. 11. The aviNLM algorithm
can reach higher restoration accuracy than HYPR-LR and NLM
algorithms as measured by the SD of the image density within
each ROI.

Fig. 12 shows the MTFs of the restored physical phantom
images by the HYPR-LR, NLM, and aviNLM algorithms, respectively. It can be observed that the spatial resolution of the restored images by the aviNLM algorithm is much better than that
from the other two algorithms. Fig. 13 shows the decomposed
basis material images from four different algorithms, wherein
the iodine and water were chosen as the basis materials and
the mass attenuation coefficients of these two basis materials
are accessible with instruction from the CT vendor. It can be
observed that the noise level in both water and iodine images
from the aviNLM algorithm is lower than the other three algorithms. Furthermore, to illustrate the precision of the material
decompositions, the concentrations of water and iodine at ROI
C in #1 and ROI D in #8 as indicated in Fig. 3 are estimated
and depicted with the histograms, respectively. The results are
shown in Fig. 14, which illustrate the accuracy and precision of
the material decompositions within the included material tubes
#1 and #8. The expected concentrations of water and iodine in
#1 and #8 are (1000 mg/mL, 1.0 mg/mL) and (1000 mg/mL, 50
mg/mL), respectively. In addition, the expected concentration
are also included and indicated by vertical lines for comparison.
It can be seen that the correlations between the expected and
measured material concentrations of iodine and water within
both tubes from the aviNLM algorithm are stronger than that
from the other three algorithms.
C. Clinical Patient Data Study
Fig. 15 shows the real patient CT images restored by four different algorithms. It can be seen that the results from the HYPRLR, NLM, and aviNLM algorithms have noticeable gains over
that from the FBP algorithm in terms of visual inspection.
Tables VI and VII list the local signal-to-noise ratio (LSNR)

1056

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 16. VMS images (60 keV) generated from 80 and 140 kVp images. (a) From the FBP algorithm; (b) from the HYPR-LR algorithm; (c) from the NLM
algorithm; and (d) from the aviNLM algorithm. All the images are displayed with the same window: [900, 1250] HU.

of two blue square ROIs as indicated in Fig. 15. The LSNR
is defined as the ratio of the mean and SD of the intensity in
each local region. It can be seen that the LSNR of the restored
images by the aviNLM algorithm is higher than that from the
other two restoration algorithms. Furthermore, Fig. 16 shows
the VMS images (60 keV) generated from these images. The
aviNLM algorithm can yield the noticeable gains over the other
three algorithms in terms of noise suppression of VMS images.
In addition, Table VIII lists the subjective scores in the four
images, which indicates that the aviNLM algorithm can yield
higher subjective image score than the other three algorithms in
generating high-quality VMS images.
IV. DISCUSSION
The original NLM algorithm restores the intensity of each
image pixel by averaging the intensities of its neighboring pixels. The averaging weight is based on self-similarity in images
through comparison of local neighborhoods. The similarity between a given pixel pair is robustly derived from the intensity
differences between the patches of neighboring pixels surrounding them. Conceptually, the averaging weights can be interpreted
as a probability distribution with normalization to unity and is
always positive. Clearly, optimizing the weights plays a crucial role in the NLM algorithm. Up to now, many NLM-based
methods have been proposed to yield optimal nonlocal weights
[24], [34], [35]. In this study, an alternative strategy called the
aviNLM algorithm is proposed to design the weights for SCT
image restoration on the basis of our previous work [24], [36]–
[38]. The experimental results in Section III have shown that
the aviNLM algorithm can yield more significant performance
gains than the existing HYPR-LR and NLM algorithms in terms
of different measurement metrics.
The redundant information in the whole energy domain was
exploited to optimize the construction of weights and improve
the NLM weighted average. The gain from using the redundant information over the spectral domain is noticeable. In this
study, the weights of the aviNLM algorithm were calculated by
incorporation of an average image generated from the images
reconstructed at all energy bins. In the implementation, other
image generation methods can also be adapted into the aviNLM

TABLE VIII
SUBJECTIVE SCORES OF VMS IMAGES (60 KEV) FROM DIFFERENT
ALGORITHMS
Methods
Subjective scores

FBP

HYPR-LR

NLM

aviNLM

2.32 ± 0.55

3.52 ± 0.77

3.90 ± 0.85

4.15 ± 0.58

algorithm in the image domain, such as the maximum intensity
projection volume of the SCT images in all energy domains and
optimally weighted SCT images [39].
For the present aviNLM algorithm, an average image generated from the images reconstructed in all energy bins provides
strong a priori information on the patient and is a logical choice
to induce SCT image restoration. In the most SCT systems, such
as photon-counting CT and dual-energy CT systems, the image
data at different energy bins are simultaneously obtained; therefore, tissue deformation is of minimal concern. For slow-kVp
based SCT systems, misalignments across the individual energy
bins may be observed in the patient’s anatomy because of tissue
deformation. Therefore, for the HYPR-LR algorithm, dedicated
image registration techniques are needed to fully use the prior
image of the same patient because it is a pixel-based image
filtering operation with the assumption of prior and objective
image being aligned pixel by pixel. Meanwhile, as previously
discussed [24], the challenge of tissue deformation may not be
a major obstacle for the ndiNLM algorithm because the algorithm does not heavily depend on the accuracy of the image
registration. Consequently, an important novelty of the present
aviNLM algorithm in this study is the utilization of the images in
all energy bins without the need for accurate image registration.
In this approach, some parameters need to be determined.
Optimizing parameters is a critical problem, and determining the
best parameters is an empirical, subjective, and time-consuming
trial-and-error process. Additionally, analyzing the relationship
between noise and structure information in the noise reduction
process is possible. As described in Section II-C, a comparison
of the quantitative measures and visual inspection on the ideal
phantom or high-quality reference image helped to empirically
determine the parameters for the aviNLM algorithm in a trialand-error manner. In practical applications, determining all of

ZENG et al.: SPECTRAL CT IMAGE RESTORATION VIA AN AVERAGE IMAGE-INDUCED NONLOCAL MEANS FILTER

the parameters should be adaptive, but this task is difficult.
Therefore, additional theoretical insights into optimizing the
parameters are necessary, and these may be a topic for future
research.
V. CONCLUSION
In this study, we proposed an aviNLM filter for SCT image restoration based on our previous studies [24], [36]–[38].
Specifically, the proposed aviNLM filter yields the restored results by performing a nonlocal weighted average operation on
the noisy energy-specific images with the nonlocal weight matrix between the target and prior images, in which the prior
image is generated from all of the images reconstructed in each
energy bin. The experimental results in Section III have shown
that the aviNLM algorithm can yield more significant performance gains than the existing HYPR-LR and NLM algorithms
in terms of different measurement metrics. In other words, the
proposed aviNLM algorithm has useful potential for radiation
dose reduction by lowering the mAs in SCT imaging.
ACKNOWLEDGMENT
The authors would like to thank anonymous reviewers for
their constructive comments and suggestions that greatly improve the quality of the manuscript.
REFERENCES
[1] P. M. Shikhaliev et al., “Photon counting computed tomography: Concept
and initial results,” Med. Phys., vol. 32, pp. 427–436, Jan. 2005.
[2] P. M. Shikhaliev, “Photon counting spectral CT: Improved material decomposition with K-edge-filtered x-rays,” Phys. Med. Biol., vol. 57,
pp. 1595–1615, Mar. 2012.
[3] S. Leng et al., “Noise reduction in spectral CT: Reducing dose and breaking the trade-off between image noise and energy bin selection,” Med.
Phys., vol. 38, pp. 4946–4957, Aug. 2011.
[4] R. E. Alvarez and A. Macovski, “Energy-selective reconstructions in Xray computerized tomography,” Phys. Med. Biol., vol. 21, pp. 733–744,
Sep. 1976.
[5] W. A. Kalender et al., “Evaluation of a prototype dual-energy computed
tomographic apparatus. I. Phantom studies,” Med. Phys., vol. 13, pp. 334–
339, Jan. 1986.
[6] D. J. Walter et al., “Accuracy and precision of dual energy CT imaging
for the quantification of tissue fat content,” presented at the Proc. SPIE
Medical Imaging, San Diego, CA, USA, 2006, vol. 6142, Paper 61421G.
[7] H. Q. Le and S. Molloi, “Least squares parameter estimation methods
for material decomposition with energy discriminating detectors,” Med.
Phys., vol. 38, pp. 245–255, Dec. 2010.
[8] M. Barreto et al., “Potential of dual-energy computed tomography to characterize atherosclerotic plaque: Ex vivo assessment of human coronary
arteries in comparison to histology,” J. Cardiovasc. Comput. Tomography,
vol. 2, pp. 234–242, Aug. 2008.
[9] B. Heismann et al., Spectral Computed Tomography. Belingham, WA,
USA: SPIE, 2012, pp. 25–87.
[10] K. Taguchi and J. S. Iwanczyk, “Vision 20/20: Single photon counting
x-ray detectors in medical imaging,” Med. Phys., vol. 40, pp. 100901-1–
100901-19, Sep. 2013.
[11] P. M. Shikhaliev, “Tilted angle CZT detector for photon counting/energy
weighting x-ray and CT imaging,” Phys. Med. Biol., vol. 51, pp. 4267–
4287, Aug. 2006.
[12] Y. Alivov et al., “Optimization of K-edge imaging for vulnerable plaques
using gold nanoparticles and energy resolved photon counting detectors:
A simulation study,” Phys. Med. Biol., vol. 59, pp. 135–152, Jan. 2014.
[13] P. Sukovic and N. H. Clinthorne, “Penalized weighted least-squares image
reconstruction for dual energy X-ray transmission tomography,” IEEE
Trans. Med. Imag., vol. 19, no. 11, pp. 1075–1081, Nov. 2000.

1057

[14] J. A. Fessler et al., “Maximum-likelihood dual-energy tomographic image
reconstruction,” in Proc. SPIE Med. Imag., 2002, vol. 4684, pp. 38–49.
[15] J. A. O’Sullivan and J. Benac, “Alternating minimization algorithms
for transmission tomography,” IEEE Trans. Med. Imag., vol. 26, no. 3,
pp. 283–297, Mar. 2007.
[16] W. Huh and J. A. Fessler, “Model-based image reconstruction for dualenergy X-ray CT with fast KVP switching,” in Proc IEEE Int. Symp.
Biomed. Imag., From Nano Macro, 2009, pp. 326–329.
[17] R. Zhang et al., “Model-based iterative reconstruction for dual-energy
X-ray CT using a joint quadratic likelihood model,” IEEE Trans. Med.
Imag., vol. 33, no. 1, pp. 117–134, Jan. 2014.
[18] J. Noh et al., “Low-dose dual-energy computed tomography for PET
attenuation correction with statistical sinogram restoration,” in Proc. SPIE
Med. Imag., 2008, vol. 6913, pp. 691312-1–691312-10.
[19] J. Noh et al., “Statistical sinogram restoration in dual-energy CT for
PET attenuation correction,” IEEE Trans. Med. Imag., vol. 28, no. 11,
pp. 1688–1702, Nov. 2009.
[20] W. Huh and J. A. Fessler, “Iterative image reconstruction for dual-energy
X-ray CT using regularized material sinogram estimates,” in Proc IEEE
Int. Symp. Biomed. Imag., From Nano Macro, 2011, pp. 1512–1515.
[21] R. A. Rutherford et al., “Measurement of effective atomic number
and electron density using an EMI scanner,” Neuroradiology, vol. 11,
pp. 15–21, May 1976.
[22] W. A. Kalender et al., “An algorithm for noise suppression in dual energy
CT material density images,” IEEE Trans. Med. Imag., vol. 7, no. 3,
pp. 218–224, Sep. 1988.
[23] R. A. Rutherford et al., “X-ray energies for effective atomic number
determination,” Neuroradiology, vol. 11, pp. 23–28, May 1976.
[24] J. Ma et al., “Low-dose computed tomography image restoration using
previous normal-dose scan,” Med. Phys., vol. 38, pp. 5713–5731, Sep.
2011.
[25] A. Buades et al., “A review of image denoising algorithms, with a new
one,” Multiscale Model. Simul., vol. 4, pp. 490–530, Jul. 2005.
[26] J. M. Boone and J. A. Seibert, “An accurate method for computergenerating tungsten anode x-ray spectra from 30 to 140 kV,” Med. Phys.,
vol. 24, pp. 1661–1670, Aug. 1997.
[27] X. Dong et al., “Combined iterative reconstruction and image-domain
decomposition for dual energy CT using total-variation regularization,”
Med. Phys., vol. 41, pp. 051909-1–051909-9, Aug. 2014.
[28] P. M. Shikhaliev, “Beam hardening artefacts in computed tomography
with photon counting, charge integrating and energy weighting detectors:
a simulation study,” Phys. Med. Biol., vol. 50, pp. 5813–5827, Nov. 2005.
[29] J. P. Schlomka et al., “Experimental feasibility of multi-energy photoncounting K-edge imaging in pre-clinical computed tomography,” Phys.
Med. Biol., vol. 53, pp. 4031–4047, Jul. 2008.
[30] A. C. Kak and M. Slaney, Principles of Computerized Tomographic Imaging. New York, NY, USA: IEEE Press, 1988, pp. 203–270.
[31] Z. Wang and A. Bovik, “A universal image quality index,” IEEE Signal
Process. Lett., vol. 9, no. 3, pp. 81–84, Mar. 2002.
[32] S. Richard et al., “Towards task-based assessment of CT performance:
System and object MTF across different reconstruction algorithms,” Med.
Phys., vol. 39, pp. 4115–4122, Jun. 2012.
[33] D. L. Donoho and J. Johnstone, “Ideal spatial adaptation by wavelet shrinkage,” Biometrika, vol. 81, pp. 425–455, Sep. 1994.
[34] P. Coupe et al., “An optimized blockwise nonlocal means denoising filter
for 3-D magnetic resonance images,” IEEE Trans. Med. Imag., vol. 27,
no. 4, pp. 425–441, Apr. 2008.
[35] Y. Gal et al., “Denoising of dynamic contrast-enhanced MR images using dynamic nonlocal means,” IEEE Trans. Med. Imag., vol. 29, no. 2,
pp. 302–310, Feb. 2010.
[36] Z. Bian et al., “SR-NLM: A sinogram restoration induced non-local means
image filtering for low-dose computed tomography,” Comput. Med. Imag.
Graph., vol. 37, pp. 293–303, Jun. 2013.
[37] J. Huang et al., “Projection data restoration guided non-local means for
low-dose computed tomography reconstruction,” in Proc IEEE Int. Symp.
Biomed. Imag., From Nano Macro, 2011, pp. 1167–1170.
[38] J. Ma et al., “Iterative image reconstruction for cerebral perfusion CT
using a pre-contrast scan induced edge-preserving prior,” Phys. Med. Biol.,
vol. 57, pp. 7519–7542, Oct. 2012.
[39] T. G. Schmidt, “Optimal ‘image-based’ weighting for energy-resolved
CT,” Med. Phys., vol. 36, pp. 3018–3027, Jun. 2009.

Authors’ photographs and biographies not available at the time of publication.

