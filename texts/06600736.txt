IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

703

A Rule-Based Decision-Making Diagnosis System to
Evaluate Arteriovenous Shunt Stenosis for
Hemodialysis Treatment of Patients
Using Fuzzy Petri Nets
Wei-Ling Chen, Chung-Dann Kan, Chia-Hung Lin, and Tainsong Chen

Abstract—This paper proposes a rule-based decision-making
diagnosis system to evaluate arteriovenous shunt (AVS) stenosis
for long-term hemodialysis treatment of patients using fuzzy petri
nets (FPNs). AVS stenoses are often associated with blood sounds,
resulting from turbulent flow over the narrowed blood vessel.
Phonoangiography provides a noninvasive technique to monitor
the sounds of the AVS. Since the power spectra changes in frequency and amplitude with the degree of AVS stenosis, it is difficult
to make a human-made decision to judge the degree using a combination of those variances. The Burg autoregressive (AR) method
is used to estimate the frequency spectra of a phonoangiographic
signal and identify the characteristic frequencies. A rule-based
decision-making method, FPNs, is designed as a decision-making
system to evaluate the degree of stenosis (DOS) in routine examinations. For 42 long-term follow-up patients, the examination results
show the proposed diagnosis system has greater efficiency in evaluating AVS stenosis.
Index Terms—Arteriovenous shunt (AVS), Burg autoregressive
(AR) method, degree of stenosis (DOS), fuzzy petri net (FPN),
phonoangiography.

I. INTRODUCTION
ND-STAGE renal disease (ESRD) is an irreversible disease with high rates of morbidity and mortality [1]. Patients suffering ESRD are treated with hemodialysis, peritoneal
dialysis, or kidney transplant. Hemodialysis is one choice for
ESPD patients, but arteriovenous shunt (AVS) occlusion and
failure lead to thrombosis, resulting in repeated puncturing of
the arteriovenous accesses and long-term use. Therefore, the
interior of the vascular accesses can cause intimal hyperplasia

E

Manuscript received March 13, 2013; revised May 12, 2013 and July 7, 2013;
accepted August 22, 2013. Date of publication September 16, 2013; date of current version March 3, 2014. This work was supported by the Medical Device
Innovation Center (MDIC) at National Cheng Kung University, under Contract
D102-21001 (January 1, 2013–December 31, 2013).
W.-L. Chen and T. Chen are with the Department of Biomedical Engineering, National Cheng Kung University, Tainan City 701, Taiwan (e-mail:
p88991107@mail.ncku.edu.tw; chents@mail.ncku.edu.tw.)
C.-D. Kan is with the Department of Surgery, National Cheng Kung University Hospital, Tainan City 701, Taiwan (e-mail: kcd56@mail.ncku.edu.tw).
C.-H. Lin is with the Department of Electrical Engineering, Kao-Yuan University, Kaohsiung City 82151, Taiwan (e-mail: t21025@cc.kyu.edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2279595

and aneurysmal deformability. Any narrowing of the interior
of the access increases the physical stress on the vascular wall
and produces vibrations, turbulent flow, and high blood pressure [2]. A greater than 50% narrowing of the lumen diameter
in the vascular access may result in a need for percutaneous
transluminal angioplasty (PTA) or surgical intervention [3], [4].
In clinical evaluation, angiography (X-ray), Doppler ultrasound,
intravascular ultrasound imaging, and phonoangiography (PCG)
are used to detect the presence of a stenosis within these vascular accesses [5], [6]. Stationary instruments provide reliable
techniques and high accuracy in clinical applications. However,
they need to appreciate the operational principles, and need extra learning for limitations by the patients themselves. They are
not suitable for early detection or homecare applications by the
patients themselves. Therefore, this paper proposes a noninvasive measurement, free of irradiation technique, and decisionmaking method to evaluate the DOS, purporting for screening
the degree of AVS senosis.
As an early detection tool, phonoangiography provides a noninvasive technique to monitor the sounds of the AVS. In software
applications, studies [7]–[10] have shown the stenosis produces
higher frequency components in the frequency spectra, and spectral changes in frequency and magnitude. Frequency analysis
methods, such as Fourier transform (FT) and wavelet transform
(WT), used the frequency spectra of the phonoangiographic
signals to determine the specific parameters for stenosis evaluation. However, traditional FT has spectral leakage effects and
cannot localize the observed characteristic frequency because
of the size of the sampling window. The wavelet method has
both time and frequency resolutions to decompose the low- and
high-frequency components using a trial procedure of wavelet
decomposition. In hardware applications, an embedded system
(ES) can be applied to design a portable diagnosis system, as
shown in Fig. 1. The current technique uses a built-in digital
signal processor (DSP) to support signal preprocessing and digital filters to obtain the frequency spectra. However, it lacks an
automatic diagnosis function.
To overcome the above-mentioned limitations, the Burg
method was used to estimate the frequency spectra by fitting an autoregressive (AR) model of a given specific AR order [10], [11]. It produces smoother spectra than the FT method
and is used to find the characteristic frequencies. For DOS
evaluation, artificial intelligence methods have been applied to

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

704

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

providing a reliable acquisition window to perform segmentation of the PCG signals. Before analyzing the envelope of each
PCG signal, the high-pass filter with the cut-off frequency 25 Hz
was implemented to remove the baseline wander and after that
a low-pass filter with 200 Hz [10]. The spectral peaks of frequency spectra, the region of 25 to 800 Hz, can be identified and
are normalized between zero and one by a Burg AR method.
B. Burg AR Method

Fig. 1.

Portable ES-based diagnosis system.

perform classification tasks, such as support vector machines
(SVMs) and neural networks. They provide promising solutions, but the algorithms are not easy to implement in hardware,
due to the need to assign many parameters and tune network
parameters. The fuzzy petri net (FPN) [12]–[15] is a dynamic
and marked graphical system, and extends to develop an algorithm to deal with fuzzy reasoning problems and multicriteria
decision-making applications. It is used for representing fuzzy
inference rules in the knowledge base system, and can perform
fuzzy reasoning to evaluate the degree of specified proposition.
The reasoning capability of FPN allows computers to perform
reasoning in a more flexible manner and is easy to program into
the ES and field-programmable gate array (FPGA) chip. For
42 long-term follow-up patients, the results show the proposed
diagnosis system is more efficient in evaluating AVS stenosis.

The Burg AR method is applied to estimate the characteristic
frequency spectra from each segment of the phonoangiographic
signals. With a discrete set of t sampling points of the frequency
spectrum from 0.0 kHz to 0.8 kHz, P coefficients were used to
approximate the original data of xi , where i = 1, 2, 3, . . ., n,
presented as [10], [11]
xi = −

ap xi−p + resi

(1)

p=1

where xi represents the samples, P is the AR model order, p =
1, 2, 3, . . ., P , and ap stands for the model coefficients of the
AR model.
This method uses the optimal parameters ap to minimize the
square error between the original and the approximated data.
Forward and backward linear prediction requires the minimization of Fp and Bp , as [11]
⎛
⎞⎞2
⎛
p
n
n



⎝a0 xi − ⎝−
Fp =
(xi − wi )2 =
aj xi−j ⎠⎠
i=p

=

n


i=p

j =1

(fp (i))2

(2)

i=p

II. EXPERIMENTAL SETUP AND METHOD DESCRIPTION
A. Experimental Setup
Hemodialysis patients were chosen for clinical examination
at the Department of Surgery, National Cheng Kung University Hospital (Tainan City, Taiwan). The Institutional Review
Board (IRB, under contract number: ER-99-186) approved this
study. The phonoangiographic signals in AVS were acquired
using an electronic stethoscope (3M LITTMANN 4100 Series,
Minnesota, USA), with a sample rate of 4 kHz. Auscultations
were performed with a digital stethoscope at four recording
sites, including the arterial anastomosis site (A-site), arterial
puncture site, vein puncture site, and venous anastomosis site
(V-site, in AVG means after graft region, in AVF means leaving
anastomosis at least 10 cm), as shown in Fig. 1.
The advantage of the electronic consumer stethoscope is its
good ability to remove unwanted noises. Then, Hilbert transform and a 5 Hz low-pass digital filter smoothed phonoangiographic signals were utilized to find those peaks. The envelope
of the periodic PCG signals was obtained, and the distribution of
energy content with each envelope. The segmentation process
was used to find the minimum value before and after the detected peaks [10]. Each signal segment could then be determined
between continuous two minimum values in the time-domain,

p


Bp =

n


(xi − zi )2 =

i=p

=

n
−p


n
−p

i=0

(bp (i))2

⎛

⎛

⎝a0 xi − ⎝−

p


⎞⎞2
aj xi+j ⎠⎠

j =1

(3)

i=0

where wi , i∈[p, n], is a linear weighted combination of p previously known data, and zi , i∈[0, n − p], is a linear weighted
combination of p next known data. The sum of the residual
energies at stage p is Ep = Fp + B p . The Levinson–Durbin recursion algorithm [10], [11] is
used to minimize the sum of the
residual energy (SORE), E =
[resi ]2 ≤ ε, for estimating the
AR model coefficients. To obtain the suitable parameters, a final
prediction error criterion (FPEC) is used to select the AR model
orders and coefficients [10].
Narrowing of the lumen diameter required PTA to clear the
residual thrombus and dilate the stenotic segment (site Trk – site
Trk2), as shown in Fig. 2. An electric stethoscope can be used to
record the PCG signals originating from the arteriovenous fistula
(AVF) or arteriovenous graft (AVG). Using this information,
the frequency spectra are estimated for stenosis evaluation. The
frequency spectra are normalized between zero and one, as a

CHEN et al.: RULE-BASED DECISION-MAKING DIAGNOSIS SYSTEM TO EVALUATE ARTERIOVENOUS SHUNT STENOSIS

Fig. 4.
Fig. 2. (a) X-ray image for abnormality in blood vessel (near the wrist) and
(b) X-ray image for PTA.

705

(a) Model of FPN and (b) rule matrix of FPN.

C. Fuzzy Petri Net
A set of fuzzy IF–THEN rules is commonly used to represent linguistic inference rules. Let inference rule R =
{R1 , R2 , R3 , . . . , Rj , . . ., RJ }, the form of the jth rules be
presented as
IF fj THEN C (CF = μj )

(4)

where fj and C are propositions, each proposition is a real value,
and μj is the value of the certainty factor (CF), μj ∈ [0,1]. The
CF can indicate the grade of membership of μj j = 1, 2, 3, . . .,
J, in the fuzzy set. A triangular membership function can be
parameterized by a triplet (aj 1 , aj , bj 1 ), is defined by [14]
⎧
0,
for fj < aj 1
⎪
⎪
⎪
⎪
⎪
fj − aj 1
⎪
⎪
, for aj 1 ≤ fj < aj
⎪
⎪
a
⎪
⎨ j − aj 1
for fj = aj
.
(5)
μj = 1,
⎪
⎪
⎪
bj 1 − fj
⎪
⎪
⎪
, for aj < fj ≤ bj 1
⎪
⎪
bj 1 − b j
⎪
⎪
⎩
0,
for fj > bj 1

Fig. 3. (a) Frequency spectra of before PTA at sites Trk1 and Trk2. (b) Frequency spectra after PTA at sites Trk1 and Trk2.

color bar in Fig. 3. So the characteristic frequencies of the PCG
signals are easily found in the frequency spectra. The frequency
spectra for AVS stenosis and the normal condition at the two sites
are shown in Fig. 3(a) and (b), respectively. It can be seen the
frequency components occupy different frequency bands. The
frequency-domain parameters for these bands provide indices
for detecting of AVS stenosis before PTA and after PTA.

The larger the value of μj , the more confidence is conformed.
We can use a FPN to represent the fuzzy IF–THEN rules
of a rule-based system, as shown in Fig. 4(a). The FPN is a
marked graphical system, containing two types: places (Pl) and
transitions (Tr), where circle symbols represent places, and bar
symbols represent transitions. Each transition is associated with
a CF value between zero and one. In this study, the definition of
the FPN is as follows [13]–[15]:
FPN = (P l, T r, D, F, C, μ, θ, β, W )
P l ∩ T r ∩ D = Ø and |P l| = |D|

(6)

where Pl = {p1 , p2 , p3 , . . ., pM } is a finite set of places, Tr =
{t1 , t2 , t3 , . . ., tS } is a finite set of transitions, D = {d1 , d2 , . . .,

706

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

TABLE I
FREQUENCY-BASED PARAMETERS FOR THE EVALUATION OF AVS
STENOSIS [10]

Fig. 5.

Membership function of the nonlinear approximator.

dM } is a finite set of propositions, F = {f1 , f2 , f3 , . . ., fJ }is
the input function, a mapping from transitions to desired places,
C = {C1 , C2 , C3 , . . ., CK }is the output function, a mapping
from transitions to desired places, μ = {μ1 , μ2 , μ3 , . . ., μJ } is a
membership function, defined in [0,1] from inputs to transitions,
θ = {θ1 , θ2 , θ3 , . . ., θS } is a membership function, defined in
[0,1] from places to transitions, β = 1 is a weighted value from
transitions to desired places, W = 1 is a weighted value from
transitions to desired outputs.
The graphical structure of FPN can be represented by a rule
connectivity matrix. For an example of Fig. 4(a), the rule matrix
is given by Fig. 4(b). In this study, inference functions contain
“AND” and “OR” operators with min and max composite operations [16], [17] and can be divided into the following rule
types:
1) IF fj THEN tj , CF = μj , where tj = μj (fj ), j = 1, 2,
3, . . ., J.
2) IF (μ1 and μ2 and . . . and μj ) THEN pm , pm = min{(μ1 ×
β), (μ2 × β), (μ3 × β}, . . ., (μJ ×β)}, m = 1, 2, 3, . . .,
M.
3) IF (p1 or p2 or . . . pr pm ) THEN dm , dm = max{θ1 (p1 ),
(θ2 (p2 ), θ3 (p3 ), . . ., θm (pm )), m = 1, 2, 3, . . ., M .
4) Final output C = λk × max{C1 , C2 , C3 , . . ., CK } =
λk ×max{(d1 × W ), (d2 × W ), (d3 × W ), . . ., (dK ×
W )}.
where λk is a real number, k = 1, 2, 3, . . ., K, function θm (pm )
is a nonlinear approximator, as shown in Fig. 5, and is defined
by
θm = exp(−(1 − pm )),

0 < θm ≤ 1

(7)

where value pm , 0 ≤ pm ≤ 1, can determine the output of
function θm , and the larger value, the more likely output goal
proposition will occur. Its solution list is monotone decreasing,
and the degree can be divided into three levels: “very likely
(VL),” “likely (L),” and “unlikely (UL).”
The rule-based FPNs database was collected from physical records at the National Cheng Kung University Hospital,

Institutional Review Board (IRB), under contract number: ER99-186 (Dr. C.-D. Kan). We used the long-term hemodialysis
treatment of patients database to set up the FPNs. The next section will describe the implementation of the proposed diagnosis
system.
III. DIAGNOSIS SYSTEM IMPLEMENTATION
A. Preliminary Diagnosis and Classification
In clinical research, the degree of narrowing of the normal
vessel is an index for the degree of AVS in patients, the so-called
degree of stenosis (DOS). Examination results have confirmed
the specific degrees from X-ray images or angiographic images.
For a measurement segment Trk1–Trk2, as shown in Fig. 2(a),
the definition is [4], [18]


d2
(8)
DOS% = 1 − 2 × 100%
D
where D is the diameter of the normal graft or vessel in the
direction of blood flow and d is the diameter of the stenosis
lesion. The results of clinical experiences have been confirmed
by professional physicians, including Class I: DOS% < 50%,
Class II: 50% < DOS% < 70%, and Class III: DOS% > 70%
(DOS% = 0%: no stenosis, DOS% = 100%: total occlusion), as
shown in Table I [10]. When the DOS is greater than 50%, PTA
or surgical intervention is required to dilate the stenotic lesion
or remove the thrombus.
From our previous study [10], we determined the suitable AR
model order to minimize the SORE using the FPEC. Generally,
low AR orders result in poor spectral estimates, and high AR
orders result in better spectral estimates, but increased computational tasks. For the convergent condition, we considered
E ≤ ε = 10−1 to stop the Burg AR algorithm. Considering the
nonstationary nature of PCG signals, we could obtain the reliable frequency spectra using the AR order between 5 and 9 and
could guarantee to reach the residual flatness. Therefore, the
diagnosis system will be applicable for the other commercially
available electronic stethoscopes. We suggest that the AR model

CHEN et al.: RULE-BASED DECISION-MAKING DIAGNOSIS SYSTEM TO EVALUATE ARTERIOVENOUS SHUNT STENOSIS

707

order P = 8 to construct the Burg AR method with prediction
coefficients. The frequency spectra are estimated before PTA
(pre-PTA) and after PTA (post-PA). The characteristic frequencies of the phonoangiographic signals are easily found in the
frequency spectra between 0 and 800 Hz. For the specific AR
model order, there are three peaky spectra, defining the first,
second, and third characteristic frequency. For 42 hemodialysis treatment patients, the peaky spectra fall into different frequency bands. Depending on these frequency bands and DOS%,
frequency-base parameters provide key information for evaluating the degree of AVS stenosis, as shown in Table I.
B. Design of FPN-Based Diagnosis System
According to Table I, a triangular membership function can
be parameterized by a triplet (minimum value, mean value,
maximum value) using (5), we have nine membership functions
μj , j = 1, 2, 3, . . ., 9, with specific ranges fj , j = 1, 2, 3, . . ., 9,
as shown Fig. 10(a) in the Appendix. The CF of each input in the
different ranges typically distributes in the universe of discourse
[0,1]. In this study, the FPN can perform fuzzy inference to
evaluate the degree of AVS stenosis of each proposition specified
by the professional physician. Assume the degree of proposition
Ck (Class I–Class III), k = 1, 2, 3, place pm is associated
with the proposition dm = θm (pm ), m = 1, 2, 3, . . ., 13. The
FPN performs min and max composite operations, the so-called
“multivalued logic (Boolean rule of C. G. Looney [16]),” to
generate the goal proposition C, C = max{C1 , C2 , C3 }. The
rule connectivity matrix of FPN is shown, as seen Fig. 10(b) in
the Appendix. The algorithm is summarized as follows:
Step 1) IF fj THEN tj , CF = μj , whe re tj = μj (fj ), j = 1,
2, 3, . . ., 9.
Step 2) IF (μ1 and μ2 and . . . and μj ) THEN pm , pm = min
{(μ1 × β), (μ2 × β), . . ., (μj × β)}, m = 1, 2, 3, . . .,
13.
We have 13 AND operations in this step.
Step 3) Compute the proposition dm = θm (pm ), m = 1, 2,
3, . . ., 13.
Step 4) IF (d1 or d2 or . . . pr dm ) THEN Ck , Ck = max
{θ1 (p1 ) × W, θ2 (p2 ) × W , . . ., θm (pm ) × W }, k =
1, 2, 3.
We have 3 OR operations in this step.
Step 5) Final output C = λk × max{C1 , C2 , C3 }.where λ1 =
1 for Class I, λ2 = 2 for Class II, and λ3 = 3 for Class
III. The goal proposition C indicates the possible degree of AVS senosis and also subdivides into three
levels “VL,” “L,” and “UL.” We have the following
degrees: Class I (UL, L, VL), Class II (UL, L, VL),
and Class III (UL, L, VL). The proposed diagnosis
system is tested for diagnostic accuracy with longterm follow-up patients, as detailed in Section IV.
IV. EXPERIMENTAL RESULTS AND DISCUSSION
Using a digital stethoscope, the auscultation method was used
to obtain the phonoangiographic signals at the measurement
sites, including the arterial anastomosis site (A-site) and the

Fig. 6.
value.

(a) Feasibility diagnosis results for 42 tests. (b) DOS versus the p m

venous anastomosis site (V-site). The proposed diagnosis system with the Burg AR method and FPNs was developed on
a PC AMD Athlon II×2 245 2.91 GHz with 1.75 GB RAM
and MATLAB software. To demonstrate the effectiveness of the
proposed model for detecting AVS stenosis, 42 subjects were
tested (IRB, under contract number: ER-99-186), the participants comprised 23 females and 19 males with a mean age of
63 ± 10.2 years (49–81 years). The AVS types included 22
AVGs and 20 AVFs to surgically connect the artery and vein. The
participants’ mean duration of long-term hemodialysis therapy
was 48 ± 31 months. Preliminary diagnosis results confirmed
the specific degrees by ultrasonic image examination and professional physicians. Case studies of long-term hemodialysis
patients were validated the proposed diagnosis system, as detailed below.
A. Feasibility Tests with the Proposed Diagnosis System
The study records from 42 subjects were divided into two
groups, with 21 patients being used to design the rule-based
decision-making diagnosis system. Using 42 testing data from
other 21 patients, the overall testing results are shown in Fig. 6(a)
and (b), comparison with the DOS%, the accuracy is 85.71%
with six failures. The measurement sites, quantification errors, and undetected stenosis could affect the efficiency of the

708

Fig. 7.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

Long-term examination at V site, since June 25, 2011, to September 6, 2011.

proposed method. The study used at least two records for 8 s
at the measurement site from 21 patients before Pre-PTA and
Post-PA. We have three main degrees to decide the class of
AVS stenosis, and the words “UL,” “L,” and “VL” correspond
to monotone decreasing curves that define the level to quantify
the similarity in each class. The output function of θm itself can
be an arbitrary curve, and we can define it as a function that must
vary between 0.3679 and 3.000. The place pm can determine
the similarity level, and more likely closes to value 1, 2, or 3
for the goal proposition. If place pm is only partially similar,
its value is less than 1 and gradually decays to 0. From these
results, we observed the function of AVS could be evaluated by
the proposed diagnosis system.
Due to variations in frequency spectra for different classes
and even for patients, the characteristic frequencies occupy different frequency bands, and some characteristic frequencies are
distributed into overlapping bands or crossing bands. The physicians decided on the final degree using a combination of the
variances in frequency and magnitude. However, it required offline analysis to obtain diagnosis results. Traditional petri nets
(PNs) used the constant transitions and constant weighted parameters (β and W ). It is difficult to deal with the varying
frequency spectra. PNs were suitable to process binary data in
truth–false decisions, on–off switching, and automatic control
applications [19], [20]. Comparing the FPNs with PNs, the inference rules in the knowledge base of the rule-based system are
both modeled. FPNs use the CFs of the fuzzy inference rules
and the weights of the propositions using numerical and binary
data and can automatically perform weighted fuzzy reasoning
for varying spectra analysis. It allows the proposed rule-based
diagnosis system to perform fuzzy inference in a flexible and
intelligent manner.
B. Long-Term Examination: Monthly Examination
For example, a female hemodialysis patient, aged 54 years,
AVG type (Right Forearm Loop), agreed to participate in a longterm examination and allowed further monthly data collection
from observation from June 25, 2011, to July 11, 2012. In a
routine monitoring cycle, a monthly examination was used to

evaluate the AVG function. The first characteristic frequency
also gradually increased from 68 to 170 Hz over three months
of observation, as shown in Fig. 7. On September 6, 2011, the
female patient had a severe AVG occlusion, and the professional
physician confirmed the “Class II.” Using the ultrasonic image
examination, the DOS% = 66% was found at the measurement
site, and received PTA treatment. The three characteristic frequencies were 170, 425, and 681 Hz. The diagnostic procedures
of the FPNs are:
Step 1) Compute the CFs of μj (fj ), then transition Tr =
[t1 , t2 , t3 , . . ., t9 ] = [0.0000, 0.3846, 0.4588, 0.0000,
0.6154, 0.0000, 0.6364, 0.3800, 0.0167].
Step 2) Perform AND operations with 13 combinations of
triplet transitions, then place Pl = [p1 , p2 , p3 , . . .,
p13 ] = [0.0000, 0.0000, 0.4588, 0.0000, 0.0000,
0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
0.3800, 0.0167],
Step 3) Compute the proposition D = [d1 , d2 , d3 , . . ., d13 ] =
[θ1 , θ2 , θ3 , . . ., θ13 ] = [0.3679, 0.3679, 0.5821,
0.3679, 0.3679, 0.3679, 0.3679, 0.3679, 0.3679,
0.3679, 0.3679, 0.5379, 0.3679].
Step 4) Perform OR operations with 13 combinations of three
groups of places, then goal proposition [C1 , C2 , C3 ] =
[0.3679, 0.5821, 0.5379].
Step 5) Final output C = λ2 × max[0.3679, 0.5821, 0.5379] =
1.1641.
The final output is 1.1641, and place value p3 is near 0.4588,
indicating the degree of truth of the goal proposition “Class
II (L: p3 = 0.4588, C = 1.1641).” The FPNs also agree with
the “Class II” degree. This confirms the FPNs based diagnosis
system provides promising results for evaluating the degree of
AVS stenosis.
Following multiple PTA treatment, the vessel developed
severely fibrous soft tissue and sclerotic. An immediate elastic recoil can occur after PTA, graft thrombosis, or loss of the
available graft puncture area, which contributing to blood flow
resistance, so the 1st and 2nd characteristic frequencies shift
to lower frequency components from 170 to 68 Hz and 425
to 303 Hz, respectively, and the 3rd characteristic frequency is
644 Hz. The proposed system has evaluated the “Class II (VL:

CHEN et al.: RULE-BASED DECISION-MAKING DIAGNOSIS SYSTEM TO EVALUATE ARTERIOVENOUS SHUNT STENOSIS

709

TABLE II
COMPARISON OF PERFORMANCES BETWEEN THE PROPOSED METHOD
AND SVM METHOD

Fig. 8. Ultrasonic image for stenosis AVG at measurement V site, date:
November 2, 2011.

p3 = 0.8752, C = 1.7503)” degree on October 13, 2011. This
examination provides a recommendation of increasing surveillance and confirming analysis. It can be seen the occlusion level
will perhaps develop into the “Class III (UL)” degree. Further
monthly examination using the ultrasonic image examination,
on November 2, 2011, found DOS% = 89%, d = 0.178 cm and
D = 0.556 cm, at the V site, as shown in Fig. 8. In clinical
applications, the following conditions indicate the patient needs
to receive PTA treatment and surgical revision: 1) DOS% >
50% and more than one abnormalities, 2) intragraft blood flow
(IBF) < 600 mL/min for AVF, 3) intragraft blood flow (IBF) <
400–500 mL/min for AVG, 4) venous segment static pressure
ratio > 0.50, 5) arterial segment static pressure ratio > 0.75.
The aforementioned testing results have confirmed the proposed diagnosis system can also be used for early detection and
monthly examination. Cooperating with the recommended clinical conditions, it provides a reliable and noninvasive method to
monitor AVS conditions.
C. Performance Tests
Table II shows comparison performances using the proposed
method and a SVM-based classifier [11]. Updating of network
parameters was performed after the network topology had been
decided. For a SVM topology 3-3-3, 42 sets of training data
from input–output pairs (three characteristic frequencies–three
classes) were used to train the SVM. The swarm-intelligence
algorithm (SIA), as a particle swarm optimization (PSO) [21],
is an evolutionary optimization technique, which provides more
efficiency in solving multiple optimal solutions, high dimensionnality, featuring nonlinearity, and nondifferentiability problems. The evolution computations of PSO technique were used
to minimize the mean squared error function (MSEF), as shown
in Fig. 9. It can be seen the solution list of the SVM based
classifier is decreasing with less than 30 iteration training, and
only slight improvement in the optimal parameters, γ, σ, and
b, was obtained by increasing the number of iteration training and population sizes (G = 10∼40). In addition, the SVM

Fig. 9.

Mean-squared error versus the number of iteration training.

topology is slightly less than FPN (topology 9-13-3-1); however, it needs iteration computations for updating parameters.
It also trains a classifier under the high-dimensional and complexity pattern space. Although the multilayer network provides promising solutions to perform classification tasks, but the

710

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

algorithm is difficult to implement in hardware devices. The proposed screening system provides a rule-based mechanism and
automatic weighted fuzzy reasoning. Thus, it could overcome
the complexity of adjustable mechanism design and shorten a
design cycle.
D. Discussion
An ES is a computer system that can be designed to perform
specific functions, including control, diagnosis applications, signal processing, etc. [22]–[24]. It contains processing cores, such
as micro-controllers or DSP, and also contains analog and digital
input/output (I/O), memory, and application specific integrated
circuits (ASICs). An FPGA chip is a high-level ES that can
be configured by engineering designers or customers. It has an
array configuration of logical elements, which can be used to
design any logical operation function to implement the given
applications. The FPGA is also a programmable device, and
has an inherent parallel and distributed configuration, allowing
designers to execute multiple inputs and control loops simultaneously. Its development environment can simulate and verify
the logic designs [25].
Under the ES development environment, we used four fundamental operations of arithmetic and logical reasoning to configure the combinational logics or ASICs, and then embed intelligent algorithms on the compact chip. The proposed diagnosis system provides rule-based configuration and automatic
weighted fuzzy reasoning. A flexible and intelligent manner
needs no iteration for updating system weights. Therefore, it
can overcome the complex configuration design, and the prototype device can be implemented, tested, debugged, and modified as needed in a short design cycle. Of the current techniques,
the graphical user interface for windows application has reprogrammability and flexibility to quickly develop a specific ASIC.
The proposed FPNs’ algorithm can be implemented using four
fundamental operations with specific storage data. In addition,
an exponent function, as (7), can be expanded into a Maclaurin
series, as shown in the Appendix, so it can also be implemented
with the four fundamental operations. Combining the FPNs and
logical operation functions, the proposed diagnosis system provides a promising way to implement a portable monitor for AVS
condition evaluation in daily home care.
V. CONCLUSION
According to reports from the Department of Health (DOH),
the rate of ESRD in Taiwan is 2447 per million. ESRD is an
irreversible and progressive chronic disease. More than 66,000
people need to receive the hemodialysis treatment, and this number is increasing year by year. For long-term use, AVF or AVG
accesses must be punctured every two days. Maintenance of
proper function at IBF 600–2000 mL/min is the most important
issue for ESRD patients. This study has provided a flexible, intelligent, and FPGA chip design method to develop a portable early

detection medical device. With noninvasive phonoangiographic
signals, the Burg AR method was used to estimate the characteristic frequency spectra, including the first, second, and third
characteristic frequencies. To observe three main characteristic frequencies, it provides information to evaluate the degree
of AVS stenosis. Then, we implemented the human diagnosis
work to present a fuzzy inference algorithm for a rule-based
system using FPNs, and the degree subdivides into nine scales
to survey the occlusion levels. We also used some case studies
to verify the feasibility of the proposed diagnosis system. Under
advanced ES techniques, an automatic diagnosis system could
be easy to implement for hemodialysis patients needs.
APPENDIX
(7), anexponent function can be expanded into a Maclaurin
series as
−1

[exp(1 − pm )]

∼
=

−1
 Z
 (Δ)z
z =0

(z)!

1
1
1
∼
(Δ)Z ]−1
= [1 + (Δ) + (Δ)2 + (Δ)3 + · · · +
2!
3!
(z)!
∼
= [1 + z0 (Δ) + z1 (Δ)2 + z2 (Δ)3 + · · · + zS (Δ)Z ]−1 (9)
where Δ = (1 – pm ), series coefficient zs , s = 0, 1, 2, 3, . . ., S,
is the number of series term, and series coefficient are constant
values. The series term verified the expanded function accuracy, and S = 6 was recommended. The special equation can
be computed with multiplication, addition, and division. Related constant data can be computed and stored in the memory
elements. The accuracies of the expanded function have been
verified, as follows:
1) VL: exp(−0.0) = [1+0.0+ 2!1 (0.0)2 +· · ·+ 6!1 (0.0)6 ]−1 =
1.0000
2) L: exp(−0.5) = [1+0.5+ 2!1 (0.5)2 + ... + 6!1 (0.5)6 ]−1 ≈
0.6065
3) UL: exp(−1.0) = [1+1.0+ 2!1 (1.0)2 +... + 6!1 (1.0)6 ]−1 ≈
0.3679
Fig. 11 shows the ASICs’ configuration of special functions,
in which adders, multipliers, and dividers are required to implement each special function, such as triangular membership
functions and exponent functions. Its ASIC can design the function with combinational logical operation elements, and constant
parameters are stored in the memory elements. The advantage
of each ASIC is a simplified module that can be examined before programming into the FPGA chip. In addition, each ASIC
of special function has the same configuration, it only assigns
triplet parameters for a triangular membership function and series coefficients for an exponent function. Most can be used
repeatedly. Therefore, designers can quickly develop a specific
ES within the FPGA chip.

CHEN et al.: RULE-BASED DECISION-MAKING DIAGNOSIS SYSTEM TO EVALUATE ARTERIOVENOUS SHUNT STENOSIS

Fig. 10.

(a) FPNs based diagnosis system for evaluating AVS stenosis. (b) Rule connectivity matrix of FPN.

711

712

Fig. 11.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

ASIC configurations of triangular membership function, exponent function, and FPNs.

ACKNOWLEDGMENT
The Institutional Review Board (IRB) of the National ChengKung University Hospital approved this study, under Contract
ER-99-186.
REFERENCES
[1] J. C. Tsai, S. C. Chen, S. J. Hwang, J. M. Chang, M. Y. Lin, and H. C.
Chen, “Prevalence and risk factors for CKD in spouses and relatives of

hemodialysis patients,” Am. J. Kidney Dis., vol. 55, no. 5, pp. 856–866,
May, 2010.
[2] M. F. Fillinger, E. R. Reinitz, R. A. Schwartz, D. E. Resetarits, A. M.
Paskanik, and C. E. Bredenberg, “Beneficial effects of banding on venous
intimal–medial hyperplasia in arteriovenous loop grafts,” Am. J. Surg.,
vol. 11, pp. 87–94, 1989.
[3] S.-M. Cheng, S.-P. Ng, F.-S. Yang, and S.-L. Shih, “Interventional treatment for complete occlusion of arteriovenous shunt: Our experience in 39
Cases,” Chin. J. Radiol., vol. 28, pp. 137–142, 2003.
[4] S. Tang, C. Y. Lo, W. K. Tso, W. K. Lo, F. K. Li, and T. M. Chan, “Percutaneous transluminal angioplasty for stenosis of arteriovenous fistulae:
A review of local experience,” HKMJ, vol. 4, pp. 36–41, 1998.

CHEN et al.: RULE-BASED DECISION-MAKING DIAGNOSIS SYSTEM TO EVALUATE ARTERIOVENOUS SHUNT STENOSIS

[5] National Kidney Foundation, “KDOQI Clinical practice guidelines and
clinical 326 practice recommendations for 2006 updates: Hemodialysis
adequacy, peritoneal 327 dialysis adequacy and vascular access,” Am. J.
Kidney Dis., vol. 48, pp. 1–322, 2006.
[6] A. Asif, F. N. Gadalean, D. Merrill, G. Cherla, C. D. Cipleu, D. L. Epstein,
and D. Roth, “Inflow stenosis in arteriovenous fistulas and grafts: A multicenter, prospective study,” Kidney Int., vol. 67, pp. 1986–1992, 2005.
[7] Y. M. Akay, M. Akay, W. Welkowitz, S. Lewkowicz, and J. L. Semmlow,
“Non invasive acoustical detection of coronary artery disease: A comparative study of signal processing methods,” IEEE Trans. Biomed. Eng.,
vol. 40, no. 6, pp. 571–578, Jun. 1993.
[8] Y. M. Akay, M. Akay, W. Welkowitz, S. Lewkowicz, and Y. Palti, “Dynamics of the sounds caused by partially occluded femoral arteries in
dogs,” Ann. Biomed. Eng., vol. 22, pp. 493–500, 1994.
[9] P. O. Vasquez, M. M. Marco, and B. Mandersson, “Arteriovenous fistula
stenosis detection using wavelets and support vector machines,” Proc.
31st Annu. Int. Conf. IEEE EMBS, pp. 1298–1301, Sep. 2–6, 2009.
[10] W. L. Chen, C. H. Lin, T. S. Chen, P. J. Chen, and C. D. Kan, “Stenosis
detection algorithm using the burg method of autoregressive model for
hemodialysis patients: Evaluation of arteriovenous shunt stenosis,” J. Med.
Biol. Eng., in press, Sep. 13, 2012, doi: 10.5405/jmbe.1173.
[11] C. Collomb. (2009). Linear prediction and Levinson–Durbin algorithm
[Online]. Available: http://ccollomb.free.fr/technotes/
[12] S. I. Ahson, “Petri net models of fuzzy neural networks,” IEEE Trans.
Syst., Man, Cybern., vol. SMC-25, no. 6, pp. 926–932, Jun. 1995.
[13] S.-M. Chen, “Fuzzy backward reasoning using fuzzy Petri nets,” IEEE
Trans. Syst., Man, Cybern. B: Cybern., vol. 30, no. 6, pp. 846–856, Dec.
2000.
[14] S.-M. Chen, “Weighted fuzzy reasoning using weighted fuzzy petri nets,”
IEEE Trans. Knowl. Data Eng., vol. 14, no. 2, pp. 386–397, Mar./Apr.
2002.
[15] Y. Cao and G. Chen, “A fuzzy petri-nets model for computing with words,”
IEEE Trans. Fuzzy Syst., vol. 18, no. 3, pp. 486–499, Jun. 2010.
[16] C. G. Looney and A. R. Alfize, “Logical controls via Boolean rule matrix
transformations,” IEEE Trans. Syst., Man, Cybern., vol. SMC-17, no. 6,
pp. 1077–1082, Dec. 1987.
[17] S. M. Chen, J. S. Ke, and J. F. Chang, “Knowledge representation using
fuzzy petri nets,” IEEE Trans. Knowl. Data Eng., vol. 2, no. 3, pp. 311–
319, Sept. 1990.
[18] J. Van Der Linden, J. H. M. Smits, J. H. Assink, D. W. Wolterbeek,
J. J. Zijlstra, G. H. De Jong, M. A. Van Den Dorpel, and P. J. Blankestijn,
“Short- and long-term functional effects of percutaneous transluminal angioplasty in hemodialysis vascular access,” J. Am. Soc. Nephrol., vol. 13,
pp. 715–720, 2002.
[19] K. P. Brand and J. Kopainsky, “Principles and engineering of process
control with Petri nets,” IEEE Trans. Autom. Control, vol. 33, no. 2,
pp. 138–149, Feb. 1988.
[20] S. S. Peng and M. C. Zhou, “Ladder diagram and Petri-net-based discrete
event control design methods,” IEEE Trans. Syst. Man Cybern. C, Appl.
Rev., vol. 34, no. 4, pp. 523–531, Nov. 2004.
[21] A. Ratnaweera, S. K. Halgamuge, and H. C. Watson, “Self-organizing
hierarchical particle swarm optimizer with time-varying acceleration coefficients,” IEEE Trans. Evol. Comput., vol. 8, no. 3, pp. 240–255, Jun.
2004.
[22] C. Dick and F. Harris, “FPGA signal processing using sigma–delta
modulation-innovative combinations of techniques and hardware for system designers,” IEEE Signal Proc. Mag., vol. 17, no. 1, pp. 20–35, Jan.
2000.
[23] D. Kim, “An implementation of fuzzy logic controller on the reconfigurable FPGA system,” IEEE Trans. Ind. Electron., vol. 47, no. 3, pp. 703–
715, Jun. 2000.

713

[24] J. Chilo and T. Lindblad, “Hardware implementation of ID wavelet transform on an FPGA for infrasound signal classification,” IEEE Trans. Nucl.
Sci., vol. 55, no. 1, pp. 9–13, Feb. 2008.
[25] K. Arshak, E. Jafer, D. McDonagh, and C. S. Ibala, “Modeling and simulation of wireless sensor system for health monitoring using HDL and
simulink mixed environment,” IET Comput. Digit. Tech., vol. 1, no. 5,
pp. 508–518, 2007.

Wei-Ling Chen was born in 1970. She received the B.S. degree in mechanical
engineering from the National Cheng Kung University, Tainan, Taiwan, in 1994,
the M.S. degree in biomedical engineering in 1996 from National Cheng Kung
University, Tainan City, Taiwan, where he is currently working toward the Ph.D.
degree in the Department of Biomedical Engineering. She is also working in
the Department of Engineering and Maintenance, Kaohsiung Veterans General
Hospital, Kaohsiung City, Taiwan, where has been science 2013.
Her current research interests include biomedical signal processing, numerical analysis, and medical device design.

Chung-Dann Kan received the M.D. degree from Kaohsiung Medical College,
Kaohsiung City, Taiwan, in 1993, and the Ph.D. degree from National Cheng
Kung University, Tainan City, Taiwan, in 2010.
He completed the Residency and Fellowship training in cardiovascular
surgery at National Cheng Kung University Hospital, Tainan City, Taiwan,
where he is currently an Attending Physician in the Department of Surgery and
an Assistant Professor. His current research interests include cardiac regeneration and aortic stent graft.

Chia-Hung Lin was born in 1974. He received the B.S. degree in electrical
engineering from the Tatung Institute of Technology, Taipei City, Taiwan, in
1998, the M.S. and the Ph.D. degrees in electrical engineering from the National
Sun Yat-Sen University, Kaohsiung City, Taiwan, in 2000 and 2004, respectively.
He is currently a Professor in the Department of Electrical Engineering,
Kao-Yuan University, Kaohsiung City, Taiwan, where has been since 2013. His
current research interests include neural network computing and its applications,
biomedical signal processing, and pattern recognition.

Tainsong Chen received the B.S. and M.S.Eng. degrees in power mechanical
engineering from the National Tsing Hua University, Hsinchun, Taiwan, in
1980 and 1982, respectively, and the Ph.D. degree in electrical engineering
from Michigan State University, East Lansing, USA, in 1991.
He is currently a Professor in the Department of Biomedical Engineering,
National Cheng Kung University, Tainan City, Taiwan. His current research
interests include medical ultrasound, eye movement, medical device design,
and system control.

