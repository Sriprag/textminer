IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

367

A Multistaged Automatic Restoration of Noisy
Microscopy Cell Images
Jinwei Xu, Jiankun Hu, Member, IEEE, and Xiuping Jia, Senior Member, IEEE

Abstract—Automated cell segmentation for microscopy cell images has recently become an initial step for further image analysis
in cell biology. However, microscopy cell images are easily degraded
by noise during the readout procedure via optical-electronic imaging systems. Such noise degradations result in low signal-to-noise
ratio (SNR) and poor image quality for cell identification. In order to improve SNR for subsequent segmentation and image-based
quantitative analysis, the commonly used state-of-art restoration
techniques are applied but few of them are suitable for corrupted
microscopy cell images. In this paper, we propose a multistaged
method based on a novel integration of trend surface analysis,
quantile–quantile plot, bootstrapping, and the Gaussian spatial
kernel for the restoration of noisy microscopy cell images. We show
this multistaged approach achieves higher performance compared
with other state-of-art restoration techniques in terms of peak
signal-to-noise ratio and structure similarity in synthetic noise experiments. This paper also reports an experiment on real noisy microscopy data which demonstrated the advantages of the proposed
restoration method for improving segmentation performance.
Index Terms—Bootstrapping, Gaussian noise, image restoration, microscopy cell imaging, trend surface analysis, quantile–
quantile plot (Q–Q) plot.

I. INTRODUCTION
ICROSCOPY imaging allows scientists to study biological cells at the level where a single cell can be observed. It provides an essential tool for the examination of both
living and fixed cells in cell culture. The screening of modern
high-content high-throughput image-based cells helps biologists
discover distinctive phenotypes of individual cell populations,
which can be used to identify related genes for targeted therapeutic treatment and new drug discovery [1]–[3]. For example, high-content high-throughput microscopy produces highresolution images for the inspection of normal and abnormal
cell division. Since cancer is regarded as uncontrolled abnormal
cell division, chemotherapies are often implemented to aim at
the cells during mitosis. The identification of new genes highly
correlated with the specific cancer during cell mitosis provides a
possible solution for the development of new anticancer drugs.
Because of the rapid expansion of cellular imaging data, computerized information processing tools such as image analysis and

M

Manuscript received July 2, 2013; revised December 17, 2013; accepted
February 4, 2014. Date of publication February 10, 2014; date of current version
December 30, 2014.
The authors are with the School of Engineering and Information Technology,
The University of New South Wales, Canberra, A.C.T. 2600, Australia (e-mail:
jinwei.xu@student.adfa.edu.au; j.hu@adfa.edu.au; x.jia@adfa.edu.au).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2305445

pattern recognition, are increasingly in demand [4]–[8]. Even
though microscopy imaging technology has multiple advantages
in medical and biological applications, microscopy images are
often degraded by noise from readout procedures and image
data acquisition systems, devices, or equipment [9]–[11]. As
noise is caused by defects in intensity measurement, it is the
main factor which adversely affects the quality of microscopy
imaging and the task of automated segmentation. Due to the
statistical and cumulative nature of photon detection, noise may
be reduced most effectively by increasing the length of image
acquisition time. However, it has been pointed out that this approach is not practical for microscopy imaging because of the
problems of live cell movements, photobleaching, and radiation
damage [12].
The corruption of microscopy images is caused by several
types of noise, such as Gaussian noise (additive), Poisson noise
(signal intensity dependent), salt and pepper noise (pixel intensity on and off), and speckle noise (multiplicative) [11]. Such
degradation of microscopy images adversely affects subsequent
cell image processing and analysis tasks. To be more explicit,
under noise contamination, many image pixels are corrupted,
leading to a decline in signal-to-noise ratio (SNR) and inaccuracy in automated cell segmentation. In particular, subcellular
organelle is not easy to distinguish from noisy images, so the task
of restoring microscopy images from noise degradation is one of
the most important steps prior to segmentation [5], [13]. Furthermore, the segmentation result of cellular regions is necessary for
cell counting [4], [37] and cell morphology analysis [38], [39].
The accuracy of such a segmentation-based cell analysis relies
heavily on the quality of the microscopy images under study, so
the computerized restoration of such images is considered to be
most appropriate tool for the quality improvement of degraded
microscopy images.
Computerized microscopy image restoration methods have
been the subject of much research during the past decade. One
of the simplest approaches to suppress noise in microscopy images is mean filter, but this removes noise while blurring image
detail. A bilateral filter (BF) and its variants have been developed
to preserve cell edges, but their performance in edge preservation depends on the intensity range filter response and such a
filtering response is easily affected by moderate and high intensity noise [14]–[16]. [17] and [18] propose an adaptive image
restoration scheme for restoring degraded images by comparing
the similarity of patches inside the nonlocal searching region.
Although these studies made no assumption about the properties
of image signal and noise and their computational complexity
is high, they were empirically observed to perform well with
additive Gaussian noise. Total variation (TV) filtering, based on

2168-2194 © 2014 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

368

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

the reduction of noisy signal TV, is another technique which
is often utilized in microscopy image restoration [13], [19].
These TV-based noise removal techniques effectively smooth
noise while preserving edges. However, they also lead to artifacts such as the blocky effects especially for low SNR cell
images. Partial differential equation-based (PDE) restoration algorithms have also been developed for the noise cancelation of
corrupted microscopy cell images, which smoothes the noise in
flat subregions except at strong edges [20], [21]. However these
PDE-based filters over-smooth cell’s internal microstructures
whose pixel intensities do not vary distinctively. Fuzzy-based
(FUZZY) restoration, based on the fuzzy membership function
and fuzzy rule, is a well-established technique applied to general
image filtering [22]–[25]. These fuzzy-based noise cancelation
approaches perform well to deduct the noise and preserve the
image details. However, fuzzy-based methods heavily rely on
the manual selection of membership function as well as the
subjective definition of a fuzzy rule. Therefore, their restoration
performance is restricted to the artificial experience.
Even though the development of computerized restoration
approaches for corrupted microscopy images has drawn much
attention and many methods have been proposed during the past
years, the restoration problem still remains open, because it is an
ill-posed inverse problem, and necessary information required
about the degraded microscopy image to reconstruct the original
version is inherently imprecise. In practice, we not only focus on
the image quality achieved by the restoration method, but we are
also concerned about whether the restored images are expected
to be beneficial for cell segmentation. Based on this motivation,
we present in this paper a novel Gaussian noise restoration
scheme, which integrates trend surface mapping, probability
distribution plotting known as quantile-quantile plot (Q–Q plot),
bootstrapping, and Gaussian spatial kernel for restoration of
microscopy cell images. Some distinctive advantages of the
proposed approach are summarized as follows.
1) Brightness trend is one special characteristic in microscopy cell images. Therefore, trend surface mapping
inspired by Geostatistics is employed to model the trend
of image brightness (it is regarded as the signal trend according to [26]).
2) A Q–Q plot is utilized to identify highly corrupted pixels
by comparing the pixel intensities versus known probability distribution (here the Gaussian noise model is assumed
according to [10], therefore Gaussian distribution is assigned as the known distribution). Furthermore, noise intensity level estimation is achieved by bootstrapping only
depending on the identified corrupted pixels.
3) The smoothing parameter of the Gaussian spatial kernel is
automatically determined according to the estimation of
bootstrapping, which effectively reduces undersmoothing
or oversmoothing.
4) With the integration of variance stability transform (VST),
the proposed multistaged restoration scheme can be more
generalized to deal with Poisson noise, which is another
commonly encountered noise in microscopy cell images.
The rest of this paper is organized as follows. In Section II,
we present the details of the proposed restoration approach. In

Section III, synthetic Gaussian noise, synthetic Poisson noise,
and real noise experiments are implemented, respectively. In
the synthetic noise experiments, the proposed method achieves
higher denoising performance compared with other state-ofart restoration techniques in terms of peak signal-to-noise ratio
(PSNR) and structure similarity (SSIM). In the real noise experiment, the effectiveness of the proposed method is further
verified as it contributes to improve the performance of automated segmentationIn Section IV, conclusions and remarks are
presented.
II. PROPOSED INTEGRATION APPROACH
In this section, we first apply trend surface mapping to model
the gradually varied brightness trend, then we apply the Q–Q
plot to identify corrupted pixels according to the linear pattern
between pixel intensities and standard Gaussian distribution.
In order to restore these degraded pixels, we apply bootstrapping to estimate the noise intensity level which is assigned as
the smoothing parameter of Gaussian spatial kernel for image
restoration. The following sections describe the detail of the
proposed approach.
A. Image Noise Model and Trend-Surface Mapping
Inspired by the multicomponents signal decomposition proposed in [26], we propose a decomposable model to describe
the degraded image g(x, y) corrupted by additive noise n(x, y)
as follows:
g(x, y) = l(x, y) + m(x, y) + n(x, y)

(1)

where l(x, y) represents the trend of image brightness (signal
trend), and m(x, y) is the image structure (signal structure).
The original signal is constituted of two components: signal trend l(x, y) and signal structure m(x, y). The purpose
of image restoration is to bring an approximate estimate
ˆl(x, y) + m̂(x, y) to original signal l(x, y) + m(x, y) as close
as possible. Here, ˆl(x, y) and m̂(x, y) are the estimation for
l(x, y) and m(x, y), respectively.
The idea here is to use the global trend-based estimation technique, trend surface mapping [27], [28], to generate a smooth approximation ˆl(x, y) for gradually varied brightness trend l(x, y).
Consequently, the residuals, also known as the noisy image
structure m(x, y) + n(x, y), can be obtained. Trend surface
mapping is a mathematical technique used in environmental
sciences for manipulating map data to produce a smooth approximation of a 3-D surface, which is a method based on low-order
polynomials of spatial coordinates for estimating a regular grid
of points from neighbor observations. The suitability of applying trend surface mapping to cell image data is that 1) most
cells (targets) contained in microscopy images are small-sized
or medium-sized and 2) the brightness trend of microscopy cell
images usually varies gradually. Such image circumstances facilitates good mapping of the trend surface equation based on
low-order linear polynomials. Two outputs of the trend surface
mapping of a cell image can be represented as a trend map and
a residual map, where the trend map can be used to define a
geometric model of 3-D shape as a brightness trend ˆl(x, y), and

XU et al.: MULTISTAGED AUTOMATIC RESTORATION OF NOISY MICROSCOPY CELL IMAGES

369

the residual map m(x, y) + n(x, y) is intended to be denoised
subsequently.
The p-order trend-surface mapping of a pixel of a cell image
of size M × N can be defined as
ˆl(x, y) = b0 +b1 x+b2 y+b3 x2 +b4 xy+b5 y 2 +. . .+bk y p (2)
where x = 1, . . . , M , y = 1, . . . , N , and k + 1. Here, k =
p(p + 3)/2 is the number of trend surface mapping coefficients. The trend surface function will produce a tilted plane
surface for p = 1 (linear equation), a simple hill or valley for
p = 2 (quadratic equation), or a cubic surface for p = 3 (cubic
equation).
The trend surface mapping coefficients of a degraded image
g(x, y) of size M × N can be optimally obtained by minimizing
the following objective function using the principle of least
squares:
N
M 


[g(x, y) − ˆl(x, y)]2 .

Fig. 1. Q–Q plot of two samples coming from the same type of distribution
(Gaussian) but with different parameters.

(3)

x=1 y =1

The minimization of (3) leads to the trend surface equation
expressed in matrix notation as
XT (g − Xb) = 0

(4)

where
g = [g(1, 1) g(1, 2) g(1, 3) . . . g(M, N )]T
⎡ 1 1 1 12
1
12 · · ·
⎢ 1 1 2 12
2
22 · · ·
⎢
⎢.
..
..
..
..
..
⎢ ..
.
.
.
.
.
···
⎢
X=⎢
2
2
⎢1 x y x
xy
y
···
⎢
⎢ ..
..
..
..
..
..
⎣.
.
.
.
.
.
···
1 M

N

M2

MN

N2

···

(5)
1 ⎤
2p ⎥
⎥
.. ⎥
. ⎥
⎥
⎥
yp ⎥
⎥
.. ⎥
. ⎦

Fig. 2.

p

(6)

Np

b = [b0 b1 b2 . . . bk ]T .

(7)

If the inverse of XT X exists, the trend surface mapping coefficients can be obtained as
b = (XT X)−1 XT g.

(8)

The trend surface mapping is given by
l̂ = Hg

(9)

where H = X(XT X)−1 XT is the Hessian matrix.
Finally, the trend surface residuals can be obtained by
δ(x, y) = g(x, y) − ˆl(x, y)

(10)

where x = 1, . . . , M , y = 1, . . . , N , and δ(x, y) = m(x, y) +
n(x, y).
B. Identification of Degraded Pixels by the Q–Q Plot
In statistics, the Q–Q plot [29] is a technique for determining whether two datasets come from populations with the same
type of distribution. It is a graphical display of a Q–Q plot of
the sample quantiles versus theoretical quantiles. For example,

Q–Q plot of two samples coming from different distribution families.

assuming that theoretical distribution follows Gaussian distribution and if the distribution of dataset also follows Gaussian
distribution, the plot should be close to form a linear pattern.
Here “quantile” means the point at which a given fraction (or
percent) of points lies below. That is, the 25% quantile is the
point at which 25% percent of the data fall below. The advantages of using the Q–Q plot are that the sample sizes do not
need to be equal, and many distribution characteristics can be
simultaneously tested. In other words, when there are two data
samples, it is often desirable to know whether the assumption
of the same distribution is justified. If so, the assumption which
two samples are from the same type of distribution is verified. If
two samples do differ, it is also useful to gain some understanding of the differences. Fig. 1 shows a Q–Q plot of two Gaussian
distributions, and Fig. 2 shows a Q–Q plot of a Gaussian distribution (X) versus an exponential distribution (Y), where the
dotted lines are the reference lines (fitted straight lines). The
linear pattern shown in Fig. 1 indicates that the two samples
come from the same distribution, while the nonlinear pattern
between the two samples shown in Fig. 2 clearly illustrates that
they are not from the same distribution family.
The idea here is to construct a Q–Q plot for the histogram of
trend surface residuals δ(x, y), which is contaminated by noise
and the noise distribution is assumed as Gaussian according
to [10]. The degraded pixels can be identified via the linear
pattern closely matching reference line in a Q–Q plot, because
if two samples come from the same distribution family, the
points should appear as a linear pattern and locate closely along

370

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

the reference line. Otherwise, the greater the departure from
the reference line, the greater the evidence demonstrates that
the two samples come from different distributions. Therefore,
{δ(x, y) |δ(x, y) ∈ linear pattern } can be recognized as the
corrupted pixel intensities. Then, the identified {δ(x, y)} is used
for the estimation of noise standard deviation by means of the
boot strapping method.
C. Estimation of Noise Statistics by Bootstrapping
Bootstrapping [30] provides a practical procedure for estimating statistics such as the median, mean, and standard deviation by measuring those properties depending on resampling
from an approximated distribution. One standard choice for an
approximated distribution is the empirical distribution of the
observed data. In the case where a set of observations can be
assumed to be from an independent and identically distributed
population, this can be implemented by constructing a number
of resamples with equal size from the observed data. Each resample is obtained by random sampling with replacement from
the original observed data. An advantage of bootstrapping is
that it provides an easy procedure for estimating the statistics
and corresponding confidence interval of complex parameters
regarding to empirical distribution of the observed data. In general, bootstrapping can be useful when the following conditions
are satisfied: 1) the theoretical distribution of one statistic is unknown and 2) the sample size is insufficient for straightforward
statistical inference.
In this study, we therefore use bootstrapping to estimate the
noise intensity level σn according to the corrupted pixels identified by the Q–Q plot. The sample of identified pixel intensities
can be regarded as the “only one sample,” and the σn is one parameter of such population. In fact σn cannot be known directly
because the real noise intensities are unknown in the cell image;
therefore, we have to estimate σ̂n of the real values depending on the identified sample from the population. Taking the
main idea of bootstrapping into consideration, many samples
from the same population can be efficiently replaced by resampling from “only one sample.” Using mathematical notations,
let θ be the mean based on one random bootstrapping sample
of size m (m = # {δ(x, y) |δ(x, y) ∈ linear pattern }). The
estimated noise intensity level σ̂n is obtained via selecting the
median value of (θ1 , θ2 , . . . , θZ ) based on Z different bootstrapping samples where each sample is of size m. We use the
following formula as the one to calculate different θi , and based
on calculated {θi |i = 1, 2, . . . , Z } the σ̂n can be obtained:
m
1  		 (i) 		
(11)
θi =
	δ 	
m j =1 j
σ̂n = med (θ1 , θ2 , . . . , θZ )
(12)
	 	
	 (i) 	
where 	δj 	 is the absolute value of jth element in ith bootstrapping sample.
The estimation of σ̂n by bootstrapping in this study is further
discussed in the experimental section. σ̂n will be used to define the mask of a Gaussian filter for the restoration over trend
residual map, which is discussed in the next section.

D. Restoration of Degraded Pixels using the Gaussian Filter
The Gaussian kernel hg (n1 , n2 ), which produces a 2-D Gaussian mask in image spatial domain, can be defined properly
based on appropriate smoothing parameter σ. Here, we assign
the estimated σ̂n as the smoothing parameter of the Gaussian
kernel within a local spatial domain L of size N1 × N2 . Then,
Gaussian spatial masks h(n1 , n2 ) are defined, respectively, as
follows:
hg (n1 , n2 ; σ̂n ) = e−(n 1 +n 2 )/(2 σ̂ n )
2

2

2

(13)

where (n1 , n2 ) ∈ LN 1 ×N 2 :
h(n1 , n2 ; σ̂n ) = 
N 1
n 1 =1

hg (n1 , n2 )

N 2
n 2 =1 hg (n1 , n2 )

(14)

where (n1 , n2 ) ∈ LN 1 ×N 2 .
In order to restore trend residual map δ(x, y) in (10), the
above defined Gaussian spatial mask is used as follows:
(N 1 −1)/2

m̂(x, y) =



(N 2 −1)/2



h(n1 , n2 ; σ̂n )

n 1 =−(N 1 −1)/2 n 2 =−(N 2 −1)/2

× δ(x − n1 , y − n2 ).

(15)

Finally, the restoration result is obtained by adding the restored residual map m̂(x, y) with the modeled trend surface
ˆl(x, y).
The restoration result presented in (16) is similar to adaptive
Wiener filter (AWF) in (17):


MAR(x, y) = ˆl (x, y) + h (x, y; σ̂n ) g (x, y) − ˆl (x, y) (16)
WF(x, y) = mf (x, y) +

σf2 (x, y)
[g(x, y) − mf (x, y)].
σf2 (x, y) + σn2
(17)

Equation (17) assumes that pixel intensity is stationary within
local spatial domain L, then g(x, y) can be modeled by its loσ 2 (x,y )

f
cal mean mf (x, y) and local structure response σ 2 (x,y
(σf
)+σ n2
f
is local standard deviation in spatial domain L). Based on this
assumption, the Wiener filter can produce the restored image
WF(x, y) ∈ L as summarized in [31]. Even though both formulas in (16) and (17) have similar terms, but their differences
are still evident and can be stated as follows:
1) ˆl(x, y) represents the global brightness trend which is
more noise-robust than mf (x, y), because mf (x, y) is
calculated based on local support region and its noise robustness is limited.
2) h(n1 , n2 ; σ̂n ) involves σ̂n , which is not calculated based
on local support region but automatically estimated depending on the corrupted pixels from the whole image.
By the comparison with global estimation, wiener filter
locally estimates σn .

XU et al.: MULTISTAGED AUTOMATIC RESTORATION OF NOISY MICROSCOPY CELL IMAGES

371

TABLE I
APPROPRIATE SELECTION OF POLYNOMIAL ORDER p ACCORDING TO THE
CRITERION OF “MINIMAL MSE” FOR DIFFERENT CELL IMAGES DEGRADED BY
SYNTHETIC GAUSSIAN NOISE WITH VARYING INTENSITY LEVELS

Fig. 3. Four DIC yeast cell images used in synthetic noise experiment: (a)
Cell 1, (b) Cell 2, (c) Cell 3, and (d) Cell 4.

III. EXPERIMENTAL RESULTS
A. Experiment 1: Removal Synthetic Gaussian Noise on Yeast
Cell Database
In this study, we tested the proposed restoration method by
using DIC yeast cell images provided in [32]. Four datasets are
used for the synthetic Gaussian noise experiment and shown in
Fig. 3. Such datasets are largely noiseless and have the following
imaging settings: pixel size 0.12758 μm, objective 100×, image
size 512 × 512, and intensity range is scaled to [0, 255].
In the trend surface analysis, the polynomial order p plays
a vital role in brightness trend modeling. In order to obtain
reasonable trend modeling results, we select the appropriate
one via assigning different p over a range of trials. For the
quantitative evaluation of modeling performance and the proper
selection of p, the mean square error (MSE) is utilized and
the criterion of “minimal MSE” is adopted. That is, the less the
MSE is, the better is the modeling performance. The appropriate
choice p = 3 for brightness trend modeling is demonstrated in
Table I.
The bootstrapping in this study is implemented as follows:
1) Z = 100 resamples are drawn from the Q–Q plot identified pixels sample {δ(x, y) |δ(x, y) ∈ linear pattern }; 2) the
mean θ is calculated for each bootstrapping sample according
to (11); 3) the estimated noise intensity level σ̂n is obtained
when selecting the median value of (θ1 , θ2 , . . . , θZ ) according
to (12); (iv) the (1 − α) confidence interval of the estimated
σ̂n is [σ̂R (α /2) , σ̂R (1−α /2) ]. For example, when Z = 100 and
α = 0.05, 3rd and 97th ascending ordered elements are marked
as lower and upper bounds of confidence interval, and 50th
ordered element (median value) is selected as σ̂n .
In Fig. 4, (a), (c), and (e) show the trend surface and Q–Q plot
regarding to Fig. 3(a). Then (b), (d), and (f) in Fig. 4 show the

corrupted cell image by additive Gaussian noise (σn = 30), their
corresponding trend surface and Q–Q plot, respectively. The
restoration results obtained by seven approaches for Fig. 3(a)
degraded by synthetic Gaussian noise (σn = 30) are shown in
Fig. S1 (see supplement material). The degraded images are
restored using seven approaches: bilateral filter (BF) [15], AWF
[31], nonlocal mean filter (NLM) [18], TV filter [19], nonlinear
fourth-order PDE and relaxed median filter (PDE) [21], fuzzybased filter (FUZZY) [25], and proposed multi-staged automatic
restoration scheme (MAR). All filter parameters are tuned as
follows: window size 3 × 3, σspatial = 1 and σrange = 30 for
BF; window size 3 × 3 for AWF; searching window size 7 × 7,
similarity window size 3 × 3 and smoothing parameter h = σn
for NLM; theta value 16 for TV; iteration time 3 for PDE;
window size 5 × 5 for FUZZY; in order to verify the necessity of
brightness trend modeling in proposed restoration scheme, two
different combinations: MAR1 and MAR2 are compared. Here,
MAR1 stands for “QQ + Boot + GF” while MAR2 represents
“Trend + QQ + Boot + GF” . Obviously, the procedure of trend
surface mapping is ignored in MAR1 in contrast to MAR2. We
assign filter mask size 3 × 3 for MAR1, and mask size 3 × 3 as
well as polynomial order p = 3 for MAR2.
Two restoration quality criteria: PSNR and SSIM are used
to evaluate the performance of these six approaches (the higher
PSNR and SSIM the better restoration). In particular, the SSIM
index was proposed to predict human preferences in evaluating
image quality. The introduction of the SSIM index was based
on the motivation that although PSNR are among the most popular measures of image quality, they do not account for both
intensity variations and geometric distortions. The structural

372

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Fig. 4. Trend surfaces and Q–Q plots of Fig. 3(a): (a) Original Fig. 3(a), (b) Corrupted Fig. 3(a) by synthetic Gaussian noise (σ n = 30), (c) and (d) are trend
surfaces for (a) and (b), (e) and (f) are Q–Q plots corresponding to (a) and (b), respectively.

information of an image expressed by the SSIM index is defined
as attributes that represent the visual structures of the objects,
apart from the mean intensity and contrast. The SSIM index has
been reported as a good image quality assessment for a wide
variety of image distortions [33]. Thus, the use of SSIM can be
useful for quantifying the overall structure of a restored image
which is reconstructed to its original version.
Table II and Tables S1–S3 (see supplement material) present
the comparison of restoration results provided by seven methods for 4 yeast cell datasets degraded by varying intensities of
Gaussian noise (σn = 10, 20, 30, 40, and 50, respectively). The
restoration performance achieved by MAR2 is better than that
of MAR1. Besides, MAR2 outputs the best restoration results in
terms of PSNR and SSIM at moderate and high noise intensities
of σn = 20, 30, 40, and 50. At lower noise intensity of σn = 10,
MAR2 dose not achieve highest PSNR and SSIM but it is still
competitive to NLM, TV, and FUZZY. In the proposed MAR2
scheme, the brightness trend modeling and Q–Q plot contribute
to the effective identification of corrupted pixels. According to
Fig. 4(c) and (d), the modeled brightness trends are quite similar
with each other before and after noise corruption, due to the advantage of noise robustness provided by trend surface fitting in
Geostatistics. That is, involvement of a measurement error in geographic surveys probably results in noisy measured data. Trend
surface mapping captures global trends of measured data instead
of the local patterns, therefore the adverse effects of noise could
be significantly reduced. In the procedure of brightness trend
modeling, we test different polynomial orders and find that the
use of higher orders (e.g., p = 4, 5, and 6) quite often leads to
the distortion around image boundary and results in high MSE.
This issue has been discussed in [27] and [28] and demonstrated
in Table I. Furthermore, from top right to bottom left in studied
images, the image brightness gradually becomes dark to bright
in Fig. 3(a), and this gradually varied trend is captured by trend

surface mapping in Fig. 4(c) and (d), respectively. Depending
on Fig. 4(f), the Q–Q plot reveals that the distribution of noisy
pixel intensities could evolve to Gaussian-like distribution due
to the effect of synthetic Gaussian noise. That is, the linear pattern along reference line in Q–Q plot, highlights the corrupted
pixels. In noiseless cases, images carry little noise; therefore, the
linear pattern along reference line in the Q–Q plot is not obvious
[shown in Fig. 4(e)]; however, for severe noise corruption, the
linear pattern could be more distinct because the images suffer much more noise [illustrated in Fig. 4(f)]. In the proposed
MAR2 scheme, only the highly corrupted pixels identified by
linear pattern are involved in bootstrapping for noise estimation.
In order to verify the efficiency of noise level estimation based on
proposed “Trend + QQ + Boot” scheme, the synthetic Gaussian
noise with varying intensities (σn = 10, 20, 30, 40, 50, 60, 70,
and 80, respectively) is added up to four studied cell images.
Then, the estimation is compared with ground truth and WF
scheme. Fig. 5 demonstrates the efficiency of proposed “Trend
+ QQ + Boot” noise estimation scheme.
Table III illustrates the comparison of computation time taken
by seven restoration methods for denoising a single image whose
size is 512 × 512. According to Table III, the ranking of different
filters in an increasing order is sorted as follows (1 and 7 represent the least and most processing time, respectively): (1) WF,
(2) TV, (3) PDE, (4) MAR2, (5) BF, (6) FUZZY and (7) NLM.
Both WF and TV require little time for image denoising and
can be regarded as the quickest filters in this experiment. PDE
needs to iteratively update pixel intensities while MAR2 integrates different three approaches to work as a whole. Both could
be comparably slower. BF locally detects the edges depending
on intensity range kernel sliding over the whole image domain,
thus, more processing time has to be consumed. FUZZY calculates the local difference by sliding window and obtains the
pixel-wise uncertainty; therefore, the running-time is long. The

XU et al.: MULTISTAGED AUTOMATIC RESTORATION OF NOISY MICROSCOPY CELL IMAGES

373

TABLE II
COMPARISON OF RESTORATION RESULTS FROM 8 APPROACHES FOR CELL IMAGE 1 DEGRADED BY VARYING INTENSITIES OF SYNTHETIC GAUSSIAN NOISE

TABLE III
COMPARISON OF COMPUTATIONAL TIME (SECONDS) FOR SINGLE CELL IMAGE
WITH THE SIZE OF 512 × 512

denoted as follows:
Ẑ = (1 / 4) Ŝ 2 − (3 / 8)

Fig. 5. Comparison of noise level estimation between MAR2 and WF for
Fig. 3(a).

computational time of NLM is significantly higher than other
techniques, and even this filter would take more time for image
restoration if searching or similarity window size is enlarged.
B. Experiment 2: Removal Synthetic Poisson Noise on Yeast
Cell Database
This experiment extends the proposed approach to remove
the Poisson noise, which is easily generated in microscopy
system [11], [46]. Unlike Gaussian-distributed noise, removing Poisson-distributed noise in microscopy images is not an
easy task, due to the parameter of Poisson distribution is a
function of the underlying image pixel intensity. Consequently,
the proposed approach cannot be utilized in a straightforward
way to handle Poisson noise. However, a transformation-based
strategy is adopted to cope with Poisson noise by integrating
variance stability transform (VST) with the proposed multistaged restoration scheme. That is, VST is applied to the input
image, and then through the VST transformation, the noise with
Poisson distribution is converted to the noise with approximated
Gaussian distribution. The VST is mathematically denoted as
follows according to [34] and [35]:

S = 2 Z + 3/8

(18)

where S and Z are the transformed image (after VST) and
the input image (before VST), respectively. After using VST,
our proposed algorithm can be used to denoise the transformed
image with the same multistaged restoration scheme proposed
in the paper, and the denoised result can be transformed back to
the restored image by using an inverse transformation (iVST)

(19)

where Ẑ represents the final restored image (after iVST), and
Ŝ represents the result obtained by the proposed multistaged
restoration scheme (before iVST). This integrated strategy (VST
+ MAR2 + iVST) is easy to be implemented. Similarly, we also
apply the same integrated strategy to BF, WF, NLM, TV, PDE,
and FUZZY for Poisson noise removal. All filter parameters are
maintained the same as those in experiment 1. Table IV demonstrates that the proposed method outperforms other methods in
terms of PSNR and SSIM.
C. Experiment 3: Segmentation for Real Noisy Phagocytosing
Budded Yeast Cell Database
In this experiment, we use a real noisy DIC microscopy cell
dataset provided in [36] to verify whether the proposed restoration scheme would improve the performance of cell segmentation. The used phagocytosing budded yeast cell database is
a time series whose imaging settings are pixel size 0.14 μm,
NA DIC objective 63 × 1.4, time spacing 3.94 s, image size
154 × 126 and intensity range is scaled to [0, 255]. The above
seven restoration approaches: BF, WF, NLM, TV, PDE, FUZZY
and MAR2 are applied to restore this real noisy dataset, respectively, and subsequent cell segmentation is implemented based
on the obtained restoration results.
The segmentation method used in this experiment is one of
the typical morphological filtering approaches [37]. By combining different morphological operators such as erosion, dilation,
opening, and closing, the cellular regions could be effectively
marked and segmented [40]. Here the “disk” structure element
is assigned to implement morphological filtering. In order to
obtain correctly segmented cellular regions, we select the appropriate element size based on the segmentation performance
obtained over a range of trials. For the quantitative evaluation of
segmentation results, ground truth is given by manual segmentation. Here, the true positive rate (TPR: sensitivity) is defined
as the percentage of pixels that belongs to cellular regions which

374

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

TABLE IV
COMPARISON OF RESTORATION RESULTS FROM 7 APPROACHES FOR CELL IMAGES 1-4 DEGRADED BY SYNTHETIC POISSON NOISE

Fig. 6. Segmentation results given by morphological filtering based on real noisy cell image and restored images: (a) ground truth obtained by manual segmentation,
(b) real noisy image, (c)–(i) restoration results given by 7 approaches: BF, WF, NLM, TV, PDE, FUZZY, and MAR2, respectively, (j)–(q) corresponding binary
segmentation results, where the optimal size of “disk” structure element r is assigned respectively as follows: (j) r = 3, (k) r = 6, (l) r = 6, (m) r = 10, (n)
r = 7 or 8, (o) r = 7, (p) r = 4, and (q) r = 8.

are correctly segmented from the background, and false positive rate (FPR: specificity) is defined as the percentage of pixels
that belongs to the background but wrongly recognized as cellular pixels. The proper selection of the structure element size is
demonstrated in Table S4 (see supplement material), where the
criterion of “the highest TPR and the lower FPR” is adopted. For
the images denoised by different restoration methods, the appropriate structure element sizes are used and the corresponding
segmentation results are shown in Fig. 6. In general, the segmentation result based on MAR2 demonstrates the correctly
segmented cellular regions in contrast to other six methods. The
segmentation result depending on FUZZY is competitive to that
of MAR2, even small areas inside the cell are missing [shown
in Fig. 6 (p)]. The segmentation results based on BF and WF
appear in the incomplete cellular regions (shown in Fig. 6 (k)
and (l), respectively). For WF-, NLM-, TV-, and PDE-based
segmentation, the wrongly recognized pixels can be obviously
observed in Fig. 6 (l), (m), (n), and (o) respectively. The direct
segmentation based on real noisy data produces a poor result.
Because a large number of cellular pixels are falsely segmented
as background ones, they are missing in the binary result.

IV. CONCLUSION
Segmentation-based image analysis for the individual cell
from microscopy images is promising. However, this task encounters a number of challenges [41]–[43]: 1) the intensities of
the fluorophores and their spatial distribution may change over
time during an experiment, leading spot stain in each image;
2) the images suffer low SNR, because the laser light intensity
needed to excite fluorescent probes is often reduced as minimum
as possible to avoid cell damage; 3) the cells are often touching
and occluded, when cells are aggregated and interact with each
other; 4) the cell morphology change could continuously happen during the cell cycle, and consequently the cell morphology
may be diverse at the different cell phase. Therefore, the influence of noise can cause difficulty in automated cell segmentation and feature extraction of cell images such as cell counting, texture representation, and morphological characteristic
extraction.
Subcellular organelle segmentation is another promising direction with the high-resolution microscopy [44], [45]. The subcellular components and organelle structures can be clearly observed and well investigated via high-resolution microscopy. In

XU et al.: MULTISTAGED AUTOMATIC RESTORATION OF NOISY MICROSCOPY CELL IMAGES

contrast to the lower resolution microscopy, however, the higher
resolution microscopy images are easily corrupted by higher intensity noise, because of the high-resolution light microscopy
approaching the resolution limit [11]. Prior to subcellular organelle segmentation, the following assumptions need to be
made.
1) The noise corruption needs to be assumed mild and moderate. Otherwise, the restored image would contain lots of
noise once serious noise corruption happened. As a consequence, the subcellular organelle segmentation based on
such not well restored images would result in the large
number of missing or false subcellular organelle.
2) For the real-world images generated from microscopy,
the noise needs to be assumed as Gaussian distributed. If
so, the proposed method would be confident to remove
the Gaussian-distributed noise. Otherwise, the proposed
algorithm could not be applied directly. For the assumption of Poisson noise corruption, VST could be integrated
with the proposed algorithm to effectively remove Poisson
noise.
We have discussed a novel integration of trend surface mapping, Q–Q plot, bootstrapping, and Gaussian spatial kernel for
removing Gaussian-like noise in microscopy cell images. The
integrated approach performs as an adaptive image restoration
which achieves better results compared to some other stateof-art restoration methods. One advantage of the proposed approach is that its methodology is flexible and therefore can
be extended to handle Poisson noise. Besides, the potential
improvement is the appropriate selection of noisy pixel candidates according to the linear pattern along a reference line
in a Q–Q plot. Such a selection could improve the reliability
of noise estimation by bootstrapping. Above all, the proposed
multistaged automatic restoration method provides a superior
denoising scheme, and could be a highly valuable step prior to
cell segmentation for numerously generated and widely used
microscopy cell images.
ACKNOWLEDGMENT
The authors would like to thank Yeast Resource Center, University of Washington for the test data of yeast cell, and also
would like to thank The Cell—An Image Library for the test
data of phagocytosing budded yeast cell. The first author J. Xu
would like to thank the first year Ph.D. supervision provided by
Dr. T. Pham of University of Aizu, Japan when he was at The
University of New South Wales, Australia.
REFERENCES
[1] P. Lang, K. Yeow, A. Nichols, and A. Scheer, “Cellular imaging in drug
discovery,” Nature Rev. Drug Discovery, vol. 5, pp. 343–356, 2006.
[2] A. Bullen, “Microscopic imaging techniques for drug discovery,” Nature
Rev. Drug Discovery, vol. 7, pp. 54–67, 2008.
[3] V. Starkuviene and R. Pepperkok, “The potential of high-content highthroughput microscopy in drug discovery,” Brit. J. Pharmacol., vol. 152,
pp. 62–71, 2007.
[4] K. A. Baraa, J. M. Philip, M. N. Nicole, and N. J. Dwayne, “An automated cell-counting algorithm for fluorescently-stained cells in migration
assays,” Biol. Procedures Online, vol. 13, pp. 1–5, 2011.

375

[5] K. Bredies and H. Wolinski, “An active-contour based algorithm for the
automated segmentation of dense yeast populations on transmission microscopy images,” Comput. Visualization Sci., vol. 14, pp. 341–352,
2011.
[6] V. T. Ta, O. Lezoray, A. Elmoataz, and S. Schupp, “Graph-based tools
for microscopic cellular image segmentation,” Pattern Recog., vol. 42,
pp. 1113–1125, 2009.
[7] P. M. Pilarski and C. J. Backhouse, “Towards robust cellular image classification: theoretical foundations for wide-angle scattering pattern analysis,” Biomed. Opt. Exp., vol. 1, pp. 1225–1233, 2010.
[8] L. Shamir, J. D. Delaney, N. Orlov, D. M. Eckley, and I. G. Goldberg,
“Pattern recognition software and techniques for biological image analysis,” PLOS Comput. Biol., vol. 6, pp. e1000974-1–e1000974-10, 2010.
[9] G. Dougherty, Digital Image Processing for Medical Applications.
Cambridge: Cambridge Univ. Press, 2009.
[10] P. Sarder and A. Nehorai, “Deconvolution methods for 3-D fluorescence
microscopy images,” IEEE Signal Process. Mag., vol. 23, no. 3, pp. 32–45,
May 2006.
[11] A. Papini, “A new algorithm to reduce noise in microscopy images implemented with a simple program in python,” Microscopy Res. Tech., vol. 75,
pp. 334–342, 2012.
[12] Y. L. Wang, “Computational restoration of fluorescence images: noise
reduction, deconvolution, and pattern recognition,” Methods Cell Biol.,
vol. 72, pp. 337–348, 2003.
[13] C. W. Chang and M. A. Mycek, “Total variation versus wavelet-absed
methods for image denoising in fluorescence lifetime imaging microscopy,” J. Biophoton., vol. 5, pp. 449–457, 2012.
[14] R. S. Pantelic, R. Rothnagel, C. Y. Huang, D. Muller, D. Woolford, M. J.
Landsberg, A. McDowall, B. Pailthorpe, P. R. Young, J. Banks, B. Hankamer, and G. Ericksson, “The discriminative bilateral filter: an enhanced
denoising filter for electron microscopy data,” J. Struct. Biol., vol. 155,
pp. 395–408, 2006.
[15] C. Tomasi and R. Manduchi, “Bilateral filtering for gray and color images,”
in Proc. IEEE Int. Conf. Comput. Vision, 1998, pp. 839–846.
[16] W. Jiang, M. L. Baker, Q. Wu, C. Bajaj, and W. Chiu, “Applications of
a bilateral denoising filter in biological electron microscopy,” J. Struct.
Biol., vol. 144, pp. 114–122, 2003.
[17] A. Buades, B. Coll, and J. M. Morel, “A non-local algorithm for image
denoising,” in Proc. IEEE Comput. Soc. Conf. Comput. Vision Pattern
Recog., 2005, vol. 2, pp. 60–65.
[18] A. Buades, B. Coll, and J. M. Morel, “A review of image denoising algorithms with a new one,” SIAM J. Multiscale ModelingSimulation, vol. 4,
pp. 490–530, 2005.
[19] L. I. Rudin, S. Osher, and E. Fatemi, “Nonlinear total variation based
noise removal algorithms,” Physica D: Nonlinear Phenomena, vol. 60,
pp. 259–268, 1992.
[20] P. Perona and J. Malik, “Scale-space and edge detection using anisotropic
diffusion,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 12, no. 7, pp. 629–
639, Jul. 1990.
[21] J. Rajan, K. Kannan, and M. R. Kaimal, “An improved hybrid model for
molecular image denoising,” J. Math. Imag. Vision, vol. 31, pp. 73–79,
2008.
[22] S. Schulte, B. Huysmans, A. Pizurica, E.E. Kerre, and W. Philips, “A new
fuzzy-based wavlet shrinkage image denoising technique,” Adv. Concepts
Intell. Vis. Syst., Lecture Notes Comput. Sci., vol. 4179, pp. 12–23, 2006.
[23] S. Schulte, V. D. Witte, and E. E. Kerre, “A fuzzy noise reuction method
for color images,” IEEE Trans. Image Process., vol. 16, no. 10, pp. 1425–
1436, Oct. 2007.
[24] M. Wilscy and M. S. Nair, “A new fuzzy-based additive noise removal
filter,” Adv. Electr. Eng. Comput. Sci., Lecture Notes Electr. Eng., vol. 39,
pp. 87–97, 2009.
[25] M. S. Nair and G. Raju, “Additive noise removal using a novel fuzzy-based
filter,” Comput. Electr. Eng., vol. 37, pp. 644–655, 2011.
[26] S. Paris, S. W. Hasinoff, and J. Kautz, “Local laplacian filters: Edgeaware image processing with a Laplacian pyramid,” ACM Trans. Graphics,
vol. 30, pp. 1–11, 2011.
[27] I. Clark, Practical Geostatistics. London, U.K.: Applied Science Publishers, 1979.
[28] J. P. Chiles and P. Delfiner, Geostatistics: Modeling Spatial Uncertainty.
New York, NY, USA: Wiley, 1999.
[29] M. B. Wilk and R. Gnanadesikan, “Probability plotting methods for the
analysis of data,” Biometrika, vol. 55, pp. 1–17, 1968.
[30] B. Efron and R. Tibshirani, An Introduction to the Bootstrap. Boca
Raton, FL, USA: Chapman & Hall, 1993.

376

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

[31] J. S. Lim, Two-Dimensional Signal and Image Processing. Englewood
Cliffs, NJ, USA: Prentice Hall, 1990.
[32] M. Riffle and T. N. Davis, “The yeast resource center public image repository: A large database of fluorescence microscopy images,” BMC Bioinformatics, vol. 11, no. 263, pp. 1–9, 2010.
[33] Z. Wang, A. C. Bovik, H. R. Sheikh, and E. P. Simoncelli, “Image quality
assessment: From error measurement to structural similarity,” IEEE Trans.
Image Process., vol. 13, no. 4, pp. 600–612, Apr. 2004.
[34] S. T. Li, L. Y. Fang, and H. T. Yin, “An efficient dictionary learning algorithm and its application to 3-D medica image denoising,” IEEE Trans.
Biomed. Eng., vol. 59, no. 2, pp. 417–427, Feb. 2012.
[35] J. L. Starck, F. Murtagh, and A. Bijioui, Image Processing and Data
Analysis: the Multiscale Approach. Cambridge, U.K.: Cambridge Univ.
Press, 1988.
[36] M. Clarke, U. Engel, J. Giorgione, A. M. Taubenberger, J. Prassler, D.
Veltman, and G. Gerisch, “Curvature recognition and force generation in
phagocytosis,” BMC Bioinformatics, vol. 8, no. 154, pp. 1–22, 2010.
[37] E. Meijering, “Cell Segmentation: 50 Years Down the Road,” IEEE Signal
Process. Mag., vol. 29, no. 5, pp. 140–145, Sep. 2012.
[38] S. Y. Chen, M. Z. Zhao, G. Wu, C. Y. Yao, and J. W. Zhang, “Recent Advances in Morphological Cell Image Analysis,” Comput. Math. Methods
Med., vol. 2012, pp. 1–10, 2012.
[39] Z. Pincus and J. A. Theriot, “Comparison of quantitative methods for
cell-shape analysis,” J. Microscopy, vol. 227, pp. 140–156, 2007.
[40] Marker-controlled watershed segmentation, [Online]. Available: http://
www.mathworks.com.au/help/images/examples/marker-controlledwatershed-segmentation.html
[41] O. Dzyubachyk, W. A. V. Cappellen, J. Essers, W. J. Niessen, and E. Meijering, “Advanced level-set-based cell tracking in time-lapse fluorescence
microscopy,” IEEE Trans. Med. Imag., vol. 29, no. 3, pp. 852–867, Mar.
2010.
[42] D. J. Stephens and V. J. Allan, “Light microscopy techniques for live cell
imaging,” Science, vol. 300, pp. 82–86, 2003.
[43] M. D. Acunto and O. Salvetti, “Image analysis aided by segmentation
algorithms for techniques ranging from scanning probe microscopy to
optical microscopy,” Microscopy: Sci., Tech., Appl. Education, vol. 2,
pp. 1455–1466, 2010.
[44] A. Danckaert, E. G. Couto, L. Bollondi, N. Thompson, and B. Hayes,
“Automated recognition of intracellular organelles in confocal microscope
images,” Traffic, vol. 3, pp. 66–73, 2002.
[45] R. F. Murphy, M. Velliste, and G. Porreca, “Robust numerical features for
description and classification of subcellular location patterns in fluorescence microscope images,” J. VLSI Signal Process., vol. 35, pp. 311–321,
2003.
[46] C. W. Chang and M. A. Mycek, “Precise fluorophore lifetime mapping
in live-cell, multi-photon exciation microscopy,” Opt. Exp., vol. 18,
pp. 8688–8696, 2010.

Jinwei Xu received the B.Eng. and M.Eng. degrees in electrical engineering
from Tianjin University, Tianjin, China, in 2008 and 2010 respectively. He is
currently working toward the Ph.D. degree in electrical engineering in The
University of New South Wales, Canberra, A.C.T., Australia.
His research interests include image processing and pattern recognition.

Jiankun Hu (M’12) received the B.E. degree from Hunan University, China,
in 1983, the Ph.D. degree in control engineering from Harbin Institute of Technology, China, in 1993, and the Masters by Research in computer science and
software engineering from Monash University, Australia, in 2000.
He is a Full Professor and Research Director of Cyber Security Lab, School
of Engineering and IT, University of New South Wales Canberra, Canberra,
A.C. T., Australia. His main research interests include field of cyber security
including biometrics security where he has published many papers in highquality conferences and journals including IEEE TRANSACTIONS ON PATTERN
ANALYSIS AND MACHINE INTELLIGENCE. He is now serving at the prestigious
Panel of Mathematics, Information and Computing Sciences (MIC), ARC ERA
(The Excellence in Research for Australia) Evaluation Committee.

Xiuping Jia (M’93–SM’03) received the B.Eng. degree from the Beijing University of Posts and Telecommunications, Beijing, China, in 1982 and the Ph.D.
degree in electrical engineering from The University of New South Wales, Canberra, A.C.T., Australia, in 1996.
Since 1988, she has been with the School of Information Technology and
Electrical Engineering, The University of New South Wales, where she is currently a Senior Lecturer. Her research interests include remote sensing and
imaging spectrometry. She is the coauthor of the remote sensing textbook titled
Remote Sensing Digital Image Analysis [Springer-Verlag, 3rd (1999) and 4th
eds. (2006)]. She is an Editor of the Annals of GIS, and an Associate Editor of
the IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING.

