2686

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Denoising Depth EEG Signals During DBS Using
Filtering and Subspace Decomposition
Janis Hofmanis∗ , Olivier Caspary, Valérie Louis-Dorr, Radu Ranta, Member, IEEE, and Louis Maillard

Abstract—In difficult epileptic patients, the brain structures are
explored by means of depth multicontact electrodes [stereoelectroencephalography (SEEG)]. Recently, a novel diagnostic technique allows an accurate definition of the epileptogenic zone using
deep brain stimulation (DBS). The stimulation signal propagates
in the brain and thus it appears on most of the other SEEG electrodes, masking the local brain electrophysiological activity. The
objective of this paper is the DBS-SEEG signals detrending and denoising in order to recover the masked physiological sources. We
review the main filtering methods and put forward an approach
based on the combination of filtering with generalized eigenvalue
decomposition (GEVD). An experimental study on simulated and
real SEEG shows that our approach is able to separate DBS sources
from brain activity. The best results are obtained by an original
singular spectrum analysis-GEVD approach.
Index Terms—Blind source separation (BSS), deep brain stimulation (DBS), denoising, electroencephalography (EEG), empirical
mode decomposition (EMD), epilepsy, filtering, generalized eigenvalue decomposition (GEVD), singular spectrum analysis (SSA),
subspace decomposition, Stereo-electroencephalography (SEEG).

I. INTRODUCTION
HE precise localization of the epileptiform discharges is a
crucial diagnostic step, particularly in patients considered
for the resective epilepsy surgery (about 20% of the epileptic patients). Invasive EEG recordings [stereoelectroencephalography
(SEEG)] prove to be necessary, when scalp EEG and electrical
source imagery do not provide sufficient localization information [1], [2]. On the other hand, electrical deep brain stimulation
(DBS) is a means of eliciting the phase clustering of local neural
responses [3]. Stimulation-induced modulation of a pathological network activity represents the most likely mechanism but
several questions remain open to explain the DBS effects [4].
Therefore, coupling DBS with SEEG measurements is really

T

Manuscript received June 26, 2012; revised December 18, 2012; April 24,
2013; accepted April 26, 2013. Date of publication May 7, 2013; date of
current version September 14, 2013. This work was supported by the French
Ministry of Health (PHRC 2009-17-05) and CHU de Nancy. Asterisk indicates
corresponding author.
∗ J. Hofmanis is with the CRAN, Université de Lorraine, Nancy 54516,
France (e-mail: janis.hofmanis@gmail.com).
O. Caspary, V. Louis-Dorr, and R. Ranta, are with the CRAN, Université de Lorraine, CRAN CNRS UMR 7039, Nancy 54516, France
(e-mail: olivier.caspary@univ-lorraine.fr; Valerie.Louis@univ-lorraine.fr;
radu.ranta@univ-lorraine.fr).
L. Maillard is with the CRAN, Université de Lorraine, Nancy 54516, France
and also with the Neurology Service, Centre Hospitalier Universitaire de
Nancy, Nancy 54000, France (e-mail: l.maillard@chu-nancy.fr).
Digital Object Identifier 10.1109/TBME.2013.2262212

interesting for the modeling and understanding of the (epileptic) brain, for diagnosis and, also, to access the estimation of
conductivities.
The functional properties of neural connections are predominantly linear [5], although not exclusively (nonlinear phenomena appear mainly on the cell scale [6]). SEEG electrodes have a
rather large surface area (1–10 mm2 ), thus the linearity assumption holds. Considering electrical properties of the propagation
medium (brain tissue), the distances between measuring and
stimulation electrodes and the characteristics of the acquisition system (sampling rate, filters), one can also consider that
the DBS source generates an electric field that is mixed linearly (instantaneously) with the brain sources. Therefore, this
stimulation source (perfectly deterministic in time and space)
propagates through the brain and masks the electrophysiological
activity recorded by other depth electrodes. It is thus interesting
to separate the DBS source from the brain sources (epileptic or
cognitive) in order to uncover signals that can be analyzed by
neurophysiologists afterwards.
The most widely employed methods belong to the linear
blind source separation (BSS) family (see, e.g., [7] and [8]).
In (S)EEG, the instantaneous linear mixing model comes directly from the quasi-static form of the Maxwell equations [9],
so BSS could be applied to separate DBS from underlying physiological activities. However, BSS is based on the key hypothesis
of independent sources and time invariant mixing matrix. It is
not clear whether in SEEG these assumptions are valid: DBS
might trigger a synchronous brain activity and the number of
neural sources is unknown and fluctuating in time. Moreover,
nonlinear saturation effects might appear during the DBS (see
Section II for further details).
Besides, in DBS setups, we have prior information about
the stimulation source: beginning and end time, spatial localization, and time structure. Consequently, the separation can
be addressed by a subspace decomposition procedure, namely
generalized eigenvalue decomposition (GEVD) [10], [11]. In
GEVD, information on a particular source can be provided by
different filtering methods: a frequency band, AM/FM filter
bank, nonlinear filter, and energy of the signal.
The aim of this study is to propose and compare different
methods for the separation of multidimensional SEEG measurements during the DBS. That is why we put forward an
original approach based on singular spectrum analysis (SSA)GEVD to detrend and denoise SEEG data simultaneously. This
paper is structured as follows. The signal acquisition and the
DBS are presented in Section II. Section III describes the model
of source mixing during the DBS and several proposed methods that aim at unmixing and eliminating the DBS source from

0018-9294 © 2013 IEEE

HOFMANIS et al.: DENOISING DEPTH EEG SIGNALS DURING DBS USING FILTERING AND SUBSPACE DECOMPOSITION

Fig. 1.

2687

CT image of depth electrodes implantation scheme.
Fig. 3.

Fig. 2. Theoretical electrical stimulation. (a) Time course (T = 20 ms, τ =
1 ms). (b) Spectrum (below 4 kHz).

measurements. The simulations and results obtained on real
SEEG signals of the filtering-GEVD approach are, respectively,
shown in Sections IV and V. Finally, Section VI provides our
conclusions.
II. DBS-SEEG ACQUISITION
SEEG signals are acquired by multielectrodes implanted in
the brain. The implantation sites are chosen according to noninvasive data collected during the presurgical phase. The number
of multielectrodes for one patient varies from 8 to 13, each consisting of 5–18 measuring contacts (electrodes) (see Fig. 1). The
DBS is applied between two neighboring contacts of a multielectrode. DBS consists of periodic biphasic impulsions with
intensities between 0.2 and 3 mA, lasting for 3 to 10 s [see
Fig. 2(a)]. The frequency spectrum [see Fig. 2(b)] of a DBS and
the amplitude Ak of the kth harmonic is as follows:
 τ 
 πτ 
τ 

(1)
sin k
Ak = 2A sinc k

T
2T
2T
where A is the magnitude of the stimulation, τ the width of the
biphasic impulsion, and T the period of the impulsion.
For SEEG signals, the reference has been chosen on the surface of the head at the nasion point. The signals were digitized
at a sampling rate of 4096 Hz on a 128-channels amplifier (LTM

Frequency spectrum of a real SEEG signal during the DBS.

128 Headbox; Micromed, Italy) and decimated at 512 Hz. Two
antialiasing filters have been used: a hardware filter before digitization at 4096 Hz and a digital filter before decimation. These
filters are designed according to the bandwidth of the EEG signal
but they are not selective enough to suppress the high-frequency
harmonics of the DBS. Therefore, aliasing occurs from 300 Hz
harmony onwards as shown in Fig. 3, with spectral harmonics
of DBS as 50, 100, 200, and 250 Hz and aliased harmonics from
300 Hz up to 1000 Hz. The formula to calculate directly nth
DBS aliased and nonaliased harmonic is as follows:
 
	




Fn
Fn
mod2
F̂n = Fhs + (−1) F h s (Fn mod Fhs ) − Fhs 1 +
Fhs
(2)
where Fn is nth DBS harmonic, Fhs is half the sampling rate,
· is the integer part function (also known as floor function)
and (· mod ·) is modulus after division. Fig. 3 shows real DBS
harmonics 300, 350, 400, 450, 500, 550 Hz, and so forth, aliased
at 212, 162, 112, 62, 12, 38 Hz, respectively.
III. METHODS AND MODEL
Considering the dipole model of K brain sources, each measured signal vector x̄(t) = [x̄1 (t), . . . , x̄M (t)]T from the M
electrodes may be written as an instantaneous linear system
x̄(t) = A s(t)

(3)

where A(M × K) is the mixing matrix, s(t) the SEEG sources,
and n(t) the noise. The contribution of the external stimulation
signal sstim (t) can be added to the previous model, such as
x(t) = x̄(t) + sstim (t) + n(t)

(4)

where sstim (t) = as ss (t) + strend (t) is composed of a
weighted (propagated) stimulation source ss (t) and the
trend strend (t) generated by electronic commutations in the
acquisition-stimulation system. The symbol · indicates possible saturated values, again due to the acquisition system limits
(in practice, this saturation appears on the electrodes close to
the stimulation site, when the DBS and the commutation artifact
are strong; see Fig. 5).
Depending on the context, the source separation problem can
be approached by a GEVD formulation, which spatially filters mixed sources using prior information. In [12], a unified

2688

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

solution summarizes the assumptions for a successful estimation. A GEVD application to separate maternal ECG from fetal
ECG has shown the possibility to rank the estimated sources in
order of periodicity [10]. Different types of artifacts have been
removed from EEG recordings [11], [13]. Finally, Tome [14]
has presented a first GEVD computation with filtered signals
using a finite impulse response (FIR) filter.
In this study, we propose and evaluate three original filteringGEVD combinations. In order to make use of prior information
necessary to GEVD, that is to say the close relationship between
stimulation and high-frequency harmonics, which are different from the low-frequency baseline and from the frequencies
of electrophysiological sources, we suggested: (a) a Savitzky–
Golay filter (SGF) [15], (b) the SSA [16], and (c) the empirical
mode decomposition (EMD) [17]. If the SGF (such as the classical FIR) is a linear frequency filtering, SSA can be considered to
be a nonparametric spectral estimation in an empirical orthogonal functions space, while EMD is an empirical decomposition
in AM/FM filter banks. The three filtering/GEVD combinations
will be compared with a FIR/GEVD method similar to [14], nonlinear median filtering (MED) (suggested for artifact removal
in [13]) with GEVD (that we call MED/GEVD), as well as with
the classical uninformed BSS.
A. Filtering Approaches
1) SGF: The SGF is frequently applied in EEG, ECG, and
other biomedical fields [18] for smoothing noisy data, and it
can be demonstrated that least-squares smoothing reduces noise
while maintaining the shape and height of waveform peaks.
It acts as a weighted average on a sliding window of 2L + 1
samples. Each sample x(t) is replaced by a linear combination
xSG (t)
xSG (t) =

L


ci x(t + i)

(5)

i=−L

where the SGF coefficients ci define a FIR filter depending on
the order NSG of the polynomial [15].
2) SSA: The SSA [19] is a nonparametric method which
uses an adaptive-data basis set to extract information assumed
to be stationary in the weak sense. SSA, well adapted for short
and nonstationary time series, can be summed up in three steps.
The first step builds a trajectory matrix F from x(t)
⎞
⎛
x(1)
x(2) · · ·
x(L)
⎟
⎜
x(2)
x(3) · · · x(L + 1) ⎟
⎜
⎟
⎜
F=⎜
⎟ . (6)
..
..
..
..
⎟
⎜
.
.
.
.
⎠
⎝
x(N − L + 1)

···

···

x(N )

The matrix F is used to estimate the correlation matrix by
R=

FT F
N −L+1

(7)

where L defines the longest periodicity that can be estimated by
SSA or a multiple of the expected period in the case of trend
extraction application.

Next, an eigendecomposition is applied to R, such as
R=

L


λi Ui UiT

(8)

i=1

where λi and Ui are, respectively, the nonnegative decreasing
eigenvalues and the column eigenvectors of R. Selecting I ≤ L
eigenvectors, usually those associated to the highest eigenvalues, yields a reconstructed trajectory matrix T
T=

I


Ui ViT

(9)

i=1

where V = F U is the decorrelated components matrix formed
by the Vi decomposed sources (or temporal principal components) and the matrix U the set of Ui eigenvectors. The last
step is a spatial smoothing thanks to an antidiagonal averaging
of T (like hankelization) to preserve their phase. Then, the filtered signal called xSSA (t) is built from each averaging value of
the antidiagonals of smoothed T. Let T = (Ti j )Li,j,N=1−L +1 , each
sample of xSSA (t) is given by
xSSA (t) =
⎧
t
⎪
1 
⎪
⎪
Tm ,t−m +1
1≤t≤L
⎪
⎪
⎪
⎪ t m =1
⎪
⎪
⎪
⎪
L
⎨1 
Tm ,t−m +1
L+1≤t≤N −L
L m =1
⎪
⎪
⎪
⎪
⎪
⎪
N
−L +1
⎪
⎪
1
⎪
⎪
Tt−m +1,m L + 1 ≤ t ≤ N.
⎪
⎩N −t+1

(10)

m =t−L +1

If SSA is used to estimate DBS measurements, one of the
components should correspond to nonperiodic SEEG sources
and to the baseline, and all others to different periodic parts
(harmonics) of stimulation. Accordingly, to automatically retain
SEEG sources, we need to ensure that the eigenvalues of SEEG
sources are higher than that of stimulation and thus, retaining
the first component after the decomposition step, will filter off
the stimulation source. This can be achieved by adding a high
variating artificial trend to measurements and, after the filtration,
by removing it from the resulting signal. Hence, only parameter
L must be adjusted (depending on the stimulation frequency)
and I can be fixed to 1. The added trend is a line increasing
from −1500 to 1500 μV.
3) EMD: EMD is a data-based decomposition method that
processes linear/nonlinear, stationary/nonstationary signals. It is
employed as a denoising or detrending method according to the
considered application. EMD is built on the assumption that a
signal can be iteratively decomposed into a finite set of different
oscillation modes called intrinsic mode functions (IMFs). The
algorithm ends when a monotonic IMF is found to be residual.
Each ith SEEG signal xi (t) is decomposed according to
xi (t) =

J

j =1

IMFi,j (t)

(11)

HOFMANIS et al.: DENOISING DEPTH EEG SIGNALS DURING DBS USING FILTERING AND SUBSPACE DECOMPOSITION

Fig. 5.
site.

Fig. 4.

Denoising multichannel signals with the Filtering-GEVD approach.

where J is the number of total IMFs. The first IMFs contain highfrequency components that correspond to the noise and a large
part of the stimulation. For denoising, it is enough to suppress
the first two IMFs for each xi (t) to keep low-oscillating SEEG
sources that are shown in [20].

2689

Simulated acquisition of a DBS on an electrode close to the stimulation

and nonlinearly saturated stimulation source. GEVD diagonalizes two covariance matrices (RX and RY ) simultaneously
[see (13)], giving eigenvectors related to both real and filtered
versions of the signal. So, components recovered by GEVD
with high energy (high eigenvalues) will represent low variating
sources (spanned by both RX and RY ). In contrast, the spatial
information of the stimulation is highly reduced in RY and thus,
will always be rejected by joint diagonalization.
C. BSS

B. Filtering/GEVD Approach
GEVD is a decomposition that requires two matrices. The
first one corresponds to the correlation matrix RX built from
SEEG channels X of dimension (M × N ):
1
X XT .
(12)
N
The second one is a correlation matrix RY calculated likewise
with a matrix Y defined by Y = H(X), where the operator H(·)
represents a temporal filtering function applied to each row in
X. More precisely, this operator carries out a preprocessing for
each SEEG channel with one of the filtering algorithms defined
in Section III-A.
Solving GEVD for the symmetric matrix pair (RY , RX ) implies maximizing the Rayleigh quotient defined as
RX =

Q(E) =

ET RY E
.
ET RX E

The optimum is found by resolving a joint diagonalization
 T
E RY E = Λ
ET RX E = IM .

(13)

x(t) = A s(t) ⇒ s(t) = B x(t)

(16)

where B is a reverse linear transformation of A allowing to
estimate the stimulation artifact. Among BSS algorithms, we
retained one based on high-order statistics, called fast independent component analysis (FastICA) [7], and one based on
second-order statistics, called SOBIRO [8].
IV. SIMULATIONS AND REAL DATASETS
A. Synthetic Datasets

(14)

The matrix E of dimension (M × M ) contains the eigenvectors
and the diagonal matrix Λ the eigenvalues of (RY , RX ) sorted
in descending order. IM is the identity matrix. With GEVD, the
decomposed sources are given by V = ET X.
Afterwards, to eliminate unwanted components from SEEG
signals, we recompose X̄ as follows:
X̄ = E−T G ET X

Under the hypothesis that DBS is independent of the brain
activity and linearly projected on the electrodes, one might use
BSS to separate it. The goal of BSS is to recover all sources
(assumed independent and linearly mixed) from the observed
measures, both the mixing system A and the sources S being
unknown [21]. For each time sample of X and S, the model, in
its simplest form, can be written as follows:

(15)

where the diagonal gain matrix G = diag(1, . . . , 1, 0, . . . , 0)
selects the desired components. The filtering-GEVD approach
is summarized in Fig. 4.
The idea of using GEVD is to assume that, knowing the
characteristics of stimulation, after filtration we will keep only
desirable SEEG signals while eliminating high-frequency noise

To analyze the performance of the methods described in
Section III, we simulated realistic datasets. A first step was the
simulation of the entire SEEG acquisition system (filtering and
baseline artifact) and of the stimulation pattern [see Fig. 2(a)] as
described in Section II. An important side effect of the baseline
deviation provoked by the commutation between acquisition
and stimulation modes is the saturation observed mainly on the
electrodes close to the stimulation site, where the amplitude of
the propagated pattern exceeds the range of the acquisition system.1 An example of a simulated measured DBS is presented
in Fig. 5. The stimulation lasts between 1 and 6 s, while the
baseline artifact is visible during and after the stimulation.
Multichannel depth recordings (15 intracerebral electrodes)
were simulated in two steps: DBS and background activities.
1 Consequently, as some canals are saturated differently from others, the
mixture becomes nonlinear and it leads to difficulties for linear signal processing
methods such as BSS.

2690

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 7.
Fig. 6.
20 dB.

Real SEEG stimulation. Measurements of one multielectrode.

Example of 15 channels simulated DBS-SEEG with a noise level of

V. EXPERIMENTS AND RESULTS
A. Parameter Selection

The propagated DBS was simulated as follows: considering that
the stimulation is produced between two electrodes as a dipole,
we computed the potential recorded by the electrodes using the
dipole field equation [22].
Φ(r) ∼
=

Id cos θ
.
4πσr2

(17)

In this equation, d is the distance between source I and sink
−I (two stimulating poles), r is the distance from the dipole
center to a measurement point (electrode), θ represents the angle
between the dipole axis and the vector r to an electrode, and σ is
the conductivity of the propagation medium. Obviously, the head
is not an infinite conductor and in general 3-D spatial analysis
requires accurate knowledge of the electrical properties of head
tissues. Nevertheless, in SEEG, as the electrodes are placed
inside the brain, we consider the dipole field in an isotropic
homogeneous medium as good approximation.
Afterwards, we generated a deviation in the stimulation signal
(to produce baseline) and padded it with 5 s of zero activity
before and after stimulation. After applying all operations of
the acquisition system previously described in this section, we
obtained the multidimensional stimulation signal.
The simulated background dataset consists of N simulated
noncorrelated EEG signals created by the nonstationary EEG
model of Rankine et al. [23], adapted for SEEG by Caune
et al. [24] and mixed by some randomly generated mixing matrices AM ×N , where M is the number of simulated electrodes.
The result is added to the simulated stimulation signal and to
the zero-mean Gaussian noise to produce the simulated DBSSEEG: An example is presented in Fig. 6. The level of noise is
calculated using the mean variance of simulated SEEG sources.
B. Real Datasets
To check the validation of the methods, we used 1187 selected
stimulations from 38 patients who underwent the SEEG acquisition/stimulation procedure at Nancy Hospital, Nancy, France.
To reduce the amount of data, we used the electrodes which
belong to the stimulating multielectrode, because with them the
stimulation is measured with more energy. Fig. 7 presents the
measurements of one stimulation on a multielectrode.

The objective of the filtering process before GEVD, with
the methods described in Section III, consists in suppressing at
the same time the noise and the stimulation artifact. Therefore,
the filtering efficiency will depend on the parameter choice for
each method. From the further study of optimizing parameters
for filtering DBS of the 50-Hz DBS frequency at the sampling
rate 512 Hz, the following parameters are given: SSA: L = 10
(I being 1, as explained in Section III-A2), SGF: NSG = 5 and
L = 20 with a cutoff frequency at about 21 Hz [15], EMD: J − 2
last IMFs. Indeed, these parameters depend on the dynamics
of the stimulation and on the high-frequency components. We
complete this study with a FIR filter and a median filter in the
preprocessing step in order to also test their performances: a
classical FIR of order 40 with a 21-Hz cutoff frequency (as
for SGF), and a MED of sliding window length of six samples
(chosen to be less than one period of stimulation [∼ ten samples)
but more than the length of the stimulation impulse (∼ four
samples)] because of its intrinsic characteristics.
B. Estimation of Performance
To estimate the quality of the filtering/GEVD and BSS methods in simulated data, we used a mean signal to error ratio
defined as follows:
M
1 
10 log
Δ=
M i=1



N
N

t=1

x̄i (t)2

t=1 (x̄i (t)

− x̂i (t))2


(18)

where M is the number of measurements (electrodes), N the
number of time samples, x̄i the ideal mixed signals [see (3)] for
ith electrode, and x̂i their estimate.
To measure the performance in real data, where SEEG sources
are not known, we calculated the correlation index between the
decomposed stimulation signal and the pattern of stimulation
of 1 s. The correlation index is calculated in several steps: for
every electrode i, the normalized cross-correlation function is
given as follows:
ρi (τ ) =

E[s̄stim ,i (t)spattern (t − τ )]
σs s t i m , i σs p a t t e r n

(19)

HOFMANIS et al.: DENOISING DEPTH EEG SIGNALS DURING DBS USING FILTERING AND SUBSPACE DECOMPOSITION

Fig. 8. Decomposed sources by SSA-GEVD using a dataset with ten mixed
SEEG sources and a noise of SNR = 20 dB.

2691

Fig. 9. Decomposed sources by SSA-GEVD using a dataset with mixed 15
SEEG sources and a noise of SNR = 20 dB.

and then the correlation index is calculated as follows:
mcorr =

M
1 
max ρi (τ )
M i=1 τ

(20)

where s̄stim is the estimated stimulation, spattern the stimulation
pattern (a 1-s long pattern of stimulation, taken from a clear, lownoise measurement where no evidence of the cerebral activity
was visible), and M the number of measurements.
C. Simulated SEEG Data
In Fig. 8, we present an example of decomposed sources by
SSA-GEVD, where the first component is the baseline followed
by ten simulated brain source signals (see Section IV) and the
others components consists of multiple stimulation and noise
mixed sources (a similar figure can be provided from other
filtering/GEVD methods). Furthermore, knowing that the baseline of commutation has a high variance, it comes out as the first
component of the GEVD method and thus is easy to eliminate.
For clean signal reconstruction, we need to choose the sources
of interest among the estimated sources, regardless of the estimation procedure (GEVD or BSS based). In the GEVD case, the
choice is straightforward, as the estimated sources are already
ordered (see Figs. 8 and 9): the baseline is low frequency and
high variance, while the stimulation is high frequency. Consequently, the first source will be the baseline and the nGEVD last
sources will represent the stimulation. However, the obtained
BSS components do not have a particular order and thus some
additional detection steps should be carried out to keep or to
eliminate a component for source reconstruction. Consequently,
we have ordered them according to their mean correlation to the
original sources. Then, we suppressed the component which
corresponds to the baseline. Thus, the first sources will represent brain activity, while the nBSS last sources (having a low
correlation with the known simulated brain sources) will represent the stimulation and will be eliminated in the reconstruction.
In both cases (GEVD or BSS), this number of sources needs to
be evaluated. Several situations are possible.
1) If the number of brain sources is known and smaller than
the number of electrodes (as in Fig. 8, where we used ten

Fig. 10. Comparing the performance index for a different number of eliminated sources (n G E V D and n B S S ) and different noise levels, in the case of 15
brain sources.

simulated brain sources, one baseline, and one stimulation
source for 15 electrodes), then the reconstruction will be
done afterwards by using this a priori knowledge.
2) If the number of sources is higher (the mixture is overdetermined or noisy), then nGEVD (respectively, nBSS ) needs
to be estimated. An example of estimated sources for the
case of 15 brain sources, one baseline and one stimulation
is given in Fig. 9. In the simulation, we have evaluated the
reconstruction quality using the performance index [see
(18)] as a function of the number of eliminated sources.
The results are presented in Fig. 10 for different noise
levels (mean values over 100 simulations). To keep the
figure clear, we have only displayed the results for the best
GEVD-based algorithm (GEVD-SSA) and the best tested
BSS algorithm (FastICA). The optimal number of sources
to be eliminated varies depending on the noise level, but
in all cases the GEVD-SSA method overpasses FastICA.
According to the performance index (see Fig. 10), we fixed
nGEVD and nBSS to 2 because of the low-noise condition
like real SEEG (contrary EEG).
In Table I, a Gaussian additive noise of different levels allows to consider the robustness of the methods on a simulated

2692

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

TABLE I
COMPARISON OF FILTERING-GEVD, FASTICA, AND SOBIRO ALGORITHMS
USING SIMULATED DATA WITH DIFFERENT LEVELS OF ADDITIVE NOISE

Fig. 13. Spectrograms of the 15 mixed SEEG sources estimated by SSAGEVD “e” and FastICA “f” (data for 8th electrode). Noise level: SNR = 20 dB.
“a” data with artifacts, “b” stimulation artifact, “c” trend artifact, “d” data
without artifacts.

Fig. 11. Example of denoised monochannel signal from a synthetic dataset of
15 SEEG sources without noise. Signal+Art: simulated monochannel SEEG
signal with trend and stimulation artifacts. Signal: simulated monochannel
SEEG signal without artifacts. Following by denoised signals with the presented methods.

Fig. 14.

Decomposed sources for real SEEG stimulation using SSA-GEVD.

TABLE II
COMPARISON OF FILTERING-GEVD, FASTICA, AND SOBIRO ALGORITHMS
USING REAL DATASETS (1187 DBS MULTICHANNEL RECORDINGS)

Fig. 12. Mean performance index for each electrode at a 20-dB noise level
using the presented methods.

dataset. The results indicate that SSA-GEVD and FIR-GEVD
have similar performances and, with MED-GEVD, outperform
the other methods. These performances are more regular with
SSA-GEVD and FIR-GEVD than with MED-GEVD, which
is generally less efficient with a high SNR. In the case of 15
SEEG sources, there is a small diminution of performances
for all methods. However, the results still remain good enough
to validate the usefulness of filtering-GEVD methods in underdetermined conditions except for EMD-GEVD. The low
performances of classical BSS methods could be due to the nonlinearity introduced by the saturation of the stimulation source
on electrodes close to the stimulation. Consequently, there is no
convergence of these algorithms. Fig. 11 presents one example
of a reconstructed signal after the elimination of the stimula-

tion and baseline artifacts for each method, compared to input
(see Fig. 11: Signal+Art.) and original (see Fig. 11: Signal).
All methods correctly retrieve the original sources until 5 s with
the retained decomposed sources as explained previously. The
best extraction of artifacts is obtained with SSA-GEVD and
FIR-GEVD followed by SGF-GEVD where a slight trend of
baseline remains in signal around 6.5 s. The EMD-GEVD and
MED-GEVD keep the residue of stimulation artifact but EMDGEVD has the worst baseline extraction. BSS algorithms partly
keep the trace of baseline and reproject more of the stimulation
artifact.

HOFMANIS et al.: DENOISING DEPTH EEG SIGNALS DURING DBS USING FILTERING AND SUBSPACE DECOMPOSITION

2693

Fig. 15. Elimination of the stimulation and baseline artifacts from SEEG data with an epileptic activity during the DBS (DBS ends at 3.1 s). (a) Real SEEG
as registered with the epilepsy during the DBS. (b) Sources after SSA-GEVD decomposition. (c) Reconstructed signal eliminating the first and the last two
components.

If we examine the results of each electrode presented in
Fig. 12 at a 20-dB noise level, the sources are less recovered
at the electrodes close to the stimulation site (in our case: 10th
and 11th electrodes). The same can be deduced for other noise
levels. Obviously, it is due to the stimulation amplitude, which
is saturated in these two electrodes measurements.
Finally, if we look at the spectrogram of the 8th electrode
before and after eliminating the stimulation (see Fig. 13) with
SSA-GEVD and FastICA, none of the frequencies caused by
the stimulation or baseline is present for SSA-GEVD, while for
FastICA, a small amount of the stimulation frequency and its
harmonics remain on the spectrogram.
D. Real SEEG Analysis
The SSA-GEVD decomposed sources of a real dataset (from
Fig. 7) are presented in Fig. 14. The baseline appears in the first
decomposed source and the stimulation in the last four ones. As
mentioned in Section V-B, in real datasets, we retained only the
last components such as the stimulation source and suppressed
everything else. Indeed, this source can be used to study the
propagation in the brain and the depth-surface relationships. The
performance of the methods is calculated as indicated in (20).
However, we do not know how many components representing
the stimulation should be eliminated. So, this number must be
calculated for each dataset separately. For this, we choose a criterion based on the eigenvalues which represent the contribution
of each associated eigenvector [25] in GEVD
 12

J
λ
i
>ρ
(21)
i=1
M
i=1 λi
where Λ = {λ1 , λ2 , . . . , λM } is the set of decreasing eigenvalues and M is the number of SEEG channels. We calculate the
number of suppressed components J (J ≤ M ) for which this
criterion becomes true with J = {1, 2, . . . , M } and ρ is the
threshold value. Table II shows the performance of the methods on real data when this criterion is applied. First, we retain
M − J components where J is estimated by the criterion [see
(21)]. The threshold value ρ is empirically chosen at 0.95. Second, the number n of components is 2, corresponding to the last
two components that must be kept.

From Table II, the separation quality of the stimulation source
is very high for all filtering-GEVD methods but SSA filtering approach is slightly better. Besides, the efficiency of the filteringGEVD methods is considerably better compared to classical
BSS algorithms. The results obtained when the number of components is determined by the criterion are even slightly less good
than those with a number fixed to 2. The effect of the stimulation
cannot be contained in one decomposed source but can be fixed
to 2. Therefore, this approach can be considered to be a good
tool for neurologists to eliminate the stimulation artifact in real
SEEG recordings and retrieve the underlying sources.
Fig. 15(a) illustrates an epileptic crisis activity during the
stimulation for a patient. After decomposition with SSA-GEVD,
in Fig. 15(b), parts of the stimulation source are clearly visible
over the last two components and the baseline is present in the
first. After reconstruction, the epileptic activity is recovered with
a little stimulation noise [see Fig. 15(c)].

VI. CONCLUSION
The recording DBS has been analyzed from a spectral point
of view. The propagated stimulation signal masks the physiological signal. To retrieve the latter, we have put forward a
filtering-GEVD combination which used different a priori information deduced by the filtering step and extracted by the
optimization process of the GEVD. Five methods of monodimensional filtering have been implemented: SSA and EMD are
data-driven decomposition processes, a MED, whereas FIR or
SGF are fixed spectral filters. The point of this method is that it
processes the multidimensional signals without any biophysical
model. The results obtained by the mean performance index
on simulated SEEG data prove the pertinence of the filteringGEVD approach. As a result, we validate the efficiency of the
filtering-GEVD method based on a 38-patient SEEG database,
where it shows a nonarguable better performance than the classical BSS methods. In a low-noise condition, a realistic condition
for SEEG data, results are significantly improved for simulated
and real datasets. The associated process SSA-GEVD provides
the best performance on real data. Additionally, in the underdetermined case, when brain sources are more numerous than
electrodes, filtering-GEVD methods are still able to filter off the

2694

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

stimulation source. In the physiological signal processing and
particularly in the DBS procedure, the modeling is complex because we must take into account lots of variables: the interface
between electrode and matter, the physical properties of different matters, and the position; thus, the separation of the stimulation source can be intricate. From the neurologist’s point of view,
this study is of real interest: it permits the analysis of underlying
signals, i.e., the physiological process generated by the stimulation. In future works, besides comparing our method with other
techniques adapted from neighboring applications (see [26] for
a MEG denoising application by spatiotemporal signal space
separation), further improvements can be made by combining
various a priori information with an optimization process.
REFERENCES
[1] M. Gavaret, A. Trébuchon, F. Bartolomei, P. Marquis, A. McGonigal,
F. Wendling, J. Regis, J.-M. Badier, and P. Chauvel, “Source localization
of scalp-EEG interictal spikes in posterior cortex epilepsies investigated
by HR-EEG and SEEG,” Epilepsia, vol. 50, no. 2, pp. 276–289, 2009.
[2] L. Koessler, C. Benar, L. Maillard, J.-M. Badier, J. P. Vignal,
F. Bartolomei, P. Chauvel, and M. Gavaret, “Source localization of ictal epileptic activity investigated by high resolution EEG and validated by
SEEG,” Neuroimage, vol. 51, no. 2, pp. 642–653, 2010.
[3] J. Parra, S. N. Kalitzin, J. Iriarte, W. Blanes, D. N. Velis, and F. H. Lopes da
Silva, “Gamma-band phase clustering and photosensitivity: Is there an
underlying mechanism common to photosensitive epilepsy and visual
perception?,” Brain, vol. 126, no. 5, pp. 1164–1172, 2003.
[4] C. C. McIntyre, M. Savasta, L. K.-L. Goff, and J. L. Vitek, “Uncovering
the mechanism(s) of action of deep brain stimulation: Activation, inhibition, or both,” Clin. Neurophysiol., vol. 115, no. 6, pp. 1239–1248, 2004.
[5] K. Friston, “Learning and inference in the brain,” Neural Netw. Official J.
Int. Neural Netw. Soc., vol. 16, no. 9, pp. 1325–1352, 2003.
[6] M. Breakspear, “User research multi-stability and non-linearity of largescale cortical rhythms,” Brain, vol. 38, pp. 2–5, Mar. 2011.
[7] A. Hyvärinen and E. Oja, “A fast fixed-point algorithm for independent
component analysis,” Neural Comput., vol. 9, no. 7, pp. 1483–1492, 1997.
[8] A. Belouchrani and A. Cichocki, “Robust whitening procedure in blind
source separation context,” Electron. Lett., vol. 36, no. 24, pp. 2050–2053,
2000.
[9] K. H. Hild and N. Srikantan, “Source localization of EEG/MEG data by
correlating columns of ICA and lead field matrices,” IEEE Trans. Biomed.
Eng., vol. 56, no. 11, pp. 2619–2626, Nov. 2009.
[10] R. Sameni, C. Jutten, and M. Shamsollahi, “A deflation procedure for
subspace decomposition,” IEEE Trans. Signal Process., vol. 58, no. 4,
pp. 2363–2374, Apr. 2010.
[11] C. Gouy-Pailler, R. Sameni, M. Congedo, and C. Jutten, “Iterative subspace decomposition for ocular artifact removal from EEG recordings,” in
Independent Component Analysis and Signal Separation (Lecture Notes
in Computer Science vol. 5441). Berlin, Germany: Springer-Verlag, 2009,
pp. 419–426.
[12] L. Parra and P. Sajda, “Blind source separation via generalized eigenvalue
decomposition,” J. Mach. Learn. Res., vol. 4, pp. 1261–1269, 2003.
[13] L. Amini, R. Sameni, C. Jutten, H. Soltanian-Zadeh, G. Hossein-Zadeh
et al., “MR artifact reduction in the simultaneous acquisition of EEG and
fMRI of epileptic patients,” in Proc. 16th Eur. Signal Process. Conf., 2008.
[14] A. Tomé, “Separation of a mixture of signals using linear filtering and
second order statistics,” in Proc. Eur. Symp. Artif. Neural Netw., Bruges,
Belgium, Apr. 2002, pp. 307–312.
[15] R. Schafer, “What is a Savitzky–Golay filter?,” IEEE Signal Process.
Mag., vol. 28, no. 4, pp. 111–117, Jul. 2011.
[16] N. Golyandina, V. Nekrutkin, and A. Zhigljavsky, Analysis of Time Series
Structure: SSA and Related Techniques. London, U.K.: Chapman &
Hall, 2001.
[17] N. Huang, Z. Shen, S. Long, M. Wu, H. Shih, Q. Zheng, N. Yen, C. Tung,
and H. Liu, “The empirical mode decomposition and the Hilbert spectrum
for nonlinear and non-stationary time series analysis,” Proc. Roy. Soc.
London Series Mathemat. Phys. Eng. Sci., vol. 454, no. 1971, pp. 903–
995, 1998.
[18] S. Hargittai, “Savitzky–Golay least-squares polynomial filters in ECG
signal processing,” in Proc. Comput. Cardiol., Sep. 2005, pp. 763–766.

[19] J. Elsner and A. Tsonis, Singular Spectrum Analysis: A New Tool in Time
Series Analysis. New York, NY, USA: Springer-verlag, 1996.
[20] J. Hofmanis, R. Ruiz, O. Caspary, R. Ranta, and V. Louis-Dorr, “Extraction
of Deep Brain Stimulation (DBS) source in SEEG using EMD and ICA,”
in Proc. IEEE Eng. Med. Biol. Soc., Sep. 2011, pp. 834–837.
[21] A. Cichocki and S. Amari, Adaptive Blind Signal and Image Processing:
Learning Algorithms and Applications. New York, NY, USA: Wiley,
2002.
[22] P. Nunez and R. Srinivasan, Electric Fields of the Brain: The Neurophysics
of EEG. New York, NY, USA: Oxford Univ. Press, 2006.
[23] L. Rankine, N. Stevenson, M. Mesbah, and B. Boashash, “A nonstationary
model of newborn EEG,” IEEE Trans. Biomed. Eng., vol. 54, no. 1, pp. 19–
28, Jan. 2007.
[24] V. Caune, J. Zagars, and R. Ranta, “EEG/SEEG signal modelling using
frequency and fractal analysis,” in Proc. BIOSIGNALS, 2012, pp. 249–
253.
[25] K. Konstantinides and K. Yao, “Statistical analysis of effective singular
values in matrix rank determination,” IEEE Trans. Acoust. Speech Signal
Process., vol. 36, no. 5, pp. 757–763, May 1988.
[26] S. Taulu and J. Simola, “Spatiotemporal signal space separation method for rejecting nearby interference in meg measurements,” Phys. Med. Biol., vol. 51, pp. 1759–1768, 2006. Available:
http://www.ncbi.nlm.nih.gov/pubmed/16552102.

Janis Hofmanis was born in Riga, Latvia. He received the M.Sc. degree in computer science from the
University College of Ventspils, Ventspils, Latvia, in
June 2007. Since October 2009, he has been working
toward the Ph.D. degree at the Research Center for
Automatic Control (CRAN/CNRS), Lorraine University, Nancy, France.
His research interests include analyzing methods
of SEEG data processing, DBS usage in applications
of estimation of head tissue conductivities, and localization of an epileptic source using several head
models.

Olivier Caspary was born in Nantes, France. He
received the B.Sc., M.Sc., and Ph.D. degrees in electrical engineering from Nancy 1 University, Nancy,
France, in 1988, 1991, and 1995, respectively.
Since 1995, he has been an Assistant Professor with the Research Center for Automatic Control
(CRAN/CNRS), Lorraine University, Nancy, France.
His current research interests include biomedical signal processing and source separation.

Valérie Louis-Dorr received the B.Sc. and M.Sc. degrees in electrical engineering from the University of
Lorraine, France, in 1987 and 1989, respectively and
the Ph.D. degree from the Institut National Polytechnique de Lorraine (INPL), Nancy, France, in 1993.
She is currently a Professor with the Research Center for Automatic Control (CRAN/CNRS), Lorraine
University, Nancy, France. Since 1996 her research
interests include signal processing and the analysis
of physiological signals. Since 2000, her research
has been focused on EEG processing in an epileptic
context. Her research interests include denoising, preprocessing and source separation, and connectivity model.

HOFMANIS et al.: DENOISING DEPTH EEG SIGNALS DURING DBS USING FILTERING AND SUBSPACE DECOMPOSITION

Radu Ranta (M’01) received the Ph.D. degree in
biomedical signal processing in 2003 from Lorraine
University, Nancy, France.
He is currently an Assistant Professor with the Research Center for Automatic Control (CRAN/CNRS),
Lorraine University. His research interests include
one-dimensional and multidimensional signal denoising (wavelets, spatial filtering, source separation), mostly applied to EEG signal processing.

2695

Louis Maillard recieved the first Ph.D degree in neurology from Henri Poincaré University in 2000 and
the second Ph.D degree in neuroscience form the University of the Mediterranean, France, in 2009.
He is currently a Professor of neurology with
the Faculty of Medicine, Lorraine University, Nancy,
France and with the University Hospital of Nancy,
Nancy, and a Researcher with the Research Center
for Automatic Control (CRAN), UMR 7039 CNRS,
Lorraine University. His research interests include the
characterization of epileptic networks and the understanding of the physiological mechanisms involved in visual recognition and it
takes place in the context of presurgical investigations of drug refractory epileptic seizures using SEEG recordings and Electrical Source Imaging.

