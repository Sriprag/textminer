1894

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

Risk Scoring for Prediction of Acute Cardiac
Complications from Imbalanced Clinical Data
Nan Liu, Zhi Xiong Koh, Eric Chern-Pin Chua, Licia Mei-Ling Tan, Zhiping Lin, Senior Member, IEEE,
Bilal Mirza, and Marcus Eng Hock Ong

Abstract—Fast and accurate risk stratification is essential in
the emergency department (ED) as it allows clinicians to identify
chest pain patients who are at high risk of cardiac complications
and require intensive monitoring and early intervention. In this
paper, we present a novel intelligent scoring system using heart rate
variability, 12-lead electrocardiogram (ECG), and vital signs where
a hybrid sampling-based ensemble learning strategy is proposed
to handle data imbalance. The experiments were conducted on
a dataset consisting of 564 chest pain patients recruited at the
ED of a tertiary hospital. The proposed ensemble-based scoring
system was compared with established scoring methods such as the
modified early warning score and the thrombolysis in myocardial
infarction score, and showed its effectiveness in predicting acute
cardiac complications within 72 h in terms of the receiver operation
characteristic analysis.
Index Terms—Electrocardiography, ensemble learning, heart
rate variability (HRV), risk stratification, scoring system.

I. INTRODUCTION
ATIENTS visiting the emergency department (ED) have
varying levels of risk of cardiac complications in the acute
phase of treatment (<72 h). Therefore, early risk stratification
would be able to help determine suitable treatment strategies and
the proper level of monitoring. The ability to identify high-risk
patients allows timely intervention for preventable and treatable complications. Meanwhile low-risk patients can be managed without excessive intervention and the strain on limited
resources may be reduced. A fast, accurate, and objective triage
tool that is able to risk stratify patients with suspected acute
coronary syndromes (ACS) is of value in the ED [1]. Such a
tool not only helps guide cost-effective patient management and
reduce the number of adverse cardiac events, but also has a
potential in improving the computer-aided workflow for emer-

P

Manuscript received October 6, 2013; revised December 15, 2013; accepted
January 17, 2014. Date of publication January 29, 2014; date of current version
November 3, 2014.
N. Liu, Z. X. Koh, and M. E. H. Ong are with the Department of Emergency
Medicine, Singapore General Hospital, Singapore 169608 (e-mail: liu.nan@
sgh.com.sg; koh.zhi.xiong@sgh.com.sg; marcus.ong.e.h@sgh.com.sg).
E. C.-P. Chua is with the Program in Neuroscience and Behavioral Disorders, Duke-NUS Graduate Medical School, Singapore 169857 (e-mail:
chernpin@gmail.com).
L. M.-L. Tan is with MOH Holdings, Singapore 099253 (e-mail: licia.
tan@mohh.com.sg).
Z. Lin and B. Mirza are with the School of Electrical and Electronic
Engineering, Nanyang Technological University, Singapore 639798 (e-mail:
ezplin@ntu.edu.sg; bilal2@e.ntu.edu.sg).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2303481

gency healthcare [2]. Numerous studies on risk stratification
have focused on categorizing adverse outcomes of patients into
low-, intermediate-, and high-risk groups so that efficient patient care can be delivered [3]. Risk scores derived from scoring
systems have been widely used to predict clinical outcomes and
assess the severity of illness [4]. An accurate outcome prediction
allows patients in acute conditions to be considered for proper
treatment as early as possible. Scoring systems are usually deployed in the ED or in the intensive care unit (ICU), where
rapid and accurate decision making is essential [3]. Many scoring and risk stratification systems have been developed, including the thrombolysis in myocardial infarction (TIMI) score [5],
the modified early warning score (MEWS) [6], acute physiology and chronic health evaluation score [7], simplified acute
physiology score [8], and mortality probability model [9].
Predictors in the scoring systems cover a wide range of variables, such as a patients cardiac risk factors, heart rate variability (HRV) parameters, clinical characteristics, biomarkers, and
electrocardiogram (ECG). These predictors are usually selected
into risk models based on their statistical significance. However,
statistically insignificant predictors do not necessarily have poor
discriminatory power in clinical outcome prediction, especially
when machine learning techniques are involved in the decisionmaking process. Nevertheless, a smaller number of predictors
are usually the best choice for scoring systems as redundant
variables give minor contributions to the prediction and require
extra efforts for data manipulation. The development of scoring systems heavily relies on appropriate selection of variables
with which outcomes are associated, but traditional clinical tools
have some limitations. For example, patient clinical history has
not been shown to correlate well with short-term outcomes [10].
Furthermore, the 12-lead ECG parameters have poor sensitivity
for ACS (28–55%) [11] and cardiac biomarkers may take up to
12 h to reach detectable levels [12] after an acute myocardial infarction. Some limitations of current risk stratification systems
for the prediction of cardiovascular complications have been
discussed in [4] and [13].
We have previously developed a risk assessment tool (a
Euclidean distance-based scoring system called DIST) using
HRV combined with vital signs and showed its utility for identifying high-risk patients visiting the ED [14]–[16]. However,
there has not been any study on the correlation of a combination of HRV, 12-lead ECG, and vital signs with adverse cardiac
events. Moreover, most scoring systems are not readily adaptable to new input features [17] and machine learning-based
scoring systems may encounter issues like data imbalance where
high-risk patients make up a small proportion of the study cohort

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

LIU et al.: RISK SCORING FOR PREDICTION OF ACUTE CARDIAC COMPLICATIONS FROM IMBALANCED CLINICAL DATA

[14], [18]. In this study, we aim at proposing an intelligent
scoring system to address the aforementioned difficulties, and
exploring the utility of combining HRV and 12-lead ECG parameters, and vital signs to predict acute cardiac complications
within 72 h. The proposed scoring system takes advantage of
a novel machine learning structure, with which accurate scores
and reliable decisions can be expected. The novel intelligent
scoring algorithm and the combined use of HRV and 12-lead
ECG parameters make this study unique and significant, which
may serve as an innovative tool in future healthcare settings.

1895

TABLE I
LIST OF 16 TIME AND FREQUENCY DOMAIN HRV PARAMETERS

II. METHODS
A. Study Design and Patient Recruitment
We conducted an observational cohort study of 702 chest pain
patients recruited from March 2010 to April 2012 at the Department of Emergency Medicine, Singapore General Hospital,
which is the main acute tertiary hospital in Singapore, serving
135 000 patients annually. Ethics approval with a waiver of patient consent was obtained from the Institutional Review Board.
All public hospitals in Singapore use a national Patient Acuity
Category Scale (PACS) for triage at the ED. We included PACS 1
patients and some PACS 2 patients in the study where PACS 1
patients were the most critically ill and required resuscitation,
while PACS 2 patients were not in danger of imminent collapse
but were considered critical. The recruited patients were adult
men and women at least 30 years of age. Patients in nonsinus
rhythm (for example, asystole, supraventricular and ventricular
arrhythmias, and complete heart block) and patients who were
discharged against medical advice or transferred to another hospital within 72 h of arrival at the ED were excluded. An eligible
patient who arrived at the ED was screened and recruited by
trained medical personnel. The primary outcome was a composite of four severe complications within 72 h of arrival at
the ED. These severe complications included mortality, cardiac
arrest, sustained ventricular tachycardia (VT), and hypotension
requiring inotropes or intraaortic balloon pump insertion.
B. Data Acquisition and Processing
ECG tracings were monitored by a computer-based software
with an ECG sensor (Vernier Software & Technology, Portland,
OR, USA) and a data acquisition device NI USB-6215 (National Instruments, Austin, Texas, USA) over a period of 5 min.
ECG signals were sampled at a rate of 125 Hz and the processing of raw data to obtain the HRV parameters was done using the LABVIEW (Version 8.6, National Instruments, Austin,
TX, USA) interface embedded with MATLAB (R2009a, The
MathWorks, Natick, MA, USA) scripts. A detailed description
of data acquisition and signal processing can be found in our
previous works [15], [19], in which a threshold-plus-derivative
method was used to detect the QRS complexes, and all ectopic and nonsinus beats were excluded in accordance with the
guidelines outlined by the Task Force of the European Society
of Cardiology and the North American Society of Pacing and
Electrophysiology [20]. In this study, a total of 16 time domain

and frequency domain HRV parameters were derived, which are
elaborated in Table I.
The 12-lead ECG was also measured at the ED with
PageWriter TC Series Cardiograph (Philips, Amsterdam,
Netherlands) and parameters were either automatically derived
by the device or manually calculated by a doctor. A total of
twelve 12-lead ECG parameters were selected, which included
ST elevation, ST depression, T wave inversion, Q wave, QT
interval correction (QTc), QRS axis, left-bundle branch block,
right-bundle branch block, intraventricular conduction delay,
left-atrial abnormality, left-ventricular hypertrophy, and rightventricular hypertrophy.
Vital signs such as heart rate, systolic, and diastolic blood
pressure were measured using the Propaq CS (Welch Allyn,
Skaneateles Falls, New York, NY, USA) Vital Signs Monitor
at presentation to the ED. Respiratory rate and Glasgow coma
scale were recorded at the time of vital sign measurement. Tympanic temperatures of the patients were taken using a tympanic
thermometer. Other vital signs included pain score and oxygen
saturation (SpO2 ). A total of eight vital signs were recorded for
this study.
In summary, 36 predictive variables were measured, consisting of 16 HRV parameters, 12 ECG parameters, and 8 vital
signs, for the derivation and validation of the proposed scoring
system. While patients were still in the ED, we also recorded
medical history, drug history, smoking history, family history of
ischemic heart disease, and number of angina events in the past
24 h. These, along with the present ECG and initial Troponin
T serum levels were used to calculate the TIMI risk score [5].
Moreover, AVPU scores (A for alert, V for reacting to vocal
stimuli, P for reacting to pain, U for unconscious) were recorded
according to the best response during data collection at triage.
The collected data were used to calculate a MEWS score [6] for
each recruited patient.

1896

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

C. Proposed Ensemble-Based Scoring System (ESS)
With the advancement of computational techniques, machine
learning methods have been found useful for scoring systems to
improve predictive performance, handle imbalanced data, and
enhance system adaptability. In this paper, we aim to propose
an intelligent scoring system and explore its ability to predict
acute cardiac complications within 72 h for chest pain patients
presented to the ED. The scoring system takes advantage of a
novel machine learning structure, with which reliable decisions
can be achieved.
By looking into the data collected from the ED, we find that
the database is highly imbalanced in terms of outcome distribution. That is, there exists a majority class with normal outcome
and a minority class with abnormal outcome (acute cardiac
complications within 72 h). When applying conventional machine learning algorithms on such an imbalanced dataset, the
majority class will dominate the learning process and subsequently results in poor generalization performance on unknown
testing samples. Typical solutions to handle imbalanced data
include undersampling majority classes and oversampling minority classes [21]. However, when the prevalence rate is fairly
low (e.g., <4% in our database), neither the state-of-the-art
classification techniques nor conventional imbalance handling
strategies are able to give satisfactory prediction results. In order
to provide reliable prognosis with HRV, 12-lead ECG, and vital
signs, discovering novel learning frameworks tailored specifically for the imbalanced data is extremely important and will
serve as a key factor in controlling system performance.
A number of innovative solutions to the class-imbalance problem have been proposed at both data and algorithm levels [21].
At the data level, these solutions include several forms of resampling. At the algorithm level, solutions include adjusting
the costs of various classes to counter the class imbalance. We
have previously proposed a geometric distance-based scoring
system [14], where a simple undersampling method was employed. In this paper, we propose a novel ESS for risk stratification and prediction of acute cardiac complications, in which the
core technique handling class imbalance is built upon a unique
hybrid-sampling strategy.
Given a dataset X = [x1 , x2 , . . . , xK ] where each x represents a patient, the min–max normalization [22] is applied
to transform the original inputs into the interval of [−1, 1].
Let minA and maxA denote the minimum and maximum
values of an attribute vector A = [x1 (m), . . . , xK (m)] for
m = 1, 2, . . . , M , where M is the total number of HRV parameters, 12-lead ECG parameters, and vital signs, and K is
the total number of patients in the dataset. Min–max normalization maps a value v of A to v  in the range [minA , maxA ] by
computing
v =

v − minA
(maxA − minA ) + minA
maxA − minA

(1)

The normalization process is able to preserve the relationships
among the original data and to improve learning efficiency.
1) Ensemble Learning-Based Score Prediction: In most scenarios especially medical settings, we often seek a second or

Fig. 1.

Framework of the ensemble learning-based score prediction.

more opinion before making final decisions. By consulting several experts with various backgrounds, we can weigh their suggestions or pick up the most informative one. For example, the
suggestion by a senior clinician could be given a higher weight
than that of a junior clinician. For critically ill cases, final decisions may be given by a committee of experts through discussion
and voting. Given the real-world needs, many computational
intelligence methods have been investigated and validated to
simulate the process of decision making from multiple experts.
These have various names such as ensemble learning systems,
mixture of experts, and multiple classifier systems. The philosophy behind these techniques is to discover an optimal way to
combine the suggestions of individual experts so as to achieve
a reliable final decision. Fig. 1 illustrates the general structure
of an ensemble learning-based system where each individual
expert is also called a classifier. Each ensemble classifier ϕt
(t = 1, 2, . . . , T where T is the number of individual classifiers
in the decision ensemble) will be given a weight o represent the
importance of that classifier. In the proposed ESS algorithm, the
weight wt is determined by the contribution to the prediction of
its corresponding classifier ϕt and is derived from the training
process. Ensemble learning methods [21], [23] usually generate
a predictive label rather than a score as the output. However,
in healthcare applications a risk score is more informative than
a class label to clinicians for making decisions. Details of the
proposed ESS algorithm are elaborated as follows.
Assume that we have a training dataset L consisting of K
samples (xk , yk ), where k = 1, 2, . . . , K and yk is the class label. Given a testing sample x, its label y can be predicted by
a single classifier ϕ(x, L) where the class label is either C0 or
C1 . Label C0 indicates that the patient is normal (negative outcome), while label C1 indicates that the patient has acute cardiac
complications within 72 h (positive outcome). As illustrated in
Fig. 1, we can derive T independent classifiers and their corresponding weights from training samples. The risk score on the
testing sample x is calculated as



ϕt (x, L) · wt × 100
RSx = 
y ∈C 1

y ∈C 1

ϕt (x, L) · wt +



(1 − ϕt (x, L)) · wt

(2)

y ∈C 0

The output of a classifier ϕt (x, L) is either 0 or 1 and its corresponding predicted label y is C0 or C1 , respectively. The risk

LIU et al.: RISK SCORING FOR PREDICTION OF ACUTE CARDIAC COMPLICATIONS FROM IMBALANCED CLINICAL DATA

1897

Fig. 2. Framework of the ensemble learning-based score prediction, where a
hybrid-sampling approach handles the learning from imbalanced data.

score is based on the measurements of weighted positive prediction and weighted negative prediction. The weighted positive
prediction is defined as the sum of weights whose corresponding classifiers predict label C1 , while the weighted negative
prediction is defined as the sum of weights whose corresponding classifiers predict label C0 on the testing sample x. The
idea is straightforward and is an attempt to simulate the process
of real-world decision making. Since we are dealing with binary class problem in this study, the presentation of risk score
calculation can be simplified as.
T
ϕt (x, L) · wt
× 100
(3)
RSx = t=1T
t=1 wt
Next, it is important to determine an approach to select suitable individual classifiers for decision ensemble creation and a
proper way for decision combination. Addressing the previous
questions is difficult for many medical applications where the
collected datasets are usually imbalanced, i.e., positive samples
are much less than negative samples. Learning from imbalanced
data has been well studied in a machine learning community and
many methods have been proposed and evaluated [21]. In the
next section, we will elaborate a novel hybrid-sampling approach to enhance the ESS algorithm to handle imbalanced data
within the proposed structure of score prediction.
2) Learning From Imbalanced Data With a Novel HybridSampling Approach: With the framework presented in Fig. 1,
we propose a hybrid-sampling approach to extend ESS to manipulate the imbalanced data. The hybrid-sampling-based scoring system is illustrated in Fig. 2, and its detailed algorithm is
presented in Fig. 3. Given the minority set P and the majority
set N , the undersampling method randomly samples a subset
Nt from N , where |Nt | < |N | and |Nt | = |P |. In this study, P
represents a set of samples with positive outcomes and N represents a set of samples with negative outcomes. The balanced
dataset St consists of both P and Nt and is used for classification model derivation, whereas its corresponding synthetic
dataset St is adopted for model validation. The risk score cal-

Fig. 3. The proposed ESS algorithm for risk scoring where a hybrid-sampling
approach is implemented to handle data imbalance. The synthetic datasets are
generated with the synthetic minority over-sampling technique (SMOTE).

culation is straightforward. We randomly sample T subsets and
train T independent classifiers to create the decision ensemble.
Different from most ensemble learning methods that combine
the outputs of all classifiers into one composite prediction [24],
we calculate the number of positive predictions as well as the
number of negative predictions and use (2) to estimate a risk
score. As part of the scoring system, linear support vector machine (SVM) [25] is chosen as the individual classifier because
of its reliable performance and efficiency.
In the proposed ESS algorithm, random undersampling is
used for subset selection in the majority class, while oversampling is used for evaluating the chosen classifiers. As mentioned
in [26], the selection process with an undersampling approach
is an unsupervised strategy to explore the majority class, i.e.,
we are not able to determine the performance of each individual classifier even though some of them may contribute less to
the decision ensemble. Therefore, the oversampling technique is
adopted into the selection process through a supervised learning
strategy such that a robust decision ensemble with discriminatory classifiers can be built. Unlike some methods [26], [27]
where oversampled data are used to enlarge the training set, we
use the oversampling technique to generate synthetic data for
individual classifiers to derive weights that represent their corresponding contributions in the decision ensemble. The novelty
of the ESS algorithm is its innovative approach for classifier
selection, which is a supervised process that takes the performance of an individual classifier into account. The synthetic
minority over-sampling technique (SMOTE) [27] is employed

1898

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

TABLE III
BASELINE CHARACTERISTICS OF STUDY PATIENTS WHERE DATA ARE SHOWN
AS NUMBERS (%) UNLESS OTHERWISE STATED

TABLE II
PERFORMANCE INDICATORS IN ROC ANALYSIS

to build synthetic datasets. To create a synthetic sample from
xi ∈ St , we randomly select one of its nearest neighbors x̂i and
formulate the synthetic sample as
xi = xi + (x̂i − xi ) × δ

(4)

where δ ∈ [0, 1] is a random number so that the synthetic sample
x is a point along the line segment joining xi and x̂i .
As mentioned previously, we seek an alternative way of using
oversampled data, for classifier validation instead of classifier
training. In the ESS algorithm, a classifier is trained with St and
validated with St , and the validation accuracy Acct is recorded
to indicate the importance of the classifier. Higher Acct value
means more contribution that individual classifier ϕt could give
to the decision ensemble. We build SVM-based ensemble classifier ϕt (x, St ) as follows:



ϕt (x, St ) = sgn
αi yi x, xi  + b
(5)
x i ∈S t

where the linear kernel function is adopted due to its simplicity
and efficiency. Those training samples for which αi > 0 are
called “support vectors,” and lie closest to the decision boundary.
Having the outputs of individual classifiers in the ensemble,
derivation of the risk score RSx elaborated in the previous
section can be conducted on the testing sample. Note that the
output of the SVM classifier is ±1, while ESS algorithm requires
the output as either 0 or 1, we need to convert negative SVM
output into 0 prior to risk score calculation.
D. Performance Measures
We evaluated scoring systems with the leave-one-out crossvalidation (LOOCV) framework. Given a dataset of K samples,
one sample is selected to validate a scoring model trained with
the rest of K − 1 samples. To complete the LOOCV-based validation, all K samples have to be tested individually through K
iterations. Having derived the risk scores for all samples in the
dataset, the receiver operation characteristic (ROC) analysis is
conducted, with which the area under the curve (AUC), sensitivity, specificity, positive predictive value (PPV), and negative
predictive value (NPV) can be derived for performance evaluation. Calculation of these performance indicators is presented
in Table II, which is based on four parameters elaborated as
follows. True positive (TP) indicates patients with acute cardiac complications within 72 h correctly predicted as acute cardiac complications within 72 h; false positive (FP) indicates
healthy patients incorrectly predicted as cardiac arrest within
72 h; true negative (TN) indicates healthy patients correctly
predicted as healthy; and false negative (FN) indicates patients

with acute cardiac complications within 72 h incorrectly predicted as healthy.
III. RESULTS
A. Baseline Characteristics
A total of 702 patients were included in the study, out of
which 138 patients were excluded due to unavailable 12-lead
ECG recordings; 19 out of the remaining 564 patients met the
primary outcome. The baseline characteristics of the recruited
564 patients are shown in Table III. The mean age of patients
without complications and with complications was 60.3 and
61.1, respectively. Male patients were more than 60% of the entire cohort. In terms of race group, Chinese, Malay, and Indian
were the top three races in this study. Furthermore, by comparing patients with complications with those without complications within 72 h, we observed that patients with prior history
of diabetes (36.8% versus 34.7%), stroke (15.8% versus 7.7%),
cancer (5.3% versus 4.0%), chronic renal failure (31.6% versus
10.6%), congestive heart failure (10.5% versus 5.7%), and myocardial infarction (15.8% versus 12.5%) were more likely to
suffer from acute cardiac complications.
B. Performance of Scoring Systems
Fig. 4 illustrates a comparison of the prediction of acute cardiac complications within 72 h between four different scoring systems, namely ESS, DIST, MEWS, and TIMI. The proposed ESS algorithm using 12-lead ECG, HRV, and vital signs
achieved an AUC of 0.837, which was superior to DIST (AUC
of 0.720), TIMI (AUC of 0.621), and MEWS (AUC of 0.672).
For a clinical prediction model, it is generally considered that
an AUC of less than 0.6 has no clinical value, limited value
at 0.6 to 0.7, modest value at 0.7 to 0.8, and an AUC of

LIU et al.: RISK SCORING FOR PREDICTION OF ACUTE CARDIAC COMPLICATIONS FROM IMBALANCED CLINICAL DATA

Fig. 4.

ROC curves generated with ESS, DIST, MEWS, and TIMI.

greater than 0.8 has discrimination adequate for genuine clinical
utility [28]. Table IV presents the detailed performance in terms
of optimal ROC cutoff points. The ranges of scores for ESS and
DIST are 0–100, whereas the ranges of scores for both TIMI
and MEWS are 0–6 in this study. From the results, we also observed small PPV values and large NPV values, which was a
result of imbalanced data where patients without complications
belonged to the majority class. As seen from the Table IV that
with the optimal cutoff score, ESS was able to accurately indicate 78.9% of patients with acute cardiac complications within
72 h and to filter out 76.5% of patients not meeting the primary
outcomes. Furthermore, the DIST method was found to achieve
good specificity and PPV at the optimal cutoff score, but its
corresponding sensitivity (63.2%) was far from satisfactory. To
have a more intuitive comparison among different systems, the
cutoff score of DIST was tuned to achieve the sensitivity of
78.9%, which was the same as those of ESS and TIMI (note
that MEWS method was not able to meet the same sensitivity
through parameter tuning). By doing this, at the cutoff score of
43.9, DIST achieved the specificity of 35.4% (95% CI: 31.4%
to 39.4%), PPV of 4.1% (95% CI: 2.1% to 6.1%), and NPV of
98.0% (95% CI: 96.0% to 99.9%).
A further investigation on the prediction performance is
shown in Fig. 5 where the distributions of the predicted risk
scores are depicted by outcome categories, i.e., with or without
acute cardiac complications within 72 h. The dark gray charts
indicate the score distributions for patients with complications
in terms of percentage of total patients in the same outcome
category, and the light gray charts indicate the score distributions for patients without complications. The percentage reflects
the number of patients of its own outcome category which fall
into a specific range of scores. For example in Fig. 5(a), 53%
of patients with complications received risk scores between 80
and 100, whereas 9% of patients without complications received
risk scores in the same range.

1899

Fig. 5(a), (b), (c), and (d) illustrate the score distributions
obtained by ESS, DIST, MEWS, and TIMI, respectively. Apparently, ESS successfully assigned high scores to patients with
complications and low scores to patients without complications,
showing good discriminatory power in distinguishing patients
with different outcomes through risk stratification. Meanwhile,
16% of patients with complications fell in the score range of
[0, 20], suggesting that ESS needs to be further enhanced for
well handling some positive samples. In general, a good scoring
method should be able to assign low scores to patients without
complications and high scores to patients with complications.
To some extent, the DIST method was still good but it aggregated the risk scores of patients with no complications in the
range of (40, 60], making it difficult to achieve high specificity
while maintaining good sensitivity. Previous results have proved
that the sensitivity of 78.9% came with the specificity of 35.4%
when the cutoff score of 43.9 was applied to DIST. The performance of MEWS was less convincing as it predicted very
low risk scores for 58% of patients with complications. The
TIMI method generally failed to risk stratify patients with different outcomes, which was reflected in the ROC analysis that its
AUC of 0.621 was slightly better than 0.5, the AUC of random
guessing.
The comparison of prediction performance by different types
of predictors are presented in Table IV. Four combinations of
predictors were investigated, namely {ECG, HRV, VS}, {ECG,
HRV}, {ECG, VS}, and {HRV, VS} where ECG, HRV, and
VS represent 12-lead ECG parameters, HRV parameters, and
vital signs, respectively. According to the AUC values, {ECG,
HRV, VS} outperformed a combination of any two of these three
predictors. It is noted that {ECG, HRV} and {ECG, VS} had
similar performance. Predictor {HRV, VS} received the lowest
prediction values compared with predictors that included ECG,
suggesting that the 12-lead ECG is a significant predictor in
assessing acute cardiac complications.

C. Effects of Parameter Setting
Algorithmic parameters not only control the performance but
also determine the efficiency. Therefore, selection of parameters
plays a crucial role in algorithm design and validation. There
are two important parameters in the ESS algorithm, namely T ,
the number of ensemble classifiers, and S, a ratio determining
the number of synthetic SMOTE samples. These factors have
impacts on both the prediction performance and the training
time. Given that the nature of score prediction is risk stratification in emergency situations, a tradeoff between performance
and efficiency is ultimately what we are looking for. Table V
presents the effects of parameter setting where T and S were
individually evaluated. It is observed that {T = 70, S = 0.3}
is the best combination in achieving the highest AUC while
maintaining moderate training time. All other experiments in
this study were conducted based on this “optimal” parameter
set. However, given a new study with totally different clinical
data, it is suggested to fine-tune these two parameters to get the
most satisfactory performance.

1900

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

TABLE IV
PREDICTION RESULTS WITH FOUR DIFFERENT SCORING METHODS AND THE IMPACTS OF VARIABLE SELECTION IN ESS-BASED RISK PREDICTION

TABLE V
PREDICTION RESULTS WITH ESS WHERE THE IMPACTS OF PARAMETERS T
AND S WERE INDIVIDUALLY EVALUATED

Fig. 5. Risk score distributions according to outcomes obtained with four
different scoring methods, namely ESS, DIST, MEWS, and TIMI. The optimal
cutoff scores for ESS, DIST, MEWS, and TIMI were 42.3, 51.8, 1, and 1,
respectively. Based on these cutoff scores and the results in Table IV, ESS
achieved the lowest misclassification rate (21.1%) on positive sample prediction,
compared with DIST (36.8%), MEWS (57.9%), and TIMI (21.1%).

IV. DISCUSSION
In this observational cohort study of ED patients with chest
pain, the 12-lead ECG combined with HRV and vital signs were
found to strongly associate with acute cardiac complications
within 72 h. A novel scoring method ESS has been proposed
to integrate multiple sources of predictors for risk stratification,
which showed superior performance compared with several ex-

isting methods such as TIMI [5], MEWS [6], and an intelligent
scoring method DIST [14]. As illustrated in Fig. 5, ESS was the
best performer in accurately identifying both high risk patients
and low risk patients. The ROC analysis further confirmed the
effectiveness of ESS in risk prediction.
A wide range of variables have been considered for use in cardiac risk stratification tools, for example, patient’s cardiac risk
factors, HRV parameters, clinical characteristics, biomarkers,
and ECG [3]. Although HRV has been used to predict physiological distress for centuries [29], it only received increasing
attention in recent decades as a potential predictor of congestive
heart failure [30], coronary artery disease [31], post myocardial
infarction [32], and acute cardiac complications [15]. With the
advancement of computing technology, sensor measurements
and statistical analysis techniques, derivation of a risk predictor
becomes easier and development of complex and accurate risk
stratification tools is promising. In this study, we attempted to
discover the utility of HRV, vital signs, and 12-lead ECG for predicting clinical outcomes in critically ill patients presented to the
ED with the help of machine learning techniques. Through performance comparisons conducted with different types of variables, the 12-lead ECG seems promising as a predictor as its
involvement significantly improves the performance, which is
shown in Table IV.
The ESS method simulates the scenarios in real-world medical settings where more than one opinion is sought before making final decisions. The weights in the ESS algorithm indicate the contribution of their corresponding classifiers and the

LIU et al.: RISK SCORING FOR PREDICTION OF ACUTE CARDIAC COMPLICATIONS FROM IMBALANCED CLINICAL DATA

determination of the weights are derived from a novel hybrid
approach. In the ESS algorithm, large weights strengthen the
power of prediction while small weights weaken the power,
which is a strategy refined from the one suggested in [33] that
many individual classifiers in the ensemble could be better than
all for decision making. The novelty of the ESS algorithm is its
hybrid-sampling-based optimization and its ability in handling
imbalanced data. It is worth noting that SMOTE-based technique is one of many methods for weight derivation and it is
not perfect. Given more real data, we would be able to generate
more convincing and reliable weights for individual predictors
to represent their contributions in the decision ensemble. Furthermore, the SVM classifier was originally implemented as
part of the ESS algorithm for demonstration purpose. Therefore, the state-of-the-art pattern classification methods could be
of great help for improving prediction performance. For example, a Bayesian belief network framework has been proved to be
successful in generating a risk score to identify the risk of heart
failure [34].
Experimental results have shown that the 12-lead ECG and
HRV are significant predictors of acute cardiac complications;
however, it is still unclear which specific ECG-derived parameters are the real contributors to the prediction. It is also mentioned in [35] that not all vital signs were found useful in the
prediction of clinical outcomes. In order to save time and cost,
a clinician still prefers to neglect variables with minor contributions. To address these questions, we intend to conduct
a detailed analysis of the data by means of variable selection
techniques [36], [37] in our future work.
Due to the fact that this is a single-center study at an acute
tertiary hospital in Singapore, our findings may not be generalizable to other populations. Another limitation of this study
is that input measurements came from different resources and
were collected either automatically from machines or manually
by experienced medical staff. Therefore, operational errors were
possible even though quality control was carried out. Furthermore, validation of the scoring system on an independent dataset
would make this work more acceptable in clinical practice.
V. CONCLUSION
In this paper, we have proposed a novel risk-scoring method
ESS that integrated HRV, 12-lead ECG, and vital signs for the
prediction of acute cardiac complications within 72 h, where
a hybrid-sampling approach was invented to handle data imbalance. Through experimental validations based on an imbalanced dataset collected from a tertiary hospital in Singapore,
ESS has proved its efficiency in predicting clinical outcomes
compared with several established scoring systems in terms of
the ROC analysis. It was observed through the study that the 12lead ECG was a significant predictor and its combined use with
HRV and vital signs achieved satisfactory performance. Furthermore, machine learning techniques have shown improvements
over traditional statistics-derived methods, suggesting that intelligent algorithms are potential solutions to enhance medical
decision making. However, computational predictions should be
compared with clinical knowledge prior to reaching decisions.

1901

REFERENCES
[1] H. V. Huikuri, A. Castellanos, and R. J. Myerburg, “Sudden death due to
cardiac arrhythmias,” N. Engl. J. Med., vol. 345, no. 20, pp. 1473–1482,
2001.
[2] J. Wang, “Emergency healthcare workflow modeling and timeliness analysis,” IEEE Trans. Syst., Man, Cybern. A, Syst. Humans, vol. 42, no. 6,
pp. 1323–1331, Nov. 2012.
[3] S. Marcoon, A. M. Chang, B. Lee, R. Salhi, and J. E. Hollander, “HEART
score to further risk stratify patients with low TIMI scores,” Crit. Pathw.
Cardiol., vol. 12, pp. 1–5, 2013.
[4] J. L. Vincent and R. Moreno, “Clinical review: Scoring systems in the
critically ill,” Crit. Care, vol. 14, p. 207, 2010.
[5] E. Antman, M. Cohen, P. Bernink, C. McCabe, T. Horacek, G. Papuchis,
B. Mautner, R. Corbalan, D. Radley, and E. Braunwald, “The TIMI risk
score for unstable angina/non-ST elevation MI—A method for prognostication and therapeutic decision making,” JAMA, vol. 284, no. 7, pp. 835–
842, 2000.
[6] C. P. Subbe, R. G. Davies, E. Williams, P. Rutherford, and L. Gemmell,
“Effect of introducing the modified early warning score on clinical outcomes, cardio-pulmonary arrests and intensive care utilisation in acute
medical admissions,” Anaesthesia, vol. 58, pp. 797–802, 2003.
[7] W. A. Knaus, E. A. Draper, D. P. Wagner, and J. E. Zimmerman,
“APACHE II: A severity of disease classification system,” Crit. Care
Med., vol. 13, pp. 818–829, 1985.
[8] J. R. Le Gall, S. Lemeshow, and F. Saulnier, “A new simplified acute physiology score (SAPS II) based on a European/North American multicenter
study,” JAMA, vol. 270, pp. 2957–2963, 1993.
[9] S. Lemeshow, D. Teres, J. Klar, J. S. Avrunin, S. H. Gehlbach, and
J. Rapoport, “Mortality probability models (MPM II) based on an international cohort of intensive care unit patients,” JAMA, vol. 270, pp. 2478–
2486, 1993.
[10] J. Sanchis, V. Bodi, J. Nunez, X. Bosch, P. Lorna-Sorio, L. Mainar,
E. Santas, G. Minana, R. Robles, and A. Llacer, “Limitations of clinical history for evaluation of patients with acute chest pain, non-diagnostic
electrocardiogram, and normal troponin,” Amer. J. Cardiol., vol. 101,
no. 5, pp. 613–617, 2008.
[11] F. Fesmire, R. Percy, J. Bardoner, D. Wharton, and F. Calhoun, “Usefulness of automated serial 12-lead ECG monitoring during the initial emergency department evaluation of patients with chest pain,” Ann. Emerg.
Med., vol. 31, no. 1, pp. 3–11, 1998.
[12] A. Bakker, M. Koelemay, J. Gorgels, B. Vanvlies, R. Smits, J. Tijssen,
and F. Haagen, “Failure of new biochemical markers to exclude acute
myocardial-infarction at admission,” Lancet, vol. 342, no. 8881, pp. 1220–
1222, 1993.
[13] A. F. Manini, N. Dannemann, D. F. Brown, J. Butter, F. Bamberg,
J. T. Nagurney, J. H. Nichols, and U. Hoffmann, “Limitations of risk
score models in patients with acute chest pain,” Amer. J. Emerg. Med.,
vol. 27, no. 1, pp. 43–48, 2009.
[14] N. Liu, Z. Lin, J. Cao, Z. X. Koh, T. Zhang, G.-B. Huang, W. Ser, and
M. E. H. Ong, “An intelligent scoring system and its application to cardiac arrest prediction,” IEEE Trans. Inf. Technol. Biomed., vol. 16, no. 6,
pp. 1324–1331, Nov. 2012.
[15] M. E. H. Ong, C. H. Ng, K. Goh, N. Liu, Z. X. Koh, N. Shahidah, T. Zhang,
S. Fook-Chong, and Z. Lin, “Prediction of cardiac arrest in critically ill
patients presenting to the emergency department using a machine learning
score incorporating heart rate variability compared with the modified early
warning score,” Crit. Care, vol. 16, p. R108, 2012.
[16] M. E. H. Ong, K. Goh, S. Fook-Chong, B. Haaland, K. L. Wai, Z. X. Koh,
N. Shahidah, and Z. Lin, “Heart rate variability risk score for prediction
of acute cardiac complications in ED patients with chest pain,” Amer. J.
Emerg. Med., vol. 31, pp. 1201–1207, 2013.
[17] C. B. Pearce, S. R. Gunn, A. Ahmed, and C. D. Johnson, “Machine learning can improve prediction of severity in acute pancreatitis using admission values of APACHE II score and C-reactive protein,” Pancreatology,
vol. 6, pp. 123–131, 2006.
[18] M. Khalilia, S. Chakraborty, and M. Popescu, “Predicting disease risks
from highly imbalanced data using random forest,” BMC Med. Inform.
Decis. Mak., vol. 11, pp. 51:1–51:13, 2011.
[19] N. Liu, Z. Lin, Z. X. Koh, G.-B. Huang, W. Ser, and M. E. H. Ong, “Patient
outcome prediction with heart rate variability and vital signs,” J. Signal
Process. Syst., vol. 64, pp. 265–278, 2011.
[20] Task Force of the European Society of Cardiology the North American
Society of Pacing Electrophysiology, “Heart rate variability: Standards of
measurement, physiological interpretation, and clinical use,” Circulation,
vol. 93, pp. 1043–1065, 1996,

1902

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

[21] H. He and E. A. Garcia, “Learning from imbalanced data,” IEEE Trans.
Knowl. Data Eng., vol. 21, no. 9, pp. 1263–1284, Sep. 2009.
[22] J. Han and M. Kamber, Data Mining: Concepts and Techniques. San
Mateo, CA, USA: Morgan Kaufmann, 2006.
[23] N. Liu and H. Wang, “Ensemble based extreme learning machine,” IEEE
Signal Process. Lett., vol. 17, no. 8, pp. 754–757, Aug. 2010.
[24] R. Polikar, “Ensemble based systems in decision making,” IEEE Circuits
Syst. Mag., vol. 6, no. 3, pp. 21–45, Oct.–Dec. 2006.
[25] C. J. C. Burges, “A tutorial on support vector machines for pattern recognition,” Data Min. Knowl. Discov., vol. 2, pp. 121–167, 1998.
[26] X. Y. Liu, J. Wu, and Z. H. Zhou, “Exploratory undersampling for classimbalance learning,” IEEE Trans. Syst. Man. Cybern. B Cybern., vol. 39,
no. 2, pp. 539–550, Apr. 2009.
[27] N. V. Chawla, K. W. Bowyer, L. O. Hall, and W. P. Kegelmeyer, “SMOTE:
synthetic minority over-sampling technique,” J. Artif. Intell. Res., vol. 16,
no. 1, pp. 321–357, 2002.
[28] E. M. Ohman, C. B. Granger, R. A. Harrington, and K. L. Lee, “Risk stratification and therapeutic decision making in acute coronary syndromes,”
JAMA, vol. 284, pp. 876–878, 2000.
[29] M. E. H. Ong, P. Padmanabhan, Y. H. Chan, Z. Lin, J. Overton,
K. R. Ward, and D. Y. Fei, “An observational, prospective study exploring the use of heart rate variability as a predictor of clinical outcomes
in pre-hospital ambulance patients,” Resuscitation, vol. 78, pp. 289–297,
2008.
[30] B. M. Szabó, D. J. van Veldhuisen, N. van der Veer, J. Brouwer, P. A. De
Graeff, and H. J. Crijns, “Prognostic value of heart rate variability in
chronic congestive heart failure secondary to idiopathic or ischemic dilated
cardiomyopathy,” Amer. J. Cardiol., vol. 79, pp. 978–980, 1997.

[31] L. Fei, X. Copie, M. Malik, and A. J. Camm, “Short- and long-term assessment of heart rate variability for risk stratification after acute myocardial
infarction,” Amer. J. Cardiol., vol. 77, pp. 681–684, 1996.
[32] C. Carpeggiani, A. L’Abbate, P. Landi, C. Michelassi, M. Raciti,
A. Macerata, and M. Emdin, “Early assessment of heart rate variability is predictive of in-hospital death and major complications after acute
myocardial infarction,” Int. J. Cardiol., vol. 96, pp. 361–368, 2004.
[33] Z. H. Zhou, J. Wu, and W. Tang, “Ensembling neural networks: Many
could be better than all,” Artif. Intell., vol. 137, pp. 239–263, 2002.
[34] S. Sarkar and J. Koehler, “A dynamic risk score to identify increased risk
for heart failure decompensation,” IEEE Trans. Biomed. Eng., vol. 60,
no. 1, pp. 147–150, Jan. 2013.
[35] W. Hong, A. Earnest, P. Sultana, Z. X. Koh, N. Shahidah, and
M. E. H. Ong, “How accurate are vital signs in predicting clinical outcomes in critically ill emergency department patients,” Eur. J. Emerg.
Med., vol. 20, pp. 27–32, 2013.
[36] M. Llamedo and J. P. Martı́nez, “Heartbeat classification using feature
selection driven by database generalization criteria,” IEEE Trans. Biomed.
Eng., vol. 58, no. 3, pp. 616–625, Mar. 2011.
[37] H. Liu and L. Yu, “Toward integrating feature selection algorithms for
classification and clustering,” IEEE Trans. Knowl. Data Eng., vol. 17,
no. 4, pp. 491–502, Apr. 2005.

Authors’ photographs and biographies not available at the time of publication.

