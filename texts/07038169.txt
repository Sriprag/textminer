IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

549

Adaptive Cosegmentation of Pheochromocytomas in
CECT Images Using Localized Level Set Models
San Tang, Yi Guo, Yuanyuan Wang, Senior Member, IEEE, Wanli Cao, and Fukang Sun

Abstract—Segmentation of pheochromocytomas in contrastenhanced computed tomography (CECT) images is an ill-posed
problem due to the presence of weak boundaries, intratumoral
degeneration, and nearby structures and clutter. Additional information from different phases of CECT images needs to be imposed for better mass segmentations. In this paper, a novel adaptive
cosegmentation method is proposed by incorporating a localized
region-based level set model (LRLSM). The energy function is
formulated with consideration of adaptive tradeoff between the
complementary local information from image pairs. Gradient direction and shape dissimilarity measure are integrated to guide the
level set evolution. Automatic localization radius selection is added
to further facilitate the segmentation. Then, two level set functions
from each image pair are evolved and refined alternately to minimize the energy function. Experimental results in 50 CECT image
pairs show that the adaptive LRLSM-based method is effective in
segmentation of pheochromocytoma at two phases and produces
better results, especially in the cases with weak boundaries, and
complex foreground and background.
Index Terms—Adaptive localized energy, contrast-enhanced
computed tomography (CECT), cosegmentation, level set model,
pheochromocytoma.

I. INTRODUCTION
HEOCHROMOCYTOMAS are tumors arising from chromaffin tissue of the adrenal medulla or extra-adrenal paraganglia. Although in general, the prevalence of pheochromocytomas in outpatient clinics is low (0.1% ∼ 0.6%), the potent
effects of secreted catecholamines lead to serious and potentially
life-threatening cardiovascular complications [1], [2]. Accounting for about 10% of masses are malignant that need radical
surgical removal of tumor tissue. Correct and noninvasive characterization of pheochromocytomas is of critical importance
because any handling of these masses can precipitate a hypertensive crisis. Imaging techniques like ultrasound, computed
tomography (CT), magnetic resonance (MR), and functional

P

Manuscript received June 17, 2014; revised October 10, 2014 and December
30, 2014; accepted February 4, 2015. Date of publication February 10, 2015;
date of current version March 3, 2016. This work was supported in parts by the
National Basic Research Program of China under Grant 2015CB755500, the
National Natural Science Foundation of China under Grant 61401102, and the
Science and Technology Commission of Shanghai Municipality under Grant
14YF1400300.
S. Tang, Y. Guo and Y. Wang are with the Department of Electronic Engineering, Fudan University, Shanghai 200433, China and also
with Key Laboratory of Medical Imaging Computing and Computer
Assisted Intervention (MICCAI) of Shanghai, Shanghai 200032, China
(e-mail: tangsanyi@163.com; guoyi@fudan.edu.cn; yywang@fudan.edu.cn).
W. Cao and F. Sun are with the Department of Urology, Rujin Hospital,
Shanghai Jiao Tong University School of Medicine, Shanghai 200025, China (email: wanli.cao@hotmail.com; sunfukang6@sina.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2402173

Fig. 1. Two cases of pheochromocytomas in CECT images. (a) and (b) AP
images, (c) and (d) PP images. The masses are inside the red dashed boxes.

imaging have been shown to be useful [3]. Especially, CT is
preeminent in adrenal imaging and most pheochromocytomas
are detected during CT scanning with and without contrast [1].
Contrast-enhanced CT (CECT) is a primary imaging modality for its ability to differentiate two types of adrenal tumors:
pheochromocytoma and adrenal adenoma, which are difficult to
be distinguished in an unenhanced CT image [4], [5]. Besides,
small pheochromocytomas tend to be solid and large ones contain various forms of intratumoral degeneration, such as cystic
changes, necrosis, hemorrhage, and calcifications. CECT scans
produce a better diagnosis by displaying distinct attenuation values to different types of degeneration [6], [7]. In clinical practice,
a CECT usually has two phases, the arterial phase (AP) and the
portal-venous phase (PP). PP images are typically acquired 30 s
after AP. As a result of temporally varying proportions of contrast medium, pheochromocytomas and surrounding abdominal
structures exhibit dissimilar density distributions between AP
and PP images. To inspect pheochromocytomas, urologists commonly combine detailed and complementary anatomical image
information at different phases [7], [8]. As examples, two cases
of CECT image pairs are illustrated in Fig. 1. The AP and PP
images are listed in the upper and bottom row, respectively.
Mass characterization plays a significant role in the diagnosis,
prognosis, and treatment of pheochromocytomas. The characterization primarily relies on the assessment of attenuation values
and density heterogeneity [4], [8]. Accurate tumor segmentation
and precisely delineated contours are the prerequisite for quantitative measurements. In clinical applications, the contours of

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

550

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

pheochromocytomas in CECT images at AP and PP are manually drawn by experts [5]–[7]. However, manual segmentation
is time consuming, subjective, and highly dependent on the experts’ experience. When masses compress surrounding organs,
blurred or missing boundaries may lead to manual errors. Moreover, various types of intratumoral degeneration and surrounding clutter give rise to complex foreground and background that
complicate the delineation. Automated or semiautomated segmentation methods would have improvements in efficiency and
accuracy.
Computer-aided CT tumor segmentation has become an active field of research. Methods are mainly divided into three
groups: graph-based, learning-based, and deformable models.
Graph cuts methods are employed for either initial liver segmentation or hepatic tumors using constraints such as shape and enhancement [9], [10]. However, the heterogeneity of large masses
and the partial volume effect of CT imaging severely affect the
performance of graph-based methods. Machine learning techniques are introduced to the classification of tumors and healthy
tissues as well as different types of lesions [11], [12]. Learningbased methods allow the usage of high-dimensional features to
achieve a better discriminatory power, whereas the spatial correlation between pixels is hardly considered. To complement the
drawbacks, Keshani et al. combined an active contour model
(ACM) for accurate segmentation of lung nodules [13]. Including ACM, deformable models are influential and successful in
the CT tumor segmentation. Especially, level set models (LSMs)
embedding the dynamic curves and surfaces are advantageous
to represent complex topology and handle topological changes
[14]. By integrating image data and model properties, LSMs
achieve optimal segmentation by minimizing the objective energy function [15]. Traditional edge-based geometric models
utilize image gradients derived from edge features to converge
contours at object boundaries [16]–[19]. Considering the weak
boundaries and image clutter in CECT images, the evolving
contours may eventually leak away or be attracted to false locations. In such cases, the region-based LSMs (RLSMs) are
more suitable by using statistical information of foreground and
background regions [20]–[24]. The popular Chan–Vese (C–V)
model segments a given image into two parts on the premise that
each image region is homogenous statistically [21]. To improve
the capability of segmenting objects having heterogeneous regions, local image information are widely considered in many
localized RLSMs (LRLSMs) [22]–[24].
Recent techniques incorporate other methods into the LSMs.
Li et al. unified fuzzy c-means for the probabilistic estimation
of liver tumors to enhance the object indication from a complex
background [25]. Another semiautomated LSM reported by Li
et al. used the likelihood energy to separate the tumors from
surrounding normal tissues [26]. Farag et al. proposed a general
lung nodule shape model fused with the intensity statistical
information [27]. Massoptier et al. combined the gradient vector
flow to an LSM for automated segmentation of hepatic lesions
[28]. Bai et al. initiated the region-scalable fitting LSM with
contours from the mean shift clustering [29]. These LSMs were
well applied to the segmentation of large organs. Whether they
can be used directly in the pheochromocytoma segmentation is

still questionable because of the difficult issues of weak or even
missing boundaries as shown in the first case of Fig. 1(a) and
(c) and complex foreground and background as illustrated in the
second case of Fig. 1(b) and (d).
Lately, many techniques incorporate complementary information from different images for integrative level set segmentation. Compared with the single-image-based segmentation
methods, the integrative methods can achieve better results. Fang
et al. [30] incorporated the temporal information calculated from
neighboring frames of the echocardiographic image sequence
to recover the missing boundary in weak segments. Li et al. [31]
proposed a hybrid LSM to remodel shear modulus distribution
by referring to the corresponding magnetic resonance elastography. Prevost et al. [32] used the contrast-enhanced ultrasound to
complement the kidney segmentation in the conventional ultrasound. More recently, simultaneously cosegmenting common
objects from a pair of images has drawn much attention. Yezzi
et al. [33] and Bagci et al. [34] reported that incorporating CT
and other imaging modalities for cosegmentation significantly
improved the performances that solely rely on CT. Han et al. [35]
and Song et al. [36] successively proposed graph-based methods to encode the complementary information from PET and
CT images. A considerable number of LSMs have been investigated to cosegment real image pairs. Riklin-Raviv et al. [37]
presented a unified level set framework with a mutual evolution
procedure. Zhang et al. [38] and Meng et al. [39] used the color
histogram to measure the foreground similarity in their RLSMs.
The cosegmentation methods are attractive and promising. In
clinical applications, combining the images in two phases will
benefits the detection and depiction of pheochromocytoma [7],
[8]. As demonstrated in Fig. 1, the pheochromocytoma at AP
in (a) with distinct boundaries, whereas in (c) it presents the
density similar to the liver resulting in boundary ambiguity at
PP. The other mass has clutter in the nearby upper right at AP
in (b) and no presence at PP in (d). Hence, the information of
one image in each image pair including the boundary, shape,
and location can improve the segmentation in the other image.
To tackle the aforementioned difficult issues in pheochromocytoma segmentation, we herein present a novel cosegmentation
method that takes advantage of additional information from different phases. The proposed method simultaneously cosegments
pheochromocytomas in CECT image pairs at AP and PP. The
adaptive technique, the gradient direction, the shape dissimilarity measure, and the automated selection of localization radius
are integrated into an LRLSM. Different from the existing methods, our main contributions are fourfold: 1) a novel cosegmentation level set formulation combines the complementary local
region-based information from CECT images at two phases;
2) the adaptive tradeoff of localized energies from each image
pair makes the model flexible to different local boundaries; 3)
the gradient direction and shape dissimilarity measure help to
guide the contour evolution; and 4) the localization radius is
automatically approximated based on the initial contour.
The remainder of this paper is organized as follows. Section II briefly describes two popular LSMs related to our work.
Our proposed adaptive LRLSM-based cosegmentation method
is presented in Section III. The datasets and the experiments are

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

elaborated in Section IV. Sections V and VI demonstrate the
results and discussions, respectively. Section VII concludes this
paper and outlines the possible future work.
II. BACKGROUND
Our method is an LSM-based cosegmentation. A brief introduction of two popular LSMs is described in this section.
A. Brief Introduction of C–V Model and LRLSM
Chan and Vese proposed an RLSM based on the Mumford
and Shah energy function [20], [21]. Let I be a given image in the
domain Ω and x denotes a point in I. In LSMs, the segmenting
contour C in Ω is usually represented by the zero level set of a
signed distance function φ, which is also referred as the level set
function (LSF) [14]. The LSF is positive for the interior regions
and negative for the exterior regions of C
⎧
C = {x ∈ Ω|φ(x) = 0}
⎪
⎨
inside(C) = {x ∈ Ω|φ(x) > 0}
(1)
⎪
⎩
outside(C) = {x ∈ Ω|φ(x) < 0}.
The energy function of the C–V model is given as follows:


δφ(x)|∇φ(x)|dx +
f (I, φ)dx
(2)
E C V (φ) = λl
Ω

based flow as in the C–V model [23]. In the LRLSM, a local
region of each point along the zero level set is partitioned into
the local interior and local exterior of the evolving contour. The
local region is defined as follows:

1, ||x − y|| < r
B(x, y) =
(6)
0,
otherwise
where y denotes a point independent with x in Ω, r is a localization radius parameter, and B(x, y) represents a binary circular
ball centered at x of radius r, which is 1 when y is within the
circle, and 0 otherwise.
The energy function is the sum of localized energies at each
point along the zero level set, which is given as

δφ(x)|∇φ(x)|dx
E LRLSM (φ) = λl


f (I, φ) = λi Hφ(x)(I(x) − u)2
+ λo (1 − Hφ(x))(I(x) − v)2

(3)

where λi > 0 and λo > 0 are weighted parameters to balance
the contributions of the data fitting energies inside and outside
the zero level set, respectively, λi = λo is set for most cases,
u and v are two constants, which approximate the average intensities inside and outside the contour, respectively, Hφ(x) is
the Heaviside function, which is used to specify the interior of
the zero level set and similarly, (1– Hφ(x)) denotes the exterior.
The area just around the contour is represented by the Dirac
function δφ(x), which is the derivative of Hφ(x). The smooth
versions of the Heaviside function and the Dirac function are
used as follows:
⎧
⎨ Hφ(x) = 1 (1 + 2 arctan( φ(x) ))
2
π
ε
(4)
⎩ δφ(x) = H φ(x) = 1 2 ε 2
π ε +φ(x)
where ε is a positive constant and generally set to 1.
By minimizing the aforementioned energy function, the corresponding variational level set formulation is solved as follows:
∂φ
= δφ(x)[λl div(∇φ(x)/|∇φ(x)|)
∂t
− λi (I(x) − u)2 + λo (I(x) − v)2 ].

Ωx

δφ(x)f L (I, φ, r)dx

+

(7)

Ωx

where Ωx denotes the image domain for x, f L is the localized
version of f in (2), which is defined as the localized uniform
modeling energy [21], [23]:

L
B(x, y) · Hφ(y)(I(y) − ux )2 dy
f (I, φ, r) =
Ωy



Ω

where λl > 0 is a weighted parameter, which controls the
smoothness of the zero level set, and f(I, φ) is a generic force
function defined in [23] with respect to the image I and the LSF
φ as follows:

551

B(x, y) · (1 − Hφ(y))(I(y) − vx )2 dy

+
Ωy

(8)
where Ωy is the image domain for y, and ux and vx denote the
localized versions of the means, that are

⎧
⎪
Ω B(x, y) · Hφ(y)I(y)dy
⎪
⎪
ux = y
⎪
⎪
⎨
Ω y B(x, y)Hφ(y)dy
(9)

⎪
B(x, y) · (1 − Hφ(y))I(y)dy
⎪
⎪
Ω
y
⎪

.
⎪ vx =
⎩
Ω y B(x, y)(1 − Hφ(y))dy
By minimizing the energy function in (7), the gradient descent
flow is obtained as follows:
∂φ
= δφ(x)[λl div(∇φ(x)/|∇φ(x)|) + ∇φ(y ) f L (I, φ, r)]
∂t
(10)
where ∇φ(y ) f L is the derivative of f L with respect to φ(y),
which can be written as

B(x, y) · δφ(y)(I(y) − ux )2 dy
∇φ(y ) f L (I, φ, r) =
Ωy



−

B(x, y) · δφ(y)(I(y) − vx )2 dy.
Ωy

(11)
B. Advantages and Limitations of LRLSM

(5)

To handle images with intensity inhomogeneity, Lankton and
Tannenbaum considered using local instead of global region-

The C–V model uses global statistics inside and outside
the evolving contour. The image data fitting force [−λi (I(x)
− u)2 + λo (I(x) − v)2 ] in (5) plays a key role in the level set
evolution. Obviously, it is not ideal to segment inhomogeneous

552

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

given as








( x sin θ + y cos θ)2
( x cos θ + y sin θ)2
+
=1
a2
b2

(12)

where ( x, y ) = (x − xc , y − yc ) and (xc , yc ) is the center of
the ellipse, θ depicts the angle of rotation counterclockwise,
and a and b denote the Euclidean distance from the center to the
endpoints of the major and minor axes, respectively.


Fig. 2.

Illustration of initialization. (a) Three points. (b) Generated ellipse.

regions. To cope with density inhomogeneity, the localized energies in the LRLSM are constructed separately concerning each
point and optimized at each local region. Hence, the LRLSM is
more robust to segment heterogeneous objects. However, weak
edges of pheochromocytomas in CECT images may trap the
contour into undesired local minima. Moreover, incorrect segmentations may be gained in two challenging cases: the confused foreground arising from intratumoral degeneration and
the complex background ascribed to nearby structures and clutter. Due to different density distributions and dissimilar presence
of the surrounding clutter in AP–PP image pairs, the complementary information can be exploited to improve the segmentations. In addition, the localization radius r to determine the size
of local regions is an important parameter to be considered in
the LRLSM, but its manual tuning is tedious for the user. An
automatic tuning is necessary.
III. OUR PROPOSED METHOD
In this section, the proposed method is applied to the
pheochromocytoma cosegmentation in CECT image pairs. Our
method has three steps: initialization, cosegmentation level set
formulation, and energy function minimization. The details are
described in the following sections.
A. Initialization
Different from the traditional single-image-based LSMs, the
proposed cosegmentation method takes two images into consideration. The input is a given image pair I k , k ∈ {0, 1}, of
the same pheochromocytoma at AP and PP. Because patients
are informed with breath-holding requirements during image
acquisition, the mass at different phases present slight differences. Compared to other organs, pheochromocytomas are much
smaller and the difference often could be neglected. Either one
in the AP or PP image can be the basic of the initialization.
The user simply needs to place three points to define an ellipse,
which is regarded as the initial contour. One point is placed near
the center of the mass and the other two points are placed to
approximate the endpoints of the major and minor axes. Fig. 2
illustrates the initialization of one case of pheochromocytoma.
Three points in green color are placed in (a) and an ellipse in
red is generated as shown in (b). The equation of the ellipse is



B. Cosegmentation Level Set Formulation
To incorporate the cosegmentation into the LRLSM framework, two LSFs φk corresponding to I k are generated from the
same initial contour. Based on the initial contour, localization
radius is automatically chosen to reduce the user interaction. In
the cosegmentation process, each LSF is evolved based on the
local statistics of the image pair and the constraint of the other
LSF. For image I k of each image pair, a new energy function is
proposed as follows:
E(φk ) = λkl · Length(φk ) + λks · Shape(φk , φ1−k )

+
δφk (x)[λki f L (I k , φk , rk )
Ωx

+ λko f L (I 1−k , φk , r1−k )]dx

(13)

where I k and I 1−k denote the image pair, φk and φ1−k
are the corresponding LSFs, E(φk ) is the energy function
with respect to φk , Length(φk ) represents a length term
of φk , Shape(φk , φ1−k ) denotes a shape term to penalize
the shape dissimilarity of φk and φ1−k , f L (I k , φk , rk ) and
f L (I 1−k , φk , r1−k ) are the localized energies from the image
pair along the zero level set of φk with localization radii rk and
r1−k , respectively, λki and λko govern the tradeoff between these
two localized energies, and λkl > 0, λks > 0, λki > 0 and λko > 0
are weighted parameters.
Compared with conventional single-image-based LSMs, the
proposed energy function combines two localized energies
f L (I k , φk , rk ) and f L (I 1−k , φk , r1−k ) to complement the segmentation. Similar to f L (I k , φk , rk ) defined in (8), the novel
f L (I 1−k , φk , r1−k ) represents local statistics inside and outside
the evolving zero level set of LSF φk on the other image I 1−k
of the image pair. Hence, localized energies of each image pair
Ik and I1–k are integrated to guide the evolution of φk . Moreover, the shape term Shape(φk , φ1−k ) is introduced to penalize
the dissimilarity between the two LSFs φk and φ1−k along the
cosegmentation process. Therefore, the complementary image
information, such as boundary, location, and shape, are utilized.
Furthermore, unlike the global region-based flow of existing
cosegmentation LSMs, the proposed energy function enforces
the use of local image data in the pheochromocytoma segmentation. The LRLSM is integrated for not only its capability to
keep the zero level set from boundary leakage in the cases with
weak edges, but also its advantage in the cases with density
inhomogeneity. To flexibly utilize the LRLSM, the sum of two
localized region-based energies from the image pair is calculated
under the adaptive weights λki and λko . In addition, the gradient

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

Fig. 3. One case of a pheochromocytoma and a synthetic example with different local boundaries. (a) AP image. (b) PP image. (c) Synthetic example with
local regions of different contrast. The red contour represents the zero LSF and
two green balls depict two local regions.

direction is incorporated into the length term Length(φk ) to
evolve the zero level set to converge to the object boundaries.
1) Self-Adaptive Energies From the Image Pair: Usually,
weights λki and λko controlling the contributions of two localized energies are set to be the same in the cosegmentation.
However, in our application, the PP images are acquired 30 s
after the AP. As a consequence, circulation of contrast medium
leads to dissimilar density distributions between masses and
adjacent structures at two phases. Besides, respiratory motion
leads to some differences of the same mass. As an example,
Fig. 3(a) and (b) shows an image pair of a pheochromocytoma
with different local boundaries. The AP image in (a) exhibits
relatively distinct boundaries whereas the PP image in (b) has
weak boundaries in the bottom right. Thus, the cosegmentation should be performed by adaptively adjusting the weights
on images at different phases. Usually, self-adaptive methods
were considered with regarding to images features [40], [41].
Here, a local contrast ratio is introduced to achieve self-adaptive
cosegmentation.
A synthetic example of an internally degenerated pheochromocytoma in Fig. 3(c) illustrates the effect of the local contrast
ratio. In local regions where the densities vary slowly, such as P1
in (c), the localized energy f L (I k , φk , rk ) is difficult to drive
the zero level set toward the desired boundaries because the
local information is not enough to reflect the true background
and foreground. In this situation, the weight of the other localized energy f L (I 1−k , φk , r1−k ) from image I 1−k is increased
to help the evolving zero level set converge to better boundaries.
In contrast, when the densities of the image being segmented
are inhomogeneous, such as P2 in (c), the localized energy from
the image takes dominant effects instead of being influenced
by the information from the other image. In such regions, the
weight of the localized energy from the other image is decreased.
Hence, the weights λki and λko are set to be adaptive according
to the contrast of local regions. A new local contrast ratio is
defined as
T k (x) =

|ukx − vxk |
M

(14)

where ukx and vxk are the mean densities within the localized
interior and exterior regions at point x in image I k , respectively,
M denotes the density level of the image and is usually 255 for
the gray level image, T k (x) varies between 0 and 1 that is bigger
in local regions with high contrast.

553

Fig. 4. Illustrations of the gradient direction. (a) One case of a pheochromocytoma. (b) Gradient directions of one object with a hole and surrounding
structures. (c) Normal direction of the negative LSF.

The weighted function ω k is controlled by the local contrast
ratio T k . It is defined as
ω k = 0.5(1 − T k (x))

(15)

where the constant 0.5 represents the maximum value of ω k ,
which means the impact of the local information of the other
image cannot surpass that of the image being segmented.
Then, λki = (1 − ω k ) and λko = ω k are the weights of the
localized energies from the image being segmented I k and the
other image I 1−k , respectively. To use the localized energies
from each image pair and make them work complementarily,
λki and λko are altered at the same time.
2) Length Term and Gradient Direction: Clinical studies
show that pheochromocytomas present inhomogeneous density
levels. Intratumoral degeneration forms the hole and results in
inner edges. Surrounding tissues and organs may close or even
be compressed by masses, which leads to ambiguous boundaries. As illustrated in Fig. 4(a), the red line is the true boundary,
but due to the high gradient values, it may converge to the yellow
line (the surrounding organ) or the blue line (the intratumoral
degeneration). To avoid being attracted to undesired edges, we
integrate the gradient direction into the level set framework [19],
[42]. A general edge detector with respect to the image gradient
can be defined by a positive and decreasing function as follows:
g=

1
1 + |∇IG |

(16)

where IG = Gσ ∗ I, a smoother version of the image I, is the
convolution of I with the Gaussian kernel of the standard deviation σ. The edge-detector function g has the low value close to
zero at edges while indicates the high value close to 1 in homogeneous regions. By adding the gradient direction into (13), the
length term is given by

g k · δφk (x)|∇φk (x)|dx.
(17)
Length(φk ) =
Ωx

A synthetic object in Fig. 4(b) illustrates a pheochromocytoma with inhomogeneous density levels. The mass and surrounding structures have high density levels, and the intratumoral degeneration and the background present low density
levels. The gradient directions are depicted as green arrows.
The normal direction of the negative LSF is demonstrated in (c)
with a red circle indicating the zero LSF.
The boundaries of masses are valid only when the gradient
direction is conformed to the normal direction of the negative

554

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

LSF. To determine the valid edge, the edge-detector function
takes the relationship of the two directions into consideration
when the evolving contour is close to the boundaries. The new
edge-detector function is defined as follows:

1, −∇φk · ∇IGk ≤ 0
k
(18)
g =
g, −∇φk · ∇IGk > 0
where
is the smoothed version of I , and (−∇φ ·
indicates the relationship of the gradient direction and the normal
direction of the negative LSF. If (−∇φk · ∇IGk ) is positive that
means two directions are consistent and the edge is valid, then
g k is unchanged and the edge-detector function is preserved;
otherwise, the edge is thought to be invalid, then g k is 1 and
the length term is degraded into a regularization term, which
controls the smoothness of the contour.
3) Shape term: Pheochromocytoma in each image pair has
similarity with respect to the shape and the location. To penalize
the difference between two zero LSFs, we exploit two Heaviside
functions as a dissimilarity measure of two shape representations
[37]. The shape dissimilarity measure in (13) is defined as

k
1−k
[Hφk (x)(1 − Hφ1−k (x))
Shape(φ , φ ) =
IGk

k

k

∇IGk )

Ωx

+ Hφ1−k (x)(1 − Hφk (x))]dx (19)
where Shape(φk , φ1−k ) denotes the disagreement between the
classifications of the foreground and background in the image
pair, the foreground and background in image I k are labeled by
Hφk and (1 − Hφk ) respectively, and those of the other image
I 1−k are indicated by Hφ1−k and (1 − Hφ1−k ), respectively.
In our method, the cosegmentation is done through a mutual
procedure in which two LSFs are evolved and refined alternately.
In other words, only the segmenting zero level set is evolved on
each iteration, and the other LSF is employed as a dynamic
shape prior. The disagreement can be categorized into two types
[37]. First, if there are regions labeled as the foreground by the
evolving LSF φk and labeled as the background by the shape
prior φ1−k , the first term in (19) does not vanish. On the other
hand, if there are regions labeled as the background by the
evolving LSF φk and labeled as the foreground by the shape
prior φ1−k , the second term in (19) is not void. Therefore, the
evolution of each LSF is not only controlled by the localized
energies from the image pair, but also constrained by the other
LSF as the dynamic shape prior along the mutual procedure.
4) Automated Selection of Localization Radius: In the previous study, the localization radius r in the LRLSM is manually
selected by the user based on the proximity of the scale of the
object and the presence of the nearby clutter [23], [43]. Herein,
we introduce an automated way that makes use of the initial
contour to approximate the size of the tumor and the presence
of surrounding clutter. For image I k , the value of localization
radius is set as
√
rk = round( S/2(V k + 1))
(20)
where rk is the localization radius, S denotes the area covered
by the initial contour, V k corresponding to I k depicts the local
variation ratio, two constants 2 and 1 guarantee rk to be in a

rational range, that is 5 to 15 pixels for most cases. The local
variation ratio V k is defined as
var (y0 )

V k = mean((exp(
x 0 ∈C 0

y 0 ∈B0

(mean(y0 ))2

))

(21)

y 0 ∈B0

where x0 is the pixel on the initial contour C0 , y0 is the pixel
falling into the localization ball B0 (x0 , y0 ) centered at x0 of
initial radius r0 = 10 pixels.
The initial contour lies not far away from the pheochromocytoma boundaries. Hence, the value of S is able to approximate
the mass size. The value of V k reflects the homogeneity degree of local regions along the initial contour and estimates the
presence of nearby clutter. It has small values in homogeneous
regions and produces large values at edges or in the local regions corrupted by the clutter. Therefore, a large radius rk is
defined in the case of a large mass with homogeneous boundaries, whereas small radii are chosen in the cases of small masses
having surrounding clutter.
C. Energy Function Minimization
By manipulating (13), the cosegmentation energy function is
expressed as

k
k
g k · δ(φk (x))|∇φk (x)|dx
E(φ ) = λl
Ωx



+ λks

[Hφk (x)(1 − Hφ1−k (x))
Ωx

+ Hφ (x)(1 − Hφk (x))]dx

+
δφk (x)[(1 − ω k )f L (I k , φk , rk )
1−k

Ωx
k

+ ω f L (I 1−k , φk , r1−k )]dx.

(22)

By taking the first variation with respect to φk , we obtain the
evolution equation represented as
∂φk
= δφk (x)[λkl div(g k · ∇φk (x)/|∇φk (x)|)
∂t
+ λks (2Hφ1−k (x) − 1))
+ (1 − ω k )∇φ k (y ) f L (I k , φk , rk )
+ ω k ∇φ k (y ) f L (I 1−k , φk , r1−k )].

(23)

Two LSFs φ0 and φ1 , corresponding to the image pair I 0
and I 1 , respectively, are evolved and refined alternately by minimizing the cosegmentation energy function. From (22) and
(23), we summarize that the evolution of each LSF is based on
the data of the image pair and the other LSF. Besides, a new
convergence test is introduced to stop the iteration process once
the desired contours are obtained. The convergence criterion is
defined as overlapped area of the regions covered by two consecutive evolving contours. The two level sets of the image pair
evolve alternately as the iteration number increases. Once they
reach steady state, the region of the AP image and that of the PP
image remain almost constant. In the experiments, the iteration

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

process was stopped when the overlapped area of two consecutive contours reached 99.5% for ten iterations. An overview of
the proposed method is given in Algorithm 1.
Algorithm 1 Cosegmentation of Pheochromocytomas
Input An AP–PP image pair defined as image I0 and image
I1 , respectively
Output Segmented pheochromocytoma in the image pair
Steps
1) Create an ellipse and automatically set the localization
radii by using (20) and (21). Initialize two LSFs φ0 and
φ1 , corresponding to I0 and I1 , respectively.
2) For each image I k , k ∈ {0, 1}, compute the localized
energies from the image pair adaptive to the local
contrast ratio by using (14) and (15), compute the
length term by using (17) and (18) and compute the
shape term by using (19).
3) At odd iterations, evolve the LSF φ0 by using the other
LSF φ1 as a shape prior, while at even iterations evolve
the LSF φ1 by using the other LSF φ0 as a shape prior.
4) Update LSFs φ0 and φ1 by using the evolution
equation (23).
5) Repeat steps 2–4 until convergence.

IV. EXPERIMENTS
In this section, a set of experiments were designed to verify
the effectiveness of the proposed method.
A. Datasets
To evaluate the performance of the proposed cosegmentation method, we acquired all the datasets from the clinic. 50
image pairs out of 12 patients from Department of Urology,
Ruijin Hospital, Shanghai, China, were used. Every patient has
been histologically confirmed with pheochromocytoma. Each
image pair of the same pheochromocytoma was composed of
two CECT images with one at AP and the other at PP. After
injection of contrast medium, the AP and PP scanning were
conducted 28–32 s and 55–60 s, respectively. During image acquisition, patients were instructed to hold the breath at end of
inspiration. The images were preserved in DICOM files and had
the dimension of 512 × 512 pixels and varying pixel spacing
of 0.60 mm × 0.60 mm to 0.78 mm × 0.78 mm. The whole
pipeline was implemented in MATLAB on a 2.40-GHz quad
core CPU. Reference segmentations served as the ground truth
were manually drawn by two urological experts.
B. Compared Algorithms
In order to assess all proposed contributions, five LSM-based
methods were compared:
1) an edge-based LSM based on the distance regularized
level set evolution (DRLSE) [19],
2) the LRLSM described in Section II with the automated
selection of localization radius (LRLSM_A) [23],

555

3) the global region-based cosegmentation LSM
(coGRLSM) based on the foreground similarity
and background consistency [39],
4) the cosegmentation LRLSM with constant weights of localized energies from image pairs (coLRLSM_C),
5) the cosegmentation LRLSM with adaptive weights of localized energies from image pairs (coLRLSM_A, our algorithm).
Among the aforementioned algorithms, DRLSE and
LRLSM_A were single-image-based and coGRLSM was a
cosegmentation method. coLRLSM_C was based on our algorithm but with constant weights ω k = 0.5, k ∈ {0, 1}, which
indicates equal localized energies from each image pair for the
evolution of two LSFs. coLRLSM_A was short for the proposed
self-adaptive cosegmentation method. The PP images were selected for initialization. For all five algorithms, the same initial
contour was created by the user. To assess the impacts of initialization, the initial contours were expanded by 3 pixels or
displaced by −3 pixels in x- or y-axes.
For DRLSE, the time step Δt = 5 was set to speed up the
curve evolution and the parameter of the level set regularization term μ = 0.04 was relatively small to meet the Courant–
Friedrichs–Lewy (CFL) condition as μ · Δt < 1/4 in the finite
difference schemes [19]. The other four algorithms also maintained the CFL condition to achieve the numerical stability. The
parameter of the weighed area term α = 1.5 was relatively small
to avoid the boundary leakage and the final segmentation was
refined by further evolving the contour for ten iterations with the
parameter α = 0. For coGRLSM, we chose the same optimized
parameters for the length term and the area term, and changed
the color band parameter β = 10 in one channel to segment
gray images. The parameters to govern the tradeoff between
the foreground similarity and background consistency of image
pairs were both set 1, according to the method [39]. The localized algorithms LRLSM_A, coLRLSM_C, and coLRLSM_A
used the same localization radii based on the automated selection. We set the weighted parameter of the length term λkl = 0.2
in three localized algorithms, and fixed the parameter of the
shape term λks = 0.05 in coLRLSM_C and coLRLSM_A for all
image pairs.
In the figures of the experiments, we show the rectangular
ROI of images for display effects. The user has no need to
identify an ROI first and all the initialization and segmentation
process were based on the entire images.
C. Evaluation Metrics
The performances of aforementioned five algorithms were
validated by comparison with the ground truth with respect
to the following three metrics: 1) Hausdorff distance (HD), 2)
mean sum of squared distance (MSSD), and 3) dice similarity
coefficient (DSC).
HD measures the distance between two contours obtained
from different segmentations





	
	
	
HD = max max min 	a − b	 , max min 	b − a	
a∈A

b∈B

b∈B

a∈A

(24)

556

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 5. Cosegmentation results of different forms of initialization. (a) and (e)
Ground truth. (b) Initial contour in the AP image and (c) and (g) corresponding
results. (f) Initial contour in the PP image and (d) and (h) corresponding results.

Fig. 7. Cosegmentation results of the constant and adaptive methods. (a) and
(e) Ground truth. (b) Superposition of the image pair. (f) Initial contour at PP.
(c) and (g) Results of coLRLSM_C. (d) and (h) Results of coLRLSM_A.

are apart
MSSD =

1 
min 	a − b	2
b∈B
N

(25)

a∈A

where N is the size of A and other parameters are the same as
defined in HD. The performance is better when the closer HD
and MSSD both value to 0.
DSC is defined as the overlap between the result of an algorithm and the ground truth
DSC =

2 |P ∩ Q|
|P | + |Q|

(26)

where P and Q denote the segmented regions of an algorithm
and the ground truth, respectively, and |·| represents the overall
points in the region. DSC values between 0 and 1, and higher
DSC corresponds to a better segmentation.
V. RESULTS
A. Different Forms and Positions of Initialization

Fig. 6. Segmentation results at different initial positions. The first column was
the ground truth, the second, third, fourth, and fifth columns were the results
of coGRLSM, DRLSE, LRLSM_A, and coLRLSM_A, respectively. (a)–(e)
Results at the initial position expanded by 3 pixels. (f)–(j) Results at the initial
position displaced by –3 pixels in x-axis. (k)–(o) Results at the initial position
displaced by –3 pixels in y-axis.

where A and B are contours represented as sets of points from
an algorithm and the ground truth, respectively, a and b are
two corresponding points in the contours, and ||·|| represents the
distance between two points.
MSSD is another distance metric aimed to give a statistical
measure of how much the boundaries of different segmentations

Though patients are instructed to hold their breath during
CT scanning, images may still exhibit slight difference at two
phases. To verify that choosing the AP or PP image for initialization were both feasible, different forms of initial contour
placement were conducted. Fig. 5 shows the cosegmentation results of a CECT image pair in which a mass is surrounded by the
liver, kidney, vertebra, and many other tissues. The upper row
denotes the AP images and the bottom row is the PP images. The
automated selected localization radii were 11 pixels (6.55 mm).
(a) and (e) demonstrated the ground truth. An initial ellipse was
created in the AP image in (b) and the cosegmentation results
were given in (c) and (g). Another initial ellipse was created in
the PP image in (f) and the results were given in (d) and (h).
Fig. 5 exhibited that the results of two forms of initialization
were similar and very close to the ground truth. Hence, slight
difference at two phases had little impact to the cosegmentation
results.
Fig. 6 shows representative examples of the segmentation
results at different initial positions of four algorithms. Each
subfigure contains an image pair that has the AP image in the

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

557

Fig. 8. Segmentation results of one case with weak boundaries. (a) and (h) Ground truth. (b) and (i) Same initial contour. (c) and (j) coGRLSM results. (d) and
(k) DRLSE results. (e) and (l) LRLSM_A results. (f) and (m) coLRLSM_C results. (g) and (n) coLRLSM_A results.

Fig. 9. Segmentation results of one case with complex foreground and background. (a) and (h) Ground truth. (b) and (i) Same initial contour. (c) and (j) coGRLSM
results. (d) and (k) DRLSE results. (e) and (l) LRLSM_A results. (f) and (m) coLRLSM_C results. (g) and (n) coLRLSM_A results.

upper row and the PP image in the bottom row. (a)–(e), (f)–(j),
and (k)–(o) were obtained contours at the correct initial position
expanded by 3 pixels and displaced by −3 pixels in x- or y-axes,
respectively. The first column was the ground truth, the second,
third, fourth, and fifth columns were the results of coGRLSM,
DRLSE, LRLSM_A, and coLRLSM_A, respectively. Tables I–
III is the mean and the standard deviation of HD, MSSD, and
DSC at different initial positions in 50 CECT image pairs. From
the aforementioned figures and tables, the proposed method
yielded similar and good segmentation performances in spite of
initial contour expansion or displacements. Compared to other
algorithms, the proposed method demonstrated the lowest distance errors (HD and MSSD) and the highest overlapping ratio
(DSC) and obtained contours closely to the manual expert delineations. Hence, different forms and positions of initialization
had less and limited impacts to the proposed method.

the effectiveness of the proposed adaptive localized energies,
we compared the proposed constant and adaptive methods, i.e.,
coLRLSM_C and coLRLSM_A. The case with different local
regions and mass locations was selected as an example, as shown
in Fig. 7. The localization radii were 9 pixels (6.15 mm). (a) and
(e) depict the ground truth. The superposition of the image pair
was given in (b) to demonstrate the difference. An initial ellipse
was placed in the PP image in (f). (c) and (g) showed that the
contours of the constant method failed to converge to the object
boundaries and stopped by the localized energy from the other
image. Contrarily, the adaptive method performed consistently
well in (d) and (h) since proper weights of the localized energies
adaptively altered with respect to the local density contrast. In
the case having relatively large difference at two phases, the
adaptive method was still able to produce satisfied segmentations and demonstrated more flexibility than the constant one.

B. Constant Versus Adaptive Localized Energies

C. Comparisons Over Other Algorithms

AP and PP images have differences in local density distribution and mass location, as results of contrast medium circulation
and respiratory motion, respectively. Mistaken segmentations
may be obtained if the local information from the other image
was directly used to guide the evolving zero level set. To validate

As examples, two cases of pheochromocytomas with weak
boundaries and complex foreground and background were selected as aforementioned in Fig. 1.
Fig. 8 shows the segmentation results of five algorithms in
the first case having weak and even missing boundaries in the

558

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
MEAN AND THE STANDARD DEVIATION OF HD AT DIFFERENT INITIAL POSITIONS IN 50 IMAGE PAIRS (MM)

coGRLSM
DRLSE
LRLSM_A
coLRLSM_C
coLRLSM_A

Phases

Initial contour

Initial contour displaced by
−3 pixels in x-axis

Initial contour displaced by
−3 pixels in y-axis

Initial contour expanded by
3 pixels

AP
PP
AP
PP
AP
PP
AP
PP
AP
PP

9.64±5.63
10.31±6.84
7.19±3.83
6.73±2.58
5.15±2.36
5.43±2.79
4.03±1.23
4.33±1.44
3.72±1.05
4.15±1.37

10.64±5.94
11.23±6.66
9.21±3.59
8.24±3.44
6.74±4.34
6.60±3.88
4.95±1.47
4.80±1.66
4.47±1.46
4.58±1.66

10.84±6.4
11.26±6.64
11.67±5.93
12.20±4.63
6.82±4.97
7.34±4.98
4.97±1.89
5.15±1.81
4.44±1.94
4.63±2.10

10.24±5.50
11.13±6.31
7.96±4.86
7.42±3.81
9.30±5.87
9.84±6.30
6.01±1.63
5.70±1.86
4.58±1.65
4.50±1.52

TABLE II
MEAN AND THE STANDARD DEVIATION OF MSSD AT DIFFERENT INITIAL POSITIONS IN 50 IMAGE PAIRS (MM2 )

coGRLSM
DRLSE
LRLSM_A
coLRLSM_C
coLRLSM_A

Phases

Initial contour

Initial contour displaced by
−3 pixels in x-axis

Initial contour displaced by
−3 pixels in y-axis

Initial contour expanded by
3 pixels

AP
PP
AP
PP
AP
PP
AP
PP
AP
PP

29.45±42.96
45.25±74.29
9.56±8.93
9.01±6.70
4.03±2.57
5.19±4.72
2.81±1.24
3.38±1.95
2.52±1.09
3.14±2.32

35.52±48.99
49.93±81.93
15.47±11.60
12.46±8.21
7.63±10.44
6.53±7.53
3.76±1.61
3.74±2.17
3.28±1.71
3.65±2.28

35.06±46.45
49.25±74.33
31.39±31.27
31.82±21.62
8.25±14.43
10.29±14.68
4.01±2.75
4.42±2.44
3.61±2.47
4.14±3.49

33.36±45.43
51.26±79.64
12.55±16.54
10.92±11.03
15.72±22.00
17.57±23.37
5.30±2.76
5.17±3.10
3.43±2.34
3.39±1.70

TABLE III
MEAN AND THE STANDARD DEVIATION OF DSC AT DIFFERENT INITIAL POSITIONS IN 50 IMAGE PAIRS (%)

coGRLSM
DRLSE
LRLSM_A
coLRLSM_C
coLRLSM_A

Phases

Initial contour

Initial contour displaced by
−3 pixels in x-axis

Initial contour displaced by
−3 pixels in y-axis

Initial contour expanded by
3 pixels

AP
PP
AP
PP
AP
PP
AP
PP
AP
PP

82.11±14.94
80.29±16.21
88.41±6.99
87.73±9.30
93.42±3.03
92.01±5.74
93.77±3.80
93.13±3.70
94.09±4.21
93.47±3.51

80.66±15.18
78.65±16.32
82.96±11.99
85.62±5.87
92.26±4.57
92.02±4.29
92.92±3.73
92.32±4.19
93.28±3.36
92.84±3.58

80.58±14.81
78.61±15.74
74.42±17.91
74.79±11.15
92.46±3.10
91.50±3.88
92.96±3.45
92.23±4.70
93.06±3.65
92.56±4.52

79.97±13.93
77.41±16.49
86.92±11.58
87.36±8.40
89.84±5.33
89.75±4.42
91.50±3.21
91.40±3.93
93.45±3.21
93.14±3.21

PP image. The localization radii were 13 pixels (8.58 mm) for
the image pair. The upper row denoted the results at AP and the
bottom row was that at PP. (a) and (h) were the ground truth.
The same initial contour for all algorithms was shown in (b)
and (i). In the segmentations of the AP image, coGRLSM was
unable to converge to desired boundaries in (c), and DRLSE was
attracted by the surrounding tissue in (d), whereas LRLSM_A
in (e), coLRLSM_C in (f) and coLRLSM_A in (g) all had satisfied performances. In the results of the PP image, coGRLSM
in (j), DRLSE in (k) and LRLSM_A in (l) failed to different
extents. Especially, coGRLSM produced errors of leakage to

the liver due to the boundary ambiguity. Visually, the contours
of DRLSE and LRLSM_A were relatively close to the mass.
However, the segmentation of LRLSM_A was still not satisfied enough for being trapped into local minima. In contrast,
coLRLSM_C in (m) and coLRLSM_A in (n) achieved more
favorable segmentations. Compared to coLRLSM_C, the final
contour of coLRLSM_A in the AP image was a little closer to the
desired boundaries since the weight of the localized energy from
the other image decreased when segmenting the AP image and
increased when segmenting the PP image. Therefore, in the case
with weak boundaries, the proposed method outperformed the

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

TABLE IV
MEAN TIME COSTS (S) IN 50 IMAGE PAIRS AND THE TIME COMPLEXITY
coGRLSM DRLSE LRLSM_A coLRLSM_C coLRLSM_A
Time cost
Time complexity

17.8
O(n2 )

40.4
O(n2 )

23.3
O(n2 )

22.6
O(n2 )

22.9
O(n2 )

single-image-based algorithms for using complementary information from image pairs, and it also showed better performance
than the global region-based cosegmentation algorithm.
Fig. 9 shows the other case presenting complex foreground
and background in the image pair. The automated localization
radii of the AP and PP image were both 9 pixels (6.45 mm).
The upper row and the bottom row were the results in the
AP image and PP image, respectively. (a) and (h) were the
ground truth. The same initial contour for all test algorithms
was depicted in (b) and (i). In the segmentations of the AP image, coGRLSM in (c) and LRLSM_A in (e) were affected by
the clutter in the upper right of the mass to different extents.
Since the global statistical information was utilized, coGRLSM
failed to converge to object boundaries in the cosegmentation
of the AP–PP image pair. Moreover, DRLSE in (d) and (k) and
LRLSM_A in (e) and (l) were all attracted by the intratumoral
degeneration resulting in segmentation errors. On the contrary,
coLRLSM_C in (f) and (m) and coLRLSM_A in (g) and (n)
were able to eliminate the impact of nearby clutter and intratumoral degeneration by taking advantage of the complementary
local information and the gradient direction. Since the image
pair had little differences in tumor location, coLRLSM_C obtained the good performance similar to coLRLSM_A. Hence,
our proposed method performed consistently well in the case
with complex foreground and background.
From Tables I–III, the proposed coLRLSM_A yielded contours more closely to the manual delineations. The mean HD,
MSSD, and DSC by using coLRLSM_A to the AP and PP images were 3.72 and 4.15 mm, 2.52 and 3.14 mm2 , and 94.09%
and 93.47%, respectively. Small standard deviations of all evaluation metrics attested to its robustness. Therefore, based on the
cosegmentation results of the proposed method, more accurate
and reliable measurements of the mass size and heterogeneity
at AP and PP can be obtained simultaneously.
Table IV shows the mean time costs for 50 image pairs and the
computational time complexities of five test algorithms. Note
that DRLSE, LRLSM_A, and coGRLSM were all implemented
with MATLAB codes provided by the authors. The time costs
for segmenting each image pair were computed. The number
of iterations of our method corresponded to the image size n.
Moreover, the calculation of the localized energies along the
zero level set was also related to n. Hence, our method had
the time complexity proportional to O(n2 ). Table IV indicated
that our algorithms had similar computational cost and time
complexity to others.
VI. DISCUSSION
Our main findings are that the proposed coLRLSM_A performed 1) well in the cases having weak boundaries, 2) well

559

in datasets demonstrating the complex foreground caused by
varied types of intratumoral degeneration, 3) well in images
with the complex background of nearby interfering structures
and clutter, and 4) better than the conventional single-imagebased segmentation (DRLSE and LRLSM_A) and cosegmentation (coGRLSM and coLRLSM_C) algorithms. The findings
were validated by results from various elaborate experiments.
A. Parameter Analysis
Totally two controlling parameters were involved in our
method, the weighted parameters λkl and λks to govern the contributions of the length term and the shape term, respectively.
Higher λkl and λks would have the length term and the shape term
with more impact to the energy function, respectively. More
specifically, the obtained contour would closer to the smooth
and round shape if a higher λkl was used. Two shapes of the
mass from each image pair would have less dissimilarity when
a higher λks was used. Generally, in the experiments as shown in
Figs. 7–9, the parameters λkl = 0.2 and λks = 0.05 were sufficient for the pheochromocytoma cosegmentation in most cases.
In addition, the localization radius r to determine the size of
local regions was automatically approximated and set by our
algorithm based on the initial contour. When attempting to segment small masses with surrounding clutter, small localization
radii were used; otherwise, larger radii were employed. As examples, the localization radii were 9 pixels (6.45 mm) in Fig. 9
to segment the pheochromocytoma with nearby clutter, whereas
13 pixels (8.58 mm) in Fig. 8 to handle the larger mass having
homogeneous neighbors.
B. Constant Versus Adaptive Localized Energies
Adaptive localized energies from the image pair were considered and utilized with respect to the contrast of local regions. Compared to the constant localized energies, the adaptive method was more flexible to handle both weak and distinct
boundaries. In the cases with weak boundaries, the method increased the weight of the localized energy from the other image
to guide the evolution of the segmenting zero level set without
being trapped into local minima. In the cases having distinct
boundaries, the localized energy from the image being segmented was able to drive the zero level set to converge to the
object boundaries. As a result, the weight of the localized energy from the other image decreased. The constant model was
capable to utilize the complementary image data of each image
pair, whereas it was clumsy when image pairs exhibited relatively severe misalignment, especially in the cases dominated
by the respiratory motion. As shown in Figs. 7–9, and Tables
I–III, the cosegmentation method with constant localized energies was not flexible and robust enough and had less impressive
segmentations compared with the adaptive method.
C. Single-Image-Based LSMs Versus Our Method
Two conventional single-image-based segmentation algorithms, DRLSE and LRLSM_A, were compared in the
experiments. As shown in Fig. 8(d), (k) and Fig. 9(d), (k),
the edge-based method DRLSE was likely to evolve contours

560

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

at boundaries with strong gradients. The local region-based
method LRLSM_A was better to segment inhomogeneous objects but lacked strength in cases with weak boundaries as well
as the intratumoral degeneration and nearby clutter as depicted
in Fig. 8(e), (l) and Fig. 9(e), (l). In contrast, our method introduced a novel cosegmentation framework. To utilize the complementary information from image pairs, the proposed algorithm
adaptively exploited local statistics of different density distributions. Further, two LSFs of each image pair were evolved
and refined alternately under the constraint of the shape term
along the process. As a consequence, it produced better segmentations as shown in Fig. 8(g), (n) and Fig. 9(g), (n). Tables I
and II indicted lower distance errors (HD and MSSD) of our
method. Although, Table III had relatively close mean DSC of
DRLSE and LRLSM_A, our proposed method still had more
accurate and robust segmentations especially in the challenging
cases including weak boundaries and complex foreground and
background.
D. Cosegmentation RLSMs Versus Our Method
The comparison with one typical cosegmentation method,
coGRLSM, was carried out in the experiments. coGRLSM analyzed global image information that was more robust against
poor initialization that local methods. However, it was prone to
boundary leakage in the cases with weak boundaries as shown
in Fig. 8(j) and Fig. 9(c) and (j). Besides, the coGRLSM considered the foreground similarity with respect to density, which was
inconsistent for pheochromocytomas in AP–PP image pairs. As
shown in Tables I–III, coGRLSM produced unfavorable performances in terms of accuracy and robustness. On the contrary,
our method took advantage of the localized region-based information of image pairs. It had superior performances in the
cases of weak boundaries but also density inhomogeneity. The
proposed algorithm gained much more satisfied results, which
attributed to the adaptive use of the localized information of image pairs. The gradient direction term was integrated to control
the evolution direction of the zero level set to further improve
the segmentations.
E. Efficiency
The efficiency and minimum operator interaction were highly
valued in clinical practice. Our method merely required the user
to set three points to define an ellipse as the initial contour. The
initialization method is simple and feasible and highly reduces
the manual labor for physicians. Afterwards, there was no operator interaction for the cosegmentation in image pairs. The
experiments in Tables I–III with different initial positions indicated that the results would not be affected even if the operator
placed three points with small deviations. Besides, we have introduced a convergence test, which stopped the iteration process
once the desired contours have been obtained. Table IV showed
that our method had similar time cost and computational time
complexity with the compared algorithms despite localized information and adaptive energies were utilized. Therefore, with
the highest accuracy, the proposed method practically governed
the tradeoff between the accuracy and the efficiency.

VII. CONCLUSION
In this paper, we have proposed a novel adaptive LRLSMbased method to the pheochromocytoma cosegmentation in
CECT image pairs. The energy function is formulated by adaptive combination of the localized energies from image pairs.
Gradient direction, shape dissimilarity measure, and automated
localization radius selection are integrated to further facilitate
the segmentation. Then, two LSFs are evolved and refined alternately through a mutual procedure to achieve the energy function
minimization. Experimental results in 50 image pairs out of 12
patients validated the accuracy and effectiveness of our method.
By taking advantage of the local-region-based complementary
information from image pairs, the proposed method performed
consistently well in the cases with weak boundaries and complex
foreground and background.
In clinical practice, accurate manual segmentation and measurements of pheochromocytomas rely on referencing of relevant image data from multiple phases and also adjacent slices.
Improvements will be the use of information from image
sequences or volumes, such as 3-D pheochromocytoma segmentation. Automatic detection and segmentation of pheochromocytomas will further elevate the efficiency. Based on the
proposed cosegmentation method, future work will be extension to applications of other tumors at different phases.
REFERENCES
[1] J. W. Lenders, G. Eisenhofer, M. Mannelli, and K. Pacak, “Phaeochromocytoma,” Lancet, vol. 366, no. 9486, pp. 665–675, Aug. 2005.
[2] A. Tsirlin, Y. Oo, R. Sharma, A. Kansara, A. Gliwa, and M. A. Banerji,
“Pheochromocytoma: A review,” Maturitas, vol. 77, no. 3, pp. 229–238,
Mar. 2014.
[3] K. Leung, M. Stamm, A. Raja, and G. Low, “Pheochromocytoma: The
range of appearances on ultrasound, CT, MRI, and functional imaging,”
Amer. J. Roentgenol., vol. 200, no. 2, pp. 370–378, 2013.
[4] M. A. Blake, S. K. Krishnamoorthy, G. W. Boland, A. T. Sweeney,
M. B. Pitman, M. Harisinghani, P. R. Mueller, and P. F. Hahn, “Lowdensity pheochromocytoma on CT: A mimicker of adrenal adenoma,”
Amer. J. Roentgenol., vol. 181, no. 6, pp. 1663–1668, Dec. 2003.
[5] A. M. Halefoglu, N. Bas, A. Yasar, and M. Basak, “Differentiation
of adrenal adenomas from nonadenomas using CT histogram analysis
method: A prospective study,” Eur. J. Radiol., vol. 73, no. 3, pp. 643–651,
Mar. 2010.
[6] D. H. Szolar, M. Korobkin, P. Reittner, A. Berghold, T. Bauernhofer,
H. Trummer, H. Schoellnast, K. W. Preidler, and H. Samonigg, “Adrenocortical carcinomas and adrenal pheochromocytomas: Mass and enhancement loss evaluation at delayed contrast-enhanced CT,” Radiology,
vol. 234, no. 2, pp. 479–485, Feb. 2005.
[7] G. A. Motta-Ramirez, E. M. Remer, B. R. Herts, I. S. Gill, and
A. H. Hamrahian, “Comparison of CT findings in symptomatic and incidentally discovered pheochromocytomas,” Amer. J. Roentgenol., vol. 185,
no. 3, pp. 684–688, Sep. 2005.
[8] J. Patel, M. S. Davenport, R. H. Cohan, and E. M. Caoili, “Can established CT attenuation and washout criteria for adrenal adenoma accurately exclude pheochromocytoma?” Amer. J. Roentgenol., vol. 201, no. 1,
pp. 122–127, Jul. 2013.
[9] R. Beichel, A. Bornik, C. Bauer, and E. Sorantin, “Liver segmentation in
contrast enhanced CT data using graph cuts and interactive 3D segmentation refinement methods,” Med. Phys., vol. 39, no. 3, pp. 1361–1373,
2012.
[10] M. G. Linguraru, W. J. Richbourg, J. Liu, J. M. Watt, V. Pamulapati,
S. Wang, and R. M. Summers, “Tumor burden analysis on computed
tomography by automated liver and tumor segmentation,” IEEE Trans.
Med. Imag., vol. 31, no. 10, pp. 1965–1976, Oct. 2012.
[11] M. Freiman, O. Cooper, D. Lischinski, and L. Joskowicz, “Liver tumors segmentation from CTA images using voxels classification and

TANG et al.: ADAPTIVE COSEGMENTATION OF PHEOCHROMOCYTOMAS IN CECT IMAGES USING LOCALIZED LEVEL SET MODELS

[12]

[13]

[14]
[15]
[16]
[17]
[18]
[19]
[20]
[21]
[22]
[23]
[24]
[25]
[26]

[27]
[28]
[29]

[30]

[31]

[32]

[33]
[34]

affinity constraint propagation,” Int. J. Comput. Assist. Radiol. Surg., vol.
6, no. 2, pp. 247–255, Mar. 2011.
F. Zhang, Y. Song, W. Cai, M. Lee, Y. Zhou, H. Huang, S. Shan,
M. J. Fulham, and D. D. Feng, “Lung nodule classification with multilevel patch-based context analysis,” IEEE Trans. Biomed. Eng., vol. 61,
no. 4, pp. 1155–1166, Apr. 2014.
M. Keshani, Z. Azimifar, F. Tajeripour, and R. Boostani, “Lung nodule
segmentation and recognition using SVM classifier and active contour
modeling: A complete intelligent system,” Comput. Biol. Med., vol. 43,
no. 4, pp. 287–300, May 2013.
S. Osher and J. A. Sethian, “Fronts propagating with curvature-dependent
speed: Algorithms based on Hamilton-Jacobi formulations,” J. Comput.
Phys., vol. 79, no. 1, pp. 12–49, Nov. 1988.
R. Tsai and S. Osher, “Level set methods and their applications in image
science,” Commun. Math. Sci., vol. 1, no. 4, pp. 1–20, Nov. 2003.
M. Kass, A. Witkin, and D. Terzopoulos, “Snakes: Active contour models,”
Int. J. Comput. Vis., vol. 1, no. 4, pp. 321–331, Jan. 1988.
V. Caselles, R. Kimmel, and G. Sapiro, “Geodesic active contours,” Int. J.
Comput. Vis., vol. 22, no. 1, pp. 61–79, Feb. 1997.
N. Paragios and R. Deriche, “Geodesic active contours and level sets for
the detection and tracking of moving objects,” IEEE Trans. Pattern Anal.
Mach. Intell., vol. 22, no. 3, pp. 266–280, Mar. 2000.
C. Li, C. Xu, C. Gui, and M. D. Fox, “Distance regularized level set
evolution and its application to image segmentation,” IEEE Trans. Image
Process., vol. 19, no. 12, pp. 3243–3254, Dec. 2010.
D. Mumford and J. Shah, “Optimal approximations by piecewise smooth
functions and associated variational problems,” Commun. Pure Appl.
Math., vol. 42, no. 5, pp. 577–685, Jul. 1989.
T. F. Chan and L. A. Vese, “Active contours without edges,” IEEE Trans.
Image Process., vol. 10, no. 2, pp. 266–277, Feb. 2001.
C. Li, C. Y. Kao, J. C. Gore, and Z. Ding, “Implicit active contours driven
by local binary fitting energy,” Proc. IEEE Conf. Comput. Vis. Pattern
Recog., Jun. 2007, pp. 1–7.
S. Lankton and A. Tannenbaum, “Localizing region-based active contours,” IEEE Trans. Image Process., vol. 17, no. 11, pp. 2029–2039, Nov.
2008.
K. Zhang, H. Song, and L. Zhang, “Active contours driven by local image
fitting energy,” Pattern Recogn., vol. 43, no. 4, pp. 1199–1206, Apr. 2010.
B. N. Li, C. K. Chui, S. Chang, and S. H. Ong, “A new unified level set
method for semi-automatic liver tumor segmentation on contrast-enhanced
CT images,” Expert Syst. Appl., vol. 39, no. 10, pp. 9661–9668, Aug. 2012.
C. Li, X. Wang, S. Eberl, M. Fulham, Y. Yin, J. Chen, and D. Feng, “A
likelihood and local constraint level set model for liver tumor segmentation from CT volumes,” IEEE Trans. Biomed. Eng., vol. 20, no. 10,
pp. 2967–2977, Sep. 2013.
A. A. Farag, H. E. A. El Munim, J. H. Graham, and A. A. Farag, “A novel
approach for lung nodules segmentation in chest CT using level sets,”
IEEE Trans. Image Process., vol. 22, no. 12, pp. 5202–5213, Dec. 2013.
L. Massoptier and S. Casciaro, “A new fully automatic and robust algorithm for fast segmentation of liver tissue and tumors from CT scans,” Eur.
Radiol., vol. 18, no. 8, pp. 1658–1665, Aug. 2008.
P. R. Bai, Q. Y. Liu, L. Li, S. H. Teng, J. Li, and M. Y. Cao, “A novel
region-based level set method initialized with mean shift clustering for
automated medical image segmentation,” Comput. Biol. Med., vol. 43,
no. 11, pp. 1827–1832, Nov. 2013.
W. Fang, K. L. Chan, S. Fu, and S. M. Krishnan, “Incorporating temporal information into level set functional for robust ventricular boundary
detection from echocardiographic image sequence,” IEEE Trans. Biomed.
Eng., vol. 55, no. 1, pp. 2548–2556, Nov. 2013.
B. N. Li, C. K. Chui, S. H. Ong, T. Numano, T. Washio, K. Homma,
S. Chang, S. Venkatesh, and E. Kobayashi, “Modeling shear modulus
distribution in magnetic resonance elastography with piecewise constant
level sets,” Magn. Resonance Imag., vol. 30, no. 3, pp. 390–401, 2012.
R. Prevost, R. Cuingnet, B. Mory, J. Correas, L. D. Cohen, and R. Ardon, “Joint co-segmentation and registration of 3D ultrasound image,” in
Information Processing in Medical Imaging (Lecture Notes in Computer
Science ), vol. 7917. Berlin, Germany: Springer, 2013, pp. 268–279.
A. Yezzi, L. Zollei, and T. Kapur, “A variational framework for joint
segmentation and registration,” in Proc. IEEE Math. Methods Biomed.
Image Anal., Dec. 2001, pp. 44–51.
U. Bagci, J. K. Udupa, N. Mendhiratta, B. Foster, Z. Xu, J. Yao,
X. Chen, and D. J. Mollura, “Joint segmentation of anatomical and functional images: Applications in quantification of lesions from PET, PET-CT,
MRI-PET, and MRI-PET-CT images,” Med. Image Anal., vol. 17, no. 8,
pp. 929–945, Dec. 2013.

561

[35] D. Han, J. Bayouth, Q. Song, A. Taurani, M. Sonka1, J. Buatti, and
X. Wu, “Globally optimal tumor segmentation in PET-CT images: A
graph-Based co-segmentation method,” in Information Processing in Medical Imaging (Lecture Notes in Computer Science ), vol. 6801. Berlin,
Germany: Springer, 2011, pp. 245–256.
[36] Q. Song, J. Bai, D. Han, S. Bhatia, W. Sun, W. Rockey, J. Bayouth,
J. Buatti, and X. Wu, “Optimal co-segmentation of tumor in PET-CT
images with context information,” IEEE Trans. Med. Imag., vol. 32, no.
9, pp. 1685–1697, Sep. 2013.
[37] T. Riklin-Raviv, N. Sochen, and N. Kiryati, “Shape-based mutual segmentation,” Int. J. Comput. Vis., vol. 79, no. 3, pp. 231–245, Sep. 2008.
[38] L. Zhang and Z. Liu, “Image cosegmentation based on local and global
level set methods,” Int. J. Image Graph., vol. 12, no. 3, Jul. 2012.
[39] F. Meng, H. Li, G. Liu, and K. N. Ngan, “Image cosegmentation by incorporating color reward strategy and active contour model,” IEEE Trans.
Cybern., vol. 43, no. 2, pp. 725–737, Apr. 2013.
[40] Y. Yu, C. Zhang, Y. Wei, and X. Li, “Active contour method combining
local fitting energy and global fitting energy dynamically,” in Medical Biometrics (Lecture Notes in Computer Science), vol. 6165. Berlin, Germany:
Springer, 2010, pp. 163–172.
[41] L. Liu, Q. Zhang, M. Wu, W. Li, and F. Shang, “Adaptive segmentation of
magnetic resonance images with intensity inhomogeneity using level set
method,” Magn. Reson. Imag., vol. 31, no. 4, pp. 567–574, May 2013.
[42] H. Gao and O. Chae, “Individual tooth segmentation from CT images
using level set method with shape and intensity prior,” Pattern Recogn.,
vol. 43, no. 7, pp. 2406–2417, Jul. 2010.
[43] W. Aitfares, E. H. Bouyakhf, F. Regragui, A. Herbulot, and M. Devy, “A
robust region-based active contour for object segmentation in heterogeneous case,” Pattern Recogn. Image Anal., vol. 24, no. 1, pp. 24–35, Jan.
2014.

San Tang received the B.Sc. degree in electronic engineering from Fudan University, Shanghai, China,
in 2012, where he is currently working toward the
M.Sc. degree in electronic engineering.
His research interests include medical image processing and analysis.

Yi Guo received the B.Sc. degrees in electronic engineering, and the M.Sc. and Ph.D. degrees in biomedical engineering from Fudan University, Shanghai,
China, in 2013.
She is currently a Lecturer in the Department of
Electronic Engineering, Fudan University. Her research interests include medical signal and image
processing.

Yuanyuan Wang (M’99–SM’03) received the B.Sc.,
M.Sc., and Ph.D. degrees in electronic engineering
from Fudan University, Shanghai, China, in 1990,
1992, and 1994, respectively.
From 1994 to 1996, he was a Postdoctoral Research Fellow with the School of Electronic Engineering and Computer Science, University of Wales,
Bangor, U.K. In May 1996, he went back to Department of Electronic Engineering, Fudan University,
as an Associate Professor. He was then promoted to
a Full Professor in May, 1998. He is currently the
Director of Information Science and Engineering School and the Director of
Biomedical Engineering Center at Fudan University. He is also the author or
coauthor of 6 books and 430 research papers. His research interests include
medical ultrasound techniques and medical signal processing.

562

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Wanli Cao received the B.Sc. degree in medicine
from Zhengzhou University, Henan, China, in 2012.
He is currently working toward the M.Sc. degree in
Ruijin Hospital, School of Medicine, Shanghai Jiaotong University, Shanghai, China.
His research interests include adrenal gland
surgery and various imaging characteristics of
adrenal lesions.

Fukang Sun received the B.Sc., M.Sc., and Ph.D.
degrees in medicine from the School of Medicine,
Shanghai Jiaotong University, Shanghai, China.
He is currently a Surgical Specialist and an Associate Professor of urology, Ruijin Hospital, School
of Medicine, Shanghai Jiaotong University. His research interests include adrenal gland surgery and
various imaging characteristics of adrenal lesions.

