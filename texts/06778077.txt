IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

2057

A Robust Algorithm for Thickness Computation at
Low Resolution and Its Application to In Vivo
Trabecular Bone CT Imaging
Yinxiao Liu, Dakai Jin, Cheng Li, Kathleen F. Janz, Trudy L. Burns, James C. Torner, Steven M. Levy,
and Punam K. Saha∗ , Senior Member, IEEE

Abstract—Adult bone diseases, especially osteoporosis, lead to
increased risk of fracture which in turn is associated with substantial morbidity, mortality, and financial costs. Clinically, osteoporosis is defined by low bone mineral density; however, increasing
evidence suggests that the microarchitectural quality of trabecular bone (TB) is an important determinant of bone strength and
fracture risk. Accurate measures of TB thickness and marrow
spacing is of significant interest for early diagnosis of osteoporosis
or treatment effects. Here, we present a new robust algorithm for
computing TB thickness and marrow spacing at a low resolution
achievable in vivo. The method uses a star-line tracing technique
that effectively deals with partial voluming effects of in vivo imaging with voxel size comparable to TB thickness. Also, the method
avoids the problem of digitization associated with conventional algorithms based on sampling distance transform along skeletons.
Accuracy of the method was examined using computer-generated
phantom images, while the robustness of the method was evaluated on human ankle specimens in terms of stability across a wide
range of voxel sizes, repeat scan reproducibility under in vivo conditions, and correlation between thickness values computed at ex
vivo and in vivo imaging resolutions. Also, the sensitivity of the
method was examined by evaluating its ability to predict the bone
strength of cadaveric specimens. Finally, the method was evaluated
in a human study involving 40 healthy young-adult volunteers (age:
19–21 years; 20 males and 20 females) and ten athletes (age: 19–
21 years; six males and four females). Across a wide range of voxel
sizes, the new method is significantly more accurate and robust as
compared to conventional methods. Both TB thickness and marrow
spacing measures computed using the new method demonstrated
strong associations (R2 ∈ [0.83, 0.87]) with bone strength.
Also, the TB thickness and marrow spacing measures allowed

Manuscript received May 17, 2013; revised February 21, 2014; accepted
March 15, 2014. Date of publication March 25, 2014; date of current version
June 14, 2014. This work was supported by the National Institutes of Health
under Grant R01-AR054439 and Grant R01-DE012101. Asterisk indicate corresponding author.
Y. Liu, D. Jin, and C. Li are with the Department of Electrical and Computer Engineering, University of Iowa, Iowa City, IA 52242 USA (e-mail:
yinxiao-liu@uiowa.edu; dakai-jin@uiowa.edu; cheng-li@uiowa.edu).
K. F. Janz is with the Department of Health and Human Physiology, University of Iowa, Iowa City, IA 52242 USA (e-mail: kathleen-janz@uiowa.edu).
T. L. Burns and J. C. Torner are with the Department of Epidemiology, University of Iowa, Iowa City, IA 52242 USA (e-mail: trudy-burns@uiowa.edu;
james-torner@uiowa.edu).
S. M. Levy is with the Department of Preventive and Community Dentistry and the Department of Epidemiology, University of Iowa, IA 52242 USA
(e-mail: steven-levy@uiowa.edu).
∗ P. K. Saha is with the Department of Electrical and Computer Engineering
and the Department of Radiology, University of Iowa, Iowa City, IA 52242 USA
(e-mail: pksaha@engineering.uiowa.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2313564

discrimination between male and female volunteers (p ∈
[0.01, 0.04]) as well as between athletes and nonathletes (p ∈
[0.005, 0.03]).
Index Terms—Bone biomechanics, marrow spacing, multirow
detector computed tomography (CT), star-line tracing, trabecular
bone (TB) thickness.

I. INTRODUCTION
DULT bone diseases, especially osteoporosis, lead to increased risk of fracture associated with substantial morbidity, mortality, and financial costs [1]. Approximately, 30%
of postmenopausal white women in the U.S. suffer from osteoporosis [2] and the prevalence in Europe and Asia is similar.
Clinically, osteoporosis is defined by low bone mineral density (BMD) [1]. However, increasing evidence suggests that
microarchitectural quality of trabecular bone (TB) is an important determinant of bone strength and fracture risk [3]–[11].
Trabecular (or spongy) bone forms a dense network of bone
plates and rods and it dominates in the vertebrae and at locations near the joints of long bones (metaphysis and epiphysis).
Bone atrophy as it occurs in osteoporosis leads to either homogeneous or heterogeneous thinning of the trabecular elements.
Besides changes in TB network connectivity and topology, TB
thickness and marrow spacing between trabeculae play critical
roles in determining the mechanical competence of bone and
thus resistance to osteoporotic fractures [10]. Chung et al. [12]
performed an experiment on 22 cadaveric specimens of lumbar vertebrae. They found that, with similar trabecular plate
density, the specimens with lower mean trabecular thickness
showed low bone strength, indicating the relationship between
TB thickness and strength. Kleerekoper et al. [5] observed a correlation between TB strength and plate thickness. In a histologic
study involving 78 normal subjects, 100 patients with vertebral
fracture, and 50 patients with hip fracture, Parfitt et al. [11]
observed reduced TB thickness in the fracture group as compared to the normal subjects. Several studies have revealed the
relationship between aging and TB thickness. In a histologic
study of lumbar vertebral specimens from 23 normal individuals, Mosekilde [13] observed that aging is associated with a
steady decrease in mean thickness in horizontal trabeculae and a
threefold increase in horizontal marrow spacing. In a cadaveric
forearm study (N = 21), Spadaro et al. [14] observed that both
cortical and TB thickness are correlated with mechanical bone
strength.

A

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2058

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

The classical approach of measuring trabecular thickness is
based on histomorphometry of transiliac bone biopsies [15]. The
emergence of imaging technologies such as micro-computed tomography (μ-CT) [16] enables reconstruction of high-resolution
3-D images calling for more elaborate techniques for computing
TB thickness. Recently, in vivo imaging techniques including
magnetic resonance imaging (MRI) [17], [18], high-resolution
peripheral quantitative CT (HR-pQCT) [19]–[21], and multirow detector CT (MD-CT) [22]–[24] have emerged as promising modalities for high-quality TB imaging at peripheral sites
that avoid the problems of invasive bone biopsies. Therefore,
an accurate and robust algorithm for computing TB thickness
and marrow spacing that is applicable to in vivo imaging would
be useful as an effective indicator of quantitative bone quality for clinical trials designed to evaluate fracture risks under
different clinical conditions. Here, we present such an algorithm and evaluate its accuracy, robustness, and sensitivity to
bone strength. Although, in this paper, the method is applied
and evaluated on MD-CT imaging, it may be adapted for other
in vivo 3-D imaging modalities including MRI and HR-pQCT.
Also, the method may be applicable to other in vivo medical
imaging applications such as pulmonary airway wall [25] and
vascular thickness [26], [27].
Several methods for computing TB thickness and marrow
spacing have been reported [28]–[32]. Following Hildebrand
and Räegsegger [28], thickness at a given point is the diameter
of the largest inscribed sphere containing that point. A discrete
implementation of this definition using chamfer distances was
presented in [32]. The star-volume [30], [31] algorithm has
been applied to compute TB marrow spacing. Essentially, it
determines the object volume seen unobscured from a given
point and, finally, computes the average of this measure over a
target volume. This approach is well suited for high-resolution
images that can easily be segmented. However, it is bound to fail
when significant partial voluming is presented in a target object.
Saha and Wehrli [29] overcame this issue of partial voluming
in TB thickness computation at low resolution by introducing
the use of the fuzzy distance transform (FDT). However, this
method fails to fully account for digitization errors in local
thickness computation.
Here, we introduce a star-line-based algorithm for an accurate
and robust measure of TB thickness and marrow spacing at in
vivo resolution in the presence of significant partial voluming.
Accuracy of the method was examined on computer-generated
phantoms. Robustness of the method was evaluated on human
specimens in terms of stability across a wide range of voxel
sizes, repeat scan reproducibility under in vivo conditions, and
correlation between thickness values computed at ex vivo and
in vivo imaging resolutions. Also, the sensitivity of the method
was examined by its ability to predict bone strength of cadaveric
specimens. Finally, the method was evaluated in a sample of
young adult volunteers with tibial scans.
II. THEORY AND ALGORITHMS
The new method for thickness computation of the fuzzy digital objects interprets fuzzy membership value at a given image

voxel as the partial occupancy of the object or the local object
material density. Although, the method is designed for fuzzy
digital objects at low resolution, its premise is built on objects
in the continuous space. First, we establish a definition of “local
thickness” in the continuous space, and then, we describe an
effective algorithm for digital objects.
A. Definition of Local Thickness
Let R3 denote the continuous 3-D space and let O ⊂ R3 be an
object. A ball B ⊂ O is a maximally included ball (MIB) in O,
if there exists no other ball B  ⊂ O that contains B. Obviously,
at a given point p ∈ O, the local thickness should be related
to the diameters of the MIBs containing p [28]. However, the
challenge emerges from the fact that a point p is contained by
multiple MIBs and the question is which specific MIB should be
used to define the thickness at p. First, consider the axial points
of O. A point a ∈ O is an axial point in O if and only if there is
a MIB in O whose center is a. Following the fact that the MIB
BO (a) centered at an axial point a is unique and symmetrically
defines the extent of the local structure on both sides of the
axis, BO (a) is the natural choice for defining the thickness at a.
Therefore, a proper choice of local thickness should satisfy the
following property:
Property 1: For any object O ⊂ R3 and any axial point a ∈ O,
the thickness of O at a is the length of the diameter of the unique
MIB BO (a) centered at a.
Property 1 is important as it provides the necessary and sufficient condition for reconstruction of an object from its thickness
distribution at axial points. Now, let us examine different possible options of defining local thickness at a nonaxial point
p ∈ O; let MO (p) denote the set of all MIBs in O containing p.
Hildebrand and Rüegsegger [28] used the largest ball in MO (p)
to define the thickness at p which was further studied by Moreno
et al. [34]. Another variation of this choice is to select the diameter of the smallest ball in MO (p). We will refer to these options
as the largest and smallest MIB options. Both of these options
fail to satisfy Property 1 as illustrated in Fig. 1(a) and (b). Also,
we examine the behavior of these options for an object formed
by two overlapping disks of different scales and the results are
shown in Fig. 2 (a) and (b). The largest MIB option shows thickness bias toward the larger disk, while the smallest MIB option
picks the same artifact, but in the opposite direction. Thus, both
the largest and the smallest MIB options suffer from serious
drawbacks. Here, we introduce the idea of selecting the MIB
for thickness definition at a given point p based on the distance
between p and the center or the circumference of a MIB.
Liu et al. [35] defined the thickness at the given point p as
the diameter of the MIB in MO (p) whose center is closest
to p. Although the method satisfies Property 1 [see Fig. 1(c)],
its performance for two intersecting balls is seriously flawed
[see Fig. 2(c)]. Here, we propose the following definition of
thickness which satisfies Property 1 [see Fig. 1(d)] and produces
an unbiased thickness distribution for two overlapping balls of
different scales [see Fig. 2(d)].
Definition 1: For any object O ⊂ R3 and any point p ∈ O,
the thickness of O at p, denoted as τO (p), is the length of the

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

Fig. 1. Comparison among different definitions of thickness in terms of satisfying Property 1. The color bar is added where the thickness values are shown in
millimeter units. (a) Local thickness distribution on an ellipse using the largest
MIB option except that the intensity at an axial point is enforced as the diameter
of the MIB centered at that point. (b)–(d) Same as (a) but using the options
of smallest MIB (b), nearest MIB center (c), and farthest MIB circumference
(d). Axial lines are partially visible in (a) and (b) confirming the failure of the
first two thickness options to satisfy Property 1. The axial lines in (c) and (d)
are not visible indicating that both the nearest MIB center and the farthest MIB
circumference options satisfy Property 1.

Fig. 2. Comparison among different definitions of thickness in terms of their
performance for two overlapping disks of different scales. Disk boundaries are
shown by dotted lines. (a) Local thickness distribution using the largest MIB
option. Here, the thickness of the larger ball gets higher preference and it enters
inside the smaller ball. (b) Same as (a) but for the smallest MIB option; here,
the artifact is opposite to that of (a). (c) Same as (a) but using the MIB with the
nearest center. The failure of this option is obvious. (d) Same as (a) but using the
MIB with the farthest circumference. A major advantage of this option is that
it impartially divides the intersecting regions between the two balls eliminating
bias artifacts.

diameter of the MIB in MO (p), whose circumference is farthest
from p.
It can be shown that, for any object O ⊂ R3 and a point
p ∈ O, the MIB in MO (p) whose circumference is farthest is
unique. Therefore, Definition 1 produces a unique thickness
distribution for any object.
B. Thickness Computation for Fuzzy Digital Objects
The proposed thickness computation algorithm for fuzzy digital objects is summarized in three steps:
Step 1: Computation of the surface skeleton A of a fuzzy digital
object O.
Step 2: Computation of thickness τO (a) at all the axial voxels
a ∈ A.

2059

Step 3: Inheritance of thickness τO (p) at all the nonskeletal
voxels p ∈ O − A following Definition 1.
Step 1 is accomplished using the surface skeletonization algorithm [38] that is applied on the support of the target fuzzy
object. We will use A to denote the set of axial voxels or the
skeleton of an object. In conventional algorithms [28], [29], local thickness at an axial voxel is determined by sampling the
distance transform (DT) [37] at that voxel. Such methods work
fine when the relative image resolution is high, but its performance may be suboptimal when image resolution is comparable
to object thickness. This effect is reduced by using the FDT [29]
instead of the binary DT.
Here, a brief outline of the FDT-based local thickness computation method [29] is presented. Let O = {(p, fO (p)|p ∈ Z 3 }
be a fuzzy digital object; fO : Z 3 → [0, 1] be the membership
function; O = {p|fO (p) = 0} be the support; and Ō = Z 3 − O
be the background. Let FDT(p) denote the fuzzy distance of
a voxel p ∈ O from the background Ō. FDT(p) provides the
depth measure of a voxel p in a fuzzy object. The principle of
the FDT-based thickness computation is to sample depth values at axial voxels. It uses binary skeletonization [38]–[40] to
compute the set A of axial voxels. FDT-based mean thickness
THFDT (O) is computed as the average of twice the FDT values
at axial voxels, i.e.,

p∈S k (O ) 2 × FDT(p)
THFDT (O) =
(1)
|A|
where | · | is the voxel count in a set.
The above method of thickness computation suffers from
a random negative error caused by digitization of axial voxels.√The magnitude of this error is bounded by the interval
[0, 23 Δ], where Δ is the voxel size. Saha and Wehrli [29]
(see [29, Fig. 1]) proposed a voxel size-dependent global compensation factor, which was derived under several assumptions
on structural anisotropy. However, it is difficult to correct local thickness measures at the voxel level using this approach.
Further, it makes several assumptions on structural anisotropy
which may not be universally applicable. Therefore, it is of
paramount interest to develop a method that avoids digitization
errors while computing thickness at individual axial voxels.
Here, an intercept-based algorithm is introduced for computing thickness at axial voxels that overcomes the digitization
error. Let us consider a voxel p ∈ O in a fuzzy object O; an
intercept of O at p along a direction (polar: θ, azimuth: φ) is
the membership-weighted length of the straight line segment
lθ ,φ (p, O) passing through p with the two ends coinciding with
the boundary of O. It should be noted that, for a voxel 
p ∈ O,
there can be many intercepts of O passing through p. Let O (p)
denote the set of all possible intercepts of O that pass through
p. The thickness measure τO (a) at an axial voxel a is approximately equal to the length of the shortest intercept of O passing
through a, i.e.,
π(l)
τO (a) = min

l∈

O (a)

(2)

where π(l) denotes the intercept length of l. The above equation offers a new algorithm for thickness computation at

2060

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 3. Advantages of intercept-based thickness computation in reducing digitization errors as compared to the FDT-based method.

axial voxels. Major advantages of this approach are that 1) the
minimum-intercept length measure is highly robust under small
random shifts of axial voxels, and 2) partial voluming effects
are efficiently handled during intercept length computation.
Here, we analytically discuss the relevance of the digitization error in the FDT-based and the new thickness computation methods. The FDT-based approach assumes that an axial
voxel where the FDT value is sampled coincides with the true
axis of the object and any difference between the two directly
contributes to thickness error. In case of the intercept-based approach, the true axis of an object always orthogonally intersects
a minimum intercept line. Therefore, even when an axial voxel
deviates from the true axis, the error caused by the intercept approach is minimized. To further explain, let us consider a simple
2-D example of Fig. 3. Consider the material density values at
different object pixels as 0.30 (dark gray), 0.70 (light gray), and
1.0 (white). Clearly, the thickness values for the structures in (a)
and (b) are 4 and 5 pixels, respectively. For both the FDT-based
and the proposed methods, thickness values are sampled at axial
pixels. For (a), the axial voxels form a digital line along one of
the two rows of white pixels, say, the upper row as marked by
dots. Consider the skeletal pixel where star-lines are drawn. The
FDT-based method will assign a thickness value of 3 pixels.
Now consider the new intercept-based approach. Although the
sample pixel fails to coincide with the true axis, the minimum
intercept line (bold) produces the correct thickness value as the
true axis transects the minimum intercept. Finally, this behavior of the FDT-based method is not consistent; for example, it
produces the correct thickness value for the structure of (b), and
therefore, a uniform compensation may not work to correct for
this digitization error. These claims are thoroughly examined
and the experimental results are presented in Section IV. Here,
it is worth mentioning that, for any compact object in R2 or R3 ,
a minimum intercept line always passes through a unique axial point as it orthogonally intersects the medial axis. However,
such a claim may not be made for a digital object and it may
be possible to construct an example where a minimum intercept
line passes through multiple axial voxels.

Fig. 4. Illustration of star-line-based TB thickness computation in twodimensions. The candidate voxel (black dot), star-lines (dot), edge locations
(hollow dots), and shortest intercept (solid line) in TB thickness computation
are shown.

The star-line-based thickness computation algorithm (see
Fig. 4) determines the term minl∈ O( a ) π(l) at axial voxels. It
locally traces an object along m pairs of mutually opposite sample lines emanating from an axial voxel a (black dot in Fig. 4).
These sample lines are selected at a pseudouniform distribution
over the entire 3-D angular space [33]. A parameter ψ is used
to define the angular separation between neighboring sample
lines. The optimum value of ψ was experimentally determined
and used for all experiments (see Section III). A sample line
along a direction 	θ, φ
 is represented as a sequence of points
viθ φ = i × δ × iθ φ , for i = 0, 1, 2, . . ., where iθ φ is a unit vector
along direction 	θ, φ
; the opposite sample line is represented
by a sequence of points i × δ × iθ φ , for i = 0, −1, −2, . . .. Following the arguments by Saha [33] on the basis of the Nyquist
theorem, the sample interval δ is set to one-half the smallest
dimension of a voxel. At an axial voxel a and a given direction
	θ, φ
, the local intercept length πθ ,φ (a) of the target object is
determined as follows:
θ ,φ

n+

δ 
θφ
fO (a + vi−1
) + fO (a + viθ φ )
πθ ,φ (a) =
2 i=1
θ ,φ

n−

δ 
θφ
θφ
) + fO (a + v−i
) (3)
fO (a + v−i+1
+
2 i=1

where nθ+,φ and nθ−,φ are the first sample points, on the respective
sample lines, that fall out of the support O of the fuzzy object.
The local extent of the object along each sample line is recorded
(hollow dots in Fig. 4). The thickness at the axial voxel a is
computed as the shortest (solid line segment in Fig. 4) among
the m different object intercept lengths along different sample
line directions.

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

2061

equation:
min −(τO (a) − ωO (a, p)).
a∈A

(4)

In Algorithm 1, N ∗ (p) is the excluded neighborhood [43] of
a voxel p and link(p, q) = 12 (fO (p) + fO (q))|p − q|. It should
be noted that, the algorithm solves (4) through a dynamic programming approach [42] and the corresponding axial voxel a is
recorded in N AP which eventually determines the inheritance
of the thickness value τO (p) at a nonaxial voxel p.
III. EXPERIMENTAL PLANS AND METHODS

Prior to describing Step 3, it is worth mentioning that the idea
of sampling the thickness values at axial voxels of an object
was proposed earlier [29] and, in this context, the novelty of the
current method lies in the process of computing local thickness
at individual axial voxels. Although star-line-based approaches
have been used previously [30], [31], [33], [36], their application to computing minimum intercept length as local thickness
is novel. Vesterby et al. [30] and Croucher et al. [31] used
the star-line approach to compute star-volume of TB pores,
which is a different measure than structure thickness or spacing. To describe the process in Step 3, let a ∈ O be an axial
voxel and let p ∈ O be a nonaxial voxel. The distance of p
from the circumference of the MIB BO (a) centered at the axial voxel a is essentially equal to τO (a) − ωO (a, p), where the
ωO (a, p) is the fuzzy distance between a and p in O. Let A
denote the set of axial voxels or the skeleton of O. Therefore, following Definition 1, p inherits the thickness from an
axial voxel a in A for which the measure τO (a) − ωO (a, p)
is maximized. Essentially, Algorithm 1 solves the following

An application of the proposed algorithm for computation of
TB thickness and marrow spacing by in vivo MD-CT imaging of
a human distal tibia was investigated. The experimental study
was designed to evaluate the following performance indices:
1) accuracy; 2) stability of local thickness values under random local shifts in axial voxels; 3) stability of local thickness
values across a wide range of image voxel sizes; 4) stability
of thickness values under a major shift in “true” image resolution using ex vivo and in vivo imaging modalities; 5) repeat
scan reproducibility; 6) ability of TB thickness and marrow
spacing to predict bone strength; and 7) application to in vivo
studies. Computer-generated phantoms were used for Experiment 1, while μ-CT images of cadaveric ankle specimens were
used for Experiments 2–4. MD-CT imaging of the same specimens were used for Experiments 4–6. For Experiment 6, bone
strength of cadaveric specimens was determined by mechanical testing. Experiment 7 involved MD-CT scans of distal tibia
in a human pilot study. The following sequence of steps was
applied to each specimen: 1) MD-CT imaging; 2) removal of
soft tissue and dislodgement of the distal tibia from the ankle
joint; 3) μ-CT imaging; 4) specimen preparation and TB core
extraction; and 5) mechanical testing to compute compressive
Young’s modulus and yield stress.
Here, it is important to clarify the difference between Experiments 3 and 4. The purpose of Experiment 3 was to examine a
method’s performance under digitization at varying voxel size.
On the other hand, Experiment 4 examined a method’s performance under a major shift in true image resolution defined by
the modulation transfer function (MTF) of an imaging technique. Assuming that the thickness computation using μ-CT
at high resolution is quite accurate, this experiment examined
the meaningfulness of thickness computation using the current
method and an in vivo imaging technique. In the rest of this paper, voxel size or digitization will refer to downsampling effects
while resolution will symbolize the effects of the MTF on an
imaging technique.
A. Bone Volume Fraction and Volume Fraction Image
Computation
To compute trabecular thickness, a fuzzy representation of
TB is used where the membership value at a given p represents
its bone volume fraction (BVF) denoted as BVF(p). For μ-CT
images, BVF was directly computed from the raw CT data using the bimodal intensity distribution. MD-CT imaging acquires

2062

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

data in Hounsfield units and these numbers were first converted
to BMD (mg/cc) measures using a calibration phantom. The
INTable calibration phantom was used for all cadaveric specimen scans, while the Gammax calibration phantom was used for
all human in vivo scans. Finally, a BMD image was converted
to a BVF image using the following equation [45]:
⎧
0,
if BMD(p) < 940
⎪
⎪
⎪
⎨
BMD(p) − 940
BVF(p) =
, if 940 ≤ BMD(p) < 2184
⎪
2184 − 940
⎪
⎪
⎩
1,
otherwise.
(5)
Marrow space represents the marrow-filled region between
trabeculae. Therefore, marrow spacing was computed from the
marrow volume fraction image (MVF), derived as the inverse
of the BVF image as follows:
MVF(p) = 1.0 − BVF(p).

(6)

Both BVF and MVF images were resampled using the
windowed-sinc interpolation method producing 0.15-mm
isotropic voxels.

Fig. 5. Tradeoff between computation time and error as a function of the
parameter ψ defining the angular separation between neighboring sample lines
for star-line-based computation of local thickness.

optimum tradeoff value was attained at the angular separation
of 12◦ . Following the results of this experiment, for all experiments reported in this paper, we used 123 pairs of sample lines
at an approximate angular separation of 12◦ between every two
neighboring sample lines.

B. TB Thickness and Marrow Spacing Measures
Computation of both trabecular thickness and marrow spacing
was accomplished using the algorithm described in Section II-B.
Specifically, the two TB measures, namely, TB thickness (THB )
and marrow spacing (SPM ), were computed over a target
volume-of-interest (VOI) V as follows:

THB =
THB (p)/|VB |
(7)
p∈V B

SPM =



SPM (p)/|VM |

(8)

p∈V M

where VB (or VM ) is the set of voxels with nonzero BVF (respectively, MVF) in V . In addition to THB and SPM , the average
BMD over V was computed as described in [24].
C. Optimum Angular Separation Parameter
As described in Section II-B, the value of the parameter ψ
defining the angular separation between neighboring sample
lines needs to be determined. A small value of ψ provides a more
precise measure of star-line-based thickness at higher computation cost and the right choice of the parameter depends on the
tradeoff. To understand the tradeoff between accuracy and computation cost, an experiment was conducted on in vivo MD-CT
images of the distal tibia from ten human volunteers. The ideal
measure of star-line-based local thickness distribution was determined at dense distribution of star-lines with ψ = 1◦ . At any
other value of ψ, the mean and standard deviation of voxel-wise
thickness errors were computed. The mean error was expressed
as a percentage of the ideal mean thickness measure (see Fig. 5).
Also, the computation time was expressed as a percentage of
time required at one degree angular separation (see Fig. 5). An
overall tradeoff measure was defined as the square root of the
sum of squares of normalized error and computation time. The

D. Computerized Phantoms With Known Truth
Binary phantoms with a known thickness distribution were
generated at high resolution over an array of 512 × 512 × 512.
The simulation began with an ideal skeleton in the continuous
3-D space R3 as a union of mathematical surfaces, e.g., sinusoidal, cylindrical, spherical, or elliptical surfaces and sinusoidal
curves constituting different cross structures. The ideal skeleton
was densely and quasi-uniformly sampled; let ST be the set of
NT sampled points. A Euclidean DT [44] was computed from
ST and DTT : Z 3 → R+ denoted the DT map. To generate a
binary volumetric object with nonuniform thickness, a smoothly
varying thickness field, say fthickness : Z 3 → R+ , was generated using trilinear interpolation of independently chosen thickness values at a 25 × 25 × 25 array of control points. The
number of control points represented the degrees of freedom in
the simulated thickness field.
Finally, a volumetric object corresponding to the true skeleton ST was defined as the set of all voxels with its Euclidean
distance DTT not exceeding the true local thickness fthickness .
Six binary objects with true thickness distribution were generated; for example, see Fig. 6(a). Test phantom images were
generated by downsampling binary phantoms at 3 × 3 × 3,
4 × 4 × 4, and 5 × 5× 5 voxels and by adding noise at signal-tonoise ratios (SNR) of 6, 12, and 24. Zero-mean white Gaussian
noise was used for these phantoms and the SNR was defined as
the variance of the noise; it may be noted that the true signal
value at a fully occupied object voxel is 1. For the six phantoms
used in the current experiment, the mean and standard deviation
of thickness values at the original resolution were 30 ± 5 and
the thickness values covered the range of [10], [50] voxels. After accounting for larger voxel size in the test phantom image,
these thickness values at 5 × 5 × 5 downsampling were 6 ± 1
and the range was [2], [10].

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

2063

to failure. Yield stress was determined as the intersection of the
stress-strain curve and a 0.2% strain offset of the modulus.

G. VOI Selection for Cadaveric Image Analysis

Fig. 6. Computer generated phantom data at different levels of noise and
downsampling. (a) Three-dimensional rendition of the true binary phantom.
(b)–(d) Axial image slices of test phantoms at SNR values of 24, 12, and 6 and
downsampling rates of three, four, and five voxels, respectively.

E. Cadaveric Specimens, MD-CT, and μ-CT Imaging
Fifteen fresh-frozen human cadaveric ankle specimens were
obtained from 11 body donors (age: 55–91 years). Bodies were
obtained under the Deeded Bodies Program, The University
of Iowa, Iowa City, IA, USA, and the ankle specimens were
removed at the mid-tibia region. Exclusion criteria for this study
were evidence of previous fracture or knowledge of bone tumor
or bone metastasis. These ankle specimens were kept frozen
until the performance of MD-CT imaging.
High-resolution MD-CT scans of the distal tibia were acquired at the University of Iowa Comprehensive Lung Imaging Center on a 128-slice SOMATOM Definition Flash scanner
(Siemens, Munich, Germany) using the following CT parameters: single tube spiral acquisition at 120 kV, 200 effective mAs,
1 sec rotation speed, pitch factor: 1.0, nominal collimation:
16 × 0.3 mm, scan length: 10 cm beginning at the distal tibia
end-plateau, and total effective dose equivalent to 17 mrem
(≈ 20 days of environmental radiation) in the USA. Images
were reconstructed at 0.2-mm slice thickness and 0.2 × 0.2 inplane resolution using a normal cone beam method with a special
U70u kernel achieving high structural resolution. Following all
MD-CT repeat scans, each specimen was further scanned on an
Imtek Microcat II scanner at 28.5-μm isotropic resolution, after
removing soft tissue and dislocating the tibia from the ankle
joint.

The size and location of VOIs for image analysis of the cadaveric bone strength study (Experiment 6) were chosen as per
the information recorded during specimen preparation for mechanical testing of individual specimens. First, the image was
rotated to align the bone axis along the coordinate z-axis using
the following two steps: 1) generation of a cylinder C with its
axis lying on the coordinate z-axis and its cross-sectional area
equating to the average tibial cross sectional area; and 2) reorientation of the tibial volume to align its axis with C by maximizing
the overlap between the tibial volume and the cylinder C. After
reorienting the bone image, a VOI cylinder of 8-mm diameter
along the coordinate z-axis was generated and its proximal end
was manually positioned at the center of the cortical rim using in-plane translation through a graphical user interface. The
location of the distal end of the VOI cylinder in the slice direction and its length were determined as per the core location and
length recorded during specimen preparation; the growth plate
was visually located in the CT data of each specimen. Finally,
the central 6-mm region from the cylinder was used as the VOI
for the extensometer test; for the nonextensometer study, the
length of the VOI was determined as per data collected during
specimen preparation for the second mechanical test.

H. Human Volunteers for the In Vivo Study
In vivo MD-CT distal tibia bone scans were obtained for
20 healthy male (M) and 20 healthy female (F) volunteers 19
to 21 years of age from the ongoing Iowa Bone Development
Study (IBDS). MD-CT scans were obtained on the left lower
leg of each volunteer following the same CT protocol used for
cadaveric specimens (see Section III-E). Each volunteer’s tibial
length was determined by locating the distal and proximal tibial
plateaus in the AP projection MD-CT scout scan of the entire
tibia. Along with the healthy volunteers, six male (M) and four
female (F) athletes 19 to 21 years of age were recruited and the
same MD-CT bone scans were obtained.

I. VOI Selection for In Vivo Studies
F. Mechanical Testing and Determination of Bone Strength
To determine TB strength, a cylindrical TB core 8 mm in
diameter and 20.9 ± 3.3 mm in length was cored from the distal
tibia in situ along the proximal-distal direction. Each TB core
was mechanically tested for compression using an electromechanical materials testing machine. To minimize specimen end
effects, strain was measured with a 6-mm gauge length extensometer attached directly to the midsection of the bone. A
compressive preload of 10 N was applied and strains were set to
zero. At a strain rate of 0.005 s−1 , each specimen was preconditioned to a low strain with at least ten cycles and then loaded

The purpose of VOI computation for the in vivo pilot study
was to adjust the VOI according to the individual-specific tibia
length and width. The following protocol was adopted for this
study: 1) determination of tibial sites for the VOI as the percentage of tibial length in reference to the distal end plateau;
2) reorientation of the tibial image to align its axis with the
coordinate z-axis using the same method described in
Section III-G for cadaveric specimens; 3) location of the distal
end plateau in the MD-CT volume scan; and 4) determination
of the VOI at the 5% tibial site covering 2% of the tibial length
after applying a 45% peel on each cross-sectional slice.

2064

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

B. Robustness Under Different Conditions

Fig. 7. Illustration of the TB thickness and marrow spacing measures for three
different TB specimens with distinctly different bone strengths : (a) strong (yield
stress: 11.5 MPa), (b) moderate (7.1 MPa), and (c) weak (3.4 MPa).

IV. RESULTS AND DISCUSSION
Results of TB thickness measures for three specimens with
different bone strengths are illustrated in Fig. 7. As observed
in the figure, an 8% difference in BMD from a strong bone
(a) to a weak bone (c) leads to a 70% loss in bone strength
and manifests as a 20% reduction in TB thickness and a 42%
increase in marrow spacing. This observation supports that TB
thickness and marrow spacing measures are highly sensitive to
bone loss and, therefore, play a significant role in early detection
of bone diseases.
A. Accuracy Analyses
To examine the accuracy of the method, an error function
was defined using the known thickness field fthickness . Let Ol,σ
denote the set of voxels with nonzero membership in a phantom
image at the downsampling rate of l and the noise at SNR of
σ, and let fcom puted,l,σ : Z 3 → R+ be the computed thickness
map. The thickness computation error was defined as follows:
Errorl,σ =


1
|fthickness (p) − fcom puted,l,σ (p)|.
|Ol,σ |
p∈O l . σ

(9)
Average errors using both the new and the FDT-based [29]
methods for six phantoms are presented in Table I; the errors
are shown in voxel size prior to downsampling. Thus, a mean
error of 1.33 at a downsampling of 4 × 4 × 4 and an SNR of
12, essentially, represents an error of 0.46 in terms of the voxel
size of the test phantom image. Compared to the FDT-based
method, the new method produces smaller errors at all different
combinations of noise and downsampling, and these differences
are significant (two sample t-test p <0.001).

Three different experiments were undertaken to assess the robustness of the new method. The first experiment was designed
to examine whether the new thickness computation algorithm is
prone to the digitization error of axial voxels. For this purpose,
each axial voxel was randomly replaced by one of its 3 × 3 × 3
neighbors, and then, Steps 2 and 3 of the thickness computation
algorithm were followed. Two thickness values were computed
at each object voxel: one using the originally computed axial
voxels and the other derived after randomly moving axial voxels. The error was computed as the average of voxel-by-voxel
absolute differences between these two thickness values. This
error was normalized by the mean thickness value computed
from the original axial voxels. The experiment was run on both
μ-CT and MD-CT images of 15 ankle specimens. The mean
and standard deviation of voxel-by-voxel errors of TB thickness
computation for μ-CT images were 0.9% and 0.5%, respectively, and these numbers were 8% and 6%, respectively, for
MD-CT images. It should be mentioned that 8% and 6% thickness computation errors at 150-μm resolution are equivalent to
0.12 and 0.09 voxel errors. Further, it should be mentioned that
for MD-CT images, the error was reduced to 3% or 0.04 voxel
when average thickness values over a VOI of 1 mm3 were used
for error calculation.
To examine the method’s stability under digitization at different voxel sizes, the method was applied on ten μ-CT images each
downsampled at six different voxel sizes. Specifically, μ-CT images of original isotropic voxel size of 28.5 μm were used and
each image was down sampled at six larger isotropic voxel sizes
of 57.0, 85.5, 114.0, 142.5, 171.0, and 199.5 μm, as shown in
Fig. 8. Computed mean thickness values for different specimens
at various voxel sizes are illustrated in Fig. 9(a). Thickness error
for a specific μ-CT image at a given downsampled resolution
was computed as the difference between mean thickness values
computed from the downsampled and the original μ-CT voxel
size. Finally, the average and standard deviation of thickness
errors at a given voxel size were computed over the ten μ-CT
images and the results are presented in Fig. 9(b). As observed in
Fig. 9(b), despite a wide range of voxel sizes covering ex vivo to
in vivo regimes, the average thickness error is only 4.3%. These
results demonstrate that the new thickness computation method
is highly stable across a wide range of voxel sizes. However, it
must be clarified that the change in voxel size for this experiment was acquired by downsampling, and it does not reflect
the behavior of the method under true loss of resolution due to
change in imaging modalities, e.g., the effects of a larger MTF.
To examine the performance of the algorithm under true loss
of resolution by different imaging modalities with widely different characteristics of MTF, the correlation of TB thickness
computed from ex vivo μ-CT and in vivo MD-CT imaging was
examined. The purpose of this experiment was different from the
previous experiment. In the previous experiment, different voxel
sizes were obtained computationally, and the results showed
that the proposed algorithm produced highly stable measures of
thickness across a wide range of voxel sizes. On the other hand,
the current experiment was designed to examine the relationship

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

2065

TABLE I
THICKNESS COMPUTATION ERRORS ON PHANTOMS AT DIFFERENT LEVELS OF DOWNSAMPLING AND NOISE

Fig. 8. Illustration of a μ-CT image downsampled at different voxel sizes:
(a) 28.5 μm, (b) 114.0 μm, and (c) 199.5 μm.
Fig. 11. Illustration of the linear correlation of (a) TB thickness and (b) marrow
spacing computed from postregistered μ-CT and MD-CT images.

Fig. 9. Illustration of stability of the new algorithm across a wide range of
voxel sizes. (a) Mean thickness values over a matching VOI at different voxel
sizes. Each curve represents the results for one specimen. (b) Mean and standard
deviation of errors at different voxel sizes as computed based on data from ten
specimens.

ent imaging modalities will generate the same thickness value.
Instead, the objective was to examine whether the thickness
values measured by the proposed method using the two characteristically different modalities are tightly related or not. The
linear correlations of TB thickness and marrow spacing computed from registered μ-CT and MD-CT images are presented
in Fig. 11. The r values from a linear regression model of TB
thickness and marrow spacing measures in two different modalities are 0.96 and 0.95, respectively, with slopes of 1.66 and
1.08, respectively. For both measures, the regression line passes
near the origin. Thus, the results of this experiment reveal that
the thickness values computed by the current method from two
distinctly different modalities are not identical, but there is a
strong association between their values.
C. Reproducibility Analysis

Fig. 10. Illustration of a matching axial image slice from postregistered
(a) μ-CT and (b) MD-CT images of a cadaveric specimen.

between thickness values measured from images acquired using ex vivo and in vivo imaging modalities with widely different
MTFs. Matching axial image slices from postregistered images
of a cadaveric specimen using the two different modalities are
presented in Fig. 10. As observed in the figure, the trabecular
structures are thicker in MD-CT imaging due to a larger MTF.
Therefore, it is unrealistic to expect that the two widely differ-

Three repeat MD-CT scans of 15 cadaveric ankle specimens
were used to examine the method’s reproducibility. Fig. 12 illustrates a color-coded TB thickness map over a matching volume
in two repeat MD-CT scans of the distal tibia. For quantitative
analyses, ten spherical VOIs of the same radius were randomly
selected in the first MD-CT scan of each specimen above the
position 8-mm proximal to the distal endplate leading to a total
of 150 VOIs. A postregistration algorithm was used to locate the
matching VOIs in the second and third repeat scans. It is obvious
that the result of reproducibility analysis depends on the scale
of the VOI, with larger VOIs showing improved reproducibility.
The relationship between the method’s reproducibility and VOI
size is presented in Fig. 13. As can be seen in the figure, for
the new method, at a VOI diameter of 3.45 mm or greater, the

2066

Fig. 12. Illustration of reproducibility of the TB thickness measure under
MD-CT repeat scans. (a) and (b) Color-coded TB thickness images. (c) and (d)
TB image without color coding. (e) Color coding bar.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 14. (a) and (b) Ability of TB thickness and marrow spacing measures
computed by the method to predict experimental bone strength. The ability is
computed in terms of the R 2 of linear correlation between bone strength and
the respective measure. (c) and (d) Same as (a) and (b) but for the FDT-based
method.
TABLE II
RESULTS OF LINEAR REGRESSION ANALYSIS (R 2 VALUES) BETWEEN
DIFFERENT TB MEASURES AND EXPERIMENTAL TB STRENGTH PARAMETERS

Fig. 13. Illustration of repeat MD-CT scan ICC values as a function of VOI
diameters for both the new and the FDT-based algorithms. As observed in (a), at a
VOI diameter of 3.45 mm or greater, the ICC value for the new algorithm exceeds
the mark of 0.95, while the FDT-based algorithm requires a VOI diameter of
6.15 mm or greater to reach to that mark.

intraclass correlation coefficient (ICC) exceeds the value of 0.95
suggesting that the measure is highly reproducible for assessing regional bone alteration. For the conventional FDT-based
approach, the VOI diameter has to reach 6.15 mm or greater to
achieve equivalent performance in terms of the ICC.

Fig. 15. Color-coded illustration of TB thickness distribution using the new
method for age-BMI-similar healthy (a) female and (b) male volunteers.

D. Ability to Predict Bone Strength
The results of correlation analysis between Yield stress and
each of the TB thickness and marrow spacing measures using
the new method are shown in Fig. 14(a) and (b), while the results
using the FDT-based algorithm are shown in Fig. 14(c) and (d).
The values of R2 or coefficients of determination from the linear
regression analysis between TB Young’s modulus and the different TB measures are presented in Table II. For both yield stress
and Young’s modulus parameters, the TB thickness and marrow spacing measures computed using the new method have
demonstrated superiority in predicting bone strength as compared to the FDT-based measures and MD-CT based volumetric
BMD.

E. Results of In Vivo Pilot Studies
Twenty male and twenty female volunteers (19 to 21 years)
were used to form body mass index (BMI) order-matched
male–female pairs. The BMI was 26.89 ± 6.32 kg/m2
(mean±standard deviation) for males and 25.15 ± 7.96 kg/m2
for females, and r for the two ordered groups of BMIs was
0.98. The colored results for one male–female pair are shown
in Fig. 15. Clearly, the results indicate that the male has thicker
TB than the female. Quantitative results show that males on
average have 6.7% thicker TB and 13.9% reduced marrow spacing as compared to females. Observed values for TB thickness
and marrow spacing for males were 0.22 ± 0.02 and 0.32 ± 0.06

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

2067

TABLE III
RESULTS OF PAIRED t-TEST FOR TB THICKNESS AND MARROW SPACING MEASURES BETWEEN BMI-MATCHED MALE AND FEMALE PARIES AND BETWEEN
ATHLETES AND SEX- AND BMI-MATCHED HEALTHY CONTROLS

Fig. 16. Same as Fig. 15, but comparison between a healthy nonathlete
(a) and an age-sex-BMI-matched athlete volunteer.

mm, respectively, and those measures observed for females were
0.19 ± 0.03 and 0.37 ± 0.10 mm (see Table III). Paired t-test results showed the differences were statistically significant (p <
0.03) for both TB thickness and marrow spacing. Using the
FDT-based methods, males on average have 2.6% thicker TB
and 12.3% reduced marrow spacing as compared to females,
with p-values of 0.29 and 0.12 for TB thickness and marrow
spacing, respectively.
In vivo MD-CT data from ten athlete volunteers (six male
and four female) were processed. Collegiate athletes who were
actively participating at the varsity level in volleyball or basketball were recruited from regional colleges and universities. We
did not recruit from Big Ten universities in order to minimize
genetic differences between the athletic sample and the IBDS
sample. All athletes were screened to ensure that they had not
been injured in the past year. A control group was formed by
selecting among the 40 healthy volunteers, ten with the same
gender and the most similar BMI value. The mean BMIs were
23.73 ± 1.56 kg/m2 for athletes, and 24.07 ± 1.83 kg/m2 for
the control group, and r for the two groups of BMI values was
0.98. The results for one athlete and one nonathlete with similar
BMI values are shown in Fig. 16. Obviously, the results indicate
that the athlete has thicker TB than the nonathlete. Quantitative results show that athletes on average have 9.4% thicker TB
and 11.0% reduced marrow spacing as compared to age-sexBMI-matched healthy controls (see Table III). Results of paired
t-tests showed the differences were statistically significant (p =
0.01 for TB thickness and p = 0.04 for marrow spacing). Using
FDT-based methods, athletes on average have 10.0% thicker TB
and 9.3% reduced marrow spacing as compared to nonathletes,
with p of 0.07 and 0.14 for TB thickness and marrow spacing,
respectively.
V. CONCLUSION
In this paper, we presented a new thickness computation algorithm for fuzzy digital objects at relatively low resolution

and investigated its role in computing TB thickness and marrow
spacing measures through MD-CT imaging under in vivo conditions. Results of a comprehensive study on computer-generated
phantoms and fifteen cadaveric ankle specimens evaluating the
new method were presented. Observed results demonstrated encouraging accuracy and stability of computed thickness at different levels of noise and downsampling. Also, high repeat MD-CT
scan reproducibility of the new thickness computation method
was observed in the cadaveric ankle study. TB thickness and
marrow spacing measures demonstrated higher ability to predict the experimental mechanical properties of TB under in vivo
conditions as compared to BMD and conventional FDT-based
methods. Currently, we are investigating the power of the new
method to characterize clinical groups with low bone mass.
Also, in vivo data from 40 age similar and BMI order-matched
male and female volunteers demonstrated that males have significantly thicker trabeculae and significantly reduced marrow
spacing as compared to females. Although similar differences of
TB thickness and marrow spacing between males and females
were observed for FDT-based measures, differences were not
statistically significant. A second experiment on ten basketball
or volleyball athletes and age-sex-BMI similar healthy matched
controls showed that using the current method, athletes have
significantly thicker TB and significantly reduced marrow spacing. This imaging difference is consistent with the Mechanostat
theory which states that bone adapts to local mechanical elastic deformation in response to peak forces caused by muscle
activity. In short, the thicker TB and reduced marrow spacing
in the athletes which we report is an environmental adaptation
that improves bone strength. Our results suggest that exercise
interventions that do not include pre- and postmeasures of TB
may not fully capture the positive effects of the intervention. A
similar analysis using FDT-based measures marginally failed to
demonstrate statistically significant differences in TB thickness
and marrow spacing between and athletes and healthy matched
controls. The current experimental results demonstrate the application of the proposed method in a young population, but it
has yet to be tested on an osteoporotic population, generally,
consisting of elderly subjects or subjects with compromised
bone.
One drawback of the current thickness computation method
lies in the increased computation time needed to compute interpolated intensity values at multiple sample points on individual
star-lines for each axial voxel. Current implementation of the
method on a desktop with a 2.53-GHz Intel(R) Xeon(R) CPU
and Linux OS requires approximately 4–5 min for a typical MDCT image analysis of human TB over a region of interest of
300 × 300 × 300 at an isotropic resolution of 150 μm.

2068

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Considering the fact that the method is fully automated and
it can be run on multiple images in a batch mode, the additional
computation time may not be an important concern for most
applications.

ACKNOWLEDGMENT
The authors would like to thank J. Fishbaugher for helping
with the conduct of the human study.

REFERENCES
[1] S. Boonen and A. J. Singer, “Osteoporosis management: Impact of fracture
type on cost and quality of life in patients at risk for fracture I,” Curr. Med.
Res. Opin., vol. 24, pp. 1781–1788, 2008.
[2] L. J. Melton, 3rd, “Epidemiology of spinal osteoporosis,” Spine, vol. 22,
pp. 2S–11S, 1997.
[3] M. Benito, B. Gomberg, F. W. Wehrli, R. H. Weening, B. Zemel,
A. C. Wright, H. K. Song, A. Cucchiara, and P. J. Snyder, “Deterioration of trabecular architecture in hypogonadal men,” J. Clin. Endocrinol.
Metab, vol. 88, pp. 1497–1502, 2003.
[4] M. J. Barger-Lux and R. R. Recker, “Bone microstructure in osteoporosis: Transilial biopsy and histomorphometry,” Top. Magn. Reson. Imag.,
vol. 13, pp. 297–305, 2002.
[5] M. Kleerekoper, A. R. Villanueva, J. Stanciu, D. Sudhaker Rao, and
A. M. Parfitt, “The role of three-dimensional trabecular microstructure
in the pathogenesis of vertebral compression fractures,” Calcified Tissue
Int., vol. 37, pp. 594–597, 1985.
[6] A. M. Parfitt, “Implications of architecture for the pathogenesis
and prevention of vertebral fracture,” Bone, vol. 13, pp. S41–S47,
1992.
[7] R. R. Recker, “Architecture and vertebral fracture,” Calcified Tissue Int.,
vol. 53, Suppl. 1, pp. S139–S142, 1993.
[8] A. Vesterby, H. J. Gundersen, F. Melsen, and L. Mosekilde, “Marrow
space star volume in the iliac crest decreases in osteoporotic patients
after continuous treatment with fluoride, calcium, and vitamin D2 for five
years,” Bone, vol. 12, pp. 33–37, 1991.
[9] T. M. Link, S. Majumdar, P. Augat, J. C. Lin, D. Newitt, Y. Lu, N. E. Lane,
and H. K. Genant, “In vivo high resolution MRI of the calcaneus: Differences in trabecular structure in osteoporosis patients,” J. Bone Mine. Res.,
vol. 13, pp. 1175–1182, 1998.
[10] R. Moore, T. Durbridge, P. McNeil, I. Parkinson, and A. Need, “Trabecular
spacing in post-menopausal Australian women with and without vertebral
fractures,” Aust. N. Z. J. Med., vol. 22, pp. 269–273, 1992.
[11] A. M. Parfitt, C. H. E. Mathews, A. R. Villanueva, M. Kleerekoper,
B. Frame, and D. S. Rao, “Relationships between surface, volume, and
thickness of iliac trabecular bone in aging and in osteoporosis. Implications for the microanatomic and cellular mechanisms of bone loss,”
J. Clin. Invest., vol. 72, pp. 1396–1409, 1983.
[12] H. Chung, F. W. Wehrli, J. L. Williams, and S. D. Kugelmass, “Relationship between NMR transverse relaxation, trabecular bone architecture and
strength,” Proc. Nat. Acad. Sci., vol. 90, pp. 10250–10254, 1993.
[13] L. Mosekilde, “Age-related changes in vertebral trabecular bone
architecture—Assessed by a new method,” Bone, vol. 9, pp. 247–250,
1988.
[14] J. A. Spadaro, F. W. Werner, R. A. Brenner, M. D. Fortino, L. A. Fay,
and W. T. Edwards, “Cortical and trabecular bone contribute strength
to the osteopenic distal radius,” J. Orthp. Res., vol. 12, pp. 211–218,
1994.
[15] P. Chavassieux, M. Arlot, and P. J. Meunier, “Clinical use of bone biopsy,”
Osteoporosis, vol. 2, pp. 501–509, 2001.
[16] P. Rüegsegger, B. Koller, and R. Muller, “A microtomographic system for
the nondestructive evaluation of bone architecture,” Calcified Tissue Int.,
vol. 58, pp. 24–29, 1996.
[17] S. Majumdar, “Magnetic resonance imaging of trabecular bone structure,”
Top. Magn. Reson. Imag, vol. 13, pp. 323–334, 2002.
[18] F. W. Wehrli, “Trabecular bone imaging,” in Magnetic Resonance Imaging and Spectroscopy in Medicine and Biology, vol. 2, I. R. Young, Ed.
London, U.K.: Wiley, 2000, pp. 1356–1368.

[19] A. Laib, H. J. Hauselmann, and P. Rüegsegger, “In vivo high resolution
3D-QCT of the human forearm,” Tech Heal Care, vol. 6, pp. 329–337,
1998.
[20] A. J. Burghardt, T. M. Link, and S. Majumdar, “High-resolution computed
tomography for clinical imaging of bone microarchitecture,” Clin. Orthop.
Relat. Res., vol. 469, pp. 2179–2193, 2011.
[21] J. A. MacNeil and S. K. Boyd, “Improved reproducibility of highresolution peripheral quantitative computed tomography for measurement of bone quality,” Med. Eng. Phys., vol. 30, pp. 792–799,
2008.
[22] M. Ito, K. Ikeda, M. Nishiguchi, H. Shindo, M. Uetani, T. Hosoi, and
H. Orimo, “Multi-Detector Row CT Imaging of Vertebral Microstructure
for Evaluation of Fracture Risk,” J. Bone Miner. Res., vol. 20, pp. 1828–
1836, 2005.
[23] G. Diederichs, T. M. Link, M. Kentenich, K. Schwieger, M. B. Huber,
A. J. Burghardt, S. Majumdar, P. Rogalla, and A. S. Issever, “Assessment
of trabecular bone structure of the calcaneus using multi-detector CT:
Correlation with microCT and biomechanical testing,” Bone, vol. 44,
pp. 976–983, 2009.
[24] P. K. Saha, Y. Xu, H. Duan, A. Heiner, and G. Liang, “Volumetric topological analysis: a novel approach for trabecular bone classification on the
continuum between plates and rods,” IEEE Trans. Med. Imag., vol. 29,
pp. 1821–1838, Nov. 2010.
[25] S. A. Little, M. W. Sproule, M. D. Cowan, K. J. Macleod, M. Robertson,
J. G. Love, G. W. Chalmers, C. P. McSharry, and N. C. Thomson, “High
resolution computed tomographic assessment of airway wall thickness in
chronic asthma: Reproducibility and relationship with lung function and
severity,” Thorax, vol. 57, pp. 247–253, 2002.
[26] Y. Xu, G. Liang, G. Hu, Y. Yang, J. Geng, and P. K. Saha, “Quantification
of coronary arterial stenoses in CTA using fuzzy distance transform,”
Comput. Med. Imag. Graph, vol. 36, pp. 11–24, 2012.
[27] P. K. Saha, Z. Gao, S. K. Alford, M. Sonka, and E. A. Hoffman, “Topomorphologic separation of fused iso-intensity objects via multi-scale opening: separating arteries and veins in 3-D pulmonary CT,” IEEE Trans. Med.
Imag., vol. 29, no. 3, pp. 840–851, Mar. 2010.
[28] T. Hildebrand and P. Rüegsegger, “A new method for the model independent assessment of thickness in three-dimensional images,” J. Microscopy,
vol. 185, pp. 67–75, 1997.
[29] P. K. Saha and F. W. Wehrli, “Measurement of trabecular bone thickness in
the limited resolution regime of in vivo MRI by fuzzy distance transform,”
IEEE Trans. Med. Imag., vol. 23, no. 1, pp. 53–62, Jan. 2004.
[30] A. Vesterby, H. J. Gundersen, and F. Melsen, “Star volume of marrow
space and trabeculae of the first lumbar vertebra: Sampling efficiency and
biological variation,” Bone, vol. 10, pp. 7–13, 1989.
[31] P. I. Croucher, N. J. Garrahan, and J. E. Compston, “Assessment of cancellous bone structure: comparison of strut analysis, trabecular bone pattern
factor, and marrow space star volume,” J. Bone Miner. Res., vol. 11,
pp. 955–961, 1996.
[32] E. Martn-Badosa, A. Elmoutaouakkil, S. Nuzzo, D. Amblard, L. Vico, and
F. Peyrin, “A method for the automatic characterization of bone architecture in 3D mice microtomographic images,” Comput. Med. Imag. Graph.,
vol. 27, pp. 447–458, 2003.
[33] P. K. Saha, “Tensor scale: A local morphometric parameter with applications to computer vision and image processing,” Comput. Vis. Imag.
Understanding, vol. 99, pp. 384–413, 2005.
[34] R. Moreno, M. Borga, and Ö. Smedby, “Estimation of trabecular thickness
in gray-scale images through granulometric analysis,” Proc. SPIE, 2012,
pp. 831451-1–831451-9, 2012, to be published.
[35] Y. Liu, D. Jin, and P. K. Saha, “A new algorithm for trabecular bone
thickness computation at low resolution achieved under in vivo condition,”
in Proc. 10th Int. Symp. Biomed. Imag., San Francisco, CA, USA, 2013,
pp. 390–393.
[36] Y. Liu, P. K. Saha, and Z. Xu, “Quantitative characterization of trabecular
bone micro-architecture using tensor scale and multi-detector CT imaging,” in Proc. Image Comput. Comput.-Assisted Intervention Conf., Nice,
France, 2012, pp. 124–131.
[37] G. Borgefors, “On digital distance transformation in three dimensions,”
Comput. Vis. Imag. Understanding, vol. 64, pp. 368–376, 1996.
[38] P. K. Saha, B. B. Chaudhuri, and D. D. Majumder, “A new shape preserving parallel thinning algorithm for 3D digital images,” Pattern Recognit.,
vol. 30, pp. 1939–1955, 1997.
[39] C. Arcelli, G Sanniti di Baja, and L. Serino, “Distance-driven Skeletonization in voxel images,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 33,
no. 4, pp. 709–720, Apr. 2011.

LIU et al.: ROBUST ALGORITHM FOR THICKNESS COMPUTATION AT LOW RESOLUTION AND ITS APPLICATION

[40] P. K. Saha and B. B. Chaudhuri, “Detection of 3-D simple points for
topology preserving transformations with application to thinning,” IEEE
Trans. Pattern Anal. Mach. Intell., vol. 16, no. 10, pp. 1028–1032, Oct.
1994.
[41] P. K. Saha, F. W. Wehrli, and B. R. Gomberg, “Fuzzy distance transform:
Theory, algorithms, and applications,” Comput. Vis. Imag. Understanding,
vol. 86, pp. 171–190, 2002.
[42] P. K. Saha, J. K. Udupa, and D. Odhner, “Scale-based fuzzy connected
image segmentation: Theory, algorithms, and validation,” Comput. Vis.
Imag. Understanding, vol. 77, pp. 145–174, 2000.
[43] P. K. Saha, B. B. Chaudhuri, B. Chanda, and D. D. Majumder, “Topology
Preservation in 3D Digital Space,” Pattern Recognit., vol. 27, pp. 295–300,
1994.

2069

[44] H, Breu, J. Gil, D. Kirkpatrick, and M. Werman, “Linear time Euclidean
distance transform algorithms,” IEEE Trans. Pattern Anal. Mach. Intell.,
vol. 17, pp. 529–533, 1995.
[45] C. J. Hernandez, G. S. Beaupre, T. S. Keller, and D. R. Carter, “The influence of bone volume fraction and ash fraction on bone strength and
modulus,” Bone, vol. 29, pp. 74–78, 2001.

Authors’ photographs and biographies not available at the time of publication.

