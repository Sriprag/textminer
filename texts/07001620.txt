IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

1355

Multiscale 3-D + t Intracranial Aneurysmal Flow
Vortex Detection
Giacomo Feliciani, Wouter V. Potters, Pim van Ooij, Joppe J. Schneiders, Aart J. Nederveen, Ed van Bavel,
Charles B. Majoie, and Henk A. Marquering∗

Abstract—Objective: Characteristics of vortices within intracranial aneurysmal flow patterns have been associated with increased
risk of rupture. The classifications of these vortex characteristics are commonly based upon qualitative scores, and are, therefore, subjective to user interpretation. We present a quantitative
method for automatic time-resolved characterization of 3-D flow
patterns and vortex detection within aneurysms. Methods: Our approach is based upon the combination of kernel deconvolution and
Jacobian analysis of the velocity field. The deconvolution approach
is accurate in detecting vortex centers but cannot discriminate between vortices and high-shear regions. Therefore, this approach is
combined with analysis of the Jacobian of the velocity field. Scalespace theory is used to evaluate aneurysmal flow velocity fields at
various scales. Results: The proposed algorithm is applied to computational fluid dynamics and time-resolved 3-D phase-contrast
magnetic resonance imaging of aneurysmal flow. Conclusion: Results show that the proposed algorithm efficiently detects, visualizes, and quantifies vortices in intracranial aneurysmal velocity
patterns at multiple scales and follows the temporal evolution of
these patterns. Significance: Quantitative analysis performed with
this method has the potential to reduce interobserver variability in
aneurysm classification.
Index Terms—Flow patterns, hemodynamics, intracranial
aneurysms, multiscale analysis, shear layers, velocity patterns,
vortices.

Manuscript received May 20, 2014; revised September 10, 2014, November
5, 2014, and November 25, 2014; accepted December 27, 2014. Date of publication December 27, 2014; date of current version April 17, 2015. This work
was supported by the Dutch Technology Foundation STW. Asterisk indicates
corresponding author.
G. Feliciani was with the Department of Biomedical Engineering and Physics
and the Department of Radiology, Academic Medical Center, University of
Amsterdam. He is now with the Department of Medical Physics, IRCCSArcispedale Santa Maria Nuova and the School of Specialization in Medical
Physics, University of Bologna.
W. V. Potters, J. J. Schneiders, A. J. Nederveen, and C. B. Majoie are with the
Department of Radiology, Academic Medical Center, University of Amsterdam.
P. van Ooij was with the Department of Biomedical Engineering and Physics
and the Department of Radiology, Academic Medical Center, University of
Amsterdam. He is now with the Department of Radiology, Feinberg School of
Medicine, Northwestern University.
E. van Bavel is with the Department of Biomedical Engineering and Physics,
Academic Medical Center, University of Amsterdam.
∗ H. A. Marquering is with the Department of Biomedical Engineering
and Physics and Department of Radiology, Academic Medical Center, University of Amsterdam, 1012 WX Amsterdam, The Netherlands (e-mail: h.a.
marquering@amc.uva.nl).
This paper has supplementary downloadable material available at
http://ieeexplore.ieee.org, provided by the authors. This includes one supplementary figure and two multimedia AVI format movie clips. This material is 1.5
MB in size.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org .
Digital Object Identifier 10.1109/TBME.2014.2387874

I. INTRODUCTION
STIMATIONS of cerebral aneurysm prevalence range
between 0.4% and 6% [1]. Cerebral aneurysms have a
low acute rupture risk, however, rupture results in aneurysmal
subarachnoid hemorrhage and is associated with high mortality and morbidity [2]. Treatment is based on excluding the
aneurysm from circulation, thereby relieving the aneurysm from
hemodynamic stress. Currently, endovascular coil embolization
is the first therapeutic option. Although widely practiced, significant peri- and postoperative complications can occur due to
these treatments [3], [4]. These complications have to be carefully balanced against the risk of rupture to determine the choice
of treatment.
In current clinical practice, only size and location are considered in the decision to treat. Additional risk factors are needed
for more accurate estimations of aneurysmal rupture risk. Intraaneurysmal hemodynamic risk factors for aneurysmal growth and
rupture have been addressed in many studies. Both low and high
wall shear stress (WSS) have been associated with aneurysmal
growth and rupture [5], [6]. Furthermore, unstable flow patterns
were associated with aneurysm progression and rupture because
of the potential for elevated oscillatory shear index or larger regions of elevated mean WSS. In various studies, computational
fluid dynamics (CFD) simulations have been performed on vascular models to associate rupture status with flow complexity,
flow stability, and inflow jet size [7]. Alternatively, intraaneurysmal velocity can be measured using time-resolved 3-D phasecontrast MRI (PC MRI) [8]. In a recent study, it was shown
that ruptured aneurysms had complicated flow patterns in the
aneurysm domes, whereas all of the unruptured cases showed a
simple vortex [9].
Vortex characteristics such as vortex complexity, vortex stability, and flow pattern category are assessed by visual inspection [10]. In clinical research studies, intraaneurysmal flow is
commonly categorized according to the definitions previously
introduced [10] using animations of intravascular flow velocities: (i) constant direction of inflow jet with a single associated
vortex, (ii) constant direction of inflow with multiple and constant number of associated vortices, (iii) changing direction of
inflow jet with a single vortex, and (iv) changing direction of
inflow jet with the creation and destruction of multiple vortices. Illustrations of these flow categories can be found in [10]
and are proposed here in Fig. 1. Type (i) flow is associated
with unruptured status, whereas type (iii) and type (iv) flow is
more common in ruptured aneurysms. This classification is well
accepted among the community and has been used in multiple
clinical studies [10]–[15]. Because of the qualitative and manual

E

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1356

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

we have presented a 2-D singular velocity pattern detection technique to analyze 2-D velocity fields [21] based upon the works
of Liu and Ribeiro [22]. This approach included vortex identification as one of the singular flow patterns. Here, this technique
is extended to time-resolved 3-D velocity fields. For this new approach, the local velocity field v (x, t) in a small neighborhood
Δx is represented by a combination of base functions φk (Δx)

v (x, t) =
Ak (x, t) φk (Δx) .
(1)
k

Fig. 1. Schematic drawings of flow categories in small (left) and large (right)
aneurysms. Flow types ranges from (i) at the top to (iv) at the bottom. Arrows
indicate the direction of flow at 3 moments during the cardiac cycle and illustrate
the complexity and stability of the intra-aneurysmal flow patterns for the 4 flow
type categories. Reprinted with permission [10].

assessment, these measurements are prone to interobserver variation. In a recent study of this research group, interobserver
agreement was poor with intraclass correlation coefficients ranging from 0.47 to 0.70. Quantitative analysis of vortex characteristics has the potential to reduce interobserver variability and to
improve the value of these parameters in risk assessment because
of its continuous characteristic as opposed to the classification
in a limited number of categories.
II. METHODS
Hemodynamics, which can be assessed by CFD and PC MRI,
are generally presented as time-resolved 3-D velocity fields
v (x, t). Below, we describe approaches to extract quantitative
information from these velocity fields.

where the projection coefficients Ak are given by the cross
correlation of the global velocity field and the base functions

Ak (x, t) = v (x + ξ, t) · φk (ξ) dξ.
(2)
As we focus on vortex quantification in this study, only six
base functions are used; three for describing the laminar flow
φk (Δx) = êk for k 1, 2, and 3 with êk the Cartesian basis vectors where their dimension is ms−1 . This part of the velocity
field is called laminar flow since it describes the local “nonsingular” velocity. The vortex base functions are a single class
of the “singular” velocity patterns. This term is called singular
because of its diminishing contribution at ξ = 0. We refer to
Liu and Ribeiro [22] for illustrations of different singular flow
patterns. The three vortex projection coefficients are determined
using the following equation:

(3)
Avi (x, t) = v (x + ξ, t) · (êi × ξ)dξ
where we have used the superscript v to indicate that these
contributions are the vortex projections. The used base functions
are illustrated in the supplementary Fig. S1.

A. Kernel Deconvolution

B. Multiscale Space Representation

The most commonly applied approaches for vortex detection
are the Q- and λ2 -criteria [16]. These approaches are based
upon local pressure characteristics. However, in our experience
these criteria do not reflect the impression of radiologists of intraaneurysmal vorticity because the radiologists interpret more
global features. Bauer described various methods for flow field
feature visualization [17] and to trace the flow field in time. They
used combinations of feature detection techniques, such as vortex core lines detection, with methods acting on the Jacobian
of the flow field. Schafhitzel et al. [18] presented an overview
on analysis of shear stress layers in flow fields and described a
visualization method for simultaneous tracking of vortices and
shear layers as well as their interaction. More recent studies focus on vortex core lines and vorticity magnitude detection and
their variation in time [19], [20]. However, in clinical studies,
analyses of aneurysmal vortex structures are still based upon
qualitative visual interpretation and a quantitative measure is
still missing.
Furthermore, we noted that the Q- and λ2 -criteria are sensitive
to high-velocity gradients without an actual circular movement
in, for example, aneurysmal neck areas. As such, we searched
for more global descriptive methods that are able to capture the
clinician’s impression of intraaneurysmal vorticity. Previously,

To introduce a finite support size of the base functions and to
be able to distinguish various scales of the vorticity, the analyses are performed in a multiscale space approach. Multiscale
techniques operate on a source signal by a convolution with
a Gaussian function [17]. With increasing scale, smaller scale
details in the signal are removed. To assess the scale-dependent
flow patterns, we employ the 3-D Gaussian function


|x|2
1
· exp − 2
(4)
G (x, σ) = √
2σ
( 2πσ)3
where σ is the scale. The scale-space dependent velocity
field f (x, σ, t) can be obtained by the convolution of the
Gaussian function with the velocity field f (x, σ, t) =
v (x, t) ⊗ G(x, σ). Using the multiscale approach, we can write
the kernel equations as a decomposition of scale-dependent
base functions φk (Δx, σ), which are defined as the convolution of the initial base functions with the Gaussian function
φk (Δx) ⊗ G(Δx, σ)

f (x, σ, t) =
Ak (x, t, σ)φk (Δx, σ).
(5)
k

Again, the scale-dependent projection coefficients are determined by the convolution of the velocity field with the

FELICIANI et al.: MULTISCALE 3-D + t INTRACRANIAL ANEURYSMAL FLOW VORTEX DETECTION

scale-dependent base functions

Ak (x, t, σ) = v (x + ξ, t) · φk (ξ, σ) dξ.

1357

D. Kernel Deconvolution With Q-Criterion Masking

Av1 + Av2 + Av3 .
Note that the scale σ and the neighborhood Δx are related:
the larger the scale, the larger the neighborhood with nonzero
contributions of the velocity field. In computational practice,
the neighborhood is defined as 3 × σ in all directions.

To come to a vortex identification and quantification method
that excludes shear fields, we here combine the Q-criterion
and the kernel deconvolution analysis. We propose to use the
Q-criterion to create a mask applied to kernel deconvolution
results such that we remove shear dominated areas. To depict
centers of vortices, local spatial maxima of the vortex magnitude for a given time and scale are detected using a 26-connected
neighborhood. The time resolved multiscale kernel deconvolution with Q-criterion masking is called “kernel deconvolution
with Q-masking” in the remainder of this paper. The purpose
of this method is to visualize, quantify, and discriminate 3-D
velocity features both in time and in scale to support clinicians
in their treatment decisions. The method is evaluated in the
comparison of CFD and time-resolved 3-D PC MRI data of an
aneurysm phantom and patient-specific aneurysmal CFD flow
data of three patients described below.

C. Vortex-Shear Discrimination

E. Phantom Data

The kernel deconvolution method described above is suitable
for vortex (center) detection. However, it is unable to discriminate vortex fields from shear fields. For this reason, it is necessary to differentiate vortex dominated flow fields from shear
dominated flow fields. The widely used Q-criterion based on the
decomposition of the Jacobian J (x, t) is commonly used for
this task [23], where the Jacobian is defined as

The aneurysm phantom was based on an intracranial
aneurysm located in the anterior communicating artery. The
maximal dimensions of the dome were approximately 6, 4, and
9 mm in the x, y, and z direction, respectively. The phantom was
connected to a flow loop setup. Details on this phantom can be
found in [24].
Time-resolved 3-D PC MRI data of the phantom was obtained using three-directional velocity encoding on an Intera 3T
(Philips Medical Systems, Best, The Netherlands). Additional
scanner specific settings were previously reported in [24]. The
measurement was performed within 3 h. Spatial resolution was
0.2 × 0.33 × 0.2 mm3 .
CFD simulations (Fluent 6.3, ANSYS, Canonsburg, USA)
were performed on a vascular model based upon a 3-D rotational angiogram of the phantom with an isotropic resolution of
0.16 mm. This image was segmented with a level set algorithm
[25]. A mesh was created consisting of 742 316 tetrahedral cells
with an average node spacing of 0.24 mm. The 3-D velocity
profile of the inflow as measured in the PC MRI measurements
was applied as boundary condition in the CFD. The MRI and
CFD datasets were registered using a rigid transformation and
interpolated on a 3-D isotropic 0.2 mm grid.

(6)

Following [21], we scale the singular projection coefficients
by the magnitude of the laminar contributions to correct for
the large range of flow magnitudes that can be present within
intracranial aneurysms, and to avoid obscuring singular flow
patterns at location with low velocities. Avk (x, t, σ) represents the vortex magnitude in the x-, y-, and z-direction for
k, 1, 2, or 3, respectively. As such, the axis of the vorticity is
v
v
v
given
 by the vector (A1 , A2 , A3 ) and the vortex magnitude |A|
by

2

2

2

J (x, t) ≡ ∇v(x, t) = S(x, t) + Ω(x, t)
with
1
Sij =
2



∂vi
∂vj
+
∂xj
∂xi



1
and Ωij =
2



∂vi
∂vj
−
∂xj
∂xi

(7)

(8)

where S denotes the rate of strain and Ω represents the rotational
part of the velocity field. In (8), we omitted the dependencies x
and t for brevity. To take scale into consideration, (7) is modified
as follows:
J (x, σ, t) = ∇ (v (x, t) ⊗ G (x, σ)) = v (x, t) ⊗ ∇G (x, σ) .
(9)
This way, we take advantage of scale space properties and perform the convolution with the derivative of the Gaussian function
instead of deriving the velocity field. Vortex dominated areas
are detected as regions where Ω(x, σ, t) > S(x, σ, t), which is
known as the Q-criterion [23]. As the result of the Q-criterion
is binary rather than a continuous measure, Schafhitzel et al.
[18] suggested to use the second invariant of S as a continuous
measure for high shear stress region identification
1 
(Sii Sj j − Sij Sij )
2 i=1 j =1
3

Sm (x, σ, t) =

3

(10)

where we have omitted the spatial, scale, and time dependencies
on the right side of (10) for brevity. A region is classified as shear
dominated if Sm < 0 and the shear stress magnitude is inversely
related with Sm , as such we can use the Sm criterion as a
complementary measure for identifying high-stress areas next
to identifying the vortices.

F. Patient Data
The patient-specific vessel models for CFD based flow data
in the three patients were generated using 3DRA imaging (see
Fig. 2). The vascular tree was segmented using a level set algorithm (VMTK). The segmentations were converted into a
tetrahedral elements mesh with an average node spacing of
0.07 mm. CFD boundary velocities were based on time-resolved
three-directional single-slice PC MRI acquisitions in the afferent artery. CFD simulations were performed using the PC MRI
velocity measurements as boundary condition [8]. Three cardiac cycles were calculated of which the last cycle was used
for analysis. Because of the limited temporal resolution of the
MR measurements, only 36 time frames per cardiac cycle were

1358

Fig. 2.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Surface rendering of the three patient aneurysms used in this study.

Fig. 3. Employed analysis pipeline for flow feature analysis. The 3-D-t velocity data consisted of either phantom CFD or MR data or patient CFD velocity
data. Vortex centers were detected for two scales and rendered in 3-D. At these
locations 2-D orthogonal slices with velocity profiles were generated inspect the
vortex behavior. By monitoring this behavior for all time steps, the stability of
the vorticity was assessed. A similar approach was followed to assess the shear
stress analysis using the S m -criterion.

determined resulting in 36 time frames for the CFD with an average time step of 0.028 s. CFD iterations were continued until
the continuity residual was below 0.001.
G. Experiments Overview
The phantom and patient velocity datasets were processed to
detect dynamic and scale-dependent vortices and shear stresses
using the kernel deconvolution with Q-masking and the Sm criterion, respectively. The analysis was conducted for two scales:
a small scale with σ = 0.28 mm, which is similar to the resolution of our datasets, and a large scale with σ = 1.00 mm, which
reflects the dimension of the intracranial arteries. A schematic
overview of the analysis pipeline is presented in Fig. 3. Using
the kernel deconvolution with Q-masking, vortex centers were
detected for a given scale and time step. Simultaneously, shear
stress regions were detected. These regions were rendered in
3-D. At local maxima of the masked kernel deconvolution, three
orthogonal 2-D slices were generated to visualize the flow in detail at these positions. Vortex and shear stress evolution during
the heart cycle was subsequently tracked to study the vortex
stability.
III. RESULTS
A. Kernel Deconvolution With Q-Masking: Phantom Data
Fig. 4 shows the results of the PC MRI and CFD velocity
field analysis in the aneurysm phantom measured for a single
time step and scale of σ = 0.28 mm. The direction of the arrows
in the 3-D rendering figures denotes the vortex axis of rotation,
the length and color represents the vortex magnitude. This 3-D
view allows a quick overview of flow characteristics. In one of
the vortex cores, 2-D slices are generated to inspect detection

Fig. 4. Aneurysm phantom flow pattern analysis of PC MRI data (top) and
CFD data (bottom) in the aneurysm phantom. In the left figures the phantom
surface is rendered. The arrows represent the vortex axes. The strength of the
vortex is depicted by the length and color of the arrow. In the right figures the
2-D visualizations of the velocity (arrows) and vorticity quantification (colored
surfaces) are shown. The dark red colors of the surface visualization depict the
center and magnitude of the vortex.

results and explore the region of interest in more detail. The blue
small arrows in the 2-D planes depict the flow velocity within
that plane. This figure shows that the flow indeed rotates around
the detected vortex center. As can be seen in this figure, two
main vortex areas are located in the central part of the aneurysm
for both imaging modalities. Comparison of the analysis of the
CFD and MRI generated velocity fields indicates that there is
only a small difference in direction and magnitude, suggesting
that MR and CFD-based velocity assessment are quite similar.
B. Kernel Deconvolution With Q-Masking: Patient Data
For the patient data, we here also present the multiscale analysis. Fig. 5 shows the analysis results for patient 1 for two
different scales. This figure indicates that the flow behavior is
rather different at different scales.
The figure shows that the vortex rotation axis flips from the
z- to xy-direction at increasing scale. In the cutting planes of the
σ = 0.28 mm image, two local vortex areas are visible. A blank
area separates the two vortex areas, which is the result of the
masking with the Q-criterion. For a larger scale of σ = 1 mm,
only one large vortex region remains.
This means that the global velocity pattern inside the
aneurysm is dominated by one large vortical motion having
its rotation axis in the x-y direction while locally small vortices
with different rotation axes are present. In this case, both at small
and large scale, vortices are found in the same position whereas
Fig. 6 illustrates that locally detected vortices for patient 2 and
3 also vary in position and rotation axis at the two different
scales. This figure shows that a general (large or small local
scale) description of vortex patterns is not enough to fully grasp
flow behavior inside an aneurysm because details at different
scales may be missed.
The dynamic behavior of the vorticity during the heart cycle is
illustrated in Fig. 7. During the heart cycle, flow changes considerably, which is also illustrated by the change of vortex center

FELICIANI et al.: MULTISCALE 3-D + t INTRACRANIAL ANEURYSMAL FLOW VORTEX DETECTION

Fig. 5. Three-dimesnsional visualization of kernel deconvolution with
Q-masking analysis applied for σ = 0.28 mm (top-left) and σ = 1.00 mm (topright) for patient 1. Two-dimensional slice detail for vortex pattern detected at
different scale are shown in middle and bottom images with blue vectors representing velocity profiles. The dark red colors of the surface visualization depict
the center and magnitude of the vortex.

1359

Fig. 7. Kernel deconvolution with Q-masking analysis results at different time
steps applied to patient 1 (top), 2 (middle), and 3 (bottom) at a scale of 0.28 mm.

position, direction, magnitude, and number of vortex centers.
The identification of the vortices at different times allows the
tracking of these variations and inspection of their evolution. For
example, in patient 3 at the beginning of the cardiac cycle (see
t = 2 in Fig. 6) small vortices are present rotating around x-y
axis whereas at time t = 12 and 24 we find completely different
patterns with axis of rotation perpendicular to the initial axis of
rotation. Please note the difference in magnitude of the vorticity
between patients. This may be explained by differences in flow
patterns, or flow magnitudes in the afferent arteries. Two movies
of this vortex center evolution are available as supplementary
data (see http://ieeexplore.ieee.org).
C. Time-Resolved Sm Criterion

Fig. 6. Kernel deconvolution with Q-masking results for patient 2 and 3 for
σ = 0.28 mm (left) and σ = 1.00 mm (right).

The evolution of shear stress using the Sm -criterion is illustrated in Fig. 8. The arrow color plotted according to |Sm |
represents shear stress strength, the arrow direction and length
reflect the local velocity vector field. This kind of visualization
is employed to inspect unstable shear stress regions, which are
often associated with aneurysm growth in the literature [26]. In
patient 2, the local maximum shows a constant behavior over
the heart cycle. In the two other cases, shear stress profiles are

1360

Fig. 8

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Sm Criterion applied for different time steps (from left to right) and for different patients (top to bottom) at σ = 0.28 mm.

dynamically unstable. For example, in patient 1, strong shear
components are found at t = 2 in the direction of the vessel
inflow, which migrate toward more distal locations. In patient 3
at time step 12, a strong shear component arises pointing toward
the lobulation inside the dome and is present until the end of the
heart cycle.
IV. DISCUSSION
We have presented a method for the visualization and analysis of time-resolved 3-D flow features in intracranial aneurysms.
Kernel deconvolution with Q-masking applied at small scales
provides an initial impression of the most interesting flow features, while vortex center detection at large scales, gives an
impression of the global intraaneurysmal behavior. With this
method, it is possible to identify regions with high vorticity and
shear stress areas on different scales and to follow their evolution during the heart cycle. The method, successfully tested
on artificial phantoms and on patient data, proved to be reliable and effective to visualize specific flow characteristics. CFD

simulated velocity and PC MRI measured velocity data in the
aneurysm phantom agreed well in location and orientation of
the vertices. We have shown that these flow patterns evolve over
time and are different for different scales, which emphasizes the
importance of analysis of intraaneurysmal scale for the whole
heart cycle. Stability of vortex patterns in time, which is another
important parameter in risk of rupture assessment, can be scored
with the proposed pipeline. Moreover, changes in magnitude and
location of shear stress are also detected and may have important relations with aneurysm growth. This algorithm has the
potential to quantify vorticity behavior and help understanding
aneurysm flow behavior. In current literature [7], [10], pipelines
for qualitative aneurysm risk assessment are presented. However, the inner structure of flow at different scale is rarely taken
into consideration. Furthermore, quantitative methods able to
score local vortex stability and shear stress magnitude can be
implemented in the algorithm and used in large-scale studies to
improve intracranial aneurysmal risk assessment.
In clinical studies, vortex behavior has been associated with
rupture status. In near-future studies, the quantified measures

FELICIANI et al.: MULTISCALE 3-D + t INTRACRANIAL ANEURYSMAL FLOW VORTEX DETECTION

as presented here, need to be associated with these qualitative
measures such as they are now included in studies that associate intracranial hemodynamics with aneurysm rupture risk. A
quantitative approach as presented here may reduce the interobserver variability and potentially increase the predictive value of
vortex instability. Since the generation and interpretation of the
quantified results still require quite some effort, future perspectives are to automatize the detection allowing quantification of
parameters in large populations. We believe that this is helpful
in future clinical treatment decision. However, the agreement of
the presented quantitative measurements with qualitative assessments needs to be studied in more detail in future longitudinal
studies with larger patient populations.
Vortex detection may appear relatively easy using animations of streamlines or similar visualization. However, the low
interobserver agreement associated with vortex classification
suggests otherwise. Moreover, especially for smaller scales, the
presented algorithm suggested vortex cores that were not observed by the initial visual analysis of the streamlines. Only
careful inspection of the flow vectors in the 2-D planes in the
detected vortex centers showed that indeed small-scale vortices
were present in the image data. Therefore, we believe that the
suggested approach in which local maxima of vortex magnitude
are detected and subsequent 2-D planar visualization of the velocity vectors results in a more detailed and correct description
of intraaneurysmal flow.
The vortex quantification allows for a quantitative comparison
of flow fields originating from different modalities. In [8], the
singular energy of flow characteristics obtained with MR and
CFD were compared indicating good agreement in systole, and
differences in diastole flow patterns due to low signal to noise
ratios.
Aneurysm initiation and rupture is the result of vascular wall
failure rather than resulting from hemodynamic behavior solely.
When the cerebral artery wall has become too weak to resist
hemodynamic pressure it distends, subsequent wall degeneration may lead to impaired endothelial function. Intraaneurysmal
flow conditions may subsequently decellularize and degenerate
the arterial wall making it prone to rupture [27].
We should notice that this study suffers from a number of
limitations. First, the CFD computations depend on a number
of assumptions that may not hold: Newtonian fluid, rigid vessel walls. Furthermore, no mesh refinement studies have been
performed prior to analyzing the CFD results.
We have presented a multiscale analysis, but detailed information on the relevance of different vortex scales for aneurysm
growth and risk of rupture remains unanswered. Based on current literature, we believe that both small-scale vortices [10],
[28]–[30] and large-scale vortices [15], [31] have a degenerative
biological effect. Here, only two vortex scales were presented.
Still, this confirms that there is indeed a scale-dependence of
vorticity in the flow patterns. In a subsequent study, the scale
selection for maximum agreement with clinical interpretation
and rupture status will be addressed. However, this was beyond
the scope of this study. The multiscale approach may result in
a data increase rather than a simplification of the interpretation
of the flow data. In future practice, large-scale vortices may

1361

be presented initially, after which smaller scale structures may
be studied consequently by decreasing scale with a graphical
user interface. However, this approach has not been tested in
this study. Our method has been applied for the quantification
of intracranial aneurysmal flow. However, it is not limited to
this application area. It may potentially quantify flow features
in other applications such as intraventricular flow [32], flow in
jugular veins [33], and aortic root flow patterns [34]. However,
this was beyond the scope of this study.
V. CONCLUSION
We have presented a full-fledged scale dependent and dynamic vortex identification and quantification method. This
method has been applied to a phantom model and three patientspecific flow fields illustrating temporal and scale-dependency
of the vortical flow patterns. The quantification of vortices has
the potential to be implemented in large-scale clinical studies
to associate rupture status with vortex stability, creation, and
termination. The scale-dependence of this approach may allow
the detection of smaller scale vortices that may be obscured in
conventional visualization schemes.
REFERENCES
[1] J. L. Brisman et al., “Cerebral aneurysms,” New Engl J. Med.,
vol. 355, pp. 928–939, 2006.
[2] F. Proust and E. Gérardin, “Unruptured intracranial aneurysm and microsurgical exclusion: The need of a randomized study of surgery versus
natural history,” J. Neuroradiol., vol. 35, no. 2, pp. 109–115, Jan. 2002.
[3] J. Raymond et al., “Long-term angiographic recurrences after selective endovascular treatment of aneurysms with detachable coils,” Stroke,
vol. 34, no. 6, pp. 1398–1403, Jun. 2003.
[4] Y. Murayama et al., “Guglielmi detachable coil embolization of cerebral
aneurysms: 11 years’ experience,” J. Neurosurg., vol. 98, no. 5, pp. 959–
966, May 2003.
[5] M. R. Crompton, “Mechanism of growth and rupture in cerebral berry
aneurysms,” Brit. Med. J., vol. 1, pp. 1138–1142, 1966.
[6] H. Nakatani et al., “Cerebral blood flow patterns at major vessel
bifurcations and aneurysms in rats,” J. Neurosurg., vol. 74, no. 2,
pp. 258–262, 1991.
[7] J. R. Cebral et al., “Efficient pipeline for image-based patient-specific
analysis of cerebral aneurysm hemodynamics: Technique and sensitivity,”
IEEE Trans. Med. Imag., vol. 24, no. 4, pp. 457–467, Apr. 2005.
[8] P. Van Ooij et al., “3D cine phase-contrast MRI at 3T in intracranial
aneurysms compared with patient-specific computational fluid dynamics,”
AJNR. Amer. J. Neuroradiol., vol. 34, no. 9, pp. 1785–1791, 2013.
[9] A. Chien et al., “Patient-specific hemodynamic analysis of small
internal carotid artery-ophthalmic artery aneurysms,” Surg. Neurol.,
vol. 72, no. 5, pp. 444–450, Nov. 2009.
[10] J. R. Cebral et al., “Characterization of cerebral aneurysms for assessing
risk of rupture by using patient-specific computational hemodynamics
models,” AJNR. Amer. J. Neuroradiol., vol. 26, no. 10, pp. 2550–2559,
2005.
[11] J. J. Schneiders et al., “Rupture-associated changes of cerebral aneurysm
geometry: High-resolution 3D imaging before and after rupture,” AJNR
Am. J. Neuroradiol., vol. 35, no. 7, pp. 1358–1362, 2014.
[12] J. Xiang et al., “Hemodynamic−morphologic discriminants for intracranial aneurysm rupture,” Stroke, vol. 42, no. 1, pp. 144–152, 2011.
[13] M. a Castro, “Understanding the role of hemodynamics in the initiation,
progression, rupture, and treatment outcome of cerebral aneurysm from
medical image-based computational studies,” ISRN Radiol., vol. 2013,
pp. 1–17, Jan. 2013.
[14] M. A. Castro et al., “Hemodynamic patterns of anterior communicating artery aneurysms: A possible association with rupture,” AJNR. Amer.
J. Neuroradiol., vol. 30, pp. 297–302, 2009.
[15] J. R. Cebral et al., “Association of hemodynamic characteristics and
cerebral aneurysm rupture,” AJNR. Amer. J. Neuroradiol., vol. 32, no. 2,
pp. 264–270, Feb. 2011.

1362

[16] J. Jeong, “On the identification of a vortex,” J. Fluid Mech., vol. 285,
pp. 69–94, 1995.
[17] D. Bauer, “Selective visualisation of unsteady 3D Flow using scale-space
and feature-based techniques,” Ph.D. dissertation, Dept. Comput. Sci.,
Swiss Federal Inst. Technol.( ETH), Zurich, Germany, 2006.
[18] T. Schafhitzel et al., “Visualizing the evolution and interaction of vortices
and shear layers in time-dependent 3D flow,” IEEE Trans. Vis. Comput.
Graph., vol. 17, no. 4, pp. 412–425, Apr. 2010.
[19] T. Schafhitzel, “Topology-preserving λ 2 -based vortex core line detection
for flow visualization,” in Proc. IEEE-VGTC Symp. Vis., 2008, vol. 27,
no. 3, pp. 1023–1030.
[20] S. Meckel et al., “In vivo visualization and analysis of 3-D hemodynamics
in cerebral aneurysms with flow-sensitized 4-D MR imaging at 3 T,”
Neuroradiology, vol. 50, no. 6, pp. 473–484, Jun. 2008.
[21] H. A. Marquering et al., “Multiscale flow patterns within an intracranial
aneurysm phantom,” vol. 58, no. 12, pp. 3447–3450, 2011.
[22] W. Liu and E. Ribeiro, “Scale and rotation invariant detection of singular
patterns in vector flow fields,” in Proc. Jt. IAPR Int. Conf. Struct. Syntactic,
Stat. Pattern Recognit., 2010, pp. 522–531.
[23] J. Jeong, “On the identification of a vortex,” J. Fluid Mech., vol. 285,
pp. 69–94, Feb. 1995.
[24] P. Van Ooij et al., “Complex flow patterns in a real size intracranial
aneurysm phantom: Phase contrast MRI compared with particle image
velocimetry and computational fluid dynamics,” NMR Biomed., vol. 25,
pp. 14–26, 2012.
[25] C. Li et al., “Level set evolution without re-initialization: A new variational formulation,” in Proc. IEEE Comput. Soc. Conf. Comput. Vis.
Pattern Recognit., 2005, vol. 1, pp. 430–436.
[26] H. Meng et al., “High WSS or Low WSS? complex interactions of
hemodynamics with intracranial aneurysm initiation, growth, and rupture:
Toward a unifying hypothesis,” AJNR. Amer. J. Neuroradiol., vol. 35,
pp. 1254–1262, 2014.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

[27] J. Frösen et al., “Saccular intracranial aneurysm: Pathology and mechanisms,” Acta Neuropathol., vol. 123, no. 6, pp. 773–86, Jun. 2012.
[28] E. S. Di Martino et al., “Fluid-structure interaction within realistic threedimensional models of the aneurysmatic aorta as a guidance to assess
the risk of rupture of the aneurysm,” Med. Eng. Phys., vol. 23, no. 9,
pp. 647–655, Nov. 2001.
[29] D. Bluestein et al., “Steady flow in an aneurysm model: Correlation
between fluid dynamics and blood platelet deposition,” J. Biomech. Eng.,
vol. 118, no. 3, pp. 280–286, Aug. 1996.
[30] E. A. Finol and C. H. Amon, “Blood flow in abdominal aortic aneurysms:
Pulsatile flow hemodynamics,” J. Biomech. Eng., vol. 123, no. 5, p. 474–
484, 2001.
[31] M. D. Ford et al., “On the effect of parent-aneurysm angle on flow patterns
in basilar tip aneurysms: Towards a surrogate geometric marker of intraaneurismal hemodynamics.,” J. Biomech., vol. 41, no. 2, pp. 241–248, Jan.
2008.
[32] L. Agati et al., “Quantitative analysis of intraventricular blood flow dynamics by echocardiographic particle image velocimetry in patients with
acute myocardial infarction at different stages of left ventricular dysfunction,” Eur. Heart J. Cardiovasc. Imag., vol. 15, pp. 1203–1212, Jun. 2014.
[33] M. Mancini et al., “Internal jugular vein blood flow in multiple
sclerosis patients and matched controls,” PLoS One, vol. 9, no. 3,
p. e92730, Jan. 2014.
[34] G. Querzoli et al., “Fluid dynamics of aortic root dilation in Marfan
syndrome,” J. Biomech., vol. 47, pp. 3120–3128, Sep. 2014.

Authors’ photographs and biographies not available at the time of publication.

