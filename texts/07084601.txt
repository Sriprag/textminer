2260

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Left-Ventricle Segmentation of SPECT Images
of Rats
Pierre-Marc Jodoin∗ , Fredy Pinheiro, Alexandra Oudot, and Alain Lalande

Abstract—Single-photon emission computed tomography
(SPECT) imaging of the heart is helpful to quantify the leftventricular ejection fraction and study myocardial perfusion
scans. However, these evaluations require a 3-D segmentation of
the left-ventricular wall on each phase of the cardiac cycle. This
paper presents a fast and interactive graph cut method for 3-D
segmentation of the left ventricle (LV) of rats in SPECT images.
The method is carried out in three steps. First, 3-D sampling of
the LV cavity is made in a spherical-cylindrical coordinate system.
Then, a graph-cut-based energy minimization procedure provides
delineation of the myocardium centerline surface. From there, it
is possible to outline the epicardial and endocardial boundaries
by considering the second statistical moment of the SPECT
images. An important aspect of our method is to always produce
anatomically coherent U-shape results. It also relies on only two
intuitive parameters regulating the smoothness and the thickness
of the segmentation result. Results show not only that our method
is statistically as accurate as human experts, but it is one order of
magnitude faster than a state-of-the-art method with a processing
time of at most 2 s on a 4-D cardiac image after having determined
the LV orientation.
Index Terms—Graph cut, image segmentation, myocardium,
single-photon emission computed tomography (SPECT).

I. INTRODUCTION
mall animals are widely utilized in preclinical studies.
Common preclinical cardiac studies rely on different
modalities such as magnetic resonance imaging (MRI), X-ray
computed tomography (CT), positron emission tomography
(PET) scans, and single-photon emission computed tomography
(SPECT) scans. Typically, MRI and CT scans provide anatomical information, while PET and SPECT produce functional
images. PET and SPECT are thus helpful to locate tissues that
might be ill or dysfunctional.
Both PET and SPECT allow for 3-D visualization of tracer
distributions in the cardiac muscle and, more specifically, in the
left ventricle (LV). Synchronization of the image acquisition

S

Manuscript received November 18, 2014; revised February 5, 2015 and March
23, 2015; accepted March 29, 2015. Date of publication April 13, 2015; date
of current version August 18, 2015. This work was supported by a French
Government grant managed by the French National Research Agency (ANR)
under the program “Investissements d’Avenir” (reference ANR-10-EQPX-0501/IMAPPI Equipex), the Canadian NSERC discovery Grant 349975, and by
Imeka Solution, Inc. Asterisk indicates corresponding author.
* P.-M. Jodoin is with the Department of Computer Science, University of
Sherbrooke, QC J1K 2R1, Canada, and also with Imeka Inc., QC J1K 0A5,
Canada (e-mail: pierre-marc.jodoin@usherbrooke.ca).
F. Pinheiro and A. Oudot are with the Plateforme d’imagerie Préclinique.
A. Lalande is with the Le2I, Universite de Bourgogne.
This paper contains supplemental material available online at http://
ieeexplore.ieee.org (File size: 13 MB).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2422263

Fig. 1. Cardiac SPECT scan of a rat’s LV. Images show the short-axis and
long-axis views during systole and diastole periods. The white blob below the
LV is the liver.

with the ECG (gated-SPECT imaging for example) provides
information on the contraction of the heart over the cardiac
cycle as well as the metabolism of the cardiac muscle cells.
Viability study of the heart can also be performed with MRI
techniques, but, to our knowledge, these approaches do not provide high-resolution isotropic 3-D images in preclinical studies. They often come with a high in-plane resolution (typically
0.5 × 0.5 mm2 ) but a large slice thickness (typically 3–6 mm).
Also, the epicardial wall has a very low contrast next to the diaphragm in MR images, and the well-defined papillary muscles
make it difficult to segment the cavity.
SPECT and PET scanners have their pros and cons. One
advantage of SPECT preclinical studies is that their acquisition protocol is very close to the one used in clinical practices.
However, there are important limitations to preclinical cardiac
nuclear imaging. First, while human heart is about 13 cm long
and 8 cm wide, rat heart is more than ten times smaller (roughly
a semiellipsoid shape of 12-mm length and 6-mm diameter with
a 2 mm thickness of the myocardial wall). Since the resolution
of preclinical gamma cameras is not ten times larger than the
clinical ones, it is fundamentally difficult to obtain highly accurate images with rodents. In fact, NanoSPECT-CT intrinsic
resolution is 2.8 mm and pinhole collimator resolution (used for
ECG-gated rat heart imaging) is 2.0 mm, while clinical systems
intrinsic and collimator resolutions are, respectively, 4 and 7–
8 mm. Consequently, preclinical SPECT volumes can only picture the LV with a few pixels (see Fig. 1). The second important
difference between rat and human cardiac nuclear imaging resides in the different heart rate. While it is roughly 400 beats/min
for the rat, it is only 70 beats/min for a human. This leads to the
need for temporally high-resolution preclinical systems because
each cardiac gate lasts for only 10–12 ms (for a 12-frames-percycle image, i.e., six times lower than for a human). Since the
acquisition time of preclinical systems is not six times lower
than the clinical systems, motion blur artifacts always appear in
preclinical cardiac images.
Another challenge with preclinical nuclear images is the fact
that the heart can be pressed against the liver, which often
appears in light grayscale (see Fig. 1). This leads to a fuzzy

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

JODOIN et al.: LEFT-VENTRICLE SEGMENTATION OF SPECT IMAGES OF RATS

border, which can hardly be recovered by basic thresholding or
active contour segmentation methods.
A cardiac scan typically renders 8–16 3-D volumes, each being associated to a specific time (or “gate”) of the cardiac cycle.
Since each 3-D volume contains roughly 30 slices along the
short-axis orientation, manual delineation of the LV is inappropriate in a day-to-day practice. However, segmenting the LV
is important to locate the endocardial and epicardial borders at
every period of the cardiac cycle. LV segmentation allows thus
to compute the stroke volume and the ejection fraction (EF),
and also to perform bull-eyes’ graphics to display the cardiac
metabolism map [1].
In this paper, we present a 3-D segmentation method designed
to segment the LV of a small animal based on SPECT images.
This is a challenging task due to the previously mentioned drawbacks of small animal SPECT images. Our method uses a 3-D
graph cut procedure, which locates the myocardium centerline
surface. Although our method does not implement a shape prior
model, the end result is guaranteed to have the right anatomical
U shape. This is made possible by performing segmentation in a
spherical-cylindrical (S-C) space instead of an Euclidean space
as is usually the case. Conversion from the Euclidean space to
the S-C space is done by dividing the LV into a spherical part
(the apex of the LV) and a cylindrical part (the base of the LV).
These two parts are then sampled with rays along which intensities are integrated. This operation converts the U shape of the
heart (in the Euclidean space) into a quasi-planar surface in the
S-C space. The centerline surface of the LV is then located with
a simple dynamic programming approach which, in our case,
is performed with graph cut. The epicardial and endocardial
boundaries are then found by considering the second statistical
moment along the S-C rays.
The main contributions of this study are threefold.
(1) Our system uses an Euclidean-to-SC-space projection together with a graph cut procedure. By combining both,
our system ends up enforcing a unique implicit 3-D Ushape prior. This U-shape prior comes with no extra parameter and prevents our system from producing anatomically impossible results. This aspect of our method is
presented in Sections III-A and III-B.
(2) Our system depends on only two intuitive parameters
regulating the smoothness and the thickness of the segmentation result. The influence of these two parameters
are presented in the results section.
(3) Our system is very fast with processing times of 2 s for
a 4-D SPECT image and a mid-end laptop computer.
The results are statistically as accurate as an experienced
human operator.
II. PREVIOUS WORK
A. Thresholding Procedures
SPECT images are generated by camera detectors, which
detect gamma rays emitted by a radioactive tracer injected inside the body. Radioactive tracers such as technetium are made
of an unstable radioactive atom bound to a carrier molecule
that naturally ends up in active cells. Since the distribution of

2261

the radioactive tracer in the myocardium is proportional to the
blood flow, SPECT images display information on the perfusion and the metabolism of the cardiac muscle cells. Thus, in
normal tissues, the stronger the SPECT signal is in the vicinity
of the heart, the more probable that area is located inside the
myocardium.
Consequently, several SPECT left-ventricular segmentation
methods rely on one (or several) threshold to locate the LV.
For these methods, pixels with intensity values above a certain
threshold are set to 1, while pixels not fulfilling this requirement
are set to 0. In medical imaging, it is common to interactively
apply a threshold to outline a region of interest. Morphological
operations are then used to smooth out and separate the region
from other tissues [2]. Yamashita et al. [3] adopt a cylindrical
coordinate system with the origin in the center of LV cavity.
The cylindrical coordinate system generates rays to sample the
3-D space. The LV boundaries are then detected by applying
a threshold to each ray [4]. Daou et al. [5] figured out that the
“optimal” threshold value should be set to 35% of the maximum
voxel intensity measured inside the LV area. In a more recent
paper, Soneson et al. [6] use 55% of the maximum voxel intensity as a threshold. They then postprocess the resulting 3-D
volume with a 12-region atlas as well as a series of operations
to remove isolated regions. Lee et al. [7] use a threshold which
they set to 75% of the maximum intensity value to remove noise
inside the cavity and around the heart. They then locate the LV
by fitting a Gaussian distribution on the radial grayscale profile
of the remaining pixels. Other methods use adaptive thresholds
to determine the best threshold value [8], [9].
The resulting segmentation map is then often used to fit two
ellipsoids: one for the epicardium and one for the endocardium
[1], [10]–[12]. Van Kriekinge et al. [12] use a threshold to
determine the center point of the LV, which serves as the origin of
the radial coordinate system. With the help of a radial coordinate
system, a cloud of points is calculated and an ellipsoid is fitted
to the cloud to discard the outliers. Lomsky et al. developed a
cardiac shape model from 50 selected patient studies [13]. The
method tries to fit its cardiac model with the image data obtained
after a thresholding procedure.
Overall, methods relying on thresholds work well on humans
but often fail on small animals. Furthermore, since they often
rely on a collection of postprocesses (morphological filters, surface fitting, etc.), they often have a strong heuristic flavor, which
prevents them from generalizing well to pathological cases.
B. Active Contours
Another family of methods are those using deformable models (e.g., snakes and level sets). Most of these methods are
initialized by the user specifying an initial contour around the
object. The active contour converges slowly to its closest configuration of minimum energy. It is assumed that the minimum
energy is reached when the contour fits the boundaries of the
object. Rakotobe et al. [14] use a deformable model to segment
the LV in SPECT images. The method does not delineate the
epicardium or the endocardium but rather a centerline surface in
the myocardium. Stegger et al. [15] use also an elastic surface

2262

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

model to detect the mid-myocardial contour. Garcia-Panyella
and Susin implemented a basic snake model using a gradient
vector field as the external force [16]. Unfortunately, they only
validated their method on synthetic images, and thus, it is difficult to figure out how their method behaves on real images.
Dedic et al. [17] developed a new method based on geodesic
deformable models. Their model assumes that on the short-axis
orientation, the cardiac contours can only move in a direction
normal to the contour. Unfortunately, the proposed method was
only tested on 2-D slices of the LV, and thus, it is not clear
how it could generalize to 3-D. Let us also mention that since
3-D echocardiography segmentation has similar constraints as
SPECT, several active contour methods published in that area
could potentially be adapted to SPECT [18]–[20].
Although deformable models have been shown successful
for the LV segmentation, they are not void of limitations. First,
since the contour moves toward the strongest gradient, it can
be attracted toward other organs with larger intensity gradients
(typically, the liver in the case of small animals as shown in
Fig. 1). Also, when the myocardium does not have well-defined
borders, the contour may not find the correct borders and start
“bleeding” outside or inside the heart. This is usually the case
when the animal had a stroke. This problem can be tackled with
a shape prior such as in [19], where two elliptic shape priors
are used to force the contour to have an anatomically plausible shape, or with an active shape model [21]. Debreuve et al.
[22] developed a level set approach in a space-time segmentation process applied on an initial truncated hollow ellipsoid
shape (one shape for each contour). The segmentation of the
endocardial and epicardial borders at each frame integrates the
information of the entire sequence. However, this method does
not manage hypoperfused regions. Another solution is the one
by Kohlberger et al. [23] who proposed a level set approach
with constraints on the myocardial thickness. Another problem
associated with active contours is their slow speed, which makes
them undesirable for interactive segmentation. To deal with this
issue, Galluzzo et al. [20] came out with a GPU implementation
of level sets for the LV segmentation of the heart. Although other
approaches can be used to speedup active-contouring (e.g., narrow banding, “ballooning terms,” fast marching methods, etc.),
they often lead to relatively complicated implementations with
several parameters to tweak.
C. Other Approaches
While most previous works target human heart segmentation,
there are very few methods focusing on small animal cardiac
segmentation per se. The problem with SPECT images for small
animals is that they are both blurry and have very low resolution. It is thus difficult to identify the precise location of the
myocardium walls. Fig. 6 illustrates the situation where even
experts might not agree on which of those segmentation is the
best. To our knowledge, preclinical studies are often performed
using segmentation software made for human hearts, or generic
segmentation software that were not meant to be used specifically on SPECT cardiac images. For example, a software called
Segment [24] that uses a deformable model initially designed

for cardiovascular MRI is sometimes used on small-animal cardiac SPECT images. Soneson et al. [25] compared the behavior
of this tool on cardiac SPECT data with other available packages designed for clinical studies such as QGS [1], MyoMetrix,
ECTb [9], and Exini Heart [13]. Their conclusion is that, given
an MRI-based groundtruth, the LV volume and the EF results
produced by Segment are as accurate as other commercial software packages. However, commercial software generally underestimates the cavity volumes due to the limited spatial and
temporal resolution of clinical images [25]. This limitation is a
clear disadvantage when dealing with preclinical images of rats
and mice. To our knowledge, there is no well-validated commercial software dedicated to cardiovascular micro-SPECT images.
In this paper, we propose a fast method for endocardium
and epicardium segmentation. It uses a S-C coordinate system
together with graph cut to delineate the myocardium center
surface, and from there, the epicardial and endocardial borders
are segmented. Unlike several other methods, our approach does
not rely on any postprocessing such as morphological operations
and ellipse fitting.
III. OUR METHOD
This section presents the three main steps of our method:
1) conversion from the Euclidean space to the S-C space; 2)
localization of the myocardium center surface with graph cut;
and 3) localization of the epicardial and endocardial wall of
the LV.
A. S-C Space
Like us, several methods make the assumption that the LV has
an anatomical U shape [19], [26]. They do this with an ellipsoid
3-D shape [19] or some kind of 3-D cup with a cylindrical
shape at the bottom and a hemispherical shape at the apex as in
Fig. 2(a) [27]. Previous methods use this information as a shape
prior to help segment the LV [19] or as an explicit shape that
they fit on the image grayscale [26].
Our method is fundamentally different from these previous
approaches since it does not work in the Euclidean space. Instead, our method works in an S-C space. In the S-C space, a
plane corresponds to a 3-D U shape (or cup) in the 3-D Euclidean space. In this way, working in the S-C space allows us
to implicitly enforce a U shape prior to the segmented result.
In order to convert the input 3-D image from the Euclidean
space to the S-C space, the base and the apex of the LV have to
be identified. To do so, the user first defines the center of the LV
cavity from the long-axis view. He then places a T-bar target at
the base and extends it all the way to the apex as in Fig. 2(b).
Note that these three clicks are the only operations performed
by the user.
Then, the S-C image is generated by casting rays perpendicular to the U shape. From the T-bar target, rays are generated in
cylindrical and radial directions in the 3-D space. This is illustrated by the thin red lines in Fig. 2(c). Each ray is associated
with a radial angle θ, a height value H, or an elevation angle α as
shown in Fig. 2(a). In this way, every Euclidean voxel (x, y, z)
within the cylindrical area is assigned an (R, H, θ) coordinate,

JODOIN et al.: LEFT-VENTRICLE SEGMENTATION OF SPECT IMAGES OF RATS

2263

Fig. 2. Voxels (x, y, z) with the same S-C radius coordinate R fall onto the same U shape [green dotted line in (b) and (d)]. In the S-C space, those voxels
fall onto the same vertical line. The S-C image is obtained by integrating grayscale values along S-C rays in the Euclidean space. (a) Three-dimensional U-shape
model, (b) determination of the base and of the apex of the LV, (c) generation of rays perpendicular to the U-shape, and (d) a 2-D slice of the 3-D S-C image.

while those within the top hemisphere are assigned an (R, α, θ)
spherical coordinate. Grayscale integration is then performed
along these rays. Rays are then stacked up into a 3-D image so
that each line R in the 3-D image corresponds to a sampled ray
in the 3-D Euclidean space. This results into a 3-D S-C image
whose axes are the radial axis R, the rotation angle θ, and the
elevation position in the cylinder or the hemisphere part (variables H and α). As shown in Fig. 2(d), we represent the H/α
axis with the letter Γ.
Let us mention that the size of the 3-D S-C image is proportional to the total number of rays and the step size by which R
has been sampled. In our case, we use 16 radial angles θ, 32
H/α values, and R is sampled into 60 elements. This leads to a
resulting S-C image of size 60 × 32 × 16.
Let us also mention that in our implementation, we fixed
the height of the cylindrical coordinate system to be 55% of
the distance between the basal and the apex. The radius of the
hemisphere is thus 45% of that distance. These proportions and
the number of rays were obtained empirically.

B. Graph Cut
The second step of the method is to find the myocardium
center surface inside the 3-D S-C image. As mentioned in the
first paragraph of Section II, the higher the SPECT signal is
at a pixel, the more probable that pixel is to lie inside the LV
muscle. As proposed by Nekolla et al. [4], one can locate the
myocardium centerline by selecting the maximum value along
the R dimension following a maximum likelihood procedure.
Although this approach works well for PET images of a human
LV [4], it drastically fails for SPECT images of small animals.
The top two images of Fig. 3 show the result of this approach.
As can be seen, the resulting surface is far too noisy to be of any
use. One can also use a threshold to locate the brightest pixels
as suggested by Soneson et al. [6] as well as some commercial
software packages such as QGS [1]. But, as shown in the bottom
images of Fig. 3, one single threshold cannot work on all images
acquired during the cardiac cycle. For example, a large threshold
might give good results in systole, but a result with holes in
diastole, which is anatomically impossible. On the other hand, a
small threshold gives a good result in diastole but overestimates
the LV in systole (it fills in the cavity).

Fig. 3. (a) Center line of the myocardium obtained with a maximum likelihood
method similar to that in [4] applied along each line of the radial dimension
R and 3-D view of the resulting LV. (b) Result obtained with a thresholding
method. Two thresholds have been used at two different time instant of the
cardiac cycle.

An alternative for a 2-D S-C image such as the one in Fig. 2(d)
is to find the maximum value along each line with a dynamic
programming procedure. In this case, the myocardium center
line becomes the shortest path between the top and the bottom
of the S-C image. Since dynamic programming prevents from
having strong discontinuities, the resulting solution is guaranteed to be smoother than that of maximum likelihood. In the
case of a 3-D S-C image, the dynamic programming procedure
needs to be generalized to 3-D which is far from trivial. As an
alternative solution, we use graph cut.
Graph cut uses a weighted graph G = {N , Σ} made of nodes
N connected by edges Σ. Each edge eab ∈ Σ connects two
nodes a ∈ N and b ∈ N and is associated with a weight (or
capacity) wab ≥ 0. The weight of an edge eab indicates how
much “flow” can circulate between a and b. The graph also
contains two terminal nodes: the source s and the sink t [28].
The source is the node out of which the flow comes and the sink
is the node into which the flow ends up.

2264

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

and wat . By doing so, we make sure that these edges are never
cut.
For the other edges, we distinguish between horizontal edges
ehab and vertical edges evab . As shown in Fig. 4, horizontal edges
ehab are those for which a = (R, Γ, θ) and b = (R + 1, Γ, θ).
Vertical edges are the ones perpendicular to ehab .
Horizontal edges are assigned the following weight:
h
wab
=e

Fig. 4. (a) Schematic representation of the graph. The source and the sink
nodes are connected to the first and last rows of voxels with infinite capacity.
−(I + I )
Horizontal and vertical edges are set to exp( 2aσ 2 b ) and β. (b) Red delineation is the output of graph cut (the center line of the epicardium), while in
blue and green curves are the epicardial and endocardial walls.

S, T, U = arg min C(S, T, U ).
S,T ,U

(1)

Finding the minimum cut calls for an optimization function.
In our case, we use alpha-expansion [29] although other methods
could be used. For more details on graph cut, please refer to [30]
and [31].
C. Finding the Myocardium Center Line
The end result of graph cut in terms of an application depends
on how the graph is built and which capacities are used. In
our case, we use a 3-D graph for which each node a ∈ N is
associated with a voxel in the S-C image. Also, each node in
the graph is connected to its six nearest neighbors. In other
words, each node (R, Γ, θ) is connected to nodes (R + 1, Γ, θ),
(R − 1, Γ, θ), (R, Γ + 1, θ), (R, Γ − 1, θ), (R, Γ, θ + 1), and
(R, Γ, θ − 1). Furthermore, as shown in Fig. 4, the source node
s is connected to the first row of nodes (those for which R = 0),
and the drain is connected to the last row of nodes (those for
which R = Rmax ).
Once the graph is built, we need to set a weight to each edge.
The weight should be carefully selected so the resulting cut
corresponds to large intensity values, i.e., where the centerline
of the myocardium is most likely to be. These intensity values
correspond to the bright vertical blurry shape in Fig. 4.
Since the LV center plane cannot go outside the S-C image,
we set to infinity the capacity of the source and drain edges wsa

(2)

where Ia and Ib are grayscale values of a and b in the S-C
image and σ is a noise parameter that we set to 0.6 for all our
h
, the grayscale
experiments. Note that prior to computing wab
values of the S-C image I are rescaled between 0 and 1.
As for the vertical edges, their capacity is set to a constant
value β that we call the smoothness term.
Since graph cut always finds the minimum cut, the resulting
solution is the one for which

wa,b
S, T, U = arg min
S,T ,U

The goal of graph cut is to divide the graph in two subsets
of nodes: S and T . To be
 valid, S and
 T must comply to the
following conditions: S T = ∅, S T = N , and s ∈ S, t ∈
T . Given two subsets S and T , we also have U , the set of edges
that connect nodes a and b from S to T such that a ∈ S and
b ∈ T.
A concept pivotal to graph cut is the notion of “cost.” The cost
of
a cut is the sum of all edges contained in U , i.e., C(S, T, U ) =
e a b ∈U wab . The goal of graph cut is to find the minimum cut,
i.e.,

−( I a + I b )
2σ 2

= arg min

S,T ,U

= arg min

S,T ,U

e a b ∈U



e va b

e ha b ∈U


e ha b ∈U



h
wa,b
+

e−

|I a −I b |
σ2

v
wa,b

∈U

+



β

(3)

e va b ∈U

where S, T, U are defined in the previous section. This equation
contains a data term and a smoothness term in a maximum a
posteriori Markov random field formulation [32]. The data term
makes sure that the center line of the myocardium falls onto
pixels with a large intensity value, while the smoothness term
makes sure that the myocardium is smooth and has no strong
discontinuities. With β = 0, our method computes a maximum
likelihood along each horizontal line R. It thus produces results
similar to the one in Fig. 3(a). With an increasing value of β, the
resulting solution becomes smoother. At the limit, with β → ∞,
the resulting value would be a straight line [like the dotted line
in Fig. 2(d)]. Since that line is in the S-C space, that would
convert into a perfect U shape in the Euclidean space. In other
words, the more vertically straight a myocardium center line is,
the smoother the resulting 3-D U shape will be. That is why we
say that our method implicitly enforces a U-shape prior.
The result of graph cut for β = 0.08 is shown as a red line in
Fig. 4(b). The reader shall keep in mind that this image is a 2-D
slice of a 3-D S-C volume. Although the result is shown as a
line, the actual result of graph cut is a 3-D manifold in the 3-D
S-C space and, thus, a 3-D volume in the Euclidean space.
D. Finding the Epicardial and Endocardial Boundaries
The last step of our method is to locate the epicardial and
endocardial boundaries. In that perspective, we assume that the
grayscale distribution along the radial axis follows a Gaussian
distribution. As shown in Fig. 5, this assumption is very close
to reality. The blue curve is the average 1-D intensity profile
along the radial R axis. We computed this blue curve by aligning each 1-D radial profile perpendicularly to the myocardial

JODOIN et al.: LEFT-VENTRICLE SEGMENTATION OF SPECT IMAGES OF RATS

2265

where Tep and Ten are thickness values. The larger these values
are, the thicker the wall will be. In the context of this paper, we
use T = Tep = Ten .
IV. RESULTS
A. Experimental Setup

Fig. 5.

Average intensity profile along the radial axis of three 4-D images.

centerline (the red line in Fig. 4) and then averaged their
grayscale (three 4-D images were used). As one can see, this
results into a well-defined bell curve. In the middle, there is the
myocardial centerline with the maximum intensity. On the left,
there is the dark cavity and the endocardium, and on the right,
the epicardium. Other authors such as Lee et al. [7] also observed that the LV radial grayscale distribution has a Gaussian
profile and used it to locate the LV walls.
When segmenting a 3-D image, our method first finds the
myocardium centerline with the graph cut procedure presented
earlier. Then, we need to estimate the thickness of the myocardium for each radial line of each gate of the 4-D image.
This is done by recovering the mean and variance over each
radial line of each gate. We do this by considering the second
central moment σ2 along each line R of the S-C image I, i.e.,

(R − μ̄)2 I(R, Γ, θ)
(4)
σ2 (Γ, θ) =
R

where μ̄ is the first central moment

RI(R, Γ, θ)
μ̄ = R
.
R I(R, Γ, θ)

(5)

Note that estimating μ and σ2 for each (Γ,θ) rather than
having a fix (μ, σ2 ) pair for the entire heart allows our method
to correctly fit the walls at every period of the cardiac cycle.
This is important since the thickness of the myocardium may
vary between the systolic and the diastolic phases. This also
allows us to adapt to cases for which the thickness varies within
a given 3-D volume, such as when the animal suffers from
hypoperfusion.
We also consider m(Γ, θ) to be the position of the myocardium for the (Γ, θ) line parallel to the R axis (m(Γ, θ)
corresponds to the position of a red dot when scanning from left
to right in Fig. 4(b)).
Given σ2 (Γ, θ) and m(Γ, θ), the endocardial en(Γ, θ) and
epicardial ep(Γ, θ) boundaries along each line can be localized
according to the following equations:
ep(Γ, θ) = m(Γ, θ) + Tep σ2 (Γ, θ)

(6)

en(Γ, θ) = m(Γ, θ) − Ten σ2 (Γ, θ)

(7)

For this paper, we used a NanoSPECT/CT small animal imaging tomographic γ-camera (from Trifoil Imaging, Inc., formerly
Bioscan, Inc., USA) and a technetium sestamibi (99m Tc) radioactive tracer. Twelve phases were acquired to cover the cardiac cycle, thanks to a gated-SPECT approach. The total acquisition time for each rat was approximately 40 min. All SPECT
images were acquired roughly 30 min after the injection of the
radioactive tracer. The isotropic pixel resolution for each image
is 0.7 × 0.7 × 0.7 mm3 .
Our study follows four rats, three of which developed a cardiac dysfunction. Cardiac dysfunction was induced by three
repeated injections at ten-day interval (beginning at day 0) of
an anticancer drug already reported to induce cardiac damage:
doxorubicin [33]. For each rat, we acquired images at five time
points, i.e., at time t = 0 (the baseline) and then after two weeks,
four weeks, six weeks, and eight weeks. These five time points
allow us to track in time the EF, which is very likely to decrease
for the rats who developed a cardiac dysfunction. Please note
that since two rats died just before the last acquisition, 18 4-D
images (3-D + time) have been used in this study. Also, every
result reported in this section has been obtained with the same
set of parameters.
B. Metrics
For each 4-D image, we calculated the LV diastolic volume
(LVDV in mm3 ), the LV systolic volume (LVSV in mm3 ), and
−LVSV
× 100).
the left ventricular EF (EF in %) (EF = LVDV
LVDV
Also, results obtained with our method were compared with
those obtained with manual segmentation provided by two experts. Manual drawing of the endocardical contour was blindly
done by each expert along the short-axis orientation of all 18
4-D images. The diastolic and systolic phases were manually
selected and fixed the same for both experts. We did so to make
sure the differences between manual tracings was not affected
by different choices for the cardiac phases.
Results from the two experts were compared with our method
(which we called “MiHeart”) as well as state-of-the-art method
by Klein et al. [27], which the authors called Flowquant. Klein
et al.’s method is a semiautomatic method using active contours.
Flowquant is often used in preclinical studies. As for the intraexpert variation study, we asked one of the experts to manually
outline twice all 18 4-D images over a two-month period.
Results were expressed in terms of a mean ± 1 standard
deviation. Statistical differences between groups were compared
with an unpaired two sample t-test. Like in many other studies
similar to ours, we consider that a p-value lower than 0.05
indicates that two sets of observations are statistically different
[34]. In other words, a p-value ≤ 0.05 means that the null

2266

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Fig. 7. Results of our method on 3-D images taken from two healthy rats [in
(a) and (b)] as well as images in which hypoperfusion was added [in (c) and
(d)].
Fig. 6. (a) Influence of different values of β and T on the calculation of the
EF. (b) Example of a 3-D segmentation.

TABLE II
COMPARISON BETWEEN OUR METHOD AND TWO EXPERTS

TABLE I
AVERAGE RESULTS ± STANDARD DEVIATION

Expert 1
Expert 2
Flowquant [27]
MiHeart

LVDV
(m m 3 )

LVSV
(m m 3 )

EF
(%)

271 ± 47
269 ± 50
289 ± 54
268 ± 43

131 ± 42
127 ± 34
134 ± 46
134 ± 39

52 ± 10
52 ± 8
54 ± 9
50 ± 8

LVDV
(m m 3 )

LVSV
(m m 3 )

EF
(%)

hypothesis is rejected, i.e., that the data provided by two methods
were generated from different probability distributions.
The comparison was also performed with a linear regression
analysis (calculation of the regression line: y = ax + b) and a coefficient of correlation r ∈ [−1, 1]. Note that the closer r is to +1,
the more tightly coupled the two samples are. Furthermore, we
study the agreement between the results with a Bland–Altman
procedure [35].
C. Experimental Results
Fig. 6(a) shows the influence of β (the smoothness term) and
T (the wall thickness term) on the EF. As one can see, results
coherently evolve from one set of parameters to another. The
larger β is, the smoother the result is. In our case, a “smooth”
result means that the resulting 3-D surface is close to a 3-D U
shape. Also, the larger T is, the thicker the wall is. Interestingly,
the resulting EF (61.5% on average) is not heavily affected
when slightly modifying β or T. That is, as a rule of thumb,
by changing the value of β and T by less than 0.2. This means
that, as far as the EF goes, our method produces results that are
relatively insensitive to slight parametric variations.
We then processed the 18 4-D images with a fix set of parameters β = 0.08 and T = 0.3. Table I shows the diastolic volume, the systolic volume, and the EF obtained by two experts,
Flowquant by Klein et al. [27] and with our method (MiHeart).
As can be seen, results from our method are close to the ones
obtained by the experts. In fact, it is well below 1 standard deviation away from the experts. Furthermore, results from our

Intraexpert
Interexpert
MiHeart versus exp. 1
MiHeart versus exp. 2
Intraexpert
Interexpert
MiHeart versus exp. 1
MiHeart versus exp. 2
Intraexpert
Interexpert
MiHeart versus exp. 1
MiHeart versus exp. 2

r

Regression line

Bland–Altman
(mean ± SD)

0.7
0.92
0.93
0.96
0.95
0.97
0.98
0.97
0.8
0.86
0.96
0.87

y = 0.97x + 9.6
y = 0.88x + 35.3
y = 0.83x + 40.8
y = 0.82x + 47.1
y = 1.09x−19.4
y = 1.20x−21.8
y = 0.91x + 15.4
y = 1.1x − 6.5
y = 0.75x + 15.3
y = 1.09x − 5.6
y = 0.78x + 10
y = 0.89x + 3.2

−3.9 ± 43.2
−3.1 ± 19.3
4.2 ± 17.6
1.1 ± 15
6.1 ± 15.2
−3 ± 12
−3.2 ± 8
−6.3 ± −9.9
−3 ± 6.8
0.8 ± 5.3
1.3 ± 3.2
2.2 ± 4.2

method are closer to the experts than the ones from Flowquant.
That is especially true for the LVDV where Flowquant overestimates the volume.
We also tested our method on a simulated hypoperfused myocardium. As can be seen in Fig. 7(a) and (b), we segmented 3-D
images taken from two healthy rats. We then manually created
a hypoperfused region that is visually similar to that obtained
after an ischemia. Segmentation results obtained on the hypoperfused images [see Fig. 7(c) and (d)] are very similar to those
obtained on the healthy images. This shows that the implicit
U-shape prior makes our method robust to a degenerated signal.
D. Comparison With Manual Segmentation
Table II contains the intra- and interexpert comparisons as
well as the comparison between MiHeart and the two experts.
With a correlation of only 0.7 and 0.8 for the LVDV and the EF,
one can see that even for a well-trained user, results can vary
quite a bit.
As for the interexpert variability study, the results are similar
on every aspect (LVDV, LVSV, and EF). Furthermore, the pvalue that we computed for LVDV, LVSV, and EF is far clearly
above 5%. This shows that, although different, the results obtained by both experts are highly correlated. Correlation between our method and both experts is also very high with a

JODOIN et al.: LEFT-VENTRICLE SEGMENTATION OF SPECT IMAGES OF RATS

TABLE III
COMPARISON BETWEEN OUR METHOD, FLOWQUANT, AND TWO EXPERTS

LVDV
(m m 3 )
LVSV
(m m 3 )
EF
(%)

FQ vs Exp. 1
FQ vs Exp. 2
FQ vs MiHeart
FQ vs Exp. 1
FQ vs Exp. 2
FQ vs MiHeart
FQ vs Exp. 1
FQ vs Exp. 2
FQ vs MiHeart

r

Regression line

Bland Altman
(mean ± SD)

0.68
0.72
0.77
0.97
0.97
0.99
0.89
0.67
0.85

y = 0.76x + 82.7
y = 0.77x + 82.1
y = 0.96x + 31.7
y = 1.06x − 4.9
y = 1.3x − 31.3
y = 1.17x − 22.7
y = 0.74x + 15.9
y = 0.72x + 16.7
y = 0.88x + 10.2

−17.5 ± 41
−20.7 ± 38.9
−21.7 ± 34.3
−3 ± 10.9
−6.1 ± 15.6
0.2 ± 9.8
−2.7 ± 4.8
−1.8 ± 6.8
−4 ± 4.7

2267

TABLE IV
SENSITIVITY OF EACH SOFTWARE TO MANUAL INTERACTIONS

LVDV
(m m 3 )
LVSV
(m m 3 )
EF
(%)

Flowquant [27]
MiHeart
Flowquant [27]
MiHeart
Flowquant [27]
MiHeart

Month 1

Month 2

Month 3

285 ± 48
264 ± 41
135 ± 44
131 ± 39
53 ± 8
50 ± 9

285 ± 52
268 ± 45
134 ± 46
133 ± 42
53 ± 8
49 ± 8

282 ± 49
269 ± 44
131 ± 48
136 ± 39
54 ± 8
51 ± 10

correlation factor of 0.96 and 0.87 for the EF and a mean Bland–
Altman error of only 1.3% and 2.2%. Here again, the p-value
obtained between our method and the expert is far above 5%.
This means that results from our method have the same statistical distribution than those from the experts.

E. Intersoftware Comparison
Table III shows a comparison between Flowquant, the manual
segmentation from both experts, and our method. By considering the correlation factor “r” between the manual segmentations
and our method (MiHeart versus exp. 1 and exp. 2 in Table II)
and between Klein et al.’s method (Flowquant versus exp. 1 and
exp. 2 in Table III), one can see that our results are statistically
closer to the experts than those of Flowquant. While results for
LVSV are almost the same for both methods, Flowquant results
for LVDV do not correlate well with both experts. This results
into an EF correlation factor between Flowquant and the experts of 0.89 and 0.67, which is well below our method (0.96
and 0.87).
The Bland–Altman study shows that the results produced
by our method have less variations than those obtained with
Flowquant. As reported in Tables II and III, our method has a
mean Bland–Altman EF error of 1.3% ± 3.2 and 2.2% ± 4.2,
while Flowquant is −2.7% ± 4.8 and −1.8% ± 6.8. Results in
Table III also show that MiHeart and Flowquant are quite similar
as far as LVSV goes, but different for LVDV. Compared with
MiHeart, Flowquant slightly overestimates the diastolic volume.
Since our method and Klein et al.’s method are semiautomatic, we measured their sensitivity to different manual initialization. To do so, we asked another user to process every image
three times, with a one-month gap between each processing.
This operation was performed blindly with both software. As
shown in Table IV, to all practical purposes, each method produced the same results over the two-month period. Please note
that results reported in Table I have been obtained with a fourth
round of experiments.
As far as the processing time goes, Flowquant takes on average more than 1 min to process a 4-D volume, while our method
take less than 2 s. Processing have been performed on mid-level
desktop and laptop computers.

Fig. 8. Longitudinal study of three rats suffering from a heart failure showing
an EF decrease over an eight-week period.

F. Longitudinal Study
We performed a longitudinal study for the three rats suffering
from a cardiac dysfunction. Images were acquired at five time
points, i.e., the baseline, two weeks, four weeks, six weeks,
and eight weeks. Fig. 8 shows the average EF (± 1 standard
deviation) obtained with our software. Without any surprise, the
EF decreased in time thus showing how bad the heart failure
for these rats was. Such a longitudinal study for a population of
rats is a central element to any preclinical cardiac study. With
a processing time of less than 2 s, it took the user less than
5 min to produce these results, and that includes image loading,
volume reorientation and results saving.
V. DISCUSSION
We presented a new approach to segment the left-ventricular
walls of rats given SPECT images. Our method has the following
key advantages.
(1) It segments a 4-D LV in approximately 2 s on a mid-end
laptop computer.
(2) The result is guaranteed to have an anatomically plausible
U shape.
(3) Unlike some thresholding methods, even when the LV
has an attenuated signal due to a myocardial infarction,
the resulting shape cannot contain any hole.
(4) Our method relies on only two intuitive parameters: one
to determine the smoothness of the segmented shape and
one to determine the thickness of the LV wall.
Experiments show that our method provides results similar
to those obtained by manual tracing. Moreover, our results are
statistically closer to the manual tracing of two experts than

2268

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

the semiautomatic active contour method (Flowquant) by Klein
et al. [27]. Another difference between the two software is the
processing time. In our case, we segment a 4-D cardiac SPECT
image in roughly 2 s, while Flowquant takes around 1 min.
Such a difference in terms of processing speed makes a huge
difference when it comes to real-life applications. An interactive
method such as our’s allows for simple manual adjustments (like
repositioning the T target or changing the smoothness term β)
when dealing with noisy images or images of animals with an
unusual cardiac configuration.
A limit of our study is the number of cases that is not sufficient
to perform a complete extensive evaluation. In the future, we
look forward to validate our approach on PET images obtained
with different radioactive tracers on mice and rats suffering
from cardiac diseases. We are also working on a method to
automatically locate the apex and the basal of the heart in order
to make our method fully automatic.
ACKNOWLEDGMENT
The University of Sherbrooke have licenced the Mi-heart
software to Imeka Solution, Inc. They would also like to thank
M. Havaei, F. Morency, and N. Goyette for their precious help.
REFERENCES
[1] G. Germano et al., “Automatic quantification of ejection fraction from
gated myocardial perfusion SPECT,” J. Nucl. Med., vol. 36, no. 11,
pp. 2138–2147, 1995.
[2] P. A. Freeborough et al., “Interactive algorithms for the segmentation and
quantitation of 3-D MRI brain scans,” Comp. Met. Prog. Biomed., vol. 53,
no. 1, pp. 15–25, 1997.
[3] K. Yamashita et al., “A new method of three dimensional analysis of left
ventricular wall motion,” Eur. J. Nucl. Med., vol. 14, no. 3, pp. 113–119,
1988.
[4] S. Nekolla et al., “Reproduction of polar map generation and assessment
of defect severity and extent assessment in myocardial perfusion imaging
using positron emission tomography,” Eur. J. Nucl. Med., vol. 25, no. 9,
pp. 1313–1321, 1998.
[5] D. Daou et al., “Electrocardiographically gated blood-pool SPECT
and left ventricular function: Comparative value of 3 methods for ejection fraction and volume estimation,” J. Nucl. Med., vol. 42, no. 7,
pp. 1043–1049, 2001.
[6] H. Soneson et al., “An automatic method for quantification of myocardium
at risk from myocardial perfusion SPECT in patients with acute coronary
occlusion.” J. Nucl. Card., vol. 17, no. 5, pp. 831–840, 2010.
[7] B. Lee et al., “Development of quantification software using model-based
segmentation of left ventricular myocardium in gated myocardial SPECT,”
Comput. Methods Programs Biomed., vol. 83, no. 1, pp. 43–49, 2006.
[8] T. L. Faber et al., “Quantification of three-dimensional left ventricular
segmental wall motion and volumes from gated tomographic radionuclide
ventriculograms,” J. Nucl. Med., vol. 30, no. 5, pp. 638–649, 1989.
[9] T. Faber et al., “Left ventricular function and perfusion from gated SPECT
perfusion images: an integrated method,” J. Nucl. Med., vol. 40, no. 4,
pp. 650–659, 1999.
[10] M. W. Groch et al., “Quantitative gated blood pool SPECT: Analysis
of 3-dimensional models for the assessment of regional myocardial wall
motion,” J. Nucl. Card., vol. 9, no. 3, pp. 271–284, 2002.
[11] M. Lyra et al., “Quantification of myocardial perfusion in 3D SPECT
images-stress/rest volume differences,” in Proc. Int. Conf. Imag. Syst.
Tech., 2010, pp. 31–35.
[12] S. D. Van Kriekinge et al., “Automatic quantification of left ventricular
ejection fraction from gated blood pool SPECT,” J. Nucl. Card., vol. 6,
no. 5, pp. 498–506, 1999.

[13] M. Lomsky et al., “A new automated method for analysis of gated-SPECT
images based on a three-dimensional heart shaped model,” Clin. Physiol.
Funct. Imag., vol. 25, no. 4, pp. 234–240, 2005.
[14] R. Rakotobe et al. “3D segmentation and visualization of cardiac SPECT
studies,” in Proc. Int. Conf. Eng. Med. Bio. Soc., 1996, vol. 2, pp. 662–663.
[15] L. Stegger et al., “Elastic surface contour detection for the measurement
of ejection fraction in myocardial perfusion SPET,” Eur. J. Nucl. Med.,
vol. 28, no. 1, pp. 48–55, 2001.
[16] O. Garcia-Panyella and A. Susin, “Left ventricle volume estimation from
3D SPECT reconstruction,” in Proc Comput. Cardiol., 2002, pp. 621–624.
[17] R. Dedic et al., “Cardiac pet image segmentation by a deformable model
with a force field driven speed term,” in Proc. IEEE Nucl. Sci. Symp.,
2008, pp. 4399–4402.
[18] C. Corsi et al., “Left ventricular endocardial surface detection based on
real-time 3D echocardiographic data,” Eur. J. Ultrasound, vol. 13, no. 1,
pp. 41–51, 2001.
[19] M. Alessandrini et al., “Segmentation of the full myocardium in echocardiography using constrained level-sets,” in Proc. Comput. Cardiol., 2010,
pp. 409–412.
[20] F. Galluzzo et al., “A GPU level-set segmentation framework for 3D
echocardiography,” in Proc. Int. Ultrasonics Symp., 2012, pp. 2639–2642.
[21] L. Dornheim et al., “Automatic segmentation of the left ventricle in 3D
SPECT data by registration with a dynamic anatomic model,” Med. Image
Comput. Comput. Assist Interv., vol. 8, no. 1, pp. 335–342, 2005.
[22] E. Debreuve et al., “Space-time segmentation using level set active contours applied to myocardial gated SPECT,” IEEE Trans. Med. Imag.,
vol. 20, no. 7, pp. 643–659, Jul. 2001.
[23] T. Kohlberger et al., “Soft level set coupling for LV segmentation in gated
perfusion SPECT,” Med. Image Comput. Comput. Assist Interv., vol. 10,
no. 1, pp. 327–334, 2007.
[24] E. Heiberg et al., “Design and validation of segment—Freely available
software for cardiovascular image analysis,” BMC Med. Imag., vol. 10,
no. 1, p. 10.1, 2010.
[25] H. Soneson et al., “Development and validation of a new automatic
algorithm for quantification of left ventricular volumes and function in
gated myocardial perfusion SPECT using cardiac magnetic resonance as
reference standard,” J. Nucl. Cardiol., vol. 18, no. 5, pp. 874–885, 2011.
[26] T. Benoit et al., “Quantitative evaluation of myocardial single-photon
emission tomographic imaging: Application to the measurement of perfusion defect size and severity,” Eur. J. Nucl. Med., vol. 23, no. 12,
pp. 1603–1612, 1996.
[27] R. Klein et al., “Intra- and inter-operator repeatability of myocardial
blood flow and myocardial flow reserve measurements using Rubdium-82
pet and a highly automated analysis program,” J. Nucl. Cardiol., vol. 17,
no. 4, pp. 600–616, 2010.
[28] A. Blake et al., “Interactive image segmentation using an adaptive GMMRF model,” in Proc. Eur. Conf. Comput. Vision, 2004,
pp. 428–441.
[29] Y. Boykov et al., “Fast approximate energy minimization via graph cuts,”
IEEE Trans. Pattern Anal. Mach. Intell., vol. 23, no. 11, pp. 1222–1239,
Nov. 2001.
[30] Y. Boykov and V. Kolmogorov, “An experimental comparison of mincut/max-flow algorithms for energy minimization in vision,” IEEE Trans.
Pattern Anal. Mach. Intell., vol. 26, no. 9, pp. 1124–1137, Sep. 2004.
[31] V. Kolmogorov and R. Zabih, “What energy functions can be minimized
via graph cuts?” IEEE Trans. Pattern Anal. Mach. Intell., vol. 26, no. 2,
pp. 147–159, Feb. 2004.
[32] A. Blake et al., Markov Random Fields for Vision and Image Processing.
Cambridge, MA, USA: MIT Press, 2011.
[33] L. Gianni et al., “Sawyer anthracycline cardiotoxicity: From bench to
bedside,” Clin. Oncol., vol. 26, no. 22, pp. 3777–3781, 2008.
[34] R. Nuzzo, “Scientific method: Statistical errors,” Nature, vol. 506,
pp. 150–152, 2014.
[35] J. Bland and D. Altman, “Statistical methods for assessing agreement between two methods of clinical measurement,” Lancet, vol. 1,
pp. 307–310, 1986.

Author’s photographs and biographies not available at the time of publication.

