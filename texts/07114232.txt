2638

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

Filtered Virtual Reference: A New Method for
the Reduction of Power Line Interference With
Minimal Distortion of Monopolar Surface EMG
Alberto Botter∗ and Taian M. Vieira

Abstract—Goal: This study tests and validates a new method to
remove power line interference from monopolar EMGs detected
by multichannel systems: the filtered virtual reference (FVR). FVR
is an adaptation of the virtual reference (VR) method, which consists in referencing signals detected by each electrode in a grid to
their spatial average. Signals may however be distorted with the
VR approach, in particular when the skin region where the detection system is positioned does not cover the entire muscle. Methods:
Simulated and experimental EMGs were used to compare the performance of FVR and VR in terms of interference reduction and
distortion of monopolar signals referred to a remote reference.
Results: Simulated data revealed the monopolar EMG signals processed with FVR were significantly less distorted than those filtered
by VR. These results were similarly observed for experimental signals. Moreover, FVR method outperformed VR in removing power
line interference when it was distributed unevenly across the signals of the grid. Conclusion: Key results demonstrated that FVR
improves the VR method as it reduces interference while preserving the information content of monopolar signals. Significance:
Although the actual distribution of motor unit action potential is
represented in monopolar EMGs, collecting high quality monopolar signals is challenging. This study presents a possible solution
to this issue; FVR provides undistorted monopolar signals with
negligible interference and is insensitive to muscle architecture. It
is therefore relevant for EMG applications benefiting from a clean
monopolar detection (e.g., decomposition, control of prosthetic devices, motor unit number estimation).
Index Terms—Average reference, common mode, electromyography, power line interference, signals, virtual reference.

I. INTRODUCTION
IGH-DENSITY surface electromyography based on 2-D
electrode arrays is becoming common in research laboratories and attracting clinical interest [1]–[5]. A problem inherent
to this as well as to other techniques (EEG, ECG) is the removal of power line interference caused by parasitic capacitive
coupling with the power line. Such interference is expected to
generate a similar contribution to all monopolar channels of the

H

Manuscript received January 30, 2015; revised April 22, 2015; accepted May
21, 2015. Date of publication June 1, 2015; date of current version October
16, 2015. This work was supported by Italian bank foundations “Compagnia di
San Paolo” and “Fondazione Cassa di Risparmio di Torino.” Asterisk indicates
corresponding author.
∗ A. Botter is with the Laboratory for Engineering of the Neuromuscular
System, Dipartimento di Elettronica e Telecomunicazioni, Politecnico di Torino,
10129 Torino, Italy (e-mail: alberto.botter@polito.it).
T. M. Vieira is with the Politecnico di Torino, and also with the Universidade
Federal do Rio de Janeiro.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2438335

detection system, constant in space and variable in time at the
power line frequency (50 or 60 Hz) and its harmonics. It would
therefore appear that a method to reduce power line interference
could be based on the differential measurement of the voltage
between each electrode of the array and the instantaneous spatial average of all the detected signals. This method is referred
to as “virtual reference” (VR) and has been widely used in ECG
and EEG applications [6].
The VR method is based on two assumptions. The first assumption is that, for any given time instant, the spatial integral
on a surface that covers the entire spatial support of the potential
generated by the active sources is zero [7]. Under this assumption, the fluctuations of the spatially averaged signal represent
only the external common mode voltage that can be removed
by subtraction. However, this approximation is valid only if the
detection system covers the entire spatial support of the active sources [8], [9]. For EEG applications this requirement is
approximately fulfilled by high-density detection systems, with
electrodes covering the whole scalp. The application of this technique to high-density EMG recordings can be more problematic
because the surface integral of the potential can be considered
null only when the detection system covers the entire muscle
surface and goes beyond the tendon regions. Since this condition can rarely be achieved during practical EMG recordings,
the application of the VR technique might imply a distortion of
both propagating and nonpropagating components of monopolar EMG signals. This effect is described, for the specific case
of signals detected with a linear array of electrodes, in [2].
The second assumption on which the VR method is based
is that the external interference affects all the channels of the
detection system with the same amplitude and phase. If this
hypothesis is not valid, the average signal might not be representative of the interference affecting individual channels, and
the VR method may not remove the power line interference
from all channels in the detection system [2].
Based on the VR technique, in this study, we proposed a
new method to remove power line interference with marginal
distortion of the actual, biological signal; filtered virtual reference (FVR) method. First, a theoretical account of the VR
spatial filtering effect on the bidimensional potential distribution is presented. Then, simulated and experimental EMGs are
used to test for whether the FVR technique: 1) minimizes the
signal distortion associated with the VR processing (i.e., due to
the removal of the average of the monopolar signals); and 2) accounts for the different amplitudes of the interference affecting
the individual channels of the detection system.

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

BOTTER AND VIEIRA: FILTERED VIRTUAL REFERENCE: A NEW METHOD FOR THE REDUCTION OF POWER LINE INTERFERENCE

2639

II. METHODS
A. Analysis of VR Technique
In EMG recordings, monopolar signals detected over a skin
parallel-fibered muscle include both propagating and nonpropagating components. Nonpropagating components are mainly
due to crosstalk and to the potential generation (at the neuromuscular junctions) and extinction (at the muscle-tendon junctions, often referred as end-of-fiber effect) and may contribute
strongly to the EMG signal [10].
If the spatial support of these potentials is not entirely covered by the detection system, the nonpropagating components
do not have instantaneous zero spatial average. Consequently,
the subtraction of the spatial average affects both the nonpropagating and propagating components of the monopolar signals
[2]. Moreover, when the potential distribution is sampled with
a grid of electrodes, the nonuniform spatial distribution of the
surface potential (e.g., the transversal decay in case of skin
parallel-fibered muscles) is expected to be an additional factor degrading the quality of the signals detected with the VR
technique. In this section, we generalize the analysis presented
in [2] to the case of bidimensional sampling of the potential
distribution.
Let us consider a simple model with a grid of electrodes
placed between the endplate locations (innervation zone) and
the tendons with M columns, parallel to the fibers’ direction,
and N rows [see Fig. 1(a)]. The origin of the reference system
corresponds to the electrode (r, c) = (1, 1). V (x, z, t) is a potential distribution, on the skin surface above the muscle, travelling
with the same amplitude in the z-direction with a conduction velocity v. Under these conditions, the potential distribution generated by a fiber can be written as V (x, z, t) = a(x) · V (z, t)
where a(x) is the function (∈[0, 1]) that describes the decay of
the potential in the transverse direction (x).
For a generic column c (x coordinate = xc ), the potential
distribution in one spatial dimension (z) is ac · V (z, t) with
ac = a(xc ). For a given time instant (to ) the voltage detected by
the electrode of row r (coordinate zr ) and column c (coordinate
xc ) using the VR method is
VVR (xc , zr , t0 ) = ac · V (z, t0 ) · δ (z − d · r) − V (z, t0 )
·

M N
1 
ak · δ (z − d · i)
N ·M
i=1

where d is the distance between two consecutive electrodes
along the fiber direction (interelectrode distance), and δ(.) is the
Dirac distribution. The second term of (1) is the spatial average
computed over the N rows (i = 1, . . . , N) and the M columns
(k = 1, . . . , M) of the detection system.
The equivalent spatial impulse response (2) and the transfer
function in time frequency domain (3) are
VVR (xc , zr , t0 )
= δ (z − d · r)
ac · V (z, t0 )
−

M
N


1
·
ak ·
·δ (z − d · i) (2)
ac · N · M
i=1
k =1

M


(1)

k =1

hr,c
VR (z) =

Fig. 1. Theoretical analysis of the VR method (Section A, Methods). (a)
Schematic representation of three detection systems: two linear arrays with
four and ten electrodes (DS 1 and DS 2, respectively) and a grid of 5 × 10
electrodes (DS3) placed on one side of the innervation zone (monodirectional
propagation). (b) DS 1: magnitude of the transfer function H V R (f ) of the
channel in row 9, column 2 (channel 4 of DS1) for different conduction velocities
(v) of the travelling potential V (z, t). (c) Magnitude of H V R (f ) for the four
channels of DS1 considering a conduction velocity (v) of 4 m/s. (d) DS 2:
magnitude of H V R (f ) for the channel in row 9, column 2 (channel 9 of DS
2) for different conduction velocities (v) of the travelling potential V (z, t). (e)
Magnitude of H V R (f ) for the ten channels of DS 2 (v = 4 m/s). (g) DS 3 :
magnitude of H V R (f ) for all the channels (columns) of the row 2 considering
a signal propagating with a conduction velocity (v) of 4 m/s. HV R (f) of panel
(g) was computed considering the transversal decay function - a(x) - depicted in
panel (f).

r,c
HVR
(ω) = e−j v dr −
ω

ak

k =1

ac · N · M

1 − e−j v dN
ω
1 − e−j v d
ω

·

(3)

where ω/v is the spatial angular frequency. The transfer function
depends on the three following parameters: 1) the conduction
velocity (v) of the propagating signal [see Fig. 1(b) and (d)].
Indeed, it can be noted that the common mode components of
the signal (v → ∞ and ak = 1 for any k) are removed by the
VR method (|HVR | = 0, for v → ∞); 2) the frequency (f) of
V(z, t) and the distance (d) between two consecutive electrodes;
3) the number of rows (N) of the detection system. In addition
to the aforementioned considerations described in [2], the analysis presented in this section indicates that when the signals
are detected with bidimensional grids of electrodes, the transfer
function of VR is influenced also by the transversal (along the

2640

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

Fig. 2. Block diagram of the FVR method. V k is the monopolar signal
recorded by the electrode k of a detection system with N electrodes; S k is
the interference-free monopolar signal; V C L (t) is the power line interference;
p k is the scaling factor taking into account possible variations of the interference amplitude across the channels; V C P (t) is the common mode signal
exclusively due to physiological components; V A V (t) is the spatial average
calculated over the detection system, including the contribution of power line
interference (V C L (t)) and of physiological components (V C P (t)).

According to the VR method, the second term of (4) is estimated through the spatial average of all the signals of the
detection system (VA V (t)).
As shown in the previous section, if the detection system
does not cover the entire spatial support of the motor unit action
potentials (MUAPs), both the power line interference (VC L (t))
and the physiologically-induced (VC P (t)) common mode (e.g.,
standing waves) will contribute to VA V (t). FVR therefore aims
at separating VC L (t) from VC P (t); this operation is performed
through the blocks “Spatial Average” and “Spectral Interpolation” reported in Fig. 2. “Spatial Average” computes VA V (t)
and the block “Spectral Interpolation” linearly interpolates the
power line frequency and its harmonics in VA V (t) by considering a 2-Hz interval centered on the interpolated spectral
frequencies [11]. This procedure removes the power line components (VC L (t)) from VA V (t) and provides an estimation of
the physiological contribution to the common mode (VC P (t)).
VC L (t) is then obtained by subtracting VC P (t) from VA V (t).
The second step of the method (block “Amplitude Compensation”) corresponds to the estimation of the scaling factor pk for
each channel of the detection system. Under the assumption that
Sk (t) and VC L (t) are not correlated (<Sk (t),VC L (t)> = 0)
< Sk (t) + pk · VC L (t) , VC L (t) >

columns) amplitude profile [see Fig. 1(f)]. Considering the second term of (3) depends on the transverse decay function (a),
|HVR | will be different for the different columns of the detection
system for signal components whose amplitude is not constant
in space.
According to these theoretical considerations, the VR technique may greatly distort the actual EMGs and may not remove
the power line interference from all channels of the grid. The
magnitude of such distortion cannot be anticipated, as it depends
on different factors (e.g., conduction velocity, dimension of the
detection system, etc.; see Fig. 1). To circumvent these issues,
we therefore propose some adaptations to the VR method.

= pk · < VC L (t) , VC L (t) > .

(5)

Thus, the scaling factor pk can be estimated as
pk =

< Vk (t) , VC L (t) >
.
< VC L (t) , VC L (t) >

(6)

The block “Amplitude Compensation” computes pk for each
channel of the detection system thus providing a set of N reference signals (pk · VC L (t) for k = [1 to N ]). According to (4),
the interference-free monopolar signals (Sk (t)) are obtained,
for each channel k, by subtracting the new reference signal from
each detected signal, Vk (t).
C. Simulation Study

B. FVR Method
FVR is an adaptation of the VR method and was designed
to remove the power line interference from surface EMGs with
minimal distortion of the actual, monopolar signals. The main
features of this method are: 1) it considers only the power line
component of the common mode signal (i.e., the spatial average), and 2) it accounts for differences in the amplitude of the
power line interference affecting the different channels of the
detection system.
The block diagram of the FVR method is reported in Fig. 2.
Let us consider the monopolar signal (Vk ) recorded by an electrode k of a detection system constituted by N electrodes (4).
Vk can be written as the sum of the actual monopolar signal
referred to a remote reference (Sk (t)) and the power line interference (VC L (t)). Variations in the amplitude of the power line
interference across channels are represented in (4) by multiplying VC L (t) by a scaling factor (pk ∈ [0, 1]).
Vk (t) = Sk (t) + pk · VC L (t) .

(4)

In this section, high-density EMGs were simulated to investigate the effect of the detection system size and of the localized
distribution of muscle activity on monopolar EMGs referred to
a remote reference, to the VR and to the FVR. This simulation study was focused on the quantification of signal distortion
associated with the rereference procedure (either VR or FRV)
rather than on the efficacy in removing power line interference,
which is addressed in the following section.
The simulations were based on a model of recruitment of a
population of MUs [12] and on a cylindrical volume conductor
model [13]. The model was implemented in Matlab software
(R2007a, The MathWorks Inc., MA, USA). The cylindrical volume conductor consisted of an anisotropic muscle layer, an
isotropic subcutaneous tissue, a skin layer and a muscle with elliptical, physiological cross-sectional area (transversal x depth,
30 × 25.4 mm). The innervation zones of the motor units were
located at the center of the muscle (see Fig. 3). The parameters
of the anatomical model are reported in Table I.
Ten contractions with constant excitation levels were simulated, ranging from 10% to 100% of the excitation level in steps

BOTTER AND VIEIRA: FILTERED VIRTUAL REFERENCE: A NEW METHOD FOR THE REDUCTION OF POWER LINE INTERFERENCE

Fig. 3. (a) Cross-sectional view of the anatomical model. It consisted of bone,
muscle tissue, a subcutaneous layer, and skin. The black circles over the skin
layer represent one row (five electrodes) of the detection system. (b) Longitudinal view (z-axis) of one representative fiber. (c) Territories of the simulated
motor units. In “Simulation 1” the territories of the active motor units were
distributed randomly throughout the muscle, whereas in “Simulation 2” they
were located close to the skin surface. (d) Schematic representation of the three
detection systems used, each arranged around the center of the simulated fibers
(innervation zone location). For each detection system a schematic representation of the simulated fibers is shown (IZ: innervation zone, TR: tendon region).

The electrodes of the 5 × 40 array were grouped in subsets to
obtain different detection systems [5 × 20 array and 5 × 8 array,
see Fig. 3(d)]. Each detection system was arranged around the
center of the 5 × 40 array.
The surface potential was simulated as detected by the three
detection systems in two conditions. In the first condition (Simulation 1) the territory of active motor units was distributed
randomly throughout the muscle [see Fig. 3(c)], whereas in the
second condition (Simulation 2) the active motor units were a
subpopulation of superficial motor units [see Fig. 3(c)]. Simulation 1 and 2 were considered to compare VR and FVR when
the active motor units generate either a uniform (Simulation 1)
or localized (Simulation 2) distribution of muscle activity under
the electrodes. Indeed, as demonstrated in the first section (see
Fig. 1), a steep transversal decay of the potential (present in
Simulation 2) is a possible source of error in VR signals.
For each of the two conditions, ten randomly selected motorunit populations were simulated. These simulations were sought
to represent ten muscles, with the same anatomical characteristics but with different random locations of the motor units within
their volume.
For each detection system and simulation condition, VR and
FVR method were applied to the simulated signals. The comparison between the original monopolar signal (referred to a remote
reference) and the signals referred to the virtual (VR) and filtered virtual (FVR) references was performed for each channel
with the normalized mean square error (NMSE), according to
the formula
N


N M SEi,j = 100 ·

TABLE I
PARAMETERS OF THE CYLINDRICAL MODEL

2641

[fi,j (n) − gi,j (n)]2

n =1
N


(7)
fi,j (n)2

n =1
Model Parameter
Motor unit properties

Muscle properties

Limb properties

∗

Fiber density
Innervation ratio∗∗
Discharge rate
CoV of interspike interval
Number of motor units
Number of muscle fibers
Number of MU fibers (range)
Muscle PCSA
Average fiber length
Tendon ending spread
Innervation zone spread
Skin thickness
Subcutaneous tissue thickness
Bone (radius)

Value
∼20 fib/mm
25–1500
8–30 pps
15%
200
15 000
15–1500
598 mm2
100 mm
5 mm
5 mm
1 mm
2.5 mm
20 mm

2

of 10%. The simulated monopolar signals were detected at 4096
samples/s with circular electrodes (diameter 1 mm), arranged in
a grid with five columns and 40 rows (200 electrodes) with 5-mm
interelectrode distance in both the longitudinal and transverse
directions (see Fig. 3). The center of the grid corresponded to
the center of the muscle volume projected on the skin surface.
The detection system covered both the muscle (approximately
20 electrodes corresponding to the central portion of each column) and the tendon regions (approximately ten electrodes over
each tendon).

where fi,j (n) is the monopolar signal referred to a remote reference; gi,j (n) denotes the signal referred to the virtual (or filtered
virtual) reference; i and j are the indexes of the channel (row
and column respectively), and N is the number of samples of
the signal.
D. Experimental Signals
The performance of the VR and FVR methods was assessed
on signals acquired with different detection systems and from
muscles with different architectures (i.e., biceps brachii and
forearm muscles) to provide examples of the effect of VR and
FVR in real, experimental conditions.
High-density surface EMG signals were acquired in monopolar derivation (referred to a remote reference), amplified, bandpass filtered (3-dB bandwidth, 10–500 Hz), sampled at 2048 Hz
and A/D converted with a resolution of 12 bits (multichannel
surface EMG amplifier, EMG-USB, OT Bioelettronica, Torino,
Italy).
Two experiments were performed in one subject to address
specific issues. In the first experiment (EXP 1) we focused on the
effect of VR and FVR on nonpropagating components detected
through a linear array positioned along the muscle fiber direction in a skin parallel-fibered muscle. Since the nonpropagating
components in these signals do not have instantaneous zero

2642

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

spatial average, they are expected to be removed by VR, but
preserved by FVR. In the second experiment (EXP 2) we tested
FVR and VR on monopolar signals with a marked transverse decay; as predicted in section A and B, VR but not FVR is expected
to distort the monopolar signals and therefore their spatial amplitude distributions. The possibility of accounting for uneven
power line interference across channels with the FVR approach
is tested for the signals acquired in both experiments. The protocols considered in the two experiments are briefly described
below.
EXP 1: EMG signals were detected from the short biceps
brachii (BB) head with a linear electrode array of 16 electrodes
and 10-mm interelectrode distance (SPES Medica, Battipaglia,
Italy) during an isometric contraction at 30% MVC. The electrodes were aligned parallel to the muscle fibers, approximately
covering the proximal and distal BB tendons.
EXP 2: EMG signals were detected from dorsal, forearm
muscles with 96 electrodes arranged in a grid of 12 rows and
eight columns with 10-mm interelectrode distance (LISiN, Politecnico di Torino, Torino, Italy). Signals were recorded during
isometric wrist extension at 10% of the maximum voluntary
contraction (see [14] for details). Images were created from the
root mean square (RMS) values computed for raw monopolar
EMGs and for EMGs conditioned with both VR and FVR methods. Changes in the spatial distribution of EMG amplitude were
then assessed.
For both the experiments, a set of bandpass filters centered
at power line frequency and its first five harmonics was used
to extract the power line interference from monopolar EMGs
recorded in rest conditions. Power line interference was multiplied by a scaling factor and added to the EMG channels to
test how robustly the VR and the FVR perform in the presence
of nonuniformly distributed power line interference. In EXP 1
the scaling factor was linearly increased (in the range 0–5) from
channel 1 to channel 16. In EXP 2, the scaling factor was 5
for the six proximal channels and 0 for the six distal channels.
All EMG signals were analyzed with Matlab software (R2007a,
The MathWorks Inc., MA, USA).
E. Statistical Analysis
A three-way ANOVA (10 contraction levels x 3 detection
system sizes x 2 reference method) was applied to compare
the NMSE values of simulated signals. Parametric statistics
were considered after ensuring the data distribution obtained
for the ten populations of motor units simulated was Gaussian
(Lilliefors test). Bonferroni correction was considered for the
pair-wise comparisons, performed whenever ANOVA indicated
a significant, additive effect. Results are given as mean ± std.
III. RESULTS
A. Simulation 1: Effect of VR and FVR Methods on
Interferential Signals From Uniformly Distributed MUs
The contraction level simulated did not affect the performance
of the two methods tested. Independently of whether simulating
small or large electrode grids, for EMGs processed both with

Fig. 4. Comparison between FVR and VR method for one representative
set of signals (Simulation 1, 10% MVC) recorded by three detection systems.
For each detection system, the original set of signals (monopolar referred to a
remote reference) was referred to the VR and to the FVR. The NMSE between
the original signals and the VR or FVR set of signals was computed to compare
both methods (panels (a) and (b) respectively). The 3-D representation of NMSE
and the average NMSE computed over the electrodes of each detection system
is reported. Note different z-scale between panels (a) and (b).

the VR and the FVR methods, we did not observe statistically
significant differences among NMSE values obtained for the ten
effort levels tested (from 10% to 100% MVC at 10% MVC steps
ANOVA additive effect; P > 0.3 for all cases). For this reason,
simulation results showing the effect of the size of the detection
system on NMSE values are specifically reported for the 10%
MVC condition.
For both VR and FVR methods, the size of the detection
system affected the NMSE averaged over the grid as well as the
distribution of NMSE values across electrodes. NMSE values
distributed relatively less uniformly across channels in the grid
as the size of the detection system simulated decreased (cf.,
rows in Fig. 4), with NMSE values being smaller for electrodes
located along the central column and the central row. The NMSE
averaged over all channels in the grid decreased significantly
when either VR or FVR techniques were applied to EMGs
simulated for larger detection systems (ANOVA additive effect;

BOTTER AND VIEIRA: FILTERED VIRTUAL REFERENCE: A NEW METHOD FOR THE REDUCTION OF POWER LINE INTERFERENCE

2643

P < 0.001). Regardless of the detection system size, as shown in
Fig. 4, the mean NMSE value obtained for the FVR method was
about 50 times smaller than that obtained for the VR method
(note different z scales between panels (a) and (b) in Fig. 4;
ANOVA additive effect; P < 0.001).

B. Simulation 2: Effect of VR and FVR Methods on
Interferential Signals From Nonuniformly Distributed MUs
For MUs nonuniformly distributed within the muscle volume,
the transverse decay of the potential critically affected the performance of the virtual and FVR methods. This effect is clearly
shown for a single potential. Fig. 5 shows examples of simulated
signals [Simulation 2, see Fig. 3(c)] detected with three detection systems (5 × 40, 5 × 20 and 5 × 8 electrode array). The
NMSE values obtained for both VR and FVR methods increased
for EMGs simulated with a progressively smaller detection system (cf., potentials from the left to right panels in Fig. 5). For
EMGs detected closer to either border of the simulated grid
(column 1 or 5), NMSE values were larger than those obtained
for EMGs detected centrally in the grid (see Fig. 5), where the
center of the MU territory was simulated. The performance of
VR and FVR methods showed however a different degree of
dependence on the size of the detection system. Regardless of
whether simulating EMGs with small or large electrode grids,
NMSE values obtained for the VR method was dramatically
(∼40 times) greater than those obtained for the FVR method
(see Fig. 5). The considerations made for the single MUAP
shown in Fig. 5 apply for the ten populations of 200 MUs simulated (ANOVA additive effect for the method and detection
system size; P < 0.001).

C. Experimental Study: Distortion of the Signal
Crucial differences between VR and FVR were observed at
the level of single motor units as well as for the spatial distribution of EMG amplitude. An example of a single MUAP for the
BB muscle is shown in Fig. 6 (EXP 1 in methods). The original
signal (monopolar referred to a remote reference) contains both
propagating and nonpropagating components associated with
the end-of-fiber effect. These components changed marginally
when EMGs were processed with the FVR technique, whereas
VR processing modified the shape of the propagating potential
and markedly reduced the amplitude of end-of-fiber component (see Fig. 6). Similarly, when considering the distribution
of the RMS amplitude of interference EMGs the VR and FVR
methods provided different results (EXP 2 in methods). During
isometric, wrist extension contraction, the RMS amplitude map
obtained with the FVR method was similar to the amplitude map
obtained for the raw, monopolar EMGs; in both cases greater
EMGs were detected at the centro-lateral forearm region [see
Fig. 7(a) and (b)]. The RMS amplitude of VR processed EMGs
distributed in a substantially different fashion across the grid
of electrodes, with largest EMGs being represented at the most
distal row of electrodes [see Fig. 7(c)].

Fig. 5. Effect of the transversal decay of the potential. Example of simulated
signals (Simulation 2) detected with three recording systems (5 × 40, 5 × 20 and
5 × 8 electrode array). Each row represents the signals detected by each channel
of the selected row (see the schematic representation of the detection systems
in the left part of the figure). For each channel the original signal referred to a
remote reference (monopolar signal), the signal referred to the virtual reference
(VR signal), and the signal referred to the FVR (FVR signals) are superimposed.
The NMSE of VR and FVR signals are reported for each channel.

D. Experimental Study: Reduction of Power Line Interference
The two methods performed differently with respect to the
attenuation of power line interference. Fig. 8(a) reports an example of BB monopolar surface EMG signals with power line
interference added nonuniformly across electrodes (EXP 1 in
methods). While the VR technique removed power line interference mainly from the central channels in the array (from
channel 7 to channel 11; cf., Fig. 8(a) and (b), power line interference was equally suppressed across the whole array without

2644

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

Fig. 6. Experimental surface recordings of an action potential measured from
the biceps brachii during a 30%MVC isometric contraction (EXP 1). Original
signals (monopolars referred to a remote reference), signals referred to the VR
and to the FVR are shown. The modification of the propagating potential shape
and the cancelation of the end-of-fiber component (indicated by the arrows) are
visible for signals processed with VR. Both signal components are preserved in
monopolar signals referred to FVR.

changing the monopolar potentials with the FVR method [see
Fig. 8(c)]. The same behavior was observed in the example
reported in Fig. 8(d)–(f) (EXP 2 in methods) where the interference affected only a subset of the channels of the detection
system. Therefore, regardless of whether muscle activity was
detected along the whole detection system (EXP 1) or locally
(EXP 2), and of how differently the power line interference affected the different channels in the detection system, the FVR
method attenuated the power line interference in all channels
without distorting the actual, monopolar signal.
IV. DISCUSSION
The performance of the VR technique, commonly used to
remove power line interference from multichannel recordings
[6], and of the modified VR method proposed here, the FVR, is
tested on simulated and experimental EMG signals. Both techniques are computationally advantageous with respect to other
filtering techniques (e.g., empirical mode decomposition [15],
[16]; spectral interpolation of individual channels [11]), as they
apply to the signals’ spatial average rather than to individual
signals. This advantage may be particular attractive for EMG
recordings based on a high number of electrodes. As discussed
below, nevertheless, VR and FVR perform differently, both in
terms of the amount of distortion of the actual, monopolar signals and of their efficacy in removing the power interference.
A. Filtering of Common Mode Signals With the VR: Distortion
of Surface EMGs
The theoretical analysis of VR method showed that it behaves
like a filter whose features depend on the conduction velocity
of the propagating signals [see Fig. 1(b) and (d)] and on the
position and size of the detection system [see Fig. 1(c) and (e)].
Whenever the common mode signal distributes unevenly across

Fig. 7. EMG amplitude distributions over the dorsal portion of the forearm
during a 20%MVC isometric wrist extension. RMS amplitude maps were computed over a 1-s epoch from monopolar signals referred to a remote reference
(a) the FVR (b) and the VR (c) are reported.

the grid of electrodes, the VR method distributes its energy
across channels in the grid, greatly distorting the actual signals
(see Figs. 4–8). Moreover, as discussed below, the VR method
makes no distinction between the different sources contributing
to the common mode signal.
Regardless of the size of the detection system, the VR
method removes the common mode from EMG signals when
it distributes equally across electrodes (see (3): HVR = 0, for
v → ∞). The components that contribute to the common mode
are mainly two: the power line interference and the physiological
nonpropagating potentials (standing waves) [2], [10]. Standing
waves may be associated with the activity of a distant muscle
(crosstalk [17], [18]), with the generation of MUAPs or with
their extinction in the muscle-tendon junctions [10], [19]–[21].
One may argue that removing these standing waves from the
EMG recordings is desirable, given that, for example, common

BOTTER AND VIEIRA: FILTERED VIRTUAL REFERENCE: A NEW METHOD FOR THE REDUCTION OF POWER LINE INTERFERENCE

2645

Fig. 8. Example of 16 monopolar signals detected longitudinally from the BB muscle (a)-(c) and from dorsal, forearm muscles (d)-(f). Signals shown in (a)
and (d) were detected with respect to a remote reference, with artificial power line interference (50 Hz and four additional harmonics) added respectively to all
signals with linearly increasing intensity increasing (from ch 1 to ch 16) and to a subset of signals (from ch 1 to ch 5). (b) and (e). Signals referred to VR. Note
the reduction of physiological common mode signals. (c) and (f). Signals referred to FVR. The power spectral distribution of signals detected in ch 7 is shown
alongside all panels to better illustrate the performance of the two methods. For each experiment, spectra are represented with the same scale (a.u.).

mode signals lead to overestimates of muscle fiber conduction velocity [22]. For such a purpose, however, one could rely
on the use of selective spatial filters (e.g., single- and doubledifferential [19]) rather than on offline, filtering techniques. It
must be noted that the method proposed here was strictly developed to attenuate the power line interference while preserving
the standing waves in the monopolar EMGs.
When the amplitude of the common mode signal does not
distribute uniformly across electrodes, the VR method greatly
distorts the actual, monopolar signals (see Figs. 7 and 8). Occurrences of nonuniform spatial distribution of common mode
signals may be observed both for power line interference and
standing waves. In the case of power line interference, an uneven
amplitude distribution could be associated with poor contact of
some electrodes of the detection system [23] or with their geometrical position with respect to the interference source. Instead,
the circumstances leading to nonuniform distribution of standing waves’ amplitude are relatively more difficult to predict, as
they depend on the muscle architecture and on the muscle size in
relation to the size of the electrode grid. For example, considering that the amplitude of physiological, common mode sources
decays with the inverse of their distance from electrodes [10],
[24] (innervation zone and tendon regions), standing waves with
different amplitude across electrodes are more likely to be observed for larger than smaller grids. Indeed, uneven distribution

of standing waves’ amplitude has been observed experimentally
for muscles with long fibers (e.g., biceps brachii: [25]; forearm
muscles: [14]), for muscles whose fibers attach to a broad bone
region (e.g., trapezius: [26]) and for muscles with pennate geometry (e.g., vastus medialis: [27]; gastrocnemius: [28]). In either
case, for power line interference and standing waves, the contribution of the channels detecting higher common mode potential
will be distributed to all channels by the subtraction of the average: the VR approach. It is straightforward that this leads to
a noncomplete cancelation of the power line interference and
to a distortion of the physiological nonpropagating components
of the EMG signal, with potentially crucial consequences for
applications such as force estimation [29].
B. Robustness of the Proposed FVR Method: Preserving
EMG Waveform
The FVR method was conceptually designed to remove the
power line interference from surface EMGs without removing
the standing waves and without distorting the actual, monopolar
signals. Two main features potentially accounts for the robustness of the method proposed here: 1) it considers the power line
component of the average signal and not other common mode
sources, i.e., the standing waves; 2) it accounts for differences in
the amplitude of the power line, common mode signal detected

2646

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

by different channels in the grid. Results presented here, indeed,
indicate that our proposed method successfully attenuates the
power line interference, regardless of where it is detected in
the grid. Most importantly, our findings show the FVR method
does not distort the monopolar EMGs in the presence of standing
waves represented with equal (see Fig. 6; EXP 1 in methods) and
different (see Fig 7; EXP 2 in methods) amplitude in different
channels; it is insensitive to spatial inhomogeneities associated
with the physiological, common mode sources.
In addition to distortion due to common mode sources, distortion may arise for MUAPs when surface EMGs are detected
by relatively small grids of electrodes. Small grids, with closely
spaced electrodes, may not cover a skin region sufficiently large
to include the whole spatial distribution of MUAPs. In this case,
the spatial average of such potential distribution is not zero
and thus the distortion resulting from the VR filtering does not
uniquely apply to common mode components. Indeed, while
the FVR technique retains the waveform of MUAPs, resulting
in markedly small mean square error between the actual and the
filtered signal (see Fig. 4), the VR method does not (cf., waveforms obtained using the VR and FVR methods for simulated
and experimental signals in Figs. 5 and 6, respectively). The degree of distortion of MUAPs resulting from the VR filtering is
variable. As shown in Fig. 1(b) and (d), the shape of VR transfer
function changes with the conduction velocity of MUAPs. The
dependence of the filter features on different conduction velocities and on the position of the detecting electrode decreases with
the increase of the size of the detection system [see the reduction of HVR (f ) amplitude oscillations for comparisons between
Fig. 1(b) and (d) and between Fig. 1(c) and (e)]. On one hand,
increasing the size of the detection system may result in less distortion due to the VR filtering of MUAPs. On the other hand, as
discussed above, the larger the detection system the more likely
the standing waves are distributed unevenly across electrodes.
Another crucial point is the size and location of muscle activity represented in the surface EMGs. For large electrode arrays,
covering muscles with pinnate geometry or a group of small
muscles, EMGs with large amplitude may be detected from
different, localized skin regions [14], [27], [30]. For example,
largest EMGs were observed over different forearm regions
when subjects were asked to isometrically extend their different
finger extensor muscles [14]. Regardless of whether contracting
any of the finger extensors, EMGs with largest amplitudes were
detected by ∼20 out of 128 electrodes [14]. As predicted by
our theoretical analysis and simulation results, and as suggested
experimentally (see Fig. 7), such a localized representation of
muscle activity may spread across all electrodes in the grid when
EMGs are filtered with the VR rather than with the FVR method.
Therefore, as the FVR method preserves the information content of the actual, monopolar EMGs, it does not demand any a
priori knowledge on the spatial pattern of muscle activity.
An important remark of the FVR is that it exclusively applies to monopolar signals referred to a remote reference. Once
EMGs are detected with the VR approach, the distortion it may
introduce to the actual monopolar signals can be not accounted
for by the FVR method. Therefore, whenever using a grid of
electrodes with limited pick-up volume in relation to the mus-

cle size or sampling from highly locally active muscles with a
large grid, for example, detecting monopolar signals with the
VR technique may be not appropriate.
C. Removing Power Line Interference Without
Distorting EMGs
The VR method was not effective in reducing the power line
interference from all the channels of the detection system as
was the FVR method. This is due to the fact that the common
mode (computed as the spatial average of all the signals of the
detection system) is not representative of the interference affecting individual channels. More specifically, in both examples
shown in Fig. 8 the amplitude of the power line interference is
not the same for each channel in the grid and thus its subtraction removes the interference only in some locations and not in
others. Moreover, since the detection systems did not cover the
entire spatial support of the active sources, surface EMG signals
were spatially filtered, as evidenced by the reduction of physiological common mode signals for the VR though not for the
FVR method (cf., panels (b)-(c) and (e)-(f) in Fig. 8). Moreover,
the application of the FVR method showed a higher rejection
of power line interference on all the channels of the detection
system, regardless of how differently the power line interference
affected the different channels in the detection system and on
whether muscle activity was detected along the whole detection
system or locally (cf., panels (a)-(c) and (d)-(f) in Fig. 8, respectively). The FVR method also preserved the physiological
common mode signals, the standing waves, as indicated by the
presence of nonpropagating potentials in Figs. 6 and 8(c) and (f).
Overall, the FVR method proved useful to remove power line
interference without affecting both the standing waves and the
MUAPs present in the actual, monopolar EMGs.
V. CONCLUSION
In this paper, we propose a new method for the reduction of
power line interference from monopolar EMG signals recorded
with high-density detection systems. This method is an improvement of the VR technique, whose potential negative effect on
the information content of monopolar signals has been demonstrated theoretically and experimentally. According to our key
results, the FVR method seems to attenuate the power line interference minimizing the distortions of the actual, monopolar
EMGs.
ACKNOWLEDGMENT
The authors would like to thank R. Merletti (Politecnico di
Torino, Italy) for the useful discussions on this study.
REFERENCES
[1] R. Merletti et al., “Advances in surface EMG: Recent progress in clinical
research applications,” Crit. Rev. Biomed. Eng., vol. 38, no. 4, pp. 347–379,
2010.
[2] R. Merletti et al., “Advances in surface EMG: Recent progress in detection and processing techniques,” Crit. Rev. Biomed. Eng., vol. 38, no. 4,
pp. 305–345, 2010.

BOTTER AND VIEIRA: FILTERED VIRTUAL REFERENCE: A NEW METHOD FOR THE REDUCTION OF POWER LINE INTERFERENCE

[3] G. Drost et al., “Clinical applications of high-density surface EMG: A
systematic review,” J. Electromyogr. Kinesiol., vol. 16, no. 6, pp. 586–602,
Dec. 2006.
[4] M. J. Zwarts and D. F. Stegeman, “Multichannel surface EMG: Basic
aspects and clinical utility,” Muscle Nerve, vol. 28, no. 1, pp. 1–17, 2003.
[5] D. F. Stegeman et al., “Multi-channel surface EMG in clinical neurophysiology,” Suppl. Clin. Neurophysiol., vol. 53, pp. 155–162, 2000.
[6] F. F. Offner, “The EEG as potential mapping: The value of the average
monopolar reference,” Electroencephalogr. Clin. Neurophysiol., vol. 2,
no. 2, pp. 213–214, May 1950.
[7] O. Bertrand et al., “A theoretical justification of the average reference in
topographic evoked potential studies,” Electroencephalogr. Clin. Neurophysiol., vol. 62, no. 6, pp. 462–424, Nov. 1985.
[8] M. Junghöfer et al., “The polar average reference effect: A bias in estimating the head surface integral in EEG recording,” Clin. Neurophysiol.,
vol. 110, no. 6, pp. 1149–1155, Jun. 1999.
[9] D. Yao et al., “The effect of reference choices on the spatio-temporal
analysis of brain evoked potentials: The use of infinite reference,” Comput.
Biol. Med., vol. 37, no. 11, pp. 1529–1537, Nov. 2007.
[10] D. F. Stegeman et al., “Near- and far-fields: Source characteristics and
the conducting medium in neurophysiology,” J. Clin. Neurophysiol.,
vol. 14, no. 5, pp. 429–442, Sep. 1997.
[11] D. T. Mewett et al., “Reducing power line interference in digitised electromyogram recordings by spectrum interpolation,” Med. Biol. Eng. Comput., vol. 42, no. 4, pp. 524–531, 2004.
[12] A. J. Fuglevand et al., “Models of recruitment and rate coding organization
in motor unit pools,” J. Neurophysiol., vol. 70, no. 6, pp. 2470–2488, Dec.
1993.
[13] D. Farina et al., “A surface EMG generation model with multilayer cylindrical description of the volume conductor,” IEEE Trans. Biomed. Eng.,
vol. 51, no. 3, pp. 415–426, Mar. 2004.
[14] A. Gallina and A. Botter, “Spatial localization of electromyographic amplitude distributions associated to the activation of dorsal forearm muscles,” Frontiers Physiol., vol. 4, no. 367, Dec. 2013.
[15] A. O. Andrade et al., “EMG signal filtering based on empirical mode
decomposition,” Biomed. Signal Process. Control, vol. 1, pp. 44–55, Jan.
2006.
[16] X. Zhang and P. Zhou, “Filtering of surface EMG using ensemble empirical mode decomposition,” Med. Eng. Phys., vol. 35, no. 4, pp. 537–542,
Apr. 2013.
[17] C. J. De Luca and R. Merletti, “Surface myoelectric signal cross-talk
among muscles of the leg,” Electroencephalogr. Clin. Neurophysiol.,
vol. 69, no. 6, pp. 568–575, Jun. 1988.
[18] D. Farina et al., “Cross-talk between knee extensor muscles. Experimental
and modeling results,” Muscle Nerve, vol. 26, pp. 681–695, 2002.
[19] D. Farina et al., “Influence of anatomical, physical, and detection-system
parameters on surface EMG,” Biol. Cybern., vol. 86, no. 6, pp. 445–456,
Jun. 2002.
[20] A. Gydikov and D. Kosarov, “The influence of various factors on the shape
of the myopotentials in using monopolar electrodes,” Electromyogr. Clin.
Neurophysiol., vol. 13, no. 3, pp. 319–343, 1973.
[21] A. Gydikov and N. A. Trayanova, “Extracellular potentials of single active
muscle fibres: Effects of finite fibre length,” Biol. Cybern., vol. 53, no. 6,
pp. 363–372, 1986.
[22] A. Gallina et al., “Do surface electromyograms provide physiological
estimates of conduction velocity from the medial gastrocnemius muscle?,”
J. Electromyogr. Kinesiol., vol. 23, no. 2, pp. 319–325, 2013.
[23] G. Piervirgili et al., “A new method to assess skin treatments for lowering the impedance and noise of individual gelled Ag-AgCl electrodes,”
Physiol. Meas., vol. 35, no. 10, pp. 2101–2118, Oct. 2014.
[24] D. Dumitru, “Physiologic basis of potentials recorded in electromyography,” Muscle Nerve, vol. 23, no. 11, pp. 1667–1685, 2000.

2647

[25] K. Roeleveld et al., “The motor unit potential distribution over the skin
surface and its use in estimating the motor unit location,” Acta Physiol.
Scand., vol. 161, no. 4, pp. 465–472, Dec. 1997.
[26] B. U. Kleine et al., “Surface EMG mapping of the human trapezius muscle: The topography of monopolar and bipolar surface EMG amplitude and
spectrum parameters at varied forces and in fatigue,” Clin. Neurophysiol.,
vol. 111, no. 4, pp. 686–693, Apr. 2000.
[27] A. Gallina and T. M. Vieira, “Territory and fiber orientation of vastus
medialis motor units: A surface electromyography investigation,” Muscle
Nerve, 2015, doi: 10.1002/mus.24662
[28] T. M. Vieira et al., “Is the stabilization of quiet upright stance in humans
driven by synchronized modulations of the activity of medial and lateral
gastrocnemius muscles?,” J. Appl. Physiol., vol. 108, no. 1, pp. 85–97,
Jan. 2010.
[29] D. Staudenmann et al., “Methodological aspects of SEMG recordings
for force estimation—A tutorial and review,” J. Electromyogr. Kinesiol.,
vol. 20, no. 3, pp. 375–387, Jun. 2010.
[30] C. Avancini et al., “Variations in the spatial distribution of the amplitude
of surface EMGs are unlikely explained by changes in the length of medial
gastrocnemius fibres with knee joint angle,” PLoS One, vol. 10, no. 5, May
2015.

Alberto Botter received the M.Sc. degree in electronics engineering and the Ph.D. degree in biomedical
engineering from Politecnico di Torino, Torino, Italy,
in 2005 and 2010, respectively.
He is currently Postdoctoral Fellow of the Laboratory for Engineering of the Neuromuscular System,
Politecnico di Torino. His main research interests are
in the areas of neuromuscular electrical stimulation,
surface electromyography, basic and applied physiology of the neuromuscular system, and signal processing applied to biomedical signals.

Taian M. Vieira graduated in physical education
and, in January 2005, received the M.Sc. degree in
biomedical engineering, from the Federal University
of Rio de Janeiro, Rio de Janeiro, Brazil. With a doctoral scholarship provided by the Brazilian Research
Council (CNPq), in January 2011, he received the
Ph.D. degree in biomedical engineering from the Politecnico di Torino, Torino, Italy.
He is currently Adjunct Professor at the School of
Sports Science, Federal University of Rio de Janeiro,
and Postdoctoral Fellow of the Laboratory for Engineering of the Neuromuscular System, Politecnico di Torino. His research
interest is chiefly focused on the use of electromyography to gain insights into
the control of human posture, movement and performance.
Dr. Vieira received two student presentation awards by international, scientific societies. In July 2011, he was the inaugural winner of the Emerging
Scientist Award of the International Society of Biomechanics.

