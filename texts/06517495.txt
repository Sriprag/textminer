IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

2725

Subspace Identification of SISO Hammerstein
Systems: Application to Stretch Reflex Identification
Kian Jalaleddini∗ , Student Member, IEEE, and Robert E. Kearney, Fellow, IEEE

Abstract—This paper describes a new subspace-based algorithm
for the identification of Hammerstein systems. It extends a previous approach which described the Hammerstein cascade by a
state-space model and identified it with subspace methods that are
fast and require little a priori knowledge. The resulting state-space
models predict the system response well but have many redundant
parameters and provide limited insight into the system since they
depend on both the nonlinear and linear elements. This paper addresses these issues by reformulating the problem so that there are
many fewer parameters and each parameter is related directly to
either the linear dynamics or the static nonlinearity. Consequently,
it is straightforward to construct the continuous-time Hammerstein models corresponding to the estimated state-space model.
Simulation studies demonstrated that the new method performs
better than other well-known methods in the nonideal conditions
that prevail during practical experiments. Moreover, it accurately
distinguished changes in the linear component from those in the
static nonlinearity. The practical application of the new algorithm
was demonstrated by applying it to experimental data from a study
of the stretch reflex at the human ankle. Hammerstein models
were estimated between the velocity of ankle perturbations and
the EMG activity of triceps surae for voluntary contractions in the
plantarflexing and dorsiflexion directions. The resulting models
described the behavior well, displayed the expected unidirectional
rate sensitivity, and revealed that both the gain of the linear element and the threshold of the nonlinear changed with contraction
direction.
Index Terms—Hammerstein systems, nonlinear physiological
system identification, reflex dynamics, state-space models.

I. INTRODUCTION
HAMMERSTEIN system as shown in Fig. 1 consists of a
zero memory static nonlinearity followed by a linear dynamic system [1]. Many physical and biological systems can be
modeled with the Hammerstein structure; biological examples
include the reflex stiffness of human ankle joint [2], the neural
integrator model of the human vestibular-ocular reflex [3], and
the mechanical behavior of lung tissue [4].
A variety of methods have been developed to identify Hammerstein systems. Stochastic methods estimate the linear and

A

Manuscript received September 17, 2012; revised February 22, 2013 and
April 11, 2013; accepted May 4, 2013. Date of publication May 20, 2013; date
of current version September 14, 2013. This work was supported by the CIHR,
NSERC, FQRNT. Asterisk indicates corresponding author.
∗ K. Jalaleddini is with the Department of Biomedical Engineering,
McGill University, Montreal, QC H3A 2B4, Canada (e-mail: seyed.
jalaleddini@mail.mcgill.ca).
R. E. Kearney is with the Department of Biomedical Engineering, McGill University, Montreal, QC H3A 2B4, Canada (e-mail: robert.kearney@mcgill.ca).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2264216

Fig. 1. Hammerstein system model comprises a static nonlinearity followed
by a linear system. The input signal is u(k), z(k) is the output of the nonlinearity
and the input to the linear system, y(k) is the noise-free output. n(k) is additive
noise, and ỹ(k) the noisy output. The only signals available for identification
are u(k) and ỹ(k).

nonlinear components of the Hammerstein cascade with no
a priori knowledge of the system. However, they require the
input to be white [5], [6]—a severe limitation since in practice
it is rarely feasible to generate white inputs experimentally.
Another category of Hammerstein system identification algorithms uses iterative approaches. Hunter and Korenberg [1]
described a method that first estimates the linear dynamics using
cross correlation-based methods. It estimates the nonlinearity’s
output using the inverse dynamics of the linear component and
then uses this predicted output to estimate the nonlinearity. The
linear dynamics are then reestimated using the output predicted
by the estimated nonlinearity and the iteration repeated. The
method does not require the input to be white but the input
distribution needs to be Gaussian. Westwick and Kearney presented a method that formulates the output of the system as a
linear function of some parameters and nonlinear function of the
others [7]. Separable least-squares (SLS) optimization was then
used to estimate the linear and nonlinear elements. This method
does not require the input to be either white or Gaussian.
Another class of iterative algorithms separated the parameters
into two sets: one corresponding to the static nonlinearity and the
second to the linear element [8]. The output is a linear function
of each parameter set provided the other set is held constant. In
the first step, one set of parameters is held fixed and the other
set is estimated using least-squares. The parameter sets are then
interchanged and the same procedure is used to estimate the
optimal value for the second set. The algorithm iterates until
it converges to the optimal parameter values. Convergence can
be assured by 1) normalizing the parameter estimates at each
iteration and 2) setting the initial point for the optimization
search correctly [9]–[11].
Most nonparametric approaches for the identification of Hammerstein systems, model the linear component as an impulse
response function (IRF) [1], [7], [8]. This has the advantage of
requiring little a priori knowledge of the system but may result in models with many parameters if the system has a long
memory. For instance, describing a low-pass filter with a very
low-break frequency requires a long IRF, i.e., introducing many
unknown parameters [12]. This can result in less accurate estimation when the noise level is high.

0018-9294 © 2013 IEEE

2726

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

In contrast, parametric approaches can provide parsimonious
models but require accurate a priori information about the system structure, i.e., system order, noise model, etc., [12]. Moreover, using a parametric method with an incorrect model will
give misleading results [13]. What is desired is an identification
approach that yields parsimonious models while requiring minimal a priori information. The subspace method described in
this paper achieves this.
Subspace methods were originally developed to estimate
state-space models for multiple-input/multiple-output (MIMO)
linear systems; they require little a priori knowledge since the
order of the state-space model is determined as part of the estimation procedure [14], [15]. They are efficient computationally,
and can be extended to identify systems with both input and
output noise [16]. Moreover, as Verhaegen and Westwick [17]
showed, the multivariable output error state-space (MOESP)
subspace algorithm can be used to identify Hammerstein models
by transforming the single-input/single-output (SISO) nonlinear
Hammerstein model into a multi-input/single-output (MISO)
linear state-space model and identifying it with MOESP. Models estimated with this approach have excellent predictive capabilities but, as a result of the transformation to MISO, their
parameters are not directly related to those of the SISO system.
This causes two problems. First, many of the MISO model parameters are redundant and the resulting overparameterization
can be expected to reduce the identification robustness. Second,
each MISO parameter depends on the properties of both the
nonlinear and the linear dynamic elements. Consequently, it is
difficult to relate changes in the state-space model parameters
to those of the original Hammerstein model. For example, in
studying the stretch reflex it is important to distinguish changes
in the linear dynamics from those of the static nonlinearity. Thus,
when we used the method described in [17] to estimate a statespace model for joint stiffness, additional steps were required to
recover the underlying nonlinearity and linear dynamics [18].
The paper is organized as follows. Section II, formulates the state-space model for Hammerstein system. Section III describes the new identification algorithm which extends
Verhaegen’s algorithm [17] to estimate directly the coefficients
of the basis function expansion of the nonlinearity and the statespace model of the linear component. Section IV presents the
results of simulation studies that validate and evaluate the performance of the new algorithm. It compares the new method
with the original subspace method [17], which is a parametric approach, and two nonparametric identification methods:
Hunter–Korenberg H-K [1] and SLS algorithms [7]. Section V
gives experimental results and Section VI provides a discussion
and some concluding remarks.
II. PROBLEM FORMULATION
This section first formulates the state-space model for a
Hammerstein structure as developed in [17]. The SISO, nonlinear Hammerstein system is transformed into a MISO linear
model whose inputs are constructed from a basis function expansion of the static nonlinearity. Then, it shows how the static
nonlinearity and the linear system parameters appear individu-

ally in data equations. Throughout this paper, vectors, matrices,
and scalars are indicated by bold-face uppercase, uppercase, and
lowercase letters, respectively.
Consider a SISO Hammerstein discrete-time system shown in
Fig. 1 consisting of a static nonlinear block followed by a linear
dynamic system. Define z(k) to be the output of the nonlinear
component—an intermediate signal that cannot be observed.
Approximate the nonlinearity by an orthogonal basis function
expansion (e.g., Tchebyshev, Hermite, and so on)
z(k) = f (u(k)) 

n


ωi gi (u(k))

(1)

i=1

where gi (·) is the ith basis function, n is the order of the expansion, and ωi is its coefficient. Assume that Ns samples of u(k),
the input of the Hammerstein structure, and y(k) its output are
recorded.
Assume the linear component is stable and can be represented
by a state-space model

X(k + 1) = AX(k) + Bz(k)
(2)
y(k) = CX(k) + Dz(k)
where X(k) is a m × 1 state vector while Am ×m , B m ×1 , C1×m ,
and D1×1 are the state-space model matrices. Represent the
elements of B and D by
B = [b1 , . . . , bm ]T
D = [d] .

(3)

Assume the measured output ỹ(k) is contaminated with additive
noise, n(k) that is zero mean and uncorrelated with the input
signal u(k). Define the vectors
Ω = [ω1 , . . . , ωn ]T

(4)
T

U (k) = [g1 (u(k)) , . . . , gn (u(k))] .
Substitute (4) and (5) in (2) to yield

X(k + 1) = AX(k) + BΩ U (k)
y(k) = CX(k) + DΩ U (k)
where

⎡

b1 ω 1
⎢ .
T
.
BΩ = BΩ = ⎢
⎣ .
bm ω 1
DΩ = DΩT = [ dω1

···
..
.
···

···

⎤
b1 ω n
⎥
..
⎥
.
⎦
bm ω n
dωn ].

(5)

(6)

(7)

(8)

Note that this parameterization is not unique since for any
arbitrary scalar β, the vectors βB, βD, and β −1 Ω will generate the same matrices BΩ and DΩ . Consequently, to provide a
unique solution we will require that the first nonzero element
of the vector Ω be positive and Ω = 1, where  ·  is the two
norm.
Note that (6) models the total Hammerstein system as a MISO
system whose input is U (k), a n × 1 vector constructed from the
basis function expansion of the input to the SISO system. Thus,

JALALEDDINI AND KEARNEY: SUBSPACE IDENTIFICATION OF SISO HAMMERSTEIN SYSTEMS

the estimated state-space matrices have the following structure:

 S
S
X̂ (k + 1) = ÂS X̂ (k) + B̂ S U (k)
(9)
S
ŷ(k) = Ĉ S X̂ (k) + D̂S U (k)

2727

where Ψ is the Ns × n(m + 1) data matrix constructed only
from the known or estimated elements
Ψ = [ΔN s , ΦN s ] .

(15)

S

where the superscript (·) indicates that the identification is
achieved up to a similarity transform. One can show that given
the matrix S as the similarity transform, the matrices B̂ S and
D̂S can be written as follows:
⎡ S
⎤
b1 ω1 · · · bS1 ωn
⎢ .
⎥
.
..
⎥
(10)
B̂ S  S −1 BΩ = ⎢
. ..
⎣ ..
⎦
bSm ω1
D̂S  DΩ = [ dω1

···

···

bSm ωn

dωn ].

(11)

T

Remark 1: The vector B S = bS1 , . . . , bSm incorporates the
effect of the similarity transform, i.e., B S = S −1 B. Thus, the
similarity transform has no effect on the parameter set Ω but
does alter the parameters corresponding to the linear component,
i.e., b1 , . . . , bm , d. Also note that the rows of the matrices BΩ
and DΩ are linearly dependent.
III. ALGORITHM
The first step of the new algorithm uses MOESP to estimate
the order of the linear component and the ÂS and Ĉ S statespace matrices from the constructed input (5) and the measured
noisy output ỹ(k). MOESP is described in [14]–[17] and is
not repeated here. We used MOESP automatic order selection
method which is described in [16] and [19].
It remains to estimate the vector B S and the scalar d, which
define the linear dynamics, and the vector Ω̂ which contains
the coefficients of the basis function expansion of the nonlinear
block. The output of (9) can be expressed as [16]
 k −1

 

T
S ˆS k −1−τ
ŷ(k) =
vec B̂ S
U (τ ) ⊗ Ĉ A
τ =0

 


+ U T (k) vec D̂S + n(k)

(12)

Let the columns of Ψ be Ψ1 , Ψ2 , . . . , Ψn (m +1) . The vector Θ
contains the unknown parameters stacked in a single vector

Θ=

B̄
D̄




=

vec(B)
vec(D)


.

For normal linear MISO identification, the remaining system
parameters are estimated by solving the least-squares problem
defined by (14). However, for the Hammerstein model, the parameters of interest appear as nonlinear combinations
Θ = [bS1 ω1 , . . . , bSm ω1 , bS1 ω2 , . . . , bSm ω2 ,
. . . bS1 ωn , . . . , bSm ωn , dω1 , . . . , dωn ]T .



Y = Ψ1 ω1 + Ψm +1 ω2 + · · · + Ψm (n −1)+1 ωn bS1

Y = [ỹ(0), . . . , ỹ(Ns − 1)]T

T
N
s −2
T
S ˆS N s −2−τ
ΔN s = 0, . . . ,
U (τ ) ⊗ Ĉ A

+ (Ψm ω1 + Ψ2m ω2 + · · · + Ψm n ωn ) bSm

+ ······


+ (Ψm n +1 ω1 + Ψm n +2 ω2 + · · · + Ψm n +n ωn ) d + E.

τ =0

(18)



= U T (0), . . . , U T (Ns − 1)
Write this equation in matrix form

B̄ = vec(B̂ S )

⎡ bS ⎤

D̄ = vec(D̂S )
E = [ n(0)

(17)

Consequently, the parameters {bS1 , . . . , bSm , ω1 , . . . , ωn , d} cannot be estimated directly by the linear least-squares solution.
Note that the parameters in the vector Θ are combinations
of a smaller number of independent parameters that may be
divided into two subsets: the coefficients of the nonlinearity
{ω1 , . . . , ωn } and the parameters of linear system’s state-space
model {bS1 , . . . , bSm , d}. These parameters can be estimated separately using the iterative approach suggested in [9]–[11] as
follows: assume an initial set of values for the nonlinear coefficients {ω1 , . . . , ωn }, and estimate the parameters of the linear
dynamics using the ordinary least-squares. Then, fix these parameters {bS1 , . . . , bSm , d} and estimate the parameters of the
nonlinearity using an ordinary least-squares solution. Repeat
the procedure until it converges to optimal values.
To use this approach, the data equation (14) must be reformulated so that if the coefficients of the basis function expansion of
the static nonlinearity (Ω) are known, then the output vector Y
T

is a linear function of the unknown parameters bS1 bS2 . . . bSm d .
To do so, group the linear system parameters as follows:

where the operator vec(·) stacks the columns of a matrix (·) on
top of each other in a tall vector and ⊗ is the Kroncker product.
Define the following matrices

ΦN s

(16)

1

n(1)

...

n(Ns − 1) ]T .

(13)

Rewrite (12) as the matrix equation
Y = ΨΘ + E

(14)

⎢.
⎢ ..
Y = ΨΩ ⎢
⎢ S
⎣ bm
d

⎥
⎥
⎥+E
⎥
⎦

(19)

2728

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

where it is evident from (18) and (14) that ΨΩ is
⎤
⎡
ω1 . . .
0 0
⎢ .
.. .. ⎥
..
⎢ ..
.
. . ⎥
⎥
⎢
⎥
⎢
⎢ 0 · · · ω1 0 ⎥
⎥
⎢
⎢ .
..
.. .. ⎥
⎥
⎢ .
.
. . ⎥
⎢ .
⎥
⎢
⎢ω
0 0 ⎥
⎥
⎢ n ···
ΨΩ = Ψ ⎢
⎥.
.. .. ⎥
⎢ ..
..
⎥
⎢ .
.
.
.
⎥
⎢
⎥
⎢
⎢ 0 · · · ωn 0 ⎥
⎥
⎢
⎢ 0 ···
0 ω1 ⎥
⎥
⎢
⎢ .
.. .. ⎥
..
⎥
⎢ .
.
⎣ .
. . ⎦
0

···

0

(20)

ωn

The second requirement is to find a formulation that relates
the output Y linearly to the unknown vector Ω given the statespace parameters bS1 , bS2 , . . . , bSm d are known. To do so, collect
the terms associated with each nonlinear parameter to give


Y = Ψ1 bS1 + Ψ2 bS2 + · · · + Ψm bSm + Ψm n +1 d ω1


+ · · · + Ψm (n −1)+1 bS1 ωn


+ Ψm (n −1)+2 bS2 + · · · + Ψm n bSm + Ψm n +n d ωn + E.

1) Initialization
Let j = 1 and Ω̂(0) = [1, . . . , 1]Tn ×1 .
2) Construct the matrix ΨΩ̂(j −1) using (20).
3) Estimate [bS1 , . . . , bSm , d]T by solving the least-squares
problem defined in (19) to give
⎡ S
⎤
b̂1 (j)
⎢ . ⎥
⎢ . ⎥ 
†
⎢
⎥
ˆ
bd(j) = ⎢ . ⎥ = ΨΩ̂(j ) Y
(24)
⎢ b̂S (j) ⎥
⎣ m
⎦
ˆ
d(j)
where † is the pseudoinverse.
4) Construct the matrix Ψbd(j
ˆ ) using (23).
T
5) Estimate [ω1 , . . . , ωn ] by solving the least-squares problem (22) to give
⎡
⎤
ω̂1 (j)
†
⎢ . ⎥ 
⎥ = Ψˆ
.
Y.
(25)
Ω̂(j) = ⎢
bd(j )
⎣ . ⎦
ωn (j)
6) Let s be the sign of first nonzero element of Ω̂(j):
s = sgn (ω̂1 (j)) .
Perform the normalization





ˆ
ˆ
bd(j)
← bd(j)s
Ω̂(j)

(21)
Write this in matrix form as

⎡

Ω̂(j)s
.
Ω̂(j) ← 


Ω̂(j)

⎤

ω1
⎢ . ⎥
. ⎥
Y = Ψbd ⎢
⎣ . ⎦+E
ωn
where from (21) and (14) it can be seen that Ψbd is
⎡ S
⎤
b1
0 ··· 0
⎢ .
..
. ⎥
..
⎢ .
⎥
. .. ⎥
⎢ .
.
⎢
⎥
⎢ bS
0 ··· 0 ⎥
⎢ m
⎥
⎢
⎥
⎢ ..
..
..
.. ⎥
⎢ .
.
.
. ⎥
⎢
⎥
⎢
⎥
⎢ 0
0 · · · bS1 ⎥
⎢
⎥
⎢
..
.. ⎥
..
.
Ψbd = Ψ ⎢ ..
. . ⎥
.
⎢ .
⎥
⎢
⎥
⎢ 0
0 · · · bSm ⎥
⎢
⎥
⎢
⎥
⎢ d ··· ··· 0 ⎥
⎢
⎥
⎢ .
.. ⎥
..
⎢ ..
⎥
.
.
⎢
⎥
⎢ .
.. ⎥
..
⎢ .
. . ⎥
⎣ .
⎦
0 ··· ···
d

(22)

Algorithm: The following algorithm uses these two formulations to estimate the unknown parameters bS1 , . . . ,
bSm , d, ω1 , . . . , ωn . The algorithm is iterative so variables will
be indexed according to the iteration number j.

(27)

7) Compute the sum of squared error (SSE) between the
predicted output and the measured output.
8) Terminate if SSE satisfies the following condition; otherwise replace j by j + 1 and go to step (2)
SSE(j) − SSE(j − 1)
≤ threshold.
SSE(j − 1)

(23)

(26)

(28)

Considering SSE as a cost function, it is strictly convex at
each iteration [9], and so there will be a unique global minimum
at each step. In addition, the cost function will decrease with
each iteration. Moreover, the algorithm will converge after at
most two steps to the true values of the parameters in the limit,
i.e., provided enough samples are available [9].
The threshold value for the stopping criteria is adjustable.
However, the algorithm converges very quickly with improvements in the SSE becoming very small after a relatively few
iterations. In the results presented here, we used a threshold of
10−10 and the algorithm converged after 6–8 iterations.
IV. SIMULATION RESULTS
A. Methods
The performance of the algorithm was evaluated using simulated data from the stretch reflex stiffness model of the human’s
ankle shown in Fig. 2. In this model, the input, u(k) joint velocity, first passes through a static nonlinearity and then through
a linear component consisting of a delay and a second-order

JALALEDDINI AND KEARNEY: SUBSPACE IDENTIFICATION OF SISO HAMMERSTEIN SYSTEMS

Fig. 2.

2729

Hammerstein model of reflex stiffness.

low-pass filter to generate the output torque. This model describes reflex behavior well and has been used extensively to
explore the human stretch reflex [2], [18], [20]. The nonlinear
element accounts for two experimentally observed phenomena:
strong unidirectional rate sensitivity is modeled as a threshold at
p1 [21]; a saturation of the response at high velocities is modeled
with a saturation at p2 [21]. This nonlinearity can be described
analytically as
(u(k) − p1 ) + (u(k) − p1 )sgn(u(k) − p1 )
2
(u(k) − p2 ) + (u(k) − p2 )sgn(u(k) − p2 )
−
(29)
2
where sgn is the sign function. The continuous-time transfer
function of the linear component is
f (u(k)) =

H(s) =

e−τ s Gw2
s2 + 2sζw + w2

(30)

where s is the Laplace variable, G is the gain, ζ is the damping
parameter, w is the natural frequency, and τ is the delay in
seconds. Nominal values of these parameters were based on
those described previously [20]


⎧
Nms
⎪
⎪
G
=
25
⎪
⎪
rad
⎪
⎪
⎪
⎪
⎪
ζ = 0.98
⎪
⎪
⎪


⎪
⎪
rad
⎪
⎪
⎪
⎨ w = 20 s
(31)
⎪
τ = 0.04(s)
⎪
⎪


⎪
⎪
⎪
rad
⎪
⎪
p1 = 0
⎪
⎪
s
⎪
⎪
⎪


⎪
⎪
rad
⎪
⎪
⎩ p2 = 1.5
.
s
To avoid aliasing due to the nonlinearity, the model was simulated using MATLAB Simulink at 1 KHz for 60 s. Signals
were then filtered with an eight-order low-pass filter with cutoff
frequency of 40 Hz and decimated to 100 Hz before analysis. Gaussian white noise was added to the decimated output
to simulate experimental noise; the amplitude of the noise was
adjusted to generate the required SNR defined as


RMSsignal
.
(32)
SNR (dB) = 20log10
RMSnoise
The model used by SLS and H-K had 50 unknown parameters for the IRF and 12 parameters for the static nonlinearity
for a total of 62 free parameters while the Hammerstein statespace model used in OSS algorithm had 42 unknown parameters. In comparison, the NSS algorithm had three parameters
for the state-space matrices B and D, six parameters for the
state-space matrices A and C, and 12 parameters for the static

Fig. 3. Cumulative distribution function (CDF) of the difference between
%VAF of the NSS method and those of (a) OSS; (b) SLS; (c) H-K. Results are
shown for SNRS of −15 and +15 dB.

nonlinearity, for a total 21 free parameters. Consequently, the
NSS describes the same dynamics with fewer parameters than
the other methods which should make its estimates more robust.
The similarity of the predicted ŷ to the noise-free simulated
reflex torque, y was quantified in terms of percentage variance
accounted for (%VAF)


var(ŷ − y)
.
(33)
%VAF = 100 1 −
var(y)
To derive confidence intervals on the prediction %VAF, we
used Monte Carlo simulations with 1000 trials in which each
trial involved a new realization of input signal and noise sequence. The distributions of the %VAFs for the different methods were not Gaussian, so we used a nonparametric approach
to estimate the significance of differences between methods.
Thus, for each trial we computed the difference between the
%VAF of the new method and each of three other methods.
Then, we computed the cumulative distribution function (CDF)
of this difference for the 1000 trials. The value of this CDF at
zero p gives the probability that the %VAF of NSS was equal
to or smaller than that of the other method. Thus, the lower this
probability, the greater confidence that the NSS method is more
accurate. Fig. 3 shows the CDFs for Monte Carlo simulations
at SNR levels of −15 and +15 dB. For the low SNR of −15
dB, p < 0.02 for all three comparisons. Consequently, NSS was
more accurate than others at this SNR level. The difference was,
however, not significant at +15 dB in comparison to the original
subspace (p = 0.40) and SLS (p = 0.18) methods, however, the

2730

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 4. Input signal used for simulation: (a) a realization of the position;
(b) a realization of the velocity; (c) amplitude distribution of the input;
(d) power spectrum of velocity.

Fig. 5. Mean output prediction (%VAF) bracketed by 95% range, i.e., [2.5–
97.5%] percentiles, for all four methods. Stars indicate cases where the %VAFs
were less than those of NSS in >95% of trials.

new method was still significantly more accurate than H-K at
this SNR level (p = 0).
B. Input Design
The position input often used in the identification of reflex
stiffness is pseudorandom binary sequence (PRBS) of low amplitude displacements around an operating point. The histogram
of the velocity of this input has three major peaks corresponding
to zero, positive, and negative velocities [21]. As a result, while
the PRBS input excites the linear system well, its amplitude
distribution is not well suited to estimate the static nonlinearity
since an infinite number of polynomials can be fit between these
three levels. To address this, we used a velocity input generated
by sampling a uniform distribution at 250 ms intervals. For simulation purposes, we integrated the velocity signal to produce
the desired angular position signal. Position was then filtered
with a second order low-pass Butterworth filter with break frequency of 15.9 Hz to represent actuator dynamics. Fig. 4 shows
one realization of the resulting position input, the corresponding velocity, its distribution, and power spectrum. The amplitude histogram of the velocity shows that it is distributed over
the whole range of possible values and so this input provides
a much richer set of values with which to estimate the static
nonlinearity. The frequency spectrum of the simulated actuator
velocity is not white but does contain power up to 30 Hz suitable
for the identification.
C. Results
We compared the predictive ability of the models produced
by the different methods in a Monte Carlo validation where the
SNR was varied between −15 to 15 dB at 10 dB increments.
We first estimated a model using half of the data points. Then,
we quantified the results in terms of the %VAF between the true
output and predicted output using the second half of the data
points.
First, we studied the output prediction accuracy of the new
method in comparison to other methods. Fig. 5 shows the %VAF

Fig. 6. Hammerstein models of stretch reflex identified from simulation data
(SNR = 5 dB). (a) Static nonlinearity (b) IRF.

and its statistics for each method at different noise levels. It
shows that the output predictions from the new method were
significantly more accurate than those from all other methods
at SNRs of −15, −5, and 5 dB. At +15 dB, the only significant
difference was for H-K.
Second, we examined the accuracy with which the nonlinear
and linear elements of the Hammerstein model were estimated
by NSS in comparison to the H-K and SLS algorithms. Note that,
as indicated in the introduction, the original state-space method
does not yield direct estimates of the static nonlinearity or linear
dynamic elements of the Hammerstein systems. Consequently,
no results are shown in Figs. 6 and 7 for this method. For this
comparison, we used the nominal linear model, a nonlinearity with fixed value for threshold (p1 = 0( rad
s )) and saturation
rad
(p2 = 1.5( s )) and a SNR level of 5 dB. The nonlinear elements were evaluated by comparing their shapes over the input
range. The nonlinearities estimated using SLS and subspace
were very similar to that simulated. As shown in Fig. 6(a), the
nonlinearity estimated with H-K was, however, wrong.
The linear dynamics estimated by the different methods were
compared in terms of their IRFs. Both SLS and H-K methods
estimate IRFs directly; the IRF of the state-space model was
determined by simulating its response to unit impulse. As shown
in Fig. 6(b), the IRF estimated by the subspace method was

JALALEDDINI AND KEARNEY: SUBSPACE IDENTIFICATION OF SISO HAMMERSTEIN SYSTEMS

2731

Fig. 7. Mean IRF estimation accuracy (%VAF) bracketed by 95% range. Stars
indicate cases with %VAFs less than those of NSS in 95% of trials.

almost identical to that simulated. The IRFs estimated by both
SLS and HK had considerable noise.
The subspace and SLS algorithms both predicted the noisefree torque well (%VAF of 99.7%, 99.4%, respectively) while
the prediction of the H-K method was poor (%VAF = 81.2%).
We studied the robustness of the different methods, further
by using a Monte Carlo simulation to examine how well the
linear dynamics were estimated as the SNR level changed. To
do so, the gain, threshold, and saturation were held fixed at the
rad
same values (p1 = 0( rad
s ) and p2 = 1.5( s )) while the SNR
was varied from 0 to 20 dB. A Monte Carlo simulation of
1000 trials was performed at each SNR (each with different
realization of input and noise signals) and the estimated IRF
was compared to that simulated in terms of %VAF. Similar to
Fig. 5, Fig. 7 shows the mean value of the %VAF bracketed by
its 95% range as a function of SNR. It also shows the statistical
test results as a star on the bar plot if the new subspace method
was significantly more accurate. The new subspace algorithm
performed the best—it had the highest mean %VAF with lowest
variation at all SNRs. Moreover, the IRF was significantly more
accurately identified at all levels.
There are physiological reasons to expect both the linear and
nonlinear elements may change independently. Consequently,
it is important for an identification algorithm to distinguish between changes in the linear and nonlinear elements. To examine
this, Monte Carlo simulations were done to assess the ability
of the algorithm to distinguish between changes in gain and
threshold. Systematic changes in the linear system gain G (10
to 30) and nonlinearity threshold (−0.8 to 0.2) were made and
100 trials were simulated at each threshold/gain combination,
each with different realizations of noise and input sequence.
The results of identifying each trial were parameterized by:
1) fitting equations (29) to the estimated nonlinearity and 2)
fitting underdamped second-order IRF (34) to the estimated
IRF. Fits were done using Levenberg–Marquardt method in
MATLAB curve fitting toolbox
h(t) = 

Gw
1 − ζ2

 

e−ζ w (t−τ ) sin w 1 − ζ 2 (t − τ ) .

(34)

Fig. 8. Estimation accuracy of the Hammerstein model; (a) mean value of the
predicted gains; (b) CV associated with the estimation of gain; (c) mean value
of the predicted thresholds; (d) CV associated with the estimation of threshold.

Fig. 9. Estimation accuracy of the Hammerstein model; (a) mean value of the
predicted gain; (b) CV associated with the estimation of gain; (c) mean value of
the predicted saturation; (d) CV associated with the estimation of saturation.

Fig. 8(a) shows the mean value of the estimated gain as a function of the simulated gain and threshold. Fig. 8(b) shows the
coefficient of variation CV of the gain estimates. Fig. 8(c) and
(d) shows the results for the identification of the threshold in a
similar manner.
In another set of simulations, the gain and saturation parameters were varied systematically between [10–30] and [1], [2]
while the threshold was held constant which is shown in Fig. 9.
Figs. 8 and 9 show that the new method tracked the changes
accurately in the shape of the nonlinearity from changes in the
linear component.
To evaluate the quality of the tracking, we fitted planes to the
data from Figs. 8 and 9. Ideally, the estimated thresholds, saturations, and gains should be equal to those simulated and the fitted
planes would have a slope of 1. The fit results are summarized in

2732

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

TABLE I
ESTIMATION ACCURACY WHEN GAIN AND THRESHOLD VARY

TABLE II
ESTIMATION ACCURACY FOR VARYING GAIN AND SATURATION VALUES

Fig. 10. Hammerstein models estimated from reflex EMG at two different
torque directions.

Table I for threshold/gain and in Table II for saturation/gain. For
the NSS method, the slopes were close to one and the r-squared
values were large indicating that changes in the gain, threshold,
and saturation were distinguished accurately. Results from SLS
were also very good, although slightly less accurate, while the
H-K results were much worse.
In all the Monte Carlo simulations, we used MOESP automatic order selection method which is described in [16] and [19].
The order of the linear system was always selected correctly as
2, however, as also stated in [16] and [19], manual inspection
must always be performed.
Simulation studies validate the new method for the identification of stretch reflex model and shows that it is more reliable
compared to the other nonparametric algorithms and the original
subspace method for systems of this type. In the future, it will
be of interest to determine whether this improved performance
is also observed for different types of dynamics (e.g., band pass,
high pass).
V. EXPERIMENTAL RESULTS
A. Methods
We evaluated the performance of the algorithm under practical conditions by using it to estimate the dynamic relation
between ankle velocity and reflex EMG in the triceps surae
TS muscle. This relation has been modeled previously as a
Hammerstein system involving a unidirectional, rate sensitive
nonlinearity [22].
EMGs were recorded using single differential surface Delsys
electrodes supplied with the Bagnoli systems. The reference
electrode was a DermaSport placed on the subject’s left knee
which was immobilized during the experiment. EMG signal
was amplified 1000 times and then band passed at 20–2000 Hz
using a custom-made filter to remove artifacts. EMG as well as
position signals were recorded using NI-4472 A/D card. Data
were filtered to avoid aliasing and then sampled at 1000 Hz
for 60 s. The antialiasing filter of the module filtered data at
486.3 Hz.
The experimental methods were similar to those described
in [2], [7] and [20] except that we used the input signal described in Section V. Five subjects were recruited and gave
informed consent to the experimental procedures, which had
been reviewed and approved by McGill University Institutional

Review Board. The ankle joint was slightly dorsiflexed from the
neutral position (+0.2 rad). The subject was asked to maintain a
constant torque aided by the visual feedback of low-pass filtered
ankle torque.
Data were acquired at two voluntary torque directions corresponding to: PF [5% of the maximum voluntary contraction
(MVC) in the plantarflexing direction, i.e., a low-level contraction of the (TS)] and DF (5% of the MVC in the doresiflexing
direction, i.e., a low-level contraction of the tibialis anterior
TA). Prior to analysis, we verified the recorded data to be stationary by inspecting the EMG background levels. We full-wave
rectified EMG signals and removed their means. Similar to the
simulation section, we decimated all data to 100 Hz for analysis
purposes.
B. Results
Fig. 10 shows the Hammerstein systems estimated between
the velocity and EMG for a typical subject with the new algorithm. Qualitatively, the estimated models were similar to
previous results—both nonlinearities demonstrate a unidirection rate sensitivity while the IRFs were dominated by a sharp
peak at about 40 ms [22].
The estimated order of the linear system was six for three
trials and five for the other seven trials. The %VAF of the identification was 90% for PF and 54% for DF for this subject. The
identification %VAF was 84 ± 7% and 66 ± 9% for PF and DF
conditions, respectively, for all five subjects. We attribute the decreases in %VAF in DF to the lower gain and increased threshold
associated with the changes from PF to DF. As a result of these
changes, the responses became much smaller; indeed the power
of the predicted output for PF was more than 13 times larger
than that for DF. Consequently, the effect of noise and nonreflex EMG activity would become relatively more important. It
is unlikely that the decrease resulted from unmodeled dynamics
since fitting a parallel-cascade model [23] to the residuals did
not account for anything.
The previous studies modeled reflex EMG nonlinearity with
a half-wave rectifier, i.e., a threshold at zero [22]. Consequently,
we also calculated the prediction %VAF of a Hammerstein
model whose nonlinearity is a half-wave rectifier to validate
our new models. The prediction %VAF was comparable to the
identified nonlinearities for PF condition which shows that in

JALALEDDINI AND KEARNEY: SUBSPACE IDENTIFICATION OF SISO HAMMERSTEIN SYSTEMS

Fig. 11. Changes in threshold and gain in PF and DF operating point:
(a) threshold. (b) gain.

this case, the reliability of the half-wave rectifier and the identified nonlinearity is almost similar. However, in DF condition, the
prediction %VAF of the half-wave rectifier was always smaller
than our identified models.
What is of most interest is the changes observed with the
torque direction. During plantarflexing contractions, when TS
was active, the threshold was close to 0 and the IRF amplitude
was large which is consistent with previous findings [20]. In
contrast, during dorsiflexing contractions, when TA was active,
the amplitude of the IRF decreased and the threshold was higher
than during the TS contraction. We fit a threshold to the estimated nonlinearity and calculated the gain of the linear system
by integrating its IRF. Fig. 11 shows the result. It is evident that
the threshold was always larger in DF condition and the gain
was always smaller compared to PF for all subjects.
VI. DISCUSSION AND CONCLUSION
This paper describes a new MOESP-based algorithm for the
identification of Hammerstein systems. Its major advantage over
previous Hammerstein MOESP-based algorithms [17], [18], is
that it yields independent estimates of the linear dynamics and
the static nonlinearity. This gives explicit information on the
coefficients of nonlinearity and the state-space model of the linear component. Consequently, it is straightforward to compute
the shape of the nonlinearity and the IRF of the linear dynamics which are needed to interpret the significance of parameter
changes.
One of the advantages of the MOESP over other parametric identification approaches is that it estimates the linear system order prior to the parameter identification. Consequently, in
MOESP the only required a priori information about the system
is an upper-bound on its order.
The simulation results demonstrated that the new algorithm
successfully distinguished changes in the threshold and saturation of the nonlinearity from changes in the gain of the linear
subsystem (see Figs. 8 and 9). They further demonstrated that
NSS was more robust to additive output noise than OSS, SLS,
and H-K Hammerstein algorithms. Thus, the subspace estimates
were more accurate and had lower variances (i.e., lower biases
and less noisy, Figs. 5 and 7) especially at low SNRs. The SLS
also gave good results at high SNRs (see Fig. 5). However, SLS
solves a nonlinear optimization and it is not guaranteed to con-

2733

verge. Indeed, the Monte Carlo studies showed that this was the
case; the %VAF had a bimodal distribution; one mode corresponding to large values of %VAF with high probability and a
second mode to lower %VAFs corresponding to trials where the
algorithm did not converge. In contrast, NSS always converged
and the %VAF distribution was unimodal.
Our simulation results demonstrated that NSS method performed much better than other methods for SNRs less than
0 dB. SNRs as low as this may be infrequent for single input
systems but will occur frequently for multiple input systems
since when estimating the response to one input, the responses
to the other inputs will appear as noise. For example, in the identification of reflex stiffness at the ankle, torques generated as a
result of intrinsic mechanisms will appear as noise [2] resulting
in effective SNRs of much lower than 0 dB.
Thus, the new method was more robust than other methods; this is likely because it has fewer free parameters to
estimate in the case of reflex stiffness identification. We described the linear component of the Hammerstein system with
a state-space model whose number of parameters depends on
the system order. In contrast, nonparametric methods modeled
it as an IRF whose length depends on the system memory. The
original subspace algorithm used an overparameterized model
which will always have more parameters compared to our minimal formulation. The total number of unknown parameters
in our model is (m + 1)2 + n whereas for the original subspace method is m2 + m + mn + n. Thus, the new formulation reduced the number of parameters by mn − m − 1. The
total number of unknown parameters in the SLS formulation is
nlags + n, where nlags is the memory of the system. The difference of nlags − (m + 1)2 between number of parameters in
SLS and NSS formulation is significant for a low-pass filter with
relatively large memory compared to its order.
The new method presented here modeled the static nonlinearity by a polynomial. Future work is required to develop a
method for determining which expansion to use and the optimal
order for the nonlinearity.
The experiment studies in this paper were intended as proofof-principle experiments. We did not examine reflex stiffness
directly since the reflex torque cannot be measured directly
(only the sum of the voluntary, reflex, and intrinsic torques can
be measured). Consequently, we used EMG as the output since
it is an indicator of muscle activity and is not related to the
intrinsic response. The results showed that the method works
well with experimental data and gave results consistent with
previous EMG studies [20], [22].
Previous studies have shown that reflex stiffness changes dramatically with the operating point defined by mean ankle position and muscle activation level [20]. In these experiments, the
nonlinearity was assumed to be constant so all changes were
modeled as changes in the parameters of the linear component.
Here, the results show that the nonlinearity also changes as a
function of the operating point, in this case the muscle activation. The amplitude of the IRF changed with torque level as
expected—it was larger when TS was active, and lower when
TA was active. Interestingly, the threshold behaved differently,
it was low when TS was active and high when TA was active.
At least in this case, it appears that the reflex gain and threshold

2734

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

varied independently and consequently, characterizing the reflex
by its gain alone may not be appropriate. Much additional work
on the identification of stretch reflex (position-EMG system)
needs to be carried out to map out how the gain and threshold
change with operating point; the new algorithm provides the
means to do so.
An important application of this paper will be to incorporate it into our parallel-cascade methods for the identification
of systems with parallel-cascade structures. We demonstrated
its utility for reflex stiffness in our simulations. However, since
the reflex torque cannot be measured independently, a parallelcascade method is required to decompose the intrinsic and reflex components prior to the identification of parameters [2].
In theory, by incorporating the intrinsic path into the system
model, one can integrate this method into the identification of
the parallel-cascade structures. This will become useful in studying joint stiffness with a complaint load. Previous studies have
shown that subspace method has the great advantage of providing accurate estimates in the presence of feedback and/or input
noise, conditions under which other correlation-based methods
give biased results [18].
Implementation of the new method is straightforward. The
MOESP method that we used is well known to the system
identification community and an implementation is available
as part of the SIM toolbox, Delft University of Technology
[19]. The remainder consists of solving the two least-squares in
an iterative manner followed by normalization. The MATLAB
routine for the new method can be downloaded from our website
as part of the new release of NLID toolbox.
The new method has some limitations too. It is difficult to
include delay in a state-space model. Thus, for the subspace
identification methods to work, the value of the delay has to be
known. Moreover, we showed that since the IRF model has many
parameters, its identification is less robust than the state-space
identification. However, for a complex linear dynamics with
short memory, the IRF might have fewer parameters than the
state-space model and its identification might be more robust.
This is because the number of parameters in the state-space
model grows rapidly with the system order.

[8] K. S. Narendra and P. Gallman, “An iterative method for the identification
of nonlinear systems using a Hammerstein model,” IEEE Trans. Autom.
Control, vol. 11, no. 3, pp. 546–550, Jul. 1966.
[9] E. Bai and D. Li, “Convergence of the iterative Hammerstein system
identification algorithm,” IEEE Trans. Autom. Control, vol. 49, no. 11,
pp. 1929–1940, Nov. 2004.
[10] G. Li, W. X. Z. C. Wen, and G. Zhao, “Iterative method in the identification
of block-oriented systems based on biconvex optimization,” in Proc. 16th
IFAC Symp. Syst. Identif., 2012, pp. 31–36.
[11] G. Q. Li and C. Wen, “Convergence of normalized iterative identification
of Hammerstein systems,” Syst. Control Lett., vol. 60, no. 11, pp. 929–935,
2011.
[12] D. Westwick and R. Kearney, Identification of Nonlinear Physiological
Systems. New York, NY, USA: Wiley, 2003, pp. 39–56.
[13] E. Perreault, P. Crago, and R. Kirsch, “Estimation of intrinsic and reflex contributions to muscle dynamics: A modeling study,” IEEE Trans.
Biomed. Eng., vol. 47, no. 11, pp. 1413–1421, Nov. 2000.
[14] M. Verhaegen and P. Dewilde, “Subspace model identification—Part 1:
The output error state space model identification class of algorithm,” Int.
J. Control, vol. 56, no. 5, pp. 1187–1210, 1992.
[15] M. Verhaegen and P. Dewilde, “Subspace model identification—Part 2:
Analysis of the elementary output-error state space model identification
algorithm,” Int. J. Control, vol. 56, no. 5, pp. 1211–1241, 1992.
[16] L. R. J. Haverkamp, “State space identification: Theory and practice,”
Ph.D. dissertation, Delft Univ. Technol., Delft, The Netherlands, 2001.
[17] M. Verhaegen and D. Westwick, “Identifying MIMO Hammerstein systems in the context of subspace model identification methods,” Int. J.
Control, vol. 63, no. 2, pp. 331–349, 1996.
[18] Y. Zhao, D. T. Westwick, and R. E. Kearney, “Subspace methods for
identification of human ankle joint stiffness,” IEEE Trans. Biomed. Eng.,
vol. 58, no. 11, pp. 3039–3048, Nov. 2011.
[19] B. Haverkamp, C. T. Chou, and M. Verhaegen, “SMI toolbox: A Matlab
toolbox for state space model identification,” J. A, vol. 38, no. 3, pp. 34–37,
1997.
[20] M. M. Mirbagheri, H. Barbeau, and R. E. Kearney, “Intrinsic and reflex
contributions to human ankle stiffness: Variation with activation level and
position,” Exp. Brain Res., vol. 135, no. 4, pp. 423–436, 2000.
[21] R. B. Stein and R. E. Kearney, “Nonlinear behavior of muscle reflexes at
the human ankle joint,” J. Neurophysiol., vol. 73, no. 1, pp. 65–72, 1995.
[22] R. E. Kearney and I. W. Hunter, “System identification of human tricpes
surae stretch reflex dynamics,” Exp. Brain Res., vol. 51, pp. 117–127,
1983.
[23] M. J. Korenberg, “Parallel cascade identification and kernel estimation
for nonlinear systems,” Annu. Biomed. Eng., vol. 19, no. 4, pp. 429–455,
1991.
Kian Jalaleddini (S’08) received the MASc degree
in electrical engineering from Concordia University,
Montreal, QC, Canada, in 2009. He is currently working toward the Ph.D. degree in biomedical engineering at McGill University, Montreal, QC, Canada.
He served as the secretary of the IEEE Montreal
Section during 2011 and 2012. He is the Chair of
Engineering in Medicine and Biology (EMB) Montreal chapter. His research interests include analysis of biomedical signals and systems, development
of system identification tools, and exploring human

REFERENCES
[1] I. W. Hunter and M. J. Korenberg, “The identification of nonlinear biological systems: Wiener and Hammerstein cascade models,” Biol. Cybern.,
vol. 55, no. 2–3, pp. 135–144, 1986.
[2] R. E. Kearney, R. B. Stein, and L. Parameswaran, “Identification of intrinsic and reflex contributions to human ankle stiffness dynamics,” IEEE
Trans. Biomed. Eng., vol. 44, no. 6, pp. 493–504, Jun. 1997.
[3] W. Chan and H. L. Galiana, “A nonlinear model of the neural integrator
improves detection of deficits in the human VOR,” IEEE Trans. Biomed.
Eng., vol. 57, no. 5, pp. 1012–1023, May 2010.
[4] G. N. Maksym, R. E. Kearney, and J. H. T. Bates, “Nonparametric blockstructured modeling of lung tissue strip mechanics,” Annu. Biomed. Eng.,
vol. 26, pp. 242–252, 1998.
[5] S. A. Billings and S. Y. Fakhouri, “Identification of a class of nonlinear
systems using correlation analysis,” in Proc. IEEE, Jul. 1978, vol. 125,
no. 7, pp. 691–697.
[6] W. Greblicki, “Continuous time Hammerstein system identification,”
IEEE Trans. Autom. Control, vol. 45, no. 6, pp. 1232–1236, Jun. 2000.
[7] D. Westwick and R. Kearney, “Separable least squares identification of
nonlinear Hammerstein models: Application to stretch reflex dynamics,”
Annu. Biomed. Eng., vol. 29, pp. 707–718, 2001.

stretch reflex dynamics.
Robert E. Kearney (M’76–SM’92–F’01–LF’13) is
currently a Professor in the Department of Biomedical Engineering McGill University, Montreal, QC,
Canada, maintaining an active research program that
focuses on using quantitative engineering techniques
to address important biomedical problems. His research interests include the development of algorithms and tools for biomedical system identification;
the application of system identification to understand
the role played by peripheral mechanisms in the control of posture and movement; and the development
of signal processing and machine learning methods for respiratory monitoring.
Dr. Kearney is a Fellow of the Engineering Institute of Canada and the
American Institute of Medical and Biological Engineering. He received the
IEEE Millennium medal.

