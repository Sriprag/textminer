IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

47

Meal Detection in Patients With Type 1 Diabetes:
A New Module for the Multivariable Adaptive
Artificial Pancreas Control System
Kamuran Turksoy, Sediqeh Samadi, Jianyuan Feng, Elizabeth Littlejohn, Laurie Quinn, and Ali Cinar, Member, IEEE

Abstract‚ÄîA novel meal-detection algorithm is developed based
on continuous glucose measurements. Bergman‚Äôs minimal model is
modified and used in an unscented Kalman filter for state estimations. The estimated rate of appearance of glucose is used for meal
detection. Data from nine subjects are used to assess the performance of the algorithm. The results indicate that the proposed algorithm works successfully with high accuracy. The average change
in glucose levels between the meals and the detection points is
16( ¬±9.42) [mg/dl] for 61 successfully detected meals and snacks.
The algorithm is developed as a new module of an integrated multivariable adaptive artificial pancreas control system. Meal detection
with the proposed method is used to administer insulin boluses and
prevent most of postprandial hyperglycemia without any manual
meal announcements. A novel meal bolus calculation method is
proposed and tested with the UVA/Padova simulator. The results
indicate significant reduction in hyperglycemia.
Index Terms‚ÄîArtificial Pancreas (AP), hyperglycemia, meal detection, type 1 diabetes (T1D), unscented Kalman filter (UKF).

I. INTRODUCTION
OSTPRANDIAL glucose control in patients with type 1
diabetes (T1D) is one of the main challenges for artificial pancreas (AP) closed-loop control systems. Many studies
have shown that the AP systems are able to maintain blood
glucose concentrations (BGC) in target range during night
time when there is no meal consumption [1]‚Äì[5]. Food intake increases plasma/serum glucose levels rapidly and can
cause hyperglycemia if sufficient amount of insulin is not infused in an acceptable period of time. A hybrid closed-loop

P

Manuscript received January 26, 2015; revised April 21, 2015; accepted
June 12, 2015. Date of publication June 16, 2015; date of current version
December 31, 2015. This work was supported by the National Institutes of
Health under Grant 1DP3DK101077-01 and Grant 1DP3DK101075-01, and the
Juvenile Diabetes Research Foundation International under Grant 17-2013-472.
K. Turksoy is with the Department of Biomedical Engineering, Illinois Institute of Technology, Chicago, IL 60616 USA (email: kturksoy@hawk.iit.edu).
S. Samadi and J. Feng are with the Process Modeling, Monitoring and
Control Research Group, Department of Chemical and Biological Engineering, Illinois Institute of Technology, Chicago, IL 60616 USA (email:
ssamadi@hawk.iit.edu; jfeng12@hawk.iit.edu).
E. Littlejohn is with the Department of Pediatrics, Kovler Diabetes Center, University of Chicago, Chicago, IL 60637 USA (email: elittlej@peds.bsd.
uchicago.edu).
L. Quinn is with the Department of Biobehavioral Health Science, College
of Nursing, University of Illinois at Chicago, Chicago, IL 60612 USA (email:
lquinn1@uic.edu).
A. Cinar is with the Department of Chemical and Biological Engineering
and Department of Biomedical Engineering, Illinois Institute of Technology,
Chicago, IL 60616 USA (email: cinar@iit.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2446413

AP system may decrease the number of postprandial hyperglycemic episodes [6]. In a hybrid AP system, meal information is used either as an announced disturbance [5], [7]‚Äì
[10], or as an indicator for a constant bolus insulin infusion
[11], [12]. Because of manual meal announcements, hybrid
APs cannot be considered as a fully automated system. For
a fully automated AP, no information should be manually entered to announce measurable disturbances for feed-forward
control. Thus, there is a need for an algorithm that can detect meals from real-time measured variables. Once meals are
detected, the information can be transferred to the controller,
and appropriate amount of insulin can be infused to prevent
postprandial hyperglycemia.
To date, only a few studies have investigated the detection
of meals from real-time measurable variables such as a continuous glucose monitor (CGM) measurements. Dassau et al.
[13] proposed a voting algorithm based on Kalman filter estimation, backward difference, combination of Kalman filter, and
backward difference and second derivative of glucose (CGM)
measurements. A meal is considered to be detected when twoout-of-three or three-out-of-four algorithms detects a meal. Lee
et al. [14] proposed a meal detection and meal size estimation
algorithm and combined with model-predictive-control-based
AP system. Meal times and sizes are estimated based on various
thresholds and if/then rules using first and second derivatives of
glucose measurements. Cameron et al. [15] developed a probabilistic method for meal detection. First, CGM signals are compared to no-meal predictions made by a simple insulin/glucose
model. The residuals are fitted to predefined meal shapes used
for detection of meals. Later, the method was extended for use
in a model-predictive control algorithm for blood glucose regulation [16].
In this paper, we propose a new method for meal detection in
patients with T1D that requires only CGM readings. A modified version of the Bergman‚Äôs minimal model [17] is used. Unscented Kalman filter (UKF) is used for simultaneous estimation
of states and parameters of the minimal model. Finally, meals
are detected based on rate of appearance of glucose estimations
and some safety rules. An insulin bolus calculation algorithm
is added for detected meals. The paper is structured as follows. Model development and UKF are described in Section II.
Section III presents the outcomes of the proposed method tested
on nine real patients data and the performance of the bolus calculation algorithm which is tested with the UVa/Padova simulator
[18]. The performance of the meal-detection algorithm as a new
module for the integrated multivariable adaptive AP (IMA-AP)

2168-2194 ¬© 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

48

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

control system is evaluated in Section IV. Conclusions are provided in Section V.
II. METHODS
A. Minimal Model
Bergman et al. [17] developed the first three-compartment
‚Äúminimal model‚Äù to analyze plasma glucose and insulin dynamics during an intravenous glucose tolerance test. Modifications
of the minimal model have been proposed to separate the effect
of glucose production from utilization [19], [20] and to capture
absorption, distribution, and disposal glucose/insulin dynamics [21]. The effects of free fatty acids [22] and exercise [23]
are also incorporated into the minimal model. The dynamical
equations for plasma glucose concentration G(t) and effective
insulin concentration Ieff are given by [22]
dG (t)
= ‚àíp1 G (t) ‚àí p2 IeÔ¨Ä (t) G (t) + p1 Gb
dt
+ Ra (t)

(1)

C(t) ‚àí t
te œÑ
(3)
V œÑ2
where C(t), V , and œÑ are the amount of consumed carbohydrate,
the distribution volume, and the peak time of meal absorption,
respectively. In the original Bergman‚Äôs model [17] and its extensions [21], [22], the unknown model parameters p1 , p2 , p3 , p4 ,
V , and œÑ are not time-varying. However, due to the complexity of the human body and intersubject variability, a constant
set of parameters may not be able to describe all time-varying
dynamics for a subject. Also, intrasubject variability may require different sets of parameters for different subjects. In the
proposed method, all unknown parameters and the basal plasma
glucose concentration Gb are defined to be time-varying in order to overcome the inter- and intrasubject variability. Using the
first forward difference derivative approximation, (1)‚Äì(3) are
discretized as



Gs (k)
‚àí Gs (k)
Gs (k + 1) = h p1 (k) Gb (k) +
hp1 (k)

‚àí p2 (k) IeÔ¨Ä (k) Gs (k) + Ra (k)
(4)



IeÔ¨Ä (k)
‚àí IeÔ¨Ä (k)
IeÔ¨Ä (k + 1) = h p2 (k)
hp2 (k)

+ p3 (k) Ip (k)
(5)
hC(k)
Ra (k)
+2
a
V (k)aœÑ (k)2
Ra (k ‚àí 1)
a2

‚é§

‚é°

0

‚é§

‚é¢
‚é•
‚é•
‚é¢
‚é¢ 0 ‚é•
‚é¢ C(k + 1) ‚é•
‚é¢
‚é•
‚é•
‚é¢
‚é¢
‚é•
‚é•
‚é¢
‚é¢ p1 (k) ‚é•
‚é¢ p1 (k + 1) ‚é•
‚é¢
‚é•
‚é•
‚é¢
‚é¢
‚é•
‚é•
‚é¢
‚é¢ p2 (k) ‚é•
‚é¢ p2 (k + 1) ‚é•
‚é¢
‚é•
‚é•
‚é¢
‚é• = ‚é¢
‚é• + w(k)
‚é¢
‚é¢ 0 ‚é•
‚é¢ p3 (k + 1) ‚é•
‚é¢
‚é•
‚é•
‚é¢
‚é¢
‚é•
‚é•
‚é¢
‚é¢ p4 (k) ‚é•
‚é¢ p4 (k + 1) ‚é•
‚é¢
‚é•
‚é•
‚é¢
‚é¢
‚é•
‚é•
‚é¢
‚é¢ 0 ‚é•
‚é¢ V (k + 1) ‚é•
‚é£
‚é¶
‚é¶
‚é£
œÑ (k + 1)
œÑ (k)
‚éß
‚é® 100,
Gb (k) =
l
‚é© h k ‚àí h 2 l Gs (i),
l
i=k ‚àí +1
h

Ra (t) =

‚àí

Ip (k + 1)

(7)

k<
k‚â•

2l
h
2l
h

(8)

h
œÑ (k )

dIeÔ¨Ä (t)
= ‚àíp2 IeÔ¨Ä (t) + p3 Ip (t)
(2)
dt
where Gb and Ip represent basal plasma glucose concentration
and plasma insulin concentration, respectively. The rate of appearance of glucose Ra (t) can be defined as a two-compartment
model [24]:

Ra (k + 1) =

‚é°

, and h and w(k) represent sampling time and
where a = e
noise term, respectively. l is the length of the window that is used
for calculation of Gb and selected to be 30 min. The notation for
plasma glucose concentration G(t) in (1) is replaced with subcutaneous glucose concentration (CGM) Gs (k) in (4). The relation between two variables was shown to be a one-compartment
model with a delay parameter [25], which is neglected in our
study due to validation reasons.
B. Unscented Kalman Filter
The UKF [26], [27] is a powerful tool for state estimation of
nonlinear systems. The drawbacks of linear approximation at
an operating point and calculation of Jacobian matrices in the
extended Kalman filter are overcome by using a minimal set of
carefully chosen sample (sigma) points.
A nonlinear state-space model is derived from (4)‚Äì(8):
x(k + 1) = f (x(k)) + w(k)
y(k) = g(x(k)) + v(k)

(9)

where x(k) is the state vector. w(k) and v(k) are defined to
be process and measurement noises, respectively. The nonlinear
functions f (¬∑) and g(¬∑) are defined from (4)‚Äì(8). The state-space
model in (9) has eight states since some parameters in (4)‚Äì(8)
are defined to be part of noise term w(k).
Defining L as the dimension of x vector, the scalar weights
Wi are defined as
W0x = Œº/ (L + Œº)



W0y = Œº/ (L + Œº) + 1 ‚àí Œ±2 + Œ≤

Wix = Wiy = 1/ [2 (L + Œº)]

(10)

where i = 1, . . . , 2L and Œº = Œ±2 (L + Œ∫). The tuning parameters Œ±, Œ≤, and Œ∫ are selected to be 1, 2, and 0 [28], respectively.
The sigma-point vectors œái are defined as
œá0 (k ‚àí 1) = xÃÇ(k ‚àí 1)
œái (k ‚àí 1) = xÃÇ(k ‚àí 1) + Œ≥ √ó Œ∑i

(6)

œái+L (k ‚àí 1) = xÃÇ(k ‚àí 1) ‚àí Œ≥ √ó Œ∑i

(11)

TURKSOY et al.: MEAL DETECTION IN PATIENTS WITH TYPE 1 DIABETES: A NEW MODULE FOR THE MULTIVARIABLE ADAPTIVE

where Œ∑i is the ith column (i = 1, . . . , L) of the squared root of
the augmented
covariance matrix P (k ‚àí 1) and the parameter
‚àö
Œ≥ = L + Œº.
Prior sigma-point estimations œá‚àí
i are calculated by propagating the sigma-points œái (k ‚àí 1) through the nonlinear function
f (¬∑). The prior sigma points are trimmed with a nonlinear optimization to prevent nonrealistic estimations such as negative
values in concentrations
T
œá‚àí
i (k) = min[Œîœái ] [Œîœái ]

Œîœái = œá‚àí
i (k) ‚àí f (œái (k ‚àí 1))
œám in ‚â§ œá‚àí
i (k) ‚â§ œám ax
i = 0, . . . , 2L.

(12)

The prior state estimations and covariance matrix are calculated as
xÃÇ‚àí (k) =

2L


Wix œá‚àí
i (k)

(13)

i=0

P ‚àí (k) =

2L



 ‚àí
T
‚àí
‚àí
Wiy œá‚àí
i (k) ‚àí xÃÇ (k) œái (k) ‚àí xÃÇ (k)

i=0

+ Qp

(14)

where Qp is the covariance matrix of the process noise. The prior
sigma-point estimations are propagated through the nonlinear
function g(¬∑) for calculation of prior output sigma points Œ•‚àí
i :
‚àí
Œ•‚àí
i (k) = g(œái (k))

i = 0, . . . , 2L.

(15)

The measurement estimations are obtained from the output
sigma points as
yÃÇ ‚àí (k) =

2L


Wix Œ•‚àí
i (k)

(16)

i=0

The innovation covariance and cross-covariance matrices are
calculated as
Py y (k) =

2L



 ‚àí
T
‚àí
‚àí
Wiy Œ•‚àí
i (k) ‚àí yÃÇ (k) Œ•i (k) ‚àí yÃÇ (k)

i=0

+ Qm
Pxy (k) =

2L


Wiy

C. Data Collection and Preprocessing
Data are collected from nine subjects undergoing multivariable AP control system experiments [29], [30] without any announcement (meal or exercise). Subjects were recruited from the
University of Chicago Medical Center, Kovler Diabetes Center,
and were scheduled for a visit at the University of Chicago
General Clinical Research Center. Closed-loop control was performed for 32 h for each subject. Based on the study protocol,
breakfast, lunch, dinner, and a late time snack were provided.
Additional snacks were provided whenever requested by the
subjects. The type of foods were selected based on a subject‚Äôs
personal requirements. No limitation on food or snack intake
was imposed. The subject‚Äôs own insulin type and pump were
used during the experiments. Data were continuously collected
from the subjects with a sampling time of 5 min. Every 10 min,
insulin infusion rates were computed by the controller and used
to adjust the pump. The Guardian REAL-time CGM (Medtronics, Northride, CA, USA) were used to collect the glucose concentration information.
To minimize the effect of CGM measurement noise on the
first forward difference derivative approximation, 1-min sampled CGM data are obtained from original data sampled every
5 min, using pchip interpolation [31]. The initial conditions and
tuning parameters are selected as
‚é§
‚é§ ‚é°
‚é°
0
Ieff (0)
‚é•
‚é• ‚é¢
‚é¢
‚é¢ Gs (0) ‚é• ‚é¢ CGM(1) ‚é•
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é¢ Ra (0) ‚é• ‚é¢
0
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é¢ Ra (‚àí1) ‚é• ‚é¢
0
‚é•
‚é• ‚é¢
‚é¢
xÃÇ (0) = ‚é¢
‚é•
‚é•=‚é¢
‚é¢ p1 (0) ‚é• ‚é¢ 0.068 ‚é•
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é• ‚é¢
‚é¢
‚é¢ p2 (0) ‚é• ‚é¢ 0.037 ‚é•
‚é•
‚é• ‚é¢
‚é¢
‚é•
‚é• ‚é¢
‚é¢
‚é¢ p4 (0) ‚é• ‚é¢ 1.3 ‚é•
‚é¶
‚é¶ ‚é£
‚é£
20
œÑ (0)
 ‚àí6 ‚àí6 ‚àí3 ‚àí3 ‚àí2 ‚àí1 ‚àí2 ‚àí1 
Qp = diag 10 10 10 10 10 10 10 10
P (0) = I8√ó8 Qm = 100

(22)

where CGM(1) is the first measured glucose value and the initial
values for p1 , p2 , and p4 are adapted from [22].

(17)
III. RESULTS

 ‚àí

œái (k) ‚àí xÃÇ‚àí (k)

i=0



49

T
‚àí
Œ•‚àí
i (k) ‚àí yÃÇ (k)

(18)

where Qm represents the covariance matrix for process measurement noise. Finally, the Kalman filter gain and the updated
state vector estimation and covariance matrix are calculated as
K (k) = Pxy (k) (Py y (k))‚àí1


xÃÇ (k) = xÃÇ‚àí (k) + K (k) y (k) ‚àí yÃÇ ‚àí (k)

(19)

P (k) = P ‚àí (k) ‚àí K (k) Py y (k) (K (k))T .

(21)

(20)

The meal-detection algorithm is developed based on the state
estimations xÃÇ (k) from the UKF algorithm. A meal is detected
if the estimated rate of appearance of glucose Ra (k) is above
the threshold of 2 [mg/dl/min]. Once the Ra (k) value goes
below the threshold, a flag is lifted and another meal is detected
when the value gets above 2 mg/dl/min. For safety from hypoglycemia, a meal detected is used for insulin bolus decision
only when CGM values are above 100 [mg/dl].
Fig. 1 shows the performance of the proposed method for
27 different main meals (breakfast, lunch, and dinner) for nine
subjects. Each subfigure shows the time interval of 30 min before
and 120 min after a meal. The difference in glucose values

50

Fig. 1.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

Meal detection of 27 different main meals for nine subjects. (Vertical axis: glucose concentration [mg/dl], horizontal axis: sample number).

(change in glucose) between the time that meal starts and the
time that meal is detected is used as the evaluation criterion.
Detection time is not used as an evaluation criterion due to
time-varying meal consumption lengths from subject to subject.
Different types of foods have different digestion and absorption
rates which also prevent using detection time as an evaluation
criterion.
Table I summarizes the results for nine subjects data. Overall,
51 main meal and 13 snack periods are tested. Out of 63 cases,
only two meals are missed. As shown in Fig. 1, the lunch for
subject 6 is missed because there is almost no change in glucose
values after the consumption of 45 g of carbohydrates. This
might be due to insulin on board that is already active. A meal is

not detected for subject 4 because a snack, which is detected by
the algorithm, is consumed by the subject before the undetected
meal. Since the glucose increase from the meal is almost linearly added to the increase from the snack, the algorithm cannot
distinguish between the two consumptions and interprets them
as one meal. Considering only the successfully detected 61 meal
and snack periods, the average change in glucose is 16 (¬±9.42)
[mg/dl]. For all tested datasets, there is only one wrong alarm
for subject 4, where there was a rapid increase in glucose but no
recorded meals at that time. This might be because of a missed
recorded meal.
The rate of appearance of glucose Ra (k) estimations are used
for calculation of meal boluses. A meal bolus is given when the

TURKSOY et al.: MEAL DETECTION IN PATIENTS WITH TYPE 1 DIABETES: A NEW MODULE FOR THE MULTIVARIABLE ADAPTIVE

51

TABLE I
PERFORMANCE OF THE MEAL-DETECTION ALGORITHM FOR ALL SUBJECTS

Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Subject 1
Subject 2
Subject 3
Subject 4
Subject 5
Subject 6
Subject 7
Subject 8
Subject 9
Total

# of meals

Carb amounts

TD

MD

FD

CGM at meal time

CGM at detection time

Change in glucose

3
5
6
6
6
5
7
6
6
# of snacks
0
1
1
4
2
1
1
2
1
63

68(¬±7.64)
53(¬±9.75)
62(¬±17.3)
71(¬±17.6)
85(¬±21.0)
60(¬±10.6)
83(¬±46.36)
58(¬±14.15)
65(¬±6.37)
Carb amounts
0(¬±0)
30(¬±0)
30 (¬±0)
26(¬±7.5)
22(¬±10.6)
15(¬±0)
30(¬±0)
20(¬±0)
15(¬±0)
44(¬±9.38)

3
5
6
5
6
4
7
6
6
TD
0
1
1
4
2
1
1
2
1
61

0
0
0
1
0
1
0
0
0
MD
0
0
0
0
0
0
0
0
0
2

0
0
0
1
0
0
0
0
0
FD
0
0
0
0
0
0
0
0
0
1

94(¬±36.59)
145(¬±55.57)
104(¬±23.48)
169(¬±61.81)
135(¬±67.1)
115(¬±82.5)
133(¬±46.46)
160(¬±86.85)
134(¬±43.19)
CGM at meal time
0(¬±0)
68(¬±0)
133(¬±0)
137(¬±39.16)
106(¬±29.69)
120(¬±0)
123(¬±0)
122(¬±39.59)
194(¬±0)
121(¬±33.99)

113(¬±23.09)
159(¬±47.81)
117(¬±21.29)
175(¬±62.5)
141(¬±60.44)
155(¬±88.05)
148(¬±36.18)
176(¬±83.57)
143(¬±42.19)
CGM at detection time
0(¬±0)
100(¬±0)
146(¬±0)
158(¬±40.39)
119(¬±27.57)
149(¬±0)
156(¬±0)
131(¬±38.18)
200(¬±0)
138(¬±31.74)

19(¬±13.86)
13(¬±8.99)
13(¬±13.67)
6(¬±22.4)
6(¬±33.07)
40(¬±8.79)
14(¬±27.13)
15(¬±10.27)
9(¬±11.24)
Change in glucose
0(¬±0)
32(¬±0)
13(¬±0)
20(¬±16.68)
13(¬±2.12)
29(¬±0)
33(¬±0)
9(¬±1.41)
6(¬±0)
16(¬±9.42)

Values are shown as mean ( ¬±standard deviation). TD: true detection, MD: missed detection, FD: false detection. The units are m g/dl and
g r am s for glucose values and carb amounts, respectively.

estimated Ra (k) is above 2 [mg/dl/min] and measured CGM
value is above 100 [mg/dl]. A second meal bolus can be given
only after the Ra (k) values go below the 2 [mg/dl/min] threshold
and 30 min passes over the last infused meal bolus. Once a meal
bolus is infused, a flag is turned on to activate correction bolus
(CB) infusion and the 2 [mg/dl/min] threshold is increased
to 3 [mg/dl/min]. While the flag is ON, the Ra (k) value is
checked every 15 min and a CB is given if the Ra (k) is above
the new threshold. For each given CB, the threshold is increased
by 1 [mg/dl/min] and the process is repeated every 15 min
until the flag is turned OFF. The CBs are calculated based on
measured CGM values Gs (k) and subject‚Äôs body weight (BW)
as a function of total daily dose (TDD) as follows:
Gs (k) ‚àí r(k)
√ó TDD
1800
r (k) = ŒºGs (k) + (1 ‚àí Œº)r0
CB =

TDD =

Gs (k)
√ó BW
r(k)

(23)
(24)
(25)

where r0 and Œº are the desired set point, and the tuning parameter
that affects the amount of CB infusions, respectively. The values
Œº are selected to be 0.55, 0.3, and 0.1 for sensitive, normal, and
resistant adults or adolescents and 0.8, 0.7, and 0.45 for sensitive,
normal, and resistant children, respectively [30]. The set point
r0 is set to 100 mg/dl.
The proposed meal bolus calculation strategy was performed
on the academic version of UVa/Padova metabolic simulator
[32], which has 30 subjects (ten adults, ten adolescents, and
ten children). For the consistency, the same three-day simulation scenario with Turksoy et al. [30] was generated and 300
simulations (ten for each subject) were performed. The same
scenario was used for adults and adolescents. The amount of
carbohydrates in meals was reduced for children.

Turksoy et al. [30] divided the 30 subjects of the UVa/Padova
metabolic simulator into three subgroups (sensitive, normal,
resistant) based on a subject‚Äôs insulin sensitivity. In this study,
the amount of meal boluses are defined based on these three
subgroups. The meal boluses are selected to be 4 [U ], 3 [U ], and
2 [U ] for the resistant, normal, and sensitive adult and adolescent
subjects and 1 [U ], 0.85 [U ], and 0.7 [U ] for the resistant, normal,
and sensitive child subjects, respectively.
Fig. 2 shows the average glucose concentration (CGM) for all
30 subjects (means and standard deviations). The mean glucose
concentration for adolescents in the target range is 86.8% of the
time and is stable during the night. Better glucose regulation
is obtained in adults subjects. During 94.7% of the simulation
time, glucose concentration stayed within the target range even
though meals with high carbohydrate content were provided.
A successful glucose regulation was obtained for the children
subjects where 92% of the time, glucose concentration stayed
within the target range. The time in hyperglycemic range is
significantly (p < 0.01) decreased with the proposed meal bolus
calculation algorithm.
IV. DISCUSSION
Many studies have shown that an AP control system is able to
keep BGC in target range [5], [7]‚Äì[12], [29], [30], [33]. In addition to being able to control BGC, a fully automated AP system
should not require any manual information from patients. We
have already developed an IMA-AP control system without any
manual meal or exercise announcement [29], [30], [33]. The
system has two different modules. The first module is the adaptive control algorithm that is responsible for insulin suggestions
[30]. The second module is a hypoglycemia early alarm system
that is able to detect hypoglycemic episodes around 25‚Äì30 min
in advance and warn patients about potential low glucose values

52

Fig. 2.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

Average glucose concentration (CGM) for all subjects.

[34]. The two modules are able to prevent most of hypoglycemia
and at the same time keep the BGC in target range. However,
due to lack of meal announcements, the IMA-AP system suffers
from having some postprandial hyperglycemia.
The meal-detection algorithm developed provides the third
module for the IMA-AP system. The meal-detection module is
completely adaptive and does not require any subject-specific
initialization. It works based on only CGM measurements. The
early detection of meals by the meal-detection module enables
the IMA-AP system to provide a meal bolus (without any manual announcements) that would prevent most of postprandial
hyperglycemia.
Since there are no simulators that provide physiological
signals [29], [33] that are used by the IMA-AP system, a single
variable (only CGM measurements) version of the algorithm
was tested on the UVa/Padova simulator. The performance
of the IMA-AP system for preventing of hypoglycemia and
keeping BGC in target range has already been demonstrated
[29], [30]. We are conducting clinical experiments by using
the new version of the IMA-AP system with meal detection
and insulin bolus. We are expecting to significantly decrease
the number of hyperglycemia without causing any additional
hypoglycemic episodes.

[2]

[3]

[4]

[5]

[6]

[7]

V. CONCLUSION
The meal-detection algorithm developed is able to detect almost all tested meals. Simulation results indicate that using such
a high-performance meal-detection module in AP control systems can prevent most of hyperglycemia by providing bolus
insulin for meals before large increases in BGC without any
manual information from patients.

[8]

REFERENCES
[1] W. L. Clarke, S. Anderson, M. Breton, S. Patek, L. Kashmer, and
B. Kovatchev, ‚ÄúClosed-loop artificial pancreas using subcutaneous glucose sensing and insulin delivery and a model predictive control algo-

[9]

rithm: The Virginia experience,‚Äù J. Diabetes Sci. Technol., vol. 3, no. 5,
pp. 1031‚Äì1038, Sep. 2009.
R. Hovorka, J. M. Allen, D. Elleri, L. J. Chassin, J. Harris, D. Xing,
C. Kollman, T. Hovorka, A. M. F. Larsen, M. Nodale, A. De Palma,
M. E. Wilinska, C. L. Acerini, and D. B. Dunger, ‚ÄúManual closedloop insulin delivery in children and adolescents with type 1 diabetes:
A phase 2 randomised crossover trial,‚Äù Lancet, vol. 375, no. 9716,
pp. 743‚Äì751, 2010.
D. Elleri, J. Allen, M. Nodale, M. Wilinska, C. Acerini, D. Dunger, and
R. Hovorka, ‚ÄúSuspended insulin infusion during overnight closed-loop
glucose control in children and adolescents with type 1 diabetes,‚Äù Diabetic
Med., vol. 27, no. 4, pp. 480‚Äì484, 2010.
G. Steil, C. Palerm, N. Kurtz, G. Voskanyan, A. Roy, S. Paz, and
F. Kandeel, ‚ÄúThe effect of insulin feedback on closed loop glucose control,‚Äù J. Clin. Endocrinol. Metabolism, vol. 96, no. 5, pp. 1402‚Äì1408,
2011.
M. Breton, A. Farret, D. Bruttomesso, S. Anderson, L. Magni, S. Patek,
C. Dalla Man, J. Place, S. Demartini, S. Del Favero, C. Toffanin,
C. Hughes-Karvetski, E. Dassau, H. Zisser, F. J. Doyle, III, G. De
Nicolao, A. Avogaro, C. Cobelli, E. Renard, and B. Kovatchev, ‚ÄúFully
integrated artificial pancreas in type 1 diabetes modular closed-loop glucose control maintains near normoglycemia,‚Äù Diabetes, vol. 61, no. 9,
pp. 2230‚Äì2237, 2012.
S. A. Weinzimer, G. M. Steil, K. L. Swan, J. Dziura, N. Kurtz, and
W. V. Tamborlane, ‚ÄúFully automated closed-loop insulin delivery versus
semiautomated hybrid control in pediatric patients with type 1 diabetes
using an artificial pancreas.‚Äù Diabetes Care, vol. 31, no. 5, pp. 934‚Äì939,
May 2008.
J. L. Sherr, E. Cengiz, C. C. Palerm, B. Clark, N. Kurtz, A. Roy,
L. Carria, M. Cantwell, W. V. Tamborlane, and S. A. Weinzimer, ‚ÄúReduced hypoglycemia and increased time in target using closed-loop insulin delivery during nights with or without antecedent afternoon exercise in type 1 diabetes,‚Äù Diabetes Care, vol. 36, no. 10, pp. 2909‚Äì2914,
2013.
Y. M. Luijf, J. H. DeVries, K. Zwinderman, L. Leelarathna, M. Nodale,
K. Caldwell, K. Kumareswaran, D. Elleri, J. M. Allen, M. E. Wilinska,
M. L. Evans, R. Hovorka, W. Doll, M. Ellmerer, J. K. Mader, E. Renard,
J. Place, A. Farret, C. Cobelli, S. Del Favero, C. Dalla Man, A. Avogaro,
D. Bruttomesso, A. Filippi, R. Scotton, L. Magni, G. Lanzola, F. Di
Palma, P. Soru, C. Toffanin, G. De Nicolao, S. Arnolds, C. Benesch, and
L. Heinemann, ‚ÄúDay and night closed-loop control in adults with type 1
diabetes a comparison of two closed-loop algorithms driving continuous
subcutaneous insulin infusion versus patient self-management,‚Äù Diabetes
Care, vol. 36, no. 12, pp. 3882‚Äì3887, 2013.
R. Nimri, T. Danne, O. Kordonouri, E. Atlas, N. Bratina, T. Biester,
M. Avbelj, S. Miller, I. Muller, M. Phillip, and T. Battelino, ‚ÄúThe glucositter overnight automated closed loop system for type 1 diabetes: A

TURKSOY et al.: MEAL DETECTION IN PATIENTS WITH TYPE 1 DIABETES: A NEW MODULE FOR THE MULTIVARIABLE ADAPTIVE

[10]

[11]

[12]

[13]
[14]

[15]
[16]
[17]

[18]
[19]

[20]

[21]

[22]
[23]
[24]

[25]
[26]
[27]
[28]
[29]

randomized crossover trial,‚Äù Pediatric Diabetes, vol. 14, no. 3, pp. 159‚Äì
167, 2013.
D. Elleri, J. M. Allen, K. Kumareswaran, L. Leelarathna, M. Nodale,
K. Caldwell, P. Cheng, C. Kollman, A. Haidar, H. R. Murphy, M. E.
Wilinska, C. L. Acerini, D. B. Dunger, and R. Hovorka, ‚ÄúClosed-loop
basal insulin delivery over 36 hours in adolescents with type 1 diabetes
randomized clinical trial,‚Äù Diabetes Care, vol. 36, no. 4, pp. 838‚Äì844,
2013.
S. J. Russell, F. H. El-Khatib, M. Sinha, K. L. Magyar, K. McKeon,
L. G. Goergen, C. Balliro, M. A. Hillard, D. M. Nathan, and E. R. Damiano,
‚ÄúOutpatient glycemic control with a bionic pancreas in type 1 diabetes,‚Äù
New England J. Med., vol. 371, no. 4, pp. 313‚Äì325, 2014.
F. H. El-Khatib, S. J. Russell, K. L. Magyar, M. Sinha, K. McKeon, D. M. Nathan, and E. R. Damiano, ‚ÄúAutonomous and continuous
adaptation of a bihormonal bionic pancreas in adults and adolescents
with type 1 diabetes,‚Äù J. Clin. Endocrinol. Metabolism, vol. 99, no. 5,
pp. 1701‚Äì1711, 2014.
E. Dassau, B. W. Bequette, B. A. Buckingham, and F. J. Doyle, ‚ÄúDetection
of a meal using continuous glucose monitoring implications for an artificial
Œ≤-cell,‚Äù Diabetes Care, vol. 31, no. 2, pp. 295‚Äì300, 2008.
H. Lee, B. A. Buckingham, D. M. Wilson, and B. W. Bequette, ‚ÄúA
closed-loop artificial pancreas using model predictive control and a
sliding meal size estimator,‚Äù J. Diabetes Sci. Technol., vol. 3, no. 5,
pp. 1082‚Äì1090, 2009.
F. Cameron, G. Niemeyer, and B. A. Buckingham, ‚ÄúProbabilistic evolving and estimation of meal total glucose appearance,‚Äù J. Diabetes Sci.
Technol., vol. 3, no. 5, pp. 1022‚Äì1030, 2009.
F. Cameron, G. Niemeyer, and B. W. Bequette, ‚ÄúExtended multiple model
prediction with application to blood glucose regulation,‚Äù J. Process Control, vol. 22, no. 8, pp. 1422‚Äì1432, 2012.
R. N. Bergman, L. S. Phillips, and C. Cobelli, ‚ÄúPhysiologic evaluation of
factors controlling glucose tolerance in man: Measurement of insulin sensitivity and beta-cell glucose sensitivity from the response to intravenous
glucose,‚Äù J. Clin. Investigation, vol. 68, no. 6, pp. 1456‚Äì1467, 1981.
B. P. Kovatchev, M. Breton, C. Dalla Man, and C. Cobelli, ‚ÄúIn silico
preclinical trials: A proof of concept in closed-loop control of type 1
diabetes,‚Äù J. Diabetes Sci. Technol., vol. 3, no. 1, pp. 44‚Äì55, 2009.
C. Cobelli, G. Pacini, G. Toffolo, and L. Sacca, ‚ÄúEstimation of insulin sensitivity and glucose clearance from minimal model: New insights from labeled IVGTT,‚Äù Am. J. Physiol., vol. 250, no. 5 Pt 1,
pp. E591‚ÄìE598, 1986.
C. Cobelli, A. Caumo, and M. Omenetto, ‚ÄúMinimal model sgoverestimation and siunderestimation: Improved accuracy by a Bayesian twocompartment model,‚Äù Am. J. Physiol.-Endocrinol. Metabolism, vol. 277,
no. 3, pp. E481‚ÄìE488, 1999.
R. Hovorka, F. Shojaee-Moradie, P. V. Carroll, L. J. Chassin, I. J. Gowrie,
N. C. Jackson, R. S. Tudor, A. M. Umpleby, and R. H. Jones, ‚ÄúPartitioning glucose distribution/transport, disposal, and endogenous production
during IVGTT,‚Äù Am. J. Physiol.-Endocrinol. Metabolism, vol. 282, no. 5,
pp. E992‚ÄìE1007, 2002.
A. Roy and R. S. Parker, ‚ÄúDynamic modeling of free fatty acid, glucose,
and insulin: An extended‚Äù minimal model,‚Äù Diabetes Technol. Therapeutics, vol. 8, no. 6, pp. 617‚Äì626, 2006.
A. Roy and R. S. Parker, ‚ÄúDynamic modeling of exercise effects on plasma
glucose and insulin levels,‚Äù J. Diabetes Sci. Technol., vol. 1, no. 3, pp.
338‚Äì347, 2007.
R. Hovorka, V. Canonico, L. J. Chassin, U. Haueter, M. Massi-Benedetti,
M. O. Federici, T. R. Pieber, H. C. Schaller, L. Schaupp, T. Vering, and
M. E. Wilinska, ‚ÄúNonlinear model predictive control of glucose concentration in subjects with type 1 diabetes,‚Äù Physiol. Meas., vol. 25, no. 4,
pp. 905‚Äì920, 2004.
C. Dalla Man, F. Micheletto, D. Lv, M. Breton, B. Kovatchev, and C.
Cobelli, ‚ÄúThe UVA/PADOVA type 1 diabetes simulator new features,‚Äù J.
Diabetes Sci. Technol., vol. 8, no. 1, pp. 26‚Äì34, 2014.
S. J. Julier and J. K. Uhlmann, ‚ÄúUnscented filtering and nonlinear estimation,‚Äù Proc. IEEE, vol. 92, no. 3, pp. 401‚Äì422, Mar. 2004.
E. A. Wan and R. Van Der Merwe, ‚ÄúThe unscented Kalman filter for
nonlinear estimation,‚Äù in Proc. Adaptive Syst. Signal Process., Commun.,
Control Symp., 2000, pp. 153‚Äì158.
R. Van Der Merwe, ‚ÄúSigma-point Kalman filters for probabilistic inference
in dynamic state-space models,‚Äù Ph.D. dissertation, Oregon Health Sci.
Univ., Portland, OR, USA, 2004.
K. Turksoy, E. S. Bayrak, L. Quinn, E. Littlejohn, and A. Cinar, ‚ÄúAn
integrated multivariable artificial pancreas control system,‚Äù J. Diabetes
Sci. Technol., vol. 8, no. 3, pp. 498‚Äì507, 2014.

53

[30] K. Turksoy, L. Quinn, E. Littlejohn, and A. Cinar, ‚ÄúMultivariable adaptive
identification and control for artificial pancreas systems,‚Äù IEEE Trans.
Biomed. Eng., vol. 61, no. 3, pp. 883‚Äì891, Mar. 2014.
[31] F. N. Fritsch and R. E. Carlson, ‚ÄúMonotone piecewise cubic interpolation,‚Äù
SIAM J. Numerical Anal., vol. 17, no. 2, pp. 238‚Äì246, 1980.
[32] B. P. Kovatchev, M. Breton, C. D. Man, and C. Cobelli, ‚ÄúIn silico preclinical trials: A proof of concept in closed-loop control of type 1 diabetes,‚Äù
J. Diabetes Sci. Technol., vol. 3, no. 1, pp. 44‚Äì55, Jan. 2009.
[33] K. Turksoy, E. S. Bayrak, L. Quinn, E. Littlejohn, and A. Cinar, ‚ÄúMultivariable adaptive closed-loop control of an artificial pancreas without
meal and activity announcement,‚Äù Diabetes Technol. Therapeutics, vol.
15, no. 5, pp. 386‚Äì400, 2013.
[34] K. Turksoy, E. S. Bayrak, L. Quinn, E. Littlejohn, D. K. Rollins, and
A. Cinar, ‚ÄúHypoglycemia early alarm systems based on multivariable
models,‚Äù Ind. Eng. Chem. Res., vol. 52, no. 35, pp. 12329‚Äì12336, 2013.

Kamuran Turksoy received the B.Sc. degree in electrical engineering from Yildiz Technical University,
Istanbul, Turkey, and the Ph.D. degree in biomedical
engineering from the Illinois Institute of Technology,
Chicago, IL, USA, in 2010 and 2015, respectively.
He is currently a Postdoctoral Research Associate in biomedical engineering at the Illinois Institute
of Technology. His research interests include system
identification, modeling, control, fault detection, and
diagnosis in biological systems.

Sediqeh Samadi received the M.Sc. degree in chemical engineering from Sharif University, Tehran, Iran.
She is currently working toward the Ph.D. degree in
chemical engineering at the Illinois Institute of Technology, Chicago, IL, USA.
Her research interests include modeling and simulation of the dynamics of insulin‚Äìglucose system.

Jianyuan Feng received the B.Sc. degree in mechanical engineering from Changzhou University,
Changzhou, China, in 2012, and the Master‚Äôs degree
from the Illinois Institute of Technology, Chicago, IL,
USA, in 2013, where he is currently working toward
the Ph.D. degree in chemical engineering.
His current research interests include controller
performance assessment, sensor error detection, and
analytical sensor redundancy for a fully automated
closed-loop artificial pancreas algorithm for patients
with type 1 diabetes.

Elizabeth Littlejohn received the M.D. degree from
the M.D. Rosalind Franklin University of Medicine
and Science, North Chicago, IL, USA, in 1988.
She is currently an Associate Professor of pediatrics and medicine at the University of Chicago,
Chicago, IL, USA. She specializes in pediatric diabetes and endocrinology, working with patients ranging from newborn to age 20. Also a Clinical Researcher, she is investigating innovative treatments
and more efficient diagnostic tools to improve diabetes care for children and young adults. In the Kovler
Diabetes Center, she focuses specifically on expanding pediatric clinical research with the goal to advance clinical care for pediatric diabetes. She has
served on a number of committees including the Illinois Department of Public
Health Advisory Committee on Metabolic and Genetic Screening, American
Diabetes Association, and the Juvenile Diabetes Research Foundation.

54

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

Laurie Quinn received the Ph.D. degree in nursing
science from the University of Illinois at Chicago,
Chicago, IL, USA, in 1996.
She is currently a Clinical Associate Professor at the College of Nursing, University of Illinois at Chicago. She is experienced in the clinical
management of patients with diabetes mellitus and
has investigated the physiological mechanisms that
contribute to their excessive rate of cardiovascular
disease. Specifically, she has studied the effects of
aerobic exercise on the metabolic determinants of
cardiovascular disease in patients with type 2 diabetes (i.e., insulin resistance,
oxidative stress, lipid, and lipoprotein abnormalities). A major focus of her
work has been examining the influence of aerobic exercise on postprandial
metabolism in obese nondiabetic and diabetic patients.

Ali Cinar (M‚Äô87) received the Ph.D. degree in chemical engineering from Texas A&M University, College
Station, TX, USA.
He is a Professor of chemical engineering and
biomedical engineering at the Illinois Institute of
Technology, Chicago, IL, USA, and since 2004, he
has been the Director of the Engineering Center for
Diabetes Research and Education. His current research interests include agent-based techniques for
modeling, supervision, and control of complex and
distributed systems, modeling of diabetes, angiogenesis and tissue formation, and adaptive control techniques for artificial pancreas
systems for patients with diabetes. He has published two books, more than 190
technical papers in refereed journals and conference proceedings. A full list of
publications, detailed description of research interests, presentations, and software is available at www.chbe.iit.edu/Àúcinar.
Dr. Cinar is a Fellow of the American Institute of Chemical Engineers.

