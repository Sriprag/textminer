1062

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

A Novel Reduced-Order Prioritized Optimization
Method for Radiation Therapy Treatment Planning
Georgios Kalantzis∗ and Aditya Apte

Abstract—In this study, a novel reduced order prioritized algorithm is presented for optimization in radiation therapy treatment
planning. The proposed method consists of three stages. In the first
stage, the intensity space was sampled by solving a series of unconstrained optimization problems. The objective function of the
first stage is expressed as a scalarized weighted sum of partial objectives for the target and organ at risk. Latin hypercube sampling
was utilized to define the weights for each run of the unconstrained
optimizations. In the second stage, principal component analysis
is applied to the solutions determined in the first stage to identify the major eigen modes in the intensities space, significantly
reducing the number of independent variables. In the third stage,
treatment planning goals/objectives are prioritized, and the problem is solved in the reduced order space. After each objective is
optimized, that objective function is converted into a constraint
for the lower-priority objectives. In the current formulation, a slip
factor is used to relax the hard constraints for planning target volume (PTV) coverage. The applicability of the proposed method is
demonstrated for one prostate and one lung intensity-modulated
radiation therapy treatment plan. Upon completion of the sequential prioritized optimization, the mean dose at the rectum and bladder was reduced by 21.3% and 22.4%, respectively. Additionally,
we investigated the effect of the slip factor ‘s’ on PTV coverage and
we found minimal degradation of the tumor dose (∼4%). Finally,
the speed up factors upon the dimensionality reduction were as
high as 49.9 without compromising the quality of the results.
Index Terms—Intensity modulated radiation therapy (IMRT),
multiobjective optimization (MOO), prioritized optimization (PO).

I. INTRODUCTION
NTENSITY-modulated radiation therapy (IMRT) is an advanced mode of high-precision external radiotherapy that
uses computer-controlled, mega-voltage x-ray accelerators to
deliver precise doses of radiation to specific tissues. Rather than
being treated with a large uniform beam, in IMRT, the patient is
treated by a series of beam shapes that are modeled as a collection of pencil beams (beamlets). For many types of cancer, such
as prostate cancer, the use of IMRT allows a highly concentrated

I

Manuscript received September 28, 2013; revised November 23, 2013;
accepted December 1, 2013. Date of publication December 11, 2013; date
of current version March 17, 2014. This work was supported in part by the
National Cancer Institute (NCI) under Grant 1R01CA148876-04. Its contents
are solely the responsibility of the authors and do not necessarily represent the
official views of the National Cancer Institute, National Institutes of Health.
Asterisk indicates corresponding author.
∗ G. Kalantzis is with the Department of Medical Physics Memorial
Sloan Kettering Cancer Center NYC, New York, NY 10065, USA (e-mail:
gkalan@gmail.com).
A. Apte is with the Department of Medical Physics Memorial Sloan Kettering
Cancer Center NYC, New York, NY 10065, USA (e-mail: adapte@mskcc.org).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2293779

treatment of the tumor volume, while limiting the radiation dose
to adjacent healthy tissue [1]. IMRT treatment planning is concerned with selecting a beam geometry and beamlet intensities
(fluence map) to produce the best dose distribution that can be
delivered efficiently.
The concept of multiobjective optimization (MOO) for radiotherapy treatment planning has been an active area of research.
IMRT uses inverse planning optimization to determine complex
radiation beam configurations that will distribute the radiation
dose to the patient [2]–[4]. The problem is inherently multiobjective, with competing clinical goals to deliver a high dose to
the planning target volume (PTV) while minimizing the dose
to organs at risk (OARs). These conflicting clinical objectives
often require compromises when selecting a clinical treatment
plan for a patient.
A number of increasingly sophisticated mathematical programming models have been proposed for inverse treatment
planning (see [5] for a recent overview). One of the most common approaches to MOO is to optimize a single-objective function constructed from the weighted sum of multiple objectives,
in which the weights denote different relative importance to
different objectives [6], [7]. This is called the priori approach
because the user is expected to provide the weights. The popularity of this method lies in its straightforward implementation and
computational efficiency. In the past, gradient-based algorithms
have been proposed for the optimization of single-objective
problems in radiation therapy. However, the main disadvantage
of these algorithms is that planner intervention is often required
to conduct a multiple trial-error process, in which several parameters are varied until an acceptable compromise is achieved.
One way to ameliorate that issue is to use the prioritized or lexicographic optimization method [8], [9]. Prioritized optimization
(PO) is a form of multicriteria optimization, in which the various
objectives under consideration cannot be quantitatively traded
off between each other, at least not in a numerically tractable
way. Instead, PO considers a finite number of objective functions that are to be optimized on a feasible set of solutions in a
qualitatively prioritized order (i.e., lower-priority objectives are
optimized as far as they do not interfere with the optimization of
higher-priority objectives). The main advantage of that method
is that it generates an optimal solution at every sequential stage
and also, does not rely on interaction with the user once the
prioritization is fixed. It should be noted that PO may be viewed
as the limit of the minimization of a weighted combination of
objectives, in which the weights are equal to different powers
of a small parameter called “epsilon,” according to Danskin’s
theorem [10]. However, numerical minimization of such a composite objective function with different orders of magnitude can

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KALANTZIS AND APTE: NOVEL REDUCED-ORDER PRIORITIZED OPTIMIZATION METHOD FOR RADIATION THERAPY

lead to poorly conditioned problems. Therefore, the choice of
weighting factors of the scalarized multicriteria objective function is a sensitive problem in itself.
For IMRT problems with planning goals that exhibit distinctive levels of importance or priority, previous studies have
demonstrated that PO may provide an intuitive way of generating a solution [11]–[13]. However, PO has been criticized for not
allowing a large gain on a low-priority goal in trading off a small
loss on a high-priority goal [14]. Wilkens et al. [12] addressed
that issue by introducing a slip factor, which allows small degradations of higher-priority goals to the benefit of lower-priority
goals. In other words, the achievements of the algorithm for
higher-priority objectives were relaxed by a certain amount,
offering more flexibility in the algorithm for lower-order priorities. Additionally, constraint optimization for a large-scale
problem, such as that in radiation therapy with several hundreds
of variables (beamlet intensities), might become computationally intensive. In the past, dimensionality reduction techniques
have proven to be a solution for decreasing the complexity and
time of constraint optimization of the PTV for several anatomical sites [15]–[18] as well as generation of pareto frontiers
with memetic algorithms [19]. The reduced-order Constraint
optimization (ROCO) method offers a key advantage in that it
involves a computational efficient constrained optimization step
in which hard constraints are directly imposed on the optimization structures by reducing the dimensionality of the intensity
space. The main drawback of ROCO is that the final constraint
optimization in the reduced dimensionality search space is performed only on a single-objective quadratic function for the
PTV.
This paper presents the first report, to the best of our knowledge, of a method of reduced-order PO for IMRT. In the next
section, we describe our method in further detail and include a
mathematical description of each step of the optimization. Section 3 shows the results with a prostate and a lung case, the
effect of varying the slip parameter, and the number of principal components (p.c.) used during the dimensionality reduction
procedure. We further discuss these results and some key issues
in the final section of the paper.
II. MULTIOBJECTIVE OPTIMIZATION FOR IMRT
A. Description of the Problem
An IMRT treatment plan has to specify a fluence map (a set
of beamlet intensities that can be controlled individually). Typically, a small number of equispaced coplanar beam angles are
used. The planned structures are modeled as discretized cubes
(called voxels) and the dose to each voxel per intensity of each
beamlet is calculated [20], [21]. A radiation oncologist specifies
a set of requirements that have to be satisfied in the treatment
plan. These requirements are in the form of the prescription dose
to the PTV and the maximum dose at the OARs.
B. Hierarchical Optimization in Reduced Space
Hierarchical optimization is a strategy of multivariable optimization derived from priority-driven sequential steps of single-

Fig. 1.

1063

Generic outline of the reduced-order PO method.

objective optimization problems. Without loss of generality, we
consider the minimization of a multiobjective problem. Suppose a complex goal g = {g1 , g2 ,. . .,gn } contains n objectives. The subscript in this goal also describes the relative
importance of each objective, where g1 is the most important one and gi−1 is always more important than gi . The so(1) (1)
(1)
lution g (1) = {g1 , g2 ,. . .,gn } is better than the solution
(2) (2)
(2)
(1)
(2)
g (2) = {g1 , g2 ,. . .,gn }, if, and only if, gk < gk and
(1)
(2)
gi = gi = min(gi ) hold for certain k ≤ n and all i < k. In
other words, before priority k, all objectives are equally satisfied in both g (1) and g (2) , but on priority k, g (1) dominates g (2) .
Thus, the formulation of the prioritized minimization problem
can be written as follows:
min gk ,
s.t.

k = 1, 2, ..., n
gi = min gi ,

i < k.

(1)

Accordingly, PO would be defined as the algorithmic process
of a prioritized minimum solution for a multiobjective problem.
In the current study, we employed a prioritized approach combined with a dimensionality reduction of the search space in
order to reduce the computational complexity of the numerical
optimization method for solving the sequential constrained optimization problems. An outline of our method can be written
in generic form, as in Fig. 1.
Initially using a computed tomography scan as a guide, the
number and orientation of beams to be used in the treatment were
selected by the planner. Afterwards, a series of unconstrained
optimizations were performed to sample the optimal intensity
space. Upon completion of the unconstrained optimizations, a
principal component analysis (PCA) was employed in order
to reduce the dimensionality reduction of the solution space.
Finally, sequential PO steps were performed with constraints
in the reduced-order space. In the following subsections, we
describe each stage of our method.
C. Sampling the Unconstrained Optimal Intensity Space
The inverse radiotherapy problem is to determine a vector
of beamlet intensities that minimizes the objective function. In
the first step of our method, our goal is to “probe” the intensity
space for a given patient. To that end, we initially constructed a

1064

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

single-objective function expressed as a weighted sum of partial
terms:
 (Di − DT )2

+
wj · < Dj >
I = arg minwT
NT
j ∈OARs

i∈T



(2a)
wk = 1

(2b)

k

where NT is the number of voxels in the target structure, DT is
the prescribed dose to the PTV, < Dj > is the mean dose of the
OAR j, and the variables wT and wj are the relative weights for
the PTV and OARs, respectively. The Latin hypercube sampling
method was employed to define the weights variables of (1) in
the interval [0, 1]. The dose to voxel i is given by:
Di =

M 
N


Ak ,j · Ik ,j

(3)

k =1 j =1

where Ak is the dose deposition matrix (DDM), which describes
the dose contribution to all relevant voxels of the structure under
consideration for the unit fluence; k is the index of the beam
number; Ik ,j is the intensity of the beamlet j for the beam k; M is
the total number of beams; and N is the number of beamlets for
beam k. Parameter-based unconstrained optimization was used
to construct an intensity space that contains possible solutions.
We then applied PCA to reduce the dimensionality of the search
space and make the constrained optimization computationally
feasible.
D. Reduction of Search-Space Dimensionality
Upon sampling optimal intensities {I1 , I2 ,. . .,IN } (see (2)),
the dimensionality of the intensity space can be reduced by
linear or nonlinear feature extraction methods. PCA constructs
a low-dimensional representation of the data (in our case, the
intensities of the beamlets), which describes as much of the
variance in the data as possible. This is accomplished by finding a linear basis of reduced dimensionality for the beamlet
intensities, in which the amount of variance is maximal. It can
be shown that this linear mapping is formed by the d-principal
eigenvectors (i.e., p.c.) of the covariance matrix of the zeromean data. The corresponding eigenvectors form the columns
of linear transformation matrix T . Low-dimensional data representations y of datapoints x are computed, mapping them onto
linear basis T , i.e., Y = (X−Xm ean ).T . In our case, the dose
of structure S in the reduced dimensionality space is given by:
DS (ξ, Nm o des ) =

N
m odes

A · ξj + μ

(4)

where ξj are the coefficients of the p.c., which are the independent variables of the optimization. Similarly, as A is the
DDM previously, j is the index of the Nm o des p.c., and μ is
the dose corresponding to the mean of {Ii }. The intensities of
these modes were determined during the PCA and the linear
transformation is simply:
Ii = Lξi + < {Ii } >

where L is a vector containing the eigenvectors and ξj are essentially the coordinates of the transformed intensities {Ii }.
Given the p.c. variances (that is, the eigenvalues of the covariance matrix), we find the Λ eigenvectors that capture a desired
percentage (v%) of the total variance:
Λ
i=1 λi
≥ 98%.
(6)
v% = M
j =1 λj
E. Reduced-Order Prioritized Optimization
The mathematical formulation of the PO is similar to the one
proposed by Wilkens et al. [12] and can be described as follows:
Step 1: Find the vector y in the eigenspace so as to:

2
j ∈T [Dj (y) − Dpresc ]
1
(7a)
minimize OF (y) =
VT
m ax
s.t. : Dj (y) ≤ DOAR1
,

L · y + {Ii } ≥ 0

j =1

ξi = LT Ii ,

Fig. 2. Screen plot of the first fifty eigenvalues obtained with the PCA of the
unconstrained set of optimized plans (stem bars) for the prostate (a) and lung
(b) case. The dashed line represents the percentage of variance explained as a
function of the eigenvalues (left y-axis).

(5)

∀j ∈ VOAR1

(7b)
(7c)

where Dj (y) is the dose voxel j of the target T and is given from
(4), and y is the beamlet intensities in the eigenspace; Dpresc
is the prescription dose; VT and VOAR1 is the volume of the
m ax
is the constraint
target and the OAR1, respectively; and DOAR1
1
for the maximum dose at the OAR . Equation (7c) requires the
inversely transformed data y from the eigenspace to the real
intensity values to be positive numbers.

KALANTZIS AND APTE: NOVEL REDUCED-ORDER PRIORITIZED OPTIMIZATION METHOD FOR RADIATION THERAPY

1065

Fig. 3. A simplified summary of the sequential optimization formulation (a), as used in this paper for the prostate case, and DVHs for each step of the
reduced-order PO for the PTV (b), rectum (c), and bladder (d). A quadratic slip factor of 2.0 was used for the PTV in this set of optimizations.

Fig. 4. Traversal (left panel) and sagittal (right panel) view of the dose distribution for each step of the PO (Step 1: a, d; Step 2: b, e; Step 3: c, f). The outlined
structures are (from top to bottom for traversal view; left to right for sagittal view) the bladder, PTV, and rectum.

1066

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

TABLE I
SUMMARY METRICS FOR THE PTV AND TWO OARS AT EACH STEP OF THE
PRIORITIZED OPTIMIZATION ALGORITHM USING A SLIP FACTOR OF 2

the OAR1 not exceed the mean dose for the same OAR that was
obtained in Step 2. Additionally, the relaxation of constraints in
OF1 is increased by the square of (1+s).
F. Treatment Planning Optimization Parameters

Step 2: In the second step, we minimize the mean dose at the
first OAR:

j ∈OAR1 Dj (y)
2
(8a)
minimize OF (y) =
VOAR1
m ax
s.t.: Dj (y) ≤ DOAR1

∀j ∈ VOAR1

(8b)

min[Dj (y 1 )] ≤ Dj (y) ≤ Djm ax ≤ max[Dj (y 1 ), 1.15 · Dpresc ],
∀j ∈ T

(8c)

OF1 (y) ≤ (1 + s) · OF1 (y 1 )

(8d)

L · y + {Ii } ≥ 0

(8e)

m ax
where DOAR1
and VOAR1 are the maximum dose allowed at
and the volume of the OAR1 , respectively, and y 1 is the solution
obtained in Step 1. We observe that we have two additional
constraints for the optimization problem. First, the dose at the
target should be greater than or equal to the minimum dose and
greater than the maximum dose or 115% of the prescription
dose, as they were obtained from Step 1 (8c). Second, the hard
constraint for the quadratic function OF1 that was achieved in
Step 1 is relaxed by slip factor s (8d). Similarly as in the previous
step, we require the beamlets intensities to be positive numbers
(8e).
Step 3: As before, Step 3 reads as follows: Find y in order to:

j ∈OAR2 Dj (y)
(9a)
minimize OF3 (y) =
VOAR2

s.t.: Dj (y) ≤

m ax
DOAR1

m ax
Dj (y) ≤ DOAR2

∀j ∈ VOAR1
∀j ∈ VOAR2

min[Dj (y )] ≤ Dj (y) ≤
1

(9b)
(9c)

Djm ax

≤ max[Dj (y 1 ), 1.15 · Dpresc ] , ∀j ∈ T

(9c)

OF (y) ≤ (1 + s) · OF (y )

(9d)

OF2 (y) ≤ OF2 (y 2 )

(9e)

L · y + {Ii } ≥ 0.

(9f)

1

2

1

1

The hard constraints in Step 3 are similar to those in Step 2,
with the exception of (9e), which requests that the mean dose at

In this paper, two treatment plans were used to evaluate our
method. The first one was a prostate case with two OARs: the
rectum and the bladder. The plan consisted of five coplanar
beams (nominal energy, 6 MV) and a total number of 235
beamlets each of which were 1.0 cm2 in size. The prescription dose to the PTV was 72 Gy, and the maximum dose at
the bladder and the rectum was 105% of the prescribed dose.
The second treatment plan was a lung case, with the lung and
the heart considered OARs. The PTV was irradiated with three
coplanar beams (nominal energy, 6 MV), and the number of
beamlets was 272. For each case, we used 100 samples during
the unconstrained optimization stage. For the numerical solver,
the SQP algorithm was used [22], while the maximum number
of iterations was set to 200 and the code was implemented in
MATLAB (The MathWorks, Inc., Natick, MA, USA). Finally,
the treatment planning was performed using the software environment CERR (Computational Environment for Radiotherapy
Research) [23], and the DDM was calculated with the ORART
(Operations Research Applied to Radiation Therapy) toolbox,
which is an extension of CERR that is based on Ahnesjo’s pencil beam algorithm [21], [24]. For all beams, the DDM was
precalculated and stored in memory as a sparse matrix.
III. RESULTS FOR A PROSTATE CASE
A. Number of Samples and Eigenvalues
A critical aspect of our method is the choice of the number
of p.c.. A small number of p.c. will not reliably capture the
major modes of the intensity space. The screen plot in Fig. 2 (a)
and (b) illustrates for the prostate and lung case, respectively,
the eigenvalues and the percentage of variance explained for
the first fifty p.c. From our data, we found that 42 p.c. were
sufficient to capture 98% of the total variance for the prostate
case, whereas it was 24 p.c. for the lung plan. Those p.c. were
the independent variables of the PO procedure.
B. Prostate IMRT Case
For qualitatively demonstration of our method’s results, we
employed as a metric the dose-volume histograms (DVHs)
which is commonly used in radiation therapy for evaluation
of a treatment plan. The DVHs for the prostate IMRT case are
shown in Fig. 3 for each structure and step separately. The x-axis
represents the dose at the structure while the y-axis represents
the fractional volume which have received a dose D. A slip
factor s equal to 2 was used in this example. The goals of each
individual step of the sequential optimization method are reflected by the DVHs. In Step 1, good coverage of the PTV is
achieved, while the dose at the rectum and bladder do not exceed
the maximum allowed dose. In Step 2, the dose at the rectum is
substantially reduced and the homogeneity of the PTV is not affected significantly, but the mean dose to the bladder is slightly

KALANTZIS AND APTE: NOVEL REDUCED-ORDER PRIORITIZED OPTIMIZATION METHOD FOR RADIATION THERAPY

1067

Fig. 5. A simplified summary of the sequential optimization formulation (a), as used for the lung case in this paper, and the DVHs for each step of the
reduced-order PO for the PTV (b), lung (c), and heart (d), structures respectively. A quadratic slip factor of 3 was used for the PTV in this set of optimizations.

Fig. 6. Traversal (left panel) and sagittal (right panel) view of the dose distribution for each step of the PO (Step 1: a, d; Step 2: b, e; Step 3: c, f). The outlined
structures are the lungs, PTV, and heart.

1068

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

TABLE II
DOSIMETRIC EVALUATION PARAMETERS FOR THE PTV AND TWO OARS AT
EACH STEP OF THE OPTIMIZATION ALGORITHM

increased. Finally, in Step 3, the mean dose of the bladder is considerably decreased without compromising the mean dose at the
rectum. For demonstration purposes, Fig. 4 illustrates traversal
and sagittal views of the dose distributions for each step. The
overlapping of the rectum and the bladder with the PTV was
6% and 17%, respectively. By visual inspection, one can notice
dose sparing at the rectum in Step 2 [see Fig. 4 (b) and (e)].
Table I reports the numerical results of our simulations. We
should stress that the reported results were not normalized to
deliver the prescription dose to the ICRU-50 [25] prescription
point (isocenter). Such normalization would simply linearly escalate the dose of each structure for each step, so we therefore
considered that the difference in the dose at each step would
be more profound without normalization. In Table I, one can
notice that the reduction of the PTV coverage (D95 ∼Dose received the 95% of the PTV volume) is equal to ∼2%, while
the mean dose at the rectum and the bladder was decreased by
∼17% and ∼18%, respectively, upon completion of the final
step of the optimization, when a slip factor (s = 2) was used.

C. Lung IMRT Case
A lung IMRT case with a prescription dose to the PTV of
60 Gy was considered. Fig. 5 (a) illustrates the three steps of
the PO. As before, two OARs were considered: the lung and
the heart. Figs. 5 (b), (c), and (d) shows the DVHs for the PTV,
lung, and heart, respectively, when a slip factor of 3 was used.
Fig. 6 shows the sagittal and traversal dose distributions of
the treatment plan for each optimization step. As in the prostate
case, we note the sparing of the lung and the heart during the
second and third step, respectively, of the optimization.
In Table II, we see that the D95 was reduced by ∼2%, while
the mean dose at the lung and the heart were reduced by ∼16%
and ∼55%, respectively. We speculate that the main reason for
the dramatic decrease in the mean dose at the heart is that there
is no actual overlap of this structure with the PTV. Therefore, the
optimizer can more easily reduce the dose at the heart, without
affecting the dose coverage of the PTV.

TABLE III
SPEEDUP FACTORS FOR EACH STEP OF THE PRIORITIZED OPTIMIZATION FOR
THE PROSTATE AND LUNG CASE

Fig. 7. DVHs of the PO with (solid line) and without (dashed line) dimensionality reduction for the two cases.

D. Effect of Slip Factor “s” and Eigenmodes
We carried out a set of simulations to investigate the effect of
the slip factor s and the dimensionality reduction on our method.
A set of POs was repeated without dimensionality reduction
of the intensity space and compared with the results obtained
from our method. Table III reports the speed up factors obtained
with our method compared to the nonreduced order POs for the
two treatment planning cases. An average speedup of 36.3 and
43.5 was achieved for the prostate and lung case respectively. It
is worth noting that a higher speedup factor was achieved for the
lung case. That was expected since the number of eigen modes
used for that plan (24 eigen modes) was smaller compared to the
prostate case (42 eigen modes). That implies less independent
variables and consequently smaller execution times.
Evaluation of the effect of the dimensionality reduction on
the plans quality was based on the DVHs as this is the most
common way in clinical practice. As can be seen in Fig. 7, there
is a good agreement between our method and the nonreduced
algorithm for both the prostate and lung case. Finally, Fig. 8 (a)
and (b) illustrates for the prostate and lung case, respectively,
We observe that the maximum reduction of the D95 was ∼4%,
whereas the mean dose at the rectum and bladder was reduced

KALANTZIS AND APTE: NOVEL REDUCED-ORDER PRIORITIZED OPTIMIZATION METHOD FOR RADIATION THERAPY

Fig. 8. Effect of the slip factor s on the reduced-order PO for the prostate and
lung case.

by ∼23%, compared to the maximum mean value. Similarly,
for the lung case, the D95 was decreased by ∼2% when a slip
factor of 3 was used.
IV. CONCLUSION
We have described a reduced-order hierarchical programming
method for IMRT treatment planning. The applicability of our
method was demonstrated for a prostate and lung treatment
planning case. The advantages of the proposed method over the
‘conventional’ approach of creating a linearly weighted multiterm objective function are: (i) qualitatively, priorities of objectives can be defined intuitively by the planner/physician before
treatment planning optimization; (ii) once the hierarchy of the
objectives and slip factor are determined, the process is automatic and does not require several trial and error optimizations.
In that way, the planner can focus on the final evaluation of
the treatment plan; (iii) since normal tissue dosimetric goals are
used as objective functions, rather than simple constraints, the
method reduces the dose to normal tissue as much as possible
without adversely affecting more important goals; and (iv) the
reduction of the search-space dimensionality enhances computational efficiency of the sequential constraint optimizations.
In the current formulation, mean dose objective functions
were used for the OARs for both the unconstrained sampling
stage and the PO, in a manner similar to Wilkens et al. [12].
However, in clinical practice, dose-volume constraints are commonly used in addition to mean-dose constraints. Previous studies have incorporated dose-volume constraints in gradient-based
algorithms for inverse treatment planning [26]. One disadvantage of dose-volume constraints is that they introduce nonconvex

1069

feasibility spaces into the optimization problem, potentially creating multiple local minima and associated issues in solver accuracy and run-time efficiency [27]. Thus, mixed-integer or heuristic techniques are required, and these are generally not as efficient as linear/quadratic methods. Additionally, for nonconvex
regions, the weighted-sum approach cannot discover optimal
solutions of the Pareto front [28], and one cannot assert that linear PCA will always detect all structures in a given data set [29].
In that case, nonlinear feature-extraction algorithms would be
more adequate for the reduction of search-space dimensionality
and abstraction of the structures in the beamlet intensities. Alternatively, Romeijn et al. have previously suggested using ‘mean
tail dose’ rather than conventional dose-volume constraints [30],
which are linear functions and hence, computationally attractive.
‘Mean tail dose’ refers to the mean dose of either the hottest or
coldest specified fractional volume and has been successfully
used in PO studies in the past [13]. However, one disadvantage
of the ‘mean tail dose’ approach is the increase in problem size,
which would result in extensive execution times.
A key variable of the current technique is the slip factor
‘s’. As previous studies have shown, a small relaxation of a
higher-priority objective can result in a large improvement of a
lower-priority goal [12], [13]. The studies indicated that, in the
reduced-order space, the slip factor could significantly improve
the average dose at the OARs, without significantly compromising the dose homogeneity at the PTV. Additionally, from
our results it appears that reduction of the search-space dimensionality produces similar solutions with those obtained from
the PO without utilizing dimensionality reduction.
We would like to stress that in the current study, we focus on the methodological aspects of the proposed algorithm,
rather than investigate its performance under various conditions.
Therefore, in our implementation, we did not extensively alleviate computational bottlenecks of the executable code, which
might hinder its computational complexity and consequently,
its performance. Despite the fact the code was implemented in
MATLAB, which is slower when compared to other commercial
software for constraint optimization, we observed a maximum
acceleration of ∼49.9 for PO. That is due to the decrease in
independent variables of the numerical optimizer. The main disadvantage of our method, however, is the sampling stage, during which several optimization runs are required. GPU-based
IMRT optimization [31] and parallel global optimizers [32],
which result in significantly reduced execution times, have been
suggested in the past. Future directions of our study involve
parallelization of the numerical optimizer, which would lead to
further acceleration of the proposed method.
Overall, the proposed reduced order prioritized-prescription
treatment planning bears not only the ability to impact the dose
distribution in a direct intuitive way, but also the enhanced computational efficiency makes the method attractive for clinical
use.
ACKNOWLEDGMENT
The authors would like to acknowledge Dr. A. Jackson for
his helpful comments.

1070

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

REFERENCES
[1] L. Veldeman, I. Madani, F. Hulstaert, G. Meerleer, M. Mareel, and
W. De Neve, “Evidence behind use of intensity-modulated radiotherapy:
A systematic review of comparative clinical studies,” Lancet Oncology,
pp. 367–375, 2008.
[2] T. Bortfeld, “Optimized planning using physical objectives and constraints,” Semin. Radiation Oncology, vol. 9, pp. 20–34, 1999.
[3] Z. Fuks, S. A. Leibel, and C. C. Ling, A Practical Guide to IntensityModulated Radiation Therapy. Madison, WI, USA: Medical Physics
Publishing, 2004.
[4] R. Palta and T. R. Mackie, Intensity Modulated Radiation Therapy: The
State of the Art. Madison, WI, USA: Medical Physics Publishing, 2004.
[5] K. Kufer, M. Monz., A. Scherrer, P. Suss, F. Alonso, A. Sultan.,
T. Bortfeld, and C. Thieke, “Multicriteria optimization in intensity modulated radiotherapy planning,,” in Handbook of Optimization in Medicine,
P. M. Pardalos and H. E. Romeijn, Eds. New York, NY, USA: Springer,
2009.
[6] S. V. Spirou and C. S. Chui, “A gradient inverse planning algorithm with
dose-volume constraints,” Med. Phys., vol. 25, pp. 321–33, Mar. 1998.
[7] Q. Wu and R. Mohan, “Algorithms and functionality of an intensity modulated radiotherapy optimization system,” Med. Phys., vol. 27, pp. 701–11,
Apr. 2000.
[8] K. Miettinen, Nonlinear Multiobjective Optimization. Boston, MA,
USA: Kluwer, 1999.
[9] R. Marler and J. S. Arora, “Survey of multi-objective optimization methods for engineering,” Struct. Multidisc. Optim., vol. 26, pp. 293–297,
2004.
[10] J. F. Bonnans and A Shapiro, Perturbation analysis of optimization problems. New York, NY, USA: Springer-Verlag, 2000.
[11] K. W. Jee, D. L. McShan, and B. A. Fraass, “Lexicographic ordering:
Intuitive multicriteria optimization for IMRT,” Phys. Med. Biol., vol. 52,
pp. 1845–61, Apr. 2007.
[12] J. J. Wilkens, J. R. Alaly, K. Zakarian, W. L. Thorstad, and J. O. Deasy,
“IMRT treatment planning based on prioritizing prescription goals,” Phys.
Med. Biol., vol. 52, pp. 1675–92, Mar. 2007.
[13] V. H. Clark, Y. Chen, J. Wilkens, J. R. Alaly, K. Zakaryan, and J. O. Deasy,
“IMRT treatment planning for prostate cancer using prioritized prescription optimization and mean-tail-dose functions,” Linear Algebra Appl.,
vol. 428, pp. 1345–1364, Mar. 2008.
[14] R. Rosenthal, “Principles of multiobjective optimizaiton,” Decis. Sci.,
pp. 133–152, 1985.
[15] L. Rivera, E. Yorke, A. Kowalski, J. Yang, R. J. Radke, and A. Jackson,
“Reduced-order constrained optimization (ROCO): Clinical application
to head-and-neck IMRT,” Med. Phys., vol. 40, p. 021715, Feb. 2013.
[16] H. Stabenau, L. Rivera, E. Yorke, J. Yang, R. Lu, R. J. Radke, and
A. Jackson, “Reduced order constrained optimization (ROCO): Clinical
application to lung IMRT,” Med. Phys., vol. 38, pp. 2731–41, May 2011.
[17] R. Lu, R. J. Radke, L. Happersett, J. Yang, C. S. Chui, E. Yorke,
and A. Jackson, “Reduced-order parameter optimization for simplifying prostate IMRT planning,” Phys. Med. Biol., vol. 52, pp. 849–70, Feb.
2007.

[18] R. Lu, R. J. Radke, J. Yang, L. Happersett, E. Yorke, and A. Jackson,
“Reduced-order constrained optimization in IMRT planning,” Phys. Med.
Biol., vol. 53, pp. 6749–66, Dec. 2008.
[19] G. Kalantzis, A. Apte, R. Radke, and A. Jackson, “A reduced order
memetic algorithm for constraint optimization in radiation therapy treatment planning,” in Proc. ACIS Int. Conf. Softw. Eng., Artif. Intell., Netw.
Parallel /Distributed Comput., 2013, HI, USA, pp. 225–230.
[20] R. Mohan, C. Chui, and L. Lidofsky, “Differential pencil beam dose
computation model for photons,” Med. Phys., vol. 13, pp. 64–73, Jan./Feb.
1986.
[21] A. Ahnesjo, M. Saxner, and A. Trepp, “A pencil beam model for photon
dose calculation,” Med. Phys., vol. 19, pp. 263–73, Mar./Apr. 1992.
[22] J. Nocedal and S. Wright, Numerical Optimization, 2nd ed. New York,
NY, USA: Springer Verlag, 2006.
[23] J. O. Deasy, A. I. Blanco, and V. H. Clark, “CERR: A computational
environment for radiotherapy research,” Med. Phys., vol. 30, pp. 979–85,
May 2003.
[24] J. Deasy, E. Lee., T. Bortfeld, M. Langer, K. Zakarian, J. Alaly, Y. Zhang,
H. Liu, R. Mohan, R. Ahuja, A. Pollack, J. Purdy, and R. Rardin, “A collaboratory for radiation therapy treatment planning optimization research,”
Ann. Oper. Res., vol. 148, pp. 55–63, 2006.
[25] ICRU International Commission on Radiation Units50 Prescribing,
recording and reporting photon beam therapy. International Commission
on Radiation Units, Bethesda, MD, USA, ICRU Report No. 50, 1993.
[26] D. Hristov, P. Stavrev, E. Sham, and B. G. Fallone, “On the implementation
of dose-volume objectives in gradient algorithms for inverse treatment
planning,” Med. Phys., vol. 29, pp. 848–56, May 2002.
[27] J. O. Deasy, “Multiple local minima in radiotherapy optimization problems with dose-volume constraints,” Med. Phys., vol. 24, pp. 1157–61,
Jul. 1997.
[28] K. Deb, Multi-Objective Optimization Using Evolutionary Algorithms.
Chichester, U.K.: Wiley, 2001.
[29] H. Hoffmann, “Kernel PCA for novely detection,” Pattern Recog., vol. 40,
pp. 863–874, 2007.
[30] H. E. Romeihn, R. K. Ahuja, and J. F. Dempsey, “A new linear programming approach to radiation therapy treatment planning problems,” Oper.
Res., vol. 54, pp. 201–216, 2006.
[31] C. Men, X. Gu, D. Choi, A. Majumdar, Z. Zheng, K. Mueller, and
S. B. Jiang, “GPU-based ultrafast IMRT plan optimization,” Phys. Med.
Biol., vol. 54, pp. 6565–73, Nov. 2009.
[32] F. Theos, I. Lagaris, and D. Papageorgiou, “PANMIN: sequential and
parallel global optimization procedures with a variety of options for the
local search strategy,” Comput. Phys. Commun., vol. 159, pp. 63–69, 2004.

Authors’ photographs and biographies not available at the time of publication.

