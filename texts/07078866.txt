2224

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

A Dual-Mode Large-Arrayed CMOS ISFET Sensor
for Accurate and High-Throughput pH Sensing
in Biomedical Diagnosis
Xiwei Huang, Member, IEEE, Hao Yu∗ , Senior Member, IEEE, Xu Liu, Member, IEEE, Yu Jiang,
Mei Yan, and Dongping Wu

Abstract—Goal: The existing ISFET-based DNA sequencing detects hydrogen ions released during the polymerization of DNA
strands on microbeads, which are scattered into microwell array
above the ISFET sensor with unknown distribution. However, false
pH detection happens at empty microwells due to crosstalk from
neighboring microbeads. In this paper, a dual-mode CMOS ISFET sensor is proposed to have accurate pH detection toward
DNA sequencing. Methods: Dual-mode sensing, optical and chemical modes, is realized by integrating a CMOS image sensor (CIS)
with ISFET pH sensor, and is fabricated in a standard 0.18-μm
CIS process. With accurate determination of microbead physical locations with CIS pixel by contact imaging, the dual-mode
sensor can correlate local pH for one DNA slice at one locationdetermined microbead, which can result in improved pH detection
accuracy. Moreover, toward a high-throughput DNA sequencing,
a correlated-double-sampling readout that supports large array
for both modes is deployed to reduce pixel-to-pixel nonuniformity
such as threshold voltage mismatch. Results: The proposed CMOS
dual-mode sensor is experimentally examined to show a well correlated pH map and optical image for microbeads with a pH sensitivity of 26.2 mV/pH, a fixed pattern noise (FPN) reduction from
4% to 0.3%, and a readout speed of 1200 frames/s. Conclusion: A
dual-mode CMOS ISFET sensor with suppressed FPN for accurate
large-arrayed pH sensing is proposed and demonstrated with stateof-the-art measured results toward accurate and high-throughput
DNA sequencing. Significance: The developed dual-mode CMOS
ISFET sensor has great potential for future personal genome diagnostics with high accuracy and low cost.
Index Terms—CMOS image sensor (CIS), contact imaging, correlated double sampling, DNA sequencing, ion-sensitive field-effect
transistor (ISFET), pH detection.

I. INTRODUCTION

T

HE traditional ion-sensitive field-effect transistor (ISFET)
introduced by Bergveld [1] was essentially a metal–oxide–

Manuscript received November 10, 2014; revised March 7, 2015; accepted
March 30, 2015. Date of publication April 2, 2015; date of current version
August 18, 2015. This work was supported by the Singapore National Research
Foundation Proof-of-Concept under Grant NRF2011NRF-POCO01-050. This
paper was presented at the IEEE Symposium on VLSI Circuits, Honolulu, HI,
USA, June 2014. Asterisk indicates corresponding author.
X. Huang is with the School of Electronics and Information, Hangzhou Dianzi
University, and also with the School of Electrical and Electronic Engineering,
Nanyang Technological University.
∗ H. Yu is with the School of Electrical and Electronic Engineering, Nanyang
Technological University, 639798 Singapore (e-mail: haoyu@ntu.edu.sg).
X. Liu, Y. Jiang, and M. Yan are with the School of Electrical and Electronic
Engineering, Nanyang Technological University.
D. Wu is with the State Key Laboratory of ASIC and System, School of
Microelectronics, Fudan University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2419233

Fig. 1. (a) Traditional ISFET fabricated by a special process. (b) ISFET
fabricated by a standard CMOS process. (c) Existing large ISFET array for
a DNA sequencing, which shows the problem of sequencing accuracy due to
pH crosstalk and V T variation.

semiconductor FET without polysilicon gate as shown in
Fig. 1(a). Its fabrication was, however, expensive and not compatible with a standard CMOS process. As shown in Fig. 1(b),
Bausells first integrated ISFET in a standard CMOS process
with a polysilicon gate connected to the top metal and oxinitride passivation layer [2], making ISFET with low cost and
mass manufacturable. As a result, the CMOS ISFET can lead
to on-chip integration with high-speed and low-noise CMOS
readout circuit for large chemical sensor array. These advantages enable the ISFET applications to evolve over years from
neuronal sensing to personalized biomedical diagnosis such as
DNA sequencing [3]–[7], where the features of high throughput,
low cost, and miniaturization are required [8], [9].
DNA sequencing has profound impact on life technologies
such as personal genome study, health care, drug development
[10]. Toward higher throughput and lower cost sequencing, over
the decades, there has been a remarkable development of the
next-generation DNA sequencing instruments [11], [12], such
as electrical sequencer called personal genome machine (PGM)

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

HUANG et al.: DUAL-MODE LARGE-ARRAYED CMOS ISFET SENSOR FOR ACCURATE AND HIGH-THROUGHPUT pH SENSING

[5]. The PGM relies on a large-arrayed ISFET sensor chip to
detect hydrogen ions (H+ ) released by DNA polymerase [13].
The DNA slices to be sequenced are initially prepared to attach
onto microbeads, which are then distributed into microwell reaction chambers, each of which corresponds to one ISFET pixel
below. As such, the detected local pH change can be used for
the DNA sequencing analysis.
However, as for the ISFET-based DNA sequencing, there is
significant inaccuracy existed due to two reasons as illustrated in
Fig. 1(c). First, as the DNA-templated microbeads are scattered
into microwell array by centrifuge spinning, the distribution of
microbeads into microwell array is not known [14]. Thus, the
measured pH response has no correlation with the physical locations that contain microbeads. If there is no microbead in the
microwell, due to crosstalk from neighboring microbeads in the
solution, it will lead to a false pH value reported. Second, to
improve a sequencing throughput, one needs a large-arrayed ISFET pixels per sensor chip at an advanced CMOS process nodes
[5]. However, larger process variation occurs in the attributes of
transistors, such as oxide thickness, channel length, and width
[15]. As such, the pixel-to-pixel threshold voltage VT mismatch,
or the fixed pattern noise (FPN) [16], is also increased, which
can significantly degrade pH detection accuracy as the ISFET
sensor is to detect the change of the threshold voltage VT .
To tackle the first problem, microscope imaging of the 2-D
microbead distribution can be applied, which still requires bulky
optics and tedious calibration. Furthermore, due to the small
field-of-view when zooming in for micrometer-scale spatial resolution, the microscope needs to physically scan the whole array, which would be slow and could lead to more overhead and
detection error. For the second problem, the process level UV exposure is used in [17] to remove the trapped charge accumulated
on the ISFET gates, but it requires an external calibration source
with long time to converge. Some other circuit level techniques
have also been proposed. In [18], a programmable-gate (PG)
ISFET is proposed to program the ISFET operating point by applying a voltage bias to the capacitively coupled floating gate and
counteract the effect of trapped charge and drift. However, it also
requires other auxiliary circuits. Based on PG-ISFET, a backend digital autocalibration technique is developed in [19] to
eliminate mismatch. Their main limitation is not applicable for
large-arrayed design toward a high-throughput DNA sequencing. A reference-electrode-based differential readout method is
developed in [20], which makes differential measurement of a
reference FET (REFET) and ISFET to reduce the noise. However, because REFET and ISFET are not the same device, the
noise may not be correlated to cancel.
Toward an accurate and high-throughput DNA sequencing,
we have demonstrated one 64 × 64 arrayed dual-mode CMOS
ISFET sensor in this paper with preliminary results reported in
[21]. First, both optical and pH sensing are performed with a
dual-mode sensor pixel that integrates the ISFET with CMOS
image sensor (CIS) pixel in standard CIS process. Since the
microbeads are in direct contact with the sensor surface, the
imaging of the microbead distribution can be detected based
on the contact imaging principle without lens [22]–[25]. As
such, an accurate pH-image correlation map can be generated

Fig. 2.

2225

ISFET device model in a standard CMOS process.

to prune the false pH values due to crosstalk for empty microwells. Moreover, one correlated-double-sampling (CDS) readout
is developed for both image and pH modes to reduce the pixel-topixel VT mismatch, i.e., FPN. As such, the proposed dual-mode
sensor can significantly enhance the accuracy of ISFET-based
DNA sequencing.
The remainder of this paper is organized as follows. In Section II, the brief background of ISFET and contact imaging are
introduced. Next, the dual-mode CMOS ISFET sensor is presented in Section III. After that the CDS readout with an FPN
reduction is discussed in Section IV. The experimental results
are discussed in Section V with conclusions in Section VI.
II. BACKGROUND
A. ISFET-Based pH Sensing
The ISFET characteristics are affected by the ionic activity of
the electrolyte. In conventional ISFET that has no polysilicon
gate, the immediate pH response results from the surface reaction between electrolyte and ion sensitive membrane on gate
oxide. For ISFET fabricated in the standard CMOS process,
the pH response is attributed to the surface reaction between
electrolyte and the intrinsic passivation layer (Si3 N4 ) as an ion
sensitivity membrane, which is all the way connected through
the metal layers to the polysilicon gate as shown in Fig. 2.
The pH-dependent surface charge causes the changes in ISFET
transfer characteristics and modulates its threshold voltage VT .
As shown in Fig. 2, this can be modeled using the sitedissociation model and the Gouy–Chapman–Stern double-layer
model [26], [27] by
VT (ISFET) = VT (M OS) + Vchem

(1a)

Vchem = γ + 2.3 × α · UT · pH

(1b)

and

where Vchem is the chemical voltage between the reference
electrode and passivation layer, the only pH dependent item;
γ is a grouping factor of all pH-independent terms; UT is the
thermal voltage; and 0 < α < 1 is a sensitivity parameter,
whose maximum value gives the theoretical Nernstian sensitivity limit of 59.2 mV/pH at 25 °C. What is more, CGouy ,
CHelm , and CPass are the capacitances of the Gouy–Chapman
or diffuse layer, the Helmholtz layer, and the passivation layer,

2226

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

respectively [27]. Besides, the effects of nonidealities determined by different physical design geometries can also be considered. For example, we have parasitic capacitances, such as
those between passivation to source CPs , to drain CPd , to body
CPb , and to substrate CPsub [28]. As such, the threshold voltage
of the ISFET is linearly proportional to pH.
B. ISFET-Based DNA Sequencing
As the detection of pH value change can be correlated for
DNA sequencing, the CMOS-ISFET-based sensor has been deployed in PGM [5]. To prepare the genomic sample, the DNA
chain is first fragmented into slices and ligated to specific
adapters, which are then linked to and clonally amplified by
emulsion PCR on the surface of microbeads. Next, the templated microbeads are loaded into a microwell array that is fabricated on the top of the ISFET chip. The sequencing is primed
from a specific location in the adapter sequence. Note that each
microbead needs to be loaded into an individual microwell. During sequencing, all four nucleotides (dATP, dGTP, dCTP, and
dTTP) are provided sequentially through a microfluidic system
to react with the template base of the DNA chain. When they
are complementary, the released proton (H+ ) generates a pH
change in the solution of the microwell that is proportional to
the number of nucleotides incorporated. As such, the measured
pH change at a microbead location indicates the relevant DNA
sequence of ATCG [5]. When the pH changes for DNA slices
are detected at millions of spatially localized microbeads by a
large-arrayed ISFET sensor, a high-throughput DNA sequencing can be thereby realized in a nonoptical fashion. However,
the main challenge is to improve the sequencing accuracy that
can remove false pH reporting as well as nonuniformity.
C. Contact Imaging
In this paper, in addition to the pH sensing, we will introduce
an optical sensing for the CMOS ISFET such that a dual-mode
sensor can be developed with the removal of false pH reporting.
Note that conventional optical microscope imaging systems require intermediate bulky lens for magnification, which usually
constrains the size, weight, and cost with the difficulty of miniaturization. One promising solution is the use of contact imaging,
which directly couples the image sensor array with the sample
of interest in small proximity (or contact), as shown in Fig. 3. As
such, the sample image can be captured by directly projecting
light through it with a detected shadow [23]–[25].
Contact imaging is a kind of near-field sensing without an
optic lens [24]. As such, a contact imaging systems have different geometrical constraints over spatial resolution compared
with the lens -based imaging. In conventional optical imaging
systems, the image resolution is determined by the number of
pixels in the photodetect array as the scene is entirely projected
to the sensor array by optics. By increasing the number of pixels,
the spatial resolution for the conventional imaging system can
be increased. Differently in the contact imaging, as the image is
directly projected from the object to the image sensor array, the
resolution is mainly determined by the pixel dimension as well
as proximity distance. Thus, the contact imaging is quite suitable

Fig. 3. Contact imaging principle: With light source illuminated from above,
the contact shadow images of microbeads can be captured by the sensor underneath.

Fig. 4. (a) Architecture of the dual-mode sensor. (b) Cross-sectional view of
the dual-mode pixel layout with microbead contact imaging and ion sensing for
DNA sequencing.

for miniaturized biomedical applications to detect objects such
as microbeads [25] used in DNA sequencing. Thereby, if one
can leverage a dual-mode ISFET sensor with both pH sensing
to detect H+ at one microbead and also contact imaging to detect the existence of microbead, the false pH reporting problem
of the existing ISFET sensor can be resolved during the DNA
sequencing.
III. DUAL-MODE CMOS ISFET SENSOR
As discussed in the introduction, the H+ diffusion of
neighboring nucleotide incorporation processes can introduce
crosstalk with false pH reporting, which is the fundamental limitation of single-mode CMOS ISFET sensor due to the unknown
locations of microbeads [14]. In this paper, we show that with
the use of additional contact imaging, one can develop a dualmode CMOS ISFET sensor with accurately reported pH value
for each microbead.
A. Dual-Mode Sensor Architecture
In this paper, a dual-mode CMOS ISFET sensor is developed
in the standard CIS process. The cross-sectional view of the
proposed dual-mode pixel is shown in Fig. 4(b). Note that n+

HUANG et al.: DUAL-MODE LARGE-ARRAYED CMOS ISFET SENSOR FOR ACCURATE AND HIGH-THROUGHPUT pH SENSING

2227

Fig. 5. Dual-mode pixel schematic in comparison with 4T-CIS pixel and
ISFET pixel (a) 4T-CIS Pixel (b) Dual-mode Pixel (c) ISFET pixel.

and p+ guard rings are placed around the pixel array to minimize
the noise generated from the peripheral circuitry. Each pixel is
in dual mode to correlate the local pH value to the existence of
one microbead detected by the contact imaging. Therefore, the
false pH value reporting problem can be pruned.
Moreover, for a large-arrayed ISFET sensor array with the
minimum nonuniformity of a pixel-to-pixel ISFET threshold
voltage mismatch, the CDS readout is further deployed. As the
architecture diagram shown in Fig. 4(a), the dual-mode CMOS
ISFET sensor contains a 64 × 64 CIS-ISFET pixel array. All
pixels are read out row by row. The row decoder and row driver
sequentially address each row, and 64-column of pixel outputs
are scanned out sequentially controlled by column decoder. The
CDS is implemented with the column sample-and-hold (S/H)
circuitry and the global switched-capacitor operational amplifier. After amplifying the difference of reference and signal
voltages, a 12-bit pipelined A/D converter converts the results
to digitally coded outputs that correspond to pH values. The
SREG is a static register to set the operation mode of the sensor.
The IDAC provides the needed on-chip bias current. The digital
timing generation is realized off-chip using an FPGA to control
the system operation and coordinate all parts of the circuits.
B. Dual-Mode Pixel Structure
Fig. 5 compares the (a) four transistors 4T-CIS pixel and (c)
ISFET pixel with the proposed (b) dual-mode pixel. As shown
in Fig. 5(b), each dual-mode pixel contains a 4T-CIS pixel to
sense the shadow image of microbead by the contact imaging
[22]–[25]. Meanwhile, the source follower (SF) can work as an
ISFET to detect the pH value at one microbead.
In the optical mode, a photodiode PD first collects photons
and converts them to proportional electrons whose drifting generates the photocurrent. As the intrinsic junction capacitor of
PD can store the generated charges, after a certain integration
period, the intensity of incident light carried by the amount
of charges is translated to a voltage signal. The charges can
be transferred to a floating diffusion (FD) by turning on “TX”
switch of M6. As such, the voltage signal indicating the shadow
image of microbead is detected through contact imaging. Then,
the corresponding voltage signal for the optical image is buffered
by SF (M2) and read out to PIXOUT node through its source
under the control of the “ROW” select signal of M3. Since there
are multiple rows of pixels that share the same PIXOUT line,

Fig. 6.
mode.

Dual-mode readout timing for both (a) optical mode and (b) chemical

the row-select transistor M3 is used to isolate different pixel
outputs, and is enabled only when the row is selected for readout. The cascade current source (M4 and M5) provides biasing
current and is shared by the whole column for better current
matching.
In the chemical mode, the polygate of SF (M2) is all-the-way
connected to the top metal and Si3 N4 passivation layer, acting
as an ion-sensitive membrane of ISFET. Since the change of ion
(H+ ) concentration (or pH) can cause the proportional VT shift
of the SF, the corresponding voltage signal is correlated to the
pH value that is read out through the source of SF. Considering
that VT variation exists in the ISFET transistor, i.e., the SF
transistor M2 in Fig. 5, it will show as an offset added at the SF
output PIXOUT, i.e., VPIXOUT = α(VFD –VT ), where α is the
gain of the SF, and VFD and VPIXOUT are the input and output
voltage of the SF. Moreover, note that although ISFET pixel has
a switch to the floating gate, the TX leakage has been reduced
through the process optimization from the CIS aspect. As the
cross-sectional pixel layout shown in Fig. 4(b), a completely
depleted pinned photodiode pixel is used, which consists of a
pinned diode (p+ -n+ -p) to reduce the surface-defect noise due
to the dark current. The depletion layer of a pinned photodiode
stretches almost to the Si–SiO2 interface, which is perfectly
shielded by the p+ layer that keeps the interface fully filled with
holes, making the leakage extremely low [29], [30].
C. Dual-Mode Operation
Based on the dual-mode pixel structure, the timing of dualmode CIS-ISFET pixel sensing control is operated as follows
corresponding to the readout timings shown in Fig. 6 with following steps.
1) When reaction carrier microbeads are initially distributed
into the sensor pixel array, the readout timing is set to
optical mode shown in Fig. 6(a) as a normal 4T-CIS pixel.
The shadow images of microbeads can be captured by the
contact imaging. After that the existence of microbead at
each pixel can be determined with an address generated.
2) Then, the optical mode changes to chemical mode. Before
loading ATCG solution, the reference reset signal for the
whole pixel array is read out using the timing in Fig. 6(b).

2228

Fig. 7.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

CDS readout schematic for a dual-mode sensor.

3) After loading ATCG solution sequentially, the pH readout
timing changes to Fig. 6(c) to obtain the signal of the pixel
array with actual pH value at an individual microbead.
As such, one can obtain the accurate correlation between the
measured pH data and the distribution of microbeads. The false
pH data at empty microwells can be, thereby, eliminated by the
dual-mode operation.
IV. CDS READOUT
As ISFET sensor senses the VT , the pixel-to-pixel VT mismatch in a large-arrayed sensor can introduce a significant error.
Note that CDS is commonly used to reduce the VT mismatch
and improve the signal-to-noise ratio during readout [16]. In
this paper, the CDS for the VT mismatch cancellation and FPN
reduction is developed in the dual-mode CMOS ISFET sensor
array.
The CDS readout timing is shown in Fig. 6 for readout. The
rolling shutter reset phase with PD reset through TX pulse is not
illustrated for simplicity of illustration. Note that the developed
CDS is applied to suppress pixel-to-pixel VT mismatch by using
each pixel itself as reference, which is intrinsically better than
the differential measurement using another REFET device in
[20]. In addition as shown in Fig. 7, the whole CDS readoutchain schematic includes column sample/hold, global amplifier,
and pipelined analog-to-digital converter (ADC).
A. CDS Readout for a CIS
We first discuss the CDS for CIS in an optical mode. As the
timing shown in Fig. 6(a), during the pixel to column readout
period, “CLAMP” switch is ON so that the top plate of sampling
capacitors CSS and CSR are clamped to VCM . The charges on
the pixel output line are sampled to CSR when “SHR” switch
is on and to CSS when “SHS” switch is ON. These correspond
to the pixel reset level voltage VRST and signal-level voltage
VSIG at the SF input node. Then during the column to amplifier
readout period, the “CLAMP” switch is OFF. The crow-bar
switch “CB” is OFF during the amplifier reset phase and is ON
during the charge amplifying phase. The value of sample and
hold (S/H) capacitor is determined by the balance between the
KTC noise and speed. A 1-pF polycapacitor is chosen for both
CSS and CSR , i.e., CSS = CSR = CS = 1 pF. The output of
the column sample capacitors are successively controlled by the
column select signals “COL.”

Following the column S/H is the global switched-capacitor
amplifier that consists of one nonoverlapping clock generator, a fully differential cascode amplifier with a switchedcapacitor common-mode feedback, and several polycapacitors
CFS and CFR for programmable gain control. We also have
CFR = CFR = CF .
The nonoverlapping clock generator generates a pair of a
nonoverlapping clock signals: “Φ1 ” and “Φ2 ,” and “Φ1P ” whose
falling edge is slightly earlier than “Φ1 ” to reduce the possible
charge injection and clock feed-through. “Φ1 ” and “Φ2 ” work
under “CB” to amplify and read out signals of each column.
During the reset phase Φ1 , both inputs and outputs of the amplifier as well as the feedback capacitor CF are reset to VCM ,
the common-mode voltage. During the amplify phase Φ2 , the
bottom plates of the sample and hold capacitors are shorted by
turning on “CB” for the currently selected readout column, and
the feedback capacitor CF is connected to the amplifier output.
Thus, charges are essentially moved from the column sample
and hold a capacitor CS to the feedback capacitor CF . As the
two input nodes of the differential amplifier connect with the
pixel output reset level VPOR and pixel output signal level VPOS ,
and VPOR = α(VRST − VT ), VPOS = (VSIG − VT ); thus, only
the difference between them is amplified and output, i.e.,
VOUT = VOUTP − VOUTN
= α · (Cs /CF ) · [(VRST − VT ) − (VSIG − VT )]
= α · (Cs /CF ) · (VRST − VSIG )

(2)

where α is the gain of the SF. As such, the VOUT removes the
dependence on VT for CIS in the optical mode.
B. CDS Readout for an ISFET
We add switches “ISFR”/“ISFS” as shown in Fig. 7 to realize the CDS for ISFET in pH mode. Other readout circuits
remain the same. The corresponding timing diagram is shown
in Fig. 6(b) and (c). The CDS readout for ISFET is performed
as follows.
As shown in Fig. 6(b), before loading solution with microbeads, “RST” is turned ON, and the reset voltage VRST is
stored at a sampling capacitor CSR by turning ON “SHR.” Meanwhile, “ISFR” is turned ON to force VPOS = VCM . As such, the
output of the amplifier is
VOUT1 = VOUTP − VOUTN
= α · (Cs /CF ) · (VRST − VT − VCM ).

(3)

Afterward the reset voltage level for the whole array is read
out and digitized by the 12-bit pipelined ADC at the next stage
and saved by the external storage.
As shown in Fig. 6(c), after loading solution with microbeads,
“ISFS” is turned ON to force VPOR = VCM . The amplifier output now is
VOUT2 = VOUTP − VOUTN
= α · (CS /CF ) · (VREF − VCM − VT − dV ), (4)

HUANG et al.: DUAL-MODE LARGE-ARRAYED CMOS ISFET SENSOR FOR ACCURATE AND HIGH-THROUGHPUT pH SENSING

where dV is the threshold voltage change caused by the chemical
reaction between the ion and the passivation layer, and VREF
is the voltage of the reference electrode. This output is also
converted by the ADC and readout to the external storage for
further digital processing.
As there is an equivalent passivation capacitor Cpass connected to the ISFET gate, the dc level of electrode VREF is
thereby not equal to the FD voltage. However, note that a reference electrode in the analyte solution determines the electric
potential of the bulk of the analyte solution, and always provides a fixed electrical reference. Therefore, the difference of
the VREF and the FD node can be considered as the dV . As
such, as long as the VT is subtracted, the dependence on VT for
the ISFET in the chemical mode can be removed.
As a result, we subtract the two outputs and obtain the difference by
VOUT1 − VOUT2 = α · (CS /CF ) · (VRST − VREF + dV )
(5)
which removes the dependence on VT for ISFET in the chemical
mode. Hence, CDS readout circuit measures each individual
ISFET pixel output voltage level before the chemical reaction,
and use this as a reference to calibrate the DNA sequencing
measurement data for higher accuracy.

2229

Fig. 8. Cross-sectional structure of the ISFET as modeled in Sentaurus TCAD.
The electron concentration during an ISFET operation is indicated by coloring.

shorter time. For DNA sequencing, sampling the signal at high
frequency relative to the time of the nucleotide incorporation
signal allows the signal averaging to improve the SNR.
V. RESULTS
A. ISFET Device Modeling

C. Global Amplifier
As for the global amplifier, the feedback capacitors CF are
adjustable among 1, 0.5, and 0.25 pF such that the gain CS /CF
can be selected among 1X, 2X, and 4X under different input
signal levels. Thus, the input
√ referred noise of the gain amplifier
has a reduction factor of G, where G is the closed-loop gain of
the column readout amplifier. The sensitivity or dynamic range
can then be improved. The amplifier utilizes a telescopic structure. AC simulation results show an open-loop gain of 68 dB
and bandwidth of 628 MHz. The high-gain-bandwidth product
(GBW) enables high-speed readout with 10 MHz columnwise
readout speed.
D. Pipelined ADC
The sensed signal by an ISFET-sensor array is digitized by
12-bit pipelined ADC before the final output. The ADC consists of sample/hold input stages, ten serially connected 1.5-bit
pipeline stages, and one 2-bit flash stage. The digital correction block creates a 12-bit output code by a redundant signed
digit. The 1.5-bit per-stage is chosen because of its immunity
to the offsets. A telescopic operational amplifier with a gain
boosting is chosen for high dc gain, high GBW, and fast settling time. The maximum differential nonlinearity is 0.44 LSB
and the maximum-integral nonlinearity is 0.61 LSB. The effective number of bits (ENOB) is 11.4 bits, and the signal-tonoise and distortion ratio (SNDR) is 70.35 dB. As such, the
whole row-readout time is 13 μs, including the pixel sampling,
amplification, and digitization. Therefore, for a 64 × 64 array,
the whole readout time for 64 rows is 64 × 13 μs = 0.832 ms
with a readout frame rate about 1/0.832 ms = 1200 frames/s.
Fast readout speed can enable us to capture a chemical image in a

To evaluate the dual-mode ISFET device fabricated by a standard CISprocess, we model an N-type ISFET with six metal layers using Synopsys Sentaurus TCAD (Technology ComputerAided Design), which is a suite of commercial TCAD tools that
simulates the fabrication, operation, and reliability of semiconductor devices. As the electrolyte cannot be directly modeled,
in the simulation, we change the concentration of the trapped
charge in polysilicon gate area to try to simulate the charge
change in polysilicon caused by the ion reaction on the surface
of the passivation layer. The charge change in the poly will result in the change of the threshold voltage VT of the ISFET. To
evaluate the effect of negative charge, i.e., donor, and positive
charge, i.e., acceptor, we choose VDS = 1 V with only donor or
accepter change in density. The addition of donors and acceptor
to semiconductor is similar to the process of adding acids or
bases to pure water and altering the balance between H+ an
OH− .
The cross-sectional structure of the ISFET modeled is shown
in Fig. 8. The electron concentration is indicated by coloring
corresponding to the bar graph on the right. As the results shown
in Fig. 9(a), when we increase the concentration of negative
charge donor from 1016 /cm−3 to 1040 /cm−3 with acceptors =
0, the VT has a corresponding linear reduction from 1.11 to
0.06 V. As in Fig. 9(b), when increasing the concentration of
a positive charge acceptor from 1016 / to 1036 /cm−3 with donor
= 0, the VT has a corresponding linear increase from 1.13 to
1.74 V. A natural logarithm scale for charge concentrations is
used. As such, although the electrolyte is not directly modeled,
the effect of changing the surface charge will cause the changes
in ISFET transfer characteristics and linearly modulates the
ISFET threshold voltage VT , which is the basic principle of
ISFET-based pH sensing.

2230

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

TABLE I
SPECIFICATIONS OF A DUAL-MODE SENSOR

Fig. 9. ISFET device simulation results showing the threshold voltage V T
change.

Parameters

Specifications

Process
Pixel Type
Pixel Size
Pixel Optical Sensing Area
Pixel Chemical Sensing Area
Array Size
Die Area
ADC ENOB
ADC SNDR
FPN
Frame Rate
Total Power Consumption

Standard TSMC 0.18-μm CIS
Dual-Mode (Image and Chemical)
10 μm × 10 μm
20.1 μm2 (Fill Factor = 20.1%)
22.3 μm2 (Fill Factor = 22.3%)
64 × 64
2.5 mm × 5 mm
11.4 bits
70.35 dB
0.3%
1200 frames/s
32 mA at 3.3V

Fig. 11. Correlated maps of distributed microbeads: (a) Contact images and
(b) pH values.
Fig. 10. (a) FPGA-based testing system setup. (b) Ion-image sensor with
liquid-friendly encapsulation with 3-D-printed plastic reservoir attached on the
chip PGA package. (c) Cross-sectional view of the encapsulated packaging
strategy. (d) Micrograph photo of the dual-mode sensor chip.

is shown in Fig. 10. The design specifications are summarized
in Table I.

B. Testing System Setup
The proposed dual-mode ISFET sensor is fabricated in a
standard TSMC 0.18-μm CIS process. After fabrication, the
chip is packaged in a 100-p-i-n grid array (PGA) package with a
size of 33.5 mm × 33.5 mm. As the experimental processes need
to be conducted in aqueous environments, proper encapsulation
of the sensor chip is necessary to protect the circuits. Thus, we
use an epoxy to encapsulate the whole chip with the sensing pixel
array area open only, as shown in Fig. 10(b) and (c). Meanwhile,
the bonding wires and bonding pads are also covered by epoxy.
To retain aqueous samples on the top of sensor chip, in addition,
a 3-D-printed plastic reservoir that just fits the PGA package is
mounted on the package with epoxy to fill the gap at all four
sides. The plastic reservoir is also designed to be able to fix the
Ag/AgCl reference electrode. The package chip is then mounted
on a specially designed printed circuit board (PCB) through a
100-p-i-n PGA socket. The PCB, which is further connected
with a Xilinx Virtex-6 XC6VLX240T FPGA demo board [31],
is designed to provide power supply and digital timing control
signals to the sensor chip. We measured the electrochemical
characteristics of the chip under the control of a MATLABbased (Mathworks, Natick, MA, USA) graphical user interface.
The chip micrograph with an architecture and a testing system

C. Measurement of a Correlated-Ion-Image Map
First, the correlated-contact image and pH map of microbeads
are shown in Fig. 11. The microbeads of 45-μm diameter are
used (Product# 07314-5, Polysciences, Warrington, PA, USA).
Note that we have not fabricated the microwell array on the top
of the image sensor die to correspond each microwell with an
ISFET pixel. Thus, a relatively larger microbead compared with
10-μm pixel size is selected such that the contrast of a shadow
imaging can be better. With the contact shadow imaging, the
image size of microbead takes up about a 5 × 5 pixel array area.
Due to the diffraction effect, the center pixels show darker intensity and the pixels near the boundary show lighter intensity. For
the proof-of-concept verification, the microbeads are first diluted and prepared in acid solution as they are ideally suited for
protein binding using passive adsorption techniques, and then
dropped onto the sensor surface to test the local pH changes.
The contact image determines the existence of microbeads and
provides their addressed distribution. The exposure time of the
contact imaging is 160 μs. The pH map is thereby locally associated with microbeads by pruning out those uncorrelated pH data.
Due to the diffusion effect, the pH map at microbead locations
show a pattern similar to normal distribution.

HUANG et al.: DUAL-MODE LARGE-ARRAYED CMOS ISFET SENSOR FOR ACCURATE AND HIGH-THROUGHPUT pH SENSING

2231

TABLE II
COMPARISON OF STATE-OF-THE-ART ISFET SENSORS
[33]

[34]

[35]

[36]

Process

Fig. 12. Measurement results: (a) pH sensitivity of a dual-mode ISFET sensor
and (b) the comparison with commercial pH meter for a bacteria (E. Coli) culture
solution with glucose at different time intervals.

5-μm
0.35-μm
0.35-μm
0.18-μm
Non-CMOS Modified
Standard
Standard
CMOS
CMOS
CMOS
Pixel Size 200 μm × 12.8 μm × 10.2 μm × 20 μm ×
200 μm
12.8 μm
10.2 μm
2 μm
Array Size 10 × 10
16 × 16
64 × 64
8×8
Frame
30 frames/s
–
100frames/s
–
Rate
Sensitivity
229
46
20
37
(mV/pH)
Dual
Mode

No

No

No

No

[37]

This Work

0.35-μm
0.18-μm
Standard
Standard
CMOS
CMOS
150 μm × 10 μm ×
150 μm
10 μm
8×8
64 × 64
6frames/s 1200 frames/s
57

Yes

26.2 (gain =
1) 103.8 (gain
= 4)
Yes

0.25 mV, respectively. The FPN is accordingly reduced from
4% down to 0.3%.
Finally, the comparisons with the state-of-the-art ISFET sensors are summarized in Table II. The proposed dual-mode sensor
shows the state-of-the-art results: 10-μm pixel pitch, 64 × 64
pixel array, fast frame rate of 1200 frames/s, and readout sensitivity of 103.8 mV/pH in a standard CIS process.
VI. CONCLUSION

Fig. 13. Measurement results: Spatial FFT of readout voltage variations (a)
without CDS and (b) with CDS readout.

D. Characterization of a Dual-Mode Sensor
To characterize the pH sensing capability of the dual-mode
sensor, the pH sensitivity is tested and the measurement results
are shown in Fig. 12(a). The pH of solution is changed by
adding HCL and NaOH. The pH readout sensitivity of ISFET
by a CIS process is measured as 26.2 mV/pH with amplifier gain
= 1 and as 103.8 mV/pH with amplifier gain = 4 as shown in
Fig. 12(a). The device sensitivity at gain = 1 is somewhat lower
than the commonly observed response of 45–56 mV/pH for
Si3 N4 [32], this can be due to the low-pressure chemical vapor
deposition (LPCVD) technique for Si3 N4 S at low temperature,
which generally cause low density and porous passivation layer.
It can be optimized by the LPCVD at a high temperature or do
additional depositions, which are still a standard CMOS process
[14].
The CMOS ISFET sensor chip is also calibrated by testing
the pH change of a bacteria (Escherichia coli) culture solution
at different time intervals and comparing with commercial tool.
By extracting the sample solution of the bacteria culture for
testing at 1- to 6-h time intervals, the measurement results by
the dual-mode sensor can correlate well with one commercial
pH meter (Checker, Hanna Instruments, RI, USA) in Fig. 12(b).
The comparison of readout voltage variations with and without CDS is shown in Fig. 13. After performing spatial FFT to
the readout voltages with respect to the addresses of the sensor
array, the mean and peak variations are reduced by 0.17 and

In this paper, a dual-mode CMOS ISFET sensor with a suppressed FPN for an accurate large-arrayed pH sensing is proposed and demonstrated with state-of-the-art results, targeted
for accurate and high-throughput DNA sequencing. With the
dual-mode pixel design to prune false pH value reporting by determining the existence of microbead with contact imaging; and
the CDS readout to suppress FPN for large-arrayed sensor, the
pH sensing accuracy can be significantly improved. Our future
work is to perform the actual DNA sequencing testing using the
proposed sensor, which requires fabricating the microwell array
on the sensor, and building the microfluidic system for sample
loading. We believe that the developed dual-mode CMOS ISFET sensor has great potential for the future personal genome
diagnostics.
REFERENCES
[1] P. Bergveld, “Development of an ion-sensitive solid-state device for
neurophysiological measurements,” IEEE Trans. Biomed. Eng., vol. 17,
no. 1, pp. 70–71, Jan. 1970.
[2] J. Bausells et al., “Ion-sensitive field effect transistors fabricated in
a commercial CMOS technology,” Sens. Actuators B, Chem., vol. 57,
pp. 56–62, Sep. 1999.
[3] P. Bergveld, “Thirty years of ISFETOLOGY what happened in the past
30 years and what may happen in the next 30 years,” Sens. Actuators B,
Chem., vol. 88, no. 1, pp. 1–20, Jan. 2003.
[4] C. Toumazou and P. Georgiou, “Piet Bergveld—40 years of ISFET technology: From neuronal sensing to DNA sequencing,” Electron. Lett.,
vol. 47, no. 26, pp. 7–12, Dec. 2011.
[5] J. M. Rothberg et al., “An integrated semiconductor device enabling nonoptical genome sequencing,” Nature, vol. 475, pp. 348–352, Jul. 2011.
[6] C. Toumazou et al., “Simultaneous DNA amplification and detection
using a pH-sensing semiconductor system,” Nature Methods, vol. 10,
pp. 641–646, Jun. 2013.
[7] A. Manickam et al., “A fully-electronic charge-based DNA sequencing
CMOS biochip,” in Proc. IEEE Symp. VLSI Circuits Dig. Tech. Papers,
Jun. 2012, pp. 126–127.

2232

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

[8] A. Pai et al., “A handheld magnetic sensing platform for antigen and
nucleic acid detection,” Analyst, vol. 139, no. 6, pp. 1403–1411, Dec.
2013.
[9] K. Venta et al., “Differentiation of short, single-stranded DNA homopolymers in solid-state nanopores,” ACS Nano, vol. 7, no. 5,
pp. 4629–4636, May 2013.
[10] M. Margulies et al., “Genome sequencing in microfabricated high-density
picolitre reactors,” Nature, vol. 437, pp. 376–380, Sep. 2005.
[11] E. R. Mardis, “Next generation DNA sequencing methods,” Ann. Rev.
Genom. Hum. Genet., vol. 9, pp. 387–402, Jun. 2008.
[12] A. Ahmadian and H. A. Svahn, “Massively parallel sequencing platforms using lab on a chip technologies,” Lab Chip, vol. 11, no. 16,
pp. 2653–2655, Apr. 2011.
[13] N. Pourmand et al., “Direct electrical detection of DNA synthesis,” Proc.
Nat. Acad. Sci. USA, vol. 103, no. 17, pp. 6466–6470, Apr. 2006.
[14] J. M. Rothberg et al., “Methods and apparatus for measuring analytes,”
U.S. Patent 20 100 301 398, Dec. 2, 2010.
[15] B. E. Stine et al., “Analysis and decomposition of spatial variation in
integrated circuit processes and devices,” IEEE Trans. Semicond. Manuf.,
vol. 10, no. 1, pp. 24–41, Feb. 1997.
[16] K. Yonemoto and H. Sumi, “A CMOS image sensor with a simple fixedpattern-noise-reduction technology and a hole accumulation diode,” IEEE
J. Solid-State Circuits, vol. 35, no. 12, pp. 2038–2043, Dec. 2000.
[17] M. J. Milgrew and D. R. S. Cumming, “Matching the transconductance
characteristics of CMOS ISFET arrays by removing trapped charge,” IEEE
Trans. Electron Devices, vol. 55, no. 4, pp. 1074–1079, Apr. 2008.
[18] P. Georgiou and C. Toumazou, “CMOS-based programmable gate ISFET,”
Electron. Lett., vol. 44, no. 22, pp. 1289–1290, Oct. 2008.
[19] C. Z. D. Goh et al., “A CMOS-based ISFET chemical imager
with auto- calibration capability,” IEEE Sensors J., vol. 11, no. 12,
pp. 3253–3260, Dec. 2011.
[20] P. A. Hammond et al., “Design of a single-chip pH sensor using a
conventional 0.6-μm CMOS process,” IEEE Sensors J., vol. 4, no. 6,
pp. 706–712, Dec. 2004.
[21] X. Huang et al., “A 64 × 64 1200 fps CMOS ion-image sensor with suppressed fixed-pattern-noise for accurate high-throughput DNA sequencing,” in Proc. IEEE Symp. VLSI Circuits Dig. Tech. Papers, Jun. 2014, pp.
109–110.
[22] J. Guo et al., “Portable resistive pulse-activated lens-free cell imaging
system,” RSC Adv., vol. 4, pp. 56342–56345, Oct. 2014.
[23] X. Huang et al., “A contact-imaging based microfluidic cytometer with
machine-learning for single-frame super-resolution processing,” PLoS
ONE, vol. 9, no. 8, p. e104539, Aug. 2014.
[24] H. Ji et al., “Contact imaging: Simulation and experiment,” IEEE Trans.
Circuits Syst. I, Reg. Papers, vol. 54, no. 8, pp. 1698–1710, Aug. 2007.
[25] A. Ozcan and U. Demirci, “Ultra wide-field lens-free monitoring of cells
on-chip,” Lab Chip, vol. 8, no. 1, pp. 98–106, Jan. 2008.
[26] L. Shepherd and C. Toumazou, “Weak Inversion ISFETs for ultra-low
power biochemical sensing and real-time analysis,” Sens. Actuators B
Chem., vol. 107, no. 1, pp. 468–473, May 2005.
[27] S. Martinoia and G. Massobrio, “A behavioral macromodel of the ISFET
in SPICE,” Sens. Actuators B Chem., vol. 62, no. 3, pp. 182–189, Mar.
2000.
[28] Y. Liu et al., “An extended CMOS ISFET model incorporating the physical design geometry and the effects on performance and offset variation,”
IEEE Trans. Electron Devices, vol. 58, no. 12, pp. 4414–4422, Dec. 2011.
[29] E. R. Fossum and D. B. Hondongwa, “A review of the pinned photodiode
for CCD and CMOS image sensors,” IEEE J. Electron Devices Soc.,
vol. 2, no. 3, pp. 33–43, May 2014.
[30] A. J. P. Theuwissen, “CMOS image sensors: State-of-the-art,” Solid State
Electron., vol. 52, no. 9, pp. 1401–1406, Sep. 2008.
[31] Xilinx Virtex-6 XC6VLX240T FPGA. (2014, Oct.). [Online] Available:
http://www.xilinx.com/products/boards-and-kits/EK-V6-ML605-G.htm
[32] D. L. Harame et al., “Ion-sensing devices with silicon nitride and
borosilicate glass insulators,” IEEE Trans. Electron Devices, vol. 34,
no. 8, pp. 1700–1707, Aug. 1987.
[33] T. Hizawa et al., “Fabrication of a two-dimensional pH image sensor
using a charge transfer technique,” Sens. Actuators B Chem., vol. 117,
no. 2, pp. 509–515, Oct. 2006.
[34] M. J. Milgrew et al., “A 16 × 16 CMOS proton camera array for direct
extracellular imaging of hydrogen-Ion activity,” in Proc. IEEE Dig. Tech.
Papers Solid State Conf., Feb. 2008, pp. 590–638.
[35] B. Nemeth et al., “High-resolution real-time ion-camera system using a
CMOS-based chemical sensor array for proton imaging,” Sens. Actuators
B Chem., vol. 171, pp. 747–752, Sep. 2012.

[36] W. P. Chan et al., “An integrated ISFETs instrumentation system in
standard CMOS technology,” J. Solid State Circuits, vol. 45, no. 9,
pp. 1923–1934, Sep. 2010.
[37] C. Z. D. Goh et al., “Live demonstration: A CMOS-based lab-on-chip
array for combined magnetic manipulation and opto-chemical sensing,”
in Proc. IEEE Int. Symp. Circuits Syst., May 2011, pp. 1997–2001.

Xiwei Huang (S’10–M’15) received the B.Eng. degree from the Beijing Institute of Technology, Beijing, China, in 2009, and the Ph.D. degree in electronic engineering from Nanyang Technological University, Singapore, in March 2015.
Since May 2014, he has been with Hangzhou Dianzi University, Hangzhou, China, as an Assistant
Professor. His research interests include CMOS multimodal sensor for personalized biomedical diagnostics, including CMOS image and ISFET sensor design, and microfluidic on-chip imaging system.

Hao Yu (M’06–SM’14) received the B.S. degree
from Fudan University, Shanghai, China, and the
Ph.D. degree from the Electrical Engineering Department, University of California, Berkeley, CA, USA.
He was a Senior Research Staff with Berkeley Design Automation. He has been an Assistant Professor
with the School of Electrical and Electronic Engineering, Nanyang Technological University, Singapore,
since October 2009. His research interests include 3D-IC and RF-IC at nanotera scale.
Dr. Yu received the Best Paper Award from the
ACM TODAES in 2010, the Best Paper Award nominations in DAC 2006, ICCAD in 2006, and ASP-DAC in 2012, the Best Student Paper (advisor) Finalist
in SiRF 2013 and RFIC 2013, and the Inventor Award in 2008 from semiconductor research cooperation. He is an Associate Editor and a Technical Program
Committee Member for a number of journals and conferences.

Xu Liu (M’10) received the B.S. and M.S. degrees
in electronics engineering from the Huazhong University of Science and Technology, Wuhan, China,
in 2007 and 2009, respectively, and the Ph.D. degree
in electrical and computer engineering from the National University of Singapore, Singapore, in 2015.
He is currently with Nanyang Technological University, Singapore. His research interests include
biomedical IC design, biosensors, and mixed-signal
IC design.

Yu Jiang received the B.Eng. degree in electronics
and information engineering from Anhui University,
Anhui, China, and the M.S. degree in electronics science and technology from Fudan University, Shanghai, China, in 2011 and 2014, respectively.
She is currently a Research Associate with
Nanyang Technological University, Singapore. Her
research interests include biosensor and image-sensor
design for biomedical applications.

HUANG et al.: DUAL-MODE LARGE-ARRAYED CMOS ISFET SENSOR FOR ACCURATE AND HIGH-THROUGHPUT pH SENSING

Mei Yan received the Ph.D. degree from the State
University of New York at Stony Brook, Stony Brook,
NY, USA, in 2004.
During her Ph.D. study, she worked with scientists in Brookhaven National Lab, and developed the
world’s first linear digital CMOS image sensor for
barcode scanner. Then, she was with Aptina Imaging for six years, where she was involved in more
than ten advanced products design. In October 2010,
she joined Nanyang Technological University, Singapore, as a Research Fellow. Her research interests
include building innovated CMOS-based biomedical imaging system by integrating image-sensor design with last advanced device development, such as
MEMS, microfluidic, and ISFET sensor.

2233

Dongping Wu received the Ph.D. degree from the
Department of Microelectronics and Information
Technology, Royal Institute of Technology, Stockholm, Sweden, in 2004.
He is currently a Professor with the School of Microelectronics, Fudan University, Shanghai, China.
His research interest includes nanoscale semiconductor devices, semiconductor sensors, and bioelectronics.

