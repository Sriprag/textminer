IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 4, JULY 2015

1443

A Method of Detecting Heartbeat Locations in the
Ballistocardiographic Signal From the Fiber-Optic
Vital Signs Sensor
Mariusz Krej, Łukasz Dziuda, Member, IEEE, and Franciszek Wojciech Skibniewski

Abstract—We present a flexible, easy-to-expand digital signal
processing method for detecting heart rate (HR) for cardiac vibration signals of fiber Bragg grating (FBG) sensor. The FBG-based
method of measuring HR is possible to use during the magnetic
resonance imaging procedure, which is its unique advantage. Our
goal was to design a detection method with plurality of parameters
and to subject these parameters to genetic algorithm optimization
technique. In effect, we arrived at a method that is well able to deal
with much distorted signals with low SNR. We proved that the
method we developed allows automatic adjustment to the shape of
the waves of signal carrying useful information about the moments
of heartbeat. Thus, we can easily adapt our technique to the analysis
of signals, which contains information on HR, from sensors employing different techniques of strain detection. The proposed method
has the capabilities of analyzing signals in semi-real-time (online)
with beat-to-beat resolution, significantly low delay, and negligible
computational power requirements. We verified our method on
recordings in a group of seven subjects. Verification included over
6000 heartbeats (82 min 47 s of recordings). The root-mean-square
error of our method does not exceed 6.0 bpm.
Index Terms—Ballistocardiographic (BCG) signal, fiber Bragg
gratings (FBGs), genetic algorithms (GAs), heart rate (HR),
parallel computing.

I. INTRODUCTION
EART rate (HR) is one of the fundamental physiological
parameters, essential for the monitoring and diagnosis of
patients. Some conditions, for example, a magnetic resonance
imaging (MRI) environment, limit the use of conventional HR
monitors due to their vulnerability to strong electromagnetic
fields and the possibility of introducing interferences to the
imaging [1]. However, the latest study [2] shows that HR trends
may be crucial in predicting symptoms associated with claustrophobia, which often occurs in patients examined with the use
of equipment limiting their movements such as MRI scanners
[3]–[5]. In general, HR indicators are of considerably higher
values in persons experiencing claustrophobic episodes, e.g.,
anxiety, panic, and hyperventilation, in comparison with those
who do not experience such discomforts. Usually, already before a claustrophobic patient is placed inside the MRI tube,

H

Manuscript received June 11, 2014; revised October 7, 2014 and December 4, 2014; accepted January 9, 2015. Date of publication January 23, 2015;
date of current version July 23, 2015. This work was supported by the
resources of the Program for National Defense and Security under Project
DOBR/0052/R/ID1/2012/03.
The authors are with the Military Institute of Aviation Medicine, Warsaw
01-755, Poland (e-mail: mkrej@wiml.waw.pl; ldziuda@wiml.waw.pl; fskib@
wiml.waw.pl).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2392796

his/her HR values begin to rise and can reach dangerous levels
during the examination. Therefore, continuous, online monitoring of trend changes in the patient’s HR shortly before and
during examination can be crucial in predicting and assessing
the possible occurrence of claustrophobia closely related to the
circumstances of examination.
There are many other patient categories that require HR monitoring during MRI procedures, e.g., pediatric patients, disabled
patients, sedated or anesthetized patients, critically-ill or highrisk patients, patients developing reactions to contrast media,
as well as all patients who are unable or may not be able to
communicate or to use the alarm button [6]. Contrary to the
electronic transducers, fiber-optic sensors are immune to electromagnetic fields used in MRI, safe for the patient, and do
not influence the imaging quality [7]–[10]. These advantages,
together with the ability of the fiber-optic sensors to detect
miniature deflections (e.g., those caused by heart-induced body
movements), renewed the interest in recording ballistocardiographic (BCG) signal, [11], particularly in the context of patient
monitoring during MRI examination [12].
Ballistocardiography has obvious advantages such as noninvasiveness, electrically contactless, as well as simple design of
measurement systems. However, BCG signal analysis induces
many problems. The main reason for this is the presence of
motion artifacts in the measured signals. These artifacts are
associated with the patient’s body movements, as well as artifacts originating from the environment in applications such as
examination of vehicle operators. The number of articles currently published considering the problem of BCG signal analysis
[13]–[16] reveals the topicality and novelty of the subject.

II. MEASUREMENT METHOD
The movements of the patient’s body including the mechanical activity of the heart are the causes of force, pressure, and
strain exerted on the sensing element. There are a number of
fiber-optic strain gauges designed to monitor vital signs, of
which the most popular are interferometers [17], micro- [10]–
[11] and macrobending sensors [18], and fiber Bragg gratings
(FBGs) [18], [19]. Many researchers took a liking to the FBGs
due to their spectral encoding, easy multiplexing, and selfreferencing capabilities [20]. The authors have used the in-house
constructed FBG-based sensor to acquire BCG signal from an
MRI patient’s body [19]. Fig. 1(a) shows a photograph of the
sensor; an elastic Plexiglas board with bonded FBG element is
placed on the MRI couch behind the back of the patient close

2168-2194 © 2015 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1444

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 4, JULY 2015

frequency that depends on the grating period Λ [9] modulated
by strains transmitted by the board to the FBG [9]. The value of
the resonant frequency is measured by an interrogation system.
We used an sm130-700 instrument manufactured by Micron
Optics [22]; this is an optical scanner of frequency with a function of automatic seeking resonant frequency of the grating. A
band of 1510–1590 nm was scanned 1000 times per second with
the peak-to-peak resolution of 1 pm. The instantaneous spectral
value of the resonant frequency of the FBG-based sensor can be
calibrated in terms of heartbeat readings. Due to the so-called
self-reference capability of FBGs, i.e., a return to the referential
values of spectral parameters after achieving the initial conditions [23], the sensor does not require additional calibration.
The mechanical activity of the heart modulates the resonant
frequency, but the cardiac activity is only one of the several
sources of strains exerted on the FBG, such as respiration, any
other body movements, or displacement of the track table during
the MRI scanning process [7]. Therefore, we have developed a
method to extract the heart-induced artifacts in the sensor signal
as well as to provide moments of their occurrence. This allows
determining a series of heartbeat time intervals (i.e., tachogram)
and consequently, monitor the HR trace.
III. DETECTION METHOD

Fig. 1. Photograph of (a) fiber-optic vital signs sensor and (b) sensor in the
MRI system.

to the heart as shown in Fig. 1(b). The Plexiglas board is of
209 cm2 in area and as thin as 1.5 mm and can follow the contour of the body fragment when the patient lies on it. At the time,
the FBG element is subjected to be strained due to body movements including those induced by heartbeats. Thus, the board
is a medium reflecting body movements and converting them
into strains (elongations/contractions) measurable by the FBG.
A thin layer of epoxy adhesive is applied over the entire length
of the grating. This protects the bare fiber against moisture and
enables for transmitting strains to the FBG.
It has been demonstrated that the level of heart-induced strains
is much less than the physical strength of the sensor [7], i.e.,
8000 με [8]. Other body movements, e.g., sudden sneezes or
coughs [9], as well as jerks of the MRI track table [19] do not
pose a threat to the sensor, as the Plexiglas board is protected
against large deformations by the hardness of the MRI couch,
on which only a thin layer (∼1 cm) of soft polyurethane foam
is put to ensure comfort for the patient and allow the board to
bend.
A Bragg grating can be considered as a frequency filter [21].
Depending on the measuring system, maximum or minimum
attenuation of this filter occurs for signals with the resonant

The proposed technique uses signals from the sensor, in which
the measurand is represented by means of wavelength readings
rather than frequency readings. The wavelength domain is the
most common way of analyzing the response of an FBG subjected to strain [12]. Thus, the Bragg wavelength value outlines
the BCG signal shape as shown in Fig. 2. The peak of ventricular ejection phase exerts the greatest strain on the sensor, which
appears in the ballistocardiogram as a series of the J wave peaks
[24], [25], indicated by arrows in Fig. 2. The relatively high
value of noise with respect to the values of the signal presented
in Fig. 2 is the result of the resolution of the interrogator system
which is 1 pm while usable peak-to-peak values of the signal
are about 6 pm.
A. Detection Function
For detecting heartbeat positions, a specially prepared signal
of the detection function is analyzed rather than the source signal
from the sensor. The detection function enhances the signal
characteristics associated with the heartbeats. The trace of the
detection function is determined by software implementing a
cascade of digital filters. Band-pass filter, quadratic function,
and low-pass filter in this sequence are used [26], [27].
By using the aforementioned procedure, the algorithm avoids
errors introduced by the impulse noise and fluctuations in the
level of the signals originating from the stopband of filters. This
approach also allows adjusting the characteristics of the filters
to the shape of the signal characteristic waves corresponding
to the heartbeats and thus, to the spectrum of the analyzed signal. Therefore, the same algorithm can be adapted for analyzing
amplitude-modulated BCG signals originating from sensors employing different measurement methods (e.g., electromechanical films or piezoelectric transducers) [28]. The parameters of

KREJ et al.: METHOD OF DETECTING HEARTBEAT LOCATIONS IN THE BALLISTOCARDIOGRAPHIC SIGNAL FROM THE FIBER-OPTIC

Fig. 3.

Fig. 2.

Example of the input signal for the detection method.

the utilized filters are part of a set of values being subjected to
the optimization process.
B. Detecting Local Maxima
The next step of operation of the detection algorithm is to
determine the time of occurrence of the local extremes in the
signal, which may potentially be used as the characteristic moments sourced by the heart. A given value of the signal is classified by the algorithm as a potential distinctive moment if it
is the maximum value of the signal for the time interval whose
center falls at the time of this value. The width of this interval
is one of the parameters of the algorithm being part of the set of
values subjected to the optimization. Fig. 3 shows a portion of
the detection function signal with examples of markers set at the
positions of the found maxima (yellow) and markers of maxima classified as characteristic moments (green). The frames
indicate widths of the maxima search windows.
For each subsequent sample of the signal, it is verified whether
it occurs in the characteristic time. This verification is based on
the analysis of samples in two windows of the same size: 1) a
window preceding the analyzed sample; and 2) a window that
follows after the sample. We assume that the searched sample
is an extreme if the maximum values for both windows fall on
the mutual point.
C. Correcting Local Maxima Series
In the later stage of the method, algorithms improving the
sequence of the potential characteristic moments are applied.

1445

Examples of markers set at the found maxima.

These algorithms, hereinafter referred to as the correctors, are
interchangeable and customizable elements of the processing.
A number of correctors have been developed. In the field of
software engineering, these correctors have been implemented
as a system of decorator classes [29]. Each corrector receives
the incoming stream of maxima, processes them, and sends the
output of the processed extremes stream. This processing may
involve both generation and filtering of the maxima. The proposed method is capable of analyzing the signal online. The
design comprises a chain of correctors; each of them that independently processes the stream of items is determined by the
requirement of the method’s ability to act as a semi-real-time
digital signal processing element. The presented approach employs the following correctors:
1) classifying corrector,
2) averaging corrector, and
3) corrector of gaps.
1) Classifying Corrector: The corrector accumulates the incoming stream of times of local maxima from the time range
with a specified width. This width belongs to the parameters that
are the subject of optimization. Then, a set of values identifying
a potential imperfection of the maxima for each of the collected extremes is assigned. Subsequently, these characteristics
are multiplied by a set of weights selected in the optimization
process, and summed. The classifier selects the maximum with
the lowest cumulative imperfection and forwards it for further
processing.
Designation of many of these features depends on the value
of the JJ interval. This value is defined as the interval between
the analyzed center of the wave, tn , and the former one, tn −1
classified as artifact derived from the heartbeat, i.e., ventricular
ejection, given by
JJn = tn − tn −1 .

(1)

The following features of the incoming maxima are determined by the classifying corrector.
1) The ratio of the local maximum value to the average of N
previously selected local maxima values, where N is the
parameter subjected to optimization.

1446

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 4, JULY 2015

2) The ratio of the JJ interval of the current maximum to the
average JJ interval between M selected earlier extremes,
where M is the parameter subjected to optimization.
3) The current JJ interval, used to prevent unnecessary skipping of the maxima, although the share of such behavior
through a system of weights is selected by optimization.
4) The current interval length exceeding beyond the acceptable range. We assumed the value of 0.25 s (HR =
240 bpm) as the minimum of the interval and the value of
2 s (HR = 30 bpm) as the maximum of the interval. This
range is intentionally wider than what is generally used in
the physiology.
5) Deviation of values of consecutive intervals, ΔJJn =
|JJn − JJn −1 |, beyond the acceptable range (ΔJJm ax =
30bpm).
6) The value of relative change of consecutive intervals,
δJ J n , given by
δJ J n =

|JJn − JJn −1 |
.
JJn

(2)

2) Averaging Corrector: This corrector involves replacing
the position of maximum tn with the center of positions of its
neighbors according to
tn =

tn +1 − tn −1
.
2

(3)

From the stream of incoming maxima, these are modified,
for which the value of relative change of consecutive intervals,
δJ J n , determined according to (2), exceeds the limit parameter.
This parameter is also included in the set of values subjected to
optimization.
3) Corrector of Gaps: The purpose of the next corrector is to
fill the gaps appearing in the detected maxima stream. Similar
to the averaging corrector, the logic of the corrector of gaps is
sensitive to relative change of consecutive intervals, δJ J n , determined according to (2), exceeding the limit parameter, which
is also a part of the set of values subjected to optimization. The
second value, which is observed by the corrector, is the HR and
the fact that its value exceeds the acceptable range (similar to
the classification corrector). Exceeding the limit values in the
incoming stream of maxima is regarded as the beginning of the
gap. The return of parameters to the acceptable ranges means
the end of the gap.
The given time of a detected gap is analyzed to detect a
new set of heartbeat positions. The first task of the algorithm
detecting position of gaps is to search local maxima with a
narrow window, i.e., 0.1 s. Narrow windows generate large sets
of maxima. This logic comes down to analysis of an array of
detected local maxima to find a new set of characteristic wave
centers that will fill the given gap. The number of positions to
insert is the input variable of a procedure, which aims to find
the potential set of new maxima dividing a gap.
In subsequent stage, the number of positions for inserting is
increased by 1 from 1 until it reaches the value equal to the total
number of available extremes. For each number of the positions
to insert, the set of maxima dividing gap is determined, and then
the variability of the HR signal corresponding to a given layout

is calculated. The algorithm looks for a layout of maxima, which
corresponds to the smallest variability of the HR signal.
The procedure of finding a set of extremes filling a gap with
a given number of positions in the first step divides the gap
into subranges of equal length. Then, in the array of previously
found maxima, the positions nearest to the edges of subranges
are searched. In the following steps, each maximum in the set
is replaced by the maximum nearest to the averaged time of its
closest neighbor maxima. This operation is repeated multiple
times until the system of chosen maxima ceases to change.
D. Optimization
For optimizing the parameters of the detection method, the
genetic algorithm (GA) has been implemented. In the implementation of this method, a .Net platform and C# programming
language have been applied. The reason was the possibility of
using the computing power of the grid of multicore computers.
Along with version 4 of the .Net platform, parallel computing library Microsoft Parallel Extensions (PFX) was introduced
[30]. This is a managed library of parallelization of tasks. Its
basic elements are Parallel LINQ (PLINQ) and Task Parallel Library (TPL). PLINQ supports data parallelism wherein the set
of tasks is executed simultaneously on the different subranges of
data. The method of implementation is based on the technique of
integrated query language, LINQ. TPL supports task parallelism
and provides parallelized versions of the Foreach and For loops.
The library supports the user in tasks such as management of
threads of operating system used to perform calculations.
The idea of GAs has been derived from the theory of evolution. The techniques inspired by natural phenomena are, in
particular, mutation, inheritance, selection, and crossing. In a
GA, the population (i.e., a set of solutions) stored as a sequence
of genes (genome), evolves toward better solutions pointed by
the fitness function [31].
In the presented approach, the objective of the optimization
is finding an optimal set of parameters of heartbeat detection
method, which analyzes signals coming from the FBG-based
sensor. The set of these variables creates a virtual genome. The
most common way to represent variables in the genome is binary
encoding. It is a natural coding method for integer parameters.
For values that have the nature of real numbers, quantization
or bit representations of floating point numbers can be applied.
In the presented optimization problem, some variables are integers, and some are real numbers. Due to the predominance
of the parameters stored as real numbers, direct floating point
representation of parameters has been applied. This means that
the described variation of the evolutionary algorithm represents
real-valued GA [32].
During the search for the optimal solution with the use of
evolutionary algorithms for each individual genome of population, fitness function is computed for determining the probability of reproduction. The choice of individuals who will
participate in the reproduction is the selection process. There
are several known selection schemes. In the presented implementation, stochastic remainder selection without replacement
has been applied [33]. Assuming that the expected number of

KREJ et al.: METHOD OF DETECTING HEARTBEAT LOCATIONS IN THE BALLISTOCARDIOGRAPHIC SIGNAL FROM THE FIBER-OPTIC

1447

TABLE I
RESULTS OF EVALUATION OF THE PROPOSED METHOD
Subject no.
Rec. time (min:s)
Beats count
Mean HR (bpm)
SD (bpm)
RMSE (bpm)
RMS of relative error (%)
Mean error; bias (bpm)

1

2

3

4

5

6

7

8

Total

9:34
783
82.3
6.6
6.7
8.2
–1.4

10:52
748
69.0
4.7
4.8
6.7
–0.5

10:48
793
73.4
4.3
3.2
8.1
–0.3

10:26
645
62.3
6.6
4.8
7.6
0.1

10:42
776
72.6
4.7
2.9
4.1
–0.3

10:43
675
63.2
5.3
5.9
9.9
–0.8

9:49
587
59.8
3.6
3.9
6.2
–0.4

9:54
1087
110.0
6.7
9.7
7.1
–0.9

82:47
6094
76.8
17.7
6.0
7.4
–0.6

TABLE II
PARAMETERS SUBJECTED TO OPTIMIZATION AND THEIR OPTIMAL VALUES
Parameter

Optimal value

Low cutoff frequency of band bass filter
High cutoff frequency of band bass filter
Cutoff frequency of low-pass bass filter
Half-width of the window of local maxima detection algorithm
Width of interval of which the classifying corrector selects local maxima for comparison
Number of values of maxima, N, averaged for estimation a feature (a) of maximum determined by classifying corrector
Number of intervals, M, averaged for estimation a feature (b) of maximum determined by classifying corrector
Weight for component (a) criterion for classifying corrector
Weight for component (b) criterion for classifying corrector
Weight for component (c) criterion for classifying corrector
Weight for component (d) criterion for classifying corrector
Weight for component (e) criterion for classifying corrector
Weight for component (f) criterion for classifying corrector
Limit value of relative change of consecutive intervals, δ J J n , of averaging corrector
Limit value of relative change of consecutive intervals, δ J J n , of corrector of gaps

4.72491 Hz
29.51572 Hz
6.93891 Hz
0.185 s
4.8 s
19
13
4.42746
4.68384
0.83594
0.37800
7.41111
9.21850
0.1515
1.0687

copies of each solution, ei , is given by

where fi is the value of fitness of ith genome, and P is the
number of genomes in population. In this selection scheme,
each individual is copied as many times as is the integer part of
ei . The fractional part of ei is the probability of selection of an
individual one more time.
The creation of the descendants of individuals of the population relies on crossing their genomes. Special variants of the
arithmetic crossing operation are proposed for the GA [31],
wherein the genes of the descendants, z1 , and, z2 , are the sum
of ancestral genes x and y according to

Another important mechanism of GA is mutation. Mutation
is one of the ways to maintain genetic diversity of a population,
which enables one to avoid premature convergence of the algorithm. Mutation involves the introduction of random gene values
into the population. It is carried out with a certain probability,
which is a very important GA parameter. We used mutation operator based on a standard normal distribution and we applied a
probability of mutation equal to 0.05.
In the presented GA application, scaling of the fitness function
was also applied. We used linear scaling and sigma truncation.
Linear scaling prevents premature convergence of a population
to one of the local maxima, which can result in overlooking
the global maximum. The idea of scaling is based on a linear
transformation of fitness given by

z1 = x(1 − α) + y(α)

(5)

f  = af + b

z2 = x(α) + y(1 − α)

(6)

ei =

1
P

fi
P
j =1

fj

(4)

where α: 0 ࣘ α ࣘ 1.
However, the performed tests have shown that discrete crossing operation (i.e., α = 1 or α = 0) with one crossing point is
best suited for the applied configuration of GA.
Given two parents {x1 , x2 , . . . , xn } and {y1 , y2 , . . . , yn },
split point position, k, is picked stochastically. Then, the first
of the descendants will take the form (7), and the other one will
take the form (8)
{x1 , x2 , . . . , xk −1 , yk , . . . , yn }

(7)

{y1 , y2 , . . . , yk −1 , xk , . . . , xn } .

(8)

(9)

where a and b are the values selected so as the fitness of the
best individuals is scaled into the mean fitness of population
multiplied by an empirically chosen factor. At the same time,
the fitness value of average individuals remains unchanged. In
typical applications, the multiplication factor is a number of the
range 1.2 to 2; we assumed the value of 2.
To avoid problems with negative values of fitness function,
linear scaling was preceded by sigma truncation scaling, in
which the primary value of fitness function is moved toward
lower values according to
f  = f − f¯ + cσ

(10)

1448

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 4, JULY 2015

where c is a number of the range 1–3, f¯ is the average value of
fitness of population, and σ is the standard deviation of fitness
of population; we assumed c to be equal to 2.
An important aspect of the optimization using GAs is also the
fitness function. Often, this function cannot directly constitute
one of the indicators describing the objective of optimization.
The fitness has limitations such as nonnegativity and growth
toward better solutions.
After a series of tests, we have developed the following procedure of determining the base coefficient of fitness function, Ie .
Both irregularly sampled HR signals, that is, one subjected to
analysis and the reference signal, are interpolated; the integral of
absolute difference of these signals is determined according to
 T
Ie =
|HR(t) − HRr ef (t)| dt
(11)
0

where T is the duration of the signal.
In practice, a numerical approximation of the previous integral is computed. For this purpose, both the interpolated signals
are equally sampled at a frequency of 10 Hz. Finally, the value
of fitness function is determined as follows:


ln (1 + Ie )
f = max 0, 1 −
(12)
ln (1 + CT )
where C is a constant equal to 60 bpm.
Due to the use of filtration as an element of the detection
method and subjecting the filter parameters to the optimization
process, it is necessary to design the digital filter in the process
of calculations. For this purpose, we used an analytical software
package Matlab with Matlab Builder NE toolbox, which allowed the integration of components developed in Matlab with
application created for the .Net platform.
The dataset used in the optimization included nine 5-min
registrations in a group of six male and three female subjects.
The study was conducted in stationary conditions. The examined subjects were sitting on a chair with a sensor placed on
the back seat. An ECG recorder was used during the study to
determine the reference positions of heartbeats. Optimization
was performed using a population of 64 genomes. A full list of
variables subjected to optimization with their optimal values is
presented in Table I.
Calculations were performed on three Intel Core i7-2600 processor computers with four cores, i.e., eight threads, each. The
genome chosen for verification was obtained in 701 generation
after 42 h of computation.
IV. VERIFICATION
A verification study was carried out on a group of eight subjects (six males and two females). Each of the experiments included simultaneous recording of the FBG sensor-based signal
and ECG signal. The reference positions of heartbeats were determined from the R waves of ECG. Verification included over
6000 heartbeats. The total acquisition time was 82 min 47 s.
Table II shows the root-mean-square error (RMSE) for each
study separately as well as other performance indexes of the
algorithm, including root-mean-square (RMS) of relative error.
The RMSE reached a value of 6.0 bpm corresponding to RMS
of relative error ratio of 7.4%.

Fig. 4. Example of the HR traces obtained in subjects #5 and #8 using the
proposed method (black) and compared with the reference HR (gray).

Fig. 5.

Bland–Altman plot for the obtained HR samples.

Fig. 4 shows an example of a comparison of HR signals obtained from a recording in subjects #5 and #8, with the reference
HR signal. Most of the time, the signals being compared overlap; however, in certain moments, the differences occur due to
faults of the method, which are caused by movement artifacts
in the source signal.
The analysis of accuracy of the method was made using the
Bland–Altman plot shown in Fig. 5, in which the differences between gained HR values and the reference signal values are plotted against their averages. The confidence interval for the error
of the method is <–12.28 bpm; 11.04 bpm> with a mean error of
–0.62 bpm. The graph shows no significant correlation of errors
with the HR; in addition, bias of the method is negligibly small.
Concentration of points in the lower range of the HR values
results from greater number of samples obtained in this range.
V. CONCLUSION
We have reported a method for detecting the HR trace from the
BCG signal acquired by the MRI-compatible fiber-optic sensor.

KREJ et al.: METHOD OF DETECTING HEARTBEAT LOCATIONS IN THE BALLISTOCARDIOGRAPHIC SIGNAL FROM THE FIBER-OPTIC

The detection of heartbeat location in the ballistocardiogram is
a complex task, mainly due to small levels of the useful waveform amplitude in the source signal in relation to the noise and
resolution of the measurement system. According to the previously reported results, the authors estimate the signal-to-noise
ratio at 3.37 dB [19]. At the same time, the usable peak-to-peak
values are approximately 6 pm, whereas the resolution of the interrogation system is 1 pm. Nevertheless, the proposed method
for establishing the detection procedure with multiple parameters subjected to optimization allowed us to achieve satisfactory
results for the automatic detection of heartbeat positions.
The method, due to its flexible design, is easy to expand,
in particular, for the ability to add correctors easily. Currently,
we are considering supplementing the method with a Bayesian
classifier corrector, described by Brüser et al. [16]. Future work
will also include the adaptation of the method to the development
of a sensor system based on a matrix of FBGs. This feature will
enable signal acquisition from multiple body locations and thus
improve the measurement reliability.
REFERENCES
[1] C. T. Results. (2008, Sep. 20). Optical sensors make MRI scans
safer. Sci. Daily [Online]. Available: www.sciencedaily.com/releases/
2008/09/080918091609.htm
[2] A. Pittig, J. J. Arch, C. W. Lam, and M. G. Craske, “Heart rate and
heart rate variability in panic, social anxiety, obsessive–compulsive, and
generalized anxiety disorders at baseline and in response to relaxation
and hyperventilation,” Int. J. Psychophysiol., vol. 87, no. 1, pp. 19–27,
Jan. 2013.
[3] J. C. Meléndez and E. McCrank, “Anxiety-related reactions associated
with magnetic resonance imaging examinations,” J. Amer. Med. Assoc.,
vol. 270, no. 6, pp. 745–747, Aug. 1993.
[4] S. A. Sarji, B. J. J. Abdullah, G. Kumar, A. H. Tan, and P. Narayanan,
“Failed magnetic resonance imaging examinations due to claustrophobia,”
Australasian Radiol., vol. 42, no. 4, pp. 293–295, Nov. 1998.
[5] L. M. Harris, J. Robinson, and R. G. Menzies, “Predictors of panic symptoms during magnetic resonance imaging scans,” Int. J. Behav. Med.,
vol. 8, no. 1, pp. 80–87, 2001.
[6] Shellock R & D Services, Inc., and F. G. Shellock. (2014).
Monitoring Patients in the MRI Environment [Online]. Available:
http://www.mrisafety.com/SafetyInfov.asp?SafetyInfoID=186
[7] Ł. Dziuda, M. Krej, and F. W. Skibniewski, “Fiber Bragg grating strain
sensor incorporated to monitor patient vital signs during MRI,” IEEE Sens.
J., vol. 13, no. 12, pp. 4986–4991, Dec. 2013.
[8] C. I. Merzbacher, A. D. Kersey, and E. J. Friebele, “Fiber optic sensors
in concrete structures: A review,” Smart Mater. Struct., vol. 5, no. 2,
pp. 196–208, Apr. 1996.
[9] L. Dziuda, F. W. Skibniewski, M. Krej, and J. Lewandowski, “Monitoring
respiration and cardiac activity using fiber Bragg grating-based sensor,”
IEEE Trans. Biomed. Eng., vol. 59, no. 7, pp. 1934–1942, Jul. 2012.
[10] Z. Chen, D. Lau, J. T. Teo, S. H. Ng, X. Yang, and P. L. Kei, “Simultaneous
measurement of breathing rate and heart rate using a microbend multimode
fiber optic sensor,” J. Biomed. Opt., vol. 19, no. 5, p. 057001, May 2014,
doi: 10.1117/1.JBO.19.5.057001.
[11] Y. Zhu, H. Zhang, M. Jayachandran, A. K. Ng, J. Biswas, and Z. Chen,
“Ballistocardiography with fiber optic sensor in headrest position: A feasibility study and a new processing algorithm,” in Proc. 35th Annu. Int.
Conf. IEEE Eng. Med. Biol. Sci., 2013, pp. 5203–5206.
[12] Ł. Dziuda and F. W. Skibniewski, “A new approach to ballistocardiographic measurements using fiber Bragg grating-based sensors,” Biocybern. Biomed. Eng., vol. 34, no. 2, pp. 101–116, 2014.
[13] Z. Chen, J. T. Teo, S. H. Ng, and X. Yang, “Portable fiber optic ballistocardiogram sensor for home use,” Proc. SPIE, vol. 8218, p. 82180X, 2012,
doi.org/10.1117/12.909768.
[14] J. Witt, F. Narbonneau, M. Schukar, K. Krebber, J. De Jonckheere,
M. Jeanne, D. Kinet, B. Paquet, A. Depré, L.T. D’Angelo, T. Thiel, and
R. Logier, “Medical textiles with embedded fibre optic sensors for moni-

[15]
[16]
[17]

[18]
[19]

[20]

[21]

[22]
[23]

[24]
[25]
[26]
[27]

[28]

[29]
[30]
[31]
[32]
[33]

1449

toring of respiratory movement,” IEEE Sens. J., vol. 12, no. 1, pp. 246–254,
2012.
C. Brüser, K. Stadlthanner, S. De Waele, and S. Leonhardt, “Adaptive
beat-to-beat heart rate estimation in ballistocardiograms,” IEEE Trans.
Inf. Technol. Biomed., vol. 15, no. 5, pp. 778–786, Sep. 2011.
C. Brüser, S. Winter, and S. Leonhardt, “Robust inter-beat interval estimation in cardiac vibration signals,” Physiol. Meas., vol. 34, no. 2,
pp. 123–138, 2013.
S. Šprager and D. Zazula, “Optimization of heartbeat detection in fiberoptic unobtrusive measurements by using maximum a posteriori probability estimation,” IEEE J. Biomed. Health Informat., vol. 18, no. 4,
pp. 1161–1168, Jul. 2014.
A. Grillet, D. Kinet, J. Witt, M. Schukar, K. Krebber, F. Pirotte, and
A. Depré, “Optical fiber sensors embedded into medical textiles for healthcare monitoring,” IEEE Sens. J., vol. 8, no. 7, pp. 1215–1222, Jul. 2008.
Ł. Dziuda, F. W. Skibniewski, M. Krej, and P. M. Baran, “Fiber Bragg
grating-based sensor for monitoring respiration and heart activity during
magnetic resonance imaging examinations,” J. Biomed. Opt., vol. 18,
no. 5, art. no. 057006, May 2013, doi: 10.1117/1.JBO.18.5.057006.
S. Abad, M. López-Amo, F. M. Araújo, L. A. Ferreira, and J. L. Santos,
“Fiber Bragg grating-based self-referencing technique for wavelengthmultiplexed intensity sensors,” Opt. Lett., vol. 27, no. 4, pp. 222–224,
Feb. 2002.
E. Al-Fakih, N. A. Abu Osman, and F. R. Mahamd Adikan, “The use of
fiber Bragg grating sensors in biomechanics and rehabilitation applications: The state-of-the-art and ongoing research topics,” Sensors, vol. 12,
no. 10, pp. 12890–12926, Oct. 2012.
Micron Opt. Tech. Inf. (2010). Optical Sensing Interrogator sm130,
Atlanta, GA, USA. [Online]. Available: http://www.micronoptics.com/
S. Abad, M. López-Amo, F. M. Araújo, L. A. Ferreira, and J. L. Santos,
“Fiber Bragg grating-based self-referencing technique for wavelengthmultiplexed intensity sensors,” Opt. Lett., vol. 27, no. 4, pp. 222–224,
Feb. 2002.
O. Tannenbaum, J. A. Schack, and H. Vesell, “Relationship between ballistocardiographic forces and certain events in the cardiac cycle,” Circulation,
vol. 6, no. 4, pp. 586–592, Oct. 1952.
J. Alametsä, A. Varri, J. Viik, J. Hyttinen, and A. Palomäki, “Ballistocardiographic studies with acceleration and electromechanical film sensors,”
Med. Eng. Phys., vol. 31, no. 9, pp. 1154–1165, Nov. 2009.
D. Friedrich, X. L. Aubert, H. Fähr, and A. Brauers, “Heart rate estimation
on a beat-to-beat basis via ballistocardiography—A hybrid approach,” in
Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., 2010, pp. 4048–4051.
J. Paalasmaa, H. Toivonen, and M. Partinen, “Adaptive heartbeat modelling for beat-to-beat heart rate measurement in ballistocardiograms,” IEEE J. Biomed. Health Informat., 2014, DOI:
10.1109/JBHI.2014.2314144.
Y.-L. Zheng, X.-R. Ding, C. C. Y. Poon, B. P. L. Lo, H. Zhang,
X.-L. Zhou, G.-Z. Yang, N. Zhao, and Y.-T. Zhang, “Unobtrusive sensing
and wearable devices for health informatics,” IEEE Trans. Biomed. Eng.,
vol. 59, no. 7, pp. 1934–1942, May 2012.
E. Gamma, R. Helm, R. Johnson, and J. Vlissides, Design Patterns:
Elements of Reusable Object-Oriented Software. Boston, MA, USA:
Addison-Wesley, 1995.
J. Albahari and B. Albahari, C# 5.0 in a Nutshell: The Definitive Reference.
Sebastopol, CA, USA: O’Reilly Media, 2012.
T. Baeck, D. Fogel, and Z. Michalewicz, Handbook of Evolutionary Computation. New York, NY, USA: Taylor & Francis, 1997.
D. T. Larose, Data Mining Methods and Models, 2nd ed. Hoboken, NJ,
USA: Wiley, 2014.
D. E. Goldberg, Genetic Algorithms in Search, Optimization, and Machine
Learning. New York, NY, USA: Addison-Wesley, 1989.

Mariusz Krej received the M.Sc. degree in electronics and telecommunications
from the Military University of Technology, Warsaw, Poland, in 2004.
In 2007, he joined the Aviation Bioengineering Department at the Military
Institute of Aviation Medicine, Warsaw, and currently holds a software developer post within the Medical Electronics Team. His main interests center on
algorithms and analysis of applications that lie predominantly in the field of
biomedical informatics.

1450

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 4, JULY 2015

Łukasz Dziuda (M’13) received the Ph.D. degree in optical sensing from the
University of Strathclyde, Glasgow, U.K., in 2007, and the D.Sc. degree in
biocybernetics and biomedical engineering from the Nałecz
˛ Institute of Biocybernetics and Biomedical Engineering of the Polish Academy of Sciences,
Warsaw, Poland, in 2014.
He is an Associate Professor at the Military Institute of Aviation Medicine
(MIAM), Warsaw, Poland. He is currently leading the Biomedical Engineering
Team within the Technical Department of Aeromedical Research and Flight
Simulators at the MIAM. His main interests center on the advancement of optical sensing techniques in applications that lie predominantly in the fields of
biomedical engineering and energy systems. He has published nearly 40 papers
in these areas.

Franciszek Wojciech Skibniewski received the M.Sc. degree in electronic
engineering from the Military University of Technology, Warsaw, Poland, in
1964, and the Ph.D. degree from the Warsaw University of Technology, Warsaw,
Poland, in 1980.
He is currently leading the Technical Department of Aeromedical Research
and Flight Simulators at the Military Institute of Aviation Medicine, Warsaw.
His main interests include flight simulators and biomedical systems used in
aviation training. He is also a pioneer in the research program of examinations
in flight conditions.

