1214

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Supervised Hierarchical Bayesian Model-Based
Electomyographic Control and Analysis
Hyonyoung Han and Sungho Jo, Member, IEEE

Abstract—This work suggests a supervised hierarchical
Bayesian model for surface electromyography (sEMG)-based motion classification and its strategy analysis. The proposed model
unifies the optimal feature extraction and classification through
probabilistic inference and learning by identifying the latent neural
states (LNSs) that govern a collection of sEMG signals. In addition,
the inference step provides an approach to identify distinct muscle
activation strategies according to sEMG patterns based on LNSs.
To validate the model, nine-class classification using four sEMG
sensors on the limb motions is tested. The model performance is
evaluated with relatively high and low activation levels, generalized
classification across subjects and online classification. The model,
based on LNSs to capture various motions, is assessed with respect
to activation levels, individual subjects and transition during online
classification. Our approach cannot only classify sEMG patterns,
but also provide the interpretation of sEMG strategic patterns.
This work supports the potential of the proposed model for sEMG
control-based applications.
Index Terms—Classification, electromyographic control, surface electromyography (sEMG), supervised hierarchical Bayesian
model.

I. INTRODUCTION
URFACE electromyography (sEMG)-based muscle activation observation has been of particular interest as a noninvasive method for control [1]. This method has potential
for applications in prosthetics [2]–[5], exoskeletons [6]–[9],
robotics [10], [11], etc., and has been verified through various research results. While testing various algorithms to extract
desired commands from encoded sEMG signals, the following popular algorithms have been explored in detail: neural
networks [12], [13], fuzzy systems [5], [6], and the Hill-type
muscle model [7], [8].
Artificial neural networks (ANNs) are one of the most popular machine learning-based classification and regression algorithms. ANNs enable prediction without a detailed model of

S

Manuscript received April 24, 2013; revised July 31, 2013 and September 24, 2013; accepted September 30, 2013. Date of publication October 4,
2013; date of current version June 30, 2014. This work was supported by the
Agency for Defense Development of Korea under Grant UD1100511D, by the
Korean Government (MTIE) under the Human Resources Development Program for Convergence Robot Specialists H1502-13-1001, and by the Korean
Government (ME) under the Basic Science Research Program under Grant
2013R1A1A2009378.
The authors are with the Department of Computer Science, Korea Advanced Institute of Science and Technology, Daejeon, Korea (e-mail: hhn98@
kaist.ac.kr; shjo@kaist.ac.kr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2284476

the underlying musculoskeletal system. Conversely, they do not
provide an explicit physical representation of the mechanism.
Taking into account the fact that the human body is a complicated fuzzy system, a neurofuzzy algorithm for myoelectric
control or interface has been proposed, especially for robotic
exoskeleton applications [6]. A hierarchical neurofuzzy [14]
controller has been found to be good adapting to people who
generate different muscle activity levels. The Hill-type muscle
model [15] explains the neurophysiological mechanism of muscle operation. A problem of the model-based approach is that
the number of model parameters to be determined increases as
more muscles are incorporated into the model, and the model
parameters are subject dependent [16], [17]. In addition to the
aforementioned approaches, onset analysis and finite state machine approaches have also been suggested [18].
Recently, there have been some attempts to apply Bayesian
approaches for electromyographic control [19]–[22]. Especially,
the hidden Markov model (HMM) [21] and the Gaussian mixture model (GMM) [22] have been applied for multiple limb
motion classification using myoelectric signals. Bayesian approaches are generally known to be good at achieving an automatic and adaptive process without concrete information about
the parameters and at incorporating prior information as well.
On the other hand, they typically involve high-dimensional integrals. However, the recent advent of sufficient computational
power and good methodology has made Bayesian approaches
very attractive for solving complex problems.
Even though a variety of methods have been attempted so far,
achieving a robust algorithm is still challenging because sEMG
signals are very likely affected by a person’s condition and the
task performed. For classification and analysis of motions, generative model approaches may have advantages to provide an
intuitive mechanism and to comprehensively describe the overall processing. Moreover, the sEMG strategies, which indicate
an essential characteristic of sEMG executing a specific motion,
could be different across subjects or differ in activation levels
while executing similar motions. Therefore, a comprehensive
model which can take into account individual strategies as well
as classify signal patterns is expected to provide better results
for extensive applications.
This paper proposes a new hierarchical Bayesian model to
interpret a generation of a multitime series of sEMG data and
classify the sEMG profiles (time series of each channel sEMG
signal) into several classes. The proposed model assumes the
probabilistic distribution of latent neural state (LNS) variables
that infer sEMG profiles. By constructing a generative probabilistic model, probabilistic relationships among a set of latent
intention variables are formed and possible sequences of sEMG

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

HAN AND JO: SUPERVISED HIERARCHICAL BAYESIAN MODEL-BASED ELECTOMYOGRAPHIC CONTROL AND ANALYSIS

Fig. 1. Graphical model representation for the proposed supervised hierarchical Bayesian model. Each node is labeled according to its role in the generative
process. Observed nodes indicating data d and label c are shaded while the
other nodes indicating Dirichlet parameter α, Gaussian multimodal parameters
μ and Ω, class coefficient parameter η, multinomial distribution of LNSs θ, and
specific LNS z are unshaded.

data are generated based on the relationships. The probabilistic structure of the LNS variables makes it possible to classify
activations from a set of sEMG profiles and to distinguish the
sEMG motion strategies.
II. SUPERVISED HIERARCHICAL BAYESIAN PROCESS MODEL
FOR AN SEMG-BASED CLASSIFICATION
A. Motivation
The proposed model is motivated by Latent Dirichlet Allocation (LDA), which is the simplest topic model. LDA is based
on the intuition that documents, which are sets of words, exhibit
multiple topics [23]–[25]. LDA models document collections
that are produced from latent topics by representing each topic
as a distribution over a fixed vocabulary. The proposed model
interprets the intuition behind the topic model with respect to a
collection of sEMG profiles. It is proposed that we should regard
an sEMG signal profile over time as a sequence of data units.
An sEMG data unit, corresponding to a word in the topic model,
contains features that play roles in the basic representation of
data. Then, a trial, which records sEMG signals from multiple
electrode channels, is a collection of a sequence of units. Assuming there are LNSs comparable to latent topics in the topic
model, the trials are represented by random mixtures over latent
intentions, in which each LNS is characterized by a distribution
over data units. This work also proposes to use the Gaussian
distribution to represent each LNS by taking into account the
general features of sEMG signals [26], [27]. For applications to
control, the model includes a classification procedure. The most
likely classes are successively selected by assuming that a trial
is associated with a sequence of intentions. The selected class
labels can be interpreted as commands to an object intended to
be controlled such as a robot, a prosthetic device, a wheelchair
and so on.
B. Generative Process Model
A simple illustration of the proposed model is shown in Fig. 1.
Suppose that training data are collected in T trials for C class
classification, and a data sequence is made up of N data units
in each trial (see Section II-C). Under the assumption that the

1215

number of LNSs, K, are fixed, the proposed model describes a
generative process of data acquired at the dth trial, as follows:
1) Sample θd ∼ Dirichlet (α).
2) For each of the sEMG data units (n = 1, . . . , N ),
Sample zn ∼ Multinomial (θd ). Sample dn ∼ p(dn |zn ,
μ1:K , Ω1:K ) from a multivariate Gaussian distribution
conditioned on zn .
3) Sample c ∼ p(c|z, η1:L ) which represents a softmax dis
tribution, where z = (1/N ) N
n =1 zn .
θd is a K-dimensional Dirichlet random vector; the parameter
α is a K-dimensional vector each of whose elements are positive. Each trial is generated by again selecting from the Dirichlet
random vector and repeating the entire process. Each zn denotes
a 1-of-K binary random vector with elements zn k for k = 1, . . . ,
K. zn , n = 1, . . . , N , are the LNS factors that induce an sEMG
sequence. To describe the kth latent intention, the Gaussian parameters, mean vector μk , and covariance matrix Ωk are fixed
quantities. Given the quantities, a feature vector dn of the data
unit is drawn from the following distribution conditioned on zn :
p(dn |zn , μ1:K , Ω1:K ) =

K


N (μk , Ωk )z n k .

(1)

k =1

A sequence of values of dn over successive data units represents a trial. For applications, a class label c is drawn from the
softmax distribution [28],
L

 


exp ηiT z
p(c|z, η1:L ) = exp ηlT z /

(2)

i=1

where η1:L represents a set of L class coefficients; and each
ηl is a K-dimensional vector whose elements are real values.
Unknown parameters to be estimated are α, μ1:K , Ω1:K , and
η1:L . Their optimal values are determined based on training
trials. Section II-D will explain the optimization method. Once
the model is established, sEMG-based classification is possible
for future test trials.
This section introduced the concept of the generative process and relationship among parameters. From the next section,
we describe each step sequentially: the feature extraction from
sEMG signals in Section II-C, the hidden unknown variable
optimization and estimation in Section II-D, and estimation of
classification parameter in Section II-E.
C. sEMG Data Unit
Raw sEMG profiles can be windowed with or without overlap.
Each window is regarded as a data unit. In a window, features are
appropriately designated. Feature extraction relies on physical
and neurophysiological conditions for a problem to be solved.
The feature used in this work is the mean absolute value (MAV),
which has commonly been used for muscle activation detection.
The MAV is computationally simple and intuitive. It is computed
as follows:
MAV =

M
1 
|xi |
M i=1

(3)

1216

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

where xi is a data point value at the ith time index, and M is
the total number of data points in a window. Thus,
dn = [ MAV1

...

T

MAVH ]

(4)

where the subscript indicates channel index assuming a trial
records sEMG signals from H channels.
It should be noted that the sEMG data unit is the representation of a basic element of information. This work assumes
that a sequence of sEMG units contains essential information
encoded in the sEMG data from a trial. Other than the MAV,
any possible combination of features is available [29], [30], and
it has been shown that combinatory features are advantageous
to attain high classification accuracy [31], [32]. However, this
work restricts the use of other features because its primary aim
is to show the feasibility of our approach not to find the best
protocol for the highest classification accuracy.
D. Variational Inference
Finding the exact inference to compute the conditional distribution of the LNSs given the model is intractable. Instead,
the method of variational inference approximation used in LDA
is similarly applicable [24]. In the middle of the inference approximation, the factorized variational distribution of the latent
variables is declared to be
q (θ, z1:N , |γ, ϕ1:N ) = q (θ|γ)

N


q(zn |ϕn ).

(5)

n =1

Variational parameters γ and ϕ1:N are introduced; γ is a
K-dimensional Dirichlet parameter; and each ϕn parameterizes a categorical distribution over K elements, where E[zn ] =
ϕn . Then, the minimization of the Kullback–Leibler (KL) divergence [33] between the factorized and the true posterior
distributions is conducted using the variational expectationmaximization (EM) algorithm [34]. In the E step, the variational parameters are updated. The update rule of the variational
parameter γ is identical to that of LDA [24], therefore,
γ new = α +

N


ϕn .

(6)

computed:
N
n =1 ϕn k dn
=
μnew

k
N
n =1 ϕn k
N
new
) (dn − μnew
)T
k
n =1 ϕn k (dn − μk
=
.
Ωnew

k
N
n =1 ϕn k

(8)

(9)

Classification parameters η1:L can be estimated using the
conjugate gradient [28], which is applied to
 L N K


T

 
1
T
ηlk
ηl t ϕt − log
ϕtn k exp
(10)
N
t=1
n =1
l=1

k =1

N

where ϕt = (1/N ) n =1 ϕtn at the tth trial. α can also be optimized [20]. However, practically, its value is fixed, for example,

T
α = K1 , . . . , K1 uniformly.
The variational inference and the parameter estimation are
repeatedly processed until the convergence is attained.
E. Classification
Once a model is learned, classification for future data can be
performed. Given an unseen data, the learned model performs
a variational inference on the data to identify variational parameters with LNSs estimated during training. Then, the same
procedure as in [28] is applied, which results in a label selection
such that
c∗ = arg

max

l∈{1,...,L }

E[ηlT z] = arg

max

l∈{1,...,L }

ηlT ϕ.

(11)

For practical applications such as control of prosthetic devices
or robotic arms, online or real-time classification is important
[2], [22], [35]. To implement online classification, a decision is
made per time window by modifying the classification rule as
follows:
c∗n = arg

max

l∈{1,...,L }

ηlT ϕn for the nth time window.

(12)

Generally, increasing window length improves classification,
while a longer processing time is required for a decision [35].

n =1

Meanwhile, the update rule of the variational parameter ϕn
is obtained by applying the technique introduced in [28] for the
model, which includes a softmax classification, as follows:


1
ηlk − (hT ϕn )−1 hk ϕnew
exp
nk
N
⎞⎞
⎛
⎛
K

= κN (dn |μk , Ωk ) exp ⎝ψ(γk ) − ψ ⎝
γj ⎠⎠ (7)
j =1

 
where ϕn k is the kth element of ϕn , hT ϕn = Ll=1 N
n =1
K
( k =1 ϕn k exp( N1 ηlk )) is a linear function of ϕn , h =
[h1 , . . . , hK ]T , ψ(·) is a gamma function, and κ is a normalization factor.
In the M step, model parameters are estimated given the
variational parameters. Gaussian parameters in the LNS are

III. EXPERIMENTS
A. Subject
Seven subjects volunteered for the experiments (mean ± SD
age = 27.4 ± 2.96 years). All of the participants were free of neuromuscular and musculoskeletal pathology. All of the subjects
were given sufficient information about the purpose and procedures, and, before participation, informed consent was obtained
from each subject. The KAIST Institutional Review Board approved the proposed experimental protocol of this study.
B. Experiment Design
Fig. 2 shows a list of the limb motions chosen in this study.
The motions were chosen to intuitively represent all possible
actions: wrist flexion/extension, radial/ulnar deviation, pronation/supination, and hand grip/open. The movement of opening

HAN AND JO: SUPERVISED HIERARCHICAL BAYESIAN MODEL-BASED ELECTOMYOGRAPHIC CONTROL AND ANALYSIS

1217

Fig. 2. Eight limb motions (M1–M8) with a relaxation pose (M0) for classification in this study.

Fig. 3.

Electrode locations chosen for this study. See also Table I.
TABLE I
ELECTRODE LOCATIONS ON THE FOREARM
Fig. 4. (a) Experimental setup. (b) Experimental Procedure: black bold line
represents the target motions from M0 to M8 over time and gray lines illustrate
sEMG signals of the channels.

the hand also extends the fingers to distinguish it from the relaxation movement. The limb motions are easily executable,
intuitive, and varied enough to be used for applications such as
prosthetic or exoskeleton control [2], [21], [32], [35].
The actions are mainly governed by forearm muscles. The
goal of this study is the classification of the nine wrist or finger
postures, eight motions plus one relaxation posture, using the
proposed model, and the model evaluation through the experimental results. A minimal number of electrodes were placed
at sites such that interpreting the signal of different motions
could be performed as accurately as possible across subjects.
Fig. 3 shows the electrode locations selected considering particular muscles whose relevant functions contribute to the limb
motions listed in Table I. Four electrodes were attached at each
recording spot, as summarized in Table I. A fifth electrode was
located on the upper arm as a reference to remove noise.

The subject was asked to sit comfortably in a chair with
his right forearm lightly positioned on a horizontal plane with
supports (Ergo Rest, USA). To allow the natural movement of
the wrist, the wrist and hand were not constrained with any
supports [see Fig. 4 (a)]. During movements, raw sEMG signals
were measured using a commercial bipolar surface electrode
and a filter-amplifier system (Bagnoli, Delsys Inc., USA).
C. Experimental Procedure
The experiments consisted of three sessions: pretest, a maximal voluntary contraction (MVC) check, and test sessions. During the pretest session, each subject took part in a familiarization
session in which the subject became comfortable with the experimental equipment and practiced the experimental protocols.
After the pretest session, maximum contraction values of each
of the four muscles were recorded to be regarded as 100% MVC
following the instructions on the computer screen. The subjects
were asked to sequentially perform four wrist motions which
exercised the maximum force of each muscle: radial deviation,
flexion, extension, and ulnar deviation at MVC. It was requested
that each wrist action be performed for 2 s.

1218

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

In each experiment, each subject was asked to perform wrist
motions sequentially at two distinctive muscular activation levels. It was very difficult to maintain a consistent contraction
level; therefore, relatively low (20–30% MVC) and high (60–
70%) activation level windows were designated. The activation
level bar graph was shown on the screen during the experiment
to help each subject maintain the level in real time. In each test
session, the order of wrist motions was radial deviation, flexion,
extension, ulnar deviation, pronation, supination, hand grasp,
and hand open [see Fig. 4(b)] for 5 s. Relaxation posture was
taken between any two sequential motions with the same interval. The motion sequence began with a relaxed natural posture
of the wrist and hand. Each subject repeated the motion sequence five times at each muscular activation level. Therefore,
five sessions per subject were recorded. The subject was allowed
to relax between each session to avoid muscular fatigue, which
could affect the myoelectric signal in the subsequent trials. The
subject was not allowed to talk or move his body during the
experiments, in order to avoid motion artifacts.
D. Signal Processing
The myoelectric signals were recorded simultaneously with
a data acquisition system (NI 6221, National Instrument, USA),
and were then sampled at 1 kHz. The myoelectric signals were
band-pass filtered (5–450 Hz) using a zero phase fourth-order
Butterworth filter; power line noise was rejected with an activated notch filter. The baselines of the myoelectric signals were
shifted using mean values during the initial 10 s. Then, the myoelectric signals were normalized using MVC values. The static
phase of each contraction was used for evaluation. The time
window per data unit was set at 250 ms with a 50 ms window
increment. The MAV feature was extracted in each window.
E. Modeling Condition and Motion Analysis
Various validation studies are conducted to assess the proposed model. First, the influence of the number of LNSs is examined. Second, the possibility of identifying the same motions
without considering different activation levels is investigated in
the combined activation level condition. Third, the performance
of a generalized model across subjects is investigated. Finally,
online classification using the proposed model is performed.
From the results, we analyze the sEMG strategy between high
and low activation levels through the model in the combined
activation level condition, sEMG strategy transition through
the model in an online classification condition, and compare
individual sEMG strategy through model in a cross subject
condition.
IV. STRATEGY ANALYSIS
This work assumes a motion’s sEMG strategy can be indicated with respect to LNSs using the proposed model. The
learned model describes a specific motion execution with a
specified vector γ which expresses the relative contribution proportion of LNSs. kth LNS is expressed by its mean vector, μk ,
and covariance matrix, Ωk , e.g., a Gaussian distribution. Hence,

Fig. 5. Simple visualization of LNS that consists of the four-dimensional
mean vector of the GMM for sEMG strategy analysis.

a characteristic of a specific motion in terms of the data units
can be represented by a GMM as follow:
p (x) =

K


wk Nk

(13)

k =1

where wk =  Kγ k γ , Nk = N (x; μk , Ωk ) , γk is the kth elek=1 k
ment of γ which is estimated through the variational inference
step using the specific motion data. Here, the random vector x
represents MAVs relative to MVCs from the four electrodes.
To ease visual analysis and evaluation, the characteristic of a
specific motion can be simply expressed by mean vector which
is computed by
μs =

K


wk μk .

(14)

k =1

The mean vector indicates the representative magnitudes of
muscular activations from the four electrodes as, for example,
illustrated in Fig. 5. Therefore, it provides information on the
sEMG strategy. Especially, when specific motions are executed
by consistent muscular activations as in our cases, the mean vector describes the distribution of muscular activations intuitively.
For quantitative analysis, it is valid to measure similarity
between sEMG strategies extracted from the probabilistic LNS
space. This work considers the extended Jaccard distance which
measure dissimilarity between two sample sets, and is complementary to the Jaccard coefficient [36] which is a variant of
normalized inner product. Each mean vector of two motions in
comparison is represented by (14) using a specific variational
parameter γ inferred from each specific motion data in the LNS
space. When μa and μb represent two mean vectors, the extended
Jaccard distance is defined as follows:
J(μa , μb ) = 1 −

μa · μb
.
μ2a2 + μ2b2 − μa · μb

(15)

As two sEMG strategies are more similar, the metric value
becomes lower. The value is between 0 and 1. The original Jaccard index [37] is a similarity measure for binary features, but its
extension in (15) is used with real-valued features. The Jaccard
similarity is both scale and translation sensitive [36]; therefore,
the overall scale and the relative contribution of individual elements of the mean vector can be taken into account to compare
sEMG strategies as well.

HAN AND JO: SUPERVISED HIERARCHICAL BAYESIAN MODEL-BASED ELECTOMYOGRAPHIC CONTROL AND ANALYSIS

TABLE II
OFFLINE INDIVIDUAL PATTERN CLASSIFICATION ACCURACY ACCORDING TO
NUMBER OF LNSS (%): (a) HIGH, (b) LOW, AND (c) COMBINED
ACTIVATION LEVEL CONDITION

1219

TABLE III
ONLINE CLASSIFICATION ACCURACY ACCORDING TO NUMBER OF LNSS (%)

Fig. 6. Example of online classification over designated time window. Each
dot indicates classification result at a specific instant interval.

tioned cases with the same number of LNSs probably because
the model complexity is relatively higher.

V. RESULTS
A. Number of LNSs
As in [2], performance accuracy was measured based on
leave-session-out cross validation. That is, the proposed model
was trained with four sessions and tested with a remaining session. Average accuracy was obtained from five runs per test for
each session. Table II shows accuracies of identifying the same
motion intentions over the number of LNSs. Individual subjects
are identified by letters A–G. In the high activation condition
[Table II(a)], most of subjects achieved above 90% accuracy;
a few had results of over 95%. In contrast, only a few cases
achieved above 90% accuracy in the low activation condition
[Table II(b)]. The model performance was poor with subject E
in both conditions.

B. Combined Activation Level
To examine the influence of activation level on performance,
myoelectric signals at both high and low activation levels were
used together to train the model. For evaluation, leave-sessionout cross validation was performed using all the data from both
activation conditions. Table II(c) summarizes the results over
the number of LNSs. With 30 and 40 LNSs, 86 and 87% accuracies were achieved on average, respectively. The classification
accuracy was relatively lower than the single activation condi-

C. Online Classification
To study the application of the model to online classification, simulation tests were conducted. Rather than training a
model anew, the offline-trained model from the previous test
was used. However, the online classification rule, as explained in
Section II-D, was applied. Hence, each test session was classified online; that is, a classification result is an outcome per
250 ms time window with a 50 ms window increment. The results over the number of LNSs are summarized in Table III.
Fig. 6 illustrates the online classification performance. False
classification mainly occurred during motion transition periods.
D. Generalization Across Subjects
To study the model performance across subjects, the model
was tested with leave-subject-out cross validation. That is, a
specific subject’s data was excluded during training, and the
subject’s data was used as test data. The model was trained using high activation conditioned electromyographic signals only,
in order to clarify the LNSs by inferring each motion across
subjects. The model can be regarded as a generalized one across
subjects. Its overall performance for all of the LNSs is summarized in Table IV. On average, 84% accuracy was obtained with
50 LNSs (K = 50), although the generalized model across subjects performed less accurately than the subject-specific models
overall.

1220

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

TABLE IV
OFFLINE INDIVIDUAL PATTERN CLASSIFICATION ACCURACY WITH
GENERALIZED MODEL ACROSS SUBJECTS ACCORDING
TO NUMBER OF LNSS (%)

TABLE V
MAJOR INFLUENTIAL LNSS WITH WHOLE ACTIVATION CONDITIONED
MODEL OF SUBJECT D

Fig. 7. Visualization of each LNS in the combined activation level conditioned
model. The LNSs are labeled from S1 to S30 (the label order is meaningless).

VI. DISCUSSION
A. Number of LNSs
Although subject-specific performance is different, the classification accuracy over the number of LNSs tends to increase
until some optimal number of LNSs, after which it slowly decreases due to model overfitting. We analyzed and selected the
optimal number of LNSs overall from the individual results.
Accuracies were only obtained for up to 50 LNSs because computational complexity becomes much higher when there are
more than 50 LNSs.
In a comparison of the activation levels, the high activation
conditioned accuracy was found to be higher than the low activation conditioned accuracy. High activation seems to better
clarify each intended motion. Above 20 LNSs (K > 20) note
that there is an appropriate choice to obtain reasonable overall
accuracies of at least 91% for high contraction level and 86%
for low contraction level across all subjects.
B. Combined Activation Conditioned Model Analysis
A trained model incorporates LNSs that describe activation
patterns. To demonstrate analyzing a trained model in detail,
this section uses the combined activation conditioned model
obtained from subject D’s data as an example. From this model,
the estimated LNSs when k = 30 are illustrated in Fig. 7.

Fig. 8. Comparison between the mean vectors of low (thin line) and high
(thick) activation conditions per motions extracted from the combined activation conditioned model. And, for clarity, scale-adjusted mean vectors of low
activation conditions are overlapped with them of high activation conditions.

Relative contribution proportion of LNSs per motion is obtained by averaging γ values estimated through variational inference. Table V summarizes the most influential LNSs which
cover at least 95% of the total proportions in which they contributed. The relative contribution proportions are also indicated
in parentheses in Table V. It is clearly shown that relatively large
scaled LNSs are mainly contributed for motions with high activation levels. Meanwhile, relatively small scaled LNSs dominates the representation of motions with low activation levels.
With the obtained accuracy, the learned model constructs the
LNS space, which characterizes both low and high activation
conditioned motions.
Fig. 8 visualizes each mean vector per each motion in both
activation level cases. The mean vectors of low and high activation conditions are drawn in thin and thick lines, respectively.

HAN AND JO: SUPERVISED HIERARCHICAL BAYESIAN MODEL-BASED ELECTOMYOGRAPHIC CONTROL AND ANALYSIS

1221

to another may extend possible applications to those beyond
discrete classification.
To enhance motion classification accuracy, it is possible to use
a postprocessing method such as a majority vote [35]. However,
this work is intended to emphasize the primary characteristic of
the proposed model, which is its ability to capture the stream of
motion change.
D. Subject’s Generalized Model Analysis

Fig. 9. Example of motion transition over time in online classification performance. Dot and cross represent instant features of each muscle, and gray boxes
depict the dataset and related mean vector visualization.

In addition, for easy comparsion, the mean vector scales of
low activation conditioned cases are matched and drawn overlapped with the high activation condition cases in Fig. 8. sEMG
strategies between low and high activation conditioned cases
are clearly distinguished in terms of the amplitude of the mean
vector. However, the relative distribution of the mean vectors
seem comparable between the two cases per each motion. Motions M1, M3, M5, M6, M7, M8, and M0 demonstrate quite
consistent results between the two activation conditions. Except for motions M2 and M4, the motions amplify the mean
vector scales maintaining a relative activation pattern over the
muscles. In M2 and M4, the relative distributional difference
between two activation conditions other than the scale change
is visually observed further relative to the other motions. At M2
(flexion), LNS of low activation level (S25) is dominant on the
downward element (PL), but the LNS at high activation level,
a combination of S19 and S10, indicates relatively significant
rightward element (FCU) increment. This can be explained that
more cocontractions were activated to generate higher activation. Motion M4 (deviation) case can also be similarly explained.
Upward directional element (ED) is generated dominantly in
low activation condition, but as activation level increases, other
muscular activations are also significantly increased.
C. sEMG Strategy Transition
As a typical example, Fig. 9 illustrates the time flow of the
online performance around the transition period from relaxed
posture (M0) to motion M3. The mean vectors at selected windows are indicated. In the middle of the transition, the mean
vector is shaped between motions M0 and M3. The mean vector
could lead to wrong classification at that instant; however, it may
be able to explain transient muscular activation between motions
M0 and M3. That is to say, the transient muscular activations do
not match specified sEMG strategies well; hence, false classifications are frequently seen during the transition. The proposed
model allows continuous tracking of sEMG strategies or influential LNSs over time. Thus, it can identify the dynamics of
sEMG strategies in a spatial representation. The information
on proportional changes of sEMG strategies from one motion

To analyze the structure of the LNS space of a generalized
model across subjects, this section uses a model trained with the
other subjects’ data to test subject F. The performance accuracy
of this case is shown in Table III and is 90% when K = 50. Under the model’s accuracy, the similarity measure between two
motions with respect to LNSs as in (15) is applied, and its result
is visualized as similarity matrix in Fig. 10. As two motions
are more similar in strategy, the pixel color is closer to red. For
easy comparison, the similarity matrix is drawn with respect
to the between-subject similarity across motions [Fig. 10(a)]
and the between-motion similarity across subjects [Fig. 10(b)]
separately. Fig. 10(a) visually shows motions are generally distinguishable across subjects. In addition, some reddish areas
indicate similar strategies are shared between different subjects.
Even within a subject, some different motions are relatively similar. For example, subject E shares similarity between M5 and
M6. In Fig. 10(b), motions M2, M3, M6, and M0 turn out to be
executed mostly similarly over subjects. A more detailed observation is possible. For example, in M2 and M3, subject G has a
clearly different strategy from the others. The rest posture M0
is relatively well distinguished from other motions. This seems
due to the activation scale. Fig. 10(c) visualizes hierarchical
cluster analysis which more effectively demonstrates identical
observations from Fig. 10(a) and (b).
To see how the similarity or dissimilarity is expressed in the
LNS space, Fig. 11 demonstrates some examples of the comparison of the mean vectors extracted from the model to describe
the same motion executed by different subjects. As shown in
Fig. 11(a), at M2 (flexion), subject G’s sEMG strategy represented by a mean vector is the most distinguished from the
others, and subject C’s one is the second most distinguished.
Those two subjects have lower downward elements (PL) as
well as lower activation scales. In Fig. 11(b), while executing M3(extension), most subjects’ sEMG strategies possessed
greater leftward elements (ECR) than rightward elements (FCU)
except subject G. Fig. 11(b) demonstrates examples of describing different motions of a subject in the LNS space. As indicated
in Fig. 10, some motions are similar in their mean vectors. For
example, M5 and M6 are quite similar for subject E, meanwhile
M1, M2, and M5 are quite similar for subject F. This implies
that those motions are hard to distinguish during classification.
In addition, it is visually recognized that subject F tends to activate the PL muscle while executing various motions. On the
other hand, subject E uses the PL muscle much less than subject E. These observations demonstrate that the model captures
subject-specific characteristics of motion execution.
Overall, including the unseen cases here, the trained model
describes shared motion execution strategies between subjects

1222

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Fig. 10. Similarity matrices based on extended Jaccard distance, J , (a) between subjects across motions and (b) between motions across subjects. Two motions
are more similar when the pixel color is closer to red. (c) Hierarchical cluster analysis. Motions are clustered based on their similarity.

can also be characterized with respect to the LNSs. The results
indicate that the proposed model as a single coherent model is
able to incorporate diverse strategies and signify complicated
correlations of various motions in the LNS space as well.
E. Remarks

Fig. 11. (a) Comparison between the mean vectors which infer the same
motion per subjects extracted from the generalized model: (left) M2 and (right)
M3. Similarity values are indicated below. (b) Comparison between the mean
vectors which infer various motions executed by the subject extracted from the
generalized model: (left) subject E and (right) subject F.

with respect to LNSs as well as different strategies even for
the same executed motion. In addition, a particular motion or
comparison between particular motions or particular subjects

This section summarizes some nontrivial remarks. The proposed model not only attained high accuracy for subject-specific
performance but also demonstrated its potential for use in the
design of a generalized classification system across subjects.
Furthermore, the model can be used to analyze characteristics
of individual motion executions in the LNS space. The spatial
LNS representation is valuable for not only motion classification but also motion-specific or subject-specific characterization
and analysis.
Our approach did not require an explicit optimal feature
extraction procedure. While training the model, optimal features were extracted implicitly and automatically. Furthermore,
the model did not rely on prior knowledge of model parameters. During online processing, continuous tracking of major
influential LNSs, or sEMG strategies was possible unlike other
traditional approaches. The online monitoring will be very effective to extend to other electromyographic control applications.

HAN AND JO: SUPERVISED HIERARCHICAL BAYESIAN MODEL-BASED ELECTOMYOGRAPHIC CONTROL AND ANALYSIS

The output response of the current model was designed for
classification problems using the softmax function. However,
the output response model can be extended or modified for any
other application. Appropriate selection of the output response
model would make it possible to generate control signals based
on an entire probability distribution over LNSs rather than discrete classification decisions. Further investigation on other response models is expected.
Previously, Bayesian models such as HMM and GMM [21],
[22] have been applied for electomyographic control. The
HMM- or GMM-based approaches require a number of models equivalent to the number of classification labels. Then, a
label is decided on to correspond to the model that attains the
maximum likelihood value given the data. Different from these
approaches, the proposed model includes a dimension of the
classification parameter that relies on the number of labels; the
natural description of the proposed model remains unchanged.
During training, the proposed model relies on the variational
EM algorithm for optimization. EM’s convergence speed is generally known to be sensitive to parameter initialization. To attain
quick and stable convergence, an efficient initialization method
such as an iterative point refinement algorithm [38] may be
effective.
There are still unexplored issues such as the selection of a
time window length [35] and application of any other features
beyond MAV [29], [30]. The optimized number of LNSs varied
from subject to subject. The subject-dependent issue should also
be further investigated.
VII. CONCLUSION
This paper presented information on the progress of generative model-based electromyographic control. The proposed
hierarchical Bayesian model offers intuitive signal processing
and effective analysis; these are very useful during implementation. Furthermore, the generative model automatically determines LNSs, which are key components of classification. Therefore, users do not need to find optimal features separately. This
paper has also demonstrated that the proposed model can reflect
various muscular activation patterns across subjects as well as
represent subject-specific characteristics of muscular activities.
Such potential functions will promote the feasibility of the proposed model for applications. Even though further exploration
is required, this work proposes that the hierarchical Bayesian
model is a natural, intuitive, and efficient means for myoelectric
assistive device interface or control development.
ACKNOWLEDGMENT
The authors would like to thank J. Cho for technical discussion and T. Morse for editorial assistance, and appreciate the
valuable comments from anonymous reviewers.
REFERENCES
[1] T. S. Saponas, D. S. Tan, D. Morris, R. Balakrishnan, J. Turner, and
J. A. Landey, “Enabling always-available input with muscle-computer
interfaces,” in Proc. 22nd Annu. ACM Symp. User Interface Softw. and
Technol., Victoria, British Columbia, Canada, Oct. 2009, pp. 167–176.

1223

[2] P. Shenoy, K. J. Miller, B. Crawford, and R. P. N. Rao, “Online electromyographic control of a robotic prosthesis,” IEEE Trans. Biomed. Eng.,
vol. 55, no. 3, pp. 1128–1135, Mar. 2008.
[3] S. Bitzer and P. van der Smagt, “Learning EMG control of a robotic
hand: Towards active prostheses,” in Proc. IEEE Int. Conf. Robot. Autom.,
Orlando, Florida, May 2006, pp. 2819–2823.
[4] K. H. Ha, H. A. Varol, and M. Goldfarb, “Volitional control of a prosthetic
knee using surface electromyography,” IEEE Trans. Biomed. Eng., vol. 58,
no. 1, pp. 144–151, Jan. 2011.
[5] F. H. Y. Chan, Y.-S. Yang, F. K. Lam, Y.-T. Zhang, and P. A. Parker,
“Fuzzy EMG classification for prosthesis control,” IEEE Trans. Rehabil. Eng., vol. 8, no. 3, pp. 305–311, Sep. 2000.
[6] K. Kiguchi, T. Tanaka, and T. Fukuda, “Neuro-fuzzy control of a robotic
exoskeleton with EMG signals,” IEEE Trans. Fuzzy Syst., vol. 12, no. 4,
pp. 481–490, Aug. 2004.
[7] E. Cavallaro, J. Rosen, J. C. Perry, S. Burns, B. Hannaford et al., “Hillbased model as a myoprocessor for a neural controlled powered exoskeleton arm – parameters optimization,” in Proc. IEEE Int. Conf. Robot.
Autom., Barcelona, Spain, 2005, pp. 4525–4530.
[8] C. Fleischer and G. Hommel, “A human-exoskeleton interfaces utilizing
electromyography,” IEEE Trans. Robot., vol. 24, no. 4, pp. 872–882, Aug.
2008.
[9] Z. O. Khokhar, Z. G. Xiao, and C. Menon, “Surface EMG pattern recognition for real-time control of a wrist exoskeleton,” BioMed. Eng. Online,
vol. 9, no. 41, 2010.
[10] P. K. Artemiadis and K. J. Kyriakopoulos, “A switching regime model
for the EMG-based control of a robot arm,” IEEE Trans. Syst., Man, and
Cybern. B, vol. 41, no. 1, pp. 53–63, Feb. 2011.
[11] Y. Chae, C. Choi, J. Kim, and S. Jo, “Noninvasive sEMG-based control
for humanoid robot teleoperated navigation,” Int. J. Precis. Eng. Manuf.,
vol. 12, no. 6, pp. 1105–1110, 2011.
[12] F. Tenore, A. Ramos, A. Fahmy, S. Acharya, R. Etienne-Cummings, and
N. V. Thakor, “Towards the control of individual fingers of a prosthetic
hand using surface EMG signals,” in Proc. IEEE Annu. Int. Conf. Eng.
Med. Bio. Sci., Lyon, France, Aug. 2007, pp. 6145–6148.
[13] S. Kwon and J. Kim, “Real-time upper limb motion estimation from
surface electromyography and joint angular velocities using an artificial
neural network for human-machine cooperation,” IEEE Trans. Inform.
Tech. Biomed., vol. 15, no. 4, pp. 522–520, Jul. 2011.
[14] K. Kiguchi, T. Tanaka, and T. Fukuda, “Neuro-fuzzy control of a robotic
exoskeleton with EMG signals,” IEEE Trans. Fuzzy Syst., vol. 12, no. 4,
pp. 481–490, Aug. 2004.
[15] A. V. Hill, “The heat of shortening and the dynamic constants of muscle,”
in Proc. R. Soc. Lond. B, 1938, vol. 126, no. 843, pp. 136–195.
[16] B. A. Garner and M. G. Pandy, “Estimation of musculotendon properties
in the human upper limb,” Ann. Biomed. Eng., vol. 31, pp. 207–220, 2003.
[17] D. G. Lloyd and T. F. Besier, “An EMG-driven musculoskeletal model
to estimate muscle forces and knee joint moments in vivo,” J. Biomech.,
vol. 36, pp. 765–776, 2003.
[18] M. A. Oskoei and H. Hu, “Myoelectric control systems-a survey,” Biomed.
Signal Process Control, vol. 2, pp. 275–294, 2007.
[19] T. D. Sanger, “Bayesian filtering of myoelectric signals,” J. Neurophysiol.,
vol. 97, pp. 1839–1845, 2007.
[20] N. Bu, M. Okamoto, and T. Tsuji, “A hybrid motion classification approach for EMG-based human-robot interfaces using Bayesian and neural
networks,” IEEE Trans. Robot., vol. 25, no. 3, pp. 502–511, Jun. 2009.
[21] A. D. C. Chan and K. B. Englehart, “Continuous myoelectric control for
powered prostheses using hidden Markov models,” IEEE Trans. Biomed.
Eng., vol. 52, no. 1, pp. 121–123, Jan. 2005.
[22] Y. Huang and K. B. Englehart, “A Gaussian mixture model based classification scheme for myoelectric control of powered upper limb prostheses,”
IEEE Trans. Biomed. Eng., vol. 52, no. 11, pp. 1801–1811, Nov. 2005.
[23] D. M. Blei, “Probabilistic topic models,” Commun. ACM, vol. 55, no. 4,
pp. 77–84, 2012.
[24] D. Blei, A. Ng, and M. Jordan, “Latent Dirichl et al. location,” J. Mach.
Learn. Res., vol. 3, pp. 993–1022, 2003.
[25] D. Blei and J. McAuliffe, “Supervised topic models,” in Proc. Neural Inf.
Process. Syst., 2007, vol. 21.
[26] E. A. Clancy and N. Hogan, “Probability density of the surface electromyogram and its relation to amplitude detectors,” IEEE Trans. Biomed.
Eng., vol. 46, no. 6, pp. 730–739, Jun. 1999.
[27] N. Hogan and R. W. Mann, “Myoelectric signal processing: Optimal estimation applied to electromyography—Part II: Experimental demonstration of optimal myoprocessor performance,” IEEE Trans. Biomed. Eng.,
vol. BME-27, no. 7, pp. 396–410, Jul. 1980.

1224

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

[28] C. Wang, D. Blei, and L. Fei-Fei, “Simultaneous image classification and
annotation,” in Proc. Comput. Vision Pattern Recog., 2009.
[29] M. Zardoshti-Kermani, B. C. Wheeler, K. Badie, and R. M. Hashemi,
“EMG feature evaluation for movement control of upper extremity prostheses,” IEEE Trans. Rehabil. Eng., vol. 3, no. 4, pp. 324–333, Dec. 1995.
[30] D. Tkach, H. Huang, and T. A. Kuiken, “Study of stability of time-domain
features for electromyographic pattern recognition,” J. Neuroeng. Rehabil., vol. 7, no. 21, 2010.
[31] U. M. Fayyad, C. A. Reina, and P. S. Bradley, “Initialization of iterative
refinement clustering algorithms,” in Proc. Int. Conf. Knowl. Discovery
Data Mining, 1998.
[32] J.-U. Chu, I. Moon, and M.-S. Mun, “A real-time EMG pattern recognition
system based on linear-nonlinear feature projection for a multifunction
myoelectric hand,” IEEE Trans. Biomed. Eng., vol. 53, no. 11, pp. 2232–
2239, Nov. 2006.
[33] S. Kullback and R. A. Leibler, “On information and sufficiency,” Ann.
Math. Stat., vol. 22, no. 1, pp. 79–86, 1951.
[34] A. P. Dempster, N. M. Laird, and D. B. Rubin, “Maximum likelihood from
incomplete data via the EM algorithm,” J. Roy. Stat. Soc. B, vol. 39, no. 1,
pp. 1–38, 1977.
[35] K. Englehart and B. Hudgins, “A robust, real-time control scheme for
multifunction myoelectric control,” IEEE Trans. Biomed. Eng., vol. 50,
no. 7, pp. 848–854, Jul. 2003.
[36] J. Ghosh and A. Strehl, “Similarity-based text clustering: A comparative
study,” in Grouping Multidimensional Data. Berlin: Springer, 2006,
pp. 73–97.
[37] P. Jaccard, “Étude comparative de la distribution florale dans une portion
des Alpes et des Jura,” Bulletin de la Société Vaudoise des Sci. Naturelles,
vol. 37, pp. 547–579, 1901.
[38] P. S. Bradley and U. M. Fayyad, “Refining initial points for K-means
clustering,” Microsoft Res. Tech. Rep. MSR-TR-98–36, 1998.

Hyonyoung Han received the B.S., M.S., and Ph.D.
degrees from the Department of Mechanical Engineering, Korea Advanced Institute of Science and
Technology (KAIST), Daejeon, Korea, in 2005, 2007,
and 2012, respectively.
He is currently a Postdoctoral Researcher with
the Department of Computer Science, KAIST. His
research interests include physical human robot interaction, health monitoring, and bioinstrumentation.

Sungho Jo (M’09) received the B.S. degree from the
School of Mechanical and Aerospace Engineering,
Seoul National University, Korea, in 1999, and the
M.S. degree in Mechanical Engineering and the Ph.D.
degree in Electrical Engineering and Computer Science both from the Massachusetts Institute of Technology (MIT), Cambridge, USA, in 2001 and 2006,
respectively.
While pursuing the Ph.D. degree, he was with the
Computer Science and Artificial Intelligence Laboratory and the Laboratory for Information Decision
and Systems. From 2006 to 2007, he was a Postdoctoral Researcher with the
MIT Media Lab. Since December 2007, he has been with the Department
of Computer Science, Korea Advanced Institute of Science and Technology,
Daejeon, Korea, where he is currently an Associate Professor. His research interests include brain-machine interface, muscle-computer interface, and wearable
computing.

