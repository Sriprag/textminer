IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

2079

Quantitative Analysis of Deformable Model-Based
3-D Reconstruction of Coronary Artery
From Multiple Angiograms
Weijian Cong, Jian Yang∗ , Danni Ai, Yang Chen, Yue Liu, and Yongtian Wang

Abstract—Three-dimensional (3-D) reconstruction of the coronary artery is important for the diagnosis and interventional
treatment of cardiovascular diseases. In this paper, a novel mean
composited external force back-projective composition model is
proposed and integrated into the deformable model framework
for the 3-D reconstruction of coronary arteries from multiple angiograms. The parametric snake evolves toward the real vascular
centerline in 3-D space based on the integrated internal energy
and composited external energy. In addition, a polynomial function is constructed to determine the diameter of the cross section of
the vascular segments, which fully utilizes the back-projection information of multiple angiograms. The deformable and proposed
methods are comparatively validated using phantom datasets and
routine angiographic images with respect to space and reprojection
Euclidean distance errors. The experimental results demonstrate
the effectiveness and robustness of the proposed model, which can
achieve a mean space error of 0.570 mm and a mean reprojection
error of 0.351 mm. In addition, the influence of the angle difference
to the reconstruction accuracy is discussed and validated on phantom datasets, which demonstrate that an angle difference of for
any two angiograms is suitable for the 3-D reconstruction process.
Index Terms—Deformable model, perspective projection, 3-D
reconstruction.

I. INTRODUCTION
-RAY angiography (XRA) is a powerful technique for
vasculature visualization and has been widely used for the
diagnosis of cardiac diseases and interventional treatment [1]–
[3]. XRA has better imaging qualities and faster imaging speed
compared with alternative imaging modalities, such as computed tomographic angiography (CTA) and magnetic resonance
angiography. XRA is the golden standard for the diagnosis of
coronary artery diseases. However, substantial 3-D information

X

Manuscript received January 19, 2015; accepted February 17, 2015. Date of
publication March 19, 2015; date of current version July 15, 2015. This work was
supported by the National Basic Research Program of China (2013CB328806),
the Key Projects in the National Science and Technology Pillar Program
(2013BAI01B01), the National Hi-Tech Research and Development Program
(2013AA013703), and the National Natural Science Foundation under Grant
61179020 and Grant 81370040). Asterisk indicates corresponding author.
W. Cong, D. Ai, Y. Liu, and Y. Wang are with the Beijing Engineering
Research Center of Mixed Reality and Advanced Display, School of Optics and
Electronics, Beijing Institute of Technology.
∗ J. Yang is with the Beijing Engineering Research Center of Mixed Reality
and Advanced Display, School of Optics and Electronics, Beijing Institute of
Technology, Beijing 100081, China (e-mail: jyang@bit.edu.cn).
Y. Chen is with the Key Laboratory of Computer Network and Information
Integration, Ministry of Education of China Laboratory of Image Science and
Technology, Southeast University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2408633

of coronary arteries tends to be lost when the anatomic structures
are projected from 3-D space by using XRA images [4]–[7]. The
successful diagnosis of coronary diseases generally requires
profound professional knowledge and operational experience
of physicians during the interventional operation. Therefore,
the 3-D reconstruction of coronary arteries not only provides
physicians with a clear vascular structure in 3-D space but can
also provide quantitative vasculature information, including diameter, length, perfusion volume, and optimum imaging angle.
Hence, the 3-D reconstruction technique has important clinical
values in the diagnosis of vascular-related diseases [8].
The 3-D reconstruction methods for angiographic images can
be divided into the two main classes: the epipolar constraint
method and deformable-model-based method. The epipolar
constraint method generally utilizes epipolar geometry constraint to construct a corresponding relationship among different
angiographic images, and 3-D vasculatures are then established
by triangulating the correspondences based on the geometric parameters of the corresponding angiograms [9]–[13]. A motion
compensation method was introduced in [9] to overcome the
correspondence error between different projections. The reconstruction accuracy is strictly correlated with the correspondence
calculation results. However, one critical problem with this
method is the multiple possible intersections between the epipolar line and the vascular structures, which results in difficulty in
finding the actual correspondences, especially when the vessel
segments are overlapping or parallel with the epipolar lines [14].
Hence, the reconstruction accuracy is determined by the epipolar geometry determination accuracy. One possible alternative
solution for the corresponding calculation is the deformablemodel-based optimization methods. The deformable curve is
gradually evolved toward the target vascular vessel segment
by defining the combination of external and internal forces.
This method avoids the corresponding calculation and has been
widely studied for vascular structure reconstruction.
The deformable model was first proposed by Terzopoulos
et al. [15], [16] in the 1980s and was initially used to perform
elastic deformation, including shape model, segmentation, and
motion tracking. Kass et al. [17] proposed a more general active
contour model named snake to deform the image by energy minimization. Molina et al. [18] first introduced the snake model
for vascular structure reconstruction. Initially, a limited number
of correspondences were constructed in the two angiographic
images by utilizing the epipolar constraint. The original snake
was then determined by the correspondences through B-Spline
interpolation. The snake curve was evolved in space to adjust

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2080

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

its projections in images by minimizing the distance between
the projection and the corresponding image data. Cañero et al.
[19], [20] developed the 3-D biplanar snake to reconstruct the
main branches of the coronary structure, wherein the generalized gradient vector flow (GGVF) was proposed to generate the
external energy for the curve deformation [21], [22]. A polynomial model was proposed to rectify the distortions derived
from the imaging errors of the angiographic system. Zheng
et al. [23] solved the contraction and shifting problems that
may be caused by balancing the internal and external energies
during optimization by combining the intrinsic properties of
the curve and priori knowledge of the coronary arteries. All
these studies have greatly developed our understanding of the
deformable-model-based 3-D reconstruction of coronary arteries from angiographic images. However, one critical problem
for these methods is the possible large reconstruction errors for
vascular segments with small curvatures because the nonstrict
corresponding points are generally used to construct the spatial point by triangulating the correspondences. In addition, the
deformation of the curve is directly determined by the energy
between the source and the target vessels; thus, the projection
geometry is not fully utilized. Generally, the deformable-modelbased methods iteratively refine the vasculatures in 3-D space
according to the projection forces of each vessel segment in 2-D
angiographic images, which can be defined as the external force
projective iteration model (EFPIM)-based methods.
To solve the nonstrict matching problem of EFPIM-based
method, our previous work has proposed a novel external force
back-projective composition model (EFBPCM) for deforming
the vasculature, and hence, improving the reconstruction accuracy [24], [25]. In contrast to the traditional EFPIM-based
method, the driving forces of the deformable model are backprojected from the image to the 3-D space and composited in
the same coordinate based on the perspective projection geometry of the angiograms. And our previous work [25] mainly
aims to solve the reconstruction problem for two angiographic
images. In clinical practice, the physician usually acquires 5–7
full cardiac cycle at different imaging angle, and there are usually 70–90 images obtained during the acquisition. It is obvious
that the reconstruction accuracy improves with the increase of
the angiographic images involved for the 3-D reconstruction.
If more than two angiograms are available for the 3-D reconstruction, traditional methods usually first iteratively utilize two
angiograms for the reconstruction, then the final results are determined by calculating the average [26] or by bound adjustment
optimization [23] of all the intermediate results obtained by two
images. However, for such methods, it is obvious that the reconstructed intermediate results with large errors may induce more
uncertain factors to the final results. To improve the reconstruction accuracy, in this study, we extend the previous EFBPCM to
multiple angiographic images, which fully utilize the extra information provided by images acquired at different angles. And
a novel mean composited EFBPCM is proposed to minimize
error accumulation for multiple angiograms, which is named as
MC-EFBPCM. As the diameter of the coronary recovered in 3-D
space is decided by the composition effects of diameter estimation in every 2-D angiograms, a novel diameter fitting method

for the composition model is proposed for accurate diameter reconstruction. This paper also aims to evaluate the performance
of the deformable-model-based methods, for which the factors
that affect the reconstruction accuracy are analyzed in detail.
II. RELATIVE WORK
Given an open 3-D curve X(s) = [x(s), y(s), z(s)], s ∈
[0, 1], the deformable model can be generally defined as follows [15]:
 1
[Einternal (X(s)) + Eexternal (X(s))]ds (1)
Eenergy =
0

where Einternal and Eexternal are the internal and external energies, respectively. During the reconstruction process, the external force pushes the model to deform its shape, whereas the
internal force serves to maintain its smoothness. Under the constraint of internal and external forces, the deformable curve
can evolve gradually toward the true vascular centerline in 3-D
space. According to the energy conversion principle, (1) can be
transformed into the followed iterative from:
n
)
Xin +1 = (A + γI)−1 (Xin − fj,i

(2)

where Xi is the sampling point of the 3-D curve, γ is the weightn
is the composited energy. A is an m × m
ing coefficient, and fj,i
diagonal matrix decided by Xi and can be denoted as follows
[15], [16]:
⎤
⎡
1 0
0
0 ... ...
0
0 0
⎢0 1
0
0
0 ... ...
0 0⎥
⎥
⎢
⎢a b
c
b
a
0
.
.
.
.
.. 0⎥
⎥
⎢
⎢
.. ⎥
⎢0 a
b
c
b
a
0 ... . ⎥
⎥
⎢
⎢ .. . .
.. ⎥ ,
..
..
..
..
..
..
A = ⎢.
.
.
.
.
.
.
.
.⎥
⎥ (3)
⎢
⎥
⎢.
⎢ .. . . .
0
a
b
c
b
a 0⎥
⎥
⎢
⎢0 ... ...
0
a
b
c
b a⎥
⎥
⎢
⎣0 0 ... ...
0
0
0
1 0⎦
0 0 	 0 . . .
 . . . 	0
0 
0 1
a = − hβ4 , b =

α
h2

+

4β
h4

,c = −

2α
h2

+

6β
h4

where α and β are weighted parameters, which control the
elasticity and stiffness of the deformable curve in space. While
h is the step size.
The 3-D coordinate Oj − Xj Yj Zj is constructed at the optical center of the jth image, whereby Xj and Yj are parallel
to the image coordinates Uj and Vj , respectively, as shown in
Fig. 1. ϕj , θj and φj denote the rotation angles between coordinates Oj − Xj Yj Zj and the original coordinate O − XY Z
corresponds to the X, Y , and Z axes, respectively. Uj,i represents the projection image coordinate corresponding to space
point Xi . Let eUj,i represents the external force at image point
Uj,i , eUj,i |U and eUj,i |V represent the back-projected force that
corresponds to the axes of Uj and Vj , respectively. In this study,
the rotation order is defined as X → Y → Z.
The effect of translation can be neglected during force composition because the composition and subtraction of space vectors are only decided by their rotation angles. As the force

CONG et al.: QUANTITATIVE ANALYSIS OF DEFORMABLE MODEL-BASED 3-D RECONSTRUCTION OF CORONARY ARTERY

Fig. 1.

Energy back-projection and scaling principle.

components from different angiographic images are independent and can be composited together, components eUj,i |U and
eUj,i |V of the external forces are back-projected into 3-D space
and decomposed into the three axes of O − XYZ, which can be
defined as eq.(4) as shown at the bottom of the page.
sum
where m denotes the number of views, and f xsum
j,i , f yj,i , and
sum
f zj,i represent the summaries of force component in the three
axes in coordinate O − XYZ.
Under the composited forces of the internal and external constraints in 3-D space, all points on the predefined curve can
evolve gradually to adapt the shape of the curve on the condition that the total reprojection errors will reach the minimum.
The developed external force back-projection and composition
model is general and can be used for any form of external force,
such as PE, GVF, and GGVF.
III. METHODOLOGY
A. Limitations of EFPIM-Based Method
The deformable-model-based 3-D reconstruction methods of
vascular structures from multiple angiographic images generally consist of the following four main steps [18]–[20], [23]:
1) the start and end points in the two angiographic images are
manually selected and paired, and two parametric snakes are
then initialized in the corresponding angiograms by constructing straight lines between these two pairs of correspondences.
2) The energy function of the deformable model is increased
by combining the external and internal forces. The external
force is devised to push the deformable curve toward the target,
whereas the internal force is devised to maintain the smoothness
of the deformable curve. 3) Under the combination of forces, the

deformable curves will gradually evolve into the shape of the
target vessels in the two angiograms. 4) The correspondences
for the evolved curves in the two angiograms are paired and then
utilized to construct the 3-D coordinates in space via the regular
triangulation method. 5) Steps 3 and 4 are iteratively repeated
until the summarized error of every correspondence is less than
a predefined threshold. The 3-D vessel structure can be finally
calculated, wherein the projections in the two angiograms are
close to the extracted vascular skeletons in the two angiograms.
Such methods utilize projected energy in the angiographic image to approach the vascular target iteratively; hence, it can be
named as EFPIM.
A major problem with the EFPIM-based method is that the
correspondences used to reconstruct the 3-D vessel coordinates
cannot strictly follow the epipolar constraint during the curveevolving procedure, which is a primitive problem for the 3-D
reconstruction of nature scenes in computer vision solutions.
Hence, the reconstruction errors may accumulate during the
curve evolution, which can be named as a nonstrict matching
problem. The internal parts of the parametric lines are regularly
interpolated to find the correspondences because the start and
end correspondence pairs are manually defined. The correspondences are then used to reconstruct the corresponding 3-D coordinates in space based on the perspective projection principle
of pinhole camera model. The initial correspondences may satisfy the epipolar constraint, but the motion of correspondences
in the angiographic images is under the combination of forces
of the external and internal forces for the continued steps of
evolution. Hence, the corresponding relationship cannot strictly
follow the epipolar geometry during the iteration process. Therefore, the nonstrict matching used for the 3-D reconstruction may
induce a large amount of error accumulated from every iteration
steps.
Fig. 2 shows an example of the nonstrict matching probn
n
(unj,i , vj,i
) is the projection of a spatial point
lems. Suppose Uj,i
n
n
n
n
Xi (xi , yi , zi ) in the jth angiographic image at the nth iteran
n
and U3,i
tion. Under the epipolar constraint, the location of U2,i
in the second and the third images must lie on the epipolar line
n +1
n
in the first image. Let Uj,i
lu2 n1 , i and lu3 n1 , i that correspond to U1,i
represent the projection coordinates of Xin in the jth image at the
(n + 1)th iteration. Our experiments show that the location of
n +1
n +1
and U3,i
do not lie on the epipolar line lU2 n + 1 and lU3 n + 1
U2,i
1,i

1,i

n +1
n +1
n +1
in these two images. Therefore, U1,i
, U2,i
, and U3,i
no
longer satisfy the epipolar constraints and the nonstrict matching

⎧
m
m


⎪
f xsum
=
eUj,i |U cos(φj,i ) cos(θj,i ) −
eUj,i |V sin(φj,i ) cos(θj,i )
⎪
j,i
⎪
⎪
j =1
j =1
⎪
⎪
⎪
m
m


⎪
⎪
⎪
f yjsum
=
eUj,i |U cos(φj,i ) sin(θj,i ) sin(ϕj,i ) +
eUj,i |U sin(φj,i ) cos(ϕj,i )
,i
⎪
⎪
⎪
j =1
j =1
⎪
⎨
m
m


+
eUj,i |V cos(φj,i ) cos(ϕj,i ) −
eUj,i |V sin(φj,i ) sin(θj,i ) sin(ϕj,i )
⎪
j =1
j =1
⎪
⎪
m
m
⎪


⎪
⎪
f zjsum
=−
eUj,i |U cos(φj,i ) sin(θj,i ) cos(ϕj,i ) +
eUj,i |U sin(φj,i ) sin(ϕj,i )
⎪
,i
⎪
⎪
j =1
j =1
⎪
⎪
m
m
⎪


⎪
⎪
+
eUj,i |V cos(φj,i ) sin(ϕj,i ) −
eUj,i |V sin(φj,i ) sin(θj,i ) cos(ϕj,i )
⎩
j =1

2081

j =1

(4)

2082

Fig. 2.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

Nonstrict matching problem of the EFPIM-based method.

may lead to the accumulation of the reconstruction error during
the deformable model evolution.
Another main problem for the EFPIM-based method is the
comparatively low calculation efficiency and the possible large
accumulation of errors because of tedious correspondence determination procedures when more than two angiograms are
involved in the reconstruction. The 3-D coordinates of the vascular structure should be triangulated from the paired correspondences for every iteration step. Although the reconstruction results may be refined to a particular extent by using more
angiographic views, the correspondence determination for multiple views is extremely time-consuming and may also lead to
divergent iterations.

B. MC-EFBPCM
The main concept of the MC-EFBPCM is that the external
forces are normalized and integrated from all angiographic images into the predefined world coordinates based on their projection geometry. The deformable model is then directly constructed in 3-D space by defining the integrated back-projective
and composited forces as the external energy. In contrast to the
EFPIM-based method wherein the curve is deformed in projection images, the parametric snake evolves in 3-D space based
on the combined internal and the external force back-projected
from 2-D angiograms. Once the geometrical relationship between the angiograms at different imaging angles is determined,
the external energy map in space can also be determined. Hence,
the proposed MC-EFBPCM-based method effectively avoids
the nonstrict matching problem.
The general EFBPCM is appropriate to 3-D reconstruction
of coronary arteries using two angiographic images. It is obvious that if more images involved for the 3-D reconstruction, the
more accurate will be the reconstruction result. However, from
our experiments, we found that with the increase in the number of angiogram, the composited external energy in space will
also be augmented. As a result, the projection of the deforming curve may exceed the angiographic image boundary, which
hence leads to failure of the algorithm. To solve this problem, in
this study, we propose an adaptive constrained method for the

adjusting of the composited external energy, which is named as
adaptive constrained EFBPCM.
Let Uj,i represents the jth projection image coordinate corresponding to the space point Xi . fj,i represents the external

is the back-projection of fj,i
force at the image point Uj,i . fj,i
in space. Let fi represents the adaptive constrained forces of all
the back-projection forces in mth angiographic images, and we
have
⎧

fi = favg × n i
⎪
⎪
⎪
⎪
m

⎨
|f j , i |
j
(5)
avg
f
=
⎪
m
⎪
⎪ i
⎪
⎩ n = f 1 , i ×f 2 , i ×···×f m , i
i
|f 1 , i ×f 2 , i ×···×f m , i |

represents the back-projection force in the jth projecwhere fj,i

tion image for the space point Xi and n i represents the direction
av g
represents the average force of Xi , which
vector of Xi . fi
is utilized as the external force to drive the moving of the ith
point in space. The average driving force effectively preserves
the combination effects of the back-projection forces obtained
from every projection image, which hence can guarantee the
effectiveness of the external forces.

C. Diameter Estimation
Once the 3-D centerline of the coronary artery tree is recovered, the diameter of each sampling point on the centerline
should be estimated [27]–[30]. Majority of current algorithms
assume that the cross section of a vascular segment is a regular circle. However, this regular circle is not true for real
angiograms, specifically for a vessel segment with unilateral
stenosis. In such a case, the detected diameter in the angiogram
will be larger than the true width of the stenosis if the imaging angle of the C-arm is not perpendicular to the narrowest
view of the vessel. Hence, the size of the stenosis cannot be
accurately estimated. Multiple views from different angles provide more information to determine the diameter of the vessel
segments. However, the accuracy of the diameter recovery is
strictly correlated with the projection angle of the vessel segments. Suppose that dj,i denotes the 2-D diameter of the projection Uj,i (uj,i , vj,i ) of the spatial point Xi on the vascular
centerline at the jth image, as shown in Fig. 3. The 3-D luminal
diameter Dj of Xi can be calculated by the following equation
[31]:


2
2 +O
Di = dj,i ( x2i + yi2 + zi2 / u2j,i + vj,i
(6)
view Oj )
where Oview Oj is the source-to-intensifier distance (SID) of
the C-arm.
In [28], we proposed that the cross-sectional plane of two
projection views could be obtained by ellipse fitting of the
four intersections between the projection plane and the vascular volume. In this study, we extend the cross-sectional plane
calculation by using multiple projection views. Suppose i is
the cross-sectional plane centered at point Xi in 3-D space,
1,i , 2,i , . . . , j,i are the intersection planes projected from
different views centered at Xi . Let lj,i denote the cross-line of
i and j,i . The length of lj,i can be calculated using (6) by

CONG et al.: QUANTITATIVE ANALYSIS OF DEFORMABLE MODEL-BASED 3-D RECONSTRUCTION OF CORONARY ARTERY

Fig. 3. Cross-sectional determination for the 3-D reconstruction of the vessel
segment.

utilizing the boundary intersections Xj,i,1 (xj,i,1 , yj,i,1 , zj,i,1 )
and Xj,i,2 (xj,i,2 , yj,i,2 , zj,i,2 ). The function of the section of
the vessel can be defined as follows:
⎧
F (X  ) = lj,i /2,
j=1
⎪
⎪
⎪
⎪

2
2
⎪
j=2
⎪
⎨ F (r, X ) = x + y + r,

F F (a, b, c, d, e, X ) =
(7)
⎪
⎪
2


2


⎪
⎪
ax + bx y + cy + dx + ey + f,
⎪
⎪
⎩ 2
j≥3
(b < ac, a > 0, c > 0)
Equation (7) demonstrates that the accuracy of diameter estimation is strictly correlated with the number of projections
involved for the calculation. The cross section of the vessel can
be estimated as a circle when only one view is involved. By
contrast, the cross section of the vessel is defined as an ellipse
when two views are involved and fitted by the four intersections of l1,i , l2,i by the least square method. The cross section
of the vessel can be defined as an ellipse when j ≥ 3 and fitted by all the intersections of l1,i , l2,i , . . . , lj,i . In summary, the
reconstruction accuracy increases with increasing number of
angiograms.
D. Reconstruction Accuracy Analysis
The reconstruction accuracy of the vascular structure is tightly
correlated to the angular difference of the involved angiograms
because of the limited number of angiograms used for 3-D reconstruction [32]. The correlation of the images decreases with
increasing angle difference; hence, more information can be
used for the reconstruction [33], [34]. However, corresponding
vascular features in angiograms with a large angle difference are
difficult to find [35], [36]. This section aims to analyze quantitatively the influence of angle difference on the reconstruction
accuracy for the parametric-model-based method.
The orientation of the C-arm is determined by the caudal/cranial oblique (CAU/CRA) and left/right anterior oblique
(LAO/RAO) rotation angles for the angiographic device. The

2083

Fig. 4. External force projection relationship with respect to the anglebisecting plane of two images.

CAU/CRA angle is set as constant to simplify the quantification procedure, whereas the influence of LAO/RAO angle
n
is the prodifference is discussed in detail. Suppose Uj,i
n
jected points of the ith spatial point Xi in the jth images
n +1
is the corresponding imat the nth iteration, whereas Uj,i
age points of the (n + 1) th iteration of the space point
n →n +1
n →n +1
Xin +1 . Let Uj,i
= Uj,i
denote the displacement vecn +1
n →n +1
n
to Uj,i
· Uj,i
can be detor of projection points Uj,i
composed based on the vector projection principle into two
displacement vectors along Uj and Vj axes in the jth image,
n →n +1
n →n +1
n →n +1
= Uj,i
|U j + Uj,i
|V j . Let Δδ reprewhere Uj,i
sent the intersection angle between images 1 and 2 and π represents the angle-bisecting plane of Δδ, as shown in Fig. 4.
A space coordinate X0 Y0 Z0 can then be constructed on plane
π. Z0 is parallel to Uj , whereas Y0 is the normal vector of
plane π for this coordinate system. X0 can then be defined
as the cross product of Y0 and Z0 in the left-hand coordin →n +1
nate. Uj,i
can be decomposed into the X0 Y0 Z0 coordinate
n →n +1
n →n +1
n →n +1
n →n +1
= Uj,i
|X o + Uj,i
|Y o + Uj,i
|Z o ; thus,
as Uj,i
n →n +1
n →n +1
n →n +1
Uj,i
|V i = Uj,i
|X o + Uj,i
|Y o is obtained. Based
on the imaging-angle relationship between π and the jth imaging
plane, the following equation is obtained:
⎧

 ◦
n →n +1
⎪
|V j sin 180 2−Δ δ
U n →n +1 |X 0 = Uj,i
⎪
⎨ j,i

 ◦
n →n +1
n →n +1
(8)
Uj,i
|Y 0 = Uj,i
|V j cos 180 2−Δ δ
⎪
⎪
⎩ U n →n +1 | = U n →n +1 |
j,i

Z0

j,i

Uj

n →n +1
n
where Uj,i
represents the motion vector of point Uj,i
from
the nth iteration to the (n + 1) th iteration for the traditional
n →n +1
EFPIM-based method. By contrast, Uj,i
represents the external force for every image pixel at two consecutive iteration
steps for the EFBPCM-based method. Equation (8) shows that
n →n +1
in the direction of X0 and Y0 are
the motion vectors of Uj,i

2084

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

not only correlated with 2-D motion vector in the two images
but are also determined by the angle difference of the two imaging planes. Moreover, the motion vector in the direction of Z0
is only determined by the 2-D motion vector in the direction of
n →n +1
|X 0
Uj in the jth image. By contrast, the motion vector Uj,i
for two consecutive iteration steps is extremely small in the 2-D
images. Hence, the reconstructed motion vector in the 3-D space
will be also extremely small if the intersection angle Δδ between
the two images is also small. In such a situation, the approach of
the deformable model to the true vessels in the direction of X0 is
difficult. By contrast, the approach of the deformable model to
the true vessels in the direction of Y0 is extremely difficult.
IV. EXPERIMENTAL RESULTS
A. Phantom Data
In this section, a series of experiments were conducted using
phantom data to investigate the performance of the proposed
MC-EFBPCM-based method. The phantom data were simulated from the CTA data obtained from Grand Challenge 2012
of the International Conference on Medical Image Computing
and Computer-Assisted Intervention [37]. The dataset contained
the coronary skeletons and the original CTA images and the 3-D
skeletons were composed of 17 098 sampling points with resolutions of (0.36, 0.36, 0.4) mm. The intrinsic parameters, including
SID, source-to-object distance, field of view, radiographic magnification factors (RMF), and image pixel spacing (IPS), were
obtained from the clinical angiographic device. The parameters
of the internal and external matrices were customized based on
the true angiographic system; thus, the imaging processes of
the device can be effectively simulated. The entire algorithm
was implemented in the C++ programming language in the
Linux platform, and the experiments were performed on a relative low-cost desktop computer with an i7-2600 processor and
16G memory.
The criteria for quantifying accuracy are as follows. 1) Image reprojection error (IRPE): the Euclidean distance between
a set of centerline points in projection image and the corresponding reprojected 2-D centerline points in the image; and
2) Space error (SE): the Euclidean distance between a set of
centerline points of the phantom data and the reconstructed centerline points in 3-D space. Generally, IRPE is utilized to measure reprojection error in the angiographic images, while SE is
employed to measure reconstruction error in 3-D space. It is obvious that SE is the ground truth for evaluating the performance
of the reconstruction error. However, for clinical angiograms,
it is difficult to obtain the true structure of coronary arteries
inside the human body. Hence, we only can utilize IRPE for
the algorithm quantification. In the above section, we have theoretically analyzed the validity of the reprojection error with
respect to the ranges of angle difference between the angiographic images. From the comparative analysis of SE and IRPE
on the phantom datasets, the effective conditions of IRPE for
evaluating the reconstruction error are demonstrated.
A theoretical analysis was presented for the effects of the
factors on the vessel reconstruction accuracy for both EFPIMand MC-EFBPCM-based methods in Sections II and III. The
following experiments were designed to verify the nonstrict

Fig. 5. Nonstrict matching problem for EFPIM based method. (A) shows the
deformable curve in 3-D space, wherein the three cones represent the viewing
angles corresponding to (B), (C), and (D). (B)–(D) show the projection curves
of the true skeleton and initial deformable curve in the image planes. (B ),
(C ), and (D ) show the magnified views of two consecutive iteration steps that
correspond to (B), (C), and (D).

n
denotes the projections
matching problem. In these figures, Uj,i
0
of the ith spatial point Xi in the jth images. Fig. 5(B)–(D) show
0
0
0
and U3,i
rest on the epipolar line of U1,i
;
that the location of U2,i
1
1
and U3,i
were not located on the epipolar line
however, U2,i
1
1
1
after one iteration step. Û2,i
and Û3,i
are the corresponding
U1,i
1
points with U1,i . d2,i and d3,i denote the distance errors between
1
1
1
1
, Û3,i
, and Û2,i
,Û3,i
. The experiment demonstrated that the
Û2,i
original pair of corresponding points did not satisfy the epipolar
constraints after the points moved to the new locations under the
combination effects of the internal and external forces. Hence,
the reconstruction error may have accumulated when the spatial
points were reconstructed with corresponding points obtained
by the epipolar constraints.
In addition, traditional EFPIM is generally used for vessel
reconstruction with two angiographic images. EFPIM-based
methods usually iteratively use the combination of two angiograms to reduce the calculation burden if three or more angiographic images are involved for the 3-D reconstruction. The final
results were obtained as the average
of all the combination
calcu

lations. Fig. 5 shows that Xi1 (u 1 ,u 1 ) and Xi1 (u 1 ,u 1 ) are the
1,i

2,i

1,i

3,i

1
1
, U2,i
)
reconstructed results with respect to image points (U1,i
1
1
and (U1,i , U
).
Particular
distance
variations
were
present
be 3,i

tween X 1  1 1 and X 1  1 1 and the mean values
i (U ,U )
1,i
2,i

i (U ,U )
1,i
3,i

of these two reconstructed points were obtained as the final
results. Thus, the correlation relationship between multiple
angiograms was not used effectively and a large error may
have been introduced for the reconstruction results. The proposed MC-EFBPCM method can practically avoid error accumulation compared with the EFPIM method because of the
following reasons: 1) the external forces in different angiograms

CONG et al.: QUANTITATIVE ANALYSIS OF DEFORMABLE MODEL-BASED 3-D RECONSTRUCTION OF CORONARY ARTERY

Fig. 6. Comparison of reconstruction accuracy of EFPIM- and MC-EFBPCMbased methods. 1) -EFPIM (Images A and B); 2) -EFPIM (Images A and C); 3)
-EFPIM (Images B and C); 4) -EFPIM (Mean); 5) -MC-EFBPCM.

are back-projected into 3-D space and composited in the same
coordinates; hence, the nonrigid matching problem can be
avoided and 2) the external forces in different views are independent and the motion of the parameter curve is under the
combination of forces in the space; thus, the forces in multiple
views can be used simultaneously.
To validate the effectiveness of the proposed method, three
angiographic images acquired at the same cardiac cycle are utilized for the 3-D reconstruction, and the external forces of PE,
GVF and GGVF are evaluated independently, as can be seen in
Fig. 6. To convenient for the comparison, the three angiographic
images utilized for the reconstruction are denoted as A to C, respectively. It can be seen that if two images are utilized for the
3-D reconstruction, there are large variations for the reconstruction accuracies. The reason is that the reconstruction results of
two angiographic images are highly dependent on their angle
difference. Hence, if more than two images are utilized for the
3-D reconstruction, it is not appropriate to randomly choose
two images for the reconstruction. In addition, it can be seen
that SEs for PE-EFPIM, GVF-EFPIM, GGVF-EFPIM, PE-MCEFBPCM, GVF-MC-EFBPCM, and GGVF-MC-EFBPCM are
1.18, 0.87, 0.66, 0.99, 0.80, and 0.57 mm, respectively. Obviously, the proposed GGVF-MC-EFBPCM achieves the best
reconstruction results for all the compared methods.
A series of experiments were designed with respect to the
external energies of PE, GVF, and GGVF to verify the effectiveness of the proposed MC-EFBPCM-based method. The
commonly used EFPIM-based method was executed and compared with the proposed method. For the phantom experiments,
the 3-D reconstruction results are evaluated on two to five angiographic images. The reconstruction results were quantitatively obtained and the algorithm was objectively evaluated by
calculating IRPEs and SEs. Table I demonstrates the reconstruction accuracies for the PE-EFPIM, GVF-EFPIM, GGVFEFPIM, PE-MC- EFBPCM, GVF-MC-EFBPCM, and GGVFMC-EFBPCM methods with respect to the different number
of angiographic images. Data 1 to data 4 are designed to use
two to five angiographic images for the 3-D reconstruction.
While the first to the fifth IRPE represent the reprojection error in the first to the fifth angiographic images, respectively.
Moreover, the reconstruction results obtained by using different numbers of angiographic images were tested and compared.
IRPEs in the image were all minimized to a constant range of
0.3–0.4 mm. The projection skeletons in the angiographic images were quite close to the true vascular centerlines. SEs for

2085

PE, GVF, and GGVF for EFPIM-based methods when two angiographic images were used for the reconstruction are 1.22,
0.91, and 0.66 mm, respectively.
Large variations in SEs were observed when more than two
images were involved for the calculation. The GVF-EFPIM
method shows that SEs for two to five images were 0.910,
0.787, 0.913, and 0.854 mm, respectively. Thus, a higher number of images involved for the calculation cannot guarantee the
increase in reconstruction accuracy. GGVF appears to be the
best method for 3-D reconstruction among the EFPIM-based
methods. SEs for two to five images involved in the calculation
were 0.660, 0.708, 0.602, and 0.651 mm, respectively. By contrast, SEs in the MC-EFBPCM-based methods decreased with
increasing number of angiographic images involved in the calculation. Moreover, among the three external forces, GGVF had
the minimum SEs independent of the number of angiographic
images involved in the calculation. In summary, the following
conclusions are obtained: 1) the proposed MC-EFBPCM-based
methods can obtain a higher reconstruction accuracy than the
EFPIM-based methods when the external force is the same form
(PE, GVF, or GGVF) and 2) GGVF is more effective than PE
and GVF for both MC-EFBPCM- and EFPIM-based methods
for the 3-D reconstruction of coronary arteries.
To investigate the 3-D reconstruction accuracy with respect to
the number of angiographic images utilized for the reconstruction, in this study, two to five angiographic images are generated
on phantom data and utilized for the 3-D reconstruction. For our
experiments, the MC-EFBPCM- and EFPIM-based methods utilizing different forms of external forces, including PE, GVF, and
GGVF, are evaluated on the generated two to five angiographic
images. Fig. 7 compares IRPEs and SEs of different methods. It
can be seen that the mean IRPEs for whether the different number of images or different methods are very constant, which have
been constrained to a tight range of 0.325–0.412 mm. While for
SEs, it can be seen that the proposed GGVF-MC-EFBPCM is
the best, which can obtain the minimum reconstruction error for
all the compared methods with a determined number of images.
Furthermore, it can be seen that the reconstruction accuracy improves with the increase of the number of images involved for
the 3-D reconstruction. Among all the three utilized external
forces, the GGVF is the best, and it can achieve the minimum
reconstruction error.
Tables II and III compare the amplitude of variation of the
IRPE an SE between the EFPIM- and MC-EFBPCM-based
methods by using paired t-test. For these experiments, the coronary arteries are reconstructed by the different number of projection angiograms as well as different external forces. Then,
we calculate the IRPE and SE in the 2-D angiograms and in
3-D space, respectively. In these two tables, X̄ and S represent
the mean and standard deviation of the sample, while t and
p-value represent the statistical magnitude and the significant
value of the paired t-test. From Table II, it can be seen that there
are totally ten groups of datasets with the p-value larger than
a commonly accepted value of 0.05, which indicate there is no
significant difference between the EPIM- and MC-EFBPCMbased methods for the IRPE in the projection angiograms. As
both the EPIM- and MC-EFBPCM-based methods can obtain a

2086

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

TABLE I
COMPARISON OF RECONSTRUCTION ACCURACY FOR DIFFERENT METHODS WITH RESPECT TO A DIFFERENT NUMBER OF ANGIOGRAPHIC IMAGES
Data

1

2

3

4

Mean 3-D Space

Images

1st IRPE
2nd IRPE
Mean-IRPE
SE
1st IRPE
2nd IRPE
3rd IRPE
Mean-IRPE
SE
1st IRPE
2nd IRPE
3rd IRPE
4th IRPE
Mean-IRPE
SE
1st IRPE
2nd IRPE
3rd IRPE
4th IRPE
5th IRPE
Mean-IRPE
SE
1.181

PE

GVF

GGVF

EFPIM

MC-EFBPCM

EFPIM

MC-EFBPCM

EFPIM

MC-EFBPCM

0.338
0.373
0.356
1.220
0.395
0.373
0.369
0.379
1.271
0.349
0.333
0.338
0.344
0.341
1.034
0.318
0.366
0.319
0.358
0.393
0.351
1.198
0.990

0.384
0.390
0.387
1.066
0.336
0.400
0.324
0.353
1.052
0.374
0.346
0.350
0.348
0.355
0.939
0.355
0.353
0.314
0.388
0.347
0.351
0.901
0.990

0.361
0.338
0.350
0.910
0.360
0.342
0.349
0.350
0. 819
0.335
0.317
0.353
0.325
0.333
0.913
0.327
0.398
0.355
0.328
0.398
0.361
0.854
0.802

0.337
0.376
0.357
0.883
0.376
0.34
0.397
0.371
0. 787
0.384
0.328
0.331
0.357
0.35
0.761
0.367
0.388
0.334
0.347
0.323
0.352
0.746
0.655

0.381
0.365
0.373
0.660
0.367
0.393
0.389
0.383
0.708
0.328
0.373
0.362
0.326
0.347
0.602
0.338
0.362
0.357
0.336
0.325
0.344
0.651
0.570

0.342
0.314
0.328
0.614
0.383
0.321
0.350
0.351
0.601
0.355
0.328
0.341
0.338
0.341
0.564
0.386
0.349
0.298
0.399
0.330
0.352
0.502

Data 1 to data 4 utilizing two to five angiographic images for the 3-D reconstruction, while the first to the fifth IRPE represent
the reprojection error in the first to fifth angiographic images, respectively. Unit: mm.

Fig. 7. Quantitative analysis of the final reconstruction results of different methods from the first column to the fourth over two to five angiographic images used
for the reconstruction, respectively. 1) PE-EFPIM; 2) PE-MC-EFBPCM; 3) GVF-EFPIM; 4) GVF-MC-EFBPCM; 5) GGVF-EFPIM; 6) GGVF-MC-EFBPCM.

minimum value of IRPE, it can be concluded that the defined
external energies capable of driving the deformable model approach the vascular centerlines in the 2-D angiographic images.
As the optimizing functions for both methods are defined as
the Euclidian distances between the target centerlines and the

deformation curves, all the reprojection errors are minimized
to the extremity values of subpixel. Table III compares SE for
the EPIM- and MC-EFBPCM-based methods in 3-D space using the paired t-test. It can be seen that all the 12 groups of
data are with the p-value smaller than the commonly accepted

CONG et al.: QUANTITATIVE ANALYSIS OF DEFORMABLE MODEL-BASED 3-D RECONSTRUCTION OF CORONARY ARTERY

2087

TABLE II
COMPARATIVE ANALYSIS OF IRPE FOR DIFFERENT METHODS IN 2-D ANGIOGRAMS USING PAIRED T-TEST
External Energy

PE

Image Num.

2
3
4
5
2
3
4
5
2
3
4
5

GVF

GGVF

EFPIM

X̄ + S
MC-EFBPCM

Difference

0.356 ± 0.094
0.379 ± 0.118
0.341 ± 0.093
0.351 ± 0.092
0.350 ± 0.110
0.350 ± 0.096
0.333 ± 0.103
0.361 ± 0.098
0.373 ± 0.103
0.383 ± 0.112
0.347 ± 0.090
0.344 ± 0.095

0.387 ± 0.082
0.353 ± 0.108
0.355 ± 0.099
0.351 ± 0.106
0.357 ± 0.105
0.371 ± 0.088
0.350 ± 0.100
0.352 ± 0.116
0.328 ± 0.088
0.351 ± 0.113
0.341 ± 0.104
0.352 ± 0.103

0.031 ± 0.121
0.026 ± 0.158
0.014 ± 0.129
0.000 ± 0.154
0.007 ± 0.168
0.021 ± 0.140
0.017 ± 0.155
0.009 ± 0.138
0.045 ± 0.141
0.032 ± 0.172
0.006 ± 0.145
0.008 ± 0.132

Sample Num.

41
61
35
50
55
46
59
67
61
52
57
43

t

p-value

−0.553
−0.828
2.780
2.091
1.117
2.315
−1.566
0.722
−0.924
−0.654
1.041
0.265

0.583
0.411
0.009
0.042
0.269
0.025
0.123
0.473
0.359
0.516
0.302
0.793

TABLE III
COMPARATIVE ANALYSIS OF SE FOR DIFFERENT METHODS IN 3-D SPACE USING PAIRED T-TEST
External Energy

PE

GVF

GGVF

Image Num.

2
3
4
5
2
3
4
5
2
3
4
5

EFPIM-

X̄ + S
MC-EFBPCM-

Difference

1.220 ± 0.116
1.271 ± 0.121
1.034 ± 0.112
1.198 ± 0.105
0.916 ± 0.095
0.901 ± 0.089
0.879 ± 0.098
0.854 ± 0.109
0.760 ± 0.095
0.708 ± 0.098
0.602 ± 0.101
0.651 ± 0.105

1.066 ± 0.143
1.052 ± 0.122
0.939 ± 0.096
0.901 ± 0.086
0.836 ± 0.107
0.817 ± 0.096
0.761 ± 0.102
0.746 ± 0.100
0.614 ± 0.097
0.601 ± 0.084
0.564 ± 0.087
0.502 ± 0.131

0.154 ± 0.193
0.219 ± 0.126
0.095 ± 0.137
0.297 ± 0.159
0.080 ± 0.129
0.084 ± 0.146
0.118 ± 0.133
0.108 ± 0.121
0.146 ± 0.131
0.107 ± 0.136
0.038 ± 0.126
0.149 ± 0.180

Sample Num.

41
61
35
50
55
46
59
67
61
52
57
43

significant value of 0.05, which demonstrate there are significant differences between the EPIM- and MC-EFBPCM-based
methods. Obvious, the proposed MC-EFBPCM greatly reduces
the SE than that of the EPIM-based method. According to the
definition of SE, it can be concluded that the proposed MCEFBPCM method outperforms the EPIM- method for the 3-D
reconstruction of coronary arteries.
Fig. 8 shows the reconstruction results of one vascular centerline sample by using the GGVF-MC-EFBPCM-based method.
Fig. 8(A) shows 2-D images in three different views, whereas
Fig. 8(B) shows the reconstruction results by using the 2-D images of 8(A) at three random views. Fig. 8(C) shows that SEs in
terms of the Euclidean distance to the ground truth. The reconstruction centerlines are accurately matched with the true vessel
centerlines both at the root and terminal parts and the average error is 0.65 mm. Fig. 8(D) shows the reconstructed surface of the
vascular structures with diameter information. The topological
structure of the vasculature is accurately preserved.
The influence of angle difference on the final reconstruction
accuracy has been discussed in detail in Section V. If the angle
difference is extremely small or extremely large, the projections
of the reconstruction results in the corresponding angiographic
images may accurately overlap with the real vessel but the reconstruction error in 3-D space will be extremely large. Fig. 9
shows the relationship between the angle difference and the reconstruction accuracy by using two angiographic images. The

t

p-value

25.769
2.997
4.461
10.254
2.461
5.473
4.250
10.724
1.629
15.514
6.338
6.201

< 10 −4
0.004
< 10 −4
< 10 −4
0.003
< 10 −4
< 10 −4
< 10 −4
< 10 −4
< 10 −4
< 10 −4
< 10 −4

curve of SE presents a bowl-shaped distribution. Moreover, the
3-D reconstruction errors rapidly decrease from 3.7 to 0.5 mm
for an angle difference in the range of [0◦ , 45◦ ], whereas the
3-D reconstruction errors rapidly increase from 0.5 to 3.7 mm
for an angle difference in the range of [135◦ , 180◦ ]. Moreover,
the 3-D reconstruction errors are quite constant in the range of
[45◦ , 135◦ ], which may reach a minimum of 0.56 mm at 90◦ . The
projection errors in the two angiographic images compared with
the 3-D reconstruction error are constant, with a mean value of
0.28 mm and a standard deviation of 0.06 mm. Fig. 9 shows that
although projection errors in the images are extremely small, the
3-D reconstruction errors are larger than the error in the images
and can be clearly visualized. Moreover, the errors in an angle
difference of 75◦ are larger than those at 15◦ for both image and
SEs. The two following conclusions can be obtained from this
experimental analysis: 1) the reconstruction accuracy is strictly
correlated with the angle difference of two angiographic images
used for the reconstruction and 2) the reconstruction accuracy
cannot be estimated by the error in the projection images; SE
should be evaluated for accuracy quantification.
B. Clinical Coronary Angiogram
To validate the performance of the proposed algorithm, in this
study, a series of routine clinical angiograms acquired from a
GE Innva 2000 XRA device at the Beijing Anzhen Hospital are

2088

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

TABLE IV
IMAGING PARAMETERS OF DIFFERENT DATASETS
Data Images LAO/RAO (Degree) CAUD/CRAN (Degree) SID (mm) RMF IPS (mm)
1
2
3

4

5

6

1st
2nd
1st
2nd
1st
2nd
3rd
1st
2nd
3rd
1st
2nd
3rd
4th
1st
2nd
3rd
4th

37.5
76.6
−36.1
19.4
16.4
−15.7
−45.3
−56.4
−17.1
26.9
−49.3
−18.6
12.4
41.4
39.0
−3.8
37.7
31.7

12.1
12.4
−6.3
−6.9
−7.7
−7.9
−8.3
15.5
15.9
16.1
20.3
20.7
21.1
21.4
−2.7
29.0
3.8
1.7

841.27
841.27
562.31
562.31
544.94
544.94
544.94
571.22
571.22
571.22
747.59
747.59
747.59
747.59
636.19
636.19
636.19
636.19

1.51
1.51
1.67
1.67
1.63
1.63
1.63
1.71
1.71
1.71
1.61
1.61
1.61
1.61
1.58
1.58
1.58
1.58

0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2
0.2

TABLE V
ERROR STATISTICS OF THE PROPOSED GGVF-MC-EFBPCM-BASED METHOD
OVER TWO TO FOUR IMAGES UTILIZED FOR THE RECONSTRUCTION
Data

Fig. 8. Reconstruction results of the vascular structures using three phantom
images. (A) Three 2-D phantom images. (B) Reconstruction results in three different views. (C) Reconstruction errors in 3-D space. The blue curves represent
the true vascular structures, while red curves represent the reconstruction results corresponding to (B). (D) Surface rendering of the reconstructed vascular
structures.

1
2
3

4

5

6

Mean-IRPE

Images (IRPE)

1st
2nd
1st
2nd
1st
2nd
3rd
1st
2nd
3rd
1st
2nd
3rd
4th
1st
2nd
3rd
4th
11.702

Initial error

GGVF-MC-EFBPCM

Max

Mean

RMS

Max

Mean

RMS

12.125
11.932
12.243
9.442
13.046
13.253
14.072
9.361
11.524
13.116
11.662
12.758
10.554
9.190
11.004
11.973
12.910
10.477
6.772

6.061
7.569
6.818
6.497
6.382
7.122
5.803
6.438
7.313
6.799
6.660
6.136
7.211
6.898
7.520
7.020
7.199
6.442
6.959

6.132
7.673
6.940
6.515
6.762
7.484
5.868
6.653
7.651
6.993
6.731
6.240
7.508
7.101
7.821
7.184
7.227
6.772
1.078

1.207
0.898
1.045
0.945
1.179
1.264
1.176
0.901
0.989
1.114
1.072
1.216
1.299
1.139
0.891
0.953
1.065
1.053
0.365

0.348
0.390
0.373
0.324
0.351
0.371
0.370
0.355
0.404
0.410
0.379
0.418
0.351
0.356
0.299
0.431
0.338
0.303
0.387

0.359
0.410
0.382
0.335
0.354
0.393
0.386
0.371
0.412
0.440
0.406
0.426
0.361
0.376
0.334
0.393
0.426
0.407

Unit: mm.

Fig. 9.

Relationship between angle difference and reconstruction accuracy.

utilized for the experiments. Clinical data collection and processing were conducted according to the authorized protocol.
The clinical angiograms were provided with patient privacy information removed, and all patients gave their agreements on using the data. Approval of this study on clinical data was granted
by our institutional review board. To reduce the negative effects
of motion artifacts and obtain the image at the same cardiac

cycle, electrocardiogram gating [38] was performed to trigger
angiogram acquisition. The study was approved by the ethical
committee of the Beijing Anzhen Hospital and informed consent was obtained from each patient. Vessel features, including
centerlines, diameters, bifurcations, and topological hierarchy of
the coronary trees, were extracted using a semiautomatic method
developed in [39]. Vessel segmental matching was achieved by
the epipolar constraint method proposed in [40], whereas the diameter estimation for 3-D space was achieved using the method
proposed in Section IV in this paper. Table IV lists the imaging
parameters of eight groups of datasets.
Table V shows the reconstruction error for two to four images
by the proposed GGVF-MC-EFBPCM-based method. It can be
seen that the initial max, mean, and average errors are 11.702,

CONG et al.: QUANTITATIVE ANALYSIS OF DEFORMABLE MODEL-BASED 3-D RECONSTRUCTION OF CORONARY ARTERY

Fig. 10. Reconstruction results of real clinical angiograms. A1 and A2 are
angiograms of left and right coronary arteries at different imaging angles. B1
and B2 are the reconstructed 3-D models at the corresponding view angles. C1
and C2 are surface rendering of the reconstructed models at the other four and
five view angles.

6.772, and 6.959, respectively, over the six groups of datasets.
After optimization by the proposed method, the max, mean, and
average errors are reduced to 1.078, 0.365, and 0.387, respectively. Obvious, the proposed method is very effective for the
3-D coronary artery reconstruction from clinical angiograms.
Fig. 10 shows two groups of reconstruction results by the
proposed GGVF EFBPCM method by using four and five real
clinical angiographic images. 10(A1) and 10(A2) are the angiograms of right and left coronary arteries. The left to right
images of 10(A1) are with the imaging angles of (RAO = 39◦ ,
CAU = −2.7◦ ), (RAO = −3.8◦ , CAU = 29.0◦ ), (RAO =
37.7◦ , CAU = 3.8◦ ) and (RAO = 31.7◦ , CAU = 1.7◦ ), while
the left to right images of 10(A2) are with the imaging angles of
(RAO = −28.2◦ , CAU = −29.0◦ ), (RAO = −1.1◦ , CAU =
39.7◦ ), (RAO = −16.6◦ , CAU = −39.3◦ ), (RAO = −36.5◦ ,
CAU = −31.9◦ ) and (RAO = 10.8◦ , CAU = 44.8◦ ). 10(B1)
and 10(B2) show the reconstructed 3-D models at the corresponding view angles. While 10(C1) and 10(C2) give the reconstructed 3-D model at the other four and five view angles.
From the figure, it can be seen that the structures of the left and
right coronary arteries are accurately recovered, and the hidden
parts can be clearly visualized.

2089

The external force driving the motion of the parameter curve is
composed of back-projected forces in the angiograms; thus, the
reconstruction error induced by nonrigid matching problems
of the traditional EFPIM methods is greatly reduced. Moreover, the external forces in the 2-D angiographic images are
independent, i.e., the forces for multiple views can be easily
used and integrated, which can avoid the iterative use of image
pairs for the corresponding optimization of traditional methods.
Hence, the proposed EFBPCM-based methods greatly improve
the calculation efficiency for the 3-D coronary reconstruction.
In addition, the diameter information of the vascular structures
in 3-D space can be effectively calculated by ellipse fitting of
the back-projected intersections.
A series of experiments were designed on phantom and clinical data to evaluate the performance of the proposed method.
The EFPIM- and MC-EFBPCM-based methods can utilize any
form of external energies; thus, three commonly used forces,
namely, PE, GVF, and GGVF, were used and compared. The
experiments demonstrated that the proposed EFBPCM is very
effective and robust for coronary artery reconstruction from multiple monoplane angiographic images. The proposed GGVFMC-EFBPCM method had the best reconstruction results with
an RMS error of 0.8 mm in 3-D space. In addition, the influence of angle difference on the 3-D reconstruction accuracy was
discussed in detail and a series of phantom experiments were
designed and tested. We conclude that the appropriate angle
difference for the 3-D reconstruction for different views is in
the range of [45◦ , 135◦ ], and the RMS errors is distributed in a
constant range of 0.56–0.62 mm.
From the experiments, it can be concluded that the propose
MC-EFBPCM is very effective for 3-D reconstruction of coronary arteries from multiple angiographic images. It is obvious
that the reconstruction accuracy can be greatly refined by the
extra images involved for the reconstruction. Some advanced
imaging algorithms can also be used to provide better projections [40]–[42]. Compared with the traditional EFPIM-based
method, the improved MC-EFBPCM can make full use of the
imaging information of all the involved images. The complexity of the deformable model-based method is mainly determined
by the formation of external force. For the three external forces
evaluated in this study, PE is the simplest and with the minimum
time expense, while GGVF is the most complex force and with
maximum time expense.
One problem for current reconstruction methods is that the
deformable curve may evolve to its closet boundaries instead
of the true topology structures of the vascular centerlines when
large curvature variances are present for the vessel segments.
One solution to this problem is to split the curve into several parts
with comparatively small curvature variance. Another solution
is to predefine the iteration boundaries under the constraints of
topological structure of the evolution curves.
REFERENCES

V. CONCLUSION AND DISCUSSION
This paper proposes a novel EFBPCM for the 3-D reconstruction of coronary artery by using multiple angiographic images.

[1] P. J. Kilner et al., “Recommendations for cardiovascular magnetic resonance in adults with congenital heart disease from the respective working
groups of the European Society of Cardiology,” Euro. Heart J., vol. 31,
pp. 794–805, 2010.

2090

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 8, AUGUST 2015

[2] J. Heautot et al., “Analysis of cerebrovascular diseases by a new 3dimensional computerised X-ray angiography system,” Neuroradiology,
vol. 40, pp. 203–209, 1998.
[3] Q. Yang et al., “Contrast-enhanced whole-heart coronary magnetic resonance angiography at 3.0-TA comparative study with X-Ray angiography
in a single center,” J. Am. College Cardiol., vol. 54, pp. 69–76, 2009.
[4] R. R. Gollapudi et al., “Utility of three-dimensional reconstruction of coronary angiography to guide percutaneous coronary intervention,” Catheterization Cardiovascular Interventions, vol. 69, no. 4, pp. 479–482, 2007.
[5] G. Shechter et al., “Three-dimensional motion tracking of coronary arteries in biplane cineangiograms,” IEEE Trans. Med. Imaging, vol. 22,
no. 4, pp. 493–503, Apr. 2003.
[6] G. Yang et al., “Characterization of 3-D coronary tree motion from
MSCT angiography,” IEEE Trans. Inf. Technol. Biomed., vol. 14, no. 1,
pp. 101–106, Jan. 2010.
[7] A. Matsui et al., “Image-guided perforator flap design using invisible
near-infrared light and validation with x-ray angiography,” Ann. Plastic
Surgery, vol. 63, p. 327, 2009.
[8] N. E. Green et al., “Angiographic views used for percutaneous coronary interventions: A three-dimensional analysis of physician-determined
versus computer-generated views,” Catheterization Cardiovascular Interventions, vol. 64, no. 4, pp. 451–459, 2005.
[9] B. Alexandre et al., “Motion compensated tomography reconstruction of
coronary arteries in rotational angiography,” IEEE Trans. Biomed. Eng.,
vol. 56, no. 4, pp. 1254–1257, Apr. 2009.
[10] P. A. Dorsaz et al., “The effect of image distortion on 3-D reconstruction
of coronary bypass grafts from angiographic views,” IEEE Trans. Med.
Imag., vol. 19, no. 7, pp. 759–762, Jul. 2000.
[11] C. Blondel et al., “Reconstruction of coronary arteries from a single rotational X-ray projection sequence,” IEEE Trans. Med. Imag., vol. 25,
no. 5, pp. 653–663, May 2006.
[12] E. Hansis et al., “Projection-based motion compensation for gated coronary artery reconstruction from rotational x-ray angiograms,” Phys. Med.
Biol., vol. 53, no. 14, pp. 3807–3820, 2008.
[13] R. Liao et al., “3-D reconstruction of the coronary artery tree from multiple
views of a rotational X-ray angiography,” Int. J. Cardiovascular Imaging
(formerly Cardiac Imaging), vol. 26, no. 7, pp. 733–749, 2010.
[14] Z. Zhang et al., “A robust technique for matching two uncalibrated images
through the recovery of the unknown epipolar geometry,” Artif. Intell.,
vol. 78, no. 1, pp. 87–119, 1995.
[15] D. Terzopoulos and K. W. Fleischer, “Deformable models,” Visual Comput., vol. 4, pp. 306–331, 1988.
[16] D. Terzopoulos et al., “Constraints on deformable models: Recovering
3-D shape and nonrigid motion,” Artif. Intell., vol. 36, pp. 91–123, 1988.
[17] M. Kass et al., “Snakes: Active contour models,” Int. J. Comput. Vision,
vol. 1, no. 4, pp. 321–331, 1988.
[18] C. Molina et al., “3-D catheter path reconstruction from biplane angiograms,” Med. Imag.: Image Proceed., vol. 3338, pp. 504–512, 1998.
[19] C. Canero et al., “3-D curve reconstruction by biplane snakes,” in Proc.
Int. Conf. Pattern Recog., 2000, vol. 4, pp. 563–566.
[20] C. Cañero et al., “Predictive (un) distortion model and 3-D reconstruction
by biplane snakes,” IEEE Trans. Med. Imag., vol. 21, no. 9, pp. 1188–1201,
Sep. 2002.
[21] C. Xu and J. L. Prince, “Generalized gradient vector flow external forces
for active contours,” Signal Process., vol. 71, no. 2, pp. 131–139, 1998.
[22] C. Xu and J. L. Prince, “Gradient vector flow: A new external force for
snakes,” in Proc. IEEE Proc. Conf. Comput. Vision Pattern Recog., 1997,
pp. 66–71.
[23] S. Zheng et al., “Sequential reconstruction of vessel skeletons from Xray coronary angiographic sequences,” Comput. Med. Imag. Graphics,
vol. 34, no. 5, pp. 333–345, 2010.
[24] W. Cong et al., “Energy back-projective composition for 3-D coronary
artery reconstruction,” in Proc. 2013 35th Annu. Int. Conf. IEEE Eng.
Medicine Biol. Soc., 2013, pp. 5151–5154.

[25] J. Yang et al., “External force back-projective composition and globally
deformable optimization for 3-D coronary artery reconstruction,” Phys.
Med. Biol., vol. 59, p. 975, 2014.
[26] Z. Weizhong et al., “An approach to curve reconstruction from multiple
images,” in Proc. 3rd Int. Conf. Digital Manuf. Autom., 2012, pp. 171–174.
[27] R. Cardenes et al., “3-D reconstruction of coronary arteries from rotational
X-ray angiography,” in Proc. 9th IEEE Int. Symp. IEEE Biomed. Imag.,
2012, pp. 618–621.
[28] A. M. Neubauer et al., “Clinical feasibility of a fully automated 3D reconstruction of rotational coronary X-ray angiograms,” Circulation: Cardiovascular Interventions, vol. 3, pp. 71–79, 2010.
[29] J. Yang et al., “Novel approach for 3-D reconstruction of coronary arteries
from two uncalibrated angiographic images,” IEEE Trans. Image Process.,
vol. 18, no. 7, pp. 1563–1572, Jul. 2009.
[30] S. Tu et al., “In vivo flow simulation at coronary bifurcation reconstructed by fusion of 3-dimensional X-ray angiography and optical coherence tomography,” Circulation: Cardiovascular Interventions, vol. 6,
pp. e15–e17, 2013.
[31] S. J. Chen and J. D. Carroll, “3-D reconstruction of coronary arterial tree
to optimize angiographic visualization,” IEEE Trans. Med. Imag., vol. 19,
no. 4, pp. 318–336, Apr. 2000.
[32] B. Movassaghi et al., “A quantitative analysis of 3-D coronary modeling
from two or more projection images,” IEEE Trans. Med. Imag., vol. 23,
no. 12, pp. 1517–1531, Dec. 2004.
[33] E. Hansis et al., “Evaluation of iterative sparse object reconstruction from
few projections for 3-D rotational coronary angiography,” IEEE Trans.
Med. Imag., vol. 27, no. 11, pp. 1548–1555, Nov. 2008.
[34] J. A. Garcia et al., “Initial clinical experience of selective coronary angiography using one prolonged injection and a 180 rotational trajectory,”
Catheterization Cardiovascular Interventions, vol. 70, pp. 190–196, 2007.
[35] C. Rohkohl et al., “Interventional 4D motion estimation and reconstruction of cardiac vasculature without motion periodicity assumption,” Med.
Image. Anal., vol. 14, pp. 687–694, Oct. 2010.
[36] U. Jandt et al., “Automatic generation of 3D coronary artery centerlines using rotational X-ray angiography,” Med. Image Anal., vol. 13,
pp. 846–858, 2009.
[37] K. Hameeteman et al., “Evaluation framework for carotid bifurcation
lumen segmentation and stenosis grading,” Med. Image Anal., vol. 15,
pp. 477–488, 2011.
[38] A. Wahle et al., “Geometrically correct 3-D reconstruction of intravascular ultrasound images by fusion with biplane angiography-methods
and validation,” IEEE Trans. Med. Imag., vol. 18, no. 8, pp. 686–699,
Aug. 1999.
[39] P. Zou et al., “A model-based consecutive scanline tracking method for
extracting vascular networks from 2-D digital subtraction angiograms,”
IEEE Trans. Med. Imag., vol. 28, no. 2, pp. 241–249, Feb. 2009.
[40] J. H. Han and J. S. Park, “Contour matching using epipolar geometry,”
IEEE Trans. Pattern Anal. Machine Intell., vol. 22, no. 4, pp. 358–370,
Apr. 2000.
[41] Y. Chen et al., “Nonlocal prior bayesian tomographic reconstruction,” J.
Math. Imag. Vision, vol. 30, pp. 133–146, 2008.
[42] Y. Chen et al., “Artifact suppressed dictionary learning for low-dose
CT image processing,” IEEE Trans. Med. Imag., vol. 33, no. 12,
pp. 2271–2292, Dec. 2014.

Authors’ photographs and biographies not available at the time of publication.

