IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

1635

Robustness Assessment of 1-D Electron
Paramagnetic Resonance for Improved
Magnetic Nanoparticle Reconstructions
Annelies Coene∗ , Guillaume Crevecoeur, and Luc Dupré

Abstract—Electron paramagnetic resonance (EPR) is a sensitive
measurement technique which can be used to recover the 1-D spatial distribution of magnetic nanoparticles (MNP) noninvasively.
This can be achieved by solving an inverse problem that requires
a numerical model for interpreting the EPR measurement data.
This paper assesses the robustness of this technique by including
different types of errors such as setup errors, measurement errors,
and sample positioning errors in the numerical model. The impact
of each error is estimated for different spatial MNP distributions.
Additionally, our error models are validated by comparing the simulated impact of errors to the impact on lab EPR measurements.
Furthermore, we improve the solution of the inverse problem by
introducing a combination of truncated singular value decomposition and nonnegative least squares. This combination enables to
recover both smooth and discontinuous MNP distributions. From
this analysis, conclusions are drawn to improve MNP reconstructions with EPR and to state requirements for using EPR as a 2-D
and 3-D imaging technique for MNP.
Index Terms—Electron paramagnetic resonance (EPR), image
reconstruction, inverse problems, magnetic nanoparticles (MNP),
robustness.

I. INTRODUCTION
AGNETIC nanoparticles (MNP) are convenient tools for
biomedical applications [1]–[3]. Their diameter in the
nanometer region allows them to reach virtually every part in the
body. Additionally, they have a high saturation magnetization
making them detectable from a distance. These properties are
extensively used in hyperthermia [4], [5], drug targeting [6]–
[10], and disease detection [11], [12]. One drawback is the lack
of a quantitative and qualitative reconstruction technique for
the spatial MNP distribution. A consequence thereof is that the
previously mentioned applications do not operate efficiently and
safety issues arise. In order to improve the performance of these
biomedical modalities, an accurate reconstruction technique is
required.
A well-known reconstruction technique is magnetic particle
imaging (MPI) [13], [14]. This method has a high resolution

M

Manuscript received April 28, 2014; revised October 14, 2014; accepted
February 1, 2015. Date of publication February 3, 2015; date of current version
May 18, 2015. Asterisk indicates corresponding author.
* A. Coene is with the Department of Electrical Energy, Systems and
Automation, Ghent University, 9000 Ghent, Belgium (e-mail: Annelies.
Coene@ugent.be).
G. Crevecoeur and L. Dupré are with the Department of Electrical Energy,
Systems and Automation, Ghent University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2399654

(<1 mm) but lacks sensitivity (i.e., errors on the absolute MNP
concentrations) [15]. Another technique is magnetorelaxometry,
which allows the imaging of larger volumes but has a smaller
resolution than MPI [16]–[18]. Magnetic resonance imaging
(MRI) on the other hand measures only an indirect effect of the
particles [19]. Electron paramagnetic resonance (EPR) follows
similar principles, but works on the magnetic moment of electrons instead of nuclei [20], [21]. Because EPR can only measure
unpaired electrons and most stable molecules have paired electrons, EPR has a larger specificity compared to MRI. In a typical
EPR experiment, the particles are quantified indirectly by measuring the absorption of the incident electromagnetic wave. In
this paper, we employ the sensitive induction EPR technique,
which measures the magnetization of the particles directly at a
fixed frequency of the electromagnetic wave and fixed amplitude of the magnetic field [22], [23]. No field sweep is necessary
which makes it more convenient to optimize the EPR hardware,
resulting in an improved signal-to-noise ratio. Furthermore, this
setup employs radio frequency waves (instead of the conventional 9 GHz waves) which allow penetration into tissue. Previous work devised a method to obtain the one-dimensional
(1-D) spatial MNP distribution by employing this adapted EPR
setup [24]. EPR is a promising and quantitative technique for
the visualization of the spatial MNP distribution. In order to
further improve this method and to retrieve three-dimensional
(3-D) spatial information from the particles, it is necessary to
investigate the impact of different setup parameters and errors.
Another promising technique is magnetophotoacoustic imaging
[25]. This technique, however, requires dual-contrast particles
with enhanced optical absorption and magnetic susceptibility simultaneously. Furthermore, a pulsed magnetic field in the order
of 1 T is needed, whereas our adapted EPR setup only requires
field amplitudes of 10 mT.
A 1-D particle distribution can be recovered by solving an inverse problem. This inverse problem requires a forward model
to mimic the EPR measurements as a function of the spatial
MNP distribution. The difference between these simulated measurements and the actual measurements needs to be minimized.
The spatial MNP distribution can be retained from this. This
problem encompasses uncertainties, for example, due to measurement errors (ME), inherent setup errors, model errors, and
the ill-posedness of the problem.
This paper investigates which requirements the MNP distribution needs to fulfill to achieve an accurate reconstruction
with EPR. For this purpose, various MNP distributions are considered and examined. Additionally, the impact of setup errors

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1636

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

tizing component can be measured by the sensing coil. The
corresponding signal is proportional to the MNP concentration,
but does not contain spatial information. To recover this information, we move the sample through B as the amount of signal
from the particles is related to their respective distances to the
excitation and sensing coil.
Fig. 1. Schematic overview of the studied methodology. The dash-dotted rectangles represent necessary model inputs. Additionally, lab EPR measurements
(full line rectangle) can be employed as a model input so to validate the error
models.

B. EPR Measurement
We denote the unknown spatial MNP distribution as c. Since
we consider the 1-D reconstruction of MNP, c is a 1-D vector
of N elements. In an EPR measurement, the unknown MNP
distribution is measured for M adjacent positions along a line
through the homogeneous magnetic field B in steps of ΔM (see
Fig. 2). This results in M measurements that can be represented
by:
S = [S1 , . . . , Sm , . . . , SM ].

(1)

This EPR measurement S can be modeled as
S(c) = F · c.

Fig. 2. Example of the EPR setup with the three perpendicular coils showing
a lab EPR measurement. The MNP sample is moved through B along a line (in
this case along XY), so to obtain spatial information about the MNP. Adapted
figure from [24].

(grid, forward model properties, etc.), MEs, and sample positioning errors (PE) is explored. The simulated impact of the
different errors is compared to the impact of EPR lab measurements with deliberately added errors so to validate the error
models. Furthermore, we assess the importance of the inverse
solving method by introducing a combination of truncated singular value decomposition (TSVD) [26] and nonnegative least
squares (NNLS) [27] to solve the associated inverse problem.
We test these inverse solvers on MNP distributions exhibiting
smooth and discontinuous behavior. Fig. 1 shows a schematic
overview of the studied methodology. The aim of this paper is
to inspect the limits of the EPR setup and to understand the influence of different types of errors on the MNP reconstructions.
This allows us to optimize the EPR setup toward more accurate
reconstructions of MNP distributions.
II. METHODS
A. EPR Setup
We briefly describe the EPR setup and how the EPR signal is generated. A more detailed description can be found in
[22]–[24]. The EPR setup has three perpendicular coils; an excitation coil to generate a radio frequency wave, a Helmholtz
coil pair to have a homogeneous magnetic field B, and finally, a sensing coil to measure the magnetization of the
particles (see Fig. 2). Due to B, the MNP have their magnetization oriented parallel to this field. When exciting the
MNP with a radio frequency wave, perpendicular to B, the
orientation of their magnetization flips so that their magne-

(2)

F is the forward model, which is used to simulate the EPR
measurement values. F is a M × N matrix which associates a
measurement Sm to position m of the concentration distribution
c.
F is constructed by measuring an accurately known amount of
MNP with N = 1 (i.e., not spatially extended) for M positions
as follows:
1
SEPR
R=
ccal
= [R1 , . . . , Rm , . . . , RM ],

m = 1, . . . , M

(3)

where ccal is the MNP amount of the calibration sample and is
typically in the order of micromol. In our experiments, Resovist (Schering AG, Berlin, Germany) particles are employed.
More information about these particles can be found in [28].
SEPR (m) represents the EPR measurement value for position
m of ccal . At every position m of ccal , a response value Rm
is measured. Rm is normalized to obtain the response value
of a unit concentration (1 μmol) on m. These M normalized
response values constitute the response function R. F is then
constructed by using the appropriate response function values
for the unknown cn (n = 1, . . . , N ) of the MNP concentration
distribution and their positions mn . mn represents the position
of cn in EPR measurement m. These positions change for every
new measurement.
C. EPR for Retrieving 1-D MNP Distributions
The spatial MNP distribution c is retrieved by minimizing
the differences between the model solution (S(c)) and the actual
EPR measurement (SEPR )
c∗ = arg min S(c) − SEPR .
c

(4)

c∗ is the solution of the inverse problem and represents the reconstructed MNP distribution. This inverse problem is traditionally solved using TSVD [24], [26]. In TSVD, the eigenvalues

COENE et al.: ROBUSTNESS ASSESSMENT OF 1-D EPR FOR IMPROVED MNP RECONSTRUCTIONS

σ are organized according to decreasing size. Only the eigenvalues equal to or larger than σr are retained, i.e., the following
equation is solved:
c∗ = F†r SEPR = (UΣVT )†r SEPR =

r

uT SEPR
l

l=1

σl

vl .

(5)

F†r represents the pseudoinverse of F which is found by solving
the SVD, and Σ is a diagonal matrix containing the eigenvalues
of F. ul and vl are the eigenvectors of the matrices U and V. A
detailed description of the EPR 1-D reconstruction methodology
and how to select the right r can be found in [24]. In NNLS, (4)
is solved iteratively subject to the constraint that all elements of
the solution are positive
w = FT (SEPR − S(c)).

(6)

Every iteration transforms the dual vector w until only elements
smaller than or equal to zero remain, so that the solution c∗ has
only elements greater than or equal to zero [27]. Both algorithms
are combined in the following way: first, the inverse problem
is solved using TSVD, then it is solved by NNLS. The positive
MNP amounts from the NNLS reconstructions are substituted
by the values of the TSVD algorithm at the same position.
D. EPR Sensitivity Analysis
A change in a setup parameter of the EPR setup results in a
change of ΔF in the model
S = (F + ΔF) · c.

(7)

In case of a fixed setup, the setup parameters can vary and
lead to errors in the reconstruction, i.e., setup errors. Examples
of setup parameters are the resolution of c∗ , the resolution of
SEPR , and the ratio of M to N (ill-posedness of the problem).
Moreover, R depends on hardware properties of the EPR setup.
We investigate the effect of these parameters to assess in a first
stage the robustness of the EPR setup and in a second stage
to optimize the EPR setup for improved MNP reconstruction
purposes.
Moreover, the impact of ME and PEs on the reconstructed
distributions c∗ are examined. A ME λ is modeled as follows:
SM E (m, κ) = S + λ(m, κ).

(8)

SM E (m, κ) represents the simulated measurement with an
added ME vector λ(m, κ), which expresses the ME λ on measurement position m with a relative error size of κ% compared
to the mean amplitude of S. This allows to carefully characterize
the consequences of a ME. A measurement with a PE can be
represented by
SPE (m, α) = F(Fm = F(m +α ) ) · c.

(9)

Row m of F, Fm , consists of all the response values for the
positions of the MNP at measurement position m. If we erroneously measure at position m + α instead, these response
values are the values from m + α where α is the shift from the
actual position m (here in mm units).
The spatial variation of SEPR depends on the shape of c. We
investigate the necessary requirements to allow a quantitative

1637

detection of the MNP distributions. To this end, various MNP
distributions are considered in the analysis (see Section III-A).
Remark that the aggregation behavior of Resovist particles
can be neglected for the typical MNP amounts employed in our
setup, this is why we did not consider this to be an error. In case
of extremely high MNP amounts, aggregation needs to be taken
into account.
In this paper, we investigate the impact of the different types
of errors independently, but in practice, these errors coexist.
The error models allow an estimate of the maximum error (i.e.,
the summation of all the errors). These errors can compensate
each other, but by adding them, a worst-case scenario can be
assessed.
III. RESULTS AND DISCUSSION
A. Measures of Reconstruction Quality
A certain quality is assigned to every reconstruction c∗ and
is measured using the correlation coefficient (CC)
N
(c∗ − c¯∗ )(cn − c̄)
.
(10)
CC =  n =1 n
N
N
∗ − c¯∗ )2
2
(c
(c
−
c̄)
n =1 n
n =1 n
c∗n and cn , respectively, represent elements from the reconstructed MNP distribution and the actual distribution, while c̄
and c¯∗ are their averages. A CC of 1 implies a “perfect” reconstruction. Additionally, the average difference between c∗ and
c (denoted by μ) and its standard deviation (denoted by σ) are
employed. In most cases, the differences in correlation score
allow us to distinct the reconstructions and no other parameters
are necessary. In certain situations, the reconstruction quality
depends on the numerical stability of the system matrix F from
(2). We explore the numerical stability of F by employing the
condition measure ρ
σ1
.
(11)
ρ=
L
1/L l=1 σl
ρ is defined in [29] as the ratio between the largest eigenvalue
of F and the mean singular value size of F. Smaller ρ signifies a
better numerical stability. The conventional condition measure
(σ1 · σL−1 ) depends to a great extent on the smaller eigenvalues
which make it difficult to compare different matrix sizes.
The distributions considered in this paper are depicted in
Fig. 3. The upper row represents MNP distributions in the lab
measured according to the method described in Section II-B.
Each distribution has specific properties to allow targeted testing
of the setup. The first distribution is an example of a calibration
sample, ccalib (see Section II-B). In this way, we can investigate
the impact of different parameters and errors on our calibration.
Errors in the calibration result in an inaccurate forward model
[see (2), (3)] and, thus, in inaccurate reconstructions. The bottom row represents numerically simulated MNP distributions.
We investigate constant (i.e., homogeneous) distributions, ccon ,
with slope equal to zero and gradient distributions, cgrad with
constant slope different from zero to assess the impact of slope
sizes. Multiple cgrad MNP distributions are tested, but only two
of them are shown for clarity reasons. The red cgrad distribution

1638

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Fig. 3. Upper row shows lab made MNP distributions. The bottom row depicts
numerically simulated distributions. The red lines represent simulated distributions of MNP Distributions 1 and 2, respectively, but without discontinuities.

Fig. 4.

Impact of the setup noise level on the MNP distributions from Fig. 3.

corresponds to the measured MNP Distribution 2 (upper row),
but without discontinuities. This is also the case for the ccon distribution and MNP Distribution 1. These distributions are used
to investigate the impact of discontinuities whether they realize
improved or deteriorated reconstructions compared to continuous distributions, which are found in biomedical applications.
We also consider 100 random MNP distributions, crand . These
distributions are generated with uniformly distributed pseudorandom numbers in the open interval (0,1). Additionally, we
simulate a realistic MNP distribution, crea , corresponding to a
small MNP injection.
B. Impact of Setup Parameters
In this section, we consider parameters that change F by
ΔF (as in (7)). We regard noise as a setup parameter, which
originates, for example, from the coils and increases as the coils
heat up. This setup noise results in a different response function
and, thus, in a different setup behavior
S = (F + ΔFnoise ) · c.

(12)

ΔFnoise represents the changes in the final setup matrix due
to setup noise. Fig. 4 depicts the noise robustness of the EPR
setup toward the distributions from Fig. 3. Typical noise levels for this setup are between 1% and 10 % of the measured
EPR signals. We use noise levels relative to the signal intensity of the distributions as MNP distributions with higher MNP
amounts are less sensitive to noise if absolute values are used.
The white Gaussian noise is increased in steps of 1%, and for

every noise level, 200 simulations (noise measurements) are
performed which are then averaged. The shadow band around
the average represents the standard deviation due to the noise.
The influence of the noise is similar as in [24]: The average
CC decreases for increasing noise levels. The presence of noise
requires a cutoff of the eigenvalues [r, from (5)]. To determine
the cutoff value, we use the method from [24]. A large standard
deviation (0.4 CC) is observed for Distribution 1 due to the
inherent symmetry of the distribution. The calibration sample
remains largely unaffected by the noise, which means that the
calibration results will not differ in time due to small changes in
setup noise levels. The random and constant distributions (omitted for clarity) reach a CC close to zero starting from noise levels
of 1%, suggesting a lesser performance for these type of distributions with this setup. The CC of the random distributions can
also be explained due to the combined randomness of the noise
and the distribution. Distributions 2 and 3 obtain similar CC
scores, but are lower compared to Distribution 1 because of the
smaller spacing between the components. The cgrad distributions obtain a CC between Distributions 2, 3 and Distribution 1.
The best results are found for the realistic distribution, crea ,
because of the changing steepness in the distribution on a larger
spatial scale (compared to the lab distributions). This figure is
used as a reference figure for observing the additional impact of
measurement and PEs.
The impact of the response function R on the reconstruction
is further investigated, generating measurement
S = (F(R1 ) + ΔF) · c = F(R2 ) · c.

(13)

R1 and R2 represent two different response functions. We assess the impact of R on the reconstruction quality and want
to define necessary requirements for R to improve reconstructions. Two types of response functions were investigated in [24],
but it remained unclear what properties of the response function caused the differences in reconstruction quality. First, we
regard R2 = D · R1 , D ∈ R (i.e., equal shape, but changed
slope). R1 corresponds to a measured response function. An increased slope should show an increased robustness toward setup
noise and, thus, increased reconstruction performance. Starting
from D = 4, the impact of the noise is negligible for all distributions shown in Fig. 3. In this case, the noise level is considered
relatively to R1 . Fig. 5 shows an example with D = 4 for MNP
Distribution 1. However, no reconstructions are obtained with a
CC of 1. This suggests that other properties such as the spatial
variation of R also have an impact.
We, therefore, introduce three synthetic response functions
Ra , Rb , and Rc with following properties:
dRa
= constant, m = 1, . . . , M
dm
⎧
dRb
⎪
⎨
= constant, m = 1, . . . , M/2
dm
⎪
⎩ dRb = -constant, m = M/2 + 1, . . . , M
dm

COENE et al.: ROBUSTNESS ASSESSMENT OF 1-D EPR FOR IMPROVED MNP RECONSTRUCTIONS

Fig. 7.
Fig. 5. (a) Response functions R 1 and R 2 with R 2 = 4 · R 1 . The blue
dotted line depicts a measured response, (b) CC for every response as function
of noise level, (c) standard deviation for every function due to the noise levels.

Impact of F resolutions on setup performance.

TABLE I
PERFORMANCE OF THE RELATIVE RESOLUTIONS OF c ∗ AND S FROM FIG. 7
HIGHLY DEPEND ON THE NUMERICAL STABILITY (ρ [−]) OF F
Resolution S\Resolution c ∗
1
0.1
0.01

Fig. 6. (a) Depicts the different response functions. (b) CC for every type
of response function for MNP Distribution 1 as a function of noise level.
(c) Standard deviation on the CC in (b) due to the noise.

⎧
dRc
⎪
⎨
= t · constant, m = 1, . . . , M/2, t ∈ R
dm
.
⎪
⎩ dRc = -constant, m = M/2 + 1, . . . , M
dm
Fig. 6 depicts these response functions and the associated CC
when reconstructing MNP Distribution 1 for increasing noise
levels. Here, the setup noise is relative to the mean amplitude of
each R to remove the impact of the slope (as shown in Fig. 5).
Additionally, two measured response functions from two EPR
setups, denoted as Setup A and Setup B, are plotted (for more
detailed information see [24]). Lab measurements of MNP Distribution 1 obtain a CC of 80% for Setup A and a CC of 93% for
Setup B. We observe that a constant slope is noise robust (Ra ).
Having similar up and downward slopes (Rb ) result in similar
response values and, therefore, a decreased noise robustness.
However, for lower noise values, a higher CC is observed. This
is also the case for Setup A, which has similar slopes. Setup
B has two different slopes (similar to Rc ) and is, therefore,
more noise robust. When extending the existing 1-D EPR toward the 2-D and 3-D reconstruction of MNP distributions in
possible further EPR setups, we have to take into account these
requirements on the response function.

1639

0.01

0.1

1

23.569
232.186
790.321

23.491
79.239
79.244

8.059
8.106
8.106

F also depends on the required resolution (i.e., the step size
between consecutive values) of the measurement S and the MNP
distribution c∗ . The resolutions of these parameters determine
the M to N ratio of F and the resolution of R. Our aim is to have
the smallest possible resolution for c∗ , by performing the least
possible amounts of measurements so to realize fast measurements. Lab measurements were performed of MNP Distribution
2 with S having a resolution of 1 mm. Starting from this measurement, reconstructions, c∗ , with resolutions of 1, 0.1, and
0.01 mm were realized [see Fig. 7(a)]. A similar reconstruction quality is observed for these reconstructions, suggesting
no numerical impact of increasing the resolution. When S is
linearly interpolated to smaller resolutions (0.01 and 0.1 mm),
a decrease in reconstruction quality due to numerical instability of the matrix can be observed, as only linearly dependent
information is added to the matrix. This decrease also depends
on the resolution of c∗ ; for smaller resolutions, there are more
unknowns and the problem is ill-posed. The performance of the
selected resolutions highly depends on the numerical stability
[see (11)] of the matrix F in (2), see Table I. In Fig. 7(b), values
of the measurement S are omitted to acquire resolutions of 2
and 3 mm. Because less information is available to solve the
inverse problem, their reconstruction quality decreases. Starting
from a resolution of 3 mm for c∗ , the problem is overdetermined
to such extent that the approximated solution does insufficiently
characterize the spatial variations of the MNP distribution.
C. Impact of MEs
MEs of the form (8) were investigated through numerical
simulations. In a first stage, the impact of a single ME, λ, is
investigated. λ is added to a noise-free measurement, Scon ,
con
= 0, m = 1, . . . , M , for investigating the position
with dSdm

1640

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Fig. 8. (a) Impact of the position of λ for constant S and for increasing κ; (b) impact of 1 λ on the reconstruction quality (average CC) for changing κ for the
MNP distributions from Fig. 3 without setup noise; (c) impact of ME on the reconstruction quality (average CC) for κ equal to 15% with setup noise; (d) 100
simulations are performed of Distribution 1 for increasing number (1–25) of random MEs (random sizes, random positions) with setup noise, the simulated results
are compared to an averaged lab measurement of Distribution 1 that is also subjected to random ME’s.

dependence of the introduced ME λ. In this case, neighboring
measurement positions of λ, m − 1, and m + 1, differ always
κ% of Scon (m) in value. There is no need to investigate different amplitudes of Scon as the κ parameter scales the size
of λ compared to the average amplitude of Scon . For each m
(m = 1, . . . , M ) and for fixed κ, SM E (m, κ) [see (8)] is generated, resulting in M simulated measurements each containing
one error on position m. From each measurement, a reconstruction of c with N = 16 unknowns is performed and a correlation
score is associated. Fig. 8(a) depicts the difference between the
maximum and minimum score of the M corresponding correlation scores. Nevertheless, a dependence is observed due to the
nature of the inverse problem, which increases for rising κ in
case of an underdetermined (M = 8) or overdetermined (M
= 24) problem. A slower increase is observed for the underdetermined problem compared to the overdetermined. For a welldefined problem (M = 16), there is no dependence on m. It is
recommended, therefore, to achieve an underdetermined problem (M < N ) or to be close to the well-posed case (M ≈ N ).
In biomedical applications, the first situation will most likely
occur. The overdetermined problem shows larger differences
for the M correlation scores due to the numerical instability of
the larger matrix F. ρ(FM =24 ) = 13.2 and ρ(FM =8 ) = 7.3
(11), suggesting an improved numerical stability for the underdetermined problem. The average CC of the M reconstructions
is similar for the under- and overdetermined problem; therefore,
we show in the subsequent results the average CC to diminish
the influence of the position of λ on the CC.
Fig. 8(b) shows the average CC for increasing κ. In general,
larger variations (larger slopes) in the MNP distribution result

in a smaller influence of the ME λ. This can also be seen on
Fig. 8(b) as the spatial variations of MNP Distribution 1 > crea >
MNP Distribution 3 > ccon . The lab MNP distributions (MNP
distributions 1, 2, and 3) have high slopes (sudden increase of
MNP values higher than 1 μmol), which result in improved
reconstructions. For the same reason, the simulated continuous
distributions (see Fig. 3, red) have a lower average CC than the
lab distributions. Distributions 2 and 3 obtain similar results due
to an equal spacing of 2 mm between the compartments. This
spacing is smaller (2 mm compared to 4 mm) compared to MNP
Distribution 1, which makes them inherently more sensitive to
errors. Note that the influence of κ is small for ccalib which
determines F leading to an increase of the system’s stability.
In the next phase, white Gaussian setup noise was added to the
simulations. The effect of λ combined with noise is investigated
for κ ranging from 1% to 50%. Fig. 8(c) shows an example for
κ = 15%. The noise averages the signal and decreases the κ
impact in the measurement. The influence of κ decreases for
higher noise levels because the ME is less distinct compared
to the noise. Distributions less sensitive to setup noise obtain
higher CC’s than in the noise-free case, changing the relative
positions now to crea > MNP Distribution 1 > ccalib . This
means that noise has a larger impact than the spatial variations
in c from the previous paragraph.
For the analysis of multiple MEs, we generated uniformly
distributed pseudorandom numbers for the position of the error
(limited to the range of m) and the size of the error (ranging from 1% to 15 % of the measurement’s mean amplitude).
We performed 100 simulations for increasing number of errors
(1 to 25).

COENE et al.: ROBUSTNESS ASSESSMENT OF 1-D EPR FOR IMPROVED MNP RECONSTRUCTIONS

Fig. 9. Dashed lines represent the overdetermined (red), well posed (green),
and underdetermined (blue) CC differences for an S g ra d measurement with
Δ = 2 μmol and 1 PE ranging from 1 to 5 mm. The full lines are for Δ =
0.2 μmol.

Finally, five lab measurements were performed of MNP Distribution 1. These five measurements were averaged and then
considered to be free of MEs. Next, we added multiple random MEs as described before and compared the results to the
simulated MEs [see Fig. 8(d)]. The shadow band shows the
standard deviation for 100 simulations. In the simulations, the
effect of setup noise was considered to be ≈0.05 CC. The correspondence (difference in average CC of only 0.02) between
the correlation scores of the actual measurement and the simulated measurement suggests that aforementioned simulations
assess the impact of MEs correctly. The small differences still
observed are due to the fact that only five measurements were
averaged and MEs still might be present. Furthermore, the setup
noise cannot be perfectly characterized. However, the averaged
impact on the lab measurements is still within the standard deviation of our simulated impact.

1641

Fig. 10. (a) PE depends on m (α = 1 mm), (b) average CC for 1 PE with α
= 1 and 3 mm without setup noise, and (c) the impact of the PE is correlated
with the local gradient (α = 1 mm).

D. Impact of PEs

Fig. 11. (a) Impact of 1 PE on the reconstruction quality (average CC) for α
equal to 3 mm with setup noise. (b) 100 simulations are performed for increasing
number (1–25) of random PEs (random sizes, random positions) with setup
noise; these simulated results are compared to an averaged lab measurement of
Distribution 1 that is also subjected to random PE’s.

In this section, the impact of PEs [see (9)] is investigated. We
first assume S to have a constant slope = 0, Sgrad . Consequently,
dS g r a d
) should be identical for
the impact of one PE (equal to dm
every position m. Next, M reconstructions are calculated from
SPE for m = 1, . . . , M and M correlation scores are associated.
In the ideal case, these M CC’s should be identical. Based on
the posedness of the problem, a dependence of the position
error on m is observed (see Fig. 9). The well-posed case has
no dependence on the position m of the error except for α =
1 mm in case of 2 μmol (large error) instead of 0.2 μmol due
to the equal size (1 mm) of reconstruction grid and PE. This is
also observed for the underdetermined case. When a different
grid size is taken, this dependence is shifted to the grid size.
Therefore, the grid size should be smaller or larger than the
estimated PE. The overdetermined problem is less numerically
stable, i.e., ρ(FM =24 ) = 13.2, and is much more independent
(difference in correlations of 0.03 for Δ10 times larger) on the
gradient of Sgrad than the underdetermined case (differences in
correlations of 0.4). On the other hand, increasing the PE (α)
from 1 to 5 mm increases the CC difference by 0.8 and for the
underdetermined case only by ≈ 0.15. We suppose a degree of
numerical instability is needed to cope with the increase of the

error (i.e., the local gradient of the measurement results between
m and m + α).
The current EPR setup is asymmetric due to the relative positions of the hardware. This is also reflected in the impact of
the PE. The first positions (smaller m) only have small relative
changes to one another (small gradient), and therefore, an error of 1 mm has almost no impact, while the last measurement
positions (larger m) have a higher slope and, thus, a higher associated impact of the PE [see Fig. 10(a)]. This results in a lower
average CC for PE’s [see Fig. 10(b)]. A similar relative sensitivity toward position errors as MEs is observed for the MNP
distributions from Fig. 3. The largest impact (lowest CC) is for
the ccon , cgrad , and crand distributions. The lab MNP distributions 1, 2, and 3 obtain similar scores. ccalib has the highest CC
scores and, therefore, is only limitedly affected by the PE. crea
seems to be more sensitive (compared to the other distributions)
to PEs than to MEs. The CC correlates directly to the gradient
of the measurements [see Fig. 10(c)]. The measurement of crea
for example, contains steeper gradients than the MNP lab distributions. The crand and cgrad distributions are sensitive to the
size of α due to their larger gradients. For α = 3 and 5 mm,

1642

Fig. 12.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Reconstruction of MNP Distribution 1 with TSVD, NNLS, and with TSVD and NNLS combined.

ccalib obtains similar scores as the distributions due to a larger
gradient for higher m. These results show that PEs are more
important than MEs [see Fig. 8(b)]. This means that automating
the setup is a higher priority than stabilizing the measurement
system.
Second, Gaussian white setup noise was added, analogous
as in Section III-C [see Fig. 11(a)]. Comparison with Fig. 8(c)
reveals that adding noise results in a similar relative performance
of MNP reconstructions than when adding a ME, however the
impact of the PE is larger. This suggests that the noise sensitivity
of the distributions plays a larger role than the inserted errors.
The standard deviation due to the noise is considerably smaller
for the PEs.
Fig. 11(b) presents the impact of multiple random PEs for α
= 1–3 mm and increasing number of errors (1–25). The simulations are performed analogous as in Section III-C. This figure
clearly shows that PEs have a two to three times greater impact
(average CC goes faster to zero and starts lower) than MEs.
Finally, we added PEs to the five averaged lab measurements of
MNP Distribution 1 and compared them to simulated random
errors. We obtained similar results (average CC difference of
only 0.05) for the simulated impact and the actual impact, suggesting that our method assesses PEs well and allows to consider
measurement and PEs independently.
E. Solving the Inverse Problem Using a Nonnegativity
Constraint
TSVD is a traditional inverse solution method but may exhibit negative reconstructed MNP concentrations. We, therefore,
suggest solving the inverse problem using a NNLS algorithm.
Both solution methods are compared and finally combined in
order to improve the reconstruction results. In this section, the
reconstructions are performed on actual measurement data.

Fig. 12 depicts a reconstruction example of MNP Distribution 1. NNLS is able to pinpoint the filled compartments in
the tube; however, a large discrepancy exists between the actual MNP amounts in the compartment compared to the reconstructed amount (a mean difference of 0.3 μmol). TSVD
on the other hand, shows a MNP concentration similar to the
actual concentrations for the compartment positions (a mean
difference of 0.06 μmol), but the compartments are broadened
by an average of 2 mm. By combining TSVD and NNLS, we
can achieve a reconstruction with CC = 99%, μ = 0.08 μmol,
and σ = 0.04 μmol. This is an increase of 10% and 6% in CC
compared to the separate use of the algorithms.
Distribution 1 is discontinuous which improves the performance of the NNLS algorithm. Therefore, we investigate the
performance of the NNLS algorithm also on the more continuous Distribution 2. The reconstruction with TSVD is broadened
because of PEs of the sample during the movement through
the magnetic field. When employing NNLS, the CC increases
with an average of 12%. Combining both methods decreases the
CC again with 7% because of the poor performance of TSVD.
Nevertheless, a better reconstruction score is obtained by employing NNLS and TSVD + NNLS instead of only TSVD in
reconstructions. In the future, the movement of the setup will
be automated and this will increase the reconstruction quality
of TSVD and TSVD + NNLS. This is in correspondence with
our numerical simulations where PEs had the largest impact.
IV. CONCLUSION
In this paper, we numerically investigated the robustness of
EPR toward setup, measurement, and PEs. We obtained results showing that the EPR measurements need to be preferably
carried out in a region where the response function exhibits a

COENE et al.: ROBUSTNESS ASSESSMENT OF 1-D EPR FOR IMPROVED MNP RECONSTRUCTIONS

high continuous slope. In the future, the slope of the response can
be increased by adding a gradient magnetic field to the already
present homogeneous field. Furthermore, the measurement and
PE models were compared with actual EPR measurements in
which we deliberately introduced errors to validate the simulated
impacts. Correspondence for the PEs is observed (difference in
average CC of only 0.05) and MEs (difference in average CC of
only 0.02). PEs have a two to three times larger impact than MEs
so the automation of the sample positioning setup should be prioritized above improving the EPR measurement sensitivity. The
gradient magnetic field can additionally improve measurement
and setup noise errors as lower spatial variations of the MNP
distribution are required while a larger variation in the EPR
measurement is obtained. Additionally, we proposed a combination of TSVD and NNLS, which improved the solution of the
inverse problem with ≈10%. The reconstruction quality is further affected by the ill-posedness of the inverse problem and the
number of measurements should therefore be kept comparable
to or lower than the number of unknowns in the spatial distribution. The EPR setup used for the reconstructions in this paper
is not well suited for measuring homogeneous (constant) MNP
distributions, but in biomedical applications, these are rarely encountered. High-quality reconstructions were achieved in case
of MNP distributions with large spatial variations.
ACKNOWLEDGMENT
The authors would like to thank PEPRIC NV for giving them
the opportunity to perform measurements on their EPR setup.
A. Coene gratefully acknowledges J. Leliaert for a critical reading of the manuscript.
REFERENCES
[1] Y. Gao et al., “Magnetic nanoparticles for biomedical applications: From
diagnosis to treatment to regeneration,” in Engineering in Translational
Medicine. New York, NY, USA: Springer, 2014, pp. 567–583.
[2] C. T. Lim et al., “Micro and nanotechnology for biological and biomedical
applications,” Med. Biological Eng. Comput., vol. 48, no. 10, pp. 941–943,
2010.
[3] Q. Pankhurst et al., “Progress in applications of magnetic nanoparticles in
biomedicine,” J. Phys. D, Appl. Phys., vol. 42, 15 pp (1–15), 2009.
[4] M. Johannsen et al., “Thermotherapy of prostate cancer using magnetic
nanoparticles: Feasibility, imaging, and three-dimensional temperature
distribution,” Eur. Urology, vol. 52, no. 6, pp. 1653–1662, 2007.
[5] D. Su et al., “Numerical study of nanofluid infusion in deformable tissues for hyperthermia cancer treatments,” Med. Biological Eng. Comput.,
vol. 49, no. 11, pp. 1233–1240, 2011.
[6] C. Alexiou et al., “Locoregional cancer treatment with magnetic drug
targeting,” Cancer Res., vol. 60, no. 23, pp. 6641–6648, 2000.
[7] L. Arcese et al., “Endovascular magnetically guided robots: Navigation
modeling and optimization,” IEEE Trans. Biomed. Eng., vol. 59, no. 4,
pp. 977–987, Apr. 2012.

1643

[8] P. Babinec et al., “Dynamics of magnetic particles in cylindrical halbach
array: Implications for magnetic cell separation and drug targeting,” Med.
Biol. Eng. Comput., vol. 48, no. 8, pp. 745–753, 2010.
[9] S. Goetz et al., “First theoretic analysis of magnetic drug targeting in the
lung,” IEEE Trans. Biomed. Eng., vol. 57, no. 9, pp. 2115–2121, Sep.
2010.
[10] R. Seip et al., “Targeted ultrasound-mediated delivery of nanoparticles:
On the development of a new hifu-based therapy and imaging device,”
IEEE Trans. Biomed. Eng., vol. 57, no. 1, pp. 61–70, Jan. 2010.
[11] M. Kircher et al., “A multimodal nanoparticle for preoperative magnetic
resonance imaging and intraoperative optical brain tumor delineation,”
Cancer Res., vol. 63, no. 23, pp. 8122–8125, 2003.
[12] M. Visscher et al., “Quantitative analysis of superparamagnetic contrast
agent in sentinel lymph nodes using ex vivo vibrating sample magnetometry,” IEEE Trans. Biomed. Eng., vol. 60, no. 9, pp. 2594–2602, Sep.
2013.
[13] B. Gleich and J. Weizenecker, “Tomographic imaging using the nonlinear response of magnetic particles,” Nature, vol. 435, no. 7046,
pp. 1214–1217, 2005.
[14] J. Weizenecker et al., “Three-dimensional real-time in vivo magnetic particle imaging,” Phys. Med. Biol., vol. 54, p. L1–L10, 2009.
[15] J. Weizenecker et al., “A simulation study on the resolution and sensitivity
of magnetic particle imaging,” Phys. Med. Biol., vol. 52, pp. 6363–6374,
2007.
[16] D. Baumgarten et al., “Magnetic nanoparticle imaging by means of minimum norm estimates from remanence measurements,” Med. Biological
Eng. Comput., vol. 46, no. 12, pp. 1177–1185, 2008.
[17] E. Flynn and H. Bryant, “A biomagnetic system for in vivo cancer imaging,” Phys. Med. Biol., vol. 50, no. 6, pp. 1273–1293, 2005.
[18] F. Wiekhorst et al., “Magnetorelaxometry assisting biomedical applications of magnetic nanoparticles,” Pharmaceutical Res., vol. 29,
pp. 1189–1202, 2012.
[19] A. Rad et al., “Quantification of superparamagnetic iron oxide (SPIO)labeled cells using MRI,” J. Magn. Reson. Imag., vol. 26, no. 2,
pp. 366–374, 2007.
[20] M. Brustolon and G. Giamello, Electron Paramagnetic Resonance: A
Practitioner’s Toolkit. New York, NY, USA: Wiley, 2009.
[21] J. Weil and J. Bolton, Electron Paramagnetic Resonance: Elementary
Theory and Practical Applications. New York, NY, USA: Wiley, 2007.
[22] X. Li et al., “Sensitive and quantitative PEPR detection system for SPIO
nanoparticles,” Electron. Lett., vol. 49, no. 25, pp. 1600–1601, 2013.
[23] P. Vaes and S. Teughels, “Isolating active electron spin signals in EPR,”
Patent WO/2012/126 968, Sep. 28, 2012.
[24] A. Coene et al., “Quantitative estimation of magnetic nanoparticle distributions in one dimension using low-frequency continuous wave electron paramagnetic resonance,” J. Phys. D, Appl. Phys., vol. 46, no. 24,
10 pp (1–10), 2013.
[25] M. Qu et al., “Magneto-photo-acoustic imaging,” Biomed. Opt. Exp.,
vol. 2, no. 2, pp. 385–396, 2011.
[26] P. Hansen, “The truncated SVD as a method for regularization,” BIT
Numerical Math., vol. 27, no. 4, pp. 534–553, 1987.
[27] C. L. Lawson and R. J. Hanson, Solving Least Squares Problems. Philadelphia, PA, USA: SIAM, 1974, vol. 161.
[28] Y.-X. J. Wang, “Superparamagnetic iron oxide based MRI contrast agents:
Current status of clinical application,” Quant. Imag. Med. Surg., vol. 1,
no. 1, pp. 35–40, 2011.
[29] R. Eichardt et al., “Adapting source grid parameters to improve the condition of the magnetostatic linear inverse problem of estimating nanoparticle distributions,” Med. Biological Eng. Comput., vol. 50, no. 10,
pp. 1081–1089, 2012.
Authors’ photographs and biographies not available at the time of publication.

