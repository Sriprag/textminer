588

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Gastroesophageal Reflux Disease Diagnosis Using
Hierarchical Heterogeneous Descriptor Fusion
Support Vector Machine
Chun-Rong Huang∗ , Member, IEEE, Yan-Ting Chen, Wei-Ying Chen, Hsiu-Chi Cheng, and Bor-Shyang Sheu

Abstract—A new computer-aided diagnosis method is proposed
to diagnose the gastroesophageal reflux disease (GERD) from endoscopic images of the esophageal-gastric junction. To avoid the
interferences of different endoscope devices and automatic camera
white balance adjustment, heterogeneous descriptors computed
from heterogeneous color models are used to represent endoscopic
images. Instead of concatenating these descriptors to a super vector, a hierarchical heterogeneous descriptor fusion support vector
machine (HHDF-SVM) framework is proposed to simultaneously
apply heterogeneous descriptors for GERD diagnosis and overcome the curse of dimensionality problem. During validation, heterogeneous descriptors are extracted from test endoscopic images
at first. The classification result is obtained by using HHDF-SVM
with heterogeneous descriptors. As shown in the experiments, our
method can automatically diagnose GERD without any manual selection of region of interest and achieve better accuracy compared
to states-of-the-art methods.
Index Terms—Computer-aided diagnosis, feature extraction,
gastroenterology, gastroesophageal reflux disease, support vector
machines.

I. INTRODUCTION
ASTROESOPHAGEAL reflux disease (GERD) is a disease caused by stomach contents rising up into the esophagus. GERD can be diagnosed by typical symptoms of acid regurgitation or heartburn sensation at the epigastric or midchest
regions [1]. As indicated in [2], around 10% to 20% prevalence
was identified in the western world. The prevalence of typical
symptoms of GERD experienced at least weekly was about 20%
in the United States [3], [4]. In [5], Lee et al. discover that there
are 29% subjects enrolled in a health screening program with
manifestations suggesting GERD. Among these patients, 18.3%

G

Manuscript received February 21, 2015; revised May 24, 2015 and July 31,
2015; accepted August 1, 2015. Date of publication August 10, 2015; date
of current version February 16, 2016. This work was supported in part by
MOST104-2221-E-005-027-MY3 and MOST101-2221-E-005-086-MY3 from
the Ministry of Science and Technology, Taiwan, and NCKUH-10002006 from
the National Cheng Kung University Hospital, Taiwan. Asterisk indicates corresponding author.
∗ C.-R. Huang is with the Department of Computer Science and Engineering,
National Chung Hsing University, Taichung 402, Taiwan (e-mail: crhuang@
nchu.edu.tw).
Y.-T. Chen is with the Institute of Networking and Multimedia, National Chung Hsing University, Taichung 402, Taiwan (e-mail: g100083002@
mail.nchu.edu.tw).
W.-Y. Chen, H.-C. Cheng, and B.-S. Sheu are with the Institute of Clinical
Medicine and Department of Internal Medicine, National Cheng Kung University Hospital, National Cheng Kung University, Tainan 701, Taiwan (e-mail:
chen036543@yahoo.com.tw, teishuki@mail.ncku.edu.tw, sheubs@mail.ncku.
edu.tw).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2466460

erosive esophagitis are found. Thus, the diagnosis and treatment
of GERD are growing more and more important worldwide [6]–
[8] in the upper gastrointestinal tract.
One of the most common ways to diagnose GERD is to perform upper gastrointestinal endoscopy [5], [9], [10]. It is helpful
to provide the morphological diagnosis and validate the endoscopic severity of GERD. The diagnosis of GERD can be made
confidently according to visible erosions or ulcers during endoscopy. To assess the severity of GERD, Los Angeles (LA)
grading classification [10] is applied which can describe the
mucosal breaks and provide the assessment of the esophagitis.
According to the mucosal breaks, the LA grade is divided into
four levels, from A to D. In grade A, one or more mucosal breaks,
which are smaller than 5 mm, are confined to the mucosal folds.
In grade B, at least one mucosal break is larger than 5 mm long
confined to the mucosal folds but not connected between the
tops of two mucosal folds. In grade C, at least one mucosal
break connects between the tops of two or more mucosal folds
but not circumferential. Grade D contains circumferential mucosal break. Subjects with findings classified as grades A–D are
considered as diagnosed as having GERD. Such grades have
been widely used in GERD related diagnosis [9], [11]–[13].
Ambulatory pH monitoring provides a physiological measurement of the acid to diagnose GERD. A catheter with a
single pH meter is located at 5 cm above the lower esophageal
sphincter [14] to collect pH values. Barrientos et al. [15] use 24hour esophageal pH meters and correlate the recordings with the
Savary–Miller grade [16] of esophagitis. Starner and Ashbrook
[17] aim to analyze which activities will result in symptoms of
GERD by equipping a 24-hour stomach acid pH meter with a
camera on a GERD patient. To avoid the uncomfortable feeling
and the interferences of the normal activities when equipping
pH meters, Hammond et al. [18] design a system-on-chip digital
pH meter for a wireless capsule [19]. Similar to [18], GonzalezGuillaumin et al. [20] also develop an impedance-pH capsule
for GERD monitoring. Simulation results of the magnetic holding scheme are performed to show the potential to control the
position of the capsule in the stomach. Ativanichayaphong et al.
[21] determine the impedance of the reflux in the esophagus
remotely. An external reader provides the power to the battery
less sensor implant and measures the impedance values simultaneously. Although pH monitoring can provide long term monitoring of the acid, it requires much longer assessment time and
cannot provide mucosa breaks like endoscopy. Their new extension can be found in [22]. As for wireless capsule endoscopy,
please refer to [23] and [24].

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

Besides endoscopy and pH monitoring, GERD can also be
diagnosed by esophageal manometry [25], [26] which is used to
measure the function of the lower esophageal sphincter and the
muscles of the esophagus. The esophageal manometric data are
then stored for the diagnosis of GERD. Liang et al. [25] propose
the empirical mode decomposition to analyze the esophageal
manometric data for GERD diagnosis. Najmabadi et al. [26]
propose using wavelet decomposition to further represent the
esophageal manometric data which leads better denoised signals
for GERD diagnosis. Esophageal manometry requires at least
20 minutes for data collection and also cannot provide mucosa
breaks like endoscopy.
In general, patients with GERD will have esophageal mucosal
injury and inflammation [27] which can be found during endoscopy. Discovering typical finding of GERD using endoscopy
has 90% to 95% specificity [28], [29]. Thus, well-experienced
physicians can diagnose GERD based on LA grades. The diagnosis results are heavily dependent on the personal experience,
even though the grading criteria of LA grading classification are
already defined. To offer a consistent and objective result, a new
computer-aided diagnosis (CAD) method is developed to diagnose GERD from endoscopic images. Moreover, as it is a noninvasive examination, this method enables a global analysis on the
whole esophagus at any regions that are suspected by physicians.
According to the most recent survey [30], only few researches
focus on the esophagus disease diagnosis from endoscopic images. Münzenmayer et al. [31] combine a color-texture analysis
algorithm with the interactive relevance feedback to detect precancerous lesions. Their system can also be used to identify
wrong decisions of gastroenterologists with lesser experience.
Reviews on CAD works using endoscopic images in the gastrointestinal tract can be found in [30] and [32]. Thus, to the
best of our knowledge, this is the first automatic CAD method
to diagnose GERD.
During endoscopy, lighting changes and automatic camera
white balance adjustment will significantly affect the colors
of the esophageal mucosa in different endoscopes as shown in
Fig. 1. Thus, the manufacturer types of endoscopes used in many
CAD methods such as [33] and [34] are fixed to reduce possible
interferences. Moreover, manual selection of regions of interesting (ROI) is required to identify biopsy locations. Although
[33] and [34] aim to classify helicobacter pylori related gastric
histology of the antrum, body and cardia in the stomach, they
address the difficulties of developing automatic CAD tools for
endoscopic images.
To avoid the interferences of lighting changes and automatic
camera white balance adjustment, and the inconvenience of
manual selection, we separate the endoscopic images of the
esophageal-gastric (E-G) junction into image regions. Each image region is represented by heterogeneous descriptors which
are computed from heterogeneous color models. To collaborate
all of the heterogeneous descriptors for GERD diagnosis, we
propose a hierarchical heterogeneous descriptor fusion support
vector machine (HHDF-SVM) framework. Each image region is
firstly classified by SVM trained from different heterogeneous
descriptors. Then, the classification results of each heterogeneous descriptor are combined to obtain a unified classification

589

Fig. 1. Four sampled endoscopic images of the esophageal-gastric junctions
of patients in the National Cheng Kung University Hospital. (a) and (b) are the
images of non-GERD patients under different endoscopes. (c) and (d) show the
GERD patterns of the E-G junction. It is clear that the colors of the mucosa under
different endoscopes will be different which lead the illumination problem.

result for GERD diagnosis. All of the heterogeneous descriptors are extracted automatically from image regions to avoid
manual selection of ROI as indicated in [33] and [34]. In addition, we also introduce and evaluate a new measurement, the
index of hemoglobin (IHb) [35], to assess the hemoglobin of
the gastrointestinal mucosa for GERD identification.
In the remaining parts of the paper, Section II describes
the preliminary of endoscopy images. Section III presents our
HHDF-SVM. The computation of heterogeneous color models
and descriptors are presented in Section IV. The experimental
results are shown in Section V. Finally, Section VI draws the
conclusion.
II. PRELIMINARY
Four endoscopic images of E-G junctions of different patients
are shown in Fig. 1. The E-G junction contains the cardia, which
links the esophagus and the stomach. Because of the breath and
esophagus movement, the hole of the cardia will be varied with
time. Fig. 1(a) and (b) show two images of the patients without
GERD. In contrast to normal cases, the mucosa of GERD patients is broken as shown in Fig. 1(c) and (d), respectively. To
observe the esophageal mucosa, an additional light of the endoscope is required. When the light of the endoscope illuminates
the mucosa, the specular reflection will occur. Thus, the image
regions of the mucosa may be covered by illumination reflection from the light of the endoscope. Besides the illumination
reflection, secretions, such as saliva from the throat and gastric
juice from the stomach, may also affect the appearance of the
mucosa and lead to incorrect representation of mucosa breaks.
During the data collection, manufacturer types of endoscopes
are not controlled. Thus, color tones of different endoscopic
images from different endoscopes are significantly different as
shown in Fig. 1.

590

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

III. HHDF-SVM
The visual evidences of diagnosing GERD from endoscopic
images are mucosa breaks and esophageal lesions captured by
the endoscopic image of the E-G junction. In [33] and [34], it
also has been shown that recognition rates of the gastric histology can achieve more than 85% by the manual selection of ROI
from the endoscopic images. In their approaches, the manual
selection of ROI is necessary because the mucosa for diagnosis
needs to be consistent with the biopsy locations. Moreover, they
did not develop automatic biopsy location detection algorithms.
As shown in Fig. 1, the breaks or lesions of the esophageal
mucosa may distribute in different parts of the E-G junction. It is
hard to limit the regions for GERD diagnosis. A naive approach
is to apply global features such as RGB color histograms of the
entire endoscopic image for GERD diagnosis. However, global
features have been shown that they are hard to be against occlusions, spatial and illumination variations in [36]–[38]. Such
variations usually occur during endoscopy. Moreover, a GERD
patient can also have normal mucosa in the endoscopic image,
i.e., not all of the pixels and regions contain breaks or lesions of
GERD. Thus, using global features to represent the endoscopic
image will degrade the recognition accuracy.
To automatically diagnose GERD without manually selecting
target regions and overcome the interferences mentioned above,
heterogeneous descriptors are applied in the paper. Each heterogeneous descriptor represents a local image region of the E-G
junction and is computed from heterogeneous color models. To
consider all of the heterogeneous descriptors at the same time
for GERD diagnosis, we propose an HHDF-SVM framework.
Given an endoscopic image IE of the E-G junction of a patient, we separate IE into N regions as R = {R1 , R2 , . . . , Rn ,
. . . , RN }, where Rn is the nth region of IE and the size of
each region is w × w. To represent Rn , we compute K heterogeneous descriptors from L heterogeneous color models, i.e., K
× L heterogeneous descriptors are computed for each region.
The detailed equations of heterogeneous descriptors and color
models are presented in Section IV.
Let the descriptor dkl (Rn ) be the kth heterogeneous descriptor computed from the lth color model for Rn . A naive approach
is to scale and concatenate the heterogeneous descriptors of Rn
to a super vector d(Rn ) = [d11 (Rn ) . . . dkl (Rn ) . . . dKL (Rn )].
We then can apply the super vector as the input of the classifier
for GERD diagnosis. There are several problems for the naive
approach. The first one is the scale problem of heterogeneous
descriptors. These descriptors are computed from different color
models which contain different types of information. Enforcing
each descriptor to a unit vector will lose the original information of the descriptors and color models. Second, the feature
dimension sk l of each dkl (Rn ) are different. The descriptors
with larger sk l may dominate the classification results because
they occupy more dimensions in the super vector. Moreover,
the dimension of the merged super vector will face the curse of
dimensionality [39].
To solve the aforementioned problems, our HHDF-SVM
framework integrates the information from heterogeneous
descriptors of heterogeneous color models. By using HHDF-

SVM, we can then identify if a region is affected by GERD.
Fig. 2 illustrates the proposed framework. As shown in Fig. 2,
six color models are computed for Rn . Then, for each color
model, two descriptors SIFT [37] and CCH [38] are constructed.
For simplicity, dkl (Rn ) will be referred as dkl in the following.
There are two levels in HHDF-SVM including the bottom
level and the top level. In the bottom level, each kind of heterogeneous descriptor dkl is individually trained by a SVM
classifier Ck l . As a result, K × L (2 × 6 = 12) SVM classifiers
are trained in the bottom level of HHDF-SVM as shown in the
orange rectangle of Fig. 2. Then, the outputs of all of the SVM
classifiers in the bottom level are composed as a new input vector dt (Rn ), which is used as the input vector of the top level
of the proposed framework. In the following, dt (Rn ) will be
referred as dt for simplicity.
To integrate the decisions of the bottom level of HHDF-SVM,
we use another SVM classifier Ct to fuse the labels of the
bottom level and classify dt as shown in the yellow rectangle
of Fig. 2. After the decision of the top level, the label of Rn
is then decided by Ct . Because IE contains N regions, we take
all of Rn for consideration. If a sufficient number θ of Rn is
considered as regions with GERD, the patient is considered as
a GERD patient. In the following, we will describe the detailed
method of the proposed HHDF-SVM scheme. Please note that
each SVM classifier of the bottom level and the top level deals
with a binary classification problem, i.e., to classify if a patient
is a GERD patient or not.
In the bottom level, we train an SVM classifier Ck l for dkl
of all training regions, where dkl means the kth heterogeneous
descriptor computed from the lth heterogeneous color model
of an image region. If a training region is manually labeled by
well-experienced physicians as a GERD region, the label is 1.
Otherwise, the label is −1. Given dkl and its label yk l ࢠ{1,
−1}, we apply the ν-SVM [40]–[42] to train the classifier Ck l .
As a result, the classifier Ck l aims to classify the heterogeneous
descriptor dkl in the bottom level of the proposed framework. To
construct Ck l , each dkl is projected to a high dimensional feature
space by the kernel function Φ(dkl ). In the formulation of SVM,
the hyperplane w can be represented
combination of
 N i i as a linear
i
α
y
Φ(d
).
Then,
the linear
the training data as w= #
kl
i=1 k l k l
combination is substituted to the cost function ||w||2 = wT w of
SVM and the dual problem of SVM is obtained as follows:
1
min αT
k l Qαk l
α 2

(1)

subject to
0 ≤ αki l ≤ 1/#N, i = 1, ..., #N
eT αk l ≥ ν, y T αk l = 0
αk#lN ]T ,

(2)

where αk l =
ν binds
···
···
the maximum of the fraction of margin errors and the minimum of the fraction of support vectors, e is a column vector
of all ones, Q is a an #N × #N positive semidefinite matrix,
and #N is the total number of the training descriptors. Here,
Qij = yki l ykj l K(dik l ,djk l ) and K(dik l ,djk l ) = Φ(dik l )T Φ(djk l ) is
the kernel function, where the indices i and j represent the ith
[ αk1 l

αk2 l

αki l

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

591

Fig. 2. Proposed framework. Each region R n is sampled from the endoscopic image and six color models are constructed. Then, K × L heterogeneous descriptors
are computed from R n . Each heterogeneous descriptor dkl is classified by the bottom level classifier C k l to obtain the classification label, where k ࢠ {1, 2} and
l ࢠ {1, 2, 3, 4, 5, 6}. The labels of all bottom level classifiers form a new vector dt . To obtain the label of R n , the top level classifier C t is applied to classify
dt . The purple rectangle represents six color models including the RGB color model, the normalized RGB color model, the opponent color model, the C-invariant
color model, the transformed RGB color model, and the index of hemoglobin model. The green rectangle represents 12 heterogeneous descriptors computed by
using SIFT and CCH. The red rectangle represents the HHDF-SVM which includes two levels: the 12 bottom level classifiers (the orange rectangle) for classifying
each descriptor dkl and the top level classifier C t (the yellow rectangle) for fusion.

and jth heterogeneous training descriptors of dkl . Please refer
to [41] and [42] for the detailed derivation. In our approach, we
use the radial-basis function (RBF) as the kernel function which
is suggested in [42] as follows:
j

K(dik l ,djk l ) = e−||dk l −dk l ||
i

2

/σ

(3)

where σ is set as the number of features. The predicted label
ẏk l using the SVM classifier Ck l trained by the heterogeneous
descriptor dkl is defined as follows:
# N


i
i
i
ẏk l = sgn
yk l αk l K(dk l ,dk l ) + bk l .
(4)
i=1

Until this step, K × L SVM classifiers are trained by using
different heterogeneous descriptors dkl of different heterogeneous color models and form the bottom level classifiers of the
proposed framework.
To fuse the results of the bottom level, the top level SVM
classifier Ct is trained. For each training region, we compute K
× L heterogeneous descriptors. Each dkl is classified by related
classifier Ck l to obtain the classification labels of the bottom
level. The input feature vector dt of an image region for Ct is
defined as the union of predicted label ẏk l of each classifier Ck l
as follows:


(5)
dt = ẏ11 ẏ12 . . . ẏk l . . . ẏk L .
The label yt of dt ࢠ{1, –1}, if the training region is a GERD
region, the label is 1. By using dt as the training vector of
the top level of the HHDF-SVM framework, we then train Ct
which combines the information of heterogeneous descriptors
and color models. With the proposed scheme, we can diagnose GERD of each region by fusing all information from
heterogeneous descriptors of heterogeneous color models. Here,

Ct is also a ν-SVM [40]–[42]. The label ẏt of dt classified by
Ct is defined as
# N


i
i i
ẏt = sgn
yt αt K(dt ,dt ) + bt
(6)
i=1

αti

where is the ith coefficient of αt which is the optimal vector
of the dual problem for the classifier Ct .
During testing, for each region Rn , we also extract K × L
heterogeneous descriptors from the test endoscopic image. For
each descriptor dkl of Rn , we obtain the label ẏk l by using (4)
at first. Then we combine the labels of all K × L heterogeneous
descriptors as shown in (5) to obtain the label yt of the top level
classifier by using (6). Thus, each Rn contains its own label
ẏt (Rn ) after applying the HHDF-SVM framework.
Because the E-G junction image is split to N regions, an
efficient voting scheme is applied to decide if the patient is a
GERD patient. It is worth to note that not all of the image regions
will be covered by lesions of GERD. The number of lesions of
GERD is computed as follows:
Sum =

N


{1|ẏt > 0}.

(7)

i=1

If Sum is larger than a threshold θ, the patient is considered
as a GERD patient. As for the effects of different θ, please refer
to the experiments.
IV. HETEROGENEOUS DESCRIPTOR REPRESENTATION
A. Heterogeneous Color Models
To investigate the interferences of lighting changes and the
automatic camera white balance adjustment for general object
and scene recognition problems, various color models are ana-

592

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

lyzed in [36]. In this paper, we apply six color models for the
evaluation of GERD diagnosis and show the comparison results
in the experiments. Besides the standard RGB color models,
four color invariant models and a new measurement, the index
of hemoglobin (IHb) [35] are applied for computing heterogeneous descriptors. IHb can assess the hemoglobin in the predominant pigment of the gastrointestinal mucosa [43], which
can represent color changes of mucosal inflammation. To the
best of our knowledge, there are still no related researches to
analyze which color models are good to represent endoscopic
images for disease diagnosis. In the following, we will introduce
these six color models and evaluate the performance of different
heterogeneous color models in the experiments.
1) RGB Color Model: An endoscopic image is captured and
digitized to red (R), green (G) and blue (B) eight bits digital
image data with lossless compression. The ranges of the R, G,
and B channels are between 0 and 255, respectively.
2) Normalized RGB Color Model: This model has been
shown to be invariant to illumination changes [36]. Thus, extracting features from the normalized RGB color model can
reduce the influences of the shadows and shading. The components r, g, and b of the normalized RGB model are calculated as
follows:
⎡

R
⎡ ⎤ ⎢R+G+B
r
⎢
⎢ ⎥ ⎢
G
⎢g⎥ = ⎢
⎣ ⎦ ⎢
⎢R+G+B
⎢
b
⎣
B
R+G+B

⎤
⎥
⎥
⎥
⎥
⎥.
⎥
⎥
⎦

(8)

3) Opponent Color Model: The opponent color model has
been widely used as a color invariant space for image matching
[36] and graphics applications [44]. It is invariant to both light
intensity changes and shifts. The opponent color channels O1
and O2 represent the color information. The opponent color
channel O3 represents the intensity information of the image.
The opponent color model is defined as follows:
⎡

R−G
√
⎤ ⎢
⎡
2
O1
⎢
⎥ ⎢
⎢
R + G − 2B
⎢ O2 ⎥ = ⎢
√
⎦ ⎢
⎣
⎢
6
⎢
O3
⎣ R+G+B
√
3

⎤
⎥
⎥
⎥
⎥
⎥.
⎥
⎥
⎦

follows:

⎡

⎤

⎡
0.06
⎥ ⎢
⎢
⎢ Êλ ⎥ = ⎣ 0.30
⎦
⎣
0.34
Êλλ
Ê

0.63
0.04
−0.60

0.27

⎤⎡

R

⎤

⎥⎢ ⎥
−0.35 ⎦ ⎣ G ⎦
0.17

(10)

B

where Ê, Êλ and Êλλ are the C-invariant channels.
5) Transformed RGB Color Model: Also shown in [36], the
RGB histogram is not invariant to illumination changes. To
solve the problem, a transformed color space is proposed by
normalizing RGB values using the mean and standard deviation
of each color channel. Because each channel is normalized independently, the model can against changes in lighting color and
arbitrary offsets of each channel. Here, the means and standard
deviations of each color channel are computed using all of the
pixels in the endoscopic image. The channels of transformed
color model, R , G and B , are defined as follows:
⎤
⎡
R − μR
⎡  ⎤ ⎢ σR ⎥
⎥
⎢
R
⎥
⎢
⎢  ⎥ ⎢ G − μG ⎥
(11)
⎥
⎣G ⎦ = ⎢
⎢ σG ⎥

⎥
⎢
B
⎣B−μ ⎦
B
σB
where μc and σc are the mean and the standard deviation of
the distribution in the color cannel C computed over the endoscopic image and C ࢠ {R, G, B}. Please note that we exclude
black backgrounds of endoscopic images shown in Fig. 1 during
the mean and the standard deviation computation to avoid the
background interferences.
6) Index of Hemoglobin (IHb) Model: IHb is used to measure the gastric mucosal bloods. As shown [35], IHb can also
represent a color model that enhances mucosal blood flows of
the endoscopic images. The situation of the mucosal blood flow
is helpful to detect inflammation and lesion areas. IHb has been
widely used in the diagnosis of gastric mucosa [43]. Also indicated in [9], IHb provides correlations between LA grade classification and GERD. Thus, we also impose IHb for automatic
GERD detection. The IHb is calculated from the endoscopic
image as follows:
R
.
(12)
G
With these six heterogeneous color models, we will extract
two heterogeneous descriptors from these models to represent
the esophageal mucosa of the endoscopic images for GERD
diagnosis.
IHb = 32 log2

(9)

4) C-Invariant Color Model: In [45], Geusebroek et al. derive
illumination and geometric invariant properties of objects using
the Kubelka–Munk theory [46], which models the reflection
of color objects. To efficiently obtain these invariant properties
from the RGB color model, they consider the Gaussian color
model to represent spectral differential quotients at first. Then,
the spectral differential quotients of the C-invariant color model
can be obtained by a linear combination of RGB values as

B. Heterogeneous Descriptors
To efficiently and effectively represent the properties of edges
and textures of local regions under variant geometric and photometric transformations, we consider using two heterogeneous
descriptors, SIFT [37] and CCH [38], for each color model. SIFT
[37] has been shown to its performance on edge representation
for image matching and object recognition. SIFT represents the
sampled region using edge information. To consider appearance

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

593

Algorithm 1. Step by Step Algorithm of the HHDF-SVM
Framework
Require: An endoscopic image IE , Sum = 0
1.
Split IE to R = {R1 , . . . ., Rn , . . . , RN }
2.
for n = 1 to N do
3.
for k = 1 to K do
4.
for l = 1 to L do
5.
Compute dkl (Rn )
6.
end for
7.
end for
8.
end for
9.
for n = 1 to N do
10.
for k = 1 to K do
11.
for l = 1 to L do
12.
Classify dkl (Rn ) using Ck l to obtain ẏk l
13.
end for
14.
end for
15.
Classify dt (Rn ) in Eq. (5) using Ct to obtain ẏt
16.
if ẏt > 0
17.
Sum ← Sum + 1
18.
end if
19.
end for
20.
if Sum > θ
21.
IE belongs to a GERD patient
22.
else
23.
IE belongs to a non-GERD patient
24.
end if
information like regions of inflammation and ulcer at E-G junction of GERD patients, we modify the appearance-based descriptor CCH [38] to represent the textures of mucosa.
Because both SIFT and CCH descriptors are applied to gray
level images, we modified both descriptors to generate descriptors from multiple channels of heterogeneous color models.
Given a region Rn , the computation of modified SIFT and CCH
descriptors for the lth color model Ml is presented as follows.
For clearness, descriptors d1l and d2l are referred as the descriptors computed by SIFT and CCH from the lth color model
Ml , respectively.
To build the SIFT descriptor of Rn using Ml , the gradient
magnitude ρω (x, y) and gradient orientation θω (x, y) of each
pixel p = (x, y) in Rn are first computed from the ωth color
channel of Ml as follows:
ρω (x, y) = ((ω(x + 1, y) − ω(x − 1, y))2
1

+ (ω(x, y + 1) − ω(x, y − 1))2 ) 2

(13)

ω(x, y + 1) − ω(x, y − 1)
ω(x + 1, y) − ω(x − 1, y)

(14)

and
θω (x, y) = tan−1

where ω(x, y) is the value of p of the ωth color channel of Ml .
Then, Rn is separated into 4 × 4 subregions as shown in Fig. 3.
The orientation histograms with eight bins are computed from
ρω (x, y) and θω (x, y) of each pixel of each subregion in Rn as
[37]. The SIFT descriptor dω1l of the ωth color channel of Ml
is then formed as the vector of all histogram values and the

Fig. 3. The Framework of the computation of the heterogeneous descriptors.
Given a region R n marked by blue, we construct the lth color model from R n .
Then, the SIFT descriptor and the CCH descriptor are respectively computed to
represent R n and are used as the input vectors of bottom classifiers C , where k
belongs to {1, 2}.

dimension is 128 ( = 4 × 4 × 8).
 The final SIFT descriptor
d1l of Ml is then defined as d1l = d11l d21l d31l by joining
three SIFT descriptors computed from Ml and the dimension of
d1l will be 384 ( = 128 × 3). Please refer to [36] and [37] for
detailed implementation.
To build the CCH descriptor d2l from the lth color model Ml ,
we quarter Rn into 2 × 2 subregions, s1 , s2 , s3 , and s4 as shown
in Fig. 3. Let pc be the center pixel located in Rn . For the ωth
color channel of Ml , we obtain the value of pc by computing
the mean of four center pixels of the ωth color model as shown
in the yellow regions of the CCH construction diagram in Fig. 3.
The color contrast value vω ,ω ’ (p, pc ) of p in Rn between the
ωth color channel of p and the ω  th color channel of pc of Ml
is defined as follows:


ν ω ,ω (p, pc ) = ω (p) − ω  (pc )

(15)

where ω(p) and ω  (p) are the values of p and pc in the ωth color
and ω  channels of Ml , respectively. Please note that ω can be
the same as ω  of Ml .
Similar to [47], we simplify the color channel combinations
of ω and ω  to 6. In each subregion si , where i ࢠ {1, 2, 3, 4}, we
compute positive and negative contrast value histograms. The
positive contrast histogram of si is defined as follows:
 ω ,ω 

(p, pc )|p ∈ si &v ω ,ω (p, pc ) ≥ 0}
{v

hωs i,ω
(p
)
=
c
+
#si+
(16)
and the negative contrast histogram of the quadrant si is defined
as follows:
 ω ,ω 

(p, pc )|p ∈ si &v ω ,ω (p, pc ) < 0}
{v

hωs i,ω
(p
)
=
c
−
#si−
(17)
where and #si+ and #si− are the numbers of pixels with positive and negative contrast values in si under Ml , respectively.
The CCH descriptor d2l (si ) of the subregion si is defined as
the vector of all positive and negative histogram values of the
six color channel combinations and the dimension is 12 ( = 2
× 6). The final CCH descriptor d2l of Ml is then defined as
d2l = [d2l (s1 ) d2l (s2 ) d2l (s3 ) d2l (s4 )] by joining four CCH

594

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

descriptors computed from all subregions and the dimension of
d2l is 48 ( = 12 × 4).
Please note that we repeat the IHb model three times to form
a three channel IHb space for the descriptor computation. Fig. 3
shows the framework of the computation of the heterogeneous
descriptors. Both SIFT and CCH descriptors are respectively
computed to represent Rn and are used to classify Rn . Finally,
given N regions, N × K × L heterogeneous descriptors are computed and are used to diagnose GERD by the proposed HHDFSVM framework. For the detailed algorithm of the proposed
framework for testing, please refer to Algorithm 1.
V. EXPERIMENTS

is the number of correctly classified GERD patients and NP is
the number of patients who have GERD. TN is the number of
non-GERD patients diagnosed by the classifier and NN is the
number of non-GERD patients.
TPR =

TP
NP

(18)

TNR =

TN
NN

(19)

and
FPR = 1 −

B. Evaluation Metrics
For evaluation, we define the true positive rate (TPR), true
negative rate (TNR) and false positive rate (FPR) as follows. TP

(20)

Finally, the accuracy (ACC) is defined as

A. Patients and Study Design
A total of 147 patients undergoing esophagealgastroduodenal endoscopy were enrolled in this study to
confirm the presence of GERD or normal esophageal mucosa.
Based on the observations of the experienced physicians, 39 of
the study patients were defined as GERD with LA grade A–D.
The patients with the presence of typical clinical symptoms of
GERD were reviewed. Patients with normal esophageal mucosa
were also reviewed for comparison. Please note that the GERD
diagnosis problem is defined as a binary classification problem,
i.e., to classify if a patient is a GERD patient or not. Based on
the suggestion of physicians, we assumed that the positive rate
of HHDF-SVM in the control group was 10%. We wanted to be
able to detect an increase to be 30% of the detection rate in the
case group. With a two-side alpha value of 0.05, power of 80%,
and the proposed control-to-case ratio of 3, the total number of
patients required was 147 [48].
To avoid impediments in evaluating GERD status, none of
the enrolled subjects had taken antisecretory agents, and proton pump inhibitors, within four weeks prior to the endoscopy.
Patients were excluded if they had the following conditions:
the presence of peptic ulcers; major medical problems, including hypertension, liver cirrhosis, and congestive heart failure;
or undergone previous gastric surgery. Throughout the study,
upper gastrointestinal electronic endoscopes (GIF-Q260, Olympus Optical, Tokyo, Japan) with an electron endoscopy system
(EVIS-260, Olympus Optical, Tokyo, Japan) were used to capture the endoscopic images. The color endoscopic images are
collected by an endoscopic image database system (EVIS-NET)
on a personal computer. Unlike [9], these endoscopes are not
color calibrated and without manual white balance adjustment.
During each endoscopic session, we inserted the endoscope until
the E-G junction was reached. Then, the LA grades are manually
labeled by well-experienced physicians to define the presence
or absence of GERD. Then, we captured a frozen endoscopic
image of the E-G junction for each patient and this image is
used for computer-aided GERD diagnosis. As a result, a total of
147 images were used in the experiments.

TN
.
NN

ACC =

TP + TN
.
NP + N N

(21)

To evaluate the performance of heterogeneous descriptors
dkl , we computed TPR, TNR and FPR of each classifier Ck l
and Ct by using ten-fold cross validation for efficiency and
parameter evaluation in the following.
C. Evaluation of Parameters in HHDF-SVM
In our experiments, the LA grades from experienced physicians are regarded as the ground truth of the GERD diagnosis.
We used LIBSVM [42] for the SVM classification with the RBF
kernel. The numbers K and L of heterogeneous descriptors and
color models are 2 and 6, respectively. As a result, 12 (= 2 × 6)
heterogeneous classifiers are trained in the bottom level of the
proposed HHDF-SVM framework.
In this section, we aim to evaluate three parameters in HHDFSVM. The first parameter is the size of the region w. If w
becomes large, each heterogeneous descriptor represents a larger
region and the number of regions will decrease. The second
parameter is ν of ν-SVM which binds the maximum of the
fraction of margin errors. The third parameter θ is the threshold
for deciding if a subject is a GERD patient. For each endoscopic
image, we changed the sizes w of the region of interest (ROI)
from 12 to 40. For each w, we examined ν of the ν-SVM from
0.2 to 0.4.
Fig. 4 shows the receiver operating characteristic (ROC)
curves for HHDF-SVM with respect to different sizes w of
the region. To draw the ROC curves, we varied the values of θ
of the HHDF-SVM framework from 1 to 26 to obtain different
TPR, FNR and FPR values. To investigate the effects of different
ν values, we drew five ROC curves of different ν values that
were close to the best ROC curve of each w for comparison. As
shown in Fig. 4, the ν values of the best ROC curves of each w
are different. Thus, we show the best ROC curves of ν for each
size of the region in Fig. 5.
As shown in Fig. 5, when the sizes of ROI are too large or
too small, the classification performance will degrade. When
w is too small, the region contains too few information, and is
easily affected by illumination reflection and secretions during
heterogeneous descriptor computation. In contrast, when w is
too large, each region may contain normal mucosa and abnormal
mucosa simultaneously. As a result, the classification accuracy

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

595

Fig. 5. ROC curves of HHDF-SVM of the best classification rates of ν with
respect to different w.

Fig. 6. ROC curves of bottom level classifiers of the RGB model, the normalized RGB model, the opponent color model, the C-invariant color model, the
transformed color model, the IHb model, and the gray level model for (a) SIFT
descriptors and (b) CCH descriptors.

Fig. 4. ROC curves of HHDF-SVM with respect to different ν and w. For
clearness, we draw five ROC curves of different ν from 0.33 to 0.37 for each
w. The ROC curves of (a) w = 12, (b) w = 16, (c) w = 20, (d) w = 24, (e)
w = 28, (f) w = 32, (g) w = 36, and (h) w = 40.

will also decrease. According to Figs. 4 and 5, the best ROC
curve was performed when w = 32 and ν = 0.34. Thus, we
selected w = 32 and ν = 0.34 in the following experiments.
D. Evaluation of Heterogeneous Descriptors and
Color Models
Because all of the heterogeneous descriptors are computed
from different color models, the color information is embedded

in each descriptor for GERD diagnosis. We also evaluated the
performance of different heterogeneous color models in the experiments. The ROC curves of the bottom level classifiers using
SIFT and CCH descriptors computed from heterogeneous color
models are shown in Fig. 6(a) and (b), respectively. After obtaining the best ν for each model, we change the values of θ to
obtain the ROC curves of each color model in Fig. 6(a) and (b),
respectively.
As shown in Fig. 6(a), the ROC curves of the classifiers using
SIFT descriptors computed from RGB, normalized RGB, and
C-invariant color models achieved better results. Compared to
the ROC curves of classifiers using SIFT descriptors, the ROC
curves of classifiers using CCH descriptors performed better
results when using transformed color and IHb models as shown
in Fig. 6(b). Such results indicate that the descriptors should
cooperate with proper color models to achieve better representation of endoscopic images for GERD diagnosis. Moreover, because SIFT and CCH descriptors have different benefits by using

596

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

heterogeneous color models, they turn to a complementary to
each other for HHDF-SVM. For comparison, we also compute
SIFT and CCH descriptors using the gray levels of the endoscopic images. As shown in Fig. 6(a), the performance of the
ROC curve of the SIFT on the gray levels is obviously worse
than the results of SIFT on color models. Similar results can
be observed in Fig. 6(b). Thus, applying heterogeneous color
models can help to solve the GERD classification problem.
E. Results
To demonstrate the performance of the proposed method,
we compared our method with AdaBoost (Ada) [49], and cascade boost (CB) [50]. Both AdaBoost and cascade boost can
be applied to learn classifiers from heterogeneous descriptors
because each weak classifier can be trained from different descriptors. AdaBoost aims to combine many weak classifiers into
a weighted sum to make the final decision. Each weak classifier can be trained from different descriptors. Thus, it can also
be considered as a fusion scheme of heterogeneous descriptors.
During the training of AdaBoost, AdaBoost picks weak classifiers which perform the lowest error rate and adjusts the weights
based on the prediction results. Please refer to [49] for the detail
algorithm.
We also compared our method to cascade boost [50], which
was designed for unbalanced data classification by using heterogeneous features. To efficiently identify negative examples,
cascade boost contains several cascaded classifiers. The previous classifiers aim to reject the obvious negative samples. The
later classifiers are used to identify the GERD patterns. Each
classifier of cascade boost is an AdaBoost classifier. The weak
classifier of each AdaBoost classifier is trained by selecting
different heterogeneous features.
Besides the comparisons to Adaboost and cascade boost, feature selection methods, which aim to select a proper subset that
can represent the whole feature space and avoid the curse of
dimensionality, are also compared. To balance the computation cost and performance, we chose sequential forward floating search (SFFS) [51] to select the best feature subset from
heterogeneous descriptors for SVM classification. When the dimension of the super vector is very large, the standard optimal
method such as branch and bound is then infeasible for practical usage. SFFS has been found in [52], [53] that the produced
results are very close to the optimal results of the branch-andbound method and is more efficient to select a subset of features. Before the feature selection, we individually normalized
12 heterogeneous descriptors to unit vectors to avoid the scale
problem. Then, we applied SFFS to select a subset that has the
best classification rate by using the conventional SVM classifier.
The ROC curves of comparative results of the proposed
HHDF-SVM with respect to state-of-the-art methods and endoscopists are shown in Fig. 7. The same as the previous section,
the ROC curves were obtained by varying the θ values from 1
to 26. As shown in Fig. 7, cascade boost performs better classification results compared to the results of AdaBoost. Because
cascade boost contains several AdaBoost classifiers to reject
negative regions, it naturally has better classification results.

Fig. 7. ROC curves of the HHDF-SVM, cascade boosting (CB), AdaBoost
(Ada), CCH on the transformed RGB model, SIFT on the transformed RGB
model, and results of two endoscopists (E1 and E2).

The ROC curve of SFFS is also shown in Fig. 7. The performance of SFFS is better than that of boosting-based methods,
because the objective function of SFFS aims to select the feature
subset that achieves the best classification rates during feature
selection. Nevertheless, selected features are combined from
heterogeneous descriptors without considering the individual
properties of descriptors and color models. Because the SIFT
descriptor is computed from the edge orientation histogram, the
scale of the value of the SIFT descriptor is bounded by the magnitudes of edges computed from each color model. In contrast,
the CCH descriptor is computed by averaging the color contrasts. The scale of the value of the CCH descriptor is bounded
by the color contrasts of each color model. The scales of the
values of the SIFT and CCH descriptors are different. To avoid
the scale problem, the normalization of SIFT and CCH descriptors is performed. The discriminability of CCH and SIFT will
then decrease because the ranges of values of descriptors are
also compressed. As a result, the performance of SFFS is still
worse than that of the proposed method.
In Fig. 7, we also draw the best ROC curves of the bottom level classifiers using SIFT and CCH descriptors, respectively. Because GERD patterns have significant mucosa texture
changes, the appearance-based descriptor CCH [38] can have
better representation of the GERD patterns compared to that of
the edge-based descriptor SIFT [37]. Compared to the bottom
classifiers, the proposed HHDF-SVM performs the best ROC
curve because it combines the advantages of heterogeneous descriptors computed from heterogeneous color models. It is also
worth to note that two inexperienced endoscopists (E1 and E2)
perform similar results as the bottom level classifier using SIFT
which implies the practical usability of the automatic CAD
method.
Table I shows the quantitative results of each method from
the ROC curves shown in Fig. 7. To consider both TPR and

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

597

TABLE I
ACCURACY, SENSITIVITY AND SPECIFICITY (%)

Ada
CB
SFFS
CCH
SIFT
HHDF-SVM
E1
E2

ACC

TPR

TNR

51.1
58.5
78.9
70.1
66.0
93.2
69.6
70.4

69.3
69.6
79.5
74.4
79.5
94.9
93.8
87.5

44.5
55.1
78.7
68.5
61.1
92.6
66.4
68.1

TABLE II
AVERAGE COMPUTATION TIME (S) PER PATIENT
Stage

Time

CCH
SIFT
Bottom Level
Top Level
Total

0.040
0.601
1.416
0.052
2.109

TNR simultaneously, we multiplied TPR by TNR for each θ of
each method. Then, we select the θ which has the highest TPR
× TNR value of each method and report TPR, TNR and the
ACC in Table I. As shown in Table I, our method performed
the best results compared to all of the state-of-the-art methods.
The θ of the proposed method is 1. If a region contains GERD
patterns, the subject is considered as a GERD patient. The result
is consistent to the diagnosis in the medical domain because
GERD patterns may not be observed in every regions of the
endoscopic image of the E-G junction. Once a GERD pattern
is observed, the patient is then considered as a GERD patient.
With our CAD method, a consistent reference can be provided
for assisting GERD diagnosis and will not be affected by human
factors.
As for the evaluation of computational efficiency, the average computation time per patient of each stage of the proposed
method on an Intel i7 3.4 GHz CPU with 8 GB memory computer is shown in Table II. The computation time of the CCH
descriptors of six color models is less than that of the SIFT
descriptors of six color models. Such results are expected because the computation of CCH is much more efficient than that
of SIFT. Nevertheless, the total computation time of heterogeneous descriptors is still less than a second. After the descriptor computation, 12 heterogeneous descriptors are individually
classified by their bottom level classifiers Ck l . Then, the results
are used as the input of the top level classifier Ct . Because the
dimension of dt is fewer than those of the heterogeneous descriptors dkl , the computation time of Ct is less than that of the
classifiers in the bottom level. As shown in Table II, the total
computation time for each patient during testing is around 2.1 s.
As a result, the proposed HHDF-SVM is feasible for practical
usage.

F. Discussion
The proposed HHDF-SVM presents a different fusion concept compared to Adaboost [48], and cascade boost [50]. In Adaboost, each weak classifier is trained by using a heterogeneous
descriptor and then the fusion results will depend on the sign of
the sum of the weighted labels classified by weak classifiers. In
this case, the classification result of the Adaboost classifier can
be considered as a voting result based on the weighted labels
of the weak classifiers. Since each weak classifier may fail to
represent GERD even when the classifier is a strong classifier
as shown in Fig. 6, the combination results is then expected to
be worse.
The cascade boost contains several AdaBoost classifiers and
connects these classifiers in a sequential order. Each AdaBoost
classifier of cascade boost aims to remove normal regions. The
AdaBoost classifiers in the later stage of cascade boost contain
more weak classifiers and aim to classify regions which are
hard to be identified by classifiers in the previous stages. Nevertheless, the input vector of all of the AdaBoost classifiers of
cascade boost is the same. Thus, although negative regions can
be rejected in the previous stage, the classifications still rely on
the Adaboost classifier in the last stage and will face the same
problem of the Adaboost classifier mentioned above.
Different from Adaboost and cascade boost, HHDF-SVM
combines the labels of classifiers of the bottom level as a new
feature vector dt . Then, dt is used as the input of the classifier
of the top level in HHDF-SVM. Using the sign of the weighted
sum of the elements of dt is able to classify linearly separable
data. When the data are not linearly separable, the sign of the
weighted sum is hard to correctly classify the labels of data.
As a result, kernel-based methods [40]–[42] are proposed to
project data to high dimensional space to solve the classification
problem of nonlinearly separable data. Inspired from the kernel
concept, HHDF-SVM does not consider the sign of the weighted
sum of the elements of dt as the final labels. It projects dt to
high-dimensional space by using the kernel function of the top
level SVM classifier Ct and then finds a hyperplane to separate
positive and negative data. As a result, HHDF-SVM can achieve
better fusion results compared to Adaboost and cascade boost,
and is different from the boosting-based approaches.
HHDF-SVM presents a hierarchical fusion method to combine the information of heterogeneous descriptors with different
scales and properties. Each bottom level SVM classifier has its
own optimal hyperplane computed for each heterogeneous descriptor without interferences of other descriptors. Thus, the
original discriminability of each heterogeneous descriptor can
be presented in each bottom level classifier. Instead of considering voting or linear combination schemes of the decision results
of bottom level classifiers, the top level classifier provides a nonlinear fusion scheme to identify labels by simultaneously considering all of the features. It also avoids the burdens of selecting
proper features as SFFS does. By using the optimal hyperplane
of the top level classifier, normal and abnormal data can be separated without incurring the scale problems of SFFS. Thus,
HHDF-SVM is suitable for solving classification problems
which need to simultaneously consider heterogeneous features

598

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

with different scales and properties. For example, an SVM classifier trained from textures helps to recognize the appearance of
the target and an SVM classifier trained from edges helps to recognize the shape of the target, respectively. These two SVM classifiers are applied as the bottom level classifiers of HHDF-SVM
to recognize the appearance and the shape of the target, respectively. Then, the top level classifier of HHDF-SVM is applied to
nonlinearly fuse the recognition results of the appearance and
the shape to recognize the target. As a result, HHDF-SVM provides an effective and efficient way to integrate heterogeneous
descriptors (features) for solving classification problems.
Because the endoscopic image of the E-G junction will contain the hole of the cardia, the image regions of the hole may
become darker and will be visually similar for both GERD and
non-GERD patients. Thus, the value of threshold of θ provides
the tolerance of false negatives of the image regions of the hole
of the cardia. The possible solution is to detect the hole of the
cardia in the endoscopic image as [54]. Nevertheless, additional
computation time is required.
VI. CONCLUSION
A new CAD method is proposed for GERD diagnosis from endoscopic images by using HHDF-SVM. With heterogeneous descriptors and color models, the interferences of lighting changes
and automatic camera white balance adjustment can be reduced.
Moreover, by integrating all of the heterogeneous descriptors,
manual selection [33], [34] of ROI can be avoided. We also evaluate the combinations of heterogeneous descriptors and color
models to provide the reference of the practical usage of heterogeneous descriptors in endoscopic image analysis. In the future,
we will collect more data from GERD patients for evaluation
and focus on automatically grading GERD according to LA
grades.
REFERENCES
[1] R. H. Holloway et al., “Relation between oesophageal acid exposure and
healing of oesophagitis with omeprazole in patients with severe reflux
esophagitis,” Gut, vol. 38, no. 5, pp. 649–654, 1996.
[2] J. Dent et al., “Epidemiology of gastro-oesophageal reflux disease: A
systematic review,” Gut, vol. 54, no. 5, pp. 710–717, 2005.
[3] G. R. Locke et al., “Prevalence and clinical spectrum of gastroesophageal
reflux: A population-based study in olmsted county, minnesota,” Gastroenterology, vol. 112, no. 5, pp. 1448–1456, 1997.
[4] G. R. Locke et al., “Risk factors associated with symptoms of gastroesophageal reflux,” Amer. J. Med., vol. 106, no. 6, pp. 642–649, 1999.
[5] Y.-C. Lee et al., “Comparative analysis between psychological and endoscopic profiles in patients with gastroesophageal reflux disease: A prospective study based on screening endoscopy,” J. Gastroenterol. Hepatol.,
vol. 21, no. 5, pp. 798–804, 2006.
[6] K. R. Devault and D. O. Castell, “Updated guidelines for the diagnosis
and treatment of gastroesophageal reflux disease,” Amer. J. Gastroenterol.,
vol. 100, no. 1, pp. 190–200, 2005.
[7] N. Vakil et al., “The montreal definition and classification of gastroesophageal reflux disease: A global evidence-based consensus,” Amer. J.
Gastroenterol., vol. 101, no. 8, pp. 1900–1920, 2006.
[8] H.-B. Yang et al., “H. pylori eradication prevents the progression of gastric intestinal metaplasia in reflux esophagitis patients using longterm
esomeprazole,” Amer. J. Gastroenterol., vol. 104, no. 7, pp. 1642–1649,
2009.
[9] H. Cheng et al., “Supplementation of Los Angeles classification with
esophageal mucosa index of hemoglobin can predict the treatment response of erosive reflux esophagitis,” Surg. Endosc., vol. 25, no. 8,
pp. 2478–2486, 2011.

[10] D. Armstrong et al., “The endoscopic assessment of esophagitis: A
progress report on observer agreement,” Gastroenterology, vol. 111,
no. 1, pp. 85–92, 1996.
[11] J. Dent et al., “An evidence-based appraisal of reflux disease
management—The Genval workshop report,” Gut, vol. 44, no. 2,
pp. S1–S16, 1999.
[12] L. Lundell et al., “Endoscopic assessment of oesophagitis: Clinical and
functional correlates and further validation of the Los Angeles classification,” Gut, vol. 45, no. 2, pp. 172–180, 1999.
[13] W.-Y. Chen et al., “Double-dosed pantoprazole accelerates the sustained
symptomatic response in overweight and obese patients with reflux
esophagitis in Los Angeles grades A and B,” Amer. J. Gastroenterol.,
vol. 105, pp. 1046–1052, 2010.
[14] P. J. Kahrilas and E. M. Quigley, “Clinical esophageal pH recording: A
technical review for practice guideline development,” Gastroenterology,
vol. 110, pp. 1982–1996, 1996.
[15] M. Barrientos et al., “A dynamic analysis of area under the curve (AUC)
estimation of hydrogen ion activity predicts mucosal damage in GERD,”
in Proc. Annu. Int. Conf. IEEE Eng. Med. Biol. Soc. Eng. Advances: New
Opportunities Biomed. Eng., 1994, pp. 1174–1176.
[16] H. C. Rath et al., “Comparison of interobserver agreement for different
scoring systems for reflux esophagitis; impact of level of experience,”
Gastrointest. Endosc., vol. 60, no. 1, pp. 44–49, 2004.
[17] T. Starner and D. Ashbrook, “Augmenting a pH medical study with wearable video for treatment of GERD,” in Proc. Int. Symp. Wearable Comput.,
2004, pp. 194–195.
[18] P. A. Hammond et al., “A system-on-chip digital pH meter for use in a
wireless diagnostic capsule,” IEEE Trans. Biomed. Eng., vol. 52, no. 4,
pp. 687–694, Apr. 2005.
[19] I. De Falco et al., “An integrated system for wireless capsule endoscopy
in a liquid-distended stomach,” IEEE Trans. Biomed. Eng., vol. 61, no. 3,
pp. 794–804, Mar. 2014.
[20] J. L. Gonzalez-Guillaumin et al., “Ingestible capsule for impedance and
pH monitoring in the esophagus,” IEEE Trans. Biomed. Eng., vol. 54,
no. 12, pp. 2231–2236, Dec. 2007.
[21] T. Ativanichayaphong et al., “An implantable batteryless wireless
impedance sensor for gastroesophageal reflux diagnosis,” in Proc. IEEE
MTT-S Int. Microw. Symp. Dig., 2010, pp. 608–611.
[22] H. Cao et al., “An implantable, batteryless, and wireless capsule with
integrated impedance and ph sensors for gastroesophageal reflux monitoring,” IEEE Trans. Biomed. Eng., vol. 59, no. 11, pp. 3131–3139, Nov.
2012.
[23] A. Karargyris and A. Koulaouzidis, “OdoCapsule: Next-generation wireless capsule endoscopy with accurate lesion localization and video
stabilization capabilities,” IEEE Trans. Biomed. Eng., vol. 62, no. 1,
pp. 352–360, Jan. 2015.
[24] X. Luo and K. Mori, “Robust endoscope motion estimation via an animated particle filter for electromagnetically navigated endoscopy,” IEEE
Trans. Biomed. Eng., vol. 61, no. 1, pp. 85–95, Jan. 2014.
[25] H. Liang et al., “Application of the empirical mode decomposition to
the analysis of esophageal manometric data in gastroesophageal reflux
disease,” IEEE Trans. Biomed. Eng., vol. 52, no. 10, pp. 1692–1701, Oct.
2005.
[26] M. Najmabadil et al., “Wavelet decomposition for the analysis of
esophageal manometric data in the study of gastroesophageal reflux disease,” in Proc. Biomed. Circuits Syst. Conf., 2007, pp. 207–210.
[27] D. R. Lichtenstein et al., “Role of endoscopy in the management of
GERD,” Gastrointest. Endosc., vol. 66, no. 2, pp. 219–224, 2007.
[28] J. E. Richter, “Diagnostic tests for gastroesophageal reflux disease,” Amer.
J. Med. Sci., vol. 326, no. 5, pp. 300–308, 2003.
[29] P. Moayyedi and N. Talley, “Gastro-oesophageal reflux disease,” Lancet,
vol. 367, pp. 2086–2100, 2006.
[30] M. Liedlgruber and A. Uhl, “Computer-aided decision support systems
for endoscopy in the gastrointestinal tract: A review,” IEEE Rev. Biomed.
Eng., vol. 4, pp. 73–88, Nov. 2011.
[31] C. Münzenmayer et al., “Computer-assisted diagnosis for precancerous
lesions in the esophagus,” Meth. Inform. Med., vol. 48, pp. 324–330, 2009.
[32] Y. M. Yacob et al., “A survey on medical digital imaging of endoscopic
gastritis,” in Proc. IEEE Region 10 Conf., 2009, pp. 1–9.
[33] C.-R. Huang et al., “Computerized diagnosis of helicobacter pylori infection and associated gastric inflammation from endoscopic images by
refined feature selection using a neural network,” Endoscopy, vol. 36,
pp. 601–608, 2004.
[34] C.-R. Huang et al., “Helicobacter pylori-related gastric histology classification using support-vector-machine-based feature selection,” IEEE
Trans. Inform. Technol. Biomed., vol. 12, no. 4, pp. 523–531, Jul. 2008.

HUANG et al.: GERD DIAGNOSIS USING HHDF-SVM

[35] S. Tsuji et al., “Functional imaging for the analysis of the mucosal blood
hemoglobin distribution using electronic endoscopy,” Gastrointest. Endosc., vol. 34, pp. 332–336, 1988.
[36] K. E. A. Sande et al., “Evaluating color descriptors for object and scene
recognition,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 32, no. 9,
pp. 1582–1596, Sep. 2010.
[37] D. G. Lowe, “Distinctive image features from scale-invariant keypoints,”
Int. J. Comput. Vis., vol. 60, no. 2, pp. 91–110, 2004.
[38] C.-R. Huang et al., “Contrast context histogram—An efficient discriminating local descriptor for object recognition and image matching,” Pattern
Recog., vol. 41, no. 10, pp. 3071–3077, 2008.
[39] M. Radovanović et al., “Hubs in space: Popular nearest neighbors in highdimensional data,” J. Mach. Learn. Res., vol. 11, pp. 2487–2531, 2010.
[40] C. Cortes and V. Vapnik, “Support-vector network,” Mach. Learn.,
vol. 20, pp. 273–297, 1995.
[41] C. J. C. Burges, “A tutorial on support vector machines for pattern recognition,” Data Mining Knowl. Discovery, vol. 2, no. 2, pp. 955–974, 1998.
[42] C.-C. Chang and C.-J. Lin, “LIBSVM: A library for support vector machines,” ACM Trans. Intell. Syst. Technol., vol. 2, no. 3, pp. 27:1–27:27,
2011.
[43] K. Yao et al., “Techniques using the hemoglobin index of the gastric
mucosa,” Endoscopy, vol. 37, no. 5, pp. 479–486, 2005.
[44] M. Bratkova et al., “Orgb: A practical opponent color space for computer
graphics,” IEEE Comput. Graph. Appl., vol. 29, no. 1, pp. 42–55, Jan./Feb.
2009.
[45] J. M. Geusebroek et al., “Color invariance,” IEEE Trans. Pattern Anal.
Mach. Intell., vol. 23, no. 12, pp. 1338–1350, Dec. 2001.
[46] P. Kubelka, “New contribution to the optics of intensely light scattering
materials,” J. Opt. Soc. Amer. Part I, vol. 38, no. 5, pp. 448–457, 1948.
[47] Y.-T. Chen et al., “Efficient hierarchical method for background subtraction,” Pattern Recog., vol. 40, no. 10, pp. 2706–2715, 2007.
[48] B. Dawson and R. G. Trapp, Basic Clinical Biostatistics. Singapore:
McGraw-Hill, 2001.
[49] Y. Freund and R. Schapire, “A decision-theoretic generalization of on-line
learning and an application to boosting,” J. Comput. Syst. Sci., vol. 55,
pp. 119–139, 1997.
[50] P. Viola and M. Jones, “Robust real-time face detection,” Int. J. Comput.
Vis., vol. 57, no. 2, pp. 137–154, 2004.
[51] P. Pudil et al., “Floating search methods in feature selection,” Pattern
Recog. Lett., vol. 15, pp. 1199–1125, 1994.
[52] A. Jain and D. Zongker, “Feature selection: Evaluation, application, and
small sample performance,” IEEE Trans. Pattern Anal. Mach. Intell.,
vol. 19, no. 2, pp. 153–158, Feb. 1997.
[53] M. Kudo and J. Sklansky, “Comparison of algorithms that select features
for pattern classifiers,” Pattern Recog., vol. 33, no. 1, pp. 25–41, 2000.
[54] O. Gloger et al., “Fully automated glottis segmentation in endoscopic
videos using local color and shape features of glottal regions,” IEEE
Trans. Biomed. Eng., vol. 62, no. 3, pp. 795–806, Mar. 2015.

Chun-Rong Huang (M’05) received the B.S. and
Ph.D. degrees from the Department of Electrical Engineering, National Cheng Kung University, Tainan,
Taiwan, in 1999 and 2005, respectively.
In 2005, he joined the Institute of Information Science, Academia Sinica, Taipei, Taiwan, where, since
2005, he has been a Postdoctoral Fellow. Since 2010,
he was an Assistant Professor at both the Department
of Computer Science and Engineering and the Institute of Networking and Multimedia, National Chung
Hsing University, Taichung, Taiwan. Since 2015, he
has become an Associate Professor at the Department of Computer Science and
Engineering, National Chung Hsing University. His research interests include
computer vision, computer graphic, multimedia signal processing, image processing, and medical image processing.
Dr. Huang is a Member of the IEEE Circuits and Systems Society, the IEEE
Signal Processing Society, and the Phi Tau Phi Honor Society.

599

Yan-Ting Chen received the B.S. and M.S. degrees
from the Department of Computer Science, National
Tsing Hua University, Hsinchu, Taiwan, and the Department of Computer Science and Engineering, National Chung Hsing University, Taichung, Taiwan, in
2011 and 2013, respectively.

Wei-Ying Chen received the M.D. degree from the
Faculty of Medicine, National Yang Ming University,
Taipei, Taiwan, in 1999. He received the M.M. degree from the Institute of Clinical Medicine, National
Cheng Kung University, Tainan, Taiwan, in 2009.
He joined the Department of Internal Medicine,
National Cheng Kung University Hospital, to receive
resident training from 2001 to 2004. He is currently a
Member of the Gastroenterology Society of Taiwan
and a Visiting Staff of the Department of Internal
Medicine, National Cheng Kung University Hospital. His research interests include data mining and gastrointestinal endoscopy.

Hsiu-Chi Cheng received the M.D. degree from
the School of Medicine, China Medical College,
Taichung, Taiwan, in 1996. He received the Ph.D. degree from the Institute of Clinical Medicine, National
Cheng Kung University, Tainan, Taiwan, in 2009.
He joined the Department of Internal Medicine,
National Cheng Kung University Hospital, to receive
resident training in 1997 and has been a Visiting Staff
since 2002. He has been an Adjunct Assistant Professor since 2007 and an Associate Professor since 2014,
respectively, at the Department of Internal Medicine,
National Cheng Kung University Hospital. His research interests include peptic
ulcer disease, gastroesophageal reflux disorder, H. pylori related diseases, and
endoscopic diagnosis and treatment.

Bor-Shyang Sheu received the M.D. degree from
the School of Medicine, China Medical College,
Taichung, Taiwan, in 1988. He is currently the Deputy
Superintendent and Distinguished Professor of Internal Medicine, College of Medicine, National Cheng
Kung University, Tainan, Taiwan, and Chairman of
the Internal Medicine Committee, Ministry of Science and Technology, Taiwan.
He is an expert in gastroenterology, microbiology,
and immunology. He has published more than 180
SCI articles. He has majorly focused on Helicobacter pylori infection, virulence factor and genomic host factor related to gastric
carcinogenesis. He also focuses on early precancerous lesion detection and
chemoprevention in H. pylori-related diseases.
Mr. Sheu has been awarded for 1997 European H. pylori study group 14th
international workshops of H. pylori and gastroduodenal pathology, Young Scientist Award, Spain, 1999 Award for Career Develop Grant of National Research
Institute (NHRI), Taiwan, 2000 Professor Sung Jui-Rong’s Research Awards for
Gastroenterology, Taiwan, Outstanding Research Award of National Scientific
Council of Taiwan, 2003–2006. He won 2009 Emerging Leader Lectureship
Award of Asia Pacific Digestive Disease Week, and served as the committee
chair of the Internal Medicine Session of National Science Council, Taiwan,
during 2011–2013. He currently serves as an Associate Editor of BMC Microbiology (2010 up to now), and on Editorial Boards of SCI journals.

