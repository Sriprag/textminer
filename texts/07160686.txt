340

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Investigation of a New Weighted Averaging Method
to Improve SNR of Electrocochleography Recordings
Chathura Lahiru Kumaragamage∗ , Student Member, IEEE, Brian John Lithgow, Senior Member, IEEE,
and Zahra Kazem Moussavi, Senior Member, IEEE

Abstract—Goal: The aim of this study was to investigate methods
to improve signal-to-noise ratio (SNR) of extratympanic electrocochleography (ET-ECOG); a low SNR electrophysiological measurement technique. The current standard for ET-ECOG involves
acquiring and uniform averaging ∼1000 evoked responses to reveal the signal of interest. Weighted averaging is commonly employed to enhance SNR of repetitive signals in the presence of
a nonstationary noise, yet its efficacy in ET-ECOG has not been
explored to date, which was the focus of this study. Methods: Conventional techniques used to compute signal statistics required for
weighted averaging were found to be ineffective for ET-ECOG due
to low SNR; therefore, a modified correlation coefficient-based approach was derived to quantify the “signal” component. Several
variants of weighted averaging schemes were implemented and
evaluated on 54 ECOG recordings obtained from seven healthy
volunteers. Results: The best weighted averaging scheme provided
a 17% (p < 0.05) SNR increase [signal amplitude to standard deviation (STD) of the noise ratio] compared to uniform averaging,
and further improved to 22% (p < 0.05) when variance of the noise
was incorporated as a cost factor. The implemented weighted averaging schemes were robust and effective for variants of ET-ECOG
recording protocols investigated. Conclusion: Weighted averaging
improved SNR of low amplitude ET-ECOG recordings in the presence of nonstationary noise. Significance: SNR improvements for
ECOG have significant benefits in clinical applications; the variability associated with biofeatures extracted can be reduced, and
may lead to shorter recordings. Methods described in this study
can easily be incorporated in other low SNR repetitive electrophysiological measurement techniques.
Index Terms—Electrocochleography (ECOG), evoked response
(ER), extratympanic electrocochleography, weighted averaging.

I. INTRODUCTION
N recent years, significant efforts have been devoted to capturing microvolt level biological activity with inherently
low signal-to-noise ratio (SNR). Electrocochleography (ECOG)
[1]–[3] is one such electrophysiological measurement technique, wherein electrical activity from the cochlear labyrinth
is recorded at the onset of an auditory stimulus. ECOG is

I

Manuscript received January 12, 2015; revised April 15, 2015 and June 15,
2015; accepted July 9, 2015. Date of publication July 16, 2015; date of current
version January 16, 2016. This work was supported by the Natural Sciences and
Engineering Research Council of Canada, the MITACS Accelerate Internship
Program, and the Neural Diagnostics Pty., Ltd. Asterisk indicates corresponding
author.
∗ C. L. Kumaragamage is with the Department of Biomedical Engineering, McGill University, Montreal, QC H3A 0G4, Canada (e-mail: Chathura.
kumaragamage@mail.mcgill.ca).
B. J. Lithgow is with the Alfred Hospital, with the Monash Alfred Psychiatry
Research Centre, and also with the University of Manitoba.
Z. K. Moussavi is with the University of Manitoba.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2457412

Fig. 1. (a) SNR with respect to the number of consecutive stimulus responses
averaged, the methods for calculating SNR are described in Section II-C.
(b) Typical averaged ECOG waveform is illustrated after averaging ∼1700
click stimuli (detailed in Section II). The popularly used biofeatures in ECOG
are the action potential (AP) and summing potential (SP). The signal and noise
components are shaded in dark and light gray, respectively.

commonly recorded using either an extratympanic (ET) or
transtympanic (TT) approach. ET-ECOG is non-invasive; however, suffers from lower SNR (∼18 dB below the noise floor
[4]) compared to TT-ECOG, due to the increased distance
from the cochlear labyrinth. Thus, ET-ECOG typically requires averaging of ∼1000 evoked responses (ER’s) [5]. Historically, the primary application of ECOG has been for the
diagnosis, assessment, and monitoring of Meniere’s disease
(MD)/endolymphatic hydrops (ELH) [1], [6]. However, recent
advances have led TT-ECOG to be employed as an intraoperative tool [7] to determine the level of anaesthesia [8], and for
real-time quantitative measurements of the efficacy of cochlear
implants during surgery [9]. With increasing applications of
ECOG, SNR improvement techniques, without compromising
recording time, is highly beneficial. SNR improvements directly
translate to reduced variability associated with biofeatures extracted; thus, leading to improved sensitivity and specificity
measures associated with disease classification.
SNR progression with respect to the number of ER’s averaged
was investigated in a previous ECOG study [4]. It was observed
that the SNR increased with respect to the number of ER’s averaged (as expected); however, the relationship was not strictly
increasing. That is, regions existed where SNR decreased or was
stagnant, which can be attributed to the presence of transient
noise artifacts in the recordings [see Fig. 1(a)]. This nonstationary nature of ECOG recordings can be largely attributed to
movement and muscle artefacts, resulting in nonoptimal SNR
outcomes when uniform averaging is employed. In such situations, weighted averaging is a plausible technique [10], [11] to
maximize SNR. Weighted averaging has been successfully employed in electrophysiological measurement studies [12], [13],
where the biological signal of interest is repetitive or is repetitive due to stimulation. Weighted averaging employed in highresolution electrocardiography [12], [14], [15] has improved

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KUMARAGAMAGE et al.: INVESTIGATION OF A NEW WEIGHTED AVERAGING METHOD TO IMPROVE SNR OF ELECTROCOCHLEOGRAPHY

SNR compared to uniform averaging in the presence of a nonstationary noise. One study [16] investigated the effectiveness of
weighted averaging compared to uniform averaging on auditory
evoked electroencephalography (EEG) recordings, and report
an SNR increase of up to 21%. However, these EEG recordings
[16] capture ER’s that extend up to 500 ms, are contained within
a bandwidth <100 Hz, and have a >5-μV amplitude range [17].
ET-ECOG, in contrast, captures ER’s that are ∼10 ms in length,
spans up to ∼3 kHz, while the signal of interest is in the submicrovolts range [see Fig. 1(b)]. As a result, the methodology in
[16] failed to be effective for ET-ECOG.
In this study, five averaging schemes (two weighted averaging schemes and three selective exclusion schemes) were investigated. We first present the mathematical description for maximizing SNR using weighted averaging. Next, we present fundamental differences associated with ECOG compared to other
popular electrophysiological measurement techniques, and finally, derive a framework for calculating weighting factors used
for weighted averaging, and investigate efficacy of the implemented schemes on ET-ECOG recordings.

341

TABLE I
ECOG RECORDING PARAMETERS AND PROTOCOL
Recording Parameters
Amplifier gain
Amplifier bandwidth
Recording window
Repetitions
Power-line filter

∼30 000 (89.5 dB)
1 Hz to 10 kHz
185 ms
500–1800 (study dependent)
50-/60-Hz analog notch filter (> 20 dB)
Stimulus

Type/duration
Repetition rate/sound intensity

Broadband clicks/100-μs pulse 50% duty cycle
5.4 Stimuli per second/80-dB SPL

II. METHODS
A. ECOG Recording Protocols and Preprocessing
The collection of ECOG recordings used for this study were
revived from previous studies [4], [18], where recordings were
obtained across two low-noise biosignal amplifier systems,
and two electrode types; commercially available Biopac electrodes (herein, called OEM electrodes), and a modified low
impedance ear electrode type (herein, called MOD electrodes).
The OEM electrode setup consists of an ECochGtrode (Biologic) ear electrode coated with conductive gel, fixated proximal
to the tympanic membrane (TM), a reference electrode (BiopacELS254 S), also coated with gel, placed either on the ipsilateral
earlobe (this setup is called an IPSI recording) or the contralateral earlobe (called a CONTRA recording). The MOD electrode
setup (detailed in [4]) consists of a low impedance ear electrode
coated with a mixture of saline and conductive gel placed proximal to the TM (similar to the OEM case); an identical electrode
type, used as the reference, is placed on the incisura of the ipsilateral or contralateral ear (again, called IPSI or CONTRA
recording, respectively). For all recordings, a biopac-ELS258S
common electrode coated with conductive gel is placed on the
forehead of the subject. Additional ECOG recording parameters
are summarized in Table I.
The digitized data (Fs = 44 kHz) were bandpass filtered between 5 Hz and 9 kHz using a zero-phase digital filter [19] [the
sequence of preprocessing steps are illustrated by the unshaded
boxes in Fig. 2(a)]. The 5-Hz high-pass cutoff frequency was
used to reduce drift due to half-cell potentials and movement
artifacts. The 9-kHz low-pass cutoff frequency provides flexibility (for future studies) to probe into a high-frequency content
if required. A zero-phase digital notch filter is employed to attenuate the ninth power-line harmonic at 540 Hz (detailed in
Results). In an attempt to suppress high-amplitude motion and
muscle artifacts [20], the final preprocessing step is to nullify
signal content beyond ±7 STD of the entire recording. The

Fig. 2. (a) Flowchart of signal processing steps used to generate
S E C O G a p p rox . The unshaded boxes correspond to preprocessing steps, the
shaded boxes summarize the extraction and averaging process of ER’s. (b) To
increase SNR of each ER, the average of consecutive ER’s were calculated
based on weighting factors derived by a Gaussian window. (c) Plot of the crosscorrelation coefficient vector (X c o rr ) found for each ER as described in (b),
when correlated with S E C O G a p p rox .

above described preprocessing steps were employed on all, except one recording where outlier filtering was omitted due to
severe sound stimulus coupling with the recording. The ECOG
specific processing steps are summarized in shaded boxes of
Fig. 2(a).
B. Weighted Averaging
An example IPSI ECOG waveform is shown in Fig. 1(b) obtained with OEM electrodes. The 0-ms time stamp indicates the
onset of the sound stimulus delivered. The SP and AP amplitudes used to compute the SP/AP ratio (biofeature used to assist
in the diagnosis and monitoring of MD/ELH [1]) are illustrated
in Fig. 1(b) (based on an approach described in [1]).

342

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

In this study, electrical activity between 0.5 and 9 ms of the
ECOG waveform [see Fig. 1(b)] is considered as the signal of
interest (the region 0 to 0.5 ms is omitted due to the presence of
stimulus related artifacts), and electrical activity outside the region of interest is considered as noise. Each electrical response
captured after the sound stimulus is called an ER denoted as
xr [k], which can be hypothetically decomposed into two components:
xr [k] = Sr [k] + nr [k]

(1)

Sr [k] is the signal content of interest, nr [k] is the collection of
noise components, [k] is the discretized time/sampling index,
and r corresponds to the rth sound stimulus. Noise in ECOG
recordings can be categorized into three main components [4]:
thermal noise due to impedances and system noise (electronics),
background biological noise (undesired biological activity that
often dominates), and background interference (mainly, powerline interference). The reader is referred to [4] for a detailed
description of noise components in ET-ECOG.
If weighted averaging is used to reconstruct the ECOG waveform, the resulting SNR can be shown to be [16]:

wr Sr
(2)
SNRﬁnal =  r
2
(w
N
)
r
r
r
where wr is the weighting factor, Sr and Nr are the signal of
interest and STD of the noise, respectively, of the rth ER. Note
that noise is assumed to have a white Gaussian distribution.
The weighting factor (wi ) that will yield optimal SNR for the
ith ER can then be derived by computing the partial derivative
of SNRﬁnal with respect to wi [16], [21]–[23] as shown in (3)
at the bottom of the page.
Then

	− 12





2
2
2
(wr Nr ) .Si − wi Ni
(wr Sr ) .
(wr Nr )

can then be computed as follows:
SECOG

ﬁnal

=

1 
wr xr
Nf r

(6)


where Nf = r wr is the normalization factor required to correct the amplitude scale of the final ECOG waveform [22].
Calculating weighting coefficients (wr ) required for (5) is not
trivial, since approximating signal (Sr ) and noise (Nr ) components of individual ER’s is technically challenging for low
SNR [24] ET-ECOG. We, therefore, propose a cross-correlationbased approach to calculate a metric for Sr . The first step involves averaging all ER’s, as per (7) to obtain an approximation
to the final ECOG waveform, herein labeled SECOG approx .
Note that uniform averaging is the method used in published
ECOG research; thus, SECOG approx also serves as a reference
to be compared against averaging schemes investigated
1
(xr ).
(7)
SECOG approx =
r r
The correlation coefficient between each ER and
SECOG approx was found to be poor and highly variable due
to the low SNR of each ER. Therefore, a modified ER was derived by averaging a subset of successive ER’s around the ith
ER as described in (8). The exponential term in (8) is a Gaussian
window function, such that xi (when l = 0) gains the highest
weighting factor; xi+l is the (i + l)th ER as described in (1):


10 
 
2

− 0.5 ( σ ∗ ( 2 1l−1 ) / 2 )
SECOG ER(i) =
· xi+l . (8)
e
l=−10

In (8), l is the index number starting from –10 to 10 that
accounts for 21 samples averaged under the Gaussian window, and σ (the STD of the Gaussian window) was set at 0.4.
These values were empirically determined on a subset of ECOG
recordings that provided a balance between acceptable SNR of
r
r
r
SECOG ER(i) , while minimizing the number of ER’s needed to
= 0
(4) be averaged. All indices of SECOG ER(i) were calculated by
sequentially sliding the Gaussian window one index at a time,
leads to
till the end of the recording. Averaging ER’s under the Gaussian

window in (8) is an essential aspect to retain the ability of local(Si / r wr Sr )
Si
= 2 ·k
(5) izing noisy ER’s (since the ith ER is given the highest weight);
wi = 2 
Ni / r (wr Nr )2
Ni
a feature that would not be possible had a rectangular win

where k = r (wr Nr )2 / r wr Sr is a constant for a given dow been used. A simplistic illustration is depicted in Fig. 2(b),
ECOG recording. Hence, k has no influence on SNRﬁnal as it where five ER’s are averaged with maximum weighting on ER3 .
cancels out in (2). Therefore, in theory, setting the weighting
Next, the Pearson’s correlation coefficient (Xcorr(i) ) between
factor wi = NS i2 will maximize SNRﬁnal for the train of ER’s to the ith averaged waveform SECOG ER(i) and SECOG approx is
i
be averaged. The weighted averaged waveform (SECOG ﬁnal ) calculated as shown in (9) at the bottom of the page.



− 12


2
2
2 .S − 1
(w
N
)
(w
S
)
·
(w
N
)
·
2
·
(w
N
)
r r
i
r r
r r
i i
r
r
r
2
∂SNRﬁnal

=
(3)
2
∂wi
r (wr Nr )

Xcorr(i) =


E (SECOG

approx


− μECOG approx ) SECOG ER(i) − μECOG
σECOG approx · σECOG ER(i)


ER(i)

(9)

KUMARAGAMAGE et al.: INVESTIGATION OF A NEW WEIGHTED AVERAGING METHOD TO IMPROVE SNR OF ELECTROCOCHLEOGRAPHY

where E is the expectation value, μ and σ are the mean and
STD of the described signals, respectively. An example of the
calculated Xcorr vector for an ECOG recording is illustrated
in Fig. 2(c); the majority of correlation coefficient indices are
found to be >0, indicating that most SECOG ER(i) waveforms
positively resemble SECOG approx . The negative valued Xcorr
indices [around index 970 in Fig. 2(c)] correspond to signal content likely degraded due to movement and/or muscle artifacts.
The signal component (Si ) required for (5) can then be derived from Xcorr(i) . However, the correlation metric Xcorr(i) is
dependent on both signal and noise components of the ith ER
(for example, the value of Xcorr(i) would be reduced if either
signal content is low, or if the noise content in SECOG ER(i) is
high). Therefore, the waveforms to be correlated (SECOG ER(i)
and SECOG approx ) are truncated from –2 to 8.5 ms to enhance
correlation of the signal content of interest represented in Xcorr
[see Fig. 1(b)].
In its raw form, Xcorr(i) cannot be used to represent Si since
its values range from −1 to +1. Si must be a vector ranging from 0 to +1 that correspond to minimum and maximum
signal content in the ER, respectively. Five variants for calculating Si (labeled S mod(i) ) were then derived from Xcorr(i) .
The motivation was to investigate variants of averaging schemes
that maximize SNR by eliminating or giving minimal weight to
ER’s that poorly correlate with SECOG approx , and simultaneously emphasizes the least corrupted ER’s. The five variants of
S mod(i) investigated (in addition to the conventional/original
method) are as follows.
1) Original: All elements in S mod(i) are given equal
weighting of 1. The resulting waveform (SECOG approx )
is used to generate Xcorr required to derive the five averaging schemes described next.
2) Exclude all negative minima: All indices in Xcorr(i) corresponding to negative local minima are zeroed out in
corresponding indices of S mod(i) . The remaining indices in S mod(i) are given a weight value of 1. Negative
minima are expected to represent ER’s poorly correlate
with SECOG approx ; thus, eliminating them is expected to
increase SNR of the averaged waveform.
3) Exclude all negative minima ±1: All indices zeroed out
in S mod(i) from scheme 2, and its neighbouring indices
are zeroed (for example if index 10 and 30 were zero in
scheme 2, indices 9, 10, 11 and 29, 30, 31 are zeroed in
scheme 3), as it is likely that muscle or movement artefacts would be sustained longer than 185 ms (the interval
between successive ER’s). The remaining indices have a
weight value of 1.
4) Exclude all negative minima ±3: Similar to scheme 3,
all indices in scheme 2, ±3 neighbours are zeroed. The
remaining indices have a weight value of 1.
5) Weighted_1: The Xcorr(i) vector is copied to S mod(i) .
Next, all negative valued indices of S mod(i) are set to
zero, and the positive values are unchanged. Scheme 5,
therefore, is the first proper weighted averaging scheme,
where all positive correlation coefficients are given a
weight value based on its correlation coefficient with
SECOG approx .

343

6) Weighted_2: The Xcorr(i) vector is copied to S mod(i) .
Next, indices of S mod(i) below –0.025 are set to zero.
All elements of the correlation coefficient vector are then
given an increment of 0.025 (such that all elements are
≥ 0). The rationale is that reducing the amount of zero valued correlation coefficient indices (compared to scheme
5) will increase the number of ER’s used for averaging,
which may improve SNR.
The noise component (Ni ) of the ith ER is calculated from
the STD of the recording as described

NT 2
T
n =N T 1 xi [n] .xi [n]
Ni = Noise =
(10)
NT 2 − N T 1
where NT 1 and NT 2 correspond to the discrete time indices
84 and 156 ms, respectively. Each ER is 1/5.4 Hz (185 ms) in
duration; hence, NT 1 and NT 2 regions are selected such that
Ni is isolated from electrical activity and artefacts resulting
from the sound stimulus, but simultaneously close to the ER to
better account for transient noise events in the vicinity of the
waveform.
Three noise weighted variants were included for the five averaging schemes described above: 1) No-noise weighting (w1 i ),
S m o d( i )
where w1 i =
, 2) STD noise weighting (w2 i ), where
Nf
S mod
w2 i = Nf ·N i( i ) , and 3) variance (VAR) noise weighting (w3 i ),
S mod

where w3 i = Nf ·N 2( i ) . The noise statistics represent a cost faci
tor inversely proportional to the weighting factor. S mod(i) is
one of six averaging schemes described above, and Nf is the
normalization factor.
C. SNR Definition
To quantitatively compare quality of ECOG waveforms generated by the schemes described, a linear SNR = S/N metric
was used, where signal of interest (S) is calculated from the
dynamic range of the ECOG waveform between 1 and 4.5 ms
[see Fig. 1(b) for clarification], and noise (N ) is calculated from
(10), where NT 1 and NT 2 correspond to the time indices 30 and
140 ms, respectively. The bounds of NT 1 and NT 2 in this case
are chosen to be closer to the sound stimulus (rather than 84 ms
used for the noise weighting) to obtain a measure of variability
of the ECOG waveform in the vicinity of the signal of interest.
Note that the entire process of calculating weighting factors and
calculating SNR are automated, with no operator interventions.
D. Data Analysis
The database included 54 ECOG recordings obtained from
seven healthy individuals, whom underwent hearing tests, and
manual otoscopy prior to ECOG to ensure their external ear was
healthy and had normal hearing. All participants gave written
consent approved by the Biomedical Research Ethics Board of
the University of Manitoba prior to this study.
ECOG recordings in the database had varying recording
lengths (6–12 min). Therefore, the final SNR calculated for
each
was normalized to 500 stimuli by the factor
√
√ recording
500/ Total number of Stimuli; since SNR is found to be

344

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 3. (a) SNR with respect to the number of stimuli added for the investigated
schemes. (b) ECOG waveforms obtained for schemes 1, 5 and the truncated
recording using scheme 5.

√
approximately proportional to
Number of Stimuli added
[see Fig. 3(a)].
Comparisons of the averaging schemes were carried out by
one-way repeated measures ANOVA on normalized SNR data.
Bonferroni adjustments for multiple comparisons were made,
and a p < 0.05 was selected to be statistically significant.
III. RESULTS
An example of SNR progression for the six schemes computed on a recording is illustrated in Fig. 3(a) (with respect to
the number of ER’s). Each index of the SNR vector is computed on the running ECOG waveform (SECOG running(i) ) and
obtained as follows:
i
wr xr
(11)
SECOG running(i) = r =1
Nf
xr is the rth ER as defined in (1), wr is the corresponding
weighting vector defined by the scheme used, and Nf is the
normalization factor calculated up to the ith ER.
Toward the end of the recording, scheme 1 and scheme 5
have achieved SNR of ∼8.1 and ∼11.6, respectively. The impact of SNR improvement from scheme 5 is evident when the
corresponding time domain ECOG waveforms are overlaid [see
Fig. 3(b)]. The AP amplitude obtained from scheme 1 and 5
are 0.13 and 0.21 μV, respectively, though the variability in the
waveforms (seen after ∼8 ms) appear to be similar. To further
investigate the effectiveness of weighted averaging, the ECOG
waveform was constructed with scheme 5, but using only the
first 760 stimuli [which should produce similar SNR to scheme
1 as illustrated by the green markings on Fig. 3(a)]. The resulting ECOG waveform is plotted in Fig. 3(b) (green curve)
with a dc shift for clarity. It is seen that an ECOG waveform
that resembles the original waveform is achieved, even though
less than half the recording is used. However, it must be noted
that the calculation for weighting coefficients were based on the
SECOG approx waveform obtained by averaging all ER’s in the
recording.
Calculation of the uncertainty associated with the SP/AP ratio is valuable from a clinical perspective, yet the calculation
or use of such a statistic is lacking in current ECOG literature.
An uncertainty metric for the SP/AP ratio can be derived by
uncertainties associated with SP and AP amplitude measurements, and by using the propagation of error formulae. SP and

Fig. 4. Mean variability of ECOG waveforms during 30-ms segments computed for all 54 ECOG waveforms obtained using scheme 1. The error bars
represent associated STD.
TABLE II
SP/AP RATIO STATISTICS OBTAINED FOR SCHEMES 1, 5 AND TRUNCATED
SCHEME 5
Scheme description

Scheme 1
Scheme 5
Scheme 5 (truncated)

Variability between
120–180 ms (μV)

SP/AP ratio

Uncertainty of
SP/AP ratio

0.013
0.013
0.018

0.33
0.22
0.34

±0.19
±0.16
±0.29

AP amplitude uncertainties can be approximated by the variability in the ECOG waveform. However, a suitable time interval
in the averaged ECOG waveform needs to be identified, since
variability is time dependent. Fig. 4 illustrates the mean STD
of 30-ms time intervals calculated by averaging all 54 computed ECOG waveforms using scheme 1. The mean variability
is highest around 30–70 ms, and attenuates toward the end of
the ECOG waveform (due to minimal inner ear and cortical
activity correlated with the auditory stimulus). However, biological noise and other sources of noise uncorrelated with the
stimulus can be approximated to be stationary due to averaging;
therefore, variability in the 120–180-ms interval is identified to
be the most plausible statistic to approximate variability of SP
and AP measurements. The SP/AP ratio was manually found for
the three waveforms in Fig. 3(b), and associated uncertainties
were calculated from the propagation of uncertainty statistics
(summarized in Table II). An SP/AP ratio <0.5 is expected for
normal subjects [3], [6], which is satisfied in all three cases. An
interesting note is, as a result of the increased SNR for scheme
5, the uncertainty measure has reduced from ±0.19 to ±0.16. It
is expected that SNR obtained from scheme 1 would be similar
to the SNR obtained from the truncated recording on scheme
5; yet the latter shows a higher uncertainty value of ±0.29. The
discrepancy can be associated with the different regions in the
recording used to calculate SNR (30–140 ms), and region used
to observe the uncertainty measure (120–180 ms).
The SECOG approx waveform is seldom affected by large
transient noise components due to the high number of ER’s
averaged; however, noise correlated with click stimuli will
constructively add and potentially appear in SECOG approx .
An example recording is shown in Fig. 5(a), where
ninth power-line harmonic (540 Hz) coupling was present.
Correlated noise artifacts in SECOG approx adversely affect the

KUMARAGAMAGE et al.: INVESTIGATION OF A NEW WEIGHTED AVERAGING METHOD TO IMPROVE SNR OF ELECTROCOCHLEOGRAPHY

345

Fig. 5. (a) ECOG waveforms generated by schemes 1 and 5 for a recording with moderate 540-Hz power-line coupling. (b) ECOG waveforms from
schemes 1 and 5 for the same recording as in (a) with 540-Hz notch filtering.

performance of weighted averaging, since noise components
common to SECOG approx and SECOG ER(i) get emphasized in
SECOG ﬁnal . In response, a 540-Hz narrowband (3 Hz, 20 dB)
zero-phase digital filter [19] was implemented in preprocessing;
the resulting ECOG waveform is shown in Fig. 5(b).
Fig. 6(a) summarizes SNR performance achieved for all
schemes. A one-way repeated measured ANOVA was performed
on SNR performance to evaluate the null hypothesis that there is
no change in SNR between schemes (at the p < 0.05 significance
level). Results for all recordings in Fig. 6(a) indicated a significant effect on schemes, Wilks’ Lambda = 0.176, F(15, 39) =
12.145, p < 0.01, η 2 = 0.82. Hence, significant evidence exists
to reject the null hypothesis. Follow-up pairwise comparisons
were then conducted (with Bonferroni adjustments); the primary
focus, however, was to compare effectiveness of the schemes implemented relative to scheme 1. Results in Fig. 6(a) show that
all except scheme 2, superseded SNR performance of scheme
1 (p < 10−6 ), and weighted averaging schemes (5 and 6) were
more effective, with significance of p < 10−9 . Scheme 5 is seen
to be the most effective, with a mean SNR increase of 29.5%
for all recordings, and a maximum SNR increase of 17% at the
p < 0.05 significance level relative to scheme 1. The effectiveness of scheme 5 further improved to a mean of 34% when VAR
weighting was used, with a maximum SNR increase of 22% at
the p < 0.05 significance level. Comparisons between adjacent
schemes show a significant SNR increase from schemes 2 to 3,
3 to 4, and 4 to 5; however, there was no significant difference
between schemes 5 and 6.
To evaluate the significance of STD and VAR noise weighting
compared to no-noise weighting, pairwise comparisons within
schemes were also conducted. However, a significant increase
was only observed from no-noise weighting to STD weighting
for schemes 5 and 6 (p < 0.01). A second repeated measures
ANOVA was performed on a dataset generated by calculating
the difference in SNR for all schemes relative to scheme 1.

Fig. 6. Three subigures summarize pairwise SNR comparisons between
schemes. The error bars correspond to the 95% lower bound confidence interval for the difference in SNR between itself and scheme 1 (after adjusting
for multiple comparisons). Hence, the lower bound of the error bars represent
the highest SNR that could be assumed at the p < 0.05 confidence interval in
comparison to scheme 1. Additionally, if the lower bound of the error bar intercepts the horizontal dotted line, the SNR increase (relative to scheme 1) is not
significant at the p < 0.05 level. Statistical significance between schemes are
illustrated symbolically (“∗”—p < 0.05, “∗∗”—p < 0.01, “∗∗∗”—p < 10−4 ,
“∗∗∗∗”—p < 10−6 , “∗∗∗∗∗”—p < 10−9 ). For clarity, the markings in “blue”
are comparisons between scheme 1 and the indicated scheme(s), markings in
“red” are comparisons between other schemes (except scheme 1) as indicated,
and markings in “green” are comparisons between noise weighting variants
from the same scheme. (a) All recordings (N = 54). (b) All IPSI recordings
with MOD electrodes (N = 16). (c) All CONTRA recordings (N = 20).

Two within subject factors were identified: schemes (with five
levels (schemes 2–6), and noise weighting [with three levels (no
noise, STD, and VAR)]. Pairwise comparisons (after Bonferroni
adjustment) between noise levels show a mean SNR increase of
0.05, and 0.068 from no-noise to STD weighting, and no-noise
to VAR weighting, respectively, at the p < 0.05 level; however,
no significant change was observed between STD and VAR
weighting.
Previous findings [4] indicate that IPSI recordings produce better SNR compared to CONTRA recordings; therefore,
to evaluate the performance of weighted averaging on IPSI
and CONTRA recordings, the analysis in Fig. 6(a) was extended by separately evaluating: 1) IPSI ECOG recordings with
MOD electrodes [see Fig. 6(b)], and 2) All CONTRA ECOG
recordings [see Fig. 6(c)]. Weighted averaging was shown to be

346

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 7. SNR increase from employing scheme 5 with VAR noise weighting
relative to scheme 1 (as percentage) versus number of ER’s in the recording.

effective for both protocols, where schemes 5 and 6 provide a
mean SNR increase of at least 27% and 32% relative to scheme
1 for IPSI and CONTRA protocols, respectively. Scheme 5 with
VAR weighting is shown to be the most favourable for both
IPSI and CONTRA recordings, with an SNR increase of 29%
and 40% relative to scheme 1, respectively. Results show that
schemes 2–4 on CONTRA recordings provide no significant
improvement in SNR, relative to scheme 1 (except scheme 4
with STD weighting).
Another aspect of interest is to evaluate the efficacy of
weighted averaging with respect to the number of ER’s in the
recording. Fortunately, ECOG recordings in the database span
from 6–12 min, which were used to generate a scatter plot of
SNR increase gained from scheme 5 with VAR weighted averaging relative to scheme 1 versus number of ER’s in the recording
(see Fig. 7). One recording produced an SNR increase >200%,
which was excluded from the scatter plot. The least-squares linear fit line is shown, and its equation is displayed. The small
R2 value indicates that the linear fit was poor (due to variability); the small x coefficient indicates that the SNR increase
dependence on # of ER’s is negligible (an increase of 0.5% per
1000 ER’s), and the constant indicates that a mean SNR increase
of ∼40% is seen across all recording lengths available. Note that
this SNR increase is not normalized.
IV. DISCUSSION
Comparisons for the five implemented averaging schemes
show that, weighted averaging schema (5 and 6) consistently
provided the highest SNR increase relative to scheme 1 for all
recordings. Results in Fig 5(a) show that SNR from scheme
2 to 3 to 4 is monotonically increasing, with scheme 4 being the best nonweighting averaging scheme, providing a mean
∼10% increase in SNR relative to scheme 1. This result can
be interpreted to be due to two possible phenomena: 1) Noisy
ER’s have a long time duration >185 ms (1/5.4 Hz); hence,
eliminating neighboring ER’s assist in improving SNR, or
2) since the SECOG ER(i) is based on averaging successive ER’s
around the ith index using a Gaussian window function, the resulting Xcorr(i) is smoothened (a necessary compromise to increase SNR of SECOG ER(i) ) and may obscure the actual indices
of noisy ER’s, therefore eliminating ±3 neighbours assists to
remove the uncertainty. However, this dilemma was not further

investigated as weighted averaging performed significantly better than nonweighted averaging schemes.
The inclusion of STD or VAR weighting as cost factors were
found to benefit all schemes, and that VAR noise weighting
was found to be the most optimal for both IPSI and CONTRA
recording types [see Fig. 5(b) and (c)].
SNR improvements of ∼40% was observed for CONTRA
recordings (compared to 29% seen for IPSI recordings), when
weighted averaging is used. This is indicative that CONTRA
recordings are more susceptible to nonstationary noise (movement and muscle artefacts) than IPSI recordings; an indirect
observation in agreement with findings in [24]. As a result,
mean SNR obtained for both IPSI and CONTRA recordings
were similar (SNR of ∼5.8), when scheme 5 with VAR noise
weighting was used (though IPSI recordings provide higher
SNR than CONTRA recordings when uniform averaged). This
is an interesting finding, since a previous study [4] shows
that IPSI recordings provide higher SNR relative to equivalent
CONTRA recordings, as a result of reduced susceptibility to
movement and muscle artifacts. By employing weighted averaging, SNR degradation due to nonstationary noise artifacts appears to be mitigated, thus providing similar SNR for both IPSI
and CONTRA recordings. A follow-up question that arises from
the above findings is that if weighted averaging is employed,
and if both IPSI and CONTRA recordings provide similar SNR,
which ET-ECOG approach is more practical in a clinical setting? Based on our experience with both approaches, signal and
noise components of IPSI recordings are ∼2–3 orders of magnitude smaller than those of equivalent CONTRA recordings [4].
Hence, a CONTRA approach would be more robust, and easier
to conduct (since susceptibility to thermal noise and background
interference is reduced).
Ideally, variability in a fixed time interval of the ECOG
waveform should be used for all computations that require a
noise/variability measurement. However, in this study, the noise
statistic used to calculate weighting coefficients was derived
from 84–156 ms, far from the sound stimulus (to avoid correlated biological activity from interfering with the measurement), and simultaneously proximal to the ECOG waveform
to accurately account for transient noise nearby. When investigating a statistic to calculate uncertainty associated with the
SP/AP ratio, variability toward the end of the ECOG waveform
(120–180 ms) was chosen to minimize correlated biological
activity in the measurement. For SNR calculations, the noise
statistic was chosen to be much closer to the ECOG waveform (30–140 ms) to better approximate variability/clarity of
the waveform. The presence of correlated biological activity,
particularly in the vicinity of the sound stimulus, makes it difficult to identify one region suitable to estimate variability for
the above three cases. Investigating an optimal time interval for
variability measures is beyond the scope of this paper; however,
it is an interesting avenue to be explored.
The current ECOG protocol used at the Riverview Health
Centre is based on the protocol established at Monash University, Australia, where mains power is 220 V/50 Hz. A click
stimulus interval of 5.4 Hz is not synchronized with mains power
in Australia; however, it is unfortunately in sync with the ninth

KUMARAGAMAGE et al.: INVESTIGATION OF A NEW WEIGHTED AVERAGING METHOD TO IMPROVE SNR OF ELECTROCOCHLEOGRAPHY

harmonic or 540 Hz in North America, where mains power is
110 V/60 Hz. Outcomes of this study lead to the revising of the
ECOG protocol used in Canada.
Thirteen different variants of averaging schemes were investigated for this study. However, only the best three nonweighted averaging schemes and the best two weighted averaging schemes were presented. The excluded weighted averaging
schemes were variants of scheme 6 with threshold points –
0.05, –0.075, and –0.1. Relative to scheme 5, SNR provided
by these four variants were found to be inversely proportional
to the magnitude of the threshold value. This indicates that
excluding ER’s negatively correlated with SECOG approx provide better SNR outcomes (even though the total number of
ER’s is reduced), than increasing leniency on the cut off threshold of noisy ER’s (which were hypothesized to provide better
SNR relative to scheme 5 due to the increased number of ER’s
averaged).
SNR improvements described in this study are based on ETECOG; yet the methods presented are readily applicable in low
SNR, stimulus driven techniques, such as TT-ECOG, and auditory brainstem response recordings. In recent years, TT-ECOG
has been exploited as an intraoperative monitoring and assessment tool, where SNR improvements, without compromising
recording time, are particularly beneficial.
A potential extension to this study is to investigate the outcome of weighted averaging if a standard template is used
for SECOG approx . If such a template can be successfully
synthesized, the initial computations required to generate
SECOG approx can be eliminated, and weighted averaging methods described can be easily employed in real-time ECOG applications. Furthermore, such a template will provide means
to calculating an accurate measure of time reduction achievable when weighted averaging is employed. However, various
pathologies related to the inner ear result in variations to the
ECOG waveform [2]; thus, searching for a universal template
for SECOG approx may be improbable.
A mean SNR increase of ∼40% was achieved for weighted
averaging (for scheme 5 relative to scheme 1) irrespective of
the recording length (see Fig. 7). We, however, predict that this
SNR increase will resemble a monotonically increasing function (with respect to recording length) if a much larger dataset
was available, since the performance of weighted averaging is
dependent on the quality of the SECOG approx waveform, which
improves with increased number of ER’s in the recording.
V. CONCLUSION
Over the years, weighted averaging has been successfully employed in various electrophysiological signal measurement applications in the presence of nonstationary noise. In this study,
the efficacy of weighted averaging was investigated for very
low SNR (< –18 dB) ECOG recordings by deriving a crosscorrelation-based approach to quantitatively approximate the
signal content in the recording. Results show an SNR increase
of 22% (p < 0.05) from weighted averaging, relative to uniform averaging. Furthermore, a quantitative approach to calculate uncertainty statistics related to extracted biofeatures is
presented.

347

ACKNOWLEDGMENT
The authors would like to thank Dr. R. Edwards for his continued support throughout this work.
REFERENCES
[1] J. A. Ferraro and J. D. Durrant, “Electrocochleography in the evaluation of
patients with Meniere’s disease/endolymphatic hydrops,” J. Amer. Acad.
Audiol., vol. 17, no. 1, pp. 45–68, Jan. 2006.
[2] J. A. Ferraro, “Electrocochleography: A review of recording approaches,
clinical applications, and new findings in adults and children,” J. Amer.
Acad. Audiol., vol. 21, no. 3, pp. 145–152, Mar. 2010.
[3] A. Ferraro, “Clinical electrocochleography: Overview of theories, techniques and applications,” AudiologyOnline, 2000.
[4] C. L. Kumaragamage et al., “A new low-noise signal acquisition protocol
and electrode placement for electrocochleography (ECOG) recordings,”
Med. Biol. Eng. Comput., vol. 53, pp. 499–509, Mar. 4, 2015.
[5] W. P. Gibson and H. A. Beagley, “Electrocochleography in the diagnosis
of acoustic neuroma,” J. Laryngol. Otol., vol. 90, no. 2, pp. 127–139, Feb.
1976.
[6] J. Hornibrook, Catherine Kalin, Emily Lin, Greg A. O’Beirne, and John
Gourley, “Transtympanic electrocochleography for the diagnosis of Meniere’s disease,” Int. J. Otolaryngol., vol. 2012, art. no. 852714, 11 pages,
2012, doi:10.1155/2012/852714
[7] M. V. Simon, “Neurophysiologic intraoperative monitoring of the vestibulocochlear nerve,” J. Clin. Neurophysiol., vol. 28, no. 6, pp. 566–581, Dec.
2011.
[8] S. M. Krieg et al., “Superiority of tympanic ball electrodes over mastoid
needle electrodes for intraoperative monitoring of hearing function,” J.
Neurosurg., vol. 120, no. 5, pp. 1042–1047, May 2014.
[9] N. H. Calloway et al., “Intracochlear electrocochleography during
cochlear implantation,” Otol. Neurotol., vol. 35, pp. 1451–1457, Sep.
2014.
[10] J. M. Leski, “Robust weighted averaging,” IEEE Trans. Biomed. Eng.,
vol. 49, no. 8, pp. 796–804, Aug. 2002.
[11] A. Momot, “Methods of weighted averaging of ECG signals using
Bayesian inference and criterion function minimization,” Biomed. Signal Process. Control, vol. 4, no. 2, pp. 162–169, Apr. 2009.
[12] E. Laciar and R. Jane, “An improved weighted signal averaging method
for high-resolution ECG signals,” in Proc. Comput. Cardiol. Conf., 2001,
pp. 69–72.
[13] I. Silva, “Estimation of postaverage SNR from evoked responses under nonstationary noise,” IEEE Trans. Biomed Eng, vol. 56, no. 8,
pp. 2123–2130, Aug. 2009.
[14] E. Bataillou et al., “Weighted averaging with adaptive weight estimation
[ECG],” in Proc. Comput. Cardiol. Conf., 1991, pp. 37–40.
[15] E. Bataillou et al., “Weighted averaging using adaptive estimation of the
weights,” Signal Process., vol. 44, no. 1, pp. 51–66, Jun. 1995.
[16] C. E. Davila and M. S. Mobin, “Weighted averaging of evoked potentials,”
IEEE Trans. Biomed. Eng., vol. 39, no. 4, pp. 338–345, Apr. 1992.
[17] R. F. Burkard et al., Auditory Evoked Potentials: Basic Principles and Clinical Application. Philadelphia, PA, USA: Lippincott Williams & Wilkins,
2007.
[18] C. L. Kumaragamage et al., “Development of an ultra low noise, miniature
signal conditioning device for vestibular evoked response recordings,”
Biomed. Eng. Online, vol. 13, p. 6, 2014.
[19] J. Kormylo and V. K. Jain, “Two-pass recursive digital filter with
zero phase shift,” IEEE Trans. Acoustics, Speech Signal Process.,
vol. ASSP-22, no. 5, pp. 384–387, Oct. 1974.
[20] B. Lithgow, “A methodology for detecting field potentials from the external ear canal: NEER and EVestG,” Ann. Biomed. Eng., vol. 40, no. 8,
pp. 1835–1850, Aug. 2012.
[21] E. L. Hall et al., “Methodology for improved detection of low concentration metabolites in MRS: Optimised combination of signals from multielement coil arrays,” NeuroImage, vol. 86, pp. 35–42, Feb. 1, 2014.
[22] J. Mandel, The Statistical Analysis of Experimental Data. New York, NY,
USA: Dover, 1984.
[23] D. G. Brennan, “Linear diversity combining techniques,” Proc. IEEE,
vol. 91, no. 2, pp. 331–356, Feb. 2003.
[24] C. L. Kumaragamage et al., “Implementation of a gelatin model to simulate
biological activity in the inner ear for electrovestibulography (EVestG)
validation,” in Proc. IEEE Eng. Med. Biol. Soc. Conf., 2013, vol. 2013,
pp. 4545–4548.
Authors’ photographs and biographies not available at the time of publication.

