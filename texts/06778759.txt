2102

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fast Three-Material Modeling With Triple Arch
Projection for Electronic Cleansing in CTC
Hyunna Lee, Jeongjin Lee*, Bohyoung Kim, Member, IEEE, Se Hyung Kim, and Yeong-Gil Shin

Abstract—In this paper, we propose a fast three-material modeling for electronic cleansing (EC) in computed tomographic
colonography. Using a triple arch projection, our three-material
modeling provides a very quick estimate of the three-material fractions to remove ridge-shaped artifacts at the T-junctions where air,
soft-tissue (ST), and tagged residues (TRs) meet simultaneously.
In our approach, colonic components including air, TR, the layer
between air and TR, the layer between ST and TR (LS T /T R ),
and the T-junction are first segmented. Subsequently, the material
fraction of ST for each voxel in LS T /T R and the T-junction is
determined. Two-material fractions of the voxels in LS T /T R are
derived based on a two-material transition model. On the other
hand, three-material fractions of the voxels in the T-junction are estimated based on our fast three-material modeling with triple arch
projection. Finally, the CT density value of each voxel is updated
based on our fold-preserving reconstruction model. Experimental
results using ten clinical datasets demonstrate that the proposed
three-material modeling successfully removed the T-junction artifacts and clearly reconstructed the whole colon surface while
preserving the submerged folds well. Furthermore, compared with
the previous three-material transition model, the proposed threematerial modeling resulted in about a five-fold increase in speed
with the better preservation of submerged folds and the similar
level of cleansing quality in T-junction regions.
Index Terms—Computed tomographic colonography (CTC),
electronic cleansing (EC), fold preservation, material fraction,
T-junction.

I. INTRODUCTION
OMPUTED tomographic colonography (CTC), also
known as virtual colonoscopy (VC), has been accepted
as a noninvasive alternative to colonoscopy that facilitates

C

Manuscript received October 5, 2013; revised February 11, 2014; accepted
March 19, 2014. Date of publication March 26, 2014; date of current version
June 14, 2014. This work was supported by Leading Foreign Research Institute Recruitment Program through the National Research Foundation of Korea
(NRF) funded by the Ministry of Science, ICT & Future Planning (MSIP)
(2012027176). Asterisk indicates corresponding author.
H. Lee is with Integrative Cardiovascular Imaging Research Center, Yonsei
Cardiovascular Center, College of Medicine, Yonsei University, Seodaemun-gu,
Seoul 120-752, Korea (e-mail: hnlee@cglab.snu.ac.kr).
∗ J. Lee is with the School of Computer Science and Engineering, Soongsil
University, Dongjak-Gu, Seoul 156-743, Korea (e-mail: leejeongjin@ssu.ac.kr).
B. Kim is with the Department of Radiology, Seoul National University,
Seongnam-si, Gyeonggi-do 463-707, Korea (e-mail: bhkim@snubh.org).
S. H. Kim is with the Department of Radiology, Seoul National University
Hospital, Jongno-gu, Seoul 110-744, Korea (e-mail: shkim@radcom.snu.ac.kr).
Y.-G. Shin is with the School of Computer Science and Engineering, Seoul National University, Gwanak-gu, Seoul 151-742, Korea (e-mail:
yshin@cse.snu.ac.kr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2313888

screening of colon cancer [1]–[5], which is the second leading
cause of cancer deaths in the United States [6]. CTC utilizes advanced medical imaging and computer technologies to mimic
the conventional optical colonoscopy (OC) navigation procedure, looking for polyps via a fly-through in a virtual colon
model which is reconstructed from abdominal computed tomography (CT) images [7], [8]. Although OC is the gold standard for
the examination of the entire colon [5], CTC has demonstrated
the potential to become a mass screening modality in terms of
safety, cost, and patient compliance [3], [9]–[11].
Considering that residual colonic materials such as stool and
fluid decrease the sensitivity and specificity of polyp detection,
however, CTC requires the thorough cleansing of the colon
prior to CT data acquisition. To cope with this limitation, fecal
tagging, which enhances residual materials using radiopaque
contrast material, has been introduced [12], [13]. The enhanced
residual materials appear to be hyperdense in CT images thus
tagged residues (TRs) can be easily differentiated from untagged
soft-tissue (ST) structures including polyps and cancers. Fecal
tagging has led to the development of electronic cleansing (EC),
which is the virtual cleansing of the colon by removal of the TRs
in CT images [14].
Various EC approaches have been investigated over the last
decade [15]–[24]. Although TRs with enhanced CT density values can be easily detected and removed through simple thresholding, a partial volume (PV) effect causes unexpected ST-like
layers between air and TR as well as aliasing artifacts between
ST and TR. Therefore, most previous EC methods were designed to mitigate the PV effect. EC methods are mainly categorized into statistical [15]–[18] and edge model-based methods [19]–[22]. The first group of EC methods employed a TR
classifier based on statistical features [15]–[18]. Chen et al. [15]
classified each voxel by its local feature vector based on Markov
random field. Wang et al. [17] presented a PV segmentation
method to classify each voxel that is composed of multiple
materials by using expectation-maximization (EM) algorithm.
Wang et al. [18] improved their EM-based method [17] using
maximum a posteriori EM algorithm.
The second group of EC methods delineated each type of
transition between different materials [19]–[22]. Zalis et al. [20]
mitigated the volume averaging artifacts at the boundary of the
TRs using a combination of morphological and spatial filterings.
Serlie et al. [21] proposed a two-material transition model that
estimates material fractions with subvoxel accuracy. Serlie et al.
[22] extended this model as a three-material transition model
using an anisotropic point-spread function and sampling near a
T-junction where air, ST, and TR simultaneously meet.
Although previous EC methods [16]–[22] have resolved the
PV effect, they share a common limitation: a degradation of

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

LEE et al.: FAST THREE-MATERIAL MODELING WITH TRIPLE ARCH PROJECTION FOR ELECTRONIC CLEANSING IN CTC

the ST structures caused by a pseudoenhancement (PEH) effect causes a degradation of the ST structures. Owing to the
PEH effect, which is an artificial increment of the observed CT
density from the presence of an adjacent hyperdense contrast
material [25], the folds submerged in TRs may be erroneously
identified as TRs and cleansed. To preserve such ST structures
submerged in TRs, Cai et al. [23] developed a structure analysis EC method, which segments TRs using a level set model
combined with the structural responses. However, their model
reconstructed the transition between ST and TR using simple
filterings without the consideration of material fractions.
To simultaneously mitigate the PV and PEH effects, Lee
et al. [26] proposed a fold-preserving EC method using a novel
reconstruction model that integrates the material fractions and
structural responses. However, this previous method [26] failed
to remove ridge-shaped artifacts at the T-junctions since a twomaterial transition model was adopted for estimating the material fractions. Although the T-junction artifacts can be removed
using a three-material transition model [22], this model has a
problem of high computational complexity due to the parachute
projection.
In this paper, we propose a new fast three-material modeling that estimates the three-material fractions from a triple
arch projection. The motivation is that the arch projection for
a two-material transition model requires far less computation
time than a parachute projection for a three-material transition
model. Considering that three different pairs of materials (i.e.,
air-ST, air-TR, and ST-TR) exist in a set of three materials
(i.e., air-ST-TR), these three pairs of two-material fractions are
calculated using the arch projection for a two-material transition model and are then simply combined into a single triplet
of three-material fractions based on a barycentric interpolation
in the material fraction space. In addition, by extending our
fold-preserving reconstruction model of two materials to take
into account three materials, our EC method using the newly
proposed three-material modeling quickly removes T-junction
artifacts while preserving the submerged folds well.
The remainder of this paper is organized as follows. The next
section describes the proposed method of fast three-material
modeling with triple arch projection. This procedure consists of
three major steps: segmentation, PV classification, and reconstruction. Section III presents the results of the application of the
proposed method to clinical datasets along with a comparison
to other previous methods. Finally, we summarize the results of
our findings and discuss directions for future work in Section IV.
II. METHODS
The proposed EC method consists of the following three
major steps, which are illustrated in Fig. 1. First, the colonic
components including air, TR, the layer between air and TR
(Lair/TR ), the layer between ST and TR (LST/TR ), and a Tjunction are segmented. Subsequently, in the PV classification
step, the material fraction of ST for each voxel in LST/TR and
the T-junction is determined. Two-material fractions of the voxels in LST/TR are derived based on a two-material transition
model. On the other hand, three-material fractions of the voxels

Fig. 1.

2103

Process of the proposed EC method.

in the T-junction are estimated based on our fast three-material
modeling with triple arch projection. Finally, during the reconstruction step, the CT density value of each voxel is updated
based on our fold-preserving reconstruction model.
A. Segmentation of Colonic Components
First, an anisotropic diffusion filter [27] is applied during the
preprocessing step. This filter suppresses noise in the TRs while
preserving the edges at their boundaries. Four colonic components, air, TR, Lair/TR , and LST/TR are then segmented using
the successive application of the seeded region growing (SRG),
rolling ball algorithm, and binary dilation operation [26]. Air
and TR are simultaneously segmented using the 3-D SRG with
two thresholds for air and TR. To prevent segmentation from
stopping on Lair/TR , a leaping is allowed between air and TR
across Lair/TR . To segment Lair/TR , a new colon lumen contour is constructed using the rolling ball algorithm. When a ball
filter touches two distinct points that belong to the air and TR
contours, a straight line that connects these two points is drawn.
The voxels newly encompassed by the final contour are assigned to be Lair/TR . As the binary dilation operation is applied
to TRs, LST/TR is segmented. The last colonic component, the
T-junction, is also segmented through the binary dilation operation. Both end regions of Lair/TR , where Lair/TR touches the
colon wall, are dilated using a 3 × 3 × 3 structuring element,
and the newly expanded voxels are assigned as a T-junction.
B. PV Classification Using Two- and Three-Material Models
After segmentation of the colonic components, each voxel
in the colonic region is classified as one of five components, i.e., air, TR, Lair/TR , LST/TR , and a T-junction. Each
voxel in air or TR is filled by a single pure material. Further, each voxel in Lair/TR or LST/TR is composed of two
different materials, whereas each voxel in the T-junction is
composed of three different materials. Considering that the TR

2104

will eventually be replaced with air in the next reconstruction step, voxels in Lair/TR are replaced with air regardless
of the material fractions (i.e., air-TR) at each voxel. During
the PV classification step, the material fractions of the voxels
in LST/TR and T-junction should therefore be estimated. For
each voxel in LST/TR , we derive two-material fractions (i.e.,
ST-TR) using a scale- and rotation-invariant two-material transition model [21], [26]. For each voxel in the T-junction, we can
determine the three-material fractions (i.e., air-ST-TR) using a
scale-invariant three-material transition model [22].
However, this three-material transition model suffers from
a high computational complexity when solving the parachute
projection problem when the observed measurements are projected onto a three-material transition model representation with
the minimum Euclidean distance. To reduce this high computational complexity, Serlie et al. [22] resolved the parachute
projection problem in a numerical manner. As a preprocessing step, they generated a “code-book” of traces by sampling
the three-material transition model representation uniformly in
the material fraction space. The optimal three-material fractions
were then determined approximately by finding the best match
entry between the observed measurements and the precalculated
entries in the code-book.
However, this approach still requires too much computation
time compared to an arch projection for a two-material transition model, because the observed measurements for every voxel
in the T-junction have to be compared to all of the entries in the
code-book. In addition, considering that the code-book is generated by sampling the model representation uniformly in the
material fraction space, the sampling rate limits the precision of
the estimated three-material fractions. As the sampling rate is
increased to establish a more accurate estimation, the processing time for finding the best match entry is therefore critically
increased owing to the exponential growth of the code-book.
As a more computationally efficient alternative, in this paper,
we propose a novel three-material modeling that provides a very
quick estimate of the three-material fractions without the use of
a code-book. In our three-material modeling, a parachute projection for the three-material transition model is replaced with a
triple-arch projection for a two-material transition model, which
requires far less computation time. Three pairs of two-material
fractions (i.e., air-ST, air-TR, and ST-TR) are calculated using a
two-material transition model and then simply combined into a
single triplet of three-material fractions (i.e., air-ST-TR) based
on a barycentric interpolation in the material fraction space.
1) Two- and Three-Material Transition Models: Prior to a
detailed description of the proposed three-material modeling,
we briefly review the previous two-material [21], [26] and threematerial [22] transition models. A transition between two different materials is modeled using a Gaussian blurred step edge
along the gradient direction ω allowing slowly varying material densities at both sides of the transition, and the CT density value I across the Gaussian blurred step edge and its first
derivative Iω are related based on the arch function. The gradient magnitude is increased based on the scale of Gaussian σω
along ω to make the arch scale-invariant, and based on scale
factor θ to make the noise isotropic. For each voxel, the data

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 2. Barycentric coordinate in a triangular domain [22]. (a) Image acquisition combining PV contributions of three different materials into the CT density
value. (b) Edges of the triangle denoting mixtures of two materials, corresponding to three arches for the two-material transition model.

measurements {I, θσω Iω } are then projected onto the closest
point {I  , θσω Iω } on the θ-weighted arch curve using an arch
projection, and the relative position of the arch-projected point
{I  , θσω Iω } yields the material fractions of two materials. This
two-material transition model is extended into a three-material
transition model using a homogeneous barycentric coordinate
on a triangle (Pair , PST , PTR ) [22]. The properties of the homogeneous barycentric coordinate on the triangle are as follows
(Fig. 2).
1) The vertices of the triangle denote each of the three pure
materials.
2) The edges of the triangle denote mixtures of two materials,
with the scale-invariant gradient magnitude being given
by the arch function.
3) The inner points of the triangle denote mixtures of the
three materials that correspond to the three vertices of
the triangle. Given an arbitrary inner point, the proportion
of the areas of the three subtriangles defined by this inner
point and the two vertices of the triangle represent the
material fractions of the three materials.

LEE et al.: FAST THREE-MATERIAL MODELING WITH TRIPLE ARCH PROJECTION FOR ELECTRONIC CLEANSING IN CTC

Fig. 3. Parachute projection for three-material transition model [22]. (a) Firstorder parachute function displaying σ ω Iω as a function of the barycentric
position. (b) Second-order parachute function displaying σ ω2 Iω ω as a function
of the barycentric position. (c) Ambiguity in the estimation of three-material
fractions using a data measurement pair {I, θσ ω Iω }. Probing the surface of the
first-order parachute function along a fixed density (dark line) results in equal
altitude for two positions. (d) Including the second derivative (b) in the gradient
direction (dashed line) solves this problem. This can be seen since equal gradient
magnitudes have a different second derivative in the gradient direction.

For each voxel at a T-junction, the three-material fractions
(tair , tST , tTR ) are estimated by determining a barycentric point
(BP) in the interior of the triangle. However, the data measurement pair {I, θσω Iω }, which is sufficient information for
estimating two-material fractions, leads to an ambiguity in the
estimation of three-material fractions. When the first derivatives
of the CT density value (as a barycentric coordinate in the triangle in the material fraction space, and not in the image space)
are modeled by the first-order parachute function [see Fig. 3(a)],
probing the surface of the first-order parachute function along
the given CT density value I results in an equal altitude for two
different positions [see Fig. 3(b)]. To resolve any ambiguity, the
second-derivative term is included. Further, using the parachute
projection, the data measurement triplet {I, θ1 σω Iω , θ2 σω2 Iω ω}
is projected onto both the first- and second-order parachute functions [see Figs. 3(c) and (d)]. The parachute-projected point that
yields the minimum Euclidean distance to the data measurements {I, θ1 σω Iω , θ2 σω2 Iω ω} is determined by minimizing the
sum of the square residuals as follows:
t = (tair , tST , tTR )T

2105

derivative to obtain isotropic noise in the same manner as in the
two-material transition model. However, this parachute projection of the data measurement triplet {I, θ1 σω Iω , θ2 σω2 Iω ω} suffers from a high computational complexity. To reduce the computational complexity of the parachute projection for the threematerial transition model, BP is approximately determined by
finding the best match between the data measurements and the
entries in the code-book, which is generated through a uniform
sampling of the three-material model representation in the material fraction space. As mentioned earlier, despite the use of the
code-book, a comparison of the data measurements with all of
the entries in the code-book still requires too much computation
time compared to an arch projection for the two-material transition model. Therefore, a computationally efficient alternative is
required for the application of three-material modeling in a real
clinical environment.
2) Three-Material Modeling With Triple Arch Projection:
To accelerate the estimation of the three-material fractions,
we propose a fast three-material modeling. Without the use
of the code-book, our three-material modeling provides a very
quick estimate of the three-material fractions by converting the
parachute projection for the three-material transition model into
an arch projection for the two-material transition model. Three
pairs of two-material fractions are calculated using triple-arch
projection and then simply combined into a single triplet of
three-material fractions based on the barycentric interpolation
in the material fraction space.
Since three materials (i.e., air, ST, and TR) contribute to the
CT density values of the voxels in a T-junction, three different
arch curves can be constructed to represent three kinds of twomaterial transitions (i.e., air-ST, air-TR, and ST-TR) at a Tjunction [see Fig. 4(a)]. These arches coincide with the edges
of the triangle in a barycentric coordinate when the vertices
of the triangle represent three pure materials (air, ST, and TR)
[see Fig. 4(b)]. First, for each voxel, the data measurement pair
{I, θσω Iω} is arch-projected onto the closest points on three arch
curves, which represent three kinds of two-material transitions.
Three arch-projected points (APs) in three arch curves are then
used to derive three pairs of two-material fractions at the voxel
[see Fig. 4(a)]. In the barycentric coordinate associated with the
three materials, each of the three APs is located on one edge of
the triangle as follows:
APair -ST = tair/(air -ST) · Pair + tST/(air -ST) · PST
APair -TR = tair/(air -TR) · Pair + tTR/(air -TR) · PTR
APST -TR = tST/(ST -TR) · PST + tTR/(ST -TR) · PTR . (2)

2

Let Pair , PST , and PTR represent three vertex points of a


θn2 σωn I (n ) − parachute(n ) (tair , tST , tTR ) triangle corresponding to single materials of air, ST, and TR,
t a i r ,t S T ,t T R
n =0
respectively. Further, let tA /(A -B ) represent the material fraction
(1) of A between two materials A and B; the following equations
can thus be derived:
where I (n ) is the nth Gaussian derivative of the voxel inten(n )
tair/(air -ST) + tST/(air -ST) = tair/(air -TR) + tTR/(air -TR)
sity in the gradient direction, and parachute (tair , tST , tTR )
is the nth order parachute function. In addition, tm represents
= tST/(ST -TR) + tTR/(ST -TR)
the material fraction of material m at the point of the trajectory
= 1.
(3)
for the parachute function, and θn is the scale factor for the nth
= arg min

2


2106

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

tST/(air -ST) + tST/(ST -TR)
· PST
3
tTR/(air -TR) + tTR/(ST -TR)
· PTR
+
3
+

(6)

where
tair/(air -ST) + tST/(air -ST) + tair/(air -TR) + tTR/(air -TR)
+ tST/(ST−TR) + tTR/(ST−TR) = 3.

(7)

The position of BP is determined based on the areas of three
subtriangles, which are proportional to the fraction of each material. Therefore, the material fractions of air, ST, and TR can
be estimated as follows:
tair/(air -ST) + tair/(air -TR)
3
tST/(air -ST) + tST/(ST−TR)
=
3
tTR/(air -TR) + tTR/(ST−TR)
= 1 − tair − tST . (8)
=
3

tair =
tST
tTR

C. Fold-Preserving Reconstruction Model for Both Two and
Three Materials

Fig. 4. Proposed three-material modeling. (a) Three arch projections of the
data measurement pair {I, θσ ω Iω }. The positions of three arch-projection points
(APs) derive three pairs of two-material fractions. (b) Barycentric interpolation
in a triangular domain. When using uniform weights, barycentric point BP is
determined as the center of the triangle formed by three APs. The proportion of
the areas of the three subtriangles (light gray, gray, and dark gray) represents
the three-material fractions.

Finally, the barycentric interpolation of the three APs generates a single BP in the interior of the triangle as follows:
BP = αair -ST · APair -ST + αair -TR · APair -TR
+ αST−TR · APST−TR

(4)

αair -ST + αair -TR + αST -TR = 1.

(5)

where

In this paper, we used uniform weights of αair -ST =
αair -TR = αST -TR = 13 since we can assume that an arbitrary
voxel in the T-junction has an unbiased distribution of the predominance of each material. Using uniform weights, BP is determined as the center of the triangle formed by three APs as
follows [see Fig. 4(b)]:
1
BP = · (APair -ST + APair -TR + APST -TR )
3
tair/(air -ST) + tair/(air -TR)
· Pair
=
3

In the final step of the proposed EC method, the CT density
value of each voxel in colonic regions is reconstructed based on
the material fractions determined in the previous step. In the air,
TR, and Lair/TR regions, the CT density values of the voxels
are replaced by Iair because there is no contribution of the PV
of ST in these regions and TR will eventually be replaced with
air regardless of the material fractions of air and TR at each
voxel. For a reconstruction of the voxels in LST/TR , our foldpreserving reconstruction model [26] is used. For voxels in the
T-junction, the reconstruction model is extended to take account
of three materials, resulting in a minimization of the T-junction
artifacts. In the case of the three materials, the CT density value
Ioriginal is modeled as a linear combination of the pure material
densities of air, ST, and TR with the corresponding material
fractions: Ioriginal = tair · Iair + tST · IST + tTR · ITR . When
we use the material fraction-based reconstruction model, the
CT density value Ifractions is reconstructed by replacing the
contributions of TR with air, i.e., Ifractions = tair · Iair + tST ·
IST + tTR · Iair .
For a preservation of the submerged folds, the rutenhancement function is integrated into the three-material
fraction-based reconstruction model as the weight factor in a
similar way as in our fold-preserving reconstruction model for
two materials [26]. The final CT density value Ifold -preserving
for the three materials is reconstructed as follows:
Ifold -preserving = (1 − (1 − Frut )κ ) · Ioriginal
+ (1 − Frut )κ · Ifractions
= tair · Iair + tST · IST
+ tTR · {(1 − (1 − Frut )κ ) · ITR
+ (1 − Frut )κ · Iair } .

(9)

LEE et al.: FAST THREE-MATERIAL MODELING WITH TRIPLE ARCH PROJECTION FOR ELECTRONIC CLEANSING IN CTC

For each voxel, the structural response Frut is calculated
through the rut-enhancement function, which differentiates the
submerged folds from the neighboring TRs by the local morphological structure based on the eigenvalue signature of a Hessian
matrix [23], [26]. Parameter κ controls the relative contribution of the rut-enhancement function to the fold preservation.
In this paper, parameter κ is experimentally set to 2. Our novel
reconstruction model replaces the contribution of TR with the
combination of air and TR, while the contributions of air and
ST are conserved during EC, resulting in a preservation of the
folds.
III. EXPERIMENTAL RESULTS
We used five full-cathartic fecal-tagging CTC cases. Multidetector CT scanning (Brilliance 64, Philips Medical Systems,
Cleveland, OH, USA) was performed in both supine and prone
positions, resulting in a total of 30 scans from 15 patients. Each
scan is represented by a volume image dataset of about 600
slices of 512 × 512 array size with spatial resolution roughly
0.66 mm × 0.66 mm × 0.7 mm.
We evaluated the improvement in EC quality by comparing
the proposed three-material modeling (ECthree prop ) with our
previous fold-preserving EC method (ECtwo ) [26] and previous three-material transition model (ECthree prev ) [22]. Threedimensional volume-rendered images of a panoramic endoluminal view (referred to hereafter as “band view”) were generated
[28] from the original, ECtwo , ECthree prev , and ECthree prop
CT datasets. Along the navigation path from the rectum to the
cecum, the band view was screen-captured with a uniform step
size of 50.0 mm. Of the 1043 screen-captured images from
the original ten CT scans, 690 were selected when at least one
tagged pool appeared in the image. For each selected image
from the original datasets, three corresponding electronically
cleansed images were also captured from the same camera position within ECtwo , ECthree prev , and ECthree prop . Using these
selected images, the visual assessment of the cleansing quality was performed by an abdominal radiologist with more than
1,000 CTC cases of clinical experience.
A. Comparison With Two-Material Transition Model
To evaluate the performance of ECthree prop compared to
ECtwo [26], the 690 selected image pairs of ECthree prop
and ECtwo were shown in random order, and the ECtwo and
ECthree prop images of each pair were displayed on the same
screen in a blind manner (i.e., one at the top and the other at the
bottom) with the corresponding reference image from the original datasets (at the center). For each selected image pair, the
radiologist independently rated the perceptible difference in the
cleansing quality between the top and bottom images on a fourpoint comparison scale. If two images were identical or almost
identical in the cleansing quality, grade 0 was assigned. Otherwise, the radiologist indicated a preference for either the top or
bottom image and any perceived differences were assigned as
follows. Grade 1 meant slightly better (or worse) image quality.
Grade 2 meant better (or worse) image quality. Grade 3 meant
much better (or worse) image quality.

2107

Fig. 5 compares 3-D band view images containing T-junction
regions from the original ECtwo and ECthree prop datasets.
Parts of the colon surface, i.e., LST/TR and the T-junctions,
were covered by TRs before EC [see Fig. 5(a)], but the covered colon surface was exposed and reconstructed after EC in
both ECtwo and ECthree prop [see Figs. 5(b) and (c)]. Both
ECtwo and ECthree prop showed good EC results without ST
degradation artifacts of the submerged folds or aliasing artifacts in LST/TR . However, in ECtwo , T-junction artifacts were
observed as distracting ridges along the line where Lair/TR
touches the colon surface [see Fig. 5(b)], demonstrating that
the previous fold-preserving EC method, ECtwo using only the
two-material transition model [26], does not resolve the artifacts
owing to the three-material intersections at the T-junctions. In
contrast, ECthree prop adopting our new three-material modeling removed the T-junction artifacts, and clearly reconstructed
the whole colon surface including the T-junction regions [see
Fig. 5(c)].
Table I shows the grading results for a perceptible difference in the cleansing quality between ECtwo and ECthree prop .
Of the 690 selected image pairs containing at least one tagged
pool, 28 (4.06%) and 617 (89.42%) images from ECtwo and
ECthree prop , respectively, were preferred by the radiologist.
Since the radiologist rated the difference in the cleansing quality
between the top and bottom images in a blind manner, when selecting a preference for the ECtwo images, the difference grades
were considered to be negative. For example, for a given image
pair, when the radiologist selected a preference for an ECtwo
image and rated the difference in the cleansing quality as grade
1, the difference grade became –1, indicating that the cleansing
quality of the ECthree prop image is slightly “worse” than that
of the ECtwo image. For the 690 image pairs, the average of
the difference grades between ECtwo and ECthree prop was then
1.42, and this positive average value showed that ECthree prop
had an overall improvement in EC quality compared to ECtwo .
B. Comparison With the Previous Three-Material
Transition Model
To evaluate the performance of ECthree prop compared to
ECthree prev [22], the visual assessment was performed in a
similar manner. The 690 selected image pairs of ECthree prop
and ECthree prev were assessed by the same radiologist. In the
assessment, considering that the three-material models were designed to remove ridge-shaped artifacts at the T-junctions, the
radiologist assessed the cleansing quality of only T-junction
regions. Because there was no significant difference in the Tjunction artifacts between ECthree prev and ECthree prop , the additional assessment was performed to examine the entire region
of the images to find any image difference, including submerged
fold artifacts.
Table II shows the grading results for the perceptible difference in the T-junction artifacts between ECthree prev and
ECthree prop . Of the 690 selected image pairs, 640 (92.75%)
pairs were rated as grade 0, indicating that ECthree prev and
ECthree prop images were identical or almost identical. The
average of the difference grades between ECthree prev and

2108

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 5. Comparison of 3-D band view images from ECtw o and ECth re e p ro p . (a) Band view images generated from the original dataset before EC. (b) Magnified
images of the T-junctions from ECtw o . (c) Magnified images of the T-junctions from ECth re e p ro p .
TABLE I
PERCEPTIBLE DIFFERENCE IN CLEANSING QUALITY FOR ECtw o AND
ECth re e p ro p

TABLE II
PERCEPTIBLE DIFFERENCE IN T-JUNCTION ARTIFACTS FOR ECth re e
ECth re e p ro p

p re v AND

ECthree prop was 0.017 and this indicated that ECthree prev
and ECthree prop had a similar EC quality at the T-junctions.
On the other hand, Table III shows the grading results for
the perceptible difference in the entire region of the images
including submerged folds. Of the 690 selected image pairs,
285 (41.30%) pairs were rated as grade 0 and 399 (57.83%)

TABLE III
PERCEPTIBLE DIFFERENCE IN ENTIRE IMAGE INCLUDING SUBMERGED FOLDS
FOR ECth re e p re v AND ECth re e p ro p

images from ECthree prop were preferred by the radiologist,
whereas only 6 (0.87%) images from ECthree prev were preferred. The average of the different grades between ECthree prev
and ECthree prop was 0.80. Therefore, although the T-junction
artifacts were successfully removed in both ECthree prev and
ECthree prop , ECthree prop showed an overall improvement in
EC quality compared to ECthree prev , especially including the
better preservation of the submerged folds.
Fig. 6 compares 3-D band view images containing Tjunction regions and submerged folds from the original, ECtwo ,
ECthree prev , and ECthree prop datasets. The parts of the colon
surface covered by TRs before EC [see Fig. 6(a)] are exposed and reconstructed after EC in ECtwo , ECthree prev , and
ECthree prop [see Figs. 6(b) and (d)]. In contrast to ECtwo , in

LEE et al.: FAST THREE-MATERIAL MODELING WITH TRIPLE ARCH PROJECTION FOR ELECTRONIC CLEANSING IN CTC

2109

Fig. 6. Comparison of 3-D band view images from ECtw o , ECth re e p re v , and ECth re e p ro p . (a) Magnified image of T-junctions from the original dataset before
EC. (b) Magnified image from ECtw o . (c) Magnified image from ECth re e p re v . (d) Magnified image from ECth re e p ro p .

particular, the T-junction artifacts were successfully removed in
both ECthree prev and ECthree prop . In addition, while the submerged folds had a rough surface in ECtwo [see Fig. 6(b)] or
became inappropriately cleansed in ECthree prev [see Fig. 6(c)]
after EC, ECthree prop well preserved submerged folds after EC
[see Fig. 6(d)].
The same radiologist also performed the polyp detection.
For 15 patients, 27 polyps ≥6 mm were identified using OC.
Considering both supine and prone position datasets as independent scans, there were totally 54 polyps in 30 scans. Of 54
polyps, 37 polyps were easily visible in the original ECtwo ,
ECthree prev , and ECthree prop datasets because they were surrounded by air. The remaining 17 polyps, which were partially
or completely submerged in TRs, could not be detected in the
original dataset. But, all of them were clearly visible in ECtwo ,
ECthree prev , and ECthree prop datasets. Thus, the sensitivity
for polyp detection after EC was identically 100% (54/54) with
ECtwo , ECthree prev , and ECthree prop . Fig. 7 illustrates 3-D
band view images containing two different types of polyps before EC and after EC with ECthree prop . Both of them were
clearly visible after EC, and were confirmed to be true polyps
by OC.
In addition, we also evaluated the improvement in computational performance. We compared the computational complexity

and processing times of ECthree prop and ECthree prev [22].
During the ECthree prev , we generated a code-book by sampling the model representation uniformly in the material fraction space. When considering the trade-off relationship between
the sampling rate of the code-book generation and the processing time for the comparison of all entries in the code-book, the
sampling rate should be set to allow a fair comparison between
ECthree prev and ECthree prop . In this paper, the sampling size
for the generation of the code-book in ECthree prev was set to
0.01, since the arch projection used in ECthree prop was solved in
an iterative manner until a change in the material fraction of less
than 0.01 was achieved. These algorithms were tested on an Intel
Core-i7-based desktop computer with 12 GB of main memory.
A comparison in terms of the computational complexity
could show the computational efficiency of the proposed threematerial modeling over the previous three-material model [22].
In the material fraction space, let the number of samples for
each material dimension
 be N . Then, the time complexity
of ECthree prev is O N 2 for the lookup on the code-book.
On the other hand, the time complexity of ECthree prop is
O (log N )since our three-material modeling is the linear combination of triple arch projections and the time complexity of the
arch projection for two-material transition model is O (log N )
due to its convexity.

2110

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 7. Polyps (arrows) before and after EC. Top and middle rows show 3-D band view images before EC and after ECth re e p ro p , respectively. Bottom row
shows captured images during OC, in which the two polyps were found in two different patients. The 15-mm pedunculated (a) and 7-mm sessile (b) polyps were
both clearly exposed and well depicted (see the middle row).

The processing time of each method for three-material modeling was averaged over ten runs of all of the datasets. Both
ECthree prev and ECthree prop commonly took 62.3 ± 5.4 s for
the segmentation of colonic components, 4.2 ± 2.1 s for the
estimation of the two-material fractions of the TR voxels, and
10.6 ± 4.7 s for the fold-preserving reconstruction. For an estimation of the three-material fractions of the T-junction voxels,
ECthree prev took about 34.3 ± 7.7 s since the data measurement
triplet at each voxel had to be compared with every entry in the
code-book to find the best match that yields the minimum least
squares error. ECthree prev additionally required 0.04 s for the
generation of the code-book during the preprocessing step. On
the other hand, ECthree prop reduced the processing time for the
estimation of the three-material fractions to 6.8 ± 1.9 s, thereby
resulting in about a five-fold increase in speed.
IV. CONCLUSION
In this paper, we proposed a novel three-material modeling with a triple arch projection to remove ridge-shaped artifacts at the T-junctions. In the proposed EC method, the
colonic region is first segmented as five components, i.e., air,
TR, Lair/TR , LST/TR , and a T-junction. Subsequently, in the
PV classification step, the two- and three-material fractions for
voxels in LST/TR and T-junction are determined using the twomaterial transition model and the fast three-material modeling
with a triple arch projection, respectively. Finally, in the reconstruction step, the CT density value of each voxel is updated
based on our fold-preserving reconstruction model, which is
extended to take into account both two and three materials.

Although the T-junction artifacts can be removed using a
previous three-material transition model [22], this method includes a parachute projection problem with high computational
complexity. Despite the acceleration when using a code-book,
it still requires too much computation time compared to an arch
projection for a two-material transition model because the data
measurements for each voxel have to be compared to all entries in the code-book. In contrast, the proposed three-material
modeling with triple-arch projection provides a very quick estimate of the three-material fractions. In a set of three materials, three different pairs of materials exist, and these three
pairs of two-material fractions are derived quickly using a
two-material transition model with arch projection. A single
triplet of three-material fractions is then determined based on
the barycentric interpolation of the three pairs of two-material
fractions.
Experimental results from ten clinical CT datasets demonstrate that the proposed method successfully removes the Tjunction artifacts and clearly reconstructs a whole colon surface including the T-junction regions. Compared to ECtwo ,
ECthree prop showed an overall improvement in EC quality based on a visual assessment evaluating the perceptible differences in the cleansing quality between ECtwo
and ECthree prop . In addition, compared to ECthree prev ,
ECthree prop showed an improvement in computational performance based on a comparison of the processing times
for clinical datasets with the better preservation of submerged folds and the similar level of cleansing quality in Tjunction regions and the same sensitivity of 100% in the polyp
detection.

LEE et al.: FAST THREE-MATERIAL MODELING WITH TRIPLE ARCH PROJECTION FOR ELECTRONIC CLEANSING IN CTC

TABLE IV
PARAMETER VALUES USED IN OUR IMPLEMENTATION
[12]

[13]

[14]
[15]
[16]

In our full-cathartic fecal-tagging CTC datasets, the TR region appears as a bowl-shaped liquid pool with mostly homogeneous tagging. Thus, our results cannot be directly applied to
a noncathartic fecal-tagging CTC, in which TR is often inhomogeneously tagged as being filled with a semisolid material
consisting of mixtures of fats, undigested foodstuff, air bubbles,
and unevenly distributed contrast materials. As future work, we
are therefore planning to remove EC artifacts from inhomogeneously TRs found in noncathartic fecal-tagging CTC.

[17]

[18]

[19]

APPENDIX
Table IV shows the values of parameters used in segmentation
and reconstruction steps. The values of the parameters were
experimentally determined.

[20]

[21]

REFERENCES
[1] C. G. Coin, F. C. Wollett, J. T. Coin, M. Rowland, R. K. Deramos, and
R. Dandrea, “Computerized radiology of the colon: A potential screening
technique,” Comput. Radiol., vol. 7, no. 4, pp. 215–221, Jul./Aug. 1983.
[2] L. H. Shigeru, S. Muraki, A. Kaufman, D. Bartz, and T. He, “Virtual voyage: Interactive navigation in the human colon,” in Proc. ACM
SIGGRAPH, 1997, pp. 27–34.
[3] J. T. Ferrucci, “Colon cancer screening with virtual colonoscopy: Promise,
polyps, politics,” Amer. J. Roentgenol., vol. 177, no. 5, pp. 975–988, Nov.
2001.
[4] M. M. Morrin and J. T. LaMont, “Screening virtual colonoscopy—Ready
for prime time?,” N. Engl. J. Med., vol. 349, no. 23, pp. 2261–2264, Dec.
2003.
[5] A. E. Kaufman, S. Lakare, K. Kreeger, and I. Bitter, “Virtual
colonoscopy,” Commun. ACM, vol. 48, no. 2, pp. 37–41, Feb. 2005.
[6] American Cancer Society, Cancer Facts & Figures, 2013, American Cancer Society, Inc., Atlanta, 2013.
[7] L. Hong, Z. Liang, A. Viswambharant, A. Kaufman, and M. Wax, “Reconstruction and visualization of 3D models of colonic surface,” IEEE
Trans. Nucl. Sci., vol. 44, no. 3, pp. 1297–1302, Jun. 1997.
[8] I. Serlie, F. Vos, J. Stoker, R. Truyen, F. Gerritsen, Y. Nio, and F. Post,
“Improved visualization in virtual colonoscopy using image-based rendering,” in Proc. IEEE Joint Eurographics TCVG Symp. Vis., 2001, pp. 137–
146.
[9] A. K. Hara, C. D. Johnson, J. E. Reed, D. A. Ahlquist, H. Nelson,
R. L. MacCarty, W. S. Harmseen, and D. M. L. Iistrup, “Detection of
colorectal polyps with CT colography: Initial assessment of sensitivity
and specificity,” Radiology, vol. 205, no. 1, pp. 59–65, Oct. 1997.
[10] H. M. Fenlon, D. P. Nunes, P. C. Schroy, M. A. Barish, P. D. Clarke, and
J. T. Ferrucci, “A comparison of virtual and conventional colonoscopy for
the detection of colorectal polyps,” N. Engl. J. Med., vol. 341, no. 20,
pp. 1496–1503, Nov. 1999.
[11] J. Yee, G. A. Akerkar, R. K. Hung, A. M. Steinauer-Gebauer, S. D. Wall,
and K. R. McQuaid, “Colorectal neoplasia: Performance characteristics

[22]

[23]
[24]

[25]
[26]

[27]
[28]

2111

of CT colonography for detection in 300 patients,” Radiology, vol. 219,
no. 3, pp. 685–692, Jun. 2001.
M. R. Callstrom, C. D. Johnson, J. G. Fletcher, J. E. Reed, D. A. Ahlquist,
W. S. Harmsen, K. Tait, L. A. Wilson, and K. E. Corcoran, “CT colonography without cathartic preparation: feasibility study,” Radiology, vol. 219,
no. 3, pp. 693–698, Jun. 2001.
P. A. Lefere, S. S. Gryspeerdt, J. Dewyspelaere, M. Baekelandt, and
B. G. Van Holsbeeck, “Dietary fecal tagging as a cleansing method before CT colonography: Initial results—Polyp detection and patient acceptance,” Radiology, vol. 224, no. 2, pp. 393–403, Aug. 2002.
M. R. Wax, Z. Liang, R. Chiou et al., “Electronic colon cleansing for virtual colonoscopy,” presented at the First Int. Symp. Virtual Colonoscopy,
Boston, MA, USA, 1998, p. 94.
D. Chen, Z. Liang, M. R. Wax, L. Li, B. Li, and A. E. Kaufman, “A novel
approach to extract colon lumen from CT images for virtual colonoscopy,”
IEEE Trans. Med. Imag., vol. 19, no. 12, pp. 1220–1226, Dec. 2000.
L. Li, D. Chen, S. Lakare, K. Kreeger, I. Bitter, A. E. Kaufman, M. R. Wax,
P. M. Djuric, and Z. Liang, “An image segmentation approach to extract
colon lumen through colonic material tagging and hidden Markov random
field model for virtual colonoscopy,” in Proc. SPIE, San Diego, CA, USA,
2002, pp. 406–411.
Z. Wang, Z. Liang, X. Li, L. Li, B. Li, D. Eremina, and H. Lu, “An
improved electronic colon cleansing method for detection of colonic
polyps by virtual colonoscopy,” IEEE Trans. Biomed. Eng., vol. 53, no. 8,
pp. 1635–1646, Aug. 2006.
S. Wang, L. Li, H. Cohen, S. Mankes, J. J. Chen, and Z. Liang, “An EM
approach to MAP solution of segmenting tissue mixture percentages with
application to CT-based virtual colonoscopy,” Med. Phys., vol. 35, no. 12,
pp. 5787–5798, Dec. 2008.
S. Lakare, D. Chen, L. Li, A. Kaufman, and Z. Liang, “Electronic colon
cleansing using segmentation rays for virtual colonoscopy,” in Proc. SPIE,
San Diego, CA, USA, 2002, pp. 412–418.
M. E. Zalis, J. Perumpillichira, and P. F. Hahn, “Digital subtraction bowel
cleansing for CT colonography using morphological and linear filtration methods,” IEEE Trans. Med. Imag., vol. 23, no. 11, pp. 1335–1343,
Nov. 2004.
I. W. O. Serlie, F. M. Vos, R. Truyen, F. H. Post, and L. J. Van Vliet,
“Classifying CT image data into material fractions by a scale and rotation invariant edge model,” IEEE Trans. Image Process., vol. 16, no. 12,
pp. 2891–2904, Dec. 2007.
I. W. O. Serlie, F. M. Vos, R. Truyen, F. H. Post, J. Stoker, and L. J. van
Vliet, “Electronic cleansing for computed tomography (CT) colonography
using a scale-invariant three-material model,” IEEE Trans. Biomed. Eng.,
vol. 57, no. 6, pp. 1306–1317, Jun. 2010.
W. Cai, M. E. Zalis, J. Näppi, G. J. Harris, and H. Yoshida, “Structureanalysis method for electronic cleansing in cathartic and noncathartic CT
colonography,” Med. Phys., vol. 35, no. 7, pp. 3259–3277, Jul. 2008.
W. Cai, J. G. Lee, M. E. Zalis, and H. Yoshida, “Mosaic decomposition:
An electronic cleansing method for inhomogeneously tagged regions in
noncathartic CT colonography,” IEEE Trans. Med. Imag., vol. 30, no. 3,
pp. 559–574, Mar. 2011.
J. Näppi and H. Yoshida, “Adaptive correction of the pseudo-enhancement
of CT attenuation for fecal-tagging CT colonography,” Med. Image Anal.,
vol. 12, no. 4, pp. 413–426, Aug. 2008.
H. Lee, B. Kim, J. Lee, S. H. Kim, Y. G. Shin, and T. G. Kim, “Foldpreserving electronic cleansing using a reconstruction model integrating
material fractions and structural responses,” IEEE Trans. Biomed. Eng.,
vol. 60, no. 6, pp. 1546–1555, Jun. 2013.
P. Perona and J. Malik, “Scale-space and edge detection using anisotropic
diffusion,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 12, no. 7, pp. 629–
639, Jul., 1990.
S. S. Lee, S. H. Park, J. K. Kim, N Kim, J. Lee, B. J Park, Y. J Kim,
M. W Lee, A. Y Kim, and H. K Ha, “Panoramic endoluminal display
with minimal image distortion using circumferential radial ray-casting
for primary three-dimensional interpretation of CT colonography,” Eur.
Radiol., vol. 19, no. 8, pp. 1951–1959, Aug. 2009.

Authors’ photographs and biographies not available at the time of publication.

