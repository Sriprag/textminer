986

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

A Direct Method With Structural Priors for
Imaging Pharmacokinetic Parameters in
Dynamic Fluorescence Molecular Tomography
Guanglei Zhang, Fei Liu, Huangsheng Pu, Wei He, Jianwen Luo, and Jing Bai∗

Abstract—Images of pharmacokinetic parameters in dynamic
fluorescence molecular tomography (FMT) have the potential to
provide quantitative physiological information for biological studies and drug development. However, images obtained with conventional indirect methods suffer from low signal-to-noise ratio
because of failure in efficiently modeling the measurement noise.
Besides, FMT suffers from low spatial resolution due to its ill-posed
nature, which further reduces the image quality. In this letter, we
present a direct method with structural priors for imaging pharmacokinetic parameters, which uses a nonlinear objective function
to efficiently model the measurement noise and utilizes the structural priors to mitigate the ill-posedness of FMT. The results of
numerical simulations and in vivo mouse experiments demonstrate
that the proposed method leads to significant improvements in the
image quality.
Index Terms—Fluorescence tomography, pharmacokinetics
imaging, reconstruction algorithm, structural priors (SPs).

I. INTRODUCTION
YNAMIC fluorescence molecular tomography (FMT) is a
powerful imaging technique that allows dynamically and
three-dimensionally resolving the metabolic process of fluorophores within small animals in vivo. Through the application
of compartmental models, the dynamic FMT boundary measurements can be transformed into images of pharmacokinetic
parameters, which are known as parametric images and can

D

Manuscript received August 29, 2013; revised November 2, 2013; accepted
November 21, 2013. Date of current version February 14, 2014. This work was
supported by the National Basic Research Program of China (973) under Grant
2011CB707701, the National Natural Science Foundation of China under Grants
81227901, 81071191, and 81271617, the National Major Scientific Instrument
and Equipment Development Project under Grant 2011YQ030114, the National Science and Technology Support Program under Grant 2012BAI23B00.
The work of F. Liu was supported in part by the Postdoctoral Fellowship of the
Center for Life Sciences. Asterisk indicates corresponding author.
G. Zhang, H. Pu, and W. He are with the Department of Biomedical Engineering, School of Medicine, Tsinghua University, Beijing 100084, China (e-mail:
guangleizhang@163.com; 29219550@qq.com; posithe@gmail.com).
F. Liu is with the Tsinghua-Peking Center for Life Sciences and Department
of Biomedical Engineering, School of Medicine, Tsinghua University, Beijing
100084, China (e-mail: erin4436@163.com).
J. Luo is with the Center for Biomedical Imaging Research and Department
of Biomedical Engineering, School of Medicine, Tsinghua University, Beijing
100084, China (e-mail: luo_jianwen@tsinghua.edu.cn).
∗ J. Bai is with the Department of Biomedical Engineering, School of
Medicine, Tsinghua University, Beijing 100084, China (e-mail: deabj@
tsinghua.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2292714

provide valuable physiological information for tumor detection,
drug development, and metabolic research [1]–[3].
Typically, there are two kinds of methods for obtaining parametric images in dynamic FMT: indirect methods and direct
methods. In the conventional indirect methods, a time series
of FMT images are first reconstructed, and then each voxel in
the imaged volume is fitted to a compartmental model to obtain the parametric images. Although the indirect methods are
simple and easy to implement, they tend to obtain parametric
images with low signal-to-noise ratio (SNR). This is because
the boundary measurements have been divided into individual
time frames in the first step; thus, the indirect methods cannot
efficiently model the measurement noise [2], [4]. In contrast, the
direct methods can reconstruct parametric images directly from
the raw boundary measurements by combining dynamic FMT
reconstruction and compartment modeling into one step; thus,
they allow modeling the measurement noise in one objective
function and can be statistically more efficient [4].
Despite of the advantages of direct methods, dynamic FMT is
still challenging when applied to image the pharmacokinetic parameters of organs in small animals, because FMT suffers from
a low spatial resolution due to its inherent ill-posedness [5],
which makes it difficult to determine the location of a specific
organ and carry out the following pharmacokinetic analysis for
the organs of interest [3]. Structural priors (SPs) provided by a
secondary anatomical imaging system such as X-ray computed
tomography (XCT) can help to solve this problem. In a previous study, we have proposed to obtain the parametric images
of indocyanine green (ICG) in the mouse liver with a hybrid
FMT/XCT system using an indirect method, and SPs from the
XCT system were used to constrain the FMT inverse problem
and restrict the pharmacokinetic analysis in the specific organs
of interest [3]. To the best of our knowledge, however, direct
methods with SPs for imaging pharmacokinetic parameters in
dynamic FMT have not been reported. In this letter, we present a
method for direct reconstruction of parametric images based on
the Tikhonov regularization framework. The proposed method
combines the advantages of direct methods and SPs, and shows
significant improvements in the image quality as compared with
indirect methods.
II. METHODS
A. Conventional Indirect Methods
The indirect methods for imaging pharmacokinetic parameters are divided into two separate steps: FMT image
reconstruction and compartmental model fitting. In the first step,

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

the objective function of the FMT image xk ∈ RN in the time
frame k ∈ [1, K] can be given based on Tikhonov regularization
method as follows [5]:
Φ (xk ) = yk −

Wxk 22

+

λ Lxk 22

(2)

where Δt is the time interval between the consecutive time
frames.
  The two compartments are plasma and organs, and
xk ϕj denotes the total concentration of fluorophores in the
two compartments for voxel j at time frame k [1]. A and B are
the zero-time intercepts, which denote the initial concentration
of fluorophores. When the gain of the FMT system is unknown,
the pharmacokinetic parameters A and B have arbitrary unit
(a.u.) [3]. α and β (min−1 ) are the uptake and excretion rates of
fluorophores, which have physiological significance for quantitative evaluation of organ function [7].
B. Proposed Direct Method
The direct method proposed in this letter combines the FMT
image reconstruction and compartmental model fitting into a
single step. Let ϕ = {ϕj }, the objective function of the direct
method can be written as
K


yk − Wxk (ϕ)22 + λ Lxk (ϕ)22 .

K


yk − Wxk (ϕn ) − WΔxk 22

k =1

(1)

where λ is the regularization parameter, yk ∈ R is the boundary measurements in the time frame k, W ∈ RM ×N is the
weight matrix and each element wij represents the contribution of voxel j ∈ [1, M ] to the boundary measurement signal at
the source–detector pair i ∈ [1, N ], L is a Laplacian-type matrix which can be constructed based on the SPs provided by an
anatomical imaging system [6]. M and N are the total number
of the source–detector pairs and voxels, respectively.
Let ϕj = [Aj , Bj , αj , βj ]T denote the pharmacokinetic parameter vector for voxel j. In the second step, to obtain the
parametric images (A, B, α, and β) is treated as a nonlinear
least-squares (NLS) problem which fits each voxel in the FMT
images (K frames) to the bi-exponential solution of a twocompartment model as reported previously [1], [7]

Φ (ϕ) =

Φ (ϕ|ϕn ) =

+ λ Lxk (ϕn ) − LΔxk 22

M

 
xk ϕj = −Aj exp (−αj kΔt) + Bj exp (−βj kΔt)

987

(3)

k =1

After combing the two separate steps into one step, a nonlinear
mapping from the boundary measurements to the pharmacokinetic parameter vector is established in the direct method. By
optimizing the total objective function, the measurement noise
in different time frames can be compensated as a whole, and the
reconstruction quality is eventually improved [2], [4].
Because of the nonlinearity of the objective function (3), it is
difficult to implement analytical minimization. In this letter, an
iterative optimization method is presented for minimization. Let
ϕn be the pharmacokinetic parameter vector after nth iteration,
and then the objective function can be written as

= Φ (ϕn ) +

K


(gkn )T Δxk +(Δxk )T HΔxk (4)

k =1

where Δxk = xk (ϕ) − xk (ϕn ) denotes the FMT image
change due to the pharmacokinetic parameter vector change,
H denotes the curvature matrix, and gkn denotes the gradient
vector. They can be calculated by the following formulas:
H = WT W + λLT L


gkn = −2 WT yk − Hxk (ϕn ) .

(5)
(6)

In order to minimize the iterative objective function (4), a
voxel-wise coordinate decent (CD) algorithm is adopted [1], [4].
The voxels are individually updated by optimizing the objective
function with respect to the pharmacokinetic parameter vector
at each voxel. With all other voxels fixed, the CD update for ϕj
is given by
K

 
Φj ϕj |ϕn =
ĝjnk Δxj k + hj Δx2j k

(7)

k =1

 
 
where Δxj k = [Δxk ]j = xk ϕj − xk ϕnj , the curvature hj
and gradient ĝjnk with respect to xj k can be calculated by
hj = Hj j =

M


j −1


N


2
lsj

(8)

 


Hj l xk ϕnl +1 − xk (ϕnl ) .

(9)

i=1

ĝjnk = gjnk +

2
wij
+λ

s=1

l=1



Then, the minimization of Φj ϕj |ϕn in (7) with respect to
ϕj is equivalent to an NLS problem given by

K 

 
 n  ĝjnk 2
n +1
ϕj
= arg min
. (10)
xk ϕj − xk ϕj +
ϕj
2hj
k =1

The proposed direct method has several features which are
different from other direct methods [1], [2]. First, it incorporates
SPs into the reconstruction algorithm to improve the parametric
image quality. Second, it allows flexibly using different compartmental models for different SPs because of the voxel-wise
updated CD algorithm.
III. RESULTS
Numerical simulations and in vivo mouse experiments
were carried out to evaluate the performances of the proposed direct method (direct-SP), the indirect method with SPs
(indirect-SP), and the indirect method without SPs (indirectSP). For indirect-/SP, L was set to an identity matrix. Since the
liver is particularly an important organ for drug metabolism, the
three methods are used to image the pharmacokinetic parameters of ICG in the mouse liver, which are helpful for studying the liver function. In the direct method, the CD algorithm

988

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

Fig. 1. Numerical simulation settings. (a) 3-D Digimouse model used for
simulations. Different colors correspond to different metabolic regions (green:
liver; red: IRI region in liver; gray: other tissues). (b) ICG concentration curves
simulating the metabolic processes of ICG in the three regions. (c) Segmented
XCT slice indicated by the red line in (a). This slice and other slices were
segmented into two regions (white: liver; gray: other tissue) as the SPs used for
constructing the Laplacian-type matrix. (d)–(g) Setups of parametric images A
(a.u.), B (a.u.), α (min−1 ) and β (min−1 ) corresponding to the slice shown
in (c).
TABLE I
PHARMACOKINETIC PARAMETERS USED IN THE NUMERICAL SIMULATIONS

was implemented for 20 iterations. In the two indirect methods, the minimization in the first step was solved by the LSQR
algorithm with 100 iterations [8]. Compartmental model fitting in both the direct and indirect methods was performed
with the NLS fitting function (lsqnonlin) in MATLAB software
(MathWorks, Natick, MA, USA). The regularization parameter was set to λ = 0.001 ∗ tr(WT W) for numerical simulations and λ = 0.002 ∗ tr(WT W) for mouse experiments. All
reconstruction results were three-dimensional (3-D) parametric
images with the voxel size of 1 mm × 1 mm × 1 mm. A heterogeneous FMT forward model was constructed and used by
assigning the corresponding optical properties to the segmented
organs according to [3].
A. Numerical Simulations
In the numerical simulations, the Digimouse atlas [9] was
employed to construct a 3-D simulation model. The model
in Fig. 1(a) includes three different metabolic regions: liver,
ischemia-reperfusion injury (IRI) region (3 mm × 3 mm ×
3 mm) in the liver [7], and other tissues. Fig. 1(b) shows the ICG
concentration curves which mimic different metabolic processes
of ICG in the three regions. The ICG curves are obtained according to (2) and the corresponding pharmacokinetic parameters are
shown in Table I [3], [10]. Fig. 1(c) shows the segmented XCT
slice across the center of the IRI region. This slice and other
slices were segmented into the liver and other tissues, and the
IRI region cannot be seen in the XCT images. The segmentation
results were used to construct the Laplacian-type matrix used in
the indirect-SP and direct-SP methods. Fig. 1(d)–(g) show the
setups of parametric images A, B, α, and β corresponding to
the slice in Fig. 1(c).

Fig. 2. Parametric images A (a.u.), B (a.u.), α (min −1 ), and β (min −1 )
of the numerical simulations. These images were reconstructed from the noisy
measurements with SNR = 30 dB. They were the representative slice of the 3-D
reconstruction results, and corresponded to the slice shown in Fig. 1(d)–(g).

The numerical simulations were designed based on a hybrid
FMT/XCT system [3]. The ICG curves shown in Fig. 1(b) were
integrated for each frame to generate dynamic boundary measurements of the 3-D model. 60 frames with 1-min time intervals
were used to mimic a metabolic process of 60 min in the mouse.
Then, different intensities of zero-mean white Gaussian noise
were added to generate noisy measurements with SNR set as 40,
35, 30, 25, and 20 dB, respectively. The indirect and direct methods were implemented to process these noisy measurements and
obtain the parametric images. Fig. 2 shows the parametric images of the numerical simulations with SNR = 30 dB. It can be
seen that the indirect-/SP method cannot resolve the metabolic
processes of the liver and other tissues in the parametric images and obtains noisy results [see Fig. 2(a)–(d)]. Although the
indirect-SP method has obtained higher spatial resolution by
taking advantage of the SPs, it also suffers from noisy results
[see Fig. 2(e)–(h)]. In contrast, the direct-SP method obtains the
best results among the three methods. In order to quantitatively
evaluate the reconstruction quality, the normalized mean square
error (NMSE = ||u − û ||22 /||u ||22 , where u and û are the true
and reconstructed images, respectively) is used as the evaluation
metric. Fig. 3 shows the NMSE under the five different noise
levels for parametric images A, B, α, and β. It can be seen that
the NMSE in the reconstructed images increases as the measurement noise increases for the three methods. However, the
parametric images obtained with the direct method result in the
smallest NMSE as compared to the indirect methods. Besides,
the contrast-to-noise ratio (CNR) [5] was used to evaluate the
contrast of the IRI region to the liver. The direct-SP method also
obtains the highest contrasts (see Table II).
B. Mouse Experiments
Mouse experiments similar to [3] were conducted in vivo.
Briefly, a healthy BALB/c nude mouse (about 22 g) was
fixed on the rotation stage of a hybrid FMT/XCT system
and anesthetized during the experiments. A bolus of ICG
(0.1 mL, 50 μg/mL) was injected through the tail vein. Then,

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

Fig. 3. NMSE under different noise levels (SNR = 40, 35, 30, 25, 20 dB).
(a)–(d) NMSE for parametric images A, B, α, and β, respectively.
TABLE II
CNRS OF IRI REGION TO LIVER FOR NUMERICAL SIMULATIONS
(SNR = 30 dB)

Fig. 4. XCT results of the mouse experiments. (a) Coronal XCT slice.
(b) Transversal XCT slice indicated by the green-dashed line in (a). (c) Segmentation result for (b). All transversal XCT slices getting from the mouse torso in
(a) were manually segmented into two regions (white: liver; gray: other tissues)
as the SPs used for constructing the Laplacian-type matrix.

the mouse was rotated continuously for 100 circles (about
95 min) to monitor the metabolic process of ICG in the liver.
After collecting the fluorescence datasets, the XCT datasets
were collected to get the SPs of the mouse.
Fig. 4 shows the XCT results of the mouse. Fig. 4(a) is a
coronal XCT slice, and shows the region selected for 3-D FMT
reconstruction. Fig. 4(b) is a transversal XCT slice indicated
by the green-dashed line in Fig. 4(a). All transversal XCT
slices were manually segmented to the liver and other tissues.
Fig. 4(c) is the segmentation result for Fig. 1(b). The SPs were
used to construct the Laplacian-type matrix. Fig. 5 shows the
parametric images of the mouse experiments obtained with the
three methods. Since the pharmacokinetic parameters A and B
only have a.u. without knowing the gain of the FMT system, the
two parameters are normalized to the mean value of A. Since
α and β (min−1 ) are the rate constants for ICG influx to and
disappearance from the liver, they can be used to quantitatively
evaluate the liver function. Image α reflects the microcirculatory

989

Fig. 5. Parametric images A (a.u.), B (a.u.), α (min −1 ), and β (min −1 ) of
the mouse experiments. These images were the representative slice of the 3-D
reconstruction results, and corresponded to the slice shown in Fig. 4(c).
TABLE III
MEAN VALUES OF PHARMACOKINETIC PARAMETERS IN THE MOUSE LIVER

conditions of the liver, and image β reflects the cytoplasmic
transport and biliary excretion conditions of the liver [7].
Similar to the numerical simulations, it can be observed in
Fig. 5 that the direct-SP method obtains the best image quality.
The indirect-/SP method cannot obtain correct parametric
images without using the SPs [see Fig. 5(a)–(d)], while the
indirect-SP method obtains results with more noise than the
direct-SP method [Fig. 5(e)–(l)]. Table III shows the mean
values of the pharmacokinetic parameters in the mouse liver
for all the methods. A fiber-based fluorescence measurement
system has been previously used to invasively acquire the ICG
metabolic curves of mouse livers in the same experimental
conditions [3]. Among the three methods, the mean values of
the pharmacokinetic parameters obtained with the direct-SP
method are the most similar to that acquired by the fiber system
(see Table III).
IV. CONCLUSIONS AND DISCUSSIONS
In conclusion, a novel method for direct reconstruction of
parametric images has been proposed. The method combines
dynamic FMT image reconstruction and compartmental model
fitting into a single objective function to efficiently model the
measurement noise, and utilizes SPs provided by the XCT system to mitigate the ill-posedness of the FMT inverse problem.
Numerical simulations and mouse experiments have confirmed
the performance of the proposed direct method.
It should be noted that wrong SPs may reduce the performance
of the direct method; thus, the XCT images should be segmented
correctly. Besides, other performances of the direct method,
such as spatial resolution and depth sensitivity, should be further
systematically tested. Preliminary studies have shown that the

990

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

depth of IRI region has little influence on the performance of
the direct method.
REFERENCES
[1] A. B. Milstein, K. J. Webb, and C. A. Bouman, “Estimation of kinetic
model parameters in fluorescence optical diffusion tomography,” J. Opt.
Soc. Am. A, vol. 22, no. 7, pp. 1357–1368, 2005.
[2] B. Alacam and B. Yazici, “Direct reconstruction of pharmacokinetic-rate
images of optical fluorophores from NIR measurements,” IEEE Trans.
Med. Imag., vol. 28, no. 9, pp. 1337–1353, Sep. 2009.
[3] G. Zhang, F. Liu, B. Zhang, Y. He, J. Luo, and J. Bai, “Imaging of
pharmacokinetic rates of indocyanine green in mouse liver with a hybrid
fluorescence molecular tomography/x-ray computed tomography system,”
J. Biomed. Opt., vol. 18, no. 4, pp. 040505-1–040505-3, 2013.
[4] G. Wang and J. Qi, “Generalized algorithms for direct reconstruction of
parametric images from dynamic PET data,” IEEE Trans. Med. Imag.,
vol. 28, no. 11, pp. 1717–1726, Nov. 2009.
[5] G. Zhang, X. Cao, B. Zhang, F. Liu, J. Luo, and J. Bai, “MAP estimation
with structural priors for fluorescence molecular tomography,” Phys. Med.
Biol., vol. 58, no. 2, pp. 351–372, 2013.

[6] S. C. Davis, H. Dehghani, J. Wang, S. Jiang, B. W. Pogue, and
K. D. Paulsen, “Image-guided diffuse optical fluorescence tomography
implemented with Laplacian-type regularization,” Opt. Exp., vol. 15, no. 7,
pp. 4066–4082, 2007.
[7] H. Shinohara, A. Tanaka, T. Kitai, N. Yanabu, T. Inomoto, S. Satoh,
E. Hatano, Y. Yamaoka, and K. Hirao, “Direct measurement of hepatic
indocyanine green clearance with near-infrared spectroscopy: Separate
evaluation of uptake and removal,” Hepatology, vol. 23, pp. 137–144,
1996.
[8] C. C. Paige and M. A. Saunders, “LSQR: An algorithm for sparse linear
equations and sparse least squares,” ACM Trans. Math. Softw., vol. 8,
no. 1, pp. 43–71, 1982.
[9] B. Dogdas, D. Stout, A. F. Chatziioannou, and R. M. Leahy, “Digimouse:
A 3D whole body mouse atlas from CT and cryosection data,” Phys. Med.
Biol., vol. 52, pp. 577–587, 2007.
[10] E. M. C. Hillman and A. Moore, “All-optical anatomical co-registration
for molecular imaging of small animals using dynamic contrast,” Nat.
Photon., vol. 1, pp. 526–530, 2007.

