IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

2125

Semisupervised ECG Ventricular Beat Classification
With Novelty Detection Based on Switching
Kalman Filters
Julien Oster‚àó , Joachim Behar, Omid Sayadi, Shamim Nemati, Alistair E. W. Johnson,
and Gari D. Clifford, Senior Member, IEEE

Abstract‚ÄîAutomatic processing and accurate diagnosis of
pathological electrocardiogram (ECG) signals remains a challenge.
As long-term ECG recordings continue to increase in prevalence,
driven partly by the ease of remote monitoring technology usage,
the need to automate ECG analysis continues to grow. In previous
studies, a model-based ECG filtering approach to ECG data from
healthy subjects has been applied to facilitate accurate online filtering and analysis of physiological signals. We propose an extension
of this approach, which models not only normal and ventricular
heartbeats, but also morphologies not previously encountered. A
switching Kalman filter approach is introduced to enable the automatic selection of the most likely mode (beat type), while simultaneously filtering the signal using appropriate prior knowledge.
Novelty detection is also made possible by incorporating a third
mode for the detection of unknown (not previously observed) morphologies, and denoted as X-factor. This new approach is compared
to state-of-the-art techniques for the ventricular heartbeat classification in the MIT-BIH arrhythmia and Incart databases. F1 scores
of 98.3% and 99.5% were found on each database, respectively,
which are superior to other published algorithms‚Äô results reported
on the same databases. Only 3% of all the beats were discarded
as X-factor, and the majority of these beats contained high levels of noise. The proposed technique demonstrates accurate beat
classification in the presence of previously unseen (and unlearned)
morphologies and noise, and provides an automated method for
morphological analysis of arbitrary (unknown) ECG leads.
Index Terms‚ÄîElectrocardiogram, heartbeat classification,
switching Kalman filter.

I. INTRODUCTION

E

LECTROCARDIOGRAM (ECG) analysis is routinely
used in clinical practice for the diagnosis of cardiovascular

Manuscript received September 2, 2014; revised December 31, 2014; accepted January 30, 2015. Date of publication February 10, 2015; date of
current version August 18, 2015. The work of J. Oster was supported
by the Royal Academy of Engineering under a Newton Fellowship Grant
793/914/N/K/EST/DD PF/tkg/4004642 and the Wellcome Trust under Grant
098461/Z/12/Z for the University of Oxford Sleep and Circadian Neuroscience
Institute. The work of J. Behar was supported by the U.K. Engineering and
Physical Sciences Research Council, the Balliol French Anderson Scholarship
Fund and MindChild Medical Inc., North Andover, MA, USA. The work of
A. E. W. Johnson was supported by the RCUK Digital Economy Programme
under Grant EP/G036861/1 (Oxford Centre for Doctoral Training in Healthcare
Innovation). Asterisk indicates corresponding author.
‚àó J. Oster is with the Intelligent Patient Monitoring Group, Institute of Biomedical Engineering, Department of Engineering Science, University of Oxford,
Oxford OX1 2JD, U.K. (e-mail: julien.oster@eng.ox.ac.uk).
J. Behar and A. E. W. Johnson are with the University of Oxford.
O. Sayadi and S. Nemati are with the Harvard University.
G. D. Clifford is with the University of Oxford and is also with the Emory
University and the Georgia Institute of Technology.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2402236

diseases. It is the standard method used for detection of arrhythmias, which manifest as an irregularity in the heart rate or in
the origin/conduction of the cardiac electrical activity. A particular case of abnormal conduction is the premature ventricular
contraction (PVC), which corresponds to an early contraction
of the heart muscle initiated in the ventricle by spontaneous
repolarization of ventricle cells (ectopic focus) or by reentrant
signaling. A PVC therefore generates a different ECG morphology than a normal heart beat (which originates in the sinoatrial
node). PVCs are usually followed by a compensatory pause, a
step change increase in the heart rate and a subsequent rapid
return to the baseline heart rate. This effect is often known by
the misnomer ‚Äúheart rate turbulence‚Äù (HRT). The quantification
of this effect can be informative in terms of patient outcome
postmyocardial infarction and for patients with cardiovascular
disease [1], [2]. However, such metrics require extremely accurate identification of PVCs with the ability to reject noise, which
is not associated with HRT-like changes.
Development of accurate automated ECG analysis techniques
has been a challenge for many decades, with several excellent
proposals for automatic beat classification appearing over the
last decade in particular [3]‚Äì[8]. Most of these methods approach the problem from the supervised machine learning perspective, optimizing features extracted from a patient cohort‚Äôs
ECGs to train a static classifier. These features can be divided
in two categories: 1) those based on the ECG morphology, and
2) those based on the cardiac rhythm or interbeat intervals.
Many software-based Holter monitoring algorithms allow the
electrophysiologist or lab technician to overread beats clustered
together into unsupervised groups and assign a label to each
group. Llamedo and Martƒ±ÃÅnez [8] recently described a beat classifier which automatically clustered heartbeats and requested
expert labeling of the output clusters by a trained cardiologist.
This is a form of semisupervised learning, where both unsupervised techniques (i.e., beat clustering) are combined with
supervised techniques (i.e., classification of clusters using expert assistance). They demonstrated that such an approach can
improve the accuracy of the classification task from 94% to 98%
[8]. In parallel to this, a model-based ECG framework, which
employed an extended Kalman filter (EKF), was proposed by
Sameni et al. [9]. This technique relies on the fact that the ECG
dynamics can be modeled with a sum of Gaussians [10]. This
technique has been successfully applied to signal denoising [9],
[11], [12], the delineation of the QT interval [13]‚Äì[15], and the
detection of PVCs [5]. Sayadi et al.‚Äôs [5] approach leverages

0018-9294 ¬© 2015 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2126

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

the fact that Bayesian filtering allows not only the estimation
of a hidden variable, but also provides the uncertainty of this
estimate. By tracking the value of the innovation, which corresponds approximately to the level of accordance between the
model and the measurements, the authors were able to detect
and filter beats whose morphology differ from the model of a
normal beat [5], [11], [12].
The EKF is limited by its ability to track only one morphology.
It is nevertheless common, especially for pathological cases, that
the ECG signal contains multiple heartbeat morphologies. In this
paper, a novel technique is introduced in order to track multiple
morphologies, by taking advantage of a switching state-space
modeling approach [16], [17]. For each recording, clusters of
heartbeat morphologies are built and manually annotated by a
cardiologist. The recording is then simultaneously processed,
filtered and each heartbeat automatically assigned to a cluster.
The assignment to a cluster consequently classifies the beat as
‚Äúnormal‚Äù (really nonventricular) or ventricular (the two possible
categories of beat types considered in this study). The proposed
technique thus facilitates simultaneous denoising of ECG signals, with proper prior knowledge for most of the heartbeats,
and ventricular beat identification.
The morphological analysis of the heartbeats and their clustering is a delicate process and a few percent of the heartbeats
are difficult to assign to a cluster. This is primarily caused by:
1) some heartbeat morphologies are rare and thus too infrequent to generate an independent cluster, 2) physiological signals can be highly distorted by the presence of noise, making
it almost impossible to perform a morphological analysis of
such contaminated heartbeats. It is therefore important to allow the technique to detect novel or ‚Äúunknown‚Äù heartbeat morphologies in order to automatically detect these ‚Äúunclusterable‚Äù
or unclassified events. The need for a mode corresponding to
novel beats further motivates the use of a switching state-space
model technique [18], [19]. The novel mode is referred to as the
‚ÄúX-factor,‚Äù and was initially suggested by Quinn et al. for monitoring physiological states [20]. With the growing use of long
term continuous monitoring ECG recordings, it is increasingly
important for techniques to incorporate an uncertainty estimate,
since the noise profile of real world data is in stark contrast to
controlled laboratory experiments. Given the deluge of data, it
becomes more reasonable to exclude questionable data rather
than attempt a poor classification. This is particularly useful in
environments such as the intensive care unit, where poor classifications lead to high numbers of false alarms which are routinely
ignored due to alarm fatigue.
II. THEORY
A. Model-Based ECG Filter
The ECG signal can be modeled as a pseudoperiodic signal,
each cycle being represented by a sum of Gaussians [10]. It
has been shown that the use of seven Gaussians, the first two
representing the P wave, the next three the QRS complex and
the last two the T wave, allows for an accurate representation of
the ECG signal [5]. As introduced by McSharry et al. [10] and
simplified by Sameni et al. by using cylindrical coordinates in

[9], the ECG signal ,zk , can be modeled by
‚éß
Œ∏k = (Œ∏k ‚àí1 + œâŒ¥) mod 2œÄ
‚é™
‚é™
‚é®
7

œâŒîŒ∏i,k ‚àí1
‚é™
‚é™
z
=
z
‚àí
Œ¥
G (Œ±i , ŒîŒ∏i,k ‚àí1 , bi ) + Œ∑
k
k
‚àí1
‚é©
b2i
i=1

(1)

where Œ∏k is the angular position in the cardiac cycle , œâ =
2œÄ/RR the angular speed, RR being the length of the heart
cycle, Œ¥ the sampling period. zk represents the ECG value
in mV at time index k and Œ±i , bi , Œæi are the amplitude,
width and angular position of the ith Gaussian, respectively,
with ŒîŒ∏i,k ‚àí1 = (Œ∏k ‚àí1 ‚àí Œæi ) mod 2œÄ and with G(m, n, o) =
m exp(‚àín2 /(2o2 )) a Gaussian wave.
The denoising of the ECG signal is then performed by nonlinear Bayesian filtering. The Gaussian parameters of the underlying model are initialized by building an average beat template
and then performing a nonlinear optimisation of the sum of
Gaussian waves. A state-space formalism is thus required, and
the equations described by Sayadi et al. were used in this study
[5].
The state variables are defined as xk = [Œ∏k , pk , ck , tk ], where
p, c and t represent the P wave, the QRS complex and the
T wave, respectively. The observed signals are denoted yk =
[sk , œïk ], where sk is the observed ECG signal and œïk is an
artificial phase signal, which linearly increases from ‚àíœÄ to œÄ
between two consecutive R waves. Each major wave of the ECG
signal is represented in the state vector, and the denoised ECG
signal (zk ) is then given by the sum of the three components
zk = pk + ck + tk .
B. Switching Kalman Filter (SKF)
The approach of model-based filtering has been shown to be
powerful for healthy subjects and a measure of concordance
between the observations and the model has been introduced
for the detection of PVCs [5]. However, when processing ECG
signals with pathological rhythms (e.g., bi or trigeminy), the
approach as presented is not suitable. This is because the model
acts as a strong prior on the signal, and this prior is incorrectly
defined for many heartbeats during such rhythms. This problem
has been encountered previously in biomedical applications and
physiological condition monitoring [20]. SKFs have been proposed to solve this problem, where a random signal can be
approximated by different state-space formalisms depending on
its mode [17]. This allows for multiple competing models of
a heartbeats‚Äô morphology: representing a normal beat, ventricular beats and one unknown. The model which is most likely
is the one that fits the observed heartbeat best. We then denote
a mode as a specific state-space formalism with a given set of
parameters of the cardiac cycle dynamical model.
Let us call H (i) the observation matrix of the ith mode such
(i)
(i)
that yk = H (i) √ó xk + vk , where yk are the measurements,
(i)
(i)
xk is the hidden state vector and vk is the observation noise.
(i)
(i)
Let us further denote Rk = cov(vk ) as the covariance of the
(i)
observation noise. The innovation at time k is denoted yÃÉk =
(i)
(i)
(i)
yk ‚àí H (i) √ó xÃÇk |k ‚àí1 , with xÃÇk |k ‚àí1 being the estimate of the

OSTER et al.: SEMISUPERVISED ECG VENTRICULAR BEAT CLASSIFICATION WITH NOVELTY DETECTION

hidden state at time k given the k ‚àí 1 first measurements. The
(i)
covariance of the innovation RŒµ can be computed as
(i)
RŒµ,k
(i)

=

(i)
Rk

+H

(i)


(i)
P(k |k ‚àí1) H (i)

(2)

(i)

with P(k |k ‚àí1) = cov(xÃÇk |k ‚àí1 ) being the prior state covariance
matrix, which is computed step by step during the Kalman filter
procedure. The residual likelihood for this mode is then given
by
lk (i) =

1
1 (i)  (i) ‚àí1 (i)
1

exp(‚àí yÃÉk RŒµ,k yÃÉk )
(i)
Œ± 2œÄ det(R )
2

(3)

Œµ,k

with
 Œ± being a normalization factor which ensures that
i lk (i) = 1. Monitoring this likelihood function for each
modes allows the system to chose the mode which better explains the observations.
C. X-Factor
The SKF framework is well-suited for situations where the
model for each mode is known or can be initialized. However, as
discussed earlier, it is important to allow the technique to adapt
to novel situations, i.e., allowing the SKF to detect heartbeats
whose morphologies are not recognized. In practice, it is infeasible to cluster certain heartbeats either due to their rarity or
due to the amount of noise distorting the apparent morphology.
The technique proposed in this study deals with this novelty
detection through the addition of a mode as proposed by Quinn
et al. [20]: called the X-factor.
In this study, a similar approach was adopted by considering
the process of ECG filtering as a tracking problem, where the
ECG amplitude value is considered to be a point whose position
(or value in mV ) is tracked. The new ECG position is dependent
on its previous position and speed, where the speed (or slope
of the amplitude value) is assumed to follow a simple random
walk. The state-space formalism can then be written as follows:
1) evolution equations
‚éß
‚é™
‚é® zk = zk ‚àí1 + dk ‚àí1 + ŒΩ1,k
fs
(4)
‚é™
‚é©
dk = dk ‚àí1 + ŒΩ2,k
with fs being the sampling frequency, zk being the position of
the target,1 dk being the speed of the target and ŒΩk being the
state noise.
2) observation equations
	
sk = zk + v1,k
(5)
with sk being the observed signal (ECG) and v1,k the observation noise.
Therefore, the X-factor is a mode for which no assumptions
are made concerning the morphology of the beat apart from
its continuity. If the SKF finds that this mode is most likely to
describe the morphology of a given heartbeat, it is clearly sufficiently different from the expected morphologies of ventricular
and normal heart beats, and is classified as an X-factor beat.
1z

is consistently used to refer to the estimated ECG amplitude in mV for
both the ECG model-based mode and X-factor mode.
k

2127

III. MATERIALS AND METHOD
A. Data
As for any technique based on the Kalman filter, its efficacy
is highly dependent on a number of parameters and their values.
These parameters are in most cases defined by the architect. The
setting of the parameters should be performed on a training set,
independently from the test set, and results should be reported
on this unseen test set.
For this study, the same methodology as described in Llamedo
and Martƒ±ÃÅnez [6] was followed, since their results are the stateof-the-art, they followed the aforementioned (correct) train/test
paradigm and the databases they used are the most relevant for
this study. The MIT-BIH arrhythmia database was divided in two
sets, DS1 for training and DS2 for testing. The Incart 12-lead
arrhythmia database was used as an independent validation set to
study the exportability of the method on a set of data collected
under different conditions and in a different population. All
parameter and model optimization was performed exclusively
on the training set DS1.
1) MIT-BIH Arrhythmia Database: The MIT-BIH arrhythmia database consists of 48 recordings which last 30 min. The
ECG signals are sampled at 360 Hz and each recording contains two leads. This database contains approximately 100 000
annotated beats.
The MIT-BIH database was split into two sets: one for training
(DS1) and one for testing (DS2) as per Llamedo and Martƒ±ÃÅnez
[6].2 The four recordings with paced beats were omitted as has
been previously done [6], [21]. This division of the data was
chosen to balance the frequency of beat types and subjects in
the two subsets (See Section III-A3).
2) Incart 12-Lead Arrhythmia Database: The Incart
database contains 75 recordings of 12-lead ECG signals, each
lasting 30 min. These signals were initially sampled at 257 Hz
but were resampled at 360 Hz. This database contains more than
175 000 beat annotations which were automatically detected and
then manually corrected by experts. The records were collected
from patients undergoing tests for coronary artery diseases and
with consistent heart abnormalities (such as ischemia, conduction abnormalities and arrhythmias). This study was restricted
to two leads (II and V1) as in [6].
3) Annotations: The reference annotations are available
from Physionet [22]. The class labeling used in [6] was adopted.
Supraventricular beats were considered to be normal beats for
the purpose of this work, since they do not exhibit significant
morphological differences with normal beats and do not lead
to a large hemodynamic change such as HRT. Limitations to
this approach and possible improvements will be discussed in
Section V. The fusion (F) and ventricular (V) beat classes were
initially merged as in [6], with the merged class being named
V‚Äô. The reason for this stems from the fact that ‚ÄúF‚Äù beats are rare
events and therefore underrepresented in both the MIT-BIH arrhythmia database and Incart database. In order to have a deeper
2 DS1 contains recordings 101, 106, 108, 109, 112, 114, 115, 116, 118, 119,
and 122 and DS2 contains recordings 124, 201, 203, 205, 207, 208, 209, 215,
220, 223, and 230.

2128

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

TABLE I
BEAT CLASS DISTRIBUTION OF THE TRAINING AND TESTING SETS
V‚Äô
Database
MIT-BIH arrhythmia (DS1)
MIT-BIH arrhythmia (DS2)
Incart

N‚Äô

V

F

Q

46810
46096
155635

4261
3221
20011

414
388
219

8
7
6

understanding of the behavior on the F beats, we also considered
the V and F beats separately.
Three different beat classes were thus considered in this study,
the normal and supraventricular beats denoted by N‚Äô, the aggregation of the fusion (F) and ventricular (V) beats denoted V‚Äô
and finally the questionable (unclassifiable) beats, denoted Q.
The beat class distributions of the different databases are given
in Table I.
B. Method
1) Preprocessing: We used a previously published signal
quality index (SQI) to evaluate the level of noise for a given
segment of the ECG [23]. This algorithm is based on the fusion
of several objective signal features by means of a support vector
machine (SVM). The SVM output, which ranges between zero
to one can be interpreted as a scale of poor to excellent signal quality, respectively. Six basic quality features were used in
this approach, ranging from the comparison of two peak detectors (bSQI, rSQI) and statistical moments (kurtosis; kSQI, and
skewness; sSQI) to features based on the spectral content of the
signal (pSQI). The SQI metric was found to be 99% accurate.
The readers are referred to the original paper for further details
on the SQI estimation. The SQI was utilized in the initialization of the Gaussian parameters for each mode. Poor quality
heartbeats, as defined by an SQI < tS Q I , were discarded when
computing the average template of a heartbeat mode.
Finally, the ECG signal was preprocessed with a simple baseline wander suppression filter, consisting of a second order Butterworth high-pass filter with a 0.5-Hz cutoff frequency.
2) Gaussian Parameter Initialization: As explained in the
Section II-A, the ECG model-based Bayesian filtering approach
relies on parameters of the Gaussian waves (which define
the morphology of a typical heart cycle). Therefore, the first
step in the modeling method consists of the initialization of
these parameters. In the following section, the procedure for
the semiautomatic initialization of the Gaussian parameters is
described.
First, the initialization procedure was run simultaneously but
independently on all of the used leads of the ECG signal. A
peak detector could be used to identify and segment the beats,
which could then be used to form an average template beat. In
this study, the reference annotation positions given with each
database were used rather than those derived from a peak detector, in order to avoid accounting for the variable quality
of a specific R-peak detector on the beat classification accuracy. The ECG signal was segmented around the R-peak. This

segmentation was performed by mapping the RR intervals to
a cyclic phase as described in [9]. However, in this study, we
modified the phase so as to shift the R peak location to ‚àíœÄ/3
radians. This shift allowed the T wave to be fully included in
one cyclic phase, even during large RR variability. Each cycle
was then segmented from ‚àíœÄ to œÄ rad.
Each heart beat, with an SQI over a given threshold, tS Q I , was
then compared to the mean heart cycle using cross correlation. If
this value was over a given threshold, tc , then the heart beat was
added to the dominant class. If the heart-cycle was not attributed
to the existing class, then a new class containing only this cycle
was created. Subsequent cross correlations are then performed
on both beat types. If the cross correlation was not above tc for
either of the two new groups, then the beat was put in a third
class. This process continues for all beats.
At the end of this step, the ECG signal beats have been assembled into different clusters. Only the relevant modes are kept for
the estimation of the Gaussian parameters. The relevant modes
are determined by counting the number of cycles in each cluster,
and keeping only the clusters with more than tr cycles.
For each relevant class, the Gaussian parameters are estimated
by performing a nonlinear fitting of seven Gaussian functions
over the set of all the cycles contained in one class [13]. The
nonlinear fitting procedure requires some initial values for each
parameter. The quality of the fit will depend on these parameters,
and more specifically the initial position of the center of each
Gaussian. These values were randomly set over the segment
{‚àíœÄ, œÄ}, and the procedure was repeated up to maxi times if
the error between the Gaussian-based function and the mean of
the cycles was greater than 5%.
At this stage, the Gaussian parameters were estimated for
each class. In order to perform the classification of the beats,
each class needed to be identified as normal or ventricular. The
application relies on the cardiologist or local expert to interpret
the type of each cluster, although automated approaches could
be possible. For instance, a beat classifier based on features such
as QRS width could be used [8].
Finally, in order to minimize the number of modes, each
average cycle (which was a sum of Gaussian functions) was
compared to the typical cycle of the other classes. Clusters are
merged if two classes have a normalized cross correlation greater
than a threshold tc1 .
As was explained previously, the Gaussian parameter initialization relies on a number of parameters:
{tc , tc1 , tS Q I , tr , maxi }. These parameters need to be set in
an optimal way. The training set has been used for performing a
random search as described by Bergstra and Bengio [24], which
has been applied in biomedical signal processing for fetal ECG
extraction [25]. Instead of performing an extensive grid search
to find optimal parameters, it was demonstrated that performing
a random sampling over the parameter space can yield the similar degree of optimization but at a lower computational cost.
The sampling of the parameters was performed as indicated in
Table II.
3) SKF: Once the number of modes, n, and the Gaussian
parameters for each mode have been estimated it is possible
to run the SKF. As explained in the Section II-B, the mode

OSTER et al.: SEMISUPERVISED ECG VENTRICULAR BEAT CLASSIFICATION WITH NOVELTY DETECTION

2129

TABLE II
RANGE FOR THE RANDOM SEARCH OF THE PARAMETERS AND THE OPTIMAL VALUE FOUND FOR BOTH THE GAUSSIAN PARAMETER INITIALIZATION
STEP AND THE SKF PARAMETERS
Gaussian Parameter Initialization

SKF Parameters

P

tc

tc 1

tS Q I

tr

m ax i

œÉŒ∏

qG

qp

qo

rp

re

qx

R
O

U(0.5, 1)
0.92

U(0.5, 1)
0.93

U(‚àí0.1, 1)
‚àí0.004

U(10, 80)
25

U(10, 80)
26

U(œÄ , 2œÄ )
5.32

10 U( ‚àí3 , 3 )
0.46

10 U( ‚àí3 , 3 )
65.0

10 U( ‚àí3 , 3 )
0.01

10 U( ‚àí3 , 3 )
0.02

10 U( ‚àí3 , 3 )
9.50

10 U( ‚àí2 , 2 )
0.25

where U(a, b) represents an uniform distribution between a and b. (P: parameter name, R: range and O: optimal value)

classification can be performed by estimating the residual
likelihood lk (i), and selecting the mode having the highest
likelihood.
In general applications, an SKF allows for the switching of
modes at every new sample. This feature is not desirable in
this application, since the ECG mode is a slow varying process
when compared to the sampling frequency (i.e., a heart beat
spans many samples). The switching to another mode should
therefore only occur at the beginning of a new cycle, which can
be detected from the phase signal as it transits from œÄ to ‚àíœÄ.
In order to improve the quality of the classification, the average residual likelihood of all estimations from each sample in
the full cycle was used. As there is more information around the
peak, it is also of interest to use a window which emphasises
the importance of the residual likelihood in the neighbourhood
of the peak. A Gaussian window centred around the peak was
used to accomplish this. We thus define the cycle likelihood for
the ith mode, denoted by lC (i), as follows:


C

k2

l (i) =
k1



œïk ‚àí œÄ/3 2
exp (
)
œÉŒ∏


√ó lk (i)dk

(6)

where œï is the artificial observed phase signal, k1 is the sample
such that œïk 1 = ‚àíœÄ and k2 defined such that œïk 2 = œÄ, and œÉŒ∏
is a parameter defining the width of an exponential window.
As with every Kalman filter application, the quality of the
filtering is highly dependant on a set of parameters, and in particular the process covariance noise matrix Q and the observation noise covariance matrix R. Each matrix represents the level
of trust in the evolution equation for Q and in the observation
equation for R.
Let us define the covariance matrices for the ECG modelbased Bayesian filtering. The state noise is defined by
{Œ±i,k , Œæi,k , bi,k , œâ, Œ∑P , Œ∑C , Œ∑T } as described by Sayadi et al. in
[5], and its covariance matrix is a diagonal matrix defined as


2
, (qo esd )2 , (qo esd /2)2 Œπ2
Q = diag qG Œπ7 , 0.5qG Œπ14 , qp wsd
where Œπn is a n √ó n identity matrix, wsd is the standard deviation
of the heart rate over the recording, and esd is the standard deviation of the heart cycle computed during the Gaussian parameter
initialization. qG , qo and qp are three parameters that need to be
tuned. The observation noise is defined by {v1,k , v2,k }, and its
covariance matrix is given by


R = diag rp (w/fs )2 /12, re e2sd

where w is the mean of the heart rate over the entire length of
the signal, fs is the sampling frequency and rp and re are two
parameters that need to be adjusted for setting the uncertainty
on the observation of the phase and ECG signals, respectively.
The covariance matrices for the X-factor model also need
to be defined. The state noise for the X-factor is defined by
{ŒΩ1,k , ŒΩ2,k }, and its covariance matrix is given by


QX = diag qx e2sd , qx2 e2sd
where qx is a parameter that needs to be set. Finally, the observation covariance matrix is a simple scalar and can be defined similarly to the observation covariance matrix for the ECG
model; that is RX = [re e2sd ].
As in the previous section, the optimal parameters need to
be identified, and this optimization was again performed with
a random search with the parameters sampled as indicated in
Table II.
4) Extension to Multiple Lead Recordings: The model can
be easily extended to multiple lead recordings. This was accomplished by adding parameters to the observation vector, which
represent each new lead: These parameters are given by œïk resulting in a variable size observation vector [œïk , s1k , s2k ]. Second,
the latent state for each lead would be added in the state vector
giving [Œ∏k , p1k , c1k , t1k , p2k , c2k , t2k ], with the superscript indicating
the lead number. The fusion of beat classifications for multiple
leads was then naturally handled by the SKF framework. Obviously, this can be extended to any number of leads, but was here
restricted to two leads for a fair comparison to other state-ofthe-art techniques. Fig. 1 presents a flowchart of the proposed
method and the various steps involved.
5) Evaluation of the Different Random Searches: Two random searches were performed consecutively; one for optimizing
the SKF parameters and the second one for the optimization of
parameters for the Gaussian parameter initialization. First, the
parameters for the Gaussian parameter initialization were manually picked and were {tc = 0.96, tc1 = 0.81, tS Q I = ‚àí1, tr =
20, maxi = 50}. These parameters were manually picked such
that a limited number of modes per record were created and
so the morphology of each template was well estimated by the
Gaussian functions. The first random search was then performed
on the first lead of the signals in DS1 as the mean SQI for this
lead was higher. Once the best parameters for the SKF were
found, the second random search was performed in order to optimize the Gaussian parameters {tc , tc1 , tS Q I , tr , maxi }. This
optimization was performed on both leads of the signals in DS1.

2130

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Fig. 1. Logic flow of the proposed method. The original ECG signals are depicted on the left. The beats are then clustered, and the Gaussian parameters for the
relevant modes are initialized. At this point the expert can assign a class to each mode. The original signals are then filtered using the Bayesian approach and the
prior knowledge (encoded as the sum of Gaussians model). The output of the method (right) is the filtered signal and beat classification. An example of V beat
detection and of X-factor beat detection are circled in red. This procedure is performed for each new recording.

In order to evaluate the quality of the parameters, we decided
to assess the classification of the heartbeats. Each heartbeat was
compared to the mode assigned by the SKF in order to build the
confusion matrix. Heartbeats assigned to normal mode were denoted n, those assigned to a ventricular beat mode were denoted
v, and finally beats assigned an X-factor mode were considered
to be part of class q. As the main application of this study is
the tracking of ventricular arrhythmias, we considered V‚Äôv to
be true positives (TP), V‚Äôn false negatives (FN) and N‚Äôv false
positives (FP). Beats belonging to both classes N‚Äôq and V‚Äôq are
generally harder to classify. These beats are not incorrectly classified, and yet may have a morphology which is not recognised
by the SKF even though it is expected to be so. We therefore
considered the beats belonging to the class Nq as pseudo
false positives (PFP) and beats from Vq as being pseudo false
negatives (PFN). In order to compare the results derived from a
different set of parameters, we defined a metric that considered
the difference between FN and PFN, with the latter carrying
a lower penalty than the former. This metric was inspired from
the F1 score, which is the harmonic mean of the sensitivity
(Se) and positive predictive value (+P ), and is given by
F1 =

2T P
.
2T P + F N + F P

(7)

Here, FP and FN are equally weighted. The new score JŒ± is
given by
JŒ± =

2(Œ± + 1)T P
(8)
2(Œ± + 1)T P + Œ±(F N + F P ) + (P F N + P F P )

where Œ± controls the relative weighting of pseudo incorrect
classifications due to the X-factor. We have set Œ± to 10 so that
a real FP or FN is penalized ten times as much as having a beat
classified as belonging to the X-factor cluster. Nevertheless, the
score still penalizes X-factor classifications to ensure that all
beats are not considered as belonging to this mode.
C. Quality Assessment
The method was assessed with respect to the performance
of ventricular heartbeat classification. Confusion matrices were
created for the SKF approach on both test sets (DS2 of the MITBIH arrhythmia database and the Incart database). The proposed
SKF approach was compared to state-of-the-art beat classifica-

tion techniques described by Chazal et al. [3], Llamedo and
Martƒ±ÃÅnez [6], and the two techniques described by Llamedo and
Martƒ±ÃÅnez in [8]. The first of the two techniques in this latter
study is a semisupervised approach with an expert annotating
12 clusters of heartbeats for each record denoted as assisted
[8]. The second uses the same clustering technique, but in a
fully automatic manner, and is denoted automatic [8]. Note that
the training for techniques presented in [8] was performed on
a much larger dataset, which included the records in DS1 and
the MIT-BIH supraventricular arrhythmia database [22], which
should provide an advantage to these methods. Although these
techniques provide complete heartbeat classification, we have
only considered their capability of ventricular beat classification, in order to compare with the SKF approach presented in
this study.
The proposed technique detection of ventricular beats was assessed using the sensitivity (Se) and positive predictivity (+P )
as suggested in [21], but also in terms of F1 (which is the harmonic mean of Se and +P , and penalizes FP and FN equally).
The advantage of the proposed technique is that it offers an
automatic rejection of noisy heartbeats or unknown morphologies. Therefore, in a first instance, the heartbeat classification
will not consider the heartbeats classified as X-factor. Nevertheless, in order to compare the classification ability of the SKF,
the technique was run again, without incorporating the X-factor
possibility, and using the parameters found during the random
search procedure. By doing so, the SKF approach was forced to
classify all beats. As the clustering was not designed to necessarily label all beat morphologies (or do a partitioning of the data),
since rare events or noisy data were represented by X-factor,
the results were expected to be lower. The SKF was then run
gain without considering the X-factor on the DS2 by lowering
tr = 10, so that more modes were created.
It is important to understand and interpret the X-factor class.
From observation, we suggest that this class corresponds mainly
to noise contaminated beats which prohibit morphological analysis of this beat. The signal quality of these X-factor beats was
therefore manually annotated. 954 5-s segments containing all
the beats classified as X-factor in the DS2 dataset were annotated for signal quality as described in [26]. An automatic
evaluation of signal quality was also calculated using the technique detailed in [23]. The statistics of the automated SQI for

OSTER et al.: SEMISUPERVISED ECG VENTRICULAR BEAT CLASSIFICATION WITH NOVELTY DETECTION

TABLE III
RESULTS ON DS2 (MIT-BIH ARRHYTHMIA DATABASE)

TABLE V
RESULTS ON THE INCART DATABASE

V‚Äô Classification (Without F Class)

V‚Äô Classification (Without F Class)

With X-Factor

N‚Äô
V‚Äô

With X-Factor

No X-Factor

n‚Äô

v‚Äô

q

n‚Äô

v‚Äô

45096 ¬± 46
282 ¬± 22

1 ¬±1
2681 ¬± 24

999 ¬± 46
656 ¬± 24

45979 ¬± 47
447 ¬± 33

117 ¬± 47
3161 ¬± 33

N‚Äô
V‚Äô

No X-Factor

n‚Äô

v‚Äô

q

n

v‚Äô

152906 ¬± 87
246 ¬± 22

25 ¬± 9
17101 ¬± 150

2699 ¬± 93
2883 ¬± 133

155490 ¬± 24
1058 ¬± 15

142 ¬± 24
19172 ¬± 15

V Classification (With F Class)

V Classification (With F Class)
With X-Factor

N‚Äô
V
F

2131

With X-Factor

No X-Factor

n‚Äô

v

q

n‚Äô

v

45096 ¬± 46
70 ¬± 6
202 ¬± 20

1 ¬±1
2523 ¬± 21
158 ¬± 19

999 ¬± 46
628 ¬± 23
28 ¬± 5

45979 ¬± 47
234 ¬± 21
214 ¬± 19

117 ¬± 47
2987 ¬± 21
174 ¬± 19

N‚Äô
V
F

n‚Äô

v

q

n

v

152906 ¬± 87
168 ¬± 22
78 ¬± 3

25 ¬± 9
17033 ¬± 150
68 ¬± 1

2699 ¬± 93
2810 ¬± 134
73 ¬± 2

155490 ¬± 24
929 ¬± 14
129 ¬± 1

142 ¬± 24
19082 ¬± 14
90 ¬± 1

TABLE IV
SCORES OBTAINED ON THE DS2 (MIT-BIH ARRHYTHMIA DATABASE)
V‚Äô Classification

No X-Factor

TABLE VI
SCORES OBTAINED ON THE INCART DATABASE
V‚Äô Classification

V Classification

Technique

Se

+P

F1

Se

+P

F1

de Chazal et al. [3]‚àó
Llamedo and Martƒ±ÃÅnez [6]‚àó
automatic Llamedo and Martƒ±ÃÅnez [8]a , ‚àó
assisted Llamedo and Martƒ±ÃÅnez [8]‚Ä°
SKF with no X-factor‚Ä†
SKF with X-factorb , ‚Ä†

86.5
95.3
82.1
91.4
87.6
90.5

42.7
28.6
77.9
96.9
96.4
99.96

57.1
44.0
79.9
94.1
91.8
95.2

85.1
94.6
90.1
93.8
92.7
97.3

81.9
88.1
86.0
96.7
96.2
99.96

83.5
91.2
88.0
95.2
94.5
98.6

V Classification

Technique

Se

+P

F1

Se

+P

F1

Llamedo and Martƒ±ÃÅnez [6]‚àó
automatic Llamedo and Martƒ±ÃÅnez [8]‚àó
assisted Llamedo and Martƒ±ÃÅnez [8]‚Ä°
SKF with no X-factor‚Ä†
SKF with X-factora , ‚Ä†

82
88.0
98.0
94.7
98.6

88
96.0
98.0
99.3
99.9

84.9
91.8
98.0
97.0
99.2

N/A
N/A
N/A
95.4
99.1

N/A
N/A
N/A
99.3
99.96

N/A
N/A
N/A
97.3
99.4

a
a

0.12% of the heartbeats were not classified.
b
3.2% of the heartbeats were classified as X-factor, and therefore discarded for the
computation of these statistics.
‚àó
These techniques are completely automatic.
‚Ä°
12 cluster centroids were annotated by an expert.
‚Ä†
Average of three cluster centroids were annotated by an expert, with a fifth percentile of
one beat and a 95th of six beats.

X-factor beats were compared to the heartbeats assigned to a
known morphology.
IV. RESULTS
A. Random Search
The best JŒ± score after optimization of the SKF coefficients
was 91.3%. The second random search was performed to determine the parameters for the Gaussian initialization. The best average score was JŒ± = 93.0%, and similar scores were achieved
for each of the two leads. The best score was obtained with the
parameters given in Table II.
B. Beat Classification Accuracy on the Different Test Sets
The confusion matrices of the SKF on the test set of the
MIT-BIH arrhythmia database are presented in Table III.
Among the state-of-the-art techniques, the method (assisted)
Llamedo and Martƒ±ÃÅnez [8] achieved the highest F1 score with
94.1% for V‚Äô beat classification and 95.2% for V beat classification in the MIT-BIH arrhythmia database (see Table IV). It
should be noted that many state-of-the-art techniques were de-

3.2% of the heartbeats were classified as X-factor, and therefore discarded for the
computation of these statistics.
‚àó
These techniques are completely automatic.
‚Ä°
12 cluster centroids were annotated by an expert.
‚Ä†
Average of three cluster centroids were annotated by an expert, with a fifth percentile of
one beat and a 95th of six beats.

signed to also classify supraventricular beats. The incorporation
of additional classes increases the probability of false classification, and ventricular beat detection could have been better if
these techniques (see [3], [6], [8]) would have focused on this
beat class only. The proposed technique obtains an F1 score of
95.2 ¬± 0.4% for V‚Äô beat classification and 98.6 ¬± 0.1% for V
beat classification. Both scores are superior to the state-of-theart; the techniques of Llamedo and Martƒ±ÃÅnez [8]. This comes
at the cost of 1580 beats (or 3.2% of all beats) being classified
as X-factor. By discarding the X-factor class, the resulting F1
score is lower than the best state-of-the-art techniques for V‚Äô
classification by 2.3% and for V classification by only 0.7%.
This is mainly due to a lower Se, whereas +P is similar. This
experiment was run again, with a lower tr = 10, by doing so
and building more morphologies the Se was increased to 90.4%
for V‚Äô classification and F1 increased to 92.7% for V‚Äô classification. These results were even better for V classification, with
Se = 95.9% and F1 = 95.4%, which was slightly better than
the assisted technique of Llamedo and Martƒ±ÃÅnez [8].
Finally, confusion matrices of the SKF approach on the Incart
database are given on Table V, and a comparison of the results
to the other state-of-the-art techniques on the Incart database
are presented in Table VI.

2132

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Fig. 2. Example of the SKF filtering. The top two rows contain the two ECG lead signals with both the raw signal (solid line) and the denoised signal (dashed
line). The third row shows the class likelihood for each mode: normal beat (solid line), ventricular beat (dashed line) and X-factor (dash-dotted line). The left
column highlights an example of ventricular beat classification, and the right column highlights an example of a noisy segment classified as X-factor.

The proposed technique achieved an F1 score of 99.2 ¬± 0.1%
for V‚Äô beat classification and 99.4 ¬± 0.1% for V beat classification, which came at the cost of 5588 beats (or 3.2% of all beats)
being classified as X-factor. These F1 scores are superior to
Llamedo and Martƒ±ÃÅnez (assisted) technique [8], which achieved
a F1 score of 98% for V‚Äô beat classification.3 When discarding
the X-factor the SKF technique achieved a F1 of 97.0% for
the V‚Äô classification and 97.3% for the V classification, which
is slightly lower than the performance than the state-of-the-art
technique. This is mainly due to a lower Se of the SKF technique
when discarding the X-factor. Examples of the SKF filtering are
depicted in Fig. 2.

Fig. 3. Left: Box plots of the empirical PDF of the automatic SQI averaged
over both leads for good and bad quality X-factor segments. The mean annotated
SQI for these X-factor segments (= 0.56) is depicted with a dotted horizontal
line. Right: Box plots of the empirical PDF of the automatic SQI averaged over
both leads for X-factor beats and beats from ‚Äúknown classes,‚Äù as beats classified
as normal or ventricular (A Wilcoxon test showed that these two classes were
statistically significantly different; P < 0.01.).

C. Signal Quality Evaluation Using the SKF Approach
Among the manually annotated 954 segments, 639 were considered to be of bad quality and 315 were considered as being
of good quality. The FP rate for detecting bad quality segments
using the X-factor is 33%. This compares well to the FP rate
of the SVM-based SQI technique [23] on these 954 segments,
which is 29%. As this SVM-based SQI is performed on one
lead, the overall segment SQI was computed as the mean of
both leads‚Äô SQI. The box plot representing the empirical PDF
of the automatic SQI of these segments is given in Fig. 3.
Examples of segments being annotated as X-factor are displayed in Fig. 4. It can be seen that some segments contain
intermediate levels of noise with spikes on both leads. Another
example shows the presence of high level of noise on the second
lead only, making any analysis of this signal impossible.
In order to confirm the overall quality of the beats being
classified as normal or ventricular is different than those being
classified as X-factor, the empirical PDFs of the SVM-based SQI
[23] for these two different types of heartbeats were compared.
Fig. 3 shows the box plots of the empirical PDF of the SQI of
X-factor beats and the ‚Äòknown classes‚Äù (that is either classified
as normal or ventricular). A Wilcoxon-ranked-sum test showed a
3 Score

for V beat classification is not given in their publication.

Fig. 4. Two examples of segments being automatically classified as X-factor
and having been annotated as bad quality. The left column represents an example
with intermediate level of noise on both leads. The right column represents an
example of segments with large level of noise on lead 2 (lower plot) and good
quality on lead 1 (above).

statistically significant difference between the mean SQI values
of the beats classified in X-Factor class and those in the ‚Äúknown
classes‚Äù classes (P -value < 0.01).

OSTER et al.: SEMISUPERVISED ECG VENTRICULAR BEAT CLASSIFICATION WITH NOVELTY DETECTION

V. DISCUSSION AND CONCLUSION
This study introduced a novel technique for filtering and automatically classifying ventricular beats. Two settings of the
model were benchmarked against state-of-the-art techniques:
The first classified all beats even if the morphology was unusual, whereas the second setting assigned some heartbeats to a
novel class denoted as the X-factor.
Without the X-factor, the SKF had equivalent positive predictive value to the state-of-the-art (assisted Llamedo and Martƒ±ÃÅnez
[8])4 but had lower performance in terms of sensitivity and F1 .
This is unsurprising after considering the initial clustering of
beat morphologies. While Llamedo and Martƒ±ÃÅnez [8] clustered
all beats and assigned class labels, we only considered clusters
with a certain minimum size (tr = 25). This was a design decision to improve the utility of the model. It was shown that considering more beats by lowering minimal cluster size (tr = 10)
improved the results on DS2. While annotating every cluster of
beats for each patient is a feasible approach, it would require
a larger amount of input from a trained cardiologist. Instead,
we elected to incorporate a new class, the X-factor, to capture
heart beat dynamics which were underrepresented in the data.
In this second setting, the SKF classifies 3% of all heartbeats as
X-factor, and the performance is superior to the state-of-the-art.
The heartbeats classified as X-factor were assessed in terms
of signal quality. Manual annotation of the quality of these beats
demonstrated that more than two thirds of such beats were of
poor or medium quality. This highlights a potential use of the
X-factor as an automatic SQI. This result was further confirmed
by analyzing the distribution of a state of the art SQI [23], which
showed that X-factor heartbeats had statistically significantly
lower quality than heartbeats in the ventricular and normal class.
While 3% is a reasonable amount of beats to exclude, the use
of the X-factor could be an issue if it contained a much larger
portion of heartbeats. A possible solution would be to create
new clusters of beats among the X-factor beats. The new class
would need to be created with a lower number of internal beats,
however, as there were only 18 X-factor beats on average for a
30-min recording.
The current implementation of the technique uses two leads,
which for some records was a subset of all available leads.5
The incorporation of additional leads could be accomplished by
adding parameters to the observation vector to account for each
new lead. The incorporation of additional leads would, however, require a new training phase, as the parameters for both
the Gaussian parameter initialization and the SKF parameters
were tuned on a set with two leads only. As the SKF approach
will have more independent leads rom which to derive a consensus, the overall performance would be expected to increase.
In particular, some of the beats were classified as X-factor because one lead was extremely noisy, and additional leads may
allow for a better classification of these beats in particular. One
could also further refine the technique with the incorporation of
4 Note that this technique was trained on a larger training dataset (DS1 + MIT
Supraventricular database).
5 Maximum of two leads were used in order to provide a fair comparison to
state-of-the-art techniques.

2133

a lead specific SQI. This would allow the fusion of the leads to
be weighted by an independent empirical estimate of the signal
quality.
The SKF approach presented in this study takes advantage
of expert assistance to identify the different clusters of beats
grouped according to their morphology. The amount of work
required by the expert is relatively low, however. Over the 97
recordings of the test set (22 from the MIT-BIH arrhythmia
database and 75 from the Incart database), the median number
of clusters of beats per recording which required expert annotation was three (one being the fifth percentile and nine the
95thpercentile). This means that on an average the cardiologist
was asked to annotate three heartbeats per recording, and the
maximum number of annotated modes for a single recording
was 13 (from the Incart database).
The proposed SKF approach relies on a clustering of the beats
for each patient. The current clustering technique is simple and
based on the cross correlation between each new heart beat
and the mean morphology of each cluster. A more advanced
clustering technique could be applied and could improve the
classification by better aggregating beats into modes or creating
additional clusters for infrequently occurring beat morphologies. Application of Bayesian nonparametric clustering techniques is an interesting avenue of research, as it will also offer
the possibility of automatically adjusting the number of clusters
to the complexity of the patient recording [27].
As only morphological classification is performed, the technique is limited to the detection of ventricular beats and/or
arrhythmias. In order to add the possibility of classifying
supraventricular beats or atrial arrhythmias, two improvements
could be employed. First, an arrhythmia detector could be applied on the RR interval time-series and used in parallel with
this morphological-based beat detector. Second, one could try
to incorporate temporal features, such as the estimation of œâ,
into the SKF-based technique. The SKF could then model both
heart rate and heart rate variability and be able to detect when
the dynamics of œâ differ from normal rhythm.
A key component of the proposed technique is the detection
of R peaks, which are used in the preprocessing step for the
creation and construction of the modes and in the creation of
the artificial phase signal for the SKF. It is often assumed that
R peak detection is an easy and solved problem, but it is often
complicated by noisy environments. It would be interesting to
analyze the effect of imperfect peak detection on beat classification for the proposed and state-of-the-art methods.
REFERENCES
[1] A. Iwasa et al., ‚ÄúAbnormal heart rate turbulence predicts the initiation
of ventricular arrhythmias,‚Äù Pacing Clin. Electrophysiol., vol. 28, no. 11,
pp. 1189‚Äì1197, 2005.
[2] G. Schmidt et al., ‚ÄúHeart rate turbulence after ventricular premature beats
as a predictor of mortality after acute myocardial infarction,‚Äù Lancet,
vol. 353, no. 9162, pp. 1390‚Äì1396, 1999.
[3] P. de Chazal et al., ‚ÄúAutomatic classification of heartbeats using ECG
morphology and heartbeat interval features,‚Äù IEEE Trans. Biomed. Eng.,
vol. 51, no. 7, pp. 1196‚Äì1206, Jul. 2004.
[4] P. de Chazal and R. B. Reilly, ‚ÄúA patient-adapting heartbeat classifier using
ECG morphology and heartbeat interval features,‚Äù IEEE Trans. Biomed.
Eng., vol. 53, no. 12, pp. 2535‚Äì2543, Dec. 2006.

2134

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

[5] O. Sayadi et al., ‚ÄúRobust detection of premature ventricular contractions
using a wave-based bayesian framework,‚Äù IEEE Trans. Biomed. Eng.,
vol. 57, no. 2, pp. 353‚Äì362, Feb. 2010.
[6] M. Llamedo and J. P. Martƒ±ÃÅnez, ‚ÄúHeartbeat classification using feature
selection driven by database generalization criteria,‚Äù IEEE Trans. Biomed.
Eng., vol. 58, no. 3, pp. 616‚Äì625, Mar. 2011.
[7] T. Mar et al., ‚ÄúOptimization of ECG classification by means of feature
selection,‚Äù IEEE Trans. Biomed. Eng., vol. 58, no. 8, pp. 2168‚Äì2177, Aug.
2011.
[8] M. Llamedo and J. P. Martƒ±ÃÅnez, ‚ÄúAn automatic patient-adapted ecg heartbeat classifier allowing expert assistance,‚Äù IEEE Trans. Biomed. Eng.,
vol. 59, no. 8, pp. 2312‚Äì2320, Aug. 2012.
[9] R. Sameni et al., ‚ÄúA nonlinear bayesian filtering framework for ECG
denoising,‚Äù IEEE Trans. Biomed. Eng., vol. 54, no. 12, pp. 2172‚Äì2185,
Dec. 2007.
[10] P. McSharry et al., ‚ÄúA dynamical model for generating synthetic
electrocardiogram signals,‚Äù IEEE Trans. Biomed. Eng., vol. 50, no. 3,
pp. 289‚Äì294, Mar. 2003.
[11] O. Sayadi et al., ‚ÄúSynthetic ECG generation and bayesian filtering using
a gaussian wave-based dynamical model,‚Äù Physiol. Meas., vol. 31, no. 10,
pp. 1309‚Äì1329, 2010.
[12] G. D. Clifford et al., ‚ÄúAn artificial vector model for generating abnormal
electrocardiographic rhythms,‚Äù Physiol. Meas., vol. 31, no. 5, pp 595‚Äì609,
2010.
[13] G. D. Clifford, ‚ÄúA novel framework for signal representation and source
separation,‚Äù J. Biol. Syst., vol. 14, no. 2, pp. 169‚Äì183, Jun. 2006.
[14] G. D. Clifford and M. C. Villarroel, ‚ÄúModel-based determination of QT
intervals,‚Äù in Proc. Comput. Cardiol., 2006, pp. 357‚Äì360.
[15] O. Sayadi and M. Shamsollahi, ‚ÄúA model-based Bayesian framework for
ECG beat segmentation,‚Äù Physiol. Meas., vol. 30, no. 3, pp. 335‚Äì352,
2009.
[16] Z. Ghahramani and G. E. Hinton, ‚ÄúVariational learning for switching
state-space models,‚Äù Neural Comput., vol. 12, no. 4, pp. 831‚Äì864, 2000.

[17] K. Murphy, ‚ÄúSwitching kalman filters,‚Äù Dept. Comput. Sci., Univ. California, Berkeley, CA, USA, 1998.
[18] M. A. Pimentel et al., ‚ÄúA review of novelty detection,‚Äù Signal Process.,
vol. 9, pp. 215‚Äì249, 2014.
[19] M. Markou and S. Singh, ‚ÄúNovelty detection: A review‚ÄîPart 1: Statistical
approaches,‚Äù Signal Process., vol. 83, no. 12, pp. 2481‚Äì2497, 2003.
[20] J. Quinn et al., ‚ÄúFactorial switching linear dynamical systems applied
to physiological condition monitoring,‚Äù IEEE Trans. Pattern Anal. Mach.
Intell., vol. 31, no. 9, pp. 1537‚Äì1551, Sep. 2009.
[21] Testing and Reporting Performance Results of Cardiac Rhythm and STSegment Measurement Algorithms, ANSI/AAMI:EC57, 1998.
[22] A. Goldberger et al., ‚ÄúPhysiobank, physiotoolkit, and physionet: Components of a new research resource for complex physiological signals,‚Äù
Circulation, vol. 101, pp. 215‚Äì220, 2000.
[23] J. Behar et al., ‚ÄúECG signal quality during arrhythmia and its application to false alarm reduction,‚Äù IEEE Trans. Biomed. Eng., vol. 60, no. 6,
pp. 1660‚Äì1666, Jun. 2013.
[24] J. Bergstra and Y. Bengio, ‚ÄúRandom search for hyper-parameter optimization,‚Äù J. Mach. Learn. Res., vol. 13, pp. 281‚Äì305, 2012.
[25] J. Behar et al., ‚ÄúAn echo state neural network for foetal ECG extraction
optimised by random search,‚Äù in Proc. Mach. Learn. Clinical Data Anal.
Healthcare Workshop, 2013.
[26] G. D. Clifford et al., ‚ÄúSignal quality indices and data fusion for determining clinical acceptability of electrocardiograms,‚Äù Physiol. Meas., vol. 33,
no. 9, pp. 1419‚Äì1433, 2012.
[27] N. L. Hjort et al., Bayesian Nonparametrics. Cambridge, U.K.: Cambridge
Univ. Press, 2010.

Authors‚Äô photographs and biographies not available at the time of publication.

