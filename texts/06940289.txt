832

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Advanced Model-Based Control Studies
for the Induction and Maintenance
of Intravenous Anaesthesia
Ioana Naşcu, Alexandra Krieger, Clara Mihaela Ionescu, and Efstratios N. Pistikopoulos*

Abstract—This paper describes strategies toward model-based
automation of intravenous anaesthesia employing advanced control techniques. In particular, based on a detailed compartmental
mathematical model featuring pharmacokinetic and pharmacodynamics information, two alternative model predictive control
strategies are presented: a model predictive control strategy, based
on online optimization, the extended predictive self-adaptive control and a multiparametric control strategy based on offline optimization, the multiparametric model predictive control. The multiparametric features to account for the effect of nonlinearity and
the impact of estimation are also described. The control strategies
are tested on a set of 12 virtually generated patient models for the
regulation of the depth of anaesthesia by means of the bispectral
index (BIS) using Propofol as the administrated anaesthetic. The
simulations show fast response, suitability of dose, and robustness
to induce and maintain the desired BIS setpoint.
Index Terms—Anaesthesia, EPSAC, estimation, interpatient
variability, MPC, mp-MPC.

I. INTRODUCTION
NAESTHESIA plays a very important role in surgery and
in the intensive care unit (ICU). It is defined as a reversible
pharmacological state of the patient where hypnosis, analgesia,
and muscle relaxation are guaranteed [1]. Analgesics block the
sensation of pain; hypnotics produce unconsciousness, while
muscle relaxants prevent unwanted movement of muscle tone.
The role of the anaesthetist has become more complex and
indispensable to maintain the patients’ vital functions before,
during, and after surgery. To estimate the drug effect in the patient’s body and calculate the corresponding drug infusion rates,
average population models are used. These strategies may not
always be safe for the patient since they do not take into account

A

Manuscript received June 25, 2014; revised September 16, 2014; accepted
October 18, 2014. Date of publication October 30, 2014; date of current version February 16, 2015. This work was supported in part by EPSRC under
Grant EP/G059071/1 and Grant EP/I014640, the European Research Council
(MOBILE, ERC Advanced Grant, No: 226462), and the European Commission
(OPTICO/G.A. No. 280813). Asterisk indicates corresponding author.
I. Naşcu and A. Krieger are with the Centre of Process Engineering, Department of Chemical Engineering, Imperial College London, London SW72AZ,
U.K. (e-mail: ioana.nascu@imperial.ac.uk; a.krieger@imperial.ac.uk).
C. M. Ionescu is with the Department of Electrical Energy, Systems and
Automation, Ghent University, 9052, Gent, Belgium (e-mail: ClaraMihaela.
Ionescu@UGent.be).
* E. N. Pistikopoulos is with the Centre of Process Engineering, Department of Chemical Engineering, Imperial College London, London SW72AZ,
U.K., and also with the Artie McFerrin Department of Chemical Engineering, Texas A&M University College Station, TX 77843 USA (e-mail:
e.pistikopoulos@imperial.ac.uk).
Digital Object Identifier 10.1109/TBME.2014.2365726

any measured variable in a feedback control scheme and even
if they reach the desired level of sedation fast, it can result in
unsafe minimal values (undershoot) [1]. In stress situations, the
anaesthetist has to deal with routine assessments and simultaneously solve complex problems quickly. The automation of some
routine actions of the anaesthetist can reduce the workload and
consequently increase the safety of the patient.
The control of anaesthesia poses a manifold of challenges:
Inter- and intra-patient variability, multivariable characteristics,
variable time delays, dynamics dependent on the hypnotic agent,
model analysis variability, and agent and stability issues [2], [3].
Hitherto, many PID tuning techniques have been elaborated.
Since these classical controllers have no prior knowledge of the
drug metabolism, they cannot anticipate the response of the patient and their performance may be suboptimal. Other authors
developed model-based strategies using fuzzy [4], predictive
[5]–[7], robust [8], [9], adaptive [2], [10], and multiparametric MPC [11] control algorithms and applied them in clinical
trials.
Drugs given for the induction and maintenance of depth of
anaesthesia (DOA) can be either inhalational or intravenous
anaesthetics. An individualized physiological-based, patient
specific, compartmental model for volatile anaesthesia is presented and developed in [12] and a combined strategy of model
predictive control (MPC) and estimation under uncertainty is
presented in [13]. For intravenous anaesthesia, robustness tests
of MPC for DOA using the extended predictive self-adaptive
controller (EPSAC) for a single-input single-output (SISO)
model is presented in [14], different protocols for the administration of Propofol and remifentanil (multiple-input single-output
model) are evaluated in [15], and in [16], a second output variable is determined that originates from the effect of Remifetanil
and leads to the implementation of a MIMO algorithm.
MPC is a model-based control technique that calculates the
optimal control action considering constraints on the input, output, and state variables by solving an optimization problem.
The downside of this control technique is that the optimization problem has to be solved online. One way to avoid this is
to use explicit/multiparametric MPC, which solves offline the
optimization problem using multiparametric programming and
derives the control inputs as a set of explicit functions of the
system states. An important advantage of the multiparametric
model predictive control (mp-MPC) is that the previously offline
computed control laws can be easily implemented on embedded
controllers. These types of devices use programming languages
that cannot support powerful mathematical computations.

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

NAŞCU et al.: ADVANCED MODEL-BASED CONTROL STUDIES FOR THE INDUCTION AND MAINTENANCE OF INTRAVENOUS ANAESTHESIA

833

linear studied on real patient data with the collaboration of
anaesthesiologists and validated using blood samples provided
by hospitals [18], [19], [22]
ẋ1 (t) = −[k10 + k12 + k13 ] · x1 (t) + k21 · x2 (t)
+ k31 · x3 (t) + u(t)/V1
ẋ2 (t) = k12 · x1 (t) − k21 · x2 (t)
ẋ3 (t) = k13 · x1 (t) − k31 · x3 (t)
ẋe (t) = −ke0 · xe (t) + k1e · x1 (t)
Fig. 1. Compartmental model of the patient, where PK denotes the pharmacokinetic model and PD denotes the pharmacodynamic model.

The optimal control laws are retrievable immediately through
simple function evaluations.
The aim of this paper is to design and compare four different types of model-based controllers for administration of
Propofol during ICU sedation. Based on a compartmental pharmacokinetic (PK) and pharmacodynamic (PD) patient model, a
predictive controller is first designed using an EPSAC strategy
and three predictive controllers are designed using an mp-MPC
strategy. The difference between the three controllers based on
the mp-MPC strategy is that one of them uses the linearized patient model, whereas the other two use the compensation of the
nonlinear part of the patient model. In one of the two controllers
using the nonlinear compensation, the states are estimated using an online estimator, while for the other one, the states are
computed using the nominal patient model.
This paper is organized as follows: The patient model, the
multiparametric control strategy, the EPSAC strategy, and the
design of the controllers are presented in the following section.
Section III presents the simulation results for the induction and
maintenance phase and discussions are presented in Section IV.
Finally, Section V summarizes the main outcome of this paper.
II. THEORETICAL BACKGROUND
A. Patient Model
A compartmental model is used to describe the PK–PD blocks
representing the distribution of drugs in the body, i.e., mass
balance. The PK model represents the relation between the drug
administration and drug concentration in the body, whereas the
PD model represents the relation between the concentration of
the drug in the central compartment and the effect observed
on the patient. In each compartment, the drug concentration is
assumed to be uniform, as perfect and instantaneous mixing is
assumed. The structure of the compartmental model is depicted
in Fig. 1 [10], [14], [17], [18].
The PK–PD models most commonly used for Propofol are
the fourth-order compartmental model described by Schnider
[18], [19] and Minto [20], [21], respectively. These models,
developed, tested, and validated on a wide range of real patient data are commonly used in the literature for the control of
anaesthesia.
PK describes the distribution of the drug in the human body.
The PK model and the first term of the PD model are considered

(1)

where x1 represents the drug concentration in the central compartment [mg/L]. The peripheral compartments 2 (muscle) and 3
(fat) model the drug exchange of the blood with well and poorly
diffused body tissues. The concentrations of drug in the fast
and slow equilibrating peripheral compartments are denoted by
x2 and x3 , respectively. The parameters kij for ij, denote the
drug transfer frequency from the ith to the jth compartment, and
u(t) [mg/min] is the infusion rate of the anaesthetic or analgesic
drug into the central compartment. The parameters kij of the
PK models depend on age, weight, height, and gender and can
be calculated for Propofol
V1 = 4.27[l], V2 = 18.9 − 0.391 · (age − 53)[l], V3 = 2.38[l]
Cl1 = 1.89 + 0.456(weight − 77) − 0.0681(lbm − 59)
+ 0.264(height − 177)[l/ min]
Cl2 = 1.29 − 0.024(age − 53)[l/ min], C13 = 0.836[l/ min]
k10 =

Cl1 −1
Cl2 −1
Cl3 −1
[min], k12 =
[min], k13 =
[min],
V1
V1
V1

k21 =

−1
Cl2 −1
Cl3 −1
[min], k31 =
[min], ke0 = 0.456[min]
V2
V3

(2)

where Cl1 is the rate at which the drug is cleared from the body,
and Cl2 and Cl3 are the rates at which the drug is removed
from the central compartment to the other two compartments by
distribution.
The lean body mass (lbm) for men (M) and women (F) are
calculated by
lbm M = 1.1 · weight − 128

weight2
height2

lbm F = 1.07 · weight − 148

weight2
.
height2

(3)

An additional hypothetical effect compartment is added to
represent the lag between plasma drug concentration and drug
response. The drug concentration in this compartment is represented by xe , called the effect-site compartment concentration.
The effect compartment receives drug from the central compartment by a first-order process and it is considered as a virtual
additional compartment. Therefore, the drug transfer frequency
for Propofol from the central compartment to the effect sitecompartment is considered in clinical practice to be equal to
the frequency of drug removal from the effect-site compartment
ke0 = k1e = 0.456 [min−1 ] [18], [19], [23]. When considering
the drug effect observed on the patient, the bispectral index

834

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

the cost function
N2


[r(t + k/t) − y(t + k/t)] + λ
2

k =N 1

Fig. 2. Schematic representation of the nonlinear SISO patient model for
intravenous anaesthesia.

(BIS) variable can be related to the drug effect concentration Ce
by the empirical static nonlinear relationship [5], [6], [18], [19],
[23], called also the Hill curve
BIS(t) = E0 − Em ax ·

Ce (t)γ
.
Ce (t)γ + ECγ50

(4)

Notice that in the model used in this paper Ce = xe .
E0 denotes the baseline value (awake state—without drug),
which by convention is typically assigned a value of 100, Em ax
denotes the maximum effect achieved by the drug infusion,
EC50 is the drug concentration at 50% of the maximal effect and
represents the patient sensitivity to the drug, and γ determines
the steepness of the curve.
The inverse of the Hill curve can be defined by the following
formulation:

 γ1
E0 − BIS(t)
.
(5)
Ce (t) = EC50
Em ax − E0 + BIS(t)
The type of models that consider a linear dynamic followed
by a nonlinear dynamic system are called Wiener-Hammerstein
models and are presented in Fig. 2. These type of models have
been widely used in control of anaesthesia [23]. For the automatic regulation of DOA in Fig. 2, the anaesthetic agent, i.e.,
Propofol, is the input and the BIS the output of the system. Because of its pharmacological profile, Propofol is applicable for
both induction and maintenance of hypnosis during anaesthesia
and intensive care sedation [24].
The BIS is a signal that is derived from the electroencephalogram (EEG) used to assess the level of consciousness
in anaesthesia. A BIS value of 0 equals EEG silence, while a
BIS value of 100 is the expected value of a fully conscious
adult patient, 60–70 and 40–60 range represents light and moderate hypnotic conditions, respectively. The target value during
surgery is 50, giving us a gap between 40 and 60 to guarantee
adequate sedation [1]–[3].

N
u −1

[Δu(t + k/t)]2 .

k =0

(6)
The design parameters are: N1 = the minimum costing
horizon, N2 = the maximum costing horizon, N2 − N1 =
the prediction horizon, Nu = control horizon, λ = weight
parameter, n(t) is the disturbance, y(t) the measured output,
and u(t) the model input. The signal r represents the reference
trajectory.
In our case, the process input is represented by the Propofol
infusion rate applied to the patient. The process output is predicted at time instant t over the prediction horizon N2 −N1 , based
on the measurements available at that moment and the future
outputs of the control signal. The cost function is an extended
EPSAC cost function that penalizes the control movements using the weight parameter λ.
2) Multiparametric Strategy: Multiparametric programming
is a technique to solve an optimization problem, where the objective is to minimize or maximize a performance criterion subject
to a given set of constraints where some of the parameters vary
between specified lower and upper bounds. The main characteristic of the mp-MPC is its ability to obtain: 1) the objective and
optimization variable as a function of the varying parameters,
and 2) the regions in the space of the parameters where these
functions are valid [critical regions (CR)] [26], [27] .This reduces the online implementation of the MPC to simple function
evaluation, facilitating real-time applications.
For the mp-MPC, the generic optimization problem solved is
min J = xN P xN +

x,y ,u

N
−1


xk Qk xk

k =1

+

N
−1


(yk − ykR ) QRk (yk − ykR )

k =1

+

N
u −1

(uk − uR ) Rk (uk − uR )

k =0

+

N
u −1

Δuk R1k Δuk

k =0

s.t.xt+1 = Axt + But
B. Advanced Model-Based Control Strategies
MPC is a control methodology based on two main principles:
explicit online use of a process model to predict the process
output at future time instants, and the computation of an optimal control action by minimizing one or more cost functions,
including constraints on the process variables.
The main differences between the different types of MPC
algorithms are: the type of model used to represent the process
and its disturbances and the cost function(s) to be minimized,
with or without constraints.
1) EPSAC Strategy: For the EPSAC approach, described in
detail in [25], the controller output is obtained by minimizing

yt = Cxt
BISm in ≤ y ≤ BISm ax
Δum in ≤ Δu ≤ Δum ax
xt ∈ X ⊆ p ,

ut ∈ U ⊆ s

(7)

where x are states, y are outputs, and u are controls, all (discrete) time-dependent vectors. The subsets of output variables
that get tracked have time-dependent set points y R . Finally, Δu
are changes in control variables, Δu(k) = u(k) − u(k − 1).
The prediction horizon is denoted by N and control horizon by
Nu . X and U are the sets of the state and input constraints that

NAŞCU et al.: ADVANCED MODEL-BASED CONTROL STUDIES FOR THE INDUCTION AND MAINTENANCE OF INTRAVENOUS ANAESTHESIA

Fig. 3.

835

MPC control scheme.

contain the origin in their interior. Both Q > 0, the objective
coefficient for the states and P > 0, the terminal weight matrix for the states, are symmetric semipositive definite matrices.
The quadratic matrix for manipulated variables R > 0 is a symmetric positive matrix, QR is the quadratic matrix for tracked
outputs, and R1 is a weight matrix for the control action changes
(Δu). The control problem is posed as a quadratic convex optimization problem for which an explicit solution can be obtained
as follows:
⎧
⎨ K1 x + c1 , if x ∈ CR1
(8)
u = f (x) =
...
⎩
Ks x + cs , if x ∈ CRs
where s is the number of CR.
C. Control Design
The presence of the Hill nonlinearity complicates the use of
linear controller synthesis. Two methods to overcome this problem have been proposed: Exact and local linearization. Exact
linearization is based on the compensation of the nonlinearity
introduced by the Hill curve, in the PD model. Since the Hill
nonlinearity (4) is a monotonic function (f) of the normalized
effect site concentration, it has an inverse presented in (5). Using a parameter scheduling technique, the inverse Hill function
(f −1 ) could be implemented in the controller as illustrated by the
block diagram in Fig. 3. Here, f is using the nonlinearity parameter of the real patient (E0 , Em ax , EC50 , γ), while f −1 is using
the parameter assumed by the controller (the nominal patient
nonlinearity parameters a priori known (E0 m ean , Em ax m ean ,
EC50 m ean , γ m ean ). The controller aims at controlling the estimated drug concentrationĈe , which is straight-forward, using a
linear controller.
An exact linearization occurs only in the case where the patient model is identical to the nominal model in which case
it completely cancels the nonlinearity and Ĉe = Ce . The local
linearization is based on the linearized PK–PD model for a BIS
value of 50 obtained using gPROMS [28].
An important challenge of DOA control is the high interand intra-patient variability. This results in different dynamics
in PK model, and changes in the parameters of the Hill function for each patient model. Four control strategies, a model
predictive controller, EPSAC, and three different mp-MPC are
designed and evaluated. The framework for the different ways
of designing the controllers is presented in Fig. 4.
The patient response is simulated using patient model block,
composed of the PK–PD linear part (1) and the nonlinear PD
part, the Hill nonlinearity (4). BIS can be measured; however,

Fig. 4.

Control scheme development flowchart.

the states cannot and have to be estimated: either using the drug
rate and the nominal state-space patient model or by using the
input and output measured output (BIS) of the process, the statespace nominal model and a correction estimator based on the
output changes.
To analyse the influence of the changes in the dynamics of
the PK model on the control performances, two types of control schemes are implemented, one uses the states given by the
nominal model (B) and the other uses an estimator to adjust the
states based on the dynamics of each patient (A).
The influence to the changes of parameters of the Hill curve
on the control performances is analyzed by two types of control schemes, one using the local linearized PK–PD model (C)
and the second is based on the exact linearization (D). The following design parameters are used: The objective coefficients
for states (x), Q = 0, when we have no state estimation and
Q = 1 in the case with state estimation, the quadratic matrix for
tracked outputs (y), QR = 1000, quadratic matrix for manipulated variables (u), R = 1, the control horizon Nu = 1, and the
prediction horizon N = 20 in both mp-MPC and EPSAC. The
EPSAC has an extra weighting factor λ from (8) for which its
default value λ = 0 was used. The states used in the design of
the controllers are x1 , x2 , x3 , xe as described in (1). The clinically recommended sampling time is of 5 s [6]. N1 , N2 , and Nu
are chosen based on the characteristics of the process and the
desired performances. Based on [29], [30], N should be large,
at least 2n−1 but not larger than the risetime of the process. For
anaesthesia, due to medical procedures, we are constrained to
use a small sampling time leads to a choice of a greater value
for N. Also, the dead time is not considered since it is very small
and does not affect the process, therefore N1 = 1. In choosing Nu for processes with no unstable/underdamped poles, like
anaesthesia, N u = 1 is generally satisfactory. A choice of the
Q, R, and QR is given by Bryson’s rule [31].
1) Case 1: Extended Prediction Self-Adaptive Control: In this
section, we apply a particular case of online MPC, the EPSAC
strategy described in detail in Section II-C. The structure of the
control system proposed in this section is shown in Fig. 5.

836

Fig. 5.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Case 1: EPSAC control scheme.
Fig. 7.

Case 3: mp-MPC with nonlinearity compensation control scheme.

TABLE I
BIOMETRIC VALUES OF THE VIRTUAL PATIENTS
Age

Height (cm)

Weight (Kg)

Gender

EC5 0

E0

γ

1
2
3
4
5
6
7
8
9
10
11
12

40
36
28
50
28
43
37
38
41
37
42
34

163
163
164
163
164
163
187
174
170
167
179
172

54
50
52
83
60
59
75
80
70
58
78
58

M
M
M
M
F
M
F
M
M
M
F
M

6.33
6.76
8.44
6.44
4.93
12.0
8.02
6.56
6.15
13.7
4.82
4.95

98.8
98.6
91.2
95.9
94.7
90.2
92.0
95.5
89.2
83.1
91.8
96.2

2.24
4.29
4.1
2.18
2.46
2.42
2.1
4.12
6.89
1.65
1.85
1.84

Mean

38

169

65

M

7.42

93.1

3

Patient

Fig. 6.

Case 2: mp-MPC without nonlinearity compensation control scheme.

The patient block is composed of the PK and PD models.
Control strategy based on nonlinearity compensation and I/O
linear nominal patient model is used (see Fig. 4). The controller
output is obtained by minimizing cost function (6) with the
design parameters in Section II-B1 The control algorithm uses
for prediction a transfer function derived from the PK–PD linear
model (1). The inverse of the Hill curve (5) is used to compensate
the nonlinearity. Both the linear model and the inverse of the
Hill curve use the nominal values from Table I.
2) Case 2: mp-MPC Without Nonlinearity Compensation:
The structure of the control scheme is presented in Fig. 6. This
approach uses the explicit/multiparametric MPC strategy based
on local linearization of the PK–PD model and the state-space
model of the linearized nominal patient model (see Fig. 4).
To obtain the linearized patient model, we will first implement
the PK and PD model for the nominal patient in gPROMS [28],
and determine the state space of the linearized nominal patient
model at BIS = 50. Using these matrices, the mp-QP optimization problem (7) is solved to obtain the CR using a MATLAB
implementation of multiparametric quadratic programming algorithm [32] and determine the mp-MPC controller.

Fig. 8. Case 4: mp-MPC with nonlinearity compensation and estimator control
scheme.

3) Case 3: mp-MPC With Nonlinearity Compensation: The
explicit/multiparametric MPC is used again. Control strategy
based on nonlinearity compensation and the state-space model
of the PK–PD linear part (1) for the nominal patient model is
used (see Fig. 4). The PK–PD model is no longer linearized as a
whole in gPROMS like in the previous case (Case2). Instead, the
PK–PD linear part (1) is implemented in MATLAB and is used
to obtain the state space of the nominal patient characteristics
(A, B, C, and D matrices). Having the state space obtained, we
solve the mp-QP optimization problem (7), obtain the CR using
POP [32] and determine the controller based on the nominal
patient values.
The inverse of the Hill curve (5) based on the nominal patient
model parameters is then used to compensate the nonlinearity.
Note that the states are obtained using the state-space model
based on the A, B, C, and D matrices and the drug rate u as
input. This control scheme is presented in Fig. 7.
4) Case 4: mp-MPC With Nonlinearity Compensation and Estimation: This approach also uses the explicit/multiparametric
MPC strategy. The structure of this control scheme is similar to
the one described in Section II-C3 and it is presented in Fig. 8.
The difference is that the state-space model nominal patient
block from Fig. 7 is replaced by a state estimator. Here, the real
patient states are estimated using a Kalman filter [33] based on
the state space of the nominal patient, the online BIS measurement, and the drug rate.
III. RESULTS
In this section, the results of a simulation study to evaluate
the four control strategies for the administration of Propofol are
presented. DOA is monitored using the BIS during the induction
and maintenance phase of general anaesthesia. The closed-loop
control tests are performed on a set of 12 patients [14] plus an

NAŞCU et al.: ADVANCED MODEL-BASED CONTROL STUDIES FOR THE INDUCTION AND MAINTENANCE OF INTRAVENOUS ANAESTHESIA

Fig. 9.

Fig. 10.

BIS output for all 13 patients for Case 1.

Map of CR: Case 2.

Fig. 11.

BIS output for all 13 patients for Case 2.

Fig. 12.

Map of CR: Case 3 and Case 4.

Fig. 13.

BIS output for all 13 patients for Case 3.

837

extra patient representing the nominal values of all 12 patients
(PaN—patient nominal). The parameters values of these patients
are given in Table I and are also used to calculate the parameters
of the patient model.
All designed controllers are simulated first for the set of data
presented in Table I in order to have a better understanding of
their behavior on the different types of patients, and analyze the
inter- and intra-patient variability. Next, the four controllers will
be tested against each other and simulated for different patients
so as to be able to compare their performances by means of the
BIS index and the corresponding Propofol infusion rates.
A. Induction Phase
Ideally, the induction phase of the patient in an operational
DOA is performed as fast as possible, such that little time is lost
before the surgeon can start operating. It is, therefore, desirable
that the patient reaches the BIS = 50 target and remains within
the target value without much undershoot or overshoot, i.e., values below BIS = 40 and above BIS = 60 should be avoided.
In Figs. 9, 11, 13, and 14, we have the simulations of the four
controllers for all 12 patients and the nominal one in the induction phase. Fig. 10 presents the map of the CR for the controller
using local linearization (Case 2); and in , we have the map of

the CR for the controllers designed using exact linearization, by
using the inverse of the Hill curve (Cases 3 and 4).
Simulations of some patients show very small oscillations
around the steady-state values. The average settling time for EPSAC is approximately 7 min, and for the mp-MPC controllers is
approximately 5 min. In common practice, the operation procedure does not start until the patient reaches an adequate DOA,

838

Fig. 14.

Fig. 15.

Fig. 16.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Fig. 17.

BIS response for the four controllers for patient 9.

Fig. 18.

Output for the four controllers for patient 9.

Fig. 19.

Artificially generated disturbance signal.

BIS output for all 13 patients for Case 4.

BIS response for the four controllers for PaN.

Output for the four controllers for the PaN.

usually taking up to 15 min. Thus, a risetime between 5 and
7 min gives good performances.
The best performances are obtained for Case 2. It seems that
the local linearization is able to deal with inter- and intra-patient
variability. Also, the process was linearized at BIS = 50, which
is the value of the controller set point. The EPSAC controller is
more influenced by interpatient variability and for some patients
the settling time has greater values.
The four controllers: EPSAC and the mp-MPC controllers,
are simulated, compared for PaN and presented in Fig. 15. For
patient 9, the most sensitive patient, this simulation is presented
in Fig. 17. In Figs. 16 and 18, we have the corresponding Propo-

fol infusion rates for the two patients. We can observe that due to
the less aggressive behavior of the EPSAC controller, the output
evolution will be smoother. In all the cases, the Propofol infusion
rates are limited to 10 mg/s due to pump restrictions. The same
conclusions as for Figs. 9–12 arevalid here. For both simulated
patients, the EPSAC controller has a slower response.
B. Maintenance Phase
During the maintenance phase, it is important that the controller rejects the disturbances occurred during surgery as fast
as possible and bring the patient to the BIS target value. In this
phase, typical disturbances can be applied additively to the output of the process to check the controller’s ability to reject them
[22]. A standard stimulus profile is defined and is presented in

NAŞCU et al.: ADVANCED MODEL-BASED CONTROL STUDIES FOR THE INDUCTION AND MAINTENANCE OF INTRAVENOUS ANAESTHESIA

Fig. 23.
Fig. 20.

839

Output for the four controllers for patient 9 with disturbance.

BIS response for the four controllers for PaN with disturbance.

Figs. 21 and 23, we have the corresponding Propofol infusion
rate for PaN and patient 9, limited between 0 and 10 mg/s.
The simulations are performed for the maintenance phase using
the disturbance signal (see Fig. 19) between 60 and 140 min. The
simulations show only small differences between the controllers
and, thus, comparable performances of all four controllers. For
the second control scheme, the behavior of the controller is less
aggressive; the response is slower but it also has the smallest
values of the undershoot.
IV. DISCUSSION
Fig. 21.

Output for the four controllers for PaN with disturbance.

Fig. 22.

BIS response for the four controllers for patient 9 with disturbance.

Fig. 17. Each interval denotes a specific event in the operation
theatre. Stimulus A represents response to intubation; B represents a surgical incision that is followed by a period of no
surgical stimulation (i.e., waiting for pathology result); C mimics an abrupt stimulus after a period of low level stimulation; D
represents the onset of a continuous normal surgical stimulation;
E, F, and G simulate short-lasting, larger stimulation within the
surgical period; and H represents the withdrawal of stimulation
during the closing period [34].
In Figs. 20 and 22, the performance of the disturbance rejection of the four controllers for PaN and a more sensitive patient
(patient 9) are shown. The figures present the most challenging part of the disturbance rejection test, namely B-C-D-E. In

The aim of this study is to evaluate the performance of a
model-based predictive control algorithm and model predictive
multiparametric control for automatic induction and control of
DOA during the induction and the maintenance phases.
Some of the most important aspects of this application are
the high inter- and intra-patient variability, variable time delays,
dynamics dependent on the hypnotic agent, and model analysis
variability. These are just some of the issues that are dealt with
when trying to control the DOA.
In this paper, the hypnotic agent Propofol is given as the
input and the output is described by the BIS, resulting in a SISO
system. SISO patient models for control of most anesthetic drugs
already exist in the literature and their parameters are estimated
based on age, weight, gender, and height.
Four different types of controllers are designed and tested.
The first controller is based on the online optimization EPSAC
MPC technique. The other three controllers are based on the
offline optimization mp-MPC: one uses the linearized patient
model and the other two uses the compensation of the nonlinear
part of the patient model. The difference between the two control
strategies using nonlinearity compensation is that for one of
them the states are computed using the nominal patient model,
whereas the other one uses an online estimator.
In order to address the issue of inter- and intra-patient variability, each of the four controllers are first tested for the whole set
of patients presented in Table I for the induction and the maintenance phase. The maps of the CR for the mp-MPC are presented
in Figs. 10 and 12 . One can observe that for the controllers using the nonlinearity compensation (exact linearization), there
are less CR than for the controller using local linearization. This

840

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

will make the controllers from Cases 3 and 4 easier to implement
on embedded devices.
In the induction phase, for Case 1, representing the online
EPSAC controller, we have an average settling time of 390 sec.
The undershoot of the most sensitive patient is of 4.6%. As it
can be observed from Figs. 11, 13, and 14, representing the
BIS response of the mp-MPC controllers, the three cases have
very similar settling time, lower than for the EPSAC strategy,
an average of 270 sec. For the undershoot evaluation, the worstcase scenario is considered, meaning the most sensitive patient.
We obtain for the first controller (Case 2) an undershoot of 3.7%;
for Case 3, an undershoot of 5.8%; and for Case 4, an undershoot
of 5.78%. All undershoots are below 10%, which represents the
maximum limit. For the induction phase, it can be said that all
four controllers perform well each of them having their own
advantages: i.e., lower settling time and smaller undershoot.
The controllers are tested in the maintenance phase in order
to see how well they can deal with the disturbance rejection. In
Figs. 20 and 22, we can observe the four controllers response
to a disturbance signal that mimics the events that occur in an
operation theatre for PaN and for patient 9.
All four controllers are tested against each other for the induction and maintenance phase for two different patients. The
first patient is PaN, and the second patient used for comparison,
patient 9, represents the most sensitive patient. It is worth mentioning that the controllers are designed using the values of the
nominal patient which means that for this patient, we will have
the best behavior of the controllers. As it can be observed from
Figs. 15, 16, 20, and 21, the BIS response and the output for PaN
in the induction phase and the maintenance phase, respectively,
the three offline controllers have a very similar behavior. All the
controllers present no undershoot and a fast settling time. The
EPSAC controller has a less aggressive behavior; hence, a longer
settling time compared to the mp-MPC controllers, but as can be
observed in the maintenance phase, it will have less undershoot.
In Figs. 17, 18, 22, and 23, we have the BIS response and the
output for patient 9 in the induction phase and the maintenance
phase. This patient represents the worst-case scenario since it
is the most sensitive patient. We can observe from the figures
that all four controllers have good performances and their responses are very close to each other. However, the controller
from Case 2 gives the best performances for this patient in the
induction phase particularly lower undershoot, 3.7%, and faster
settling time, 300 sec. This shows that the combination between
the linearization method based on gPROMS and optimization
methods based on mp-MPC gives good results even without the
nonlinearity compensation.
It is important to state that the mp-MPC controller designed
using the linearized patient model is the simplest version of
the four controllers since it does not use an estimator and it
avoids using the nonlinearity compensation, which introduces
additional complexity in the DOA control. Moreover, it obtains
the best performances which can be explained through the fact
that the nonlinearity of the Hill curve is more intense at extreme
values of the BIS index and weaker around the BIS value of 50
where the model was linearized and where the BIS target is set. If
the induction phase and the maintenance phase are kept around

the value of 50%, Case 2 will give very good performances.
But if the disturbances take the process out of the 50% area,
we can observe that the performances are not as good as in
the case of nonlinearity compensation. Case 2 does not provide
good performances if the disturbances are substantial. Due to
the Hill nonlinearity, the real-patient model has smaller gain
at the extreme values of the control variable. In the case of
substantial disturbances, the control variable goes to the extreme
values and the controller has a slower response but also a lower
undershoot/overshoot.
Using nonlinearity compensation is a good alternative in this
case. Moreover, the computations required for the nonlinearity
compensation are rather straightforward (the inverse of the Hill
curve), and there are no recursive computations that might lead
to accumulation of errors.
The estimator used for the mp-MPC with nonlinearity compensation can also be applied for the mp-MPC using local linearization. It was not used for this study because as it can be
observed from the simulations, the case with nonlinearity compensation is more meaningful in the presence of disturbance.
The aim of the studies on control of anaesthesia is to be able to
implement the controllers on embedded devices (see MOBILE
project). These types of devices do not have the same computational power as the computers where simulations are performed
in real time. This would make classical MPC more difficult to
implement since matrix operations are harder to program on
embedded devices. The mp programming algorithms derive the
explicit mapping of the optimal control actions as a function of
the current states resulting in the implementation of a simple
lookup table and simple function evaluations. This makes the
mp-MPC controllers much easier to implement for the control
of DOA.
For each patient, there will be a variable dose-response relationship. For the same reference value, the controller sends
different drug rate and the blood and effect-site concentrations
levels are different for each patient. The safety limit for Propofol
blood concentration and effect-site concentration is fulfilled by
maintaining the drug infusion rate below 10 mg/s. It can be observed from Figs. 16, 18, 21, and 23 that the drug infusion rates
are maintained below this limit.
Note that the robustness of the performance is analyzed by
having the controllers designed on a nominal model [6] and
then tested on a wide set of patient models parameters where
the impact of parameter uncertainties were analyzed. Formal
robust criteria can also be included [27], and this represents a
topic of our ongoing research.

V. CONCLUSION
In this paper, we design and evaluate four different controllers
for the regulation of DOA during induction and maintenance
phase. For the maintenance phase, a realistic disturbance signal
was considered and applied. A simulation study is performed
on a set of 12 virtually generated patients plus the mean patient.
The performance of the four controllers is compared with each
other for a sensitive patient and the nominal patient.

NAŞCU et al.: ADVANCED MODEL-BASED CONTROL STUDIES FOR THE INDUCTION AND MAINTENANCE OF INTRAVENOUS ANAESTHESIA

Some important aspects of this application are the high
interpatient variability and the presence of important disturbances during the maintenance phase. The results show a highefficiency, optimal dosage, and robustness of the MPC algorithm to induce and maintain the desired BIS reference while
rejecting typical disturbances from surgery. The mp-MPC approach, which is an offline optimisation method, has similar
performances with the online method and promising results.
REFERENCES
[1] J. M. Bailey and W. M. Haddad, “Drug dosing control in clinical pharmacology,” IEEE Control Syst. Mag., vol. 25, no. 2, pp. 35–31, Apr. 2005.
[2] W. M. Haddad, T. Hayakawa, and J. M. Bailey, “Nonlinear adaptive control
for intensive care unit sedation and operating room hypnosis,” in Proc.
Amer. Control Conf., 2003, pp. 1808–1813.
[3] A. R. Absalom, R. De Keyser, and M. M. R. F. Struys, “Closed loop
anaesthesia: Are we getting close to finding the Holy Grail?” Anesthesia
Analgesia, vol. 112, pp. 516–518, 2011.
[4] M. Curatolo, M. Derighetti, S. Petersen-Felix, P. Feigenwinter, M. Fischer,
and A. M. Zbinden, “Fuzzy logic control of inspired isoflurane and oxygen concentrations using minimal flow anaesthesia,” Brit. J. Anaesthesia,
vol. 76, pp. 245–250, 1996.
[5] M. M. R. F. Struys, H. Vereecke, A. Moerman, E. W. Jensen, D. Verhaeghen, and N. De Neve, “Ability of the bispectral index, autoregressive modelling with exogenous input-derived auditory evoked potentials,
and predicted propofol concentrations to measure patient responsiveness during anesthesia with propofol and remifentanil,” Anesthesiology,
vol. 99, pp. 802–812, 2003.
[6] C. M. Ionescu, R. D. Keyser, B. C. Torrico, T. D. Smet, M. M. R. F. Struys,
and J. E. Normey-Rico, “Robust predictive control strategy applied for
propofol dosing using BIS as a controlled variable during anesthesia,”
IEEE Trans. Biomed. Eng., vol. 55, no. 9, pp. 2161–2170, Sep. 2008.
[7] R. Hodrea, R. Morar, and I. Nascu, “Predictive control of neuromuscular
blockade,” Autom. Comput. Appl. Math., vol. 21, pp. 119–205, 2012.
[8] V. Caiado Daniela, M. Lemos João, and A. Costa Bertinho, “Robust control
of depth of anesthesia based on H design,” Arch. Control Sci., vol. 23,
pp. 41–59, 2013.
[9] G. A. Dumont, A. Martinez, and J. M. Ansermino, “Robust control of
depth of anesthesia,” Int. J. Adapt. Control Signal Process., vol. 23,
pp. 435–454, 2009.
[10] I. Nascu, I. Nascu, C. M. Ionescu, and R. De Keyser, “Adaptive EPSAC
predictive control of the hypnotic component in anesthesia,” in Proc. Int.
Conf. Automat. Quality, Testing Robot., 2012, pp. 103–108.
[11] I. Nascu, R. S. C. Lambert, A. Krieger, and E. N. Pistikopoulos, “Simultaneous multi-parametric model predictive control and state estimation with
application to distillation column and intravenous anaesthesia,” Comput.
Aided Chem. Eng., vol. 33, pp. 541–546, 2014.
[12] A. Krieger, N. Panoskaltsis, A. Mantalaris, M. C. Georgiadis, and
E. N. Pistikopoulos, “Analysis of an individualized physiologically based
model for anesthesia control,” in Proc. IFAC Symp. Biol., Med. Syst., 2012,
pp. 385–390.
[13] A. Krieger, N. Panoskaltsis, A. Mantalaris, M. C. Georgiadis, and E. N.
Pistikopoulos, “Modeling and analysis of individualized pharmacokinetics
and pharmacodynamics for volatile anesthesia,” IEEE Trans. Biomed.
Eng., vol. 61, no. 1, pp. 25–34, Jan. 2014.
[14] C. M. Ionescu, I. Nascu, and R. Keyser, “Robustness tests of a model
based predictive control strategy for depth of anesthesia regulation in
a propofol to bispectral index framework,” in International Conference
on Advancements of Medicine and Health Care Through Technology,
vol. 36, S. Vlad and R. Ciupa, Eds. Berlin, Germany: Springer-Verlag,
2011, pp. 234–239.
[15] I. Nascu, C. M. Ionescu, I. Nescu, and R. De Keyser, “Evaluation of three
protocols for automatic DOA regulation using propofol and remifentanil,”
in Proc. Int. Conf. Control, Autom., 2011, pp. 573–578.

841

[16] C. M. Ionescu, I. Nascu, and R. De Keyser, “Towards a multivariable model
for controlling the depth of anaesthesia using propofol and Remifentanil,”
in Proc. 8th Symp. Biol., Med. Syst., 2012, pp. 325–330.
[17] M. M. R. F. Struys, T. De Smet, S. Greenwald, A. R. Absalom, S. Bingé,
and E. P. Mortier, “Performance evaluation of two published closed-loop
control systems using bispectral index monitoring: A simulation study,”
Anesthesiology, vol. 100, pp. 640–647, 2004.
[18] T. W. Schnider, C. F. Minto, P. L. Gambus, C. Andresen, D. B. Goodale,
and S. L. Shafer, “The influence of method of administration and covariates
on the pharmacokinetics of propofol in adult volunteers,” Anesthesiology,
vol. 88, pp. 1170–1182, 1998.
[19] T. W. Schnider, C. F. Minto, S. L. Shafer, P. L. Gambus, C. Andresen, and
D. B. Goodale, “The influence of age on propofol pharmacodynamics,”
Anesthesiology, vol. 90, pp. 1502–1516, 1999.
[20] C. F. Minto, T. W. Schnider, and S. L. Shafer, “Pharmacokinetics and
pharmacodynamics of remifentanil—Part II: Model application,” Anesthesiology, vol. 86, pp. 24–33, Jan. 1997.
[21] C. F. Minto, T. W. Schnider, T. D. Egan, E. J. Youngs, H. J. Lemmens, and
P. L. Gambus, “Influence of age and gender on the pharmacokinetics
and pharmacodynamics of reminfetanil—Part I: Model development,”
Anesthesiology, vol. 86, pp. 10–23, 1997.
[22] N. West, G. A. Dumont, K. Van Heusden, C. L. Petersen, S. Khosravi,
and K. Soltesz, “Robust closed-loop control of induction and maintenance of propofol anesthesia in children,” Paediatric Anaesthesia, vol. 23,
pp. 712–719, 2013.
[23] C. S. Nunes, T. Mendonça, J. M. Lemos, and P. Amorim, “Feedforward
adaptive control of the Bispectral Index of the EEG using the intravenous
anaesthetic drug propofol,” Int. J. Adapt. Control Signal Process., vol. 23,
pp. 485–503, 2009.
[24] C. Ionescu, J. T. Machado, R. De Keyser, J. Decruyenaere, and M. M.
R. F. Struys, “Nonlinear dynamics of the patient’s response to drug effect during general anesthesia,” Commun. Nonlinear Sci. Numer. Simul.,
vol. 20, pp. 914–926.
[25] R. De Keyser, “Model Based Predictive Control,” Invited Chapter UNESCO Encyclopaedia Life Support Syst, vol. 6.43.16.1, p. 30p, 2003.
[26] E. N. Pistikopoulos, M. Georgiadis, and V. Dua, Multi-Parametric Programming: Theory, Algorithms and Applications. Hoboken, NJ, USA:
Wiley-VCH, 2007.
[27] K. I. Kouramas, N. P. Faı́sca, C. Panos, and E. N. Pistikopoulos,
“Explicit/multi-parametric model predictive control (MPC) of linear
discrete-time systems by dynamic and multi-parametric programming,”
Automatica, vol. 47, pp. 1638–1645, 2011.
[28] (2010). P. S. E. L. (PSE). GPROMS model developer guide. Release v3.3.0
[Online]. Available: http://www.psenterprise.com/gproms/.
[29] D. W. Clarke, C. Mohtadi, and P. Tuffs, “Generalized predictive control—
Part I: The basic algorithm,” Automatica, vol. 23, pp. 137–148, 1987.
[30] C. Mohtadi, D. Clarke, and P. Tuffs, “Generalized predictive control—
Part II: Extensions and Interpretations,” Automatica, vol. 23, pp. 149–160,
1987.
[31] G. F. Franklin, D. J. Powell, and A. Emami-Naeini, Feedback Control of
Dynamic Systems. Englewood Cliffs, NJ, USA: Prentice-Hall, 2001.
[32] E. N. Pistikopoulos, N. A. Bozinis, and V. Dua, “POP: A MATLAB
implementation of multi-parametric quadratic programming algorithm,”
Centre for Process System Engineering, Imperial College, London, U.K.,
1999.
[33] G. Welch and G. Bishop, “An introduction to the Kalman filter: SIGGRAPH 2001 Course 8,” in Proc. Comput. Graph., Annu. Conf. Comput
Graph., Interact. Techn., 2001, pp. 12–17.
[34] S. Yelneedi, L. Samavedham, and G. P. Rangaiah, “Advanced control
strategies for the regulation of hypnosis with propofol,” Ind. Eng. Chem.
Res., vol. 48, pp. 3880–3897, Apr. 15, 2009.

Authors’ photographs and biographies not available at the time of publication.

