IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

403

Study of Estimation Method for Unsteady
Inflow Velocity in Two-Dimensional
Ultrasonic-Measurement-Integrated
Blood Flow Simulation
Hiroko Kadowaki∗ , Toshiyuki Hayase, Kenichi Funamoto, and Nobuyuki Taniguchi

Abstract—Information on hemodynamics is essential for elucidation of mechanisms and development of novel diagnostic
methods for circulatory diseases. Two-dimensional ultrasonicmeasurement-integrated (2D-UMI) simulation can correctly reproduce an intravascular blood flow field and hemodynamics by
feeding back an ultrasonic measurement to the numerical blood
flow simulation. In this method, it is critically important to give the
correct cross-sectional average inflow velocity (inflow velocity) as
the boundary condition. However, systematic study has not been
done on the relative validity and effectiveness of existing inflow
velocity estimation methods for various target flow fields. The aim
of this study was to examine the existing methods systematically
and to establish a method to accurately estimate inflow velocities
for various vessel geometries and flow conditions in 2D-UMI simulations. A numerical experiment was performed for 2D-UMI simulation of blood flow models in a straight vessel with inflow velocity
profiles symmetric and asymmetric to the vessel axis using existing evaluation functions based on Doppler velocity error for the
inflow velocity estimation. As a result, it was clarified that a significantly large estimation error occurs in the asymmetric flow due to
a nonfeedback domain near the downstream end of the calculation
domain. Hence, a new inflow velocity estimation method of 2DUMI simulation is proposed in which the feedback and evaluation
domains are extended to the downstream end. Further numerical
experiments of 2D-UMI simulation for two realistic vessel geometries of a healthy blood vessel and a stenosed one confirmed the
effectiveness of the proposed method.
Index Terms—Computational fluid dynamics, hemodynamics,
inflow boundary condition, measurement-integrated simulation,
ultrasound color Doppler imaging.

I. INTRODUCTION
ESEARCH on arteriosclerosis has shown that it is closely
related to hemodynamics [1], and information on hemodynamics is thereby essential for elucidation of mechanisms and
the development of novel diagnostic methods for circulatory

R

Manuscript received March 19, 2015; revised June 12, 2015; accepted July
16, 2015. Date of publication July 28, 2015; date of current version January 16,
2016. This work was supported in part by Grant-in-Aid for Scientific Research
(B) (24360064, 15H03914). Computation in this study was performed by the
super computer at the Advanced Fluid Information (AFI) Research Center,
Institute of Fluid Science, Tohoku University. Asterisk indicates corresponding
author.
∗ H. Kadowaki is with the Graduate School of Engineering, Tohoku University, Sendai 980-8579, Japan (e-mail: kadowaki@reynolds.ifs.tohoku.ac.jp).
T. Hayase and K. Funamoto are with the Tohoku University.
N. Taniguchi is with the Jichi Medical University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2461559

Fig. 1.

2D-UMI blood flow analysis system.

diseases. In order to obtain hemodynamics, the latest medical
image measurements and numerical simulations are performed
[2], [3]. However, it is difficult to reproduce the blood-flow information of hemodynamics correctly and in detail with medical
image measurements such as ultrasonic measurement and MRI.
It is also difficult to provide exact in vivo physical properties,
boundary conditions, and initial conditions for a numerical simulation. Funamoto et al. proposed an ultrasonic-measurementintegrated simulation (hereinafter abbreviated as “UMI simulation”) as a method to reproduce an in vivo blood flow field in
detail by integrating measurement and calculation [4]. This is an
application of a measurement-integrated simulation developed
by Hayase and Hayashi [5] in order to reproduce the intravascular blood flow field and hemodynamics by feeding back the
Doppler velocities from the measurement to the calculation.
Doppler velocity is the component of the blood flow velocity
vector projected in the direction of the ultrasonic beam. In a previous study, a numerical experiment of 3D blood flow analysis
by UMI simulation [6] and development of a two-dimensional
UMI (2D-UMI) blood flow analysis system for clinical application [7] were performed (see Fig. 1).
Although the error in a velocity profile of the inflow boundary condition is properly compensated by feedback in a UMI
simulation, the cross-sectional average inflow velocity (inflow
velocity) must be correctly given. In former studies, the inflow
velocity was estimated on the condition that the Doppler velocity
error in the evaluation domain set inside the calculation domain
is minimized, which is a necessary condition for the correct
inflow velocity. In recent studies, reasonable results have been
obtained by assuming an inflow velocity which minimizes the
space-averaged value of the errors of Doppler velocities (corresponding to “evaluation function EA ” mentioned later) by the
golden-section search [8], [9], or by setting the value of the error

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

404

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

of the space-averaged values of Doppler velocities (corresponding to “evaluation function EB ”) at zero by the fixed-point
iteration method [10], [11] with the evaluation domain being
identical to the feedback domain. To date, however, the validity of the methods to identify the inflow velocity based on the
Doppler velocity field has not been systematically examined so
far, and the effectiveness for various flow fields is unknown.
This study deals with 2D-UMI simulation of the longitudinal
section of intravascular blood flow fields aiming to examine the
validity of the existing methods of estimating the inflow velocity
by the Doppler velocity field and to establish an inflow velocity
estimation method which is accurate for use with various flow
fields. In this study, a numerical experiment of the 2D-UMI simulation was performed for various numerical solutions as target
blood flows. As a basic examination, the inflow velocity estimation was first conducted by two types of existing evaluation
functions: the average value of the errors of Doppler velocities
and the error of the average values of Doppler velocities. Target
flows were sinusoidally oscillating flows with symmetric and
asymmetric inflow velocity profiles in a simple straight blood
vessel model. From these results, the cause of the inflow velocity estimation error was clarified, and a new inflow velocity
estimation method was proposed. The effectiveness of the proposed method was finally confirmed by a numerical experiment
for two types of blood vessel, i.e., a healthy one and a stenosed
one obtained from clinical data.
II. METHODS
This section describes the configuration of the 2D-UMI
blood-flow simulation system and the analysis method, including the inflow velocity estimation method in Section II-A and the
method of numerical experiment to examine the inflow velocity
estimation method in Section II-B.
A. 2D-UMI Blood Flow Analysis System
A prototype of the 2D-UMI blood flow analysis system for a
human carotid artery [7] (see Fig. 1) is herein explained. Color
Doppler measurement of a human carotid artery was performed
with an ultrasonic diagnostic device (LOGIQ7, GE Healthcare
Japan, Japan) with a linear type ultrasonic probe (12L, GE
Healthcare Japan, Japan) at an ultrasonic frequency of 5 MHz
[refer to Fig. 2(a)], and the data were saved in DICOM format.
The measurement was approved by the local ethics committee,
and informed consent was obtained from the patient. In the color
Doppler image of Fig. 2(a), the monochrome domain is a tissue image displayed in B mode, and the colored domain shows
the Doppler velocity of the blood flowing from left to right.
The measurement data are saved in the ultrasonic device for
online analysis, or transmitted to a computer through a memory
card for offline analysis. In the analysis, the blood and tissue domains are binarized from time-averaged images of the B mode
and color Doppler images such as Fig. 2(a), and the orthogonal
grid system for the fluid analysis is generated. The x–y coordinate is defined as shown in Fig. 2(b). It is noted that the blood
vessel shape is rotated so as to match the direction of the blood
vessel axis with the horizontal x-axis in order to perform the
numerical analysis easily.

Fig. 2. Healthy carotid artery, (a) color Doppler image, (b) computational
grid; stenosed carotid artery, (c) color Doppler image, (d) computational grid;
and ideal straight blood vessel model, (e) computational grid.

The 2D-UMI simulation is performed assuming that the blood
vessel wall is a rigid body with the computational grid system
shown as Fig. 2(b). Governing equations are the 2D unsteady
incompressible Navier–Stokes equations (1) and pressure equation (2)


∂u
+ (u · ∇) u = μΔu − ∇p + f
(1)
ρ
∂t
Δ p = −ρ ∇ · {(u · ∇)u} + ∇ · f .

(2)

In the above expressions, u = (u, v) is the velocity, t is the
time, μ is the viscosity, ρ is the density, and p is the pressure. f
is the artificial body force as the feedback signal defined as
 2
ρUr
∗ Vc − Vm
f = −KV
· b.
(3)
Ur
Lr
The feedback signal is expressed as a product of the feedback
gain KV∗ (nondimensional) and the difference between Doppler
velocities Vm and Vc obtained by ultrasonic measurement and
numerical calculation. Ur is the characteristic velocity, Lr is the
characteristic length, and b is the unit vector along the ultrasound
beam. The case with KV∗ = 0 corresponds to an ordinary simulation without feedback. It is applied to each computational grid
in the feedback domain (xF 1 ≤ x ≤ xF 2 ) with a blue frame inside the calculation domain (x1 ࣘ x ࣘ x2 ) as shown in Fig. 2(b).
The velocity vectors in the feedback domain are corrected by
performing the numerical calculation while giving feedback
signal f.
The Doppler velocity is written as
V = u · sin α + v · cos α

(4)

KADOWAKI et al.: ESTIMATION METHOD FOR UNSTEADY INFLOW VELOCITY IN 2D-UMI BLOOD FLOW SIMULATION

where α is the net beam angle between the y-axis and the ultrasonic beam obtained as the sum of the irradiation angle of the
ultrasonic beam and the aforementioned rotation angle of the
blood vessel shape as shown in Fig. 2(b).
Boundary conditions are described below. In UMI simulation, the inflow velocity profile is arbitrarily given. The inflow
velocity U is determined so that the following evaluation function EA or EB is minimized by the golden-section search [8]
through a number of flow analyses [7], [9].

1
|Vc − Vm | dΩ
EA =
Ω Ω

1
=
|(uc − um ) sin α + (vc − vm ) cos α| dΩ
(5a)
Ω Ω
 


1

1

EB = 
Vc dΩ −
Vm dΩ
Ω Ω
Ω Ω




1 

=
(u
−
u
)
sin
αdΩ
+
(v
−
v
)
cos
αdΩ
c
m
c
m


Ω Ω
Ω

405

TABLE I
COMPUTATIONAL CONDITIONS
Blood vessel shape
Color Doppler image
Computational grid
Inlet diameter: D [mm]
Computational domain: x1 ,
x2 [mm]
Feedback domain and
evaluation domain for E A
and E B : x F 1 , x F 2 [mm]
E A∗ and E B∗ : x F 1 , x F 2
[mm]
Grid number: N x , N y
Grid spacing: Δ x, Δ y [mm]
Net beam angle: α [°]
Time step: Δ t [s]

Healthy

Stenosed

Straight

Fig. 2(a)
Fig. 2(b)
6.45
−12.4, 4.91

Fig. 2(c)
Fig. 2(d)
5.96
−10.45, 8.29

–
Fig. 2(e)
6.28
−12.4, 4.91

−10.4, 2.79

−8.63, 6.17

−10.4, 2.79

−10.4, 4.91

−8.63, 8.29

−10.4, 4.91

65, 90
0.303, 0.182
15.7
0.0751

68, 104
0.303, 0.182
22.1
0.0619

65, 90
0.303, 0.182
15.7
0.0751

(5b)
where EA is the average value of the errors of Doppler velocities, EB the error of the average values of Doppler velocities, Ω the evaluation domain, dΩ the area element, and
subscripts “c” and “m” denote the computational result and the
standard solution, respectively. In this study, the evaluation domain was defined as being identical to the feedback domain. It
is noted that the optimum solution of U for EB was efficiently
obtained during the iterative calculation of flow analysis by
the fixed-point iteration method [10] to search for U satisfying
EB = 0 [11]


1
1
EB =
Vc dΩ −
Vm dΩ.
(5c)
Ω Ω
Ω Ω
The free stream condition (∂u/∂x = ∂v/∂x = 0) was
given as the downstream boundary condition, and the no-slip
condition was given on the blood vessel wall.
The above governing equations were discretized based on a
finite volume method using a staggered grid system, and the resultant difference equations were solved with a method similar
to the SIMPLER method [12]. A reformulated QUICK scheme
[13] was used for discretization of the convection terms, and a
second-order implicit scheme was employed for the time derivative terms. The modified strongly implicit scheme [14] was employed as the solver of linear algebraic equations.
B. Numerical Experiment
In this section, a method of a numerical experiment for consideration of inflow velocity estimation is described. In this study,
numerical solutions with two inflow velocity profiles at the upstream boundary for three blood vessel shapes were defined as
standard solutions, namely, analysis objects, and 2D-UMI simulation was performed to reproduce these standard solutions
while estimating the inflow velocity.
A healthy blood vessel of a female in her 70s [see Fig. 2(a) and
(b)], a stenosed blood vessel of a male in his 60s [see Fig. 2(c)

Fig. 3. Upstream boundary velocity profiles of standard solutions with (a)
symmetric velocity profile and (b) asymmetric velocity profile.

and (d)], and an ideal straight blood vessel [see Fig. 2(e)] were
used for blood vessel shape of the standard solutions. The computational conditions of these blood vessels are given in Table I.
The computational grid sizes Δx and Δy, the net beam angle
α, and the time step increment Δt correspond to those of the
ultrasonic color Doppler measurement. The computational conditions of the straight model were set referring to those of the
healthy blood vessel.
Symmetric and asymmetric inflow velocity profiles are defined for the standard solutions [see Fig. 3(a) and (b)].
Symmetric
 

10
y − y0
11
U (t) −
−1
+1 .
(6a)
u(x1 , y, t) =
10
D/2
Asymmetric
⎧ 
2 ⎫
⎨
⎬
1
1
U (t) −
u(x1 , y, t) =
−
2
+1
.
0
⎩
⎭
6 (log 3 − 1)
1 − 23 y −y
D
(6b)
A parabolic profile was used for 2D-UMI and ordinary simulations
 

2
y − y0
3
−1 +1
(6c)
u(x1 , y, t) = U (t) −
2
D/2
where x1 is the x-coordinate of the upstream boundary, U (t)
is the inflow velocity, and y0 ≤ y ≤ y0 + D, and y0 is the ycoordinate of the upper vessel wall of the upstream boundary.

406

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 4. Computational results of an ordinary simulation for K V∗ = 0 and 2D-UMI simulation for K V∗ = 500, 5000 for symmetric standard solution. Variations
of (a) inflow velocity, (b) inflow velocity difference, (c) space-averaged Doppler velocity error, and (d) space-averaged velocity vector error.

Vertical velocity v(x, y, t) of the upstream boundary was set
to 0.
The inflow velocity U (t) of the standard solutions was defined
as an unsteady sinusoidal oscillation with a steady component
as
U (t) = U0 + Ua · sin(2πf t)

(7)

where the inflow average velocity U0 was set to 0.25 m/s, the
amplitude of the inflow velocity Ua was set to 0.2 m/s, and the
frequency f was set to 1 Hz.
The initial values of all velocity components in the flow analysis were set to 0. Considering human blood, the density ρ and
the kinematic viscosity ν of the fluid were set to 1.0 × 103
kg/m3 and 4.0 × 10−6 m2 /s, respectively. The search range of
the inflow velocity U in a golden-section search was the same
as that of the reference on clinical application of 2D-UMI simulation [7] and was set in the range between −0.1 and 0.5 m/s,

which is sufficiently larger than the maximum and minimum
blood flow velocities in a typical human carotid artery [15]. The
flow analysis was performed with nondimensional variables.
As for characteristic values, characteristic length Lr was set as
diameter D of the blood vessel at the upstream boundary, the
characteristic velocity Ur was conveniently set to 0.1 m/s, and
the density ρ was used as the other characteristic value. The
convergence criterion of the flow analysis was set to 1.0 × 10-4
(nondimensional), and that of the golden-section search was set
to 1.0 × 10-3 (nondimensional). As to a typical CPU time, it
takes a general personal computer about two minutes for one
time step under the computational conditions in this study.
A numerical experiment in this study was performed by
the following procedures. First, 2D-UMI simulations were performed for a simple straight blood vessel model [see Fig. 2(e)] as
a basic investigation. Inflow velocity estimation was performed
using the evaluation functions EA and EB with the former

KADOWAKI et al.: ESTIMATION METHOD FOR UNSTEADY INFLOW VELOCITY IN 2D-UMI BLOOD FLOW SIMULATION

407

Fig. 5. Computational results of an ordinary simulation for K V∗ = 0 and 2D-UMI simulation for K V∗ = 500, 5000 for asymmetric standard solution. Variations
of (a) inflow velocity, (b) inflow velocity difference, (c) space-averaged Doppler velocity error, and (d) space-averaged velocity vector error.

feedback and evaluation domains and newly proposed ones. The
2D-UMI simulations were performed for a range of feedback
gain 0 ≤ KV∗ ≤ 5000. Based on systematic analysis, an optimum estimation method was proposed. As representative values
of the feedback gain, KV∗ = 0 corresponding to an ordinary simulation, KV∗ = 500, which was suggested to use in clinical application considering aspects of calculation cost and analysis accuracy [7], and a sufficiently large value of KV∗ = 5000 were used.
Next, the effectiveness of the proposed method for various blood vessel shapes was confirmed. The 2D-UMI simulation with KV∗ = 500 and an ordinary simulation with KV∗ = 0
were performed for the healthy and stenosed blood vessels [see
Fig. 2(b) and (d)].
The calculation results were evaluated by the normalized errors of the inflow velocity eU , the Doppler velocity eV , the

velocity vector eu , and each velocity component eu and ev
eU (t) =
eV (x, y, t) =

|Uc (t) − Um (t)|
U0

(8a)

|Vc (x, y, t) − Vm (x, y, t)|
Vtyp e

(8b)

eu (x, y, t)
= eu (x, y, t) + ev (x, y, t)
=

|uc (x, y, t) − um (x, y, t)|
utyp e
+

|vc (x, y, t) − vm (x, y, t)|
utyp e

(8c)

408

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 6. Variations of the time-averaged (a) inflow velocity error, (b) time-space-averaged Doppler velocity error, and (c) time-space-averaged velocity vector
error for the symmetric standard solution (left side) and the asymmetric one (right side) obtained by four evaluation functions with the feedback gain in 2D-UMI
simulation.

where subscripts “c” and “m” denote the 2D-UMI or ordinary simulation result and the standard solution, respectively.
As to the characteristic velocities for normalization, we used
the inflow average velocity U0 (= 0.25 m/s) [refer to (7)],
the literature data 0.39 m/s of the maximum mean Doppler
velocity in common carotid artery [16] for Vtyp e , and the
maximum inflow velocity 0.45 m/s of the standard solution
for utyp e . These errors were accordingly expressed as the
space-averaged values with the subscript “ave” such as
eV av e (t) and euav e (t), and as time-averaged values during
one cycle in the third period with an overbar such as ēU , ēV ,
and ēu .
III. RESULTS
A. Ideal Straight Blood Vessel Model
Computational results of 2D-UMI simulation for the feedback gain KV∗ = 0 (ordinary simulation), 500, and 5000 for the
standard solutions of the symmetric flow in a simple straight
blood vessel model are shown in Fig. 4. The figures on the

left correspond to the evaluation function EA , and those on the
right correspond to EB . The figures show variations of the inflow velocity U, the inflow velocity difference from the standard
solution ΔU = Uc − Um , the space-averaged Doppler velocity
error eV av e , and the velocity vector error euav e [see (8a)–(8c)].
Errors of the inflow velocity, the Doppler velocity, and the velocity vector for both EA and EB gradually decrease with increasing feedback gain. The inflow velocity error for EB [see
the figure on the right in Fig. 4(b)] is smaller than that for EA
[see the figure on the left in Fig. 4(b)], but the other errors are
almost the same [see Fig. 4(c) and (d)].
Next, Fig. 5 shows the corresponding results for the standard
solution of the asymmetric flow. The inflow velocity errors
shown in Fig. 5(b) for the evaluation function EA (left side)
and EB (right side) are considerably larger than those for
the symmetric standard solution in Fig. 4(b). In both cases of
EA and EB , inflow velocity errors for KV∗ = 500 are larger
than those for KV∗ = 0, showing nonmonotonic reduction
of the error with increasing the feedback gain. The Doppler
velocity errors in Fig. 5(c) are slightly larger than those for

KADOWAKI et al.: ESTIMATION METHOD FOR UNSTEADY INFLOW VELOCITY IN 2D-UMI BLOOD FLOW SIMULATION

409

Fig. 7. Cross-section-averaged values in the y-direction of (a) Doppler velocity error, (b) velocity vector error, (c) u velocity component error, and (d) v
∗ and E ∗∗
velocity component error for the asymmetric standard solution of the ordinary simulation (K V∗ = 0) and the UMI simulations (K V∗ = 500) for E A , E A
A
(t = 2.25 s).

the symmetric standard solution in Fig. 4(c), but decrease with
increasing feedback gain showing the same trend. The velocity
vector errors in Fig. 5(d) are larger than those for the symmetric
standard solution in Fig. 4(d), and the results for KV∗ = 0 are
almost the same as those for KV∗ = 500.
Fig. 6(a)–(c) shows the time-averaged inflow velocity error,
the time-space-averaged Doppler velocity error, and the timespace-averaged velocity vector error with the feedback gain. The
figures on the left correspond to the symmetric standard solution,
and those on the right correspond to the asymmetric standard
solution. The results for the existing evaluation functions EA
and EB are described here, and the results for EA∗ and EB∗
shown in the figure are described later. Comparing the inflow
velocity errors for the symmetric standard solution in the figure
on the left in Fig. 6(a), the error for the evaluation function EA
is consistently larger than that for EB . In the figure on the right,
for the asymmetric standard solution, errors for both evaluation
functions EA and EB are considerably larger than those for the
symmetric one in the figure on the left. The maximum error
for the asymmetric case for EA for KV∗ = 500 is 3.6 times
larger than the maximum error for the symmetric case for EA
for KV∗ = 0. The maximum error for EB for KV∗ = 1000 is as
large as the maximum error for EA . The Doppler velocity errors
shown in Fig. 6(b) gradually decrease with increasing feedback
gain for both symmetric and asymmetric standard solutions. The
errors for the asymmetric case are about twice as large as those
for the symmetric one. Concerning the velocity vector errors
shown in Fig. 6(c), the errors for the evaluation functions EA
and EB are almost the same for the symmetric case in the figure
on the left. The variations of the errors for the asymmetric case
are similar to those of the inflow velocity errors in the right

side of Fig. 6(a), and are considerably larger than those for the
symmetric case in the left side of Fig. 6(c).
Fig. 7(a)–(d) shows the Doppler velocity error, the velocity
vector error, and the u and v velocity component errors averaged in the y-direction over the cross section. The results shown
by solid and gray thick lines correspond to the 2D-UMI simulation at the systolic phase (t = 2.25 s) for the asymmetric
standard solution for KV∗ = 500, which resulted in the largest
inflow velocity error in Fig. 6(a) and the ordinary simulation
in the same condition (the results for EA∗ and EA∗∗ shown in
the figure are described later). Concerning the Doppler velocity
error distributions shown in Fig. 7(a), the error of the 2D-UMI
simulation is smaller than that of the ordinary simulation in the
feedback domain, whereas it rapidly increases from the downstream end of the feedback domain to the downstream boundary
of the computational domain. Concerning the velocity vector error distributions shown in Fig. 7(b), the error of the 2D-UMI
simulation is almost the same as that of the ordinary simulation in the feedback domain and that of the downstream non
feedback domain. As for the u velocity component error distributions shown in Fig. 7(c), the error of the 2D-UMI simulation
is also as large as that of the ordinary simulation and almost
the same as the velocity vector error in the feedback domain
and the downstream nonfeedback domain. As for the v velocity
component error distributions shown in Fig. 7(d), the error of
the 2D-UMI simulation is much larger than that of the ordinary
simulation in the feedback domain, and it decreases to zero in
the downstream nonfeedback domain.
In order to confirm the flow field structure of the 2D-UMI
simulation for the evaluation function EA , the velocity vectors
and Doppler velocity distribution at the systolic phase

410

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 8. Velocity vectors and Doppler velocity distribution (left side) and streamlines and Doppler velocity error distribution (right side) of the computational
results (t = 2.25 s). (a) Standard solution, (b) 2D-UMI simulation (K V∗ = 500) for evaluation function E A , and (c) 2D-UMI simulation (K V∗ = 500) for
∗ .
evaluation function E A

(t = 2.25 s) are shown in the figures on the left hand side
of Fig. 8, and the streamlines and Doppler velocity error distributions are shown in the figures on the right hand side of Fig. 8.
Fig. 8(a) shows the standard solution, and Fig. 8(b) shows the
result of the 2D-UMI simulation. Fig. 8(c) is described later.
As for the velocity vectors of the standard solution in the figure
on the left hand side of Fig. 8(a), the asymmetric profile given
at the upstream boundary remains almost unchanged up to the
downstream end, while for those of the 2D-UMI simulation in
Fig. 8(b), the parabolic profile at the upstream boundary does
not converge to that of the standard solution in the downstream
direction in the feedback domain and a reversal flow appears
near the upper wall at x = xF 2 at the downstream end of the
feedback domain. There is no large difference between the standard solution and 2D-UMI simulation regarding the Doppler
velocity distribution in the feedback domain. As for the streamlines in the figures on the right, those of the standard solution
are almost parallel to the x-direction, as shown in Fig. 8(a),
while those of the 2D-UMI simulation in Fig. 8(b) are deflected
to the lower side of the vessel in the feedback domain, and an
unrealistic flow separation region appears near the downstream
end. As for the Doppler velocity error distribution of Fig. 8(b),
the value is small in the feedback domain, but a large error occurs
in the flow separation region and in the upstream nonfeedback
domain.
According to the above result, it is considered that an increase
in the Doppler velocity error in the downstream nonfeedback
domain (xF 2 ≤ x ≤ x2 ) is the cause of no improvement in the

velocity field of 2D-UMI simulation in the feedback domain
over that of the ordinary simulation. In order to remove the
effect of the downstream nonfeedback domain, we defined new
evaluation functions EA∗ and EA∗∗ , in which the formulation is the
same as that of EA in (5a), and both the feedback and evaluation
domains are extended to the downstream end (xF 1 ≤ x ≤ x2 )
(EA∗ ) or the evaluation domain is extended to the downstream
end without changing the feedback domain (EA∗∗ ). The 2D-UMI
simulation was performed using the evaluation functions EA∗
and EA∗∗ to clarify the effect of the feedback and evaluation
domains on analysis accuracy.
The computational results are shown in Fig. 7(a)–(d) by broken and dotted lines. The Doppler velocity error for the evaluation function EA∗ shown by a broken line in Fig. 7(a) is slightly
larger than that for EA in the feedback domain of EA , but it
does not increase in the downstream nonfeedback domain of
EA . The result for the evaluation function EA∗∗ shown by a dotted line in Fig. 7(a) is almost the same as that for EA in the
feedback domain of EA and is between those of EA and EA∗
in the downstream nonfeedback domain. The errors of the velocity vector and u and v velocity components for EA∗ shown in
Fig. 7(b)–(d) monotonically decrease in the feedback domain
and are substantially smaller than those for EA . The errors for
EA∗∗ are between those for EA and EA∗ . From the above results,
it was revealed that the solution for the evaluation function
EA∗ with the feedback and evaluation domains extended to the
downstream end best reproduces the flow field of the standard
solution.

KADOWAKI et al.: ESTIMATION METHOD FOR UNSTEADY INFLOW VELOCITY IN 2D-UMI BLOOD FLOW SIMULATION

411

Fig. 9. Comparisons between (a) time-averaged relative inflow velocity error, (b) time-space-averaged Doppler velocity error, and (c) time-space-averaged
velocity vector error of the 2D-UMI simulations (K V∗ = 500) for the symmetric (left side) and asymmetric (right side) standard solutions for four evaluation
functions in three blood vessels in the evaluation domain.

The resultant flow field obtained by 2D-UMI simulation for
the evaluation function EA∗ is shown in Fig. 8(c). As for the
velocity vectors shown in the figure on the left, the parabolic
profile given at the upstream boundary converges to the asymmetric one of the standard solution in the feedback domain. The
streamlines in the figure on the right in Fig. 8(c) also converge
to those of the standard solution in Fig. 8(a) in the feedback
domain. The Doppler velocity errors in the figure on the right in
Fig. 8(c) are slightly larger than those in Fig. 8(b) in the feedback domain of Fig. 8(b), but monotonically decrease toward
the downstream end. These results directly show the superiority
of EA∗ to EA in reproducibility of the standard solution.
Furthermore, the evaluation function EB∗ was defined by extending the feedback and evaluation domains of EB in the same
way as EA and EA∗ . The results of computations for the symmetric and asymmetric standard solutions by use of the evaluation
functions EA∗ and EB∗ are shown by  and in Fig. 6. Errors
of the inflow velocity [see Fig. 6(a)] and the velocity vector [see
Fig. 6(c)] for EA∗ and EB∗ are drastically reduced from those
for EA and EB . In comparison between EA∗ and EB∗ , the inflow velocity error for EA∗ is much smaller than that for EB∗

•

in KV∗ ≥ 200 in the asymmetric case in which the inflow velocity error is relatively large. In conclusion, EA∗ is the optimal
evaluation function among these investigations because the errors of inflow velocity and velocity vector are minimal in the
aforementioned range of feedback gain usually used in 2D-UMI
simulation [7].
B. Healthy and Stenosed Vessels of Clinical Data
In order to examine the effectiveness of the optimum evaluation function EA∗ proposed in the preceding section for various
blood vessel shapes, 2D-UMI and ordinary simulations were
performed for four standard solutions with the symmetric or
asymmetric inflow velocity profile in a healthy or a stenosed
blood vessel shapes by use of evaluation functions EA , EB ,
EA∗ , and EB∗ . The calculation results are compared with those
for the ideal straight blood vessel model examined in the preceding section.
Fig. 9 shows comparisons of the time-averaged inflow velocity errors [see Fig. 9(a)], the time-space-averaged Doppler
velocity errors [see Fig. 9(b)], and the time-space-averaged

412

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 10. Comparisons between (a) time-averaged relative inflow velocity error, (b) time-space-averaged Doppler velocity error, and (c) time-space-averaged
velocity vector error of ordinary simulations (K V∗ = 0) for the symmetric (left side) and asymmetric (right side) standard solutions for four evaluation functions
in three blood vessels in the evaluation domain.

velocity vector errors [see Fig. 9(c)] of the 2D-UMI simulations for KV∗ = 500 for the evaluation functions EA , EB , EA∗ ,
and EB∗ between the straight blood vessel model, healthy, and
stenosed blood vessels. In these results, the spatial average was
calculated in each feedback domain. The figures on the left are
the results for the symmetric standard solution, whereas the ones
on the right are those for the asymmetric one. For the symmetric case in the figure on the left in Fig. 9(a), the relative inflow
velocity errors are all small whereas the error for EA in the
straight blood vessel model and that for EB in the healthy one
are somewhat large. For the asymmetric case in the figure on
the right in Fig. 9(a), the errors in the straight and healthy blood
vessels for EA and EB are very large, and the errors for EB∗ are
somewhat large. Errors for EA∗ are small in analysis in all cases.
The errors for the stenosed blood vessel are relatively small in all
evaluation functions. Fig. 9(b) shows that Doppler velocity errors increase in the order of EA , EB , EA∗ and EB∗ except for the
results of the symmetric case in the straight blood vessel model
in which all errors are the same. The errors in the stenosed blood
vessel are slightly larger than those in the straight and healthy
ones. The velocity vector errors for the symmetric standard solution in the figure on the left in Fig. 9(c) are all small, while the
error in the healthy blood vessel for EB is somewhat large. For

the asymmetric case in the figure on the right in Fig. 9(c) the
errors in the straight and healthy blood vessels for EA and EB
are very large. The errors for EA∗ are small in all blood vessels.
The errors in the stenosed blood vessel are comparable for all
evaluation functions.
Fig. 10 shows a comparison of the errors of the ordinary
simulation for KV∗ = 0 corresponding to those of Fig. 9. For
the symmetric standard solution shown in the figure on the
left in Fig. 10(a) the inflow velocity errors for EA and EA∗ in
the straight and healthy blood vessels are large, whereas those
for EB and EB∗ are small. The errors in the stenosed one are
all small. For the asymmetric standard solution in the figure
on the right in Fig. 10(a), the errors are larger than those for
the symmetric case in the figure on the left, but their relative
magnitudes are similar. In the ordinary simulation, EA∗ has no
superiority among the evaluation functions seen in the 2D-UMI
simulation. In comparison with the results in Fig. 9(a), the 2DUMI simulation using EA∗ gives the best result in the inflow
velocity estimation. For the Doppler velocity errors in Fig. 10(b),
the errors for the asymmetric case in the figure on the right are
larger than those for the symmetric case in the figure on the left,
and all the errors of the ordinary simulation are larger than those
of the 2D-UMI simulation shown in Fig. 9(b). As to the velocity

KADOWAKI et al.: ESTIMATION METHOD FOR UNSTEADY INFLOW VELOCITY IN 2D-UMI BLOOD FLOW SIMULATION

vector errors in Fig. 10(c), errors for the asymmetric case are
larger than those for the symmetric one and all the errors are
larger than those of the 2D-UMI simulation, similar to the case
of the Doppler velocity errors.
According to the above results, it is shown that the evaluation function EA∗ , in which the evaluation domain and the
feedback domain are extended to the downstream end of the
computational domain and the inflow velocity is determined to
minimize the space-averaged value of the errors of Doppler velocities, results in the optimum inflow velocity estimation of a
2D-UMI simulation which is accurate and applicable for various
flow fields in the condition examined.
IV. DISCUSSION
In this study, we clarified the validity of the existing methods to estimate the inflow velocity by the Doppler velocity field
for the 2D-UMI simulation and established a general and accurate inflow velocity estimation method based on the evaluation
function EA∗ in which both the evaluation and feedback domains
were extended to the downstream end. The method is applicable
for various vessel geometries and flow conditions.
Evidence for the generality and accuracy of the proposed
method is that the maximum relative errors of the inflow velocity by the evaluation functions EA , EB , EA∗ , and EB∗ in
2D-UMI simulation with a typical feedback gain of KV∗ = 500
for various standard solutions with three blood vessel shapes
and two inflow velocity profiles were 35%, 27%, 2%, and 6%,
confirming that EA∗ of the proposed method resulted in the lowest value. In a straight blood vessel model, the error for the
evaluation function EA∗∗ , with an extended evaluation domain
and nonextended feedback domain, was between those of EA
and EA∗ , confirming the importance of extending the feedback
domain to the downstream end for accurate estimation.
The reason why the evaluation functions EA∗ and EB∗ give
better inflow estimations than existing ones is discussed below.
The existing evaluation functions EA and EB permit errors
of the Doppler velocity and velocity vector in the downstream
nonfeedback domain, and result in inflow velocity estimation for
which the Doppler velocity error is small although the velocity
vector error is large. With the new evaluation functions EA∗ and
EB∗ , such a thing does not occur since the feedback domain
is extended to the downstream end, resulting in more accurate
estimations.
The reason why the evaluation function EA∗ gives a better
inflow estimation than EB∗ is discussed below. The evaluation
functions EA∗ and EB∗ are represented in (5a) and (5b). Generally
speaking, the evaluation function EA∗ is more sensitive to the
difference between the result of 2D-UMI or ordinary simulation
and the standard solution than the evaluation function EB∗ since
the latter is evaluated in the whole domain and some errors at
different grid points can cancel each other out. It is also noted
that the inflow velocity error depends only on the streamwise
velocity component u, but the evaluation functions EA∗ and EB∗
depend also on the transverse velocity component v. If the term
(vc − vm ) cosα is negligible, the evaluation function EB∗ , which
is less sensitive to the u velocity profile, gives a better estimate

413

of inflow velocity error than EA∗ [see Fig. 6(a) with KV∗ = 0].
Otherwise, the evaluation function EA∗ , which is sensitive to the
error in v velocity component, gives a better estimate of inflow
velocity error than EB∗ .
In the relatively simple blood vessel shape of the straight
and healthy ones, the differences in the estimation accuracy
between the four evaluation functions in the 2D-UMI simulation
were marked, especially for the case of asymmetric inflow. In
a complicated blood vessel shape with stenosis, the differences
and the error themselves were relatively small in comparison
with the former vessels, as shown in Fig. 9(a). As the reason for
the dependence on vessel geometry, it is considered that a large
velocity component of u is caused in a stenosed part and that
the evaluation of the error in Doppler velocity is less affected
by the v velocity component.
In a related study, Yamagata and Hayase [9] performed a
numerical experiment to evaluate the effectiveness of inflow
velocity estimation using evaluation function EA in 2D-UMI
simulation, but the effects of the velocity profile and blood vessel shape on the estimation accuracy were not discussed in detail.
In this study, the effects of the velocity profile and blood vessel
shape were systematically investigated, indicating the possibility that estimation accuracy is drastically degraded in the case of
an asymmetric flow. A method to accurately estimate the inflow
velocity for various vessel geometries and flow conditions in
2D-UMI simulation was established by extending the feedback
domain to the downstream end.
It is expected that the inflow velocity estimation method proposed in this study will make it possible to perform accurate
blood flow analyses by 2D-UMI simulations for various vessel
geometries and flow conditions. However, it is still necessary
to resolve some problems. First, the effect of the position of
the upstream boundary of the feedback domain remains to be
examined. Although the effect of the upstream position of the
feedback domain in 2D-UMI simulation on the calculation accuracy has been discussed in a former study [17], it is necessary
to discuss the effect on the inflow velocity estimation anew. As
for the efficiency of the method used to search for the inflow
velocity, the golden-section search used in this study requires
a number of flow analyses during the estimation process. Improvement of computational efficiency by using the fixed-point
iteration method during the iterative flow analysis procedure
needs to be examined in the future. As for the effectiveness
for in vivo blood flow analysis, this study dealt with simple 2D
blood flow in a longitudinal cross section of rigid blood vessel configuration focusing on clinical applications. There is an
essential problem of the effectiveness of such an analysis for
actual 3D blood flow in a compliant blood vessel.
V. CONCLUSION
In this study, the validity of the existing methods to estimate
an unsteady inflow velocity in 2D-UMI simulation for intravascular blood flow analysis was systematically investigated, and
a new estimation method applicable to various vessel geometries and flow conditions was proposed. A numerical experiment was performed for the 2D-UMI simulation of blood flows

414

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

in a simple straight blood vessel model with inflow velocity
profiles symmetric and asymmetric to the vessel axis using two
existing evaluation functions for the inflow velocity estimation:
the average value of the errors of Doppler velocities and the
error of the average values of Doppler velocities. As a result,
it was clarified that a significantly large estimation error occurs
in the asymmetric flow due to nonreduced velocity vector error
in spite of reduced Doppler velocity error for 2D-UMI simulation which has a nonfeedback domain near the downstream
end. A new inflow velocity estimation method in which the
feedback domain is extended to the downstream end was proposed and its effectiveness was confirmed. A further numerical
experiment of 2D-UMI simulation for two realistic vessel geometries of a healthy blood vessel and a stenosed one confirmed
the effectiveness of the proposed method and the superiority
of the evaluation function with the average value of the errors
of Doppler velocities to that of the error of the average values
of Doppler velocities.

[14] M. Zedan and G. E. Schneider, “A modified strongly implicit procedure
for the numerical solution of field problems,” Numerical Heat Transfer,
vol. 4, no. 1, pp. 1–19, Jan. 1981.
[15] P. Scheel et al., “Flow velocity and flow volume measurements in the
extracranial carotid and vertebral arteries in healthy adults: Reference
data and the effects of age,” Ultrasound Med. Biol., vol. 26, no. 8,
pp. 1261–1266, Oct. 2000.
[16] M. Kitaoka et al., “Standard method for ultrasound evaluation of carotid
artery lesions,” J. Med. Ultrason., vol. 36, no. 4, pp. 219–226, Dec. 2009.
[17] K. Funamoto et al., “Numerical study on variation of feedback methods in ultrasonic-measurement-integrated simulation of blood flow in the
aneurysmal aorta,” JSME Int. J. Series C-Mechanical Syst. Mach. Elements Manuf., vol. 49, no. 1, pp. 144–155, Mar. 2006.

Hiroko Kadowaki received the Master’s degree in
engineering in 2013 from Tohoku University, Sendai,
Japan. She is currently working toward the Ph.D.
degree in engineering at Tohoku University.
Her research interest includes an integration of
medical measurement and computation.

ACKNOWLEDGMENT
The authors would like to thank T. Shimazaki, T. Jibiki, and
K. Miyama, at GE Healthcare Japan Corporation, for their help
in exporting ultrasonic measurement data for hemodynamic
analysis.
REFERENCES
[1] Y. S. Chatzizisis and G. D. Giannoglou, “Pulsatile flow: A critical modulator of the natural history of atherosclerosis,” Med. Hypotheses, vol. 67,
no. 2, pp. 338–340, Feb. 2006.
[2] S. W. Lee et al., “Correlations among indicators of disturbed flow
at the normal carotid bifurcation,” J. Biomech. Eng., vol. 131, no. 6,
pp. 061013-1–061013-7, Jun. 2009.
[3] S. Ricci et al., “Real-time vector velocity assessment through multigate
Doppler and plane waves,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control, vol. 61, no. 2, pp. 314–324, Feb. 2014.
[4] K. Funamoto et al., “Fundamental study of ultrasonic-measurementintegrated simulation of real blood flow in the aorta,” Ann. Biomed. Eng.,
vol. 33, no. 4, pp. 415–428, Apr. 2005.
[5] T. Hayase and S. Hayashi, “State estimator of flow as an integrated computational method with the feedback of online experimental measurement,”
J. Fluids Eng., vol. 119, no. 4, pp. 814–822, Dec. 1997.
[6] K. Funamoto et al., “Numerical experiment for ultrasonic-measurementintegrated simulation of three-dimensional unsteady blood flow,” Ann.
Biomed. Eng., vol. 36, no. 8, pp. 1383–1397, Jan. 2008.
[7] T. Kato et al., “Development and feasibility study of a twodimensional ultrasonic-measurement-integrated blood flow analysis system for hemodynamics in carotid arteries,” Med. Biol. Eng. Comput.,
vol. 52, no. 11, pp. 933–943, Sep. 2014.
[8] W. H. Press, Numerical Recipes: The Art of Scientific Computing. Cambridge, U.K.: Cambridge Univ. Press, 1986.
[9] T. Yamagata and T. Hayase, “Blood flow analysis by ultrasonicmeasurement-integrated simulation with flow rate estimation,” in Proc. 9th
Int. Symp. Tohoku Univ. Global COE Programme Global Nano-Biomed.
Eng. Educ. Res. Netw. Centre, 2009, pp. 114–115.
[10] R. L. Burden and J. D. Faires, Numerical Analysis. Boston, MA, USA:
Prindle, Weber & Schmidt, 1985.
[11] S. Sakanishi et al., “Validation of blood vessel geometry reconstruction
and of blood flow analysis by ultrasonic-measurement-integrated flowstructure interaction simulation system for small animals,” in Proc. 15th
Int. Conf. Biomed. Eng., 2013, p. 136.
[12] S. V. Patankar, Numerical Heat Transfer Fluid Flow. Washington, DC,
USA: Hemisphere Pub. Corp., 1980.
[13] T. Hayase et al., “A consistently formulated QUICK scheme for fast and
stable convergence using finite-volume iterative calculation procedures,”
J. Comput. Phys., vol. 98, no. 1, pp. 108–118, Jan. 1992.

Toshiyuki Hayase received the Ph.D. degree in engineering in 1987 from Nagoya University, Nagoya,
Japan.
From 1980 to 1990, he was a Research Associate at Nagoya University. He became an Associate
Professor at the Institute of Fluid Science, Tohoku
University, Sendai, Japan, in 1990, and has been a
Professor since 2000. His research interest includes
the measurement integrated simulation of complex
flow problems.

Kenichi Funamoto received the Ph.D. degree in engineering in 2007 from Tohoku University, Sendai,
Japan.
From 2008 to 2014, he was an Assistant Professor
at the Institute of Fluid Science, Tohoku University.
Since 2015, he has been an Associate Professor at the
Frontier Institute for Interdisciplinary Sciences, Tohoku University. His interests include hemodynamics
and microfluidics.

Nobuyuki Taniguchi had graduated from Jichi Medical University, Shimotsuke, Japan, in 1980, and received the Doctor degree in medicine in 1994.
He has been a Professor at the Clinical Laboratory Medicine, Jichi Medical University, since 2006.
His research interests include the ultrasound diagnosis and tissue characterization using ultrasound.

