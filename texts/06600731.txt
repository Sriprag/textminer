IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

991

Red Blood Cell Tracking Using Optical
Flow Methods
Dongmin Guo, Anne L. van de Ven, and Xiaobo Zhou

Abstract—The investigation of microcirculation is an important
task in biomedical and physiological research because the microcirculation information, such as flow velocity and vessel density, is
critical to monitor human conditions and develop effective therapies of some diseases. As one of the tasks of the microcirculation
study, red blood cell (RBC) tracking presents an effective approach
to estimate some parameters in microcirculation. The common
method for RBC tracking is based on spatiotemporal image analysis, which requires the image to have high qualification and cells
should have fixed velocity. Besides, for in vivo cell tracking, cells
may disappear in some frames, image series may have spatial and
temporal distortions, and vessel distribution can be complex, which
increase the difficulties of RBC tracking. In this paper, we propose
an optical flow method to track RBCs. It attempts to describe the
local motion for each visible point in the frames using a local displacement vector field. We utilize it to calculate the displacement
of a cell in two adjacent frames. Additionally, another optical flowbased method, scale invariant feature transform (SIFT) flow, is
also presented. The experimental results show that optical flow is
quite robust to the case where the velocity of cell is unstable, while
SIFT flow works well when there is a large displacement of the
cell between two adjacent frames. Our proposed methods outperform other methods when doing in vivo cell tracking, which can be
used to estimate the blood flow directly and help to evaluate other
parameters in microcirculation.
Index Terms—In vivo cell tracking, intravital microscopy imaging, optical flow, red blood cells, scale invariant feature transform
(SIFT) flow.

I. INTRODUCTION
ICROCIRCULATION is pivotal for the maintenance of
human’s tissues and organs since the exchange of oxygen
and nutrients between blood and tissue occurs at this level. Diseases such as diabetes [1], hypertension [2], and cancer [3], [4]
are associated with changes in microcirculation. Changes at

M

Manuscript received April 4, 2013; revised August 2, 2013; accepted September 5, 2013. Date of publication September 16, 2013; date of current version
May 1, 2014. This work was supported by Funding: NIH U01HL111560-01
(Zhou), NIH 1U01CA166886-01 (Zhou), NIH 1R01DE022676-01 (Zhou) and
in part by a NIH/NCI Physical Sciences Oncology Center (PS-OC) Pilot Project
Award to AV and ML as part of the Methodist (U54CA143837) PS-OC Center.
D. Guo and X. Zhou are with Department of Radiology, Wake Forest University Health Sciences, Winston-Salem, NC 27157 USA (e-mail:
dguo@wakehealth.edu; xizhou@wakehealth.edu).
A. L. van de Ven is with Department of Physics, Northeastern University,
360 Huntington Ave, Boston MA 02115 USA (e-mail: a.vandevenmoloney@
neu.edu).
This paper has supplementary downloadable material available at
http://ieeexplore.ieee.org.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2281915

the level of the microcirculation can significantly impact tissue
structure and function [5]. Therefore, monitoring microcirculation information can help to detect potential diseases at an
early stage. Thanks to the use of cellular markers tagged with
fluorescent protein, some microcirculation information, such as
oxygen saturation, vessel diameter, flow velocity, vessel density,
and permeability, is easy to obtain by a noninvasive way, which
is based on analyzing imaging of the microvessels by using a
microscopy [6]–[9]. The analysis of these images allows us to
obtain multiple microcirculation parameters. RBCs take a critical role in oxygen transport through microcirculation. Therefore, tracking RBCs is crucial to measure plasma flow velocity,
RBC passage velocity, and even oxygen saturation [8], [10].
There are several methods used for RBC tracking; most
of them are based on the analysis of a spatiotemporal image [8], [11], [12]. However, these methods require that cells
should move with stable velocity and the trajectory of cells
should be very clear in blood vessels. Additionally, for in vivo
cell tracking, there are some challenging problems we cannot
avoid. First, cells may move in and out of the plane-of-focus
in large vessels, which causes cells disappear in some frames.
Second, the imaging area is rarely stationary due to the heartbeat and movement of subject. Thus, the image series may have
both spatial and temporal distortions. Third, blood flow can be
highly complex in cases such as cancer, with blood cells simultaneously flowing in multiple directions. The common methods
aforementioned cannot work well in these cases. More effective
methods are highly required.
In this paper, we obtain a time series of in vivo blood flow
images in tumor-bearing mice by high-resolution intravital microscopy (IVM) of fluorescently labeled RBCs. We propose
two methods for automatic tracking and measurement of the
motion of RBCs in the microvessels based on the optical flow
algorithm [13], [14], which attempts to describe the local motion for each visible point in an image sequence using a local
displacement vector field. Here, we use the algorithm to calculate the displacement of a cell in two adjacent frames in the
blood cell movement video. In our method, we first use a mathematical morphology method to obtain the location of a cell in
the first frame. Then, in the following frames, we calculate the
displacement of the cell between two adjacent frames. Hence,
we can obtain a cell’s location in every frame in the video and
the trajectory of cell movement is therefore recorded. With the
information, we can easily calculate some microcirculation parameters, such as blood flow velocity and oxygen saturation.
Considering that the method cannot solve the problems in all
cases of cell movement, another optical flow method, SIFT flow,
which tries to align an image to its nearest neighbors in a large

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

992

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

characterized by pulsatile RBC movement and simultaneous
RBC movement in multiple directions. Quantitative data were
extrapolated using the analysis techniques described next.
III. METHOD

Fig. 1. Representative video frame of RBCs (blue) in the vasculature (green)
of a BCM-4195 tumor.

number of images by extracting keypoints of an image, is also
presented. The experimental results show that both methods can
track cells accurately. Optical flow is especially robust in cases
where the velocity of the cell is unstable, while SIFT flow works
well when there is a large cell displacement between adjacent
frames. In contrast, common cell tracking methods which are
all based on spatiotemporal images, cannot conduct effective
cell tracking in these cases. Therefore, our proposed methods
outperform other methods for in vivo cell tracking.
The remainder of this paper is organized as follows. Section II
describes how the RBC tracking data are obtained. Section III
introduces our proposed methods. The design of experiments
is presented in Section IV. Section V describes experimental
results and the corresponding discussions. Finally, Section VI
offers our conclusions.
II. IMAGE ACQUISITION
IVM is a powerful optical imaging technique for collecting
dynamic data in vivo with high spatial and temporal resolution [15]–[19]. Here, live tumor-bearing mice were imaged using an upright Nikon A1R laser-scanning confocal microscope
equipped with a resonant scanner for high-speed imaging [20].
BCM-4195 tumor fragments were grown on the mammary pad
of SCID/beige mice (Harlan Laboratories, Wilmington, MA,
USA) [21], [22] and exposed for IVM using an aseptic skin-flap
procedure [23]. Mice received an one-time intravenous injection of DiD-labeled autologous red blood cells 1–3 days prior
to imaging [23] and a bolus injection of 40 kDa FITC-dextran
tracer (1 μM, Invitrogen) immediately prior to imaging [20].
Videos were acquired at 30 frames-per-second (fps) during simultaneous excitation with 488 and 640 nm lasers. Emissions
were collected by photomultiplier tubes with band-pass filters
of ∼ 30–35 nm width centered at 525 nm (FITC-dextran tracer)
and 670 nm (RBCs). All animal protocols were reviewed and
approved by the IACUC [24] at The Methodist Hospital Research Institute (TMHRI).
Flow within BCM-4195 tumor was visualized by tracking
the movement of RBCs. Since only a small number of RBCs
were labeled (∼ 3%), individual cells could be resolved. The
walls of the tumor vasculature were delineated using FITCdextran. Fig. 1 shows an example video frame, captured over
a 1000 × 500 μm field of view (FOV). Flow through these and
other BCM-4195 tumor vessels was observed to be irregular,

Two cell tracking methods, which are based on optical flow
and SIFT flow, are introduced in this section. These methods are
commonly used in vehicle tracking and robot navigation [14],
[25]. Considering that RBCs moving in blood vessels have the
similar movement styles as vehicles and robots, we can apply
the algorithms to the tracking of RBCs.
A. Optical Flow
The study of optical flow has a long history in visual perception and computer vision. Optical flow describes the local
motion for each visible point in an image sequence by the local
displacement vector field [26]. For digital image sequences, it
specifies how much each image pixel moves between adjacent
images and can be efficiently computed using successive image
matching. Many algorithms exist to solve or optimize optical
flow methods [13], [14], [27]–[31], developed based on the assumption that the gray value of a pixel is not changed by the
displacement from time t to time t + 1, which is represented by
I(x + u, y + v, t + 1) = I(x, y, t)

(1)

where I(x, y, t) denotes a rectangular image sequence, and
w := (u, v, 1)T is the searched displacement vector between
an image at time t and another image at time t + 1. u and v are
the horizontal and vertical components of the flow field.
However, not all optical methods are suitable for the celltracking problem discussed in this paper. In the traditional optical flow methods, i.e., Lucas–Kanade [27] and Horn–Schunck
[32], the vector field extracted will not be dense or will lose
in discontinuities. Also, in the recent variational optical flow
method such as [29] and [13], the discontinuities in the vector
field are well preserved by introducing sophisticated measures
for edge regions. The performance of the matching (1) is limited due to noise and the relatively small size of cells’ objects
appeared in the videos. In this paper, we recommend using the
algorithm of Liu [33] to obtain the vector fields u and v. Liu’s
algorithm is also under the brightness constancy assumption.
Unlike previous methods, which consider the matching of
image pixels, Liu’s method considers the matching of SIFTtransformed images. The advantages of using SIFT transform
in optical flow calculation are as follows: 1) significant image
features are well encoded in the SIFT feature vectors; 2) large
distortions due to cell motion or noise are insensitive to SIFT
features; 3) long-term cell motion can still be recovered by SIFTmatching; and 4) the SIFT-based optical flow can be computed
in the fast discrete optimization method.
B. SIFT Flow
SIFT flow exploits the SIFT feature descriptors that are reasonably invariant to changes in illumination, scaling, rotation,
image noise, and small changes in viewpoint. The SIFT descrip-

GUO et al.: RED BLOOD CELL TRACKING USING OPTICAL FLOW METHODS

993

Fig. 2. SIFT feature histogram. (Left) Each pixel in a local area is assigned
with a specific orientation, and (right) the orientations are then accumulated into
a 4-bin directional histogram. The histogram vectors can be directly used for
keypoint matching.

tor was first proposed by Lowe [34], and then further developed
and improved by Bay [35] and Dalal [36]. The SIFT descriptor,
as its followers, is a vector encoding the local orientation information such as edges and corners of a local area. The orientation
information is invariant to illumination and change of scale.
Thus, SIFT is insensitive to light, shadow, and even most affine
transforms encountered in natural images. SIFT flow matching
can avoid the noise and change of cell scales in image sequence.
The SIFT flow method includes two major steps: 1) SIFT extraction and 2) belief propagation optimization. This paper will
briefly introduce them in the following sections.
1) Computation of Scale Invariant Feature Transform: The
goal of SIFT computation is to extract the local orientation
histogram. It generally takes four steps in SIFT computation:
extrema detection, keypoint localization, edge elimination, and
orientation assignment. The first three steps attempt to extract
significant pixel candidates which are robust to scale changes.
The last step extracts the local orientation information and store
the orientation into histogram vectors as Fig. 2 shows [37],
where each pixel in a local area is assigned with a specific
orientation. The orientations are then accumulated into a fourbin directional histogram. In SIFT flow computation, the major
steps in SIFT transform are simplified due to computational efficiency. The orientation histograms are directly extracted from
the edge images obtained from the consecutive difference of
Gaussian convolutions.
2) Formulation of SIFT Computation: SIFT flow computation is formulated as the minimization over the SIFTtransformed image pair. For a given image pair, the objective
function is written as

min(s1 (p) − s2 (p + w(p))1 , t)
E(w) =

Fig. 3.

Structure of the proposed method.

Fig. 4.

Locating cells using the mathematical morphology method.

Unlike the general variational approaches such as [29] and
[13], the functional (2) cannot be directly solved by the Euler–
Lagrange equation. Instead, [14] applies a special model of
belief-propagation (BP) for solving (2). The BP model does not
require the calculation of function gradient, and the resulting w
is iteratively updated by the message-passing algorithm in the
BP model.
IV. EXPERIMENTS
The experiments were conducted in MATLAB7.1 on an Intel
Core2 Quad 3.0 GHz CPU, 8 GB Memory desktop. The basic
structure of our proposed method is presented in Fig. 3. In
our method, for a specific cell, we first use the mathematical
morphology method to obtain the cell’s location in the first
frame. Then, we find the displacement of the cell between the
first and the second frame using the optical flow and SIFT flow
algorithms, separately. Given a cell’s location in the first frame
and the displacement between the first and the second frame, it
is easy to calculate the cell’s location in the second frame. This
process is iterated until the location of cell in the last frame is
found.

p

+



A. Locating Cells

η(|u(p)| + |v(p)|)

p

+



min(α |u(p)| − |u(q)| , d)

(p,q)∈ε

+ min(α |v(p)| − |v(q)| , d),

(2)

where s1 is the SIFT descriptor over pixel p in the first frame
and s2 is the SIFT descriptor on pixel q in the second frame. t
and d are thresholds. w(p) = (u(p), v(p)) is the flow vector at
p which represents the warping that aligns both of the frames.

We first used mathematical morphology to obtain the location
of cells in the first frame. In detail, for an input image I, it first
finds the regional maxima of I. The output J, which has the
same size of I, identifies the locations of the regional maxima
in I. In J, pixels that are set to 1 identify regional maxima;
all other pixels are set to 0. Then, we perform morphological
operations on J to shrink an object to a point.
Fig. 4 shows the location of cells identified using this method.
Multiple RBCs moving through a blood vessel were visualized
by blue fluorescence, shown here using red circles to mark their

994

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

locations. Randomly selected cells were subjected to optical
flow and SIFT flow algorithms to obtain their location in the
next frame.
B. Displacement Calculation Using Optical Fow
The algorithm is used to calculate the displacement of a given
cell between two frames. The MATLAB package for this algorithm is provided in [38]. According to our previous experimental results, the following parameters were set to obtain the
best tracking results. The regularization weight (alpha) was set
to 0.04, the downsample ratio was set to 0.55, the width of the
coarsest level (minWidth) was set to 5, the number of outer fixed
point iterations (nOuterFPIterations) was set to 7, the number
of inner fixed point iterations (nInnerFPIterations) was set to
1, and finally, the number of SOR iterations (nSORIterations)
was set to 30 when we preferred accuracy over training time.
However, if we want to get a faster estimated result, (nSORIterations) can be set to 15. Eventually, the horizontal and vertical
components of the flow field were computed using the optical
flow algorithm, and locations of the cell in the whole image sets
or videos were therefore computed.
C. Displacement calculation using SIFT flow
The SIFT flow algorithm is provided in [39]. The following
parameters were set to get good estimated results. The weight
of the truncated L1-norm regularization on the flow (alpha) was
set to 5; the threshold of the truncation d was set to 20; the
weight of the magnitude of the flow (gamma) was set to 0.01;
the number of iterations (nIterations) was set to 30; the number
of hierarchies in the efficient BP implementation (nHierarchy)
was set to 2; and finally, the half size of the search window
(wsize) was set to 5. Same as optical flow, we computed the
horizontal and vertical components of the flow field and then
found the locations of the cell frame by frame.
D. Validation
To test if the estimated locations by using the above algorithms are good enough, a validation experiment was proposed.
We would like to find out the observed value of cell location
in each frame and compare it with the estimated value. In our
validation experiments, ten people (three biologists, three mathematicians, and four specialists in medical image processing)
were asked to run experiments and locate the cells’ locations
frame by frame by eyes. Therefore, for a cell in a video, we
have such an observation matrix as follows:
⎤
⎡ x , x ,..., x
1,1

⎢ x2,1 ,
⎢
A=⎢
⎢
⎣

1,2

1,n

x2,2 , . . . , x2,n
..
.

⎥
⎥
⎥.
⎥
⎦

(3)

x10,1 , x10,2 , . . . , x10,n
Assume that the ten persons’ observations to the same frame
are independent. Therefore, given a fixed frame j, xi,j (i =
1, . . . , 10, indicates the number of persons) are with the normal
distribution. We use p-value (p = 0.05) to reject the invalid

Fig. 5. Tracking singular cell in complicated background. (a) Optical flow,
(b) SIFT flow.

observations in xi,j (i = 1, . . . , 10) and average the rest valid
values as the true location of a cell in frame j.
V. RESULTS AND DISCUSSION
This section describes three independent experiments in
which optical flow and SIFT flow predictions were compared to
manual measurements.
A. Experiment 1: Track a Single Cell in a
Complicated Background
This experiment shows the important cell tracking in poorly
distinguished backgrounds. IVM images are subject to a high
degree of noise, which can result in poor contrast. Effective delineation of the vessel walls is dependent on the quality of tracer
used and can vary with how the tissue of interest is mounted for
imaging. Additionally, IVM techniques generally capture images over a relatively narrow axial plane, such that objects can
be lost if they move out of the plane of focus. This is particularly
a problem with large dilated vessels, such as those observed in
tumors. In this case, some common methods, like Gabor filter
for the spatiotemporal image analysis method, will fail to get
the missed locations of the cells in the frames.
We hence use our proposed methods to track cells in this
case. Fig. 5(a) and (b) shows the optical flow and SIFT flow
tracking results overlaid on the last video frame. Both methods
tracked the cell’s movement very well. However, only observing
the two figures, it is hard to see their performance clearly. So,
we conducted the validation experiment by recording the cell’s
locations in each frame obtained by optical flow and SIFT flow
at the same time. The validation results are shown in Fig. 6,
where the horizontal axis and vertical axis represent the cell’s
location in a frame. Ninety frames were processed in total. The
black stars present the cell’s locations computed by SIFT flow,
and the blue circles stand for the same cell’s locations computed
by optical flow, while the red dots show the observed locations
(used as true values of these locations) obtained by ten observers
and processed as introduced in Section IV-D. To see the results
clearly, we zoomed in the two parts of the original curve, as

GUO et al.: RED BLOOD CELL TRACKING USING OPTICAL FLOW METHODS

Fig. 6.

995

Validation of optical flow and SIFT flow.
TABLE I
MSE BETWEEN PREDICTED VALUES AND OBSERVED VALUES

Fig. 7. Tracking cells with two different movement tendencies. (a) SIFT flow
and (b) optical flow.

since pixel-wise correspondence has advantages when handling
complicated and unreliable scene alignment.
B. Experiment 2: Tack Cells Fowing in Two
Different Directions
ellipses A and B show. Ellipse A includes five frames. From the
figure, we can see that a red dot is missing in one of the frames
in ellipse A. It means that all of the ten observers cannot tell
the location of the cell in that frame. In fact, the cell disappears
in that frame and appears again in the next frame. However,
both SIFT flow and optical flow can predict the locations of the
cell in each of the five frames. Ellipse B represents the same
case, demonstrating that in some frames, our proposed method
can compute a cell’s location accurately when cells cannot be
visualized by eyes.
We used mean squared error (MSE) to calculate the error
between predicted values and observed values, as Table I shows.
Specially, we calculated the Euclidean distance between the
predicted location and the observed location in each frame.
In the same video, we randomly tracked ten cells’ locations
using the two methods. It should be noted that some cells are
missed in some frames, we do not have observed values of
the cells’ locations and cannot judge whether the predictions
of the two methods are good or not. We therefore deleted the
predicted values in these frames when calculating the prediction
accuracy. In the table, both methods have the same predictive
capacity for predicting the locations of eight of the ten cells.
However, optical flow outperforms SIFT flow when predicting
the locations of cells 6 and 7, and SIFT flow shows slightly better
performance when predicting the locations of cell 9. Optical flow
works better than SIFT flow in the case when the cells move in
a complicated environment. This is because the characteristics
of optical flow are quite robust to abrupt movement of objective

This experiment shows the case when two cells in the same
video flow in different directions. Such a case is very typical in
tumors, where microvessels are generally highly branched and
tortuous [40]. Common cell tracking methods cannot work well
in this case since they assume that all particles in the flow should
have the same velocity and require all particles should have the
similar movement tendency.
Fig. 7 shows an example in which multiple vessels are contained in a single FOV and each vessel has its own associated
direction of flow. Two vessels were analyzed: Fig. 7(a) is the experimental result using the SIFT flow algorithm, while Fig. 7(b)
is the result of optical flow with the same video. The arrow
lines in both figures show the direction of blood flows. From
the two figures, we can see that both SIFT flow and optical flow
can track the movement of cells accurately, even though their
directions of movement are quite different.
The predictive ability of the two algorithms is shown in Figs. 8
and 9, respectively. Fig. 8 shows the cell tracking result of cell
A and Fig. 9 the tracking results of cell B in Fig. 7, respectively.
For both of the two cell movement trajectories, we zoomed in a
part of them to see the detailed tracking results. We can see that
the two cells’ movements are abrupt in some places (see Figs.
8 and 9). Different performances of SIFT flow and optical flow
algorithms are observed, particularly when cells make abrupt
changes in velocity or direction. The SIFT flow method appears
to show better tracking than optical flow because the optical
flow method produces pixel-to-pixel correspondences between
two images, while SIFT flow creates SIFT descriptors instead

996

Fig. 8.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

Tracking cell A: results and validation.

Fig. 10. Tracking cells through heartrate-induced abnormalities. (a) SIFT flow
and (b) optical flow.

Fig. 9.

Tracking cell B: results and validation.
TABLE II
MSE BETWEEN PREDICTED VALUES AND OBSERVED VALUES

Fig. 11.

Tracking cell B: results and validation.

C. Experiment 3: Track Cells Through the Motion
of the Subject

of raw pixels. So SIFT flow is more robust to the large changes
between two adjacent frames.
Table II presents the MSE of the two methods compared with
the observed values obtained in Section IV-D. Ten cells were
randomly selected from the vessels in the video. The predicted
errors of the two methods are listed in Table II. Two points should
be noted in this experiment: First, both algorithms perform well
when the trajectory of the cell is quite simple (see Fig. 8), and
SIFT flow shows especially good performance when the cell
route is subject to large changes (see Fig. 9). Second, both
algorithms have quite high performance to track cells when a
series of cells move toward different directions.

This experiment shows the importance of tracking large track
deviations between frames. Animal motion due to heart beat,
breathing, and twitching can induce artifacts in cell tracking,
which appears as a large deviation in trajectory from one frame
to the next.
Fig. 10 shows the experimental results using both algorithms.
In this video, the location of the cell in some frames is distorted
due to animal heartbeat. Normally, other methods will fail to
track the cell in successive frames since the location of the cell
in the distorted frame is wrong. However, from the two figures,
we can see that both of our proposed methods can track the cell
very well. To compare them clearly, we conducted validation
experiments, as shown in Fig. 11. To see the two methods’
performance accurately, we randomly selected ten cells to track
and the accuracy of the two methods are listed in Table III. We
can see in the table that SIFT flow outperforms optical flow in

GUO et al.: RED BLOOD CELL TRACKING USING OPTICAL FLOW METHODS

997

TABLE III
MSE BETWEEN PREDICTED VALUES AND OBSERVED VALUES

[5]
[6]

[7]

[8]

this case. This is because SIFT flow is much more robust to
the large change of scene between two adjacent frames since
SIFT flow creates SIFT descriptors for matching rather than
pixel-to-pixel correspondences.

[9]

[10]

VI. CONCLUSION
This paper proposed two objective tracking methods, optical
flow and SIFT flow, to solve the difficulties for in vivo RBC
tracking. There are some challenging problems we cannot avoid
during in vivo cell tracking, such as cells may disappear in some
frames, imaging can be disturbed by heartbeat and movement of
subject, and vessels can be highly complex, and therefore cells
in the same imaging area may flow in multiple directions. The
experiments in this paper especially selected three difficult in
vivo tracking cases to test our proposed methods. The first one
is to track a single cell in a complicated background, the second
one is to track cells flowing in two different directions, and the
third one is to track cells though motion of the subject. The
experimental results showed that both of the methods can work
well in all of the cases. However, optical flow is much more
robust to the case where the velocity of cell is unstable, while
SIFT flow works better when there is a large displacement of the
cell between two adjacent frames. Therefore, in the application
of the two methods, we can select to use them according to different cases. Because both of the methods have to calculate the
displacements of each pixel, the calculation is time consuming.
In future, we will improve the algorithms in the aspect of speed
and accuracy.

[11]

[12]

[13]
[14]
[15]
[16]
[17]
[18]

[19]
[20]

ACKNOWLEDGMENT
Special thanks to Melissa D. Landis for providing the animal
model.

[21]
[22]

REFERENCES
[1] C. Chang, R. Tsai, W. Wu, S. Kuo, and H. Yu, “Use of dynamic capillaroscopy for studying cutaneous microcirculation in patients with diabetes mellitus,” Microvasc. Res., vol. 53, no. 2, pp. 121–127, 1997.
[2] B. Levy, G. Ambrosio, A. Pries, and H. Struijker-Boudier, “Microcirculation in hypertension,” Circulation, vol. 104, no. 6, pp. 735–740, 2001.
[3] L. Weiss, U. Nannmark, B. Johansson, and U. Bagge, “Lethal deformation of cancer cells in the microcirculation: A potential rate regulator of
hematogenous metastasis,” Int. J. Cancer, vol. 50, no. 1, pp. 103–107,
2006.
[4] Q. G. de Lussanet, W. H. Backes, A. W. Griffioen, A. R. Padhani,
C. I. Baeten, A. van Baardwijk, P. Lambin, G. L. Beets, J. van

[23]

[24]
[25]

Engelshoven, and R. G. Beets-Tan, “Dynamic contrast-enhanced magnetic resonance imaging of radiation therapy-induced microcirculation
changes in rectal cancer,” Int. J. Radiat. Oncol. Biol. Phys., vol. 63, no. 5,
pp. 1309–1315, 2005.
G. Satiukova and O. Kurguzov, “Changes in microcirculation and their
correction in patients with varicose veins and post-thrombotic syndrome,”
Morfologiia (Saint Petersburg, Russia), vol. 118, no. 5, pp. 29–35, 2000.
R. T. Ullrich, J. F. Jikeli, M. Diedenhofen, P. Böhm-Sturm, M. Unruh,
S. Vollmar, and M. Hoehn, “In vivo visualization of tumor microvessel
density and response to anti-angiogenic treatment by high resolution mri
in mice,” PloS one, vol. 6, no. 5, p. e19592, 2011.
C. Xu, W. U. Schmidt, K. Villringer, P. Brunecker, V. Kiselev, P. Gall,
and J. B. Fiebach, “Vessel size imaging reveals pathological changes of
microvessel density and size in acute ischemia,” J. Cerebral Blood Flow
Metabol., vol. 31, no. 8, pp. 1687–1695, 2011.
S. A. Japee, R. N. Pittman, and C. G. Ellis, “Automated method for tracking individual red blood cells within capillaries to compute velocity and
oxygen saturation,” Microcirculation, vol. 12, no. 6, pp. 507–515, 2005.
M. Tomita, I. Schiszler, H. Takeda, Y. Tomita, T. Osada, M. Unekawa,
N. Tanahashi, and N. Suzuki, “Spatial and temporal heterogeneity of
single capillary plasma flow and RBC tracking in the rat cerebral cortex,”
J. Cerebral Blood Flow Metabol., vol. 25, pp. S164–S164, 2005.
M. Unekawa, M. Tomita, Y. Tomita, H. Toriumi, K. Miyaki, and N. Suzuki,
“RBC velocities in single capillaries of mouse and rat brains are the same,
despite 10-fold difference in body size,” Brain Res., vol. 1320, pp. 69–73,
2010.
S. Yamamoto, Y. Nakajima, S. Tamura, Y. Sato, and S. Harino, “Extraction of fluorescent dot traces from a scanning laser ophthalmoscope image
sequence by spatio-temporal image analysis: Gabor filter and radon transform filtering,” IEEE Trans. Biomed. Eng., vol. 46, no. 11, pp. 1357–1363,
Nov. 1999.
Y. Chen, Z. Zhao, L. Liu, and H. Li, “Automatic tracking and measurement
of the motion of blood cells in microvessels based on analysis of multiple
spatiotemporal images,” Meas. Sci. Technol., vol. 22, no. 4, p. 045803,
2011.
T. Brox, A. Bruhn, N. Papenberg, and J. Weickert, “High accuracy optical
flow estimation based on a theory for warping,” in Proc. 8th Eur. Conf.
Comput. Vis., 2004, pp. 25–36.
C. Liu, J. Yuen, and A. Torralba, “Sift flow: Dense correspondence across
scenes and its applications,” IEEE Trans. Pattern Anal. Mach. Intell.,
vol. 33, no. 5, pp. 978–994, May 2011.
M. J. Pittet and R. Weissleder, “Intravital imaging,” Cell, vol. 147, no. 5,
pp. 983–991, 2011.
R. N. Germain, M. J. Miller, M. L. Dustin, and M. C. Nussenzweig, “Dynamic imaging of the immune system: Progress, pitfalls and promise,”
Nature Rev. Immunol., vol. 6, no. 7, pp. 497–507, 2006.
J. N. Kerr and W. Denk, “Imaging in vivo: Watching the brain in action,”
Nature Rev. Neurosci., vol. 9, no. 3, pp. 195–205, 2008.
G. M. Tozer, S. M. Ameer-Beg, J. Baker, P. R. Barber, S. A. Hill,
R. J. Hodgkiss, R. Locke, V. E. Prise, I. Wilson, and B. Vojnovic, “Intravital imaging of tumour vascular networks using multi-photon fluorescence
microscopy,” Adv. Drug Del. Rev., vol. 57, no. 1, pp. 135–152, 2005.
R. K. Jain, L. L. Munn, D. Fukumura et al., “Dissecting tumour pathophysiology using intravital microscopy,” Nature Rev. Cancer, vol. 2, no. 4,
pp. 266–276, 2002.
A. L. van de Ven, M. Wu, J. Lowengrub, S. R. McDougall, M. A. Chaplain,
V. Cristini, M. Ferrari, and H. B. Frieboes, “Integrated intravital microscopy and mathematical modeling to optimize nanotherapeutics delivery to tumors,” AIP Adv., vol. 2, no. 1, p. 011208, 2012.
M. D. Landis, B. D. Lehmann, J. A. Pietenpol, and J. C. Chang, “Patientderived breast tumor xenografts facilitating personalized cancer therapy,”
Breast Cancer Res., vol. 15, no. 1, pp. 1–9, 2013.
A. F. Schott, M. D. Landis, G. Dontu, K. A. Griffith, R. M. Layman,
I. Krop, L. A. Paskett, H. Wong, L. E. Dobrolecki, M. T. Lewis et al., “Preclinical and clinical studies of gamma secretase inhibitors with docetaxel
on human breast tumors,” Clin. Cancer Res., vol. 19, no. 6, pp. 1512–1524,
2013.
A. L. van de Ven, P. Kim, O. Haley, J. R. Fakhoury, G. Adriani,
J. Schmulen, P. Moloney, F. Hussain, M. Ferrari, X. Liu et al., “Rapid
tumoritropic accumulation of systemically injected plateloid particles and
their biodistribution,” J. Controll. Release, vol. 158, no. 1, pp. 148–155,
2011.
[Online]. Available:http://www.iacuc.org/aboutus.htm
K. R. Aires, A. M. Santana, and A. A. Medeiros, “Optical flow using color
information: Preliminary results,” in Proc. ACM Symp. Appl. Comput.,
2008, pp. 1607–1611.

998

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

[26] J. J. Gibson, The perception of the visual world. Oxford, England:
Houghton Mifflin, 1950.
[27] B. D. Lucas, T. Kanade et al., “An iterative image registration technique
with an application to stereo vision,” in Proc. 7th Int. Joint Conf. Artif.
Intell., 1981, pp. 674–679.
[28] D. J. Heeger, “Optical flow using spatiotemporal filters,” Int. J. Comput.
Vis., vol. 1, no. 4, pp. 279–302, 1988.
[29] G. Aubert, R. Deriche, and P. Kornprobst, “Computing optical flow via
variational techniques,” SIAM J. Appl. Math., vol. 60, no. 1, pp. 156–182,
1999.
[30] J. Barron and N. Thacker, “Tutorial: Computing 2d and 3d optical flow,”
Imag. Sci. Biomed. Eng. Divis., Medical School, Univ. Manchester, 2005.
[31] A. Bruhn, J. Weickert, and C. Schnörr, “Lucas/kanade meets
horn/schunck: Combining local and global optic flow methods,” Int. J.
Comput. Vis., vol. 61, no. 3, pp. 211–231, 2005.
[32] B. K. Horn and B. G. Schunck, “Determining optical flow,” Artif. Intell.,
vol. 17, no. 1, pp. 185–203, 1981.
[33] C. Li et al., “Beyond pixels: Exploring new representations and applications for motion analysis,” Ph.D. dissertation, Massachusetts Institute of
Technology, Cambridge, MA, USA, 2009.
[34] D. Lowe, “Object recognition from local scale-invariant features,” in Proc.
IEEE Comput. Vis., Proc. 7th IEEE Int. Conf., 1999, vol. 2, pp. 1150–1157.

[35] H. Bay, T. Tuytelaars, and L. Van Gool, “Surf: Speeded up robust features,”
in Proc. Eur. Conf. Comput. Vis., 2006, pp. 404–417.
[36] N. Dalal and B. Triggs, “Histograms of oriented gradients for human
detection,” in Proc. IEEE Comput. Vis. Pattern Recognit., IEEE Comput.
Soc. Conf., 2005, vol. 1, pp. 886–893.
[37] C. Zhu, “Video object tracking using sift and mean shift,” M.S. Thesis,
Dept. Signals and Syst., Chalmers University OF Technology Göteborg,
Sweden, 2011.
[38] C. Liu. (2009). [Online]. Available:http://people.csail.mit.edu/celiu/
OpticalFlow/.
[39] C. Liu. (2010). [Online]. Available:http://people.csail.mit.edu/celiu/
SIFTflow/
[40] H. Gerhardt and H. Semb, “Pericytes: Gatekeepers in tumour cell metastasis?,” J. Molecul. Med., vol. 86, no. 2, pp. 135–144, 2008.

Authors’ photographs and biographies not available at the time of publication.

