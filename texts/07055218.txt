508

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Real-Time Prediction of Neurally Mediated Syncope
R. Couceiro, P. Carvalho, R. P. Paiva, J. Muehlsteff, J. Henriques, C. Eickholt, C. Brinkmeyer, M. Kelm, and C. Meyer

Abstract—Neurally mediated syncope (NMS) patients suffer
from sudden loss of consciousness, which is associated with a high
rate of falls and hospitalization. NMS negatively impacts a subject’s quality of life and is a growing cost issue in our aging society,
as its incidence increases with age. In this paper, we present a
solution for prediction of NMS, which is based on the analysis
of the electrocardiogram (ECG) and photoplethysmogram (PPG)
alone. Several parameters extracted from ECG and PPG, associated with reflectory mechanisms underlying NMS in previous
publications, were combined in a single algorithm to detect impending syncope. The proposed algorithm was evaluated in a population of 43 subjects. The feature selection, distance metric selection, and optimal threshold were performed in a subset of 30
patients, while the remaining data from 13 patients were used to
test the final solution. Additionally, a leave-one-out cross-validation
scheme was also used to evaluate the performance of the proposed
algorithm yielding the following results: sensitivity (SE)—95.2%;
specificity (SP)—95.4%; positive predictive value (PPV)—90.9%;
false-positive rate per hour (FPRh)—0.14 h−1 , and prediction time
(aPTime)—116.4 s.
Index Terms—Autonomic nervous system, blood pressure regulation and variability, electrocardiogram (ECG), neurally mediated syncope (NMS), photoplethysmogram (PPG).

I. INTRODUCTION
YNCOPE is a transient and self-limiting loss of consciousness, resulting from a transient global cerebral hypoperfusion and is characterized by a rapid onset, short duration, and
spontaneous complete recovery [1]. Also referred to as vasovagal and neurocardiogenic syncope, NMS belongs to a broader
group of syncope known as reflex syncope, which is responsible
for 21% of syncope episodes [1].
In the latest Framingham study [2] involving 7814 participants between 20 and 96 years old, it was reported an incidence
rate of 6.2 per 1000 person-years. Moreover, the incidence of

S

Manuscript received August 25, 2014; revised February 11, 2015 and December 16, 2014; accepted February 25, 2015. Date of publication March 5,
2015; date of current version March 3, 2016. This work was supported by Center for Informatics and Systems of University of Coimbra and by EU projects
HeartCycle (FP7-216695), iCIS (CENTRO-07-ST24-FEDER-002003), Welcome (FP7-ICT-2013-10), and HeartSafe (PTDC-EEI-PRO-2857-2012).
R. Couceiro, P. Carvalho, R. P. Paiva, and J. Henriques are with the Department of Informatics Engineering, Science and Technology Faculty, University of Coimbra, Coimbra 3000-370, Portugal (e-mail: rcouceir@dei.uc.pt;
carvalho@dei.uc.pt; ruipedro@dei.uc.pt; jh@dei.uc.pt).
J. Muehlsteff is with Philips Research Laboratories Europe, Eindhoven 5600
JA, The Netherlands (e-mail: Jens.Muehlsteff@philips.com).
C. Eickholt, C. Brinkmeyer, M. Kelm, and C. Meyer are with the Division
of Cardiology, Pneumology, and Angiology, Heinrich-Heine University Hospital Düsseldorf, Düsseldorf 40225, Germany and also with the Department
of Electrophysiology, University Heart Center, University Hospital Eppendorf,
Hamburg 20246, Germany (e-mail: Christian.Eickholt@med.uni-duesseldorf.
de; Christoph.Brinkmeyer@med.uni-duesseldorf.de; Malte.Kelm@med.uniduesseldorf.de; Christian.Meyer@med.uni-duesseldorf.de).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2408994

syncope was shown to increase with age, ranging from 2.6 to 5.4
per 1000 person-years between 20 and 69 years old. The same
study shows a sharp rise to 11.1 and 19.5 per 1000 person-years
within the 70–79 and above 80 years old populations [2], [3].
The main causes of syncope are generally benign. However,
it is associated with frequent hospitalizations and accounts for
1–3% of all emergency department (ED) visits, as well as 1–
6% of all hospital admissions in general [2], [4]. Moreover, in
the U.S. approximately 4% of syncope patients discharged from
the ED experience severe adverse events (e.g., readmission or
death) within 72 h [4].
The recurrence of syncope episodes gains special emphasis in
elderly populations, where morbidity is particularly high. Fear
of falling often leads to reduced physical and social activity,
which is associated with increased mental decline and incidence of medical conditions. Subsequent institutionalization is
a common consequence of syncope in this age group [1].
The main advances in syncope treatment and prevention focus on lifestyle modifications, which include the education of
patients regarding the awareness and avoidance of triggers, the
early recognition of prodromal symptoms, and performance of
counter measures to abort the syncope episode [1]. Thus, the
development of a noninvasive and nonintrusive, as well as costefficient personal p-health system to alert patients in case of
an impending syncope might: 1) provide an opportunity for the
patient to perform early countermaneuvers (e.g., physical counterpressure maneuvers—PCMs) and avoid or delay syncope, as
well as 2) help in diagnostics of underlying pathophysiological
mechanisms with better personalized treatment options.
A. Background and State of the Art
Orthostatic intolerance is thought to be one of the most common triggers of reflex syncope [5]. Investigators believe that
the abrupt and excessive amount of venous blood pooling during standing posture is responsible for a decrease in the venous blood return to the heart resulting in more vigorously
ventricle contractions and excessive stimulation of the ventricular mechanoreceptors. As a result, a “paradoxical” withdrawal in sympathetic tone can occur, i.e., cardioinhibition and
vasodepression. This process is associated with a decrease in
blood pressure and finally syncope [6]. Although the increase
in parasympathetic activity (cardioinhibition) is commonly observed during NMS, hypotension due to vasodepression is considered as the primary mechanism leading to the loss of consciousness [7].
Several studies have been proposed in the literature for NMS
prediction, differing on the objectives, methods and used modalities. The most common approach is the early prediction of the
head-up tilt table test (HUTT) outcome based on an analysis
of HR and BP parameters before and after tilt, i.e., during the

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

supine position and early passive standing position. These methods are mainly focused on the analysis of the HR and/or SBP
variability using either time- or frequency-domain techniques,
or both. The time-domain methods focus on the evaluation of
temporal changes of HR during the supine and upright positions, using statistical features, such as mean, standard deviation [8]–[11], variance and kurtosis [12], or even doing simple
comparisons between the HR in both phases [13], [14]. The
frequency-domain methods are mainly based on the evaluation
of the characteristics of the low (LFr: 0.04–0.15 Hz) and high
(HFr: 0.15–0.40 Hz) frequency components (e.g., power and
area) and on the relationship between the characteristics of those
components (the LFr/HFr ratio) as measures of sympathovagal
balance [10], [11], [15]–[17]. Additionally, methods using indices of myocardial contractility assessed from peak endocardial
acceleration [18], from transthoracic impedance cardiography
(ICG) [19], [20] and from the arterial blood pressure waveform
[21] have also been proposed in the literature.
In contrast with the early prediction approach, the real-time
prediction problem has only been addressed in the later years,
where hemodynamic changes are continuously monitored during the whole HUTT protocol. Rather than focusing on the
hemodynamic responses resulting from the change of posture,
the real-time approaches continuously assess the risk of an impending syncope episode from the monitored hemodynamic parameters. Since the mechanisms underlying the occurrence of
syncope are characterized by fast dynamics and are not limited to changes of posture, these approaches are believed to
have a wider scope concerning the real-life scenarios. Here,
the changes in heart rate (HR) and continuously measured systolic blood pressure (SBP) have also been considered [22], [23].
Virag et al. [22] proposed a method for real-time prediction of
impending syncope based on the time and frequency analysis of
the HR and SBP signals, while Mereu et al. [23] evaluated the
prediction ability of HR and BP (SBP, MBP, DBP, and PP) trends
and the ratio between the dRR (first derivative of RR) with those
trends. However, current noninvasive blood pressure monitoring
systems have several disadvantages. Most obviously their application is cumbersome due to bulky and expensive hardware, as
well as complicated handling with the need for frequent calibrations [24]. These limitations become critical in unsupervised
environments such as at home or in ambulatory scenarios, where
low cost and easy-to-use devices are essential. More recently,
several authors focused on the evaluation of changes of the pulse
arrival time (PAT) alone [25], as a surrogate for SBP changes,
or combined with HR changes [26], [27] and, finally, prediction
of syncope. In our previous works [25], [28], we established
and validated a method for syncope prediction using PAT and
evaluated the possible mechanisms underlying the development
of NMS.
B. Main Contributions and Paper Organization
In this paper, we propose a complete framework with tailored algorithms for prediction of NMS by analyzing changes
of several cardiovascular parameters that characterize the
chronotropic (HR), inotropic (left ventricular ejection time—

509

Fig. 1. Schematic representation of the proposed algorithm structure. HR,
PAT, left ventricular ejection (LVET), SI and RI are extracted from the analysis
ECG and PPG, which are postprocessed and evaluated in order to extract seven
features. Syncope prediction is performed using a threshold-based approach
applied to the distance of the extracted features to an orthostatic stable reference.
A notification is generated if the distance measure surpasses a predefined optimal
threshold (THo ).

LVET), vascular tone and blood pressure (PAT, stiffness index—
SI, and reflection index—RI). These parameters were extracted
from the joint analysis of the electrocardiogram (ECG) and
photoplethysmogram (PPG), which can be acquired easily and
nonobtrusively with state-of-the-art equipment. The parameters
were normalized and led to the definition of ten features. The
best seven features were selected and the distance to the orthostatic reference was calculated using the Minkowski distance
metric. A threshold-based approach was adopted to detect impending syncope.
The remainder of this paper is organized as follows. The
proposed solution for syncope prediction is presented in
Section II. The experimental protocol used in the present study
is described in Section III. The main results and respective discussion are presented in Section IV. Finally, we present our main
conclusions in Section V.
II. METHODS
The main steps of the proposed solution are illustrated in
Fig. 1, which are: 1) detection of motion artifacts; 2) parameter extraction and postprocessing; 3) feature evaluation; and
4) syncope prediction.
A. Detection of Motion Artifacts
It is well known that the PPG signal is prone to several sources
of error (e.g., motion artifacts), which can be a serious obstacle
in the reliable extraction of the derived parameters, especially in
uncontrolled environments such as home care and ambulatory
scenarios. Therefore, it is important to detect the sections of
the PPG signal that are corrupted and consequently shall not be
included in the subsequent steps of the analysis. In the proposed
framework, we adopted a motion artifact detection algorithm
using features from the time and period domain of the PPG signal [29]. The classification of the corrupted/clean PPG sections
is performed using a C-support vector classification (C-SVC)
algorithm [30], with a radial basis function kernel. The classification model was fed with eight inputs calculated from the rate
of change of the time- and period-domain characteristics of the

510

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 2. Segmentation of the PPG using a multiple-order derivative analysis
approach.

PPG signal. The time-domain features were extracted from the
morphological characteristics of the PPG signal:
1) Pulse amplitude—difference between the pulse peak
height and its preceding trough depth (pulse onset);
2) Trough depth difference—difference between the foot
height of consecutive pulses;
3) Pulse skewness—evaluation of the pulse symmetry;
4) Pulse kurtosis—evaluation of the pulse “peakedness”
To extract the period-domain features, the discrete-time shorttime Fourier transform was applied, and the most relevant characteristics of the spectra were evaluated: 1) location of the spectrum second major spike; 2) location of the spectrum third major
spike; 3) length of the spectrum third major spike; and 4) ratio
between the area of the three major spikes and the area of the
remaining spectrum.
B. Parameter Extraction
Chronotropic and inotropic changes were assessed via HR
and LVET.
The HR was derived from the analysis of the ECG signal
and was defined as the time span between consecutive R-peaks,
detected by a Pan–Tompkins algorithm [31].
The LVET was assessed from the PPG analysis using an
extension of the algorithm proposed in [32]. First, the PPG
signal is band-pass filtered in a 0.23–18 Hz frequency band
to remove high frequency noise and the baseline fluctuations.
Second, the onset of each PPG pulse is detected using a multipleorder derivative analysis approach. Derivatives from order 1–3


to fppg
, respectively) are calculated using a five-point
(fppg
digital differentiator [22] and the onset of each PPG pulse is

preceding
defined as the local maxima (D3lmax) on the fppg

local
the local minima (D3lmin) that corresponds to the fppg
maxima (D1lmax), as presented in Fig. 2. To detect the D1lmax,

data is calculated and the
a cumulative histogram of the fppg
threshold ThRPPG is defined as the greater value bellow which

local maxima
90% of the observations are found. The fppg
with absolute amplitudes greater than ThRPPG are defined as
D1lmax [33].
Each extracted PPG pulse was normalized to the unit, the
linear trend was removed and the systolic and diastolic phases
were identified. The systolic phase associated with the ventric-

Fig. 3. Schematic representation of the approach used to determine LVET,
SI, and RI. Top: Second derivative of the PPG pulse for determination of the
systolic and diastolic phases. Middle: Gaussian model of the PPG pulse and the
characteristic points used to assess SI and RI, respectively. Bottom: First and
second derivatives of the systolic model used to determine LVET.

ular ejection was defined between the onset of the PPG pulse
and the onset of the dicrotic notch (or inflection). The diastolic
phase, resulting from pulse reflections in the arterial path, was
defined as the portion of the PPG pulse between the offset of the
dicrotic notch and the offset of the PPG pulse, as presented in
Fig. 3 (top). The onset/offset of the dicrotic notch was defined
as the negative-to-positive/positive-to-negative zero crossings
between 0.2 and 0.4 s [34].
The systolic and diastolic phases were modeled by a sum of
three and two Gaussian function, respectively, and PPG pulse
model was defined as follows:
fm (t, βj ) =

5


aj e

−( t −c j
2b2
j

)2

,

βj = {a, b, c}j

(1)

j =1

where the parameters aj , bj , and cj correspond to the amplitude, location, and length of the Gaussian function j. The sum
of the first and second Gaussians (g1 + g2 ) corresponds to the
wave driven by the systolic ejection. The third Gaussian (g3 ) is
related to the first pulse reflection at the junction between the
thoracic and abdominal aorta, presented in Fig. 3 (middle). The
fourth and fifth Gaussians (g4 and g5 ) derive from forward pulse
reflection at the juncture between abdominal aorta and common
iliac arteries [35] and minor reflections and re-reflections in the
systemic structure, respectively. The adjustment of the model
parameters was achieved minimizing the sum of the squared
residuals, using the least squares minimization method, as
follows:
fM SE (β) =

N
1 
[f (n) − fm (n, β)]2
N n =1

(2)

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

511

where fm (n, β) is the MG model with the set of parameters
βj = {a, b, c}j , j = 1, . . . , 5. Using the interior point algorithm
[36], the goal is to solve nonlinear constrained optimization
problem presented in
min
subject to

fM SE (β)
g (β) ≤ 0
lb ≤ β ≤ ub

(3)

where g (β) ≤ 0 and lb ≤ β ≤ ub are the physiologically driven
inequality constrains and the boundaries to which the parameters
are subject.
The LVET was defined by the time span between systolic
peak of the systolic model second derivative (D2sp ) and the
notch in the systolic model first derivative (D1n t ), as presented
in Fig. 3 (bottom).
To assess vascular and blood pressure changes, three highly
pressure dependent parameters were also extracted [25], [35],
[37], [38]. The SI is associated with the velocity of a pulse
wave in large arteries [39] and correlates with pulse pressure
[35] was defined as the time span between the forward wave
(g1 + g2 + g3 ) and the reflected wave (g4 ) and is described by:
SI = T 2 − T 1

(4)

where the T1 is the time index corresponding to the maximum
of the forward wave (g1 + g2 + g3 ) and the T2 is the time index
corresponding to the peak of the reflected wave (g4 ), as indicated
in Fig. 3 (middle).
The RI, associated with small artery stiffness [39], was defined as the ratio between the amplitudes of the forward wave
(g1 + g2 + g3 ) and the reflected wave (g4 ) and is described by:

Fig. 4. Example of the adopted outlier detection approach based on a 121
beat sliding window box plot analysis. Top: Extracted LVET parameter (P R 2 )
smoothed LVET (P Rs2 ) and detected outliers. Bottom: LVET parameter
difference (P D 2 ), and outlier detection criterion limits (Q1 − 3∗ IQR and
Q3 + 3 ∗ IQR).

P Di (t) = P Rsi (t) − P Ri (t)

(6)

where P Di (t) is the resulting time series without the main
trend (presented in Fig. 4 for the LVET parameter—bottom),
herein called as parameter difference.
Let P Diw (t) = {P Di (t − w, . . . , t + w} be a temporal sliding window over the derived time series P Di with length
w∗ 2 + 1 and centered in the instant t, for the ith parameter.
For each window, the lower quartile (Q1: 25th percentile), the
upper quartile (Q3: 75th percentile), and the interquartile range
(IQR = Q3 − Q1) are identified. The P Ri sample at the instant t is considered an outlier if the corresponding P Di sample
(see Fig. 4—bottom) satisfies the following criterion:

(5)

P Di (t) < Q1 − 3 ∗ IQR ∨ P Di (t) > Q3 + 3 ∗ IQR. (7)

where P1 is the amplitude of the forward wave (g1 + g2 + g3 )
and P2 is the amplitude of the reflected wave (g4 ), as indicated
in Fig. 3 (middle).
Finally, PAT80% was defined as the time span between the
ECG R-peak and the moment in time corresponding to 80%
of the PPG pulse amplitude after its onset, which is known to
correlate well with a decreasing BP in NMS [11].

Finally, all the identified outliers are excluded from the extracted parameters time series P Ri .
The rationale behind this approach is that the sporadic parameter values resulting from artifacts and noise can be detected as
outliers, which greatly differ from the parameter main trend.
Finally, the parameter time series were linearly interpolated
at a 2 Hz frequency, which according to [25] is well above the
required minimal sample frequency and a Butterworth low-pass
filter with a 0.05 Hz cutoff frequency was used to reduce high
frequency noise.

RI = P 2/P 1

C. Parameter Postprocessing
The presence of motion artifacts in the ECG signal and the
inappropriate behavior of the parameter extraction algorithms
can lead to the appearance of spurious values that do not reflect
the undergoing physiological processes and consequently in inaccurate interpretation of data. This issue can be particularly
observed in unsupervised monitoring with ill-defined measurement conditions. Therefore, a postprocessing step is needed to
detect and remove these spurious values. In the current framework, a sliding window boxplot analysis [40] was adopted to
remove outliers from the extracted parameters. First, a smoothed
version (P Rsi ) of each parameter P Ri was calculated using a
moving median average filter (121 beats length—presented in
Fig. 4 for the LVET parameter as a red thick line). The extracted P Rsi was subtracted to the parameter time series P Ri
according to

D. Feature Evaluation and Selection
To develop a robust prediction algorithm, independent from
the patient’s specific characteristics, the extracted parameters
were normalized according to (8) and (9), resulting in a set
of ten features in total (summarized in Table I). The first five
features were defined as follows:

Ri (t) =
FTi (t) = P

P Ri (t)
, i = 1, . . . , 5
P Rref i

(8)

where FTi is the ith feature, P Ri is the ith parameter, P Rref i
is the average of each parameter during the second minute (reference window) after the patient was tilted to the upright position,
and t is the time instant. The selection of the second minute

512

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
CORRESPONDENCE BETWEEN PARAMETERS/FEATURES INDEXES AND NAMES
Parameter name
HR
LVET
SI
RI
PAT

Parameter index

Feature name (first set)

Feature name (second set)

P R1
P R2
P R3
P R4
P R5


P
R1

P
R2

P
R3

P
R4

P
R5

ΔP R1
ΔP R2
ΔP R3
ΔP R4
ΔP R5

as the reference window ensures that the patient achieves orthostatic stabilization, which typically occurs within less than
1 min [6].
Additionally, the normalized changes of the extracted parameters during the last 1.5 min (the minimum response time
according to [25]) were also taken into account as follows:
FTi+5 (t) = ΔP Ri (t) =
i = 1, . . . , 5.

P Ri (t) − P Ri (t − 1.5 min)
,
P Rref i
(9)

The selection of the most appropriate features for syncope
prediction was performed using the approach proposed in [41],
where the features are selected based on a score metric (FSS)
combining their relevance and redundancy, presented in (10).
The relevance of each feature was assessed by the area under
the curve (AUC) of the receiver operating characteristic (ROC)
curve, while its redundancy was assessed by Spearman’s rank
correlation coefficient (RCC)




 FT j ∈S RCC(FTi , FTj )
(10)
FSSi = AUC (FTi ) −
|S|
where AUC (FTi ) is the AUC obtained by the ith feature,
RCC (FTi , FTj ) is Spearman’s RCC between the ith and jth
feature, S is the subset of selected features at each iteration,
and |S| its cardinality. In sum, seven features were selected
corresponding to the highest features selection scores.
1) Syncope Onset Detection Algorithm: From the analysis
of the extracted features immediately before the onset of syncope, we observed significant changes in the majority of the tilt
positive patients (see Fig. 5). The chronotropic and inotropic
variations were reflected in a substantial decrease of ΔP R1
and increase in ΔP R2 . Moreover, a significant drop in blood


pressure was reflected in a substantial increase of P
R3 , P
R5 ,

ΔP R3 , ΔP R5 and decrease of P
R4 .
To illustrate how the features vary during a HUTT, principal
component analysis was applied to the selected features in two
patients (with/without NMS), and a representation of the first
three principal components is shown in Fig. 6. In general, for
HUTT positive (po) patient, the trajectory evolves away from
the orthostatic stable reference point, just before the onset of
syncope. An example of this behavior is presented in Fig. 6
(top) for a 69-year-old patient with manifested syncope and
GTN provocation. Contrarily, on HUTT negative (ne) patients
the trajectory remains closer to the orthostatic stable state as

Fig. 5. HUTT of a 50-year-old patient with syncope onset during GTN provocation. Representation of the seven most discriminant features assessed from
the extracted parameters, SBP and HUTT sequence.

Fig. 6. Illustration of the trajectory of the three principal components extracted
from the most discriminative features, during HUTT procedure. Top: 69-yearold patient with manifested syncope and GTN provocation. Bottom: 78-year-old
patient with no syncope and GTN provocation.

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

513

TABLE II
PATIENT CHARACTERISTICS (AVG ± STD)
Tilt positive (n = 21)

Tilt negative (n = 22)

57 ± 18
86 ± 15
27.1 ± 4.6
13/8
15/6

63 ± 17
74 ± 13
26 ± 5
10/12
15/7

Age [y]
Weight [kg]
BMI [kg/m2 ]
Male/female
GTN yes/no

Fig. 7. HUTT of a 69-year-old patient with manifested syncope and GTN
provocation. Top diagram: SBP (blue) and FD (black) time series during HUTT.
Bottom diagram: Phases of HUTT. Reference window represent as a black bar,
corresponding to the second minute of phase 2. BPf window corresponds time
between the start of BP fall and the syncope episode.

shown in Fig. 6 (bottom) for a 78-year-old patient with no
syncope after GTN administration.
These findings suggest that distance metrics might be used
to differentiate the stable state from the risk of an impending
event, i.e., to capture changes relative to a stable orthostatic
reference at the beginning of the standing period (FTref). In
order to choose the distance metric that better suits syncope
prediction, several metrics were evaluated using ROC analysis
combined with a fivefold cross-validation scheme. The highest F-measure was adopted as the selection criterion leading
to the selection of the Minkowski distance metric (p = 2−0.5 ),
which was calculated according to (11). Since the proposed
measure does not account for the direction of the evolving trajectory, it is necessary to eliminate feature variations that are
not associated with the physiological mechanisms underlying
NMS, and might negatively affect FD measure. Therefore, the

R4 values below
ΔP R3 and ΔP R5 values above unit and P
unit were set to one. Additionally, ΔP R1 values below zero,
and ΔP R2 , ΔP R3 and ΔP R5 values above zero were set to
zero
1/p
 7

p
|FTi (t) − FTref i |
, p = 2−0.5 (11)
FD (t) =
i=1

where FD (t) is the Minkowski distance at the time instant t.
Impending NMS was detected when FD crosses a predefined optimal threshold. The SBP, FD, and HUTT sequence
are presented in Fig. 7 for an example case of 69-year-old
patient.
III. DATA COLLECTION
A. Study Design and HUTT Protocol
Data were acquired during scheduled diagnostic HUTT from
55 patients with unexplained syncope. All patients gave written
informed consent to participate in this study (ClinicalTrials.gov
identifier: NCT01262508).

The HUTT protocol followed the recommendation of the
European Society of Cardiology (ESC) and consisted of four
phases: 1) the patient was lying at rest of at least 15 min; 2) the
patient did a passive standing exercise of 20 min at a position
of 70°; 3) phase (2) was extended by 15 min, if no syncope
occurred, with sublingual administration of 400 μg of glycerol
trinitrate (GTN); and 4) the patient was tilted back to supine
position. The HUTT stopped at any moment in time, if syncope
occurred and the patient was brought back to supine position
immediately for recovery. The nurse accompanying the study
documented any prodromal symptoms such as dizziness, sweat,
tremor, etc., during the procedure.
According to the guideline of ESC, the test outcome was
classified as positive (po) or negative (ne) [2]. A positive result
is characterized by occurrence of syncope or presyncope with
the presence of bradycardia, hypotension, or both.
Data of 12 patients had to be removed due to BP regulation failures not caused by syncope, presence of arrhythmias or
poor data quality in BP and PPG signals. The characteristics
of the reaming study population consisting of 43 patients are
summarized in Table II.
B. Experimental Setup
The patients were monitored using two independent acquisition systems during the whole HUTT protocol.
The ECG-II lead and PPG signal (with sampling frequencies of 500 and 126 Hz, respectively) were acquired using a
Philips MP50 patient monitor [42] extended with a data logger
functionality. To collect the PPG signal, a standard SpO2 sensor
was attached to the index finger.
Continuous noninvasive blood pressure (@50 Hz) was collected using a “Taskforce Monitor” [43]. Additionally, two ECG
leads (@1000 Hz) and an ICG signal (@50 Hz) were also acquired. Based on these signals, several hemodynamic parameters are provided, such as continuous (beat-to-beat) SBP, total
peripheral resistance index, and stroke volume.
The synchronization of the data coming from both systems was performed by temporally aligning the RR intervals
time series extracted from ECG signals of both acquisition
systems.
IV. RESULTS AND DISCUSSION
To evaluate the performance of the proposed algorithm,
two validation schemes have been adopted: 1) three-way data

514

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 9. Box plot of the percentage of pulses classified as motion artifacts (top)
and parameter samples detected as outliers (bottom).

Fig. 8. Diagram of the adopted three-way data split validation scheme.
Train/validation: Feature selection, distance metric selection and optimal threshold definition. Test: Evaluation of the proposed algorithm prediction capability.

split validation (shown in Fig. 8); and 2) leave-one-out crossvalidation LOO CV.
In the three-way data split validation scheme, the dataset was
randomly partitioned into a train/validation and test subsets.
The train/validation subset was constructed in order to have
approximately 70% of the study population, corresponding to
15 po patients and 15 ne patients. The remaining 13 patients (ap.
30%), i.e., six po patients and seven ne patients, were included
in the test subset.
The train/validation subset was used to select the best features, evaluate the performance of the proposed algorithm, and
select the optimal threshold for syncope prediction. The algorithm performance and optimal threshold were evaluated using a
fivefold cross validation (5f-CV) approach (repeated 20 times).
In this process, the training set (four subsets) is used to find
the optimal threshold based on ROC analysis, while remaining
subset is used for validation. This process was repeated for each
of the five subsets (folds). The test subset was used to validate
the final solution, and test the real algorithms’ performance.
In the leave-one-out cross validation scheme, the dataset was
partitioned into 43 subsets, corresponding to each patient. From
the 43 subsets, 42 subsets were used for training and the remaining subset was used for testing. The cross-validation process was
repeated 43 times with each of the 43 subsets being used exactly
once as the validation data.
The proposed methodology was evaluated using the following metrics: F-measure (F-m), sensitivity (SE) and specificity
(SP), positive predictive value (PPV), false-positive rate per
hour (FPRh), prediction time average (aPTime), and standard
deviation (sPTime).
The detection result was considered a true positive (TP) if an
alarm is generated within the time window corresponding to the
time between the start of BP fall and the syncope episode (BPf
window). Otherwise, the detection result was considered a false
positive (FP). A true negative (TN) was assigned if no alarm
is generated outside the BPf window, whereas a false negative
(FN) is considered if alarms are generated in this period. The
FPRh was defined as the number of false-positives divided by
the sum of all non-BPf windows (in hours) of all patients, while

the PTime was defined as the time span between the first alarm
and the syncope episode.
In the fivefold CV, the performance of the algorithm was assessed in each iteration and the average was computed. After
repeating this process 20 times, the average and standard deviation (avg ± std) of the aforementioned metrics were evaluated.
In the LOO CV, the performance of the algorithm was computed
based on the countings of each iteration detection result, at the
end of the CV process.
A. Motion Artifacts Detection and Parameter Postprocessing
The percentage of the detected motion artifacts and outliers
was assessed for each patient and the results were evaluated
using a box plot analysis, which is presented in Fig. 9. It is
possible to observe that the percentage of detected motion artifacts is far greater (Median: 21.64%; Mean: 26.68%) than the
percentage of detected outliers (Median: 3.94%; Mean: 4.56%).
Moreover, the percentage of motion artifacts detected in 3 of
the 43 patients was greater than 70%. These results suggest that
even in a controlled environment such as the HUTT, the PPG
signal is prone to be corrupted with motion artifacts. The results
also show a discrepancy between the percentage of detected
motion artifacts and outliers, which can be explained by the
percentage of false detections of the motion artifacts detection
algorithm (approximately 10%). Another possible reason relies
on the outlier detection algorithm itself. Since it is based on a
boxplot analysis, it is expectable that sections corrupted with
motion artifacts result in a high variance in the extracted parameters, which prevents the correct identification of outliers. These
results emphasize the importance of combining both motion artifacts and outliers detection algorithms in order to increase the
robustness of the syncope prediction method.
Regarding the segmentation of the PPG signal, the adopted
algorithm was able to identify the PPG pulses with a sensitivity
of 96.27% and a positive predictive value of 97.23% in the
current dataset.
B. Feature Selection
The feature selection results are presented in Table III. One
observes that the feature presenting the highest FSS refers to


R3 , related to SI. The rePAT parameter (P
R5 ), followed by P
maining selected features correspond to the normalized changes
of HR (ΔP R1 ) over a 1.5 min window and to the change of

RI relatively to the reference window (P
R4 ). It is also evident

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

TABLE III
PERFORMANCE OF THE EXTRACTED FEATURES (FT1 , . . . , 1 0 )
Feature Score (%) SE (%) SP (%) PPV (%) FPRh (h−1 ) aPTime (s) sPTime (s)
acronym

P
R5

P
R3
ΔP R1

P
R4
ΔP R5
ΔP R3
ΔP R2

P
R2

P
R1
ΔP R4

94.6
89.6
75.8
71.0
70.7
68.3
67.4
56.0
49.0
35.9

100.0
80.0
80.0
86.7
80.0
80.0
80.0
93.3
73.3
100.0

90.0
96.7
86.7
83.3
93.3
93.3
73.3
60.0
90.0
10.0

83.3
92.3
75.0
72.2
85.7
85.7
60.0
53.8
78.6
35.7

1.7
0.8
2.4
2.0
0.8
0.3
4.1
5.2
1.2
11.3

101.0
125.2
60.8
113.2
76.4
84.5
90.2
201.6
77.0
206.7

85.4
121.3
72.3
94.2
143.0
84.3
80.6
130.2
142.7
141.8

515

shown in Fig. 10, the distance metric presenting the best score is
the Minkowski distance with parameter p = 2−0.5 and therefore
it used in the assessment of the distance between the evolving
trajectory and the stable orthostatic reference.
D. Syncope Detection
The performance of the proposed algorithm was evaluated
in two separate phases. First, the algorithm performance (presented in Table IV—3W-DS validation) and the optimal threshold were evaluated using a 5f-CV scheme (repeated 20 times)
in train/validation phase. Second, the real prediction capability
of the proposed solution (presented in Table IV—3W-DS test)
was tested on the test subset using the optimal threshold (TH0 ).
The optimal threshold (TH0 ) was evaluated based on the
following criterion:


N
K


TH(n, k)
(12)
1/K
TH0 = 1/N
n =1

Fig. 10.

Bar plot representing the scores of the evaluated distance metrics.

that between the seventh and eighth features (separated by a
thick red line in Table III) there is a huge gap in the FSS score
(ࣈ11.4%). The low performance of the last three features, as
indicated by the FSS decrease, resulted in the exclusion these
features. In summary, seven features were selected from a to
tal of ten extracted features. Although the best feature (P
R5 )
extracted from the analysis of the PAT parameter present the
highest FSS, it is worth noting that it presents lower SP (90%)

and PPV (83.3%), when compared to P
R3 (SP: 96.7% and PPV:
92.3%). Additionally, this feature presents a high FPRh (1.7 h−1 )

when compared to the selected features, and particularly P
R3
(0.8 h−1 ).
The selected features with the highest prediction time (aP
Time) also derive from the analysis of SI (P
R3 : 125.2 s), fol

lowed by P R4 (113.2 s) and P R5 (101.0). The aPTime of
the remaining features ranges from 60.8 s (ΔP R1 ) to 90.2 s
(ΔP R2 ).
C. Distance Metric Selection
The selection of the most appropriate distance metric was
achieved using a fivefold cross-validation scheme (repeated
20 times) and the distance metric obtaining the best F-measure
score was chosen. The scores obtained by each distance metric and corresponding parameters are presented in Fig. 10. As

k =1

where TH is the threshold calculated at the iteration k on the
5f-CV nth repetition, N = 20 is the number of repetitions of the
5f-CV, K = 5 is the number of 5-f CV iterations/folds. Using
(12), the optimal threshold was defined as TH0 = 3.458.
Additionally, the proposed algorithm performance was also
evaluated using a leave-one-out cross-validation approach using
the whole dataset composed of 43 patients, herein called LOO
validation phase (presented in Table IV—LOO validation).
1) Influence of Motion Artifacts and Outliers: In order to
evaluate the influence of the artifacts detection and outlier removal steps on the overall performance of the proposed algorithm, each of the before mentioned train/validation and test
phases were performed using four sets of features, which are as
follows.
1) Raw data—features extracted without removing the motion artifacts and outliers.
2) Data w/o outliers—features extracted after removing the
outliers.
3) Data w/o artifacts—features extracted after removing the
motion artifacts.
4) Data w/o artifacts and outliers—features extracted after
removing the motion artifacts and outliers.
From Table IV, it is possible to observe that in each phase,
the performance of the proposed method strongly benefits from
the removal of artifacts, outliers and both. It is shown an Fmeasure increase, during the 3W-DS validation, of 13% with
the removal of outliers, approximately 8% with the removal of
artifacts and approximately 15% with the removal of both. In
the 3W-DS test phase and LOO validation, similar results have
been achieved with the exception to the increase in performance
from the data w/o outliers to the data w/o artifacts and outliers,
where no performance increase has been observed (F-measure:
3W-DS Test—92.3%; LOO validation—93%).
The removal of outliers and artifacts has also a significant
impact on the reduction of false alarms, which can be confirmed
by the decrease of the FPRh in each of the validation phases.
The number of false alarms was reduced to nearly one-quarter by
removing the outliers (3W-DS Validation: 0.68–0.18 h−1 ) and

516

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE IV
PERFORMANCE OF THE PROPOSED ALGORITHM DURING THE VALIDATION AND TESTING PHASES
Dataset

Score
avg ± STD (%)

SE avg ± std (%)

SP avg ± std
(%)

PPV
avg ± std (%)

FPRh
avg ± std
(h−1 )

aPTime
avg ± std (s)

sPTime
avg ± std (s)

Raw data

78.8 ± 3.0 †

84.0 ± 3.4

77.9 ± 2.2

34.5 ± 7.3

91.8 ± 2 †
86.5 ± 1.9 †

89.0 ± 3.3
85.3 ± 4.2

65.4 ± 2.6
70.0 ± 9.4

40.6 ± 5.1
48.7 ± 10.8

Data w/o artifacts
and outliers

93.2 ± 0.06 †

93.3 ± 9.1E−15

96.7 ±
1.0E−14

94.8 ± 0.5

0.68 ±
0.018
0.18 ± 0.05
0.16 ±
0.236
0.15 ±
0.007

67.9 ± 2.4

Data w/o outliers
Data w/o artifacts

86.7 ±
1.6E −14
96.7 ± 0
93.0 ± 2.5

61.0 ± 1.0

38.6 ± 5.9

Raw data

75.0†

100

69.2

60.0

0.88

207.1

217.8

Data w/o outliers
Data w/o artifacts
Data w/o artifacts
and outliers

†

92.3
83.3†
92.3†

100
83.3
100

92.3
92.3
92.3

85.7
83.3
85.7

0.15
0.15
0.15

217.6
197.1
243.3

197.5
243.2
242.5

Raw data

69.6†

76.2

79.1

64.0

0.75

138.8

147.0

Data w/o outliers
Data w/o artifacts
Data w/o artifacts
and outliers

93.0†
87.8†
93.0†

95.2
85.7
95.2

95.4
95.4
95.4

90.9
90.0
90.9

0.18
0.16
0.14

107.9
100.9
116.4

141.6
140.8
155.5

Phase

3W-DS
Validation

3W-DS
Test

LOO
validation

†

94.4 ± 0.82
88.7 ± 4.1

F-measure (F-m).

to nearly one-fifth by removing both artifacts and outliers (3WDS Validation: 0.68–0.15 h−1 ). These results are even more
expressive in LOO validation, where a decrease in the FPRh
from 0.75 to 0.14 has been observed.
The removal of outliers and artifacts also affected the prediction time of the proposed algorithm. However, while in the
3W-DS validation (aPTime: 67.9–61.0 s) and in the LOO validation (aPTime: 138.8–116.4 s) is observed a decrease in the
prediction time, in the 3W-DS test phase, the result was the
opposite (aPTime: 207.1 to 243.3 s).
These results show the importance to remove artifacts before parameters are extracted. Additionally, they emphasize the
importance of combining the artifacts removal with an outlier removal step, focused on the detection of spurious values
provided by the parameter extraction algorithm. Since the postprocessing step targets the extracted parameters rather than the
characteristics of the analyzed signal, it is capable of detecting unreasonable behaviors caused by the parameter extraction
algorithms. Therefore, the combination of both algorithms in
the present framework results in a great enhancement of the
proposed methods’ performance.
2) Prediction Capability: In the 3W-DS validation phase, the
proposed algorithm achieved an SE of 93.3%, associated with
high specificity (SP: 96.7%) and positive predictive value (PPV:
94.8%). Moreover, the number of false-positives per hour is
low (FPRh: 0.15 h−1 ) and a good prediction time was achieved
(aPTime: 61 s). The variance of the achieved prediction times
(sPTime) was 38.6 s.
In the LOO validation, the proposed algorithm also achieved
high performance (SE: 95.2%; SP: 95.4%; PPV: 90.9%), followed by a low FPRh (0.14 h−1 ) and a good prediction time
(116.4 ± 155.5 s).
In the 3W-DS testing phase, the proposed syncope prediction
solution achieved a high SE of 100%, without compromising

both specificity (SP: 92.3%) and positive predictive value (PPV:
85.7%). Moreover, the number of false-positives per hour is
low (FPRh: 0.15 h−1 ) and a good prediction time was achieved
(aPTime: 243.3 s). The onset of impending syncope was detected
in a range of 62 to 629.5 s (presented in Table V) and presented
a high variance (sPTime: 242.5 s).
Our results obtained in each validation phase show a minor decrease in the proposed algorithm score, from the 3W-DS
validation to the LOO validation phase (93.2% against 93%),
and from the 3W-DS validation to 3W-DS test phase (93.2%
against 92.3%), as presented in Table IV. However, there was
a substantial increase in SE (93.3–100%) and decrease in PPV
(94.8–85.7%), from the 3W-DS validation to the 3W-DS test
phases. Similarly, there was an increase in SE (93.3–95.2%)
and decrease in PPV (94.8–90.9%), from the 3W-DS validation
to the LOO validation. The FPRh was similar in both phases
(ࣈ0.15 h−1 ). Contrarily, there was a substantial increase in the
prediction time average and standard deviation (65.37 ± 40.6 s
to 217 ± 197.45 s), from the 3W-DS validation to the test phase.
This discrepancy between the validation and testing performances reflect the differences in the syncope development timings between patients, suggested by the distinct prodomi times
presented in Table V.
In order to evaluate the stability of the proposed method, we
evaluated its performance in terms of sensitivity and specificity
as a function of the adopted threshold. From Fig. 11, it is possible
to observe that the optimal threshold identified during the 3WDS validation phase is within a large range of possible values
(from 3.391 to 4.461) yielding the best performance (SE: 100%
and SP: 92.3%), presented in Table IV. Moreover, a reduction in
Th0 of at least 0.28 is needed to decrease the specificity below
84% and a rise of at least 1 to set the sensitivity below 70%.
These results indicate that the extracted features provide robust
discrimination within a large range of optimal thresholds.

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

517

TABLE V
PERFORMANCE OF THE PROPOSED ALGORITHM USING THE LOO VALIDATION
SCHEME FOR THE 43 PATIENTS
Syncope
No
Yes
Yes
Yes
Yes
No
Yes
Yes
No
Yes
No
No
Yes
No
No
Yes
No
Yes
No
No
No
No
No
No
Yes
Yes
Yes
Yes
No
Yes
Yes
No
Yes
No
No
Yes
No
No
Yes
Yes
No
No
Yes

PATIENT

TP

FP

TN

FN

Prediction time (s)

Prodomi (s)

#05
#07
#08
#09
#10
#11
#12
#13
#14
#15
#16
#17
#18
#20
#21
#24
#25
#26
#27
#28
#29
#30
#31
#32
#33
#34
#36
#37
#38
#39
#40
#41
#42
#43
#45
#46
#48
#49
#50
#53
#54
#55
#56

0
1
1
1
1
0
1
1
0
1
0
0
1
0
0
1
0
1
0
0
0
0
0
0
0
1
1
1
0
1
1
0
1
0
0
1
0
1
1
0
0
0
1

0
0
0
0
1
0
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

1
1
1
1
0
1
1
1
1
1
0
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

–
82
8
62.5
627.5
–
36
86
–
65
–
–
24
–
–
71
–
145
–
–
–
–
–
–
–
29.5
61.5
59,5
–
66
33
–
50
–
–
155
–
24
181
–
–
–
461.5

–
218.1
150.1
98.2
759.9
–
92.7
211.4
–
92
–
–
167
–
–
48
–
192
–
–
–
–
–
–
368
26
50
43
–
43
195
–
53
–
–
368
–
30
178
–
–
–
495

Fig. 11. Representation of the evolution of the sensitivity and specificity
performance metrics as a function of the adopted threshold for the 3W-DS test
set (data w/o artifacts and outliers)

Fig. 12. HUTT of a 17-year-old patient with syncope after GTN
administration.

The individual results achieved for each of the 43 patients included in the LOO validation (presented in Table V) show that
the proposed solution predicted majority of the syncope events
with an acceptable prediction time (over 60 s). This time span
is enough to inform the patient for the need to start PCMs or
simply to sit/lay down to avoid falling. Moreover, there was a
misdetection in patient #10 (FP = 1), which led to the decrease
in the SP, PPV and increase in FPRh metrics. It is noteworthy
to mention that although it was considered as a FP (as a result of an alarm triggered outside the BPf window), this patient
suffered a syncope episode subsequently and therefore should
not be considered a false-positive. Fig. 12 shows that the optimal threshold is surpassed due to a substantial drop in SBP
(>40 mmHg) around 57 min, which continues to decrease until
the moment of syncope. From Table V, one observes that onset
of prodromal symptoms in the majority of the patients preceded
syncope detection (range: 3–213 s; 90.2 ± 67.2 s). Yet, prodromal symptoms in the context of the standardized clinical HUTT
procedure tend to be more pronounced than during “real-life”
onset of syncope. Moreover, in the current study, even the slight
symptoms were recorded as prodromal sensations (e.g., mild
dizziness or nausea), which in an ambulatory setting might be
ignored by the patients.
An important characteristic of our method is the compromise
between a high performance, supported by the high values of
SE, SP, and PPV (above 85%), and the low false-positive rate per
hour, in both validation and testing phases. This is essential in
the ambulatory p-health setting, since it helps to avoid mistrust
and compromised patient compliance due to false-positive syncope detections. Moreover, the observed prediction times can
give patients the ability to act appropriately, e.g., by performing
PCMs or simply to sit/lay down avoiding a fall. PCMs act via the
increase of sympathetic activity and vascular resistance to raise
BP in order to avoid or to delay NMS. According to [44], the effects of PCMs such as the hand grip maneuver were evident after
the first 10 s and showed significant BP increases after 2 min.
Our results of prediction times ranging from 1 to 9 min might
be helpful in an early execution of PCMs and therefore could

518

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE VI
PERFORMANCE OF THE ALGORITHMS PROPOSED IN LITERATURE FOR REAL-TIME SYNCOPE PREDICTION
Dataset
Virag et al. [22]
Mereu et al. [23]
Eickolt et al. [26]
Meyer et al. [27]
Muhlsteff et al. [25]
Proposed method∗
∗

SE avg ± std (%)

SP avg ± std (%)

PPV avg ± std (%)

FPRh avg ± std (h−1 )

PTime avg ± std (s)

Modalities

Number of volunteers

95
86.2
81
100
90.48
95.2

93
89.1
85
100
83.33
95.4

–
–
–
100
82.61
90.9

–
–
–
–
–
0.14

128 ± 216
44.1 ± 6.6
203 ± 227s
99 ± 108
77.71 ± 71.78
116.4 ± 155.5

ECG/ABPW
ECG/ABPW
ECG/PPG
ECG/PPG
ECG/PPG
ECG/PPG

1155
145
44
14
43
43

LOO validation; data w/o artifacts and outliers.

facilitate the timely administration of effective interventions to
prevent or delay NMS.
3) Comparison With the State of the Art: Performing a fair
comparison between our method and the other state of the art
methods is a challenging task, considering the heterogeneity of
the experimental and test protocols, as well as differences in the
populations’ demographics. However, keeping these topics in
our consideration, the comparison and discussion of the methods
prediction performance can still be accomplished.
In Table VI, we compare results achieved by our method
and methods discussed in literature for real-time prediction of
NMS. Visibly, our method outperforms the others in terms of
SE, SP, and PPV metrics, excluding the method proposed by
Meyer et al. [27] (SE/SP/PPV: 100%); however, this study was
intended to show basic feasibility under ideal conditions using
PAT with a small enrolled number of 14 patients only.
Next to our method is the approach proposed by Virag et al.
[22], which focused on the analysis of the HR and SBP trends.
The results in this study present a similar performance (SE: 95%
and SP: 93%). Although no values were provided regarding the
PPV and FPRh, the validation of the proposed method on a
much larger population (1155 patients) suggests that the presented results are founded on strong statistics, which represents
a great advantage compared to the other methods discussed before. Nonetheless, the dependence on the analysis of the arterial
blood pressure waveform to assess the SBP trends is still a major disadvantage, since the current available sensors still present
limitations regarding their long-term applicability. The remaining algorithms proposed by Mereu et al. [23], Eickolt et al.
[26], and Muehlsteff et al. [25] presented similar performances
regarding the SE and SP metrics (above 80%).
Considering the prediction time, Eickolt et al. [26] reported
the best with 203 ± 227 s, followed by Virag et al. [22] (128 ±
216 s), and then by our approach (116.4 ± 155.5 s). The lowest
prediction time was achieved by Mereu et al. [23] with 44.1 ±
6.6 s in advance of a syncope.
E. Wearable Sensors and Real-Life Scenarios
Our NMS prediction algorithm requires the ECG and PPG
signals only, which can be easily acquired in real life. For that
purpose, within the EU-funded “HeartCycle” project, a wearable monitoring system called “SENSATRON” has been developed. The “SENSATRON” is a multisensor device with a
modular design, which can be easily adapted to home and clinical monitoring scenarios. The system can be easily integrated

Fig. 13. Left: SENSATRON system attached to a subject by standard adhesive electrodes. Right: functional textile as user-interface developed within
HeartCycle for the SENSATRON device.

functional textiles [45], as shown in Fig. 13. Data are stored on
an on-board memory card and/or can be wirelessly transmitted
via Bluetooth to an external hub.
This device features extended functionalities and acquires
an ECG, an impedance cardiogram (ICG), near-infrared PPG,
infrared PPG, thoracic inductive plethysmogram, skin temperature as well as sound signals from two thorax locations [46].
Additionally, up to three three-axis acceleration sensors at the
thorax, arms or legs provide information on posture and movements. In fact, context information provided by the acceleration
sensors will play a fundamental role in the translation of the proposed algorithm in real-life setting, e.g., the detection of motion
near the ECG electrodes and PPG sensor. This information can
be used in the assistance of the proposed method to improve
handling of PPG and ECG motion artifacts and increase the
algorithm performance. Additionally, the detection of posture
changes provides the temporal windows where orthostatic stabilization is achieved and which time windows shall be used for
the normalization of the extracted features. Based on this context
information, our algorithm is able to self-calibrate periodically
without any human interventions.
V. CONCLUSION AND FUTURE WORK
In this work, a real-time algorithm for syncope prediction
based on the evaluation of chronotropic (HR), inotropic (LVET),
and vascular tone (SI, RI and PAT) parameters are presented.
Features are derived by analysis of ECG and PPG signals only
and were combined into a single distance measure. NMS was detected by an appropriately and robust threshold-based approach.
The algorithm was trained and tested on a population of
43 patients using a three-way data split validation scheme. A
train/validation subset (30 patients) was used to select the most
relevant and least redundant features, the most suitable distance

COUCEIRO et al.: REAL-TIME PREDICTION OF NEURALLY MEDIATED SYNCOPE

metric and to define the optimal threshold for syncope prediction. The threshold was found using a fivefold cross-validation
approach, repeated 20 times. The prediction capability of the
proposed algorithm was evaluated in the test subset of 13 patients (SE: 100%; SP: 92.3%; PPV: 85.7%; FPRh: 0.15 h−1 ;
aPTime: 243.3 s) and in all 43 patients using a leave-one-out
cross-validation scheme (SE: 95.2%; SP: 95.4%; PPV: 90.9%;
FPRh: 0.14 h−1 ; aPTime: 116.4 s).
Our results highlight the potential importance of a combined
analysis of the extracted parameters in the prediction of impending NMS. Additionally, we demonstrate the robustness of the
algorithm approach against artifacts, which will be key feature
to transfer our method into to ambulatory and p-health settings.
Future work will focus on the adaptation and deployment of
the proposed framework into a continuous monitoring (24/7)
wearable system. Moreover, the validation of the algorithm in
real-life scenarios such as home care and ambulatory will be also
under our concern. Finally, the improvement of the usability of
the system and respective sensors will also be one of our primary
interests.
ACKNOWLEDGMENT
The authors would like to thank the medical and nursing staff
of the Neurocardiology Unit, Division of Cardiology, Pneumology and Angiology, University Düsseldorf, for supporting this
study. They would also like to thank especially S. Gläser for
excellent technical support.
REFERENCES
[1] A. Moya, R. Sutton, F. Ammirati, J. J. Blanc, M. Brignole, J. B. Dahm,
J. C. Deharo, J. Gajek, K. Gjesdal, A. Krahn, M. Massin, M. Pepi,
T. Pezawas, R. Ruiz Granell, F. Sarasin, A. Ungar, J. G. van Dijk, E.
P. Walma, and W. Wieling, “Guidelines for the diagnosis and management of syncope (version 2009),” Eur. Heart J., vol. 30, pp. 2631–2671,
Nov. 2009.
[2] N. Colman, K. Nahm, K. S. Ganzeboom, W. K. Shen, J. Reitsma,
M. Linzer, W. Wieling, and H. Kaufmann, “Epidemiology of reflex syncope,” Clin. Auton. Res., vol. 14, no. Suppl. 1, pp. 9–17, Oct. 2004.
[3] E. S. Soteriades, J. C. Evans, M. G. Larson, M. H. Chen, L. Chen, E.
J. Benjamin, and D. Levy, “Incidence and prognosis of syncope,” New
England J. Med., vol. 347, pp. 878–885, 2002.
[4] D. M. Lemonick, “Evaluation of syncope in the emergency department,”
Amer. J. Clin. Med., vol. 7, no. 1, pp. 11–19, 2010.
[5] S. Rosanio, E. R. Schwarz, D. L. Ware, and A. Vitarelli, “Syncope in
adults: Systematic review and proposal of a diagnostic and therapeutic
algorithm,” Int. J. Cardiol., vol. 162, pp. 149–157, 2013.
[6] B. P. Grubb, “Pathophysiology and differential diagnosis of neurocardiogenic syncope,” Amer. J. Cardiol., vol. 84, pp. 3–9, 1999.
[7] H. Ouyang and J. Quinn, “Diagnosis and evaluation of syncope in the
emergency department,” Emergency Med. Clin. North Amer., vol. 28,
pp. 471–485, 2010.
[8] N. Lippman, K. M. Stein, and B. B. Lerman, “Failure to decrease parasympathetic tone during upright tilt predicts a positive tilt-table test,” Amer. J.
Cardiol., vol. 75, pp. 591–595, 1995.
[9] G. Kochiadakis, P. Lees, E. Kanoupakis, N. Igoumenidis, E. Manios,
and P. Vardas, “Spectral analysis of heart rate variability in the analysis of
autonomic nervous system activity during tilt-table testing in patients with
unexplained syncope,” in Proc. Comput. Cardiol., 1997, pp. 367–369.
[10] C. A. Morillo, G. J. Klein, D. L. Jones, and R. Yee, “Time and frequency domain analyses of heart rate variability during orthostatic stress
in patients with neurally mediated syncope,” Amer. J. Cardiol., vol. 74,
pp. 1258–1262, 1994.
[11] A. Madrid, C. Moro, E. Marin-Huerta, L. Novo, J. Mestre, J. Lage, and
E. Ricoy, “Usefulness of the RR variability in the diagnosis of neurogenic
syncope,” Revista Espanola De Cardiol., vol. 47, pp. 536–543, 1994.

519

[12] J. E. Naschitz, I. Rosner, M. Rozenbaum, M. Fields, H. Isseroff, J. P.
Babich, E. Zuckerman, N. Elias, D. Yeshurun, S. Naschitz, and E. Sabo,
“Patterns of cardiovascular reactivity in disease diagnosis,” QJM, vol. 97,
no. 3, pp. 141–151, Mar. 1, 2004.
[13] Z. Mallat, E. Vicaut, A. Sangaré, J. Verschueren, G. Fontaine, and R.
Frank, “Prediction of head-up tilt test result by analysis of early heart rate
variations,” Circulation, vol. 96, pp. 581–584, 1997.
[14] M. Sumiyoshi, Y. Nakata, Y. Mineda, T. Tokano, M. Yasuda, Y. Nakazato,
and H. Yamaguchi, “Does an early increase in heart rate during tilting
predict the results of passive tilt testing?” Pacing Clin. Electrophysiol.,
vol. 23, no. 12, pp. 2046–2051, 2000.
[15] C. Kouakam, D. Lacroix, N. Zghal, R. Logier, D. Klug, P. Le Franc, M.
Jarwe, and S. Kacet, “Inadequate sympathovagal balance in response to
orthostatism in patients with unexplained syncope and a positive head up
tilt test,” Heart, vol. 82, no. 3, pp. 312–318, 1999.
[16] G. A. Ruiz, C. Madoery, F. Arnaldo, C. Menendez, and M. C. Tentori,
“Frequency-domain analysis of heart rate variability during positive and
negative head-up tilt test: Importance of age,” Pacing Clin. Electrophysiol.,
vol. 23, pp. 325–332, 2000.
[17] K. Efremov, D. Brisinda, A. Venuti, E. Iantorno, C. Cataldi, F. Fioravanti, and R. Fenici, “Heart rate variability analysis during head-up tilt
test predicts nitroglycerine-induced syncope,” Open Heart, vol. 1, no. 1,
pp. 1–8, Jun. 1, 2014.
[18] L. Mangin, A. Kobeissi, D. Lelouche, Y. D’Hérouville, P. Mansier,
B. Swynghedauw, and I. Macquin-Mavier, “Simultaneous analysis of
heart rate variability and myocardial contractility during head-up tilt in patients with vasovagal syncope,” J. Cardiovascular Electrophysiol., vol. 12,
no. 6, pp. 639–644, 2001.
[19] D. Schang, M. Feuilloy, G. Plantier, J.-O. Fortrat, and P. Nicolas, “Early
prediction of unexplained syncope by support vector machines,” Physiol.
Meas., vol. 28, pp. 185–197, 2007.
[20] E. Bellard, J. O. Fortrat, D. Schang, J. M. Dupuis, J. Victor, and G.
Leftheriotis, “Changes in the transthoracic impedance signal predict the
outcome of a 70 degrees head-up tilt test,” Clin. Sci., vol. 104, pp. 119–126,
Feb. 2003.
[21] C. Chun-An, C. Hsin, and C. Hung-Wen, “Early detection of vasovagal
syncope in tilt-up test with hemodynamic and autonomic study,” in Proc.
Comput. Cardiol., 2011, pp. 529–532.
[22] N. Virag, R. Sutton, R. Vetter, T. Markowitz, and M. Erickson, “Prediction
of vasovagal syncope from heart rate and blood pressure trend and variability: Experience in 1,155 patients,” Heart Rhythm, vol. 4, pp. 1375–1382,
2007.
[23] R. Mereu, G. De Barbieri, T. Perrone, A. Mugellini, A. Di Toro, and L.
Bernardi, “Heart rate/blood pressure ratio as predictor of neuromediated
syncope,” Int. J. Cardiol., vol. 167, pp. 1170–1175, 2013.
[24] E. Chung, G. Chen, B. Alexander, and M. Cannesson, “Non-invasive
continuous blood pressure monitoring: A review of current applications,”
Frontiers Med., vol. 7, pp. 91–101, 2013.
[25] J. Muehlsteff, T. Correia, R. Couceiro, P. Carvalho, A. Ritz, C. Eickholt,
M. Kelm, and C. Meyer, “Detection of hemodynamic adaptations during
impending syncope: Implementation of a robust algorithm based on pulse
arrival time measurements only,” in Proc. 35th Annu. Int. Conf. IEEE Eng.
Med. Biol. Soc., 2013, vol. 2013, pp. 2291–2294.
[26] C. Eickholt, T. Drexel, J. Muehlsteff, A. Ritz, M. Siekiera, K. Kirmanoglou, D.-I. Shin, T. Rassaf, M. Kelm, and C. Meyer, “Neurally mediated syncope prediction based on heart rate and pulse arrival time,” Eur.
Heart J., vol. 34, no. 1, pp. 161, Aug. 1, 2013.
[27] C. Meyer, G. Morren, J. Muehlsteff, C. Heiss, T. Lauer, P. Schauerte, T.
Rassaf, H. Purerfellner, and M. Kelm, “Predicting neurally mediated syncope based on pulse arrival time: Algorithm development and preliminary
results,” J. Cardiovascular Electrophysiol., vol. 22, no. 9, pp. 1042–1048,
2011.
[28] R. Couceiro, P. Carvalho, R. P. Paiva, J. Muehlsteff, J. Henriques,
V. Schulze et al., “Characterization of surrogate parameters for blood
pressure regulation in neurally-mediated syncope,” in Proc. 35th Annu.
Int. Conf. IEEE Eng. Med. Biol. Soc., 2013, pp. 5381–5385.
[29] R. Couceiro, P. Carvalho, R. P. Paiva, J. Henriques, and J. Muehlsteff,
“Detection of motion artifact patterns in photoplethysmographic signals
based on time and period domain analysis,” Physiol. Meas., vol. 35,
pp. 2369–2388, 2014.
[30] C.-C. Chang and C.-J. Lin, “LIBSVM: A library for support vector machines,” ACM Trans. Intell. Syst. Technol., vol. 2, pp. 27:1–27:27, 2011.
[31] J. Pan and W. J. Tompkins, “A real-time QRS detection algorithm,” IEEE
Trans. Biomed. Eng., vol. BME-32, no. 3, pp. 230–236, Mar. 1985.
[32] R. Couceiro, P. Carvalho, R. Paiva, J. Henriques, M. Antunes, I. Quintal,
and J. Muehlsteff, “Multi-Gaussian fitting for the assessment of left ven-

520

[33]
[34]
[35]

[36]
[37]

[38]

[39]

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

tricular ejection time from the Photoplethysmogram,” in Proc. 34th Annu.
Int. Conf. IEEE Eng. Med. Biol. Soc., San Diego, 2012, pp. 3951–3954.
Y. Sun, K. Chan, and S. Krishnan, “Characteristic wave detection in ECG
signal using morphological transform,” BMC Cardiovascular Disorders,
vol. 5, no. 28, pp. 1–7, 2005.
U. Rubins, “Finger and ear photoplethysmogram waveform analysis by
fitting with Gaussians,” Med. Biol. Eng. Comput., vol. 46, pp. 1271–1276,
2008.
M. Baruch, D. Warburton, S. Bredin, A. Cote, D. Gerdt, and C.
Adkins, “Pulse decomposition analysis of the digital arterial pulse
during hemorrhage simulation,” Nonlinear Biomed. Phys., vol. 5,
no. 1, pp. 1–15, 2011.
R. A. Waltz, J. L. Morales, J. Nocedal, and D. Orban, “An interior algorithm for nonlinear optimization that combines line search and trust region
steps,” Math. Program., vol. 107, pp. 391–408, 2006.
J. Muehlsteff, A. Ritz, T. Drexel, C. Eickholt, P. Carvalho, R. Couceiro,
M. Kelm, and C. Meyer, “Pulse arrival time as surrogate for systolic blood
pressure changes during impending neurally mediated syncope,” in Proc.
34th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., 2012, pp. 4283–4286.
C. Meyer, G. Morren, J. Muehlsteff, C. Heiss, T. Lauer, P. Schauerte,
T. Rassaf, H. Purerfellner, and M. Kelm, “Predicting neurally mediated
syncope based on pulse arrival time: Algorithm development and preliminary results,” J. Cardiovascular Electrophysiol., vol. 22, pp. 1042–1048,
Sep. 2011.
S. S. DeLoach and R. R. Townsend, “Vascular stiffness: Its measurement
and significance for epidemiologic and outcome studies,” Clin. J. Amer.
Soc. Nephrol., vol. 3, pp. 184–192, 2008.

[40] O. Salem, L. Yaning, and A. Mehaoua, “A lightweight anomaly detection
framework for medical wireless sensor networks,” in Proc. IEEE Wireless
Commun. Netw. Conf., 2013, pp. 4358–4363.
[41] R. Wang and K. Tang, “Feature selection for maximizing the area under
the ROC curve,” in Proc. IEEE Int. Conf. Data Mining Workshops, 2009,
pp. 400–405.
[42] Philips MP50. (2008). [Online]. Available: www.philips.com
[43] Taskforce monitor. (2008). [Online]. Available: www.cnssystems.com
[44] M. Brignole, F. Croci, C. Menozzi, A. Solano, P. Donateo, D. Oddone,
E. Puggioni, and G. Lolli, “Isometric arm counter-pressure maneuvers
to abort impending vasovagal syncope,” J. Amer. Coll. Cardiol., vol. 40,
no. 11, pp. 2053–2059, 2002.
[45] H. Reiter, J. Muehlsteff, and A. Sipila, “Medical application and clinical validation for reliable and trustworthy physiological monitoring using functional textiles: Experience from the HeartCycle and MyHeart
project,” in Proc. 33th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., 2011,
pp. 3270–3273.
[46] J. Muehlsteff, P. Carvalho, J. Henriques, R. P. Paiva, and H. Reiter, “Cardiac status assessment with a multi-signal device for improved home-based
congestive heart failure management,” in Proc. 33th Annu. Int. Conf. IEEE
Eng. Med. Biol. Soc., 2011, pp. 876–879.

Authors’ photographs and biographies not available at the time of publication.

