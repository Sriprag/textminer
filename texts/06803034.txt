IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

317

Stroke Parameters Identification Algorithm in
Handwriting Movements Analysis by Synthesis
Min Liu, Xuemei Guo, and Guoli Wang

Abstract—This paper presents a new approach to identify the
stroke parameters in handwriting movement data understanding.
A two-step analysis by synthesis paradigm is employed to facilitate
the coarse-to-fine parameter identification for all strokes. One is
the stroke data extraction, the other is the coarse-to-fine stroke parameter identification. The new consideration of using this two-step
paradigm is that the nonnegative primitive factorization technique
is incorporated to decouple the overlapped strokes from the measurement data. In comparison to the existing paradigms of using
the heuristic stroke data decoupling techniques, our paradigm presented here contributes to alleviating the difficulty of local optimum
traps with the well-shaped initializations in the global optimization
for jointly identifying stroke parameters. Moreover, our paradigm
excludes the iteration between two steps, which contributes to the
enhancement of computational efficiency. Experimental results are
reported to validate the proposed approach.
Index Terms—Analysis by synthesis, handwriting movement
data understanding, nonnegative matrix factorization, strokes parameter identification.

I. INTRODUCTION
HERE are numerous applications that require the parameter identification of stroke models, including online handwriting recognition and signature verification [1], robotics [2],
neuroscience [3], motor control [4], and so on. The stroke parameter identification is becoming an important problem among the
various topics related to the analysis and understanding of human handwriting data. The pioneering studies of Plamondon and
Guerfali develop the kinematic theory for characterizing general
rapid human movements [5]. More specifically, in the context
of human handwriting data representation, the production of
fluent handwriting can be described as the vectorial superposition of strokes activated at different moments, in which the
individual strokes involved are modeled by the Delta-lognormal
function [6]. Along this line, a two-step analysis by synthesis
paradigm is presented for stroke parameter identification. In the
first step, all individual stroke data are extracted from the measurement data. In the second step, the coarse-to-fine parameter
identification is achieved with the local and global optimiza-

T

Manuscript received October 8, 2013; revised January 18, 2014; accepted
March 8, 2014. Date of publication April 21, 2014; date of current version December 30, 2014. This work was supported by the National Science Foundation
under Grant 61375080.
The authors are with the School of Information Science and Technology, Sun Yat-sen University, Guangzhou 510275, China (e-mail: isslm@mail.
sysu.edu.cn; guoxuem@mail.sysu.edu.cn; isswgl@mail.sysu.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2312334

tion procedures, so that the extracted stroke data are associated with their kinematic models. The aforementioned two-step
paradigm is mainly motivated by handling with the local optimum traps arising from using only the global optimization
for identifying all stroke parameters jointly. Indeed, the local
optimization for identifying individual stroke parameters with
the decoupled stroke data plays a role of offering the initializations for the global optimization with respect to all model
parameters.
Various algorithms have been proposed for stroke parameter identification, such as INFLEX, INITRI, XZERO algorithms [6]–[8]. However, the intrinsic coupling due to the overlaps among adjacent strokes inevitably challenges the use of the
aforementioned stroke identification algorithms in the above
two-step paradigm. To address this challenge, the heuristics approach is presented to recover the overlapped data in a sequential
fashion [9]. Two disadvantages arise from using this heuristics
approach. First, the former decoupling results will significantly
affect the latter decoupling procedures, the identification errors
of the former strokes will be accumulated into the identification
results of all the later strokes. Second, the parameter identification of individual strokes can only use the partially stroke
data decoupled from their former strokes, which prevents from
fully exploiting the stroke data in parameter identification. As
a result, it is hard for the local optimization to offer the wellshaped initializations for the global optimization as expected for
escaping the local optimum, especially, when the number of individual strokes increases [10]. Therefore, it is desirable to find
an effective way of decoupling stroke data in a nonsequential
fashion.
Recently, more evidences have been found that the velocity
is potential to characterize the handwriting movements [11].
Handwriting strokes as a special rapid human movement, like
reaching and drawing, have been observed that they are roughly
straight movement trajectories with a stereotyped single-peaked,
asymmetrical, bell-shaped velocity profiles [12]–[14]. More importantly, the stroke data coupling due to the overlaps between
adjacent strokes limits the applicability of the existing stroke
segmentation techniques [15]–[18] to the overlapped stroke extraction. Nonnegative matrix factorization is an emerging technique for complex data understanding [19]. It has been applied
to human motion data analysis, as a potential way of extracting
the overlapped stroke data [20].
This paper focuses on addressing the aforementioned challenges in identifying the handwriting stroke model parameters
under the two-step analysis by synthesis framework. The key
to our approach is that the nonnegative primitive factorization
technique [21] is incorporated into this two-step paradigm. In

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

318

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

doing this, the combination of the convolutive mixture model
and the Plamondon’s kinematic model is explored to represent
the handwriting movement data, which facilitates the nonnegative matrix factorization in decoupling overlapped stroke data. In
comparison to the existing paradigms of using the heuristic decoupling techniques, our paradigm presented here can not only
avoid the error accumulations in decoupling overlapped stroke
data, but also fully exploits the entire stroke data in parameter
identification rather than partially decoupled stroke data. These
advantages contribute to alleviating the difficulty of local optimum traps by offering the well-shaped initializations in the
global optimization for jointly identifying stroke parameters.
This paper is organized as follows. In Section II, the stroke
parameter identification problem is presented and the proposed
approach is outlined as well. In Section III, our stroke parameters identification algorithm is given in detail. In Section IV,
the experimental results are reported to validate the proposed
approach.

The kinematic theory developed for modeling rapid human
movement in [6] offers a parametric representation for the stroke
shapes involved in handwriting data. Although there are various
options for parametric representations, we emphasize that the
Delta-lognormal function is more suitable for describing handwriting strokes in the pen-tip velocity field. More specifically, a
stroke is understood as the result of the synergic control of two
neuromuscular systems. One is agonist and the other is antagonist, each of which can be described by a lognormal function [5],
that is

II. PROBLEM STATEMENTS

2
2
= Λ(t; ti0 , Di1 , μi1 , σi1
) − Λ(t; ti0 , Di2 , μi2 , σi2
)

A. Stroke Parameters Identification
Here, we will formulate the stroke parameter task under the
analysis by synthesis framework. We denote the human handwriting movement measurements in the velocity field by m(t),
which is expressed as
m(t) = [vx (t) vy (t)]T ,

(1)

where vx (t) and vy (t) are the X- and Y-components of the
velocity vector, respectively.
We assume that the handwriting movement associated with
m(t) involves N strokes. The ith stroke shape is modeled as the
kernel function wi (t), i = 1, 2, . . . , N . It is well known from
the biological evidence for motor primitives that a complex
movement can be understood as the combination result of a few
synergic primitives. In the context of handwriting movement
understanding, it is followed from the above synergic primitive
hypothesis that the handwriting movement data can be represented as the linear combination of the stroke data. That is, in
terms of {wi (t)}, the handwriting movement data m(t) can be
represented as
m(t) =

N


ci wi (t − τi ),

(2)

i=1

where ci and τi are the nonnegative scaling factor and time delay
of the ith stroke, respectively.
Remark 1: The representation given by (2) can be equivalently
expressed in the convolution mixture form [22]
m(t) =

N


Λ(t; t0 , D, μ, σ 2 )


⎧
1
⎨ √ D
exp − 2 [ln(t − t0 ) − μ]2 , t > t0 ,
2σ
= σ 2π(t − t0 )
⎩
0,
otherwise.
As a result, the modulus of wi (t), vi (t), can be expressed as
vi (t) = wi (t) = ΔΛ(t)
(3)

and the associated angular displacement, φi (t), is given by
 t
θie − θis
φi (t) = θis +
|vi (τ )|dτ.
Di1 − Di2 0
In short, nine parameters, including the amplitude, time, and
angle quantities, can completely characterize a stroke velocity
profile, which are listed as follows.
ti0 : the activation time of the input commands of the agonist
and antagonist systems.
Di1 , Di2 : the input commands of the velocity profiles of the
agonist and antagonist system.
μi1 , μi2 : the time delays of the two neuromuscular systems
on a logarithmic time scale.
σi1 , σi2 : the response time of the two neuromuscular systems
on a logarithmic time scale.
θis , θie : the start and end angles of strokes, respectively.
For given handwriting data m(t), the parameter identification
task of interest here is to estimate these stroke parameters, that
is, {ti0 , Di1 , Di2 , μi1 , μi2 , σi1 , σi2 , θis , θie }.
Remark 2: It can be seen that the combination of the convolutive mixture model [22] and the kinematic Delta-lognormal
model [5] is explored to represent the handwriting data in our
analysis by synthesis framework. In this way, in addition to extracting the primitives with the nonnegative matrix factorization
in the analysis-by-synthesis procedure as done in [20], modeling
the stroke shapes in a parameterization form is mainly concerned
to enhance the analysis-by-synthesis capability. This is our new
consideration of using the convolutive mixture model [22] and
the primitive extraction techniques [20].

(c(i) ∗ wi )(t),

i=1

where c(i) (t) = ci δ(t − τi ) can be understood as the control
command parameters of the ith stroke from the central nervous
system. Clearly, the response term, (c(i) ∗ wi )(t), characterizes
the contribution of wi (t) to m(t).

B. Outline of Our Approach
In this paper, we employ a two-step analysis by synthesis
paradigm to achieve the coarse-to-fine parameter identifications
for all strokes. In the first step, all individual stroke data are
extracted from the measurement data. In the second step, the

LIU et al.: STROKE PARAMETERS IDENTIFICATION ALGORITHM IN HANDWRITING MOVEMENTS ANALYSIS BY SYNTHESIS

coarse-to-fine parameter identification is performed with the
local and global optimization procedures, respectively, so that
the extracted stroke data are associated with their kinematic
models.
More precisely, the aforementioned two-step analysis by synthesis procedures for achieving the coarse-to-fine parameter
identification are outlined as follows.
Step 1: The task of nonnegative primitive factorization is to
extract all individual stroke data {ci , τi , wi }, which involves the
following two alternate procedures.
1) Procedure 1a: With the estimated onset delay times {τi },
extract all individual primitives {wi (t)} and estimate their
weights {ci }.
2) Procedure 1b: With the extracted primitives {wi (t)} and
the estimated their weights {ci }, determine the onset delay
time {τi }.
Step 2: The task of the coarse-to-fine parameter identification
is to estimate the Delta-lognormal parameters for all individual
strokes, which includes two procedures.
1) Procedure 2a: For each stroke, with the extracted primitive
wi (t), identify the associated Delta-lognormal parameters
by local optimization, which results in the coarse estimation of the stroke parameters.
2) Procedure 2b: With the measurement data m(t), identify
all stroke parameters jointly by global optimization with
the coarse estimation as being the initialization values,
which results in the fine estimation of the stroke parameters.
We will address more details of the aforementioned procedures in the next section.
III. MAIN RESULTS
First, we present the algorithms for solving Procedure 1a
and 1b in Step 1, respectively. Then, we address the local and
global optimization problems for the coarse-to-fine parameter
identification in Step 2.
A. Stroke Data Extraction
Let {m(tj ), j = 1, 2, . . . , T } denote the discrete samples of
m(t) collected from the digital tablet, where tj = Δt(j − 1),
Δt and T are the sampling interval and sample length, respectively. Then, we represent the discrete samples in the following
matrix form:
M = col{m(t1 ), m(t2 ), . . . , m(tT )}.
where col{v1 , v2 , . . . , vn } denotes the matrix arrayed by vector
sets {vj } in column. That is, the jth column of M is the jth
measurement sample m(tj ) at time tj . Let Wi denote the ith
stroke data, defined as
Wi = col{wi (t1 ), wi (t2 ), . . . , wi (tT )}.

In addition, we assume that τi = li Δt. Then, we have
Wi Θτ i = col{0, . . . , 0, wi (t1 ), . . . , wi (tT −l i )},
	 
 

W = [W1 , W2 , . . . , WN ].

(4)

(5)

li

where Θτ i is an T × T square matrix given by
Θτ i = col{0, . . . , 0, e1 , . . . , eT −l i }.
	 
 

(6)

li

Here, 0 is the all-zero column vector; ek denotes the T dimension column vector that only the kth element is 1 while others
are 0. It is followed from (4)–(6) that we have
WHi = Wi Θτ i ,

(7)

where Hi is the modulated structure matrix of the ith stroke,
defined as
· · 0 ΘTτi 0
· · 0]T .
Hi = [0
	 ·

	 ·


(8)

N −i

i−1

With the above expressions, it follows from (2) that we can
represent M as
M=W

N


ci Hi =: WH.

(9)

i=1

As a result, the task in the Step 1 can be attributed to a matrix factorization problem with structural restriction. Precisely,
Procedure 1a can be described as: with the known structure
restriction matrix Hi , find the solution of the following optimization problem:
2

N





min J(W, c) =: M − W
ck Hk  ,


k =1

[W]ij ≥ 0,

F

ck ≥ 0,

∀ i, j, k,
(10)

where AF = tr(AT A)1/2 = ( i,j a2ij )1/2 denotes the
Frobenius norm, [A]k l is the (k, l) element of A.
Note that the handwriting movement primitives are described
by the velocity of handwriting movement in X and Y coordinates. So, the nonnegative constraints are considered in the
aforementioned optimization problem. Obviously, Procedure 1a
faces with the same challenge as the matrix factorization with
no structural restriction. That is, the objective function J(W, c)
is nonconvex with respect to (W, c), but it is convex with respect to W and c, respectively. Following the idea of seeking
the nonnegative matrix factorization, we find the solution of the
aforementioned optimization problem by solving the following
two convex optimization problems in an alternate iteration way.
Both of them can be solved by the gradient declining strategy.
With the computed gradient of J(W, c) to W and c, the increment iterative rules of Procedure 1a are given by
[Ŵ]k l ← [Ŵ]k l + δk l [MĤT − ŴĤĤT ]k l ,

(11)

ĉi ← ĉi + ηi tr(M ŴΘτ i − Ĥ Ŵ ŴΘτ i ).

(12)

T

Then, we define the matrix W by

319

T

T

To satisfy the nonnegative constrain, the step factors are set
as δk l = [Ŵ]k l /[ŴĤĤT ]k l and ηi = ĉi /tr(ĤT ŴT ŴΘτ i ),

320

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

respectively, (11) and (12) become
[Ŵ]k l ← [Ŵ]k l
ĉi ← ĉi

[MĤT ]k l
[ŴĤĤT ]k l

tr(MT ŴΘτ i )
tr(ĤT ŴT ŴΘτ i )

.

(13)

(14)

At this stage, the aforementioned procedures can be summarized as follows: we start the alternate iteration with the
initializations of Ŵ and ĉ; in each alternate iteration, Ĥ can be
calculated with the activation time τi and the estimated value of
ĉ in the last round. Then, update Ŵ and ĉ using (13) and (14).
Compare the value of J(Ŵ, ĉ) in this round with that in the last
round. If there is less changes in the solutions, the iteration will
stop. Otherwise, go to the next round alternate iteration.
In Procedure 1b, we follow the correlation maximization principle to estimate the onset delay time. From (2), we know that
the contribution of wi (t − τi ) to m(t) is only over the support
set supp(wi (t − τi )). In other words, the correlation between
wi (t − τi ) and m(t) can only achieve over supp(wi (t − τi )).
Here, ci Wi Θτ i is of interest as a match templet. As a result, the
activation time τi can be identified by matching the templet with
M. Thus, Procedure 1b can be solved by finding the solution of
the following optimization problem:
minVi (τ ) =: M − ci Wi Θτ i 2F ,

(15)

or as shown in the Appendix, the aforementioned optimization
problem is equivalent to
τ̂i = arg max
τ ≥0

T


mT (tj )wi (tj − τ ).

(16)

j =1

Thus, the activation time τ̂i can be easily found by peak detection.
B. Coarse-to-fine Parameters Identification
The task of Step 2 is to perform the coarse-to-fine parameter
identification of the Delta-lognormal parameters for all individual strokes. The coarse parameter identification is associated
with the local optimization for matching the Delta-lognormal
function with individual stroke data. Precisely, with the extracted
stroke data wi (t), the matched Delta-lognormal parameters can
be found by solving the following optimization problem:
min fi (t)22 ,
where

subject to σi1 , σi2 ≥ 0,


fi (t) =

v̂ix (t) − vix (t)
v̂iy (t) − viy (t)



antagonist system. In the XZERO algorithm, the parameters
of agonist and antagonist systems can be separately estimated
from the first- and the second-order derivatives of the lognormal
function.
More precisely, four procedures are involved in estimating
the initialization for the coarse parameter identification.
1) Firstly, assume that the agonist system velocity profile
vi1 (t) contributes greatly to the pen-tip velocity profile Deltalognormal function vi (t). Let vi1 (t) ≈ vi (t).
2) Secondly, the three parameters Di1 , μi1 , σi1 of the agonist
system and the activation time ti0 are estimated by the method
based on the specific time indices of the given profile vi1 (t). The
specific time indices tk (k = {1, . . . , 5}) lie in zero crossings of
the first- and the second-order derivatives of the function (they
are the indices of starting point, the left inflexion point, the peak,
the right inflexion point, and the ending point, respectively).
Then compute the reconstructive velocity profile of the agonist
system v̂i1 (t) using the identified parameters.
3) Thirdly, calculate the velocity profile of antagonist system
as follows:
vi2 (t) = v̂i1 (t) − vi (t).
Using the same method in 2) one can estimate the parameters
Di2 , μi2 , σi2 of the antagonist system and compute the reconstructive velocity profile of the antagonist system v̂i2 (t).
4) Finally, identify the angular parameters. Suppose that the
individual stroke is acting along a pivot then the angular variation φi (t) is proportional to the pen-tip distance di (t) along the
trajectory, φi ∝ di (tk ),
⎧
0,
k = 1;
⎪
⎪
⎪



⎪
⎪
Di1
ln(t − ti0 ) − μi1
⎪
⎪
√
1 + erf −
⎪
⎨
2
2σi1
di (tk ) =



⎪
D
ln(t
−
ti0 ) − μi2
⎪ i2
⎪
√
−
, k = 2, 3, 4;
1
+
erf
−
⎪
⎪
⎪ 2
2σi2
⎪
⎪
⎩
k = 5.
Di1 − Di2 ,
(17)
Then, θis and θie can be estimated as follows:
θis = φi (t3 ) − Δφi (di (t3 ) − di (t1 ))
θie = φi (t3 ) − Δφi (di (t5 ) − di (t3 ))

(18)

where Δφi = (φi (t4 ) − φi (t2 ))/(di (t4 ) − di (t2 )), erf(t) =
t
√
2
2 0 e−x dx/ π. Hence, the Delta-Lognormal function v̂i (t)
can be calculated by
v̂i (t) = v̂i1 (t) − v̂i2 (t).

.

In solving the aforementioned optimization problem, it is
desirable to set the well initialization so as to avoid the difficulty of local optimum traps. Here, the XZERO algorithm is
incorporated into the coarse parameter identification procedure
for offering the well initialization. In the context of Plamondon’s kinematic theory, a Delta-lognormal model ΔΛ(t) in (3),
is essentially the combination of the agonist system and the

At last, the estimated velocity profiles of ith stroke in X and Y
coordinates can be calculated by
v̂ix (t) = v̂i (t) cos(φi (t))

(19)

v̂iy (t) = v̂i (t) sin(φi (t)).

(20)

At the stage of the fine parameter identification, using the
results of the coarse parameter identification as the initialization
values, all stroke parameters jointly are estimated by solving the

LIU et al.: STROKE PARAMETERS IDENTIFICATION ALGORITHM IN HANDWRITING MOVEMENTS ANALYSIS BY SYNTHESIS

321

Fig. 2. (a) Illustration of the apparatus used in the acquisition of handwriting.
(b) WACOM graphire 4 CTE-440 tablet.

Fig. 1. Comparison of our approach and the heuristic approach. (a) The optimization structures of our approach. (b) The optimization structures of the
heuristic approach [9].

following global optimization problem:
min

f (t)22 ,

where

subject to σi1 , σi2 ≥ 0,


f (t) =

Fig. 3. Velocity profiles of the X and Y coordinates (left), and the trajectory
in X Y coordinate plane (right).

x̂(t) − x(t)
ŷ(t) − y(t)


.

The identifying trajectories can be calculated with the beginning
point P0 = (x0 , y0 ) by
 T
x̂ = x0 +
v̂x (τ )dτ
(21)


0

ŷ = y0 +

The pen-tip trajectories in X and Y coordinates are sampled
at a fixed time interval, so the X and Y velocity sequences can
be calculated by


⎧
 d x(t) 


⎪
⎪
⎨ vx (t) =  dt 
(23)


 d y(t) 
⎪
⎪

⎩ vy (t) = 
 dt  .

T

v̂y (τ )dτ,

(22)

0


N
where v̂x (t) = N
i=1 v̂ix (t), v̂y (t) =
i=1 v̂iy (t). The MATLAB function Isqnonlin can be used to solve the aforementioned
nonlinear optimization problem.
As shown in Fig. 1, compared with the two-step paradigm
used in [9], there are two advantages of using our paradigm.
One is that the use of nonnegative matrix factorization in our
paradigm can effectively avoid the error accumulations in decoupling overlapped stroke data. The other is that the iterations
between the two steps are avoided in our paradigm, which contributes to the computational efficiency.
IV. EXPERIMENTAL RESULTS

B. Extraction Performance Evaluation
Here, signal-to-noise ratio (SNR) of the reconstructed profiles
is used to evaluate the reconstruction quality. That is,
SNRv x y
= 10 log



 te
 te
ts

ts

[v̂x2 (t) + v̂y2 (t)]dt

[(v̂x (t) − vx (t))2 + (v̂y (t) − vy (t))2 ]dt


.

If only the pen-tip velocity profiles are considered, the SNRv t
is given by


 te 2
t s [v̂ (t)]dt
SNRv t = 10 log  t e
.
2
t s [(v̂(t) − v(t)) ]dt

A. Experimental Setup
In our experiments, the handwriting measurement data are
collected with a WACOM Graphire 4 CTE-440 tablet. Fig. 2
illustrates the handwriting data acquisition environment. The
subjects write the fluent script continuously with the tablet pen.
The subjects are required to relax enough and perform the task
rapidly.

C. Experimental Results
In this section, the handwriting measurement data of French
word “elle”(“she” in English) collected by our device, and
“James” from the public database SVC2004 (task 2) are used to
validate our approach. Fig. 3 shows the measured velocity data
of the X and Y coordinates and the pen-tip trajectory of “elle.”

322

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Fig. 5.

Extracted handwriting strokes in pen-tip velocity space.

Fig. 4. (a) The extracted handwriting primitives in X and Y velocity space.
(b) The virtual trajectories of the extracted synergic primitives.

For estimating the number of strokes N , a low-pass filter is
used to eliminate the high-frequency components in the pen-tip
velocity v(t). Generally, it can be described by a convolution
product
 t


h(τ )v(t − τ )dτ.
v (t) =
0

In this paper, the Gaussian function h(t) with (μ, σ 2 ) =
(0, 0.152 ) is exploited as the low-pass filter. Then, the minima of v 
 (t) can be calculated. Finally, the real segmentation
points in original velocity profiles v(t) can be found through
matching the minima by the dynamic time warping technique.
The number of segments is defined as the number of strokes N .
In terms of Plamondon’s kinematic theory, the handwriting
strokes are modeled by the Delta-lognormal function. So, Wi
is initialized by a lognormal function, which is fitted to the
corresponding segmentation of M by XZERO algorithm. ci is
initialized by the random number between [0, 1]. The reconstruction error drops to zero rapidly because the initial values
are close to the real ones.
The decomposed handwriting movement primitives are presented in Figs. 4 and 5, respectively. There are nine synergic
primitives. The ith row in Fig. 4 involves the velocity profiles
and virtual trajectory of the ith handwriting primitive. The profiles in the left column are the velocity profiles in X and Y
coordinates of the extracted handwriting primitives. The figures
in the right column are the virtual pen-tip trajectories of the
primitives, which are generated by the velocity profiles of X
and Y coordinates. Using vix (t) and viy (t), we have the pen-tip
velocity profile vi (t) shown in Fig. 5. Each of them is roughly
straight with a single-peaked, asymmetrical, bell-shape velocity
profile, which is consistent with the definition of handwriting
strokes in Plamondon’s kinematic theory.

Fig. 6. Amplitude modulated parameters {ci } and the onset delay time {τ i }
of the handwriting primitives.

The movement control modulation parameters ci and τi are
the important characteristics of the synergic primitives. In Fig. 6,
the length, width, and the beginning time of the rectangle represents the duration time, the amplitude ci , and the onset delay
time τi of the corresponding primitive, respectively. It means
that after choosing the proper primitives, the central nervous
system just needs to plan their activation time and scaling factors. As can be seen in Fig. 6, the parameters {τi } reveal the superposition relationships between adjacent handwriting strokes.
The estimated parameters of handwriting strokes are shown in
Table I.
Fig. 7 shows the synthesis results reconstructed with the identified parameters. SNRv x y and SNRv are 34.08 and 46.43 dB,
respectively.
Using the proposed approach, the reconstruction results of
specimen U40S2 in the public database SVC2004 task 2 are
presented in Fig. 8. SNRv x y and SNRv are 36.12 and 51.48 dB,
respectively.

LIU et al.: STROKE PARAMETERS IDENTIFICATION ALGORITHM IN HANDWRITING MOVEMENTS ANALYSIS BY SYNTHESIS

323

TABLE I
IDENTIFICATION RESULTS OF STROKE PARAMETERS

Fig. 8. Reconstruction results of specimen U40S2 in SVC2004 (task 2)
database. The SNRv x y of the reconstruction velocity in X and Y coordinates
is 36.12 dB. And the SNRv of the pen-tip reconstruction velocity is 51.48 dB.
(a) The reconstruction velocity in X and Y coordinates. (b) The reconstruction
pen-tip velocity and trajectory results.

verification. But, the stroke parameters can be used as the initial
features of handwriting data.
VI. CONCLUSION

Fig. 7. Reconstruction Results. (a) The reconstruction velocity in X and
Y coordinates. v x (t), v y (t) are the original velocity profiles; v x r (t), v y r (t)
are the reconstruction velocity profiles. The SNRv x y is 34.08 dB. (b) The
reconstruction pen-tip velocity (left). v(t): the original pen-tip velocity profile;
v r (t): the reconstruction pentip velocity profiles. The trajectory reconstruction
result (right). Solid line: the original trajectory; dotted line: the reconstruction
trajectory. The SNRv is 46.43 dB.

V. DISCUSSION
The filter used in data preprocessing affects the model parameters identification results significantly. In this paper, the parameter σ in Gaussian filter affect the estimated number of handwriting strokes. If σ is too small, there are still high-frequency
noises in the handwriting data. If σ is too large, some real
strokes are ignored. For example, with σ = 0.15 and σ = 0.30,
the estimated numbers of handwriting strokes are 20 and 14, respectively. Through the large number of tests of normal people’s
handwriting data, the appropriate Gaussian filtering parameters
are adopted in our paper.
The work in this paper aims at handwriting data modeling,
which still does not reach handwriting recognition or signature

This paper presents a new approach to coarse-to-fine stroke
parameter identification, which aims at avoiding the difficulty
of local optimum traps when seeking stroke parameters jointly
with global optimization. Instead of using the heuristic stroke
decoupling techniques, we explore the use of nonnegative matrix
factorization in the two-step analysis by synthesis framework.
As a result, it can not only avoid the error accumulations in
decoupling overlapped stroke data, but also fully exploit the
entire stroke data in parameter identification rather than partially
decoupled stroke data. With these advantages, the coarse-level
stroke parameter identification with local optimization can offer
the well-shaped initializations for the global optimization in
fine-level stroke parameter identification, which can effectively
alleviate the difficulty of local optimum traps. Moreover, our
paradigm excludes the alternate iteration between the stroke
decoupling step and the coarse-to-fine identification step, which
contributes to the enhancement of computational efficiency. The
experimental results validate these advantages.
APPENDIX
EQUIVALENCE RELATIONSHIP BETWEEN (15) AND (16)
For ∀ τ ≥ 0, we have
T

j =1

wi (tj − τ ) =
2

T


wi (tj )2 .

j =1

Then, Vi (τ ) in (15) can be rewritten as
Vi (τ ) =

T

j =1

[m(tj ) − ci wi (tj − τ )]2 = di − 2ci ri (τ )

324

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

where
di =:

T


[m(tj )2 + c2i wi (tj )2 ],

j =1

ri (τ ) =:

T


mT (tj )wi (tj − τ ).

j =1

Therefore, the estimation of activation time τ̂i can be implemented by peak detection for ri (τ ), that is
τ̂i = arg max
τ ≥0

T


mT (tj )wi (tj − τ ).

j =1

REFERENCES
[1] D. Impedovo, G. Pirlo, and R. Plamondon, “Handwritten signature verification: New advancements and open issues,” in Proc. Int. Conf. Front.
Handwriting Recog., 2012, pp. 367–372.
[2] V. Potkonjac, “Robotic handwriting,” Int. J. Humanoid Robot., vol. 2,
no. 1, pp. 105–124, 2005.
[3] P. Mavrogiorgou, R. Mergl, P. Tigges, J. El Husseini, A. Schröter,
G. Juckel, M. Zaudig, and U. Hegerl, “Kinematic analysis of handwriting
movements in patients with obsessive-compulsive disorder,” J. Neurol.,
Neurosurg. Psychiatry, vol. 70, no. 5, pp. 605–612, 2001.
[4] R. Plamondon and M. Djioua, “A multi-level representation paradigm for
handwriting stroke generation,” Human Movement Sci., vol. 25, no. 5,
pp. 586–607, 2006.
[5] R. Plamondon and W. Guerfali, “The generation of handwriting with
delta-lognormal synergies,” Biol. Cybern., vol. 78, no. 2, pp. 119–132,
1998.
[6] M. Djioua and R. Plamondon, “A new algorithm and system for the
characterization of handwriting strokes with delta-lognormal parameters,”
IEEE Trans. Pattern Anal. Mach. Intell., vol. 31, no. 11, pp. 2060–2072,
Nov. 2009.
[7] W. Guerfali and R. Plamondon, “A new method for the analysis of simple
and complex planar rapid movements,” J. Neurosci. Methods, vol. 82,
no. 1, pp. 35–45, 1998.
[8] R. Plamondon, X. Li, and M. Djioua, “Extraction of delta-lognormal
parameters from handwriting strokes,” Front. Comput. Sci. China, vol. 1,
no. 1, pp. 106–113, 2007.
[9] C. O’Reilly and R. Plamondon, “Development of a sigma-lognormal representation for on-line signatures,” Pattern Recog., vol. 42, pp. 3324–3337,
2009.
[10] C. O’Reilly and R. Plamondon, “A globally optimal estimator for the deltalognormal modeling of fast reaching movements,” IEEE Trans. Syst., Man,
Cybern. B, Cybern., vol. 42, no. 5, pp. 1428–1442, Oct. 2012.
[11] R. Plamondon and R. M. Parizeau, “Signature verification from position,
velocity and acceleration signals: A comparative study,” in Proc. 9th Int.
Conf. Pattern Recog., 1988, vol. 1, pp. 260–265.
[12] P. Morasso and F. A. Mussa Ivaldi, “Trajectory formation and handwriting: A computational model,” Biolog. Cybern., vol. 45, pp. 131–142,
1982.
[13] T. Flash and N. Hogan, “The coordination of arm movements: An experimentally confirmed mathematical model,” J. Neurosci., vol. 5, no. 7,
pp. 1688–1703, 1985.
[14] M. Chhabra and R. A. Jacobs, “Properties of synergies arising from a theory of optimal motor behavior,” Neural Comput., vol. 18, no. 10, pp. 2320–
2342, 2006.
[15] R. S. Kashi, J. Hu, W. L. Nelson, and W. Turin, “On-line handwritten
signature verification using hidden Markov model features,” in Proc. 4th
Int. Conf. Document Anal. Recog., 1997, vol. 1, pp. 253–257.

[16] B. Kar, P. K. Dutta, T. K. Basu, C. V. Hauer, and J. Dittmann,“DTW based
verification scheme of biometric signatures,” in Proc. IEEE Int. Conf. Ind.
Technol., 2006, pp. 381–386.
[17] G. Gangadhar and D. Joseph, “An oscillatory neuromotor model of handwriting generation,” J. Document Anal. Recog., vol. 10, pp. 69–84, 2007.
[18] A. V. Da Silva and D. S. De Freitas, “Wavelet-based compared to functionbased on-line signature verification,” in Proc. 15th Brazilian Symp. Comput. Graph. Image, 2002, pp. 218–225.
[19] D. D. Lee and H. S. Seung, “Learning the parts of objects by non-negative
matrix factorization,” Nature, vol. 401, pp. 788–791, 1999.
[20] A. d’Avella, P. Saltiel, and E. Bizzi, “Combinations of muscle synergies
in the construction of a natural motor behavior,” Nature Neurosci., vol. 6,
no. 3, pp. 300–308, 2003.
[21] M. Liu and G. L. Wang, “Handwriting movement analysis by synthesis
of synergic primitives,” CAAI Trans. Intell. Syst. China, vol. 5, no. 5,
pp. 405–410, 2010.
[22] R. Vinjamuri, M. Sun, C. C. Chang, H. N. Lee, R. J. Sclabassi, and
Z. H. Mao, “Dimensionality reduction in control and coordination of the
human hand,” IEEE Trans. Biomed. Eng., vol. 57, no. 2, pp. 284–295,
Feb. 2010.

Min Liu received the B.S. degree from South China
Normal University, Guangzhou, China, in 2000,
and the M.S. degree from Sun Yat-Sen University,
Guangzhou, in 2006, where she is currently working
toward the Ph.D. degree at the School of Information
Science and Technology.
Her research interest include human movements
data understanding and analysis.

Xuemei Guo received the B.S. degree from Tsinghua
University, Beijing, China, in 1987, and the M.S.
degree from Tianjin University, Tianjin, China, in
1990. She received the M.S. degree in computational
engineering from the Ruhr-University of Bochum,
Bochum, Germany, in 2002.
She is currently an Associate Professor in the
School of Information Science and Technology,
Sun Yat-Sen University, Guangzhou, China. In 1992,
she joined the Department of Mechatronics, Shantou University. Her research interests include motion
control and biomimetic control.

Guoli Wang received the B.S., M.S., and Ph.D.
degrees from Nankai University, Tianjin, China, in
1986, 1989, and 1992, respectively.
In 1992, he joined the Department of Computer
Science, Shantou University, where he was the Department Head from 1996 to 2000. As an Alexander von Humboldt Research Fellow, he was a Guest
Scientist in the Control Engineering Laboratory,
Ruhr-University of Bochum, Germany, from 2000
to 2001, and the Institute for System Theory in Engineering, University of Stuttgart, Germany, in 2003.
He was also a Visiting Research Fellow at the City University of Hong Kong
from 2001 to 2002. He is currently a Full Professor in the School of Information Science and Technology, Sun Yat-Sen University, Guangzhou, China. His
research interests include information processing and biomimetic sensing and
control for human–machine systems.

