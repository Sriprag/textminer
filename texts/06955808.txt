IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

909

Photoplethysmography-Based Algorithm
for Detection of Cardiogenic Output
During Cardiopulmonary Resuscitation
Ralph W. C. G. R. Wijshoff∗ , Antoine M. T. M. van Asten, Wouter H. Peeters, Rick Bezemer,
Gerrit Jan Noordergraaf, Massimo Mischi, Senior Member, IEEE, and Ronald M. Aarts, Fellow, IEEE

Abstract—Detecting return of spontaneous circulation (ROSC)
during cardiopulmonary resuscitation (CPR) is challenging, time
consuming, and requires interrupting chest compressions. Based
on automated-CPR porcine data, we have developed an algorithm
to support ROSC detection, which detects cardiogenic output during chest compressions via a photoplethysmography (PPG) signal.
The algorithm can detect palpable and impalpable spontaneous
pulses. A compression-free PPG signal which estimates the spontaneous pulse waveform, was obtained by subtracting the compression component, modeled by a harmonic series. The fundamental
frequency of this series was the compression rate derived from the
transthoracic impedance signal measured between the defibrillation pads. The amplitudes of the harmonic components were obtained via a least mean-square algorithm. The frequency spectrum
of the compression-free PPG signal was estimated via an autoregressive model, and the relationship between the spectral peaks
was analyzed to identify the pulse rate (PR). Resumed cardiogenic
output could also be detected from a decrease in the baseline of the
PPG signal, presumably caused by a redistribution of blood volume
to the periphery. The algorithm indicated cardiogenic output when
a PR or a redistribution of blood volume was detected. The algorithm indicated cardiogenic output with 94% specificity and 69%
sensitivity compared to the retrospective ROSC detection of nine
clinicians. Results showed that ROSC detection can be supported
by combining the compression-free PPG signal with an indicator
based on the detected PR and redistribution of blood volume.
Index Terms—Autoregressive (AR) model, cardiogenic output, cardiopulmonary resuscitation (CPR), harmonic model, least
mean-square (LMS), photoplethysmography (PPG), pulse rate
(PR), return of spontaneous circulation (ROSC), spectral analysis, spontaneous pulse, transthoracic impedance (TTI).

Manuscript received August 1, 2014; revised October 16, 2014; accepted
November 7, 2014. Date of publication November 13, 2014; date of current
version February 16, 2015. This work was supported by NL Agency, IOP Photonic Devices, IPD083359 HIP Hemodynamics by Interferometric Photonics.
Asterisk indicates corresponding author.
∗ R. W. C. G. R. Wijshoff is with the Department of Electrical Engineering, Eindhoven University of Technology, Eindhoven, The Netherlands, and also with Philips Research, Eindhoven, The Netherlands (e-mail:
ralph.wijshoff@philips.com).
A. M. T. M. van Asten, W. H. Peeters, and R. Bezemer are with Philips
Research, Eindhoven, The Netherlands.
G. J. Noordergraaf is with the Department of Anaesthesiology and Resuscitation and the CPRLab, St. Elisabeth Hospital, Tilburg, The Netherlands.
M. Mischi is with the Department of Electrical Engineering, Eindhoven University of Technology, Eindhoven, The Netherlands.
R. M. Aarts is with the Department of Electrical Engineering, Eindhoven
University of Technology, and also with Philips Research, Eindhoven, The
Netherlands.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2370649

I. INTRODUCTION
IGH-QUALITY cardiopulmonary resuscitation (CPR) requires minimizing interruptions of chest compressions, as
interruptions reduce blood flow and, thus, the chance of achieving return of spontaneous circulation (ROSC) [1]–[5]. International guidelines state that interruptions for ROSC assessment
should last at most 10 s [2], [3]. ROSC is assessed by analyzing
the electrocardiographic rhythm and checking for a palpable
circulatory pulse. In practice, however, pulse checks by manual palpation can take significantly longer than 10 s, especially
when a spontaneous pulse is absent [6], [7]. Furthermore, the interpretation of manual palpation is known to be unreliable, even
when performed by expert clinicians [6], [7]. Therefore, an
objective method to detect presence or absence of a spontaneous pulse, especially during compressions, would be valuable
to support ROSC detection.
Monitoring end-tidal CO2 [8], [9], invasive blood pressure
[10], [11], or central venous oxygen saturation [12] allows for
a more objective assessment of ROSC, also during compressions, but requires a secured airway or placement of catheters.
Transthoracic impedance (TTI) measurements [13]–[15] and
near-infrared spectroscopy (NIRS) [16], [17] are noninvasive
methods, but TTI is strongly influenced by compressions and
NIRS responds slowly upon ROSC. Generally, photoplethysmography (PPG) is an easy to use and noninvasive technique
to continuously measure a spontaneous pulse [18], [19]. Its potential to measure a spontaneous pulse during compressions
has been observed in an automated-CPR animal study [20].
When the complexity of the PPG signal increased during compressions, the invasive blood pressure indicated presence of a
spontaneous pulse. Furthermore, frequency spectra of the PPG
signals showed that the spontaneous pulse rate (PR) and compression rate could be distinguished. Although these methods
can provide valuable support, ROSC detection remains a clinical
situational assessment, because it involves determining whether
a perfusing rhythm is life sustaining.
This paper describes a PPG-based algorithm that detects cardiogenic output during chest compressions to support ROSC
detection, developed based on preclinical data from [20].
Cardiogenic output was detected using the compression-free
PPG signal and the baseline of the PPG signal. The compressionfree PPG signal was obtained by subtracting the compression
component from the PPG signal, to estimate the spontaneous
pulse waveform. We defined a spontaneous pulse in the PPG

H

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

910

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

signal as a (quasi-)periodic feature resulting from cardiac contractions. The spontaneous pulse can be palpable or impalpable.
The compression component subtracted from the PPG signal
was determined via a harmonic series. The fundamental frequency of this series was the compression rate derived from the
TTI signal. The TTI signal had been measured between the defibrillation pads, as is common in defibrillators. The frequency
spectrum of the compression-free PPG signal was analyzed to
detect the PR. When cardiogenic output resumed, the baseline
of the PPG signal decreased, presumably caused by a redistribution of blood volume to the periphery. The algorithm indicated
cardiogenic output when a PR or a decrease in the baseline of
the PPG signal was detected.
II. METHODS
A. Experimental Measurements
An automated-CPR study was conducted on 16 pigs [20].
All animals received care compliant with the Dutch Animal
Experimentation Law and the Standard Operation Procedures of
the Central Animal Laboratory of the Radboud University Nijmegen Medical Center, where the experiments were conducted.
The Radboud University Animal Ethical Committee approved
the protocol. The experiments, protocol, and physiological data
are described in detail in [20].
After a 10-min baseline recording, cardiac arrest was induced
via an electrical shock, followed by 20 min of CPR in a rhythm
of 30 compressions alternated by two ventilations (30:2 rhythm).
Chest compressions were delivered by an automated CPR device
at a rate of 100 min−1 . After 20 min of CPR, 2-min cycles were
initiated to achieve ROSC, each starting with defibrillation if
appropriate, followed by 30:2 CPR. If ROSC was achieved after
one of the cycles, CPR stopped and measurements continued
for 20-min post-ROSC. Otherwise the experiment ended after
the fourth cycle. Animals were euthanized at the end of the
experiment.
All animals were monitored by electrocardiography (ECG),
capnography, and pulse oximetry, and by measuring arterial
blood pressure (ABP) in the aortic arch, and carotid artery
blood flow. Near-infrared (900 nm) PPG signals [Volt] were
obtained using a forehead reflectance pulse oximetry probe
(Nellcor Oxisensor II RS-10, Covidien-Nellcor, Dublin, Ireland), controlled by a custom-built photoplethysmograph. The
probe was customized to enable placement by suturing between
the nostrils, because this site is relatively stable in terms of
motion, and allows for tight fixation of the probe to the skin.
TTI [Ohm] between Adult Plus Multifunction Electrode Pads
M3713A (Philips, Andover, MA, USA) was recorded via the
HeartStart MRx Monitor/Defibrillator (Philips, Andover, MA,
USA).
PPG and ABP waveforms were recorded simultaneously using a 16-bit digital data acquisition card (DAQ) (NI USB-6259,
National Instruments, Austin, TX, USA). The DAQ was controlled by dedicated software implemented in LabVIEW (National Instruments, Austin, TX, USA).
All waveforms were sampled at fs = 250 Hz. The TTI signal
was synchronized to the PPG signal by resampling and translating the TTI signal such that correlation was maximal between

the fundamental compression frequency components in the TTI
and ABP signals. Resampling was done at rates between 249.91
and 250.09 Hz in steps of 0.01 Hz.
B. Overview of the Algorithm
Fig. 1 outlines the algorithm that indicated cardiogenic output during CPR. The algorithm contained three modules: one
for removal of the compression component and PR detection
(purple and green blocks in Fig. 1, Sections II-C–II-F), one for
analysis of the PPG signal baseline (yellow blocks in Fig. 1,
Section II-G), and one for the indicator of cardiogenic output
(blue blocks in Fig. 1, Sections II-H and II-I).
The primary input of the algorithm was the raw PPG signal
ppg[n], with sample index n. A band-pass filtered PPG signal
ppgac [n] was obtained via a first-order Butterworth low-pass
filter with a 12 Hz cutoff and a fourth-order Butterworth highpass filter with an 0.3 Hz cutoff. By using the compression
rate derived from the auxiliary TTI signal Z[n] (see Section IIC), the compression component was removed from ppgac [n] to
obtain the compression-free PPG signal ppgcf [n] (see Section
II-D). The frequency spectrum of ppgcf [n] was determined via
an autoregressive (AR) model (see Section II-E). The PR was
identified in the spectrum, if it contained a signal with sufficient high-frequency content (see Section II-F). In parallel, the
baseline of the PPG signal ppgbl d [n] was obtained by low-pass
filtering at 0.5 Hz. A presumable redistribution of blood volume
to the periphery could be detected from a decrease in ppgbl d [n]
(see Section II-G). The algorithm indicated cardiogenic output when a PR or a decrease in the baseline was detected (see
Sections II-H and II-I). In this study, we have not extensively
optimized the algorithm parameter values, because of the small
preclinical dataset.
C. Determination of Compression Characteristics
The instantaneous compression frequency and phase were determined from the TTI signal, for which it has been used before
[21], [22]. To extract the fundamental compression frequency
component, the TTI signal Z[n] was band-limited by a fourthorder Butterworth filter with a pass-band between 1 and 3 Hz.
This accommodates the range of manual chest compression frequencies between about 60 and 180 min−1 observed in clinical
practice [21]–[23].
The band-limited TTI signal, indicated by Zf [n], had a
sinusoidal-like shape, with local minima occurring at the end
of a compression. Compressions were detected by finding consecutive sequences of a local maximum (nl , Zf m ax l ), a local
minimum (nc , Zf m in c ), and a local maximum (nr , Zf m ax r ).
The local extremes were found from the zero crossings in the
time derivative of Zf [n]. It was required that Zf m ax l,r ≥ 0 and
Zf m in c < 0. To avoid detecting ventilations, motion artifacts,
or noise, a sequence of three local extremes had to meet four
criteria to be associated with a compression:
1) The amplitude was within a specified range:
Zlb ≤

Zf m ax l + Zf m ax r
− Zf m in c ≤ Zu b ,
2

with limits Zlb = 0.2 Ω and Zu b = 10 Ω [15].

(1)

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

911

Fig. 1. Overview of the PPG-based algorithm that indicated cardiogenic output during CPR. A compression-free IR PPG signal, ppgc f [n], containing an estimate
of the spontaneous pulse waveform, was obtained by removing the compression component. The compression removal stage used the compression rate determined
from the auxiliary TTI signal Z [n]. The frequency spectrum of ppgc f [n] was estimated via an AR model. The PR was determined in this spectrum, if it contained a
signal with sufficient high-frequency content. A presumable redistribution of blood volume to the periphery was detected from a decrease in the baseline of the IR
PPG signal ppgb l d [n]. Cardiogenic output was indicated if a PR or a decrease in baseline was detected. AR: autoregressive; CPR: cardiopulmonary resuscitation;
IR: infrared; PPG: photoplethysmography; PR: pulse rate; TTI: transthoracic impedance.

2) The distance nr − nl was within a specified range:
nlb ≤ nr − nl ≤ nu b ,

Second, the onset no,i of compression i was determined as
(2)

with initially nlb = nlb0 = 0.3 s · fs and nu b = nu b0 =
1 s · fs to allow for compression rates of 60–200 min−1 .
After detection of at least ND compressions, the
bounds changed to nlb,i = (1 − kD )nD ,i and nu b,i =
(1 + kD )nD ,i , with 0 < kD < 1 setting the allowed devi
ation from nD ,i = ND−1 ii  =i−N D +1 (nr,i  − nl,i  ), with
i indicating the most recently detected compression. If
nlb,i or nu b,i became incompliant with compression rates
of 60–200 min−1 , or if ND sequential sequences failed
this criterion, the bounds were reset to nlb0 and nu b0 .
3) The sequence was sufficiently symmetric in time:
1
nc − nl
≤
≤ kT ,
kT
nr − nc

(3)

where parameter kT > 1 set the allowed asymmetry.
4) The sequence was sufficiently symmetric in amplitude:
−Zf m in c
1
≤ kA ,
≤
kA
(Zf m ax l + Zf m ax r )/2

(4)

where parameter kA > 1 set the allowed asymmetry. This
criterion was only met if Zf m ax l + Zf m ax r > 0.
After identifying the individual compressions, first the instantaneous chest compression frequency fcc,i associated with
compression i was determined from the distance between two
consecutive local minima. If they were at most 1 s apart,
fcc,i =

nc,i

fs
.
− nc,i−1

(5)

If a local minimum was not preceded by another local minimum
within 1 s, a new sequence of chest compressions was assumed
to have started. In that case, the compression frequency associated with the second compression of the sequence was also
associated with the first compression of the sequence. This implies an inherent delay in the algorithm of at least two compressions. Compressions more than 1 s apart from both neighboring
compressions were ignored.

no,i = nc,i −

fs
.
fcc,i

(6)

Third, by starting at the onset of compression i, the compression phase φcc [n] [rad] was determined as
φcc [n] = φcc [n − 1] + 2π

fcc,i
,
fs

no,i ≤ n < no,i+1 .

(7)

Compression phase φcc [n] was initialized at 0 rad, and was reset
to 0 rad, when a new compression sequence started.
Fourth, a smooth envelope function A[n] [-] was constructed,
indicating presence of compressions. A[n] equaled 1 during a
compression that was not the first of a sequence. For the first
compression of a sequence, A[n] smoothly increased from 0 to
1 in No,i = round (fs /(4fcc,i )) samples via



1
n − no,i
, no,i ≤ n ≤ no,i + No,i , (8)
1 − cos π
2
No,i
after which A[n] equaled 1 during the remaining compression
period. After the last compression of a sequence, A[n] smoothly
decreased from 1 to 0 in No,i samples via



1
n − nc,i
, nc,i ≤ n ≤ nc,i + No,i . (9)
1 + cos π
2
No,i
Otherwise A[n] equaled 0.
Based on the measured TTI signals, ND = 5, kD = 0.35, and
kT = kA = 3 were used for all animals.
D. Removal of the Compression Component
To estimate the spontaneous pulse waveform, that can support the clinician in detecting ROSC, a harmonic series was
employed to model and remove the chest compression component in the PPG signal. A harmonic series has been employed
successfully before to model and remove the chest compression
component in the ECG signal [21], [23], [24].
The primary input of the compression removal stage was the
band-pass filtered PPG signal ppgac [n], that we assumed to be
a sum of a spontaneous pulse component sp[n], a compression

912

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

E. Spectrum Estimation

component cmp[n], and remaining components r[n] [20]:
ppgac [n] = sp[n] + cmp[n] + r[n].

(10)

Here, r[n] contains noise and possibly frequency components
resulting from interaction between spontaneous cardiac activity and compressions [20]. Interaction frequencies were observed at the sum and the difference of the compression rate
and the PR and their harmonics [20]. A compression-free PPG
signal ppgcf [n], containing an estimate of the spontaneous pulse
component, was obtained by subtracting the estimate of the compression component, cmpest [n]:
ppgcf [n] = ppgac [n] − cmpest [n].

(11)

The estimate cmpest [n] was modeled by a harmonic series of
K in-phase and quadrature terms with fundamental frequency
fcc,i determined from the TTI signal [23], [24]:
cmpest [n] = A[n]

K


[ak [n] cos (kφcc [n])

k =1

+bk [n] sin (kφcc [n])] ,

(12)

with envelope function A[n] (see Section II-C), compression
phase φcc [n] (7), and ak [n] and bk [n] [Volt] the amplitudes of
the in-phase and quadrature terms of the kth harmonic, respectively. A[n] quickly forced cmpest [n] to 0 during interruptions
of compressions, so that input ppgac [n] stayed unaffected in
these interruptions. Amplitudes ak [n] and bk [n] were estimated
via a least mean-square (LMS) algorithm [24]–[26]:
ak [n + 1] = ak [n] + 2μA[n]ppgcf [n] cos (kφcc [n]) , (13)
bk [n + 1] = bk [n] + 2μA[n]ppgcf [n] sin (kφcc [n]) , (14)
for k = 1, . . . , K, and with step-size parameter μ.
The transfer function of the LMS filter between ppgac [n]
and ppgcf [n] can be approximated by a cascade of K notch
filters having the notch centered at kfcc , k = 1, . . . , K, when the
estimate of the compression frequency is stable at fcc , A[n] = 1,
and the step-size parameter μ < 1 [25], [26]:


K
z 2 − 2z cos 2π kffsc c + 1



. (15)
H(z) ≈
k fc c
2
+ (1 − 2μ)
k =1 z − 2(1 − μ)z cos 2π f s
Each notch has a 3-dB bandwidth W [Hz] of about [24], [25]
μfs
.
(16)
π
Furthermore, μ determined the convergence time Tcv [s] to a
fraction 0 < v < 1 of the targeted values for ak and bk via
W ≈

Tcv =

1 ln(1 − v)
.
fs ln(1 − μ)

(17)

We used K = 9 to remove all compression harmonics from
ppgac [n] which remained in the frequency band that was to be
analyzed for PR detection. High harmonics could result from
probe motion relative to the skin. To limit the removal of PRs
to ranges of about 95–105 min−1 and 195–205 min−1 , we set
μ = 0.002, resulting in W ≈ 10 min−1 , and Tc0.95 ≈ 6 s.

1) AR Model: Frequency spectra of the compression-free
PPG signal ppgcf [n] were determined over time via AR models.
Because ppgcf [n] was nonstationary, spectra could only be estimated from short time windows. AR models provide a better
frequency resolution on short time windows compared to the
Fast Fourier Transform [27]–[29].
Prior to determining the AR models, ppgcf [n] was downsampled to fs d = 31.25 Hz. Downsampling increases the phase angle of the poles in the data, resulting in more reliable estimation
of the AR coefficients [30]. Downsampling was done in three
consecutive steps to avoid numerical issues. First, a third-order
Butterworth low-pass filter with a 12 Hz cutoff was applied,
followed by downsampling to 125 Hz. Second, a sixth-order
Butterworth low-pass filter with a 12 Hz cutoff was applied,
followed by downsampling to 62.5 Hz. Third, a sixth-order
Butterworth low-pass filter with a 12 Hz cutoff was applied,
followed by downsampling to fs d = 31.25 Hz.
The AR models were then estimated from the downsampled
compression-free PPG signal ppgcf d [n] [27]:
ppgcf d [n] = −

P


αp ppgcf d [n − p] + e[n],

(18)

p=1

with AR coefficients αp , model order P , and prediction error
e[n]. If P is sufficiently large, all correlations in the data are
described by the linear prediction in (18) and the prediction
error e[n] is white noise [27]. For each AR model, the power
spectral density (PSD) is obtained as a continuous function of
frequency f [27]:
σe2 /fs d
PAR (f ) = 	
	2 ,
P
	
	
	1 + p=1 αp exp (−j2πpf /fs d )	

(19)

with prediction error power σe2 . The AR coefficients αp were
obtained from time windows of Tw = 5 s using the forward–
backward approach [27]. The AR coefficients were computed
once per second by translating these windows by 1 s. PAR (f )
was evaluated on a 1 min−1 resolution.
2) Model Order: The AR model order P should be sufficient to capture the strongest frequency components present in
ppgcf d [n]. P was determined empirically using the prediction
error. As a function of model order, the prediction error power
was determined relative to the total signal power in the window
from which the AR model was estimated. P was selected as the
smallest order with the mean plus two standard deviations of
the relative prediction error power at most 5%.
Model orders between 2 and 50 with increments of two were
considered. AR models were estimated from Tw = 5 s sliding
windows, with 4-s overlap. For all animals with ROSC, AR
models were estimated in the 2-min cycle between successful
defibrillation and the end of CPR. Therefore, for each model
order the relative prediction error power was determined for 115
AR models. In [31], Ulrych and Ooe suggest that satisfactory
results are often obtained if the model order does not exceed 1/3
to 1/2 of the available data points. This criterion was met by

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

913

considering model orders of at most 50 for Tw = 5 s windows
at a sampling rate of fs d = 31.25 Hz.
F. Spectral Analysis
If a signal with sufficient high-frequency content was detected
in ppgcf d [n] (see Section II-F1), an iterative algorithm identified the PR among the peaks in PAR (f ) (see Section II-F2). The
PR detection was evaluated via the ABP (see Section II-F3).
1) Signal Presence: To detect presence of a potential spontaneous pulse in compression-free PPG signal ppgcf d [n], we
defined two criteria. One criterion required the prediction error
power Pe [n] to be smaller than a fraction RP  1 of the total
signal power Ps [n]. The other criterion required the power of the
low frequencies to be smaller than a fraction RD < 1 of the total
signal power. Both criteria were evaluated in each window from
which the AR model in (18) had been determined. Specifically,
we considered a signal present if

and if

Pe [n]
< RP ,
Ps [n]

(20)


PA R (f  )

 0≤f < f l
< RD ,

0≤f  ≤f s d /2 PA R (f )

(21)

with fl = 40 min−1 the lower PR limit, below the bradycardia
limit at 50 min−1 [2], and considered a minimum rate predictive
of a potential ROSC [9]. If (20) or (21) did not hold, no signal
was considered present. If both held, the peaks in PAR (f ) were
analyzed to identify the PR.
In (20), the prediction error power was computed as
1
Pe [n] =
Nw − P

n


2

e [i],

(22)

ppg2cf d [i],

(23)

i=n −N w +1+P

Fig. 2. Flowchart of the iterative algorithm that identified the PR among the
peaks in PSD P A R (f ), by searching for one harmonic frequency fh rm , one
sum interaction frequency fsu m , and one difference interaction frequency fd iﬀ .
Sets of frequencies are shown between curly brackets. Frequency is in min−1 .
CC: chest compressions; PR: pulse rate; PSD: power spectral density.

and the total signal power was computed as
Ps [n] =

1
Nw − P

n

i=n −N w +1+P

with AR model order P and window length Nw = Tw · fs d 	.
The first P samples were omitted, as there is no prediction.
If (20) held, ppgcf d [n] contained periodic components. In
that case, correlations in the signal resulted in a large contribution of the linear prediction in (18) to ppgcf d [n], causing the
prediction error power to be much smaller than the total signal
power. If periodic components were absent, ppgcf d [n] mainly
contained noise, resulting in a smaller contribution of the linear
prediction to ppgcf d [n], and a larger ratio between prediction
error power and total signal power.
Low-frequency oscillations could cause (20) to hold, whereas
ppgcf d [n] contained no frequencies potentially corresponding
to a PR. Such low-frequency oscillations occurred during compressions or interruptions of compressions. Therefore, (21) required a limited contribution of low frequencies to the signal
power, to ascertain that ppgcf d [n] contained frequencies potentially corresponding to a PR. Equation (21) was only considered,

if the TTI signal contained compressions in the window from
which the AR model had been estimated.
RP = 0.05 was used, because the AR model order P was
selected such that the mean plus two standard deviations of the
relative prediction error power was at most 5%. The spectral
distribution observed in the PSDs determined RD = 0.5.
2) PR Detection: To identify the PR, the relationship was
determined between the frequencies of the peaks in PAR (f ).
All spectral peaks were found by using the zero crossings from
positive to negative in the derivative of PAR (f ). From all peaks
found, a set of Npks peaks {fpks } was formed, where all frequencies were at least 18 min−1 , and deviated more than 5 min−1
from all compression rates fcc,i and harmonics 2 · fcc,i found
in the window from which PAR (f ) was estimated.
Fig. 2 outlines the iterative algorithm that determined the relationship between the frequencies in {fpks } to identify the PR.
The frequency corresponding to the largest peak in PAR (f ) was
not necessarily the PR, as measurements showed that the largest
peak during compressions could correspond to an interaction
frequency equal to the sum or the difference of the compression

914

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

rate and the PR. Therefore, the iterative algorithm determined
the presence of interaction frequencies to identify the PR among
the peaks.
The frequencies in {fpks } were analyzed by iteratively creating subsets {fi } corresponding to the Ni largest peaks in
the PSD. Ni was initialized at three and incremented by one
until the PR had been identified or all Npks frequencies had
been analyzed. In each iteration, a set of PR candidates {fcnd }
was derived from {fi } by selecting the frequencies between
40 min−1 [9] and 250 min−1 [32]. For each PR candidate, three
related frequencies were searched for in {fi } and collected in
the set {fcnd,rel }: the harmonic fhrm = 2 · fcn d , the sum interaction frequency fsum = fcnd + fcca , and the difference interaction frequency fdiﬀ = |fcnd − fcca |. Interaction frequencies
were considered only if the TTI signal contained compressions
in the window from which PAR (f ) had been determined. Compression rate fcca was the average of the rates fcc,i detected
in this window. Frequencies were considered related if deviating at most Δf from the expected value. To identify the PR, a
score was assigned to each candidate with related frequencies,
by summing the corresponding peak values:

PAR (f  ).
(24)
Score(fcnd ) =
f  ∈{f c n d ,{f c n d , r e l }}

PR candidates without related frequencies had score zero. The
scoring mechanism is related to Hinich’s harmogram, where
harmonics are added to detect a frequency [33]. PR candidates with a score equal to the strictly positive maximum of all
scores were collected in the set {fm ax }. If there was one maximum with frequency fm ax , iterations stopped and a tentative
identification PRt [n] was obtained. If fm ax had no associated
harmonic fhrm , but did have associated interaction frequencies fsum and fdiﬀ , with PAR (fdiﬀ )/PAR (fm ax ) > k1 > 1 and
PAR (fdiﬀ )/PAR (fsum ) > k2 > k1 , with fdiﬀ in {fcnd }, then
PRt [n] = fdiﬀ . That is, based on the decreasing spectral amplitudes, fdiﬀ was considered the PR, and both fm ax and fsum
were considered sum interaction frequencies. However, if one
of these conditions was not met, PRt [n] = fm ax . Next, if the
difference between the current and previous tentative identifications was at most Δf , the final identification was PR[n] =
PRt [n]. Otherwise, PR[n] could not be identified. If there was
not one strictly positive maximum score, {fm ax } was either
empty, occurring when there were no related frequencies, or
{fm ax } contained multiple frequencies, occurring, e.g., when
{fi } only contained the PR and one interaction frequency. In
this case, the next iteration was performed. If {fm ax } contained
multiple frequencies when all Npks peaks had been analyzed,
it was determined whether {fm ax } contained one frequency f 
with minimum deviation  = |PRt [n − 1] − f  |, with  ≤ Δf .
If so, PR[n] = PRt [n] = f  , otherwise PR[n] and PRt [n] could
not be identified.
Parameters k1 = 3 and k2 = 10 were determined from the
amplitude ratio observed between the associated peaks in the
PSDs. Parameter Δf = 15 min−1 was determined from the frequency deviations observed in the PSDs.
3) Evaluation: The PR detection was evaluated in the 2-min
cycle before the post-ROSC phase. Detection was considered

correct if a PR was observed in the ABP, and if the detected PR
was within 15 min−1 of the PR observed in the ABP spectrogram, and in the ABP signal during ventilations. The evaluation
shows whether the detected PR can qualify the cardiac condition, but does not give the quantitative accuracy of the detected
PR. From ABP signals identically high-pass filtered as PPG signals (see Section II-B) spectrograms were obtained using 10-s
windows, translated by 1 s, and zero padded to 60 s.
G. Detection of Blood Volume Redistribution to the Periphery
When PR and compression rate coincide, the compression
removal stage removes the spontaneous pulse, making the
compression-free PPG signal unusable. However, when cardiogenic output resumed, a transient change in skin color could
be observed, presumably caused by a redistribution of blood
volume to the periphery and leading to a sudden decrease in
the baseline of the PPG signal. We used the sudden decrease in
baseline as an extra parameter to detect cardiogenic output, to
accommodate for coinciding PR and compression rate.
The baseline of the PPG signal ppgbl d [n] was obtained by
a cascade of three first-order Butterworth low-pass filters with
an 0.5 Hz cutoff applied to the raw PPG signal ppg[n]. Each
filtering operation was followed by downsampling by a factor
of two. Therefore, ppgbl d [n] was sampled at fs d = 31.25 Hz.
To detect a sudden decrease in ppgbl d [n], a least squares
regression line ρn was fitted in a window of Nbl (odd) samples:


ρn [n − m] = βn

Nbl − 1
−m
2



+ γn , m = 0, . . . , Nbl − 1.

(25)

A sudden decrease in ppgbl d [n] was detected if the normalized
rate of change
Δbl [n] = βn (Nbl − 1)/γn < ΔBL ,

(26)

with threshold ΔBL < 0 [(Nbl samples)−1 ]. Equation (26) was
evaluated once per second. Nbl and ΔBL were determined by
inspecting the decrease in baseline for the animals with ROSC.
H. Indicator of Cardiogenic Output
To support ROSC assessment, the algorithm determined the
state of an indicator of cardiogenic output, SICO :
1) SICO = 0: No PR and no decrease in ppgbl d [n] were
detected, i.e., “no detection” (red) in Fig. 1.
2) SICO = 1: A decrease in ppgbl d [n] was detected, i.e.,
“Redistribution of blood volume to the periphery detected” (yellow) in Fig. 1.
3) SICO = 2: A PR was detected in PAR (f ), i.e., “PR detected” (green) in Fig. 1.
4) SICO = 3: A PR and a decrease in ppgbl d [n] were detected, i.e., states 1 and 2 held simultaneously (yellow and
green in Fig. 1).
The state of indicator SICO was determined once per second.

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

915

I. Validation of the Indicator
To validate whether the indicator can support ROSC assessment, the indicator SICO was compared to the retrospective
ROSC assessment of nine clinicians, who worked in the emergency department, operating room, intensive care unit or quick
response team of the St. Elisabeth Hospital in Tilburg, The
Netherlands. The clinicians were requested to assess at what
time instant ROSC occurred in each experiment, so they would
stop CPR. For this assessment, we provided the ECG, ABP,
capnography, and carotid artery blood flow signals, as recorded
over the entire experiment. We indicated upfront that the animals achieved ROSC. A ROSC annotation trace, indicating
the number of clinicians having detected ROSC over time, was
constructed from the provided time instants.
We used five parameters to quantify the performance of the
indicator SICO . In the 2-min cycle before the post-ROSC phase,
the time difference ΔT = TI − TC [s] was determined. We
defined TI as the time instant after which SICO contained no
further episodes of SICO = 0 which lasted 5 s or longer. We
interpreted TI as the start of consistent detection of cardiogenic
output by SICO . We defined TC as the median of the time
instants at which the clinicians detected ROSC, to exclude early
and late detections. Specificity and sensitivity were determined
for SICO and the PR detection. Comparing the specificities and
sensitivities shows the contribution of detecting decreases in
ppgbl d [n] to SICO . The specificity SpICO was defined as the
percentage of correct cardiac arrest detections by SICO = 0 in
the 20-min CPR period. The specificity SpPR was defined as the
percentage of non-identified PRs in this period. The sensitivity
SeICO was defined as the percentage of correct detections of
cardiogenic output by SICO = 0 between TC and the start of
the post-ROSC phase. The sensitivity SePR was defined as the
percentage of identified PRs in this period.
III. RESULTS
For consistency, the animal numbering from [20] has been
adopted. Animals N1–N3 had no sustained ROSC. Animals
R1–R9 had sustained ROSC. Animal N1 briefly had ROSC, but
deteriorated to cardiac arrest again. For unambiguous annotation, the brief post-ROSC phase and the preceding 2-min cycle
have been excluded from the data of animal N1.
To develop the algorithm, we used data from ten out of 16 animals. As in [20], four animals were excluded because the pulse
oximeter probe interfered with the study PPG probe. This was
resolved by increasing the distance between the probes. Further,
animals R5 and R9 were excluded, because the snout was poorly
perfused due to complications with the carotid arteries, and no
TTI signal was recorded, respectively.
A. Determination of Compression Characteristics
Fig. 3 illustrates filtering of the measured TTI signal Z[n] [see
Fig. 3(a)] to obtain the fundamental compression component in
Zf [n] [see Fig. 3(b)]. Local extremes are detected in Zf [n] (blue
circles) to identify the onsets of individual compressions (red
squares). Ventilation effects are partly suppressed in Zf [n].

Fig. 3. (a) Measured TTI signal Z [n]. (b) Filtered TTI signal Z f [n] showing
the fundamental compression component. Via the local extremes (blue circles)
in Z f [n], the onsets of the individual compressions (red squares) are found.
CC: chest compressions; TTI: transthoracic impedance; V: ventilations.

The compression rate fcc,i and phase φcc [n] [(5) and (7)],
and the envelope function A[n] were determined from the onsets.
Compression rate fcc,i was found accurately, fluctuating slightly
around 100 min−1 (see Table I). Only for animal N3 fluctuations
were larger, due to a lower quality TTI signal.
B. Removal of the Compression Component
Fig. 4 illustrates removal of the compression component by
a representative example. The defibrillation shock (dashed line)
ends cardiac arrest, after which a spontaneous pulse appears.
During arrest, the PPG signal ppgac [n] in Fig. 4(a) shows the
30:2 CPR rhythm. When a spontaneous pulse appears, the complexity of ppgac [n] increases during compressions. During arrest, the compression estimate cmpest [n] in Fig. 4(b) is almost
identical to the compressions in ppgac [n]. When a spontaneous
pulse appears, cmpest [n] changes shape. This is due to the
harmonic of the PR at about 300 min−1 , which is close to a harmonic of the compression rate. Fig. 4(c) shows the compressionfree PPG signal ppgcf [n] obtained by subtracting cmpest [n]
from ppgac [n]. The compression component is strongly reduced
in ppgcf [n], although a decaying residual is present in ppgcf [n]
at the start of a new compression sequence. During ventilations,
the envelope function A[n] forces cmpest [n] to zero, leaving
ppgac [n] unaffected in ppgcf [n]. During arrest, ppgcf [n] shows
absence of a spontaneous pulse. During the first compression sequence after the shock, a spontaneous pulse appears in ppgcf [n].
During compressions, the difference interaction frequency between the PR and the compression rate causes a low-frequency
oscillation in ppgcf [n], which disappears when compressions
stop.
The spectrograms in Fig. 5 illustrate the effective removal
of the compressions. The PPG signal ppgac [n] [see Fig. 5(a)]
contains components at the compression rate and its harmonics
during CPR, and components at the PR and its harmonics after
successful defibrillation. The compression estimate cmpest [n]
[see Fig. 5(b)] mainly contains the compression frequency components, but can also contain frequency components related to
the spontaneous pulse when these are close to the compression components (shortly after 33:00). The components at the
compression rate and its harmonics are strongly reduced in
the compression-free PPG signal ppgcf [n] [see Fig. 5(c)]. The

916

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

TABLE I
EVALUATION OF THE COMPRESSION RATE DETECTION, THE PR DETECTION, AND THE INDICATOR OF CARDIOGENIC OUTPUT
#

f c c , i [1/min]

PR

Δ T [s]

SpPR

SpICO

SePR

SeICO

N1
N2
N3
R1
R2
R3
R4
R6
R7
R8

100.0 ± 1.2
99.7 ± 1.2
100.0 ± 4.0
100.0 ± 0.9
99.8 ± 0.6
99.8 ± 0.6
99.9 ± 1.2
99.8 ± 1.3
100.0 ± 0.6
99.9 ± 1.4

n.a.
n.a.
n.a.
77%
85%
56%
82%
86%
98%
91%

n.a.
n.a.
n.a.
(49/64)
(66/78)
(9/16)
(40/49)
(65/76)
(100/102)
(40/44)

n.a.
n.a.
n.a.
25
46
96
69
69
-16
3

100%
100%
95%
92%
91%
97%
97%
90%
97%
99%

(1669/1669)
(1821/1825)
(1685/1766)
(1125/1226)
(1056/1161)
(1271/1311)
(1117/1151)
(1080/1206)
(1169/1207)
(1196/1214)

100%
99%
95%
88%
87%
96%
94%
89%
95%
90%

(1664/1669)
(1815/1825)
(1676/1766)
(1081/1226)
(1006/1161)
(1254/1311)
(1083/1151)
(1078/1206)
(1150/1207)
(1098/1214)

n.a.
n.a.
n.a.
70%
74%
14%
52%
64%
96%
75%

n.a.
n.a.
n.a.
(55/79)
(74/100)
(14/101)
(49/94)
(63/98)
(89/93)
(44/59)

n.a.
n.a.
n.a.
72%
77%
22%
76%
64%
96%
83%

n.a.
n.a.
n.a.
(57/79)
(77/100)
(22/101)
(71/94)
(63/98)
(89/93)
(49/59)

Mean

99.9 ± 1.7

86%

(369/429)

42 ± 40

96%

(13189/13736)

94%

(12905/13736)

62%

(388/624)

69%

(428/624)

No ROSC: N1-3. ROSC: R1-4, R6-8. f c c , i , mean Δ T in mean ± standard deviation. Correct detections over occurrences in parentheses. f c c , i : compression rate;
Δ T = T I − T C , T I , C : detection moment of ICO (I) and clinicians (C); SpPR: specificity PR detection; SpICO: specificity ICO; SePR: sensitivity PR detection;
SeICO: sensitivity ICO; PR: pulse rate; ICO: indicator of cardiogenic output; n.a.: not applicable; ROSC: return of spontaneous circulation.

Fig. 4. (a) PPG signal ppga c [n]. (b) Compression estimate cmpe s t [n]. (c) Compression-free PPG signal ppgc f [n], obtained by subtracting cmpe s t [n]
from ppga c [n]. Before the defibrillation shock (dashed line), a spontaneous pulse is absent in ppgc f [n]. During the first compression sequence after the
shock, a spontaneous pulse appears in ppgc f [n]. This episode is part of the spectrograms in Fig. 5. CC: chest compressions; PPG: photoplethysmography;
V: ventilations.

interaction frequencies, however, remain present in ppgcf [n].
The spectra of ppgac [n] and ppgcf [n] contain interaction frequencies between the defibrillation shock and 32:30.
C. AR Model Order P
Fig. 6 shows the mean plus two standard deviations of the
relative prediction error power as a function of AR model order
P , which is at most 5% by selecting P = 18.
D. Spectral Analysis
Fig. 7 illustrates the spectral analysis. The PR detection algorithm (see Fig. 2) analyzes the peaks in the PSD PAR (f ) [see
(19), Fig. 7(a)] to identify the PR, if a signal has been detected
in the compression-free PPG signal ppgcf d [n] [(20), SIG in
Fig. 7(b)], with sufficient high-frequency content [(21), FD in
Fig. 7(b)]. The SIG and FD conditions prevent analyzing most
PSDs before the defibrillation shock (dashed line), when the

animal is in cardiac arrest. When a PR has been identified
[black dots in Fig. 7(c)], typically 3–4 peaks have been analyzed [purple dots in Fig. 7(c)] out of all peaks [blue circles in
Fig. 7(c)]. During cardiac arrest, false PR detections occurred
due to peaks deviating more than 5 min−1 from the compression
rate or its second harmonic, as illustrated in Fig. 7(c). When the
heart resumed cardiogenic output, 86% of the detected PRs was
within 15 min−1 of the PRs observed in the ABP and, therefore,
considered correct (PR in Table I). Comparing Fig. 7(c) to the
ABP spectrogram in Fig. 7(d) shows 11 incorrect detections after
the shock. Incorrect detections of the PR harmonic or a residual
compression component at about 200 min−1 occur from 31:37
to 31:39, from 32:04 to 32:08, and at 32:16. Two more incorrect
detections occur at 32:44 and 32:45. The remaining detected
PRs can be recognized as PR in the ABP spectrogram, and are
therefore considered correct. Between 32:09 and 32:23 no PR is
detected, except for one false detection, when no relationships
are found between the peaks.

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

917

Fig. 5. Spectrograms of: (a) the PPG signal ppga c [n], (b) the compression estimate cmpe s t [n], and (c) the compression-free PPG signal ppgc f [n]. The
spectrograms show effective removal of the components at the compression rate and its harmonics in ppgc f [n], achieved by subtracting cmpe s t [n] from ppga c [n].
After the defibrillation shock (first dashed line), a spontaneous pulse appears, which continues when CPR stops (second dashed line). The spectrograms have
been obtained from 10-s windows, translated by 1 s, and zero padded to 60 s. They contain the episode of Fig. 4. CPR: cardiopulmonary resuscitation; PPG:
photoplethysmography.

E. Detection of Blood Volume Redistribution to the Periphery

F. Validation of the Indicator
Fig. 9 presents the compression-free PPG signal ppgcf d [n] of
the animals with ROSC, the state of the indicator of cardiogenic
output SICO and the ROSC annotation trace. The waveform
and indicator show good agreement with the annotation. When
clinicians detect ROSC, a spontaneous pulse is often present
in ppgcf d [n] and blood volume redistribution is detected. In
animal R3, the spontaneous pulse occasionally has a PR of
about 100 min−1 , and is therefore removed from ppgcf d [n] by
the compression removal stage, although ppgcf d [n] then still
shows presence of a spontaneous pulse during the ventilation
periods. In animal R8 the spontaneous pulse appears clearly
after the majority of clinicians detects ROSC. In animals R1,
R4, and R8 blood volume redistribution has been detected before
the first clinician detects ROSC.
For all animals in Fig. 9, the indicator detects cardiogenic
output before the majority of the clinicians detects ROSC at
time instant TC , although consistent detection, on average, occurs 42 s after TC (ΔT in Table I). By combining the detection
of PR with decreases in PPG signal baseline in the indicator, the
specificity decreased from SpPR = 96% to SpICO = 94%, but
the sensitivity increased from SePR = 62% to SeICO = 69%
(see Table I). False detections of cardiogenic output by the indi-

Mean +
2x standard deviaƟon [%]

Fig. 8(a) shows that a pronounced decrease in the baseline
of the PPG signal occurs, lasting at least 10 s, when cardiogenic output resumes in the animals with ROSC (thick lines).
In contrast, this decrease is absent in animals without ROSC
(thin lines). The decrease observed when cardiogenic output
resumes can be detected by using Nbl = 5 · fs d 	 = 157 and
ΔBL = −0.03 [see Fig. 8(b)]. With these parameters, most fluctuations in baseline during cardiac arrest were not detected.

RelaƟve predicƟon error power
35

Animal R1
Animal R2
Animal R3
Animal R4
Animal R6
Animal R7
Animal R8

30
25
20
15
10
5
0
0

10

20

30

AR model order

40

50

Fig. 6. Mean plus two standard deviations of the prediction error power relative to the compression-free PPG signal power as a function of AR model order
for all animals with ROSC. AR: autoregressive; PPG: photoplethysmography;
ROSC: return of spontaneous circulation.

cator occurred in nine animals when CPR was started after cardiac arrest induction, when redistributing blood volume caused
a decrease in the PPG signal baseline. False detections of cardiac
arrest by the indicator were due to undetected PRs, caused by coinciding of the compression rate and the PR or their harmonics,
ppgcf d [n] not meeting the conditions on signal presence (see
Section II-F1), or irregularity of ppgcf d [n]. However, when no
PR was detected and the fundamental PR component had not
been removed, ppgcf d [n] could still show presence of a spontaneous pulse, and whether the spontaneous pulse had a regular
or an irregular rhythm.
IV. DISCUSSION
Based on automated-CPR porcine data, we developed a PPGbased algorithm that detected cardiogenic output during chest
compressions. A compression-free PPG signal was obtained
by subtracting the compression component modeled by a harmonic series. The fundamental frequency of the series was the

918

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Fig. 8. (a) In animals with ROSC (thick line), the PPG signal baseline shows
a pronounced decrease when cardiogenic output resumes. Without ROSC (thin
line), such decrease is absent. The spikes in the traces of R3 and R4 are motion
artifacts caused by changing the ventilator. Each baseline has been normalized
by its mean over the 5 min preceding the shock. (b) Baseline decrease can be
detected when Δ b l [n] decreases below −0.03 when using 5-s windows. All
signals have been aligned with respect to the defibrillation shock at 0 s. PPG:
photoplethysmography; ROSC: return of spontaneous circulation.

Fig. 7. (a) PSD P A R (f ) of the compression-free PPG signal ppgc f d [n],
obtained from an order-18 AR-model. (b) Dots indicate detection of a signal
in ppgc f d [n] [see SIG, (20)] having sufficient high-frequency content [FD,
(21)]. If both conditions hold, PR detection is performed. (c) The PR detection algorithm analyzes a number (purple dots) of all peaks in the PSD (blue
circles) to identify the PR (black dots). (d) Spectrogram of the ABP signal
used to evaluate the PR detection. The dashed line indicates the defibrillation
shock. ABP: arterial blood pressure; AR: autoregressive; PR: pulse rate; PPG:
photoplethysmography; PSD: power spectral density.

compression rate derived from the TTI signal (see Fig. 3).
During automated CPR, when compression rate and depth are
controlled, removal of compressions was effective (see Figs. 4
and 5). Via an AR model, the PSD of the compression-free
PPG signal ppgcf d [n] could be accurately obtained (see Fig. 6).
The AR model allowed for detecting signal presence, and the PR
could be identified in the PSD by searching for a harmonic of the
PR and sum and difference interaction frequencies (see Fig. 7).
When cardiogenic output resumed, the detected PR agreed for

86% with the PR observed in the ABP (see Table I). Incorrect
PR detections resulted from residual compression components,
inadvertent removal of frequencies related to the spontaneous
pulse, or irregularities in ppgcf d [n]. The spontaneous pulse was
removed from ppgcf d [n] when the PR was close to the compression rate [see Fig. 9(e)]. To accommodate for coinciding
PR and compression rate, decreases in the baseline of the PPG
signal were detected. Decreases in baseline occurred when cardiogenic output resumed (see Fig. 8), presumably caused by
a redistribution of blood volume to the periphery. The indicator of cardiogenic output had a good specificity of 94% and a
reasonable sensitivity of 69% (see Table I).
The compression-free PPG signal and the indicator can potentially support ROSC detection during compressions, as is
illustrated by the good agreement with the ROSC annotation
trace. The 94% specificity suggests that a PPG-based indicator can support detecting absence of cardiogenic output during
compressions. In addition, Fig. 9 shows that the indicator detected presence of cardiogenic output before the majority of
the clinicians detected ROSC, which suggests that a PPG-based
indicator can also provide an early indication of ROSC or its development. Furthermore, Fig. 9 illustrates that the compressionfree PPG signal can be more valuable to the clinician than the
indicator alone. For example, the waveform can show presence
of a spontaneous pulse when the PR cannot be determined,
and allows for assessing the regularity of the spontaneous pulse
during compressions. Therefore, this algorithm can support the
clinician in deciding when it is appropriate to further assess
a potential ROSC after a 2-min CPR cycle, although a single
PPG signal does not provide quantitative information on blood
pressure [19].
Detecting cardiogenic output during compressions can also
support decision making in the CPR protocol. Information on
cardiogenic output may support tailoring the duration of the
compression sequence and medication choices to the clinical
state of the patient [34]. Detecting absence of cardiogenic output during compressions may prevent interrupting compressions
for futile and lengthy pulse checks [35]. Detecting presence
of cardiogenic output during compressions may possibly guide

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

919

Fig. 9. The compression-free PPG signal ppgc f d [n] (a, c, e, g, i, k, m) combined with the indicator of cardiogenic output (b, d, f, h, j, l, n) can potentially support
ROSC detection, as they show good agreement with the ROSC annotation trace (b, d, f ,h, j, l, n). The solid vertical green line marks T C , the median of the instants
that clinicians detected ROSC. The dashed vertical green line marks T I , the moment after which interruptions in the indicator are shorter than 5 s. The traces
start at the defibrillation shock. The first five oscillations in (a) are unfiltered compressions, due to incorrect detections in the TTI signal. CPR: cardiopulmonary
resuscitation; PPG: photoplethysmography; PR: pulse rate; ROSC: return of spontaneous circulation; TTI: transthoracic impedance.

stopping compressions to reduce the risk of refibrillation, associated with continuing compressions on a beating heart [36]–
[40]. Furthermore, detecting cardiogenic output during compressions may guide administration of vasopressors, which may
have detrimental effects if administered when the heart has just
resumed cardiogenic output [2].
The algorithm needs further improvement for clinical application, although 94% specificity is promising. Removal of
the compression component was feasible in automated-CPR
data. The varying compression rate and depth in manual CPR
can require faster adaptation to changes in the PPG compression
component and adaptive thresholds for TTI-based compression
detection [21]–[23]. In the small preclinical dataset, parameter
values were not extensively optimized. In a large clinical dataset,
optimization can be performed and adaptive thresholds further
investigated, to improve the algorithm performance as required
for clinical application. The algorithm could operate in real time,
despite that compression detection is delayed by two compressions, and AR and regression analysis operate on 5-s windows.
Real-time operation can require an efficient implementation of
AR analysis.

This study has limitations. First, we used porcine data obtained during automated CPR in a controlled laboratory environment. A clinical CPR study should show the ability of
central and peripheral PPG signals to indicate cardiogenic output in humans during CPR [2], [41], and the suitability of the
baseline of the PPG signal to support ROSC detection. Second,
compressions and ventilations were alternated. The influence
of ventilations during compressions on TTI-based compression
detection should be further investigated [22].
V. CONCLUSION
Detecting cardiogenic output during chest compressions using a PPG-based algorithm is feasible in automated-CPR porcine
data with a high specificity (94%). A compression-free PPG
signal, containing an estimate of the spontaneous pulse waveform, can be obtained by subtracting the compression component modeled by a harmonic series, where the compression rate
can be derived from the TTI signal. The PR can be detected in the
AR spectrum of the compression-free PPG signal by identifying
a harmonic and interaction frequencies. Resumed cardiogenic

920

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

output can also be detected from a decrease in the baseline of
the PPG signal, presumably caused by a redistribution of blood
volume to the periphery. ROSC detection can potentially be supported by combining the compression-free PPG signal with an
indicator based on the detected PR and redistribution of blood
volume.
ACKNOWLEDGMENT
The authors would like to thank Dr P. Woerlee, Ir P. Aelen,
Ir I. Paulussen, and Dr S. Ordelman from Philips Research
Eindhoven, and A. Venema MPA and P. Van Berkom MSc
from St. Elisabeth Hospital Tilburg, for valuable discussions and
conducting the experiments; Mr A. Hanssen, Ms W. JanssenKessel, and Mr M. School from the Central Animal Laboratory
Nijmegen, and Prof. G.-J. Scheffer, Dr M. Kox, Ms F. Van de
Pol, and K. Timmermans MSc from the Radboud University
Nijmegen Medical Center for assistance during preparation and
conduction of the experiments; and Mr B. Wassink from VDL
ETG Research bv for technical assistance.
REFERENCES
[1] J. P. Nolan, “High-quality cardiopulmonary resuscitation,” Curr. Opin.
Crit. Care, vol. 20, no. 3, pp. 227–233, Jun. 2014.
[2] R. W. Neumar, C. W. Otto, M. S. Link, S. L. Kronick, M. Shuster,
C. W. Callaway, P. J. Kudenchuk, J. P. Ornato, B. McNally, S. M. Silvers,
R. S. Passman, R. D. White, E. P. Hess, W. Tang, D. Davis, E. Sinz, and
L. J. Morrison, “Part 8: Adult advanced cardiovascular life support: 2010
American Heart Association guidelines for cardiopulmonary resuscitation
and emergency cardiovascular care,” Circulation, vol. 122, no. 18 Suppl
3, pp. S729–S767, Nov. 2010.
[3] C. D. Deakin, J. P. Nolan, J. Soar, K. Sunde, R. W. Koster, G. B. Smith,
and G. D. Perkins, “European resuscitation council guidelines for resuscitation 2010 Section 4. Adult advanced life support,” Resuscitation, vol. 81,
no. 10, pp. 1305–1352, Oct. 2010.
[4] R. A. Berg, A. B. Sanders, K. B. Kern, R. W. Hilwig, J. W. Heidenreich,
M. E. Porter, and G. A. Ewy, “Adverse hemodynamic effects of interrupting chest compressions for rescue breathing during cardiopulmonary
resuscitation for ventricular fibrillation cardiac arrest,” Circulation,
vol. 104, no. 20, pp. 2465–2470, Nov. 2001.
[5] J. Christenson, D. Andrusiek, S. Everson-Stewart, P. Kudenchuk,
D. Hostler, J. Powell, C. W. Callaway, D. Bishop, C. Vaillancourt,
D. Davis, T. P. Aufderheide, A. Idris, J. A. Stouffer, I. Stiell, and
R. Berg, “Chest compression fraction determines survival in patients with
out-of-hospital ventricular fibrillation,” Circulation, vol. 120, no. 13, pp.
1241–1247, Sep. 2009.
[6] B. Eberle, W. F. Dick, T. Schneider, G. Wisser, S. Doetsch, and I. Tzanova,
“Checking the carotid pulse check: Diagnostic accuracy of first responders in patients with and without a pulse,” Resuscitation, vol. 33, no. 2,
pp. 107–116, Dec. 1996.
[7] J. Tibballs and P. Russell, “Reliability of pulse palpation by healthcare
personnel to diagnose paediatric cardiac arrest,” Resuscitation, vol. 80,
no. 1, pp. 61–64, Jan. 2009.
[8] M. Pokorná, E. Nečas, J. Kratochvı́l, R. Skipský, M. Andrlı́k, and
O. Frank, “A sudden increase in partial pressure end-tidal carbon dioxide
(PE T CO2 ) at the moment of return of spontaneous circulation,” J. Emerg.
Med., vol. 38, no. 5, pp. 614–621, Jun. 2010.
[9] D. P. Davis, R. E. Sell, N. Wilkes, R. Sarno, R. D. Husa, E. M. Castillo,
B. Lawrence, R. Fisher, C. Brainard, and J. V. Dunford, “Electrical and
mechanical recovery of cardiac function following out-of-hospital cardiac
arrest,” Resuscitation, vol. 84, no. 1, pp. 25–30, Jan. 2013.
[10] N. A. Paradis, G. B. Martin, E. P. Rivers, M. G. Goetting, T. J. Appleton,
M. Feingold, and R. M. Nowak, “Coronary perfusion pressure and the return of spontaneous circulation in human cardiopulmonary resuscitation,”
J. Amer. Med. Assoc., vol. 263, no. 8, pp. 1106–1113, Feb. 1990.
[11] E. P. Rivers, J. Lozon, E. Enriquez, S. V. Havstad, G. B. Martin,
C. A. Lewandowski, M. G. Goetting, J. A. Rosenberg, N. A. Paradis,
and R. M. Nowak, “Simultaneous radial, femoral, and aortic arterial
pressures during human cardiopulmonary resuscitation,” Crit. Care Med.,
vol. 21, no. 6, pp. 878–883, Jun. 1993.

[12] E. P. Rivers, G. B. Martin, H. Smithline, M. Y. Rady, C. H. Schultz,
M. G. Goetting, T. J. Appleton, and R. M. Nowak, “The clinical implications of continuous central venous oxygen saturation during human CPR,”
Ann. Emerg. Med., vol. 21, no. 9, pp. 1094–1101, Sep. 1992.
[13] H. Losert, M. Risdal, F. Sterz, J. Nysaether, K. Köhler, T. Eftestøl,
C. Wandaller, H. Myklebust, T. Uray, S. O. Aase, and A. N. Laggner, “Thoracic-impedance changes measured via defibrillator pads can
monitor signs of circulation,” Resuscitation, vol. 73, no. 2, pp. 221–228,
May 2007.
[14] M. Risdal, S. O. Aase, J. Kramer-Johansen, and T. Eftestøl, “Automatic
identification of return of spontaneous circulation during cardiopulmonary
resuscitation,” IEEE Trans. Biomed. Eng., vol. 55, no. 1, pp. 60–68,
Jan. 2008.
[15] J. Ruiz, E. Alonso, E. Aramendi, J. Kramer-Johansen, T. Eftestøl, U. Ayala,
and D. González-Otero, “Reliable extraction of the circulation component
in the thoracic impedance measured by defibrillation pads,” Resuscitation,
vol. 84, no. 10, pp. 1345–1352, Oct. 2013.
[16] A. Kämäräinen, M. Sainio, K. T. Olkkola, H. Huhtala, J. Tenhunen, and
S. Hoppu, “Quality controlled manual chest compressions and cerebral
oxygenation during in-hospital cardiac arrest,” Resuscitation, vol. 83,
no. 1, pp. 138–142, Jan. 2012.
[17] S. Parnia, A. Nasir, C. Shah, R. Patel, A. Mani, and P. Richman, “A
feasibility study evaluating the role of cerebral oximetry in predicting
return of spontaneous circulation in cardiac arrest,” Resuscitation, vol. 83,
no. 8, pp. 982–985, Aug. 2012.
[18] J. Allen, “Photoplethysmography and its application in clinical
physiological measurement,” Physiol. Meas., vol. 28, no. 3, pp. R1–R39,
Mar. 2007.
[19] A. Reisner, P. A. Shaltis, D. McCombie, and H. H. Asada, “Utility
of the photoplethysmogram in circulatory monitoring,” Anesthesiology,
vol. 108, no. 5, pp. 950–958, May 2008.
[20] R. W. C. G. R. Wijshoff, T. van der Sar, P. H. Peeters, R. Bezemer, P. Aelen,
I. W. F. Paulussen, S. C. M. A. Ordelman, A. Venema, P. F. J. van Berkom,
R. M. Aarts, P. H. Woerlee, G.-J. Scheffer, and G. J. Noordergraaf, “Detection of a spontaneous pulse in photoplethysmograms during automated
cardiopulmonary resuscitation in a porcine model,” Resuscitation, vol. 84,
no. 11, pp. 1625–1632, Nov. 2013.
[21] E. Aramendi, U. Ayala, U. Irusta, E. Alonso, T. Eftestøl, and
J. Kramer-Johansen, “Suppression of the cardiopulmonary resuscitation
artefacts using the instantaneous chest compression rate extracted from
the thoracic impedance,” Resuscitation, vol. 83, no. 6, pp. 692–698,
Jun. 2012.
[22] U. Ayala, T. Eftestøl, E. Alonso, U. Irusta, E. Aramendi, S. Wali, and
J. Kramer-Johansen, “Automatic detection of chest compressions for the
assessment of CPR-quality parameters,” Resuscitation, vol. 85, no. 7,
pp. 957–963, Jul. 2014.
[23] J. Ruiz, U. Irusta, S. Ruiz de Gauna, and T. Eftestøl, “Cardiopulmonary
resuscitation artefact suppression using a Kalman filter and the frequency
of chest compressions as the reference signal,” Resuscitation, vol. 81,
no. 9, pp. 1087–1094, Sep. 2010.
[24] U. Irusta, J. Ruiz, S. Ruiz de Gauna, T. Eftestøl, and J. Kramer-Johansen,
“A least mean-square filter for the estimation of the cardiopulmonary
resuscitation artifact based on the frequency of the compressions,” IEEE
Trans. Biomed. Eng., vol. 56, no. 4, pp. 1052–1062, Apr. 2009.
[25] B. Widrow, J. R. Glover, J. M. McCool, J. Kaunitz, C. S. Williams,
R. H. Hearn, J. R. Zeidler, E. Dong Jr., and R. C. Goodlin, “Adaptive
noise cancelling: Principles and applications,” Proc. IEEE, vol. 63, no. 12,
pp. 105–112, Dec. 1975.
[26] Y. Xiao and Y. Tadokoro, “LMS-based notch filter for the estimation of
sinusoidal signals in noise,” Signal Process., vol. 46, no. 2, pp. 223–231,
Oct. 1995.
[27] S. M. Kay and S. L. Marple, “Spectrum analysis—A modern perspective,”
Proc. IEEE, vol. 69, no. 11, pp. 1380–1419, Nov. 1981.
[28] S. L. Marple Jr., “Corrections to “Spectrum analysis—A modern perspective,” Proc. IEEE, vol. 70, no. 10, pp. 1238, Oct. 1982.
[29] D. A. Linkens, “Short-time-series spectral analysis of biomedical data,”
Proc. IEE, vol. 129, no. 9, pp. 663–672, Dec. 1982.
[30] S. G. Fleming and L. Tarassenko, “A comparison of signal processing
techniques for the extraction of breathing rate from the photoplethysmogram,” Int. J. Biol. Med. Sci., vol. 1, no. 6, pp. 232–236, Oct. 2007.
[31] S. S. Haykin, Ed., Nonlinear Methods of Spectral Analysis. New York,
NY, USA: Springer-Verlag, 1979.
[32] H. J. J. Wellens, K. I. Lie, and D. Durrer, “Further observations on
ventricular tachycardia as studied by electrical stimulation of the heart:
Chronic recurrent ventricular tachycardia and ventricular tachycardia during acute myocardial infarction,” Circulation, vol. 49, no. 4, pp. 647–653,
Apr. 1974.

WIJSHOFF et al.: PHOTOPLETHYSMOGRAPHY-BASED ALGORITHM FOR DETECTION OF CARDIOGENIC OUTPUT DURING CPR

[33] M. J. Hinich, “Detecting a hidden, periodic signal when its period is
unknown,” IEEE Trans. Acoust., Speech, Signal Process., vol. ASSP-30,
no. 5, pp. 747–750, Oct. 1982.
[34] T. Nordseth, D. P. Edelson, D. Bergum, T. M. Olasveengen, T. Eftestøl,
R. Wiseth, J. T. Kvaløy, B. S. Abella, and E. Skogvoll, “Optimal loop
duration during the provision of in-hospital advanced life support (ALS)
to patients with an initial non-shockable rhythm,” Resuscitation, vol. 85,
no. 1, pp. 75–81, Jan. 2014.
[35] R. Wijshoff, T. van der Sar, R. Aarts, P. Woerlee, and G. Noordergraaf,
“Potential of photoplethysmography to guide pulse checks during cardiopulmonary resuscitation: Observations in an animal study,” Resuscitation, vol. 84, pp. S1–S7, Oct. 2013.
[36] J. Osorio, D. J. Dosdall, R. P. Robichaux, P. B. Tabereaux, and R. E. Ideker,
“In a swine model, chest compressions cause ventricular capture and, by
means of a long-short sequence, ventricular fibrillation,” Circulation.,
Arrhythmia Electrophysiol., vol. 1, no. 4, pp. 282–289, Oct. 2008.
[37] J. Osorio, D. J. Dosdall, P. B. Tabereaux, R. P. Robichaux, S. Stephens,
J. D. Kerby, R. E. Stickney, S. Pogwizd, and R. E. Ideker, “Effect of
chest compressions on ventricular activation,” Amer. J. Cardiol., vol. 109,
no. 5, pp. 670–674, Mar. 2012.

921

[38] R. W. Koster, “Refibrillation during out-of-hospital arrest: A frequent
event with clinical consequences,” Signa Vitae, vol. 5, no. Suppl 1,
pp. 66–68, 2010.
[39] J. Berdowski, J. G. P. Tijssen, and R. W. Koster, “Chest compressions cause
recurrence of ventricular fibrillation after the first successful conversion
by defibrillation in out-of-hospital cardiac arrest,” Circulation. Arrhythmia
Electrophysiol., vol. 3, no. 1, pp. 72–78, Feb. 2010.
[40] A. Shiyovich, A. Gerovich, and A. Katz, “Recurrence of ventricular fibrillation after successful conversion, may be associated with immediate
post-shock chest compressions: A case report,” Brit. J. Med. Med. Res.,
vol. 3, no. 3, pp. 722–726, Feb. 2013.
[41] R. D. Branson and P. D. Mannheimer, “Forehead oximetry in critically
ill patients: The case for a new monitoring site,” Respir. Care Clin. North
Amer., vol. 10, no. 3, pp. 359–367, Sep. 2004.

Authors’ photographs and biographies not available at the time of publication.

