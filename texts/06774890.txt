520

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Energy-Efficient ECG Compression on Wireless
Biosensors via Minimal Coherence Sensing and
Weighted 1 Minimization Reconstruction
Jun Zhang, Zhenghui Gu∗ , Member, IEEE, Zhu Liang Yu, Member, IEEE, and Yuanqing Li, Member, IEEE

Abstract—Low energy consumption is crucial for body area networks (BANs). In BAN-enabled ECG monitoring, the continuous
monitoring entails the need of the sensor nodes to transmit a huge
data to the sink node, which leads to excessive energy consumption. To reduce airtime over energy-hungry wireless links, this paper presents an energy-efficient compressed sensing (CS)-based
approach for on-node ECG compression. At first, an algorithm
called minimal mutual coherence pursuit is proposed to construct
sparse binary measurement matrices, which can be used to encode
the ECG signals with superior performance and extremely low
complexity. Second, in order to minimize the data rate required
for faithful reconstruction, a weighted 1 minimization model is
derived by exploring the multisource prior knowledge in wavelet
domain. Experimental results on MIT-BIH arrhythmia database
reveals that the proposed approach can obtain higher compression
ratio than the state-of-the-art CS-based methods. Together with
its low encoding complexity, our approach can achieve significant
energy saving in both encoding process and wireless transmission.
Index Terms—Compressed sensing (CS), ECG telemonitoring,
incoherence, weighted 1 minimization.

I. INTRODUCTION
ITH the rapid advancement of body area network
(BAN), low cost BAN-enabled ECG monitor has become important equipment for healthcare service providers and
users [1]–[3]. However, in common BAN-enabled ECG monitors, the sensor nodes fall short of energy efficiency due to
the huge data obtained from continuous monitoring and the
energy-hungry wireless links [4]–[7]. It is desirable to improve
the energy efficiency by reducing the in-network data rate and
shortening the airtime over wireless links.
Although conventional compression techniques, such as
wavelet-based algorithms [8]–[10], have a high data compres-

W

Manuscript received October 31, 2013; revised February 8, 2014; accepted
March 12, 2014. Date of publication March 18, 2014; date of current version
March 2, 2015. This work was supported in part by the National High-tech R&D
Program of China (863 Program) under grant 2012AA011601, the National Natural Science Foundation of China under grants 61175114, 91120305, 61403085,
the Natural Science Foundation of Guangdong under grants S2012020010945,
2013KJCX0009, the Excellent Youth Development Project of Universities
in Guangdong Province under grant 2012LYM0057. (Corresponding author:
Z. Gu.)
J. Zhang is with the College of Information Engineering, Guangdong University of Technology, Guangzhou 510006, China (e-mail: jzhang@gdut.edu.cn).
Z. Gu, Z. L. Yu, and Y. Li are with the College of Automation Science and
Engineering, South China University of Technology, Guangzhou 510640, China
(e-mail: zhgu@scut.edu.cn; zlyu@scut.edu.cn; auyqli@scut.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2312374

sion ratio, their energy cost in encoding process will offset, or
even exceed the savings. Therefore, new techniques with low encoding complexity for on-node compression are needed. Compressed sensing (CS) [11], [12] is an emerging discipline which
has attracted increasing attention thanks to its ability to guarantee data compression during the signal acquisition phase. In
particular, CS has the potential to meet the demand of low encoding complexity by designing the measurement matrix carefully.
Recently, the idea of CS has been applied in real-time ECG compression on resource-constrained sensors [13]–[15]. Typically,
Mamaghanian et al. [13], [14] proposed a measurement matrix
design technique named random sparse binary matrix (R-SBM)
method to encode the ECG signals on the representative Shimmer mote. Each column of R-SBM contains only zero entries
besides d entries of 1s with random locations, where the value
of d is small. Using the R-SBM, the encoding process of CS
can be realized through a few addition operations. Thus, it can
greatly reduce the energy cost. Decoding by the 1 minimization
algorithm [13] or model-based algorithms [14], Mamaghanian’s
work shows that the CS-based method extends the sensor node
lifetime through reducing the data rate. Further, Zhang et al.
proposed a CS-based algorithm [15]–[18], named block sparse
Bayesian learning (BSBL), to reconstruct fetal ECG and EEG
signals. Exploiting the intrablock correlation of the signals, the
BSBL has shown its outstanding performance on both fetal ECG
and EEG reconstructions. Particularly, the BSBL allows the use
of an R-SBM with only two nonzero entries in each column
to compress signals, which can greatly reduce energy cost in
encoding process.
Generally, the performance of CS relies heavily on incoherence measurement and reconstruction algorithms [19]. It is easy
to confirm that when the number of entries of 1s in each columns
is fewer, the R-SBM can encode ECG signals with lower energy
consumption [13], [15]. However, the incoherence property of
the R-SBM will deteriorate sharply at the same time [13]. Obviously, high coherence in measurement matrix means more
measurements are needed to finally reconstruct the ECG signal,
which will increase the energy consumption in wireless data
transmission. Hence, it is important to minimize the coherence
of the SBM when the number of entries of 1s in each column
is few. On the other hand, to decode ECG signals, the 1 minimization [19], [20] is the most frequently used algorithm since
it is a convex problem and admits efficient solution via linear programming techniques. Essentially, the 1 minimization
algorithm utilizes only the sparsity prior on the property of

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

ZHANG et al.: ENERGY-EFFICIENT ECG COMPRESSION ON WIRELESS BIOSENSORS

signals to guarantee the exact reconstruction. Nevertheless,
other than the standard sparsity prior, incorporating additional
knowledge of signals in the reconstruction algorithm is an efficient way to achieve higher decoding quality at a given number
of measurements, or equivalently, a lower number of measurements for a given decoding quality [21], [22]. Besides the high
sparsity nature of ECG signal in wavelet domain, we also notice
that the approximation coefficients of an ECG signal are often nonzero, and the detail coefficients decay exponentially fast
with increasing resolution level. If these anticipated information
can be explored and exploited properly in the reconstruction algorithm, one may achieve accurate decoding with substantially
lower number of measurements.
In this paper, we aim to develop an energy-efficient CS
method for on-node ECG compression. Our main contributions
lie in the following two aspects. 1) A minimal mutual-coherence
pursuit (MMCP) algorithm is proposed. In contrast to the random fashion in R-SBM, the proposed algorithm optimizes the
locations of entries of 1s to construct an SBM which achieves
minimal mutual coherence. 2) We have deduced the decay factors of wavelet coefficients between neighboring resolution levels, and present a weighted 1 minimization (WLM) algorithm
to improve the decoding performance by embedding the multisource knowledge within penalty weights. Finally, experimental
results on MIT-BIH arrhythmia database showed that the proposed method with ultra-low encoding complexity allows the
number of measurements to be reduced greatly while maintaining the reconstruction accuracy.
The rest of the paper is organized as follows. Section II introduces basic CS, the minimal mutual-coherence sparse binary
sensing and the WLM algorithm. In Section III, the experimental results are presented and compared with the results from the
state-of-the-art CS-based compression methods. Conclusions
are given in Section IV.
II. MATERIAL AND METHODS
A. Compressed Sensing and Sparse Recovery
CS, as a new compression paradigm, relies on three main requirements: sparsity representation, incoherence measurement,
and nonlinear reconstruction, which pertain to the signals of
interest, the encoding modality, and the decoding method, respectively. Let x ∈ RN be a real-valued N -dimensional ECG
signal vector, which we expand in an orthonormal wavelet basis
Ψ = [ψ 1 ψ 2 · · · ψ N ] as follows:
x = Ψθ

(1)

where θ is the coefficient vector of x. If most entries of vector
θ have negligible amplitude, the ECG signal has sparse representations in the wavelet domain. The basic CS model can be
expressed as
y = Φx  Aθ

(2)

where Φ ∈ RM ×N (M  N ) is a designed measurement (or
sensing) matrix, and A = ΦΨ. y ∈ RM is the compressed signal vector. In our study x is a segment from an ECG recording,

521

and y is the compressed data that will be transmitted via a BAN
to a remote terminal.
In order to improve the energy efficiency, we need to make
the data to be transmitted as less as possible. There are two key
problems in CS-based data compression. First, for encoding,
how should we design a measurement matrix Φ with minimal
amount of measurements to ensure that data y preserves all the
information of vector x? Second, for decoding, how can we
reconstruct the original x from the compressed data y?
For the first question, the measurement matrix Φ must obey
the restricted isometry property (RIP) or the null space property (NSP) [19]. Among them, the RIP requires that all column submatrices of a certain size of the sensing matrix are
well conditioned. However, it is quite difficult to analyze these
properties for deterministic matrices with minimal amount of
measurements. Hence, mutual coherence (MC) [23], as an alternative way, is often used to characterize the measurement
matrix, which can be defined as
MC = MC(Φ) =

max

1≤k ,j ≤N ,k = j

|G(k, j)|

(3)

T

where G  Φ̄ Φ̄ and Φ̄ is a matrix whose column is the normalized version of the column of Φ with unit 2 -norm. Because
smaller MC usually means that the measurement matrix Φ can
preserve the information in the vector x with less amount of
measurements, it is desirable that the MC is as small as possible.
In general CS applications, random matrices such as Gaussian
iid matrices or Bernoulli matrices are good choices. Introducing
randomness allows us to show near-optimal conditions on the
number of measurements [24], [25]. In terms of the sparsity
of signal vector, it allows the recovery using the below 1 minimization method (Basis Pursuit)
min θ̂1

s.t.

y = Aθ̂.

(4)

θ̂

In addition, Bayesian CS [26] and greedy approaches such as
orthogonal matching pursuit (OMP) [23], iterative hard thresholding (IHT) [27], [28] and gradient pursuits (GP) [29], [30]
are the state-of-the-art algorithms for signal recovery. Recently,
BSBL [15], [18] has been proposed as an effective method for
CS recovery problem.
B. Minimal Mutual Coherence Sparse Binary Sensing
Although the random matrices have many theoretical benefits,
they have the drawbacks of high complexity and large storage
in practical implementation. It is unrealistic to use them in the
BAN-based ECG monitoring. Mamaghanian et al. [13] showed
that the R-SBM can greatly reduce on-node energy and space
consumption in the application. However, constituted only by 0s
and 1s, the R-SBM is inferior to the random matrices in terms
of the capability of sensing the signal with minimal amount
of measurements, especially when the number of entries of 1s
is extremely low. Therefore, this section proposes an MMCP
algorithm to construct the SBM. The main difference between
our method and R-SBM is that contrary to the random fashion
in R-SBM, our method optimizes the locations of entries of 1s
to pursuit minimal mutual coherence.

522

Fig. 1.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Scene of sensing matrix construction.
Fig. 2.

Suppose we construct an M × N SBM Φ in which each
column contains d entries of 1s. Denote the ith column and the
jth row of Φ as φi and γ j respectively. Let Ωi be the location
set of entries of 1s in φi . In the beginning we initialize Φ to
a zero matrix, thus Ωi (1 ≤ i ≤ N ) is an empty set. The main
practices of the MMCP algorithm can be summarized in two
rules: 1) increasing the entries of 1s in Φ column by column
and one by one; 2) determining the location of current 1s with
the principle of minimal MC increase.
According to the definition of MC, the increase in MC results
from the increase in the number of superposition of 1s between
two columns. Therefore, in order to insert a 1 into a column,
we should try to choose its location that can avoid the increase
in the number of superposed 1s between the current column
and the previous columns. However, except for the two columns
that have the most number of superposed 1s, the increase in
the number of superposed 1s between other two columns will
not cause the increase of MC immediately. Particularly, there
always exist superposed 1s between two columns in the final
constructed Φ because M < N . Thus, a single superposition of
1 between any two columns will not affect the MC of the final
Φ. Moreover, if more than one superposition is inevitable, we
would choose to increase the number of superposed 1s between
the current column and the column that has the least superposed
1s with the current column at the moment. In the location set of
such column, the location that has superposed 1s with the least
previous columns is chosen.
Based on the above analysis, to determine the kth location
(1 ≤ k ≤ d) of 1 in φi , we compute the following items:
Ωi ∩ Ωi 	
	

	

for 1 ≤ i ≤ i − 1.

(5)

Denote Λi 	 , 1 ≤ i ≤ i − 1, as the results of (5). We check the
sets Λi 	 one by one. If a certain Λi 	 is not an empty set, we
should not choose the element of Ωi 	 as the location of the
current 1s in φi in principle, for it will produce more than one 1s
superposition between φi and φi 	 . Assume M = 12 and d = 3,
a scene of determining the third location of 1s in φi is depicted in
Fig. 1. For simplicity of the description, we omit all the columns

Mutual coherence of sensing matrices versus d.

except the first, second and ith columns. At this moment, both
Λ1 and Λ2 are nonempty set. Therefore, we should try to avoid
choosing the locations 4, 8, 9, and 11. However, when all of
the sets Λi 	 have been checked, two situations can occur: 1) a
nonempty position set, denoted as Δ, exists; 2) each location is
included in a Ωi 	 whose Λi 	 is not an empty set. For the first
situation, we choose the location j for the current 1s, where
j ∈ Δ and the sum of γ j is minimal. Otherwise, we choose the
	
location j, where s = mini 	 {|Λi 	 |, 1 ≤ i ≤ i − 1}, j ∈ Ωs and
the sum of γ j is minimal.
The proposed algorithm can be outlined as Algorithm 1. To
validate the effectiveness of the proposed MMCP algorithm,
we herein compare the measurement matrices constructed by
the MMCP algorithm, named MMC-SBM, with the R-SBM
in terms of MC. The size of the matrices is 256 × 512 in our
experiment. Fig. 2 plots the MC versus the number of nonzero
elements d for the two classes of matrices. As a baseline, the
MC corresponding to random Gaussian matrix (RGM) is also
reported, where the elements of the matrix are normal distributed
random numbers. As shown in Fig. 2, the MMC-SBM is always
superior to the R-SBM, even better than the RGM in the cases
of 4 ≤ d ≤ 8. It is easy to verify that the MMC-SBMs have the
minimal MC for 1 ≤ d ≤ 8, because there are at most a single
superposition of 1 between any two columns. Although the MC
of the MMC-SBM is higher than that of the RGM when d ≥ 9
due to its binary feature and the decrease of position freedom,
it is worth noting that the optimal construction of extremely
sparse binary matrix is what we care about in BAN-enabled ECG
telemonitoring for its ultra-low energy and space consumption.
Remark 1: In the worst case, the computational complexity
of Algorithm 1 scales as O(N 2 log2N ). The complexity of RSBM construction is O(M N log2M ). Although the complexity
of MMC-SBM construction is higher than that of R-SBM, it can
be considered a tolerable defect since the measurement matrices
are always obtained offline. In the BAN-enabled ECG monitoring, the most important issues of a measurement matrix are its

ZHANG et al.: ENERGY-EFFICIENT ECG COMPRESSION ON WIRELESS BIOSENSORS

523

300

2

200

1

100

0
0
−0.4

−0.3

−0.2

0

500

1000

1500

2000

2500

3000

0.1

0.2

0.3

0.4

0.1

0.2

0.3

0.4

0.1

0.2

0.3

0.4

H2 subband

100

−2

0

−0.1

−1

50

6
0
−0.4

4

−0.3

−0.2

−0.1

40

2

0

H1 subband

30

0

20

−2
−4

10

0

500

1000

1500

2000

2500

3000

0
−0.4

−0.3

−0.2

−0.1

0

H subband
0

(a)

(b)

Fig. 3. (a) From top to bottom, the original segment of record no. 124 MIT-BIH arrhythmia data and the corresponding wavelet coefficients of three-level wavelet
transform. (b) From top to bottom, the histograms of wavelet coefficients of the H 2 , H 1 , H 0 high-frequency subbands, respectively.

with standard deviation σi , i.e.,

⎛ √   ⎞
2 θ̂i 
1
⎠.
. exp ⎝−
p(θ̂i ) = √
σi
2σi

(6)

By maximizing the probability p(θ̂|y, A), the maximum a posteriori (MAP) estimation of θ under the prior p(θ̂i ) can be given
as [31]
⎛
2
√   ⎞


− Aθ̂ 
2 θ̂i  ⎟
y
	
⎜
2
+
θ̂ M AP = arg min ⎝
(7)
⎠.
2σn2
σi
θ̂
i
Further, (7) can be expressed as
2


1




θ̂ M AP = arg min y − Aθ̂  + λ Wθ̂ 
2
1
2
θ̂

sensing performance and computational complexity required in
signal encoding process.

C. Weighted 1 Minimization Method
To reconstruct the original ECG signal x, we herein propose a
weighted 1 minimization method (WLM). In most practical situations, we can observe only the noisy data y = Aθ + n, where
n represents the additive measurement noise. We assume that
the components of n are independent and identically distributed
(i.i.d.) Gaussian variables with unknown variance σn2 , and the
entry θ̂i of θ̂ is independent and has a Laplacian distribution

(8)

where W = diag( σ11 , σ12 , . . . , σ1N ), λ is a tuning parameter.
Hence, Basis Pursuit in (4) can be interpreted as the MAP estimation under a Laplacian prior on θ̂ and the hypothesis that the
entries of θ̂ have equal standard deviations.
However, for most ECG signals, there are at least two facts
in our application that make the above hypotheses unsatisfied:
1) since the approximation coefficients of an ECG signal in
wavelet domain are often nonzero, the corresponding part of θ̂
does not satisfy the sparsity hypothesis and cannot be modeled
by the Laplacian distribution; 2) the detail coefficients decay
exponentially fast with increasing resolution level, therefore the
hypothesis that the entries of θ̂ have equal standard deviations
does not reflect this reality. To illustrate the two arguments, as
an example, Fig. 3 plots the wavelet coefficients of the threelevel wavelet transform for record no.124 MIT-BIH arrhythmia
data. At the same time, the corresponding histograms of the
wavelet coefficients in the three detail subbands are simultaneously reported. Clearly, the approximation coefficients (range
[1, 375]) are nonzero and the standard deviations of the wavelet

524

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Fig. 4. Output PRD averaged over all MIT-BIH ECG records for different
number of measurements M for different algorithms. WLM(RGM), WLM(RSBM), and WLM(MMC-SBM) represent the results of WLM algorithm when
the measurement matrices are RGM, R-SBM, and MMC-SBM, respectively.
TABLE I
PROBABILITY OF RECONSTRUCTION FOR “GOOD” QUALITY UNDER DIFFERENT
NUMBER OF MEASUREMENTS M (%)
M

OMP

IHT

GP

BCS

BP

BSBL

96
128
160
192
224
256
288
320

0
0
0
72.9
79.2
87.5
91.7
95.8

0
0
0
39.6
64.6
87.5
91.7
91.7

0
0
0
16.7
85.4
91.7
91.7
93.8

0
0
0
87.5
91.7
91.7
93.8
97.9

0
0
12.5
37.5
75.0
91.7
93.8
97.9

2.1
18.8
72.9
89.6
95.8
100
100
100

WLM.
RGM

R-SBM

MMC-SBM

20.8
54.2
83.3
93.8
95.8
97.9
100
100

18.8
52.1
81.3
93.8
95.8
97.9
100
100

31.3
70.8
87.5
93.8
95.8
97.9
97.9
100

θH j , k =< x, ψj,k >

(11)

where ψj,k (t) = 2j /2 ψ(2j t − k), j, k ∈ Z. Note that ψj,k lives
on an interval Ij,k of length proportional to 2−j . Hence, if signal
x has s ≤ q continuous derivatives on Ij,k , it can be approximated with a Taylor polynomial [33]
(12)

where Ps−1 (t) is a (s-1)-order polynomial. According to (10),
we have

θH j , k =< x, ψj,k >=
x(t)ψj,k (t)dt

(9)

where θ L 0 consists the approximation coefficients, and θ H 0 ,
θ H 1 , . . . , θ H J −1 represent the detail coefficients at J levels,
respectively. First, because almost all the entries of θ L 0 are
nonzero, it is not necessary to employ a sparsity constraint on
θ̂ L 0 . Therefore, the corresponding diagonal elements of W for
θ̂ L 0 are set at zero. Second, we determine the other elements of
matrix W by studying the decay characteristic of detail coefficients between different levels. For special choice of wavelet
ψ, we assume that the wavelet ψ has q vanishing moments [32],
i.e.,

xn ψ(t)dt = 0 for n = 0, 1, . . . , q − 1.
(10)
R

The kth entry of θ H j is denoted as θH j , k , thus

x(t) = Ps−1 (t) + O((2−j )s )

coefficients in the three detail subbands stably decay with increasing resolution level.
In the proposed WLM, we construct a N × N matrix W
to incorporate the aforementioned multisource prior. Suppose
an ECG signal x is decomposed into J layers. Thus, θ can be
partitioned into J + 1 groups, i.e.,
θ = [θ TL 0 , θ TH 0 , . . . , θ TH J −1 ]T

Fig. 5. Box plots for all database records for OMP, IHT, GP, BCS, BP,
BSBL, and WLM, respectively, when the number of measurements M = 128.
WLM(G), WLM(R), and WLM(M) are the abbreviations of WLM(RGM),
WLM(R-SBM), and WLM(MMC-SBM), respectively.


=

R

Ps−1 (t)ψj,k (t)dt + O((2−j )s )

R

= O((2−j )s ).

(13)

Obviously, the magnitude of the detail coefficients is governed
by the resolution level j and the local smoothness s of the
underlying signal x.
Imposing the prior belief that detail coefficient has a 2−s rate
of decay with increasing resolution level, the reconstruction of
θ can be reformulated by the convex optimization problem as
follows:
J
−1
2
 T 
	
1




2−(J −1−j )s θ̂ H j 
(14)
arg min y − Aθ̂  + λ
2
1
2
θ̂
j =0
where s is a tuning parameter that reflects the smoothness of
signal x. It is worth noting that model (14) aims to incorporate
the level-dependent prior to reconstruct vector θ, but simplify
the influence of the different local smoothness of the underlying
signal on the detail coefficients. In our experiments, considering
that ECG signal can be regarded as a piecewise polynomial

ZHANG et al.: ENERGY-EFFICIENT ECG COMPRESSION ON WIRELESS BIOSENSORS

Original Segment

525

OMP

Original Segment

OMP

2

5

2

2

0

0

0

0

−2

0

100

200

300

400

−5

500

0

100

200

400

500

−2

0

100

200

300

400

−2

500

0

100

200

IHT

300

400

500

300

400

500

300

400

500

400

500

GP

2

5

2

1

1

0

0

−1

0

0
−2

300

GP

IHT

0

100

200

300

400

−5

500

0

100

200

BCS

300

400

500

−1

0

100

200

BP

2

300

400

−2

500

0

100

200

BCS

BP

2

2

2

0

0

0

0
−2
−4

0

100

200

300

400

−2

500

0

100

BSBL

200

300

400

500

−2

0

100

WLM

200

300

400

−2

500

2

2

2

0

0

0

0

0

100

200

300

400

−2

500

0

100

200

300

100

400

500

−2

0

100

200

300

200

WLM

2

−2

0

BSBL

400

−2

500

0

100

200

300

(b)

(a)

Fig. 6. Recovery results for (a) Record 220 and (b) Record 231. In both subfigure, there are the original segments and the recovered results by OMP, IHT, GP,
BCS, BP, BSBL, and WLM, respectively. (a) Record 220. (b) Record 231.

function [34], which has one derivative at most of positions,
we chose s = 1. Experimental results verify the validity of this
selection.
Remark 2: In contrast to Basis Pursuit, the main advantage
of model (14) is the incorporation of the multisource prior
in wavelet domain, including the positions of nonzero coefficients and the decay relationship of wavelet coefficients between
neighboring resolution levels, which will allow the number of
measurements to be significantly reduced without leading to
ambiguity.
Remark 3: The method (14) has similar computational complexity as the Basis Pursuit. However, it is noteworthy that the
decoding process is often performed on a computer equipped
with high-performance processor, the computational complexity of the reconstruction method is not a very important issue in
most of the BAN-enabled ECG monitoring applications.
III. RESULTS AND DISCUSSION
In this section, experiments were carried out to verify the
performance of the proposed method. We have chosen all the 48
MIT-BIH arrhythmia data as test signals. Each data file includes
two-channel ambulatory ECG recordings, and one channel data
instance was chosen for the evaluation of the algorithm performance. To measure the reconstruction quality, we employ the
percentage root-mean-square difference (PRD) to quantify the
error percentage between the original x and the reconstructed
x̂:
PRD =

x − x̂2
× 100 (%).
x2

(15)

For ECG compression, Zigel et al. [35] had classified the different values of PRD based on the signal quality perceived by

specialists. In accordance with their results, PRD value below
9% is classified as “good” reconstruction quality in this paper.
A. Experimental Setup
In our experiments, ECG vector x is extracted from the original signal at the window size N = 512. To obtain M samples,
we are interested in constructing a measurement matrix that satisfies the minimal MC, but has as less number of entries of 1s in
each column as possible. Hence, the proposed MMCP algorithm
was applicable to the determination of this matrix. By increasing the number of entries of 1s in each column from d = 1,
the MMC-SBMs were constructed in a sequential way. In the
initial phase, the MC of the constructed matrix will decrease
sharply with the increase of d. In our experiments, we found
that the matrix with minimal MC can be always obtained in a
very small d (96 × 512, 128 × 512 and 160 × 512 matrices can
be constructed with d = 4, 5, and 6, respectively). We chose
these MMC-SBM as the measurement matrix to compress (encode) the ECG signals, and the WLM algorithm was used in the
remote terminal to recover (decode) the original ECG signals.
To evaluate the performance of MMC-SBM, we compared the
recovery results of the WLM algorithm when the measurement
matrix was the MMC-SBM, R-SBM, and RGM, respectively.
At the same time, several state-of-the-art CS algorithms have
been chosen for performance comparison, including OMP [23],
IHT [27], [28], GP [29], [30], Bayesian CS (BCS) [26], Basis
Pursuit (BP) [20], and BSBL [15], [18]. Among them, OMP,
IHT, GP, BCS, and BP are the representatives of the greedy
algorithms, Bayesian compressive sensing or convex relaxation
algorithms. The BSBL proposed recently by Zhang et al. is
the most outstanding CS method for Fetal ECG(FECG) and
EEG reconstruction. In our comparison experiments, these algorithms used the R-SBM with d = 12 as the measurement

526

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

1
0
−1
10
0
−1
20
0
−2
10
0
−1
10
0
−1
10
0
−1

0

2
0
−2

200

400

600

800

1000

1
0
−1

200

400

600

800

1000

1
0
−1

200

400

600

800

1000

200

400

600

800

1000

1
0
−1

200

400

600

800

1000

2
0
−2

200

400

600

800

(a)
0
200

400

600

800

1000

0
−1
20

200

400

600

800

1000

0
−2
10

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

0
−1
10
0
−1
10
0
−1

200

400

600

800

1000

0

200

400

600

800

1000

0

200

400

600

800

1000

0

200

400

600

800

1000

0

200

400

600

800

1000

0

200

400

600

800

1000

(a)

1000

1
−1
10

1
0
−1

0

2
0
−2
10
0
−1
10
0
−1
10
0
−1
10
0
−1
20
0
−2
0

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

200

400

600

800

1000

(b)
0

(b)

Fig. 7. First 1000 time points of the six records in MIT-BIH arrhythmia dataset
with ”worst” PRD for BSBL. (a) Recovered results of BSBL. (b) Recovered
results of WLM. In each figure, the red curves represent the original signal
and the blue curves are the recovered signals. (a) Recovered results by BSBL.
(b) Recovered results by WLM.

matrix that was suggested in Mamaghanian’s work [13]. For the
OMP and BP implementations, we used the solvers SolveOM P
and SolveBP , respectively, from the SparseLab toolbox [36];
for the IHT and GP implementations, we used the solvers
Hard 10 M term and greed gp, respectively, from the Sparsify toolbox [37]; for the BCS implementation, we used the
solver BCS f ast rvm from the BCS toolbox [38]; for the
BSBL, we used the solver BSBL BO [15]. We set Ψ to be
the orthonormal basis of Daubechies-6 wavelet because it can
yield very sparse representation of ECG and has six vanishing
moments.
B. Average PRD and the Probability
of “Good” Reconstruction
For all the 48 MIT-BIH arrhythmia records, the experimental result is shown in Fig. 4, where each point is the average
PRD of a specified number of measurements. At the same time,
Table I reports the probability of “good” reconstruction quality
at different situations. As it is shown in Fig. 4 and Table I, the

Fig. 8. First 1000 time points of the six records in MIT-BIH arrhythmia dataset
with ”worst” PRD for WLM. (a) Recovered results of BSBL. (b) Recovered
results of WLM. In each figure, the red curves represent the original signal
and the blue curves are the recovered signals. (a) Recovered results by BSBL.
(b) Recovered results by WLM.

WLM related algorithms achieved the best performance in terms
of averaged output PRD and the probability of “good” reconstruction quality. Moreover, the performance of MMC-SBM has
been validated. Among the three different measurement matrices
(MMC-SBM, R-SBM, and RGM), the MMC-SBM can improve
the reconstruction accuracy of WLM algorithm when the number of measurements is very small. In these experiments, we can
also observe that the performance improvement caused by the
decoding method, WLM, is more significant than that caused
by the measurement matrix MMC-SBM. Considering the measurement matrix, it is noteworthy that the RGMs approach the
near-optimal sensing performance in theory [24], [25]. However, they are hard to be used in applications like long-term
ECG monitoring due to their high computational complexity in
signal encoding. Therefore, taking into account both the superior sensing performance and low computational complexity, the
MMC-SBM is a very good measurement matrix for long-term
ECG monitoring. It is also shown that if the MMC-SBM is chosen as the measurement matrix, the averaged output PRD of the
WLM algorithm is less than 9% for the number of measurements
M = 128, and it can achieve 87.5% of “good” reconstruction
quality with M = 160. As a comparison, most other algorithms

ZHANG et al.: ENERGY-EFFICIENT ECG COMPRESSION ON WIRELESS BIOSENSORS

under this condition cannot recover any records in MIT-BIH
arrhythmia database with “good” reconstruction quality due to
the very small number of measurements.
To observe the variance across the individual records, Fig. 5
shows the box plots for these algorithms when the number of
measurements M = 128. On each box, the central mark is the
median, the edges of the box are the 25th and 75th percentiles,
and the whiskers extend to the most extreme data points. Obviously, the WLM algorithm adopted the MMC-SBM as the
measurement matrix outperforms the other algorithms. In our
experiment, Record 220 and 231 are the 25th and 75th percentiles, respectively, for the WLM algorithm. Fig. 6 displays
the recovered segments for these algorithms. Comparing the results we can see all the algorithms, besides the BSBL and the
WLM algorithms, can hardly recover these records at such few
measurements. The BSBL and WLM algorithm recovered the
segments, but the distortion of the results of WLM algorithm
was smaller.
C. Application Perspective
We further compare the performance of the WLM algorithm
with the BSBL algorithm from an application perspective. In
clinical applications, it is crucial for an ECG monitoring system
if the diagnostic features, such as P-R interval, QRS interval,
ST segment, and R amplitude, are preserved in the recovered
ECG signal. We used the measurement matrix of size 128 × 512
to encode the MIT-BIH arrhythmia dataset, and the WLM and
BSBL algorithm are employed to recover the ECG signals because they materially outperformed the other CS algorithms in
the previous experiments. Here, we study the recovered records
with the worst PRD by one algorithm and see how well they are
recovered by the other algorithm, and vice versa. In Fig. 7(a),
we plot the first 1000 time points of the six recovered records
with the worst PRD values for BSBL algorithm. Fig. 7(b) shows
the recovered records of these ECG records by WLM algorithm.
Similarly, the first 1000 time points of the six recovered records
with the worst PRD values for WLM algorithm are plotted in
Fig. 8(b), and Fig. 8(a) shows the recovered records of these
ECG records by BSBL algorithm. In both figures, the “red”
curves represent the original records and the “blue” curves are
the recovered records. Obviously, the recovered records by the
WLM algorithm almost exactly match the original records, thus
the diagnostic features can be extracted very well. By comparison, the recovered results by the BSBL algorithm have the
noticeable S-wave distortion and R amplitude distortion. Hence,
in the digital CS paradigm, the WLM algorithm is strongly recommended for EGC data recovery at low measurement rate.
D. Energy Saving
To improve the energy efficiency of a BAN-enabled ECG
monitor, it is desirable to reduce the energy consumption in
both encoding process and wireless transmission. Comparing
with the existing CS-based methods, the proposed method enables low-complexity encoding. In our experiments, each column of the 128 × 512 MMC-SBM contains only five entries
of 1s, which saves about 58% energy consumption in encoding

527

process compared to the R-SBMs with 12 entries of 1s that were
adopted by the other CS-based methods. In terms of the energy
consumption in wireless transmission, the experimental results
indicate that the proposed method can achieve satisfactory decoding quality for the MIT-BIH arrhythmia dataset with only
25% measurements, while the other CS-based methods need
to increase the number of measurements to decode the ECG
signals with the same quality level. For example, the BP algorithm and the BSBL algorithm require more than 43% and 32%
measurements, respectively, to produce the equivalent average
output PRD. Therefore, the proposed method can obtain higher
compression ratio in the applications than the other CS-based
methods, which result in a significant energy saving in wireless
transmission.
IV. CONCLUSION
In this paper, an energy-efficient CS method was developed
for on-node ECG compression. It consists of the improvements
in both encoder and decoder. First, an MMCP algorithm was
proposed and applied to construct an SBM that can encode
ECG recordings with high sensing performance and ultra-low
energy consumption. Furthermore, an WLM algorithm is derived for further reducing the measurements needed for high
fidelity decoding of ECG recordings. The proposed method
realizes energy efficiency for BAN-enabled ECG monitoring
from the aspects of minimizing energy consumption in encoding procedure and shortening the airtime over wireless links by
efficient data compression. To evaluate the performance of the
proposed method, it was applied to all of the MIT-BIH arrhythmia databases. Experimental results showed that the proposed
method performs better compared to several other CS-based algorithms. By applying the constructed 128 × 512 SBM, in which
each column contains only five nonzero entries, to encode the
ECG recordings and decoding by the WLM algorithm, the reconstructed signals of all the MIT-BIH arrhythmia recordings
almost exactly matched the original recordings and preserved
the diagnostic features. In the future work, we will investigate
the theoretic analysis and the other applications of the proposed
method.
ACKNOWLEDGMENT
The authors would like to thank the Associate Editor and the
anonymous reviewers for their valuable comments and suggestions to improve the quality of the paper.
REFERENCES
[1] R. L. Ashok and D. P. Agrawal, “Next-generation wearable networks,”
IEEE Comput. Mag., vol. 36, no. 11, pp. 31–39, Nov. 2003.
[2] M. A. Hanson, H. C. Powell, A. T. Barth, K. Ringgenberg, B. H. Calhoun,
J. H. Aylor, and J. Lach, “Body area sensor networks: Challenges and
opportunities,” IEEE Comput. Mag., vol. 42, no. 1, pp. 58–65, Jan. 2009.
[3] F. Rincón, J. Recas, N. Khaled, and D. Atienza, “Development and evaluation of multilead wavelet-based ECG delineation algorithms for embedded
wireless sensor nodes,” IEEE Trans. Inf. Technol. Biomed., vol. 15, no. 6,
pp. 854–863, Nov. 2011.
[4] T. Ma, P. L. Shrestha, M. Hempel, D. Peng, H. Sharif, and H.-H. Chen,
“Assurance of energy efficiency and data security for ECG transmission
in BASNs,” IEEE Trans. Biomed. Eng., vol. 59, no. 4, pp. 1041–1048,
Apr. 2012.

528

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

[5] S. Lee, J. Kim, and M. Lee, “A real-time ECG data compression and
transmission algorithm for an e-health device,” IEEE Trans. Biomed. Eng.,
vol. 58, no. 9, pp. 2448–2455, Sep. 2011.
[6] A. M. Dixon, E. G. Allstot, D. Gangopadhyay, and D. J. Allstot, “Compressed sensing system considerations for ECG and EMG wireless biosensors,” IEEE Trans. Biomed. Circ. Sys., vol. 6, no. 2, pp. 156–166, Apr.
2012.
[7] C. Lin, Y. Yang, and J. Wang, “A wearable sensor module with a neuralnetwork-based activity classification algorithm for daily energy expenditure estimation.,” IEEE Trans. Inf. Technol. Biomed., vol. 16, no. 5,
pp. 991–998, Sep. 2012.
[8] B. A. Rajoub, “An efficient coding algorithm for the compression of ECG
signals using the wavelet transform,” IEEE Trans. Biomed. Eng., vol. 49,
no. 4, pp. 355–362, Apr. 2002.
[9] S.-G. Miaou and S.-N. Chao, “Wavelet-based lossy-to-lossless ECG compression in a unified vector quantization framework,” IEEE Trans. Biomed.
Eng., vol. 52, no. 3, pp. 539–543, Mar. 2005.
[10] C.-T. Ku, K.-C. Hung, T.-C. Wu, and H.-S. Wang, “Wavelet-based ECG
data compression system with linear quality control scheme,” IEEE Trans.
Biomed. Eng., vol. 57, no. 6, pp. 1399–1409, Jun. 2010.
[11] D. L. Donoho, “Compressed sensing,” IEEE Trans. Inf. Theory, vol. 52,
no. 4, pp. 1289–1306, Apr. 2006.
[12] E. J. Candès, J. Romberg, and T. Tao, “Robust uncertainty principles: exact signal reconstruction from highly incomplete frequency information,”
IEEE Trans. Inf. Theory, vol. 52, no. 2, pp. 489–509, Feb. 2006.
[13] H. Mamaghanian, N. Khaled, D. Atienza, and P. Vandergheynst, “Compressed sensing for real-time energy-efficient ECG compression on wireless body sensor nodes,” IEEE Trans. Biomed. Eng., vol. 58, no. 9,
pp. 2456–2466, Sep. 2011.
[14] H. Mamaghanian, N. Khaled, D. Atienza, and P. Vandergheynst, “Structured sparsity models for compressively sensed electrocardiogram signals:
A comparative study,” in Proc. IEEE Biomed. Circuits Syst. Conf., 2011,
pp. 125–128.
[15] Z. Zhang, T.-P. Jung, S. Makeig, and B. D. Rao, “Compressed sensing
for energy-efficient wireless telemonitoring of noninvasive fetal ECG via
block sparse Bayesian learning,” IEEE Trans. Biomed. Eng., vol. 60, no. 2,
pp. 300–309, Feb. 2013.
[16] Z. Zhang and B. D. Rao, “Recovery of block sparse signals using the
framework of block sparse Bayesian learning,” in Proc. IEEE Int. Conf.
Acoust., Speech Signal Process., 2012, pp. 3345–3348.
[17] Z. Zhang and B. D. Rao, “Sparse signal recovery with temporally correlated source vectors using sparse Bayesian learning,” IEEE J. Sel. Topics
Signal Process., vol. 5, no. 5, pp. 912–926, Sep. 2011.
[18] Z. Zhang, T. Jung, S. Makeig, and B. Rao, “Compressed sensing of EEG
for wireless telemonitoring with low energy consumption and inexpensive
hardware,” IEEE Trans. Biomed. Eng., vol. 60, no. 1, pp. 221–224, Jan.
2013.
[19] E. J. Candès and M. B. Wakin, “An introduction to compressive sampling,” IEEE Signal Proc. Mag., vol. 25, no. 2, pp. 21–30, Mar. 2008.
[20] S. S. Chen, D. L. Donoho, and M. A. Saunders, “Atomic decomposition
by basis pursuit,” SIAM Rev., vol. 43, no. 1, pp. 129–159, 2001.
[21] C. Miosso, R. von Borries, M. Argàez, L. Velazquez, C. Quintero, and
C. Potes, “Compressive sensing reconstruction with prior information by
iteratively reweighted least-squares,” IEEE Trans. Signal Process., vol. 57,
no. 6, pp. 2424–2431, Jun. 2009.
[22] Y. Wang and W. Yin, “sparse signal reconstruction via iterative support
detection,” SIAM J Imag. Sci., vol. 3, no. 3, pp. 462–491, 2010.
[23] J. Tropp and A. Gilbert, “Signal recovery from random measurements via
orthogonal matching pursuit,” IEEE Trans. Inf. Theory, vol. 53, no. 12,
pp. 4655–4666, Dec. 2007.
[24] H. Rauhut, “Compressive sensing and structured random matrices,” Theoret. Found. Numer. Methods Sparse Recov., vol. 9, pp. 1–92, 2010.
[25] E. J. Candes and Y. Plan, “A probabilistic and ripless theory of compressed
sensing,” IEEE Trans. Inf. Theory, vol. 57, no. 11, pp. 7235–7254, Nov.
2011.
[26] S. Ji, Y. Xue, and L. Carin, “Bayesian compressive sensing,” IEEE Trans.
Signal Process., vol. 56, no. 6, pp. 2346–2356, Jun. 2008.
[27] T. Blumensath and M. E. Davies, “Iterative hard thresholding for compressed sensing,” Appl. Comput. Harmon. Anal., vol. 27, no. 3, pp. 265–
274, 2009.
[28] T. Blumensath and M. E. Davies, “Normalized iterative hard thresholding: Guaranteed stability and performance,” IEEE J. Sel. Topics Signal
Process., vol. 4, no. 2, pp. 298–309, Apr. 2010.
[29] T. Blumensath and M. E. Davies, “Gradient pursuits,” IEEE Trans. Signal
Process., vol. 56, no. 6, pp. 2370–2382, Jun. 2008.

[30] T. Blumensath and M. E. Davies, “Stagewise weak gradient pursuits,”
IEEE Trans. Signal Process., vol. 57, no. 11, pp. 4333–4346, Nov.
2009.
[31] J. Zhang, Z. L. Yu, Y. Li, G. N. Liu, and Z. Gu, “Weighted regularized
sparse recovery method for optical power monitoring,” IEEE Photon.
Tech. Lett., vol. 24, no. 1, pp. 55–57, Jan. 2012.
[32] D. Ingrid, Ten Lectures on Wavelets. Philadelphia, PA, USA: Society for
Industrial and Applied Mathematics, 1992.
[33] J. Bergh, F. Ekstedt, and M. Lindberg, Wavelets: Mit Anwendungen in
Signal-und Bildverarbeitung. London, U.K.: Springer-Verlag, 2007.
[34] R. Nygaard and D. Haugland, “Compressing ECG signals by piecewise
polynomial approximation,” in Proc. IEEE Int. Conf. Acoust., Speech
Signal Process., 1998, vol. 3, pp. 1809–1812.
[35] Y. Zigel, A. Cohen, and A. Katz, “The weighted diagnostic distortion
(WDD) measure for ECG signal compression,” IEEE Trans. Biomed.
Eng., vol. 47, no. 11, pp. 1422–1430, Nov. 2000.
[36] SparseLab Toolbox [Online]. Available:http://sparselab.stanford.edu/
[37] Sparsify Toolbox [Online]. Available:http://www.personal.soton.ac.uk/
tb1m08/
[38] BCS Toolbox [Online]. Available: http://people.ee.duke.edu/∼lcarin/
BCS.html
Jun Zhang received the Bachelor’s and Master’s degrees in computer science from the Xiangtan University, Xiangtan, China, in 2002 and 2005, respectively,
and the doctoral degree in pattern recognition and intelligence system from the South China University of
Technological, Guangzhou, China, in 2012.
He joined the College of Information Engineering, Guangdong University of Technology, in 2005
as a Lecturer. His research interests include the
fields of compressive sensing and biomedical signal
processing.
Zhenghui Gu (M’03) received the Ph.D. degree
from Nanyang Technological University, Singapore,
in 2003.
From 2002 to 2008, she was with Institute for
Infocomm Research, Singapore. She joined the College of Automation Science and Engineering, South
China University of Technology, in 2009 as an Associate Professor. Her research interests include the
fields of biomedical signal processing and pattern
recognition.
Zhu Liang Yu (M’06) received the B.S.E.E. and
M.S.E.E degrees both in electronic engineering in
1995 and 1998, respectively, from the Nanjing University of Aeronautics and Astronautics, Nanjing,
China. He received the Ph.D. degree from Nanyang
Technological University, Singapore, in 2006.
He joined Center for Signal Processing, Nanyang
Technological University, from 2000 as a Research
Engineer, then as a Group Leader. In 2008, he joined
the College of Automation Science and Engineering,
South China University of Technology, China. He is
promoted to be a Full Professor in 2009. His research interests include signal
processing, machine learning, computer vision and applications in biomedical
engineering.
Yuanqing Li (M’05) received the B.S. degree in applied mathematics from Wuhan University, Wuhan,
China, in 1988, the M.S. degree in applied mathematics from South China Normal University, Guangzhou,
China, in 1994, and the Ph.D. degree in control theory and applications from South China University of
Technology, Guangzhou, China, in 1997.
Since 1997, he has been with South China University of Technology, where he became a Full professor
in 2004. In 2002–2004, he worked at the Laboratory
for Advanced Brain Signal Processing, RIKEN Brain
Science Institute, Saitama, Japan, as a Researcher. In 2004–2008, he worked at
the Laboratory for Neural Signal Processing, Institute for Infocomm Research,
Singapore, as a Research Scientist. His research interests include blind signal
processing, sparse representation, machine learning, brain-computer interface,
EEG, and fMRI data analysis.

