IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

469

Estimating Oxygen Uptake During Nonsteady-State
Activities and Transitions Using Wearable Sensors
Marco Altini, Julien Penders, and Oliver Amft

Abstract—In this paper, we present a method to estimate oxygen
uptake (V O2 ) during daily life activities and transitions between
them. First, we automatically locate transitions between activities
and periods of nonsteady-state V O2 . Subsequently, we propose
and compare activity-specific linear functions to model steadystate activities and transition-specific nonlinear functions to model
nonsteady-state activities and transitions. We evaluate our approach in study data from 22 participants that wore a combined accelerometer and heart rate sensor while performing a wide range of
activities (clustered into lying, sedentary, dynamic/household, walking, biking and running), including many transitions between intensities, thus resulting in nonsteady-state V O2 . Indirect calorimetry
was used in parallel to obtain V O2 reference. V O2 estimation
error during transitions between sedentary, household and walking
activities could be reduced by 16% on average using the proposed
approach, compared to state of the art methods.
Index Terms—Accelerometers, energy expenditure, heart rate,
nonsteady-state, VO2 .

I. INTRODUCTION
BIQUITOUS sensing technologies that objectively and
noninvasively monitor human behavior, started to provide insights into the relation between physical activity (PA)
and health. Among the parameters used to objectively quantify PA, energy expenditure (EE) is the most commonly used
single metric [1]–[3]. The measurement of steady-state oxygen
uptake (V O2 ) is considered to be the gold standard for estimating EE during light to moderate steady-state exercise [4], [5],
where aerobic pathways are predominant. In this context, V O2
measurements are proportional to metabolic heat production [4].
Due to the practical limitations of measuring V O2 in free living,
different methods to estimate V O2 using miniaturized wearable
sensors have been developed in the past.
V O2 estimation methods are typically based on activityspecific linear regressions developed using steady-state data and
therefore can describe the variations within each modeled activity during steady state. However, transitions to activities with
other V O2 levels cannot be accurately estimated, since V O2
dynamics differ during steady-state and nonsteady-state periods. Proper modeling of nonsteady-state transitions including

U

Manuscript received July 23, 2014; revised November 30, 2014; accepted
January 7, 2015. Date of publication January 12, 2015; date of current version
March 3, 2016.
M. Altini is with Bloom Technologies, 3590 Diepenbeek, Belgium, and also
with the Eindhoven University of Technology, 5612 AZ Eindhoven, The Netherlands (e-mail: marco.altini@imec-nl.nl).
J. Penders is with the Holst Centre/imec, 5656 AE Eindhoven, The Netherlands (e-mail: julien.penders@imec-nl.nl).
O. Amft is with the University of Passau, 94032 Passau, Germany, and
also with the Eindhoven University of Technology, 5612 AZ Eindhoven, The
Netherlands (e-mail: amft@ieee.org).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2390493

transitions of activity types (e.g., sitting to walking) and activity intensities (e.g., walking at different speed) are necessary in
order to provide accurate V O2 estimation in free living conditions. Accurate identification of nonsteady-state periods as well
as quantifications of V O2 during transitions could improve EE
estimation because during nonsteady-state periods total EE is
composed of aerobic and anaerobic components. [4]. Earlier
work on V O2 transitions analysis focused mainly on postexercise oxygen consumption (EPOC) [6], or V O2 estimation for
single activities [7], [8]. However, nonsteady-state V O2 is very
frequent during varying low intensities activities of daily living
(ADLs). Studies showed that most activities performed in free
living last shorter than the time needed to reach steady state.
For example, 60% of all walking bouts last shorter than 30 s
[9]. Identifying nonsteady-state V O2 can provide more insights
on the aerobic and anaerobic dynamics during the onset of exercise as well as during ADLs characterized by short duration.
While solutions have been proposed to model nonsteady-state
V O2 for specific activities [7], [8] or transitions [6], a unified
approach able to continuously estimate V O2 is missing. Thus,
we propose a novel V O2 estimation method, which combines
activity-specific V O2 estimation using linear regression, with
nonsteady-state detection and transition-specific V O2 estimation using nonlinear equations.
This paper provides the following contributions:
1) We introduce a method to automatically locate periods of
nonsteady-state V O2 by analyzing the coefficient of variation (CV) of the predicted V O2 . Using the CV allows
for detection of transition both between and within activities. Then, we compare linear, exponential and logistic
transfer functions to model nonsteady-state V O2 during
individual transition types.
2) We evaluate the proposed approach on a dataset acquired
from 22 participants performing a wide set of physical
activities, including many transitions between activities
and changes of intensity within activities. We show that the
transition-specific modeling could reduce V O2 estimation
error by 16% during activity transitions, compared to state
of the art methods.
II. RELATED STUDY
Accelerometer and HR monitors are the most commonly used
single sensor devices in epidemiological studies. Accelerometers use features representative of whole body motion, as independent variables in the linear regression model developed to
predict EE. However, there are limitations due to the inability
of a single linear model to fit all activities, since the slope and
intercept of the regression model change based on the activity

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

470

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

performed while data is collected [3]. On the other hand, the high
correlation between HR and EE within one individual changes
substantially between individuals [1]. The latest EE estimation
algorithms extended approaches based on simple linear regression models performing activity recognition over a predefined
set of activities, and then applying different methods—typically
regression models—to predict EE, based on the activity [2], [3].
The regression models use accelerometer features and anthropometric characteristics as independent variables. Some authors
included HR features as well in the activity-specific linear models, showing consistent improvements in EE estimation accuracy
compared to algorithms using accelerometer only features [1].
However, none of these models explicitly models nonsteadystate V O2 .
A. Nonsteady-State V O2 Estimation
Nonsteady-state EE is often defined as periods of time where
V O2 and carbon dioxide production vary by more than 5%–
10% [10]. Previous research on nonsteady-state V O2 focused
mainly on metabolic responses to exercise (EPOC, see [6]).
However, V O2 estimation is intrinsically a temporal problem
and nonsteady-state V O2 is very common during low intensity
ADLs as well. While V O2 increases rapidly, normally reaching
steady state within 1–4 min, most activities performed in free
living last less than the time required to reach steady state [9].
Most EE models are developed deriving EE from V O2 , and
discarding the first 1 or 2 min of data [1], [3], to isolate steady
state. Thus, the predictions of these models will be negatively
affected by the real life nature of ADL activities. Other models
incorporate nonsteady-state V O2 but without providing details
on the models accuracy during transitions [11], thus limiting
our understanding of the models performance in nonsteady-state
conditions. Using physiological data to predict V O2 involves
slower dynamics present in both physiological changes (e.g.,
HR slowing increasing) and aerobic pathways (V O2 reaching
steady state). However, these dynamics are different, typically
with HR being much slower than V O2 [12], [13].
Few attempts to model nonsteady-state V O2 are found in
the literature [14]–[16], [7], [8]. In [14], [15], the proposed
system relies on HR data only, suffering from all limitations
of nonactivity-specific models, while [7], [8] analyzed walking
data only. In [16], the authors used monoexponential functions
to better capture the relation between movement and EE during
transitions between activities. However, the EE prediction ignores the fact that during nonsteady-state EE cannot be derived
from V O2 alone, since total EE is composed of both aerobic
(estimated via V O2 ) and anaerobic components. Finally,
one single monoexponential equation might not be sufficient
to model energy deficit and energy debt situations between
different activities [5]. While solutions have been proposed to
model nonsteady-state V O2 for specific activities [7], [8] or
transitions [6], a unified approach able to continuously estimate
V O2 is missing.

Fig. 1. Example of nonsteady-state V O 2 . (a) Nonsteady state reference V O 2 .
(b) Predicted V O 2 as estimated by steady-state activity-specific models. In this
study, nonsteady state modeling is used combined with classic steady-state
models to better estimate actual VO2.

Fig. 2. Block diagram of out approach using activity-specific linear models
and transition-specific nonlinear functions to estimate VO2. Features are used
for activity recognition and activity-specific V O 2 models. Activity recognition
is used to select the proper activity-specific or transition-specific model.

Our approach combines detection of nonsteady-state V O2 ,
activity-specific linear models and nonsteady state transitionspecific nonlinear functions. Fig. 1 shows typical nonsteady
state dynamics in ADLs, such as transitions between sedentary
activities (e.g., sitting or standing), walking and then sedentary
again. Fig. 1(b) shows color-coded activities as detected by an
activity recognition system, while Fig. 1(a) shows steady-state
and nonsteady-state-data. Nonsteady-state V O2 is present when
the participant starts walking and when the participant stops
walking. Fig. 1(a) shows measured V O2 while Fig. 1(b) shows
V O2 as predicted by state of the art activity specific models.
Prediction models [see Fig. 1(b)] jump between one value to the
other as soon as a new activity starts, while transitions shown in
Fig. 1(a) are much slower. Thus, a different modeling technique
is required during nonsteady state.
A. Estimation Architecture

III. ANALYSIS AND ESTIMATION APPROACH

V O2 predictions are generated by a sequence of steady-state
and nonsteady-state models (see, e.g., Fig. 2)

This section describes the problem of nonsteady-state V O2
estimation and our approach to such problem.

. . . W1 , V1 , W2 , V2 , W1 , V3 . . .

ALTINI et al.: ESTIMATING OXYGEN UPTAKE DURING NONSTEADY-STATE ACTIVITIES AND TRANSITIONS USING WEARABLE SENSORS

471

where Wi are activity-specific models used when steady state is
detected and Vi are transition-specific nonsteady-state models
used when nonsteady state is detected. Each state Wi or Vi
comprises t predictions based on the time spent in a specific
activity or transition duration
i
Wi
Wi = {V O2W
S S 1 , . . . , V O2S S t }

Vi = {V O2VN iS 1 , . . . , V O2VN iS t }.
In the following sections, we describe Wi , Vi and model
selection.
1) Activity-Specific Steady-State Models—Wi : Wi are composed of two parts: activity recognition and activity-specific
multiple linear regression equations. Assuming n clusters of
activities
C = {c1 , . . . , cn }∀ci ∈ C,

∃ Wi

where the parameters of the activity-specific model Wi are
derived from V O2 values for a specific cluster of activities ci
i
V O2W
SS = Xact i βact i + .

(1)

β is the vector of regression coefficients, and Xact i is the vector of input features. Features are grouped into accelerometer,
physiological and anthropometric features (see Fig. 2).
2) Transition-Specific Nonsteady-State Models—Vi : We
compare linear, exponential and logistic functions as Vi . Assuming r types of transitions
Tr = {tr1 , . . . , trr } ∀tri ∈ Tr,

Linear functions: For a transition type Vi from steady-state
Wj to steady-state Wk , a linear model is derived as follows:
(2)

where V O2VNSi are target V O2 values during nonsteady state for
the transition Vi , defined by transition-specific linear functions.
The predictor t is the time elapsed since the transition started.
j
V O2W
SS is the V O2 of the steady state before the transition
(Wj ). Parameters α and β are the slope and intercept of the
linear model.
Logistic functions: For a transition type Vi , a nonlinear model
is derived as follows:
θ1
j
V O2VNSi =
+ V O2W
(3)
V i
V i
SS + 
−(θ
1 + exp 2 +θ 3 t)
where V O2VNSi are target V O2 values during nonsteady state
for the transition Vi , defined by transition-specific logistic functions. The predictor t is the time elapsed since the transition
j
started. V O2W
SS is the V O2 of the steady state before the transition (Wj ). Transitions between activities of different type and
intensity will have different dynamics [5], [17], thus require
transition-specific functions. The parameter θ1 is the asymptote
of the logistic function, and can be automatically derived as the
difference between the steady-state V O2 before (Wj ) and after
(Wk ) the transition
Wj
k
θ1 = V O2W
SS − V O2SS .

each transition type. Thus, θ2V i and θ3V i are transition-specific.
The transition type (i.e., Vi ) depends on the activities recognized
by the activity recognition system during steady-states Wj and
Wk .
Exponential functions: A transition model for a transition
type Vi is derived as follows:
j
V O2VNSi = θ1 − expα +β t + V O2W
SS + 

(5)

O2VNSi

∃ Vi .

j
V O2VNSi = α + βt + V O2W
SS + 

Fig. 3. Example waveform of the CV of the estimated V O 2 for a sequence
of sedentary, walking and sedentary activities. State is nonsteady when C V >
15%. The CV captures transitions between activities as well as within activities,
thus detecting nonsteady-state V O 2 .

(4)

Parameters θ2V i and θ3V i control the shape of the logistic curve
(e.g., the transition speed), and were determined by fitting for

where V
are target V O2 values for the transition Vi , defined by transition-specific exponential functions. The predictor
j
t is the time elapsed since the transition started. V O2W
SS is the
V O2 of the steady state before the transition (Wj ). The parameter θ1 is the same as for the logistic function, indicating the
asymptote of the exponential, and can be automatically derived
as shown in (4).
3) Model Selection: Nonsteady state is detected using the
CV of the predicted V O2 over the last minute of data, according
to a preselected threshold
σV O2 S S
(6)
CVV O2 S S =
μV O2 S S
where σV O2 S S and μV O2 S S are the standard deviation and mean
of a 60-s sliding window of predicted V O2 values. Nonsteady
state is detected if CVV O2 S S > CVThres , where CVThres was
set to 15%. Fig. 3 shows the CV for the predicted V O2 data.
CV can be used to locate nonsteady states, such as when activity
intensity changes, thus even when there is no transition between
two activities.
IV. EVALUATION STUDY
A. Participants and Data Acquisition
Participants were 22 (17 male, five female), mean age
30.4 ± 5.7 years, mean weight 71.2 ± 12.4 kg, mean height
1.76 ± 0.09 m, mean BMI 23.0 ± 2.8 kg/m2 . Imec’s IRB approved the study. Each participant signed an informed consent
form. The sensor platform used was the ECG Necklace, a wearable sensor acquiring one lead ECG data at 256 Hz, and threeaxial accelerometer data at 32 Hz. Activity type was annotated

472

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

manually by experimenter. Breath-by-breath data were collected
using the Cosmed K4b2 indirect calorimeter. We interpolated
calorimeter data at 0.25 Hz to align it with the ECG Necklace data, and applied a moving average with window size four
elements to reduce high frequency noise.

capture the repetitive patterns of some activities (e.g., walking or
running). Given the positive results in past research on activity
recognition, we selected support vector machines (SVMs) as
classifiers. For the SVMs, we used a polynomial kernel with
degree five (λ = 10, C = 1).

B. Experiment Design

C. Activity-Specific Steady-State Models—Wi

Participants reported at the lab after refraining from drinking,
eating and smoking in the two hours before the experiment.
Activities were grouped into six clusters to be used for
activity classification. The six clusters were lying (lying down),
sedentary (sitting, standing, desk work, reading, writing, PC
work), dynamic (stacking groceries, washing dishes, cleaning,
sweeping, vacuuming), walking (treadmill flat at 3,4,5,6 km/h,
inclined 3%–5%, 3–5 km/h), biking (cycle ergometer, low
medium and high resistance level), running (treadmill 7,8,9,
and 10 km/h). Activities were carried out for a period of at
least 4 min, with the exception of running (1 to 4 min). All
transitions were manually annotated.

Within one activity cluster, V O2 can be estimated using features representative of V O2 changes within the activity cluster
[1], [3]. We used the mean of the absolute signal to model
changes in intensity within an activity, together with HR. Anthropometrics features (body weight and resting metabolic rate,
estimated with the Harris–Benedict formula) were added depending on the activity cluster.

C. Statistics and Performance Measure
Models were derived using leave-one-participant-out cross
validation. The same training set, consisting of data from all
participants but one, was used to perform feature selection, activity recognition, activity-specific V O2 estimation and transitionspecific V O2 estimation models. The data from the remaining
participant were used for validation. This procedure was repeated n (n = number of participants) times, and results were
averaged. All parameters used in transition-specific functions
were determined in the same way, no data used for model building was used for model evaluation. Performance of the activity
recognition models was evaluated using the class-normalized
accuracy. Results for V O2 estimates are reported in terms of
root-mean-square error (RMSE), where the outcome variable
was V O2 in ml/kg/min. Paired t-tests were used to compare
RMSE between models.
V. IMPLEMENTATION
A. Features Extraction and Selection
Features extracted from the sensors’ raw data were used to
derive activity recognition and V O2 estimation models. Activity
recognition was performed to classify the six activity clusters introduced in Section IV-B. Accelerometer data were segmented
in 4-s windows, bandpass filtered between 0.1 and 10 Hz, to
isolate the dynamic component caused by body motion, and
low-pass filtered at 1 Hz, to isolate the static component, due to
gravity. Feature selection for activity type recognition was based
on mutual information. The final feature set included: mean of
the absolute signal, interquartile range, median, variance, main
frequency peak, low and high frequency band signal power.
Feature selection for V O2 estimation was based on how much
variation in V O2 each feature could explain within one cluster.
The process was automated using linear forward selection.
B. Activity Recognition
We selected a time window of 4 s, which is short enough
to detect short breaks in sedentary time, and long enough to

D. Nonsteady-State Detection
The CV over one minute windows was computed to locate
nonsteady-state segments of data. When the CV was higher
than CVThres , a new nonsteady-state transition was detected.
CVThres was derived from the previous literature on detection
of nonsteady-state V O2 , and empirically cross validated on our
dataset, since no definition of nonsteady state is widely accepted
[10]. Once a nonsteady-state transition Vi was detected between
two steady-states Wj and Wk , the system compared the steadystate V O2 levels and enables the nonsteady-state models only
if the difference in V O2 was greater than a threshold. This filter
avoids activating the nonsteady-state models for transitions that
are too small or short.
E. Transition-Specific Nonsteady-State Models—Vi
Transition-specific nonsteady-state models Vi were developed for the most common transitions. More specifically, logistic functions were derived by fitting the parameters θ2
and θ3 while linear and exponential functions were derived
by fitting the parameters α and β of the respective models, for the following transitions: sedentary to walking (SW),
walking to sedentary (WS), sedentary to dynamic/household
(SD), dynamic/household to sedentary (DS), walking fast to
walking slow (WWDOWN), walking slow to walking fast
(WWUP). Data used for model development were not used for
validation.
VI. RESULTS
We report results for activity recognition, activity-specific
steady-state models, nonsteady-state detection and transitionspecific nonsteady-state models, together with summary statistics on the specific transitions considered in this study. An
example of the proposed method applied to a transition between
sedentary behavior and walking is shown in Fig. 4.
A. Activity Recognition
Activity recognition accuracy was 94% on average across all
participants using the validation procedure detailed in Section
IV-C. More specifically, accuracy was 100% for lying down,
96% for sedentary, 81% for dynamic/household, 99% for walking, 91% for biking and 98% for running.

ALTINI et al.: ESTIMATING OXYGEN UPTAKE DURING NONSTEADY-STATE ACTIVITIES AND TRANSITIONS USING WEARABLE SENSORS

Fig. 4. Example of the results obtained when combining activity-specific
steady state models and transition-specific nonsteady-state models (Act-Spec
ACC-HR + Logistic), as proposed by our method, for a transition between
sedentary to walking and walking to sedentary. Act-Spec ACC-HR show the
inability of steady-state models to predict V O 2 accurately during transitions.

473

Fig. 6. RMSE for V O 2 estimation using different methods for nonsteadystate data. While standard activity-specific models that combine acc and HR
(Act-Spec ACC+HR) perform better than other models during steady state (see
Fig. 5), they offer poor performance during transitions. Linear, exponential and
logistic functions progressively reduce RMSE, with logistic functions providing
the lowest errors. Logistic generic refers to logistic functions were parameters
did not vary depending on the transition type.

to sedentary activities (100%). Transition detection accuracy
dropped to 78% and 84% for transitions between sedentary
to dynamic/household and dynamic/household to sedentary, respectively. Transitions in V O2 within activities (e.g., following
changes in walking speed or inclination), that were smaller than
1 ml/kg/min were not considered. All other within activities
transitions were correctly identified (100%).
Fig. 5. RMSE for V O 2 estimation using different sensing modalities and
methods for steady-state data. Activity-specific (Act-Spec) models outperform
all others, combined accelerometer and heart rate (ACC-HR) data improves
performance compared to accelerometer (ACC) or heart rate (HR) only.

B. Activity-Specific Steady-State Models
RMSE for activity-specific steady-state V O2 estimation
models using combined accelerometer and HR data was
3.5 ml/kg/min. More specifically, RMSE was 1.16 ml/kg/min
for lying down, 1.75 ml/kg/min for sedentary, 3.93
ml/kg/min for walking, 4.55 ml/kg/min for dynamic/household,
4.24 ml/kg/min for biking and 5.81 ml/kg/min for running.
Similarly to what was reported in the literature for EE
estimation models, activity-specific V O2 estimation models
combining accelerometer and HR data outperformed single
regression models relying on accelerometer only (46% RMSE
reduction, p = 4e−11 < α), HR only (23% RMSE reduction,
p = 0.0002 < α), combined accelerometer and HR data (17%
RMSE reduction, p = 0.001 < α) and activity-specific estimation models relying on accelerometer data only (10% RMSE
reduction, p = 0.002 < α). Fig. 5 provides an overview.
C. Nonsteady-State Detection
221 transitions were analyzed in total (45 SW, 28 WS, 42 SD,
53 DS, 39 WWUP, 14 WWDOWN). 85% of all transitions were
correctly identified by the transition detection system. Transition
detection was more accurate for transitions between sedentary
to walking activities (98%) and for transitions between walking

D. Transition Types
There was a significant relation between transition time and
V O2 change between the starting and target activities during a
transition (correlation coefficient r = 0.68, p = 0.0015 < α).
V O2 difference between the starting and target activities during
a transition was 6.40 ml/kg/min for SW , 9.25 ml/kg/min for
W S, 7.47 ml/kg/min for SD, 7.46 ml/kg/min for DS, 4.38
ml/kg/min for W W U P and 5.80 ml/kg/min for W W DOW N .
Average transition duration was 97 s for SW , 108 s for W S,
88 s for SD, 98 s for DS, 87 s for W W U P and 125 s for
W W DOW N . V O2 estimation error for steady-state models
during transitions involving sedentary and household activities
was 4.62 ml/kg/min (SD) and 4.50 ml/kg/min (DS), even
though error during steady state was only 1.75 ml/kg/min for
sedentary and 4.55 ml/kg/min for household. V O2 estimation
error for steady-state models during transitions involving sedentary and walking activities was 5.63 ml/kg/min (SW ) and 4.23
ml/kg/min (W S), even though error during steady state was only
1.75 ml/kg/min for sedentary and 3.93 ml/kg/min for walking.
E. Transition-Specific Nonsteady-State Models
Fig. 6 shows V O2 RMSE during transitions for the best
performing steady-state models (i.e., activity-specific models
combining accelerometer and HR data) and nonsteady-state
models. V O2 RMSE during transitions for steady-state
models was 4.38 ml/kg/min. Linear models reduced RMSE
to 4.27 ml/kg/min (3% RMSE reduction, p = 0.5 > α),
exponential functions to 4.07 ml/kg/min (7% RMSE reduction,

474

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
V O 2 RMSE FOR TRANSITIONS MODELS CONSIDERING PERFECT TRANSITION DETECTION (ML/KG/MIN)
Transition
Sedentary to walking (SW)
Walking to sedentary (WS)
Sedentary to dynamic (SD)
Dynamic to sedentary (DS)
Walking slow to fast (WWUP)
Walking fast to slow (WWDOWN)
Mean

Activity-Specific

Linear

Exponential

Logistic

Logistic Generic

5.42 ± 1.46
3.84 ± 1.12
4.28 ± 1.25
4.20 ± 1.48
4.10 ± 2.06
4.03 ± 2.17
4.38 ± 0.80

5.79 ± 1.86
4.10 ± 1.62
3.81 ± 1.54
3.17 ± 1.43
4.97 ± 2.43
3.69 ± 2.32
4.27 ± 1.05

4.67 ± 3.18
3.26 ± 2.60
4.07 ± 1.99
3.32 ± 1.28
3.15 ± 1.79
4.87 ± 3.01
4.07 ± 1.28

4.27 ± 2.20
2.43 ± 1.59
3.30 ± 1.29
3.57 ± 1.31
4.05 ± 2.10
4.4 ± 2.28
3.68 ± 1.10

4.94 ± 2.40
2.48 ± 1.33
3.29 ± 1.36
3.42 ± 1.23
4.06 ± 2.10
3.95 ± 2.14
3.77 ± 1.03

p = 0.2 > α), and logistic functions to 3.68 ml/kg/min (16%
RMSE reduction, p = 0.0007 < α). Thus, logistic functions
were the best performing nonsteady-state models for activities
transitions. For comparison, we evaluated logistic functions
were parameters were not fitted to specific transitions, but were
held constant for all transitions, denoted as logistic generic in
Fig. 6 and Table I. Logistic generic results were V O2 RMSE
of 3.77 ml/kg/min (14% RMSE reduction, p = 0.002 < α).
VII. DISCUSSION
In this paper, we introduced a method to estimate V O2 during ADLs. Our method combines nonsteady-state detection and
transition-specific V O2 estimation nonlinear equations.
It is misleading to assume that EE can be derived from V O2
alone. Proper modeling of nonsteady-state transitions is important since both anaerobic and aerobic EE result in heat production, which is the true EE. However, only aerobic EE results in
V O2 consumption. To tackle nonsteady-state V O2 estimation,
we proposed a method to locate periods of nonsteady-state V O2
using the CV over the predicted V O2 level. Our results showed
that the CV can be used for detecting transitions between and
within activities. Then, we showed that modeling nonsteadystate transitions using nonlinear logistic functions for individual
transition types could reduce V O2 estimation error by 16%.
A. Activity Recognition and Transition Detection
In previous research, both unsupervised and supervised methods for activity recognition were proposed in the context of V O2
estimation, with supervised methods providing better results
[18]. For this reason, we opted for supervised methods typically
able to provide good accuracy on big clusters of activities as confirmed by our results, where 94% average accuracy was obtained
in leave-one-participant-out validation design. Transition detection was highly accurate for all transitions including the walking
activity (98%–100%). However, transition detection was less
accurate for transitions involving dynamic/household activities
(78%–84%), since these activities are both more difficult to
recognize and highly variable in V O2 . In the literature, several
approaches have been proposed to detect transitions between activities [19], [20]. Detecting transitions based on the CV of the
predicted V O2 provides the advantage to detect not only transitions between activities, but also changes in intensity within the
same activity (e.g., walking at a lower speed). Various definitions of steady state have been reported [10]. Some researchers
defined steady state as five consecutive 1-min intervals where
O2 consumption changes by less than 10%. However, this defini-

tion resulted from assessments of basal metabolic rate and is not
directly applicable to free living conditions, where we are interested in detecting much shorter transitions. Our analysis shows
that one minute windows and a slightly less strict CV (i.e., 15%),
are a good tradeoff for nonsteady state and transitions detection.
B. Transition-Specific Nonsteady-State Models
Our analysis focused on sedentary, dynamic/household and
walking activities, since our objective is to improve V O2 estimation in common transitions during ADLs, where current
methods lack proper modeling.
Thus, we have not considered transitions during intense activities (e.g., biking or running), which are less frequent in daily
life and well studied in the literature. The ADLs considered are
characterized by similar levels of V O2 for both the starting and
target activity of a transition. Thus, the V O2 changes during a
transition and the time required to reach steady state are similar. While parameters differ between transitions, and transitionspecific logistic functions provided the best results, generic logistic functions which do not vary parameters based on the transition were sufficient to significantly reduce RMSE compared
to steady-state models (14% RMSE reduction, p = 0.002 < α).
Logistic functions were proposed in the literature to model HR
recovery after intense exercise [21], due to the ability to model
different dose-response relationships between two relatively stable levels. While we applied this technique to model transitory
oxygen uptake during ADLs, the methodology could be extended to other physiological parameters undergoing similar
changes. For comparison, we also fitted linear and exponential
functions, as previously reported in the literature [16]. However,
we found suboptimal results compared to logistic functions.
Another advantage of the proposed technique is that at runtime V O2 estimations during transitions are only dependent on
the previously fitted parameters and on the parameter θ1 , representing the difference in V O2 between the starting and the target
activity. Thus, these models could be applied to systems based
on accelerometers only, and do not depend on other predictors
or sensing modalities.
Performance of nonsteady-state V O2 models should be assessed outside of the lab [22]. However, there is currently
no unobtrusive reference system that is able to measure
breath-by-breath V O2 in unconstrained settings. Only by using indirect calorimetry and supervised settings we can record
data, which allows us to analyze how nonsteady-state models
can improve V O2 estimations during transitions. In our evaluation protocol, we could not elicitate abrupt V O2 changes within

ALTINI et al.: ESTIMATING OXYGEN UPTAKE DURING NONSTEADY-STATE ACTIVITIES AND TRANSITIONS USING WEARABLE SENSORS

one activity, e.g., when changing the treadmill speed and inclination level, there was a gradual change, which could last up
to 30 s. Hence, it was difficult to even collect representative
data that could benefit from nonsteady-state modeling within an
activity (e.g., walking at different speeds) and the V O2 estimation did not provide improvements over the steady state. A set
of thirty activities of varying intensities was used in this study
and further work could extend the set, for example including
activities involving carrying loads. However, we believe that the
lifestyle activities used here are representative and relevant to
assess V O2 estimation in nonstationary daily life conditions.
The generalized method proposed in this study is able to model
abrupt within-activity changes in V O2 without modifications to
the model, since it detects transitions relying on the CV, instead
of the activity type. While it is not feasible for us to robustly detect activities such as carrying a weight using a wearable sensor
on the chest, the use of HR partially solves the problem. Carrying a load would create higher strain, thus raise HR, which
is used in the estimation models, and therefore result in higher
predicted V O2 . In this study, CV changes were shown to even
indicate intensity changes within the same activity confirming
the method’s sensitivity. By properly modeling V O2 during
transitions and locating periods of nonsteady state, we quantified V O2 for aerobic dynamics during the onset of exercise, as
well as during ADLs characterized by short duration, with 16%
error reduction compared to current methods.
REFERENCES
[1] M. Altini, J. Penders, and O. Amft, “Personalizing energy expenditure
estimation using a cardiorespiratory fitness predicate,” in Proc. 7th Int.
Conf. Pervasive Comput. Technol. Healthcare, 2013, pp. 65–72.
[2] A. G. Bonomi. (2009). Improving assessment of daily energy expenditure by identifying types of physical activity with a single accelerometer.
Journal of Applied Physiology [Online]. 107(3), pp. 655–661. Available:
http://www.ncbi.nlm.nih.gov/pubmed/19556460
[3] E. Tapia, “Using machine learning for real-time activity recognition and
estimation of energy expenditure,” Ph.D. dissertation, Dept. Archit. Program Media Arts Sci., Massachusetts Inst. Technol., Cambridge, MA,
USA, 2008.
[4] C. B. Scott, “Contribution of anaerobic energy expenditure to whole body
thermogenesis,” Nutr. Metab., vol. 2, pp. 14–23, 2005.
[5] K. Wasserman, A. L. Van Kessel, and G. G. Burton, “Interaction of physiological mechanisms during exercise,” J. Appl. Physiol., vol. 22, no. 1,
pp. 71–85, 1967.
[6] K. R. Short and D. A. Sedlock, “Excess postexercise oxygen consumption
and recovery rate in trained and untrained subjects,” J. Appl. Physiol.,
vol. 83, no. 1, pp. 153–159, 1997.
[7] S. W. Su, L. Wang, B. G. Celler, and A. V. Savkin, “Oxygen uptake
estimation in humans during exercise using a hammerstein model,” Ann.
Biomed. Eng., vol. 35, no. 11, pp. 1898–1906, 2007.
[8] S. W. Su, B. G. Celler, A. V. Savkin, H. T. Nguyen, T. M. Cheng, Y. Guo,
and L. Wang, “Transient and steady state estimation of human oxygen
uptake based on noninvasive portable sensor measurements,” Med. Biol.
Eng. Comput., vol. 47, no. 10, pp. 1111–1117, 2009.
[9] M. S. Orendurff, J. A. Schoen, G. C. Bernatz, A. D. Segal, and G. K. Klute,
“How humans walk: Bout duration, steps per bout, and rest duration,”
J. Rehabil. Res. Dev., vol. 45, no. 7, pp. 1077–1089, 2008.
[10] M. M. Reeves, P. S. Davies, J. Bauer, and D. Battistutta, “Reducing the time
period of steady state does not affect the accuracy of energy expenditure
measurements by indirect calorimetry,” J. Appl. Physiol., vol. 97, no. 1,
pp. 130–134, 2004.
[11] J. Wang, S. J. Redmond, M. Voleno, M. R. Narayanan, N. Wang, S. Cerutti,
and N. H. Lovell, “Energy expenditure estimation during normal ambulation using triaxial accelerometry and barometric pressure,” Physiol. Meas.,
vol. 33, no. 11, pp. 1811–1830, 2012.

475

[12] T. Yoshida and B. J. Whipp, “Dynamic asymmetries of cardiac output
transients in response to muscular exercise in man,” J. Physiol., vol. 480,
no. 2, pp. 355–359, 1994.
[13] J. Smolander, T. Juuti, M.-L. Kinnunen, K. Laine, V. Louhevaara,
K. Männikkö, and H. Rusko, “A new heart rate variability-based method
for the estimation of oxygen consumption without individual laboratory
calibration: Application example on postal workers,” Appl. Ergonom.,
vol. 39, no. 3, pp. 325–331, 2008.
[14] A. Pulkkinen, J. Kettunen, K. Martinmäki, S. Saalasti, and H. Rusko,
“On–and off dynamics and respiration rate enhance the accuracy of heart
rate based vo2 estimation,” in Proc. ACSM Congr., 2004, vol. 36.
[15] L. R. Dugas, L. van der Merwe, H. Odendaal, T. D. Noakes, and
E. V. Lambert, “A novel energy expenditure prediction equation for intermittent physical activity,” Med. Sci. Sports Exercise, vol. 37, no. 12,
pp. 2154–2161, 2005.
[16] F.-C. Chuang, Y.-T. C. Yang, and J.-S. Wang, “Accelerometer-based energy expenditure estimation methods and performance comparison,” in
Proc. 2nd Int. Conf. Advances Comput. Sci. Eng., 2013, pp. 99–103.
[17] E. Børsheim and R. Bahr, “Effect of exercise intensity, duration and mode
on post-exercise oxygen consumption,” Sports Med., vol. 33, no. 14,
pp. 1037–1060, 2003.
[18] S. Chen, J. Lach, O. Amft, M. Altini, and J. Penders, “Unsupervised activity clustering to estimate energy expenditure with a single body sensor,”
in Proc. IEEE Int. Conf. Body Sens. Netw., 2013, pp. 1–6.
[19] R. Ali, L. Atallah, B. Lo, and G.-Z. Yang, “Detection and analysis of
transitional activity in manifold space,” IEEE Trans. Inform. Technol.
Biomed., vol. 16, no. 1, pp. 119–128, Jan. 2012.
[20] C. Zhu and W. Sheng, “Recognizing human daily activity using a single
inertial sensor,” in Proc. 8th World Congr. Intell. Control Autom., 2010,
pp. 282–287.
[21] N. Christenfeld, L. M. Glynn, and W. Gerin, “On the reliable assessment
of cardiovascular recovery: An application of curve-fitting techniques,”
Psychophysiology, vol. 37, no. 4, pp. 543–550, 2000.
[22] L. Bouarfa, L. Atallah, R. M. Kwasnicki, C. Pettitt, G. Frost, and
G.-Z. Yang, “Predicting free-living energy expenditure using a miniaturized ear-worn sensor: An evaluation against doubly labelled water,”
IEEE Trans. Biomed. Eng., vol. 61, no. 2, pp. 566–575, Nov. 2014.
Marco Altini received the M.Sc. degree in engineering and computer science from the University
of Bologna, Bologna, Italy, in 2010. He is currently
working toward the Ph.D. degree at the Technical
University of Eindhoven, Eindhoven, The Netherlands.
His current research interests include machine
learning techniques for the development and implementation of biomedical applications using wearable
sensors data.
Julien Penders received the M.Sc. degree in systems
engineering from the University of Liege, Liege, Belgium, and the M.Sc. degree in biomedical engineering from Boston University, Boston, MA, USA, in
2004 and 2006, respectively.
He is currently the Program Manager with the
Holst Centre/IMEC, Eindhoven, The Netherlands. He
has authored or coauthored more than 30 papers in
journals and conference proceedings on body area
networks and autonomous wireless sensor networks.
Oliver Amft received the M.Sc. degree from TU
Chemnitz, Chemnitz, Germany, in 1999, and the
Ph.D. degree from ETH Zurich, Zurich, Switzerland,
in 2008, both in electrical engineering and information technology.
He is a Full Professor (W3) and Chair of Sensor Technology at the University of Passau, Passau,
Germany. He is also affiliated with the Wearable
Computing Lab, ETH Zurich, and the Signal Processing Systems Section, TU Eindhoven, Eindhoven,
The Netherlands. He is interested in multimodal activity recognition and human behaviour inference algorithms and has coauthored
more than 90 publications in this field.

