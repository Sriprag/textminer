82

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

Single-Trial Visual Evoked Potential Extraction
Using Partial Least-Squares-Based Approach
Duma Kristina Yanti, Mohd Zuki Yusoff, and Vijanth Sagayan Asirvadam, Member, IEEE

Abstract—A single-trial extraction of a visual evoked potential
(VEP) signal based on the partial least-squares (PLS) regression
method has been proposed in this paper. This paper has focused
on the extraction and estimation of the latencies of P100, P200,
P300, N75, and N135 in the artificial electroencephalograph (EEG)
signal. The real EEG signal obtained from the hospital was only
concentrated on the P100. The performance of the PLS has been
evaluated mainly on the basis of latency error rate of the peaks for
the artificial EEG signal, and the mean peak detection and standard
deviation for the real EEG signal. The simulation results show that
the proposed PLS algorithm is capable of reconstructing the EEG
signal into its desired shape of the ideal VEP. For P100, the proposed PLS algorithm is able to provide comparable results to the
generalized eigenvalue decomposition (GEVD) algorithm, which
alters (prewhitens) the EEG input signal using the prestimulation
EEG signal. It has also shown better performance for later peaks
(P200 and P300). The PLS outperformed not only in positive peaks
but also in N75. In P100, the PLS was comparable with the GEVD
although N135 was better estimated by GEVD. The proposed PLS
algorithm is comparable to GEVD given that PLS does not alter
the EEG input signal. The PLS algorithm gives the best estimate to
multitrial ensemble averaging. This research offers benefits such
as avoiding patient’s fatigue during VEP test measurement in the
hospital, in BCI applications and in EEG-fMRI integration.
Index Terms—Electroencephalograph (EEG), latent component,
partial least squares (PLS), single trial, visual evoked potential
(VEP).

I. INTRODUCTION
HE brain’s response to external stimulus such as visual,
auditory, and somatosensory has helped the medical world
in analyzing the brain and also other parts of the human body
[1], [2]. In particular, the visual stimulation has been used to
assist doctors in determining the normality or abnormality of a
human’s visual pathway [3].
Visual evoked potential (VEP) has been used to detect amblyopia [4], glaucoma [5], and diabetes [6]. The subjects are
required to respond to a certain pattern of visual stimuli at some
period of time while electrodes are in place on the human’s
scalp to record the brain signal using an electroencephalograph
(EEG) system. Response signals such as the evoked potentials
usually occupy the low frequency, although other response using visual task such as gamma-band oscillations occupy high

T

Manuscript received May 4, 2014; revised October 21, 2014 and August 22,
2014; accepted October 28, 2014. Date of publication November 4, 2014; date
of current version December 31, 2015. This work was supported by Universiti
Teknologi PETRONAS, MALAYSIA.
The authors are with the Centre for Intelligent Signal and Imaging Research (CISIR), Electrical and Electronic Engineering Department,
Universiti Teknologi Petronas, 31750 Tronoh, Malaysia (e-mail: duma.
kristina@gmail.com; mzuki_yusoff@petronas.com.my; vijanth_sagayan@
petronas.com.my).
Digital Object Identifier 10.1109/JBHI.2014.2367152

frequency (30–90 Hz) [7]–[9]. This experiment requires many
trials of stimulation, which leads to the ensemble averaging
(EA) technique.
Averaging the signals from all of the trials normally causes a
loss of the information that exists in each trial. As such, a method
such as a single-trial estimation scheme is required to maintain
the unique characteristic of the individual trial. The single-trial
extraction assists the integration of EEG-fMRI in providing the
spatiotemporal resolution of the dynamics cognitive function
[10]–[13]. Morever, in the high accuracy and high-speed VEPbased BCI system, P300-based single-trial extraction is highly
desirable to deliver the communication with the external devices
[14]–[16].
The single-trial extraction of the evoked potential has
been proposed in various methodologies. An independentcomponent-analysis-based method has been used in the singletrial evoked potential such as in [9] and [17], and moreover,
with the functional source separation, the single-trial evoked
potential was improved [13]. It is the common method in multichannel EEG analysis but not in the single-channel EEG estimation. Wavelets-based methods for single-trial evoked potential
were presented in [16] and [18]. Despite its online application,
the performance still degrades if the variability in intersubject
is large. A Kalman-filter-based approach has been proposed in
[19] for single-trial dynamical estimation utilizing the recursive Bayesian mean-square estimation. This method has ability
in dynamical estimation but it could only be used with large
values for the state noise covariance.
The principle component analysis (PCA)-based method such
as in [20] and [21], utilizing iterative generalized eigendecomposition, has been proposed to extract uncorrelated sources. An
another PCA-based method known as generalized eigendecomposition for the single-trial latency estimation by prewhitening
the colored noise input signal has been proposed by the authors
in [22]–[27].
The generalized eigenvalue decomposition (GEVD) proposed
by M.Z. Yusoff in [22] is based on the eigenvalue decomposition
(EVD) method introduced in [28]; it is implemented if the source
signal is corrupted with colored noise. In GEVD, the prestimulation noise covariance is used to prewhiten the noisy input
EEG signal covariance matrix. The prewhitening technique in
the generalized eigendecomposition, which basically alters the
input EEG signal, is the key feature to reduce the colored noise.
In this paper, we present a technique based on the partial leastsquares (PLS) regression that utilizes the covariance matrices
of the noisy signal matrix and the prestimulation noise matrix
through an objective function. The signal and noise subspace
are determined from the eigenvalues of the objective function.

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KRISTINA YANTI et al.: SINGLE-TRIAL VER EXTRACTION USING PLS-BASED APPROACH

Fig. 1. Ideal VEP signal shows N75, N135, P100, P200, and P300 in the
corresponding ideal position and its corrupted version at SNR = −8 dB.

The latent components of the noise with its projection matrix
are deflated from the predictor and response matrices. The PLS
technique, used in BCI using kernel PLS to analyze the EEG
signal, provides the feature extraction for the classification of
motor imagery [29] and classification of the selective serotonin
reuptake inhibitor medication response [30].
In this paper, we propose PLS to be implemented for the
single-trial VEP extraction. The extraction of the desired signal
using this method has been evaluated objectively by calculating
latency average error rate. The latency measurement has been
carried out on for the peak latency estimation of P100, P200,
P300, N75, and N135 in the artificial EEG signal. The P100
latency has been used clinically to measure the response (visual
pathway) of the subject over the stimulus, and to detect the abnormality in the human’s visual pathway. The N75 and N135
were generated to show the pattern reversal together with the
P100. The P300 has been known to be used for the BCI applications. The P200 was generated in order to show a continuation
of evoked potential signal from P100 to P300.
The mean peak detection and standard deviation have been
estimated for P100 only in the real EEG signal. The standard
deviation is used to justify the range estimation of each algorithm
during the latency measurement. The performance of PLS is
compared with the subspace method in [22].
This paper is organized as follows. In Section II, the objective function and the PLS algorithm are explained. Section III
describes the simulation model and the procedure of the benchmark algorithm. Section IV presents the results of the artificial
EEG and the real EEG signals. Finally, Section V presents the
conclusion of the paper.
II. METHODOLOGY

A. PLS and Objective Function
The PLS regression is a multivariate analysis to regress the
predictor or the independent variable X and the response or dependent variable Y. In other words, the role of PLS is to correctly
explain the covariance between two blocks of the independent
variable X and the dependent variable Y by a small number of
uncorrelated variables known as “latent components.” Therefore, the goals of PLS are to predict Y from X and to describe

83

Fig. 2. P100, P200, P300, N75, and N135 of VEP extraction at
SNR = −11 dB.

their common structures by finding a pair of latent components,
which produce the maximum covariance.
In order to find the latent components from both variables,
PLS uses the singular value decomposition (SVD) as its tool to
decompose the covariance matrix of XT Y such that
X T Y = W SC T
T = XW, U = Y C

(1)
(2)

where
W is the left singular vector,
C is the right singular vector,
S is the diagonal matrix of the singular values,
T is the latent component of X and summarizes the X variables
for every object,
U is the latent component of Y and summarizes the Y variables
for every object, and
T is the matrix transpose.
From (1), we can write the SVD of its transpose
 T T
= CSW T
(3)
X Y
X T Y Y T X = W SC T CSW T
= W S2 W T

(4)

Y T XX T Y = C T SW W T SC T
= C T S 2 C.

(5)

The singular values, S, are equal to the square roots of the singular vectors of XT YYT X or YT XXT Y. The eigenvalues of XT YYT X
or YT XXT Y give the singular vectors W and CT such that

 T
(6)
X Y Y T X wi = wi (S))2
 T

Y XX T Y ci = ci (S)2 .
(7)
The aim of the PLS regression is to uncover the latent components. The latent component T depends on W eigenvectors.
Then, we can write a function that can maximize the eigenvector
wi as follows

Pi = λ1 + · · · + λ q
(8)
PiT
wiT (X T Y Y T X)wi = S 2 .

(9)

84

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

The noise itself can be viewed as an aide in the estimation
of variable Y, and therefore, for this case, the covariance of
the noise matrix can be taken into account in the objective
function. By putting the noise covariance matrix in the objective
function, the orthogonality no longer exists between X and Z.
The objective function can be written as [32]
max |wiT X T Y Y T Xwi − λwiT X T ZZ T Xwi |
subject to wT w = 1.

(12)

The PLS accommodates a situation where the noise is not
completely orthogonal to the signal subspace (colored noise).
This is in contrast with the scheme where the noise is assumed
to be orthogonal with the signal (white noise). The covariance
matrices in the objective function can be modified according
to the needs. A tradeoff parameter λ is put into the objective
function for the purpose of controlling the tradeoff between
maximizing the variance of X and forcing a small covariance
with the noise Z. To solve the problem in (12), the Lagrange
multiplier operator or regularization parameter γ is introduced
[32] as follows:
L (wi ) = |wiT X T Y Y T Xwi − λwiT X T ZZ T Xwi |
− γi (wiT wi − 1) subject to E to wT w = 1. (13)

Fig. 3. Latency average error rate of PLS and GEVD at (a) P100, (b) P200,
and (c) P300 as a function of SNR.
TABLE I
SUMMARY OF STATISTICAL VALUES OF POSITIVE PEAKS
SNR

Average Error Rate

(dB)

0
−5
−10

P100

P200

P300

PLS

GEVD

PLS

GEVD

PLS

GEVD

3.68
3.51
3.29

3.35
4.04
3.93

2.69
2.95
2.88

3.7
5.56
7.82

2.55
2.49
2.58

5.23
5.99
6.97

Differentiating the Lagrangian function over wiT and applying
the sgn function with α as the argument of the absolute value
operator in (13) will yield:




δL (wi )
= sgn (α) X T Y Y T − λZZ T Xwi − γi wi
T
δwi
(14)
If γ̂i = sgn(α)γi and by setting the equation above to zero,
then we obtain


(15)
X T Y Y T − λZZ T Xwi = γ̂i wi .
Basically (15) is similar to the eigendecomposition of a matrix; in this case, the matrix is X T (Y Y T − λZZ T )Xwi , resulting in the eigenvectors wi and eigenvalues γ̂i . Since the
optimization function has to maximize the covariance matrix of
the signal then the eigenvectors are based on their corresponding
largest eigenvalues.

The objective function thus can be written with a constraint
as [31]

B. PLS Algorithm

(10)

In this study, the objective function of PLS has been introduced as

The objective function in (10), however, does not always
accommodate a condition where besides X and Y variables,
there exists another variable Z, which usually is considered as
additional noise. When the covariance noise matrix is forced
to be orthogonal with the covariance of X and Y, the objective
function is written as [32]


max wiT X T Y Y T X wi subject to wT w = 1

max |wiT X T Xwi − λwi Z T Zwi | subject to wT w = 1.
(16)
By following (14), we extracted the eigenvectors of the objective function of PLS that maximized the covariance of X,
based on the negative eigenvalues. Once the eigenvectors from
the objective function were extracted, then the latent component
was obtained accordingly, by projecting the eigenvectors to the
corresponding matrix.

T

T

max wi (X Y Y X)wi

T

subject to w w = 1.

wi X T Z = 0i = 1, . . . q. (11)
The solution to this function is attained by extracting the ith
eigenvalues of XT YYT X covariance matrix [33].

T = Xw.

(17)

We acquired the loading vectors: P which is the projection
of X to the latent component, and C which is the projection of

KRISTINA YANTI et al.: SINGLE-TRIAL VER EXTRACTION USING PLS-BASED APPROACH

85

problem, the Moore–Penrose inverse matrix is incorporated to
solve the issue.
III. SIMULATION MODEL
The mathematical model of the problem is written as
x(k) = y(k) + z(k)

(24)

where x is the noisy signal, y is the clean (desired) signal, z is
the noise signal, and k is the time index. In the artificial EEG
signal simulation, the clean signal was first generated, and then,
a colored noise using the autoregressive model was added to the
clean signal to obtain the noisy signal [22].
In order to accommodate the estimation problem, the signal
vector was transformed into a Toeplitz matrix; this can be written
as
X = Y + Z.
Fig. 4. Latency average error rate of PLS and GEVD at (a) N75 and (b) N135
as a function of SNR.
TABLE II
SUMMARY OF STATISTICAL VALUES OF NEGATIVE PEAKS
SNR
(dB)

0
−5
−10

N75

The signal vector x and the noise signal vector z in k samples
were constructed into an individual matrix, respectively. This
can be realized by time shifting the respective samples into an
m × n matrix with the size of the rows m ࣙ columns n to satisfy
the PLS matrix model
xK = ( x1

Average Error Rate
N135

PLS

GEVD

PLS

GEVD

2.15
2.57
3.9

3.23
3.53
5.07

8.91
9.71
11.2

5.6
6.34
9.1

⎡

x1
⎢ x2
⎢
X =⎢ .
⎣ ..
xm

Y into the latent component. The least-squares problem can be
also viewed as the projection matrix, thus the loading vectors
were obtained as the projection matrix to X and Y
P = (T T T )−1 T T X
T

−1

T

C = (T T ) T Y.

(18)
(19)

Now, the variables X and Y can be rewritten as the decomposition of its latent component and the corresponding projection
matrix as
X = TPT

(20)

T

(21)

Y = TC .

Whenever there is a need to obtain the latent component, it
should be obtained by deflating the current variables X0 and
Y0 with their corresponding new decomposition of latent and
projection matrices


X = Xj − T P T


Y = Yj − T C T .

(22)
(23)

The same procedure is repeated at the next iteration j until the
variable X has no more latent components to be extracted using
the same objective function. One issue in the PLS algorithm
arises when the matrices are rank deficient. To cope with this

(25)

...

x2

...

xn −1
xn
xK −1

xK ), zK = ( z1
⎤ ⎡
z1
xn
⎢
xn +1 ⎥
⎥ ⎢ z2
⎥Z =⎢ ..
⎦ ⎣.
xK
zm

z2

...

...

zn −1
zn
zK −1

zK )
(26)
zn

⎤

zn +1 ⎥
⎥
⎥.
⎦
zK

In the real EEG signal case, the signal vector from each trial
was also transformed into the Toeplitz matrix. As mentioned
previously, Z provided an aide in the estimation of Y. The Z was
assumed to be the noise approach, recorded during the prestimulation period. For the artificial EEG signal, a generated white
noise was assumed to be the prestimulation noise. A different
signal-to-noise ratio (SNR) value from 0 dB down to −11 dB
has been applied to the artificial EEG signal. The signal and
noise generation procedure, described in [22] has been applied
in this study. In the real EEG signal, the prestimulation noise
and the corrupted VEP signal in [22] have also been applied in
this study.
The algorithm procedures of PLS for the artificial EEG signal
simulation in each SNR and for the real EEG signal are as
follows:
1) design the pertinent noisy and noise matrices, X and Z,
accordingly with m ≥ n;
2) obtain the covariance matrix of X and covariance matrix
of Z, and hence, Y = X-Z;
3) apply the covariance matrices into the objective function
and set the tradeoff value, λ = 2;
4) apply the eigendecomposition to the objective function
and obtain the eigenvalues and eigenvectors;
5) rearrange the eigenvalues by sorting from the largest to
the smallest value and sort the corresponding eigenvectors
accordingly;

86

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

TABLE III
SUMMARY OF STATISTICAL MSE VALUES OF POSITIVE PEAKS
SNR

Average Error Rate

(dB)
0
−5
−10

P100
PLS
0.0093
0.0098
0.034

P200

GEVD
0.0042
0.01542
0.0641

PLS
0.0194
0.0212
0.114

P300

GEVD
0.0276
0.0458
0.1371

PLS
0.0943
0.0825
0.1136

GEVD
0.1233
0.1061
0.2001

TABLE IV
SUMMARY OF STATISTICAL MSE VALUES OF NEGATIVE PEAKS
SNR

Average Error Rate

(dB)

0
−5
−10

Fig. 5. MSE of PLS and GEVD at (a) P100, (b) P200, and (c) P300 as a
function of SNR.

Fig. 6.
SNR.

MSE of PLS and GEVD at (a) N75 and (b) N135 as a function of

6) choose the negative eigenvalues γ, and their corresponding eigenvectors w;
7) apply (17)–(22), and finally, obtain the estimate of Y, as
shown in (23).
The negative eigenvalues were chosen on the basis of the
assumption that these eigenvalues belong to the noise subspace.
By so doing, we were trying to reduce the colored noise from the

N75

N135

PLS

GEVD

PLS

GEVD

0.0137
0.1071
0.3264

0.0113
0.1663
0.393

0.0345
0.0905
0.1469

0.0507
0.171
0.2599

subspace. The tradeoff value λ = 2 was chosen as the optimum
value after many trials on different values.
For comparison purposes, the GEVD in [22] was adopted.
The Kuhn–Tucker optimization was used in order to minimize
the portion of the noise, while at the same time maintaining
the distortion of the signal as small as possible. The Lagrange
multiplier was applied in order to control the minimization of
the noise and the distortion of the signal. In order to prewhiten
the colored noisy signal, a noise covariance matrix during the
prestimulation period was utilized. The complete procedures of
GEVD for the artificial EEG signal in each SNR and the real
signal are as follows:
1) create the correlation Toeplitz matrices, Rx, Rz, and
Ry = Rx −Rz ;
2) perform the generalized eigendecomposition of Rz, Ry and
obtain the eigenvalues D and their corresponding eigenvectors V;
3) rearrange the eigenvalues D by sorting from the largest
to the smallest values and, accordingly, their respective
eigenvectors V;
4) choose the eigenvalues that are bigger than zero, for the
purpose of creating the signal plus noise subspace;
5) using an information criterion, the chosen eigenvalues are
selected again by applying the Akaike information criterion. The selection is meant to filter some of the eigenvalues, and hence, their respective eigenvectors that are
considered to still belong to the noise subspace;
6) create a new diagonal eigenvalues matrix Ds with the
eigenvalues chosen based on the Akaike information criterion selection and set the rest to zero;
7) using the Ephraim and Van Trees optimization, the formula Hopt for noise reduction is Hopt = V1 Ds V1−1 ;

KRISTINA YANTI et al.: SINGLE-TRIAL VER EXTRACTION USING PLS-BASED APPROACH

Fig. 7.

P100 detection on subject 2: EA = 100, GEVD = 98, PLS = 100.

8) extract the desired signal by multiplying the formula in

step 7 with the noisy signal: y = V1 Ds V1−1 x. Here, the
prewhitening step is shown by the multiplication of V1−1 x.
IV. PERFORMANCE EVALUATION AND RESULT ANALYSIS
The main purpose in the estimation of the clean (desired)
VEP signal in this study was to measure how far the latencies
of the estimated positive (P100, P200, and P300) and negative
(N75 and N135) peaks were from the ideal positions. The estimations of the positive and negative peaks were used to show
the pattern-reversal [34], [35] as used in the clinical environment. The pattern-reversal of VEP showed the evoked potentials especially at N75-P100-N135; whereas, P200 and P300
were purposely prolonged to see the ability of the algorithm. To
perceive the idea of the purpose, Fig. 1 shows the ideal (clean)
and the noisy (corrupted) VEP signals of the artificial EEG
signal simulation.
The results are the reconstructed waveforms of the PLS and
GEVD algorithms out of the noisy signal. The reconstructed
waveforms have been purposely chosen from lower SNRs in
order to visualize the capability of the algorithm in poor SNR
conditions. Fig. 2 shows the reconstructed waveforms of both
algorithms for the artificial EEG signal obtained at SNR equal
to −11 dB.
From the figure, we can see that the reconstructed waveform
of the PLS algorithm shows a closer shape to the ideal waveform as compared to the GEVD algorithm. This is evaluated by
observing the latency or average error rate of the reconstructed
results. In terms of the amplitude, as can be seen in Fig. 2, the
PLS result displays that the amplitude of P100 is highest followed by the P200 peak, and finally, the P300 peak. In contrast
to the PLS, in the GEVD results, the P300 peak was higher than
the P200.
In order to evaluate the performance of the estimation algorithm, the latency average error rate has been used to measure
how far the average latency of the positive and negative peaks
was from the ideal positions. In the artificial EEG signal, the

Fig. 8.

87

P100 detection on subject 6: EA = 107, GEVD = 107, PLS = 110.

average error rates were obtained for 100 iterations. For the
artificial EEG signal of the PLS and GEVD algorithms, Fig. 3
shows the performance in terms of the latency average error rate
in the peak latencies of P100, P200, and P300.
We also compare the PLS-based method with a nonprewhitening subspace approach (EVD) [28]. The main difference between the GEVD prewhitening-based approach in [22] and the
nonprewhitening-based approach (EVD) is that, the GEVD used
the generalized eigenvalues decomposition to prewhiten the input signal, whereas the EVD used eigenvalues decomposition.
The smaller the average error rate the better the performance
of the algorithm is in reconstructing the noisy signal toward the
ideal waveform. As can be seen in Fig. 3, the latency average
error rate of P100 in the PLS algorithm and GEVD algorithm is
comparable. In Table I, at SNR = −10 dB, the PLS estimation
for P100 is 3.29, and the GEVD estimation is 3.93 which reflect
comparable results of P100. Interestingly, the average error rate
for P200 and P300 in the PLS estimation show smaller values
than those of the GEVD in each of the SNRs. At SNR = −10 dB,
the latency error rate for P200 and P300 in the PLS estimation
are 2.88 and 2.58, respectively, reflecting the smaller error rate
than the GEVD estimation, which generated 7.82 and 6.97 for
the P200 and P300.
For the N75 artificial EEG signal, Fig. 4(a) shows that the
PLS estimation produced a smaller error rate than the GEVD
estimation in almost every SNR. On the contrary, in N135, the
GEVD algorithm has a smaller error rate in comparison to the
PLS algorithm. Table II displays the summary statistical values
of N75 and N135 highlighting the significant difference between
PLS and the GEVD estimation. At SNR = −10 dB, PLS estimation is 3.9, whereas GEVD estimation is 5.07. More distinct
results were also shown in the N135 average error rate between
the PLS and the GEVD algorithms, where PLS estimation is
11.2, whereas GEVD estimation is 9.1.
At N135, GEVD has given a better estimation than the PLS.
In clinical use, however, the presence or detection of N135
is usually considered whenever the P100 is difficult to observe

88

Fig. 9.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

P100 detection on subject 27: EA = 102, GEVD = 99, PLS = 102.

[36]. The overall performance of the PLS has shown competitive
results in comparison to the GEVD.
In general for peak latency estimation, the EVD performed
poorly in comparison to both GEVD and the proposed PLS
methods. Thus, in the next measurement comparisons (figures
and table), the EVD-based method is omitted for ease of interpretation and inference.
The PLS latency results in pattern reversal peaks N75, P100,
and N135 peak give an alternative promising detection for the
visual pathway as well as in the P300 peak for the BCI applications. The reason is that the PLS did not need to alter (prewhiten)
the input signal as GEVD did and yet performed comparably
well.
The single-trial amplitudes in terms of mean squared error
(MSE) is also calculated for the artificial EEG signals for PLS
and GEVD as shown in Figs. 5 and 6, and Tables III and IV.
In general, the PLS MSE results of positive peaks are smaller
than the MSE of GEVD but for the negative peaks in particular
N75, the PLS MSE is larger than the GEVD. The MSE results
show that the amplitudes of P100–N135 are better estimated by
the PLS and the amplitudes of N75–P100 are better estimated
by the GEVD.
The real EEG signals were collected from 47 patients and the
proposed algorithm was applied to extract the desired signal, and
then, detect the desired peaks. In the experiment, 80 trials were
conducted for the extraction of the real EEG signals for each of
47 subjects in Selayang Hospital, Kuala Lumpur, Malaysia. The
stimulation used in the experiment was a checkerboard pattern
using checker reversal. The subjects were required to respond
to the stimulus with one eye closed at any given time [22].
The International 10/20 system was used in the recordings of
80 trials with the active electrode connected between the middle
of occipital (O1, O2), and the reference electrode was connected
to the middle of the forehead. Sampling frequency for every trial
was at 512 Hz and prefiltered at 0.1–70 Hz.
In the real EEG signal, only the P100 peak was available
for detection due to the limited length of the recorded signal.

Fig. 10.

P100 detection on subject 29: EA = 92, GEVD = 93, PLS = 94.

The P100 was investigated as an example, even though the
data would also be sufficient to investigate the N75. Similar
to the artificial EEG signal evaluation, the capability of the
algorithms is also shown in the reconstructed waveforms for the
real EEG signal. Figs. 7–10 show the results of the reconstructed
waveforms of some subjects. The P100 peak has been detected
as the highest peak from time/samples within 80–160 ms.
The evaluation of the P100 detection in the real EEG signal
case has been initiated by taking the average (mean) peak detection from every trial. This is due to the absence of reference
peak in every trial. The average error rate in the real EEG signal
thus has been replaced with the mean peak estimation of single
trial and the standard deviation of the peak estimation has been
substituted as the range estimation shown in Table IV. As can be
seen in Table V, the evaluation is based on the closeness of the
mean peak estimation of single trial to the ensemble averaging
estimation.
In the mean peak estimation, out of 47 subjects, the PLS
algorithm has closer estimation for the 21 subjects in comparison
to the EA algorithm. However, the GEVD algorithm has been
able to estimate 26 subjects with the mean peak estimation closer
to the EA algorithm. This result is similar to our artificial EEG
signal where in comparison to the PLS, GEVD has a mean peak
estimation closer to the ideal P100. For the standard deviation
results, the PLS algorithm showed a smaller deviation than the
GEVD algorithm.
In this single-trial estimation work, we have summarized both
results obtained from the artificial EEG signal and the real EEG
signal. In the artificial EEG signal, the average error rates (latencies) are comparable to those of the GEVD.
In the proposed PLS algorithm, the prestimulation EEG signal
has been utilized. The core of the PLS algorithm is to optimize
the signal covariance rather than the noise covariance. Interestingly, it did not normalize the colored noise by modifying the
given input signal as in the case of GEVD.
Since the colored noise was stronger than the desired signal,
the latent component in the PLS algorithm still contained the

KRISTINA YANTI et al.: SINGLE-TRIAL VER EXTRACTION USING PLS-BASED APPROACH

TABLE V
MEAN AND STANDARD DEVIATION IN REAL PATIENT DATA
Subject

EA

Mean GEVD

Mean PLS

Std GEVD

Std PLS

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47

99
100
119
128
99
107
109
107
130
119
114
102
123
102
102
107
107
110
130
109
102
130
104
103
116
98
102
101
92
99
130
105
114
130
103
102
112
106
114
96
104
103
103
94
98
105
127

98.4125
100.4125
120.325
127.6375
97.025
104.8696
110.8625
108.1375
132.7875
119.2
110.7625
103.5125
122.9375
104
107.7125
107.0785
106.9625
112.7
130.3125
111.05
101.3875
128.7375
104.35
103.875
116.4375
99.0875
103.2
102.575
94.45
102.3625
132.5
104.775
114.1125
133.3375
101.2125
100.6625
113.9
106
113.7
97.0375
104.0875
103.4
105
95.75
97.125
105.125
130.25

101.3375
99.925
120.5875
130.125
101
105.2174
110.9125
107.7625
130.35
120.3125
115.9625
101.725
122.9875
99.962
109.4875
106.55
107.475
113.8625
130.25
112.1875
113.225
129.7375
104.375
103.4375
122.6125
98.3375
103.25
103.2
91.6
96.6375
128.6375
107.2875
116.0875
131.7375
104.55
103.2875
114
106.4375
112.4625
97.05
103.95
103.95
105.125
95.5
102.25
104.9375
125.6875

10.6837
7.2503
7.4242
8.0035
9.2817
9.5065
7.083
5.4538
23.8074
8.2241
11.5858
4.5028
8.7755
7.2973
9.8529
4.6749
9.919
11.4132
5.5398
10.6723
13.635
7.0405
18.0271
5.9856
17.574
10.8768
14.0435
10.0969
12.2446
16.0133
5.8544
14.2276
9.8297
16.9733
8.0171
8.3705
10.8524
12.8047
8.6522
1.3982
1.3096
1.8708
3.5267
2.9765
3.9031
7.3612
14.0435

10.0833
6.6253
5.0539
7.4873
6.1053
5.9924
5.1239
6.6657
15.0915
7.3325
6.5659
5.1647
9.5335
5.3347
11.887
5.7661
8.7077
9.9508
5.5599
8.1349
16.8211
7.7213
6.3253
5.8005
9.0215
14.4611
7.9254
9.9038
10.1988
12.2844
11.5534
6.118
10.9672
6.9655
7.7941
7.4719
10.7506
5.7071
10.2822
6.784
13.379
13.379
1.2686
3.5707
2.9047
3.3998
7.8559

colored noise. Hence, when it was projected to the noisy signal
for producing the loading vector, the estimated signal (desired
signal) was still affected by the colored noise. This scenario was
different with the GEVD algorithm; it normalized the colored
noise by prewhitening the given input signal. As the colored
noise had become white noise, the GEVD algorithm performed
better to reduce the white noise. This prewhitening step explains
the peak estimation results of GEVD.
In the PLS, the input signal was not modified; the estimation
range was limited to the area in the subspace where the signal
mostly exists along with some portion of the colored noise. But
in the GEVD algorithm, since the input signal was normalized
to whiten the colored noise, the area of the signal became wider
than it should have been, producing a wider range of estimation,
which lead to larger standard deviation reading.

89

V. CONCLUSION
This paper has evaluated the PLS regression-based method
for single-trial VEP extraction. The method utilizes the latent
components of the projection matrix to the independent and
dependent variables. In this paper, the artificial EEG signal and
real EEG signal have been applied to test the capability of the
algorithm. The PLS algorithm was compared to the benchmark:
GEVD algorithm. The results from the artificial EEG signal
show that the PLS-based P100 estimations are comparable to
GEVD ones in term of the latencies. For the real EEG signal
results, 21 out of 47 subjects have mean peak estimation close
to the ensemble averaging and are almost comparable to that of
GEVD. Moreover, for the standard deviation, the PLS algorithm
has smaller values than the GEVD results.
Further, the P200 and P300 results of the artificial EEG signals
show that the average peak latency of the PLS has a lower
error rate in comparison to that of the GEVD. Overall, the
performance of the proposed PLS technique is comparable to
GEVD as shown in the pattern reversal latency and amplitude
estimation of the artificial EEG signal, as well as the P100
latency of the real EEG signal without altering the EEG input
signal.
REFERENCES
[1] P. Walsh, N. Kane, and S. Butler, “The clinical role of evoked potentials,”
J. Neurol. Neurosurg. Psychiatry, vol. 76, no. 2, pp. 16–22, 2005.
[2] P. Daphna, J. Chapman, A. D. Korczyn, O. Elkayam, O. Hilkevich,
G. B. Groozman, D. Levartovsky, I. Litinsky, D. Caspi, Y. Segev, and
V. E. Drory, “Evoked potential studies in the antiphospholipid syndrome:
Differential diagnosis from multiple sclerosis,” Ann. Rheumatic Diseases,
vol. 65, no. 4, pp. 525–528, 2006.
[3] G. W. Weinstein, “Clinical aspects of the visually evoked potential,” Trans.
Amer. Ophthalmol. Soc., vol. 75, pp. 627–673, 1977.
[4] R. Halfeld Furtado De Mendoca, S. Abbruzzese, B. Bagolini, I. Norfroni,
and E. Ferreira, (2012). “Importance of visual evoked potential in amblyopic children,” Acta Ophthalmol., vol. 90, no. s429, Sep. 2012.
[5] J. S. Weizer, D. C. Musch, L. M. Niziol, and N. W. Khan, “Multifocal
visual evoked potential for early glaucoma Detection,” Ophthalmic Surg.,
Laser Imaging Retina, vol. 43, no. 4, pp. 335–340, Jul./Aug. 2012.
[6] P. G. Raman, A. Sodani, and A. George, “A study of visual evoked potential changes in diabetes mellitus,” Int. J. Diab. Dev. Countries, vol. 17,
pp. 69–73, 1997.
[7] A. Hadjipapas, P. Adjamian, J. B. Swettenham, I. E. Holliday, and
G. R. Barnes, “Stimuli of varying spatial scale induce gamma activity
with distinct temporal characteristics in human visual cortex,” Neuroimage, vol. 35, pp. 518–530, 2007.
[8] S. D. Muthukumaraswamy, K. D. Singh, J. B. Swettenham, and D.
K. Jones, “Visual gamma oscillations and evoked responses: Variability, repeatability and structural MRI correlates,” Neuroimage, vol. 49,
pp. 3349–3357, 2010.
[9] C. Porcaro, D. Ostwald, A. Hadjipapas, G. R. Barnes, and A. P. Bagshaw,
“The relationship between the visual evoked potential and the gamma
band investigated by blind and semi-blind methods,” Neuroimage, vol. 56,
pp. 1056–1071, 2011.
[10] S. Debener, M. Ullsperger, M. Siegel, and A. K. Engel, “Single-trial EEGfMRI reveals the dynamics of cognitive function,” Trends Cogn. Sci.,
vol. 10, pp. 558–563, 2006.
[11] A. P. Bagshaw and T. Warbrick, “Single trial variability of EEG and fMRI
responses to visual stimuli,” Neuroimage, vol. 38, no. 2, pp. 280–292,
2007.
[12] D. Ostwald, C. Porcaro, and A. P. Bagshaw, “An information theoretic
approach to EEG-fMRI integration of visually evoked responses,” NeuroImage, vol. 49, pp. 498–516, 2010.
[13] C. Porcaro, D. Ostwald, and A. P. Bagshaw, “Functional source separation improves the quality of single trial visual evoked potentials recorded
during concurrent EEG-fMRI,” NeuroImage, vol. 50, pp. 112–23, 2010.

90

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

[14] O. I. Khan, F. Farooq, F. Akram, M. T. Choi, S. M. Han, and T.
S. Kim, “Robust extraction of P300 using constrained ICA for BCI
applications,” Med. Biol. Eng. Comput., vol. 50, no. 3, pp. 231–41,
2012.
[15] D. Liparas, S. Dimitriadis, N. Laskaris, A. Tzelepi, K. Charalambous,
and L. Angelis, “Exploiting the temporal patterning of transient VEP
signals: A statistical single-trial methodology with implications to braincomputer interfaces (BCIs),” J. Neurosci. Methods, vol. 232, pp. 189–198,
2014.
[16] Y. Tu, Y. S. Hung, L. Hu, G. Huang, Y. Hu, and Z. Zhang, “An automated and fast approach to detect single-trial visual evoked potentials
with application to brain-computer interface,” Clinical Neurophysiology.
[17] O. I. Khan, K. Sang-Hyuk, T. Rasheed, A. Khan, and K. Tae-Seong,
“Extraction of P300 using constrained independent component analysis,”
in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., Sep. 3–6, 2009,
pp. 4031–4034.
[18] T. Yiheng, H. Gan, S. H. Yeung, H. Li, H. Yong, and Z. Zhiguo, “Singletrial detection of visual evoked potentials by common spatial patterns and
wavelet filtering for brain-computer interface,” in Proc. IEEE 35th Annu.
Int. Conf. Eng. Med. Biol. Soc., Jul. 3–7, 2013, pp. 2882–2885.
[19] S. D. Georgiadis, P. O. Ranta-aho, M. P. Tarvainen, and P. A. Karjalainen, “Single-trial dynamical estimation of event-related potentials: A
Kalman filter-based approach,” IEEE Trans. Biomed. Eng., vol. 52, no. 8,
pp. 1397–1406, Aug. 2005.
[20] S. Hajipour, M. B. Shamsollahi, and V. Abootalebi, “Visual acuity classification using single trial visual evoked potentials,” in Proc. IEEE Int.
Conf. Eng. Med. Biol. Soc., Sep. 2–6, 2009, pp. 982–985.
[21] S. Hajipour, M. B. Shamsollahi, H. Mamaghanian, and V. Abootalebi,
“Extracting single trial visual evoked potentials using iterative generalized
Eigen value decomposition,” in Proc. IEEE Int. Symp. Signal Process.
Inform. Technol., Dec. 16–19, 2008, pp. 233–237.
[22] N. Kamel, M. Z. Yusoff, and A. F. Mohamad Hani, “Single-trial subspacebased approach for VEP extraction,” IEEE Trans. Biomed. Eng., vol. 58,
no. 5, pp. 1383–1393, May 2011.
[23] M. Z. Yusoff, N. Kamel, and A. F. M. Hani, “Estimation of visual evoked
potentials using a signal subspace approach,” in Proc. Int. Conf. Intell.
Adv. Syst., Nov. 25–28, 2007, pp. 1157–1162.
[24] M. Z. Yusoff and K. Nidal, “A time-domain subspace technique for estimating visual evoked potential latencies,” Int. J. Comput. Sci. Netw.
Security, vol. 10, no. 1, pp. 144–153, 2010.
[25] M. Z. Yusoff and K. Nidal, “Estimation of visual evoked potentials for
measurement of optical pathway conduction,” in Proc. 17th Eur. Signal
Process. Conf., 2009, pp. 2322–2326.
[26] M. Z. Yusoff, N. Kamel, A. F. M. Hani, and A. Fadzil, “Single-trial
extraction of visual evoked potentials from the brain,” in Proc. 16th Euro.
Signal Process. Conf. (EUSIPCO-2008), 2008.
[27] N. Kamel and M. Z. Yusoff, “A generalized subspace approach for estimating visual evoked potentials,” in Proc. IEEE 30th Annu. Int. Conf.
Eng. Med. Biol. Soc., Aug. 20–25, 2008, pp. 5208–5211.
[28] Y. Ephraim and H. L. Van Trees, “A signal subspace approach for
speech enhancement,” IEEE Trans. Speech Audio Process., vol. 3, no. 4,
pp. 251–266, Jul. 1995.
[29] B. Xuecai, M. Zhendong, and H. Jianfeng, “Nonlinear analysis for motor
imagery EEG based kernel partial least squares,” in Proc. IEEE 4th Conf.
Ind. Electron. Appl., May 25–27, 2009, pp. 2106–2109.
[30] A. Khodayari-Rostamabad, J. P. Reilly, G. Hasey, H. de Bruin, and D.
MacCrimmon, “Using pre-treatment EEG data to predict response to SSRI
treatment for MDD,” in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc.,
Aug. 31, 2010–Sep. 4, 2010, pp. 6103–6106.
[31] C. J. F. ter Braak and S. de Jong, “The objective function of partial least
squares regression,” J. Chemometrics, vol. 12, no. 1, pp. 41–54, 1998.
[32] S. Salari Sharif, “Regularized latent variable methods in the presence of
structured noise and their application in the analysis of electroEncephalogram Data,” Ph.D. dissertation, Chem. Eng. Dept., McMaster University,
Hamilton, ON, Canada, 2012.
[33] C. RadhaKrishna Rao, “Use and interpretation of principal component analysis in applied research,” Sankhya: Indian J. Statis., vol. 26,
pp. 329–358, 1964.

[34] J. V. Odom, M. Bach, M. Brigell, G. E. Holder, D. L. McCulloch, A.
P. Tormene, and Vaegan, “ISCEV standard for clinical visual evoked
potentials (2009 update),” Documenta Ophthalmol., vol. 120, no. 1,
pp. 111–119, 2010.
[35] J. R. Heckenlively and G. B. Arden, Principles and Practice of Clinical
Electrophysiology of Vision, Cambridge, MA, USA: MIT press, 2006,
pp. 300–305.
[36] Understanding DIOPSYS NOVA-TR Waveforms, Dyopsis Inc., NJ 07058,
United States, 2012.

Duma Kristina Yanti received the B.Sc. degree
in electrical engineering from Universitas Indonesia, Indonesia and the M.Sc. degree in electrical
and electronic engineering from Universiti Teknologi
PETRONAS, Tronoh, Malaysia, in 2010, where she
is currently working toward the Ph.D. degree in electrical and electronic engineering.
She is a member of Center of Intelligent Signal and Imaging Research, Universiti Teknologi
Petronas. Her research interests include signal processing specifically in biomedical technology.

Mohd Zuki Yusoff received the B.Sc. degree in electrical engineering from Syracuse University, Syracuse, NY, USA, in 1988, the M.Sc. degree in communications, networks and software from Surrey University, Surrey, U.K., in 2001, and the Ph.D. degree in
electrical and electronic engineering from Universiti
Teknologi PETRONAS, Tronoh, Malaysia, in 2010.
He is currently a Senior Lecturer at Universiti
Teknologi PETRONAS. His research interests include signal processing, telecommunication, and embedded systems.
Dr. Yusoff is a member of the Tau Beta Pi, the National Engineering Honorary Society, and the Eta Kappa Nu, the Electrical and Computer Engineering
Honorary Society.

Vijanth Sagayan Asirvadam (M’03) received the
B.Sc. degree in statistics from the University of Putra, Serdang, Malaysia, in April 1997 and the Masters
degree in engineering computation (with a distinction) from Queen’s University Belfast, Belfast, U.K.
in 1998 and Phd degree in Intelligent systems and
control from the same University in 2002.
He was a System Engineer in 1999 and later became a Lecturer (2003–2005) at the Multimedia University Malaysia. He was also a Senior Lecturer at
Faculty of Engineering and Computer Technology,
AIMST University (2005–2006). He joined as a Senior Lecturer (2006–2011),
and since 2011, has been an Associate Professor at the Department of Electrical and Electronics Engineering, Universiti Teknologi PETRONAS, Tronoh,
Malaysia, where he is currently also the Head of the Health Informatics Modeling (HiM) group for Center of Intelligent Signal and Imaging Research. His
research interests include linear and nonlinear system identification and model
validation.
Dr. Vijanth is a member of the Institute of Engineering Technology (IET).
He is a member of the IEEE for signal processing and control systems chapters
since 2003.

