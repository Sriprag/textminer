586

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

A Novel Curvature-Based Algorithm for Automatic
Grading of Retinal Blood Vessel Tortuosity
Masoud Aghamohamadian-Sharbaf, Hamid Reza Pourreza, Senior Member, IEEE, and Touka Banaee

Abstract—Tortuosity of retinal blood vessels is an important
symptom of diabetic retinopathy or retinopathy of prematurity.
In this paper, we propose an automatic image-based method for
measuring single vessel and vessel network tortuosity of these vessels. Simplicity of the algorithm, low-computational burden, and
an excellent matching to the clinically perceived tortuosity are the
important features of the proposed algorithm. To measure tortuosity, we use curvature which is an indicator of local inflection
of a curve. For curvature calculation, template disk method is a
common choice and has been utilized in most of the state of the
art. However, we show that this method does not possess linearity
against curvature and by proposing two modifications, we improve
the method. We use the basic and the modified methods to measure
tortuosity on a publicly available data bank and two data banks
of our own. While interpreting the results, we pursue three goals.
First, to show that our algorithm is more efficient to implement
than the state of the art. Second, to show that our method possesses
an excellent correlation with subjective results (0.94 correlation
for vessel tortuosity, 0.95 correlation for vessel network tortuosity in diabetic retinopathy, and 0.7 correlation for vessel network
tortuosity in retinopathy of prematurity). Third, to show that the
tortuosity perceived by an expert and curvature possess a nonlinear
relation.
Index Terms—Curvature, diabetic retinopathy (DR), retinal image, tortuosity measure.

I. INTRODUCTION
IABETES causes damage in blood vessels. Vessel damages in heart muscles are related to ischemic heart diseases
and heart attacks; and vessel damages in the retina cause reduction of sight. The latter called diabetic retinopathy (DR) is one
of the common causes of reduction of sight. In fact, many studies show that DR dramatically increases chances of blindness
[1] and that it is the leading cause of blindness of the working
age especially in developed countries [2]. Presence of numerous
microaneurysms is the earliest sign of DR [3]. As the disorder
develops, retinal blood vessels become thicker, more twisted and
turned [4]. In more advanced levels, neovascularization through
inability to provide the required amount of nutrition and oxygen for the retina occurs [5]. These newly generated vessels are
very fragile. Therefore, they cause internal bleeding in the retina

D

Manuscript received October 1, 2014; revised November 30, 2014; accepted
January 15, 2015. Date of publication January 23, 2015; date of current version
March 3, 2016.
M. Aghamohamdian-Sharbaf and H. R. Pourreza are with the Department of Electrical Engineering, Ferdowsi University of Mashhad, Mashhad
9177948974, Iran (e-mail: masoudas@hotmail.com; hpourreza@ieee.org).
T. Banaee is with the Retina Research Centre, Mashhad University of Medical
Sciences, Mashhad 913791-3316, Iran (e-mail: banaeet@mums.ac.ir).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2396198

Fig. 1. Two images of the retina with different tortuosity level. (a) Normal
tortuosity. (b) High tortuosity.

that endangers the visual system and might ultimately result in
blindness.
Early diagnosis of DR helps controlling its side effects. This
is possible with the aid of technical examination of the ocular
fundus. Experimentally, it has been shown that when there is no
critical symptom of retinal damage, an escalation in retinal blood
vessel tortuosity is an early sign of DR [4]. Moreover, presence
of tortuous retinal blood vessels is an indicator of retinopathy of
prematurity (ROP) in preterm infants [6]. It is well known that
in serious cases, ROP causes retinal detachment and blindness
[7]. For a detailed review on applications of image processing to diagnosing ROP and comparison of different methods,
see [8], [9].
Qualitatively speaking, tortuosity is an indication of how
winding a blood vessel is [10]. In Fig. 1, two ocular fundus
images with normal and tortuous vessels are shown. As is clear,
the vessel network in Fig. 1(b) is more twisted than a normal
network that alerts probable presence of DR. Note that vessel
tortuosity can happen locally in small portions of blood vessels,
or throughout the blood vessel network.
For quantitative measurement of tortuosity, the vessel is modeled as a smooth connected curve. Based on this model, different
tortuosity measurement algorithms have been proposed in the
literature that could be divided into four general groups:
A. Arc Length Over Chord Length Ratio Methods
Methods of this group have simple mathematical expressions.
Lotmar et al. [11] were the first to introduce methods of this
category and their method was widely utilized thereafter (e.g.,
[12]–[15]). However, it is apparent that the arc over chord length
ratio, on its own, is insufficient for determination of vessels with
smooth curvature and vessels with variation in curvature direction. For compensation, Bullit et al. [16] and Grisan et al. [17]
proposed modifications on the approach. In [17], vessels are partitioned into segments with the same convexity and a weighted

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

AGHAMOHAMADIAN-SHARBAF et al.: NOVEL CURVATURE-BASED ALGORITHM FOR AUTOMATIC GRADING OF RETINAL BLOOD VESSEL

587

sum of arc over chord length of all segments is proposed as a
tortuosity measure.
B. Methods Based on Curvature
Curvature is a mathematical measure for how inflected a curve
is at a certain coordinate. Hart et al. [13] use curvature to propose
two tortuosity measures which are the integral of curvature and
the integral of curvature squared. For future reference, as in
[17], we call these measures τc and τsc . Moreover, the ratio of
these integrals over arch or chord length has also been proposed
as tortuosity measures in [13]. In [18], the integral of squared
curvature derivative is suggested as a measure of tortuosity.
These or other curvature-based algorithms have been used in
most of the recent works including [19], [20] as well. Curvaturebased tortuosity measures are more reliable, but they impose a
heavy computational burden compared to the methods of the
first group.
C. Methods Based on Angle Variation
These methods compute the direction variations of the vessel
to measure tortuosity. In [21], the average of the angles between
sample center points that describe the vessel (called local direction variation) was used to measure tortuosity. In [22], the same
method is used to measure local angles and the number of times
a local angle surpasses π/6 is considered as tortuosity index.
D. Methods Based on Other Domain
These methods are in fact a subgroup of the curvature-based
methods. The difference is that unlike the first group, they calculate curvature in domains beside the space domain. Kaupp
et al. [23] use Fourier analysis and Ghadiri et al. [24] use circular Hough transform to calculate curvature. Moreover, in [25],
Non Subsampled Contourlet Transform is used for curvature
calculation. The key feature of these methods is evaluation of
tortuosity without vessel extraction. However, they suffer from
heavy computational burden as well.
There have also been some special cases of tortuosity measurement algorithms. For example, Wallace et al. [26] use
cubic-spline interpolation for measuring tortuosity. Other work
includes [10], [27], [28]. For a more detailed review on different tortuosity measurement algorithms and their applications,
see [29].
E. Our Method
Our method is a curvature-based tortuosity measurement;
therefore, it falls into the second group. To illustrate the method,
in Section II, we define curvature as a mathematical tool for measuring local inflection. To calculate curvature, a novel approach
called the template disk method is commonly used. In Section
III, after showing the pitfalls of the template disk method, we
propose two modifications for amendment of the method. Later
in this section, we examine the accuracy of the modified methods using synthetic functions. Section IV deals with how to use
the template disk method and its modifications for tortuosity

Fig. 2.

Curvature calculation with the template disk method.

measurement, and finally in Sections V and VI, the test results,
the concluding remarks, and possible future works are given.
II. CURVATURE CALCULATION
Curvature is an indication of local twistedness of a curve [30].
In the continuous case, for a planar curve y = f (x), curvature
is given by
κ=

y 
.
(1 + y 2 )3/2

(1)

Moreover, for the parametric representation x = x(t) and y =
y(t), we have
κ=

y  (t)x (t) − x (t)y  (t)
.
(x (t)2 + y  (t)2 )3/2

(2)

Note that rigid transformations would not affect the absolute
value of curvature. However, the sign may change by rotation.
To calculate curvature using a discrete model of a curve,
numerical approaches have been exploited in [31]. However,
numerical methods are nontrivial and time consuming for large
datasets [32]. An elegant method for estimation of curvature that
has a relatively low computational complexity was introduced
in [33]. This approach, known as the template disk method, is
further explored for 2-D images in [34]. Through its simplicity, this method has been widely utilized in most applications
requiring curvature calculation. The basic idea of the method
is to relate the area between the curve and a template disk of
a suitable radius with curvature. To illustrate the method, note
that for a point with zero first derivative, we have
κ = f  (x).

(3)

Hence, to calculate curvature for a point (x, y), first a template
disk of radius b is sketched around the point (see Fig. 2). Next,
the center of the Cartesian coordinate system is set on the point
to ensure that f (0) = f  (0) = 0. Under this assumption, Taylor
series for points in the vicinity of zero is
1
f (x) = 0 + 0 + κx2 + o(x3 )
2

(4)

where κ denotes curvature at the origin and o(x3 ) expresses
higher order terms of the series. Using polar coordinates (r, θ),
we have
rsinθ =

1 2 2
κr cos θ + o(r3 cos3 θ).
2

(5)

588

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 4. Approximating area A using the crossover point of the curve and the
template disk.
Fig. 3.

Estimated curvature versus analytical curvature for a parabola.

Normalizing the coordinate system by the radius of the template
disk b, we get
1
KR2 cos2 θ + o(R3 cos3 θ)
(6)
2
where R = r/b and K = κb. Now, assume that θ is near zero,
we can approximate cosθ by one and sinθ by θ and define θ as
a function of R and K


1
θ(R) ≈ sin−1
KR + o(R2 ) .
(7)
2
Rsinθ =

Using this expression, we could approximate area A, which is
the area between the disk and the curve. Define:
 1
 π −θ (R )
a=
RdR
dθ
(8)
0

θ (R )

A. First Modification: Based on Crossover Point (κcp )

2

then A = ab . As it turns out, analytical calculation of this
integral does not yield a linear relation between curvature and
this area. However, if θ(R) is further approximated by its Taylor
series around zero, we get
1
KR + o(R2 ).
(9)
2
Ignoring higher order terms, the normalized area using (8) is
θ(R) ≈

π K
a≈ −
2
3
and rearranging terms yield

(10)

3Ac
3π
3π 3A
− 3 = 3 −
(11)
2b
b
b
2b
where Ac is the complement of A. Therefore, κ ∝ Ac . Based
on this relation and the argument given in the next section, the
nonlinear estimation of curvature κn l is defined as
κ≈

κn l  Ac .

results of [34], for error free calculation of curvature in digital
images, the radius of the template disk should be large. This
is due to the fact that for small radius, area calculation may
contain significant error. However, as b increases, area A has
weaker dependency on κ. Therefore, we face a contradiction
between the assumption that simplifies (7) (which assumes a
small radius for the disk) and the one that is required for accurate
implementation (which requires a large radius for the template
disk).
Although we showed that the template disk method is inaccurate when estimation of high curvature is concerned, through
its simplicity, we try to perform the necessary modifications
in order to make it applicable to all curvature values. In what
follows, two modifications are given.

(12)

III. MODIFICATIONS OF THE TEMPLATE DISK METHOD
As we saw in the previous section, the assumption that θ is
small simplifies (6) and results in (7). However, this assumption
is valid merely if curvature is sufficiently small. To show that
(11) fails to deliver for large curvature, assume that κn l is used to
estimate the curvature of a parabola y = cx2 at the origin. Fig. 3
is a comparison of the analytical curvature 2c (horizontal axis)
versus curvature derived by the method. As is clear, though
for small curvature (small c) estimated curvature and actual
curvature are proportional, the relation for large curvature is far
from being linear. On the other hand, as indicated by the test

As Fig. 4 shows, irrespective of θc (the crossover angle of the
curve and the disk), the area between the curve and the template
disk is the gray area plus the green area. Therefore, area A could
be approximated by the gray area or Ã. In what follows, we try
to relate Ã and θc .
To derive θc , it suffices to set R = 1 in (6). We have
1
Kcos2 θc + o(cos3 θc ).
(13)
2
Now, we assess three different cases:
1) θc Near Zero: In this case, sinθc is approximated by θc
and cosθc by one. We have
sinθc =

θc =

1
K.
2

(14)

Thus, Ã is
πb2
Kb2
−
.
(15)
2
2
Rearranging terms yields the following relation for small
crossover angle:
Ã ≈

κ≈

π 2Ã
− 3 .
b
b

(16)

Note that as was expected, this equation is similar to (11) neglecting a scaling factor.
2) θc Near π/2: If θc is near π/2, we can approximate cosθc
by π2 − θc and sinθc by one that yields

2
π
.
(17)
θc ≈ −
2
K

AGHAMOHAMADIAN-SHARBAF et al.: NOVEL CURVATURE-BASED ALGORITHM FOR AUTOMATIC GRADING OF RETINAL BLOOD VESSEL

589

Hence, curvature for such angles has the following relation with
Ã:
κ≈

2b3
.
Ã2

(18)

As (16) and (18) indicate, for small curvature (i.e. small
crossover angle), κ has a linear relation with A (or Ã). However,
for large curvature (i.e., large crossover angle), κ is proportional
to the squared reciprocal of A (or Ã). We define the squared reciprocal of A as an approximation of curvature
κcp 

1
.
A2

(19)

Note that for small curvature, A is relatively large that results
in a κcp close to zero. Therefore, (19) should have satisfactory
accuracy for small curvature as well. For this reason, we consider
(19) it as a suitable alternative for (12). The test results of Section
III-C will manifest that this presumption is in fact valid.
3) Other Values of θc : As we will show with sufficient tests,
the metric κcp has sufficient accuracy for values which are neither close to 0 nor close to π/2. Therefore, no further expression
is required to treat such other angles.
B. Second Modification: Trigonometrical Method (κtr )
Returning to (13), if we neglect o(R3 cos3 θc ), we have the
following relation between θc and K:
K≈

2sinθc
2sinθc
=⇒ κ ≈
.
cos2 θc
bcos2 θc

(20)

Using (20), we can directly relate curvature to the crossover
angle. Hence, define
κtr 

2sinθc
.
1 − sin2 θc

Fig. 5. Curvature estimation with the template disk method (a) Drawing the
template disk. (b) Eliminating the inferior segment from inside the disk. (c)
Determining A, A c , and θc .

(21)

To compare the three curvature estimation methods, note that
the first two methods rely on area calculation which is a form
of integration. Therefore, we expect these two methods to be
resilient against noise and return smoother results. On the other
hand, to get accurate results using the third method, knowledge of the exact crossover point is a fundamental requirement.
Therefore, even quantization error may widely affect the results.
This phenomenon will be explored in the next section. However,
this method does not need area calculation which is an advantage in terms of implementation. Based on the aforesaid facts,
if we should deal with noise-free signals of relatively low curvature, κtr should produce better results. However, for signals
sampled in the presence of noise, κcp should function better.
C. Accuracy Examination Using Synthetic Functions
In this section, we compare the two modified template disk
methods with the basic method. To do so, we use synthetic
parabolas, circles and sinusoids. Note that even though for each
method the resultant range of values may be different, in our
analysis of tortuosity linear proportionality to real curvature is
of mere importance. Hence, all test results to be presented are
suitably normalized.

In order to estimate curvature for a point on the curve y =
f (x), first a circle with center (x, y) and radius b is depicted on
the curve [see Fig. 5(a)]. Next, the segment of the curve inside
the disk that is connected to the point (x, y) is saved and the
rest of the curve is eliminated [see Fig. 5(b)]. At this point, the
two areas confined within the disk and the curve are calculated.
The larger area is Ac and the smaller one is A. Moreover, the
crossover point of the curve and the disk is used to derive θc and
this angle is used for calculation of κtr .
1) Parabola: For a parabola y = cx2 with c > 0, curvature
for x = 0 using (1) is
κ = 2c.

(22)

Fig. 6 shows the estimated curvature versus analytical curvature
for 0.001  c  1.5 for four different template disk radii. As
can be seen (and this was shown beforehand) curvature and
κn l are not proportional. On the other hand, κcp and κtr elevate
linearly with analytical curvature. In fact, for small curvature, all
three methods show proportionality to real curvature. However,
as curvature increases, only the two modified methods maintain
their linearity. Note that the stepwise behavior of κtr is due to the
quantization of values of θc . For larger values of c, even small
changes in θc highly affect the denominator of (21). Therefore,
the quantization error for such values is significant.
2) Circle: To estimate curvature for a circle, assume the following equation for a circle that is tangent to the origin:
(y − r)2 + x2 = r2

rb

(23)

where r is the radius of the circle. Using (1), curvature at the
origin is
κ = 1/r.

(24)

Fig. 7 shows the estimated curvature versus analytic curvature
for 20  r  200 for three different values of b. Relatively low
values of curvature for a circle imply that all three methods
should return acceptable results. Note that κtr is still suffering
from quantization error.
3) Sinusoid: One of the functions that is commonly used for
examination of the accuracy of a tortuosity measure is a sinusoid.
If a sinusoid is given by y = Am sin(ωx), then curvature for
every point using (2) is




Am ω 2 sin(ωx)
.

(25)
|κ| = 
(1 + A2m ω 2 cos2 (ωx))3/2 

590

Fig. 6.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Estimated curvature with κ n l , κ c p , and κ t r versus actual curvature for a parabola.

5) Second Test: For this test, first a 500 × 500 pixel image
containing a sinusoidal curve is created. Next, the period of the
sinusoid is held fixed at 100 pixels and its amplitude is varied
from 50 to 200 pixels. For each method, mean curvature of each
image using a template disk of radius 11 is depicted in Fig. 9. As
the figure shows, elevation in average curvature with amplitude
increment is more apparent for κtr than κcp and κn l .
6) Third Test: For this test, the same image as the second test
was used. Only this time, the amplitude is fixed at 100 pixels and
the period is changed from 50 to 250 pixels. Using a template
disk of radius 11, mean curvature of each image was calculated
(see Fig. 10). As can be seen, proportionality between frequency
and curvature is better seen for κtr and κcp .
IV. TORTUOSITY EVALUATION

Fig. 7. Estimated curvature with κ n l , κ c p , and κ t r versus actual curvature
for a circle.

With three tests, we compare the analytical curvature with κn l ,
κcp , and κtr . In the first test, we compare (25) with the outcome
of the three methods for a specified frequency and amplitude. In
the next two tests, we employ an image of a sinusoid and observe
the effect of amplitude and frequency variation on the estimated
curvature. To do so, the average value of curvature for each
image is calculated. Note that as Grisan et al. [17] claim, increase
in amplitude or frequency should increase average curvature.
Detailed description of each test is given below.
4) First Test: Fig. 8 shows the graph of |κ| and results of
point-wise curvature calculation with each method for a sinusoid
with Am = 200 and ω = 2π/100, where b is 11 pixels. It is clear
that κcp is most similar to real curvature and curves of κtr and
κn l are very much alike.

In this section, we propose an algorithm for automatic evaluation of tortuosity in retinal images. Since curvature calculation
is the core of this algorithm, all three curvature estimation methods given in Section III are used so as to test their performance
in the algorithm. The algorithm contains the following steps:
1) Vessel detection.
2) Extraction of vascular skeleton.
3) Elimination of crossovers and bifurcations.
4) Local and global tortuosity measurement.
A. Vessel Detection
For vessel detection, we use the algorithm in [35]. To detect
a vessel map using this algorithm, first the green layer of the
RGB representation of the image is extracted. The significant
property of this plane is that the vessel and the background
possess the highest contrast. Next, this plane is divided into a
number of overlapping blocks and by placing a circular mask,
the Radon transform for each block is calculated. The angle
for which the local sinogram reaches its maximum value is the

AGHAMOHAMADIAN-SHARBAF et al.: NOVEL CURVATURE-BASED ALGORITHM FOR AUTOMATIC GRADING OF RETINAL BLOOD VESSEL

Fig. 8.

Point-wise estimated and analytical curvature for a sinusoid (b = 11, A m = 200, and ω = 2π/100 ).

Fig. 9.

Effect of amplitude increment on estimated average curvature for a sinusoid (b = 11 and ω = 2π/100) .

Fig. 10.

Effect of frequency increment on estimated average curvature for a sinusoid (b = 11 and A m = 100).

Fig. 11.

Vessel detection algorithm. (a) Retinal Image. (b) Vessel map.

direction perpendicular to a vessel. By verifying the presence
of a vessel, a linear approximation of the vessel is depicted
and Combination of these local linear vessels gives the vessel
network. Fig. 11 shows an image of a retina and the resultant
vessel map. Smoothing effect of Radon transform is the reason
why this method is so powerful in presence of noise.
B. Extraction of Vascular Skeleton
In order to use the curvature calculation methods described in
Section III, it is necessary to thin the vessel map and extract the
vessel skeleton. For this end, morphologic thinning algorithm
suggested in [36] is used.

Fig. 12.

591

Bifurcation and crossover detection for the vessel map of Fig. 11.

C. Elimination of Crossovers and Bifurcations
Bifurcation and crossover of the vessels could trouble the
tortuosity evaluation process. Therefore, prior to curvature estimation procedure, all areas containing bifurcation and crossover
should be eradicated. To detect such areas, a circle is drawn at
every point on the map and the number of crossovers of the disk
and the map is counted. If this number is three or four, bifurcation and/or crossovers in that area is detected. Fig. 12 shows
the outcome of implementing the algorithm for the vessel map
of Fig. 11.

592

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
BEST SRCC REPORTED BY [17] AND [37] FOR THE RET-TORT DATASET AND
SRCC FOR OUR ALGORITHM
Tortuosity Measure
Grisan
Quadratic polynomial decomposition [37]
τ c over chord length
τ s c over chord length
τs c
τc
Average angles [21]
τn l
τc p
τt r

Arteries

Veins

0.949
0.944
0.939
0.928
0.925
0.922
0.920
0.945
0.928
0.924

0.853
0.828
0.842
0.804
0.826
0.837
0.814
0.840
0.830
0.851

B. Vessel Network Tortuosity

D. Local and Global Tortuosity Measurement
To calculate global tortuosity of a vessel map, first local tortuosity for each point on the map is calculated using κn l , κcp ,
and κtr . Here, we propose the following formula for measuring
global tortuosity:
1 
κi
m i=1
m

τ=

Note that the results suggest a strong nonlinear relation between
perceived tortuosity of the arteries and curvature. However, the
relation for the veins is uncertain (both linear and nonlinear
metrics are comparable).

(26)

where κi denotes curvature for the ith point on the map and m
denotes the total number of points for which curvature is measured. Based on the three methods of local tortuosity calculation,
global tortuosity measures are called τn l , τcp , and τtr .
V. RESULTS AND CONCLUSION
In this section, we compare the performance of our algorithm
with the state of the art. Comparison is made both on the vessel level and on the vessel network level. We show that our
algorithm matches the best of the state of the art when tortuosity of single vessels is considered. Further, we compare our
method with subjective results for the vessel network case. To
assess correlation with subjective results, we use Spearman’s
rank correlation coefficient (SRCC), which is an indicator of
the linear relation between two datasets. Further, we report the
probability of null hypothesis (or p − value) for each case to
ensure that there is no stronger nonlinear relation between any
two compared datasets. Note that if this number is below 0.05,
it is guaranteed that no such nonlinear relation exists.
A. Vessel Level Tortuosity
To evaluate the vessel level performance of our algorithm,
we conducted it on the RET-TORT data bank. This data bank is
the image bank introduced by Grisan et al. [17] and contains 30
images of arteries and 30 images of veins, sorted based on the
tortuosity level of the images.
Table I shows SRCC for our algorithm and some of other state
of the art. It is apparent that τn l closely accommodates with the
expert’s opinion for the artery images. Further, τtr has the best
correlation for the vein images while τn l is a reliable choice as
well. Therefore, when tortuosity of single vessels is concerned,
Grisan’s algorithm and τn l are as good in terms of correlation.

An important purpose of introducing a tortuosity measurement algorithm is to calculate the entire vessel network tortuosity of the retina. Since on the vessel level test, Grisan’s algorithm
has the best performance, it is the best candidate for extension
to the vessel network case. To extend Grisan’s algorithm to the
entire vessel network, the following issues should be considered:
1) Since the algorithm is vessel based, identification and
separation of all vessels is most likely a requirement for
vessel network implementation. This is a tough and time
consuming task (see [38]).
2) In [17], Grisan has not specified how their algorithm deals
with vessel bifurcation and/or crossover. Specifically, for
vessel bifurcation, the assignment of tortuosity is not clear.
3) Grisan’s algorithm requires segmentation of a vessel based
on convexity change. Further, arc and chord length calculation of each segment is a requirement for measuring
the tortuosity of each vessel. Therefore, the algorithm requires two additional steps compared to ours to reach the
same level of correlation.
These are our objections to [17] when extension to the vessel
network case is considered. Finally, since [17], Grisan has only
manually segmented a vessel map to measure whole image tortuosity (e.g., [39]) and has not yet introduced a fully automatic
method (to our knowledge) for this task. Therefore, a quantitative comparison of our algorithm with Grisan’s is impossible
unless they extend their method to the vessel network case.
To evaluate the performance of our algorithm when measuring vessel network tortuosity in DR, we used a data bank
that contains ten full images of the retina with a 2050 × 1748
pixel resolution. This dataset is produced in Khatam-Al-Anbia
hospital of Mashhad and is sorted based on tortuosity by a number of experienced experts with focus on the subject of DR.
We have provided this dataset and the votes of the experts at
www.eiarg.um.ac.ir. In order to decrease the computational burden, we lowered the resolutions to 575 × 479. We should also
mention that the SRCC between the votes of the experts for
this dataset ranges from 0.758 to 0.964 (p-value < 0.01), which
suggests a fairly good agreement among experts.
Table II is a comparison of SRCC for the three metrics. As
the numbers indicate, τn l is strongly correlated with the experts’
opinion especially when the average vote is considered. This
excellent correlation manifests the power of our algorithm in
grading the tortuosity of retinal blood vessel networks. The
interesting point is that in this test, the nonlinear method is
more capable of following the opinion of each expert rather
than the linear methods. Hence, we conclude that the opinion
of an expert possesses a nonlinear relation with curvature (or a
linear relation with area A). In fact, when estimated curvature
maintains a linear relation with real curvature, results are of
weaker correlation.

AGHAMOHAMADIAN-SHARBAF et al.: NOVEL CURVATURE-BASED ALGORITHM FOR AUTOMATIC GRADING OF RETINAL BLOOD VESSEL

593

TABLE II
SRCC OF THE ESTIMATED VESSEL NETWORK TORTUOSITY WITH SUBJECTIVE
RESULTS FOR THE SECOND DATASET (p−VALUES< 6 × 10 −3 )

Exp. 1
Exp. 2
Exp. 3
Exp. 4
Exp. 5
Overall vote

τnl

τcp

τtr

0.939
0.939
0.903
0.891
0.818
0.946

0.927
0.891
0.903
0.7939
0.830
0.915

0.915
0.878
0.854
0.8788
0.866
0.925

Fig. 14. SRCC of each vote the experts with subjective results for the third
dataset (Note that the pair (i, j) on the horizontal axis denotes the ith vote of
the jth expert).

TABLE III
SRCC OF EACH METHOD WITH AVERAGE VOTE OF THE EXPERTS FOR THE
THIRD DATASET (p−VALUES< 0.002)

Fig. 13.

Boxplot of (a) interexpert correlation and (b) intraexpert correlation.

To evaluate the performance of our algorithm in measuring
the tortuosity of ROP images, we conducted it on a third data
bank that contains 120 full images of the retina. The goal of
the test is to determine the positive cases of ROP among the
images. All images of this dataset belong to preterm infants and
we have provided the dataset at www.eiarg.um.ac.ir. We asked
three ophthalmologists on three different occasions to give us
their opinion on existence of tortuosity by assigning one and
zero to the positive and the negative cases, respectively. Further,
we used the three methods to measure tortuosity for the entire
vessel network.
A full statistical analysis of the votes is given in Fig. 13.
As is clear from the figure, interexpert correlation is not high
enough to ensure sufficient consistency for each individual expert. Further, when correlation with other experts is considered,
a dramatic decline is observed. Therefore, we conclude that
when it comes to diagnosing the tortuosity of ROP, the problem
(as stated in [40] as well) is the absence of agreement among
experts rather than the metric itself. Irrespective of the above
discussion, as Fig. 14 indicates, τn l is most capable of following each vote of all experts. However, correlation is significant
for experts 1 and 3, and is relatively weak for expert 2. Moreover, if we consider 0.5 as a threshold for good correlation, it is
easy to see that while correlation between the experts is mostly
weak (see Fig. 13), τn l is (to a great extent) capable of keeping itself correlated with each individual expert at all occasions
(see Fig. 14). From another point of view, when the average
vote of each expert is considered, as Table III indicates, τn l
is superior to the other two methods and its correlation ranges
from good to strong. Finally, for the average vote of all experts,
SRCC for τn l is 0.701, which (considering the inconsistency of
the votes) suggests a strong correlation between the average vote
and this metric. This strong correlation manifests the capability

Exp. 1
Exp. 2
Exp. 3
Overall average vote

τnl

τcp

τtr

0.61
0.48
0.7
0.71

0.56
0.41
0.61
0.61

0.41
0.28
0.48
0.47

of our algorithm in determining the positive cases of tortuosity
in ROP images. Moreover, based on the results we have from all
three tests, we conclude that tortuosity and curvature possess a
nonlinear relation.
To compare the computation time of the given three algorithms, the total performance time of the algorithms on the ten
images of the second data bank was measured. The program
was written as single thread in MATLAB R2012 and was ran
on a computer with Corei5-3570K CPU. The running time for
all measures were approximately the same and was nearly 35 s
(3.5 s /image). We should mention that a MATLAB implementation of our algorithm is available at www.eiarg.um.ac.ir. We
encourage the research society to use our algorithms and publish their results. Further, we encourage using the two introduced
datasets for comparison tests in the future.
In this paper, we presented a fully automatic algorithm for
evaluating tortuosity in retinal images. Our algorithm is a
curvature-based algorithm. For curvature calculation, we used
the template disk method. We presented two modifications on
this method to correct the nonlinearity of template disk method
against curvature and assessed the linearity of results with numerous tests. Finally, we used all three methods for measuring
tortuosity of retinal images. In doing so, we showed that tortuosity has a nonlinear relation with curvature. No requirement for
classification of vessels as opposed to vessel based measures,
simplicity of the measure, low-computational burden, and an
excellent matching to the clinically perceived tortuosity of the
retinal blood vessels are the major features of the algorithm
proposed in this paper.

594

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

VI. FUTURE WORKS
We believe the following issues need more in-depth analysis
and consideration:
1) Relation Between Tortuosity of Arteries and Vessel Network Tortuosity: Note that both vessel network tortuosity and
tortuosity of arteries are highly correlated with a nonlinear function of curvature. Therefore, it seems that the state of arteries
have a major impact on vessel network tortuosity. This is due to
the observation that even though τn l does not follow the tortuosity of veins as well as the arteries, the vessel network tortuosity
is still very well followed by this metric.
2) Relation Between Nonlinear Curvature and Caliber of
Vessels: As Trucco et al. [10] claim, while measuring the tortuosity of a vessel network, more attention should be given to the
thicker vessels, which is possible by introducing a weighting
system. It seems that τn l provides such a weighting as wll. This
is due to the observation that usually thinner vessels are more
tortuous than thicker vessels and the fact that κn l saturates for
high curvature suggest a reduction of curvature for such vessels
(same as assigning a smaller weight to these vessels). Therefore,
the nonlinear method provides a natural filtering to ensure that
the assigned tortuosity to a vessel is related to the caliber of that
vessels. By proving this, we will be able to explain the reason
why tortuosity and curvature possess a nonlinear relation.
3) Fitting a Model to Veins and Arteries: Based on the results
for synthetic functions (see Section III-C), it seems that the best
mathematical model for a vein is a sinusoidal. For the arteries,
however, a parabola might be a better choice since τn l has the
best correlation with subjective results.
ACKNOWLEDGMENT
The authors would like to thank M. Abrishami and H. Hosseini (Retina Research Centre, Mashhad University of Medical
Sciences, Mashhad, Iran), M. K. Mathews (University of Maryland, College Park, MD, USA), S. Russell (University of Iowa,
Iowa City, IA, USA) and M. Rafieetary (Charles Eye Institute,
U.K.) for their kind and helpful assistance in manual grading of
tortuosity.
REFERENCES
[1] D. S. Fong, L. Aiello, T. W. Gardner, G. L. King, G. Blankenship,
J. D. Cavallerano, F. L. Ferris, and R. Klein, “Retinopathy in diabetes,”
Diabetes Care, vol. 27, no. suppl. 1, pp. s84–s87, 2004.
[2] H. R. Taylor and J. E. Keeffe, “World blindness: A 21 st century perspective,” Brit. J. Ophthalmol., vol. 85, no. 3, pp. 261–266, 2001.
[3] G. Quellec, M. Lamard, P. M. Josselin, G. Cazuguel, B. Cochener, and
C. Roux, “Optimal wavelet transform for the detection of microaneurysms in retina photographs,” IEEE Trans. Med. Imag., vol. 27, no. 9,
pp. 1230–1241, Sep. 2008.
[4] M. Sasongko, T. Wong, T. Nguyen, C. Cheung, J. Shaw, and J. Wang,
“Retinal vascular tortuosity in persons with diabetes and diabetic retinopathy,” Diabetologia, vol. 54, no. 9, pp. 2409–2416, 2011.
[5] M. Mizutani, T. S. Kern, and M. Lorenzi, “Accelerated death of retinal
microvascular cells in human and experimental diabetic retinopathy.” J.
Clinical Investigation, vol. 97, no. 12, p. 2883, 1996.
[6] D. K. Wallace, G. E. Quinn, S. F. Freedman, and M. F. Chiang, “Agreement
among pediatric ophthalmologists in diagnosing plus and pre-plus disease
in retinopathy of prematurity,” J. Amer. Assoc. Pediatric Ophthalmol.
Strabismus, vol. 12, no. 4, pp. 352–356, 2008.

[7] I. C. for the Classification of Retinopathy of Prematurity, “The international classification of retinopathy of prematurity revisited.” Archives
Ophthalmol., vol. 123, no. 7, p. 991, 2005.
[8] L. A. Wittenberg, N. J. Jonsson, R. P. Chan, and M. F. Chiang, “Computerbased image analysis for plus disease diagnosis in retinopathy of prematurity,” J. Pediatric Ophthalmol. Strabismus, vol. 49, no. 1, p. 11,
2012.
[9] C. M. Wilson, K. Wong, J. Ng, K. D. Cocker, A. L. Ells, and A. R. Fielder,
“Digital image analysis in retinopathy of prematurity: A comparison of
vessel selection methods,” J. Amer. Assoc. Pediatric Ophthalmol. Strabismus, vol. 16, no. 3, pp. 223–228, 2012.
[10] E. Trucco, H. Azegrouz, and B. Dhillon, “Modeling the tortuosity of retinal
vessels: Does caliber play a role?” IEEE Trans. Biomed. Eng., vol. 57,
no. 9, pp. 2239–2247, Sep. 2010.
[11] W. Lotmar, A. Freiburghaus, and D. Bracher, “Measurement of vessel
tortuosity on fundus photographs,” Albrecht von Graefes Archiv Für Klinische und Experimentelle Ophthalmologie, vol. 211, no. 1, pp. 49–57,
1979.
[12] C. Heneghan, J. Flynn, M. OKeefe, and M. Cahill, “Characterization of
changes in blood vessel width and tortuosity in retinopathy of prematurity
using image analysis,” Med. Image Anal., vol. 6, no. 4, pp. 407–429, 2002.
[13] W. E. Hart, M. Goldbaum, B. Côté, P. Kube, and M. R. Nelson, “Measurement and classification of retinal vascular tortuosity,” Int. J. Med.
Informatics, vol. 53, no. 2, pp. 239–252, 1999.
[14] M. Perez, A. Highes, A. Stanton, S. Thorn, N. Chapman, A. Bharath, and
K. Parker, “Retinal vascular tree morphology: A semi-automatic quantification,” IEEE Trans. Biomed. Eng., vol. 49, no. 8, pp. 912–917, Aug.
2002.
[15] P. Benitez-Aguirre, M. E. Craig, M. B. Sasongko, A. J. Jenkins, T. Y. Wong,
J. J. Wang, N. Cheung, and K. C. Donaghue, “Retinal vascular geometry predicts incident retinopathy in young people with type 1 diabetes
a prospective cohort study from adolescence,” Diabetes Care, vol. 34,
no. 7, pp. 1622–1627, 2011.
[16] E. Bullitt, G. Gerig, S. Pizer, W. Lin, and S. Aylward, “Measuring tortuosity of the intracerebral vasculature from MRA images,” IEEE Trans.
Med. Imag., vol. 22, no. 9, pp. 1163–1171, Sep. 2003.
[17] E. Grisan, M. Foracchia, and A. Ruggeri, “A novel method for the automatic grading of retinal vessel tortuosity,” IEEE Trans. Med. Imag.,
vol. 27, no. 3, pp. 310–319, Mar. 2008.
[18] M. Patasius, V. Marozas, A. Lukosevicius, and D. Jegelevicius, “Evaluation of tortuosity of eye blood vessels using the integral of square of
derivative of curvature,” in Proc. EMBEC, 2005, vol. 5, pp. 20–25.
[19] R. Crosby-Nwaobi, L. Z. Heng, and S. Sivaprasad, “Retinal vascular
calibre, geometry and progression of diabetic retinopathy in type 2 diabetes
mellitus,” Ophthalmologica, vol. 228, no. 2, pp. 84–92, 2012.
[20] M. B. Sasongko, T. Y. Wong, T. T. Nguyen, R. Kawasaki, A. J. Jenkins,
J. Shaw, C. Robinson, and J. J. Wang, “Serum apolipoproteins are associated with systemic and retinal microvascular function in people with
diabetes,” Diabetes, vol. 61, no. 7, pp. 1785–1792, 2012.
[21] K. Chandrinos, M. Pilu, R. Fisher, and P. Trahanias, “Image processing
techniques for the quantification of atherosclerotic changes,” UK: University of Edinburgh, DAI Res. Paper, 1998.
[22] K. G. Goh, W. Hsu, M. Li Lee, and H. Wang, “Adris: An automatic
diabetic retinal image screening system,” Stud. Fuzziness Soft Comput.,
vol. 60, pp. 181–210, 2001.
[23] A. Kaupp, H. Toonen, S. Wolf, K. Schulte, R. Effert, D. Meyerebrecht,
and M. Reim, “Automatic evaluation of retinal vessel width and tortuosity
in digital fluorescein angiograms,” Investigative Ophthalmol. Visual Sci.,
vol. 32, no. 4, pp. 863–863, 1991.
[24] F. Ghadiri, H. Pourreza, T. Banaee, and M. Delgir, “Retinal vessel tortuosity evaluation via circular hough transform,” in Proc. 18th Iranian Conf.
Biomed. Eng., Dec. 2011, pp. 181–184.
[25] F. Ghadiri, S. Zabihi, H. Pourreza, and T. Banaee, “A novel method for
vessel detection using contourlet transform,” in Proc. Nat. Conf. Commun.,
Feb. 2012, pp. 1–5.
[26] D. K. Wallace, S. F. Freedman, and Z. Zhao, “Evolution of plus disease
in retinopathy of prematurity: Quantification by roptool,” Trans. Amer.
Ophthalmological Soc., vol. 107, pp. 47–52, 2009.
[27] G. Dougherty and J. Varro, “A quantitative index for the measurement
of the tortuosity of blood vessels,” Med. Eng. phys., vol. 22, no. 8,
pp. 567–574, 2000.
[28] C. Eze, R. Gupta, and D. Newman, “A comparison of quantitative measures of arterial tortuosity using sine wave simulations and 3d wire models,” Phys. Med. Biol., vol. 45, no. 9, pp. 2593–2599, 2000.

AGHAMOHAMADIAN-SHARBAF et al.: NOVEL CURVATURE-BASED ALGORITHM FOR AUTOMATIC GRADING OF RETINAL BLOOD VESSEL

[29] A. A. Kalitzeos, G. Y. Lip, and R. Heitmar, “Retinal vessel tortuosity
measures and their applications,” Exp. Eye Res., vol. 106, pp. 40–46,
2013.
[30] M. P. Do Carmo and M. P. Do Carmo, Differential Geometry of Curves
and Surfaces, vol. 2. Englewood Cliffs, NJ, USA: Prentice-Hall, 1976.
[31] P. J. Flynn and A. K. Jain, “On reliable curvature estimation,” in Proc.
IEEE Conf. Comput. Vis. Pattern Recog., 1989, vol. 89, pp. 110–116.
[32] D. Coeurjolly, S. Miguet, and L. Tougne, “Discrete curvature based on
osculating circle estimation,” in Proc. 4th Int. Workshop Vis. Form, 2001,
pp. 303–312.
[33] J. Bullard, E. Garboczi, W. Carter, and E. Fuller Jr, “Numerical methods
for computing interfacial mean curvature,” Comput. Mater. Sci., vol. 4,
no. 2, pp. 103–116, 1995.
[34] O. I. Frette, G. Virnovsky, and D. Silin, “Estimation of the curvature of
an interface from a digital 2d image,” Comput. Mater. Sci., vol. 44, no. 3,
pp. 867–875, 2009.
[35] R. Pourreza, T. Banaee, H. Pourreza, and R. D. Kakhki, “A radon transform
based approach for extraction of blood vessels in conjunctival images,” in
Proc. Adv. Artif. Intell., 2008, pp. 948–956.
[36] Z. Guo and R. W. Hall, “Parallel thinning with two-subiteration algorithms,” Commun. ACM, vol. 32, no. 3, pp. 359–373, 1989.
[37] A. Chakravarty and J. Sivaswamy, “A novel approach for quantification
of retinal vessel tortuosity using quadratic polynomial decomposition,” in
Proc. Indian Conf. Med. Inform.Telemed., Mar. 2013, pp. 7–12.
[38] Q. Lau, M. L. Lee, W. Hsu, and T. Y. Wong, “Simultaneously identifying
all true vessels from segmented retinal images,” IEEE Trans. Biomed Eng.,
vol. 60, no. 7, pp. 1851–1858, Jul. 2013.
[39] E. Poletti, E. Grisan, and A. Ruggeri, “Image-level tortuosity estimation
in wide-field retinal images from infants with retinopathy of prematurity,” in Proc. Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., Aug. 2012,
pp. 4958–4961.
[40] D. K. Wallace, G. E. Quinn, S. F. Freedman, and M. F. Chiang, “Agreement
among pediatric ophthalmologists in diagnosing plus and pre-plus disease
in retinopathy of prematurity,” J. Amer. Assoc. Pediatric Ophthalmol.
Strabismus, vol. 12, no. 4, pp. 352–356, 2008.

Masoud Aghamohamadian-Sharbaf was born in
1990. He received the B.Sc. degree in electrical
engineering from Ferdowsi University of Mashhad
(FUM) in 2012. He is currently working toward the
M.Sc. degree in communication systems at the Ferdowsi University of Mashhad (FUM), Mashhad, Iran.
He is also with the Vision Laboratory at FUM
and the Eye Image Analysis Research Group. His
research interest includes optimization theory, frame
theory, information theory, and possible applications
of the latter two fields in biomedical engineering.

595

Hamid Reza Pourreza (SM’12) received the M.Sc.
degree in electrical engineering and the Ph.D. degree
in computer engineering from Amirkabir University
of Technology, Tehran, Iran, in 1993 and 2002, respectively.
He is currently an Associate Professor with the
Department of Computer Engineering, Ferdowsi University of Mashhad, Mashhad, Iran. His research interests include image processing and machine vision.
He is one of the Founders and an active Member of
Eye Image Analysis Research Group.

Touka Banaee received the Graduation degree in
general medicine from the Mashhad University
of Medical Sciences (MUMS) in 1993 and completed her fellowship in vitreoretina at Medical Center of Shahid Beheshti University of Medical Sciences,Tehran, Iran in 2001.
She is an Ophthalmologist and a Fellow in vitreoretinal diseases and surgeries. She has been a Faculty
Member at the School of Medicine, Mashhad University of Medical Sciences (MUMS), Mashhad, Iran,
since 2001. As a Consultant in ophthalmology, she
has since been actively involved in the undergraduate, residency, and fellowship
programs of ophthalmology. She is one of the Founders and an active Member
of Eye Research Center and Retina Research Center of MUMS and the Eye Image Analysis Research Group. She has more than 50 national and international
papers, and has participated in more than 90 national or international presentations. Her research interests include diabetic retinopathy, image processing in
retinal diseases, and vitreoretinal surgeries.

