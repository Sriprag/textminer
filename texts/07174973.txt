IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

431

Dynamic 3-D MR Visualization and Detection
of Upper Airway Obstruction During Sleep
Using Region-Growing Segmentation
Ahsan Javed∗ , Student Member, IEEE, Yoon-Chul Kim, Michael C. K. Khoo, Fellow, IEEE, Sally L. Davidson Ward,
and Krishna S. Nayak, Senior Member, IEEE

Abstract—Goal: We demonstrate a novel and robust approach
for visualization of upper airway dynamics and detection of obstructive events from dynamic 3-D magnetic resonance imaging
(MRI) scans of the pharyngeal airway. Methods: This approach
uses 3-D region growing, where the operator selects a region of
interest that includes the pharyngeal airway, places two seeds in
the patent airway, and determines a threshold for the first frame.
Results: This approach required 5 s/frame of CPU time compared
to 10 min/frame of operator time for manual segmentation. It compared well with manual segmentation, resulting in Dice Coefficients
of 0.84 to 0.94, whereas the Dice Coefficients for two manual segmentations by the same observer were 0.89 to 0.97. It was also able
to automatically detect 83% of collapse events. Conclusion: Use of
this simple semiautomated segmentation approach improves the
workflow of novel dynamic MRI studies of the pharyngeal airway and enables visualization and detection of obstructive events.
Significance: Obstructive sleep apnea (OSA) is a significant public
health issue affecting 4–9% of adults and 2% of children. Recently,
3-D dynamic MRI of the upper airway has been demonstrated
during natural sleep, with sufficient spatiotemporal resolution to
noninvasively study patterns of airway obstruction in young adults
with OSA. This study makes it practical to analyze these long scans
and visualize important factors in an MRI sleep study, such as the
time, site, and extent of airway collapse.
Index Terms—Biomedical image processing, image segmentation, magnetic resonance imaging (MRI), medical diagnostic imaging, sleep apnea.

Manuscript received February 11, 2015; revised June 15, 2015 and July 10,
2015; accepted July 17, 2015. Date of publication August 3, 2015; date of current
version January 16, 2016. This work was supported by the National Institutes
of Health under Grant R01-HL105210. The work of Y.-C. Kim was supported
by American Heart Association postdoctoral fellowship (13POST17000066).
Asterisk indicates corresponding author.
∗ A. Javed is with the Ming Hsieh Department of Electrical Engineering,
Viterbi School of Engineering, University of Southern California, Los Angeles,
CA 90089 USA (e-mail: ahsanjav@usc.edu).
Y.-C. Kim was with the Ming Hsieh Department of Electrical Engineering,
Viterbi School of Engineering, University of Southern California. He is now
with the Samsung Medical Center.
M. C. K. Khoo is with the Department of Biomedical Engineering, Viterbi
School of Engineering, University of Southern California.
S. L. Davidson Ward is with the Department of Pediatrics, Keck School of
Medicine, University of Southern California, Children’s Hospital Los Angeles.
K. S. Nayak is with the Ming Hsieh Department of Electrical Engineering
and the Department of Biomedical Engineering, Viterbi School of Engineering, University of Southern California.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2462750

I. INTRODUCTION
BSTRUCTIVE sleep apnea (OSA) syndrome is a common breathing disorder in which the airflow pauses during
sleep due to physical collapse of pharyngeal airway [1]. It affects
approximately 4–9% of adults [2] and 2% of children [3] in the
United States; in particular, OSA has been reported in 13–66%
of obese children [4]. OSA is linked to decreased productivity, accidents, and increased risk of cardiovascular disease [5].
It is widely recognized that determining the accurate location
of obstruction sites may benefit treatment planning and patient
outcome [6].
The current gold standard for diagnosing OSA is overnight
polysomnography (PSG). PSG involves monitoring and continuously recording several physiological signals that reflect sleep
and breathing, for roughly 7–8 h. The single most important
output of overnight PSG is the apnea-hypopnea index (AHI)—
the average number of complete or partial obstructive events
that occur per hour during sleep. PSG also helps to elucidate the
impact of these events on sleep pattern and gas exchange. An
overnight PSG requires interpretation by a skilled sleep specialist for visual scoring; in contrast, computer scoring has not been
proven accurate.
Objective monitoring is required because patient history and
physical findings suggestive of OSA are not considered sufficiently sensitive or specific to make a diagnosis. Often, uncomplicated cases of OSA in children can be diagnosed and treated
with removal of the tonsils and adenoids or by the provision
of positive airway pressure therapy. While PSG provides a detailed physiologic diagnosis, no information regarding the site,
or sites, of obstruction can be inferred from the recording. This
is especially important for complicated cases of OSA, including
obesity and craniofacial abnormalities. In these cases, surgical
intervention directed at relieving sites of obstruction may be
needed.
Endoscopy is one imaging approach that provides site information. It involves the use of cameras inserted through the
nose, and anesthesia to mimic sleep, hence the alternative name
drug-induced sleep endoscopy. Endoscopy provides information
about one site of obstruction and nothing distal to it. Furthermore, it cannot replicate natural sleep or the various sleep cycles
or sleep stages.
Magnetic resonance imaging (MRI) is an alternative imaging approach that has shown significant potential for airway
assessment and collapse site identification in these patients. It is

O

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

432

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

noninvasive, involves no ionizing radiation, and can resolve all
relevant soft tissues in three dimensions. It has been shown to
yield valuable insight into the dynamics and shape of airways
for patients with OSA [7]–[9], and the primary limitation until
now has been imaging speed.
Previous MRI studies have focused on static 3-D or dynamic
2-D imaging that can easily be performed on current clinically
available MRI scanners [10]. Static 3-D MRI provides a complete picture of the upper airway (UA) anatomy in patients with
sleep disorders [7], but does not depict changes with tidal breathing or during collapse events. Wagshul et al. recently showed
that tidal breathing could be resolved using retrospective gating
[11]; however, this approach would not apply to collapse events.
Single- and multislice dynamic imaging captures the dynamics
of tidal breathing [12] and collapse events [13], [14]. These
methods suffer from gaps in coverage and are susceptible to
imperfect placement of the imaging slices.
Recently, real-time 3-D UA MRI during natural sleep has
been demonstrated with 1.6–2.0 mm isotropic spatial resolution,
two temporal frames per second, and synchronized recording of
physiological signals [15], [16]. Each scan provides between
240 and 2400 temporal frames, corresponding to 2–20 min of
continuous recording. In these studies, the shorter 2-min scans
were used for tests that involve a stimulus to encourage collapse [13], whereas longer 20-min scans were used to capture
natural collapse events. We anticipate a potential need for even
longer scans, on the order of hours, for the study of sleep state
changes. With such large 3-D dynamic datasets, analysis becomes a significant bottleneck. Using software assistance, manual UA segmentation requires roughly 10 min per 3-D volume.
Visual inspection of all data is not practical, and therefore, automated segmentation and collapse detection tools could provide
significant value. Such tools would enable identification of time
periods of airway obstruction, visualization of collapse sites,
and volumetric analysis of airway changes.
Previously, automatic segmentation of the UA has been applied to 3-D computed tomography (CT) and MR images. Threedimensional static CT images of the UA were segmented for
volumetric analysis using level-set-based deformable models
[17] and region-growing algorithm [18], [19]. In [3] and [20],
static 3-D T2-weighted MR images were segmented using a
fuzzy connectedness-based algorithm that required 4 min/study.
This framework required significant operator and processing
time, even for short scans. More recently, Wagshul et al. used
threshold-based segmentation to segment and depict 3-D UA images of tidal breathing [11]. Their static 3-D and retrospectively
gated UA images had significantly higher contrast-to-noise ratio (CNR) and reduced artifacts compared to what is seen in
real-time 3-D UA MRI. Additionally, these previous methods
were not designed for or applied to collapsed airways.
In this study, we demonstrate visualization of UA dynamics
and detection of natural obstructive apneas during sleep. The key
development is a method for semiautomated analysis of realtime 3-D UA MRI using multiseeded 3-D region growing [21].
Region growing was chosen for its simplicity to demonstrate a
new application where segmentation facilitates the workflow of
a novel study. Multiple seeds were found to enable more accurate

segmentation and visualization during collapse events when the
airway is divided into two (or more) patent sections. We narrow
the analysis volume to just the pharyngeal airway and propagate
seeds from one time frame to the next using the observation that
the nasal cavity and base of the airway remain patent at all
times. We demonstrate that this approach performs as well as
manual segmentation. Errors were comparable to intraoperator
variability of manual segmentation. We also show that it enables
analysis of long scans and visualization of important factors in
an MRI sleep study, such as the time, site, and extent of airway
collapse.
II. METHODS
A. Segmentation and Analysis
Fig. 1 illustrates the proposed segmentation approach. A reference frame is selected to be the first frame with a visibly
patent airway in each dataset. A region of interest (ROI) is selected from the hard palate to the epiglottis in the mid-sagittal
slice of the reference frame as shown in Fig. 1(a). Two seeds are
placed within the mid-sagittal slice: one in the nasopharyngeal
airway and the other in the oropharyngeal airway as shown in
Fig. 1(a). The first frame is segmented using multiseeded 3-D
region growing [21]. The threshold is manually set to separate
air and tissue signals in the ROI, which was between 7th and
15th percentiles of pixel intensities for all cases studied. Seeds
for subsequent frames are generated automatically by dividing
segmented airway into five sections and placing two new seeds
for the next time frame at the centroid of the subsections with
the largest volume, as illustrated in Fig. 1(a). The two initial
seeds plus the two new seeds are used for segmentation. This
process repeats until all frames are processed. Segmentation is
performed using an open-source implementation of multiseeded
3-D region growing [22] in MATLAB (MathWorks Inc., Natick,
MA, USA).
The images have nonzero intensity in the airway, due to noise,
which results in underestimation of the patent airway. This could
also result in false positive collapse detection if the threshold is
set too low. Therefore, the initial threshold is increased by an
operator-determined ΔT and segmentation is repeated with an
updated threshold if two conditions are met: 1) if a collapse is
detected; and 2) if the threshold is less than the original threshold
plus 10ΔT. This process is repeated until one of the conditions
becomes false or the volume of the mask with updated threshold
is greater than the original volume plus 1 cm3 . We found that
this significantly improved collapse detection. If the collapse is
detected for all thresholds, the mask from the original threshold
is used. However, if the collapse is resolved by updating the
threshold, the mask from the updated threshold value is saved
and is used to generate seeds for the subsequent frame.
When the airway is patent, region growing results in a single
contiguous region. Airway collapse is, therefore, detected based
on the existence of two (or more) disconnected regions that were
larger than 0.2 cm3 . This threshold excludes small-disconnected
regions that are not part of the airway. The binary airway collapse waveform can be displayed alongside other physiological recordings. Three-dimensional renderings of airway were

JAVED et al.: DYNAMIC 3-D MR VISUALIZATION AND DETECTION OF UPPER AIRWAY OBSTRUCTION DURING SLEEP

433

Fig. 1. Segmentation Procedure. (a) Graphical representation of ROI placement, seed placement, and division of airway into five sections for generation of new
seeds. (b) Flowchart illustrating the entire procedure. An ROI is manually selected (red), two seeds are placed within the ROI, and a threshold (Torig) is determined
based on the first frame. The first frame is segmented using automatic region growing (green). The threshold is increased by ΔT and segmentation is repeated if
volume of airway is less than the segmented volume using original threshold plus ΔV, collapse is detected, and threshold is less than original threshold plus 10ΔT.
Two new seeds for subsequent frames are generated using segmented masks.

TABLE I
PATIENT INFORMATION
Patient Info

Polysomnography

#

Age/Sex

BMI

oAHI∗

1
2
3
4
5
6
7
8
9
10

14/F
16/M
14/M
17/F
14/F
14/F
17/F
20/F
13/F
15/M

45.0
30.0
23.7
26.9
30.2
32.8
32.0
24.9
32.0
29.2

0.3
0.2
4.0
1.7
2.5
1.1
2.0
4.0
70
0.7

Phenotype
Primary snorer
High Arousal
Sleep related hypoxemia/hypoventilation
Primary snorer
Sleep related hypoxemia/hypoventilation
Primary snorer
Sleep related hypoxemia/hypoventilation
Sleep related hypoxemia/hypoventilation
Obstructive sleep apnea
Primary snorer

∗
OAHI = Obstructive apnea hypopnea index (i.e., # of events per hour) measured
from an overnight polysomnography. The use case columns show that subjects 1
and 2 were used for dice coefficient analysis and subject 3 was used for testing
the accuracy of collapse detection.

generated for frames before, during, and after collapse events,
using MATLAB.
B. Evaluations
Dynamic 3-D UA data were analyzed from 3-D RT-MRI sleep
studies in ten adolescents with sleep-disordered breathing, described in Table I. Our Institutional Review Board approved the
imaging protocol, and written informed consent was provided.
Images were acquired using a 3-D Fourier transform gradient

echo sequence with golden angle radial view order, and constrained reconstruction, as described by Kim et al. [15], [16].
Relevant imaging parameters for short scans are: scan time
2 min, field of view (FOV) 16.0 × 12.8 × 6.4 cm3 ; spatial resolution 1.6 × 1.6 × 1.6 mm3 , echo time (TE) 1.74 ms, and TR
3.88 ms. Relevant imaging parameters for long scans are: scan
time 14–18 min, FOV 20.0 × 16.0 × 8.0 cm3 ; spatial resolution 2.0 × 2.0 × 2.0 mm3 , TE 1.72 ms, and TR 6.02 ms. The
body coil was used for radio frequency transmission, and a sixchannel carotid coil was used for signal reception.
Respiratory effort, heart rate, oxygen saturation, and mask
pressure were recorded during the MRI scan as described by
Kim et al. [15]. Two respiratory transducers placed over the
abdomen were used to measure respiratory effort. An optical fingertip plethysmograph (Biopac Inc., Goleta, CA, USA)
was used to measure oxygen saturation and heart rate. A facial mask (Hans Rudolph Inc., Kansas City, MO, USA) along
with a Validyne pressure transducer (Validyne Engineering Inc.,
Northridge, CA) was used to measure airway pressure at the
mouth and for airway occlusion test.
Segmentation accuracy was evaluated using manual segmentation as the gold standard. Ten datasets were chosen from the
work of Kim et al. [15], [16]. These provided a range of expected data quality for this nascent imaging approach. In five
patients (Patients # 1, 2, 8, 9, and 10), inspiration was blocked
for three breaths as part of an airway compliance test [13]. In
all other patients, the scan was performed during free breathing.
Each dynamic 3-D dataset was segmented using semiautomated
3-D pharyngeal airway segmentation. Twelve frames were

434

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

selected and manually segmented twice by one MR physicist
with knowledge of the UA anatomy.
Dice coefficient analysis [23] was used to compare the
semiautomatic segmentations with manual segmentations and
to evaluate the intraoperator variability of manual segmentation. Manual segmentations were performed using a commercial package (Slice-o-Matic, TomoVision Inc. Magog, Canada).
For two segmented volumes A and B, the DC is given by
(2 |A + B|) / (|A| + |B|) and quantifies the amount of overlap
between the two sets. The DC ranges from 0 to 1, where 1 signifies exact overlap between A and B, and 0 signifies no overlap.
A DC of 0.85 or greater is considered to be “very good.”
DC analysis was also used to evaluate differences in estimated
airway clearance between manual and semiautomatic segmentations at four different axial cross sections of the UA. The
locations were chosen to be at the level of the uvula, because
that is where the airway is typically the narrowest and is where
we have observed the largest number of collapse events in our
patient cohort.
Sensitivity of the method to seed selection was also evaluated
using ten different pairs of seed points to segment each dataset
with semiautomated segmentation. DC analysis was used to
compare the different semiautomated segmentations.
Five long datasets during natural sleep, each 18–22 min and
1500–1800 frames, were selected to demonstrate visualization
of airway dynamics and detection of collapse events. These particular datasets were more likely to contain central and obstructive apnea events. A clinical sleep expert identified these events
using physiological signals acquired during the MRI scan. Obstructive apneas were identified based on the presence of respiratory effort detected by respiratory bellows with no change
in mask pressure measured at the mouth. Central apneas were
identified by the absence of respiratory effort coincident with no
change in mask pressure. The timing of obstructive events was
compared to the events detected by automatic collapse detection.
III. RESULTS
Semiautomated segmentation of 2 min of data (240 frames)
required 2 min of operator time, and 20 min of CPU time (Intel Xeon 2.93 GHz, 192-GB RAM). Manual segmentation of
6 s of data (12 frames) required roughly 2 h (10 min/frame).
Table II contains Dice Coefficients and Table I contains baseline subject information, sleep-disordered breathing phenotype,
and MRI analysis of airway collapse. DC for manual versus
manual was comparable to DC for manual versus automatic for
both the ROI and airway clearance at four slices around the
uvula. The accuracy of semiautomated segmentation was comparable to the intraoperator variability of manual segmentation.
The method was not sensitive to initial seed placement resulting
in DC of 1 for all the semiautomated segmentations performed
using different initial seeds.
The DC values for manual versus automatic segmentation
were low (<0.85) for 22% (9/40) of 2-D slices. These slices
had narrow airway clearance. Because the segmented airway
consisted of less than 175 pixels in these slices, very small
segmentation errors result in lower DC values.

TABLE II
DICE COEFFICIENT COMPARISON OF SEMIAUTOMATIC
AND MANUAL SEGMENTATION
#

Manual versus Manual

Manual versus Automated

1
2
3
4
5
6
7
8
9
10

0.95
0.94
0.97
0.97
0.89
0.91
0.94
0.94
0.95
0.94

0.87, 0.87
0.84, 0.85
0.93,0.94
0.87,0.86
0.86,0.91
0.92,0.94
0.91,0.91
0.92,0.89
0.93,0.94
0.91,0.93

A DC of 0.85 or greater indicates good agreement. First
column contains patient numbers from Table I.

TABLE III
DICE COEFFICIENT COMPARISON OF AIRWAY CLEARANCE BETWEEN
SEMIAUTOMATED AND MANUAL SEGMENTATION USING FOUR AXIAL SLICES
#

Manual versus Manual

Manual versus Automated

1
2
3
4
5
6
7
8
9
10

0.88,0.93,0.95,0.96
0.91,0.84,0.96,0.96
0.98,0.97, 0.98,0.95
0.95,0.96,0.97,0.96
0.87,0.86,0.91,0.91
0.88,0.90,0.95,0.93
0.93,0.93,0.92,0.97
0.93,0.91,0.93,0.96
0.97,0.94,0.91,0.91
0.96,0.96,0.95,0.93

0.72,0.86,0.89,0.88
0.74,0.63,0.89,0.91
0.95,0.93,0.94,0.90
0.79,0.86,0.89,0.83
0.85,0.71,0.81,0.92
0.92,0.93,0.96,0.94
0.87,0.85,0.87,0.94
0.88,0.81,0.83,0.93
0.95,0.92,0.89,0.90
0.94,0.94,0.94,0.91

DC values for all four slices are shown. In column 3, the
average of DC for semiautomated and the two manual segmentations is shown. A DC of 0.85 or greater indicates
good agreement. First column contains patient numbers from
Table I.

Natural obstructive events were observed in two Patient’s scan
data (patients 3 and 10 from Table I). Patient 10 only showed
1 naturally occurring obstructive event. Patient 3 was used to
test automatic collapse detection because he showed the most
number of naturally occurring collapses. Of the 18 obstructive
events, 15 were detected automatically. Of the three cases where
obstructive events were not detected, two suffered from poor
image quality and one showed a narrowed but patent airway. In
addition, there were nine false positives. A series of consecutive
frames showing collapse was regarded as an event. False positive
events had at most four frames of consecutive collapse compared
to 15 or more frames in actual events with the exception of two
true events that had four and eight consecutive frames showing
collapse due to poor image quality.
Fig. 2 contains surface renderings illustrating UA dynamics
during one collapse from validation Subject 1. Such anatomical
information along with other physiological signals can be used
for treatment planning and to monitor treatment outcome. The
information from the plots of airway collapse also makes it easier
to navigate to frames that show airway collapse and allows
for more efficient data processing. In Fig. 2, collapses were
observed in three frames for manual segmentation 1 and in

JAVED et al.: DYNAMIC 3-D MR VISUALIZATION AND DETECTION OF UPPER AIRWAY OBSTRUCTION DURING SLEEP

435

Fig. 2. Visualization of a retropalatal airway collapse event during natural
sleep. (a) Automatic segmentation. (b) Manual segmentation #1. (c) Manual
segmentation #2.The manual segmentations differ in the number of collapse
frames detected due to low contrast-to-noise ratio in the image data from patient 1 .The number of detected collapse frames in automatic segmentation are
comparable to manual segmentations.

two frames for manual segmentation 2. This was due to the
difficulty in segmenting airway with high signal intensity that
made it difficult for the operator to decide if a particular region
is part of the airway or tissue.
Figs. 3 and 4 show data from patients experiencing a natural central apneic event, and a natural mixed apneic event,
respectively. Mixed apneic event consists of a central apnea followed by an obstructive apnea in this case. The volume plot
and binary collapse plot are displayed along with physiological
signals to simplify the process of identifying and classifying
events. Obstructive events are identified based on the presence
of respiratory effort detected by respiratory bellows with no
change in mask pressure measured at the mouth. Central events
were identified by the absence of respiratory effort coincident
with no change in mask pressure. In Fig. 3, the decrease in airway volume, flat respiratory effort (black arrows), zero mask
pressure, and subsequent decrease in oxygen saturation indicate
a central apneic event that resulted in airway narrowing, shown
by the volume plot and visualizations. In Fig. 4, flat respiratory
effort and zero mask pressure indicate a central apnea followed
by fluctuations in respiratory effort in the abdomen, zero mask
pressure, and the binary collapse plot (black arrows) indicating
an obstructive apneic event. The binary collapse plot makes it
easier to navigate to collapse events and the visualizations allow
us to observe the precise site and extent of collapse.
IV. DISCUSSION
The proposed semiautomated segmentation drastically reduces the processing time of 3-D real-time UA MRI. It takes a
trained operator approximately 10 min/frame to perform manual
segmentation, not including training time. Comparatively, semiautomated segmentation requires just 2 min of operator time,
and 5 s of CPU time per frame. For a typical dataset containing
1800 frames, manual segmentation would require 100+ h, while
semiautomated segmentation requires 2 min of manual adjust-

Fig. 3. Example use from a 14/M with central apnea event. Waveforms shown
are (a) abdominal respiratory effort, (b) oxygen saturation, (c) heart rate, (d)
mask pressure, (e) normalized volume (f) collapse, and (g) 3-D visualizations.
The first four (a)–(d) were simultaneously measured during an MRI scan, and
(e)–(g) were displayed based on calculations from segmented masks using the
proposed approach. The light blue background in (a)–(e) highlights the durations
of the central apneas. The black arrows indicate flat bellow signal, zero mask
pressure, and the drop in volume. The apneas are followed by drop in oxygen
saturation indicated by the green arrows. The colored lines in (f) represent times
when the visualizations of UA were generated. The red arrow in visualizations
points to site of airway narrowing during the apneic event. In (f), black indicates
a patent airway.

ments in the initial frame and 3 h of CPU time in subsequent
frames.
The specific data acquisition and reconstruction methods used
in this study are nascent and evolving. Optimal k-space sampling patterns and reconstruction constraints have not yet been
determined, and may improve the underlying image quality. The
current images do have residual signal in the airway, suffer from
coil roll off in the head-foot direction, suffer from motion artifacts in frames acquired during arousal following an apneic
event, and appear spatially blurred in some frames. These quality issues make automated segmentation with high accuracy
a challenging problem. As the acquisition and reconstruction
methods are improved so will the accuracy of segmentation due
to the improvement in image quality.
Rapid involuntary motion such as that following an arousal
after and apneic event or from swallowing will result in motion
artifacts. We did not address these artifacts in the present study;
however, they may be resolved by identification and rejection
of some temporal frames, or by incorporating nonrigid motion
correction into the MRI acquisition and reconstruction methods.
Another limitation of the RT-MRI approach is that the scanning itself is loud and subjects have reported difficulty falling
asleep. Currently, the sleep state is determined by manual inspection of heart rate, mask pressure, oxygen saturation, and
respiratory signals by experienced pediatric pulmonologists. A

436

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 4. Example use from a 14/M with obstructive apnea event. Waveforms
shown are (a) abdominal respiratory effort, (b) oxygen saturation, (c) heart rate,
(d) mask pressure, (e) normalized volume, (f) collapse, and (g) 3-D visualizations. The first four (a)–(d) were simultaneously measured during an MRI scan
and (e)–(g) are calculated from segmented masks using the proposed approach
with 3-D RT-MRI. The blue background highlights the length of the mixed
(central and obstructive) apneas. The black arrows indicate change in respiratory effort, flat mask pressure, and the white collapse plot. The mixed apnea is
followed by a drop in oxygen saturation indicated by the green arrow and an
increase in heart rate indicated by the brown arrow. The orange arrows indicate
breathing evident from changes in respiratory effort and mask pressure. The
colored lines on (f) represent times when the visualizations of UA were generated. The red arrows in visualization point to site of airway collapse during
the apneic event. In (f), black indicates a patent airway and white indicates a
collapsed airway.

sustained regular heart rate and breathing pattern, free of artifact,
serve as a surrogate for identifying sleep. Arousal from sleep and
wakefulness were assumed with any variability in the heart rate,
irregular respiratory breath intervals and/or amplitude, and/or
movement artifact contaminating the signals. Manual inspection
is subjective and not very accurate, whereas electroencephalogram (EEG) is the best way to objectively assess sleep state.
Due to difficulty in using EEG in an MRI scanner, it was not
used in the current protocol. Since sleep state was determined
retrospectively, the scan was completed as is even if the patient
did not fall asleep or woke up in the middle of the scan. Efforts
are being made to use EEG in an MRI scanner. Knowledge of
sleep state will enable us to determine the duration of our scan
to allow subjects to attain a sufficiently deep level of sleep in the
MR scanner for future studies. Efforts are also being made to
reduce the acoustic noise from the scanner to help subjects fall
asleep more easily because in many OSA patients, obstructive
events tend to occur more frequently during rapid eye movement
sleep.
This study has demonstrated the feasibility of semiautomated
airway segmentation in dynamic 3-D airway MRI and there is
much room for improvement. The present segmentation method
requires manual selection of ROI, seeds, and the intensity thresh-

old. Manual selection is subjective and prone to intra- and interobserver variability. Therefore, further investigation is needed to
make this algorithm fully automated and to explore best methods
for segmentation.
Recent advances in automated landmark detection algorithms
may help reduce variability by automating ROI and seed selection. Recently, Wang et al. presented an evaluation and comparison of four robust anatomical landmark detection methods for
cephalometry 2-D X-ray images [24]. These methods rely on
sophisticated image analysis and pattern-recognition principles.
They all require annotated training datasets to train the landmark
detectors before use in nonlabeled datasets [25]–[28]. Automatic landmark detection has also been used for automated seed
placement for colon segmentation using an automated heuristic
approach that does not rely on training datasets but used knowledge of anatomy for seed placement [29]. This approach was
specifically designed for colon segmentation and may not be
easily translated to 3-D UA data. In [30], an automated segmentation plus landmark detection approach is presented for
2-D UA MR images. Most of these methods were developed
for high-resolution 2-D images with much higher CNR than in
our datasets. However, they may still be applicable to dynamic
3-D UA images presented in this study and allow for further
automation of the segmentation algorithm presented here.
Furthermore, more sophisticated methods may improve the
false positive rate. For example, in some frames from the long
scan of Subject 1, the airway boundaries were not well preserved
and resulted in oversegmentation. The segmented region grew
to include the tissue that had lower signal intensity. Such errors
might be resolved using region-growing algorithms that detect
breach of periphery as it grows and ensures that segmented region stays within the airway. A technique that addressed this
issue has been previously demonstrated in brain lesion segmentation [31].
The 3-D renderings generated from our segmentation method
can be used to study the dynamics of airflow in the UA and its
interaction with airway walls during events. Current studies
have used static MRI to characterize UA using computational
modeling and fluid structure interactions [32]. However, static
MRI lacks information about dynamics of UA during collapse.
This information can be provided by 3-D RT-MRI and may
help with improved characterization of UA using computational
modeling and fluid structure interactions.
V. CONCLUSION
We have demonstrated a novel and simple semiautomated
segmentation approach for dynamic 3-D MRI of the pharyngeal
airway. The proposed method has shown very good agreement
with manual segmentation. This approach, for the first time,
enables time-efficient identification of collapse events and enables visualization of the pharyngeal airway dynamics throughout all events. The segmented dynamic MR data can provide
previously unavailable anatomical landmarks for clinical interventions such as surgery or oral appliances in the treatment of
OSA, or for patient-specific modeling of the airway collapse
pattern.

JAVED et al.: DYNAMIC 3-D MR VISUALIZATION AND DETECTION OF UPPER AIRWAY OBSTRUCTION DURING SLEEP

ACKNOWLEDGMENT
The authors gratefully acknowledge Z. Wu and X. Wang for
help with data collection; L. Nava, A. Bernardo, and W. Tran
for help with the occlusion devices; and Dr. R. Kato, Dr. B.
Joshi, Dr. S. Loloyan, and Dr. T. Keens for their help with
patient recruitment, consent, identifying events, and feedback
on image quality.
REFERENCES
[1] A. Malhotra and D. P. White, “Obstructive sleep apnoea,” Lancet,
vol. 360, no. 9328, pp. 237–245, Jul. 2002.
[2] R. Arens and C. L. Marcus, “Pathophysiology of upper airway obstruction:
A developmental perspective,” Sleep, vol. 27, no. 5, pp. 997–1019, Aug.
2004.
[3] R. Arens et al., “Upper airway size analysis by magnetic resonance imaging of children with obstructive sleep apnea syndrome,” Am. J. Respir.
Crit. Care Med., vol. 167, no. 1, pp. 65–70, Jan. 2003.
[4] S. L. Verhulst et al., “Sleep-disordered breathing in overweight and obese
children and adolescents: Prevalence, characteristics and the role of fat
distribution,” Arch. Dis. Child., vol. 92, no. 3, pp. 205–208, Mar. 2007.
[5] T. D. Bradley and J. S. Floras, “Obstructive sleep apnoea and its cardiovascular consequences,” Lancet, vol. 373, no. 9657, pp. 82–93, Jan.
2009.
[6] A. N. Rama et al., “Sites of obstruction in obstructive sleep apnea,” Chest,
vol. 122, no. 4, pp. 1139–1147, Oct. 2002.
[7] R. J. Schwab et al., “Upper airway and soft tissue anatomy in normal
subjects and patients with sleep-disordered breathing. Significance of the
lateral pharyngeal walls,” Am. J. Respir. Crit. Care Med., vol. 152, no. 5
Pt 1, pp. 1673–1689, Nov. 1995.
[8] F. J. Trudo et al., “State-related changes in upper airway caliber and
surrounding soft-tissue structures in normal subjects,” Am. J. Respir. Crit.
Care Med., vol. 158, no. 4, pp. 1259–1270, Oct. 1998.
[9] R. J. Schwab et al., “Identification of upper airway anatomic risk factors
for obstructive sleep apnea with volumetric magnetic resonance imaging,”
Am. J. Respir. Crit. Care Med., vol. 168, no. 5, pp. 522–530, Sep. 2003.
[10] K. Nayak and R. Fleck, “Seeing Sleep: Dynamic imaging of upper airway collapse and collapsibility in children,” Pulse, IEEE, vol. 5, no. 5,
pp. 40–44, 2014.
[11] M. E. Wagshul et al., “Novel retrospective, respiratory-gating method
enables 3D, high resolution, dynamic imaging of the upper airway during
tidal breathing,” Magn. Reson. Med., vol. 70, no. 6, pp. 1580–1590, Dec.
2013.
[12] R. Arens et al., “Changes in upper airway size during tidal breathing in
children with obstructive sleep apnea syndrome,” Am. J. Respir. Crit. Care
Med., vol. 171, no. 11, pp. 1298–1304, Jun. 2005.
[13] Y.-C. Kim et al., “Measurement of upper airway compliance using dynamic MRI,” in Proc. ISMRM 20th Sci. Sessions, Melbourne, Australia,
2012, vol. 20, p. 3688.
[14] Y.-C. Kim et al., “Real-time MRI can differentiate sleep-related breathing
disorders in children Introduction,” in Proc. ISMRM 21st Sci. Sessions,
Salt Lake City, UT, USA, 2013, vol. 21, no. c, p. 251.
[15] Y.-C. Kim et al., “Real-time 3D magnetic resonance imaging of the pharyngeal airway in sleep apnea,” Magn. Reson. Med., vol. 71, no. 4, pp.
1501–1510, Apr. 2014.

437

[16] Y.-C. Kim et al., “Investigations of upper airway obstruction pattern in
sleep apnea benefit from real-time 3D MRI,” in Proc. ISMRM 22nd Sci.
Sessions, Milan, Italy, 2014, no. 5, p. 4364.
[17] S. Y. Yeoa et al., “Segmentation of human upper airway using a level set
based deformable model,” in Proc. 13th Med. Image Underst. Anal., pp.
174–178, 2009.
[18] S. Salerno et al., “Semi-automatic volumetric segmentation of the upper
airways in patients with Pierre Robin sequence,” Neuroradiol. J., vol. 27,
pp. 487–494, 2014.
[19] V. R. D. Water et al., “Measuring upper airway volume: Accuracy and
reliability of dolphin 3D software compared to manual segmentation in
craniosynostosis patients,” J. Oral Maxillofac. Surg., vol. 72, no. 1, pp.
139–144, 2014.
[20] J. Liu et al., “System for upper airway segmentation and measurement
with MR imaging and fuzzy connectedness,”Acad. Radiol., vol. 10, no. 1,
pp. 13–24, 2003.
[21] R. Adam and L. Bischof, “Seeded region growing,” IEEE Trans. Pattern
Anal. Mach. Intell., vol. 16, no. 6, pp. 641–647, Jun. 1994.
[22] Daniel. (2011). Region Growing (2D/3D grayscale). [Online]. Available: http://www.mathworks.com/ matlabcentral/fileexchange/32532region-growing-2d-3d-grayscale[23] L. Dice, “Measures of the amount of ecologic association between
species,” Ecology, vol. 26, no. 3, pp. 297–302, 1945.
[24] C. W. Wang et al., “Evaluation and comparison of anatomical landmark
detection methods for cephalometric X-ray images: A grand challenge,”
IEEE Trans. Med. Imag., 2015, to be published.
[25] P. Geurts, “Automatic Cephalometric X-Ray Landmark Detection Challenge 2014: A machine learning tree-based approach,” 2014.
[26] C. Chu et al., “Fully Automatic cephalometric X-ray landmark detection
using random forest regression and sparse shape composition,” in Proc.
ISBI International Symposium on Biomedical Imaging 2014: Automatic
Cephalometric X-Ray Landmark Detection Challenge, 2014.
[27] H. Mirzaalian and G. Hamarneh, “Automatic globally-optimal pictorial
structures with random decision forest based likelihoods for cephalometric
X-ray landmark detection.” in Proc. ISBI International Symposium on
Biomedical Imaging 2014: Automatic Cephalometric X-Ray Landmark
Detection Challenge, 2014.
[28] B. Ibragimov et al., “Automatic cephalometric X-ray landmark detection
by applying game theory and random forests,” in Proc. ISBI International
Symposium on Biomedical Imaging 2014: Automatic Cephalometric XRay Landmark Detection Challenge, 2014.
[29] G. Iordanescu et al., “Automated seed placement for colon segmentation
in computed tomography colonography,” Acad. Radiol., vol. 12, no. 2,
pp. 182–190, 2005.
[30] Z. Raeesy et al., “Automatic segmentation of vocal tract MR images,” in
Proc. 10th Int. Symp. Biomed. Imaging, 2013, pp. 1316–1319.
[31] S. A. Hojjatoleslami and F. Kruggel, “Segmentation of large brain lesions,”
IEEE Trans. Med. Imaging, vol. 20, no. 7, pp. 666–669, Jul. 2001.
[32] S. D. Ward et al., “Pediatric sleep-related breathing disorders: Advances
in imaging and computational modeling,” IEEE Pulse, vol. 5, no. 5,
pp. 33–39, Sep./Oct. 2014.

Authors’ photographs and biographies not available at the publication.

