476

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Improvement in Neural Respiratory Drive Estimation
From Diaphragm Electromyographic Signals Using
Fixed Sample Entropy
Luis Estrada, Member, IEEE, Abel Torres, Member, IEEE, Leonardo Sarlabous,
and Raimon Jané, Senior Member, IEEE

Abstract—Diaphragm electromyography is a valuable technique
for the recording of electrical activity of the diaphragm. The analysis of diaphragm electromyographic (EMGdi) signal amplitude is
an alternative approach for the quantification of the neural respiratory drive (NRD). The EMGdi signal is, however, corrupted
by electrocardiographic (ECG) activity, and this presence of cardiac activity can make the EMGdi interpretation more difficult.
Traditionally, the EMGdi amplitude has been estimated using the
average rectified value (ARV) and the root mean square (RMS).
In this study, surface EMGdi signals were analyzed using the fixed
sample entropy (fSampEn) algorithm, and compared to the traditional ARV and RMS methods. The fSampEn is calculated using
a tolerance value fixed and independent of the standard deviation
of the analysis window. Thus, this method quantifies the amplitude
of the complex components of stochastic signals (such as EMGdi),
and being less affected by changes in amplitude due to less complex
components (such as ECG). The proposed method was tested in
synthetic and recorded EMGdi signals. fSampEn was less sensitive
to the effect of cardiac activity on EMGdi signals with different levels of NRD than ARV and RMS amplitude parameters. The mean
and standard deviation of the Pearson’s correlation values between
inspiratory mouth pressure (an indirect measure of the respiratory
muscle activity) and fSampEn, ARV, and RMS parameters, estimated in the recorded EMGdi signal at tidal volume (without inspiratory load), were 0.38 ± 0.12, 0.27 ± 0.11, and 0.11 ± 0.13,
respectively. Whereas at 33 cmH2 O (maximum inspiratory load)
were 0.83 ± 0.02, 0.76 ± 0.07, and 0.61 ± 0.19, respectively.
Our findings suggest that the proposed method may improve the
evaluation of NRD.
Index Terms—Diaphragm muscle, electromyography, fixed sample entropy (fSampEn), neural respiratory drive.
Manuscript received July 18, 2014; revised December 2, 2014 and January
27, 2015; accepted January 28, 2015. Date of publication February 2, 2015;
date of current version March 3, 2016. The work of L. Estrada was supported
by Instituto para la Formación y Aprovechamiento de Recursos Humanos and
Secretarı́a Nacional de Ciencia, Tecnologı́a e Innovación (IFARHU-SENACYT
Program) from the Panama Government under Grant 270-2012-273. This work
was supported in part by Ministerio de Economı́a y Competitividad from the
Spain Government under Grant TEC2010-21703-C03-01.
L. Estrada, A. Torres, and R. Jané are with the Department d’Enginyeria
de Sistemes, Automàtica i Informàtica Industrial, Universitat Politècnica de
Catalunya—Barcelona Tech (UPC), 08034 Barcelona, Spain, and also with the
Biomedical Signal Processing and Interpretation Group, Institute for Bioengineering of Catalonia (IBEC), 08028 Barcelona, Spain and the Biomedical Research Networking Center in Bioengineering, Biomaterials and Nanomedicine
(CIBER-BBN), 08028 Barcelona, Spain (e-mail: lestrada@ibecbarcelona.eu;
abel.torres@upc.edu; raimon.jane@upc.edu).
L. Sarlabous is with the Institute for Bioengineering of Catalonia (IBEC),
08028 Barcelona, Spain, and Biomedical Research Networking Center in Bioengineering, Biomaterials and Nanomedicine (CIBER-BBN), 08028 Barcelona,
Spain (e-mail: lsarlabous@ibecbarcelona.eu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2398934

I. INTRODUCTION
URFACE electromyography is a minimally invasive tool
for monitoring and evaluating muscle electrical activity
for clinical diagnosis and research purposes. It provides information about the electrical response of motor unit recruitment
near the position of the electrode, attached to the skin surface
above the muscles. In general, the amplitude of the surface
electromyographic (EMG) signal is positively correlated and
increases nonlinearly with the force generated by the musculoskeletal system during contraction [1]–[3]. Traditionally, the
EMG amplitude has been estimated using the average rectified
value (ARV) and root mean square (RMS) value, which provide
useful information about the signal in the time domain [4].
Measuring respiratory muscle function, especially that of the
diaphragm, the main respiratory muscle involved in inspiration,
is increasingly recognized as important for clinicians to improve
their understanding the mechanisms of breathing, for instance,
in patients suffering from chronic obstructive pulmonary disease (COPD) [5], [6] or critically ill patients in intensive care
units [7]. The diaphragm electromyographic (EMGdi) signal
provides a real-time indirect measure of neural respiratory drive
(NRD), which reflects the load on the respiratory muscles [8],
[9]. Several studies have shown that NRD, assessed by normalized EMGdi signals, is higher in patients with respiratory disease
than in healthy subjects [9]–[11]. Nonetheless, the EMGdi signal has the drawback of being influenced by electromagnetic
noise [12] and crosstalk effects of physiological origin such as
motion artifacts [13], respiratory muscles [14], and above all,
the electrocardiographic (ECG) signal from the heart [13]. The
estimation of the NRD from EMGdi signals will be affected by
the accuracy of the EMG measurement.
In a general context, the ECG signal appears as large amplitude, short-time duration train of impulsive noise superimposed
on the EMGdi signal. Impulsive noise is also found in other
respiratory signals at the beginning and the end of inspiratory
breathing [15]. ECG interference is a problem as it hinders the
evaluation and clinical interpretation of the EMGdi signal [16].
In particular, the EMGdi amplitude is modified, and this is reflected in the classical amplitude estimators (ARV and RMS),
which are considerably influenced by the presence of the ECG
activity. Various approaches based on signal processing [17]–
[21], and sensor instrumentation [22] have been proposed to
minimize the effect of ECG interference on the analysis of respiratory muscle signals.
In the research setting, the sample entropy (SampEn) method
has shown great potential in the study of biomedical signals.

S

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

ESTRADA et al.: IMPROVEMENT IN NEURAL RESPIRATORY DRIVE ESTIMATION FROM DIAPHRAGM ELECTROMYOGRAPHIC SIGNALS

SampEn, a modification of the approximate entropy (ApEn) [23]
presented by Richman and Moorman [24], measures the regularity of a dataset, and it is an indirect measure of Kolmogorov–
Sinai entropy. The analysis of SampEn has contributed to diverse
areas in the field of biomedical engineering [25]–[28]. In this
paper, we applied a variation of the SampEn called fixed sample
entropy (fSampEn) [29] for the evaluation of the EMGdi signal.
This method uses a moving window of analysis and a fixed tolerance value. In [29], fSampEn has been used to evaluate the respiratory muscle strength from diaphragm mechanomyographic
(MMGdi) signals under the presence of cardiac vibration and
was found to be less influenced by cardiac activity than ARV
and RMS value. In addition, fSampEn has been also used to
determine the onset time of muscle activity in surface EMG signals, achieving a lower mean error than other methods based on
conventional amplitude thresholding [30], [31] and to estimate
grasping force from intramuscular EMG signals [32].
The aim of this paper was to evaluate the behavior of the
fSampEn, as a method for improving the measurement of NRD
from EMGdi signals in the presence of cardiac activity, compared to ARV and RMS approaches. To achieve this objective,
first we applied the fSampEn, ARV, and RMS methods to synthetic EMGdi signals, for which we were able to separately
generate the diaphragm electromyographic component and the
cardiac component. Second, we tested the proposed methods in
an experimental study with EMGdi signals recorded in healthy
subjects during an incremental inspiratory load test.

II. MATERIALS AND METHODS
A. Recorded EMGdi Signals
Physiological signals were acquired in five male healthy
subjects with no medical history of cardiac, pulmonary, or
neuromuscular disease (mean ± standard deviation: age
31.0 ± 2.6 years, height 1.77 ± 0.08 m, weight 79.8 ± 10.1 kg).
The study was conducted with the subject’s written consent, and
with the approval of the Institutional Review Board of the Institute for Bioengineering of Catalonia (IBEC), Barcelona, Spain.
The skin was initially prepared using an abrasive gel (Nuprep,
Weaver and Company, Aurora, CO, USA) and cleaned with alcohol to reduce the skin/electrode impedance prior to electrode
placement. For EMGdi acquisition, a pair of electrodes in bipolar configuration was positioned on the lower right chest along
the anterior axillary line (one electrode below the other), over
the seventh (positive electrode) and eighth (negative electrode)
intercostal spaces above the costal margin [17]. The EMGdi
signal was recorded using a modular amplifier (EMG 100C,
Biopac Systems, Santa Barbara, CA, USA) with a gain of 5000
and an analog band-pass filter from 1 to 500 Hz. A ground
electrode was placed on the left ankle as a reference. For this
procedure, standard circular and disposable Ag/AgCl electrodes
were used (10-mm diameter contact area, pregelled, foam electrode 50/PK–EL501, Biopac Systems, Santa Barbara, CA, USA)
and electrodes were placed 2-cm apart. In order to evaluate the
cardiac activity without EMGdi activity, the EMGdi signal was
first recorded while the subjects were holding their breath (without respiratory activity). The subjects were able to maintain a

477

relaxed breath hold for about 12 s. This signal has been used to
build the synthetic EMGdi signal with cardiac noise.
For the activation of the diaphragm muscle and recording
of the corresponding signal (EMGdirec ) during the inspiratory
phase of the breathing cycle, the subjects used a threshold inspiratory muscle trainer (Threshold IMT, Philips Respironics,
Amsterdam, The Netherlands). This device has been used for
training and enhancing inspiratory muscle in patients with a
range of medical conditions including COPD [5] and during the
weaning process in intensive care [33]. It generates an adjustable
steady pressure during the inspiratory process, independent of
the flow, through a spring-loaded valve (linear resistance) [34].
The subjects were requested to inhale through a mouth-piece
connected onto the inlet of a T-tube together with the inspiratory muscle trainer coupled to the outlet. Inspiratory mouth
pressure (Pm outh ) was measured with a differential pressure
transducer (TSD160, Biopac Systems) and a modular amplifier
(DAC100C, Biopac Systems) with a gain of 50, connected to the
T-tube connected via approximately 60 cm of tubing. Recording
of Pm outh , and consequently, the respiratory muscle work, was
performed at tidal volume, and inspiratory pressures of 9, 17,
25, and 33 cmH2 O.
The subjects wore a disposable nose clip to prevent nasal
breathing during the test while comfortably seated in a chair
with their arms by their sides. Signals from the modular amplifiers were recorded at a sampling frequency of 2000 Hz
by a data acquisition system (MP150, Biopac Systems), displayed and stored in a computer via the accompanying software
(AcqKnowledge software v.3.2). Signals were later offline filtered using a zero-phase fourth-order Butterworth filter with a
bandpass from 5 to 400 Hz, subsampled by a factor of 2, and
analyzed using MATLAB (v. R2011b, Natick, MA, USA).
As an example, plots a and b of Fig. 1 show the Pm outh and
EMGdirec signals, respectively, of one subject. A MATLAB file
containing the Pm outh and EMGdirec signals recorded from all
subjects can be found in the supporting information section.
B. Synthetic EMGdi Signals
Since an objective evaluation of the effect of ECG interference on the fSampEn, ARV, and RMS parameters requires
knowledge of the original undisturbed signals, we simulated
EMGdi signals with and without ECG noise. For each of the five
subjects, a synthetic inspiratory envelope (ENVi ), and EMGdi
signals without ECG noise (EMGdis ) and with ECG noise
(EMGdin ) were generated taking into account the main features of the corresponding EMGdirec signals. Fig. 2 illustrates
the main steps of the method for generation of these synthetic
signals.
1) The EMGdi signal contains different frequency components in inspiratory and expiratory phases [17]. Therefore, for each subject and each inspiratory pressure level
studied (tidal volume, 9, 17, 25, and 33 cmH2 O), two autoregressive (AR) models were adjusted to simulate the
behavior of the two respiratory phases. These AR models were estimated from the recorded EMGdi data using
concatenated ECG-free inspiratory and expiratory segments, respectively, as is illustrated in Fig. 2, plots a and
b. The orders of the AR filters were selected using the

478

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 1. Recorded signal with different levels of inspiratory load. (a) Pm o u th and (b) EMGdire c signals, and the evolution of (c) ARV, (d) RMS, and (e)
fSampEn for the EMGdire c signal, for one subject. The left column corresponds to 10-s of tidal volume breathing (between vertical blue dots from right column)
corresponding to the case with the least diaphragm activity.

2)

3)

4)
5)

modified Akaike information criterion [35]. The variance
and the AR coefficients of the inspiratory and expiratory
segments (σi2 and σe2 , and Ai and Ae , respectively) were
used to generate the EMGdi activity free of ECG interference.
Two cyclical envelopes were generated to simulate the inspiratory (ENVi ) and expiratory (ENVe ) processes occurring during normal breathing. The two envelope signals
have opposite phases, as shown in Fig. 2(c). A quarter
of the respiratory cycle was composed of the inspiration
plateau, half was the expiration plateau and the last quarter the rising and falling segments. A Hamming window
was used to generate these rising and falling segments.
The envelopes lasted 300-s with a frequency of 16 breaths
per minute. The respiratory rate and inspiratory periods
were selected based on data from a study of breathing
patterns in healthy subjects [36]. The amplitudes of the
ENVi and ENVe were adjusted every 60-s multiplying
by the variances of the AR processes, σi2 and σe2 , respectively, estimated for each subject at each inspiratory
pressure level.
Two EMGdi templates (EMGdii and EMGdie ) free of
ECG noise were modeled by filtering a Gaussian signal
using the corresponding AR coefficients, and then, multiplying it by the envelope signals [see Fig. 2, plots (d) and
(e), respectively].
The EMGdis signal was generated by adding the two
EMGdi templates [see Fig. 2(f)].
An EMGdi signal was acquired while subjects were holding their breath (EMGdihold ). As subjects were able to
maintain a relaxed breath hold for about 12 s, to form
300 s of signal, this breath hold signal was concatenated
with itself 25 times. This EMGdihold signal was then
filtered using a fourth-order Butterworth low-pass filter

with a cutoff frequency of 45 Hz, i.e., the frequency range
of the ECG signal [see Fig. 2(g)].
6) Finally, the EMGdin signal was generated by adding
the filtered EMGdihold signal to the EMGdis signal [see
Fig. 2(h)].
All signals were generated using a sampling rate of 1000 Hz.
As an example, plots a and b of Fig. 3 show the ENVi and
EMGn signals, respectively, for the same subject as in Fig. 1.
A MATLAB file containing the ENVi , EMGdis , and EMGdin
signals simulated for all subjects can be found in the Supporting
Information section.
C. Sample Entropy With Fixed Tolerance Values
SampEn [24] quantifies the complexity and regularity of time
series, identifying patterns of change in data. It reduces the
problem associated with ApEn [23] of counting self-matches
by avoiding the value ln(0) and is more independent of record
length. Two parameters are required to calculate the SampEn:
the embedding dimension m, referred to the length of data that
will be compared, and the tolerance value r.
Let x(n) = {x(1), x(2), . . . , x(N )}, denotes N-elements of
a data sequence.
1) The subsequences of data X(1), X(2), . . . , X(N–m+1)
are constructed, defined by X(i) = {x(i), x(i+1), . . . ,
x(i+m−1)} where i = 1, 2, . . . , N–m+1, being m a constant.
2) The distance between two vectors X(i) and X(j) is expressed as the maximum absolute difference between corresponding elements of the respective subsequences as
d [X(i), X(j)] =

max

k =0,1,...,m −1

(|x(i + k) − x(j + k)|)
(1)

where i = j.

ESTRADA et al.: IMPROVEMENT IN NEURAL RESPIRATORY DRIVE ESTIMATION FROM DIAPHRAGM ELECTROMYOGRAPHIC SIGNALS

479

Fig. 2. Steps for the generation of the synthetic EMGdi signal. (a) recorded EMGdi data and power spectral density (PSD) of the inspiratory (black) and
expiratory (blue) EMGdi segments free of ECG, (b) PSD of the autoregressive (AR) models adjusted to the ECG-free inspiratory and expiratory segments, (c)
ENVi and ENVe signals, (d) EMGdii signal, (e) EMGdie signal, (f) EMGdis signal, (g) EMGdih o ld signal, and (h) EMGdin signal.

3) Bi (r) is the number of subsequences X(i) that resemble
X(j) and satisfy

6) The average for Bim (r) and Am
i (r) is expressed as

(2)

B m (r) =

N
−m
1
B m (r)
N − m i=1 i

(6)

with i = j.
4) Ai (r) is the number of subsequences X(i) that resemble
X(j) and satisfy

Am (r) =

N
−m
1
Am (r).
N − m i=1 i

(7)

dm [X(i), X(j)] ≤ r

dm +1 [X(i), X(j)] ≤ r

(3)

with i = j.
5) The frequency of the patterns encountered that are similar
in subsequences X(i) and X(j) for Bi and Ai are
Bim (r) =

Bi (r)
N −m−1

(4)

Am
i (r) =

Ai (r)
N −m−1

(5)

where i = 1, 2, . . . , N − m.

7) Finally, the sample entropy SampEn(m,r,N) is defined as
 m

A (r)
SampEn(m, r, N ) = −1n
.
(8)
B m (r)
SampEn is evaluated over a moving window and using fixed
r values that do not depend on the standard deviation of each
moving window. We call the modification of SampEn presented
in this paper fixed SampEn (fSampEn) [29]. In the way, that it
has been defined, fSampEn will be higher if the signal covers a
wide range of amplitudes or is highly complex. The fixed fSampEn algorithm was implemented using MATLAB software and
the program code is available in Supporting Information section.
fSampEn was calculated over EMGdis , EMGdin , and EMGdirec

480

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 3. Synthetic signal with different levels of envelope amplitude. (a) ENVi signal, (b) EMGdin signal and the evolution of (c) ARV, (d) RMS, and (e) fSampEn
for the EMGdis (blue line) and EMGdin (red line) signals. The left column corresponds to 10-s of tidal volume breathing (between vertical blue dots from right
column) corresponding to the case with the least diaphragm activity.

signals using a 1-s moving window and with 90% overlap. In
each subject, the fSampEn of the three EMGdi signals was evaluated with the same m and r values. Based on a preliminary
study [29], m was set at 1 and r at 0.3 times the standard deviation of the EMGdirec signal. Since the EMGdin has been
generated with the characteristics of the EMGdirec signal, the
standard deviation of the EMGdin signal is very similar to that
of the EMGdirec signal.
D. Methodology for Assessing the fSampEn Parameter
Pearson’s correlation coefficient (R) and Lin’s concordance
correlation coefficient (ρ) were used to assess agreement between signals. In practical terms, R provides a measure of the
strength of linear association between two measurements (precision) and ρ assesses the agreement between two measurements
considering whether they fall on the 45º line through the origin
(both precision and accuracy) [37], [38]. Specifically, ρ is a correction factor for R and, as a consequence, its values are lower.
R is traditionally interpreted as very strong for 0.80–1.00, strong
for 0.60–0.79, moderate for 0.40–0.59, weak for 0.20–0.39, and
very weak for 0–0.19 [39], while ρ is traditionally interpreted as
almost perfect for > 0.99, substantial for 0.95–0.99, moderate
for 0.90–0.95, and poor for < 0.90 [40].
ARV, RMS, and fSampEn parameters were calculated over
the EMGdis , EMGdin , and the EMGdirec signals using a 1-s
moving window and with 90% overlap. The R coefficient was
used to assess the linear relationship between the parameters calculated using the moving window over the following pair of signals: EMGdis versus EMGdin , EMGdis versus ENVi , EMGdin
versus ENVi , and EMGdirec versus Pm outh . The ρ coefficient
was used to assess the relationship between the parameters calculated over the synthetic signals without and with ECG noise
(EMGdis versus EMGdin ). The R and ρ values were calculated

by analyzing separately the range of envelope amplitudes, for
the synthetic signals, and the range of inspiratory load levels,
for the recorded signals.
The correlation values were compared between fSampEn and
ARV, and between fSampEn and RMS, using the nonparametric
Mann–Whitney U-test. p-values smaller than 0.05 are considered to denote statistical significant differences between the
correlation values.
III. RESULTS
A. Evolution of the fSampEn Parameter in the Synthetic
EMGdi Signals
Fig. 3 illustrates (a) the ENVi , (b) EMGdin signal, and the
evolution of (c) ARV, (d) RMS, and (e) fSampEn for the EMGdis
(blue line) and EMGdin (red line) signals, for one subject. It can
be observed that the influence of ECG is much more notable
in the classical ARV and RMS amplitude parameters than in
the fSampEn. Response without ECG can be defined as ideal
and was used to determine the periodic evolution of parameters
due to the EMGdi activity (without cardiac interference). As the
amplitude of the synthetic envelope increases, the EMGdi component increases relative to the background EMGdihold signal
and the parameter response approaches the ideal response.
The graphs on the left depict a zoom on the tidal volume
breathing over 10-s, the case with the least diaphragm activity. In
normal subjects, tidal volume refers to the amount of air inhaled
and exhaled with each breath, at rest (without any inspiratory
load).
B. Effect of ECG Noise in the Synthetic EMGdi Signals
Fig. 4(a) and (b) represent, respectively, the mean and standard deviation of the R and ρ values between ARV, RMS, and

ESTRADA et al.: IMPROVEMENT IN NEURAL RESPIRATORY DRIVE ESTIMATION FROM DIAPHRAGM ELECTROMYOGRAPHIC SIGNALS

481

Fig. 4. (a) Pearson’s correlation coefficient and (b) Lin’s concordance correlation coefficient, between the ARV, RMS, and fSampEn parameters calculated using
a 1-s moving window over EMGdis and EMGdin signals at different levels of amplitude of the ENVi signal. E1 to E5: ENVi amplitudes corresponding to tidal
volume, and inspiratory loads of 9, 17, 25, and 33 cmH2 O, respectively. Data are presented as mean ± standard deviation across the synthetic signals generated
for the five subjects.

fSampEn parameters calculated over EMGdis and EMGdin signals at different envelope amplitudes. These R and ρ values
allow us to evaluate the effect of the cardiac noise on the estimated parameters. It was observed that both R and ρ increase
as the amplitude increases, although the increase in ρ is more
pronounced. fSampEn had the highest R values throughout the
analysis followed by ARV and RMS parameters. A moderate
correlation (the weakest) was observed for RMS at a tidal volume (0.25 ± 0.24) and a very strong correlation was observed at
33 cmH2 O for fSampEn (0.99 ± 0.003). Significant differences
(p < 0.01) were found between R values of fSampEn and ARV,
and fSampEn and RMS, for all envelope amplitude levels. The
highest ρ values throughout the analysis were obtained again by
fSampEn followed by ARV and RMS parameters. fSampEn at
33 cm H2 O had a substantial concordance (0.97 ± 0.02). Significant difference with p = 0.016 was found between the ρ values
of fSampEn and ARV at the amplitude level corresponding to
tidal volume. For the rest of ρ values, significant differences with
p < 0.01 were found between fSampEn and ARV, and between
fSampEn and RMS.
Fig. 5 shows the mean and standard deviation of the R values between ARV, RMS, and fSampEn parameters calculated
over EMGdis and ENVi signals [see Fig. 5(a)] and between
the parameters calculated over EMGdin and ENVi signals [see
Fig. 5(b)], at different envelope amplitudes. R values allow us to
evaluate the ability of the parameters to estimate the cyclical behavior in the EMGdi signal amplitude. When the EMGdi signal
has no ECG interference, R values are generally high indicating
that all parameters were very strongly correlated. No significant differences were found between the R values of fSampEn
and ARV, and fSampEn and RMS. Conversely, when there is
ECG interference, the R values are lower, the magnitude of R
increasing with the amplitude. In this case, fSampEn obtained
the highest R, achieving mean values always higher than 0.85.
Significant differences (p < 0.01) were found between R values
of fSampEn and ARV, and fSampEn and RMS, for all envelope
amplitude levels.

C. Evolution of the fSampEn Parameter in the Recorded
EMGdi Signals
Fig. 1 illustrates (a) the Pm outh and (b) EMGdirec signals,
and the evolution of (c) ARV, (d) RMS, and (e) fSampEn for
the EMGdirec signal, for the same subject as in Fig. 3. It can
be observed that ECG interference was notable for classical
ARV and RMS amplitude parameters, compared to the effect
in fSampEn, similar to results obtained for the EMGdin signal
shown in Fig. 3. Moreover, as the inspiratory load increases
the EMGdi content is higher and the parameter response is less
influenced by the ECG. The graphs on the left show a zoom
on 10-s of tidal volume breathing, as noted before, the case
with the least diaphragm activity. During tidal volume breathing,
fSampEn had a better performance (less influenced by the ECG)
for the EMGdirec than the EMGdin signal, whereas ARV and
RMS performed less well.

D. Effect of ECG Noise in the Recorded EMGdi Signals
Fig. 6 represents the mean and standard deviation of the
R correlation values of Pm outh and EMGdirec signals for
ARV, RMS, and fSampEn parameters at different inspiratory
loads. R correlation values increase as the load increases;
similar behavior is observed in the synthetic signals [see
Fig. 5(b)]. Once again, the highest R values were obtained with
fSampEn, mean values for this parameter always being higher
than 0.38.
The analysis of concordance was not conducted in this section because the concordance measures the agreement between
data estimated by different methods. When comparing R values
of the fSampEn with ARV, significant differences were found
at 17 and 33 cmH2 O (p < 0.05), but no significant differences
were found at tidal volume (p = 0.5), 9 cmH2 O (p = 0.06), and
25 cmH2 O (p = 0.09). When comparing R values of the
fSampEn with RMS, significant differences (p < 0.01) were
found for all inspiratory load levels.

482

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 5. Pearson’s correlation coefficient (R) between the ENVi signal and the ARV, RMS, and fSampEn parameters calculated using a 1-s moving window over
(a) EMGdis signal and (b) EMGdin signal. R values are calculated at different levels of amplitude of the ENVi . E1 to E5: ENVi amplitudes corresponding to tidal
volume, and inspiratory loads of 9, 17, 25, and 33 cmH2 O, respectively. Data are presented as mean ± standard deviation across the synthetic signals generated
for the five subjects.

Fig. 6. Pearson’s correlation coefficient (R) between the Pm o u th signal and
the ARV, RMS, and fSampEn parameters calculated using a 1-s moving window
over EMGdire c signal. R values are calculated at different levels of Pm o u th . L1
to L5: inspiratory loads corresponding to tidal volume, and inspiratory pressures
of 9, 17, 25, and 33 cmH2 O, respectively. Data are presented as mean ± standard
deviation across the signals recorded from the five subjects.

E. Evaluation of Neural Respiratory Drive
To investigate the ability of the EMGdi parameters to describe the NRD, we analyzed the variation of maximum values
of ARV, RMS, and fSampEn parameters achieved during each
respiratory cycle. All EMGdi parameters were normalized by
the mean value at the lowest envelope amplitude/inspiratory
load. As is shown in Fig. 7, the maximum values of all the
parameters increase as the amplitude/load increases.
IV. DISCUSSION
It is well known that muscular signals such as that from
diaphragm electromyography are greatly influenced by external factors and other physiological signals, that from cardiac
activity being one of the most important. ECG contamination
complicates the analysis of the EMGdi signal by physicians.
In this context, we can consider ECG as structured noise with

higher amplitude and shorter time duration than the random
nature EMGdi activity.
Classical amplitude-based parameters ARV and RMS have
been widely used for the NRD estimation by the EMGdi signal
[8], [9]. However, the analysis of EMGdi with these parameters
is greatly affected by the presence of ECG. The most interesting
aspect of this study is the use of fSampEn as a new estimator of
the NRD from EMGdi signals that is robust against the presence
of ECG noise. This method has the advantages over ARV and
RMS classical parameters of being more robust and less sensitive to the presence of ECG noise at different inspiratory loads.
Although in this study, we have evaluated only signals from
healthy subjects, the use of fSampEn to evaluate NRD could
be extended to the analysis of the respiratory system output in
patients with different respiratory diseases, such as COPD [9],
cystic fibrosis [10], or obstructive sleep apnea [41]. To reduce
the effect of the ECG, EMGdi signals are usually either only
recorded from the right hemithorax and/or evaluated only considering the EMG activity between QRS complexes [42]. In
contrast, with fSampEn, there is no need to remove segments
with ECG activity and we can obtain more reliable information
than with ARV and RMS, given its greater robustness in the
presence of cardiac noise.
We have tested this alternative estimator by evaluating
recorded (EMGdirec ) and synthetic (EMGdis and EMGdin )
EMGdi signals. Despite EMGdis and EMGdin signals not fully
characterizing the EMGdirec signal, they do provide the main
features in the frequency and amplitude context. First, the energy
and the frequency content of the synthetic signals during the inspiratory and expiratory phases were adjusted to match that of
the recorded EMGdi signals using AR models. Second, the same
respiratory rate of 16 cycles per minute was used and this rate is
within the normal range of breathing [36]. Third, the EMGdin
signal was contaminated with the ECG signal, recorded during
a breath-hold maneuver using the same electrode configuration
as for acquiring the EMGdirec signal. In both cases, a total of
five EMGdi amplitude levels were analyzed with a total of 80
inspiratory cycles.

ESTRADA et al.: IMPROVEMENT IN NEURAL RESPIRATORY DRIVE ESTIMATION FROM DIAPHRAGM ELECTROMYOGRAPHIC SIGNALS

483

Fig. 7. Evaluation of neural respiratory drive. ARV, RMS and fSampEn parameters calculated using a 1-s moving window over (a) EMGdin signal and (b)
EMGdire c signals. Parameters are calculated at different levels of amplitude of ENVi and Pm o u th , respectively, and normalized to the first mean value. E1 to
E5: ENVi amplitudes corresponding to tidal volume, and inspiratory loads of 9, 17, 25, and 33 cmH2 O, respectively. L1 to L5: inspiratory loads corresponding to
tidal volume, and inspiratory pressures of 9, 17, 25, and 33 cmH2 O, respectively. Data are presented as mean ± standard deviation across the synthetic signals
generated for the five subjects, and across the signals recorded from the five subjects, respectively.

A comparison of all parameters for the amplitude estimation of the electromyographic component present in EMGdis
and EMGdin signals served to characterize the response of the
EMGdi signal when it is affected by cardiac activity at different inspiratory loads. For all parameters, both R and ρ values
increased as the envelope amplitude increased. This implicitly indicates that the related signal-to-noise ratio improves as
the envelope amplitude increases. From the highest to lowest
performance, the highest values were obtained with fSampEn,
followed by ARV, and RMS with the lowest values for both
R and ρ. Notably, in general terms all parameters can be considered moderately to very strongly correlated, the strongest
relation being found with fSampEn parameter. ρ takes into account not just the precision, but also the accuracy of the data.
In the case of comparing EMGdis and EMGdin signals, the ρ
value takes into account the offset found between the estimation
of the parameters. A visual inspection of Fig. 3 shows that the
smallest offset was obtained with fSampEn and the largest with
RMS.
The evaluation of the correlation between the synthetic
EMGdi signals (EMGdis and EMGdin ) and the ENVi signal
indicated how well all parameters correlate with or without
ECG interference through the simulated increase in diaphragm
muscle activation. First, a comparable and very strong correlation was obtained between the ENVi signal and the fSampEn,
ARV, and RMS estimations for the EMGdis signal. Second,
comparison between ENVi and parameter estimation for the
EMGdin signal showed that fSampEn had a very strong correlation, ARV had a weak-to-very strong correlation while RMS
had a weak-to-strong correlation. This tendency was similar
and comparable to that obtained with correlation parameters for
the EMGdis signal, with a higher performance as the envelope
amplitude increases.
The correlation between Pm outh and parameters for estimation of the NRD by the EMGdirec signal also increases as the inspiratory load increases, the strength of the correlation from the
highest to the lowest being for: fSampEn, ARV, and RMS. These

findings are comparable to those with EMGdis and EMGdin
signals.
For estimation of the EMGdirec signal, the fSampEn parameter performed well. It is also noticeable by simple visual
inspection that respiratory periods were better identified with the
fSampEn than using ARV or RMS parameters. Indeed, ARV and
RMS performed poorly, especially at lower inspiratory loads.
Notably, all parameters tended to increase with the inspiratory
load. Our study confirmed that the relationship of respiratory
output with EMGdi activity characterized using fSampEn increases over the whole range of inspiratory mouth pressures
covered, as it does with classical ARV and RMS amplitudebased parameters. The slope was steepest with fSampEn (indicating that they are more sensitive) followed by ARV and RMS
as shown in Fig. 7.
The use of surface diaphragm EMG signal for estimating
NRD has the advantage of its minimally invasive nature and
its ability to sample a large number of motor units. However,
surface EMG recordings are often affected by the activity of
adjacent muscles, causing crosstalk [14]. In this study, we have
tried to minimize crosstalk from muscles of the trunk by performing the measurements with the subjects in a relaxed, upright
seated position. Furthermore, we have used a threshold trainer
[34], a device that imposes an inspiratory load and allows us
to increase inspiratory muscle effort of diaphragm [5], [42],
while adjacent muscles involved in the expiration are minimally
activated. In addition, EMG signals from adjacent inspiratory
muscles that interfere with diaphragm muscle should behave
in a similar way to the diaphragm EMG signal. Therefore, we
can consider that the surface diaphragm EMG signal analyzed,
even if it contains crosstalk, reflects changes in the respiratory
muscle activation pattern.
V. CONCLUSION
This study presents the use of fSampEn as an alternative to the
classical ARV and RMS parameters for the estimation of NRD

484

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

by EMGdi signals under the presence of ECG interference. This
method has been shown to be less affected by cardiac activity
during the inspiration process at several inspiratory mouth pressures. Moreover, the proposed method has been shown to have
potential for being used to extract useful information from muscular activity of patients with compromised respiratory function.
Further studies should be conducted to assess the feasibility of
using these methods to evaluate the EMGdi activity in clinical
studies.

REFERENCES
[1] C. J. De Luca, “The use of surface electromyography in biomechanics,”
J. Appl. Biomech., vol. 13, pp. 135–163, 1997.
[2] P. Madeleine, P. Bajaj, K. Søgaard, and L. Arendt-Nielsen, “Mechanomyography and electromyography force relationships during concentric, isometric and eccentric contractions,” J. Electromyogr. Kinesiol., vol. 11,
no. 2, pp. 113–121, Apr. 2001.
[3] J. L. Dideriksen, D. Farina, and R. M. Enoka, “Influence of fatigue on the
simulated relation between the amplitude of the surface electromyogram
and muscle force,” Philos. Trans. A, Math. Phys. Eng. Sci., vol. 368,
no. 1920, pp. 2765–2781, Jun. 2010.
[4] M. González-Izal, A. Malanda, E. Gorostiaga, and M. Izquierdo, “Electromyographic models to assess muscle fatigue,” J. Electromyogr. Kinesiol., vol. 22, no. 4, pp. 501–512, Aug. 2012.
[5] A. D. de Andrade, T. N. S. Silva, H. Vasconcelos, M. Marcelino,
M. G. Rodrigues-Machado, V. C. G. Filho, N. H. Moraes, P. E. M. Marinho, and C. F. Amorim, “Inspiratory muscular activation during threshold
therapy in elderly healthy and patients with COPD,” J. Electromyogr. Kinesiol., vol. 15, no. 6, pp. 631–639, Dec. 2005.
[6] T. Similowski and J.-P. H. Derenne, “Inspiratory muscle testing in stable
COPD patients,” Eur. Respir. J., vol. 7, no. 10, pp. 1871–1876, 1994.
[7] J. Doorduin, H. W. H. van Hees, J. G. van der Hoeven, and L. M. a. Heunks,
“Monitoring of the respiratory muscles in the critically ill,” Amer. J. Respir.
Crit. Care Med., vol. 187, no. 1, pp. 20–27, Jan. 2013.
[8] American Thoracic Society/European Respiratory Society, “ATS/ERS
statement on respiratory muscle testing,” Amer. J. Respir. Crit. Care Med.,
vol. 166, no. 4, pp. 518–624, Aug. 2002.
[9] C. J. Jolley, Y.-M. Luo, J. Steier, C. Reilly, J. Seymour, A. Lunt, K. Ward,
G. F. Rafferty, M. I. Polkey, and J. Moxham, “Neural respiratory drive
in healthy subjects and in COPD,” Eur. Respir. J., vol. 33, pp. 289–297,
2009.
[10] C. C. Reilly, K. Ward, C. J. Jolley, A. C. Lunt, J. Steier, C. Elston,
M. I. Polkey, G. F. Rafferty, and J. Moxham, “Neural respiratory drive,
pulmonary mechanics and breathlessness in patients with cystic fibrosis,”
Thorax, vol. 66, no. 3, pp. 240–246, Mar. 2011.
[11] C. Sinderby, J. Beck, J. Spahija, J. Wiberg, and A. Grassino, “Voluntary
activation of the human diaphragm in health and disease,” J. Appl. Pysiol.,
vol. 85, pp. 2146–2158, 1998.
[12] J. M. Defreitas, T. W. Beck, and M. S. Stock, “Comparison of methods for removing electromagnetic noise from electromyographic signals,”
Physiol. Meas., vol. 33, no. 2, pp. 147–158, Mar. 2012.
[13] C. Sinderby, L. Lindstrom, and A. Grassino, “Automatic assessment of
electromyogram quality,” J. Appl. Physiol., vol. 79, no. 5, pp. 1803–1815,
1995.
[14] C. Sinderby, S. Friberg, N. Comtois, and A. Grassino, “Chest wall muscle
cross talk in canine costal diaphragm electromyogram,” J. Appl. Physiol.,
vol. 81, no. 5, pp. 2312–2327, Nov. 1996.
[15] L. Sarlabous, A. Torres, J. Fiz, J. Morera, and R. Jané, “Index for estimation of muscle force from mechanomyography based on the Lempel-Ziv
algorithm,” J. Electromyogr. Kinesiol., vol. 23, no. 3, pp. 548–557, Jul.
2013.
[16] H. L. Butler, R. Newell, C. L. Hubley-Kozey, and J. W. Kozey, “The
interpretation of abdominal wall muscle recruitment strategies change
when the electrocardiogram (ECG) is removed from the electromyogram
(EMG),” J. Electromyogr. Kinesiol., vol. 19, no. 2, pp. e102–e113, May
2009.
[17] Y. Deng, W. Wolf, R. Schnell, and U. Appel, “New aspects to eventsynchronous cancellation of ECG interference: An application of the
method in diaphragmatic EMG signals,” IEEE Trans. Biomed. Eng.,
vol. 47, no. 9, pp. 1177–1184, Sep. 2000.

[18] H. D. Katzberg, D. F. Barros, B. Widrow, C. S. Cho, and Y. T. Yo, “Analysis of continuous diaphragm electromyographic signal: Results from a
patient with amyotrophic lateral sclerosis,” Muscle Nerve, vol. 43, no. 6,
pp. 801–806, 2011.
[19] H. Liang, Z. Lin, and F. Yin, “Removal of ECG contamination from
diaphragmatic EMG by nonlinear filtering,” Nonlinear Anal., vol. 63,
no. 5–7, pp. 745–753, Nov. 2005.
[20] B. Widrow, J. R. Glover, J. M. McCool, J. Kaunitz, C. S. Williams,
R. H. Hearn, J. R. Zeidler, D. Eugene, and R. C. Goodlin, “Adaptive noise
cancelling: Principles and applications,” in Proc. IEEE, vol. 63, no. 12,
pp. 1692–1716, Dec. 1975.
[21] C. Zhan, L. F. Yeung, and Z. Yang, “A wavelet-based adaptive filter for
removing ECG interference in EMGdi signals,” J. Electromyogr. Kinesiol.,
vol. 20, no. 3, pp. 542–549, Jun. 2010.
[22] L. Estrada, A. Torres, J. Garcia-Casado, Y. Ye-Lin, and R. Jané, “Evaluation of Laplacian diaphragm electromyographic recordings in a static
inspiratory maneuver,” in Proc. 13th Mediterr. Conf. Med. Biol. Eng. Comput., 2014, pp. 977–980.
[23] S. M. Pincus, “Approximate entropy as a measure of system complexity,” in Proc. Natl. Acad. Sci. U S A, vol. 88, no. 6, pp. 2297–2301,
Mar. 1991.
[24] J. S. Richman and J. R. Moorman, “Physiological time-series analysis
using approximate entropy and sample entropy,” Amer. J .Physiol. Heart
Circ. Physiol., vol. 278, no. 6, pp. H2030–H2049, 2000.
[25] W. Chen, J. Zhuang, W. Yu, and Z. Wang, “Measuring complexity using
FuzzyEn, ApEn, and SampEn,” Med. Eng. Phys., vol. 31, no. 1, pp. 61–68,
Jan. 2009.
[26] J. G. A. Cashaback, T. Cluff, and J. R. Potvin, “Muscle fatigue and contraction intensity modulates the complexity of surface electromyography,”
J. Electromyogr. Kinesiol., vol. 23, no. 1, pp. 78–83, Feb. 2013.
[27] A. Molina-Picó, D. Cuesta-Frau, M. Aboy, C. Crespo, P. Miró-Martı́nez,
and S. Oltra-Crespo, “Comparative study of approximate entropy and
sample entropy robustness to spikes,” Artif. Intell. Med., vol. 53, no. 2,
pp. 97–106, Oct. 2011.
[28] R. Alcaraz and J. J. Rieta, “A novel application of sample entropy to
the electrocardiogram of atrial fibrillation,” Nonlinear Anal. Real World
Appl., vol. 11, no. 2, pp. 1026–1035, Apr. 2010.
[29] L. Sarlabous, A. Torres, J. a. Fiz, and R. Jané, “Evidence towards Improved
estimation of respiratory muscle effort from diaphragm mechanomyographic signals with cardiac vibration interference using sample entropy with fixed tolerance values,” PLoS One, vol. 9, no. 2, pp. 1–9,
Jan. 2014.
[30] X. Zhang and P. Zhou, “Sample entropy analysis of surface EMG for
improved muscle activity onset detection against spurious background
spikes,” J. Electromyogr. Kinesiol., vol. 22, no. 6, pp. 901–907, Dec.
2012.
[31] P. Zhou and X. Zhang, “A novel technique for muscle onset detection
using surface EMG signals without removal of ECG artifacts,” Physiol.
Meas., vol. 35, no. 1, pp. 45–54, Jan. 2014.
[32] E. N. Kamavuako, D. Farina, K. Yoshida, and W. Jensen, “Estimation of
grasping force from features of intramuscular EMG signals with mirrored
bilateral training,” Ann. Biomed. Eng., vol. 40, no. 3, pp. 648–656, Mar.
2012.
[33] D. A. Martin, B. K. Smith, and A. Gabrielli, “Mechanical ventilation,
diaphragm weakness and weaning: A rehabilitation perspective,” Respir.
Physiol. Neurobiol., vol. 189, no. 2, pp. 377–383, May 2013.
[34] R. Gosselink, R. C. Wagenaar, and M. Decramer, “Reliability of a commercially available threshold loading device in healthy subjects and in
patients with chronic obstructive pulmonary disease,” Thorax, vol. 51,
pp. 601–605, 1996.
[35] S. M. Kay, “Modern spectral estimation: Theory and application,” Signal
Processing Series, Alan V. Oppenheim, Ed. Englewood Cliffs, NJ, USA:
Prentice-Hall, 1988.
[36] M. J. Tobin, M. J. Mador, S. M. Guenther, R. F. Lodato, and M. A. Sackner,
“Variability of resting respiratory drive and timing in healthy subjects,” J.
Appl. Physiol., vol. 65, no. 1, pp. 309–317, Jul. 1988.
[37] L. I. Lin, “A concordance correlation coefficient to evaluate reproducibility,” Biometrics, vol. 45, no. 1, pp. 255–268, Mar. 1989.
[38] L. I. Lin, “A Note on the concordance correlation coefficient,” Biometrics,
vol. 56, no. 1, pp. 324–325, 2000.
[39] J. D. Evans, Straightforward Statistics for the Behavioral Sciences. Pacific
Grove, CA, USA: Brooks/Cole Publishing Company, 1996.
[40] G. B. McBride, “A proposal for Srength-of-agreement criteria for Lin’s
concordance correlation coefficient,” NIWA, Auckland, New Zealand,
NIWA Client Report, HAM2005-062, 2005.

ESTRADA et al.: IMPROVEMENT IN NEURAL RESPIRATORY DRIVE ESTIMATION FROM DIAPHRAGM ELECTROMYOGRAPHIC SIGNALS

[41] Y. M. Luo, H. D. Wu, J. Tang, C. Jolley, J. Steier, J. Moxham,
N. S. Zhong, and M. I. Polkey, “Neural respiratory drive during apnoeic
events in obstructive sleep apnoea,” Eur. Respir. J., vol. 31, pp. 650–657,
2008.
[42] Y. M. Luo, N. Hart, N. Mustfa, R. A. Lyall, M. I. Polkey, and J. Moxham,
“Effect of diaphragm fatigue on neural respiratory drive,” J. Appl. Physiol.,
vol. 90, no. 5, pp. 1691–1699, 2001.

Luis Estrada (M’08) was born in Panama City,
Panama, in 1982. He received the B.Sc. degree in
biomedical engineering from the Universidad Latina
de Panamá, Panama, in 2004 and the M.Sc. degree in biomedical engineering from the Universitat
de Barcelona, Barcelona, Spain and the Universitat
Politècnica de Catalunya (UPC), Barcelona, in 2009.
He is currently working toward the Ph.D. degree in
biomedical engineering at the UPC, the Institute for
Bioengineering of Catalonia (IBEC) and the Biomedical Research Networking Center in Bioengineering,
Biomaterials and Nanomedicine (CIBER-BBN), Barcelona.
His current research interests include signal processing techniques as well
as the use of novel sensors and biomedical instrumentation for the evaluation of
respiratory muscles.
Mr. Estrada is a member of the IEEE Engineering in Medicine and Biology
Society.
Abel Torres (M’97) was born in Figueres (Girona),
Spain, in 1972. He received the M.Sc. degree in electrical engineering and the Ph.D. degree in biomedical
engineering, from the Technical University of Catalonia (UPC), Barcelona, Spain, in 1997 and 2003,
respectively. From 1998 to 2002, he worked as a
Research Fellow at the Biomedical Engineering Research Centre, Barcelona.
He is currently a Professor of automatic control in
the Department of Automatic Control (ESAII), UPC
and he is also involved as a Senior Researcher with
the Institute for Bioengineering of Catalonia, Barcelona and the Biomedical Research Networking Center in Bioengineering, Biomaterials and Nanomedicine
(CIBER-BBN), Barcelona. His main research interests include the field of
biomedical signal processing, and its application to the analysis of noninvasive respiratory muscle signals.

485

Leonardo Sarlabous was born in Santiago de Cuba,
Cuba, in 1980. He received the Degree in telecommunications and electronics engineering from the University of Oriente, Santiago de Cuba, in 2005 and
the Ph.D. degree in biomedical engineering from the
Technical University of Catalonia, Barcelona, Spain,
in 2013.
He is currently a Postdoctoral Researcher at the
Biomedical Research Networking Center in Bioengineering, Biomaterials and Nanomedicine, Barcelona
and at the Institute for Bioengineering of Catalonia,
Barcelona. His current research interests include signal processing, analysis and
modeling of respiratory muscle signals recorded by means accelerometers.

Raimon Jané (M’91–SM’14) received the Ph.D. degree from the Universitat Politècnica de Catalunya
(UPC), Barcelona, Spain, in 1989.
He is currently the Director of research in the Department of Automatic Control (ESAII), UPC, and
the Scientific Group Leader of the Biomedical Signal Processing and Interpretation Group, Institute for
Bioengineering of Catalonia, Barcelona. Since 2008,
he has been the Principal Investigator of the Biomedical Signals and Systems Group, Biomedical Research
Networking Center in Bioengineering, Biomaterials
and Nanomedicine, Barcelona. He is a Professor of the Master’s and the Coordinator of the Ph.D. programs on biomedical engineering. His research interests
include multimodal and multiscale biomedical signal processing in cardiorespiratory diseases and sleep disorders. He is currently member of IEEE EMBS
Technical Committee on Cardiopulmonary Systems.
Prof. Jané received the Barcelona City Prize, of the Barcelona Council, in
the area of technology research in 2005. Since 2012, he is the President of the
Spanish Society of Biomedical Engineering.

