606

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Lumen Segmentation in Intravascular Optical
Coherence Tomography Using Backscattering
Tracked and Initialized Random Walks
Abhijit Guha Roy, Student Member, IEEE, Sailesh Conjeti, Student Member, IEEE, Stéphane G. Carlier,
Pranab K. Dutta, Member, IEEE, Adnan Kastrati, Andrew F. Laine, Fellow, IEEE, Nassir Navab, Amin Katouzian,
and Debdoot Sheet, Member, IEEE

Abstract—Intravascular imaging using ultrasound or optical
coherence tomography (OCT) is predominantly used to adjunct
clinical information in interventional cardiology. OCT provides
high-resolution images for detailed investigation of atherosclerosisinduced thickening of the lumen wall resulting in arterial blockage
and triggering acute coronary events. However, the stochastic uncertainty of speckles limits effective visual investigation over large
volume of pullback data, and clinicians are challenged by their
inability to investigate subtle variations in the lumen topology
associated with plaque vulnerability and onset of necrosis. This
paper presents a lumen segmentation method using OCT imaging physics-based graph representation of signals and random
walks image segmentation approaches. The edge weights in the
graph are assigned incorporating OCT signal attenuation physics
models. Optical backscattering maxima is tracked along each Ascan of OCT and is subsequently refined using global graylevel
statistics and used for initializing seeds for the random walks
image segmentation. Accuracy of lumen versus tunica segmentation has been measured on 15 in vitro and 6 in vivo pullbacks,
each with 150–200 frames using 1) Cohen’s kappa coefficient
(0.9786 ± 0.0061) measured with respect to cardiologist’s annotation and 2) divergence of histogram of the segments computed
with Kullback–Leibler (5.17 ± 2.39) and Bhattacharya measures (0.56 ± 0.28). High segmentation accuracy and consistency
substantiates the characteristics of this method to reliably segment
lumen across pullbacks in the presence of vulnerability cues and
necrotic pool and has a deterministic finite time-complexity. This
paper in general also illustrates the development of methods and
framework for tissue classification and segmentation incorporating
cues of tissue–energy interaction physics in imaging.
Index Terms—Intravascular imaging, lumen segmentation, optical backscattering physics, optical coherence tomography, random
walks.

Manuscript received November 20, 2014; revised February 5, 2015; accepted
February 9, 2015. Date of publication February 12, 2015; date of current version
March 3, 2016.
A. Guha Roy, P. K. Dutta, and D. Sheet are with the Department of
Electrical Engineering, Indian Institute of Technology Kharagpur, Kharagpur 721302, India (e-mail: abhi4ssj@gmail.com; pkd@ee.iitkgp.ernet.in; debdoot@ee.iitkgp.ernet.in).
S. Conjeti, A. Kastrati, N. Navab, and A. Katouzian are with Technische
Universität München, 80333 Munich, Germany (e-mail: sailcon.131@
gmail.com; kastrati@dhm.mhn.de; nassir.navab@tum.de; amin.katouzian@
cs.tum.edu).
S. G. Carlier is with the Department of Cardiology, Hôpital Ambroise Paré and
Université de Mons, B-7000 Mons, Belgium (e-mail: sgcarlier@hotmail.com).
A. F. Laine is with Columbia University, New York, NY 10027 USA (e-mail:
laine@columbia.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2015.2403713

I. INTRODUCTION
ARDIOVASCULAR diseases increasingly account for
most deaths globally and is estimated to annually account
for 23.3 million by 2030 [1]. Atherosclerosis is a medical condition caused by thickening of the arterial wall (tunica media or t.
media) due to excessive deposition of extracellular contents like
lipids and calcium forming plaques between the tunica intima
and tunica media. This thickening of tunica intima subsequently
leads to decrease of the lumen area and eventually leads to partial
or complete blockage of blood flowing through the artery [2].
Presence of untreated plaques over prolonged periods leads to
onset of necrosis in lipid rich regions that often triggers vulnerability. It can lead to unstable or stable angina pectoris (chest
pain or discomfort), myocardial infarction (heart attack), and
sudden death due to full occlusion of a coronary artery when
a vascular plaque ruptures [3]. Coronary angiography is generally the corner stone for primary diagnosis and localization
of plaques within the artery. Due to their limited spatial resolution and inability to visualize the plaque, adjunct imaging
with intravascular optical coherence tomography (OCT) [4]–[6]
or intravascular imaging using ultrasound (IVUS) [2] is additionally performed for high-resolution imaging and detailed
investigation.
OCT uses the principle of speckle formation through coherence sensing in photons backscattered by a highly scattering
optical media, viz. biological tissues [7]. Intravascular imaging
is carried out using a catheter mounted system which is used
for high-resolution (10–20 μm) cross-sectional imaging of the
artery up to depth of 0.5–2.0 mm. These characteristics make it
more preferable compared to IVUS since it allows clinicians to
assess symptomatic cues of plaque vulnerability like the thincap fibroatheroma rupture [4]. However, the spatiotemporal nonstationarity and stochastic uncertainty of speckle appearance in
OCT causes visual discomfort to the clinical interpreter and limits effective use of the method for high-throughput deployment
across multiple centers. This has motivated substantial research
in developing computer-based methods of image segmentation
[8], [9], classification and tissue characterization [4]–[6], [10],
[11] for assisting clinicians with high-throughput screening. A
predominant challenge still remains while imaging and analyzing thin-cap fibroatheromatous plaques where the necrotic pool
is present very close to the lumen and the stochastic of associated speckles are very different. Most tissue characterization

C

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

GUHA ROY et al.: LUMEN SEGMENTATION IN INTRAVASCULAR OCT USING BACKSCATTERING INITIALIZED RANDOM WALKS

algorithms [4]–[6], [10] require cues about the lumen boundary
for effective functioning and a clinician manually annotates region of interest on the images for computer-based investigation,
while currently available methods for automatic lumen segmentation in OCT images [8], [9] are limited in their ability to 1)
reliably segment lumen in presence of thin-cap fibroatheroma;
2) require manual initialization; and 3) iterative and do not have
deterministic time complexity.
This paper presents an algorithm for reliable segmentation of
lumen in sequence of OCT images of atherosclerotic arteries in
the presence of vulnerability cues like thin-cap fibroatheromatous plaques. The problem of lumen segmentation is formally
defined in Section II. The algorithm detailed in Section III is
modeled using a random walks graph-based representation of
the OCT data incorporating photon propagation physics and optical backscattering in biological tissues. Section IV presents
experimental results along with evaluation of lumen segmentation accuracy. The results and different characteristics of the
algorithm are discussed in Section V. Finally, we conclude the
work elucidating its translating potential in Section VI. Implementation of this framework is also made available.1
II. FORMAL DEFINITION
Let us consider an intravascular OCT image I such that intensity at a location x be i(x). The objective of lumen segmentation is to split I into two disjoint sets Ilum en and Itu n ica
such that Ilum en ∩ Itu n ica = ∅ and Itu n ica = I − Ilum en . We
define I as an equivalent graph G such that the nodes of G
represent each x ∈ I and the edges connecting the nodes of
G are modeled, incorporating physics of photon propagation
and attenuation within highly scattering biological tissues. The
probability of each node of G is obtained by solving it using
the random walks for image segmentation approach [12]. The
class posterior probability of a location x is the probability of
the corresponding node in G and the pixel at x is labeled as
arg max {p(lumen|x, I), p(tunica|x, I)}.
Further, in order to achieve solution to the random walks,
a set of seeds M constituting some of the marked nodes
of G such that M ⊆ {(M ∈ Ilum en ) ∪ (M ∈ Itu n ica )} and
(M ∈ Ilum en ) ∩ (M ∈ Itu n ica ) = ∅ is defined for initialization using physics-based models of photon backscattering in biological tissues that influence OCT speckle formation and imaging. The random walks solver would assign class posterior probability to the unmarked nodes U = I − M to achieve the lumen
segmentation task such that I ⊆ {M ∪ U} and M ∩ U = ∅.
Fig. 1 illustrates the different stages of our proposed algorithm
that are detailed in the subsequent sections.
III. EXPOSITION TO THE SOLUTION
OCT relies on the basic principle of using low time-coherence
interferometry depth scans performed in the time domain for image formation [13]. A Michelson’s interferometer is illuminated
by a broadband low time-coherence light source which splits the
1 http://www.facweb.iitkgp.ernet.in/˜debdoot/downloads/OCTLumSegRW
.zip

607

incident light into the sample and reference beams with fields
ES and ER , respectively. ES focuses through the scanning optics and objective lens to the tissue constituting the artery being
images. A modified field US is returned by backscattering from
the tissues, while the reference field reflected from the depth
scan mirror is UR . The field from reference arm corresponds to
a large phasor UR = AR exp[j(α − Ωt)], where AR is the field
amplitude, Ω is the phase change introduced by pulsation of the
depth scan mirror, and α is the complex phase residual in the
source beam. The field from the sample beam is made up of a
small random phasor US = AT exp(jβ), where AT is the field
amplitude and β is the phase associated with the backscattering
media viz. tissues being images. The photodetector is sensitive
to the resultant intensity IT = UT UT∗ , where the detected time
coherence field is UT = UR + US = AT exp(jθ) and UT∗ is the
complex conjugate of UT . The most relevant for OCT imaging
is the phase difference φ between UR and US such that the
phasor summation of the intensity sensed at the detector can be
written as
IT = (UR + US )(UR + US )∗ = A2R + A2S − 2AR AS cos φ
(1)
where φ = β − α − Ωt and the effective OCT signal is obtained
after bandpass filtering to remove the constant intensity terms.
Since the coherence length of the imaging setup exceeds a few
wavelengths, the phase difference β − α  β remains constant
during a few rotations of US . The rotation of US at a frequency
Ω
permits the phasors’ alignment during each measurement
of 2π
since US takes a positive and real value in each cycle at φ = 0.
Thus, the demodulated signal amplitude is given as SOCT =
2AR AS [13], [14].
Let IS be the set of speckle intensity acquired by OCT at a
point; then, it is known to be negative exponentially distributed
[15]


1
IS
exp −
(2)
p(IS ) =
σS
σS
where σS is the variance of IS [15]. Since intravascular OCT
is acquired using a rotatory scanning mechanism, the acquired
data are stored in polar domain and a location is specified using s = (sa , sθ ), where sa represents the distance of a scanning location from the start of the A-scanline and sθ represents the angular displacement of the A-scanline w.r.t the
starting scanline in the rotatory scan. Further, each location
x in the Cartesian coordinate space is associated with the
polar space as x = Tp ol2cart (s) and also an inverse relation
Tcart2p ol (·) = Tp−1
ol2cart (·) exists. Since the speckle intensity
IS (·) has a high dynamic range, it is generally compressed
nonlinearly to a lower dynamic range signal i(·) to form the
B-mode image, and they are related as
i(·) = p1 + p2 log10 (IS (·) + p3 )

(3)

where p1 , p2 and p3 are empirically determined constants [16]
and i(x) ∈ I [see Fig. 1(c)] represents the OCT image in Cartesian coordinate space as defined earlier. Equivalently, IS (x) [see
Fig. 1(a)] and IS (s) [see Fig. 1(b)], respectively, represent the

608

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 1. Illustration of the different stages involved in our approach for lumen segmentation in intravascular OCT image. (a) IV-OCT speckle data (16bpp),
(b) IV-OCT speckle data (16bpp), (c) Log compressed (B-mode) IV-OCT data, (d) Approximate mask of tunica intima, (e) Maxima tracked along each A-scan
line for seed localization, (f) Initial estimate of seeds in tunica intima, (g) Initial estimate of seeds in lumen, (h) Initial estimate of seeds in tunica intima, (i) Initial
estimate of seeds in lumen, (j) Refined estimate of seeds in tunica, (k) Refined estimate of seeds in lumen, (l) Detected lumen boundary.

uncompressed speckle intensity in Cartesian coordinate space
and in polar space.
A. Graph Representation of the Image
Let an OCT image I be represented as an undirected graph
G, where it is defined as G = (V, E) with vertices v ∈ V and
edge e ∈ E ∈ V × V . The edge e connecting two vertices vp
and vq is denoted as epq and is assigned a weight
wpq > 0. The

degree of the vertex at p is given by dp = wpq for all edges
epq connected with vp . Considering 4-adjacency of the pixels in
I such that (p, q) ∈ V are adjacent pixels in I, the edge weights
are defined following the physics of photon intensity attenuation
in OCT imaging [13]

exp (−η|zp − zq |) ,
if p and q are adjacent
wpq =
0,
otherwise
(4)
where η is an empirically defined constant and its value depends
on the models of photon intensity attenuation in OCT imaging.
zp and zq are intensities of the pixels corresponding to vertices
(p, q) in I and are illustrated in Fig. 2.
B. Seed Initialization in Lumen and Tunica
The intensity of OCT signal IS (s) at any point along the
scanline is highest when φ → 0 in (1). In the demodulated signal
amplitude SOCT , this condition indicates the highest value of the
field amplitudes AS and arises when at s there is a sharp change
of refractive index of the media through which the photons are

Fig. 2.

Equivalent graph representation of the OCT image I.

traveling. In intravascular OCT, the sharp changes occur at the
boundary of lumen and tunica intima, a thin layer of epithelial
cells laminating the vascular cavity and the muscular tunica
media [4]. At all other points following the maxima along the
A-scanline sθ , the intensity of the OCT speckle signal decays
exponentially until a further sharp change of refractive index in
the media [5], [11], [17].
This model of optical backscattering is used for finding the
initial estimate of boundary seeds [see Fig. 1(e)] on the region
between lumen and tunica intima


∀sθ ∈ IS .
(5)
sb oundary = arg max (IS (s))
sa

However, in the presence of stochastic uncertainty associated
with nonstationary speckles in OCT as mentioned in (2), the
initial estimate of seeds is not always error free as illustrated in
Fig. 3. This estimate is subsequently used to obtain an initial

GUHA ROY et al.: LUMEN SEGMENTATION IN INTRAVASCULAR OCT USING BACKSCATTERING INITIALIZED RANDOM WALKS

609

D. Solution to Random Walks for Lumen Segmentation
The graph G is represented as a combinatorial Laplacian
matrix L for achieving an analytically convergent solution [12]
⎧
dp ,
if p = q
⎪
⎪
⎨
if vp and vq are adjacent nodes
(11)
Lpq = −wpq ,
⎪
⎪
⎩
0,
otherwise

Fig. 3. Error in initial location of tunica intima seeds selected by tracking of
maxima along each A-scanline. (a) A-scanline with maxima tracked at location
other than on lumen boundary. (b) Maxima points detected along each Ascanline and erroneous points encircled. (c) A-scanline with maxima tracked at
correct location on lumen boundary.

estimate of seeds in tunica [see Fig. 1(f) and (h)] and lumen [see
Fig. 1(g) and (i)]
slum en = {(sa − a1 , sθ )}

∀(sa , sθ ) ∈ sb oundary

(6)

stu n ica = {(sa + a2 , sθ )}

∀(sa , sθ ) ∈ sb oundary

(7)

where a1 and a2 are two empirically chosen constants and the
initial estimates are used to obtain the set of marked nodes M
after refinement as present in the subsequent section.
C. Refinement of Lumen and Tunica Seeds
The tunica is formed of endothelial cells, muscle fibers, and
muscle tissue, epithelial cells in healthy arteries, and extracellular plaque constituents during atherosclerosis. The densely
placed fibrous tissues in the pool of extracellular matrix causes
intermittent change of refractive index leading to φ → 0 and
high value of the field amplitude AS in (1) thus giving rise to
high speckle intensity IS and i(x) ∈ I [13], [14]. This generally
forms a bimodal distribution of the probability density of I that
is used for determining the speckle rich region BS constituting
tunica in major and the complementary region BS̄ constituting
the lumen as deeper regions within tunica where heavy signal
attenuation limits speckle formation such that BS ∩ BS̄ = ∅ and
BS ∪ BS̄ = I:
BS = argx∈I {I ≥ τ }

(8)

where τ is obtained following the method in [18] and an example of BS post-morphological geodesic reconstruction is
illustrated in Fig. 1(d). The marked nodes M [see Fig. 1(j)
and (k)] for initializing random walks solver on G are hence
obtained as
M ∈ Ilum en = slum en ∩ BS̄

(9)

M ∈ Itunica = stunica ∩ BS .

(10)

where Lpq is indexed by vertices vp and vq . The set of vertices
or nodes V can be divided into two groups:
(1) VM ∈ M consisting of marked or seeded nodes;
(2) VU ∈ U consisting of unmarked or unseeded nodes;
such that VM ∪ VU = V and VM ∩ VU = ∅. Thus, the Laplacian matrix can be decomposed as


LM B
L=
(12)
B T LU
where LM and LU are Laplacian submatrices corresponding to
VM and VU , respectively. We denote the probability of a random
walker starting at a node vq to reach a seededpoint belonging
to tissue type ω ∈ {lumen, tunica} as xωq s.t. ω xωq = 1. Further, to achieve a solution, the set of labels defined for all the
seeds in VM ∈ M is specified using a function
Q(vq ) = ω

∀vq ∈ VM

(13)

where ω ∈ Z, 0 < ω ≤ 2 s.t. ω = 1 is the set of label corresponding to Ilum en , and ω = 2 is the set of labels corresponding
to Itu n ica . This helps us in defining M ∈ M is a 1-D vector
of |VM | × 1 elements corresponding to each label s at node
vq ∈ VM constituted as

1,
if Q(vq ) = ω
ω
mq =
(14)
0,
if Q(vq ) = ω.
Therefore, for label ω, the solution can be obtained by solving
LU xωq = −B T mωq

(15)

LU X = −B T M

(16)

where solving for ω = 1 yields X = {xq ∀q|vq ∈ V } as the set
of solution probabilities of a random walker originating at a
node q ∈ G and reaching the lumen and is associated and solved
accordingly
p(lumen|x, I) = xωq ∀{q ∈ G ⇔ x ∈ I}, ω = 1

(17)

p(tunica|x, I) = 1 − p(lumen|x, I)
(18)


Ilum en = arg max (p(ω|x, I)) = lumen . (19)
ω ,x

IV. EXPERIMENTS AND RESULTS
A. OCT Data Collection
1) In vitro: Human coronary arterial segments were obtained from anonymous autopsy examinations, less than 12 h
past death at the New York Presbyterian Hospital/Columbia

610

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
STATISTICAL DIVERGENCE BETWEEN PDF OF INTENSITY VALUES IN Nlu m e n
AND Ntu n ic a INDICATING ACCURACY OF LUMEN DETECTION IN
INTRAVASCULAR OCT DATA
Divergence measure
Kullback–Leibler distance
Bhattacharya distance

Fig. 4. Illustration of the different regions around the detected lumen boundary used for quantifying the accuracy between the two regions. (a) Detected
lumen boundary (red) with the seeds for lumen (yellow) and tunica (green). (b)
Magnified view of the lumen boundary (red) and the seeds for lumen (yellow)
and tunica (green). (c) Thin neighborhood around the detected lumen boundary
within lumen Nlu m e n (cyan) and within tunica Nt u n i c a (red).

B. Implementation
Data acquired in vitro from 15 artery segments and in vivo
from six arteries symptomatic of atherosclerotic plaque formation and thin-cap fibrotheroma were used for our experiments.
Each pullback of OCT data consisted of 150–300 frames. Each
frame of OCT signal IS acquired in polar domain consisted of
400 A-scanlines s.t. |sθ | = 400 and had 752 samples along each
A-scanline s.t. |sa | = 752. The polar domain data are converted
to Cartesian coordinate space of size 512 × 512. The values
for the nonlinear compression in (3) are p1 = 0, p2 = 1, and
p3 = 10. The constant η = 90 in (4). The empirically chosen
constants a1 = 10 in (6) and a2 = 20 in (7). The random walks
solution is obtained using [12].3
C. Quantification of Segmentation Accuracy
1) Divergence of Speckle Intensity Between Segments: Unsupervised evaluation is done by comparing the statistical divergence [19] between the distribution of intensity values of I in a
thin neighborhood around the lumen boundary in the segmented
result, with Nlum en located within the lumen and having pdf Q
and Ntu n ica located within the tunica and having pdf P . Fig. 4
2 C7-XR,

LightLab Imaging Inc., Westford, MA, USA.
lgrady/software.html

3 http://cns.bu.edu/

[17]

5.1735 ± 2.39
0.5641 ± 0.2822

4.2211 ± 6.99
0.2653 ± 0.3649

TABLE II
SUPERVISED EVALUATION OF SEGMENTATION ACCURACY
Measure
Cohen’s Kappa coefficient
Contour RMS Error

University Medical School, NY, USA. To prevent artery
contraction and deformation, the hearts were pressure-fixed before excision using 10% formalin, recirculating at 100 mmHg
for 2 h. Artery segments presenting significant plaque accumulation were identified and excised. During in vitro OCT imaging,
the artery segments were immersed in a bath of 0.9% NaCl solution maintained at 37 ◦ C. The arteries were imaged with a
rotary catheter based Fourier-domain OCT system2 with a center wavelength of 1320 nm and axial resolution of 7.3μm in
air (5.4μm in tissue) and segments with symptomatic thin-cap
fibroatheroma were also identified. Details of data acquisition
and histological correlation are available in [4].
2) In vivo: OCT imaging on six follow-up patients with
stents implanted in coronary arteries was performed with a
Fourier-domain OCT system with same specifications as used
for in vitro data. The details of data acquisition are available in
[6].

Our approach

Our approach

[17]

0.9786 ± 0.0061
8.4655 ± 3.8540

0.8692 ± 0.0709
52.0845 ± 20.4840

Fig. 5. Comparison of results obtained with our approach and prior art [17].
The expert annotated ground truth (red) and segmentation result (yellow) are
marked. The failure of prior art to segment in presence of necrotic pool is
evident. (a) Our approach (κ = 0.9797). (b) Prior art [17] (κ = 0.9621).

illustrates the selection of the different regions used, and the following measures used for divergence computation are reported
for the complete dataset in Table I.
(1) Kullback–Leibler divergence


g

P (i)
dK L =
P (i) ln
(20)
Q(i)
i=1
(2) Bhattacharya distance
dB = − ln

 g
 


P (i)Q(i)


(21)

i=1

where g is the total number of graylevels considered while computing the pdf and g = 256 in our experiments where I is an 8
bpp image.
2) Kappa Coefficient for Comparison of Interannotator Variability: Supervised evaluation of the segmentation results in
contrast with ground truths annotated by an experienced Cardiologist is performed using the Cohen’s Kappa coefficient (κ)
[20]. The ground truth lumen boundaries were annotated on 41
different OCT frames. Further, the contour RMS error between
the manually annotated lumen contour and segmentation results
(Fig. 5.) was also computed and performance of our approach
in comparison with [17] is presented in Table II.

GUHA ROY et al.: LUMEN SEGMENTATION IN INTRAVASCULAR OCT USING BACKSCATTERING INITIALIZED RANDOM WALKS

611

Fig. 6. Result of lumen detection in a sample with sparse seeds. The image
is divided in to five sectors and the seeds of lumen (yellow) and tunica intima
(green) are marked.
TABLE III
STATISTICAL DIVERGENCE BETWEEN PDF OF INTENSITY VALUES IN Nlu m e n
AND Ntu n ic a IN THE FIVE SECTORS MARKED IN FIG. 6
Divergence measure

Sec. 1

Sec. 2

Sec. 3

Sec. 4

Sec. 5

Kullback–Leibler distance
Bhattacharya distance

4.12
3.05

2.44
0.1027

0.94
2.1715

3.97
2.3714

2.91
0.08

V. DISCUSSION
A. Boundary Detection in Presence of Sparse Seeds
One of the characteristics of this algorithm is its ability to
refine the placement of seeds in lumen and tunica (see Section
III-C) for obtaining an accurate random walks solution of the
detected lumen boundary. In certain situations, this leads to
discontinuity of seeds place in the lumen, and despite this, the
algorithm is expected to perform accurately. Fig. 6 elucidates
some of such scenarios and the reliability of this algorithm
to accurately detect lumen boundary despite such limitations.
Sector 1 has an evident discontinuity in the contour of seeds
in lumen and tunica. Sector 2 has minor discontinuity in the
seeds of lumen. Sector 3 has a complete stretch of nonexistent
seeds of lumen. Sectors 4 and 5 present complete continuity
of seeds, while Sector 4 is also characterized by presence of
calcification. The detected lumen boundary contours in all the
five sectors are visually evident to accurately follow the actual
lumen boundary. Further, there is no observed discontinuity
between the detected contour in these regions. Table III presents
the divergence measures of segmentation accuracy in all the five
sectors in Fig. 6 to substantiate their consistency and reliability.
B. Interframe Consistency of Lumen Detection
An important characteristic desired in any lumen detection
algorithm is consistency of detection across adjacent frames to
ensure smooth transverse section profile of the imaged vessel.
This property is evaluated following the framework in Fig. 7.
We have considered an intravascular OCT stack of 200 frames
for one pullback data. A transverse section is sliced out from

Fig. 7. Result of interframe consistency of lumen boundary detection.
(a) Stack of IV-OCT frames (16bpp), (b) Detected Lumen Boundary, (c) Transverse Section of IV-OCT frames (8bpp), (d) Detected Lumen Boundary in
Transverse Section, (e) Segmented Lumen Boundary (green) with manually initialized seeds for Lumen (yellow) and tunica intima (magenta), (f) Comparison
of Consistency of detected Lumen boundary (red) accross frames in contract
with manual segmentation (green).

this stack [see Fig. 7(c)] and the lumen boundary is detected
in it using manually seeded random walks [see Fig. 7(e)]. This
resultant contour is compared with the contour observed by
transverse sectioning of the lumen contour map in the detected
results [see Fig. 7(d)]. The comparison is presented in Fig. 7(f).
The mean squared error between these two lumen contours is
computed to be limited with displacement of 2.01 pixels and
evidently substantiates the claim of interframe consistency of
detected lumen boundary.
C. Reliable Detection in Plaques of Different Sizes and Shapes
Another important characteristic desired in any lumen boundary detection algorithm is its ability to perform with equal reliability across multiple shapes and sizes of plaques images with
intravascular OCT. Fig. 8 illustrates this ability of this algorithm. The segmentation accuracy in these two OCT images is
presented in Table IV and their consistency strongly substantiates this ability of the algorithm.
D. Effect of Guide-Wire and Stent Strut Shadows
A major challenge in lumen segmentation is the presence of
shadows due to the guide-wire and stent struts during in vivo

612

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Fig. 8. Illustration of reliable lumen boundary detection across plaques of
different shapes and sizes. (a) Section with small lumen size. (b) Section with
larger lumen size.
TABLE IV
STATISTICAL DIVERGENCE BETWEEN PDF OF INTENSITY VALUES IN Nlu m e n
AND Ntu n ic a IN FIG. 8
Divergence measure

Fig. 8(a)

Fig. 8(b)

Kullback–Leibler distance
Bhattacharya distance

12.1649
0.6841

7.6227
0.3785

sity is nonlinearly compressed to a lower dynamic range. This
is subsequently modeled as a 2-D graph with four-neighbor adjacency between the nodes and the edge weights are modeled
following speckle intensity attenuation physics of OCT signals.
The solution to segmentation is obtained using a random walks
solver, where the initial estimates of seeds for lumen and tunica
are provided by estimating them from backscattering properties
along each A-scanline and through refinement in the presence of
stochastic uncertainty of OCT speckle intensity. The segmented
lumen boundary in OCT data of 15 in vitro and six in vivo pullbacks each with 150–300 frames has been assessed to be highly
accurate as indicated by quantified scores of statistical divergence measures and interannotator variability comparison with
Cohen’s Kappa coefficient. The method also demonstrates 1)
reliable lumen segmentation in the presence of different tissues
under the lumen border, 2) interframe consistency of detected
lumen, 3) ability to segment lumen over wide shape and size
variations, 4) reliability in presence of guide-wire and stent
strut shadows, and 5) deterministic and finite time complexity
and assured convergent results [12]. These characteristics make
it unique and provide it with an edge compared to other stateof-the-art methods of lumen segmentation. Furthermore, this
framework also presents rational incorporation of OCT imaging physics into each stage of the algorithm to compensate for
uncertainty inherent to tissue–energy interaction physics of the
imaging modality.

REFERENCES

Fig. 9. Reliable lumen boundary detection in in vivo OCT images in presence
of guide-wire and stent strut shadows. The seeds of lumen (yellow), tunica
(green) and segmented lumen boundary (red) are marked.

imaging. Fig. 9 illustrates the characteristics of our approach to
accurately segment the lumen in the presence of such artifacts.
E. Computational Time
The proposed algorithm was implemented in MATLAB
r2013b and executed on a laptop computer with Intel Core i3
@ 2.50-GHz CPU, 4.00 GB of RAM, and Windows 8 (64 bits)
operating system. Per frame processing time was 18.82 ± 1.77
s when tested over 30 frames of OCT pullback data.
VI. CONCLUSION
This paper presents a computationally efficient and reliable
algorithm for completely automated and user-interaction free lumen boundary detection in intravascular OCT image sequences.
The algorithm models the problem as a graph-based segmentation approach and uses cues of tissue–photon interaction in OCT
for creating the model, thus contributing in its high accuracy and
reliability. Initially, the OCT data acquired in polar domain are
converted to Cartesian coordinate space and its speckle inten-

[1] S. C. Smith, A. Collins, R. Ferrari, D. R. Holmes, S. Logstrup, D. V.
McGhie, J. Ralston, R. L. Sacco, H. Stam, and K. Taubert, “Our time: A
call to save preventable death from cardiovascular disease (heart disease
and stroke),” J. Am. Coll. Cardiol., vol. 60, no. 22, pp. 2343–2348, 2012.
[2] J. S. Suri, C. Kathuria, and F. Molinari, Eds., Atherosclerosis Disease
Management. New York, NY, USA: Springer, 2010.
[3] J. Narula, M. Nakano, R. Virmani, F. D. Kolodgie, R. Petersen, R. Newcomb, S. Malik, V. Fuster, and A. V. Finn, “Histopathologic characteristics
of atherosclerotic coronary disease and implications of the findings for the
invasive and noninvasive detection of vulnerable plaques,” J. Am. Coll.,
Cardiol., vol. 61, no. 10, pp. 1041–1051, 2013.
[4] C. Xu, S. G. Carlier, R. Virmani, and J. M. Schmitt, “Characterization of
atherosclerosis plaques by measuring both backscattering and attenuation
coefficients in optical coherence tomography,” J. Biomed. Opt., vol. 13,
no. 3, p. 034003, 2008.
[5] F. J. van der Meer, D. J. Faber, D. B. Sassoon, M. C. Aalders, G.
Pasterkamp, and T. G. van Leeuwen, “Localized measurement of optical
attenuation coefficients of atherosclerotic plaque constituents by quantitative optical coherence tomography,” IEEE Trans. Med. Imag., vol. 24,
no. 10, pp. 1369–1376, Oct. 2005.
[6] C. Malle, T. Tada, K. Steigerwald, G. J. Ughi, T. Schuster, M. Nakano, S.
Massberg, J. Jehle, G. Guagliumi, A. Kastrati, R. Virmani, R. A. Byrne,
and M. Joner, “Tissue characterization after drug-eluting stent implantation using optical coherence tomography,” Arteriosclerosis, Thrombosis,
Vascular Biol., vol. 33, no. 6, pp. 1376–1383, 2013.
[7] D. Huang, E. A. Swanson, C. P. Lin, J. S. Schuman, W. G. Stinson,
W. Chang, M. R. Hee, T. Flotte, K. Gregory, C. A. Puliafito, and J. G.
Fujimoto, “Optical coherence tomography,” Science, vol. 254, no. 5035,
pp. 1178–1181, 1991.
[8] M. Moraes, C. Cardoso, A. C. Diego, and S. S. Furuie, “Automatic lumen
segmentation in IVOCT images using binary morphological reconstruction,” Biomed. Eng. Online, vol. 12, p. 78, Jan. 2013.
[9] S. Tsantis, G. C. Kagadis, K. Katsanos, D. Karnabatidis, G. Bourantas, and
G. C. Nikiforidis, “Automatic vessel lumen segmentation and stent strut
detection in intravascular optical coherence tomography,” Med. Phys., vol.
39, no. 1, pp. 503–13, Jan. 2012.

GUHA ROY et al.: LUMEN SEGMENTATION IN INTRAVASCULAR OCT USING BACKSCATTERING INITIALIZED RANDOM WALKS

[10] S. Celi and S. Berti, “In-vivo segmentation and quantification of coronary lesions by optical coherence tomography images for a lesion type
definition and stenosis grading,” Med. Image Anal., vol. 18, no. 7, pp.
1157–1168, 2014.
[11] G. J. Ughi, K. Steigerwald, T. Adriaenssens, W. Desmet, G. Guagliumi,
M. Joner, and J. Dhooge, “Automatic characterization of neointimal tissue
by intravascular optical coherence tomography,” J. Biomed. Opt., vol. 19,
no. 2, pp. 021 104–021 104, 2014.
[12] L. Grady, “Random walks for image segmentation,” IEEE Trans. Pattern
Anal., Mach. Intell., vol. 28, no. 11, pp. 1768–1783, Nov. 2006.
[13] A. F. Fercher, W. Drexler, C. K. Hitzenberger, and T. Lasser, “Optical
coherence tomography-principles and applications,” Rep., Prog., Phys.,
vol. 66, no. 2, p. 239, 2003.
[14] J. M. Schmitt, “Optical coherence tomography (OCT): A review,” IEEE
J. Sel. Topics, Quantum Electron., vol. 5, no. 4, pp. 1205–1215, Jul./Aug.
1999.
[15] M. Bashkansky and J. Reintjes, “Statistics and reduction of speckle in
optical coherence tomography,” Opt. Lett., vol. 25, no. 8, pp. 545–547,
2000.
[16] D. Kaplan and Q. Ma, “On the statistical characteristics of log-compressed
rayleigh signals: Theoretical formulation and experimental results,” in
Proc. IEEE Ultrason. Symp., Oct. 1993, pp. 961–964.
[17] G. J. Ughi, T. Adriaenssens, P. Sinnaeve, W. Desmet, and J. Dhooge,
“Automated tissue characterization of in vivo atherosclerotic plaques by
intravascular optical coherence tomography images,” Biomed. Opt. Exp.,
vol. 4, no. 7, pp. 1014–1030, 2013.
[18] N. Otsu, “A threshold selection method from gray-level histograms,” Automatica, vol. 11, nos. 285–296, pp. 23–27, 1975.
[19] S. Cha, “Comprehensive survey on distance/similarity measures between
probability density functions,” Int. J. Math. Models, Methods, Appl. Sci.,
vol. 1, no. 4, pp. 300–307, 2007.
[20] J. Cohen, “A coefficient of agreement for nominal scales,” Educ. Psychol.
Meas., vol. 20, no. 1, pp. 37–46, Apr. 1960.

Abhijit Guha Roy (S’15) was born in Baripada, India
in 1989. He received the B.E. degree in electrical engineering from Jadavpur University, Kolkata, India,
in 2012. He has been working toward the M.Tech. degree in instrumentation and signal processing at the
Indian Institute of Technology Kharagpur, Kharagpur, India, since 2013.
He is also a DAAD Visiting Student at the
Technishe Universität München, München, Germany.
His research interests include computational medical
imaging, machine learning, and medical image computing.

Sailesh Conjeti (S’11) was born in Chennai, India, in
1990. He received the B.E.(Hons.) degree in electrical
and electronics engineering from the Birla Institute
of Technology and Science, Pilani, India, in 2012, the
M.Tech. degree in medical imaging and informatics
from the Indian Institute of Technology Kharagpur,
Kharagpur, India, in 2014. He is currently a doctoral student at the Chair for Computer Aided Medical Procedures at Technishe Universität München,
München, Germany.
His research interests include computational medical imaging, machine learning, medical image computing, and biomedical
signal processing.

613

Stéphane G. Carlier received the M.D. degree from
the Université Libre de Bruxelles, Brussel, Belgium,
in 1996, and the Ph.D. degree in biomedical engineering from Erasmus University, Rotterdam, Netherlands, in 2001.
He is currently an Interventional Cardiologist at
Hôpital Ambroise Paré and a Professor of cardiology
at the Université de Mons (UMons), Mons, Belgium.
He was an Assistant Professor of clinical medicine at
Columbia University, New York, NY, USA and the
Director of the Intravascular Imaging and Physiology
Corelab of the Cardiovascular Research Foundation. His research interests include intravascular imaging, cardiac and vascular dynamics, physiology, and
signal processing.
Dr. Carlier is a Member of the European Association of Percutaneous Cardiovascular Interventions of the European Society of Cardiology.

Pranab K. Dutta (M’10) received the B.E. degree
in electrical engineering from Bengal Engineering
College, Shibpur, India, in 1984, the M.E. degree
in electrical engineering from the University of Calcutta, Kolkata, India, in 1986, and the Ph.D. degree
in electrical engineering from the Indian Institute of
Technology Kharagpur, Kharagpur, India, in 1992.
He has been a Professor at the Department of
Electrical Engineering, since 2004, and the Head of
the School of Medical Science and Technology, since
2009, at the Indian Institute of Technology Kharagpur, where he joined as a Lecturer in 1993. His main research interests include
optical imaging, image processing, and machine learning for biomedical applications.

Adnan Kastrati studied medicine in Tirana, Albania,
where he graduated in 1979. He trained as a specialist
and completed his postdoctoral studies in 1988.
He was an Alexander von Humboldt Researcher at
Heidelberg University, Germany, and Technishe Universität München (TUM), Germany. Prior to his appointment to the Chair of Internal Medicine at TUM,
since 2000, he has worked as a Visiting Researcher
at the German Cardiac Center in Munich (DHM). He
is currently a Chief Physician and Deputy Director
of the Cardiovascular Disease Clinic at DHM and
Director of the Cardiac Catheter Laboratory and the ISARESEARCH Center.
His research focus is on optimizing treatment strategies in patients with acute
coronary syndrome and in developing new drug-coated stents with an improved
safety and efficacy profile.

Andrew F. Laine (S’82–M’83–SM’07–F’10) received the B.S. degree from Cornell University,
Ithaca, NY, USA, in 1977, and the D.Sc. degree from
Washington University, St. Louis, MO, USA, in 1989.
He is currently with the Department of Biomedical Engineering, Columbia University, New York,
NY, USA. He is the President of the IEEE Engineering in Medicine and Biology Society (EMBS)
(2015–2016), has served as the Chair of Technical
Committee on Biomedical Imaging and Image Processing for the EMBS (2006–2009), and is on the
IEEE ISBI steering committee since 2006. His research interests include quantitative image analysis; cardiac functional imaging: ultrasound and MRI, retinal
imaging, intravascular imaging and biosignal processing. He is a Fellow of the
American Institute for Medical and Biological Engineering.

614

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Nassir Navab received the Diploma degree in computer engineering from the University of Technology
of Compiégne, Compiégne, France, in 1988, and the
Ph.D. from INRIA, Paris, France, in 1993.
He is currently a Chair Professor for computer
aided medical procedures and a Professor at the
School of Medicine, Technical University of Munich, Germany; Professor of Computer Science at
the Johns Hopkins University, Baltimore, MD, USA.
His research interests include surgical workflow, registration/visualization, segmentation, reconstruction,
medical imaging, molecular imaging, computer-aided surgery, patient monitoring, computer vision, industrial augmented reality, medical augmented reality,
and machine learning for medical applications.
Dr. Navab is an Associate Editor for the IEEE TRANSACTIONS ON MEDICAL IMAGING, Medical Physics, and on the Editorial Board of Medical Image
Analysis and International Journal Computer Vision. He is also a Fellow of the
MICCAI Society.

Amin Katouzian received the B.S. degree from Sistan and Baluchestan University, Sistan Va Baluchestan, Iran, and the M.S. degree from Fairleigh Dickinson University, NJ, USA, in 1998 and 2004, respectively, both in electrical engineering, and the Ph.D.
degree in biomedical engineering from Columbia
University, New York, NY, USA in 2011. During his
Ph.D., he developed algorithms for ultrasound-based
tissue characterization of atherosclerotic plaques.
He has been a Senior Research Scientist at the
Chair for Computer Aided Medical Procedures, Technical University of Munich, Munich, Germany, since 2011. His research interests
include multidimensional medical image and signal analysis, computer-aided
diagnosis and surgery, pattern recognition, and understanding of sensory data
within surgical workflows.

Debdoot Sheet (S’09–M’14) was born in Kharagpur, India, in 1986. He received the B.Tech. degree
in electronics and communication engineering from
the West Bengal University of Technology, Kolkata,
India, in 2008, the M.S. and Ph.D. degrees in medical imaging from the Indian Institute of Technology
Kharagpur, Kharagpur, India, in 2010 and 2014, respectively.
He was a DAAD Visiting Scholar at the Chair
for Computer Aided Medical Procedures, Technishe
Universität München, München, Germany, during
2011–2012. He is currently an Assistant Professor of electrical engineering
at the Indian Institute of Technology Kharagpur. His research interests include
computational medical imaging, machine learning, image and multidimensional
signal processing, and visualization. He has been a Regional Editor of IEEE
PULSE since 2014.

