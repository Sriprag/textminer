IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

349

Breast Segmentation and Density Estimation in
Breast MRI: A Fully Automatic Framework
Albert Gubern-Mérida, Michiel Kallenberg, Ritse M. Mann, Robert Martı́, and Nico Karssemeijer

Abstract—Breast density measurement is an important aspect in
breast cancer diagnosis as dense tissue has been related to the risk of
breast cancer development. The purpose of this study is to develop
a method to automatically compute breast density in breast MRI.
The framework is a combination of image processing techniques
to segment breast and fibroglandular tissue. Intra- and interpatient signal intensity variability is initially corrected. The breast is
segmented by automatically detecting body-breast and air-breast
surfaces. Subsequently, fibroglandular tissue is segmented in the
breast area using expectation–maximization. A dataset of 50 cases
with manual segmentations was used for evaluation. Dice similarity coefficient (DSC), total overlap, false negative fraction (FNF),
and false positive fraction (FPF) are used to report similarity between automatic and manual segmentations. For breast segmentation, the proposed approach obtained DSC, total overlap, FNF,
and FPF values of 0.94, 0.96, 0.04, and 0.07, respectively. For fibroglandular tissue segmentation, we obtained DSC, total overlap,
FNF, and FPF values of 0.80, 0.85, 0.15, and 0.22, respectively. The
method is relevant for researchers investigating breast density as a
risk factor for breast cancer and all the described steps can be also
applied in computer aided diagnosis systems.
Index Terms—Atlas-based segmentation, breast density segmentation, breast MRI, breast segmentation, image processing, quantitative image analysis.

I. INTRODUCTION
REAST MRI is a technique employed for 1) screening for
breast cancer in high risk patients, 2) evaluation of tumor
extent in specific groups of patients with breast cancer (e.g., patients with invasive lobular carcinoma), 3) evaluation of tumor
response to chemotherapy treatment, and 4) trouble shooting in
case of inconclusive findings from other modalities [1]. It provides good tissue contrast between fibroglandular (also referred
to as dense) and fatty tissues, thus allowing three-dimensional

B

Manuscript received October 23, 2013; revised January 20, 2014; accepted
March 5, 2014. Date of publication March 11, 2014; date of current version
December 30, 2014. This work was supported by the Spanish Science and Innovation under Grant TIN2012-37171-C02-01. The work of A. Gubern-Mérida
was supported by the FPU under Grant AP2009-2835.
A. Gubern-Mérida is with the Department of Computer Architecture and
Technology, University of Girona, 17071 Girona, Spain, and also with the
Department of Radiology, Radboud University Medical Center, 6525 GA
Nijmegen, The Netherlands (e-mail: agubernmerida@gmail.com).
M. Kallenberg, R. M. Mann, and N. Karssemeijer are with the Department
of Radiology, Radboud University Medical Center, 6525 GA Nijmegen, The
Netherlands (e-mail: michielkallenberg@gmail.com; R.Mann@rad.umcn.nl;
n.karssemeijer@rad.umcn.nl).
R. Martı́ is with the Department of Computer Architecture and Technology,
University of Girona, 17071 Girona, Spain (e-mail: marly@eia.udg.edu).
Digital Object Identifier 10.1109/JBHI.2014.2311163

characterization of breast composition. Segmentation of the different structures visible in a breast MRI is needed to perform
an automatic analysis of such images. Some examples of applications in breast MRI which require an initial segmentation
step are multimodal breast image registration, computer aided
analysis of dynamic contrast enhanced MRI [2], and breast density assessment [3], [4]. Related to the latter, breast density has
been identified as an important risk factor for developing breast
cancer, with risk being four times larger in women with a breast
density higher than 75%, compared to those with little or no
density [3], [4]. Automated segmentation of breast density in
breast MRI is the main focus of this paper.
In general, two steps are required to obtain 3-D breast density
measurement from MRI: Breast segmentation and fibroglandular tissue segmentation. The segmentation of the breast is
initially performed to exclude other tissue that does not belong
to the breast, such as pectoral muscle. The separation of the
breast from the body is a difficult task. Complicating factors
are the large shape variations of pectoral muscles across different patients and the similarity between intensity distributions
of the MRI signal in muscle and fibroglandular tissues. Other
issues are caused by the lack of agreement on the anatomical extent of the breast. Because no automated segmentation
method was available, manual intervention has been mostly required [5]–[9] in the literature. In some studies, the definition
of the breast-body interface was made by manually defining
a straight line [5], [6]. Other studies combined edge detection
filters and manual outlining to delineate the breast volume [7],
[8], [10]. Nie et al. [9] used an approach for breast volume segmentation that also requires some manual intervention when the
chest wall is connected to fibroglandular tissue. Their algorithm
starts with the detection of body landmarks and is followed by
fuzzy C-means (FCM), B-spline fitting, and dynamic searching.
However, the thoracic spine, which is used as a body landmark,
is not always visible in all acquisition orientations and field of
views. Fully automatic breast segmentation has been addressed
by a few authors. Wang et al. [11] used second derivative information represented by the Hessian matrix to delineate chest
wall and air-breast boundary. Another example is found in the
work of Gallego-Ortiz et al. [12], where a method based on 3-D
edge detection combined with probabilistic atlas of the breast is
proposed to extract the breast. Both approaches led to satisfactory breast segmentation results, but segmentation of internal
structures in the breast, such as fibroglandular tissue, was not
included.
Regarding the second step, different techniques have been
applied to segment the fibroglandular tissue in breast MRI. Interactive thresholding of the breast tissue signal intensity was

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

350

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

used to study the correlation between MRI percent density
and area-based [5], [10] and volume-based [6] mammography
percent density. Alternatively, other studies proposed a twocompartmental model [7], which linearly combines pure-tissue
signals, and FCM algorithm [8], [9], [13] to segment fatty and
fibroglandular tissue. More recently, an atlas-aided probabilistic
model-based method has been also described [14], where breast
tissue is characterized by a mixture model and a fibroglandular
tissue probabilistic atlas is used as a prior likelihood in combination with FCM. Among all these studies on breast density
estimation on MRI, only Wu et al. [13], [14] presented two
fully automatic fibroglandular segmentation approaches integrated with automated breast segmentation. In both approaches,
the outline of the breast is initially defined on each slice of
the MR volume using context information. The segmentation
of fibroglandular tissue is performed in [13] using 2-D FCMalone. In [14], prior learned fibroglandular tissue likelihood is
incorporated to FCM to segment fibroglandular tissue. A weak
point of these fully automatic approaches is that the employed
breast and fibroglandular tissue segmentation algorithms are 2D segmentation methods which are applied to MR volumes on
a slice-by-slice basis.
In this paper, we present a framework that takes into account
the three-dimensionality nature of breast MRI to automatically
segment breast and fibroglandular tissue. In combination, these
can be used for automated breast density estimation, which
requires computation of the relative amount of fibroglandular tissue in the breast. The framework consists of different
image processing steps. First, signal intensity inhomogeneities
are corrected. Subsequently, a 3-D probabilistic atlas-based approach [15], previously used for pectoral muscle segmentation,
is applied to segment the breast. The expectation–maximization
(EM) algorithm [16] is finally used to estimate the image intensity distributions of breast tissue and automatically discriminate
between fatty and fibroglandular tissue. The novel contribution
of the paper is to extend the work in [15] for breast segmentation
and breast density estimation in breast MRI. Breast segmentation step is evaluated with 27 MRI cases fully annotated by
an experienced observer. The fibroglandular tissue segmentation step, the final aim of this paper, is evaluated with 50 MRI
cases compared to the annotations provided by four different
observers.
II. METHODS
A general overview of the process to estimate the breast density segmentation is shown in Fig. 1. Three preprocessing algorithms are initially applied: first, image inhomogeneities are
corrected using the N3 bias field correction algorithm [17] to
correct signal intensity variations within the same structure of
one specific case. The N3 is a nonparametric method which
was designed to be applied on early stages of automated data
analysis and does not require a model of the tissue intensities.
Second, the sternum is detected, which is used as an important
landmark in different parts of our algorithm. Third, intensities
of the MR images are normalized to compensate for interpatient
signal intensity variability.

Fig. 1.
MRI.

General overview of the process for dense tissue segmentation in breast

Fig. 2. (a) MRI axial slice, with sternum indicated with a circle, and (b) the
output obtained applying the filter to detect the sternum point with a VOI (dotted
box), as described in (1).

The segmentation starts separating the body from the breast.
The body consists of lungs, heart, pectoral muscle, thoracic area,
and fat outside the base of the breast. The breast is connected to
the pectoral muscle and is composed by fatty and dense tissues
[18]. A probabilistic atlas, which contains spatial information
of pectoral muscle, lungs, heart, thorax, and breast tissue, is
used to exclude the body from the breast [15]. Finally, the breast
volume is defined and the dense tissue is delineated using the EM
algorithm. Each step is sequentially presented in the following
sections.

A. Sternum Landmark Detection
The sternum is a bone localized between pectoral muscles and
is always visible in centered axial slices. The use of a breast coil
ensures that the sternum is roughly in the center of the image.
We consider the sternum as an important landmark to guide the
separation between body and breast [see Fig. 2(a)] and we use
the y-coordinate of the outer edge of the sternum in two stages
of our method.
To detect the outer edge of the sternum, we observed that the
pectoral muscle border appears as the surface with the strongest
edges in the image with maximum positive gradient in y direction, using the coordinate system defined in Fig. 2. Taking advantage of this observation, we implemented a first-derivativebased filter to enhance this edge and detect the sternum landmark
point. Note that throughout this paper, a voxel position is noted
as a 3-D vector r with components r x , r y , and r z . Given an MR
image I(r), the first derivative volumes Ix (r) = δδx Gσ 1 (I(r)),
Iy (r) = δδy Gσ 2 (I(r)), Iz (r) = δδz Gσ 3 (I(r)) are computed in
each direction at different Gaussian scales: σ1 = σ3 = 5 mm

GUBERN-MÉRIDA et al.: BREAST SEGMENTATION AND DENSITY ESTIMATION IN BREAST MRI: A FULLY AUTOMATIC FRAMEWORK

and σ2 = 1 mm. The output of the filter is defined as
 
Iy (r) − (Iz (r) + Ix (r)) if Iy (r) ≥ 0,
F (r) =
0
otherwise.

351

(1)

F (r) can be interpreted as the likelihood of a specific voxel at
location r to belong to an edge with y-gradient. The expression
(Iz (r) + Ix (r)), subtracted from Iy (r), can be seen as a penalization term because high gradient values in z and x directions
are not expected in voxels that belong to the pectoral muscle
surface. Fig. 2(b) shows an example.
The output of F (r) is binarized by an adaptive threshold set to
max(F (r))/4. We identify the distinct structures of the binary
volume by determining the connected components [19]. The
largest structure is identified as the pectoral boundary and the
rest excluded. By doing so, smaller edges that do not belong to
the pectoral boundary, such as skin folds, are removed. Finally,
a box-shaped volume of interest (VOI) is placed in the center of
the volume [see dotted box of Fig. 2(b)]. The sternum landmark
is determined by computing the center of mass of the voxels
of the largest structure which are included in the VOI. In our
experiments, the size of the VOI was set to 34 mm × 156 mm
× 14 mm to ensure that the sternum landmark was detected at
any y location of the center of the volume.

Fig. 3. Axial breast MR slice: the sternum is localized (ellipse) to define the
VOI to estimate the mean value of fatty tissue. Dotted box shows the VOI. The
white highlighted tissue within the VOI corresponds to the fatty tissue used as
reference tissue in the image normalization process.

B. Image Normalization
Bias field correction minimizes the signal intensity variability of a given tissue within a single acquisition. However, voxel
values belonging to a specific structure vary from patient to
patient due to differences on the build of each patient and differences on the acquisition parameters. Ignoring the interpatient
variability can severely hamper the final segmentation of the
different tissues, especially in steps where image intensity is
used as a feature. Hence, signal intensity of all the scans needs
to be standardized for segmentation.
Among others, the sensitivity of the coil is one of the most
important factors that cause the difference between signal intensities of different scans. Thus, if we define St as the MR intensity
corrected for coil sensitivity, we can write I(r|xr = t) = γSt ,
where xr is the label at location r, t is the tissue type, and γ is
the factor that generates the difference.
The factor γ can be canceled out by using the mean intensity
value of a reference tissue of the same scan
ˆ | xr = t) = Iˆt = γSt = It
I(r
(2)
γSref
Iref
where Iˆt is the normalized image intensity value for a tissue t
and Iref is the image intensity value of the reference tissue of
the same scan. The fatty tissue was selected as the reference
as it is the most prominent tissue of the image and its intensity
distribution is easier to estimate than the distribution of other
structures.
The estimation of the mean fatty tissue value, Iref in (2), is
performed in a VOI containing all the voxels of the MR scan
which are located anterior to the sternum. Sternum detection is
described in Section II-A. The dotted box of Fig. 3 illustrates
the VOI, which contains voxels belonging to fatty and glandular

Fig. 4. Image normalization: intensity distribution of the whole image of five
different patients before (a) and after (b) normalization.

tissues, background and, in some cases, voxels which belong to
the pectoral muscles. The background is excluded using Otsu
thresholding [20], leaving fatty, dense, and pectoral muscle tissues. The fatty mean intensity value is computed by means
of the EM algorithm [16]. Pectoral muscle and fibroglandular
tissue have similar voxel values and can be considered as a single class. The image intensity distributions of the two classes
(fatty and other tissues) are estimated by fitting two Gaussian
distributions.
Fig. 4 shows the MR signal intensity distributions of the whole
image of five different cases before (a) and after (b) normalization. A better overlap can be observed after normalization.
C. Breast-Body Segmentation
In this stage, the breasts are identified as the region delimited by the breast-body surface and the air-breast boundary.
The breast-body surface is determined by segmenting body

352

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Fig. 6. Breast volume definition for dense tissue segmentation: axial planes
define the parts of the breast with highest curvature. The coronal and sagittal
planes are aligned to the sternum landmark.

Fig. 5. Overview of the probabilistic atlas-based breast-body segmentation
approach.

structures using an atlas-based voxel classification algorithm
[15]. The atlas-based approach uses a probabilistic atlas that
provides the probability for each voxel to belong to the body
(pectoral muscle, heart, lungs, and thorax) and the breast as a
prior information. A dedicated registration framework [15], that
focuses on the body area, is used to build and map the probabilities. This registration is composed of two stages: translation
transform, where the sternum is used as a landmark, and a
nonrigid registration based on a B-Splines transform [26] in a
multiresolution scheme.
The air-breast boundary is defined by a region growing algorithm applied slice by slice. A morphological dilation filter with
scale 5 × 5 mm is also performed on the background segmentation to ensure that the skin between the background and the
breast is removed. The probabilistic atlas-based approach is not
used to compute the air-breast boundary because this approach
was designed to capture anatomical variations on body area.
Fig. 5 shows the general scheme of the breast-body segmentation framework and the results produced with its application.
More details can be found in [15].
D. Breast Density Segmentation
In the previous breast-body segmentation step (see Section IIC), a general delineation of the breast is obtained. This initial
breast segmentation separates the breast from the body, but it
might still contain fatty tissue which is not part of the breast. In
the breast density segmentation step, the breast volume is first
defined for each breast independently to remove the nonbreast
fatty tissue that could negatively influence the estimation of
breast density.
Fig. 6 shows an illustration of the breast volume definition for
the right breast. First, the breasts are separated by a sagittal plane
(y – z) situated in the center of the volume where the sternum
was detected. Second, we define a coronal plane (x – y) at 2-cm
posterior from the sternum landmark. Then, we exclude all the
voxels which are posterior to the plane. Finally, for each breast
independently, the breast boundaries are identified by detecting
the superior and inferior points with maximum curvature of the

Fig. 7.

Skin fold examples.

central sagittal slice of the breast. Axial planes (x–z) of Fig. 6
define the breast boundaries of the right breast.
Once the breast volume for each breast is defined, the dense
tissue is segmented using the EM algorithm [16] independently
on each breast. The EM is an iterative technique that maximizes
the probability density function of a mixture model. In this implementation, the mixture model is composed by the image intensity distributions of fatty and fibroglandular tissues modeled
as Gaussian distributions, taking advantage of the good contrast
between breast tissues in MRI. The signal intensity value that
discriminates between fatty and fibroglandular tissue is set to
the value where the likelihood ratio between the two estimated
tissue models is one.
Large breasts often present folds, because the breast does
not entirely fit in the coil. As can be seen in Fig. 7, these skin
folds contain air and appear in the breast area as horizontal
structures in axial slices. Voxel values of skin folds have similar
image intensity values compared to dense tissue voxel values.
This similarity causes skin fold voxels to be segmented as a
dense tissue by the EM algorithm applied on breast volume. The
erroneous segmentation of these structures can considerably bias
the estimation of breast density, especially in fatty breasts. For
this reason, we included a final step in our algorithm to remove
such structures from the dense tissue segmentation previously
generated by EM.
The skin fold removal approach is applied to the whole volume that contains the dense tissue segmentation of both breasts.
It is based on the observation that skin folds appear in axial
slices as structures parallel to the chest wall connected to the
background. First, a morphological dilation operation with the
scale 4 × 4 × 4 mm is applied to a binary volume composed
by the union of dense tissue and background segmentations. By
doing so, background and skin fold voxels labeled as dense tissue are connected to each other and are detected as the largest
structure in a 3-D connected component analysis. Second, a first
ˆ
is computed at Gausderivative volume Iˆy (r) = δδy Gσ (I(r))
sian scale σ = 5 mm to enhance the structures that run parallel
to the x-axis. The detection algorithm segments as skin fold
the high y-gradient voxels with Iˆy (r) > max(Iˆy (r))/3 which

GUBERN-MÉRIDA et al.: BREAST SEGMENTATION AND DENSITY ESTIMATION IN BREAST MRI: A FULLY AUTOMATIC FRAMEWORK

353

belong to the glandular segmentation and to the background. If
skin folds are not present, only the background is found as the
largest structure and no dense tissue is removed.
III. EXPERIMENTS AND RESULTS
The two main steps of the presented segmentation method
were evaluated in detail using a large annotated dataset. Automatic separation of body and breast was evaluated on a subset
of 27 fully manually annotated MR volumes (see Section III-B).
Fibroglandular tissue segmentation was evaluated on a set of 50
cases with manual fibroglandular tissue segmentations of four
different experienced readers (see Section III-C). The complete
description of the used dataset is presented in the following
section.
A. Material
At the Radboud University Nijmegen Medical Centre, breast
MRI is used for the screening of women with high familial
or genetic risk. In this study, we used a random subset of 50
precontrast coronal T1-weighted MR breast volumes from 50
different patients with no sign of malignancy within 2 years after
the acquisition. The age of the screened women ranged from 23
to 76 years (45.84 ± 11.97 of average). The cases were collected
from 2003 to 2009. Breast MRI examinations were performed
on either a 1.5 or 3 Tesla Siemens scanner (Magnetom Vision,
Magnetom Avanto and Magnetom Trio), with a dedicated breast
coil (CP Breast Array, Siemens, Erlangen). Clinical imaging
parameters varied; matrix size: 256 × 128 or 256 × 96; slice
thickness: 1.3 mm; slice spacing: 0.625 – 1.25 mm; flip angle:
8◦ , 20◦ or 25◦ ; repetition time: 7.5 – 9.8 ms; echo time: 1.7 –
4.76 ms. Patients were scanned in prone position. Note that,
although the MR images were acquired in coronal orientation,
all the annotations were performed using axial orientation and
the illustrated images in this paper are axial slices.
In order to evaluate the automatic breast segmentation algorithm and construct the atlas, 27 cases were manually segmented
in seven structures by a single experienced observer. The classes
are background, fatty tissue, glandular tissue, pectoral muscles,
lung area, and the heart. The seventh class is the “other” class
and refers to the previous nonlabeled voxels of the thorax. Annotations were done every 5 – 10 axial slices on average, and
linear interpolation was applied to obtain the complete labeling.
When needed, and especially for the heart, lungs, and pectoral
muscles, accurate manual delineation was performed within a
smaller slice interval. For the manual segmentation of background and the breast, thresholding was applied on regions of
interest provided by the reader. The manual segmentation of the
breast dense tissue is explained further in this section. Fig. 8
shows an example of an MRI slice on an axial view and the
manual delineation of the mentioned classes. One should note
that obtaining manual annotations of the six different classes
for the breast segmentation is a tedious and time consuming
task. Each volume takes approximately 45 min in a dedicated
breast MRI annotation environment [21]. This is the reason why
a subset of 27 women out of the 50 cases is used for evaluating
breast segmentation.

Fig. 8. Breast MRI scan on an axial slice with manual annotations of the
different structures.

Independently, fibroglandular manual segmentations from
different viewers were also collected for the complete dataset.
First, an experienced observer annotated a VOI in each of the
100 breasts in the 50 cases, by coarsely encapsulating all the
dense tissue while avoiding inclusion of skin folds and fatty tissue areas where signal intensity is dimmed due to the bias field.
This VOI is called dense tissue mask in the paper. To delineate the dense tissue masks, the experienced observer analyzed
and annotated axial slices of each MR volume using a freehand annotation tool. Second, four different readers segmented
fibroglandular tissue. Each reader selected a single threshold on
the dense tissue mask of each breast to discriminate between
fibroglandular and fatty tissue. The thresholds were applied on
bias field corrected volumes. As a result, four manual fibroglandular segmentations for right and left breasts were obtained for
each case.
B. Breast-Body Segmentation
For each of the 27 fully manually segmented patients, the
probabilistic atlas was built with the remaining subjects (N =
26) in a leave-one-out fashion. These 26 patients and their segmentations were mapped into the same reference space and the
probabilities were computed [15]. The same reference space
was used for all the experiments. It was represented by a patient
with normal appearance to minimize the differences in the registration process. This patient was not included in the evaluation
set.
These 27 cases were automatically segmented and compared
to their complete manual segmentations. For the evaluation of
breast and body delineations, we determined breast segmentation performance. Dice similarity coefficient (DSC) [22], total
overlap, and false negative fraction (FNF), and false positive
fraction (FPF) errors are employed as done in [12], where breast
segmentation is also evaluated. DSC is widely used in the literature to evaluate segmentation agreement and is also referred to as
mean overlap. The total overlap is computed as the sensitivity.
The FNF error gives the fraction of the breast reference segmentation that is not segmented as the breast by the automatic
segmentation. Similarly, the FPF error gives the fraction of the
automatic segmentation of the breast that is not segmented as the
breast by the reference segmentation. More details about these
measures can be found in [23]. Furthermore, since similarity between voxel values of pectoral muscle and fibroglandular tissue
is the reason why breast-body separation is not trivial, we provide a complementary evaluation: the fraction of fibroglandular
tissue voxels of the reference segmentation labeled as body in the
automatic segmentation of the breast. We refer to this evaluation

354

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Fig. 11. Breast segmentation of the case 7 with (a) and without (b) the use of
sternum landmark in registration.

(a)

(b)

Fig. 9. Breast segmentation performance. (a) Distribution of overlap DSC and
total overlap metrics and (b) distribution of error overlap false negative fraction
(FNF), false positive fraction (FPF), and dense tissue error (DTE).

uate the impact on the final segmentation, the automatic breastbody segmentation approach was also tested without incorporating the sternum landmark detection. When the sternum point
was incorporated, an improvement was observed in the performance of pectoral muscle segmentation. A DSC mean value of
0.75 ± 0.09 (mean ± sd) was obtained for pectoral muscle
segmentation. When the sternum point was not incorporated,
the DSC value decreased to 0.71 ± 0.12 (mean ± sd). In fatty
cases, where the registration is more complicated because of
the large amount of fatty tissue between the body and the background (i.e·.case (b) of Fig. 10), the localization of the sternum
appears to be essential as can be seen in the example in Fig. 11.
C. Breast Density Segmentation

Fig. 10. Intermediate slices from three different cases and the breast contour
obtained from the segmentations.

measure as dense tissue error (DTE). To compute this metric,
the fibroglandular tissue reference segmentation was built by
combining the four manual dense tissue segmentations of each
observer using STAPLE [24]. The STAPLE algorithm fuses a
collection of manual segmentations maximizing the accuracy
assessment of each expert. The DTE metric was not previously
used in the literature, but we consider it relevant to quantify the
segmentation error in combination with other overlap measures.
Fig. 9 shows a box plot with the distribution of overlap and
error metrics used for breast segmentation evaluation. The average DSC value was 0.94 ± 0.03 (mean ± sd), the average total
overlap was 0.96 ± 0.02 (mean ± sd), the average FNF was
0.04 ± 0.02 (mean ± sd), the average FPF was 0.07 ± 0.06
(mean ± sd), and the average DTE was 0.02 ± 0.03 (mean ±
sd). The DTE was useful to observe the influence of pectoral
muscle in the breast-body surface segmentation. The majority
of the fibroglandular voxels automatically misclassified as body
(93.75%) belonged to pectoral muscle, which is included in
the body. Accurate delineations are achieved as is illustrated in
Fig. 10.
The sternum localization and its influence on the breast segmentation stage was also evaluated. Each case was annotated
with a manually centered sternum point. Manual landmarks
of the outer edge of the sternum were compared to the sternum localizations determined automatically. An average error
of 1.51 ± 1.34 mm (1.16 ± 1.03 voxels) was obtained, which
shows the validity of our sternum detection approach. To eval-

In order to evaluate the breast density segmentation, several
experiments were performed. First, interobserver variability was
studied analyzing the four manual segmentations of the 50 cases
(100 breasts). Second, to show the validity of the EM algorithm
for fibroglandular tissue segmentation, we also segmented dense
tissue of the 50 cases using the EM algorithm on the manually
segmented dense tissue masks employed in manual thresholding. Finally, breast density segmentations from the complete
dataset were obtained using the presented fully automatic approach, which includes all steps: automatic breast segmentation
and density segmentation using EM.
STAPLE [24] was used to fuse manual segmentations and
build multiple fibroglandular tissue reference segmentations.
To evaluate interobserver variability, a leave-one-out strategy
was followed and each manual segmentation was compared to a
reference segmentation created by fusing manual delineations of
the three remaining readers. In total, four fibroglandular tissue
reference segmentations were created for each case. To evaluate
our approach, automatic segmentations were compared to each
of the four reference segmentations and the average was taken.
DSC, total overlap, FNF, and FPF were chosen to quantify the
performance of breast density segmentation. Two-sided paired
Wilcoxon test at 95% confidence level was used to determine
statistical significance.
The results presented in Table I and in Fig. 12 indicate that our
EM algorithm is comparable to manual thresholding when applied on a manually defined dense tissue area. In terms of DSC,
which is the metric used by Wu et al. [13], [14] to evaluate the
performance of their fully automatic fibroglandular tissue segmentation algorithms, it outperforms segmentations of viewer
3 (p-values < 0.025) and differences are not significant when
compared to viewer 1, 2, and 4 (p-values of 0.20 and 0.54 and
0.54, respectively). When the fully automatic method is applied,
the performance decreases to 0.80. However, automatic segmentations have similar performance compared to that obtained by

GUBERN-MÉRIDA et al.: BREAST SEGMENTATION AND DENSITY ESTIMATION IN BREAST MRI: A FULLY AUTOMATIC FRAMEWORK

355

TABLE I
AVERAGE DSC, AVERAGE TOTAL OVERLAP, AVERAGE FNF, AND AVERAGE
FPF (MEAN ± SD) OBTAINED FROM MANUAL SEGMENTATIONS OF THE FOUR
DIFFERENT VIEWERS, FROM EXPECTATION–MAXIMIZATION ALGORITHM
APPLIED ON MANUALLY DEFINED DENSE TISSUE AREA (EM MASK) AND,
FROM EM ALGORITHM APPLIED ON AUTOMATIC DEFINED BREAST
VOLUME (AUTOMATIC)

(a)

(b)
Fig. 12. Fibroglandular tissue segmentation: distribution of DSC and total
overlap measures computed from manual segmentations of the four different
viewers (V#), from expectation–maximization algorithm applied on manually
defined dense tissue area (EM mask) and, from EM algorithm applied on automatic defined breast volume (automatic).

(c)
Fig. 14. Correlation between right and left breast density estimations using
(a) fully automatic, (b) reference segmentations, and (c) case-based correlation
between breast density estimations from automatic and reference segmentations.
Numbers refer to the identifier of each case.
Fig. 13. Fibroglandular tissue segmentation results: comparison of reference
and automated segmentation of two axial slices from the best and worst automatic segmented cases.

viewer 3 (p-value of 0.65). Fig. 13 shows reference and automated fibroglandular segmentations on two axial slices from
the best and worst automatic segmented cases. In the worst-case
example, the pectoral muscle is segmented as fibroglandular tissue due to registration errors and the skin fold was not totally
removed. Although the skin fold is still present in this example,
overall, the skin fold removal step appeared to be important:
The results obtained by the proposed fully automatic approach,
which includes skin fold removal, significantly outperforms the
fibroglandular tissue segmentations obtained without detecting

such structures (average DSC values of 0.80 ± 0.12 (mean ±
sd) and 0.75 ± 0.14 (mean ± sd) respectively, with p-value
<0.025).
Finally, the volume of dense tissue was computed using the
fibroglandular tissue segmentations of the automated approach
and the reference segmentations. For each case and segmentation, dense volume estimation of the right and left breasts was
compared. Fig. 14 illustrates the correlation (0.93 and 0.91) between right and left breast densities for (a) fully automatic and
(b) reference segmentations. Numbers indicate the case identifier. Assuming that the right and left breasts tend to have the same
density, the similarity of volumetric estimates obtained for left
and right breasts demonstrates the consistency of the method we

356

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

developed. Similarly, correlation between breast density measures computed from automatic and reference segmentations
was substantial, reaching breast-based and case-based correlation ratios of 0.89 and 0.92, respectively [see Fig.14(c)].
IV. DISCUSSION AND CONCLUSION
The segmentation framework we developed to automatically
compute breast density by segmenting breast and fibroglandular
tissue in breast MRI shows good performance for both automatic
segmentation tasks. The presented method is a combination
of image processing techniques. Intra- and interpatient signal
intensity variability is initially corrected. Second, the breast
is segmented by automatically detecting body-breast and airbreast surfaces using an atlas-based approach. Subsequently,
the fibroglandular tissue is segmented by EM algorithm and
skin-fold removal.
Different stages of our method have been validated. Automatic segmentations of breast and fibroglandular tissues were
compared to manual segmentations. Overall, qualitative and
quantitative results show that the obtained segmentations are
of high quality in most cases. With respect to the fibroglandular
tissue segmentation, good correlation between breast density
estimates obtained in the right and left breasts indicates consistency and robustness of our approach.
We observed that the inclusion of the sternum landmark in the
registration framework improves the segmentation of the breastbody surface. This is important because erroneous inclusion of
pectoral muscle tissue in the breast is a major source of errors
in methods aimed at automated segmentation of fibroglandular
tissue. The sternum landmark was detected automatically and
this detection was reliable since results we obtained were similar
to manual annotations.
Compared to previous work found in the literature, for breast
segmentation, our performance metric values are higher than
the reported by Gallego-Ortiz et al. [12]. With our approach we
achieved an average DSC value of 0.94 ± 0.04 (mean ± sd)
and an average total overlap of 0.96 ± 0.02 (mean ± sd). The
breast segmentation framework of Gallego-Ortiz et al. [12] obtained an average DSC value of 0.88 ± 0.05 (mean ± sd) and
an average total overlap of 0.89 ± 0.05 (mean ± sd). However,
Gallego-Ortiz et al. validated their approach on 409 MRI cases,
which is larger than the 50 used in our work, and reported computational time of less than a minute per volume. Our approach
takes approximately 8 min computed on a 4 Intel(R) Core(TM)
i5-2400 CPU 3.10GHz processors system with 12 GB RAM.
Most of this time is spent by our algorithm to register and map
the probabilistic atlas to the target image (≈ 6 min.). However,
one should note that the current implementation of this step
is single threaded. Therefore, the computational time can be
substantially decreased by multithreading the task.
For the automatic fibroglandular tissue segmentation, we obtained an average DSC value of 0.80 ± 0.13 (mean ± sd).
The DSC value is higher than the values of 0.73 and 0.67 reported by Wu et al. in [13] and [14], respectively. In addition, a
value of 0.93 was reported in [14] for case-based fibroglandular
tissue volume correlation between automatic and manual seg-

mentation. In our study, we obtained a case-based fibroglandular
tissue volume correlation of 0.92.
It should be noted that not too much importance should be
given to these comparisons, since the segmentation results were
determined on different datasets. The composition of these sets
may have a strong influence on the overall results, especially
when sets are small. Datasets represent different populations
and the way manual annotations are made may also cause differences. For instance, we observed that the area covered by the
manual breast segmentations used in our experiments is larger
than the area covered by the manual segmentation used in [12].
These differences are caused by the difficulty of determining
the anatomical extent of the breast, in particular the lateral zone
where the breast is connected to the chest wall.
Using the presented method, we found that most of the remaining errors in automated fibroglandular tissue segmentation
are due to an inaccurate definition of the breast-body surface.
In the experiments, in three of the cases the breast segmentation algorithm classified more than 6% of dense tissue voxels as
body (DTE > 0.06), which indicates that a substantial amount
of body voxels were erroneously labeled as dense tissue. This
error was observed in cases where the registration was not able
to compensate for differences between the target and the atlas.
Hence, probability distributions of body and breast were not
correctly mapped leading to errors in the final segmentation. To
improve results in such cases, the use of a multiprobabilistic
atlas approach can be considered, in which different probabilistic atlases would be created for different populations of breast
MRI cases, grouped based on shape and/or patient age. For a
given case, the most similar atlas to the target image would be
chosen to proceed with the segmentation. A disadvantage of this
approach, however, is that it may lead to a strong increase in
computational load.
The use of a different threshold to segment fibroglandular
tissue for each breast appeared to be important. During the development of our algorithm, we found that the use of a single
threshold for both breasts produced a strong asymmetry between left and right breast density estimations. This asymmetry
was caused by differences in signal intensities between left and
right breasts. We considerably reduced it and improved overall
performance of the presented method by applying the N3 bias
field correction method and by segmenting each breast independently. We also observed that the bias field is not completely
removed after correction in cases with large breasts. The bias
field causes lower signal intensity values in fatty tissue areas
of the base breast and this fatty tissue is incorrectly segmented
as fibroglandular tissue. To overcome this limitation the effect
of applying other bias field correction algorithms, such as [25],
will be studied in the future.
The method in our study has been developed and evaluated
using data collected in only one clinical center. Therefore, robustness against differences in population and image acquisition systems could not be investigated. However, we are confident that, with minor adjustments, the proposed segmentation
framework for breast MRI is suitable for application to datasets
obtained in different institutions and under different conditions, since our dataset contained images obtained on different

GUBERN-MÉRIDA et al.: BREAST SEGMENTATION AND DENSITY ESTIMATION IN BREAST MRI: A FULLY AUTOMATIC FRAMEWORK

scanners with different clinical imaging protocols and our
method only uses a few parameters. These parameters are related
to sternum detection and skin-fold removal. Experimentally, we
found that the performance of our method did not critically
depend on the values of these parameters.
The probabilistic atlas we used captures anatomical information. Since it is learned from a selected population, care must
be taken that the atlas is representative for the population the
method is applied to. The atlas is not dependent on the image
acquisition protocols, but obviously it needs to be rotated and
scaled to the correct coordinate frame. It is remarked that the
use of different breast coils may lead to some variations that are
not represented in an atlas constructed from a single acquisition
system. However, since this predominantly affects the atlas values of breast tissue, this does not affect our method, in which
the atlas is only used for the breast-body surface segmentation.
To summarize, in this paper we have presented a new fully
automatic approach to measure the volume of dense tissue in
breast MRI. The previously published segmentation methods
either required manual intervention, were evaluated on small
datasets, or were focused only on breast-body separation. Evaluation on a substantial dataset of 50 cases with multiple manual
annotations has shown that our approach yields fairly accurate
automatic segmentations. Therefore, we believe that our segmentation method can serve as a reliable tool in breast density
studies, such as investigating the correlation between breast
density measurements obtained from MRI and mammograms.
Although there is no consensus on the role of breast density
as an individual risk factor for breast cancer, population-based
studies have shown that there is a strong relation between breast
density and breast cancer occurrence. The presented segmentation framework, as well as its different stages independently, can
be also applied in other clinical applications for breast cancer.
For instance, fibroglandular tissue morphology and distribution
patterns can be analyzed to investigate their relationship with
risk of developing cancer, and automated segmentations may be
used in computer aided diagnosis programs.

REFERENCES
[1] R. M. Mann, C. K. Kuhl, K. Kinkel, and C. Boetes, “Breast MRI: Guidelines from the European Society of breast imaging,” Eur. Radiol., vol. 18,
pp. 1307–1318, 2008.
[2] S. Behrens, H. Laue, M. Althaus, T. Böhler, B. Kuemmerlen, H. K. Hahn,
and H-O. Peitgen, “Computer assistance for MR based diagnosis of
breast cancer: Present and future challenges,” Comput. Med. Imag. Graph,
vol. 31, pp. 236–247, 2007.
[3] N. F. Boyd, H. Guo, L. J. Martin, L. Sun, J. Stone, E. Fishell, R. A. Jong,
G. Hislop, A. Chiarelli, S. Minkin, and M. J. Yaffe, “Mammographic
density and the risk and detection of breast cancer,” N. Engl. J. Med.,
vol. 356, pp. 227–236, 2007.
[4] C. M. Vachon, C. H. van Gils, T. A. Sellers, K. Ghosh, S. Pruthi,
K. R. Brandt, and V. S. Pankratz, “Mammographic density, breast cancer risk and risk prediction,” Breast Cancer Res., vol. 9, p. 217, 2007.
[5] M. Khazen, R. M. L. Warren, C. R. M. Boggis, E. C. Bryant, S. Reed,
I. Warsi, L. J. Pointon, G. E. Kwan-Lim, D. Thompson, R. Eeles, D.
Easton, D. G. Evans, M. O. Leach and Collaborators in the United
Kingdom Medical Research Council Magnetic Resonance Imaging in
Breast Screening (M. A. R. I. B. S) Study, “ A pilot study of compositional analysis of the breast and estimation of breast mammographic
density using three-dimensional T1-weighted Magnetic Resonance Imaging,” Cancer Epidemiol. Biomarkers Prev., vol. 17, pp. 2268–2274,
2008.

357

[6] S. van Engeland, S. Timp, and N. Karssemeijer, “Finding corresponding
regions of interest in mediolateral oblique and craniocaudal mammographic views,” Med. Phys., vol. 33, pp. 3203–3212, 2006.
[7] N. A. Lee, H. Rusinek, J. Weinreb, R. Chandra, H. Toth, C. Singer, and
G. Newstead, “Fatty and fibroglandular tissue volumes in the breasts
of women 20-83 years old: Comparison of X-ray mammography and
computer-assisted MR imaging,” AJR Amer. J. Roentgenol., vol. 168,
pp. 501–506, 1997.
[8] C. Klifa, J. Carballido-Gamio, L. Wilmes, A. Laprie, J. Shepherd, J. Gibbs,
B. Fan, S. Noworolski, and N. Hylton, “Magnetic resonance imaging for
secondary assessment of breast density in a high-risk cohort,” Magn.
Reson. Imag., vol. 28, pp. 8–15, 2010.
[9] K. Nie, J-H. Chen, S. Chan, M-K. I. Chau, H. J. Yu, S. Bahri, T. Tseng,
O. Nalcioglu, and M-Y. Su, “Development of a quantitative method for
analysis of breast density based on three-dimensional breast MRI,” Med.
Phys., vol. 35, pp. 5253–5262, 2008.
[10] J. Wei, H. P. Chan, M. A. Helvie, M. A. Roubidoux, B. Sahiner,
L. M. Hadjiiski, C. Zhou, S. Paquerault, T. Chenevert, and M. M. Goodsitt,
“Correlation between mammographic density and volumetric fibroglandular tissue estimated on breast MR images,” Med. Phys., vol. 31, pp. 933–
942, 2004.
[11] L. Wang, B. Platel, T. Ivanovskaya, M. Harz, and H. Hahn, “Fully automatic breast segmentation in 3D breast MRI,” in Proc. IEEE Ninth Int.
Symp. Biomed. Imag., 2012, pp. 1024–1027.
[12] C. Gallego-Ortiz and A. L. Martel, “Automatic atlas-based segmentation
of the breast in MRI for 3D breast volume computation,” Med. Phys.,
vol. 39, pp. 5835–5848, 2012.
[13] S. Wu, S. Weinstein, B. M. Keller, E. F. Conant, and D. Kontos, “Fullyautomated fibroglandular tissue segmentation in breast MRI,” in Proc.
11th Int. Conf. Breast Imaging, 2012, pp. 244–251.
[14] S. Wu, S. Weinstein, E. F. Conant, and D. Kontos, “Automated fibroglandular tissue segmentation and volumetric density estimation in breast
MRI using an atlas-aided fuzzy C-means method,” Med. Phys., vol. 40,
p. 122302, 2013.
[15] A. Gubern-Mérida, M. Kallenberg, R. Martı́, and N. Karssemeijer, “Segmentation of the pectoral muscle in breast MRI using atlas-based approaches,” Med. Image Comput. Assist. Interv., vol. 15, pp. 371–378,
2012.
[16] A. Dempster, N. Laird, and D. Rubin, “Maximum likelihood from incomplete data via the EM algorithm,” J. R. Stat. Soc., vol. 39, pp. 1–38,
1977.
[17] J. G. Sled, A. P. Zijdenbos, and A. C. Evans, “A nonparametric method
for automatic correction of intensity nonuniformity in MRI data,” IEEE
Trans. Med. Imag., vol. 17, no. 1, pp. 87–97, Feb. 1998.
[18] R. Putz and R. Pabst, Sobotta Atlas of Human Anatomy, Volume 2:
Trunk, Viscera, Lower Limb, 13th ed. Philadelphia, PA, USA: Lippincott, Williams and Wilkins, 2001.
[19] R. M. Haralick and L. G. Shapiro, Computer and Robot Vision. vol. I:
Addison-Wesley, 1992, pp. 28–48.
[20] N. Otsu, “A threshold selection method from gray level histograms,”
IEEE Trans. Syst. Man Cybern., vol. SMC-9, no. 1, pp. 62–66, Jan.
1979.
[21] F. Ritter, T. Boskamp, A. Homeyer, H. Laue, M. Schwier, F. Link, and
H-O Peitgen, “Medical image analysis: A visual approach,” IEEE Pulse,
vol. 18, no. 2, pp. 60–70, Nov./Dec. 2011.
[22] L. R. Dice, “Measures of the amount of ecologic association between
species,” Ecology, vol. 26, pp. 297–302, 1945.
[23] A. Klein, J. Andersson, B. A. Ardekani, J. Ashburner, B. Avants,
M-C. Chiang, G. E. Christensen, D. L. Collins, J. Gee, P. Hellier,
J. H. Song, M. Jenkinson, C. Lepage, D. Rueckert, P. Thompson,
T. Vercauteren, R. P. Woods, J. J. Mann, and R. V. Parsey, “Evaluation
of 14 nonlinear deformation algorithms applied to human brain MRI registration,” Neuroimage, vol. 46, no. 3, pp. 786–802, Jul. 2009.
[24] S. K. Warfield, K. H. Zou, and W. M. Wells, “Simultaneous truth and
performance level estimation (STAPLE): An algorithm for the validation
of image segmentation,” IEEE Trans. Med. Imag., vol. 23, no. 7, pp. 903–
921, Jul. 2004.
[25] M. Lin, S. Chan, J. H. Chen, D. Chang, K. Nie, S. T. Chen, C. J. Lin,
T. C. Shih, O. Nalcioglu, and M. Y. Su, “A new bias field correction
method combining N3 and FCM for improved segmentation of breast
density on MRI,” Med. Phys., vol. 38, pp. 5–14, 2011.
[26] D. Rueckert, L. I. Sonoda, C. Hayes, D. L. G. Hill, M. O. Leach, and
D. J. Hawkes, “Nonrigid registration using free-form deformations: Application to breast MR images,” IEEE Trans. Med. Imag., vol. 18, no. 8,
pp. 712–721, Aug. 1999.
Authors’ photographs and biographies not available at the time of publication.

