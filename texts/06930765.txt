688

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Realistic Microwave Breast Models Through
T1-Weighted 3-D MRI Data
Ahmet Hakan Tunçay∗ and Ibrahim Akduman, Member, IEEE

Abstract—In this paper we present an effective method for developing realistic numerical three-dimensional (3-D) microwave
breast models of different shape, size, and tissue density. These
models are especially convenient for microwave breast cancer
imaging applications and numerical analysis of human breast–
microwave interactions. As in the recent studies on this area,
anatomical information of the breast tissue is collected from T1weighted 3-D MRI data of different patients’ in prone position. The
method presented in this paper offers significant improvements including efficient noise reduction and tissue segmentation, nonlinear
mapping of electromagnetic properties, realistically asymmetric
phantom shape, and a realistic classification of breast phantoms.
Our method contains a five-step approach where each MRI voxel
is classified and mapped to the appropriate dielectric properties.
In the first step, the MRI data are denoised by estimating and removing the bias field from each slice, after which the voxels are
segmented into two main tissues as fibro-glandular and adipose.
Using the distribution of the voxel intensities in MRI histogram,
two nonlinear mapping functions are generated for dielectric permittivity and conductivity profiles, which allow each MRI voxel
to map to its proper dielectric properties. Obtained dielectric profiles are then converted into 3-D numerical breast phantoms using
several image processing techniques, including morphologic operations, filtering. Resultant phantoms are classified according to
their adipose content, which is a critical parameter that affects
penetration depth during microwave breast imaging.
Index Terms—Breast cancer detection, breast cancer treatment,
electromagnetic mapping of tissues, microwave breast imaging,
microwave breast models, MRI denoising, tissue segmentation.

I. INTRODUCTION
UMERICAL breast phantoms are important experimental
tools for microwave breast cancer imaging, electromagnetic therapy and all other fields that deal with interactions
between human breast tissue and the electromagnetic waves.
Over the last decade, the number of electromagnetic therapy and
diagnosis studies for the human female breast cancer has drastically increased. Several imaging methods such as thermoacoustic tomography, microwave tomography, ultrawide-band radar,

N

Manuscript received February 18, 2014; revised September 9, 2014; accepted
October 6, 2014. Date of publication October 20, 2014; date of current version
January 16, 2015. This work was supported by TUBITAK (The Scientific and
Technological Research Council of Turkey) under Project Number 105E077.
Asterisk indicates corresponding author.
∗ A. H. Tunçay is with the Alcatel-Lucent Teletas Inc., Istanbul 34776,
Turkey, and also with the Electrical and Electronics Engineering Faculty, Istanbul Technical University, Istanbul 34469, Turkey (e-mail: ahmet_
hakan.tuncay@alcatel-lucent.com).
I. Akduman is with the Electrical and Electronics Engineering Faculty, Istanbul Technical University, Istanbul 34469, Turkey (e-mail: akduman@itu.edu.tr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2364015

narrow and wide-band microwave techniques, and other timedomain techniques [1]–[5], as well as therapeutic approaches
[6]–[7], [8] have been reported recently. In parallel, numerical
breast phantoms, which describe electromagnetic properties of
human breast, have also improved toward providing realistic
models. Earlier studies have used over-simplistic models with
limited number of internal breast features [9], [10]. At the beginning of 2000s numerical breast phantoms are derived using the
spatial information of the breast tissues presented by magnetic
resonance imaging (MRI) [11].
Recent studies on diagnostic and therapeutic microwave techniques offered three different mapping methods, namely: uniform, bimodal and piecewise-linear mapping [12] between MRI
images and electromagnetic properties. However, in these studies numerical phantoms were limited to anatomically realistic
(two-dimensional) 2-D phantoms or relatively simple 3-D phantoms.
Recent studies [14], [15] focused on building 3-D anatomically realistic numerical microwave breast models (ARNMBPs) based on denoising of MRI data, segmentation of
tissues, and mapping of electromagnetic properties. These
particular studies used homomorphic filters [15] to remove the
slowly changing gradient on MRI data, two component Gaussian
mixture model (GMM) [16] for the segmentation of tissues and
a linear mapping method to assign the electromagnetic properties to tissues. Although widely used in literature [1]–[4], there
are major disadvantages of this method due to the homomorphic filters that decrease contrast among tissues and GMM that
strictly fails in fatty breasts and requires manual segmentation
requirement. In addition current ARN-MBPs do not reflect the
asymmetric shape of the real female breast and instead consist
of ellipsoid slices in the coronal axis.
In this context, we propose alternative steps for the development of patient-specific 3-D ARN-MBPs in order to overcome
its current restrictions in denoising, segmentation and in being
asymmetric as in truly realistic models. Our method is also wellsuited to microwave imaging sessions, as it generates electromagnetic profiles that can be used as background data in breast
tumor/lesion detection, to improve the imaging quality [1]. The
method starts with an efficient noise reduction technique, which
depends on estimating and removing the slowly changing gradient on MRI images that is called the bias field. We also offer
a histogram based segmentation technique for breast MRI data,
which can be effectively used on any breast category defined by
the American College of Radiology (ACR) [17]. Moreover, for
the first time, we integrate a nonlinear mapping technique for
the development of 3-D ARN-MBPs. The spatial information
of the breast tissue distribution is obtained from T1-weighted

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

TUNÇAY AND AKDUMAN: REALISTIC MICROWAVE BREAST MODELS THROUGH T1-WEIGHTED 3-D MRI DATA

689

3-D MRI data which are provided by Maltepe University Medical Faculty and Euromed Medical Center. 3-D ARN-MBPs with
realistic shapes that approximate to the natural structure of the
breast are developed to represent heterogeneously distributed
relative permittivity and conductivity properties that vary with
the spatial location.
The rest of the paper is divided into three main sections.
In Section II, the method is proposed in detail and is divided
into five major steps. In Section III, developed ARN-MBPs
are classified according to their adipose content. Finally, the
concluding remarks are given in Section IV.
II. METHOD OF DEVELOPMENT
In this paper, T1-weighted 3-D MRI data of the breast are
used as a base for our method, where voxel intensity variation
in the MRI data is mapped to the proper electromagnetic parameters of the related breast tissues, i.e., dielectric permittivity
and conductivity. To classify the breast tissue, we present a segmentation method that uses the distinct Gaussian signatures of
the glandular and adipose tissues in the MRI histogram. Then, a
nonlinear mapping operation based on cubic Hermitte interpolation [187], [19] is applied for the mapping of segmented tissues
to the electromagnetic properties. Finally, the electromagnetic
profile of the breast tissue is presented as a realistic 3-D form.
The proposed method is composed of five steps: preprocessing of MRI data, bias field correction, tissue segmentation, electromagnetic properties mapping, and building the
3-D structure.

Fig. 1. Elimination of the noise at the breast exterior on MRI data. (a) Slice
of a raw MRI. (b) Binary version of the same slice generated by Otsu’s method.
(c) Eroded binary mask. (d) Resultant slice after masking.

A. Preprocessing of MRI Data
The MRI data consist of 40–45 axial slices per patient in prone
position, covering the whole chest. Each axial slice consists of
1024 × 1024 voxels, with 8-bit grayscale format. Typical fieldof-view (FOV) of the provided data is given as 32 cm × 32
cm and the spacing between consecutive slices is 3 mm, respectively. In this case, each voxel in the data corresponds to
approximately 0.31 mm × 0.31 mm × 3 mm volume. Preprocessing starts with choosing the tissue of interest by isolating
the desired region with a window, having a size of 300 × 300
voxels approximately, as illustrated in Fig. 1(a).
The main purpose of preprocessing of MRI data is to prepare
the data for segmentation. The proposed segmentation method
here, as will be explained in Section II-C, is based on the breast
MRI histogram that is composed of a mixture of two Gaussians
centered at different intensity levels. Any noise, i.e., artifacts on
the background or bias field, can lead to inaccurate segmentation and/or inappropriate mapping of electromagnetic properties
by disrupting the distribution of voxel intensities (see Fig. 2).
In fact, the artifacts are considered as a low intensity noise at
the breast exterior that originate from either the nonuniformities
due to the bandwidth-limiting filtering and/or the ghost images
which are mainly seen in the phase direction [20]. Ghosts must
be removed from the data for a successful segmentation and
mapping operation. To this end, a threshold operation based
on Otsu’s method [21] is applied in order to generate a binary
image as shown in Fig. 1(b). Then, a binary erosion process

Fig. 2. Disruption of MRI voxel intensity distribution due to the background
artifacts and the bias field. Black curve represents the histogram of a raw MRI
data while the red curve shows the histogram of the same data after background
artifacts are removed.

with a structural element with a radius of 2 voxels is applied
to detach the connected components in the binary image [15],
[22]. The erosion process isolates the biggest connected component, which is later considered as the rough mask of the breast.
The erosion operation is then reversed by applying a dilation
operation with the same structural element size [see Fig. 1(c)],
to thicken the tissue to its original size. Finally, by multiplying
noisy MRI data with the smoothed binary mask, low intensity
artifacts at the background are removed as illustrated in Fig. 1(d).
Removing the background artifacts provides noticeable enhancement in the MRI histogram as illustrated in Fig. 2, where
black and red lines represent the probability density function
(pdf) of the voxel intensity variation before and after the artifacts are removed. It is shown that the sharp peak seen at
low intensities which is originated from the external artifacts is

690

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

TABLE I
CORRESPONDING WINDOW SIZES FOR SAMPLING
R1 , R2 , R3
nr
nc
or
oc

Fig. 3. Illustration of proposed windowing method and four regions defined in
the breast. (a) Representative windows showing the overlap between consecutive
moving window locations. (b) Four different regions defined by the distribution
of fibroglandular tissue: R1 : region including the nipple, R2 : edge of breast, R3 :
chest wall, and R4 : interior region.

clearly eliminated after denoising operation. It should be noted
that the above described denoising procedure cannot eliminate
the bias field nonuniformities that corrupt the Gaussian curves
in the histogram as shown in Fig. 2.
B. Bias Field Correction
Bias field is a smoothly changing, low-frequency signal that
corrupts MRI images by altering voxel intensity values. The bias
of an image is caused by poor radio frequency coil uniformity
and patient anatomy that is inside or outside the field-of-view.
Therefore, bias field is unique for each patient and even for each
MRI imaging session. The magnitude of variation in intensity
values due to the bias field typically varies in the range of
10–20%, which breaks the mapping between a specific tissue
and a unique voxel intensity [23]. This implies that two different
tissues can have the same voxel intensity value, thus causing
ambiguity.
The main idea of removing the bias field relies on its estimation in each slice and its removal from the data by a simple
division. Estimation of bias field can be achieved in two steps.
In the first step, a number of sample points (100–400 points
according to the breast size) belonging to the adipose tissue in
the related MRI slice are gathered. Then assuming that in a T1weighted MRI dataset the voxel intensities belonging to adipose
tissue should have the maximum values, any reduction in the
intensity of those sample points can reveal the bias field. Since
bias field is a smoothly changing signal, it can then be estimated
by fitting a thin plate spline surface to those points [24].
We first define a region of interest (ROI) as the smallest
rectangle, having size Nc × Nr , which covers the breast tissue
for a given MRI slice, as illustrated in Fig. 3(a). Voxels belonging
to adipose tissue are taken as the local maxima within a moving
window, having size nc × nr , which scans the breast tissue
inside the ROI with a certain step size. The overlap of the moving
window among two consecutive steps in x and y directions are
given as oc and or , respectively [see Fig. 3(a)].
For an accurate estimation of bias field, it is necessary to
identify the adipose tissue samples correctly. However, the distribution of the breast tissue can lead to the false determination
of some adipose regions if the moving window is fully filled
with glandular tissue. In order to avoid false determination of
sample points, different moving window sizes are utilized on

= N r /25
= N c /25
= 0.5 n r
= 0.5 n c

R4
n r = 4 s N r /25
n c = 4 s N c /25
o r = 0.5 n r
o c = 0.5 n c

different regions of the breast depending on the tissue distributions. Therefore, the breast interior is divided into four regions
denoted by R1 to R4 as illustrated in Fig. 3(b), depending on the
abundancy of glandular and adipose tissues.
R1 , defined by the thickness δ 1 , is the region that includes
the nipple. It is composed of milk ducts and is very rich in
glandular tissue. In a breast MRI of a patient in prone position, nipple is usually located at the bottom of the breast. The
structure of the glandular tissue starts branching out from the
nipple through the chest wall, and separates from the skin by
0.5–2.5 cm of subcutaneous fat [25]. Therefore the lateral edges
of the breast which is denoted by R2 with thickness δ 2 is composed of almost completely adipose tissue. The glandular region
which lies on the chest wall is represented by R3 with a thickness represented by δ 3 . Finally, the remaining inner region of
the breast is represented by the region R4 .
The choice of the thicknesses δ 1 , δ 2 , δ 3 can be made by
analyzing MRI images of the breasts of different size, density,
and shape. δ 1 was selected to be 1.5 cm, as the maximum height
of the nipple area among the chosen 50 reference breast MRIs.
On the other hand, δ 2 and δ 3 should be defined in proportion to
the size of the breast region in the current slice. δ 2 can be taken
as minimum adipose thickness just under the skin and is nearly
Nr /14, based on our observations from the set of MRI images.
With a similar logic, δ 3 is selected as nearly Nc /4.
For each region, local maxima are retrieved using a moving
window whose parameters are specific to different regions. Coordinates and the intensity values of the maxima are stored in
a matrix form for each slice (Im ax ). Corresponding windowing
parameters for sampling operation are given in Table I.
If the breast is mostly glandular, then R4 is expected to be
rich in glandular tissue [25]. The abundancy of glandular tissue inside R4 can result in gathering undesired samples if the
corresponding moving window is not large enough to cover
any adipose tissue, as mentioned before. In order to avoid false
determination of adipose tissue samples, slightly larger moving windows are defined for the region R4 . However, moving
windows that are larger in size lead to insufficient number of
samples in the exterior slices as shown in Fig. 4(a) because the
overall density of the glandular tissue reduces in exterior slices.
In order to increase the number of samples one should adapt
the size of the moving window defined for R4 in accordance
with the size of the breast at a given MRI slice. To this aim,
a slice factor s can be defined which shrinks the window size
linearly down to (approximately) four times in exterior slices
with respect to the slices at the center. For an MRI data consisting of K slices, the slice factor s for kth slice is calculated

TUNÇAY AND AKDUMAN: REALISTIC MICROWAVE BREAST MODELS THROUGH T1-WEIGHTED 3-D MRI DATA

691

Fig. 4. Adipose tissue samples collected from an external slice: (a) without
using the slice factor and (b) using the slice factor.
TABLE II
CORRESPONDING WINDOW SIZES FOR TRIM OUT
R1 , R4
nr
nc
or
oc

= 8 N r /25
= 8 N c /25
= 0.5 n r
= 0.5 n c

R2

R3

No reduction

n r = 3 N r /25
n c = 3 N c /25
o r = 0.5 n r
o c = 0.5 n c

Fig. 5. Process of the bias field elimination. (a) Sample voxels of adipose
tissue indicated by red dots. (b) Estimated bias filed. (c) MRI data disrupted by
the bias field. (d) The same slice after bias field is eliminated.

by
s(k) =
where

(X − s )
max (X − s )




K
s =  − k  + 1, k = 1, 2, . . . K
2

(1)

(2)

and
4max (s ) − min (s )
.
(3)
3
As shown in Fig. 4(b), using different moving window sizes
for different regions reduces the number of undesired samples
significantly.
After sampling the operation, we still observe some samples
that belong to nonadipose voxels in the matrix Im ax . A second
scanning procedure can be applied to discard these nonadipose
samples by spatial filtering, since bias field is a low frequency
signal. Voxels within a neighborhood should have similar values
due to the low-frequency content signature of the bias, and thus
nonadipose samples are eliminated by scanning the matrix Im ax
with a local window with different parameters for each of four
regions given in Table II. An intensity threshold operator p is
applied inside the window to discard the voxels that do not
satisfy the following condition:
X=

im ax (r, c) > max(im ax ).p

(4)

where im ax (r, c) denotes the retrieved point located at the coordinates (r, c) in the local window. The threshold operator p
is selected as 0.85, as advised in [24]. Selected sample voxels
belonging to adipose tissue after discarding process are shown
in Fig. 5(a) as red dots. In order to model the bias field, we fit
an interpolated smooth surface to those voxels using thin plate
smoothing splines [24], as illustrated in Fig. 5(b). Then the estimated bias field is removed from the corresponding slice by

an element-wise division. After removing the bias field from
the corresponding slice, an unsharp filter [22] is applied in order to enhance the contrast between fibroglandular and adipose
tissues. In Fig. 5(c) and (d), the original slice corrupted by
bias field and the denoised version through the given process
are illustrated respectively. We also compared to the results of
homomorphic filtering with those of the proposed ones (see
Fig. 6). Three columns (A), (B), and (C) represent the results
of three selected slices (21th, 34th, and 43th slice) of an MRI
data, consisting of 43 axial slices. The first row, in which the
results of homomorphic filtering are illustrated, shows reduced
background illumination only at bright regions, specifically in
exterior slices as in (C). On the other hand, as illustrated in the
second row, our approach gives sharper tissue distribution and
better contrast between the adipose and the glandular tissue than
the homomorphic filtering process. Additionally, histograms of
the same MRIs obtained by homomorphic filtering and the proposed approach are illustrated in the third and the fourth rows,
clearly showing the noticeable enhancement of the proposed
method on the double peaked MRI histogram.
In addition, we also compare how bias field correction approach and homomorphic filtering approach affect the mapping
of electromagnetic properties to the MRI voxel intensities in
Fig. 7. In both cases we manually segmented the glandular and
adipose tissues and mapped the voxel intensities to the electromagnetic properties using the mapping approach proposed in
[13]. MRI data, which are heavily disrupted by a bias field are
denoised using homomorphic filter and the proposed bias field
correction approach as illustrated in Fig. 7(a) and (b), respectively. Electromagnetic maps illustrated in Fig. 7(c) and (d) are
produced from (a) and (b). In Fig. 7(c), we observe that, the
voxels belonging to the adipose tissue are mapped to electromagnetic properties of glandular tissue, and some portion of the
glandular tissue are mapped to the electromagnetic properties of
adipose tissue. In contrast, electromagnetic map produced from

692

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 8. GMM decomposition of an almost entirely fatty breast. MRI histogram is represented by the solid curve, while two components of GMM, are
represented by the dashed and the dotted curves, respectively.

Fig. 6. Comparison between the MRIs denoised by homomorphic filtering and
by the presented method. Each of three columns labeled with (A) to (C) shows a
different slice taken from the same MRI data. The first and the second rows show
visual results of homomorphic filtering and the proposed method, respectively.
Likewise, the third and the fourth rows demonstrate the enhancement on the
histograms after the homomorphic filtering and the proposed method is applied,
respectively.

Fig. 9. Representation of the proposed segmentation method. MRI histogram
is represented by the solid curve while the curve fitted to the Gaussian component
formed by the adipose tissue voxels is represented by the dotted curve.

the MRI data denoised by the proposed approach represents the
tissue distribution more accurately.
The denoised MRI data are now ready for the tissue segmentation, as explained in the next section.
C. Segmentation of Two Main Tissues

Fig. 7. Comparison between mapping of electromagnetic properties to the
MRI data denoised by homomorphic filtering and proposed approach. In (a)
and (b), MRI data denoised by homomorphic filter and the proposed bias filed
correction approach are illustrated, respectively. Accordingly, (c) and (d) are
the ARN-MBPs developed by mapping the relative permittivities to the MRI
voxel intensities given in (a) and (b) respectively. Gray bars indicate the voxel
intensity values and color bars indicate relative permittivities, εr .

The human breast is composed of two main tissue types:
adipose, which determines the shape of breast and acts as a protective barrier, and fibroglandular tissue, which is composed of
connective tissue, lobs, lobules, and milk ducts. These two types
of tissue have different electromagnetic properties and must be
separated on the MRI data to correctly map electromagnetic
properties according to their MRI voxel intensities. Based on a
double Gaussian histogram assumption of MRI data, a method
using the Gaussian mixture model (GMM) for the tissue segmentation of 3-D breast MRI is presented in [13]. This approach
leads to robust results given that the breast is dense as in ACR III
or IV classes. On the other hand, GMM does not provide clear
information about glandular tissue distribution in fatty breasts
as illustrated in Fig. 8. The upper intensity bound of glandular
tissue cannot be resolved since its distribution (dotted curve with
mean μg and standard deviation σg ) lies under the adipose tissue
histogram (dashed curve with mean μf and standard deviation
σf ).

TUNÇAY AND AKDUMAN: REALISTIC MICROWAVE BREAST MODELS THROUGH T1-WEIGHTED 3-D MRI DATA

693

Fig. 10. Segmentation results of two breasts with different radiographic densities. Plots (a) and (b) represent the histograms of the denoised MRIs of the breast
that are classified as ACR4 and ACR1, respectively. Plots (c) and (d) are the axial slices of the same breast MRIs, and (e) and (f) are the segmentation results. The
manually segmented ground truth masks are illustrated in (g) and (h).

Along this line, we present an alternative, histogram based
segmentation method, which involves an intensity threshold parameter T that separates adipose and glandular tissues. As the
adipose tissue ideally has Gaussian-like distribution, its full
width half maximum (FWHM), FWHMf , is calculated as two
times of the width around the half of the peak denoted by μf
as shown in Fig. 9. Then, a single Gaussian curve (i.e., dotted
curve in Fig. 9) is fitted onto part of the adipose tissue histogram,
that is toward the right of the intensity threshold T, and whose
intensity values below T are clipped. Threshold parameter T
is increased from 0 to a certain value, until the optimal fit is
achieved between the clipped adipose histogram and the Gaussian curve. The resulting Gaussian curve can now be considered
as the actual adipose tissue distribution, and the threshold value
T becomes the separator of two main tissues. The procedure
can be formulated as follows.
Let X be the set of voxel intensities in the breast interior and
f (x) is the probability density function of X. If we define a
threshold value T , the variance of the adipose tissue voxels is
defined by [26]

f (x)(μf − x)2
(5)
σf2 =
x> T

where μf is the mean of the adipose tissue distribution. Then
the threshold T can be calculated as
T = arg min(|FWHMf − FWHMf |)

(6)

FWHMf ∼
= 2.34 σf .

(7)

T ∈X

with

The results of the proposed segmentation method on the
breasts with different radiographic densities are illustrated in
Fig. 10. The first and the second rows of the figure illustrate the
results of a breast classified as ACR IV and a breast classified

TABLE III
SEGMENTATION RESULTS GIVEN WITH THE DICE
SIMILARITY COEFFICIENT (DSC)
Cases
Worst
Best
Mean

ACR class
ACR II
ACR III
-

DSC
0.839
0.992
0.932

FPR

FNR
−3

377 × 10
108 × 10 −4
762 × 10 −4

544 × 10 −3
528 × 10 −5
687 × 10 −4

as ACR I, respectively. Fig. 10(a) and (b) demonstrates the histograms of the breast MRIs of those shown in Fig. 10(c) and
(d), respectively. The solid curves represent the pdf of the voxel
intensities, while the dashed curves are the Gaussian curves fitted to the adipose tissue distributions. The segmentation results
of the glandular tissue are given in Fig. 10(e) and (f). In order
to evaluate the effectiveness of the method, segmentation results are compared with the gold truth images through the Dice
similarity coefficient (DSC) [27] which has been adopted to
validate the segmentation of various MRI images [28]. Because
there is no such database supplying both the 3-D T1-wighted
MRI breast data and the segmented slices, we manually create
our own gold truth images of our MRI data collection [i.e., see
Fig. 10(g) and (h)]. A total of 50 segmented MRIs of different
sizes and densities are compared with the gold truths, and the
results in the worst and the best cases, as well as the average of
all results are given in Table III. The false positive ratio (FPR)
is the ratio of the misclassified voxels labeled as glandular,
which in fact belong to the adipose tissue. On the other hand,
the false negative ratio (FNR) is the ratio of the misclassified
voxels labeled as adipose, which in fact belong to the glandular
tissue.
We also provide the ACR classes of the segmented breasts in
the worst and the best cases to show that there is no correlation
between the success rates and the breast densities. However, in

694

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

TABLE IV
SINGLE-POLE COLE–COLE MODEL FOR THE FIVE
DIELECTRIC PROPERTY CURVES
Media

Maximum
Group 1
Group 2
Group 3
Minimum

Electromagnetic media characteristics
ε∞

Δε

σ s (S/m)

τ (ps)

α

1.000
7.821
5.573
3.140
2.293

66.31
41.48
34.57
1.708
0.141

1.370
0.713
0.524
0.036
0.002

7.585
10.66
9.149
14.65
16.40

0.063
0.047
0.095
0.061
0.251

For a specific frequency f1 the corresponding values of εr
and σ for each group will have the values pm in , p1 , p2 , p3 ,
pm ax and cm in , c1 , c2 , c3 , cm ax , respectively (see Fig. 11). The
corresponding voxel intensity values in the MRI histogram for
these values are labeled by Im in , Iμg , IT , Iμf , Im ax which are
defined as
Im in = μg − 3σg
Iμg =

T


(8)

xf (x)

(9)

xf (x)

(10)

x=0

Iμf =

∞

x=T

IT = T
Im ax = μf + 3σf

Fig. 11. Conductivity (σ), and relative permittivity (εr ) curves depending on
the frequency for different breast tissue groups.

the worse cases FPR which shows the over-segmentation are
slightly greater than FNR.
D. Electromagnetic Properties Mapping
The electromagnetic properties and heterogeneity of breast
tissue have been well analyzed [29], [30]. In these studies, breast
tissue is categorized into three groups according to the portion
of adipose content during the measurements: i) group 1 (0–
30% adipose content), ii) group 2 (31–84% adipose content),
iii) group 3 (85–100% adipose content). The average values of
relative permittivity (εr ) and conductivity (σ) for each tissue
group as well as the maximum and minimum bounds of εr
and σ, are calculated by single-pole Cole–Cole model given
in Table IV [29]. The frequency dependence of corresponding
variations of σ and εr obtained by the single-pole Cole–Cole
model are illustrated in Fig. 11(a) and (b), respectively.

(11)
(12)

where μg and μf are the expected values and σg and σf are the
standard deviations of adipose and glandular tissue, respectively.
In order to make an appropriate mapping from MRI voxel
intensity variation to electromagnetic properties of the tissues,
one can first establish the pairs (pm in, Im in ), (p1, Iμg ), (p2 , IT ),
(p3 , Iμf ), (pm ax , Im ax ) and (cm in , Im in ), (c1 , Iμg ), (c2 , IT ),
(c3 , Iμf ), (cm ax , Im ax ). This allows us to form a point-wise
mapping from (Im in , Iμg , IT , Iμf , Im ax ) to (pm in , p1 , p2 , p3 ,
pm ax ) and cm in , c1 , c2 , c3 , cm ax ).
To cover the whole MRI voxel intensity space, these pairs
can be used to define mapping functions which relate the appropriate dielectric properties to the intensity values. In [13], a
piecewise linear mapping function that matches all MRI voxel
intensity values to dielectric permittivities and conductivities
is showcased by taking the aforementioned pairs into account.
Here, we consider an alternative approach, which defines a nonlinear interaction between the MRI voxel intensity values and
the permittivity and conductivity profiles.
Introducing a nonlinear mapping instead of piecewise linear
approach is motivated based on the analysis in [29] and [30],
which demonstrated the dependence of three groups. In another
words, dielectric permittivity and conductivity pairs may not
be used as a boundary that exactly separates different tissue
types from each other, as done in piecewise linear mapping.
Accordingly, we use, for the first time, a monotone piecewise
polynomial cubic Hermitte interpolation [18], [19] to form such
nonlinear mapping functions for εr and σ, passing through five
intersection points. The nonlinear mapping functions assure two
important features.
1) Electromagnetic properties should be monotonically decreasing, because higher intensities refer to the tissues
rich in adipose content and as a result there is an inverse
proportion between the MRI intensities and the dielectric
properties. Monotone piecewise polynomial cubic Hermitte interpolation ensures that the mapping functions are
strictly monotonic.
2) Electromagnetic properties should cover the whole voxel
intensity space in MRI data: Upper and lower bounds of
mapping function in MRI voxel intensity axis are taken as

TUNÇAY AND AKDUMAN: REALISTIC MICROWAVE BREAST MODELS THROUGH T1-WEIGHTED 3-D MRI DATA

Fig. 12. Representative nonlinear mapping functions of electromagnetic properties at 6 GHz for (a) εr and (b) σ.

Im in and Im ax respectively. Voxel intensities greater than
Im ax are mapped to the maximum dielectric values, while
the voxel intensities smaller than Im in are mapped to the
minimum dielectric values.
Representative nonlinear mapping functions for both relative
permittivity and conductivity are illustrated in Fig. 12. Each
voxel in MRI data is mapped to appropriate electromagnetic
properties through these nonlinear mapping functions.
Because there is no such study that can be assumed as ground
truth for dielectric variations in an ARN-MBP, to validate the
proposed nonlinear mapping approach, we compare it with the
piecewise linear mapping method as in Fig. 13. Axial slices of
an ARN-MBP produced using piecewise linear mapping and the
proposed method are shown in Fig. 13(a) and (b), respectively.
To compare the variations of two different approaches, we examine the εr variations over the paths passing through the same
coordinates as illustrated by dashed white lines. In Fig. 13(c) εr
variations over the paths are plotted by blue and red lines where
the blue line corresponds to the variation in piecewise mapping
approach while the red line corresponds the proposed nonlinear mapping approach. Two approaches seem to give nearly the
same distributions. However in the zoomed area, it is shown that
the piecewise linear mapping method assigns relatively high dielectric values to the adipose tissue compared to our approach.
For example, in the zoomed figure, same voxels are assigned
to εr of approximately 11 by piecewise linear mapping, while
mapped to εr of 8 by our approach. Consequently, nonlinear

695

Fig. 13. Comparison of piecewise linear mapping with the proposed approach.
(a) ARN-MBP developed using piecewise linear mapping and (b) proposed
mapping approach. (c) Dielectric properties variation over the paths illustrated
in (a) and (b). Variations belonging to the piecewise linear mapping and the
proposed method are illustrated by blue and red lines, respectively.

mapping approach gives better contrast between adipose and
glandular tissues in ARN-MBPs than the traditional piecewise
linear mapping approach.
E. Building the 3-D Structure
After mapping all the MRI voxels to corresponding dielectric
permittivity and conductivity profiles, one can now construct
a 3-D ARN-MBP. But at first, corresponding permittivity and
conductivity slices are considered in terms of the operating frequency. The current voxel sizes are interpolated by a desired
amount in accordance with the requirements of the chosen computational method that wants to be utilized. The amount of resize
ζ can be calculated as
ζ=

rdes rx,y
λ

(13)

where λ represents the operating wavelength, rdes is the desired voxel resolution (number of voxels per wavelength)
and rx,y is the initial resolution of the MRI data. For example, for an operating frequency of 6 GHz, if one needs
a voxel resolution of 20 for per wavelength, then the permittivity and conductivity slices with an initial resolution of
0.31 mm × 0.31 mm × 3 mm, should be resized by a factor of
0.124, using cubic interpolation [31].

696

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 14. Representation of the stair step artifacts elimination. (a) Base structure
with the additional slices, and (b) the elimination of stair step artifacts preserving
the natural shape of breast. Plots (c) and (d) represent the elimination through
coronal slices of the phantoms given in (a) and (b), respectively.

After the desired resolution is achieved, the permittivity and
conductivity slices are cubically interpolated [31] to form a
proper volumetric profile as illustrated in Fig. 14(a). As a result
of interpolation, stair step artifacts emerge in the direction of
interpolation which may lead to undesired scattering. One can
remove these artifacts by masking the coronal slices by perfectly fitting 2-D elliptical masks [13]. Although, they can be
completely removed in this manner, some structural features
specific to the breast would be lost. Consequently, the entire
structure of the phantom would become a collection of elliptical slices in the direction of the coronal axis. This kind of a
masking operation discards some portions of the breast such as
upper chest wall and axilla where the tumors can spread to the
lymph nodes or cause metastasis reaching blood vessels. Therefore, ARN-MBPs with more realistic shapes are desired. To this
aim, we consider the phantoms in 3-D and apply morphological
operations to make them structurally more realistic.
The interpolation process produces the base structure as illustrated in Fig. 14(a). The base structure can be used to produce
a 3-D realistic breast mask for the corresponding phantom by
smoothing its surface. However, some lateral portion of the
breast along the imaging axis cannot be imaged by MRI with
high fidelity, resulting in an incomplete breast structure. To provide the continuity, the breast is extended with additional lateral
slices, as illustrated in Fig. 14(a). The dielectric properties of the
additional slices are selected equal to the dielectric properties
of adipose tissue, as the missing portion of the breast fall into
the region which is composed of 0.5–2.5 cm of subcutaneous
fat [25]. Then, the surface of the base structure is smoothed by
a 3-D Gaussian filter and is eroded by 2.7 mm as in Fig. 14(b)
(which is the maximum breast skin thickness given in [32]).
Fig. 14(c) and (d) shows the coronal slices before and after the
elimination of stair step artifacts, respectively.
Finally, the breast surface is dilated and covered by an artificially produced 1.5-mm thick skin layer. Thickness of the skin

Fig. 15. Axial cross sections of five MRI data with different BTI index and
corresponding 3-D ARN-MBPs for 6 GHz developed from them. The grayscale
bars show the variation of voxel intensity values while the color bars represent
the relative permittivity variation of the corresponding phantom.

layer is chosen to be the average value given in [32]. Whole
structure is placed on an artificial chest model with a 1.5 cmthick fat followed by a 0.5-cm thick muscle layer [13]. Dielectric properties of skin and muscle are obtained from the previous
study reported in [33].
III. CLASSIFICATION OF BREAST PHANTOMS
It has been shown that the risk of developing breast cancer
increases with the density of breast [34]. The sensitivity of early
breast cancer detection methods based on mammography [i.e.,
computer-aided diagnosis (CAD)] decreases as the breast density increases [17]. Thus, breast classification according to the
tissue density is important. In this sense, ACR classification
emerged as a crucial tool for assessment of mammographic images. On the other hand, mapping ACR categories and the densities, obtained through MRI data, is unrealistic as the correlation between MRI and mammographic density is low [35]–[36],
[37]. Not only the ACR classification has specifically emerged
for mammographic images, but also the unqualified categorization, (i.e., what is the boundary between ACRII and ACRIII?)

TUNÇAY AND AKDUMAN: REALISTIC MICROWAVE BREAST MODELS THROUGH T1-WEIGHTED 3-D MRI DATA

makes ACR classification approach inefficient for MRI images
[37]. Instead of assigning ACR categories to our phantoms, we
label them with an index number, called breast tissue index
(BTI) [36]. BTI is defined as the ratio of glandular tissue to the
total breast tissue, with the following definition:
T
BTI =

x=0 f (x)

f
(x)

(14)

where f (x) represents pdf of MRI voxel intensity and T is
threshold value. In Fig. 15, we present the results of our 3-D
ARN-MBPs. Fig. 15(a) to (e) illustrate the breast MRIs with different ACR categories according to their radiographic densities,
ACR IV, ACR III, ACR III, ACR II, and ACR I, respectively.
Similarly, a BTI score is assigned to each breast MRI to categorize our ARN-MBPs. Corresponding dielectric permittivity
profiles for the given MRI data at 6 GHz are demonstrated in
Fig. 15(f) to (j) and the 3-D ARN-MBPs of these breasts are also
illustrated in Fig. 15(k)–(o) with the cross-sections showing the
same slices. Note that, although the given MRIs in Fig. 15(c)
and (d) are both categorized as ACR III, they have different
BTI scores because of poor correlation between mammographic
density and the MRI density. Therefore, it is more consistent
to classify ARN-MBPs with BTI score rather than ACR classification. Thereby, one can easily choose any type of ARNMBPs with appropriate tissue density by using this classification
procedure.
IV. SUMMARY
3-D ARN-MBPs are developed using T1-weighted MRI data
of the patients in prone position. A general method, which can be
applied to any type of breast belonging to four ACR categories, is
developed. In contrast to uniform, piecewise linear and bimodal
mapping methods, 3-D MRI data are transformed into ARNMBPs via nonlinear mapping functions, which assume a nonlinear relationship between tissues types and electromagnetic
properties. Furthermore, an effective histogram based segmentation method is presented for the development of ARN-MBPs.
Human dependency of the previous methods are substantially
eliminated allowing for producing numerous ARN-MBPs with
different types. Additionally, using basic morphological operations, 3-D ARN-MBPs with more realistic shapes, in comparison to its counterparts, are developed. Each of the developed
ARN-MBPs, are labeled with a BTI index according to their
MRI densities, which has been observed as the optimal indicator for classification purpose.
ACKNOWLEDGMENT
The authors would like to acknowledge the technical assistance of the Euromed Medical Center in supplying a number of
anonymous breast MRI data. They also would like to thank Prof.
Dr. L. Çelik (Marmara University Medical Faculty member) for
his convulsive assistance and Asst. Prof. O. Ferhanoglu for his
editorial assistance.

697

REFERENCES
[1] A. M. Hassan and M. El-Shenawee, “Review of electromagnetic techniques for breast cancer detection,” IEEE Rev. Biomed. Eng., vol. 4,
pp. 103–118, 2011. DOI: 10.1109/RBME.2011.2169780
[2] T. U. Gürbüz, B. Aslanyürek, A. Yapar, H. Şahintürk, and I. Akduman,
“A nonlinear microwave breast cancer imaging approach through realistic
body–breast modeling,” IEEE Trans. Antennas Propag., vol. 62, no. 5,
pp. 2596–2605, May 2014.
[3] X. Zhu, Z. Zhao, J. Wang, G. Chen, and Q. H. Liu, “Active adjoint
modeling method in microwave induced thermoacoustic tomography for
breast tumor,” IEEE Trans. Biomed. Eng., vol. 61, no. 99, pp. 1957–1966,
Jul. 2014.
[4] R. Scapaticci, G. Bellizzi, I. Catapano, L. Crocco, and O. M. Bucci, “An
effective procedure for MNP-enhanced breast cancer microwave imaging,”
IEEE Trans. Biomed. Eng., vol. 61, no. 4, pp. 1071–1079, Apr. 2014.
[5] M. A. Elahi, A. Shahzad, M. Glavin, E. Jones, and M. O’Halloran, “Hybrid
artifact removal for confocal microwave breast imaging,” IEEE Antennas
Wireless Propag. Lett., vol. 13, pp. 149–152, Jan. 2014.
[6] M. Converse, E. J. Bond, B. D. Van Veen, and S. C. Hagness, “A computational study of ultrawideband versus narrowband microwave hyperthermia
for breast cancer treatment,” IEEE Trans. Microw. Theory Tech., vol. 54,
no. 5, pp. 2169–2180, May 2006.
[7] J. Stang, M. Haynes, P. Carson, and M. Moghaddam, “A preclinical system
prototype for focused microwave thermal therapy of the breast,” IEEE
Trans. Biomed. Eng., vol. 59, no. 9, pp. 2431--2438, Sep. 2012.
[8] R. Bansal, “Battling cancer: The latest on microwave hyperthermia,” IEEE
Microw. Mag., vol. 6, no. 3, pp. 32–34, Sep. 2005.
[9] S. C. Hagness, A. Taflove, and J. E. Bridges, “Two-dimensional FDTD
analysis of a pulsed microwave confocal system for breast cancer detection: Fixed-focus and antenna-array sensors,” IEEE Trans. Biomed. Eng.,
vol. 45, no. 12, pp. 1470–1479, Dec. 1998.
[10] A. E. Souvorov, A. E. Bulyshev, S. Y. Semenov, R. H. Svenson, and G. P.
Tatsis, “Two-dimensional computer analysis of a microwave flat antenna
array for breast cancer tomography,” IEEE Trans. Microw. Theory Tech.,
vol. 48, pp. 1413–1415, Aug. 2000.
[11] X. Li and S. C. Hagness, “A confocal microwave imaging algorithm for
breast cancer detection,” IEEE Microw. Wireless Compon. Lett., vol. 11,
no. 3, pp. 130–132, Mar. 2001.
[12] M. Converse, E. J. Bond, B. D. Van Veen, and S. C. Hagness, “A computational study of ultrawideband versus narrowband microwave hyperthermia
for breast cancer treatment,” IEEE Trans. Microw. Theory Tech., vol. 54,
no. 5, 2169–2180, May 2006.
[13] E. Zastrow, S. K. Davis, M. Lazebnik, F. Kelcz, B. D. Van Veen, and S.
Hagness, “Development of anatomically realistic numerical breast phantoms with accurate dielectric properties for modeling microwave interactions with the human breast,” IEEE Trans. Biomed. Eng., vol. 55, no. 12,
pp. 2792–2799, Dec. 2008.
[14] Z. Guangran, B. Oreshkin, E. Porter, M. Coates, and M. Popović, “Numerical breast models for commercial FDTD simulators,” in Proc. 3rd
Eur. Conf. Antennas Propag., pp. 263–267, Mar. 2009.
[15] R. C. Gonzalez and R. E. Woods, Digital Image Processing, 2nd ed. Upper
Saddle River, NJ: Prentice-Hall, 2002.
[16] R. A. Redner and H. F. Walker “Mixture densities, maximum likelihood, and the EM algorithm,” Soc. Ind. Appl. Math. Rev., vol. 26, no. 2,
pp. 195–239, 1984.
[17] American college of radiology, Breast Imaging Reporting and Data System
(BI-RADS) Atlas, 4th ed. Reston, VA: Amer. Coll. Radiol., 2003.
[18] F. N. Fritsch and R. E. Carlson, “Monotone piecewise cubic interpolation,”
SIAM J. Numer. Anal., vol. 17, no. 2, pp. 238–246, 1980.
[19] M. H. James, “Accurate monotonicity preserving cubic interpolation,”
SIAM J. Numer. Anal., vol. 4, no. 4, Dec. 1983.
[20] M. J. Firbank, A. Coulthard, R. M. Harrison, and E. D. Williams, “A
comparison of two methods for measuring the signal to noise ratio on MR
images,” Phys. Med. Biol., vol. 44, pp. N261–N264, 1999.
[21] N. Otsu, “A threshold selection method from gray-level histograms,” IEEE
Trans. Syst., Man, Cyber., vol. 9, pp. 62–66, 1979.
[22] R. M. Haralick and L. G. Shapiro, Computer and Robot Vision, 1st ed.
Boston, MA: Addison-Wesley, 1992.
[23] J. G. Sled and A. P. Zijdenbos, “A nonparametric method for automatic
correction of intensity nonuniformity in MRI data,” IEEE Trans. Med.
Imag., vol. 17, no. 1, pp. 87–97, Feb. 1998.
[24] F. S. Jorgensen, “Segmentation of male abdominal fat using MRI,” Master’s thesis, Dept. Informat. Math. Modelling, Tech. Univ. Denmark,
Kongens Lyngby, Denmark, pp. 11–35, 2006.

698

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

[25] R. L. Egan, Breast Imaging: Diagnosis and Morphology of Breast Diseases, Philadelphia, PA: Saunders, 1988.
[26] D. G. Montgomery and G. C. Runger, Applied Statistics and Probability
for Engineers, New York: Wiley, 2007.
[27] L. R. Dice, “Measures of the amount of ecologic association between
species,” Ecology, vol. 26, pp. 297–302, 1945.
[28] A. P. Zijdenbos, B. M. Dawant, R. A. Margolin, and A. C. Palmer, “Morphometric analysis of white matter lesions in MR images: Method and
validation,” IEEE Trans. Med. Imag., vol. 13, no. 4, pp. 716–724, Dec.
1994.
[29] M. Lazebnik, L. McCartney, D. Popovic, C. B. Watkins, M. J. Lindstrom,
J. Harter, S. Sewall, A. Magliocco, J. H. Booske, M. Okoniewski, and S. C.
Hagness, “A large-scale study of the ultrawideband microwave dielectric
properties of normal breast tissue obtained from reduction surgeries,”
Phys. Med. Biol., vol. 52, pp. 2637–2656, 2007.
[30] M. Lazebnik, D. Popovic, L. McCartney, C. B.Watkins, M. J. Lindstrom,
J. Harter, S. Sewall, T. Ogilvie, A. Magliocco, T. M. Breslin, W. Temple,
D. Mew, J. H. Booske, M. Okoniewski, and S. C. Hagness, “A large-scale
study of the ultrawideband microwave dielectric properties of normal,
benign, and malignant breast tissues obtained from cancer surgeries,”
Phys. Med. Biol., vol. 52, pp. 6093–6115, 2007.
[31] R. Keys, “Cubic convolution interpolation for digital image processing,”
IEEE Trans. Signal Process., Acous., Speech, Signal Process., vol. 29,
no. 6, pp. 1153–1160, Dec. 1981.
[32] J. T. L. Pope, M. E. Read, T. Medsker, A. J. Buschi, and A. N. Brenbridge,
“Breast skin thickness: Normal range and causes of thickening shown on
film-screen mammography,” J. Can. Assoc. Radiol., vol. 35, pp. 365–368,
1984.
[33] S. Gabriel, R.W. Lau, and C. Gabriel, “The dielectric properties of biological tissues: III. Parametric models for the dielectric spectrum of tissues,”
Phys. Med. Biol., vol. 41, pp. 2271–2293, 1996.
[34] S. C. O’Neill, K. G. Leventhal, M. Scarles, C. N. Evans, E. Makariou,
E. Pien, and S. Willey, “Mammographic breast density as a risk factor for
breast cancer: Awareness in a recently screened clinical sample,” Women’s
Health Issues, vol. 24, no. 3, pp. e321–e326, May–Jun. 2014.
[35] N. A. Lee, H. Rusinek, J. Weinreb, R. Chandra, H. Toth, C. Singer,
and G. Newstead, “Fatty and fibroglandular tissue volumes in the breasts
of women 20–83 years old: Comparison of X-ray mammography and
computer-assisted MR imaging,” Am. J. Roentgenol., vol. 168, no. 2, pp.
501–506, 1997
[36] C. Klifa , J. Carballido-Gamio, L. Wilmes, A. Laprie, C. Lobo, E. Demicco,
M. Watkins, J. Shepherd, J. Gibbs, and N. Hylton, “Quantification of
breast tissue index from MR data using fuzzy clustering,” in Proc. IEEE
26th Annu. Int. Conf. Eng. Med. Biol. Soc., Sep. 2004, vol. 1, no. 3,
pp. 1667–1670.
[37] N. L. Hansen, C. K. Kuhl, A. Barabasch, K. Strobel, and S. Schrading,
“Does MRI breast “density” (degree of background enhancement) correlate with mammographic breast density?,” J. Magn. Resonance Imag.,
vol. 40, no. 2, pp. 2431–2438, Sep. 2012.

Ahmet Hakan Tunçay was born in Eskişehir, Turkey
in 1986. He received the B.Sc. degree in electrical and
electronic engineering from Osmangazi University,
Eskişehir, Turkey, in 2010, and the M.Sc. degree in
biomedical engineering from Istanbul Technical University, Istanbul, Turkey, in 2013. He began the Ph.D.
program in satellite communication and remote sensing at Istanbul Technical University, in 2013.
From 2011 to 2014, he was with Istanbul Technical University as a Research Assistant. He joined
Alcatel Lucent Inc. in Istanbul, Turkey, in 2014.
His main areas of research interest include biomedical imaging systems and
image processing.

Ibrahim Akduman (M’06) was born in Konya,
Turkey, in 1963. He received the B.Sc., M.Sc., and
Ph.D. degrees in electronics and communication engineering from the Istanbul Technical University, Istanbul, Turkey, in 1984, 1987, and 1990, respectively.
He was a Visiting Scientist with the Polytechnic
University, New York, in 1991; with the King’s College London, U.K., in 1995; with the New Jersey
Institute of Technology, in 2000; and with the University of Goettingen, Germany, in 2001. He was the
Dean of the Electrical and Electronics Engineering
Faculty, Istanbul Technical University, between June 1999 and July 2001, and
a Vice President of the same university between 2002 and 2004. He is currently with the Istanbul Technical University, as a Full Professor where he is the
Head of the Electromagnetic Research Group. His research interests include microwave tomography and electromagnetics in medicine. He is also shareholder
of a company doing research and developing products for medical application
of electromagnetic fields.
Prof. Akduman received the Turkish Scientific and Technological Research
Council Young Scientist Award, in 2000.

