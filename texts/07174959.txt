IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

485

Real-Time Respiratory Motion Analysis Using
4-D Shape Priors
Jakob Wasza∗ , Peter Fischer, Student Member, IEEE, Heike Leutheuser, Student Member, IEEE, Tobias Oefner,
Christoph Bert, Andreas Maier, Member, IEEE, and Joachim Hornegger, Member, IEEE

Abstract—Respiratory motion analysis based on range imaging (RI) has emerged as a popular means of generating respiration surrogates to guide motion management strategies in
computer-assisted interventions. However, existing approaches
employ heuristics, require substantial manual interaction, or
yield highly redundant information. In this paper, we propose a
framework that uses preprocedurally obtained 4-D shape priors
from patient-specific breathing patterns to drive intraprocedural
RI-based real-time respiratory motion analysis. As the first contribution, we present a shape motion model enabling an unsupervised decomposition of respiration induced high-dimensional body
surface displacement fields into a low-dimensional representation
encoding thoracic and abdominal breathing. Second, we propose
a method designed for GPU architectures to quickly and robustly
align our models to high-coverage multiview RI body surface data.
With our fully automatic method, we obtain respiration surrogates yielding a Pearson correlation coefficient (PCC) of 0.98 with
conventional surrogates based on manually selected regions on RI
body surface data. Compared to impedance pneumography as a
respiration signal that measures the change of lung volume, we obtain a PCC of 0.96. Using off-the-shelf hardware, our framework
enables high temporal resolution respiration analysis at 50 Hz.
Index Terms—Graphics processing unit (GPU), radiation therapy, range imaging (RI), respiratory motion.

practicable and advanced methods such as beam tracking or
beam gating are based on continuous respiratory motion monitoring and analysis [4]–[6]. For this purpose, external respiration surrogates computed from sparsely distributed reflective
infrared (IR) markers attached to the body or dense range imaging (RI) to capture the entire body surface have gained increasing
popularity. Especially, in combination with patient-specific motion models that correlate external surrogates to internal tumor
movement [7], [8], the advantages of IR markers or RI sensors,
namely their real-time capability and absence of ionizing radiation, can be exploited. Clinically available IR tracking solutions
include the Synchrony system (Accuray Inc., Sunnyvale, CA,
USA) and the ExacTrac module (Brainlab AG, Feldkirchen,
Germany). For RI solutions, the AlignRT system (Vision RT,
London, U.K.) is clinically available and novel RI sensor concepts to tackle the limitations of existing principles have been
recently presented [9]–[11].
One advantage of RI solutions compared to IR tracking methods is that they do not require auxiliary equipment such as reflective vests or markers attached to the patient. However, with
RI sensors, a respiration surrogate is not given per se and various
approaches have been proposed.

I. INTRODUCTION
ESPIRATORY motion is a major issue in computerassisted interventions such as image-guided radiation therapy [1], [2]. One option for motion mitigation is to reduce the
respiration amplitude using active breath-control systems or abdominal pressure [3]. However, such techniques are often not

R

Manuscript received May 11, 2015; revised July 8, 2015; accepted July 20,
2015. Date of publication August 3, 2015; date of current version February 16,
2016. This work was supported by the European Regional Development Fund
and the Bayerisches Staatsministerium für Wirtschaft, Infrastruktur, Verkehr
und Technologie under Grant No. IUK338/001. This work was also by the
Erlangen Graduate School in Advanced Optical Technologies (SAOT) by the
German Research Foundation (DFG) in the framework of the German excellence
initiative. Asterisk indicates corresponding author.
* J. Wasza is with the Pattern Recognition Lab, Department of Computer
Science, Friedrich-Alexander-Universität Erlangen-Nürnberg, 91058 Erlangen,
Germany (e-mail: jakob.wasza@cs.fau.de).
P. Fischer, A. Maier, and J. Hornegger are with the Pattern Recognition Lab,
Department of Computer Science, Friedrich-Alexander-Universität ErlangenNürnberg, and also with the Erlangen Graduate School in Advanced Optical
Technologies.
H. Leutheuser and T. Oefner are with the Pattern Recognition Laboratory,
Department of Computer Science, Friedrich-Alexander-Universität ErlangenNürnberg.
C. Bert is with the Department of Radiation Oncology, Universitätsklinikum
Erlangen and the Friedrich-Alexander-Universität Erlangen-Nürnberg.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2463769

A. Related Work
Commonly, RI-based external respiration surrogate signals
are derived from the movement of body surface regions [12]–
[16]. One issue with such methods is that the surrogates are
based on variations of 3-D points or plain 1-D depth measurements rather than true 3-D surface deformations. Further, the
number of body surface regions and their size and position
must be manually and repeatedly chosen. This is a heuristic approach that is potentially error prone due to low reproducibility
of landmark selection and requires substantial manual interaction which complicates clinical workflows.
Alternative approaches to overcome these limitations compute external body deformations using nonrigid surface registration techniques [9], [17], [18]. By design, these methods allow anatomically plausible 3-D surface landmark tracking and
are capable of avoiding recurring manual landmark selection by
registering preprocedurally labeled planning data to intraprocedurally acquired RI body surface data. The major advantage of
nonrigid registration methods, however, is the ability to generate high-dimensional respiration surrogates in a fully automatic
manner via dense surface displacement fields. An issue with
such high-dimensional surrogates is that they contain redundant information and the low-dimensional nonredundant factors
must be identified. Approaches to address this problem are to

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

486

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Fig. 1. Respiratory motion analysis framework as proposed in this study. The method is divided into a preprocedural and an intraprocedural phase. In the
preprocedural phase, a shape motion model is generated from prior knowledge of 4-D shape deformations. In the intraprocedural phase, the motion model is
registered to RI surface data yielding a respiration surrogate.

calculate the mean displacement magnitude or the movement
along the principal surface deformation direction [17]. However, such reduction schemes do not account for the anatomical
source of motion. Besides these methodological challenges, as
an important practical aspect, real-time capability is an open
issue with nonrigid surface registration.
B. Contributions
In this paper, we propose a framework for RI-based respiratory motion analysis to address the limitations of existing
approaches. Our framework is based on prior knowledge of
patient-specific 4-D shape deformations. This information is encoded in a surface motion model that is preprocedurally trained
from nonrigidly registered 3-D body surface data acquired at
different respiration states. Intraprocedurally, the motion model
is registered to the patient’s current body surface acquired with
multiview RI. The intrinsic parameters that govern the registered
motion model then define a nonredundant external respiration
surrogate. Further, our framework supports the reconstruction
of respiration induced dense body surface displacement fields
to generate custom respiration surrogates. A sketch of our proposed framework is given in Fig. 1.
The feasibility of using prior shape knowledge for respiration management was demonstrated in our preceding work for
motion compensated patient positioning [19], [20]. In this paper, we substantially extend this idea for real-time respiratory
motion analysis by the following two main contributions: first,
we propose a sparse motion model that enables an unsupervised decomposition of respiration induced high-dimensional
dense surface displacement fields into a thoracic and abdominal
component. Second, we present a fast and robust registration
technique to align motion models to high coverage body surface
data computed from multiview RI. To cope with real-time constraints, our framework is designed for general purpose graphics
processing unit (GPU) architectures.
II. METHODS
In the preprocedural training phase, we denote P =
{x1 , . . . , xN }, xn ∈ R3 as the point set that describes a
body surface. Without loss of generality, the point set P can
be equivalently described as a vector p ∈ R3N according to

P ≡ p = ((x1 ) , . . . , (xN ) ) . Using point sets instead of
closed surfaces enables a generic framework that is independent from the acquisition modality to capture prior knowledge
on 4-D shape deformations. For example, tissue-to-air thresholding techniques to extract body surfaces from tomographic
planning data such as computed tomography (CT) or magnetic
resonance imaging (MRI) may exhibit a different topology and
sampling density compared to RI-based surfaces. Further, laser
scanners or markers do not provide a continuous surface at all.
In the intraprocedural respiratory motion analysis phase, we
denote an RI in a multiview setup associated with the kth sensor
as Rk : Ωk → R+ . Rk is sampled on the domain Ωk ⊂ R2 with
N1 × N2 1-D orthogonal range measurements rk ,i in mm with
i ∈ Ω that correspond to the depth of a 3-D point x ∈ R3 along
the viewing axis of the RI camera. Consistently, we denote the
3-D surface corresponding to Rk as Sk : Ωk → R3 . We further
denote Pk : R3 → Ωk as the operator that projects the point x
into Ωk . For a surface point x captured by the kth sensor, we
thus have
Sk (Pk (x)) = R
k (x − tk )
Rk (Pk (x)) = rk ,i = (0, 0, 1) · Sk (Pk (x))

(1)

where Rk ∈ SO(3) and tk ∈ R3 denote the rotation and translation to define the kth RI sensor coordinate system. Further,
surface normals Nk : Ωk → R3 can be readily computed from
Sk using, for example, difference quotients.
For a sketch of the different phases, steps, and data of our
framework, see Fig. 1.
A. Preprocedural 4-D Shape Motion Models
We denote P 0 = {x01 , . . . , x0N } as the point set that describes
the body surface at a fixed reference respiration state, e.g., fully
exhale. Analogously, P s = {xs1 , . . . , xsN } is the point set denoting the moving body surface at respiration state s = 1, . . . , S.
The moving surface points are obtained by warping the fixed surface points with an elastic deformation. This deformation is represented by the displacement field U s = {us1 , . . . , usN }, usn ∈
R3 encoding the pointwise displacements induced by respiratory motion as
xsn = x0n + usn

∀xsn ∈ P s .

(2)

WASZA et al.: REAL-TIME RESPIRATORY MOTION ANALYSIS USING 4-D SHAPE PRIORS

Depending on the acquisition modality, the displacement fields
U s can be computed using dedicated RI surface matching techniques [9], [17], volumetric registration for CT/MRI and surfaces that are represented implicitly by distance transforms, or
point-set alignment methods [21].
1) Motion Model Training: Training a 4-D shape motion
model is to recover the intrinsic structure that governs the
high-dimensional representations of the training data T =
{p1 , . . . , pS } with ps ≡ P s . For this purpose, we use principal
component analysis (PCA) as a linear dimensionality reduction
technique. We favor PCA over nonlinear methods such as manifold learning as the latter typically requires a large number of
training samples which is prohibitive if the training shapes are
extracted from CT or MRI data. Further, nonlinear dimensionality reduction techniques do not offer advantages per-se as we
showed in preceding work [22].
One interpretation of PCA is to find an orthonormal basis that
allows us to reconstruct the training data T in a least-squares
sense [23]. This is readily done by an eigendecomposition of
the covariance matrix C of the mean-centered training data:
C=

S
1 s
(p − p)(ps − p) ,
S s=1

p=

S
1 s
p .
S s=1

487

Fig. 2. Exemplary depiction of the three leading modes of variation el (top to
bottom) for different motion models. The magnitude of the individual surface
displacements in mm is color coded. The proposed weighted VR model allows
for a differentiation between thoracic and abdominal breathing. (a) Standard
PCA. (b) Conventional VR. (c) Weighted VR.

(3)

Let P ∈ R3N ×L denote the PCA basis that columnwise contains
the modes of variation defined by the eigenvectors el ∈ R3N
corresponding to the L largest eigenvalues λl of C. In practice,
L is chosen to match the intrinsic dimensionality of the training
data.
cumulative variance criterion, this translates to
L Using a
S
λ
≥
δ
l=1 l
s=1 λs , i.e., the model accounts for more than
(100 · δ)% of the variance in the input training data. For a test
point set P ≡ p ∈ R3N , its approximation w.r.t. the PCA basis
P is traditionally computed as


(4)
p ≈ pb = p + P P  (p − p) = p + P b
where the model parameter vector b = [b1 , . . . , bL ] ∈ RL is the
low-dimensional representation of p.
Essentially, b corresponds to a least-squares estimate with
regard to pointwise Euclidean distances between corresponding
points in the model and the test point set. As our framework is
based on the registration of the motion model to instantaneous
RI surface data, this estimator is potentially prone to noise and
outliers that are typical with RI. A robust method to account for
this issue is investigated in Section II-C. √
√
Valid shapes are restricted to bl ∈ [−3 λl , +3 λl ] in order
to enforce plausibility w.r.t. to the training data. This interval
assumes that the training data are normally distributed, which
is not necessarily true for respiration related samples. However,
in practice, we found these values as reasonable bounds.
2) Model-Based Respiration Surrogates: For respiratory
motion analysis, we exploit the fact that the modes of variation
el contained in P encode nonrigid body surface displacement
fields; see Fig. 2(a) for an illustration. Thus, the individual model
parameters bl constitute respiration surrogates that describe the
change of surface extent w.r.t. the lth mode relative to the mean
shape p.

In this study, we assume that maximal values of the parameters bl correspond to the state of full inhale. This property is
not given per se as the modes of variation el computed by PCA
have arbitrary signs. One automatic approach to this problem is
to flip the signs such that the model instance pb with maximum
extent is obtained.
Following the model plausibility criterion from the preceding
section,
we shift the model parameters according to bl = bl +
√
3 λl . This enforces the parameters bl to be positive and to
describe the surface extent relative to the most compact or fully
exhale shape allowed by the model. Consequently, we compute
the respiration surrogate σl ∈ R+ for the lth mode and the joint
surrogate σJ ∈ R+ across all modes as
σl = bl
σJ = b 2 .

(5)

Note that (5) is not valid for raw parameters bl ∈ R as a potential
negative sign would be lost.
3) Sparse Motion Models: One inherent problem with PCA
is that the modes el are defined to yield a minimum reconstruction error w.r.t. the training samples ps [23]. Thus, the individual
components of el that are also known as loadings in general do
not exhibit sparsity. As a consequence, the modes el represent
global abstract deformations that do not allow for a respiration analysis w.r.t. to anatomically plausible distinct breathing
patterns; see Fig. 2(a) for an illustration.
In a preliminary study, we have shown that so-called varimax rotations (VR) known from factor analysis [24] allow us to
compute sparse respiratory motion modes [25]. However, this
study was based on plain 1-D depth data, which is a simplifying
assumption that does not reflect complex 3-D surface deformations. In fact, we found that a naive application of VRs for

488

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

complex 3-D deformation data further hinders an intuitive interpretation. This issue is depicted in Fig. 2(b) where the individual
modes exhibit sparse but widespread deformation components.
The reason for this can be traced back to the theoretical concepts
of factor rotations.
The general principle behind VR is to find a rotation R ∈
contained columSO(L) such that the modes of variation eVR
l
nwise in the rotated basis P VR = P R exhibit a more simple
structure. The sought rotation R must maximize [24]:

JRVR =

L

l=1

⎛
	2 ⎞
 3N
3N


⎝
[P R]4q ,l −
[P R]2q ,l ⎠ .
q =1

(6)

q =1

Using Var(X) = E(X ) − [E(X)] with Var(X) denoting the
variance and E(X) the expected value of a random variable
X, (6) corresponds to maximizing the variances of squared
loadings, i.e., X ∝ [P R]2q ,l , across the modes of variation eVR
l
contained in P VR . Due to orthonormality constraints on R, the
only possibility to increase the modewise variances in (6) is to
bring some loadings close to zero and make others grow large
[26].
The problem with this formulation is that it rigorously favors
sparsity w.r.t. the scalar-valued components in the normalized
modes eVR
l . Thus, the vector-valued nature of pointwise 3D displacements as well as the variances λl as a measure of
respiration magnitude is lost.
We address this issue by using a weighted VR (WVR) model
extending the standard VR optimization problem from (6) with
a diagonal weighting matrix Λ according to
2

JRW VR =

L

l=1

⎛
⎝

3N

q =1

2

[P ΛR]4q ,l −

 3N


	2 ⎞
[P ΛR]2q ,l

⎠ . (7)

q =1

For Λ = diag(1, . . . , 1), the standard VR principle is retained,
whereas for Λ = diag(λ1 , . . . , λL ), the solution is similar to
conventional PCA with the difference that the variance of the
squared loadings weighted by λl is maximized. In this study, we
use the mode-specific standard deviations defined
eigen√ by the √
values λl as weighting factors, i.e., Λ = diag( λ1 , . . . , λL ).
The rationale behind this scheme is that these eigenvalues are
directly related to the amount of shape variation in the training set that by definition reflects different respiration states with
varying surface deformation. Thus, sparsity w.r.t. the respiration
magnitude is injected in our WVR model.
The optimization problems from (6) and (7) can be solved
by using an iterative scheme based on singular value decompositions [26]. One issue with the WVR model is that the basis P W VR = P ΛRW VR is in general not orthogonal. Here,
RW VR denotes the solution from (7). We address this issue
by estimating the rotation RW VR with the WVR approach
from (7) but compute the WVR basis without the weighting
matrix Λ analogous to the standard VR approach according
to P W VR = P RW VR . The modes that are obtained with our
WVR scheme are exemplarily shown in Fig. 2(c).

Fig. 3. Surface reconstruction using conventional pinhole (left) and manifold
(right) ray casting of a distance transform D. Color-coded is the support region
, i.e., D(x) ∈ (−1, +1). Note that the diverging rays with a pinhole camera
model do not allow for high coverage surface models.

B. Intraprocedural Multiview RI Body Surface Models
Our respiratory motion framework is based on the registration
of a potentially high coverage preprocedurally trained motion
model to instantaneous RI body surface data. Thus, the RI body
surface data ideally should exhibit high coverage, too. Due to
the limited field-of-view of a single camera, multiple RI sensors
are advantageous to obtain this property.
A real-time capable method for fusing the multiview RI data
and reconstructing a unifying surface representation was proposed in our prior work [20]. Due to the importance of this
scheme for the proposed robust and fast motion model registration in Section II-C, we now outline the basic working principles.
1) Data Fusion Using Distance Transforms: We represent the surface data Sk implicitly via its corresponding
distance transform Dk : Γk → [−1, +1] that holds the distance
to the closest point on the RI surface Sk . Γ ⊂ R3 denotes a suitable region embedding Sk . Similar to Curless and Levoy [27],
the distance transform is approximated based on the relationship
from (1) in a support region around Sk as


Dk (x) = η Rk (Pk (x)) − (0, 0, 1) · R
(8)
k (x − tk )
where η(d) = min(1, |−1 d|) · sign(d) accounts for the support
region controlled by  ∈ R+ . The fused implicit representation
D is then given by a weighted average of the individual distance
transforms Dk [20].
2) Surface Reconstruction Using Ray Casting: For reconstructing an explicit surface S from the fused implicit representation D, we use a manifold ray casting technique introduced in
our previous work [20]. This approach overcomes the limited
body surface coverage with conventional ray casting; see Fig. 3
for an illustration.
Mathematically, we simulate an RI sensor by estimating the
1-D depth measurements R such that the corresponding 3-D
surface points S coincide with the zero level-set of the distance
transform D, i.e.,
!

D (R (oi + R(i)r i ) + t) = 0

∀i ∈ Ω

(9)

where R ∈ SO(3) and t ∈ R3 similar to (1) account for the
virtual sensor position and orientation. Further, oi ∈ R3 and
r i ∈ R3 with r i 2 = 1 denote the starting position and direction of the ray associated with i, respectively. Both oi and r i
are computed from the manifold and basically constitute the
counterpart of the projection operator from (1). Thus, there also
exists a projection operator P : R3 → Ω.

WASZA et al.: REAL-TIME RESPIRATORY MOTION ANALYSIS USING 4-D SHAPE PRIORS

489

As a prerequisite, the virtual RI domain Ω must exhibit a
2-D parameterization. In this study, we use a manifold based on
a half-cylinder as a coarse approximation of the human torso.
Thus, a 2-D parameterization of Ω is readily obtained via cylindrical coordinates.
C. Intraprocedural Motion Model Registration
In this paper, we assume that the patient is aligned w.r.t. the
preprocedural planning data. For existing approaches, we refer
to our prior work on motion-compensated alignment [19], [20]
or the motion-gated patient setup by Placht et al. [28].
For an aligned patient, we have to estimate the model parameter b such that the corresponding model instance P b fits the
instantaneous RI surface data S. However, directly using the
least-squares estimator from (4) is prohibitive. First, correspondences between the individual motion model components and
RI surface points are not known. Second, the least-squares estimator that drives the computation of b is not robust to outliers
caused by erroneous correspondences, partial surface matching
issues, and noise in the RI data.
1) Robust Alignment: A technique that inherently addresses
these issues is the coherent point drift (CPD) method [21]. The
CPD framework models a point set registration as a probability
density estimation problem with one point set representing the
centroids of a Gaussian mixture model (GMM) and the second
point set representing the data points. The registration is then
performed by reparameterizing the GMM centroids to minimize
the negative log-likelihood of the data points. This GMM-based
alignment scheme is solved by the expectation maximization
algorithm, eventually leading to an iterative weighted multilink
registration problem [21].
In contrast to the original CPD formulation, we do not quantify the alignment of the model instance P b and the instantaneous RI surface S based on point-to-point (P2P) distances but
instead use a point-to-tangent (P2T) metric. This is motivated
by the fact that the latter has shown superior performance in
terms of attraction range and convergence [29]. Our CPD-like
iterative optimization problem to be minimized is
	2


|S|
N 

xbn − y m · nm
CPD
b
p(xn |y m )
Jb,σ =
σ
n =1 m =1
(10)
|S|
N 

+
p(xbn |y m ) log(σ 2 )
n =1 m =1

with GMM centroids xbn ∈ P b ≡ pb = p + P b similar to (4).
Further, y m ∈ S denote the data points with associated surface normals nm ∈ N . The posterior probabilities p(xbn |y m )
of GMM centroids given the data points are computed using the
previous parameter estimates according to
 
2 	

(xbn −ym )·nm
exp −
σ
p(xbn |y m ) =

 
2 	
(xbk  −ym )·nm
+c
k =1 exp −
σ

N

(11)

Fig. 4. Surface neighborhood computation using PDA. For a test point x, its
closest points Sx ⊂ S are given via the local neighborhood Ω P (x) ⊂ Ω around
its projection P (x) ∈ Ω into the RI sensor domain Ω; cf., (1).

√
w N
where c = 2πσ 2 1−w
|S| with w ∈ [0, 1] to account for noise
and outliers. Symbols marked with a prime denote the previous
estimate [21]. As shown in Appendix A, minimizing (10) w.r.t.
b corresponds to a linear equation system that can be solved
efficiently by using Cholesky decompositions.
2) Fast CPD Approximation: A crucial issue with the CPD
formulation is run-time performance. Though the original work
reported significant speedups using the fast Gauss transform
[21], we found the CPD registration scheme computationally
too expensive for the real-time scenario at hand.
Inspired by the original work that also used truncated Gaussians [21], we thus propose an approximative scheme tailored
to RI data: for a given model point xbn , we do not use all
points y m ∈ S in (10) but only a small subset of closest points
y n ,m ∈ Sxbn ⊂ S; see Fig. 4. Similar to [21], we argue that this
is a valid approximation as the weights defined by the posteriors
and the kernel width rapidly decay with increasing distance. The
key step toward real-time computation is that for a point xbn , its
closest neighbors y n ,m ∈ Sxbn can be computed efficiently using a projective data association (PDA) scheme that is inherent
to our manifold ray casting technique outlined in Section II-B2.
The working principle of this multilink point correspondences
approach is illustrated in Fig. 4 and the mathematical formulation for the final approximated CPD alignment problem as well
as implementation aspects for real-time computation are given
in Appendix A.
III. EXPERIMENTS AND RESULTS
The experiments in this paper are concerned with two aspects.
First, we perform a thorough assessment of the methodology
inherent to our respiratory motion analysis framework. Second,
we compare the respiratory motion surrogates obtained with our
model-based approach to a respiration sensor that is independent
of surface motion.
A. Assessment of Methodology
The purpose of this experiment is to assess the general aspects
of the proposed respiratory motion analysis framework regarding 1) the ability of motion models to adapt to unseen surface
data, 2) the robustness of model registration in the presences of
outliers in RI data, 3) the suitability of motion models to generate low-dimensional respiration surrogates, and 4) the run-time
performance.

490

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Fig. 5. Exemplary depiction of a cropped and postprocessed reference RI
surface S s (left) and the training point set P 0 denoted as black dots with the
corresponding displacement field U s (right) color coded by the magnitude. (a)
RI surface S s . (b) Point set P 0 with U s .

1) Setup and Data: We captured RI data from four male
subjects S1 , . . . , S4 using two Microsoft Kinect RI sensors
(∼30 Hz, Ω1,2 = R640×480 ) with an acquisition distance of
∼1 m. For RI data fusion, we discretized the distance transform as Γ = R256×256×256 and the manifold domain for surface
reconstruction as Ω = R640×480 . To account for missing data
and noise, we performed postprocessing using normalized convolution and guided filtering similar to [30].
For training our 4-D motion model, the subjects were instructed to perform one cycle of thoracic and abdominal breathing, respectively. Each cycle was sampled with 1 Hz, which
corresponds to five to seven different respiration states for the
individual sequences; see Table IV in Appendix B for a detailed
listing. We purposely employed a sparse temporal sampling to
stress the fact that our method is generic in a sense that no
specific modality to capture surface data from different respiration states is required; cf., the beginning of Section II. For
example, 4-D tomographic planning data commonly provide a
limited number of different respiration states due to radiation
exposure with CT or binned reconstruction and acquisition time
with MRI.
The raw surfaces consist of approximately 350k 3-D points
and were cropped to a region of interest covering the torso,
subsequently decimated using a quadric edge collapse strategy
and finally smoothed using Laplacian smoothing. Again, the
motivation here is multimodality which requires the employed
algorithms to be robust w.r.t. different spatial sampling, mesh
topology and partial matching issues. The final surface meshes
consist of about 10k 3-D points to form the training point sets
P s ; see Fig. 5(a) for an illustration.
For computing the displacement fields U s to match different
respiration states, we represented all surfaces as distance transforms and used a volumetric nonrigid registration scheme based
on level-set motion [31]. The state of fully exhale was chosen
as reference P 0 . Fig. 5(b) exemplarily depicts a training point
set along with its displacement field.
We built the motion models with an intrinsic dimensionality
of L = 3 such that ≥ 99% of the variance is explained. The resulting cumulative normalized variances are listed in Table IV in
Appendix B. The importance of the third modes is considerably
lower than the first two modes and we retain them solely for
a consistent number of modes for all subjects. For respiratory
motion analysis, we focus on the two leading modes that are
depicted in Figs. 2 and 6.

Fig. 6. First two modes of variation for subjects S 1 , S 3 , and S 4 ; for S 2 ,
see Fig. 2. The magnitude of the individual respiratory motion displacements
in mm is color coded. Note that the proposed WVR scheme allows for an
classification of local thoracic and abdominal motion whereas conventional
PCA modes exhibit a global nature.

For testing, the subjects were asked to perform one cycle
of thoracic abdominal and two cycles of regular breathing. We
then analyzed the sequences at the full frequency of ∼30 Hz.
The corresponding number of frames are listed in Table IV in
Appendix B. In contrast to the training phase, neither cropping
nor mesh decimation nor Laplacian smoothing was applied.
2) Results: For model registration using (10), we set w =
0.99 and use a 5 × 5 PDA neighborhood Sxbn , i.e., each model
point xbn is connected to its 25 nearest neighbors y n ,m ∈ Sxbn .
The initial guess for the model parameter was set to b = 0. We
assume convergence of the iterative optimization scheme when
there are no considerable changes in the cost function, i.e.,
CPD
/JbCPD
|| < , where a prime denotes the estimates
|1 − |Jb,σ

,σ 
from the previous iteration. We set  = 10−2 .
a) Adaptability: We first assess our motion model’s ability to adapt to unseen respiration states. We quantify this by
the point-to-surface distance of registered
motion modelsto RI

surface data using EnM 2S = min xbn − y2 , y ∈ Sxbn ; cf.,
Fig. 4. This is an unbiased metric as it does not reflect the model
registration problem from (10) that relies on a P2T metric.
We compute the first (Q1 ), second (Q2 ), and third (Q3 ) quartiles of EnM 2S across all model points xbn . These quartiles are
then averaged across the individual breathing sequences [see
Fig. 7(a)]. For all subjects and respiration sequences, the median (Q2 ) distance is always below 1.0 mm. This is in the scale of
the noise level of the used RI sensor for an acquisition distance
of ∼1 m [32].
b) Robustness: To assess the robustness of our framework
in the presence of noise and outliers, we corrupt the RI data as

WASZA et al.: REAL-TIME RESPIRATORY MOTION ANALYSIS USING 4-D SHAPE PRIORS

491

TABLE I
PCCS BETWEEN CONVENTIONAL AND OUR MODEL-BASED SURROGATES FOR
SEQUENCES OF ABDOMINAL, THORACIC, AND REGULAR BREATHING PATTERNS
Thoracic

S1
S2
S3
S4

PCA
WVR
PCA
WVR
PCA
WVR
PCA
WVR

Abdominal

Regular

ρ PT C C

ρ PA C C

ρ PT C C

ρ PA C C

ρ PT C C

ρ PA C C

1.00
1.00
1.00
1.00
0.98
0.98
0.98
0.99

0.99
1.00
0.31
0.97
0.13
0.95
1.00
1.00

1.00
1.00
0.86
0.91
0.10
0.91
1.00
1.00

1.00
1.00
1.00
1.00
0.98
1.00
0.98
0.99

0.97
0.98
0.96
0.99
0.96
0.97
0.99
0.99

0.99
1.00
0.99
1.00
0.79
0.98
0.94
0.99

The subscripts j ∈ {A, T} denote the correlation between the conventional
surrogates s j and our model-based surrogates σ j for the abdominal (A) or
thoracic (T) mode, respectively. The evaluation further opposes the standard PCA
versus the proposed WVR approach. All coefficients are statistical significant
(p Pj C C ≤ 0.01).

Fig. 7. Model-to-surface distance and model differences in the presence of
outliers with robust (colored) and conventional least-squares (gray) estimators
for S 1 –S 4 (top to bottom). Shown are the first to third quartiles Q 1 –Q 3 averaged
across all frames for abdominal, thoracic, and regular breathing. (a) Model-tosurface distance. (b) Model-to-model difference.

R (i) = R(i) + Δri prior to computing the corresponding surface representation S  (i). The pixelwise offset Δri is drawn
from a standard normal distribution to simulate noise. For 25%
of the offsets which correspond to values of |Δri | > 1.15 mm
according to the standard normal distribution, an arbitrarily
selected multiplier using a factor of 5 is applied to simulate
outliers.
The hypothesis now is that a robust estimator is less sensitive
to corruptions. We quantify this using the pointwise model-to
model difference EnM 2M = xbn − xbn 2 , where xbn ∈ P b are
b
the points of the model P registered to the original RI surface



data S and xbn ∈ P b denotes a point of the model P b aligned
to the corrupted data S  .

The quartile differences EnM 2M across the entire surface averaged over the individual breathing sequences are depicted in
Fig. 7(b) for the conventional least-squares estimator from (4)
and the proposed robust CPD approximation from Section IIC1. The difference compared to the ground truth estimation is
substantially smaller with the robust approach and, except for
subject S4 with thoracic breathing, the median difference never
exceeds 0.2 mm.
c) Respiration Surrogates: For assessing our framework
to deliver respiration surrogates corresponding to distinct
anatomic motion, we use a conventional surface monitoring
technique to generate a baseline signal s = (sA , sT ) ∈ R2 encoding abdominal (A) and thoracic (T) surface motion. For this
purpose, we manually selected two circular regions Ωj ∈ Ω with
j ∈ {A,T} and a diameter of approximately 5 cm for each of
the subjects. The regions were placed at positions where we
expect the maximum respiration amplitude w.r.t. to thoracic
and abdominal motion, respectively. Similar to [15] and [16],
the respiratory motion signals sj are computed as the average distance 
of 3-D points to the camera center according to
sj = |Ωj |−1 i∈Ω j S(i)2 .
The Pearson correlation coefficients (PCCs) ρPCC
between
j
the baseline signal sj and the model based surrogates σj are
given in Table I. For the WVR model, we achieve a PCC not
less than 0.97. In contrast, the conventional PCA model often
fails to differentiate between distinct respiration patterns with
= 0.10 as with S3 . This is due to the global
PCCs down to ρPCC
T
nature of the conventional PCA modes. The global deformations
induced by a certain mode often must be corrected by a complementary mode in order to fit the surface data. This yields a score
on the model parameter bj governing the surrogate σj though
there is no anatomical equivalent. Due to its sparsity, the WVR
model does not suffer from this problem. Over all sequences,
subjects and surrogates we found a mean PCC of 0.91 for the
PCA and 0.98 for the WVR model.
d) Run-Time Evaluation: Our framework is designed for
real-time computation on modern GPU architectures. Besides

492

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

TABLE II
RUN-TIME EVALUATION OF THE PROPOSED FRAMEWORK
Fusion [ms]

S1
S2
S3
S4

5.1 ± 0.4
5.4 ± 0.5
5.6 ± 0.5
5.5 ± 0.5

CPD P2T

CPD P2P

Iterations

Run-time [ms]

Iterations

Run-time [ms]

15.8 ± 5.5
9.67 ± 1.4
12.1 ± 3.1
14.6 ± 6.1

18.5 ± 5.5
12.2 ± 1.8
15.6 ± 3.6
16.2 ± 5.8

29.1 ± 3.6
34.0 ± 5.3
32.2 ± 8.1
37.8 ± 6.2

28.9 ± 3.5
33.9 ± 4.9
33.0 ± 7.6
37.2 ± 5.8

Evaluated is the multiview RI data fusion with surface reconstruction (cf., Section II-B)
and the model registration using our P2T opposed to conventional P2P approximated CPD
schemes (cf., Section II-C).

the real-time capability of multiview RI reconstruction in Section II-B that we demonstrated in preceding work [20], the
approximated CPD framework outlined in Section II-C1 can be
computed efficiently on GPU architectures. We implemented
the framework using the CUDA programming model. The evaluation is performed on a PC equipped with an Intel Core i7
3770K CPU and an NVIDIA GTX 680 GPU.
The run-times for the different steps of our framework are
given in Table II. For multiview RI data fusion and surface reconstruction from Section II-B with subsequent postprocessing,
we achieve steady run-times of ∼5.5 ms. In contrast, the runtimes for the motion model registration show more variations
due to the fact that more iterations are required for instantaneous
respiration states that are considerably different from the initial
guess. For our point-to-tangent metric (CPD P2T), we require 13
iterations in average which corresponds to ∼16 ms. For comparison, the conventional point-to-point metric (CPD P2P) requires
33 iterations and ∼33 ms. In conclusion, our framework (CPD
P2T) achieves run-times of about 20 ms or 50 Hz.
B. Comparison to Established Respiration Sensor
This experiment is concerned with a comparison of the respiratory motion surrogates obtained from our WVR model and an
established baseline respiration sensor that does not rely on body
surface deformations but instead directly measures the change
of lung volume.
1) Setup and Data: For this experiment, data from three additional subjects S5 –S7 were collected. As baseline, we use a
PMM2 sensor (Siemens Healthcare, Erlangen, Germany) which
uses the measurement principle of impedance pneumography
(IP). The IP sensor sends high-frequency current through biopotential electrodes that are attached to the left and right sides of
the thorax and the side of the belly. Based on the change of
impedance caused by the change of lung volume, a 1-D respiration signal was obtained at 250 Hz.
Simultaneously, RI surface data were acquired with two Asus
Xtion PRO RI sensors with a frame-rate of ∼30 Hz and a resolution of Ω1,2 = R320×240 . The same multiview fusion, preprocessing, model generation, and registration methods as in
Section III-A were used. To match the RI frame rate, the IP
signal was uniformly downsampled to 30 Hz.
Similar to the experiments in Section III-A, the subjects were
asked to perform free abdominal and thoracic breathing to train

Fig. 8. Qualitative visualization of the IP signal σ IP compared to the joint
(σ J ), thoracic (σ T ), and abdominal (σ A ) model-based RI surrogates for subject S5 and different respiration patterns. The signals divide into abdominal
(P1 ), thoracic (P2 ), fast shallow (P3 ), fast strong (P4 ), slow shallow (P5 ),
slow strong (P6 ), and breath hold (P7 ) breathing instructions. For visualization, the IP signal is scaled to [min(σ IP ), max(σ IP )] and the RI surrogates to
[min(σ J , σ T , σ A ), max(σ J , σ T , σ A )].

our 4-D motion model; see Table V in Appendix B for a detailed
listing of the number of training samples and properties of the
proposed WVR model.
For testing, we use a protocol that specifies predefined breathing instructions over a period of about 7 min which resulted in
approximately 12k respiration measurements. First, abdominal
and thoracic breathing patterns were to be performed with a
duration of about 60 s, each. Subsequently, the subjects were instructed to breath at fixed frequencies of 0.5 and 0.17 Hz. These
phases subdivide into shallow and strong breathing where the
duration was set to approximately 30 s for fast, and about 60 s
for slow breathing. Finally, breath-holds with a duration of 15 s,
each, were to be performed over a period of approximately 120 s.
The resulting number of frames that were used for evaluation
are detailed in Table V in Appendix B.
Though being acquired simultaneously, the RI surrogates and
the IP signal exhibited a temporal shift caused by bus and driver
latencies. To bring both signals into congruence, we phasewise
estimated the shift that maximizes the correlation coefficient
between the shifted IP signal and the RI surrogate σJ,A,T from (5).
The rationale behind this alignment scheme is that the temporal
shift is not uniform across the entire evaluation period and that
at least one RI surrogate is supposed to explain the IP signal
within a localized window.
2) Results: Fig. 8 exemplarily depicts the registered IP signal and the proposed model-based RI surrogates for one of the
subjects over the entire evaluation period. Noticeable are the
distinct breathing instructions and varying degrees of correlation between the IP signal and the model-based surrogates. This
is most distinct for phase P2 where the abdominal surrogate σA
contradicts the IP sensor regarding both signal scale and shape
whereas the thoracic surrogate σT follows the IP signal.
For quantification, we first computed the PCCs between the
shifted IP signal and our respiration surrogates for the individual

WASZA et al.: REAL-TIME RESPIRATORY MOTION ANALYSIS USING 4-D SHAPE PRIORS

493

TABLE III
PCCS BETWEEN THE SHIFTED IP SENSOR SIGNAL AND OUR WVR SURROGATES FOR PHASES OF DIFFERENT BREATHING PATTERNS AND ACROSS
ALL RESPIRATION SAMPLES

The subscripts j ∈ {J, A, T} denote the correlation of the IP signal w.r.t. the joint (σ J ), abdominal (σ A ) and thoracic (σ T ) WVR model surrogates. The evaluation phases divide
into abdominal (P 1 ), thoracic (P 2 ), fast shallow (P 3 ), fast strong (P 4 ), slow shallow (P 5 ), slow strong (P 6 ), and breath hold (P 7 ) breathing instructions; cf., Fig. 8. The surrogate
yielding the best correlation to estimate the signal shift is highlighted.

sequences Pi . The results are listed in Table III . For the joint
≥ 0.97 for
signal σJ , an average PCC of 0.96 ± 0.04 with ρPCC
J
19 out of 21 evaluations and a minimum of 0.92 was found across
the individual phases and subjects. In contrast, the thoracic and
abdominal surrogates show substantial variations regarding the
correlation with the IP signal and an average PCC of 0.79 ±
0.35 and 0.84 ± 0.28 for the abdominal and thoracic surrogate,
respectively. Here, the most prominent results are for subject S6
and phase P1 where there is no correlation in the thoracic mode
= −0.04) but a very strong correlation in the abdominal
(ρPCC
T
= 0.97).
part (ρPCC
A
These results show that an RI-based respiratory motion analysis regarding change of lung volume requires surrogates based
on distinct spatially localized surface displacements as well as
their superposition. However, which surrogate best correlates to
the IP signal depends on the breathing pattern and the subject.
This is no flaw in our model-based respiration analysis formulation but instead indicates that the 1-D IP signal as a measure
of lung volume change is not capable to describe the entire
spectrum of surface deformations.
As an overall performance metric, we computed the PCCs
across the entirety of available breathing samples. This avoids
any bias that might occur in the phasewise correlation. Here, we
found PCCs of 0.93–0.96 for the joint, 0.93–0.99 for the thoracic, and 0.16–0.90 for the abdominal surrogates. Compared
to the phasewise evaluation, the performance of the joint signal slightly decreased, whereas the thoracic surrogate shows a
higher correlation w.r.t. the IP signal. This effect is solely due
to the mathematical foundations of the PCC.

IV. CONCLUSION AND FUTURE WORK
We proposed a real-time respiratory motion analysis framework that uses preprocedurally trained 4-D shape priors to drive
intraprocedural RI-based respiration analysis. As the major contribution, we presented a sparse motion model that allows for an
unsupervised differentiation of thoracic and abdominal breathing. For intraprocedural respiration analysis, we presented a
robust and fast method to register our motion model to body
surface data computed from multiview RI.
Our model-based formulation allows us to derive anatomically plausible low-dimensional respiration surrogates encoding
surface extents for different body regions. Compared to existing
RI-based respiration analysis approaches, our method is not intrusive, does not rely on heuristic surface partitioning, and does
not require manual interaction.

One key finding of our work is that motion models can be
constructed using PCA with a small number of variation modes.
We showed that respiration induced surface deformations can
be reconstructed by model-based dense abdominal and thoracic
displacement fields with a median error < 1.0 mm. This indicates that such body surface deformations are governed by only
two factors and that displacements in different thoracic (or abdominal) regions can be inferred from each other. In this regard,
we found a statistically significant PCC of 0.98 between our
model-based surrogates and conventional surrogates encoding
thoracic and abdominal movement.
Regarding practical aspects, we demonstrated the robustness
and efficiency of an approximative model registration scheme
extending the CPD by a P2T metric. Compared to conventional
P2P metrics, we require half of the number of iterations resulting
in run-times of ∼50 Hz for a GPU-based implementation.
Compared to IP as an intrusive and fundamentally different
respiration measurement principle, our model-based surrogates
yield a PCC ≥ 0.93 across seven different breathing phases
covering a period of about 7 min with ∼12k respiration samples. For the individual phases, we showed the varying degree
of correlation of surrogates based on abdominal, thoracic, or
superimposed body surface deformations.
Especially, the results from the last experiment raise the question whether external respiration surrogates or direct internal
signals are more suited for respiration analysis. This is of particular importance when the surrogates or signals are used to
predict internal target movement. However, this aspect is not
within the scope of this paper and must be addressed in future
research that also must be concerned with the evaluation of our
proposed respiratory motion analysis framework in a clinical
setting. This includes both the evaluation on nonhealthy subjects as well as the integration into clinical workflows.
APPENDIX A
MULTILINK MODEL-TO-TANGENT DISTANCE
As both the posteriors p(xbn |y m ) from (11) and the kernel width σ are constants when optimizing (10) w.r.t. b,
we define αn ,m = σ −2 p(xbn |y m ). We expand (10) using the
modes of variation el columnwise contained in P = (pi,j ) and
b = (b1 , . . . , bL ) pointwise as

JbCPD

=

|Sn |
N 

n =1 m =1

αn ,m

 L

l=1

	
bl el,n − y n ,m

	2
· nn ,m

494

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

where el,n = (p3·(n −1)+1,l , p3·(n −1)+2,l , p3·(n −1)+3,l ) and
y n ,m ∈ Sxbn are the nearest neighbors for the nth point in our
approximated CPD framework; cf., Section II-C2. Computing
the partial derivative of Jb w.r.t. one specific motion model
parameter bk and equating to zero yields
|Sn | L
N 



!

αn ,m bl ηl,n ,m ηk ,n ,m =

n =1 m =1 l=1

|Sn |
N 


αn ,m ζm ηk ,n ,m

n =1 m =1

where ηl,n ,m = el,n · nn ,m and ζm = y n ,m · nn ,m . For the
vector b, this can be written using matrix-vector notation as
⎛
⎞
η1,n ,m η1,n ,m · · · η1,n ,m ηL ,n ,m
|Sn |
N 
⎜
⎟

⎜
⎟
..
..
..
αn ,m ⎜
⎟b
.
.
.
⎝
⎠
n =1 m =1

ηL ,n ,m η1,n ,m
⎛
⎞
ζm η1,n ,m
|Sn |
N 
⎜
⎟

⎜
⎟
..
=
αn ,m ⎜
⎟.
.
⎝
⎠

···

ηL ,n ,m ηL ,n ,m

APPENDIX B
DETAILED DATA SPECIFICATION
TABLE IV
DATA FOR METHODOLOGY ASSESSMENT IN SECTION III-A
Training

S1
S2
S3
S4

6
6
5
7

5
6
5
6

0.76
0.72
0.53
0.84

(0.79)
(0.76)
(0.67)
(0.85)

Testing
λ2

0.98
0.99
0.98
0.96

(0.98)
(0.99)
(0.98)
(0.96)

S5
S6
S7

7
7
7

6
6
6

λ1

λ2

λ3

0.64 0.93 0.97
0.87 0.97 0.99
0.50 0.94 0.97

|P1 | |P2 | |P3 | |P4 | |P5 | |P6 | |P7 |
1.6
1.6
1.5

1.5
1.6
1.6

0.9
0.8
0.9

0.9
0.8
0.8

1.5
1.5
1.6

1.6
1.7
1.5

3.4
3.4
3.3

Shown are the number of frames in the thoracic (T) and abdominal (A) training sequences
and the resulting WVR model variances λi (cf., Table IV). For the testing stage, the number
of frames in phases with predefined respiration patterns P1 –P7 are listed (cf., Section III-B1
and Fig. 8).

ACKNOWLEDGMENT

REFERENCES

This is a linear equation system in the form Ab = c, where the
symmetric matrix A ∈ RL ×L is positive definite for weights
and diagonal elements > 0. By definition, αn ,m > 0; cf., (11).

|Sn | 2
Further, N
m =1 ηl,n ,m ≥ 0. These scalars are zero iff all
n =1
motion model directions el,n are perpendicular to the corresponding normals nn ,m . Thus, all points would move parallel
to the surface which is an invalid degenerated model.
Regarding real-time aspects, we note that (12) essentially
breaks down to the summation of matrices. This problem can
be calculated very efficiently on GPU architectures using treebased parallel reduction techniques [33].
For efficient nearest neighbor computation, we represent the
RI surface S as a multichannel 2-D texture where the individual
channels hold the x, y, and z coordinates, respectively. For a
point xbn , the closest points y n ,m ∈ Sxbn are then obtained by
texture lookups w.r.t. the index neighborhood Ωxbn ; cf., Fig. 4.
This scheme exploits the cache layout of GPU textures being
designed for spatial locality in an index-based sense.

λ1

|T| |A|

(12)

ζm ηL ,n ,m

|A|

Testing (|Pi | · 10 3 )

Training

The authors would like to thank Metrilus GmbH, Erlangen,
Germany, for providing the camera equipment and the calibration framework used in the IP experiment of this work.

n =1 m =1

|T|

TABLE V
DATA FOR THE IP SENSOR EXPERIMENT IN SECTION III-B

λ3
0.99
0.99
0.99
0.99

(0.99)
(0.99)
(0.99)
(0.99)

|T|

|A|

|R|

167
118
235
89

112
122
156
168

272
324
354
328

Listed are the number of frames in thoracic (T), abdominal (A), and regular (R)
breathing sequences. For the training stage, the normalized cumulative variances λi =
3
i
s = 1 λs /
s = 1 λs are reported. Plain values denote the proposed WVR model and
bracketed values denote conventional PCA.

[1] C. Bert and M. Durante, “Motion in radiotherapy: Particle therapy,” Phys.
Med. Biol., vol. 56, no. 16, pp. R113–R144, 2011.
[2] S. S. Korreman, “Motion in radiotherapy: Photon therapy,” Phys. Med.
Biol., vol. 57, no. 23, pp. R161–R191, 2012.
[3] H. Hof et al., “Stereotactic single-dose radiotherapy of stage I nonsmallcell lung cancer (NSCLC),” Int. J. Radiation Oncol. Biol. Phys., vol. 56,
no. 2, pp. 335–341, 2003.
[4] P. J. Keall et al., “The management of respiratory motion in radiation
oncology report of AAPM Task Group 76a,” Med. Phys., vol. 33, no. 10,
pp. 3874–3900, 2006.
[5] D. Verellen et al., “Gating and tracking, 4D in thoracic tumours,” Cancer/Radiothérapie, vol. 14, no. 67, pp. 446–454, 2010.
[6] T. Willoughby et al., “Quality assurance for nonradiographic radiotherapy
localization and positioning systems: Report of task group 147,” Med.
Phys., vol. 39, no. 4, pp. 1728–1747, 2012.
[7] J. McClelland et al., “Respiratory motion models: A review,” Med. Image
Anal., vol. 17, no. 1, pp. 19–42, 2013.
[8] A. Fassi et al., “Tumor tracking method based on a deformable 4D CT
breathing motion model driven by an external surface surrogate,” Int. J.
Radiation Oncol. Biol. Phys., vol. 88, no. 1, pp. 182–188, 2014.
[9] S. Bauer et al., “Marker-less reconstruction of dense 4-D surface motion
fields using active laser triangulation for respiratory motion management,”
in Proc Med. Image Comput. Comput.-Assist. Interv., 2012, pp. 414–421.
[10] G. J. Price et al., “Real-time optical measurement of the dynamic body
surface for use in guided radiotherapy,” Phys. Med. Biol., vol. 57, no. 2,
pp. 415–436, 2012.
[11] B. L. Lindl et al., “Topos: A new topometric patient positioning and
tracking system for radiation therapy based on structured white light,”
Med. Phys., vol. 40, no. 4, p. 042701, 2013.
[12] C. Schaller et al., “Time-of-flight sensor for respiratory motion gating,”
Med. Phys., vol. 35, no. 7, pp. 3090–3093, 2008.
[13] H. Fayad et al., “A patient specific respiratory model based on 4D CT
data and a time of flight camera (TOF),” in Proc IEEE Nucl. Sci. Symp.
Conf. Rec., 2009, pp. 2594–2598.
[14] S. Hughes et al., “Assessment of two novel ventilatory surrogates for
use in the delivery of gated/tracked radiotherapy for non-small cell lung
cancer,” Radiotherapy Oncol., vol. 91, no. 3, pp. 336–341, 2009.
[15] H. Fayad et al., “Technical note: Correlation of respiratory motion between external patient surface and internal anatomical landmarks,” Med.
Phys., vol. 38, no. 6, pp. 3157–3164, 2011.
[16] J. Xia and R. A. Siochi, “A real-time respiratory motion monitoring system
using kinect: Proof of concept,” Med. Phys., vol. 39, no. 5, pp. 2682–2685,
2012.
[17] J. Schaerer et al., “Multi-dimensional respiratory motion tracking from
markerless optical surface imaging based on deformable mesh registration,” Phys. Med. Biol., vol. 57, no. 2, pp. 357–373, 2012.
[18] D. Spinczyk et al., “Methods for abdominal respiratory motion tracking,”
Comput. Aided Surg., vol. 19, no. 1-3, pp. 34–47, 2014.

WASZA et al.: REAL-TIME RESPIRATORY MOTION ANALYSIS USING 4-D SHAPE PRIORS

[19] J. Wasza et al., “Real-time motion compensated patient positioning and
non-rigid deformation estimation using 4-D shape priors,” in Proc Med.
Image Comput. Comput.-Assist. Interv., 2012, pp. 576–583.
[20] J. Wasza et al., “Real-time respiratory motion analysis using manifold
ray casting of volumetrically fused multi-view range imaging,” in Proc
Med. Image Comput. Comput.-Assist. Interv., 2013, pp. 116–123.
[21] A. Myronenko and X. Song, “Point set registration: Coherent point drift,”
IEEE Trans. Pattern Anal. Mach. Intell., vol. 32, no. 12, pp. 2262–2275,
Dec. 2010.
[22] O. Taubmann et al., “Prediction of respiration-induced internal 3-D deformation fields from dense external 3-D surface motion,” in Proc. 28th
Int. Congr. Exhib., 2014, pp. 33–34.
[23] R. O. Duda et al., Pattern Classification, 2nd ed. New York, NY, USA:
Wiley-Interscience, 2000.
[24] H. Kaiser, “The varimax criterion for analytic rotation in factor analysis,”
Psychometrika, vol. 23, no. 3, pp. 187–200, 1958.
[25] J. Wasza et al., “Sparse principal axes statistical surface deformation models for respiration analysis and classication,” in Proc. Bildverarbeitung für
die Medizin (BVM), 2012, pp. 316–321.
[26] M. B. Stegmann et al., “Sparse modeling of landmark and texture variability using the orthomax criterion,” Proc SPIE, vol. 6144, pp. 61441G.1–
61441G.12, 2006.
[27] B. Curless and M. Levoy, “A volumetric method for building complex
models from range images,” in Proc. 23rd Ann. Conf. Comput. Graph.
Interactive Techn., 1996, pp. 303–312.

495

[28] S. Placht et al., “Fast time-of-flight camera based surface registration for
radiotherapy patient positioning,” Med. Phys., vol. 39, no. 1, pp. 4–17,
2012.
[29] S. Rusinkiewicz and M. Levoy, “Efficient variants of the ICP algorithm,”
in Proc. Int. Conf. 3-D Digital Imag. Model., 2001, pp. 145–152.
[30] J. Wasza et al., “Real-time preprocessing for dense 3-D range imaging on the GPU: Defect interpolation, bilateral temporal averaging and
guided filtering,” in Proc. IEEE Int. Conf. Comput. Vis. Workshops, 2011,
pp. 1221–1227.
[31] B. Vemuri et al., “Image registration via level-set motion: Applications
to atlas-based segmentation,” Med. Image Anal., vol. 7, no. 1, pp. 1–20,
2003.
[32] J. Smisek et al., “3D with kinect,” in Proc. IEEE Int. Conf. Comput. Visi.
Workshops, 2011, pp. 1154–1160.
[33] M. Harris et al., “Parallel prefix sum (Scan) with CUDA,” in GPU Gems
3, Reading, MA, USA: Addison Wesley, Aug. 2007.

Authors’ photographs and biographies not available at the time of publication.

