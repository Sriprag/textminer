582

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Cardiac Fiber Unfolding by
Semidefinite Programming
Hongying Li∗ , Marc C. Robini, Member, IEEE, Feng Yang, Isabelle Magnin, and Yuemin Zhu

Abstract—Diffusion-tensor imaging allows noninvasive assessment of the myocardial fiber architecture, which is fundamental in
understanding the mechanics of the heart. In this context, tractography techniques are often used for representing and visualizing
cardiac fibers, but their output is only qualitative. We introduce
here a new framework toward a more quantitative description of
the cardiac fiber architecture from tractography results. The proposed approach consists in taking three-dimensional (3-D) fiber
tracts as inputs, and then unfolding these fibers in the Euclidean
plane under local isometry constraints using semidefinite programming. The solution of the unfolding problem takes the form of a
Gram matrix which defines the two-dimensional (2-D) embedding
of the fibers and whose spectrum provides quantitative information
on their organization. Experiments on synthetic and real data show
that unfolding makes it easier to observe and to study the cardiac
fiber architecture. Our conclusion is that 2-D embedding of cardiac fibers is a promising approach to supplement 3-D rendering
for understanding the functioning of the heart.
Index Terms—Cardiac imaging, diffusion-tensor imaging, dimensionality reduction, semidefinite programming, tractography.

I. INTRODUCTION
HE human myocardium is composed of branched myocytes which are approximately 25 μm in diameter and
100 μm in length, and which are attached to each other by
intercalated disks. Therefore, contrary to brain white matter tissue, the myocardium does not contain so-called “fibers” at the
microscopic scale. However, cardiac myocytes form elongated
structures with a preferential local orientation, which are often regarded as fibers (or bundles of fibers) at coarse scales.
The notion of cardiac fibers has been used since the end of the
19th century to study the structure of the myocardium [1]–[11],
and cardiac fiber organization is fundamental in understanding
the functioning of the heart [12], [13]. More recently, the existence of fiber patterns in the myocardium has been further confirmed by diffusion-tensor imaging (DTI) [14]; this technique
measures water diffusion in the myocardium region and allows

T

Manuscript received April 13, 2014; revised August 8, 2014; accepted
September 18, 2014. Date of publication September 29, 2014; date of current version January 16, 2015. This work was supported by the French ANR
under ANR-13-MONU-0009-01. Asterisk indicates corresponding author.
∗ H. Li is with the CREATIS, 69621 Villeurbanne cedex, France (e-mail:
lihongying17@gmail.com).
M. C. Robini, I. Magnin, and Y. Zhu are with the CREATIS, 69621 Villeurbanne cedex, France (e-mail: marc.robini@creatis.insa-lyon.fr; isabelle.magnin@creatis.insa-lyon.fr; zhu@creatis.insa-lyon.fr).
F. Yang is with the Department of Biomedical Engineering, Beijing JiaoTong
University, 100044 Beijing, China (e-mail: feng.yang@bjtu.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2360797

Fig. 1. Fiber tracts obtained from human cardiac DTI data (superimposed on
the B0 volume). The tracts are located in the left ventricle and pass through the
voxel pointed by the red arrow.

noninvasive assessment of the human myocardial architecture
[15]–[21]. In cardiac DTI, tractography produces a set of threedimensional (3-D) curves which represent the paths followed
by myocardial fibers, thereby facilitating the high-level perception of the fiber architecture of the heart (the fibers are usually
interpreted visually from 3-D rendering with a coloring scheme
based on curve features such as local tangent directions [22]).
The helical pattern of cardiac fibers can be successfully reconstructed from DTI tractography results [23], [24], but tractography is usually regarded as the final stage in representing the
cardiac fiber architecture. In fact, up to now, few studies have
focused on the quantitative description of fiber tracts, whether
cardiac or neuronal. In [25], a clustering methodology was proposed to find correspondences across a fiber population obtained
from cardiac DTI data. In [26] and [27], the authors used computational techniques to quantify and compare the shape of fibers
in the human brain. Finally, clustering approaches to classifying
white matter fiber bundles were reported in [28] and [29].
We present here a framework for unfolding cardiac fibers in
order to facilitate the description of their architecture. Our approach consists in taking 3-D fiber tracts as inputs, unfolding
them in the Euclidean plane, and extracting quantitative parameters from the resulting two-dimensional (2-D) embedding. This
new type of representation makes it easier to observe the relative
positions of the fibers and allows a more accurate assessment
of their organization. To motivate our idea, Fig. 1 displays four
cardiac fiber tracts with the B0 volume in the background. These
fibers pass through a same point, but even though they are few,
their organization is difficult to apprehend.

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

LI et al.: CARDIAC FIBER UNFOLDING BY SEMIDEFINITE PROGRAMMING

(p )

(p )

583

(p )

Fig. 2. Fiber tract X (p ) = (x −m p , . . . , x 0 , . . . , x n p ) is represented by a
finite sequence of points. The distance between two adjacent points is a constant
δ called the step-length.

We propose to unfold the fiber tracts using a nonlinear dimensionality reduction technique (see [30], [31] for an overview)—
namely, semidefinite embedding [32]—which positions data
points as far apart as possible under local distance constraints.
More precisely, each fiber is sampled at regular intervals, and
the resulting points are placed in the Euclidean plane by maximizing the sum of the squared distances between pairs of points
connected in a fiber-isometry graph. This graph is constructed
to reflect likely similarities between neighboring fibers, and the
optimization is performed by semidefinite programming (SDP).
The solution of the SDP problem takes the form of a Gram matrix
from which the embedded fibers are obtained by diagonalization, and whose spectrum provides quantitative information on
fiber organization. In particular, the ratio of the second to the
third largest eigenvalues measures the closeness of the 3-D input
fibers to a 2-D manifold, and the ratio of the second to the first
largest eigenvalues measures the dispersion of the fibers within
the embedding. This leads to the definition of two quantitative
indices on fiber organization: embedding accuracy (EA) and
fiber dispersion (FD).
This paper is organized as follows. In Section II, we describe
the methodology of unfolding, which includes the representation
of fibers, the definition of suitable distance and neighborhoods
for isometry constraints, and the formulation in terms of SDP.
Section III is devoted to experimental results on synthetic data
and real human cardiac data. A brief discussion and concluding
remarks are given in Section IV.

Fig. 3. Spiral-shaped fibers before and after unfolding: (a) fiber points in the
yellow region are close to each other in the sense of the Euclidean distance in
(2 )
(2 )
space; (b) in the embedding, the image point y k of x k is distant from the
other image points.

(p)

(p)

The distance between two adjacent points xi and xi+1 in a
same fiber X(p) is a constant δ > 0 which we call the steplength.
For simplicity, we will sometimes drop the superscript indi(p)
cating the fiber number. In this case, a point xi is denoted by
xm with
⎧
if p = 1
⎪
⎨ i + mp + 1, p−1

m=
(4)
(mj + nj ), if p > 1.
⎪
⎩ i + mp + p +
j =1

In other words, (x1 , . . . , xN ) is the ordering of the set of all
fiber points obtained by concatenating X(1) , . . . , X(P ) .

II. METHODOLOGY
B. Fiber Isometry

A. Fiber Representation
Fibers are represented by finite sequences of points, as shown
in Fig. 2. Given an ordering of the fibers, we denote the pth
fiber by

 (p)
(p)
X(p) = x−m p , . . . , x0 , . . . , x(p)
(1)
np
(p)

where mp and np are positive integers, and x0 is called the
reference point of the fiber. The set of all fiber points is
X=

P


np


(p)

{xi }

(2)

p=1 i=−m p

where P is the number of fibers. We let N denote the total
number of points in X, that is,
N=

P

p=1

(mp + np + 1).

(3)

A map f from a metric space (E, dE ) to another metric space
(F, dF ) is called an isometry if dF (f (a), f (b)) = dE (a, b) for
all (a, b) ∈ E 2 . To extend the notion of isometry to fibers points,
we must give a meaning to distance preservation for a one-to-one
correspondence between the set of fiber points X ⊂ R3 and an
embedding Y = {y1 , . . . , yN } of X in the Euclidean plane. To
do so, we equip Y with the standard Euclidean norm (which we
simply denote by  · ), and we define a distance function dX on
X that reflects our knowledge about cardiac fiber organization
(see Section II-D). In particular, dX should discriminate pairs
of nearby points in a same fiber from pairs of nearby points in
different fibers. This is illustrated in Fig. 3. The four points in
the yellow region in Fig. 3(a) are close in terms of the Euclidean
(2)
distance in space, but in the embedding, the image point yk of
(2)
xk is distant from the other three image points; so in terms of
(1)
(2)
(2)
dX , the fiber points xi , xi and xj should be close to each
(2)

other and distant from xk .

584

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

C. Fiber Unfolding

E. Construction of the Adjacency Matrix

Given a set {X , . . . , X } of sequential cardiac fibers
in R3 , unfolding embeds the X(p) ’s in the Euclidean plane
to supplement the description of their organization. The oneto-one correspondence between the set of fiber points X and
its embedding Y is obtained by “stretching” the fibers (that
is, by maximizing the sum of the squared distances between
pairs of points) while preserving neighborhood relationships
defined in terms of dX . Formally, the optimization problem is
the following:
(1)

maximize

(P )

N


ym − yn 2

m ,n =1

subject to am n ym − yn  = am n xm − xn 

(5)

where the am n ’s are the binary coefficients of an adjacency
matrix A designed to preserve fiber features such as arc-length
along a same fiber and isometry between adjacent fibers. The
construction of A is detailed in Section II-E; it involves the
distance dX defined below.
D. Distance Between Fiber Points
The definition of dX is not straightforward because 3-D cardiac fibers have a somewhat spiral shape. In a nutshell, the
distance we propose moves two fiber points away if they do not
belong to a same local fiber-bundle region. By way of illustration, referring back to Fig. 3, the idea is to put a large distance
(2)
between xk and the three other fiber points.
(p)
(p)
The natural distance between two points xi and xj in
a same fiber X(p) is the fiber-length between them; so we let
(p)
(p)
dX (xi , xj ) be the length of a polygonal chain approximating
X(p) between these two points:
(p)

(p)

dX (xi , xj ) = |j − i|δ

(6)

The purpose of the N × N adjacency matrix A = [am ,n ] is
to relax the distance constraints that are not tied to cardiac fiber
organization. The coefficients of A are defined by

1, if xn ∈ Nk (xm ) and xm ∈ Nk (xn )
am n =
(9)
0, otherwise
where {Nk (x1 ), . . . , Nk (xN )} is a collection of structural
neighborhoods which can be interpreted as local fiber bundle
regions, and where the integer k  3 is a size parameter which
fixes the number of points in the neighborhoods and thus controls local isometry. If k is set to its minimum value (that is,
k = 3), the distance constraints between pairs of points in different fibers are relaxed, and hence the original local structure
is lost in the unfolding process. Increasing k reinforces the distance constraints and widens their range, which makes it harder
to flatten the original 3-D structure. In the present study, the
value of k is chosen so that the neighborhoods involve three
to six fibers (more details are given in the experimental and
discussion sections).
The neighborhoods Nk (xm ) are constructed in the following
three steps:
(p)
(p)
1) For every fiber point xi , we let S(xi ) be the set of
fiber points whose elements are
(p)
(p)
(p)
a) xi and its nearest neighbors xi−1 and xi+1 in the pth
fiber (it being understood that there is only one nearest
neighbor if i = −mp or np )
(p)
b) the three nearest neighbors of xi with respect to dX in
(q )
(q )
each fiber X(q ) (q = p), that is, the fiber points xi 1 , xi 2
(q )

and xi 3 such that

 (p) (q ) 
max dX xi , xi j

j ∈{1,2,3}

 min
(q )

<

x∈X ( q ) \
(p)

for all p ∈ {1, . . . , P } and all i, j ∈ {−mp , . . . , np }. If xi and
(q )
xj do not belong to a same fiber, we extend this definition by
setting


2  (p,q ) 2
(p)
(q )
|j − i|δ + di,j
(7)
dX (xi , xj ) =
where |j − i|δ is to be interpreted here as the arc-length between
(p)
(q )
the local fiber-bundle regions containing xi and xj , and
(p,q )

where di,j is the mean distance between the pth and qth fibers
at points i and j, that is,
(p,q )

di,j

 (p)
1  (p)
(q ) 
(q ) 
= xi − xi  + xj − xj  .
2

(8)

It should be stressed that dX is not the Euclidean distance
between two points (except for successive points in a same
fiber) and that it depends on the choice of the reference points
(1)
(P )
x0 , . . . , x0 . This distance has intuitive appeal if the reference
points are located in a small region of interest which we call the
reference region.

(q )
(q )
x i ,x i ,x i
1
2
3

(p)

 dX (xi , x).

(10)

(p)

Therefore, S(xi ) contains either 3P − 1 or 3P fiber
(p)
points depending on whether xi is a fiber extremity or
not.
2) Since S = {S(x1 ), . . . , S(xN )} is not symmetric in
the sense that xn ∈ S(xm ) does not necessarily imply that xm ∈ S(xn ), we introduce the symmetrization
{S † (x1 ), . . . , S † (xN )} of S defined by
S † (xm ) = S(xm ) ∪ {xn ∈ X | xm ∈ S(xn )}

(11)

for all m ∈ {1, . . . , N }.
3) Finally, we adjust the range of the local isometry constraints by restricting the symmetrization of S to neighborhoods of size at most k + 1. More precisely, if S † (xm )
has more than k + 1 elements, we define the structural
neighborhood Nk of xm to be the union of xm with its k
nearest neighbors in S † (xm ) with respect to dX :
Nk (xm ) = {xm } ∪ {xm ,1 , . . . , xm ,k }

(12)

LI et al.: CARDIAC FIBER UNFOLDING BY SEMIDEFINITE PROGRAMMING

∗
∗
λ1  · · ·  λN  0. The coefficients gm
n of G are given by

where xm ,1 , . . . , xm ,k ∈ S † (xm ) \ {xm } are such that
max dX (xm , xm ,l )

∗
gm
n =

l∈{1,...,k }

<

min

x∈S † (x m )\Nk (x m )

dX (xm , x).

(13)

If S † (xm ) has no more than k + 1 elements, then we simply set
Nk (xm ) = S † (xm ).
F. Solving the Unfolding Problem by SDP
Given a set Y = {y1 , . . . , yN } of points in the Euclidean
plane, we let G = [gm n ] be the Gram matrix of Y; that is,
gm n = ym · yn (the standard inner product of ym and yn )
for every (m, n) ∈ {1, . . . , N }2 . Then, since ym − yn 2 =
gm m − 2gm n + gn n , the constraints of the unfolding problem
(5) are equivalent to
am n (gm m − 2gm n + gn n ) = am n xm − xn 2 .

(14)

The unfolding problem has a translational degree of freedom:
∗
∗
} is a solution, then so is {y1∗ + a, . . . , yN
+ a}
if {y1∗ , . . . , yN
for any 2-D point a. To obtain a single solution,
we add the
constraint that Y be centered on the origin, that is, n yn = 0,
or equivalently,

gm n = 0
(15)
m ,n


2
(this
 equivalence follows from the fact that  n yn  =
m ,n ym · yn ). The constraint (15) also allows to express the
objective function of the unfolding problem in terms of the trace
of G:


ym − yn 2 =
(gm m − 2gm n + gn n )
m ,n

m ,n

= 2N



585

gm m = 2N tr(G).

(16)

m

In the end, since a matrix is Gramian if and only if it is positive semidefinite, the unfolding problem is equivalent to the
following SDP problem:
maximize tr(G) subject to
⎧
G is symmetric positive semidefinite
⎪
⎨
(17)
m ,n gm n = 0
⎪
⎩
am n (gm m − 2gm n + gn n ) = am n xm − xn 2 .
(We refer to [33] for a comprehensive introduction to SDP and
to [35] for the SDP solver used in our experiments.)
The question that remains is how to compute a solution
∗
} to the original unfolding problem from
Y∗ = {y1∗ , . . . , yN
∗
a solution G to (17). Since G∗ is symmetric, it can be written
in the form G∗ = PΛPT , where Λ = diag{λ1 , . . . , λN } is the
diagonal matrix whose entries are the eigenvalues of G∗ , and
P = [v1 . . . vN ] is the orthogonal matrix whose columns are
the eigenvectors of G∗ associated with λ1 , . . . , λN . The eigenvalues λn are nonnegative (because G∗ is positive semidefinite), and we assume that they are arranged in decreasing order:

N


λk vk ,m vk ,n

(18)

k =1

where vk ,n denotes the nth component of vk . Equivalently, G∗
is the Gram matrix of the vectors ψ 1 , . . . , ψ N defined by
√
√
ψ n = ( λ1 v1,n , . . . , λN vN ,n ).
(19)
If the fibers X(1) , . . . , X(p) lie near a 2-D manifold, then λ2 	
λ3 [32], and thus
√
√
ψ n ≈ ( λ1 v1,n , λ2 v2,n , 0 . . . , 0).
(20)
Hence, the solution Y∗ to the original unfolding problem is
obtained by truncating the vectors ψ n to their first two components; that is, we set
√
√
yn∗ = ( λ1 v1,n , λ2 v2,n )
(21)
for all n ∈ {1, . . . , N }.
The ratio λ3 /λ2 can be used to measure the accuracy of
approximation (20) (the smaller λ3 /λ2 , the closer the original
set of 3-D fibers to a 2-D manifold), and λ2 /λ1 measures the
dispersion of the fibers within the 2-D embedding. Since these
two ratios are in the interval [0, 1], we can use them to express
EA and FD as percentages:
EA (%) = 100(1 − λ3 /λ2 )

(22)

FD (%) = 100 λ2 /λ1 .

(23)

G. Distance Measure Between Two Embeddings
We conclude our methodological description with the definition of a distance measure between embeddings of a same
set of fibers X. This measure is denoted by d and used in our
experiments below. Given two embeddings Y = (y1 , . . . , yN )
and Z = (z1 , . . . , zN ) of X, we define
1 
dm ,n (Y, Z)
(24)
d(Y, Z) = 2
N
m = n

where dm ,n (Y, Z) is the absolute difference of the distances
between the mth and nth points in Y and Z:



(25)
dm ,n (Y, Z) = ym − yn  − zm − zn .
III. EXPERIMENTS
A. Synthetic Examples
1) Equidistant Helical Fibers: We first test our unfolding algorithm on the four equidistant helical fibers displayed in Fig. 4;
this choice is motivated by the helical ventricular myocardial
band model [23]. Each fiber is represented by 100 points and
has a length of 49 (the unit of measurement is arbitrary, but we
can think in terms of millimeters). The distance between two
nearby fibers is 0.93. Fig. 5 shows the embedding produced by
our unfolding algorithm with k = 9. Note that the horizontal
and vertical axis scales are the same, as for all the embeddings
displayed in this paper. The embedding reveals the structure
of the 3-D curves: It consists of parallel segments with length

586

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 4. Equidistant helical fibers. Each fiber has a length of 49 (arbitrary unit),
the distance between two adjacent fibers is 0.93, and the red points are the
reference points.

Fig. 5. Embedding of the equidistant helical fibers obtained with k = 9. The
length and relative positions of the helixes are preserved.

Fig. 6. Embeddings of the equidistant helical fibers obtained with (a) k = 11
and (b) k = 5.

equal to that of the helixes, and the distance from one segment to the next is also the same as that between the helixes.
These observations are supplemented by the three largest normalized eigenvalues of the Gram matrix G∗ solution to (17):
λ1 = 0.9950, λ2 = 4.7 × 10−3 , and λ3 = 10−4 . Following definitions (22) and (23), the EA is 97.8%, which indicates that the
helixes are very close to a 2-D manifold, and the FD within the
embedding is smaller than 0.5%, which is in agreement with
the fact that the helixes are equidistant and close to each other.
A guideline for choosing the neighborhood-size parameter k
is that it should be about three times the number of fibers that
defines the range of the local isometry constraints. So k ranges
from 3 to 3P if there are P fibers to unfold, and setting k = 3Q
with Q ∈ {1, . . . , P } means that each structural neighborhood
Nk (xm ) contains points in about Q different fibers (the exact number depends on the fiber extremities in the considered
neighborhood). Back to our example, for the value k = 9 considered above, most neighborhoods N9 (xm ) contain ten points
distributed in three neighboring fibers; in other words, the range
of the local isometry constraints is limited to three fibers, which
is sufficient since the helixes are equidistant. The unfolding
results remain similar for values of k larger than 9, but they
deteriorate when the structural neighborhoods involve less than
nine points in three different fibers (that is, when k  7). This
is illustrated in Fig. 6, which shows the embeddings obtained
with k = 11 and k = 5.

2) Fanning and Highly Curled Fibers: We consider here the
set of fanning fibers shown in Fig. 7(a) and the set of highly
curled fibers shown in Fig. 7(b). Each set contains a total of
800 points distributed among seven fibers. The elevation angle
is constant along every fiber and varies from one fiber to the
other, ranging from −45◦ to 45◦ with a 15◦ step-angle for the
fanning fibers, and from 0◦ to 30◦ with a 5◦ step-angle for
the curled fibers.
Fig. 8 displays the embeddings obtained by our unfolding
algorithm with k = 15 and using the reference points at the
locations pointed by the arrows in Fig. 7. Let us first examine the
embedding of the fanning fibers in Fig. 8(a). The unfolded fibers
are straight line segments revealing the fanning structure of the
original 3-D fibers. The EA is almost perfect (99.6%) because
the 3-D fibers lie on a cylinder, and the important FD within
the embedding is confirmed by its quantitative measurement
(40.6%). Furthermore, the angle α between every pair of nearby
line segments is about 15.1◦ , and the angle β between the outer
line segments is about 90.7◦ ; that is, we recover almost exactly
the step and the range of the elevation angle that were used
to generate the 3-D fibers. The embedding of the curled fibers
[see Fig. 8(b)] consists of nearly straight lines. The associated
accuracy is 94.9%, the FD is only 6.3%, and the step and range
angles α and β are close to the step and the range of the elevation
angle in the 3-D fibers (but not as close as for the fanning
fibers). This slight decrease in accuracy compared to the fanning

LI et al.: CARDIAC FIBER UNFOLDING BY SEMIDEFINITE PROGRAMMING

587

TABLE I
LARGEST NORMALIZED EIGENVALUES, EA, AND FD OF THE UNFOLDED
FANNING FIBERS FOR INCREASING VALUES OF k

k
k
k
k
k
k

=
=
=
=
=
=

6
9
12
15
18
21

λ1

λ2

λ3

EA (%)

FD (%)

1.0000
0.7134
0.7141
0.7099
0.7053
0.7027

0.0000
0.2857
0.2833
0.2886
0.2897
0.2912

0.0000
0.0004
0.0018
0.0010
0.0035
0.0038

99.8
99.3
99.6
98.8
98.7

40.0
39.6
40.6
41.0
41.4

TABLE II
STEP AND RANGE ANGLES OF THE UNFOLDED FANNING FIBERS
FOR INCREASING VALUES OF k  9

k
k
k
k
k

Fig. 7. Synthetic sets of fanning and curled fibers, both with three groups of
reference points. The first group consists of reference points at the same location
(pointed by the arrow), and the other two groups are vertically aligned.

=
=
=
=
=

9
12
15
18
21

α

β

14.9
14.9
15.1
15.2
15.3

89.4
89.4
90.7
91.4
92.2

TABLE III
LARGEST NORMALIZED EIGENVALUES, EA, AND FD OF THE CURLED
FIBERS FOR INCREASING VALUES OF k

k
k
k
k
k
k

Fig. 8. Embeddings of the sets of fibers shown in Fig. 7: (a) fanning fibers;
(b) curled fibers. (In both cases, we used k = 15 and the reference points pointed
by the arrows.)

=
=
=
=
=
=

6
9
12
15
18
21

λ1

λ2

λ3

EA (%)

FD (%)

1.0000
1.0000
0.9352
0.9363
0.9394
0.9357

0.0000
0.0000
0.0587
0.0590
0.0578
0.0591

0.0000
0.0000
0.0043
0.0030
0.0015
0.0034

92.6
94.9
97.4
94.2

6.2
6.3
6.1
6.3

fibers is due to the more complex, spiral-shaped structure of the
underlying 2-D manifold. The small FD reflects the fact that the
curled fibers move slowly away from each other.
To assess the effect of the neighborhood-size parameter
k, we repeated the above unfolding experiments with k ∈
{6, 9, 12, 18, 21} (recall that we used k = 15 previously). In
the case of the fanning fibers, the original fiber structure is
lost when k = 6 (the structural neighborhoods Nk (xm ) contain
too few points to keep the unfolded fibers grouped together),
but the other embeddings are visually the same: the distance d
[see (24)] between any two embeddings obtained for k  9 is
smaller than 0.13, a value to be compared to the average length
of the 3-D fibers (about 40). Quantitatively, Table I shows that
for k  9, the spectrum of the Gram matrix is approximately
constant, and hence so are the EA and the FD. Moreover, the
step and range angles given in Table II are very close to 15◦ and
90◦ . So the distribution of the original elevation angle is preserved by the unfolding process. As regards the curled fibers,
the original structure is lost when k  9, but the embeddings obtained for k  12 are similar, as Table III shows—the distance
d between any two such embeddings is smaller than 0.36, to be
compared with an average fiber length of about 60. The step and
range angles given in Table IV confirm that the distribution of

588

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

TABLE IV
STEP AND RANGE ANGLES OF THE UNFOLDED CURLED FIBERS
FOR INCREASING VALUES OF k  12

k
k
k
k

=
=
=
=

12
15
18
21

α

β

5.2
5.3
5.4
5.4

31.2
31.9
32.1
32.1

Fig. 9. Simple configuration consisting of six cardiac fibers close to one
another (long- and short-axis views).

the original elevation angle is preserved by unfolding when the
neighborhood size is large enough.
We finally repeated all the previous experiments on the fanning and curled fibers using the other two groups of reference
points (that is, the sets of vertically aligned points shown in
Fig. 7). We did not observe any difference with the results obtained when using the overlapping reference points, which leads
to the conclusion that our unfolding algorithm is not sensitive
to the choice of the reference region. However, when dealing
with real data, it is practically (and intuitively) better to choose
a reference region as small as possible.

Fig. 10. Embeddings of the fibers in Fig. 9 obtained with different sets of
reference points: (b), (d) and (f) are the embeddings associated with the reference
point locations displayed in red in (a), (c) and (e), respectively. (Axis units are
mm.)

B. Unfolding Real Cardiac Fibers
Our real data consist of diffusion-weighted images of ex vivo
human hearts acquired with a Siemens 1.5 T Magnetom Avanto
using the following settings: TE = 98 ms, TR = 8600 ms,
FOV = 256 × 256 mm2 , slice thickness = 2 mm, number of
slices = 52, slice size = 128 × 128, diffusion sensitivity =
103 s × mm−2 , and 12 gradient directions. The acquisition sequence is a 2-D EPI diffusion-weighted sequence with a twicerefocused diffusion preparation.
The cardiac fibers considered here are selected from fiber sets
obtained with the probabilistic tractography method proposed in
[34]. Unless stated otherwise, these fibers are discretized with a
step-length of half the voxel size (they contain about 160 points
on average), and the neighborhood-size parameter k is set to 15
(so according to our discussion in Section III-A, most structural
neighborhoods involve five different fibers).
1) Simple Fiber Configuration: We start with the simple
configuration shown in Fig. 9, which consists of six cardiac
fibers that are close to each other along their whole lengths.
Figs. 10(b), (d) and (f) show the corresponding embeddings obtained when moving the reference region from one extremity

TABLE V
LARGEST NORMALIZED EIGENVALUES, EA, AND FD OF THE EMBEDDINGS
SHOWN IN FIG. 10
Reference region
Lower [see Fig. 10(b)]
Middle [see Fig. 10(d)]
Higher [see Fig. 10(f)]

λ1

λ2

λ3

EA (%)

FD (%)

0.9907
0.9896
0.9906

0.0064
0.0073
0.0070

0.0008
0.0010
0.0007

87.5
86.3
90

0.64
0.73
0.70

to the other. We observe that the unfolded fibers remain close
to each other (similar to the 3-D fibers) and that the unfolding algorithm is not sensitive to moving the reference region.
This is further confirmed by measuring the distance d between
any two of the three embeddings: The result remains smaller
than 0.25% of the average length of the 3-D fibers. The largest
normalized eigenvalues of the Gram matrices associated with
the three embeddings are reported in Table V. The EA is high
enough to conclude that the 3-D fibers lie near a 2-D manifold,

LI et al.: CARDIAC FIBER UNFOLDING BY SEMIDEFINITE PROGRAMMING

589

Fig. 11. Thirteen cardiac fibers with organization subject to misinterpretation.
(The red points are the reference points used for unfolding.)
Fig. 13. Ten cardiac fibers with no apparent helical structure. (The red points
are the reference points used for unfolding.)

Fig. 12.

Embedding of the fibers shown in Fig. 11. (Axis units are mm.)

and the negligible FD values are in agreement with the band-like
organization of the 3-D fibers.
2) Complex Fiber Configuration: The architecture of the set
of fibers displayed in Fig. 11 is more difficult to apprehend than
that of the fibers in Fig. 9. The corresponding embedding is
shown in Fig. 12. We observe that the unfolded fibers do not
scatter as much as may be erroneously inferred from the 3-D
representations. Together with the short-axis view in Fig. 11(c),
unfolding reveals that the selected fibers are consistent with the
helical band model. The EA (about 54%) is smaller than in the
previous example (see Table V); this indicates that the fibers in
Fig. 11 are less close to a 2-D manifold than those in Fig. 9. The
FD remains negligible (below 0.5%), revealing that the set of
3-D fibers also has a band-like structure. This latter observation
is noteworthy, for the band-like organization is hardly visible
from 3-D rendering.
3) Fibers With No Apparent Helical Structure: An even
more complicated example is shown in Fig. 13. The ten selected

Fig. 14.

Embedding of the fibers shown in Fig. 13. (Axis units are mm.)

fibers are sampled with a step-length equal to the voxel-size;
they are close to each other along one third of their length, and
they scatter along the apex-base axis. Although a spiral shape
is clearly visible from Fig. 13(c), the 3-D representations do
not allow us to conclude that the fibers have an helical structure. Fig. 14 shows the embedding produced by unfolding. The
EA is 85.4%, which confirms that the underlying dimensionality of the fibers is two. The FD (about 1.1%) is larger than in
the two previous examples, but the fibers tend to regroup after
moving away from each other. Therefore, the band model is
acceptable to the extent that fibers can scatter within the helical
structure. Fig. 15 shows the embedding of middle segments of
the four longest fibers. The associated accuracy is 98.9%, and
so these fiber segments lie on a 2-D manifold even though they
move away from each other in the apex region. This confirms

590

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 15. Embedding of fiber segments from Fig. 13. The unfolded fiber segments can be divided into three parts: (I) they follow approximately the same
trajectory, (II) then they move away from each other in the apex region, and (III)
they finally regroup.

again that the specific structure of the cardiac fibers is more
completely assessed by combining information from both 3-D
rendering and 2-D embedding.
4) Fiber Groups With Different Organizations: We conclude our experiments by further examining the effect of the
neighborhood-size parameter k. Fig. 16 shows eighteen fibers
passing through vertically aligned points [displayed in pink in
Fig. 16(a)] in the epicardium. These fibers were separated into
two groups of nine fibers each according to their shape. The
separate 3-D renderings of these groups in Figs. 16(c) and (d)
do not allow us to conclude whether they lie near a same manifold. Fig. 17 shows the unfolding results obtained for values of
k ranging from 10 to 35 [we used the reference points displayed
in white in Fig. 16(b)]. The spectra of the corresponding Gram
matrices are displayed in Fig. 18 in the form of cumulative
bar charts. Both representations show an abrupt change for a
value of k between 20 and 25. More precisely, the break occurs
for k = 24, which is the value above which the local isometry
constraints involve at least nine fibers on average. The similar
embeddings and the spectra obtained for k  24 indicate two
things: First, the two groups of fibers lie near a same manifold;
second, the critical value of k is that which creates attachment
between the two groups. These observations suggest that k can
be set automatically by unfolding with increasing neighborhood
size until an abrupt increase of the ratio λ1 /λ2 (or, equivalently,
an abrupt decrease in FD) occurs.
IV. DISCUSSION AND CONCLUSION
We introduced an original approach to assess the architecture
of the human heart—the unfolding of cardiac fibers under local
isometry constraints using SDP. This new tool facilitates the
analysis of complex 3-D fiber structures, it allows quantitative

Fig. 16. Eighteen cardiac fibers separated into two groups with different organizations: (a) the fibers pass through the vertically aligned points displayed in
pink; (b) the reference points used for embedding are displayed in white (they
are the closest points to a user-defined vertical plane); (c), (d) the two groups of
nine fibers each do not seem to lie near a same manifold.

measurements of fiber organization via the eigenvalues of the
Gram matrices defining the embeddings, and it provides fiber
grouping information.
Our unfolding algorithm is controlled by
1) the set of reference points involved in the definition of the
distance dX (see Section II-D), and
2) the neighborhood-size parameter k that controls the local
isometry constraints (see Section II-E).
It is best practice to take the reference points in a narrow
region intersected by all the fibers to unfold, if such exists.
However, although the reference points affect the adjacency
matrix, fiber unfolding is weakly sensitive to the choice of the
reference region because it preserves local Euclidean distances
rather than dX . The effect of the parameter k is more critical. If
it is too small (that is, if the neighborhoods Nk (xm ) do not involve enough fibers), then too much structure information is lost
in the unfolding process, and this results in faulty embeddings
such as those displayed in Figs. 17(a)–(c). Increasing k strengthens and widens the local isometry constraints, which makes it
more difficult to embed fiber sets with complex organization
but preserves structures. In practice, k can be determined by
considering increasing values until a drop in FD is observed, as
illustrated by the Gram matrix spectra in Fig. 18. We suggest to
start with k = 15, which generally produces good embeddings,
and then increase it by increments of 3 if necessary.
Our experiments show that 2-D embedding is an interesting supplement to 3-D cardiac fiber rendering. In particular,
it reveals specific fiber propagation patterns such as band-like

LI et al.: CARDIAC FIBER UNFOLDING BY SEMIDEFINITE PROGRAMMING

591

ACKNOWLEDGMENT
The authors would like to thank Dr. L. Fanton and P. Croisille
for data acquisition.
REFERENCES

Fig. 17. Embeddings of the fibers in Fig. 16 obtained with different values of
k. (Axis units are mm.)

Fig. 18. Cumulative bar charts of the spectra of the Gram matrices associated
with the embeddings shown in Fig. 17.

organization (as for the fiber sets displayed in Figs. 9, 11 and
16) and scattering in the vicinity of the apex (as for the fibers
displayed in Fig. 13). This information could be used for better understanding laminar fiber architecture [17], [36], [37], for
performing fiber clustering [25], [28], and for distinguishing
abnormal from healthy hearts [20], [38]–[40].

[1] L. Krehl, Beitrge Zur Kenntniss Der Fllung Und Entleerung Des Herzens.
Leipzig, Germany: Hirzel, 1891.
[2] J. MacCallum, “On the muscular architecture and growth of the ventricles
of the heart,” Johns Hopkins Hosp. Rep., vol. 9, pp. 307–335, 1900.
[3] F. Mall, “On the muscular architecture of the ventricles of the human
heart,” Am. J. Anat., vol. 11, no. 3, pp. 211–266, 1911.
[4] J. Robb and R. Robb, “The normal heart: Anatomy and physiology of the
structural units,” Amer. Heart J., vol. 23, no. 4, pp. 455–467, 1942.
[5] R. Rushmer, D. Crystal, and C. Wagner, “The functional anatomy of
ventricular contraction,” Circ. Res., vol. 1, no. 2, pp. 162–170, 1953.
[6] F. Torrent-Guasp, “Organizacion de la musculatura cardiaca ventricular,” in El Fallo Mecànico del Corazon. Barcelona, Spain: Toray, 1975,
pp. 3–36.
[7] D. Streeter, “Gross morphology and fiber geometry of the heart,” in Handbook of Physiology. Bethesda, MD, USA: Amer. Physiol. Soc., 1979,
pp. 61–112.
[8] R. Greenbaum, S. Ho, D. Gibson, A. Becker, and R. Anderson, “Left
ventricular fibre architecture in man,” Br. Heart J., vol. 45, no. 3,
pp. 248–263, 1981.
[9] P.-S. Jouk, Y. Usson, G. Michalowicz, and F. Parazza, “Mapping of the
orientation of myocardial cells by means of polarized light and confocal scanning laser microscopy,” Microsc. Res. Tech., vol. 30, no. 6,
pp. 480–490, 1995.
[10] D. Sanchez-Quintana, V. Garcia-Martinez, V. Climent, and J. Hurle, “Morphological changes in the normal pattern of ventricular myoarchitecture
in the developing human heart,” Anat. Rec., vol. 243, no. 4, pp. 483–495,
1995.
[11] P. Lunkenheimer, K. Redmann, H. Scheld, K.-H. Dietl, C. Cryer,
K.-D. Richter, J. Merker, and W. Whimster, “The heart muscle’s putative
secondary structure: Functional implications of a band-like anisotropy,”
Technol. Health Care, vol. 5, no. 1, pp. 53–64, 1997.
[12] B. Taccardi, E. Macchi, R. Lux, P. Ershler, S. Spaggiari, S. Baru, and
Y. Vyhmeister, “Effect of myocardial fiber direction on epicardial potentials,” Circulation, vol. 90, no. 6, pp. 3076–3090, 1994.
[13] C.-Y. Chung, H. Bien, and E. Entcheva, “The role of cardiac tissue alignment in modulating electrical function,” J. Cardiovasc. Electrophysiol.,
vol. 18, no. 12, pp. 1323–1329, 2007.
[14] P. Basser, J. Mattiello, and D. LeBihan, “Estimation of the effective selfdiffusion tensor from the NMR spin echo,” J. Magn. Reson. B, vol. 103,
no. 3, pp. 247–254, 1994.
[15] E. Piuze, J. Sporring, and K. Siddiqi, “Moving frames for heart fiber
geometry,” in Information Processing in Medical Imaging. New York,
NY, USA: Springer, 2013, pp. 524–535.
[16] P. Savadjiev, G. Strijkers, A. Bakermans, E. Piuze, S. Zucker, and
K. Siddiqi, “Heart wall myofibers are arranged in minimal surfaces to
optimize organ function,” Proc. Nat. Acad. Sci. U.S.A., vol. 109, no. 24,
pp. 9248–9253, 2012.
[17] D. Rohmer, A. Sitek, and G. Gullberg, “Reconstruction and visualization of fiber and laminar structure in the normal human heart from ex
vivo diffusion tensor magnetic resonance imaging (DTMRI) data,” Invest.
Radiol., vol. 42, no. 11, pp. 777–789, 2007.
[18] C. Frindel, M. Robini, and Y. Zhu, “A graph-based approach for automatic
cardiac tractography,” Magn. Reson. Med., vol. 64, no. 4, pp. 1215–1229,
2010.
[19] F. Yang, Y. Zhu, I. Magnin, J. Luo, P. Croisille, and P. Kingsley, “Featurebased interpolation of diffusion tensor fields and application to human
cardiac DT-MRI,” Med. Image Anal., vol. 16, no. 2, pp. 459–481, 2012.
[20] H. Lombaert, J.-M. Peyrat, P. Croisille, S. Rapacchi, L. Fanton, F. Cheriet,
P. Clarysse, I. Magnin, H. Delingette, and N. Ayache, “Human atlas of the
cardiac fiber architecture: Study on a healthy population,” IEEE Trans.
Med. Imag., vol. 31, no. 7, pp. 1436–1447, Jul. 2012.
[21] N. Toussaint, C. Stoeck, T. Schaeffter, S. Kozerke, M. Sermesant, and
P. Batchelor, “In vivo human cardiac fibre architecture estimation using shape-based diffusion tensor processing,” Med. Image Anal., vol. 17,
no. 8, pp. 1243–1255, 2013.
[22] L. Zhukov and A. Barr, “Heart-muscle fiber reconstruction from diffusion
tensor MRI,” in Proc. 14th IEEE Vis. Conf., 2003, pp. 597–602.

592

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

[23] M. Kocica, A. Corno, F. Carreras-Costa, M. Ballester-Rodes, M. Moghbel, C. Cueva, V. Lackovic, V. Kanjuh, and F. Torrent-Guasp, “The helical
ventricular myocardial band: Global, three-dimensional, functional architecture of the ventricular myocardium,” Eur. J. Cardiothorac. Surg., vol.
29, pp. S21–40, 2006.
[24] H. Wei, M. Viallon, B. Delattre, L. Wang, V. Pai, H. Wen, H. Xue, C.
Guetter, P. Croisille, and Y. Zhu, “Assessment of cardiac motion effects
on the fiber architecture of the human heart in vivo,” IEEE Trans. Med.
Imag., vol. 32, no. 10, pp. 1–11, Oct. 2013.
[25] C. Frindel, M. Robini, and Y. Zhu, “Cardiac fibre trace clustering for the
interpretation of the human heart architecture,” in Functional Imaging and
Modeling of the Heart. New York, NY, USA: Springer, 2009, pp. 39–48.
[26] P. Batchelor, F. Calamante, J.-D. Tournier, D. Atkinson, D. Hill, and A.
Connelly, “Quantification of the shape of fiber tracts,” Magn. Reson. Med.,
vol. 55, no. 4, pp. 894–903, 2006.
[27] A. Leemans, J. Sijbers, S. De Backer, E. Vandervliet, and P. Parizel,
“Multiscale white matter fiber tract coregistration: A new feature-based
approach to align diffusion tensor data,” Magn. Reson. Med., vol. 55,
no. 6, pp. 1414–1423, 2006.
[28] L. O’Donnell, M. Kubicki, M. Shenton, M. Dreusicke, W. Grimson, and
C. Westin, “A method for clustering white matter fiber tracts,” Amer. J.
Neuroradiol., vol. 27, no. 5, pp. 1032–1036, 2006.
[29] S. Zhang, S. Correia, and D. Laidlaw, “Identifying white-matter fiber
bundles in DTI data using an automated proximity-based fiber clustering method,” IEEE Trans. Vis. Comput. Graphics, vol. 14, no. 5,
pp. 1044–1053, Sep./Oct. 2008.
[30] L. Cayton, “Algorithms for manifold learning,” Univ. California, San
Diego, CA, USA, Tech. Rep. CS2008-0923, 2005.
[31] L. van der Maaten, E. Postma, and H. van den Herik, “Dimensionality reduction: A comparative review,” Tilburg Univ., Tilburg, The Netherlands,
Tech. Rep. 2009-005, 2009.
[32] K. Weinberger and L. Saul, “Unsupervised learning of image manifolds by
semidefinite programming,” in Proc. IEEE Comput. Soc. Conf. Comput.
Vis. Pattern Recognit., 2004, pp. 988–995.

[33] L. Vandenberghe and S. Boyd, “Semidefinite programming,” SIAM Rev.,
vol. 38, no. 1, pp. 49–95, 1996.
[34] H. Li, M. Robini, F. Yang, and Y. Zhu, “A neighborhood-based probabilistic approach for fiber tracking in human cardiac DTI,” in Proc. IEEE
Int. Symp. Biomed. Imag., 2012, pp. 9–13.
[35] B. Borchers, “CSDP: A C library for semidefinite programming,” Optim.
Methods Softw., vol. 11, no. 1–4, pp. 613–623, 1999.
[36] I. LeGrice, B. Smaill, L. Chai, S. Edgar, J. Gavin, and P. Hunter, “Laminar
structure of the heart: ventricular myocyte arrangement and connective
tissue architecture in the dog,” Amer. J. Physiol. Heart Circ. Physiol.,
vol. 269, no. 2, pp. H571–582, 1995.
[37] K. Costa, Y. Takayama, A. McCulloch, and J. Covell, “Laminar fiber architecture and three-dimensional systolic mechanics in canine ventricular
myocardium,” Amer. J. Physiol. Heart Circ. Physiol., vol. 276, no. 2,
pp. H595–607, 1999.
[38] M. Wu, W. Tseng, M. Su, C. Liu, K. Chiou, V. Wedeen, T. Reese, and C.
Yang, “Diffusion tensor magnetic resonance imaging mapping the fiber
architecture remodeling in human myocardium after infarction correlation
with viability and wall motion,” Circulation, vol. 114, no. 10, pp. 1036–
1045, 2006.
[39] W. Tseng, J. Dou, T. Reese, and V. Wedeen, “Imaging myocardial fiber disarray and intramural strain hypokinesis in hypertrophic cardiomyopathy
with MRI,” J. Magn. Reson. Imag., vol. 23, no. 1, pp. 1–8, 2006.
[40] M. Wu, M. Su, Y. Huang, K. Chiou, P. Yang, H. Pan, T. Reese, V. Wedeen,
and W. Tseng “Sequential changes of myocardial microstructure in patients postmyocardial infarction by diffusion-tensor cardiac MR: Correlation with left ventricular structure and function,” Circ. Cardiovasc. Imag.,
vol. 2, no. 1, pp. 32–40, 2009.

Authors’ photographs and biographies not available at the time of publication.

