IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

2621

Multiscale Registration of Real-Time and Prior MRI
Data for Image-Guided Cardiac Interventions
Robert Xu∗ , Prashant Athavale, Adrian Nachman, and Graham A. Wright

Abstract—Recently, there is a growing interest in using magnetic
resonance imaging (MRI) to guide interventional procedures due
to its excellent soft tissue contrast and lack of ionizing radiation
compared to traditional radiographic guidance. One of these applications is the use of MRI to guide radio frequency ablation of
anatomic substrates, within the left ventricle, responsible for ventricular tachycardia. However, different MRI acquisition schemes
have significant tradeoffs between image quality and acquisition
time. Guidance using high-quality preoperative 3-D MR images
is limited in the case of cardiac interventions because the heart
moves dynamically during the procedure. On the other hand, 2-D
real-time MR images acquired during the intervention sacrifice image quality for shorter image acquisition time, leading to real-time
positional updates of cardiac anatomy. Ideally, we wish to combine the advantages of live feedback from real-time images and
accurate visualization of anatomical structures from preoperative
images. Therefore, to improve the MRI guidance capabilities for
cardiac interventions, we describe a novel multiscale rigid registration framework to correct for respiratory motion between the
prior and real-time datasets. In the proposed approach, we use a
weighted total variation flow algorithm to extract coarse-to-fine
features from the input images and subsequently register the corresponding scales in a hierarchical manner. Registration experiments were performed with in vivo human imaging data, and the
target registration error achieved was 1.51 mm. Thus, the feasibility of motion correction in an interventional setting has been
demonstrated, which may lead to significant improvements in the
guidance of cardiac interventions.
Index Terms—image-guided cardiac interventions, magnetic
resonance imaging (MRI), multiscale image registration.

I. INTRODUCTION

C

ARDIOVASCULAR disease remains as one of the main
causes of death in developed nations. Recent mortality

Manuscript received January 14, 2014; revised April 4, 2014; accepted May
6, 2014. Date of publication May 16, 2014; date of current version September
16, 2014. This work was supported by the GE Healthcare and the Federal
Development Agency of Canada. Asterisk indicates corresponding author.
∗ R. Xu is with the Physical Sciences Platform and Schulich Heart Research
Program, Sunnybrook Research Institute, Toronto, ON M4N 3M5, Canada,
and is also with the Department of Medical Biophysics, University of Toronto,
Toronto, ON M5G 2M9, Canada (e-mail: robert.xu@mail.utoronto.ca).
P. Athavale is with the Department of Mathematics, University of Toronto,
Toronto, ON M5S 1A1, Canada (e-mail: prashantva@gmail.com).
A. Nachman is with the Department of Mathematics, the Department of
Electrical Engineering, and the Institute of Biomaterials and Biomedical Engineering, University of Toronto, Toronto, ON M5S 1A1, Canada (e-mail:
nachman@math.utoronto.edu).
G. A. Wright is with the Physical Sciences Platform and Schulich
Heart Research Program, Sunnybrook Research Institute, Toronto, ON
M4N 3M5, Canada, and also with the Department of Medical Biophysics, University of Toronto, Toronto, ON M5G 2M9, Canada (e-mail:
graham.wright@sri.utoronto.ca).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2324998

data showed that cardiovascular disease accounted for over
800 000 deaths or 32.8% of all deaths in the U.S. [1]. One
particular disease of interest in this study is ventricular tachycardia (VT), which is a cardiac arrhythmia caused by scarring
from previous myocardial infarctions. The current curative treatment of VT requires the use of radio frequency (RF) ablation
to eliminate the anatomical substrate responsible for triggering
the arrhythmia. To this end, image-guided therapies have been
proposed to guide mapping and ablation catheters to increase
the accuracy and efficacy of cardiovascular procedures [2]–[9].
Traditionally, cardiovascular interventions are carried out under X-ray fluoroscopic guidance for diagnosis and treatment
of arrhythmias. However, X-ray images have poor soft tissue
contrast and it is, therefore, difficult to interpret the anatomical
context from the images directly. The use of real-time magnetic
resonance imaging (MRI) to guide cardiac interventions has also
been proposed [2], [8], [10]. Although MRI has inherently superior soft tissue contrast compared to X-ray fluoroscopy, real-time
MRI guidance also has its limitations. The increased acquisition frame rate is obtained at the expense of imaging quality
and spatial coverage. Alternatively, the use of high-resolution
3-D imaging roadmaps generated from computer tomography
(CT) or MRI prior to the intervention has also been described
[11]–[13]. However, one of the major limitations of guidance
using high-resolution roadmap images is that the images remain
static and do not account for patient respiratory motion during
the interventional procedure. The amount of respiratory motion
is subject dependent, and it has been shown that the movement
can potentially exceed 16 mm [14], [15]. Therefore, patient respiratory motion can significantly reduce the targeting accuracy
of RF ablation procedures.
In the ideal paradigm, we would like to combine the advantages of live feedback from real-time images, and accurate
visualization of anatomical context from high-resolution preprocedural images. To this end, a number of registration studies have been reported in the literature for aligning real-time
and preprocedural images in the context of surgical navigation and adaptive radiation therapy [16]–[19]. However, these
studies focused on less mobile anatomical regions such as the
prostate, rectum, lungs, as well as the head and neck areas.
The registration problem for cardiac intervention is significantly more challenging due to the highly mobile nature of the
heart [15]. Therefore, many cardiac image registration studies
in the past have focused on offline cardiac analysis [20]–[24].
In a review of cardiac image registration methods [20], the
authors discussed various methods for combining information
from multiple cardiac image modalities for physiologic understanding and diagnostic purposes. Aladl et al. [21] proposed a

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2622

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

registration method to align cardiac-gated SPECT and MR images for comparison of regional function and perfusion. Their
algorithm requires the myocardium to be initially segmented in
the cardiac MR images, which is subsequently registered to the
gated SPECT image via maximization of mutual information
(MI). Perperidis et al. [22] proposed a 4-D deformable registration algorithm to register 3-D MR imaging sequences from
different subjects. Specifically, the free-form deformation model
based on B-splines was used to separately correct for spatial and
temporal misalignments. However, the reported computational
time was approximately 1 h. More recently, Shi et al. [24] proposed a nonrigid image registration method to estimate cardiac
motion and evaluate regional volume and strain. In this case,
a free-form deformation method was adopted and a spatially
weighted normalized cross correlation (NCC) metric was chosen to utilize data from both tagged and untagged MR images.
Although the above-mentioned methods are suitable for offline
cardiac function analysis, the extended computational times render them unsuitable for interventional applications.
Fewer studies have explored cardiac image registration for
interventional purposes [5]–[7]. Huang et al. [5] proposed a
two-step method to register real-time 3-D ultrasound images to
high-quality MR/CT images of the beating heart for diagnosis and surgical navigation. Excellent registration accuracy was
achieved for both the phantom and human studies with an average target registration error (TRE) of 2.59 and 1.76 mm, respectively. However, this method requires an initial manual registration step, which is then automatically refined using an MI-based
registration method. Smolı́ková-Wachowiak et al. [6] presented
an automatic registration method for aligning 2-D real-time MR
images to 3-D preprocedural MR images for interventional applications. They studied the effect of various imaging parameters
on registration accuracy and compared the efficacy of two different similarity metrics. In the optimal setting, excellent TREs
were achieved (i.e., translation error was <2.7 mm and rotation
error was <3.6◦ ), but the capture range of the algorithm was
only reported for up to 10 mm of initial misalignment between
the real-time and prior imaging data. Ma et al. [7] proposed a
feature-based algorithm to register 3-D echo to 3-D MR images
for cardiac catheterization. They were able to achieve a mean
error of 4.1 mm based on distance between anatomical and
catheter landmarks. However, the algorithm initially requires
a clinical expert to segment the left ventricle (LV) and identify points along the aorta in the echo image, which can take
approximately 3 min. The subsequent automatic feature-based
registration requires an additional 2 min to complete. Therefore, this algorithm is only used to compensate for bulk patient
motion. Although the previous methods show promise, registration of cardiac images with potentially large misalignments due
to respiratory motion remains challenging without manual user
intervention.
In this paper, we propose a novel framework for registering
preprocedural 3-D MR images to 2-D real-time MR images
to better utilize MR guidance for cardiac interventions within
the LV. Specifically, a rigid transformation is applied to correct for respiratory motion induced misalignment between the
prior and real-time datasets. The registration framework uses

a novel edge-preserving scale space filter based on weighted
total variation (TV) flow to decompose each image into coarse
and fine scales. Then, the real-time and prior images are registered in a coarse-to-fine manner using an edge sensitive distance
metric, normalized gradient field (NGF) [25]. In the proposed
approach, large structures or coarse scales in the images are
registered first, before additional finer scale features are added
to iteratively refine the resulting registration. It is shown that
the proposed method is less likely to be trapped in a local minimum compared to other registration approaches, and is able to
achieve a median TRE of 1.51 mm in vivo.
II. METHODS
A. Image Acquisition
Cardiac images from eight volunteers were acquired with a
GE Signa HD 1.5T MRI scanner (GE Healthcare, Milwaukee,
WI, USA) using the manufacturer’s eight-channel cardiac imaging coil. Two separate image acquisition protocols were used to
obtain the images used in this study. For each subject, a preprocedural high-resolution scan is first performed to acquire a
prior roadmap image, followed by a low-resolution real-time
acquisition.
1) High-Resolution Roadmap Acquisition: The prior roadmap
image consists of a multislice 3-D volume acquisition, which encompassed the heart of the subject. These were standard clinical
prescription slices parallel to the short axis (SAX) of the heart.
A typical range of 11–13 slices were acquired to cover the entire
LV. For each slice, the subject was asked to hold their breath at
end expiration, while the GE FIESTA pulse sequence was used
to acquire images gated to middiastole. The acquired images
had a field of view (FOV) = 350 mm, in-plane resolution =
1.3 × 1.3 mm2 , and slice thickness = 8 mm.
2) Low-Resolution Real-Time Acquisition: A fast spiral balanced steady-state free precession sequence was used to acquire
2-D images in real time at a frame rate of approximately 10
frames/s. The FOV was set to 350 mm, and the obtained resolution was 2.2 × 2.2 × 8 mm3 . This set of data was acquired
under free breathing. However, physiological data such as cardiac and respiratory gating information were also recorded using
the electrocardiogram (ECG) trigger and respiratory bellows,
respectively. Furthermore, the geometry of the slice prescriptions mirrors the slices acquired in the high- resolution roadmap
images.
B. Multiscale Image Decomposition Based on TV Flow
Medical image registration is often a nonconvex and timeconsuming optimization problem, which has many local minima. To tackle this challenging problem, multilevel or multiscale registration approaches have been proposed in the past
[19], [26], [27] to register images of similar resolution levels or
scales in a coarse-to-fine manner. These methods focus on first
aligning large-scale structures to obtain a good initial transformation before adding finer details to fine-tune the registration
result. Similarly, we propose to use an edge preserving filter
based on TV flow to decompose the prior and real-time cardiac

XU et al.: MULTISCALE REGISTRATION OF REAL-TIME AND PRIOR MRI DATA FOR IMAGE-GUIDED CARDIAC INTERVENTIONS

images into their natural coarse and fine scales, and then register
the images in a hierarchical approach.
Decomposition of an image f can be considered as generating
a smooth component u and a residual component v = f − u.
In the variational approach described by Rudin et al. [28], the
decomposition can be formulated in terms of the minimization
problem as follows:



2
|∇u| + λ
|f − u|
(1)
f = uλ + vλ , uλ := arginf
u

Ω

Ω

where the Ω ⊂ R denotes the imaging domain, and the minimizer uλ is a smooth version of f with a fixed scale 1/λ. The
smooth
 image uλ is constrained to be in the space of finite
TV ( Ω |∇uλ | < ∞), and the residual vλ is in the mathematical
space L2 , the space of square integrable functions.
In this study, we consider a different version of the minimization problem compared to (1), shown as follows:



2
α |∇u| + λ
|f − u|
f = uλ + vλ , uλ := arginf

2623

Fig. 1. Image decomposition using weighted TV flow. Images from left to right
show images with coarse to increasingly fine-scale features. This corresponds
to decreasing values of the artificial time t in (5).

2

u

Ω

Ω

(2)
where α ≡ α(x) is a spatially varying weight that is independent of u, but depends on the given data f . Motivated
by [29], we now extend this minimization problem (2) to
produce a multiscale decomposition. To this effect, the multiscale decomposition algorithm can generate a multiscale
family {uλ , vλ }, where λ denotes an algorithm specific scale
parameter. First, we consider the decomposition of the original
f into f = uλ0 + vλ0 using a large parameter λ = λ0 . Then,
we decompose uλ0 = uλ1 + vλ1 with λ1 < λ0 . This process
is repeated iteratively with λi+1 < λi to obtain successively
smoothed versions uλi + 1 with coarser scale features, thus producing a nonlinear multiscale decomposition as follows:
f = u λ0 + vλ0
= u λ1 + vλ1 + vλ0
= ···
= u λN +

N


vλi .

(3)

i=0

Here, we note that this multiscale decomposition is equivalent to
removing noise and oscillations at certain scales, thus smoothing the image at each iteration. This approach differs from[29],
where the algorithm started with a coarse image, and finer details
were successively added at dyadic scales. We also distinguish
the proposed approach from our earlier work [30], where
 we introduced a similar decomposition, but the TV seminorm Ω |∇u|
was not weighted by the spatially varying α.
Using the Euler–Lagrange differential equation[31] of (2),
and rearranging (3) gives us


N
N


α∇uλi
1
u λN = f −
vλi = f +
div
(4)
2λi
|∇uλi |
i=0
i=0
where {λi }N
i=1 is a monotonically decreasing sequence. Considering λi as samples from a real valued monotonically decreasing function λ(t) motivates the following integro-differential

equation:



u(x, t) = f (x) +
0

t

1
div
2λ(s)



α∇u(x, s)
|∇u(x, s)|


ds.

(5)

As time t increases, the image u(·, t) becomes successively
smoother versions of the original image f . Differentiating (5)
formally with respect to t yields


α∇u
∂u
= μ(t)div
(6)
∂t
|∇u|
where u(t = 0) := f with Neumann boundary condition,
and μ(t) = 1/2λ(t) is the speed function, which is set to
μ(t) = 1.1t . We consider (6) as multiscale weighted TV flow
(see the Appendix for numerical solution to this equation),
which is closely related to TV flow [32].
To enhance the edge-preserving nature of the flow in (6), we
choose the spatial weight α as follows:
α(x) = 	

1
1 + |∇(Gσ ∗ f )(x)|2 /β 2

(7)

where Gσ is a Gaussian kernel with a small standard deviation
σ, and β ∈ R, which is chosen such that α(x) attains small
values at prominent edges in the image. Small values of β close
to 0 enhance the edge-preserving nature of the weighted TV
flow, but could also preserve noise artifacts that have sharp
transitions in intensity. In contrast, as the value of β increases,
α(x) approaches unity, which reduces the constraint on edge
smoothing in the weighted TV flow. For the experiments in
this paper, β was set to 0.07 to emphasize the preservation of
prominent edges belonging to anatomical boundaries.
We observe that the weighted TV flow produces a multiscale
representation of a given image f (see Fig. 1). Theoretically,
this flow differs from the well-known edge-preserving Perona–
Malik equation, which is defined in [33] as



∂u
= div g(|∇u|)∇u .
(8)
∂t
In fact, if we treat the Perona–Malik equation as the solution to a
minimization problem [34], and set g(s) = 1+s12 /κ 2 as proposed
in [33], then (8) can be viewed as a flow corresponding to
minimization of the following functional:



κ2
|∇u|2
JPM (u) =
ln 1 +
dx
(9)
2 Ω
κ2
which is a fundamentally different minimization problem compared to our consideration in (2). Moreover, the weight α in (6)

2624

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

is a function of the original data f rather than u, which can help
to preserve prominent edges at coarser scales. This stems from
the fact that f is a constant, whereas u is smoothed over time.
C. Hiearchical Multiscale Image Registration
Mathematically, registration of a template image f to a reference image g can be posed as an optimization problem as
follows:


(10)
arg min D(f [w], g)
w

where w : R → R is a geometric transformation, and D measures the distance between the transformed template image f [w]
and the reference image g. In this study, the chosen geometric
transformation is a rigid-body transformation, because the acquired images are gated to the same cardiac phase. However,
in general, w can be any arbitrary transformation. The distance
measure D is chosen to be the NGF measure DN GF , which is
defined as [25]

1
DN GF = −

n̂(f, x), n̂(g, x)2 dx
2 Ω
3

3

n̂(I, x) : =

∇I(x)
∇I(x)ε

III. EXPERIMENTS AND RESULTS
Validation of the proposed multiscale registration framework
was performed for prior roadmap and real-time MR images acquired from eight volunteers at the Sunnybrook Health Sciences
Centre (Toronto, ON, Canada). Specifically, two experimental
protocols were adopted to quantitatively evaluate the registration accuracy of the proposed registration technique. One is a
controlled experiment, where the ground truth registration transformations were known, and the registration accuracy was evaluated based on the proposed framework’s ability to recover the
known transformations. In the second experiment, the real-time
images were acquired during free breathing, and the ground
truth registration parameters were unknown. In this case, the
registration accuracy was estimated via two different evaluation metrics. In the first evaluation criterion, the dice similarity
coefficient (DSC) [36] was computed between the manually segmented LV endocardium boundary from a real-time image and
the corresponding segmentation from a registered prior image.
During the second evaluation, the in-plane distance between
visible landmarks from prior and real-time images after image
registration was computed. Details are presented in the following sections.

(11)

where 
·, · denotes the vector dot product, and n̂ represents
thenormalized gradient of the image. For x ∈ Rm , xε =
	
m
2
2
k =1 xk + ε and ∇I := (∂1 I, . . . , ∂m I). The parameter
ε is a regularizing term that minimizes the effects of small
gradients due to noise, and is automatically set as follows:

η
|∇I(x)|dx
(12)
ε=
V Ω
where η is the estimated noise level in the image, and V is the
volume of the domain.1
NGF is an alternative to MI-based registration metrics, and is
derived from the observation that if two images are similar, then
many intensity changes should occur at the same location. The
motivation for using this edge sensitive metric is that we wish
to align spatial features such as contours and boundaries, which
often denote transitions between tissue types.
The optimization in (10) is achieved via the proposed multiscale registration framework illustrated in Fig. 2, and the simplex
minimization algorithm [35] was used at each scale. Smoothed
template uf (·, t) and reference ug (·, t) images are obtained via
weighted TV flow (6), where t0 > t1 . . . > tN . Then, the coarse
scale image pairs uf (·, t0 ) and ug (·, t0 ) are subsampled (denoted by operator D↓ ) by a factor of 2N before registration;
the resulting transformation is used as the initialization for the
image pair with finer scales. This process is repeated for N additional levels, where the subsampling factor is reduced by 2 at
each level, until the final registration result is obtained. In this
study, the number of levels N = 3.
1 In this paper, the value of ε was approximately 0.01 and 0.04 for the prior and
real-time images, respectively, assuming image intensity range is normalized to
[0, 1].

A. Controlled Registration Experiment Setting
To quantitatively evaluate the accuracy of the proposed framework, a controlled study was performed. The prior images were
acquired during end-expiration breath-holds and retrospectively
gated to the middiastolic cardiac phase. On the other hand,
the acquired real-time images were retrospectively gated to the
same middiastolic cardiac phase and end-expiration respiratory
phase. Moreover, the same geometric slice prescriptions were
used for both the prior and real-time scans, which were acquired
a few minutes apart during the same scan session. During the
session, the volunteer subjects were securely strapped down by
the cardiac imaging coil and did not move out of the MR bore
between the two scans. Therefore, in this controlled study, the
prior and real-time images were optimally aligned and considered as ground truths for the ensuing registration. Subsequently,
the spatial locations of landmarks within the heart such as the
LV apex, papillary muscles, and aortic valve annulus were identified, and their (x, y, z) coordinates were recorded from the
aligned images.
Next, a known transformation ωd = 
θx , θy , θz , tx , ty , tz 
consisting of rotations and translations was applied to the prior
roadmap image, causing a mean displacement equal to a predefined value d for the selected landmarks. The rotation and
translation parameters were randomly generated with independent and identically uniform distributions. For each predefined
value of d = 5, 10, 15, 20 mm, 100 transformations were generated. Thus, 400 transformations were generated for each of
the eight volunteer subjects, creating 3200 registration cases in
total. Subsequently, the misaligned 3-D prior roadmap image
f and a 2-D real-time image g were supplied to the proposed
registration framework (see Fig. 2) to attempt to recover the
known transformation. During this process, we also evaluated
the effect of using different image decomposition schemes or

XU et al.: MULTISCALE REGISTRATION OF REAL-TIME AND PRIOR MRI DATA FOR IMAGE-GUIDED CARDIAC INTERVENTIONS

2625

Fig. 2. Multiscale TV flow registration framework using the normalized gradient field metric. Both the template f and reference g images are decomposed into
coarse and fine-scale images corresponding to decreasing values of t : t0 > t1 > · · · > tN . The extracted scale images are then down-sampled and registered
iteratively in a coarse-to-fine manner.

registration distance metrics. Since the ground truth transformation is known, the TRE can be defined as
TRE =

M
1 
L (f [ωr ], j) − L (g, j) l 2
M j =1

(13)

where ωr : R3 → R3 is the recovered geometric transformation,
and M denotes the number of landmarks. The corresponding
anatomical landmark locations of the transformed prior and
real-time images are represented by L (f [ωr ], j) and L (g, j),
respectively, where j = 1, . . . , M . Finally,  · l 2 represents the
Euclidean norm.
B. Controlled Registration Experiment Results
The controlled experimental results obtained using the proposed registration framework are summarized in Fig. 3(a). In
the proposed approach, both the prior and real-time data were
decomposed using the weighted TV flow algorithm, and subsequently registered via minimizing the NGF metric. For comparison, the registration results using the NGF metric with a Perona–
Malik hierarchical decomposition scheme [see Fig. 3(b)] and a
Gaussian hierarchical decomposition scheme [see Fig. 3(c)] are
also presented. Specifically, the same registration framework
shown in Fig. 2 was applied, but the weighted TV flow decomposition step was replaced by the Perona–Malik anisotropic
diffusion filter [33] in the former approach and a Gaussian filter
in the latter approach. Box-and-whisker plots were used to describe the results, since the errors were not normally distributed,
as confirmed by the Anderson–Darling test [37]. The median
TREs for all three registration approaches were below the

Fig. 3. Comparison of registration results using the NGF distance metric and
different image preprocessing schemes. Registration accuracy was evaluated for
aligning prior and real-time images (a) with weighted TV flow preprocessing,
(b) with the Perona–Malik anisotropic diffusion filter preprocessing, and
(c) with Gaussian preprocessing. For each approach, there are four box-andwhisker plots, which illustrates the median (notch), interquartile range (box),
and 10th and 90th percentiles (whiskers) of the TRE after registration for all the
volunteers with an initial known misalignment of d = 5, 10, 15, and 20 mm,
respectively.

desired clinical accuracy of 5 mm (i.e., the dotted line in Fig. 3)
for initial misalignments of up to 20 mm. However, it was observed that lower upper bounds of the TREs were achieved
with the proposed weighted TV flow decomposition scheme.

2626

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Fig. 4. Comparison of registration results using the proposed weighted TV
flow registration framework with different distance metrics. Registration accuracy was evaluated for the (a) NGF metric, (b) NCC metric, and (c) the MI
metric. For each approach, there are 4 box-and-whisker plots, which illustrates
the median (notch), interquartile range (box), and 10th and 90th percentiles
(whiskers) of the TRE after registration for all the volunteers with an initial
known misalignment of d = 5, 10, 15, 20 mm, respectively.

Specifically, when we combined the registration results for all
four initial misalignment distances, the median TREs were 1.28,
1.31, and 1.30 mm for the weighted TV flow, Perona–Malik, and
Gaussian approaches, respectively. However, the TREs at the
90th percentile were 4.27, 6.51, and 9.82 mm for the weighted
TV flow, Perona–Malik, and Gaussian approaches, respectively.
Since the TRE distributions were not normally distributed and
displayed positive skew, the nonparametric Wilcoxon signedrank test [38] was used to test for statistical significance between
the results of the different registration approaches. A paired
difference test was chosen because, in each registration trial,
the different registration approaches all attempted to correct for
the same misalignment generated by a known transformation.
Using the Wilcoxon signed-rank test [38], we found at the 1%
significance level (i.e., p < 0.01) that lower TREs were achieved
using the weighted TV flow approach compared to Perona–
Malik (p < 0.01) and Gaussian (p < 0.01) preprocessing. The
improvement in registration accuracy may be attributed to the
fact that the NGF measure is sensitive to edge information, and
the weighted TV flow decomposition algorithm is better able
to preserve the prominent edges during its iterative filtering
process.
Furthermore, we also compared the registration results obtained via the proposed registration framework using NGF as
the registration metric with other well established distance metrics such as NCC and MI. Specifically, the weighted TV flow
algorithm was first used to extract the different scale features
from the prior and real-time images. Then, the registration was
performed using the NCC or MI metric instead of NGF. The
registration results are shown in Fig. 4. Again, the Wilcoxon
signed-rank test was used, and we observe that registrations

Fig. 5. Controlled registration experiment between prior 3-D volume and
real-time 2-D image. (a) Initially misaligned imaging slice from the prior
3-D volume. (b) Reference 2-D real-time image. (c) Absolute difference image
between images (a) and (b). (d) Registered imaging slice from the prior 3-D volume. (e) Reference 2-D real-time image. (f) Absolute difference image between
the registered images (d) and (e).

with NGF achieved significantly lower TREs compared to registration with NCC (p < 0.01) and MI (p < 0.01).
Overall, it was observed that the lowest median TRE of
1.28 mm was achieved using the combination of NGF as the
distance metric, and weighted TV flow as the image decomposition method. An example of a successful registration using the
proposed method is shown in Fig. 5. Note that the difference
image between the prior and real-time image before registration
[see Fig. 5(c)] shows distinct anatomical structures in the region of interest as highlighted by the circle centered around the
LV. On the other hand, the difference image after registration
[see Fig. 5(f)] shows more uniform intensity variations within
the region of interest, which is due to the inherent difference
in the contrast mechanisms of the two acquisitions rather than
structural misalignment.
C. Free Breathing Registration Experiment Setting
To evaluate the proposed registration framework in a more
clinically relevant scenario, the volunteers were asked to breathe
normally during this experiment, while the real-time images
were continuously acquired. The acquired prior roadmap images still consisted of a stack of slices that covered the entire
LV, and were gated to middiastole and end-expiration as before.
In contrast, the acquired real-time images consisted of a single
imaging slice within the LV and were only retrospectively gated
to the same middiastolic cardiac phase. Since the real-time images were acquired continuously in time, and were not gated to
end-expiration, they could be in any arbitrary respiratory phase.
Moreover, due to the difference in respiratory phase between the
two datasets, the ground truth alignment is unknown. A total of
179 registration cases were performed, which included registrations between 9–29 real-time single slice 2-D images from each
of the eight subjects and their corresponding 3-D prior roadmap
images.

XU et al.: MULTISCALE REGISTRATION OF REAL-TIME AND PRIOR MRI DATA FOR IMAGE-GUIDED CARDIAC INTERVENTIONS

2627

TABLE I
FREE BREATHING REGISTRATION EVALUATION FOR DIFFERENT IMAGE
PREPROCESSING SCHEMES
DSC (%)
Registration
Method
No Registration
NGF + Gaussian
NGF + Perona-Malik
NGF + weighted TV flow

Median

10th
Percentile

90th
Percentile

IQR

88.0
95.0
95.1
95.5

69.6
92.1
92.1
92.9

93.8
96.8
97.1
97.1

8.20
2.40
2.39
1.93

The median, 10th percentile, 90th percentile, and interquartile range (IQR)
values for DSC measurements are shown for N = 179 pairs of real-time and
prior images.

TABLE II
FREE BREATHING REGISTRATION EVALUATION FOR DIFFERENT IMAGE
PREPROCESSING SCHEMES
TRE (mm)
Registration
Method

Fig. 6. DSC measure. (a) Extracted 2-D slice from the prior 3-D volume
before registration and the corresponding manual segmentation of the LV endocardium (dashed line). (b) Direct overlay of the prior mask from (a) is shown
together with the contour of the LV endocardium (solid line) in the real-time
image. (c) Registered prior image with corresponding LV contour (dashed line).
(d) Overlay of the registered prior contour from (c) and contour of the LV (solid
line) in the real-time image.

To correct for the respiratory motion induced misalignment,
we used the proposed registration framework with the NGF
metric to register the prior volume to the real-time image. The
choice of the NGF metric was based on results of the previous controlled registration experiment, where registration using the NGF metric demonstrated higher accuracy compared to
NCC and MI. In terms of image decomposition schemes, we
compared the registration accuracy achieved with the proposed
weighted TV flow algorithm to the Perona–Malik preprocessing
method, and Gaussian preprocessing of the prior and real-time
images.
In this experiment, the registration accuracy was estimated
via the DSC and the in-plane TRE. DSC is defined as [36]
2|Mprior ∩ Mrealtim e |
DSC(Mprior , Mrealtim e ) =
|Mprior | + |Mrealtim e |

(14)

where Mprior and Mrealtim e represent the manual segmentation
masks of the LV endocardial border from the prior and real-time
images, respectively. The DSC measure is illustrated in Fig. 6,
where the overlap between the contours of the LV endocardial
border in the prior and real-time image is shown in Fig. 6(b)
for the initially misaligned case (DSC = 82.9%), and Fig. 6(d)
for the motion corrected case using the proposed registration
method (DSC = 95.2%). The higher DSC indicates improved
image alignment, which is confirmed by visual observation.
Alternatively, the in-plane TRE can also be measured as an
indicator of registration accuracy. Equation (13) can be used to
measure the average distance between visible landmarks (e.g.,

No Registration
NGF + Gaussian
NGF + Perona-Malik
NGF + weighted TV flow

Median

10th
Percentile

90th
Percentile

IQR

4.35
1.70
1.63
1.51

2.30
0.88
0.89
0.85

11.54
3.77
3.34
3.28

3.25
1.22
1.33
1.20

The median, 10th percentile, 90th percentile, and interquartile range (IQR)
values for in-plane TRE measurements are shown for N = 179 pairs of
real-time and prior images.

papillary muscles) in the prior and real-time datasets from the
intersecting imaging plane after registration.
The manual segmentations and landmark identifications were
performed by two experts. Each observer was asked to perform
the segmentation and landmark identification tasks for both the
real-time and prior images, using a custom MATLAB application. Each task was performed in two separate sessions, where
each observer was not aware of the other’s results. The average DSC measure between the two experts’ segmentations was
97.4%, while the average distance between the identified landmarks was 0.80 mm.
D. Free Breathing Registration Experiment Results
The free breathing registration experiment results for DSC
and in-plane TRE are summarized in Tables I and II respectively. As a baseline reference, we computed the median DSC
and in-plane TRE values for the prior and real-time datasets
before registration was applied. As expected, a relatively low
DSC value (88.0%) and a high in-plane TRE (4.35 mm) were
obtained due to misalignments caused by respiratory motion.
Subsequently, a comparison of the three different registration approaches showed that the highest median DSC value
(95.5%) and lowest median in-plane TRE (1.51 mm) were
achieved using the proposed method of applying weighted TV
flow as the preprocessing scheme with NGF as the registration distance metric. Again, using the Wilcoxon signed-rank
test, it was observed that the proposed method achieved higher

2628

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

DSC values compared to Perona–Malik (p < 0.01) and Gaussian
(p < 0.01) approaches. Similarly, the proposed method obtained
lower in-plane TREs compared to Perona–Malik (p < 0.01) and
Gaussian (p < 0.01) approaches.
E. Computational Time
In our experiments, the preprocessing time associated with
weighted TV flow decomposition was approximately 3.08 s for
a multislice prior dataset of size 256 × 256 × 12, and 0.27 s
for a single 2-D real-time image of size 256 × 256. The subsequent coarse-to-fine registration process for a pair of prior and
real-time images required 29.17 ± 3.02 s to complete when the
NGF distance metric was used, whereas the computational time
was 27.94 ± 3.38 s and 30.46 ± 4.25 s for registrations with
the NCC or MI distance metric, respectively. Thus, the computational complexity of NGF is slightly higher than NCC, but
lower than MI. Currently, the overall registration framework is
implemented using unoptimized MATLAB code and evaluated
on a MacBook Pro laptop with 2.66-GHz Core i7 processor and
4GB of RAM.
IV. DISCUSSIONS
A. Distance Metric Evaluation
In the previous section, we demonstrated that the proposed
registration method using the weighted TV flow algorithm and
NGF metric was effective for aligning prior roadmap and realtime MR images. In fact, in our experiments, the NGF metric
outperformed traditional NCC and MI metrics. This may be
explained by analyzing the cost function curves for each metric,
which are visualized in Fig. 7. These cost curves were generated
from a pair of initially aligned prior and real-time images by
applying small rotations and translations to the prior volume
and computing the corresponding distance metric values.2 For
the plots in Fig. 7, no preprocessing techniques were applied
to the prior and real-time images. For each metric, there are
six cost curve plots, corresponding to rotations and translations
in 3-D. In each plot, one registration parameter is varied near
the vicinity of the correct registration value, while the other
parameters are kept constant at the correct registration values.
We observe for the NCC plots [see Fig. 7(a)] that the cost
curves are smoothly varying and have very few local minima.
However, the cost functions have a relatively broad minimum,
and the global minimum for some registration parameters is
shifted from the correct solution at the 0 offset. This suggests
that registrations using the NCC metric should be robust and
generally converge to the near vicinity of the correct solution,
but will not obtain a very accurate registration. This is evident
in the controlled registration experiment see Fig. 4(b)], where
the obtained median TREs were relatively stable in the range of
3–4 mm regardless of the magnitude of the initial misalignment.
In contrast, the MI cost curves [see Fig. 7(b)] are very noisy and
have many local minima, and the global minima from the different cost curve plots are also shifted from the correct solution
at the 0 offset. Therefore, registrations using the MI distance
2 Note

that the cost functions have all been normalized to [0, 1].

metric are prone to be trapped at a local minimum, which can be
far away from the correct registration. This is demonstrated in
the controlled registration experimental results [see Fig. 4(b)],
where the median and upper bounds of the TRE for MI registrations increased significantly as the magnitude of the initial
misalignment increased. Finally, for the NGF cost curves [see
Fig. 7(c)], it is shown that all of the curves except for the translation parameter in the y-direction of the SAX imaging plane
(i.e., Ty ) have a sharp global minimum at the correct registration. This offset in Ty could be due to the presence of imaging
artifacts, which leads to detection and alignment of false edges.
However, this error is minimal, as the NGF cost function is still
dominated by prominent edges corresponding to true anatomical
boundaries. Although the cost curves for NGF are not as smooth
as the NCC curves, the global minima are more sharply defined
and closer to the correct solution. Also, the number of local
minima in the NGF cost curves is significantly less compared
to the MI curves. Accordingly, the median TREs achieved in
the controlled experiment for registrations with the NGF metric
(see Fig. 4) were lower than both NCC and MI.
B. Weighted TV Flow Enhancement
Further improvements to the registration accuracy were observed in both the controlled and free breathing registration
experiments after the weighted TV flow image decomposition
algorithm was applied to the input images. The fact that the
weighted TV flow algorithm behaves as an edge preserving filter is particularly useful when applied in conjunction with an
edge sensitive metric such as NGF, since the latter relies on
identification and alignment of prominent edges in the images.
Additionally, the coarse-to-fine scale registration framework using weighted TV flow can improve the registration robustness by
initially removing fine-scale features, leading to a reduced number of local minima in the cost function. These characteristics
are evident in the NGF cost curves shown in Fig. 8, where the
input prior and real-time images have been preprocessed using
weighted TV flow. We see that all six cost curve plots have their
global minimum close to the zero offset position, and the cost
curves for translations Tx and Ty are smoother compared to the
plot produced in Fig. 7(c). Thus, the combination of weighted
TV flow and NGF produced the best registration results in both
the controlled and free breathing experiments of this study.
C. Limitations and Future Works
In the experiments of this study, a rigid-body transformation
model was chosen to correct for respiratory motion induced
misalignment between the real-time and prior images. It was
shown in [39] that a rigid-body transformation is a reasonable
model to describe respiratory motion of the LV, provided that
ECG gating is used to align the corresponding images in the
same cardiac phase. The same rigid-body transformation model
was also adopted for image registration studies in [5], [6], [21],
and [40], when ECG gating was applied. Alternatively, nonrigid
transformation models could have been used, which include
affine and free-form deformable transformations. The additional
degrees of freedom introduced in nonrigid transformations may

XU et al.: MULTISCALE REGISTRATION OF REAL-TIME AND PRIOR MRI DATA FOR IMAGE-GUIDED CARDIAC INTERVENTIONS

2629

Fig. 7. Cost curves for the different distance metrics. Rotation and translation offsets were applied to a prior image to move it out of alignment with a paired
real-time image. For each transformation, corresponding distance metric values were computed for the (a) NCC metric, (b) MI metric, and (c) NGF metric.

be able to describe the motion of the heart with increased accuracy. However, from an optimization perspective, the additional
degrees of freedom may also lead to convergence to undesirable
local minima due to the nonconvex nature of the optimization
problem. Moreover, the use of nonrigid registration will also
significantly increase the computational time. These are potentially significant drawbacks, as the intended application in this
study is for real-time MR intervention. Therefore, a rigid-body
motion model was adopted in this study.
As part of the future work, we are planning to implement the
proposed registration framework using graphics processing unit

acceleration methods to further reduce the overall computational
time. We believe that near real-time (i.e., <1 s) registration can
be achieved after optimization [41]. However, in the scenario
where the registration speed is still insufficient, the additional latency may potentially be corrected by using a motion modelling
approach [42]. Specifically, the real-time registration method
would be used in an initial calibration stage to create a dynamic motion model, which is then updated periodically as new
registration parameters are obtained. Subsequently, the model
should be able to predict and correct for motion misalignments
with minimal latency.

2630

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Fig. 8. NGF cost curves after preprocessing the aligned prior and real-time images with weighted TV flow for t = 0.25. Rotation and translation offsets were
applied to the filtered prior image to move it out of alignment with the filtered real-time image, and corresponding NGF metric values were computed.

V. CONCLUSION
In this paper, a novel registration framework consisting of
a multiscale edge-preserving filter and an edge-sensitive registration metric was proposed for aligning real-time and prior
roadmap images for the purpose of guiding MRI-based cardiac
interventions. This method was validated in a controlled experiment with known ground truth, as well as in a free breathing
experiment using data acquired from eight human subjects. In
the controlled study, we achieved a median TRE of 1.28 mm for
initial misalignments of up to 20 mm. Alternatively, in the free
breathing experiment, the proposed method achieved a median
in-plane TRE of 1.51 mm. Thus, this proof-of-concept study
showed that it is feasible to correct for respiratory motion induced errors to within the accuracy requirement of our target
application. This combination of motion corrected roadmaps
with real-time imaging should lead to significant improvement
in the guidance of cardiac interventions.



μ D−x 	

+ D−y
=

αi,j D+x ui,j
2
 + (D+x ui,j )2 + (D0y ui,j )2


αi,j (ui+1,j − ui,j )
μ
	
2
2
h
 + (D+x ui,j )2 + (D0y ui,j )2
−	

αi−1,j (ui,j − ui−1,j )
2 + (D−x ui,j )2 + (D0y ui−1,j )2

−	

αi,j −1 (ui,j − ui,j −1 )
2
 + (D0x ui,j −1 )2 + (D−y ui,j )2

CE = 



1
2

CW = 
CS = 

+

(D+x uni,j )2

+ (D0y uni,j )2

1
2 +

(D−x uni,j )2

+ (D0y uni−1,j )2

1
2 + (D0x uni,j )2 + (D+y uni,j )2

CN = 

1
2

+

(D0x uni,j −1 )2

+ (D−y uni,j )2

.

Thus, we get the following discretization for (6):
uni,j+1 − uni,j
=
τ
μn +1
[CE αi,j uni+1,j + CW αi−1,j uni−1,j + CS αi,j uni,j +1
h2
+ CN αi,j −1 uni,j −1



αi,j D+y ui,j
	
2
 + (D0x ui,j )2 + (D+y ui,j )2

αi,j (ui,j +1 − ui,j )
2 + (D0x ui,j )2 + (D+y ui,j )2

where D+ , D− , and D0 denote the forward, backward, and
central difference schemes, respectively. We use the following
notation:

APPENDIX
NUMERICAL SCHEME FOR WEIGHTED TV FLOW
In this section, we provide the details of a fast semi-implicit
numerical scheme for solving the weighted TV flow (6). Let
h and τ be the space and time discretization steps, respectively. We denote the value of the function u at the location
(x, y) ≡ (ih, jh), and at time t = nτ by uni,j . With this notation, we have the following discretization for the right-hand side
of (6):

+	

− (CE αi,j + CW αi−1,j + CS αi,j + CN αi,j −1 )uni,j+1 ]


or
uni,j+1 =
[uni,j h2 + μn +1 τ (CE αi,j uni+1,j + CW αi−1,j uni−1,j
+ CS αi,j uni,j +1 + CN αi,j −1 uni,j −1 )]
.
h2 + μn +1 τ (CE αi,j + CW αi−1,j + CS αi,j + CN αi,j −1 )

XU et al.: MULTISCALE REGISTRATION OF REAL-TIME AND PRIOR MRI DATA FOR IMAGE-GUIDED CARDIAC INTERVENTIONS

ACKNOWLEDGMENT
The authors would like to thank R. Walcarius from Sunnybrook Health Sciences Centre for performing the MRI scans of
the participating subjects.
REFERENCES
[1] V. L. Rogers, A. S. Go, D. M. Lloyd-Jones, E. J. Benjamin, J. D. Berry,
W. B. Borden, D. M. Bravata, S. Dai, E. S. Ford, C. S. Fox, H. J. Fullerton,
C. Gillespie, S. M. Hailpern, J. A. Heit, V. J. Howard, B. M. Kissela, S.
J. Kittner, D. T. Lackland, J. H. Lichtman, L. D. Lisabeth, D. M. Makuc,
G. M. Marcus, A. Marelli, D. B. Matchar, C. S. Moy, D. Mozaffarian,
M. E. Mussolino, G. Nichol, N. P. Paynter, E. Z. Soliman, P. D. Sorlie,
N. Sotoodehnia, T. N. Turan, S. S. Virani, N. D. Wong, D. Woo, and
M. B. Turner, “Heart disease and stroke statistics—2012 update: A report
from the American Heart Association,” Circulation, vol. 125, pp. e2–e220,
2012.
[2] A. C. Lardo, “Real-time magnetic resonance imaging: Diagnostic and
interventional applications,” Pediatric Cardiol., vol. 21, pp. 80–98, 2000.
[3] A. Kolandaivelu, A. C. Lardo, and H. R. Halperin, “Cardiovascular magnetic resonance guided electrophysiology studies,” J. Cardiovasc. Magn.
Reson., vol. 11, p. 21, 2009.
[4] A. P. King, R. Boubertakh, K. S. Rhode, Y. L. Ma, P. Chinchapatnam,
G. Gao, T. Tangcharoen, M. Ginks, M. Cooklin, J. S. Gill, D. J. Hawkes, R.
S. Razavi, and T. Schaeffter, “A subject-specific technique for respiratory
motion correction in image-guided cardiac catheterization procedures,”
Med. Image Anal., vol. 13, pp. 419–431, 2009.
[5] X. Huang, J. Ren, G. Guiraudon, D. Boughner, and T. Peters, “Rapid
dynamic image registration of the beating heart for diagnosis and surgical
navigation,” IEEE Trans. Med. Imag., vol. 28, no. 11, pp. 1802–1814, Nov.
2009.
[6] R. Smolı́ková-Wachowiak, M. P. Wachowiak, A. Fenster, and M. Drangova, “Registration of two-dimensional cardiac images to preprocedural
three-dimensional images for interventional applications,” J. Magn. Reson. Imag., vol. 22, pp. 219–228, 2005.
[7] Y. L. Ma, G. P. Penney, C. A. Rinaldi, M. Cooklin, R. Razavi, and K.
S. Rhode, “Echocardiography to magnetic resonance image registration
for use in image-guided cardiac catheterization procedures,,” Phys. Med.
Biol., vol. 54, no. 16, pp. 5039–5055, 2009.
[8] B. A. Hoffmann, A. Koops, T. Rostock, K. Mullerleile, D. Steven, R. Karst,
M. U. Steinke, I. Drewitz, G. Lund, S. Koops, G. Adam, and S. Willems,
“Interactive real-time mapping and catheter ablation of the cavotricuspid
isthmus guided by magnetic resonance imaging in a porcine model,” Eur.
Heart J., vol. 31, pp. 450–456, 2010.
[9] Y. Ma, A. P. King, N. Gogin, G. Gijsbers, C. Rinaldi, J. Gill, R. Razavi, and
K. S. Rhode, “Clinical evaluation of respiratory motion compensation for
anatomical roadmap guided cardiac electrophysiology procedures,” IEEE
Trans. Biomed. Eng., vol. 59, no. 1, pp. 122–131, Jan. 2012.
[10] A. J. Dick, M. A. Guttman, V. K. Raman, D. C. Peters, B. S. Pessanha, J.
M. Hill, S. Smith, G. Scott, E. R. McVeigh, and R. J. Lederman, “Magnetic
resonance fluoroscopy allows targeted delivery of mesenchymal stem cells
to infarct borders in swine,” Circulation, vol. 108, pp. 2899–2904, 2003.
[11] V. Y. Reddy, Z. J. Malchano, G. Holmvang, E. J. Schmidt, A. d’Avila, C.
Houghtaling, R. C. Chan, and J. N. Ruskin, “Integration of cardiac magnetic resonance imaging with three-dimensional electroanatomic mapping
to guide left ventricular catheter manipulation: Feasibility in a porcine
model of healed myocardial infarction,” J. Amer. Coll. Cardiol., vol. 44,
pp. 2202–2213, 2004.
[12] Z. J. Malchano, P. Neuzil, R. C. Cury, G. Holmvang, J. Weichet, E. J.
Schmidt, J. N. Ruskin, and V. Reddy, “Integration of cardiac CT/MR imaging with three-dimensional electroanatomical mapping to guide catheter
manipulation in the left atrium: Implications for catheter ablation of atrial
fibrillation,” J. Cardiovasc. Electrophysiol., vol. 17, pp. 1221–1229, 2006.
[13] S. R. Dukkipati, R. Mallozzi, E. J. Schmidt, G. Holmvang, A. d’Avila, R.
Guhde, R. D. Darrow, G. Slavin, M. Fung, Z. Malchano, G. Kampa, J. D.
Dando, C. McPherson, T. K. Foo, J. N. Ruskin, C. L. Dumoulin, and V. Y.
Reddy, “Electroanatomic mapping of the left ventricle in a porcine model
of chronic myocardial infarction with magnetic resonance based catheter
tracking,” Circulation, vol. 118, pp. 853–862, 2008.
[14] K. McLeish, D. Hill, D. Atkinson, J. M. Blackall, and R. Razavi, “A study
of the motion and deformation of the heart due to respiration,” IEEE Trans.
Med. Imag., vol. 21, no. 9, pp. 1142–1150, Sep. 2002.

2631

[15] A. D. Scott, J. Keegan, and D. N. Firmin, “Motion in cardiovascular MR
imaging,,” Radiology, vol. 250, no. 2, pp. 331–351, 2009.
[16] B. Fei, J. L. Duerk, D. T. Boll, J. S. Lewin, and D. L. Wilson, “Slice-tovolume registration and its potential application to interventional MRIguided radio-frequency thermal ablation of prostate cancer,” IEEE Trans.
Med. Imag., vol. 22, no. 4, pp. 515–525, Apr. 2003.
[17] P. Su, J. Yang, K. Lu, N. Yu, S. Wong, and Z. Xue, “A fast CT and CTfluoroscopy registration algorithm with respiratory motion compensation
for image-guided lung intervention,” IEEE Trans. Biomed. Eng., vol. 60,
no. 7, pp. 2034–2041, Jul. 2013.
[18] D. Li, H. Li, H. Wan, J. Chen, G. Gong, H. Wang, L. Wang, and Y.
Yin, “Multiscale registration of medical images based on edge preserving
scale space with application in image-guided radiation therapy,,” Phys.
Med. Biol., vol. 57, no. 16, pp. 5187–5204, 2012.
[19] D. Paquin, D. Levy, and L. Xing, “Multiscale registration of planning
CT and daily cone beam CT images for adaptive radiation therapy,” Med.
Phys., vol. 36, pp. 4–11, 2009.
[20] T. Mäkelä, P. Clarysse, O. Sipilä, N. Pauna, Q. C. Pham, T. Katila, and
I. E. Magnin, “A review of cardiac image registration methods,” IEEE
Trans. Med. Imag., vol. 21, no. 9, pp. 1011–1021, Sep. 2002.
[21] U. E. Aladl, G. A. Hurwitz, D. Dey, D. Levin, M. Drangova, and P. J.
Slomka, “Automated image registration of gated cardiac single-photon
emission computed tomography and magnetic resonance imaging,,” J.
Magn. Reson. Imag., vol. 19, no. 3, pp. 283–290, 2004.
[22] D. Perperidis, R. H. Mohiaddin, and D. Rueckert, “Spatio-temporal freeform registration of cardiac MR image sequences,,” Med. Imag. Anal.,
vol. 9, no. 5, pp. 441–456, 2005.
[23] F. Gigengack, L. Ruthotto, M. Burger, C. H. Wolters, X. Jiang, and K.
P. Schafers, “Motion correction in dual gated cardiac PET using masspreserving image registration,” IEEE Trans. Med. Imag., vol. 31, no. 3,
pp. 698–712, Mar. 2012.
[24] W. Shi, X. Zhuang, H. Wang, S. Duckett, D. V. Luong, C. Tobon-Gomez,
K. Tung, P. J. Edwards, K. S. Rhode, R. S. Razavi, S. Ourselin, and
D. Rueckert, “A comprehensive cardiac motion estimation framework
using both untagged and 3-D tagged MR images based on nonrigid registration,” IEEE Trans. Med. Imag., vol. 31, no. 6, pp. 1263–1275, Jun.
2012.
[25] E. Haber and J. Modersitzki, “Beyond mutual information: A simple and
robust alternative,,” in Bildverarbeitung für die Medizin 2005, H. Meinzer,
H. Handels, A. Horsch, and T. Tolxdorff, Eds. Berlin, Germany: Springer,
2005, pp. 350–354.
[26] P. Thevenaz, U. E. Ruttimann, and M. Unser, “A pyramid approach to
subpixel registration based on intensity” IEEE Trans. Image Process.,
vol. 7, no. 1, pp. 27–41, Jan. 1998.
[27] J. Modersitzki, Numerical Methods for Image Registration. New York,
NY, USA: Oxford Univ. Press, 2004.
[28] L. I. Rudin, S. Osher, and E. Fatemi, “Nonlinear total variation based noise
removal algorithms,,” Phys. D, vol. 60, no. 1, pp. 259–268, 1992.
[29] E. Tadmor, S. Nezzar, and L. Vese, “A multiscale image representation
using hierarchical (BV, L2 ) decompositions,,” Multiscale Model. Simul.,
vol. 2, no. 4, pp. 554–579, 2004.
[30] P. Athavale, R. Xu, P. Radau, A. Nachman, and G. Wright, “Multiscale TV
flow with applications to fast denoising and registration,” in Proc. SPIE
Med. Imag., Image Process., 2013, pp. 86692K1–86692K7.
[31] G. Aubert, and P. Kornprobst, Mathematical Problems in Image Processing: Partial Differential Equations and the Calculus of Variations,
vol. 147. New York, NY, USA: Springer, 2006.
[32] F. Andreu, C. Ballester, V. Caselles, and J. Mazón, “Minimizing total
variation flow,,” Differ. Integral Equ., vol. 14, no. 3, pp. 321–360, 2001.
[33] P. Perona and J. Malik, “Scale-space and edge detection using anisotropic
diffusion,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 12, no. 7, pp.
629–639, Jul. 1990.
[34] P. Guidotti, “A new nonlocal nonlinear diffusion of image processing,,” J.
Differ. Equ., vol. 246, no. 12, pp. 4731–4742, 2009.
[35] J. A. Nelder and R. Mead, “A simplex method for function minimization,”
Comput. J., vol. 7, pp. 308–313, 1965.
[36] K. H. Zou, S. K. Warfield, A. Bharatha, C. Tempany, M. R. Kaus, S. J.
Haker, W. M. Wells III, F. A. Jolesz, and R. Kikinis, “Statistical validation
of image segmentation quality based on a spatial overlap index,,” Acad.
Radiol., vol. 11, no. 2, pp. 178–189, 2004.
[37] T. W. Anderson and D. A. Darling, “A test of goodness of fit,” J. Amer.
Stat. Assoc., vol. 49, no. 268, pp. 765–769, 1954.
[38] F. Wilcoxon, “Individual comparisons by ranking methods,” Biometrics
Bull., vol. 1, no. 6, pp. 80–83, 1945.

2632

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

[39] G. Shechter, C. Ozturk, J. R. Resar, and E. R. McVeigh, “Respiratory
motion of the heart from free breathing coronary angiograms,” IEEE
Trans. Med. Imag., vol. 23, no. 8, pp. 1046–1056, Aug. 2004.
[40] G.-A. Turgeon, G. Lehmann, G. Guiraudon, M. Drangova, D. Holdsworth,
and T. Peters, “2D-3D registration of coronary angiograms for cardiac
procedure planning and guidance,,” Med. Phys., vol. 32, no. 12, pp. 3737–
3749, 2005.
[41] R. Membarth, F. Hannig, J. Teich, M. Korner, and W. Eckert, “Frameworks
for GPU accelerators: A comprehensive evaluation using 2D/3D image
registration,” in Proc. IEEE 9th Symp. Appl. Specific Processors, 2011,
pp. 78–81.

[42] J. McClelland, D. J. Hawkes, T. Schaeffter, and A. P. King, “Respiratory
motion models: A review,,” Med. Imag. Anal., vol. 17, no. 1, pp. 19–42,
2013.

Authors’ photographs and biographies not available at the time of publication.

