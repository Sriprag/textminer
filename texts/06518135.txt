IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

2771

Numerical Analysis and Design of Single-Source
Multicoil TMS for Deep and Focused Brain
Stimulation
Luis Gomez∗ , Student Member, IEEE, Frantishek Cajko, Luis Hernandez-Garcia, Anthony Grbic, Member, IEEE,
and Eric Michielssen, Fellow, IEEE

Abstract—Transcranial magnetic stimulation (TMS) is a tool for
noninvasive stimulation of neuronal tissue used for research in cognitive neuroscience and to treat neurological disorders. Many TMS
applications call for large electric fields to be sharply focused on
regions that often lie deep inside the brain. Unfortunately, the fields
generated by present-day TMS coils diffuse and decay rapidly as
they penetrate into the head. As a result, they tend to stimulate
relatively large regions of tissue near the brain surface. Earlier
studies suggested that a focused TMS excitation can be attained
using multiple nonuniformly fed coils in a multichannel array.
We propose a systematic, genetic algorithm-based technique for
synthesizing multichannel arrays that minimize the volume of the
excited region required to achieve a prescribed penetration depth
and maintain realistic values for the input driving currents. Because multichannel arrays are costly to build, we also propose a
method to convert the multichannel arrays into single-channel ones
while minimally materially deteriorating performance. Numerical
results show that the new multi- and single-channel arrays stimulate tissue 2.4 cm into the head while exciting 3.0 and 2.6 times less
volume than conventional Figure-8 coils, respectively.
Index Terms—Coil arrays, genetic algorithm, magnetic stimulation, multichannel magnetic stimulation, Pareto optimization,
transcranial magnetic stimulation (TMS).

I. INTRODUCTION
RANSCRANIAL magnetic stimulation (TMS) is a noninvasive technique that holds significant promise as a tool
for cognitive neuroscience [1]–[5] and the treatment of neurological disorders [1], [6]–[8]. In TMS, one or more coils located
near the scalp produce magnetic fields that in turn induce electric
fields and eddy currents in the conductive brain tissue. When the

T

Manuscript received September 5, 2012; revised March 2, 2013 and May 8,
2013; accepted May 9, 2013. Date of publication May 22, 2013; date of current
version September 14, 2013. This work was supported by the National Institutes
of Health (NS058691). Asterisk indicates corresponding author.
∗ L. Gomez is with the Department of Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, MI 48109 USA (e-mail:
luisgo@umich.edu).
F. Cajko and L. Hernandez-Garcia are with the Department of Biomedical Engineering, University of Michigan, Ann Arbor, MI 48109 USA (e-mail:
fcajko@umich.edu; hernan@umich.edu).
A. Grbic and E. Michielssen are with the Department of Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, MI 48109 USA
(e-mail: agrbic@umich.edu; emichiel@eecs.umich.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2264632

Fig. 1. Popular TMS coils. (a) Figure-8 coil, (b) Magstim BC-70 (commercial
Figure-8 coil), (c) Hesed-coil, and (d) square multichannel array.

spatial gradient of the electric field aligns with a nerve fiber, an
action potential is generated [9], [10]. Many TMS applications
call for large electric fields that are sharply focused on target
regions deep in the brain. Unfortunately, present TMS coils generate rather diffuse fields that decay rapidly with distance from
the scalp; these fields often excite tissue well outside the target
region and/or fail to reach it altogether [11]. This paper proposes
a methodology for designing a new class of single-feed TMS
coil arrays that significantly outperform present coils.
TMS coils capable of producing sharply focused fields that
deeply penetrate the brain have been a long elusive research goal.
To produce more focused excitations than achievable with a single circular loop [12], Ueno proposed the “Figure-8” coil, which
consists of two coplanar circular coils with currents flowing in
opposite directions [see Fig. 1(a) and (b)] [13]. Others enhanced
his design by varying the loop radii, the loop inclination angle,
and the number and orientation of the windings [14]–[16]. When
compared to a single circular coil, the Figure-8 coil generates
fields that are strongly concentrated near the coil center and
thus produces a more compact excitation. Unfortunately, when
using a Figure-8 coil to excite matter deep in the brain, large
electric fields normal to the scalp are generated. These fields
lead to charge buildup on the scalp surface and often cause
painful muscle contractions [17]. To penetrate the brain more
deeply than achievable with a Figure-8 coil, Roth et al. proposed
the “H-coil,” which consists of a closed network of wires that
run tangential to the scalp with feedback paths removed from
the head [see Fig. 1(c)] [18]. In contrast to a circular or Figure-8

0018-9294 © 2013 IEEE

2772

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

coil, the H-coil induces electric fields that are mostly tangential
to the scalp; hence, it minimizes charge buildup on the air–scalp
interface and can be used to drive fields deeper into the brain.
Unfortunately, the H-coil produces a rather uniform field across
the scalp and results in little or no improvement in field focus over a Figure-8 coil. The literature abounds with studies of
single-channel coils that represent various degrees of compromise between the Figure-8 and H-coils in terms of focus and
penetration depth [19]–[25].
To bypass the limitations of single-channel coils, array configurations are called for. Multichannel TMS arrays composed
of many independently driven coils have been shown to deliver a
more concentrated and deeply penetrating field than single coils
[see Fig. 1(d)] [26]. That said, multichannel arrays have never
enjoyed the popularity of single-channel coils. We attribute this
to two factors.
Lack of robust array optimizers: The total field induced in the
head by a nonuniformly fed coil array is the superposition of the
fields produced by the individual coils. As the latter are linearly
proportional to their driving currents, the design of a multichannel coil array invariably involves a search for combinations of
coil currents that result in electric fields that “optimally” stimulate the brain. To find optimal driving currents, Ruohonen and
Ilmoniemi [26] suggested a technique that minimizes the difference between the total field and a desired field distribution.
In [27], a Genetic Algorithm (GA), viz., a robust search scheme
that mimics natural evolution, was used to minimize total power
dissipated in the head while maximizing the magnetic field at a
target point and minimizing it at nearby locations. Other studies
evaluated fields due to a small set of predetermined currents
and ranked coil designs accordingly [28]. All these methods
explicitly or implicitly require specification of a desired ideal
field distribution that may be unrealizable, are somewhat limited
in their ability to incorporate supplementary design constraints,
and oftentimes assume idealized head models. For the use of coil
arrays for TMS to become more widespread, there needs to be
a procedure that, given an array topology and a realistic model
of the human head, can automatically and robustly find driving currents that achieve optimal tradeoffs between penetration
depth and compactness of excitation.
Difficulty of realizing multichannel feeds: In previous studies, numerous planar and conformal array configurations have
been considered. Planar arrays consisted of circular coils arranged on a rectangular or hexagonal grid [27]. Han et al. [29]
proposed using two parallel but mutually shifted arrays. They
showed that the use of shifted arrays can improve field focus
without decreasing coil radii, which is beneficial since arrays
with elements with larger radii are easier to build. Conformal
arrays have been designed by tilting the outer coils of a flat
hexagonal arrangement [27] and by using loosely packed elements [28]. Unfortunately, each coil of the arrays requires an
independent and expensive driver. The complexity and cost of
present multichannel feeds restricts the use of TMS coil arrays
among researchers and clinicians.
Here, we suggest a two-pronged approach at eliminating the
weaknesses of present methods for designing and implementing TMS coil arrays. First, we propose a GA-based optimiza-

tion strategy that, for a given array configuration, robustly determines sets of driving currents that achieve Pareto-optimal
tradeoffs between field penetration depth and volume of excitation. The scheme seeks optimal combinations of fields produced
by individual coils that are evaluated using a finite difference
technique suited for modeling both idealized and realistic head
models. Second, we propose a simple but effective scheme for
converting a multichannel array produced by the above optimizer into a single-channel configuration that performs (nearly)
as well as the multichannel design from which it originates. The
transformation from multi- to single-channel arrays is achieved
by interconnecting and scaling the individual coils that make up
the original multichannel array. We demonstrate the above twopronged approach by synthesizing single-channel rectangular
arrays consisting of variable-radius circular coils [see Fig. 2(b)
and (c)] capable of producing highly focused fields. For example, the optimized single-channel array produces fields that
penetrate 2.4 cm into the head while exciting 2.6 times less
volume than a Figure-8 coil. When exciting 0.3% of the head’s
volume, the optimized array’s fields reach 2.7 cm into the head
while those of the Figure-8 coil do not penetrate deeper than
1.5 cm.

II. METHODS
This section details the proposed two-pronged approach for
designing optimal single-channel TMS coil arrays. Section II-A
describes a technique for synthesizing multichannel arrays that
realize Pareto-optimal tradeoffs between penetration depth and
excitation volume. Section II-B outlines a procedure for converting a multichannel array that realizes a prescribed penetration
depth into a (practical) single-channel array.

A. Design of Pareto-Optimal Multichannel Arrays
1) Problem Definition: We consider a multichannel array
composed of Nc single-turn coils with fixed orientation, shape,
dimension, and position relative to the head H. We assume
that the coils are driven by currents I(t) = I p(t) where I =
{I1 , I2 , . . . , IN c } is a vector of current amplitudes and p(t)
is a known unit pulse, i.e., |p(t)|m ax = 1. The head H is defined by its electric conductivity specified on a dense Cartesian
grid. We develop a procedure for finding sets of driving currents I = {I1 , I2 , . . . , IN c } that realize “Pareto-optimal tradeoffs” between field penetration depth and excited volume. We
first explain this concept.
The effects of TMS fields on the brain are complex and highly
dependent on the magnitude and timing of the TMS pulse [14].
Although small fields can potentially cause neurons to depolarize, we assume that neuronal activity occurs when the electric
field magnitude exceeds an excitation threshold ET . Throughout this paper, we use ET = 150 V/m [30]; we note that all
procedures, however, remain valid for other threshold values as
well. To characterize a current vector I in terms of its effectiveness at stimulating a target located d below the scalp surface,

GOMEZ et al.: NUMERICAL ANALYSIS AND DESIGN OF SINGLE-SOURCE MULTICOIL TMS FOR DEEP AND FOCUSED BRAIN STIMULATION

2773

Fig. 2. Conversion from a multichannel array, driven with Io p t , to a single-channel array. (a) Initial multichannel configuration. (b) New equivalent design
consisting of multiple coils each containing multiple circular windings and an inner winding and with each element driven with an identical current Isc . (c) Final
design with all the coil elements connected in series by a feed-network that during operation negligibly contributes to the stimulating field; this is done by placing
elements, which have currents of opposing polarities close to each other.

we define


B (I, d) =
v (I) =

True |E(d ẑ, I)| ≥ ET
False |E(d ẑ, I)| < ET

1dr.

(1)
(2)

r∈H ∧|E(r,I)≥E T

The Boolean penetration B (I, d) indicates whether the target is excited and v (I) is the volume of excited tissue. Here,
|E(r, I)| is the maximum of the magnitude of the electric field
produced at r ∈ H for the duration of p(t), and r = ρ + zẑ; ẑ
is the unit vector along the z-axis and ρ is a vector perpendicular to the z-axis, which is kept constant. This axis runs normal
to the scalp surface; z = 0 on the scalp surface and z > 0 inside H. The location of the z = 0 point on the scalp surface is
application dependent. Next, we define Iopt (d) as
Iopt (d) = arg min v (I)
I∈RN c

subject to:

B (Iopt (d), d ẑ) = True, and
|E(r, Iopt (d))| ≤ EM ∀r ∈ H.

(3)

Among all currents that generate fields that penetrate a distance d below the scalp surface, Iopt (d) excites the smallest
volume. The second of the constraints ensures that field magnitudes never exceed EM , a threshold beyond which painful
muscle twitching may occur; we use EM = 450 V/m [17]. To
find Iopt (d), we carry out an optimization procedure (detailed
below) that starts from d = 0, and slowly increments d until
d = dm ax where (3) has no solution, meaning that no currents
can be found that produce a large enough field d below the scalp
surface without exceeding the maximum magnitude EM elsewhere in H. The (Pareto) function v (Iopt (d)) = v m in (d), 0 ≤
d < dm ax , provides the smallest excitation volume possible for
a given target depth d; its inverse dm ax (v) yields the largest
depth that can be reached for a given excitation volume. The
set of currents Iopt (d) is termed Pareto-optimal, as they represent excitations that optimally tradeoff penetration depth versus
excitation volume.

Sections II-A2 and II-A3 describe methods for solving optimization problem (3) for a given d, and for rapidly evaluating
|E(r, I)|.
2) Genetic Algorithm for Finding Iopt (d): To find Iopt (d),
we execute a simple, single-objective GA made out of various
functions from MATLAB’s GA toolbox [31]. Briefly, GAs generate solutions to optimization problems by mimicking natural
evolution [32]. When compared to gradient-based optimization
schemes, they are well suited for solving optimization problems
involving highly multimodal cost functions. Our experience indicates that (3) falls in this category. To this end, GAs consider
not one, but successive “populations of candidate designs” that,
on average, exhibit improved characteristics. In our problem, the
optimization parameters are scaled currents I˜i , i = 1, . . . , Nc ,
assigned integer values between –999 and 999. These scaled
currents or “genes” are arranged in a “chromosome” describing
a scaled candidate design as Ĩ = {I˜1 , I˜2 , . . . , I˜N c }. An initial
population of Np op candidate designs {Ĩ1 , Ĩ2 , . . . , ĨN p o p } is assembled by randomly selecting the value of each gene in every
chromosome uniformly from the above range. Next, the (maximum in time) magnitude of the field E(ẑ d, Ĩj ) is computed for
all candidate designs, and unscaled currents are computed as
Ij =

Ĩj ET
|E(ẑ d, Ĩj )|

(4)

thereby guaranteeing that the fields of the unscaled candidate
design reach the target depth d, i.e., |E(ẑ d, Ij )| = ET . Next, for
each member of the population, we compute the cost function


⎧
v(Ij )
if maxr∈H E(r, Ij ) ≤ EM
⎪
⎨  


(5)
C(j) =
1dr if maxr∈H E(r, Ij ) > EM
⎪
⎩
r∈H

and rank all candidate designs according to their cost function
value. Finally, a new generation of candidate designs is generated by executing three operations. First, the Nelite < Np op candidate designs with the lowest cost function values are automatically carried over to the next generation. Next, Np op − Nelite
additional designs are generated by mating old candidate designs by recombining their genes. The participation of old

2774

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

candidate designs in the mating process is governed by a process known as roulette wheel selection, designed to ensure that
the “fittest” among the old candidates designs produce more
offspring than average candidate designs. Assuming that old
candidate designs Ĩi and Ĩj are selected for mating, their offspring is Ĩchild = (1 − β)Ĩi + β Ĩj 	; β is randomly selected
in the range 0 < β < 1 and .	 rounds to the nearest integer.
Finally, all chromosomes representing new candidate designs
are subject to mutation, i.e., small perturbations designed to
maintain genetic diversity.
The process of generating new populations from old ones is
repeated until no appreciable improvements in the lowest value
of the cost function recorded are made. The unscaled candidate
design with the lowest cost value encountered during the GA
run is returned as Iopt (d).
3) Fast Computation of Fields Due to Prescribed Coil Currents: Execution of the GA often requires hundreds of thousands of evaluations of electric fields E(r, I) throughout H
excited by magnetic fields produced by prescribed coil currents
I. This section, therefore, describes a technique for computing
these fields rapidly.
Let Ei (r, t) denote the electric field at position r ∈ H when
coil i supports current p(t); all other coils are assumed inactive.
For typical p(t), see [33]. All fields Ei (r, t), i = 1, . . . , Nc ,
are computed prior to starting the optimization process using the
quasi-static finite difference method for typical TMS pulses with
maximum frequency in the 1–10 kHz range proposed by Cerri
[34]. The method assumes that inductive coupling involving
eddy currents generated inside the brain can be neglected; it
also neglects displacement currents because inside brain tissue
they are much smaller than the conduction currents generated
by typical TMS pulses. Using this method, we first calculate the
magnetic field Bi (r, t) using the Biot–Savart law as

Cerri [34] and use a quadrature rule to calculate the magnetic
field Bi (r, t) throughout a rectangular domain that contains the
coil and head. Then, we solve for the electric field by approximating the brain by a collection of homogenous [constant σ(r)]
conductive cubic cells. We consider as unknowns the components of Ei (r, t) normal to, and sampled at, the centers of cell
facets. To solve for these unknowns, we apply (8) on cell faces
and use magnetic fields computed using (8) to evaluate its righthand side. Equation (9) is applied on a cubic volume centered
about each node. The resulting sparse system of equations for
the sampled component values of Ei (r, t) is solved by an iterative least squares (LSQR) procedure [35]. The LSQR procedure
is terminated when the sampled component field values result
in a relative residual norm error that is less than 10−6 .
Let E(r, t, I) denote the total electric field due to currents
I(t). Clearly, E(r, t, I) can be computed by linear superposition
of the fields Ei (r, t) as

Bi (r) = p(t)Li (r)
	
μ0
r − ri (s)
t̂i (s) ×
ds.
Li (r) =
4π Coil i
|r − ri (s)|3

B. Conversion of Multichannel Array to Single-Channel Array

(6)
(7)

Here, μ0 is the free-space permeability, s is a length coordinate that varies in the interval 0 ≤ s < Ci with Ci the circumference of coil i, ri (s) denotes a position vector on coil i, and
t̂i (s) is the unit vector tangential to coil i at ri (s). Throughout the head H and its surroundings, the electric field Ei (r, t)
satisfies
	

d
Ei (r, t) · dl = −
Bi (r, t) · ds
dt
C
S

dp(t)
=−
Li (r) · ds
(8)
dt
S

σ(r)Ei (r, t).ds = 0
(9)
Sc

where σ(r) denotes the conductivity at r, C is an arbitrary contour enclosing a surface S, and Sc is an arbitrary closed surface.
Jumps in the electric field across boundaries [enforced by (9)]
result in charges, and hence, they are (implicitly) accounted for
by the model. To solve (7)–(9) for Ei (r, t), we again follow

E(r, t, I) =

Nc



Ii Ei (r, t).

(10)

i=1

In what follows, let Ei (r) = Ei (r, tm ax ) denote Ei (r, tm ax ),
where tm ax maximizes |∂p(t)/∂t| for the duration of the TMS
pulse. As each coil is excited by the same pulse shape, tm ax does
not depend on i. The well-defined field E(r, I) = Ei (r, tm ax , I),
therefore, can be computed as
E(r, I) =

Nc



Ii Ei (r).

(11)

i=1

Since the fields Ei (r) are precomputed prior to executing
the GA, (11) can be evaluated for many different I at minimal
computational cost.

The above procedure yields a set of Pareto-optimal driving
(d)} for penetracurrents Iopt (d) = {I1opt (d), I2opt (d), ..., INopt
c
tion depths 0 < d ≤ dm ax . In principle, these currents can be
stored in a lookup table and fed into the array’s Nc coils by
means of separate tunable drivers [see Fig. 2(a)]. While costly
and bulky, such a feed would permit on-the-fly array reconfiguration to reach varying targets using Pareto-optimal, minimum
volume excitations.
If no reconfiguration is required, i.e., if the array targets a
fixed penetration depth d∗ , then the multichannel array can
be converted into a single-channel (sc) array that is much
cheaper to construct. The single-channel array is fed a current
Isc = α max{|Ii∗ |, i = 1, ..., Nc } > 0 where Ii∗ = Iiopt (d∗ )
and α is typically chosen in the range 0.05 < α < 0.2 (see
Section III-C). To simplify the discussion, we assume that the
single-turn coils in the multichannel array are circular with radius r; the proposed procedure is easily generalized to other coil
shapes as well. The conversion procedure involves two steps.
First, each single-turn coil in the multichannel array is replaced by a multiturn coil [see Fig. 2(b)]. Specifically, singleturn coil i is replaced by a multiturn coil with ni + 1 windings:
ni windings of the original coil and a single, concentrically

GOMEZ et al.: NUMERICAL ANALYSIS AND DESIGN OF SINGLE-SOURCE MULTICOIL TMS FOR DEEP AND FOCUSED BRAIN STIMULATION

positioned coil of radius r̃i < r, with
 ∗ 
I 
ni =  i 
Isc

r̃i = r2 |Ii∗ /Isc | − ni r2 .

2775

(12)
(13)

The large and small coils are connected and their windings
have identical polarity. The total magnetic dipole moment of
a single-turn coil traversed by current Ii∗ is identical to that of
composite coil i traversed by Isc . Beyond a certain distance from
the coil, the fields generated by a composite coil, therefore, will
closely match those of its single-turn counterpart; hence, the
composite coils will stimulate a region closely matching that of
its parent design.
Second, all multiturn coils connected in series using a carefully designed feed-network that negligibly contributes to the
stimulating field [see Fig. 2(c)]. This is achieved by arranging
the feed in such a way that each current introduced by the feed
network during operation is neighbored by a current of opposing
polarity to allow feed network field cancellation.
III. RESULTS AND DISCUSSION
Even though the proposed technique can be applied to any
multichannel array configuration, here we√limit ourselves
to
√
planar and densely packed square arrays of Nc × Nc circular coils with radius r and array area A = 4r2 Nc positioned
symmetrically w.r.t. and 1 cm removed from the head [see
Fig. 3(a)]. Each time we consider one of 24 arrays resulting from
all the possible combinations of Nc = 16, 36, 64, and 100, and
r = 4, 6, 8,10, 14, and 18 mm. The dm ax (v) Pareto curves for
ax
each design are compared to a similar “dm
F −8 (v)” Pareto curves
ax
in
(v)
curve
and
its inverse vFm−8
(d)
for the Figure-8 coil. The dm
F −8
were generated by brute-force search, that is by varying a
Figure-8’s loop current and radii (allowed range: 15–30 mm),
the angle between its loops (allowed range: 0–180◦ ), and the
height of its vertex above the head (allowed range: 1–3 cm)
ax
[see Fig. 3(b)]. Note that to generate dm
F −8 (v) Pareto curves,
we analyzed Figure-8 coils with different sizes and shapes, and
positioned at various positions relative to the head; in contrast,
to generate dm ax (v) Pareto curves for multichannel designs, we
only vary the amplitudes of the driving currents fed into the
coils.
Sections III-A and III-B demonstrate the applicability of the
proposed method to the design of multichannel arrays residing
above a three (concentric) spherical head model [36] and a
model constructed by segmentation of in vivo MRI data [24].
A. Multichannel Designs For the Three-Sphere Head Model
We consider the “three-sphere” conductive model for the
head proposed by Rush and Driscoll [36], commonly used to
benchmark TMS coils. The model is defined by three concentric spheres with radii of 80, 85, and 92 mm. The inner sphere
and the two shells that cover it model brain, skull, and skin
tissue [see Fig. 3(a) and (b)] and have conductivities of 0.45,
0.05, and 0.45 S/m. We approximate the three-sphere head by
62 × 62 × 62 homogenous cubic voxels each having an edge

Fig. 3. Three-sphere head model. (a) Array is placed 10 mm above the scalp
and centered about the target column (z-axis). (b) Vertex of the Figure-8 coil
is on the target column at a height that varies between 10 and 30 mm above
ax
the head; to find dm
F −8 (v), we allow both the radius (r) and angle (θ) to vary
between 15 and 30 mm and 0◦ and 180◦ .

length of 3 mm; each voxel is assigned a conductivity corresponding to that of the three-sphere head at the voxel center.
Fig. 4(a)–(f) shows dm ax (v) for r = 4, 6, 8, 10, 14,
ax
and 18 mm together with dm
F −8 (v); each subplot shows Pareto
curves for Nc = 16, 36, 64, and 100. The optimized multichannel arrays always outperform optimized Figure-8 coils,
ax
i.e., all dm ax (v) curves reside above the dm
F −8 (v) curve. This
means that for a given excitation volume, multichannel arrays
always produce fields that reach deeper into the head than
those of the Figure-8 coil. Equivalently, for a given penetration depth, the multichannel arrays excite less volume. (Note:
for two of 24 arrays (Nc = 16; r = 4, 6 mm), the safety limit
of EM = 450 V/m is encountered when the penetration depth
is less than 30 mm, a depth achievable by the Figure-8 coils)
Table I lists the minimum v m in (d = 15, 18, . . . , 30 mm) for all
in
(d). Fig. 4
(Nc , r) combinations considered, along with vFm−8
and Table I reveal that multichannel arrays can significantly
outperform Figure-8 coils. For example, fields produced by an
array consisting of Nc = 64 coils with r = 14 mm can penetrate d = 30 mm deep into the head while exciting four times
less volume than a Figure-8 coil.
Fig. 4(a)–(f) also shows that for given v, dm ax increases with
Nc while keeping r fixed, and (mostly) with r while keeping Nc constant. Note that increasing Nc and r also increases
A. Thus, it is unclear from Fig. 4, which of these parameters
was the most responsible for these gains. In order to elucidate

2776

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 5. Largest depth that can be reached for a given excitation volume by mulax
tichannel arrays (dm a x (v)) and Figure-8 coils (dm
F −8 (v)). (a)–(f) Individual
curves for each array with different N c and r but the same A and each individual
has arrays with A = 482 , 642 , 802 , 962 , 1202 , and 1602 mm2 , respectively.
Fig. 4. Largest depth that can be reached for a given excitation volume by
ax
multichannel arrays (dm a x (v)) and Figure-8 coils (dm
F −8 (v)). (a)–(f) Individual curves for each array with different number of coils N c and each individual
panel has results for arrays with coils of radius r = 4, 6, 8, 10, 14, and 18 mm,
respectively.
TABLE I
SMALLEST VOLUME v m in (d) OF ALL ARRAY CONFIGURATIONS CONSIDERED
m
in
AND v F −8 (d) FOR THREE-SPHERE HEAD

this question, Fig. 5(a)–(f) shows Pareto curves for arrays
with different r and Nc but the same A for each subplot. Specifically, it shows dm ax (v) for arrays with A =
ax
482 , 642 , 802 , 962 , 1202 , and 1602 mm2 together with dm
F −8 (v).
m ax
(v),
The plots indicate that increasing A greatly increases d
whereas decreasing r and increasing Nc while keeping A constant only marginally increases dm ax (v). In general, a bigger
array is able to reach deeper into the head than a smaller
one. Note that dm ax (v) for array (Nc = 36, r = 14 mm) and
(Nc = 100, r = 14 mm) are almost identical, and thus, increasing A beyond a size comparable to the head surface seems to
have marginal effects on dm ax (v); this is because as A increases
some of the coils are far away from the head and hence do not
generate strong enough fields to greatly affect the stimulated
region.

Fig. 6. (a) Magnitude of the electric field |E(r)| produced inside the stimulated volume by a coil array with 100 coils of 10 mm radius and driven
with currents optimized for a penetration depth of 24 mm (i.e., driven with
Io p t (d = 24 mm)). (b) Magnitude of the electric field |E(r)| produced inside
the stimulated volume by a Figure-8 coil of 25 mm radius also optimized for a
penetration depth of 24 mm.

To aid in the visualization of how the use of array coils is beneficial, Fig. 6 shows the magnitude of the electric field distribution maps |E(r, Iopt (d = 24 mm))| for an array (with Nc = 100
and r = 10 mm) compared to the electric fields generated by
the optimal Figure-8 coil along the coronal and medial planes
(orthogonal longitudinal planes intersecting on the z = 0 axis).
As evidenced by the figure, the electric fields generated by the
multichannel array produce a far more compact excitation than
the Figure-8 coil; in fact, for this particular case, the excited
in
.
volume v m in for the array was 3.24 times smaller than vFm−8

GOMEZ et al.: NUMERICAL ANALYSIS AND DESIGN OF SINGLE-SOURCE MULTICOIL TMS FOR DEEP AND FOCUSED BRAIN STIMULATION

2777

Fig. 8. Conductivity model of the head derived from an MRI image. The field
of view was 231 × 261 × 219 mm. The conductivity of tissue ranged from
3.9 × 10 −3 to 1.67 S/m. The array was placed 10 mm above the head.
Fig. 7. Total current required by each array driven with currents optimized for each penetration depth Io p t (d) penetration depth (i.e., Io p t (d)).
(a)–(f) Individual curves for each array with different number of coils N c
and each individual panel has results for arrays with coils of radius r =
4, 6, 8, 10, 14, and 18 mm, respectively.

We next focus on the currents Iopt (d) required by multichannel arrays for varying (Nc , r). Specifically, we study the norm
of the driving current Îopt (d) and the average current Iavg
defined as



  dp(tm ax ) opt 
opt

(14)
Î (d) =
Ii (d)

dt
I i ∈I

Îopt (d)
Iˆavg =
.
Nc

(15)

Fig. 7(a)–(f) shows Iopt (d) for r = 4, 6, 8, 10, 14, and
18 mm ; each subplot shows curves for Nc = 16, 36, 64,
and 100. Commercial TMS Figure-8 coils typically consist of
two coils side by side each with 8–12 windings and require
currents of 0.342 kA/μs [37] to induce electric fields of about
300 V/m in the cortex. As expected, Iopt (d) increases with
Nc . However, this increase is only marginal and in most cases
accompanied by a reduction in Iavg . For example, an array
with Nc = 36 and r = 10 mm requires Iopt (d = 24 mm) =
80 kA/μs, while one with Nc = 100 and r = 10 mm requires Iopt (d = 24 mm) = 150 kA/μs, less than a twofold
increase, but Iavg was reduced by a factor of 0.68. In addition, Iopt (d) greatly decreases with r. For example, an array
with Nc = 36 and r = 4 mm requires Iopt (d = 24 mm) =
670 kA/μs, while an array with Nc = 36 and r = 6 mm requires Iopt (d = 24 mm) = 110 kA/μs. There is a sixfold
decrease in Iopt (d), and since Nc is the same for both arrays,
there is also a sixfold decrease in Iavg . Increasing A increases
dm ax (v) while (almost always) decreasing Iopt (d) and Iavg .
We next address feasibility of the proposed designs. TMS
coils having a radius of 12.5 mm driven by currents much greater
than the ones we require have previously been fabricated [38].
We believe that using the same procedures as in [38], all of the
arrays consisting of circular coils having r = 10, 14, and 18 mm
can be constructed; that said, building arrays consisting of coils

TABLE II
TISSUE CONDUCTIVITY VALUES

having r = 4, 6, and 8 mm remains a difficult proposition. If
two arrays have the same area, the one consisting of smaller
coils only marginally outperforms the one with larger coils. In
practice, this obviates the need to build coils of radius less than
10 mm, which has been proven challenging in the past [38].
To analyze the mechanical robustness of the proposed designs,
we used Comsol [39] to compute the von Mises stresses [40]
in all coils, and determined that they are lower than the tensile
strength of N 10 gauge copper wire [41].
B. Multichannel Designs For an MRI-Derived Head Model
We consider a “MRI-derived” conductivity model of the human head [see Fig. 8(a)–(f)] created by segmenting a highresolution MRI image and assigning electrical conductivity values to each tissue type using data from the literature [42] and
given in Table II.
The MRI image consists of 256 × 256 × 124 homogenous
cubic voxels each having an edge length of 1.2 mm and
was obtained by scanning a single male subject in a 3T GE
Signa scanner (Waukesha, WI, USA) using an IR-prepped,
3-D, SPGR pulse sequence (TR = 9.03, TE = 1.84, TI =
500 ms, FOV = 24 cm, and slice thickness = 1.2 mm).
First, the image is segmented into gray matter, white matter, and ventricular CSF by the SPM5 segmentation toolbox
(http://www.fil.ion.ucl.ac.uk/spm). Next, remaining unclassified tissue is further partitioned into another three types, namely,
bone, muscle, and CSF, by FAST, a component of FSL’s image
analysis package (http://www.fmrib.ox.ac.uk/fsl/). Each voxel
is assigned a single conductivity corresponding to the average

2778

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 9. Penetration depth achieved as a function of excitation volume (d(v))
by the multichannel arrays and Figure-8 coils for targeting inside the threesphere head. (a) Results obtained for targeting inside the MRI-derived head. (b)
Results obtained for targeting inside free-space region. Note that in both cases,
achieving a penetration depth beyond 27 and 21 mm, respectively, required
exceeding the safety threshold.

of the conductivities inside it. The resulting conductivity maps
are subsampled to 128 × 128 × 62 voxels with an edge length of
2.4 mm by averaging the conductivity values of each 2 × 2 × 2
block of voxels of the original image. The subsampling speeds
up the computation of the optimum driving currents via the GA
without deteriorating the quality of the final results. As shown
in Fig. 8(a)–(f), the coil is positioned such that its normal at the
center of the coil crosses through the motor cortex.
First, we investigate the fields generated by the arrays, when
driven with the Iopt (d) obtained for the three-sphere head, inside the MRI-derived head. Specifically, we consider the arrays
that can excite each depth d into the head while exciting a v m in
volume that is smaller than all other (Nc , r) configurations.
We analyzed the fields generated by each array inside the MRIderived model, while exciting its respective d, and generate d(v)
curves. Fig. 9(a) and (b) shows d(v) and the same curve for the
ax
Figure-8 coils dm
F −8 (v). For completeness, we also show the
d(v) curve that results when using the same Iopt (d) currents
ax
in arrays operating in free space. (Note that the dm
F −8 (v) curve
becomes flat at depth of 27 mm for the MRI-derived head, and
21 mm for free space, this is because the safety limit of 450 V/m
is encountered and this is the maximum depth achievable by the
Figure-8 coils.) Although the multichannel arrays optimized for
operation near a three-sphere head model continue to outperform Figure-8 coils when operating near the MRI-derived head,
the gains are significantly reduced. The same observation holds
true when the coils operate in free space. This is not surprising because the excited region inside the MRI-derived head is
known to significantly differ from that of the three-sphere head
even if the same TMS coil is used [42]. The multichannel arrays optimized for operation near a three-sphere head thus are
suboptimal for targeting inside a realistic head model.
We, therefore, derived a new set of Iopt (d) for each of
the arrays assuming they operate near the MRI-derived head
model. Figs. 10(a)–(f) and 11(a)–(f) show dm ax (v) for r =
ax
4, 6, 8, 10, 14, and 18 mm, together with dm
F −8 (v), for the MRIderived head in the same way as Figs. 4(a)–(f) and 5(a)–(f).
Again, the optimized multichannel arrays always outperform
optimized Figure-8 coils. Notably, the realized gains greatly exceed those observed when the arrays driven by the three-sphere
head Iopt (d) were used inside the MRI-derived head. Table III
lists the minimum v m in (d = 15, 18, . . . , 30 mm) for all (Nc , r)

Fig. 10. Largest depth that can be reached for a given excitation volume by
ax
multichannel arrays (dm a x (v)) and Figure-8 coils (dm
F −8 (v)). (a)–(f) Individual curves for each array with different number of coils N c and each individual
panel has results for arrays with coils of radius r = 4, 6, 8, 10, 14, and 18 mm,
respectively.
TABLE III
in (d) FOR
v m in (d) OF ALL ARRAY CONFIGURATIONS CONSIDERED AND v Fm −8
MRI-DERIVED HEAD

in
combinations considered, along with vFm−8
(d). Table III reveals
that multichannel arrays can significantly outperform Figure-8
coils at targeting inside the MRI-derived head. For example,
fields produced by an array consisting of Nc = 100 coils with
r = 8 mm can penetrate 24 mm into the head while exciting
3.0 times less volume than a Figure-8 coil. Also, when exciting
0.3% of the head’s volume, the optimized array’s fields reach
2.7 cm into the head while those of the Figure-8 coil do not
penetrate deeper than 1.5 cm.
As was observed for the three-sphere head, dm ax (v) increases
with Nc while keeping r fixed, and (mostly) with r while keeping Nc constant. Also, dm ax (v) increases with A, whereas decreasing r and increasing Nc , while keeping A constant only
marginally increases dm ax (v). Generally speaking, larger area
arrays are capable of generating fields deeper into the head
than smaller ones, and if two arrays have the same physical

GOMEZ et al.: NUMERICAL ANALYSIS AND DESIGN OF SINGLE-SOURCE MULTICOIL TMS FOR DEEP AND FOCUSED BRAIN STIMULATION

2779

Fig. 12. Total current required by each array driven with currents optimized for each penetration depth Io p t (d) penetration depth (i.e., Io p t (d)).
(a)–(f) Individual curves for each array with different number of coils N c
and each individual panel has results for arrays with coils of radius r =
4, 6, 8, 10, 14, and 18 mm, respectively.
Fig. 11. Largest depth that can be reached for a given excitation volume
ax
by multichannel arrays (dm a x (v)) and Figure-8 coils (dm
F −8 (v)). (a)–(f) Each
have individual curves for each array with different N c and r but the same A and
each individual has arrays with A = 48 2 , 642 , 802 , 962 , 1202 , and 1602 mm2 ,
respectively.

dimensions, the one consisting of smaller coils marginally outperforms the one with larger ones.
Fig. 12(a)–(f) shows Iopt (d) for r = 4, 6, 8,10, 14, and
18 mm for multichannel coils operating in the presence of the
MRI-derived head in the same way as Fig. 7(a)–(f) for the threesphere head, each subplot showing the currents corresponding to the Pareto-optimal arrays for Nc = 16, 36, 64, and 100.
Consistent with the results for the three-sphere head, increasing Nc marginally increases Iopt (d) while reducing Iavg .
For example, an array with Nc = 36 and r = 10 mm requires Iopt (d = 24 mm) = 70 kA/μs, while an array with
Nc = 100 and r = 10 mm requires 1.6 times more current,
or Iopt (d = 24 mm) = 110 kA/μs; however, Iavg was reduced by a factor of 0.56. Iopt (d) greatly decreases with
r. For example, an array with Nc = 36 and r = 4 mm requires
Iopt (d = 24 mm) = 390 kA/μs, while an array with Nc =
36 and r = 8 mm requires Iopt (d = 24 mm) = 70 kA/μs;
Iopt (d) is 5.57 times less, and since Nc is the same for both
arrays, Iavg is also 5.57 times less.
C. Single-Channel Conversion
Next, we investigate effects of converting multichannel arrays
designed for operation near the MRI-derived head into single
channel. We consider single-channel designs that are driven by
an Isc equal to α times the maximum of the coil driving currents
of the initial multichannel array. For all (Nc , r) combinations

Fig. 13. Largest depth that can be reached for a given excitation volume by
multichannel arrays (dm a x (v)), single-channel arrays (dsc (v)), and Figure-8
ax
coils (dm
F −8 (v)).

considered, we convert multichannel arrays along the Pareto
curve dm ax (v) for α = 3/40, 1/10, and 1/5 (see Section II-B).
Fig. 13 shows the dsc (v) relationship of the resulting singlechannel arrays alongside the dm ax (v) of the multichannel arrays
ax
m ax
(v) curves
they derive from, and dm
F −8 (v). The dsc (v) and d
nearly overlap, implying that the single-channel conversion does
not deteriorate the array performance. For example, for the
multichannel array with v m in (d = 24 mm) = 0.18 %, the corresponding single-channel design with α = 1/10 excites v =
0.21% or 2.62 times less volume than the optimized Figure-8
to reach the same depth.
It would be advantageous to have a single-channel design that
uses only a single sized loop. We, therefore, created a new set

2780

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 14. Largest depth that can be reached for a given excitation volume
by multichannel arrays (dm a x (v)), single-cannel arrays without inner loop
ax
(ds c (v)), and Figure-8 coils (dm
F −8 (v)).

of designs with α = 1/100, 3/100, and 5/100 and excluded
the internal loop. Fig. 14 shows the resulting dsc (v) curves. As
expected, the performance of these simplified single-channel
arrays degrades with increasing α. However, only minor losses
in performance are seen with α = 3/100. For example, we can
reach d = 24 mm by exciting 0.265% of the head, still 2.08 times
less volume than the Figure-8 coil excites to reach the same
depth.
To verify the feasibility of the multichannel arrays, we computed their resistances and inductances, and determined them to
be comparable to those of typical commercial Figure-8 coils.
IV. CONCLUSION
We have presented and computationally verified a new approach for designing TMS coil arrays. First, we proposed a
GA-based optimization strategy that leverages a finite difference solver to robustly determine sets of array driving currents
that achieve Pareto-optimal tradeoffs between field penetration
depth and compactness of excitation. These multichannel arrays
can be reconfigured to stimulate a prescribed target in the brain
while minimally exciting extraneous tissue. Second, we developed a simple procedure for converting multichannel arrays into
a single-channel configurations that are aimed at specific targets
in the brain but otherwise operate very much like the multichannel arrays from which they derive. The transformation from
multi- to single-channel arrays is achieved by interconnecting
and scaling the individual coils that make up the original multichannel array. Finally, we applied the proposed technique to the
design of arrays composed of variable-radius circular coils that
significantly outperform Figure-8 coils. The proposed technique
yields TMS coil arrays that provide practitioners far greater control of the excited region than existing systems. Future designs
that use spiral coils, which can be easily built on printed circuit
boards, are under development.
REFERENCES
[1] N. Levit-Binnun, N. Z. Handzy, E. Moses, I. Modai, and A. Peled,
“Transcranial magnetic stimulation at M1 disrupts cognitive networks
in schizophrenia,” Schizophrenia Res., vol. 93, pp. 334–344, 2007.

[2] A. Ellison and A. Cowey, “Time course of the involvement of the ventral
and dorsal visual processing streams in a visuospatial task,” Neuropsychologia, vol. 45, pp. 3335–3339, 2007.
[3] A. Pascual-Leone, V. Walsh, and J. Rothwell, “Transcranial magnetic
stimulation in cognitive neuroscience – virtual lesion, chronometry, and
functional connectivity,” Current Opinion Neurobiol., vol. 10, pp. 232–
237, 2000.
[4] D. Pitcher, V. Walsh, G. Yovel, and B. Duchaine, “TMS evidence for
the involvement of the right occipital face area in early face processing,”
Current Biology, vol. 17, pp. 1568–1573, 2007.
[5] J. C. Rothwell, “Paired-pulse investigations of short-latency intracortical facilitation using TMS in humans,” Transcranial Magn. Stimulation,
vol. 51, pp. 113–119, 1999.
[6] T. Burt, S. H. Lisanby, and H. A. Sackeim, “Neuropsychiatric applications
of transcranial magnetic stimulation: a meta analysis,” Int. J. Neuropsychopharmacology, vol. 5, pp. 73–103, 2002.
[7] S. Kähkönen and R. J. Ilmoniemi, “Transcranial magnetic stimulation:
Applications for neuropsychopharmacology,” J. Psychopharmacology,
vol. 18, pp. 257–261, Jun. 1, 2004.
[8] S. H. Lisanby, L. H. Kinnunen, and M. J. Crupain, “Applications of TMS
to therapy in psychiatry,” J. Clinical Neurophysiol., vol. 19, pp. 344–360,
2002.
[9] B. J. Roth, “Mechanisms for electrical stimulation of excitable tissue,”
Crit. Rev. Biomed. Eng., vol. 22, pp. 253–305, 1994.
[10] P. J. Maccabee, V. E. Amassian, L. P. Eberle, and R. Q. Cracco, “Magnetic
coil stimulation of straight and bent amphibian and mammalian peripheral
nerve in vitro: locus of excitation,” J. Physiology, vol. 460, pp. 201–219,
Jan. 1, 1993.
[11] R. Jalinous, “Technical and Practical Aspects of Magnetic Nerve Stimulation,” J. Clinical Neurophysiol., vol. 8, pp. 10–25, 1991.
[12] A. Barker, I. Freeston, R. Jalinous, P. Merton, and H. Morton, “Magnetic
stimulation of the human brain,” J. Physiol., vol. 369, pp. 1106–1107,
1985.
[13] S. Ueno, T. Tashiro, and K. Harada, “Localized stimulation of neural
tissues in the brain by means of a paired configuration of time-varying
magnetic fields,” J. Appl. Phys., vol. 64, pp. 5862–5864, 1988.
[14] L. G. Cohen, B. J. Roth, J. Nilsson, N. Dang, M. Panizza, S. Bandinelli,
W. Friauf, and M. Hallett, “Effects of coil design on delivery of focal
magnetic stimulation. Technical considerations,” Electroencephalography
Clinical Neurophysiol., vol. 75, pp. 350–357, 1990.
[15] J. A. Nyenhuis, G. A. Mouchawar, J. D. Bourland, and L. A. Geddes, “Energy considerations in the magnetic (eddy-current) stimulation of tissues,”
IEEE Trans. Magn., vol. 27, no. 1, pp. 680–687, Jan. 1991.
[16] B. J. Roth, J. M. Saypol, M. Hallett, and L. G. Cohen, “A theoretical
calculation of the electric field induced in the cortex during magnetic
stimulation,” Electroencephalography Clinical Neurophysiology/Evoked
Potentials Section, vol. 81, pp. 47–56, 1991.
[17] S. Rossi, M. Hallett, P. M. Rossini, and A. Pascual-Leone, “Safety, ethical
considerations, and application guidelines for the use of transcranial magnetic stimulation in clinical practice and research,” Clinical Neurophysiol.,
vol. 120, pp. 2008–2039, 2009.
[18] Y. Roth, A. Zangen, and M. Hallett, “A coil design for transcranial magnetic stimulation of deep brain regions,” J. Clinical Neurophysiol., vol. 19,
pp. 361–370, 2002.
[19] R. Chunye, P. P. Tarjan, and D. B. Popovic, “A novel electric design for
electromagnetic stimulation-the Slinky coil,” IEEE Trans. Biomed. Eng.,
vol. 42, no. 9, pp. 918–925, Sep. 1995.
[20] H. Kai-Hsiung and D. M. Durand, “A 3-D differential coil design for localized magnetic stimulation,” IEEE Trans. Biomed. Eng., vol. 48, no. 10,
pp. 1162–1168, Oct. 2001.
[21] K. R. Davey and M. Riehl, “Suppressing the surface field during transcranial magnetic stimulation,” IEEE Trans. Biomed. Eng., vol. 53, no. 2,
pp. 190–194, Feb. 2006.
[22] K. Dong-Hun, G. E. Georghiou, and C. Won, “Improved field localization
in transcranial magnetic stimulation of the brain with the utilization of
a conductive shield plate in the stimulator,” IEEE Trans. Biomed. Eng.,
vol. 53, no. 4, pp. 720–725, Apr. 2006.
[23] M. Lu, “Calculating the electric field in real human head by transcranial magnetic stimulation with shield plate,” J. Appl. Phys., vol. 105,
pp. 07B322-1–07B322-3, 2009.
[24] L. Hernandez-Garcia, T. Hall, L. Gomez, and E. Michielssen, “A numerically optimized active shield for improved transcranial magnetic stimulation targeting,” Brain Stimulation, vol. 3, pp. 218–225, 2010.
[25] L. Gomez, L. Hernandez, A. Grbic, and E. Michielssen, “A simulation of
focal brain stimulation using metamaterial lenses,” in Proc. IEEE Antennas Propag. Soc. Int. Symp., 2010, pp. 1–4.

GOMEZ et al.: NUMERICAL ANALYSIS AND DESIGN OF SINGLE-SOURCE MULTICOIL TMS FOR DEEP AND FOCUSED BRAIN STIMULATION

[26] J. Ruohonen and R. Ilmoniemi, “Focusing and targeting of magnetic brain
stimulation using multiple coils,” Med. Biological Eng. Comput., vol. 36,
pp. 297–301, 1998.
[27] S. L. Ho, X. Guizhi, W. N. Fu, Y. Qingxin, H. Huijuan, and Y. Weili, “Optimization of array magnetic coil design for functional magnetic stimulation
based on improved genetic algorithm,” IEEE Trans. Magn., vol. 45, no. 10,
pp. 4849–4852, Oct. 2009.
[28] I. Chang-Hwan and L. Chany, “Computer-aided performance evaluation
of a multichannel transcranial magnetic stimulation system,” IEEE Trans.
Magn., vol. 42, no. 12, pp. 3803–3808, Dec. 2006.
[29] B. H. Han, I. K. Chun, S. C. Lee, and S. Y. Lee, “Multichannel magnetic
stimulation system design considering mutual couplings among the stimulation coils,” IEEE Trans. Biomed. Eng., vol. 51, no. 5, pp. 812–817,
May 2004.
[30] S. S. Nagarajan, D. M. Durand, and E. N. Warman, “Effects of induced
electric fields on finite neuronal structures: A simulation study,” IEEE
Trans. Biomed. Eng., vol. 40, no. 11, pp. 1175–1188, Nov. 1993.
[31] MATLAB: Genetic Algorthm (GA) Toolbox (Version 7.10.0 (R2010 a)).
The MathWorks Inc., Natick, MA, USA: 2010.
[32] D. Goldberg, Genetic Algorithms in Search, Optimization, and Machine
Learning. Reading, MA, USA: Addison-Wesley, 1989.
[33] A. T. Barker, “An introduction to the basic principles of magnetic nerve
stimulation,” J. Clinical Neurophysiol.: Official Publication Amer. Electroencephalographic Soc., vol. 8, pp. 26–37, 1991.
[34] G. Cerri, R. De Leo, F. Moglie, and A. Schiavoni, “An accurate 3-D
model for magnetic stimulation of the brain cortex,” J. Med. Eng. Technol.,
vol. 19, pp. 7–16, 1995.
[35] C. C. Paige and M. A. Saunders, “LSQR: An algorithm for sparse linear
equations and sparse least squares,” ACM Trans. Math. Softw., vol. 8,
pp. 43–71, 1982.
[36] S. Rush and D. A. Driscoll, “EEG electrode sensitivity—An application
of reciprocity,” IEEE Trans. Biomed. Eng., vol. BME-16, no. 1, pp. 15–22,
Jan. 1969.
[37] A. Thielscher and T. Kammer, “Linking physics with physiology in TMS:
A sphere field model to determine the cortical stimulation site in TMS,”
NeuroImage, vol. 17, pp. 1117–1130, 2002.
[38] K. Yunokuchi and D. Cohen, “Developing a more focal magnetic stimulator. Part II: Fabricating coils and measuring induced current distributions,”
J. Clinical Neurophysiol.: Official Publication Amer. Electroencephalographic Soc., vol. 8, pp. 112–120, 1991.
[39] COMSOL Multiphysics 4.3.0.184 ed. Stockholm, Sweden, 2012.
[40] H. Ford and J. M. Alexander, Advanced Mechanics of Materials. London, U.K.: Longmans, 1963.
[41] J. R. Davis and A. I. H. Committee, Copper and Copper Alloys. Materials Park, OH, USA: ASM Int., 2001.
[42] F. S. Salinas, J. L. Lancaster, and P. T. Fox, “3D modeling of the total electric field induced by transcranial magnetic stimulation using the boundary
element method,” Phys. Med. Biol., vol. 54, pp. 3631–3647, 2009.

Luis Gomez (S’08) received the B.S. degrees in electrical engineering and mathematics from the University of Florida, Gainesville, FL, USA, in 2008.
Since August 2008, he has been a Research Assistant at the Radiation Laboratory, University of Michigan at Ann Arbor, Ann Arbor, MI, USA, where he is
currently working toward the Ph.D. degree. His main
research interest is in computational electromagnetism, with a focus on wave propagation in highly
heterogeneous materials, volume integral equations,
and biomedical applications of electromagnetism.
Mr. Gomez was the recipient of the National Science Foundation Graduate
Research Fellowship in 2009.

2781

Frantishek Cajko received the B.S. and M.S.
degrees in physics from Comenius University
Bratislava, Slovakia, and the Ph.D. degree in electrical engineering from the University of Akron,
Akron, OH, USA, in 2000, 2002, and 2008, respectively.
Afterwards, he joined the Department of Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, USA, where he was a
Post-doctoral Research Fellow between 2009–2011.
His research interests include magneto-elastic phenomenon, Flexible Local Approximation Method (FLAME), simulation of plasmonic and negative index materials and in electromagnetic modeling of nanoand micro-scale systems, and fast-direct matrix solvers.

Luis Hernandez-Garcia received the B.S. degree in
applied science from the University of North Carolina at Chapel Hill, Chapel Hill, NC, USA, where
he also received the M.S. and Ph.D. degrees in 1994
and 1998, respectively.
He became a Postdoctoral Research Fellow at
Wake Forest University School of Medicine in 1999,
when he joined the faculty of the University of Michigan, Ann Arbor, MI, USA, as a Research Scientist
in the Biomedical Engineering Department and the
Functional MRI Laboratory. In 2006, he became an
Associate Research Professor. He has served on University of Michigan FMRI
Laboratory Advisory Executive Committee from 2011 to the present and on the
Advisory Board member for Advances in Neuropsychiatric Treatment Conference, San Francisco, CA, USA, since 2012. He served as the primary organizer
for the Midwest Regional Fall symposium on MRI, Ann Arbor, MI, in 2007. He
is also an advisor on the Board for the Pediatric Functional Neuroimaging Research at the Cincinnati Children’s Hospital. He has authored or co-authored 38
peer-reviewed articles and book chapters and 90 presentations at international
conferences, including 14 invited lectures. His research focus is centered on
functional MRI of the brain and on the development of brain stimulation techniques, often in conjunction with each other. More specifically, he has developed
acquisition and analysis techniques for mapping cerebral perfusion dynamically,
and probes for transcranial as well as ultrasound stimulation of the brain.
Dr. Hernandez-Garcia has served as a Reviewer for major journals in his field
including Neuroimage and Magnetic Resonance in Medicine. He has also served
as a Grant Reviewer for the National Science Foundation and the National Institutes of Health. He has received two major grants from the National Institutes
of Health as the principal investigator and as co-investigator on 12 others. He
received the James Crawford Award to the best graduate in the Applied Science
program from the University of North Carolina at Chapel Hill in 1992. In the
course of his Ph.D. studies, he was awarded a graduate student fellowship from
Magnex Scientific.

2782

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Anthony Grbic (S’00–M’06) received the B.A.Sc.,
M.A.Sc., and Ph.D. degrees in electrical engineering
from the University of Toronto, Toronto, ON, Canada,
in 1998, 2000, and 2005, respectively.
In January 2006, he joined the Department of
Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, MI, USA, where
he is currently an Associate Professor. His research
interests include engineered electromagnetic structures (metamaterials, electromagnetic band-gap materials, frequency selective surfaces), printed antennas, microwave circuits, wireless power transmission systems, and analytical
electromagnetics.
Dr. Grbic received an AFOSR Young Investigator Award as well as an
NSF Faculty Early Career Development Award in 2008. In January 2010, he
was awarded a Presidential Early Career Award for Scientists and Engineers.
In 2011, he received an Outstanding Young Engineer Award from the IEEE
Microwave Theory and Techniques Society, a Henry Russel Award from the
University of Michigan, and a Booker Fellowship from the United States National Committee of the International Union of Radio Science (USNC/URSI).
In 2012, he was the inaugural recipient of the Ernest and Bettine Kuh Distinguished Faculty Scholar Award in the Department of Electrical and Computer
Science, University of Michigan. Anthony Grbic served as Technical Program
Co-Chair for the 2012 IEEE International Symposium on Antennas and Propagation and USNC-URSI National Radio Science Meeting. He is currently the
Vice Chair of AP-S Technical Activities, Trident Chapter, IEEE Southeastern
Michigan section.

Eric Michielssen (F’02) received the M.S. degree in electrical engineering (Summa Cum Laude)
from the Katholieke Universiteit Leuven, Leuven,
Belgium, in 1987, and the Ph.D. degree in electrical
engineering from the University of Illinois at UrbanaChampaign (UIUC), Urbana, IL, USA, in 1992.
He joined the faculty of the Department of Electrical and Computer Engineering, UIUC, in 1993, becoming a Full Professor in 2002. In 2005, he joined
the University of Michigan (UM), Ann Arbor, MI,
USA, as a Professor of Electrical Engineering and
Computer Science. Since 2009, he directs the University of Michigan Computational Science Certificate Program. He authored or co-authored more than
160 journal papers and book chapters and more than 300 papers in conference
proceedings. His research interests include all aspects of theoretical and applied
computational electromagnetics. His research focuses on the development of
fast-frequency and time-domain integral-equation-based techniques for analyzing electromagnetic phenomena, and the development of robust optimizers for
the synthesis of electromagnetic/optical devices.
Dr. Michielssen received a Belgian American Educational Foundation Fellowship in 1988 and a Schlumberger Fellowship in 1990. Furthermore, he was
the recipient of a 1994 International Union of Radio Scientists (URSI) Young
Scientist Fellowship, a 1995 National Science Foundation CAREER Award,
and the 1998 Applied Computational Electromagnetics Society (ACES) Valued
Service Award. In addition, he was named 1999 URSI United States National
Committee Henry G. Booker Fellow and selected as the recipient of the 1999
URSI Koga Gold Medal. He also was awarded the UIUC’s 2001 Xerox Award
for Faculty Research, appointed 2002 Beckman Fellow in the UIUC Center for
Advanced Studies, named 2003 Scholar in the Tel Aviv University Sackler Center for Advanced Studies, selected as UIUC 2003 University and Sony Scholar;
in 2011, he received the UM College of Engineering David E. Liddle Research
Excellence Award. He is a member of URSI Commission B. He served as the
Technical Chairman of the 1997 ACES Symposium (Review of Progress in
Applied Computational Electromagnetics, Monterey, CA, USA, March 1997),
and served on the ACES Board of Directors (1998–2001 and 2002–2003) and as
ACES Vice-President (1998–2001). From 1997 to 1999, he was as an Associate
Editor for Radio Science, and from 1998 to 2008, he served as Associate Editor
for the IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION.

