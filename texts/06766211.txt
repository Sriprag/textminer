IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

2389

Automated Grouping of Action Potentials of Human
Embryonic Stem Cell-Derived Cardiomyocytes
Giann Gorospe∗ , Renjun Zhu, Michal A. Millrod, Elias T. Zambidis, Leslie Tung,
and René Vidal, Senior Member, IEEE

Abstract—Methods for obtaining cardiomyocytes from human
embryonic stem cells (hESCs) are improving at a significant rate.
However, the characterization of these cardiomyocytes (CMs) is
evolving at a relatively slower rate. In particular, there is still uncertainty in classifying the phenotype (ventricular-like, atrial-like,
nodal-like, etc.) of an hESC-derived cardiomyocyte (hESC-CM).
While previous studies identified the phenotype of a CM based on
electrophysiological features of its action potential, the criteria for
classification were typically subjective and differed across studies.
In this paper, we use techniques from signal processing and machine learning to develop an automated approach to discriminate
the electrophysiological differences between hESC-CMs. Specifically, we propose a spectral grouping-based algorithm to separate
a population of CMs into distinct groups based on the similarity of
their action potential shapes. We applied this method to a dataset
of optical maps of cardiac cell clusters dissected from human embryoid bodies. While some of the nine cell clusters in the dataset are
presented with just one phenotype, the majority of the cell clusters
are presented with multiple phenotypes. The proposed algorithm
is generally applicable to other action potential datasets and could
prove useful in investigating the purification of specific types of
CMs from an electrophysiological perspective.
Index Terms—Cardiac electrophysiology, cardiomyocyte (CM),
spectral grouping, stem cells.

I. INTRODUCTION
HE application of stem cells in the field of cardiology
has been exciting and rapidly evolving in the last decade.
Methods for cardiac differentiation of human pluripotent stem
cells have been constantly improving since it was first reported
using human embryonic stem cells (hESCs) [1]. Cardiomyocytes (CMs) can be obtained by differentiating natural or
forced aggregates of hESCs (termed human embryoid bodies—
hEBs), as hESC monolayers, or through coculture with END2
cells [1]–[3]. The efficiency of differentiation has also been
greatly improved, as seen in both the quantity and quality of

T

Manuscript received October 23, 2013; revised February 5, 2014; accepted
February 24, 2014. Date of publication March 12, 2014; date of current version
August 18, 2014. This work was supported by the National Institutes of Health
under Grant R21 HL108210, Grant S10 RR025544, and Grant U01 HL099775,
and the Maryland Stem Cell Research Fund 2011-MSCRF-II-0008-00. Asterisk
indicates corresponding author.
∗ G. Gorospe is with the Department of Biomedical Engineering, Johns Hopkins University, Baltimore, MD 21211 USA (e-mail: ggorospe@cis.jhu.edu).
R. Zhu, L. Tung, and R. Vidal are with the Department of Biomedical
Engineering, Johns Hopkins University, Baltimore, MD 21211 USA (e-mail:
zrj868@gmail.com; ltung@jhu.edu; rvidal@cis.jhu.edu).
M. A. Millrod and E. T. Zambidis are with the Department of Immunology, Johns Hopkins University, Baltimore, MD 21211 USA (e-mail:
michal.millrod@jhmi.edu; ezambid1@jhmi.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2311387

hESC-derived cardiomyocytes (hESC-CMs). For example, in
hEB-based methods, contraction can be observed in over 90%
of hEBs starting as early as nine days after initiating differentiation [4], and in monolayer-based methods, greater than
85% CM purity has been reported [5]. Combined with both
genetic- [6] and nongenetic-based [7], [8] purification methods,
it is now possible to generate large populations of high-purity
hESC-CMs. These advances in stem cell biology have greatly
expanded the applications of these human CMs from in vitro
sources, especially in regenerative medicine [9]–[12] and drug
models [13], [14].
The applications of hESC-CMs depend on their biological
properties, especially whether and how well they faithfully represent native CMs. Generally, hESC-CMs have been found to be
immature in both cellular structure and electrophysiology [5],
[15], [16]. The cells usually have a small and rounded morphology, less organized sarcomere [5] and possess immature calcium
handling mechanisms [17].
In addition to their immaturity, hESC-CMs are also heterogeneous. The variability of hESC-CMs is usually described
by categorizing their APs into different electrophysiological
phenotypes, usually referred to as nodal (or pacemaker)-like,
atrial-like, and ventricular-like hESC-CMs [18]–[22], which
correspond to the three major native CM phenotypes. The
development of hESC-CMs into multiple phenotypes during
differentiation is considered to recapitulate embryonic heart development [18]. Phenotypes of hESC-CMs are typically determined by parameters obtained from microelectrode or patch
clamp recordings of APs, such as resting potential (or maximum
diastolic potential for spontaneously beating cells), action potential duration (APD), action potential amplitude, and upstroke
velocity. However, the criteria for assigning phenotypes by these
AP parameters in different research labs are most often subjective in nature, and only rarely quantitatively defined, as in [23]
and [24]. The manual assessment of features to determine the
phenotype of a CM is near impossible to scale to large datasets,
or to remain consistent across research labs, as AP morphologies of hESC-CMs differ when using different differentiation
protocols [13], [18], [23]–[25]. Confounding the analysis further, the APs of hESC-CMs have generally been spontaneously
active even among cells believed to represent the ventricular
phenotype, which could lead to classifications that can change
over time, as the hESC-CMs mature. In addition, most AP parameters vary with beating rate, which is highly variable [18],
making it problematic for phenotype identification.
In this paper, we propose a new, automated framework for
separating a population of hESC-CMs into different groups,

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2390

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

Fig. 1. Schematic drawing of the proposed method. (a) Raw measured signals were obtained over 16 second intervals at a sampling rate of 500 Hz. (b) From
these 16 second traces, we obtained a representative AP by averaging over the individual APs. (c) These serve as input data for the spectral grouping algorithm,
which treats the signals as vertices on a graph. Two vertices were connected by a weight defined by the integral of the squared difference between the corresponding
signals. (d) and (e) Grouping of the data was obtained by finding the cut that minimizes a normalized sum of the weights. (a) Raw signals. (b) Representative APs.
(c) Graph construction. (d) Graph cut. (e) Final groups.

which we hope will lead to more objective and biologically
relevant methods for studying electrophysiological phenotypes
of hESC-CMs. Our framework relies on signal processing and
machine learning techniques that have been successfully used
in other biological fields, such as neurophysiology [26], genomics and proteomics [27], and epidemiology [28]. However,
to the best of our knowledge, they have not been applied to
discriminate cardiac APs. We operate under the hypothesis that
APs belonging to the same phenotype will have more similar
shapes than APs belonging to different phenotypes, and that
this similarity can be captured by machine learning algorithms.
Specifically, we collected an original dataset of APs using optical mapping and used signal processing techniques to transform
paced electrical activities at each recording site into representative APs. These representatives were aligned by activation time
and compared using the Euclidean distance to define the similarity between APs. The similarities were used as the input to
a spectral grouping algorithm to determine an objective separation of populations of cardiac APs with distinct phenotypes.
Model selection techniques were then used to determine the
optimal number of groups that represent that population. Our
work, partially outlined in [29], shows the viability of automated
methods for determining electrophysiologically related groups
among populations of cardiac APs.

II. METHODS AND MATERIALS
This section describes our framework for grouping APs of
hESC-CMs. Section II-A describes the acquisition protocol used
to collect our optical mapping dataset. Section II-B describes
signal processing methods used to obtain a representative AP
at each site of each optical map. Section II-C describes the
algorithm used to group these APs into different phenotypes.
Section II-D describes model selection criteria used to determine
the number of phenotypes. The overall processing pipeline is
illustrated in Fig. 1.

A. Signal Acquisition
The H9 line of hESCs was differentiated into CMs using a previously described hEB-based protocol [30]. The hEBs usually
start beating around Day 9 after the initiation of differentiation.
Beating areas of hEBs were mechanically dissected on Days 15
and 16 of differentiation, and plated on gelatin-coated plastic
coverslips as cardiac cell clusters for optical mapping. Cardiac
cell clusters were stained with 10 μM voltage-sensitive dye di4-ANEPPS (Invitrogen, Grand Island, NY, USA), and 50 μM
myosin II inhibitor blebbistatin (Sigma-Aldrich, St. Louis, MO,
USA) was applied throughout experiments to inhibit motion.
Action potentials were recorded using a MiCAM Ultima-L
CMOS camera (100 × 100 pixels, 16 μm/pixel) at 500 frames/s.
A pair of platinum electrodes was used to deliver fixed
90 beats/min (bpm) pacing to the clusters, and 16-s recordings containing multiple APs were obtained from each cluster.
Fig. 1(a) illustrates the recordings obtained with this protocol.
Note that the resulting optical recordings are normalized to be
in the range [0, 1].
B. Signal Processing
To improve signal-to-noise ratio, we processed the optical
recordings of cardiac cell clusters into one representative AP
for each pixel within the each cluster (each pixel represents
16 μm × 16 μm area of the cluster). Let I(x, t) be the input
optical recording, and let g(x) be a 5 × 5 boxcar filter. First, we
generate a spatially averaged image I x (x, t) by convolution of
the input image with the boxcar filter in space:
I x̄ (x, t) = g(x) ∗ I(x, t).

(1)

Then, let T be the period of the pacing cycle. I x̄ (x, t) is
condensed into a one cycle recording I xt (x, t) by averaging
temporally over the period:
I xt (x, t) =

N
1  x̄
I (x, t + (j − 1)T )
N j =1

(2)

GOROSPE et al.: AUTOMATED GROUPING OF ACTION POTENTIALS OF HUMAN EMBRYONIC STEM CELL-DERIVED CARDIOMYOCYTES

for t ∈ [0, T ). I xt (x, t) is a single AP indicative of the CMs
in a neighborhood around each pixel. The APs from different
averaged pixels were then aligned by their activation time, which
was calculated to be the time point with maximal upstroke slope:
∗

I xta (x, t) = I xt (x, t − t(x))

(3)

∂I xt (x, t)
.
∂t

(4)

where
∗

t(x) = arg max
t∈[0,T )

This alignment allows us to compare signals from different
regions of the cell cluster that may be offset due to differences
in activation time owing to electrical conduction of the AP
wavefront through the cell cluster. Alignment is done post spatial
averaging because the increased signal-to-noise ratio allows us

2391

Once the weights have been computed, the goal is to group
the nodes into K groups {Vk }K
k =1 , i.e., to decompose V as


∪K
k =1 Vk , where Vk ∩ Vk 
 = ∅ for all k = k . Since low weights
correspond to low similarities, one possible criterion is to minimize the average over the K groups of the sum of the weights
between signals in group
K kand signals not in group k, i.e.,
1
Cut({Vk }K
k =1 ) = K
i∈Vk ,j ∈Vk w(i, j). However, this
k =1
criterion can lead to unbalanced groupings, as shown in [32]. To
avoid this issue, Shi and Malik [32] propose to normalize each
term of the Cut criterion by the sum of the weights of every
signal in group k to every other signal, i.e.,
K 
w(i, j)
1 
K
 i∈Vk ,j ∈Vk
.
(8)
NCut({Vk }k =1 ) =
K
i∈Vk ,m ∈V w(i, m)
k =1

to determine a more accurate t(x), and experimentally, we have
found that the local misalignment is negligible compared to
misalignment from different regions of the cell cluster. These
aligned APs serve as our data elements for the machine learning
framework. Fig. 1(b) illustrates typical representatives obtained
by this method.

Since finding the set of groups that minimizes (8) is a combinatorial problem, the spectral grouping methods in [31] and [32]
find an approximate solution from the eigenvectors of a matrix built from the weights. In this paper, we use the spectral
grouping approach of [31]. Once the grouping of the graph has
been found, the phenotype of a signal is decided by the group
to which the corresponding node in the graph belongs.

C. Spectral Grouping

D. Model Selection

Once signals have been processed, the spectral grouping
method of [31] is used to obtain the segmentation of the dataset
into multiple groups. This algorithm represents the dataset with
a graph G = (V, E), where V = {1, . . . , N } is the set of nodes
and E ⊂ V × V is the set of edges. Each node i ∈ V represents
the ith signal in the dataset, xi . Each edge (i, j) ∈ E connects
nodes i and j, i = j, with a weight w(i, j) ≥ 0 that depends
on the similarity between the signals xi and xj . Specifically,
two similar signals are connected with a higher weight than two
dissimilar signals. This weight is defined as

Spectral grouping requires the number of groups K to be
known beforehand. To determine K, we need a measure of the
quality of a segmentation as a function of K.
1) Normalized Cut Cost (NCC): The first measure that is considered is the objective function of our grouping method in (8).
For well-separated clusters, the numerator will be very small,
while the denominator will be large, because signal pairs of the
same group will be well connected while signal pairs of different groups will be poorly connected. Thus, a good grouping will
have a low NCC.
2) Davies–Bouldin Index (DBI): The other measure considered is a cluster distance between pairs of groups [26], [27],
[33]. Given two groups, Vk and Vk 
 , the DBI distance between
the groups is defined as follows:

∗

w(i, j) = e−
where


d2 (xi , xj ) =

T

d 2 (x i ,x j )
σ2

(I xta (xi , t) − I xta (xj , t))2 dt

(5)

(6)
DBI(k, k 
 ) =

0

is the Euclidean distance between the APs xi and xj , T is the AP
cycle length, and σ > 0 is a scaling parameter. By convention,
there is no edge connecting node i with itself. This means the
weight w(i, i) = 0, ∀i ∈ V.
The selection of the scaling parameter σ has an important
effect in the final grouping. On the one hand, a high σ makes all
the weights closer to zero, which encourages each AP to form
its own group. On the other hand, a low σ makes all the weights
closer to one, which encourages all APs to form a single group.
A good balance is obtained when σ is chosen to be in the typical
range of the pairwise distances between APs. For this study, σ
is chosen to be the mean of the squared pairwise distances
1  2
d (xi , xj )
(7)
σ2 =
|E|
(i,j )∈E

where |E| is the number of edges in G.

Sk + Sk 

Mk k 


(9)

where Sk and Sk 
 are values for the dispersion or spread within
each group, and Mk k 
 is a measure between groups. For our
work, Sk is defined as the average of the distances of the signals
within one group to the average signal of that group, while the
measure Mk k 
 is the distance between the average signals of the
two groups:
Sk =

1 
d(I xta (xi , t), μk (t))
|Vk |

(10)

x i ∈Vk

Mk k 
 = d(μk (t), μk 
 (t))

(11)

where
μk (t) =

1  xta
I (xi , t).
|Vk |
x i ∈Vk

(12)

2392

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

Fig. 2. Observed weight matrices. (a) AP similarity for a subset of our dataset. The silhouettes of the nine cell clusters (black regions) are shown on the top
and rotated 90◦ on the left. The subset of pixels being analyzed from each cell cluster is marked by the blue lines crossing each cluster. The similarity between
the signals at pixels i and j in a line is measured by the weight w(i, j) defined in (5). Red indicates high weight and blue indicates low weight. Weights along
the diagonal are 0 by convention of spectral grouping. Areas with high weight should belong to the same group, and areas with low weight to belong to different
groups. (b) AP similarity for a subset of cell clusters 1 and 9. Since the weights relating these two clusters are blue (see the top right and bottom left areas of the
submatrix), they should be in different groups. (c) AP similarity for a subset of cell clusters 2 and 3. In contrast with (b), there are high similarities between the left
part of cluster 2 and the right part of cluster 3 and vice versa, as well as low similarity between the left and right parts of each of the clusters individually. The left
side of cell cluster 2 should group with the right side of cell cluster 3 and the right side of cluster 2 should group with the left side of cluster 3. (a) AP similarity
for the nine cell clusters of our dataset. (b) AP similarity between cell clusters 1 and 9. (c) AP similarity between cell clusters 2 and 3.

For well-separated tight clusters, the dispersion for each
group is very small, since the distances to the mean will be
small, while the measure Mk k 
 between groups will be large
because the means are well separated from each other. Therefore, a lower DBI indicates better grouping. For K groups, the
average DBI over all pairs of groups is chosen to be the group
measure:
1 
DBI =
DBI(k, k 
 )
(13)
|K|
K

where K = {k, k 
 ∈ 1, . . . , K, k < k 
 }.
III. RESULTS
Using the methods in Sections II-A and II-B, we obtained
a dataset of 6940 APs from nine cardiac cell clusters paced at
90 bpm. To quantify the differences in morphology between
two APs, we computed the weight in (5) for all pairs of APs.
Fig. 2(a) shows these weights for a subset of all pairs. Specifically, from each cell cluster, we define a reference line and
plot the weights for pairs of pixels in this line. We use red to
indicate high similarity (w > 0.9) between the action potentials
(low distance) and blue to indicate low similarity (w < 10−3 ).
We observe in Fig. 2(b) that the similarity between cell clusters
1 and 9 (counting from left to right) was low, as indicated by
the two large blue blocks in Fig. 2(b). Thus, we expected these
two cell clusters to separate into different groups. In Fig. 2(c),
we see that the similarity between cell clusters 2 and 3 is high
in some regions, as the left part of cell cluster 2 shared high
similarity with the right part of cell cluster 3 and vice versa. We

can also observe variability within the clusters, as the left part
of cell cluster 2 had low similarity with the right part of that
cluster.
Fig. 3 shows the results of applying spectral grouping to this
dataset using two, three, and four groups. Notice that cell clusters 1 and 9 are presented with predominantly one phenotype,
while the other seven cell clusters showed varying degrees of
mixed phenotypes. Notice also that, even though the grouping
algorithm did not incorporate spatial regularization, the resulting groupings are spatially smooth, suggesting that the grouping
algorithm to identify phenotype was robust. In the rightmost
column, the temporal average of APs for each phenotype is presented. We see that the two group results produce two distinct AP
phenotypes, while increasing number of groups produce intermediate APs that are increasingly less distinct. This conclusion
is supported by the NCC and DBI numbers, which suggest an optimal segmentation into two groups (NCC = 0.1457 and DBI =
1.1655).
To further evaluate the characteristics of the obtained groups,
we also computed the distributions of commonly used AP features [18], [19], [23], [24]. In particular, Fig. 4 shows the distributions of APD30 , APD80 , triangulation (APD90 − APD30 ),
9 0 −APD 3 0
) for the groups
and normalized triangulation ( APDAPD
90
determined by spectral grouping and visualized in Fig. 3. For
the case of two groups, APD30 and APD80 histograms were
fitted well as distinctly separated subpopulations. However, triangulation, a parameter indicative of a proarrhythmic substrate
when prolonged, had a wide range in both groups, with substantial overlap. By normalizing triangulation to APD90 , we
obtained a shape parameter that showed better discrimination of

GOROSPE et al.: AUTOMATED GROUPING OF ACTION POTENTIALS OF HUMAN EMBRYONIC STEM CELL-DERIVED CARDIOMYOCYTES

2393

Fig. 3. Grouping visualization. The first nine columns show the results of applying spectral grouping to all the APs in our dataset for two (top row), three (middle
row), and four (bottom row) groups with corresponding NCC and DBI measures listed underneath. Scale bars indicate 200 μm. Some cell clusters present with
primarily one phenotype, while others present a mixture of phenotypes. Both NCC and DBI suggest that K = 2 gives the best grouping fitness. The average AP
of each phenotype as determined by spectral grouping is shown on the last column. Scale bar indicates 100 ms. The average two-group APs suggest different
phenotypes, while for three and four groups, pairs of phenotypes (phenotypes 2 and 3 for three groups, phenotypes 1 and 2 and phenotypes 3 and 4 for four
groups) have similar shapes. (a) Two Groups: NCC = 0.1457, DBI = 1.1655. (b) Three Groups: NCC = 0.2756, DBI = 1.3203. (c) Four Groups: NCC = 0.3883,
DBI = 1.5863.

Fig. 4. Morphological feature distributions. Distribution APD3 0 (first column), APD8 0 (second column), triangulation (APD9 0 − APD3 0 ) (third column), and
PD30
, rightmost column), for the spectral grouping result using two (top row), three (middle row), and four (bottom row)
normalized triangulation ( A P DA9 0P−A
D90
groups. The two group segmentation suggest two unique phenotypes in APD3 0 , APD8 0 , and normalized triangulation.

AP morphology between the two groups, and that the group with
shorter APD30 and APD80 had greater triangulation. With increased number in groups (three and four groups), we observed
increased overlap in all AP features among different groups,
especially in normalized triangulation. This increased overlap
suggests that APs in different groups are similar in shape, thus
increasing difficulty in discriminating the groups by such features. Overall, these results suggest that grouping the population
based on standard AP features would be possible for two groups,
while using the entire AP waveform is effective for two, three,
or four groups.
IV. DISCUSSION
We have introduced a framework for automated grouping
of their APs and tested it using optical mapping data obtained

from hESC-CM cardiac cell clusters. In contrast to conventional
subjective criteria for phenotype classification, our automated
algorithm relies entirely on raw signal information from the
dataset. The grouping of signals is made based on the similarities
between all pairs of signals in the dataset. This leads to an
unbiased and reproducible method for discrimination that is
also widely applicable to larger populations of cells. We believe
that objective and consistent phenotype classification algorithms
are important in understanding the biology of hESC-CMs, and
our results show that applying methods developed in signal
processing and machine learning is a viable approach.
A. Spatial Distribution and AP Variability of Cell Clusters
The existence of both similar and dissimilar regions, seen
in Fig. 2(a), within some cardiac cell clusters indicates that

2394

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

more than one phenotype may coexist within a single cluster,
consistent with previous work [16]. Our results show that while
there were cell clusters in our dataset that expressed primarily one phenotype, the majority of the cell clusters presented
with multiple phenotypes. For the clusters with more than one
phenotype, even though the grouping method did not enforce
spatial regularity, continuous regions of cell clusters with only
one phenotype were obtained. Further, we observed smoothly
varying AP shape across the boundary separating phenotypes.
This is partly because of the spatial averaging performed during preprocessing, but it primarily reflects that APs vary as a
continuum from one phenotype to another. Thus, it is particularly important to develop automated algorithms to maintain a
consistent decision boundary across datasets.
B. Biological Interpretation
The differences in AP shapes and parameters between groups
suggest that our algorithm is capable of distinguishing morphological differences of APs within a dataset, which is also
the main goal of widely used subjective methods for phenotype identification. In our two-group classification results, APs
were either less triangular (as quantified by normalized triangulation) with long APD, or more triangular with short APD. This
can be interpreted as ventricular-like and nonventricular-like
APs, respectively. However, definitive biological interpretation
remains to be validated by further investigations. Possible avenues include phenotype-related biomarkers and patch clamp
studies of phenotype-specific currents. It should also be noted
that the global gene expression profile of hESC-CMs generally
differs from both adult and fetal CMs [34], [35], and should
also be taken into consideration. Also, unlike most studies of
spontaneously beating hESC-CMs [18], [19], we specifically
controlled the beating rate to 90 bpm by delivering an external
stimulus. The fixed pacing rate eliminated rate-dependent variations in AP morphology and exposed intrinsic differences in
electrophysiology, which we believe are due to true phenotypic
differences, and can provide insights into the mechanisms of
variability among APs.
C. Adaptability of the Framework
We used optical mapping recordings for our dataset, but because the spectral grouping and fitness evaluation operate with
a processed action potential signal, they are amenable to action potential recordings obtained from other techniques and
thus could be used to investigate variability in current methods for purification of specific phenotypes of hESC-CMs [24],
[36], [37]. Also, we used a very basic signal distance measure,
the Euclidean distance, which assesses AP differences equally
at every time point. This could be modified to emphasize AP
differences in different segments of the action potential (e.g.,
more weight on the depolarization and repolarization phases
of the AP and less on phase 4 resting potential), or to forgo
the Euclidean distance altogether for other distances between
AP shapes [38], [39]. Future work could investigate these other
metrics and how the resulting groupings compare to this work.
Another possibility is to operate with other representations of

the action potential such as the phase plot (dVm /dt versus Vm )
representation. A benefit to phase plot analysis is that the need
to align the signals temporally is no longer necessary. However,
appropriate measures to compare and quantify the differences
between the phase plots, so that electrophysiological phenotypes
can be identified.
V. CONCLUSION
We have introduced a framework for automated grouping of
action potentials of CMs derived from hESCs together with a
dataset with which future methods can be evaluated. Our results on this dataset showed that the groups obtained by our
algorithm reflect phenotype differences in electrophysiology of
hESC-CMs. We believe that the proposed framework provides
a landmark first step into using machine learning techniques in
the classification of stem cell-derived CM phenotypes by their
action potentials.
REFERENCES
[1] I. Kehat, D. Kenyagin-Karsenti, M. Snir, H. Segev, M. Amit, A. Gepstein,
E. Livne, O. Binah, J. Itskovitz-Eldor, and L. Gepstein, “Human embryonic stem cells can differentiate into myocytes with structural and
functional properties of cardiomyocytes,” J. Clin. Investigation, vol. 108,
no. 3, pp. 407–414, 2001.
[2] P. W. Burridge, G. Keller, J. D. Gold, and J. C. Wu, “Production of de
novo cardiomyocytes: Human pluripotent stem cell differentiation and
direct reprogramming,” Cell Stem Cell, vol. 10, no. 1, pp. 16–28, 2012.
[3] C. L. Mummery, J. Zhang, E. S. Ng, D. A. Elliott, A. G. Elefanty, and
T. J. Kamp, “Differentiation of human embryonic stem cells and induced
pluripotent stem cells to cardiomyocytes: A methods overview,” Circulation Res., vol. 111, no. 3, pp. 344–58, 2012.
[4] P. W. Burridge, S. Thompson, M. A. Millrod, S. Weinberg, X. Yuan,
A. Peters, V. Mahairaki, V. E. Koliatsos, L. Tung, and E. T. Zambidis,
“A universal system for highly efficient cardiac differentiation of human
induced pluripotent stem cells that eliminates interline variability,” PLoS
One, vol. 6, no. 4, p. 1, 2011.
[5] S. D. Lundy, W.-Z. Zhu, M. Regnier, and M. A. Laflamme, “Structural and
functional maturation of cardiomyocytes derived from human pluripotent
stem cells,” Stem Cells Develop., vol. 22, no. 14, pp. 1991–2002. 2013.
[6] D. Anderson, T. Self, I. R. Mellor, G. Goh, S. J. Hill, and C. Denning,
“Transgenic enrichment of cardiomyocytes from human embryonic stem
cells,” Mol. Therapy, vol. 15, no. 11, pp. 2027–2036, 2007.
[7] N. C. Dubois, A. M. Craft, P. Sharma, D. A. Elliott, E. G. Stanley,
A. G. Elefanty, A. Gramolini, and G. Keller, “SIRPA is a specific cellsurface marker for isolating cardiomyocytes derived from human pluripotent stem cells,” Nature Biotechnol., vol. 29, no. 11, pp. 1011–1018, 2011.
[8] F. Hattori, H. Chen, H. Yamashita, S. Tohyama, Y.-S. Satoh, S. Yuasa,
W. Li, H. Yamakawa, T. Tanaka, T. Onitsuka, K. Shimoji, Y. Ohno,
T. Egashira, R. Kaneda, M. Murata, K. Hidaka, T. Morisaki, E. Sasaki,
T. Suzuki, M. Sano, S. Makino, S. Oikawa, and K. Fukuda, “Nongenetic
method for purifying stem cell-derived cardiomyocytes,” Nature Methods,
vol. 7, no. 1, pp. 61–66, 2009.
[9] O. Caspi and L. Gepstein, “Myocardial regeneration strategies using human embryonic stem cell-derived cardiomyocytes,” J. Control. Release,
vol. 116, no. 2, pp. 211–218, 2006.
[10] L. Gepstein, “Cardiovascular therapeutic aspects of cell therapy and stem
cells,” Ann. New York Acad. Sci., vol. 1080, pp. 415–425, 2006.
[11] M. Habib, O. Caspi, and L. Gepstein, “Human embryonic stem cells for
cardiomyogenesis,” J. Mol. Cellular Cardiol., vol. 45, no. 4, pp. 462–474,
2008.
[12] M. A. Laflamme, K. Y. Chen, A. V. Naumova, V. Muskheli, J. A. Fugate,
S. K. Dupras, H. Reinecke, C. Xu, M. Hassanipour, S. Police,
C. O’Sullivan, L. Collins, Y. Chen, E. Minami, E. A. Gill, S. Ueno,
C. Yuan, J. Gold, and C. E. Murry, “Cardiomyocytes derived from human embryonic stem cells in pro-survival factors enhance function of
infarcted rat hearts,” Nature Biotechnol., vol. 25, no. 9, pp. 1015–1024,
2007.

GOROSPE et al.: AUTOMATED GROUPING OF ACTION POTENTIALS OF HUMAN EMBRYONIC STEM CELL-DERIVED CARDIOMYOCYTES

[13] S. R. Braam, L. Tertoolen, A. van de Stolpe, T. Meyer, R. Passier, and
C. L. Mummery, “Prediction of drug-induced cardiotoxicity using human
embryonic stem cell-derived cardiomyocytes,” Stem Cell Res., vol. 4,
no. 2, pp. 107–116, 2010.
[14] N. M. Mordwinkin, P. W. Burridge, and J. C. Wu, “A review of human
pluripotent stem cell-derived cardiomyocytes for high-throughput drug
discovery, cardiotoxicity screening, and publication standards,” J. Cardiovasc. Transl. Res., vol. 6, no. 1, pp. 22–30, 2012.
[15] D. K. Lieu, I. C. Turnbull, K. D. Costa, and R. a. Li, “Engineered human
pluripotent stem cell-derived cardiac cells and tissues for electrophysiological studies,” Drug Discovery Today: Disease Models, vol. 9, no. 4,
pp. 209–217, 2012.
[16] A. Blazeski, R. Zhu, D. W. Hunter, S. H. Weinberg, K. R. Boheler,
E. T. Zambidis, and L. Tung, “Electrophysiological and contractile function of cardiomyocytes derived from human embryonic stem cells,” Progr.
Biophys. Molecul. Biol., vol. 110, no. 2/3, pp. 178–195, 2012.
[17] J. Satin, I. Itzhaki, S. Rapoport, E. A. Schroder, L. Izu, G. Arbel, R. Beyar,
C. W. Balke, J. Schiller, and L. Gepstein, “Calcium handling in human
embryonic stem cell-derived cardiomyocytes,” Stem Cells, vol. 26, no. 8,
pp. 1961–1972, 2008.
[18] J.-Q. He, Y. Ma, Y. Lee, J. A. Thomson, and T. J. Kamp, “Human embryonic stem cells develop into multiple types of cardiac myocytes: Action
potential characterization,” Circ. Res., vol. 93, no. 1, pp. 32–39, 2003.
[19] J. C. Moore, J. Fu, Y.-C. Chan, D. Lin, H. Tran, H.-F. Tse, and R. A. Li,
“Distinct cardiogenic preferences of two human embryonic stem cell
(hESC) lines are imprinted in their proteomes in the pluripotent state,”
Biochem. Biophys. Res. Commun., vol. 372, no. 4, pp. 553–558, 2008.
[20] Y.-K. Lee, K.-M. Ng, W.-H. Lai, Y.-C. Chan, Y.-M. Lau, Q. Lian, H.-F. Tse,
and C.-W. Siu, “Calcium homeostasis in human induced pluripotent stem
cell-derived cardiomyocytes,” Stem Cell Rev., vol. 7, no. 4, pp. 976–986,
2011.
[21] K. Wang, C. Terrenoire, K. J. Sampson, V. Iyer, J. D. Osteen, J. Lu,
G. Keller, D. N. Kotton, and R. S. Kass, “Biophysical properties of slow
potassium channels in human embryonic stem cell derived cardiomyocytes implicate subunit stoichiometry,” J. Physiol., vol. 589, no. Pt 24,
pp. 6093–6104, 2011.
[22] D. K. Lieu, J.-D. Fu, N. Chiamvimonvat, K. C. Tung, G. P. McNerney,
T. Huser, G. Keller, C.-W. Kong, and R. A. Li, “Mechanism-based facilitated maturation of human pluripotent stem cell-derived cardiomyocytes,”
Circ. Arrhythmia Electrophysiol., vol. 6, no. 1, pp. 191–201, 2013.
[23] S. Peng, A. E. Lacerda, G. E. Kirsch, A. M. Brown, and A. BrueningWright, “The action potential and comparative pharmacology of stem
cell-derived human cardiomyocytes,” J. Pharmacol. Toxicol. Methods,
vol. 61, no. 3, pp. 277–286, 2010.
[24] J.-D. Fu, S. N. Rushing, D. K. Lieu, C. W. Chan, C.-W. Kong, L. Geng,
K. D. Wilson, N. Chiamvimonvat, K. R. Boheler, J. C. Wu, G. Keller,
R. Hajjar, and R. A. Li, “Distinct roles of microRNA-1 and -499 in ventricular specification and functional maturation of human embryonic stem
cell-derived cardiomyocytes,” PLoS One, vol. 6, no. 11, p. e27417, 2011.
[25] C. Mummery, D. Ward-van Oostwaard, P. Doevendans, R. Spijker,
S. van den Brink, R. Hassink, M. van der Heyden, T. Opthof, M. Pera,
A. B. de la Riviere, R. Passier, and L. Tertoolen, “Differentiation of human
embryonic stem cells to cardiomyocytes: Role of coculture with visceral
endoderm-like cells,” Circulation, vol. 107, no. 21, pp. 2733–2740, 2003.

2395

[26] K. Farrow and R. Masland, “Physiological clustering of visual channels in
the mouse retina,” J. Neurophysiol., vol. 105, no. 4, pp. 1516–1530, Jan.
2011.
[27] N. Ahmad, D. Alahakoon, and R. Chau, “Cluster identification and separation in the growing self-organizing map: Application in protein sequence
classification,” Neural Comput. Appl., pp. 531–542, 2010.
[28] A. Dasgupta, Y. V. Sun, I. R. König, J. E. Bailey-Wilson, and J. D. Malley,
“Brief review of regression-based and machine learning methods in genetic epidemiology: The Genetic Analysis Workshop 17 experience,”
Genet. Epidemiol., vol. 35 Suppl 1, pp. S5–11, 2011.
[29] G. Gorospe, R. Zhu, M. A. Millrod, E. T. Zambidis, L. Tung, and R. Vidal,
“Automated analysis of action potentials from cardiac cell clusters derived
from human embryonic stem cells. (abstr.),” in Proc. AHA Sci. Session,
2012.
[30] S. Weinberg, E. A. Lipke, and L. Tung, “In vitro electrophysiological
mapping of stem cells,” Methods Mol. Biol., vol. 660, pp. 215–237, 2010.
[31] A. Y. Ng, M. I. Jordan, and Y. Weiss, “On spectral clustering: Analysis and
an algorithm,” in Proc. Adv. Neural Inf. Process. Syst., 2002, pp. 849–856.
[32] J. Shi and J. Malik, “Normalized cuts and image segmentation,” IEEE
Trans. Pattern Anal. Mach. Intell., vol. 22, no. 8, pp. 888–905, Aug. 2000.
[33] D. Davies and D. Bouldin, “A cluster separation measure,” IEEE Trans.
Pattern Anal. Mach. Intell., vol. 1, no. 2, pp. 224–227, Apr. 1979.
[34] J. Liu, J. D. Fu, C. W. Siu, and R. A. Li, “Functional sarcoplasmic reticulum for calcium handling of human embryonic stem cell-derived cardiomyocytes: Insights for driven maturation,” Stem Cells, vol. 25, no. 12,
pp. 3038–3044, 2007.
[35] M. K. Gupta, D. J. Illich, A. Gaarz, M. Matzkies, F. Nguemo,
K. Pfannkuche, H. Liang, S. Classen, M. Reppel, J. L. Schultze,
J. Hescheler, and T. Sarić, “Global transcriptional profiles of beating clusters derived from human induced pluripotent stem cells and embryonic
stem cells are highly similar,” BMC Develop. Biology, vol. 10, p. 98, 2010.
[36] Q. Zhang, J. Jiang, P. Han, Q. Yuan, J. Zhang, X. Zhang, Y. Xu, H. Cao,
Q. Meng, L. Chen, T. Tian, X. Wang, P. Li, J. Hescheler, G. Ji, and Y. Ma,
“Direct differentiation of atrial and ventricular myocytes from human
embryonic stem cells by alternating retinoid signals,” Cell Res., vol. 21,
no. 4, pp. 579–587, 2011.
[37] W.-Z. Zhu, Y. Xie, K. W. Moyes, J. D. Gold, B. Askari, and
M. A. Laflamme, “Neuregulin/ErbB signaling regulates cardiac subtype
specification in differentiating human embryonic stem cells,” Circ. Res.,
vol. 107, no. 6, pp. 776–786, 2010.
[38] A. Trouvé and L. Younes, “Metamorphoses through lie group action,”
Found. Comput. Math., vol. 5, no. 2, pp. 173–198, 2005.
[39] E. Xing, A. Ng, M. Jordan, and S. Russell, “Distance metric learning, with
application to clustering with side-information,” in Proc. Adv. Neural Inf.
Process. Syst., 2002, vol. 15, pp. 505–512.

Authors’ photographs and biographies not available at the time of publication.

