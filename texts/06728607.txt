IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

1355

Juxta-Vascular Nodule Segmentation Based on Flow
Entropy and Geodesic Distance
Shenshen Sun, Yang Guo, Yubao Guan, Huizhi Ren, Linan Fan, and Yan Kang∗ , Member, IEEE

Abstract—Computed aided diagnosis of lung CT data is a new
quantitative analysis technique to distinguish malignant nodules
from benign ones. Nodule growth rate is a key indicator to discriminate between benign and malignant nodules. Accurate nodule segmentation is the essential for calculating the nodule growth
rate. However, it is difficult to segment juxta-vascular nodules, due
to the similar gray levels in nodule and attached blood vessels. To
distinguish the nodule region from the adjacent vessel region, a
flowing direction feature, referred to as the direction of the normal vector for a pixel, is introduced. Since blood is flowing in one
single direction through a vessel, the normal vectors of pixels in
the vessel region typically point in similar orientations while the
directions of those in the nodule region can be viewed as disorganized. The entropy value of the flowing direction features in a
neighboring region for a vessel pixel is smaller than that for a nodule pixel. Moreover, vessel pixels typically have a larger geodesic
distance to the nodule center than nodule pixels. Based on k-means
clustering method, the flow entropy, combined with the geodesic
distance, is used to segment vessel attached nodules. The validation of the proposed segmentation algorithm was carried out on
juxta-vascular nodules, identified in the Chinalung-CT screening
trial and on Lung Image Database Consortium (LIDC) dataset.
In fully automated mode, accuracies of 92.9% (26/28), 87.5%(7/8),
and 94.9% (149/157) are reached for the outlining of juxta-vascular
nodules in the Chinalung-CT, and the first and second datasets of
LIDC, respectively. Furthermore, it is demonstrated that the proposed method has low time complexity and high accuracies.
Index Terms—Computer-aided detection, flow direction feature,
geodesic distance, lung cancer, nodule segmentation.

I. INTRODUCTION

A

CCORDING to a survey of the WHO, the mortality
rate for lung cancer is higher than that of other kinds of

Manuscript received February 19, 2013; revised May 26, 2013, August 16,
2013, and October 30, 2013; accepted January 21, 2014. Date of publication
January 29, 2014; date of current version June 30, 2014. This work is supported
by the National Science Foundation of China under Grants 61071213, 7120115,
and 61201378. (Corresponding author: Y. Kang).
S. Sun and L. Fan are with the Information School, Shenyang University,
Shenyang, China (e-mail: sunshenshen@126.com; linanfan@163.com).
Y. Guo is with the Department of Mathematics, Northeastern University,
Shenyang, China (e-mail: gy_maths_pr@hotmail.com).
Y. Guan is with the Department of Radiological, First Affiliated
Hospital of Guangzhou Medical University, Guangzhou, China (e-mail:
yubaoguan@126.com).
H. Ren is with the Machinery School, Shenyang University of Technology,
Shenyang, China (e-mail: renhuizhi@126.com).
∗ Y. Kang is with the Sino-Dutch Biomedical and Information Engineering
School, Northeastern University, Shenyang, China (e-mail: kangyan@bmie.
neu.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2303511

cancers, and early detection is crucial to the chance for curative
treatment [1]. Pulmonary nodules, focal densities with diameter
from 3 mm to 3 cm, are the major radiographic indicators for
lung cancer [2]. In order to detect lung cancer early, efforts are
under way to establish lung screening programs using multidetector computed tomography rather than traditional radiographs [3]. To distinguish malignant pulmonary nodules from
benign ones is the main challenge for lung cancer diagnosis, but
is usually difficult to achieve, even through CT examination.
Nodule growth rate, based on two scans performed for a patient
typically within a span of three to six months, is the most
notable predictor to identify malignant nodules. If the volume
of a nodule has increased significantly, then the nodule is often
considered to be malignant [4]. Accurate manual assessment
is time-consuming and highly inaccurate [5]. Computer Aided
Detection (CAD) for lung cancer provides new technology
for the automated pulmonary nodules segmentation. Accurate
segmentation is essential for exact assessment of nodule growth.
Based on their position in the lung and proximity to other
structures, five classes of pulmonary nodules are identified:
well-circumscribed, juxta-vascular, juxta-pleural, and cavitary
pulmonary nodules and ground glass opacities. Among them,
juxta-vascular nodules have the greatest probability of being
malignant, and typically grow most rapidly. These nodules engulf normal lung tissue, since the blood vessel provides more
nourishment to the cancer cells. It is difficult however, to measure the exact growth rate for juxta-vascular nodules through
CT, because there is no explicitly defined standard to classify
the pixels in the connective part between the vessel and the
nodule. Therefore, the two image sequences of the same patient
used to estimate nodule growth rate or doubling time should be
segmented by the same radiologist or CAD software. In order
to measure nodule growth rate, it is necessary to develop a new
method which can separate juxta-vascular nodules from vessels
accurately, automatically and at a speed satisfying the clinical
need.
Early nodule segmentation methods [6] were designed for
2-D images, which required a manually initialized nodule contour and employed a dynamic programming approach to improve it. With the advent of multidetector scanners with high
out-of-plain resolutions and low acquisition time, 3-D isotropic
scans can be achieved and more and more segmentation algorithms have been designed for 3-D image sequences, most of
them focused on juxta-vascular and juxta-pleural nodules. A region growing method based on gray values is usually sufficient
for the segmentation of well-circumscribed nodules, but it is difficult to separate nodules from their attached vessels, due to the
similarity in gray values. Kostis et al. [7] proposed an improved

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1356

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

morphological segmentation method to deal with juxta-vascular
nodules. The main difficulty for the morphological method is
to decide a suitable template size for the structuring elements
to deal with the tradeoff between removing the adjacent vessel
and retaining the boundary of the nodule. That is, the template
should have a size big enough to remove all adjacent vessels, but
when too large, the nodule boundary burrs are removed as well,
which are another index for distinguishing malignant nodules
from the benign ones. To retain the burrs during segmentation,
the authors developed an iterative dilation algorithm using subsequently decreasing kernel sizes. Some of the previously removed vasculatures however, were also regrown by the process.
The approach in [8] segmented nodules by formulizing a model
of the nodules, reflecting volume of interest (VOI) to a 3-D distance transform map, selecting the local maximum pixel as the
nodule center, obtaining the nodule radius, and considering the
radius as the template size for the structuring elements. In order
to build a nodule model, the authors assumed that the size of the
vessels decreases while the vessels evolve along the periphery
of the lungs. Possible local enlargements like those in vessel
branches, however, were not considered in this hypothesis.
Way et al. [9] proposed a 3-D active contour method which
is based on two novel energy components, namely 3-D gradient
and 3-D curvatures, which take advantage of the available 3-D
information. The geodesic distance in a multithreshold image
representation was adopted by [10]. It defines a fusion segregation process based on both gray-level similarity and objects
shape and found the contour of the maximum average gradient
as the edge of the nodule. The algorithm in [11] performs an
adaptive region growing on a fuzzy connectivity map to segment
the nodule. Diciotti et al. [12] detected nodule position and estimated nodule size using a multiscale Laplacian of Gaussian
template matching method. It aligned two image sequences by
means of rigid registration and obtains the nodule growth rate
by calculating the difference between them [13]. The approach
taken by Okada et al. [14] was based on a fit of the lung nodule
with an ellipsoid formed by an anisotropic Gaussian profile, and
employs the mean shift combined with the Jensen–Shannon dispersion criterion to obtain the model scale parameters, including
the nodule center and the nodule span in every direction.
In this paper, we describe an automatic algorithm for 3-D
juxta-vascular nodule segmentation in spiral CT scans for subsequent volume evaluation. The aim of the new method is to accurately separate nodules from the connected vessel. The main
contributions in this paper are summarized below: 1) introduction of a flow entropy feature. For any pixel, the flow direction
feature is based on the direction of the orthogonal vector to the
gradient vectors of all pixels in its local neighborhood. Since
all the blood is flowing in the same direction through a vessel,
pixels in the vessel region should have the same flow direction
feature. That is to say, they have a lower entropy value of flow
direction vectors, as opposed to the pixels in the nodule. 2) A
k-means clustering segmentation method is proposed, based on
the flow entropy and geodesic distance features, to separate the
nodule from the vessel.
The paper is organized as follows. In Section II, the extraction
methods for both flow entropy and geodesic distance features

Fig. 1.

Flowing chart for juxta-vascular nodule segmentation.

are explained in details. Based on both of them, a k-means
method for juxta-vascular nodule segmentation is introduced.
In Section III, test datasets and segmentation evaluation method
are both described. The test results are shown in Section IV.
The accuracy, reproducibility, and speed of this algorithm are
discussed in Section V. Section VI concludes the paper.
II. JUXTA-VASCULAR NODULE SEGMENTATION
A. Steps
A flow chart of the proposed algorithm is shown in Fig. 1.
After loading the CT sequence, first preprocessing is performed,
which obtains the nodules and their respective VOIs. Moreover,
the foreground regions, including only the parts of vessels and
a nodule are determined. In the third step, the flow directions
in the foreground pixels are extracted. In the fourth step, the
flow entropy features are calculated, the flow entropy feature
image is constructed and the nodule center is determined. In
the fifth step, the geodesic distance between each pixel in the
foreground region and nodule center is calculated. Finally, the
k-means [15] clustering method, using both flow entropy and
geodesic distance features, is used to separate the nodule from
the vessel. Below, each of the steps is discussed in greater detail.
B. Preprocessing
The preprocessing process includes candidate nodules extraction, removing false positives, calculating the size of the VOI,
and obtaining the foreground region. After convolution with dot
filter [16], candidate nodule points are identified, after which
the specified Genetic Algorithm and support vector machines
are employed to remove false positives [17]. Fig. 2(a) shows
a slice of a CT lung sequence with candidate nodule points,
while Fig. 2(b) shows the result after removing the false positives. Next, the method in [18] is used to adaptively retrieve the
size of the VOI. A VOI containing a juxta-vascular nodule is
shown in Fig. 3. Finally, a region growing approach based on an
adaptive threshold is employed to obtain the foreground region

SUN et al.: JUXTA-VASCULAR NODULE SEGMENTATION BASED ON FLOW ENTROPY AND GEODESIC DISTANCE

1357

Fig. 2. Result of preprocessing. (a) Nodule candidate points using dot filter
marked by blue, (b) Nodule pixels set after false- positive reduction marked by
red.
Fig. 5. Histogram of the foreground region S which includes only one nodule
The histogram of a foreground region S which includes one nodule and more
than one vessel.

Fig. 3.

Sequence images of a juxta-vascular nodule in a VOI.

Fig. 6. Vector fields of the foreground region of the VOI. (a) The gradient
vector field. (b) The flow direction vectors.

Fig. 4.

Foreground region of a juxta-vascular nodule in its VOI.

which typically includes one nodule and one or more adjacent
vessels.
Step 1: Create a list of potential threshold values:
Thres [i] = minvalue + interval ∗ i, for i = 1 · · · n where
n = ( maxvalue − minvalue ) / interval is the length of
Thres, maxvalue, and minvalue are maximum and minimum
values in the VOI, respectively, and interval is the sample
interval.
Step 2: For each of the n threshold values, obtain the segmented foreground region through the region-growing method
and compute its area.
Step 3: Calculate the difference in areas for two adjacent
threshold values.
Step 4: The threshold is chosen based on the smallest change
in area size. Fig. 4 shows such a foreground region S of
a segmented juxta-vascular nodule. In order to avoid undersegmentation, our adaptive algorithm includes the following
steps:
Step 5: Transform the foreground region S to a 3-D geodesic
distance map to the center position of the VOI.
Step 6: Plot the histogram H, as shown in Fig. 5(a), of the
foreground region S, which includes one nodule and one or more
vessels. Find the maximum value MP and the total length TL in
P
histogram H. Under-segmentation is identified when M
TL > t,
where t is set to 0.5, because for a juxta-vascular nodule, vessels
attached to the nodule are structures longer than typical nodule
boundary irregularities [19]. If the aforementioned condition is
met, the foreground region is said to be under-segmented, and
the adaptive threshold should be increased. The histogram of the

under-segmented foreground region S are shown in Fig. 5(b).
This step is repeated until under segmentation is not detected
anymore.
C. Flow Direction Feature Extraction
As the gray values in a vessel can be modeled by a tubular
Gaussian model, we can define the flow direction as the vector
that is approximately orthogonal to the gradient in a local neighborhood. The gradient vector in pixel i, {gix , giy , giz }, can be
computed by calculating the Gaussian derivatives derivativeof
the foreground in the VOI.
D. Flow Direction Feature Extraction
As the gray values in a vessel can be modeled by a tubular
Gaussian model, we can define the flow direction as the vector
that is approximately orthogonal to the gradient in a local neighborhood. The gradient vector in pixel i, {gix , giy , giz }, can be
computed by calculating the Gaussian derivatives derivativeof
the foreground in the VOI. The obtained gradient vector field of
a juxta-vascular nodule in its VOI is shown in Fig. 6(a).
E. Flow Direction Feature Extraction Based on the Vector
Cross Product
In this approach, the cross product of any two gradient vectors in the neighbor region is calculated and normalized. The
flow direction is obtained by averaging all those normalized
cross products. Taking any a pixel j as the center of a 3∗3∗3
region, the set of 3-D Gaussian gradient vectors is denoted by
ζj i = {gix , giy , giz }, where i ∈ {1, 2, . . . , n}, n = 27. Let i and
k be any two pixels in the 3∗3∗3 region and the corresponding
gradients are ζj i and ζj k , respectively. Let Mj ik denote the

1358

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

normalized cross product of ζj i and ζj k ,
Mj ik = ζj i × ζj k/|ζj i × ζj k |

(1)

Mj,1,1

Mj,1,2

···

Mj,1,27

Mj,2,1
..
.

Mj,2,2
..
.

···
..
.

Mj,2,27
.
..
.

Mj,27,1

Mj,27,2

···

Mj,27,27

Let 2-D matrix Mj =

Since vectors in opposite directions indicate the same direction, it is possible to invert some of the vectors so that the
majority of the vectors in the same blood vessel have consistent
orientation. This is achieved by taking any vector in Mj as the
main direction vector Mj m ain and invert the vector Mj ik if the
angle between Mj ik and Mj m ain is bigger than π/2, i.e., their
dot product is less than 0. Equation (2) describes this process.

−Mj ik , Dot (Mj ik , Mjim ain ) < 0

Mj ik =
.
(2)
otherwise
Mj ik ,
The average of Mj ik , i = 1, 2, . . . , 27, k = 1, 2, . . . , 27, approximately dictates the normal vector of the gradient vectors
in neighboring region. In view of the symmetry of matrix Mj
and Mj ii = 0 for i = 1, 2, . . . , 27, the average vector vj can be
calculated using (3)
vj =

n
n



Fig. 7. Flow entropy feature images of the foreground region in a VOI. The
nodule center is marked by a red dot.

Fig. 8.

Geodesic distance feature images of the foreground region in a VOI.

of the foreground region in the middle slice. The center point
is determined by minimizing the total distance between the
four-connected boundary pixels of the foreground region of the
middle slice and the potential center point. The flow entropy
feature images of the foreground region in a VOI are shown in
Fig. 7, while the nodule center is represented by a red point.
G. Geodesic Distance



Mj ik / (n∗ (n − 1) /2) .

(3)

i=1 k =i+1

The angle θj between the average vector vj and the vector
(1 1 1) is referred to as the flow direction in pixel j. The flow
direction vector field in the foreground region of VOI is shown
in Fig. 6(b).
The flow direction vectors in the nodule region are always
pointing in different orientations while flow directions in the
vessel region are far more consistent, through which we can
separate nodule from vessel.



F. Flow Entropy Feature and Nodule Center
Obviously, entropy of the flow direction in pixels in a neighbor window will be small when the neighborhood belongs to a
vessel. On the contrary, entropy of flowing feature values will
be large when the window belongs to a nodule. The flow entropy
feature is defined as entropy of the flow direction in pixels in a
neighborhood.
The flow entropy Entj of pixel j is computed through (4).
Entj = Entropy{θ1 , θ2 , . . . , θn } n = (ls)3

According to Vincent et al. [20], the geodesic distance between two pixels x and y in set A is defined as the length of the
shortest path joining x and y totally included in A. Geodesic
distance is calculated through a graph-theoretic approach. Build
an undirected graph G(V, E) from the foreground region images, based on a six-connected region growing method with the
nodule center as seed point. Each pixel in the foreground region
is viewed as a node in the graph. When two pixels are sixadjacent, an edge whose weight is equal to 1 is created between
these points, as described in (5).

(4)

where ls is the scale of the neighbor window centered at pixel
j and θi is the flow direction of pixel i belonging to the neighborhood window. While even more accurate results might be
achieved by adapting ls, a fixed value of 2 was experimentally
determined to be a good tradeoff between speed and accuracy.
The nodule center typically can be found in the middle slice
of the 3-D nodule. It can be determined through maximizing
the minimal Euclidean distances between pixels that belong to
the foreground region in the middle slice and boundary pixels

E (vi, vj, ) =

1,

i and j are 6 neighbourhood

+∞,

otherwise

.

(5)

The shortest distance between any two nodes in the graph G
can be calculated using Dijkstra’s [21] shortest path algorithm.
The geodesic distance of a pixel is defined as the shortest distance between the corresponding node and the nodule center
node. Typically, the geodesic distance feature of a pixel in a
vessel is bigger than a pixel in a nodule. The geodesic distance
images of the foreground region in VOI are shown in Fig. 8.
H. k-Means to Segment Juxta-Vascular Nodules
The k-means clustering method is used to cluster the pixels of
the foreground region in the VOI using normalized flow entropy
and geodesic distance as features, into two classes. Segmentation results are shown in Fig. 9. It can be observed that the
nodule and the vessel are separated correctly using the proposed
approach.

SUN et al.: JUXTA-VASCULAR NODULE SEGMENTATION BASED ON FLOW ENTROPY AND GEODESIC DISTANCE

Fig. 9.

1359

Segmentation result of juxta-vascular nodule by the proposed method.

III. TESTING DATASETS AND EVALUATION METHODS
A. Platform
The proposed algorithms were implemented in Mathematica
7.0 and VC++ 6.0 using the Insight Segmentation and Registration Toolkit (ITK) library [22]. The development and test platform runs on Windows XP and a PC equipped with an Intel(R)
Core(TM) 2 Duo2 CPU clocked at 1.79 GHz and 1.79 GHz
processor and with 1 GB of RAM memory. Statistical analyses
were implemented in SPSS 19.0.

Fig. 10. Synthetic juxta-vascular nodule. (a–d) sequence images. (e) Maximum Intensity Projection (MIP). (f) Flow direction.

spiral CT, whose peak voltage ranged between 120 and 140 kVp
and tube current ranged between 40 and 388 mAs. The provided
gold standards for the LIDC dataset were used.

B. Datasets
1) Synthetic Data: Juxta-vascular nodule can be simulated
by adding an ellipsoid to at least one other cylinder shape. A
cylinder whose gray values are subject to a Gaussian distribution
represents the blood vessel. An ellipsoid whose gray values are
subject to Gaussian distribution represents the nodule.
2) Chinalung-CT: We collected CT scans from subjects enrolled in the multicenter randomized clinical trial on lung cancer screening with helical-CT, called Chinalung-CT. The set
contains 24 subjects showing 28 Juxta-vascular nodules of indeterminate nature with mean diameter within 8 and 40 mm.
All CT sequences were obtained using an Aquilion system
(Toshiba helical CT, reconstruction kernel FC10), with peak
voltage 120 kVp and tube current 110 mAs. The slice interval of all CT sequences in Chinalung-CT was set between 2
and 3 mm. The gold standard for the segmentation results were
formed by the annotations by an expert radiologist. All patients
underwent a surgical resection of the found nodule and a standardized routine pathology examination was performed directly
on the fresh specimen maintained on ice within 30 min after
resection. Before slicing, the maximal diameter of the nodule
was measured by macroscopic examination.
3) Lung Image Database Consortium (LIDC) First Dataset:
As a further independent test set, we adopted the dataset collected by the Lung Image Database Consortium (LIDC) [23].
The LIDC first dataset is composed of CT examinations with
23 scans, including 8 juxta-vascular nodules from screening and
diagnostic studies. We tested our algorithm on all juxta-vascular
nodules having mean diameter less than 10 mm. The slice interval of all CT sequences in the LIDC First dataset is 7 mm.
4) LIDC Second Dataset: Eighty-six subjects (low-dose, reconstruction kernel B30f) with a total of 222 nodules form the
LIDC second dataset. The set includes 157 juxta-vascular nodules. The slice interval of all CT sequences in the LIDC Second
dataset is between 1 and 3 mm.
All above CT images have a matrix of 512∗512 pixels and
an in-plane pixel spacing between 0.605 and 0.742 mm. All CT
sequences in the LIDC were obtained using Siemens low-dose

C. Evaluation Methods
To evaluate the segmentation performance, we calculate
overlap ratio to measure segmentation errors, including oversegmentation and under-segmentation. All nodule segmentations were compared with the reference standard which was
determined by a radiologist or the gold standard file provided
with the dataset. The overlap ratio is calculated as follows:
Overlap =

|Vgold ∩ Vnew |
× 100%
|Vgold ∪ Vnew |

(6)

where Vnew and Vgold are the segmented masks of the proposed
method and the ground-truth, respectively. In order to validate
the correctness of segmentation results, the Pearson correlation
method is used to determine the statistical differences of the
maximum diameter found during pathology and the proposed
automatic approach for Chinalung-CT. Furthermore, the Blandand-Altman method is used to analyze their consistency. Intraoperator reproducibility of the proposed method is analyzed by
a nonparametric Bland-and-Altman approach which was performed by calculation of the median, 5th and 95th percentiles
of the differences results.
IV. SEGMENTATION RESULTS
The whole segmentation process is performed in fully automatic mode. No manual corrections were performed.
A. Synthetic Data and Authentic Nodules
A synthetic juxta-vascular nodule is shown in Fig. 10 and the
average overlap ratio of the segmentation result is 98.2%.
If the overlap ratio is bigger than 0.95, we consider the nodule
segmentation to be correct. In regard to lung nodules identified
in the Chinalung-CT, in 26 out of 28 juxta-vascular nodules
(92.9%), our method provided a successful segmentation. A
correct segmentation was obtained in seven out of eight (87.5%)
juxta-vascular nodules for the LIDC first dataset. A test on the
LIDC second dataset revealed corrected segmentation in 149

1360

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Fig. 13. Comparison of the segmentation results between proposed method
and [20] in one slice and the 3-D visualization. (a1) and (b1): Segmentation in
a 2-D slice for the proposed method and the method of [20], respectively. (a2)
and (b2): 3-D visualizations of the segmented nodules.

Fig. 11. Four examples of challenging juxta-vascular nodules (C1∼C4) come
from the accumulated image databases. Each nodule is depicted on 2-D slices
(R1∼R4) and as 3-D volume rendering (R5). The results of the automatic
segmentation are indicated by red contours in the 2-D images. Vessels are
represented in red and nodule is represented in green in the 3-D visualization.

Fig. 14. Bland and Altman plot between pathology measurement and 3-D
maximum diameter of the proposed automatic segmentation approach.

B. Result Comparison With an Existing Method
3-D geodesic distance maps were used twice for shape representation of a juxta-vascular nodule in [20]. The authors
mentioned their method cannot obtain correct segmentation
for nodules similar to Fig. 13(a1) & (a2), while the proposed
method is able to perform an accurate segmentation, as shown
in Fig. 13(b1) & (b2).
C. Statistical Differences and Consistency Analysis

Fig. 12.

Flow direction fields for four juxta-vascular nodules.

out of 157 (94.9%) juxta-vascular nodules. Fig. 11 shows the
segmentation results on four different juxta-vascular nodules.
Fig. 12 shows the flow direction vector fields for the four juxtavascular nodules. The median in both intraoperators case was
0.0% and the 5th and 95th percentile of volume difference was
0.0 to 0.2%.

To estimate statistical differences, the Pearson correlation
method is used. The mean and standard deviation for pathology measurement and 3-D maximum diameter of the proposed
automatic segmentation approach is 20.9061+/–6.43274 and
20.7143+/–6.81967 mm, respectively. The correlation coefficient is 0.989, which shows that they are significantly correlated
at 0.01 confidence level.
For the estimation of the consistency between pathology measurement and 3-D maximum diameter of the proposed automatic
segmentation approach, Bland-Altman plots are used. The results are shown in Fig. 14. The analysis reveals a fifth percentile
of −1.8 mm, a 95th percentile of 2.2 mm and a median difference of 0.2 mm.

SUN et al.: JUXTA-VASCULAR NODULE SEGMENTATION BASED ON FLOW ENTROPY AND GEODESIC DISTANCE

V. DISCUSSION
A. Computing Time
Even for the largest nodule with a volume of about 6000 mm3 ,
the processing time is less than 30 s. This means that most of
the pulmonary nodules are segmented without any significant
waiting time. The larger nodule volume typically requires the
longest processing time. Due to the iterative segmentation and
geodesic approach applied, computation time is larger, but still
limited. In the future, we will optimize the algorithm further.
B. Reproducibility Against Imaging Protocol
Flow direction and geodesic distance features rather than
gray-level threshold are used, so the partial volume effect as
described in [8] does not have a large influence on the accurateness of measured volumes. Moreover, the proposed segmentation method is not sensitive to noise. The segmentation
accuracies of Chinalung-CT and the LIDC Second Dataset are
slightly higher than those of the LIDC First Dataset due to higher
signal to noise ratio, small slice thickness, and reduced partial
volume effects (PVE). One approach for counteracting imaging
parameter induced variability is to determine a linear calibration
function for the measured volumes by incorporating information
on the acquisition and reconstruction parameters [10]. Another
improvement reducing the influence of the PVE is SPVA [8]. In
future work, we aim to employ these methods to further improve
our results.
VI. CONCLUSION
A new automatic method for the segmentation of juxtavascular pulmonary lesions was proposed in this paper. This
method extracts flow entropy and geodesic distance to distinguish nodules from vessel segments according to their differences in anatomy. After comprehensive tests with synthetic and
real images, it was shown that the proposed method can provide
accurate results for juxta-vascular pulmonary nodules in CT
lung images. The results also indicate that the proposed method
is insensitive to the variation of protocols.
ACKNOWLEDGMENT
The authors like to thank Professor B. M. ter Haar Romeny
for the valuable discussions.
REFERENCES
[1] I. Sluimer, A. Schilham, M. Prokop, and B. V. Ginneken, “Computer
analysis of computer tomography scans of the lung: A survey,” IEEE
Trans. Med. Imag., vol. 25, no. 4, pp. 385–405, Apr. 2006.
[2] F. Girvin and J. P. Ko, “Pulmonary nodules: Detection, assessment, and
CAD [J],” AJR Amer. J. Roentgenol, vol. 191, no. 4, pp. 1057–1069, 2008.
[3] C. B. Aubry, C. Hill, and P. A. Grenier, “Management of an incidentally
discovered pulmonary nodule,” Eur. Radiol., vol. 17, pp. 449–466, 2007.
[4] J. G. Ravenel, W. M. Leue, P. J. Nietert, J. V. Miller, K. K. Taylor, and
G. A. Silvestri, “Pulmonary nodule volume: Effects of reconstruction
parameters on automated measurements, a phantom study,” Radiology,
vol. 247, no. 2, pp. 400–408, 2008.
[5] J. Pu, B. Zheng, J. K. Leader, C. Fuhrman, F. Knollmann, A. Klym, and
D. Gur, “Pulmonary lobe segmentation in CT examinations using implicit
surface fitting,” IEEE Trans. Med. Imag., vol. 28, no. 12, pp. 1986–1996,
Dec. 2009.

1361

[6] N. Xu, N. Ahuja, and R. Bansal, “Automated lung nodule segmentation
using dynamic programming and EM based classification,” Proc. SPIE,
vol. 4684, pp. 666–676, 2002.
[7] W. J. Kostis, A. P. Reeves, D. F. Yankelevitz, and C. I. Henschke, “Threedimensional segmentation and growth-rate estimation of small pulmonary
nodules in helical CT images,” IEEE Trans. Med. Imag., vol. 22, no. 10,
pp. 1259–1273, Oct. 2003.
[8] J. M. Kuhnigk, V. Dicken, L. Bornemann, A. Bakai, D. Wormanns,
S. Krass, and H. O. Peitgen, “Morphological segmentation and partial
volume analysis for volumetry of solid pulmonary lesions in thoracic CT
scans,” IEEE Trans. Med. Imag., vol. 25, no. 4, pp. 417–434, Apr. 2006.
[9] T. Way, L. Hadjilski, B. Sahiner, H. Chan, P. Cascade, E. Kazerooni,
N. Bogo, and C. Zhou, “Computer-aided diagnosis of pulmonary nodules
on CT scans: Segmentation and classification using 3-D active contours,”
Med. Phys, vol. 33, no. 7, pp. 2323–2337, 2006.
[10] S. Diciotti, G. Picozzi, M. Falchini, M. Mascalchi, N. Villari, and G. Valli,
“3-D segmentation algorithm of small lung nodules in spiral CT images[J],” IEEE Trans. Med. Imag., vol. 12, no. 1, pp. 7–19, Jan. 2008.
[11] J. Dehmeshki, H. Amin, M. Valdivieso, and X. Ye, “Segmentation of
pulmonary nodules in thoracic CT scans: A region growing approach [J],”
IEEE Trans. Med. Imag., vol. 27, no. 4, pp. 467–479, Apr. 2008.
[12] S. Diciotti, S. Lombardo, G. Coppini, L. Grassi, M. Falchini, and
M. Mascalchi, “The LOG characteristic scale: A consistent measurement
of lung nodule size in CT imaging,” IEEE Trans. Med. Imag., vol. 29,
no. 2, pp. 397–409, Feb. 2010.
[13] T. Kubota, A. K. Jerebko, M. Dewan, M. Salganicoff, and A. Krishnan,
“Segmentation of pulmonary nodules of various densities with morphological approaches and convexity models,” Med. Imag. Anal., vol. 15,
no. 1, pp. 133–154, 2011.
[14] K. Okada, D. Comaniciu, and A. Krishnan, “Robust anisotropic Gaussian
fitting for volumetric characterization of pulmonary nodules in multislice
CT,” IEEE Trans. Med. Imag., vol. 24, no. 3, pp. 409–423, Mar. 2005.
[15] T. Kanungo, D. M. Mount, N. S. Netanyahu, C. D. Piatko, R. Silverman,
and A. Y. Wu, “An efficient k-means clustering algorithm: Analysis and
implementation,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 24, no. 7,
pp. 881–892, Jul. 2002.
[16] Q. Li, “Selective enhancement filters for nodules, vessels, and airway
walls in two-and three-dimensional CT scans,” Med. Phys., vol. 30, no. 8,
pp. 2040–2051, 2003.
[17] S. Sun, H. Ren, Y. Kang, and H. Zhao, “Lung nodule detection by GA and
SVM,” J. Syst. Simulation, vol. 23, no. 3, pp. 497–502, 2011.
[18] G. Agam, S. G. Armato III, and C. Wu, “Vessel tree reconstruction in
thoracic CT scans with application to nodule detection,” IEEE Trans.
Med. Imag., vol. 24, no. 4, pp. 486–499, Apr. 2005.
[19] S. Diciotti, S. Lombardo, M. Falchini, G. Picozzi, and M. Mascalchi,
“Automated segmentation refinement of small lung nodules in CT scans
by local shape analysis,” IEEE Trans. Biomed. Eng., vol. 58, no. 12,
pp. 3418–3428, Dec. 2011.
[20] L. Vincent and P. Soille, “Watershed in digital spaces: An efficient algorithm based on immersion simulations,” IEEE Trans. Pattern Anal. Mach.
Intell., vol. 13, no. 6, pp. 583–598, Jun. 1991.
[21] D. W. Dijkstra, “A note on two problems in connection with graph [J],”
Numerische Mathematik, vol. 1, pp. 269–271, 1959.
[22] Insight Segmentation and Registration Toolkit (ITK): Segmentation & Registration Toolkit. [Online].Available: http://www.itk.org/
[23] S. G. Armato III, G. McLennan, L. Bidaut, M. F. McNittGray,
C. R. Meyer, A. P. Reeves, B. Zhao, D. R. Aberle, C. I. Henschke,
E. A. Hoffman, E. A. Kazerooni, H. MacMahon, and D. Yankelevitz, “The
lung image database consortium (LIDC) and image database resource initiative (IDRI): A completed reference database of lung nodules on CT
scans[J],” Med. Phys., vol. 38, pp. 915–931, 2011.

Shenshen Sun was born in 1980. She received the
Ph.D. degree in computer science from Northeastern
University, Shenyang, China, in 2009.
Currently, she is a Lecturer at Shenyang University. Her research interest includes medical image
processing.

1362

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Yang Guo was born in 1974. He received the Ph.D.
degree in pattern recognition and intelligent system
from Northeastern University, Shenyang, China, in
2007.
He is currently a lecturer in the Department of
Mathematics at the Northeastern University. His current research interests include algebraic geometry and
computer vision.

Yubao Guan received the Ph.D. degree in medical imaging from Southern Medical University,
Guangzhou, China, in 2012.
He is a Professor and Chief Physician of the Department of Radiology at the First Affiliated Hospital
of Guangzhou Medical University. He mainly focus
on quantitative CT analysis lung disease.

Huizhi Ren was born in 1978. He received the Ph.D.
degree from Northeastern University, Shenyang,
China, in 2011.
He is currently a lecturer in the Department of
industrial engineering, Shenyang University of Technology. His research interest covers computer programming method.

Linan Fan was born in 1965. He received the
Ph.D. degree from the Institute of Computer Science,
Northeastern University, Shenyang, China.
Currently, he is the Dean and professor of Information School, Shenyang University. His research
interest is medical imaging processing.

Yan Kang (M’13) was born in 1964. He received the
Ph.D. degree from the Institute of Medical Physics,
University of Erlangen-Nuernberg, Erlangen, Germany, in 2002.
He worked in the Laboratory of Image Guided
Surgery, Stanford University, Stanford, CA, USA, as
a Postdoctorate Scholar in 2004. Currently, he is the
Dean and Professor of Sino-Dutch Biomedical and
Information Engineering School, Northeastern University, Shenyang, China. His research interests include medical imaging, molecular imaging, intelligent assistance, and medicine computer simulations.

