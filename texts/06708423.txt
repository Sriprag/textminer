IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

1251

Direct Estimation of Cardiac Biventricular Volumes
With an Adapted Bayesian Formulation
Zhijie Wang∗ , Mohamed Ben Salah, Bin Gu, Ali Islam, Aashish Goela, and Shuo Li

Abstract—Accurate estimation of the ventricular volumes is essential to the assessment of global cardiac functions. The existing estimation methods are mostly restricted to the left ventricle
(LV), and often require segmentation which is challenging and
computationally expensive. This paper proposes to estimate the
volumes of both LV and right ventricle (RV) jointly with an efficient segmentation-free method. The proposed method employs
an adapted Bayesian formulation. It introduces a novel likelihood
function to exploit multiple appearance features, and a novel prior
probability model to incorporate the area correlation between LV
and RV cavities. The method is validated on a comprehensive
dataset containing 56 clinical subjects (3360 images in total). The
experimental results demonstrate that the estimated biventricular
volumes are highly correlated to their independent ground truth.
As a result, the proposed method enables a direct, efficient, and
accurate assessment of global cardiac functions.
Index Terms—Bayesian estimation, cardiac function assessment,
cardiac MRI, ventricular volume.

I. INTRODUCTION
ARDIOVASCULAR diseases are the leading cause of
death in western countries [1]. Diagnosis and treatment
of these diseases usually require the assessment of cardiac functions for both left ventricle (LV) and right ventricle (RV). Many
of those functions can be quantified using ventricular volumes,
such as ejection fraction (EF) and stroke volume. Since estimating ventricular volumes through manual segmentation is extremely slow and tedious, many automatic methods have been
proposed. However, accurate estimation of ventricular volumes

C

Manuscript received July 24, 2013; revised October 24, 2013 and December
17, 2013; accepted January 7, 2014. Date of publication January 9, 2014; date
of current version March 17, 2014. Asterisk indicates corresponding author.
∗ Z. Wang is with the Department of Medical Biophysics, University of Western Ontario, London ON N6A 3K7, Canada (e-mail: zhijie@ualberta.ca).
M. B. Salah is with the Department of Computing Science, University of
Alberta, Alberta AB T6G 2R3, Canada (e-mail: mbensala@ualberta.ca).
B. Gu are with the Department of Medical Biophysics, University of Western
Ontario, London ON N6A 3K7, Canada (e-mail: bin.gu@uwo.ca).
A. Islam is with Medical Imaging, University of Western Ontario, Ontario,
ON N6A 3K7, Canada, and also with the Radiology, Saint Joseph’s Health Care,
London, Ontario, ON M6R 1B5, Canada (e-mail: ali.islam@sjhc.london.on.ca).
A. Goela is with the Medical Imaging, University of Western Ontario,
Ontario, ON N6A 3K7, Canada, and also with Radiology, London Health
Sciences Center, London, Ontario, ON N6G 2V4, Canada (e-mail: Aashish.
Goela@lhsc.on.ca).
S. Li is with the GE Health Care, London, Ontario, Canada, and also with
the Department of Medical Biophysics, University of Western Ontario, Ontario,
ON N6A 3K7, Canada (e-mail: Shuo.Li@ge.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2299433

is still challenging for LV and remains completely unsolved for
RV [2]. In the following, we give a brief review on the existing ventricular analysis methods, most of which apply only to
LV and rely on computationally expensive segmentation techniques. Traditional methods such as thresholding, region growing, edge detection, and clustering [3], [4] are typically based on
low-level image information. These methods fail dramatically
when the neighboring structures to the ventricles present similar photometric profiles such as the fat which often has a bright
appearance [5]. Other popular yet more recent methods are the
variational approaches based on energy minimization such as
graph cuts, active contours/level sets, and registration [6]–[8].
They are well known to be sensitive to initialization, ad-hoc
parameters, and require a heavy computational load. Moreover,
techniques like active appearance and shape models [9], [10]
are either limited to mid-ventricular, end-diastolic images [2]
or treat the two ventricles independently. A recently published
comprehensive review which points to the challenges of cardiac
image segmentation can be found in [2]. The most closely related work to our method is the recent study of Afshin et al. [11],
which computes the cavity area of the LV from image statistics (Bhattacharyya similarity between image distributions) and
simple user inputs (two boxes, one inside the LV cavity and
one enclosing the cavity) via machine learning and without any
segmentation step. However, this method is restricted to the LV,
could not be straightforwardly extended to the RV, and is very
sensitive to the user inputs [12]. In fact, it assumes a strong correlation between the considered statistics and the LV cavity areas
as shown in Fig. 1(d) and (e). Contrarily, the statistics within
the RV region of interest (ROI) do not correlate well with the
RV cavity areas as shown in Fig. 1(i) and (j). This is because in
the RV ROI, undesirable structures with similar intensity profile
to the cavity may appear [as shown in Fig. 1(g)] and inseparably contribute to the considered statistics alone with the cavity.
Therefore, the method in [11] is not applicable to the RV.
In this paper, we propose a novel method to estimate the
biventricular volumes jointly without the need for segmentation. As shown in Fig. 2(a) and (b), a minimal user interaction
is required in the form of two landmarks placed on each slice in
the first frame of the MRI sequence. The biventricular volumes
throughout the cardiac cycle are then automatically estimated in
real time. Consequently, cardiac functions can be assessed accurately and efficiently. This study is of significant clinical importance, and its clinical validation has been accepted in Radiological Society of North America (RSNA) 2013 [13] as an abstract.
In summary, three major contributions exist in this study:
1) a novel approach for estimating both LV and RV volumes
jointly and without segmentation;

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1252

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

Fig. 1. Comparison between LV and RV illustrates that the method in [11] does not apply to RV. (a) Reference image of LV (inside red square); (b) end-systolic
frame of LV; (c) end-diastolic frame of LV; (d) and (e) LV cavity areas correlate well with the Bhattacharyya statistics over the cardiac cycle; (f)–(h) reference
image, end-systolic, and end-diastolic frames of RV; (i) and (j) RV cavity areas do not correlate with the Bhattacharyya statistics.

Fig. 2. (a) User selected landmarks; (b) estimated volumes of LV and RV over
the cardiac cycle.

Fig. 3.

Flow chart of estimating the biventricular volumes.

2) a novel likelihood function making use of multiple appearance features; and
3) a novel prior probability model exploiting area correlation
information.
The remainder of this paper is organized as follows. In Section II, the overview of the proposed volume estimation method
will be described. Then, the key component of the method, cavity area estimation, will be detailed in Section III. Section IV
includes the experimental results that illustrate the performance
of the proposed method, and finally, a conclusion is drawn in
Section V.
II. METHOD OVERVIEW
This section gives an overview of the proposed method for
estimating the biventricular volumes in a short-axis view MRI
sequence. As explained by the flow chart in Fig. 3, the proposed
method consists of three consecutive steps: 1) a minimum user
input is conducted for ROI extraction, 2) the cavity areas of LV
and RV in each slice and each frame are estimated automatically,

Fig. 4. (a) ROI construction where the user selected landmarks are shown by
the two white crosses; (b) ROI extracted from (a).

and 3) the volumes of both LV and RV are obtained by integrating the corresponding cavity areas along the sagittal direction.
The first and third steps will be introduced in the following,
while the second step (area estimation) will be explained in
more details in the next section.
A. User Input
As shown in Fig. 4(a), we select a single ROI that encloses
both the LV and the RV. The selection requires a minimal user
intervention in the form of two landmarks [depicted by the two
white crosses in Fig. 4(a)] placed on each slice of the shortaxis view MRI in the first frame. The selected landmarks are
anatomically significant in order to keep a certain consistency
between different potential ROIs. As depicted in Fig. 4(a), we
use the two attachment points of the right-ventricular wall to the
left-ventricular septal wall as anatomical landmarks. The ROI
[specified by the white rectangle in Fig. 4(a)] is then computed
automatically as follows. The central point of the two landmarks
[white dot in Fig. 4(a)] is the center of the squared ROI whose
scale is twice as large as the distance between the landmarks.
The orientation of the ROI is determined by the central line
[dashed line in Fig. 4(a)] linking the two landmarks. Finally,
the image within the selected ROI is clipped, rotated so that the
central line becomes vertical and separates between the LV on

WANG et al.: DIRECT ESTIMATION OF CARDIAC BIVENTRICULAR VOLUMES WITH AN ADAPTED BAYESIAN FORMULATION

1253

its right side and the RV on its left side, then rescaled (to 40×40
pixels in this study) as depicted by Fig. 4(b).
Although simple to proceed, the ROI selection procedure described previously brings the following advantages: 1) as mentioned previously, only a single ROI is required for both LV
and RV rather than two individual ones; 2) the LV and the RV
are jointly examined within the selected ROI by exploiting their
correlation information in the prior probability model proposed
in subsection III-C; and 3) using landmarks with anatomical significance makes the ROI selection consistent, so that the final
estimated results are robust to intra- and interuser variability as
demonstrated in the experimental section.
B. Volume Integration
In the proposed method, the ventricular volumes of LV and
RV are approximated by integrating the cavity areas in shortaxis view slices along the sagittal direction. Specifically, the
overall volume V is obtained by summing the volume of each
slice which is computed as the product of the corresponding
cavity area Ai and the slice thickness h,

Ai · h.
(1)
V =
i

In the previous equation, the key component is to estimate the
cavity area Ai , which comprises our main contribution in this
paper. This problem is formulated and tackled (different from
most of the related works) using an adapted Bayesian formulation. Details are presented in the following section.
III. BAYESIAN ESTIMATION OF CAVITY AREA
This section formulates the problem of estimating a cavity
area, given an input image, in the Bayesian framework. The
Bayesian framework has the following two advantages among
others which are appealing to our problem. It is efficient and
often leads to global optima compared to active contour/level
set and registration methods. It is also very convenient for incorporating a variety of models/constraints related to appearance,
motion, etc. In the following, we will first present the problem
formulation, and then propose a likelihood function and a prior
probability model within the Bayesian framework. Finally, we
will detail the implementation.
A. Problem Formulation
General Bayesian Formulation: In the Bayesian framework,
statistical pattern recognition problems amount to estimating
the posterior probability density of an object parameterized by
X given its prior p(X) and the observation Z. Generally, the
posterior probability of X given the observation Z is written as
follows:
p(X|Z) ∝ p(Z|X)p(X)

(2)

where p(Z|X) is the likelihood function modeling the probability of observing Z given the object state X, and p(X) is the
prior probability of the object state.
Adapted Bayesian Formulation: As shown in Fig. 5, our objects of interest, LV and RV, are two individual heart chambers

Fig. 5. LV and RV belong to a closed circulation system. Therefore, LV can
provide a prior [p RV (X )] to RV based on their correlation.

belonging to a closed circulation system. Due to their connection
in both physical and logical aspects, the two ventricles share the
same motion pattern, cyclically expanding (during a diastolic
period) and contracting (during a systolic period). As a consequence, the volume variations of the two ventricles essentially
resemble each other in their patterns as shown in Fig. 2(b).
This relationship can be approximated by a linear correlation
model which indicates two variables that increase or decrease
proportionately (not necessarily equivalently) to each other. The
same relationship reflects in a short-axis view slice too. In other
words, the two cavity areas of LV and RV are linearly correlated
too because they increase and decrease proportionally due to
the two cavities’ synchronized motion. Note that the increment
and decrement of the two cavity areas are proportional but not
equivalent. In fact, the variation degree of the RV short-axis
cavity area is smaller than LV, since RV has a predominantly
longitudinal shortening effect [14]. However, this difference between the variation degrees does not affect our assumed linear
correlation, because the assumption only requires the two cavity
areas to change proportionately rather than equivalently. Therefore, between LV and RV’s short-axis areas there is essentially a
linear correlation model which will be validated and exploited in
this paper. Driven by this model, we adapt the general Bayesian
formulation to our specific biventricle estimation problem. The
adapted formulation is designed as follows:

pL V (X|Z) ∝ p(Z|X)pL V (X)
(3)
p(X|Z) =
pR V (X|Z) ∝ p(Z|X)pR V (X).
Two corresponding Bayesian models are proposed for LV and
RV, while their connections are handled by pRV (X) (RV’s prior
probability model) which is modeled as a function of pLV (X|Z)
(LV’s posterior probability). Specifically, pRV (X) exploits the
estimated LV areas as a prior based on the correlation between
LV and RV. Here, LV is chosen to provide a strong prior for RV
estimation, a common challenge for many existing methods,

1254

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

our adapted Bayesian formulation: a novel multifeature likelihood function [p(Z|X) in (3)] and a novel area correlation prior
probability model [pRV (X) in (3)].
B. Proposed Likelihood Function
Fig. 6. Study of the independency between the three proposed appearance
models. Only weak correlations are shown between the three models computed
from an input image and its 3300 hypothesized labelings.

Fig. 7. Example masks used in the three proposed appearance models (taking
the RV case as example). (a) Blob mask used to capture the blob feature by
computing its dot product with the input image; (b) homogeneity mask used to
specify the cavity region within which the homogeneity is computed; (c) edge
mask used to capture the edge feature by computing its dot product with an edge
image.

because LV’s estimation can be accurate and reliable due to its
circular geometry in short-axis view.
Direct Area Estimation: Based on the adapted Bayesian formulation in (3), the object state is defined as X = [X1 , . . . , XQ ]
where Xq ∈ {0, 1} is the label assigned to the qth pixel in the
input image and q ∈ {1, . . . , Q}. The two labels {0, 1} correspond to “background” and “LV/RV.” Clearly, object state X
is a labeling of the image, and it partitions the image into two
segments: cavity and background. Our method is fundamentally
different from the existing segmentation-based methods which
obtain the solution X in a generative way, i.e., they directly
search for the optimal segmentation using various approaches,
for instance thresholding, graph cut, level set, etc. The cavity
area is then computed systematically from the obtained segmentation. Differently, our method computes the cavity area in an
inference way, i.e., it first estimates the posterior probability of
the object state X using the Bayesian inference method, and
then computes the cavity area as the expectation of a function of
X. Specifically, once the posterior probability p(X|Z) is estimated, the mean cavity area of LV/RV is computed as a function
of the posterior:

A(X)p(X|Z)
(4)
E[A(X)|Z] =
X ∈{0,1}Q

where
A(X) =



q δ(Xq , 1)

(5)

with δ(a, b) as the Kronecker delta function. A(X) computes
the LV/RV cavity area in X by counting the pixels labeled as 1.
Till now, the formulation of estimating a cavity area has been
presented. In the following, we focus on the two major contributions embedded within the two essential components of

We propose to compute the likelihood function p(Z|X) using
three features: blob, homogeneity, and edge in this form:
p(Z|X) = pb (Z|X)ph (Z|X)α pe (Z|X)β

(6)

where pb (Z|X), ph (Z|X), and pe (Z|X) are respectively blob,
homogeneity, and edge feature-based appearance models that
we detail in the following. The parameters α and β adjust the
relative importance of each of the three models. Here, the three
models are assumed to be conditionally independent to each
other given the object state X, which is a widely used assumption for integrating multiple features/models [15]. This is supported by the following study in our dataset. Given an input
image and 3300 hypothesized object states collected from manual segmentation of our dataset, the three models pb (Z|X),
ph (Z|X), and pe (Z|X) are computed and plotted against each
other in Fig. 6. A low degree of correlation is shown between
the blob and edge-based appearance models, while the others
show even weaker correlations.
1) Blob Feature-Based Appearance Model: Blob feature
[16] is particularly useful in medical imaging where objects
can have a blob-like appearance, i.e., the inside area is brighter
or darker than its surrounding area. In our problem, the LV/RV
cavity is typically brighter than the neighboring structures in
MRI, which makes blob feature an appropriate tool for extracting cavity regions. Therefore, we propose an appearance model
based on the blob feature,
pb (Z|X) = (1 + Z, f b (X))/2

Zq fqb (X))/2
= (1 +

(7)

q ∈{1,...,Q }

where f b (X) is an adaptive mask [as the example shown in
Fig. 7(a)] constructed based on the object state X, and fqb (X) is
the qth pixel in the mask. This mask is composed of the cavity
region [the white region in Fig. 7(a)], the narrow band region
[the black region in Fig. 7(a)], and the remaining pixels [shown
in gray in Fig. 7(a)]. The pixel weights corresponding to the
three regions sum to 1, -1, and 0 respectively. The dot product
between the input image and the adaptive mask, Z, f b (X),
naturally captures the image contrast between the hypothesized
cavity region and its surrounding area. The higher the contrast
value is, the more likely the object state X corresponds to the
cavity region in the input image. Therefore, the appearance
model in (7) essentially relies on the relative contrast value
among candidate object states rather than the absolute contrast
value. As a consequence, this model has a merit of not being
confounded by the interscan contrast variation (which in fact
ranges remarkably from 0.07 to 0.37 for LV and 0.01 to 0.18 for
RV in all the scans of our dataset). The mask f b (X) is formally

WANG et al.: DIRECT ESTIMATION OF CARDIAC BIVENTRICULAR VOLUMES WITH AN ADAPTED BAYESIAN FORMULATION

1255

Fig. 10. Automatically estimated versus manually obtained volumes of (a) LV
and (b) RV. The unit is voxel in 3-D image stack domain.
Fig. 8. Average linear correlation coefficient of 0.82 is obtained, between
the manually segmented RV versus LV cavity areas from 56 subjects. Three
subjects’ RV cavity areas against LV cavity areas over a cardiac cycle are
plotted in this figure, and the plots approximately lie on three straight lines.

TABLE II
STATISTICAL APPRAISAL OF THE CONFORMITY BETWEEN THE AUTOMATICALLY
ESTIMATED AND MANUALLY OBTAINED BIVENTRICULAR VOLUMES AND EFS

homogeneity can provide a complementary constraint along
with others for such cavity estimation problems [17]. Therefore, we propose the following appearance model to capture the
homogeneity feature:

(Zq − μ(Z, X))2 /A(X) (9)
ph (Z|X) = 1 −
q ∈Ω c (X )

μ(Z, X) =



Zq /A(X).

(10)

q ∈Ω c (X )

Fig. 9. Implementation of the adapted Bayesian formulation for area estimation using the factored sampling framework.
TABLE I
NUMBER OF THE SUBJECTS WITH LOWERED AND PRESERVED EFS FOR LV
INDIVIDUALLY, RV INDIVIDUALLY, AND LV AND RV TOGETHER

constructed as follows:

⎧
1/A(X)
⎪
⎪
⎨

fqb (X) = −1/{d · k ∈{1,...,Q } (1 − δ(∇Xk ))}
⎪
⎪
⎩
0

q ∈ Ωc (X)
q ∈ Ωb (X)

elsewhere,
(8)
where d is the width of the band, A(X) is the area of LV/RV,
Ωc (X) and Ωb (X) are the cavity region and the surrounding
narrow band determined by the object state X, and δ(·) is the
Dirac delta function.
2) Homogeneity Feature-Based Appearance Model: Filled
with blood, the LV/RV cavity has a bright and homogeneous
appearance in MRI except for the papillary muscle region. This
observation provides a homogeneity constraint to the object state
X, i.e., having low-intensity variance in its specified cavity region. In spite of the disturbance from the papillary muscles,

μ(Z, X) is the mean intensity within the cavity region Ωc (X)
specified by the object state X as the example mask shown in
Fig. 7(b).
3) Edge Feature-Based Appearance Model: Edge features
are frequently used especially in active contours-based segmentation [18] due to their popular existence and efficient computation. In this study, we employ edge features in both spatial
and temporal domains. Edges in spatial domain correspond to
high gradients along the boundaries between the cavity and myocardium. Edges in temporal domain correspond to the motion
of the cavity boundary during diastolic and systolic periods.
Accordingly, we define the edge-based appearance model as
follows:

pe (Z|X) = Z e , f e (X) = q ∈{1,...,Q } Zqe · fqe (X) (11)
where fe (X) is the edge mask [refer to the example in Fig. 7(c)]
constructed based on X, and fqe (X) is the qth pixel in the mask.
The mask is formally constructed as
 
1/ k ∈{1,...,Q } (1 − δ(∇Xk ))
q ∈ Ωe (X)
e
fq (X) =
0
elsewhere,
(12)
where Ωe (X) is the boundary of the cavity determined by
e
e
the
	 object state X. The edge image Z is given by Z =
2
2
(∂r Z) + (∂c Z) + |∂t Z|, where ∂r Z, ∂c Z, and ∂t Z are the

1256

Fig. 11.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

Automatically estimated (red/right) versus manually obtained (blue/left) EFs of LV and RV. Data are sorted by the manually obtained EFs.

Fig. 12. Bland–Altman plots demonstrating the agreement between the EF
values obtained based on the automatically estimated volumes and the manually
obtained volumes for (a) LV and (b) RV. Mean difference and 95% limits of
agreement are shown as solid and dotted lines, respectively.

first derivatives in the row, column, and temporal directions,
respectively.
C. Proposed Prior Probability Model
In this paper, we propose a novel prior probability model to
exploit the joint information between the two ventricles resulting
from their motion similarity. As discussed in subsection III-A,
LV and RV contract and expand following a similar pattern as
shown in Fig. 2(b). This joint information can be expressed by a
linear correlation between the volumes or the cavity areas of the
two ventricles. We represent the joint information using area as
AR (t) = a · AL (t) + b + N (0, σ)

(13)

where AR (t) and AL (t) represent the cavity areas of RVs and
LVs at a certain time t ∈ {1, . . . , T } during the cardiac cycle
of T frames. N (0, σ) is a Gaussian noise. This correlation between the LV and RV cavity areas is confirmed by the manually
segmented cavities in our dataset. An average linear correlation
coefficient of 0.82 is obtained, between all the segmented RV
and corresponding LV cavity areas from 56 subjects. The average residual and norm of residual for the linear regression fits
for all subjects are 39.8787 (4.76% relative error) and 218.0085,
respectively. Furthermore, the common measure for regression,
R2 , is computed with an average result as 0.7775. All the num-

bers aforementioned indicate a good fit of the linear model in
(13). To visually demonstrate the linear correlation between
AR (t) and AL (t), Fig. 8 plots three randomly chosen subjects’
RV versus LV cavity areas over their full cardiac cycles. As
expected, the plots lie on three straight lines although with different values for a (slopes) and for b (RV-axis intercept). The
slope a actually reflects the ratio between the diastolic/systolic
degrees of LV and RV cavities, which varies from subject to
subject. For example, a subject’s LV contracts normally more
than its RV in short-axis view, then the slope of this specific subject is usually smaller than one. To make the proposed method
adaptive to this intersubject slope variations, the slope is automatically estimated for each individual subject in a way that
will be described in the next paragraph.
Following (13), the estimated LV cavity areas over a cardiac
cycle can be used to predict the RV cavity areas over the same
cycle. With this prediction as a prior, more accurate RV posterior
probability can be estimated than without such a prior. This
prior is formulated and exploited by the correlation prior term
fL ⊕R (X, a, b, t) within the following proposed prior probability
model:
pRV (X) = p(X|a, b, t) = fL ⊕R (X, a, b, t) · ps (X).

(14)

ps (X) is the underlying prior distribution embedded in the training set, and fL ⊕R (X, a, b, t) is derived following (13):



(aAL (t) + b − A(X))2
1
exp −
fL ⊕R (X, a, b, t) = √
.
2σ 2
2πσ
(15)
The parameter t indicates the frame index of the current object
state X during the cardiac cycle. Therefore, the current RV
cavity area A(X) [i.e., AR (t) in (13)] is linearly correlated to
AL (t) (the LV cavity area in the same frame). The parameters
a and b are estimated using maximum a posteriori estimation
(MAP) method given all the images during the cardiac cycle,
[â, b̂]M AP = arg max[a,b] p(a, b|Z1:T )

(16)

WANG et al.: DIRECT ESTIMATION OF CARDIAC BIVENTRICULAR VOLUMES WITH AN ADAPTED BAYESIAN FORMULATION

1257

TABLE III
IMPACT ANALYSIS OF EACH INDIVIDUAL COMPONENT IN THE PROPOSED METHOD, BLOB APPEARANCE MODEL (BLOB), EDGE APPEARANCE MODEL (EDGE),
HOMOGENEITY APPEARANCE MODEL (HOMOGENEITY), AND PRIOR PROBABILITY MODEL (PRIOR)

the training set,
pLV (X) = ps (X)

(18)

where ps (X) will be detailed in the following subsection.
D. Implementation

Fig. 13. Illustration of the prior probability model rectifying the portion of
the volume curve with unexpected pattern.

where the posterior distribution p(a, b|Z1:T ) is computed as


···
p(a, b, X1 , . . . , XT |Z1:T )
p(a, b|Z1:T ) =
X1

=



XT

···

X1

=


X1



p(Z1:T , X1 , . . . , XT , a, b)/p(Z1:T )

XT

···



{p(Z1:T |X1 , . . . , XT , a, b)

XT

p(X1 , . . . , XT , a, b)}/p(Z1:T )


···
{p(Z1 |X1 ) · · · p(ZT |XT )
=
X1

This subsection presents the implementation of the adapted
Bayesian formulation proposed for cavity area estimation. The
outline of the implementation is listed by the pseudocode in
Fig. 9, and the details are introduced in the following.
Since the likelihood function p(Z|X) in our adapted Bayesian
estimation framework has a complex form, formulating the
posterior probability p(X|Z) in a closed form is not straightforward [19]. This problem is generally tackled in computer
vision by iterative sampling techniques [20], among which
the factored sampling algorithm [21] is widely accepted for
the interpretation of static images [19]. This technique consists in generating a sample set {s1 , . . . , sN } following a certain prior density p(X) and then assigning to each sample si
(i ∈ {1, . . . , N }) a weight πi based on the likelihood function as

πi = p(Z|X = si )/ N
j =1 p(Z|X = sj ). The weighted sample
set {si , πi }N
then
serves
as a representation of the posterior
i=1
density p(X|Z) whose accuracy increases as N increases. Consequently, the expectation of a function of the object state, e.g.,
the area function A(X) in this paper E[A(X)|Z], can be generated directly from the sample set using the following approximation:
E[A(X)|Z] ≈

XT

N


A(si )πi .

(19)

i=1

p(X1 |a, b) · · · p(XT |a, b)p(a, b)}/p(Z1:T )
(17)
In the previous equation, p(a, b), the prior distribution of [a, b],
is assumed uniform, and p(Z1:T ) is a constant. p(Zt |Xt ) and
p(Xt |a, b) = p(X|a, b, t) are defined in (6) and (14), respectively. A few assumptions are made in the derivation of (17),
including the observation image at time t, Zt , is independent
to others given the object state at time t, Xt , and Xt is in turn
assumed to be independent to others given the parameters a and
b.
Notice that the prior probability model proposed in (14) is
specifically designed for RV in order to exploit the corresponding LV area information. For the LV case, its prior probability
model relies on the underlying prior distribution embedded in

In this paper, instead of randomly generating the sample set
{s1 , . . . , sN }, we obtain it directly from the training set. In the
training phase, each of the input images is manually segmented
into LV/RV and background. All the LV/RV binary segmentation images are collected together to build the sample set
{s1 , . . . , sN }. This set naturally embeds various prior information about shape, location, and scale in the training set and
approximates them as follows:
ps (X) ≈

N


δ(X, si )/N.

(20)

i=i

To incorporate additional prior other than ps (X) embedded in
the training set, the sample weight is modified to involve not only
likelihood but also prior terms. For example, the incorporation

1258

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

TABLE IV
ROBUSTNESS ANALYSIS OF THE PROPOSED METHOD TO INTRA- AND INTERUSER VARIABILITY MEASURED BY ICCS

TABLE V
IMPACT ANALYSIS OF WHETHER A SUBJECT’S EF IS LOWERED
OR PRESERVED TO THE PERFORMANCE OF THE PROPOSED METHOD

of the mutual information term fL ⊕R (X, a, b, t) proposed in (14)
is achieved by computing the sample weight as the product of
fL ⊕R (X, a, b, t) and the likelihood function p(Z|X). Similarly,
other types of correlation information between LV and RV could
be exploited too.
The implementation discussed previously is formally described with the pseudocode in Fig. 9. The proposed
method takes as input the initial evenly weighted sample set
{si , 1/N }N
i=1 and the MRI images over the cardiac cycle Z1:T ;
and the output is the estimated cavity area at any time t within
the cardiac cycle, E[A(X)|Zt ]. In the following, we will explain
the pseudocode in more details.
1) The first step prepares the prior probability for each sample
si (refer to the pseudocode in Fig. 9).
2) The second step computes the likelihood for each sample
si .
3) Given the prior probability and likelihood, the third step
computes the weight πi for each sample.
4) The fourth step performs normalization.
5) The fifth and last step estimates the cavity area based on
the posterior probability approximated by the weighted
sample set.

IV. EXPERIMENTS
In our experiments, a set of (3360 in total) two-dimensional
(2-D) short-axis cine MR images from 56 clinical subjects (including both normal and abnormal cases as listed in Table I)
were used. These images were acquired on a 1.5T scanner
with fast-imaging employing steady-state acquisition image sequence mode, using these acquisition parameters: TR=2.98 ms,
TE=1.2 ms, flip angle=30◦ , and slice thickness=10 mm. Each
subject’s data contain 20 frames throughout the cardiac cycle.
In each frame, three representative slices, apical, mid-cavity,
and basal, are selected following the standard AHA prescriptions [22] for validation, and their manual segmentations are
used as the benchmark. In the following subsections, we will
demonstrate the accuracy of the proposed method, conduct a
thorough analysis of the method, and make comparisons with
closely related works.

A. Accuracy Evaluation
In this subsection, we demonstrate the high accuracy of the
proposed method in estimating the biventricular volumes of LV
and RV using a leave-one-out strategy. Fig. 10 plots the estimated volumes (VA ) versus the ground truth (VM ) of LV and
RV. The nearer the points to the identity line, the more accurate is the automatic estimation. In most of the cases, there is a
very good conformity between the estimated volumes and the
ground truth in both LV and RV cases. This is quantitatively justified by their calculated correlation coefficients [corr(VA , VM )
in Table II] evaluated to 0.985 (LV) and 0.957 (RV). The relative
error between the estimated volumes and the ground truth is also
computed as Diﬀ V = VA − VM /VM and reported in Table II.
The very low relative error Diﬀ V (≤ 0.1) demonstrates the high
accuracy of the automatically estimated volume compared to
the ground truth.
Estimating the volumes of both LV and RV with such accuracy helps in assessing global cardiac functions. As an example,
the EF that measures the blood volume pumped by a ventricle
is used for the performance evaluation of the proposed method.
The EF is computed using (Vd − Vs )/Vd , where Vd and Vs denote the largest (end-diastolic) and the smallest (end-systolic)
volumes of a ventricle in a cardiac cycle. Fig. 11 illustrates a
high conformity between the EF values obtained based on the
automatically estimated volumes (EFA ) and the manually obtained volumes (EFM ). Similar information is also displayed
using Bland–Altman plots in Fig. 12. This high conformity is
further emphasized with the correlation coefficients and the proposed method yielded the coefficients 0.966 and 0.807, respectively, for the LV and RV cases. In addition, we report the mean
and standard deviation of the errors between the automatic and
the manual EFs given by Diﬀ EF = EFA − EFM  in Table II.
The very low mean (≤ 0.05) and standard deviation (≤ 0.05) of
Diﬀ EF confirm the high consistency between the manual and
automatic EFs. By analyzing all the results discussed previously,
it can be observed that LV has relatively more accurate results
than RV. It is consistent with the literature that RV is still a completely unsolved problem [2]. The difficulty in RV estimation
includes: complex geometry, disturbing surrounding structure,
and trabeculation. These are the potential focuses that require
further study in order to improve the RV accuracy.
B. Method Analysis
In this subsection, we investigate three aspects of the proposed
method. The first one is the impact of each proposed component
in the adapted Bayesian formulation. These components include
the blob appearance model, edge appearance model, homogeneity appearance model, and prior probability model. The second
one is the robustness of the proposed method to intra- and interuser variability in terms of ROI selection. The last one is the

WANG et al.: DIRECT ESTIMATION OF CARDIAC BIVENTRICULAR VOLUMES WITH AN ADAPTED BAYESIAN FORMULATION

1259

TABLE VI
COMPARISON BETWEEN THE PROPOSED METHOD AND THE RECENTLY PUBLISHED COMPETING METHODS: THE NEURAL NETWORK-BASED REGRESSION METHOD
IN [11], GRAPH-CUT-BASED SEGMENTATION
METHOD IN [6], AND LEVEL-SET-BASED SEGMENTATION METHOD IN [24]

impact of whether a testing subject has a lowered or preserved
EF to the performance of the proposed method.
Table III reports the performance of the proposed method
when each of its proposed components is excluded in turn.
Compared to the results in Table II where no component is
excluded, the performance degrades in all the cases, which indicates that each component is indispensable and contributes with
the others in a complementary way. In terms of the three appearance models within the likelihood function, the blob and edge
appearance models generally impact the method more than the
homogeneity appearance model whose performance degrades
the least. As far as the prior probability model is concerned, it
affects the performance relatively less than the appearance models. It is because in most of the images, using the appearance
models alone has already resulted in accurate estimation. Even
in a failure case as shown in Fig. 13, the estimated volumes in
the two ends of the cardiac cycle still match the ground truth
properly without using the prior probability model. Only when
the appearance models fail totally as the middle cycle portion,
the prior probability model will contribute and rectify this error
using its imposed constraint. This improvement as confirmed
in Table III is crucial to the EF estimation, because the EF is
affected only by the volumes at the two times: end-systole and
end-diastole, whose small errors can result in big errors of EF.
In fact, with LV providing a prior to RV, the correlation coefficient between RV’s automatic and manual EFs increases from
0.759 to 0.807, and the mean error between RV’s automatic and
manual EFs decreases from 0.069 to 0.049.
The second aspect investigated is the robustness of the proposed method to the intra- and interuser variability in terms of
ROI selection. Due to the distinct landmarks used in our ROI
extraction step, the proposed method can robustly estimate the
cardiac parameters allowing the existence of intra- and interuser
variability. To demonstrate it, two users independently select the
ROIs according to the description in subsection II-A, and one
of them selects the ROIs for the second time after an interval of
≥ 15 days. The intraclass correlation coefficient (ICC) [23] is
employed to evaluate the resemblance between two groups of
ROIs and their corresponding estimated cardiac parameters. Table IV reports the corresponding ICC results computed from the
extracted ROIs’ specifications (including center, orientation, and
scale) and the estimated functional parameters of the two ventricles. The high values related to ROIs’ specifications indicate
that the proposed way of ROI extraction generates highly consistent ROIs due to the distinct landmarks used. Consequently,
the final estimation results of cardiac functional parameters are
highly robust to the intra- and interuser variability as illustrated
in Table IV.

The third analysis investigates if the proposed method is affected by whether a testing subject has a lowered or preserved
EF. This analysis compares the estimated EF results from the
two groups (subjects with lowered manual EFs and subjects with
preserved manual EFs). Table V reports the mean and standard
deviation of the errors between automatic and manual EFs from
the two groups, respectively. As shown in the table, whether a
subject has a lowered or preserved EF does not make a statistically significant difference between the results of the two groups
according to a parametric test (two-tailed t-test). Therefore, the
proposed method is suitable for processing both subjects with
preserved EFs and subjects with lowered EFs.
C. Comparison
Although there is no existing method that estimates the left
and right ventricular volumes jointly and without segmentation,
we include a comparison analysis for integrity. Table VI shows
a comparison on LV between our method and related methods
reported in the thesis version [12] of the closest work to ours
[11].
In this comparison, accuracy is measured by the mean error and standard deviation of EF, and efficiency is measured
by the computational time. As shown in Table VI, the proposed method obviously outperforms segmentation-based methods represented by the recent works using graph-cut [6] and
level-set [24] in both accuracy and efficiency. Compared to the
neural network-based (NNB) regression method, our method
and results have three superiorities even though its performance
on LV is slightly lower: 1) our method applies to both LV and
RV jointly while the NNB method does not apply to RV directly
as analyzed in the introduction; 2) our method is robust to both
intra- and interuser variability while the NNB method is very
sensitive to its user inputs as analyzed in [12]; 3) our results are
obtained from 56 subjects which is more than twice the size of
the dataset (20 subjects) where the NNB results are obtained.
V. CONCLUSION
This paper proposed a real-time segmentation-free method
that is able to estimate the biventricular volumes jointly. The
experimental results obtained on 56 subjects showed that the
method produced highly consistent results with human expert.
Furthermore, the idea of estimating the object area with the
Bayesian framework and the proposed multifeature likelihood
function can be potentially generalized and applied to a multitude of similar applications. Our future work includes: extending the method to be fully automatic by removing the user

1260

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

intervention, and applying the proposed method to other modalities and problems as a general area/volume estimation approach.
REFERENCES
[1] D. Lloyd-Jones, R. J. Adams, T. M. Brown, M. Carnethon, S. Dai,
G. De Simone, T. B. Ferguson, E. Ford, K. Furie, C. Gillespie, A. Go,
K. Greenlund, N. Haase, S. Hailpern, P. M. Ho, V. Howard, B. Kissela,
S. Kittner, D. Lackland, L. Lisabeth, A. Marelli, M. M. McDermott, J.
Meigs, D. Mozaffarian, M. Mussolino, G. Nichol, V. L. Roger, W. Rosamond, R. Sacco, P. Sorlie, R. Stafford, T. Thom, S. Wasserthiel-Smoller,
N. D. Wong, and J. Wylie-Rosett, “Heart disease and stroke statistics–
2010 update: A report from the American heart association,” Circulation,
vol. 121, no. 7, pp. e46–e215, Feb. 2010.
[2] C. Petitjean and J.-N. Dacher, “A review of segmentation methods in short
axis cardiac MR images,” Med. Image Anal., vol. 15, no. 2, pp. 169–184,
Apr. 2011.
[3] H.-y. Lee, N. C. F. Codella, M. D. Cham, J. W. Weinsaft, and Y. Wang,
“Automatic left ventricle segmentation using iterative thresholding and an
active contour model with adaptation on short-axis cardiac MRI,” IEEE
Trans. Biomed. Eng., vol. 57, no. 4, pp. 905–913, Apr. 2010.
[4] M. Lynch, O. Ghita, and P. F. Whelan, “Automatic segmentation of the
left ventricle cavity and myocardium in MRI data,” Comput. Biol. Med.,
vol. 36, no. 4, pp. 389–407, Apr. 2006.
[5] C. a. Cocosco, W. J. Niessen, T. Netsch, E.-J. P. a. Vonken, G. Lund, A.
Stork, and M. a. Viergever, “Automatic image-driven segmentation of the
ventricles in cardiac cine MRI,” J. Magn. Reson. Imag., vol. 28, no. 2, pp.
366–374, Aug. 2008.
[6] I. B. Ayed, K. Punithakumar, S. Li, A. Islam, and J. Chong, “Left ventricle
segmentation via graph cut distribution matching,” Int. Conf. Med. Image
Comput. Comput.-Assisted Intervention, pp. 901–909, Jan. 2009.
[7] I. Ben Ayed, A. Mitiche, M. B. Salah, and S. Li, “Finding image distributions on active curves,” Comput. Vis. Pattern. Recog., vol. 1, pp.
3225–3232, Jun. 2010.
[8] X. Zhuang, D. J. Hawkes, W. R. Crum, R. Boubertakh, S. Uribe, D.
Atkinson, P. Batchelor, T. Schaeffter, R. Razavi, and D. L. G. Hill, “Robust registration between cardiac MRI images and atlas for segmentation
propagation,” in Proc. Soc. Photo-Opt. Instrum. Eng. Conf., Mar. 2008, p.
691408.
[9] A. Andreopoulos and J. K. Tsotsos, “Efficient and generalizable statistical
models of shape and appearance for analysis of cardiac MRI,” Med. Image
Anal., vol. 12, no. 3, pp. 335–357, Jun. 2008.
[10] J. Senegas, C. A. Cocosco, and T. Netsch, “Model-based segmentation of
cardiac MRI cine sequences a Bayesian formulation,” Proc. SPIE, Med.
Imag., vol. 5370, pp. 432–443, May 2004.
[11] M. Afshin, I. B. Ayed, A. Islam, A. Goela, T. M. Peters, and S. Li, “Global
assessment of cardiac function using image statistics in MRI,” Int. Conf.
Med. Image Comput. Comput.-Assisted Intervention, pp. 535–543, Jan.
2012.

[12] M. Afshin, “Automatic assessment of cardiac left ventricular function via
magnetic resonance images,” Ph.D. dissertation, Univ. of Western Ontario,
London, ON, Canada, 2012.
[13] Z. Wang, M. B. Salah, I. B. Ayed, A. Islam, A. Goela, and S. Li, “Biventricular volume estimation for cardiac functional assessment,” presented at the Radiol. Soc. North Amer., Chicago, IL, USA, 2013.
[14] T. Kukulski, L. Hfibbert, M. Arnold, and B. Wranne, “Normal regional
right ventricular function and its change with age: A Doppler myocardial
imaging study,” J. Amer. Soc. Echocardiogr., vol. 13, pp. 194–2004,
2000.
[15] D. Serby, E. Meier, and L. Van Gool, “Probabilistic object tracking using
multiple features,” in Proc. 17th Int. Conf. Pattern Recogn., 2004, vol. 2,
pp. 184–187.
[16] T. Lindeberg, Scale-Space Theory in Computer Vision. New York, NY,
USA: Springer-Verlag, 1994, pp. 249–271.
[17] M. Jolly, “Fully automatic left ventricle segmentation in cardiac cine
MR images using registration and minimum surfaces,” in Proc. Worksh.
Cardiac Magn. Reson. Left Ventricle Segment., 2009.
[18] M. Kass, A. Witkin, and D. Terzopoulos, “Snakes: Active contour models,”
Int. J. Comput. Vis., vol. 1, no. 4, pp. 321–331, 1988.
[19] A. Blake and B. Bascle, “Statistical models of visual shape and motion,”
Philos. Trans. Roy. Soc. London A, vol. 356, pp. 1283–1302, 1998.
[20] G. Storvik, “A Bayesian approach to dynamic contours through stochastic
sampling and simulated annealing,” IEEE Trans. Pattern Anal. Mach.
Intell., vol. 16, no. 10, pp. 976–986, Oct. 1994.
[21] U. Grenander, Y.-s. Chow, and D. M. Keenan, A Pattern Theoretical Study
of Biological Shapes. New York, NY, USA: Springer-Verlag, 1991.
[22] M. S. V. M. D. Cerqueira, N. J. Weissman, V. Dilsizian, A. K. Jacobs, S.
Kaul, W. K. Laskey, D. J. Pennell, J. A. Rumberger, and T. Ryan, “Standardized myocardial segmentation and nomenclature for tomographic
imaging of the heart: A statement for healthcare professionals from the
cardiac imaging committee of the council on clinical cardiology of the
American heart association,” Circulation, vol. 105, no. 4, pp. 539–542,
Jan. 2002.
[23] G. G. Koch, “Intraclass correlation coefficient,” in Encyclopedia of Statistical Science, 4th ed. New York, NY, USA: Wiley, 1982, pp. 213–217.
[24] I. Ben Ayed, S. Li, and I. Ross, “Embedding overlap priors in variational
left ventricle tracking,” IEEE Trans. Med. Imag., vol. 28, no. 12, pp.
1902–1913, Dec. 2009.

Authors’ photographs and biographies not available at the time of publication.

