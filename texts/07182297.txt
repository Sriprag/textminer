IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

563

Automatic Dissection Position Selection
for Cleavage-Stage Embryo Biopsy
Zenan Wang∗ , Member, IEEE, and Wei Tech Ang, Member, IEEE

Abstract—Embryo biopsies are routinely performed for preimplantation genetic diagnosis (PGD). In order to avoid blastomere
membrane rupture and cell lysis, correct selection of a suitable dissection position on the zona pellucida (ZP) is necessary. Although,
the technology for automated cell manipulation has advanced
greatly over the past decade, fully automated embryo biopsy in
PGD has not been realized yet. Automated PGD may ultimately
set a new clinical standard that improves the consistency of outcomes, increases cell survival rates, flattens the learning curve of
the manual procedure, and reduces the effects of human fatigue.
In this paper, we present the first approach to automatically select
a suitable ZP dissection position prior to embryo biopsy from a
single focused embryo image based on edge detection. The proposed method consists of a technique that estimates the elliptical
ZP boundaries and another two techniques that select the suitable
position for ZP dissection. These techniques achieved success rates
of 96%, 94%, and 94% respectively. In addition, the proposed ZP
boundary estimation technique has the potential to perform ZP
thickness variation (ZPTV) test and other ZP morphology measurements with further improvement in the future. Our methods
provide a starting point for fast position selection prior to automatic embryo biopsy.
Index Terms—Automated embryo biopsy, automated preimplantation genetic diagnosis, cell biopsy, cell manipulation, edge
detection, image segmentation.

I. INTRODUCTION
N vitro fertilization (IVF) is a widely applied clinical technique to help infertile couples conceive when normal medical treatment proves to be ineffective. A successful IVF cycle
consists of successful oocyte fertilization and embryo implantation that leads to a healthy offspring. The success rate of IVF
can be significantly improved by selecting high-quality fertilized embryos prior to implantation. Selection methods include
both invasive and noninvasive procedures. Invasive examination, also known as preimplantation genetic diagnosis (PGD),
is performed when the embryo is suspected to be afflicted by
genetic diseases [1]. Embryo biopsy is an essential step prior
to PGD, where a portion of the ZP is dissected and one or two
blastomeres are extracted from the embryo. The success rate of
embryo biopsy is highly dependent on the position where ZP dissection is carried out, as an unsuitable dissection point will lead

I

Manuscript received April 20, 2015; revised August 2, 2015; accepted August
5, 2015. Date of publication August 7, 2015; date of current version February
16, 2016. Asterisk indicates corresponding author.
∗ Z. Wang is with the School of Mechanical and Aerospace Engineering,
Nanyang Technological University, Singapore 639798 (e-mail: wang0682@
e.ntu.edu.sg).
W. T. Ang is with the Nanyang Technological University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2466098

to embryo lysis [2]–[4]. The perivitelline space is often identified
as the ideal dissection point for three most commonly applied
dissecting techniques: mechanical cutting, chemical breaching,
and laser burning. An embryo can be examined noninvasively
by evaluating and cataloging its morphological features [5], [6].
The morphology of the zona pellucida (ZP) is a key indicator of
the quality of an embryo as it will have direct contact with the
uterus wall. For example, if the ZP is too thick or has hardened,
assisted embryo hatching is required to help the blastocyst escape through the ZP before transferring to the uterus to increase
its implantation capability. Recent studies have identified zona
pellucida thickness variation (ZPTV) as a key morphological
feature that distinguishes high-quality embryos [7]. Cell manipulation for IVF, especially intracytoplasmic sperm injection and
PGD, are labor intensive processes. Experienced and skilled embryologists are normally required to perform both the embryo
ZP measurement and PGD. For both procedures, it is necessary
for the embryologist to recognize the ZP from an embryo image
that typically has poor contrast. In order to expedite the PGD
process and automate ZP recognition, we propose the first automatic segmentation method for identifying both the internal and
external boundaries of the ZP using edge detection and ellipse
fitting from a single-focused embryo image. Furthermore, our
technique can also estimate a suitable position for ZP dissection.
Region- and edge-based methods are the most commonly
used image segmentation methods [8]. A major drawback of
region-based segmentation is the difficulty in identifying accurate borders of objects when they are diffused. Classic regionbased segmentation is not suitable for embryo images due to
their complexities. Edge-based segmentation, on the other hand,
has the challenges of thresholding and linking after searching
of high gradient values. In many cases, threshold values are set
arbitrarily or are derived experimentally. Currently, there are
only a limited numbers of segmentation algorithms that are able
to perform ZP recognition on a Day-3 embryo. The shape of the
ZP can be approximated by an ellipse [9]. Karlsson et al. [10],
[11] introduced ZP detection using region-based segmentation
methods with a probabilistic procedure. The background of the
image has to be removed to facilitate external boundary detection. The internal ZP boundary is identified by separating the
ZP from the embryo. In cases of the appearances of artifacts, a
penalty function is manually applied to remove small artifacts.
Large artifacts must be covered with masks manually to avoid
false detection. The iterative energy minimization method, active contour [12], has also been applied to ZP segmentation [13].
Surrounding artifacts, debris, and spermatozoa, in the ZP area
must be removed before the application of active contour; otherwise the algorithm will be confused by local energy minima,
which hinders the algorithm from rapid and robust convergence.

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

564

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Automatic and semiautomatic ellipse model-based approaches
on Day-5 embryo (blastocyst) ZP recognition were also introduced by Yee et al. and Filho et al., respectively [14], [15].
However, the internal structure of a Day-5 embryo is different
from a Day-3 embryo, therefore, their technique may not work
well on Day-3 embryos.
No attempt at perivitelline space position recognition has
been reported. Giusti et al. proposed a segmentation method
by converting the segmentation problem into a minimum cost
searching problem [16], [17]. The method was able to recognize
the zygotes of oocyte or blastomere of embryo, but not the ZP
or perivitelline space. Application of this technique is limited
to the segmentation of Hoffman modulation contrast (HMC)
microscopy images. Moreover, although 3-D reconstruction has
the potential to identify the perivitelline space by combining
with other ZP recognition algorithms, recognitions of the embryo from a stack of embryo images with different focal planes
is relatively complex and computationally intensive. Similarly,
Feng et al. performed blastomere recognition by using an embryo video clip, which can also be considered to be a set of
images [18]. The method also requires a considerably long processing time. Tian et al. proposed another method that was able
to count the number of blastomeres in an embryo using only
a single image [19]. However, the exact position of the blastomeres cannot be identified. In summary, to the best of our
knowledge, no one has proposed any computationally inexpensive method that can detect the perivitelline space position using
only a single image.

Fig. 1. Function flow: one ZP boundary estimation algorithm with two methods for ZP dissection position selections.

II. METHOD
The suitable ZP dissection position is commonly defined as
the perivitelline space of an embryo, as indicated in Fig. 2(a). We
have developed two segmentation methods to identify the suitable ZP dissection position. The perivitelline space, boundary of
blastomeres, and boundaries of the ZP have to be identified for
the realization of position selection. Edge-detection and ellipse
fitting techniques are applied for internal ZP boundary detection. Regional intensity recognition, classic edge detection, and
the value adjustment algorithm are also applied to estimate the
location of the blastomere boundary and the perivitelline space
position. The overview of the proposed method is illustrated in
the function flowchart in Fig. 1.
A. Boundary Estimation of Zona Pellucida
Recognition of the internal ZP boundary is necessary to identify the perivitelline space position. In this section, we proposed
a method to perform elliptical estimation of both the internal
and external ZP boundary based on edge detection with value
adjustments.
1) Preliminary Embryo Center Estimation: The preliminary
center of the embryo is defined as the mass center of the largest
connected component of the binary image of the embryo. The
original image is converted into a grayscale image, and then
smoothened by an average (pillbox) filter with a radius of 5
pixels. Sobel edge detector is used to obtain the edges of the
smoothened image because it is less sensitive to noises. A thresh-

Fig. 2. (a) Grayscale image. (b) Sobel edge detection. (c) Application of
image closing and hole filling on edge image to find mass center (cx 1 , cy 1 ). (d)
Preliminary embryo center (cx 1 , cy 1 ).

old value for Sobel edge detection is selected automatically by
using Bayes minimum error decision rule with a cutoff value.
The cutoff value is calculated as four times the signal-to-noise
ratio. Since the intensity gradient changes of the internal structure of an embryo is more distinctive than the ZP region, we can
safely assume that most of the edges detected in this stage are the
edges of blastomeres. Upon closing image (image dilation then
erosion) and filling holes of the binary image, we can connect
all the edges together. Boundary clearing and image opening
(image erosion then dilation) are then applied on the binary
image to smoothen out the boundary of the largest component.
Simultaneously, unwanted smaller particles normally obtained
from the detection of artifacts, debris, and spermatozoa are also
removed. The mass center of the largest connected component
of the binary image, (cx1 , cy 1 ), is calculated as indicated in
Fig. 2(c).
2) Estimation of the External ZP Boundary: It is challenging to automatically choose a suitable threshold for the diffused
external boundary of ZP due to the unclear edge features. The

WANG AND ANG: AUTOMATIC DISSECTION POSITION SELECTION FOR CLEAVAGE-STAGE EMBRYO BIOPSY

565

about the mass center using
Ipolar (θ, R) = Icartesian [cx1 + Rcos(θ), cy 1 + Rsin(θ)]

Fig. 3. (a) Estimation of the embryo center and exclusion circle. (b) The
corona that covers the external boundary. (c) Polar-coordinate image of the
corona-covered portion. (d) Canny edge detection. (e) Canny edge detection
and edge indicator of the external boundary. (f) Canny edge detection and edge
indicator of the external boundary with the value adjustment algorithm. (g)
Cartesian-coordinate of external boundary indicator. (h) Elliptical fitting and
real embryo center.

threshold value is normally set through a trial-and-error approach. A biased threshold is likely to be obtained when the
entire embryo image is taken into account to set the threshold.
When adaptive edge detection is applied, the intensity gradient
values of the embryo’s internal structure dominate the gradient
matrix. This domination makes the intensity gradients of the
external ZP boundary negligible. Thus, it is critical to select a
suitable area, where the entire ZP with minimal or no internal
embryo structure appear, for ZP segmentation. The area of internal structure of the embryo is estimated using a circular model.
Since the setup for embryo image acquisition remain unchanged,
i.e., the same camera, microscope, magnification lens, and light
source are used during the operation, and all embryo samples
are in the cleavage stage, it is safe to assume that the sizes (in
pixels) of these embryos fall in a certain range. Hence, around
the estimated center (cx1 , cy 1 ), a corona is drawn to define an
area that covers the ZP. The radius of the internal boundary of
the corona r1 has been set as the minor radius of the ellipse
that can encircle the binary image shown in Fig. 2(c). Through
experiments, we have found that r1 was between 68 and 73 pixels. The external boundary of the corona has a radius r2 , which
equals to either twice of r1 or the shortest distance from the
center to the boundary of the image, whichever is smaller, as
illustrated by the green solid circle in Fig. 3(b). The area that
is enclosed by the corona is then mapped into polar coordinates

(1)

where 0 ≤ θ ≤ 2π and r1 ≤ R ≤ r2 .
Canny edge detector is applied to obtain the edge image of
the image in polar coordinates. Thresholds used for Canny edge
detection are determined automatically. The higher threshold
value is set as the 17th percentile of the intensity gradient values in the edge image. The lower threshold is set as 40% of the
higher threshold. Both global and local edge detections have
been performed on the image. In local edge detection, an averaging filer is used to blur the image. The smoothened image is
equally divided into eight sections and subjected to Canny edge
detection individually. Canny edge detection on all columns can
achieve better result but slow down the process. The preliminary
estimation of the ZP external boundary is defined by the position of the last nonzero pixel in each column of the edge image.
The average value av1 and the maximum difference value mdf1
between the position values are calculated. Position values that
are not within the range of [av1 − m 3df 1 , av1 + m 3df 1 ] will be
replaced by av1 . Upon smoothening the estimated ZP external
boundary by a medium filter, the resulting estimated boundary image is transformed back to Cartesian coordinates. All the
points of the estimated boundary are fed into an ellipse fitting
model to generate an elliptical ZP external boundary. Fig. 3(h)
shows the final estimated elliptical ZP external boundary with
center (cx2 , cy 2 ).
3) Estimation of the Internal ZP Boundary: The area encircled by the elliptical external boundary is first transformed into
the polar coordinate image. As the external boundary has a major and a minor radius, we use the variable radius d instead of
R:
d(θ) = 

ab
(bcos(θ))2

+ (asin(θ))2

(2)

where a, b, and θ are the major radius, minor radius, and the
origin angle of the external elliptical boundary, respectively.
The variable d is then equally sampled n times, where n is
the length of the major axis in pixels. Using (3), we can obtain
polar coordinate image Ipolar as shown in Fig. 4(a)
Ipolar (θ, dn ) = Icartesian [cx2 + dn (θ)cos(θ), cy 2 + dn (θ)sin(θ)]
(3)
where 0 ≤ θ ≤ 2π.
To minimize the undesired edge information in the ZP, the
image is cropped by 5 pixels from the bottom. Canny edge
detection is applied to perform both global and local edge detection to obtain the edge image. The position of the last nonzero
pixel in each column of the edge image is defined as the preliminary estimated internal boundary. The estimated internal
boundary is subjected to the value adjustment algorithm, as
shown in Fig. 4(c). The average av2 is calculated as the average value of top 50 percentile of all boundary values in each
column as dented blastomere boundaries tend to be mistaken
for the internal ZP boundary. The difference of maximum and
minimum boundary value is assigned to mdf2 . If a boundary
value is closer to the maximum boundary value, which means

566

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Fig. 5. (a) Cartesian coordinate image with internal boundary ellipse. (b)
Polar coordinate transformation by a (major radius) sampling points. (c) Polar
coordinate transformation using unequal sampling.

Fig. 4. (a) Polar-coordinate image of the internal structure. (b) Global and
local Canny edge detection. (c) Edge indicator of the internal boundary with the
value adjustment algorithm. (d) Cartesian coordinate of the internal boundary
indicator. (e) Elliptical fitting of internal boundary. (f) The internal and external
elliptical boundary.

that the value is most likely obtained from the edge of internal
boundary, we define the value adjustment exclusion range as
[av2 − m 2df 2 , av2 + m 3df 2 ]; otherwise, the value is most likely
obtained from the edge of blastomeres, and thus, we define the
range as [av2 − m 5df 2 , av2 + m 2df 2 ] to mitigate the influence of
dented blastomeres’ edges. Once a boundary value exceeds the
defined range, it will be replaced by the average value of av2
and its original value. The value adjustment is completed by applying a medium filter to smoothen out the boundary indicators.
The coordinates of the boundary indicator are then transformed
back to Cartesian coordinate for ellipse fitting, where the final estimation of internal ZP boundary is derived. As shown in
Fig. 4(f), the center of the internal boundary, (cx3 , cy 3 ) is not
always the same as the center of the external boundary.
B. Dissection Position Selection With Partial Image Stretching
1) Cartesian-to-Polar Coordinate Transformation: The first
step for position selection is to transform the area encircled by
the estimated internal boundary ellipse into the polar coordinate
image by using unequal sampling. The number of samples taken
in each direction is determined by the number of pixels that are
covered by the radius from the origin (cx3 , cy 3 ) in that direction.
There are two main reasons why unequal sampling is critical.
First, equal sampling causes pixels close to the minor axis of
the ellipse to be significantly stretched especially if the major
axis is much longer than the minor axis. It is inevitable that the
estimated internal elliptical boundary encircles a portion of ZP,
which will be exaggerated if it is near the minor axis. For example, the internal ZP boundary is pulled up due to pixel stretching
as shown in Fig. 5(b) and (c). Since the intensity and contrast
of ZP are very similar to the perivitelline space, differentiation
of ZP and perivitelline space becomes very difficult. Second,
applying an arbitrary sampling size may cause image shrinkage
near the major axis, which results in loss of image information.
The number of sampling points is defined as variable D, which

Fig. 6.

(a) Unequal sampling. (b) Unequal stretching.

can be calculated using (2), where a, b, and θ are the major radius, minor radius, and the origin angle of the internal boundary
ellipse, respectively. The maximum and minimum D(θ ) values
equal to the major and minor radius, respectively. Since the
size of the resulting polar coordinate is 720 pixel × a pixel,
whenever D(θ ) is smaller than the major radius a, only pixels
at the bottom of the image are filled with sampled pixels from
the Cartesian coordinate images. Other pixels are filled with
zeros or black pixels. In other words, the size ratio between the
perivitelline space and the ZP is maintained after the coordinate
transformation.
2) Partial Polar-Coordinate Image Stretching: The perivitelline space located at the bottom of the polar-coordinate image
is the part of the image that we are interested in. The perivitelline
space can be differentiated from other structures by utilizing
its properties of low contrast and small variation in intensity.
In order to make the perivitelline space more distinctive, the
polar-coordinate image is stretched unequally by taking more
sampling points from the bottom of the image after replacing
all black pixels with the average image intensity. As shown in
Fig. 6, the perivitelline space portion in the partial stretched
image is significantly magnified.
3) Edge and Intensity Detection: Once the area containing
the perivitelline space is enhanced by partial image stretching,
the next task is to recognize the features of suitable ZP
dissection positions. There are two key features of the stretched
image that we are interested in, the edge and the pixel intensity.
HMC microscopy provides images with 3-D appearance by
converting invisible phase gradients into variations in light
intensity. Boundaries of blastomeres normally appear brighter
or darker than other parts of the image. The distinctive

WANG AND ANG: AUTOMATIC DISSECTION POSITION SELECTION FOR CLEAVAGE-STAGE EMBRYO BIOPSY

Fig. 7. (a) Intensity boundary image. (b) Edge detection of the stretched
image. (c) Combination of (a) and (b).

brightness and darkness are utilized to identify part of blastomeres boundaries. Pixel intensities in each column are sorted
first. Only the coordinates with intensity values that are within
the top and bottom, five-percentile brightness are recorded
and used to form the intensity boundary image, as shown in
Fig. 7(a). We also applied Canny edge detection on the partially
stretched image and the resulting edges were dilated. As the
intensity does not provide boundary information as accurate as
edges, we assign white pixels with different weights. A white
pixel in the intensity boundary image and in the edge image
has a weight of 1 and 3, respectively. Thus in the combination
image, each white pixel has a maximum possible weight of 4
and minimum possible weight of 1.
4) Template Image Correlation for Position Selection: The
final selection of the suitable dissection position is achieved
by correlating a template image with the intensity-edge image.
The template window used for correlation is a trapezoidal shape
with a height equal to one-third of the intensity-edge image’s
height and two arbitrary bases that are 30 and 90 pixels wide,
respectively. When correlating the template window with the
bottom portion of the intensity-edge image, the position with the
minimum correlation value is considered to be the most suitable
position. If there is more than one position having the same
minimum correlation value, the longest consecutive positions
with minimum correlation values are identified. The midpoint
of these positions is considered to be the final position. The
coordinate of the position is then transformed back to Cartesian
coordinate and a curve is drawn to indicate the suitable ZP
dissection position, as shown in Fig. 11(a).
C. Position Selection for ZP Dissection With Value Adjustment
1) Blastomere Boundary Estimation by Edge Detection:
After obtaining the polar-coordinate image using the aforementioned method in Section II-B1, the image is extended by 4 to
8 pixels at the bottom to compensate for the inaccuracy of the
estimating ellipse. This image is then cropped by one-third from
its top to eliminate both the zero padding and pixels with highintensity gradients. Two averaging (pillbox) filters with radii of
5 and 3 pixels are applied to the top-half and the bottom-sixth
of the image respectively, resulting in a double-layer filtered
image. The averaging filter with a 5-pixel radius is applied to

567

Fig. 8. (a) Two-layer smoothened extended and cropped image. (b) Global
edge detection. (c) Local edge detection. (d) Last column pixel of (c) and (d)
with yellow empty column.

Fig. 9. (a) Smoothened image (Top-half). (b) Intensity boundary image. (c)
Blastomeres boundary before value adjustment.

mitigate the threshold bias due to the high-intensity gradient
changes at the top of the image. All noise caused by small
artifacts at the bottom of the image are diminished by applying
the averaging filter with a 3-pixel radius. The resulting image
is then subjected to global and local Sobel edge detection. The
global edge detection is applied to this two-layer smoothened
image. The local edge detection is applied to a three-layer
smoothened image, obtained by smoothening the unfiltered portion of the aforementioned two-layer smoothened image with
an averaging filter with a 2-pixel radius. The results are shown
in Fig. 8.
2) Improvement on Blastomere Boundary Estimation by Intensity Recognition: The lighting feature described in Section
II-B3 is utilized to further improve the accuracy of the blastomere boundaries obtained by edge detection. The top-half
portion of the image is smoothened by an average filter with a
5-pixel radius to eliminate high brightness variations. Intensity
values of each column are sorted and indexed from low to high.
Due to the position of light source, the dominating intensity in
each column is different, i.e., higher pixel intensity in area facing the light source. The dominating intensity is determined by
comparing the average intensity of the column with a threshold
value of 0.5. If the average intensity is above or equal to 0.5,
we define the dominating intensity as bright, otherwise, it is
considered to be dark. When dominating intensity is bright, the
top three percentile of bright pixels in a column will contribute
to the intensity boundary image as shown in Fig. 9. On the other
hand, if the dominating intensity is dark, we take the top three

568

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

Fig. 11. (a) Position selected by implementing ZP dissection position selection
with partial image stretching with correlating template in the lower left corner.
(b) Position selected by ZP dissection position selection with value adjustment
with correlating template in the lower left corner.
Fig. 10. (a) Filled up image with image closing. (b) Boundary image. (c)
Value adjustment from both sides. (d) Filled up image for template correlation.

percent of dark pixels as the boundary pixels. The blastomeres’
boundary is initially defined by the last nonzero pixel positions
of the edge image. As shown in Fig. 8(d), yellow columns indicate columns without any nonzero pixel. Those columns are
filled with the last white pixel of the corresponding column from
the intensity boundary image, as shown in Fig. 9(b). In the case
where there are remaining columns without any white pixel, the
boundary values for those columns are defined as the average
of the neighboring nonzero values.
3) Boundary Value Adjustment and Template Image Correlation: In order to eliminate abrupt and unexpected variations
and to compensate the inaccuracy of the boundary estimation, a
boundary value adjustment method was developed. The resulting boundary image shown in Fig. 9(c) is filled up with white
pixels above the boundary line.
The image is then extended by ten black pixels to facilitate
a 5 × 5 image closing to eliminate those thin lines, as shown
in Fig. 10(a). A boundary value is defined as unexpected and
subjected to change when it meets following criteria:
1) The position of the boundary value is not within a range of
[LM − s, LM + s], where LM is the local average value of
a 90-pixel wide image block where the considering pixel
locates in, and s is the global standard deviation.
2) The boundary value varies more than s/2 from its previous
boundary value.
Columns with boundary values satisfying both criteria are replaced by the boundary value of the previous column. The value
adjustment algorithm is performed on the boundary image twice:
once starts from the right side and the other starts from the left
side, to obtain two new boundary images. Weight correction is
then applied by comparing the values in both boundary images.
The larger and smaller boundary values of the interested column are assigned with a weight of 2/3 and 1/3, respectively.
The final boundary position is obtained by the summation of
the two weight-corrected values, as shown in Fig. 10(c). Pixels
above the boundary lines are then filled up with white pixels for
template correlation. The same template correlation method described in Section II-B4 is applied with a triangular template to
the resulting boundary image. The final ZP dissection position
in Cartesian coordinates is indicated as shown in Fig. 11(b).

Fig. 12. (a) Example of function MSΨAS =TRUE. (b) Number of successful
segmented image versus MatchScore.

III. EXPERIMENTAL RESULTS AND DISCUSSION
We have validated the proposed approach on 45 HMC microscopy images. Each image contains a single embryo with
an internal ZP boundary radius of 70±5 pixels. Most of these
images have one or more features that are undesirable for image
segmentation. These undesirable features include low signalto-noise ratio, low resolution, low contrast, large artifacts and
small artifacts, etc.
A. ZP Boundary Estimation
The internal and external ZP boundaries have been manually
indicated using ellipses placed by an expert. The estimated ZP
boundary ellipses from the proposed method are compared with
the manually recognized ZP boundary ellipses. A MatchScore,
calculated using (4), is applied to define the success of the
automatic segmentation
MatchScore =

n(MSΨAS)
n(AS)

(4)

where MS is the manually segmented boundary ellipse by the
expert and AS is the automatically segmented boundary ellipse
by our proposed method; n(AS) is to calculate the number of
pixels of AS and n(MSΨAS) is to calculate the number of true
results. MSΨAS is defined as a true if in each particular angle,
there is an intersection with MS within a 2-pixel vicinity of
AS. As illustrated in Fig. 12, the cyan squares indicate MS
pixels, the red squares indicate AS pixels, the beige squares
indicate the neighboring pixels of the target AS pixel, and the
black arrow points to the origin of the ellipse. If the beige color
area covers the target MS pixel, n(MSΨAS ) is defined as true;

WANG AND ANG: AUTOMATIC DISSECTION POSITION SELECTION FOR CLEAVAGE-STAGE EMBRYO BIOPSY

569

Fig. 13. (a) Embryo with many suitable ZP dissection positions. (b) Embryo with one suitable ZP dissection position. (c) Embryo with no distinctively
suitable ZP dissection position.

otherwise, it is defined as false. The automatic segmentation is
deemed to be successful when the MatchScore achieved larger
than 85%. Out of 45 images, the ZP boundaries of 43 images
were correctly segmented, giving a success rate of 96%. Failures
of image segmentation are mainly due to the low signal-to-noise
ratio, which causes false edge detections along the internal ZP
boundary.

Fig. 14. (a) Image with artifacts [11]. (b) Karlsson’s method. (c) Karlsson’s
manual modification. (d) Our proposed method.

B. Suitable ZP Dissection Position Selection
The suitable ZP dissection positions are manually selected by
experts using arcs, as shown in Fig. 13. Some embryos have one
or more suitable ZP dissection positions, whereas, some has no
obvious ZP dissection position. We deemed our testing result
successful if the cutting position recommended by our system
lies within the manually selected arc.
1) Partial Image Stretching: Our approach for ZP dissection
position selection by using partial image stretching successfully
indicated a suitable ZP dissection position in 42 of 45 embryo
images, achieving a 94% success rate.
2) Value Adjustment: The ZP dissection position selection
method with the value adjustment algorithm was able to achieve
the same success rate by successfully selecting suitable positions
in 42 of 45 embryo images.
C. Discussion
The proposed ZP boundary estimation method is a fully automatic approach. Since edge values that exceed a certain range
are replaced by adjusted values, the accuracy of the boundary
estimation is not easily affected by artifacts appearing in the
image. Compared to Karlsson’s method, our approach can estimate the boundary without manual mask insertion, as shown in
Fig. 14. This is due to the built-in value adjustment algorithm.
As the proposed method is based on edge detection, it can also
be applied to bright field embryo image.
The testing of our ZP dissection position selection algorithms
was dependent on the ZP boundary estimation algorithm. However, this does not mean that a low MatchScore will lead to
failure in our position selection algorithm. For example, though
the manually drawn internal boundary ellipse has a MatchScore
less than 80%, as shown in Fig. 15, the resulting position selected
for ZP dissection is still acceptable. This is because the internal boundary ellipse encircled a portion of perivitelline space.
Although both approaches achieved 94% success rate, the po-

Fig. 15. (a) Image with MatchScore less than 80%. (b) ZP dissection position
selection.

TABLE I
TABLE OF SUCCESS RATES
Method

Success rate

ZP boundary estimation
Partial image stretching algorithm
Value adjustment algorithm

96%
94%
94%

sitions selected for suitable ZP dissection may be different, as
shown in Fig. 11. By comparing the accuracy of positions recommended by both methods, we discovered that the first method
is superior to the second in low-contrast image segmentation,
while the second method performs better on embryos with more
complex internal structure. Therefore, users can select the more
appropriate approach according to the situation encountered.
IV. CONCLUSION
In this paper, we have presented a method to automatically
select a suitable ZP dissection position from a single embryo
image. The proposed method consists of elliptical estimation
of both the internal and external boundary of the ZP and two
methods to select the suitable ZP dissection position. We have

570

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 3, MARCH 2016

validated our techniques on 45 HMC images and obtained the
success rates as follows shown in Table. I.
Our objective is to select the suitable ZP dissection position.
The elliptical ZP boundary estimation can also be applied to
ZPTV and other ZP morphology measurements with further
improvement. Furthermore, our methods provide a starting point
for fast position selection prior to automatic PGD.
REFERENCES
[1] K. Sermon et al., “Preimplantation genetic diagnosis,” Lancet, vol. 363,
no. 9421, pp. 1633–1641, May 2004.
[2] M. Boada et al., “Successful use of a laser for human embryo biopsy in
preimplantation genetic diagnosis: Report of two cases,” J. Assist. Reprod.
Genet., vol. 15, no. 5, pp. 302–307, May 1998.
[3] G. Garrisi et al., “Clinical evaluation of three approaches to
micromanipulation-assisted fertilization,” Fertility Sterility, vol. 54,
no. 4, pp. 671–677, Oct. 1990.
[4] J. Selva, “Assisted hatching,” Hum. Reprod., vol. 15, no. suppl. 4,
pp. 65–67, Dec. 2000.
[5] D. A. Morales et al., “Bayesian classification for the selection of in vitro
human embryos using morphological and clinical data,” Comput. Methods
Programs Biomed., vol. 90, no. 2, pp 104–116, May 2008.
[6] E. Van Royen et al., “Characterization of a top quality embryo, a
step towards single-embryo transfer,” Hum. Reprod., vol. 14, no. 9,
pp. 2345–2349, Sep. 1999.
[7] A. Gabrielsen et al., “Influence of zona pellucida thickness of human
embryos on clinical pregnancy outcome following in vitro fertilization
treatment,” J. Assist. Reprod. Genet., vol. 17, no. 6, pp. 323–328, Jul.
2000.
[8] R. Gonzales and R. Woods, “Image segmentation,” in Digital Image Processing, 3rd ed., Upper Saddle River, NJ, USA: Prentice-Hall, 2008, ch.
10, pp. 689–787.
[9] A. Beuchat et al., “Quantitative morphometrical characterization of human
pronuclear zygotes,” Hum. Reprod., vol. 23, no. 9, pp. 1983–1992, Sep.
2008.

[10] A. Karlsson et al. (2005). A two-step area based method for automatic
tight segmentation of zona pellucida in HMC images of human embryos. in
Proc. 5th Int. Conf. Scale Space PDE Methods Comput. Vis., pp. 503–514
[Online]. Available:http://link.springer.com/
[11] A. Karlsson et al., “Automatic segmentation of zona pellucida in HMC
images of human embryos,” in Proc. 17th Int. Conf. Pattern Recog., Cambridge, U.K., 2004, pp. 518–521.
[12] C. Xu and J. L. Prince, “Snakes, shapes, and gradient vector flow,” IEEE
Trans. Image Process., vol. 7, no. 3, pp. 359–369, Mar. 1998.
[13] D. A. Morales et al., “Automatic segmentation of zona pellucida in human embryo images applying an active contour model,” in Proc. 12th
Annu. Conf. Med. Image Understanding Anal., Dundee, U.K., 2008,
pp. 104–116.
[14] E. S. Filho et al., “A method for semi-automatic grading of human blastocyst microscope images,” Hum. Reprod., vol. 27, no. 9, pp. 2641–2648,
Sep. 2012.
[15] D. Yee et al., “An automatic model-based approach for measuring the
zona pellucida thickness in day five human blastocysts,” in Proc. Int.
Conf. Image Process., Comput. Vis., Pattern Recog., Las Vegas, NV, USA,
2013, pp 877–880.
[16] A. Giusti et al., “Blastomere segmentation and 3D morphology measurements of early embryos from Hoffman modulation contrast image stacks,”
in Proc. IEEE Int. Symp. Biomed. Imaging: From Nano Macro, 2010,
pp. 1261–1264
[17] A. Giusti et al., “Segmentation of human zygotes in Hoffman modulation
contrast images,” in Proc. Annu. Conf. Med. Image Understanding Anal.,
2009.
[18] N. Feng et al., “Toward automatic phenotyping of developing embryos
from videos,” IEEE Trans. Image Process., vol. 14, no. 9, pp. 1360–1371,
Sep. 2005.
[19] Y. Tian et al., “Automatic blastomere recognition from a single embryo
image,” Comput. Math. Method Med., vol. 2014, no. 628312, pp. 1–7, Jun.
2014.

Authors’ photographs, and biographies not available at the time of publication.

