IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

839

Denoising of Ictal EEG Data Using Semi-Blind
Source Separation Methods Based on
Time-Frequency Priors
Sepideh Hajipour Sardouie, Student Member, IEEE, Mohammad Bagher Shamsollahi, Senior Member, IEEE,
Laurent Albera, Senior Member, IEEE, and Isabelle Merlet

Abstract—Removing muscle activity from ictal ElectroEncephaloGram (EEG) data is an essential preprocessing step in diagnosis and study of epileptic disorders. Indeed, at the very beginning
of seizures, ictal EEG has a low amplitude and its morphology in
the time domain is quite similar to muscular activity. Contrary to
the time domain, ictal signals have specific characteristics in the
time-frequency domain. In this paper, we use the time-frequency
signature of ictal discharges as a priori information on the sources
of interest. To extract the time-frequency signature of ictal sources,
we use the Canonical Correlation Analysis (CCA) method. Then,
we propose two time-frequency based semi-blind source separation
approaches, namely the Time-Frequency-Generalized EigenValue
Decomposition (TF-GEVD) and the Time-Frequency-Denoising
Source Separation (TF-DSS), for the denoising of ictal signals based
on these time-frequency signatures. The performance of the proposed methods is compared with that of CCA and Independent
Component Analysis (ICA) approaches for the denoising of simulated ictal EEGs and of real ictal data. The results show the superiority of the proposed methods in comparison with CCA and
ICA.
Index Terms—Canonical Correlation Analysis (CCA), Denoising Source Separation (DSS), ElectroEncephaloGram (EEG),
epileptic seizure, fast ictal activity, Generalized EigenValue Decomposition (GEVD), semi-blind source separation.

I. INTRODUCTION
PILEPSY is one of the most common neurological disorders. In diagnosis and study of epileptic disorders, ElectroEncephaloGraphy (EEG) is a widely used technology. In particular, the recording and interpretation of EEG ictal discharges
during seizures in patients with refractory partial epilepsy is a
key component in the presurgical evaluation of these patients

E

Manuscript received January 6, 2014; revised May 15, 2014; accepted June
28, 2014. Date of publication July 28, 2014; date of current version May 7,
2015.
S. Hajipour Sardouie is with the Inserm, UMR 1099, F-35000 Rennes,
France, with the LTSI, University of Rennes 1, Rennes, F-35000, France,
and also with the BiSIPL, Sharif University of Technology, Tehran (e-mail:
sepideh.hajipour@gmail.com).
M. Bagher Shamsollahi is with the BiSIPL, Sharif University of Technology,
Tehran (e-mail: mbshams@sharif.edu).
L. Albera is with the Inserm UMR 1099, F-35000 Rennes, France, with the
LTSI, University of Rennes 1, F-35000 Rennes, France, and is also with the
INRIA, Centre Inria Rennes-Bretagne Atlantique, 35042 Rennes Cedex, France
(e-mail: laurent.albera@univ-rennes1.fr).
I. Merlet is with the Inserm, UMR 1099, F-35000 Rennes, France, and is
also with the LTSI, University of Rennes 1, F-35000 Rennes, France (e-mail:
isabelle.merlet@univ-rennes1.fr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2336797

that contributes, along with other morphological and functional
explorations, to the delineation of the epileptogenic zone. The
intracerebral recording of these discharges in partial epilepsies
have shown the occurrence of low voltage fast activity at the beginning of seizures. These rapid ictal discharges are considered
as electrophysiological signatures of the epileptogenic zone, i.e.,
of the brain region(s) from where the seizure starts [1]–[3]. The
surgical resection of regions generating rapid ictal discharges
has been correlated with a good surgical outcome [4]–[6]. Therefore, tracking these rapid discharges on scalp EEG is critical for
the presurgical evaluation of patients who are candidates for
selective surgery. Unfortunately, the rapid ictal discharges are
of low amplitude and therefore difficult to detect on scalp EEG,
even more so when signals are contaminated with various kind
of artifacts. Among them, muscular activity arising from the
contraction of head muscles is often associated with clinical
symptoms occurring at the onset of seizures, and is particularly
difficult to remove due to its broad distribution in frequency and
its unstereotyped spatial distribution.
Different denoising methods have been proposed and tested
to denoise ictal signals, from simple low-pass filtering to more
complicated algorithms, such as matched filtering [7] and Blind
Source Separation (BSS) methods. Principal Component Analysis, Independent Component Analysis (ICA), and Canonical
Correlation Analysis (CCA) are the most common BSS techniques. These techniques have been used to denoise ictal EEG
data [8]–[13] and were shown to be efficient to retrieve the EEG
rhythmic activity during seizures. However, these studies have
not specifically address the difficult issue of denoising fast ictal
activity arising at the onset of seizures. As their names indicate,
the BSS methods do not use any prior information from subspace of interest. But in some applications, useful knowledge
about sources of interest is either available or can be achieved.
In our application, although ictal fast activity does not have a
specific morphology in the time domain, its signature in the
time-frequency domain is narrow-band while that of muscle activity is broad-band [10]. These characteristics can be used to
separate ictal fast activity from muscular activity.
In this paper, we propose two methods for denoising ictal
EEG data based on the Generalized EigenValue Decomposition
(GEVD) and on the Denoising Source Separation (DSS) [14]
frameworks, respectively. Indeed, we are interested in proposing semi-blind source separation methods instead of completely
blind ones. To this end, we look for some a priori information on
sources of interest to define the covariance matrix in the GEVD

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

840

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

method and in the denoising step of the DSS method. Accordingly, the proposed semi-blind methods, namely TF-GEVD and
TF-DSS, use the time-frequency signature of ictal discharges to
denoise ictal EEGs. To extract the time-frequency information
on ictal sources, we use the CCA approach that has been shown
to be the most efficient method to date for denoising ictal EEG
signals contaminated by muscular activity [8]–[10]. In the rest of
this paper, we first present the problem formulation. Section III
begins with the description of the CCA-based method used to
extract the time-frequency signature of ictal subspace. Then,
we define the general formulation of the proposed semi-blind
methods and mathematically compare their formulations. In
Section IV, we compare the performance of the proposed algorithms with that of CCA [8] and ICA [15] for the denoising
of both simulated and real ictal data. This section is followed by
the conclusion.
II. PROBLEM FORMULATION AND NOTATIONS
The ictal EEG data are recorded by means of M electrodes
placed over the scalp according to one of the international systems. Mean subtraction is then performed. That is, for each
channel, the mean of the corresponding time series is subtracted
from each value in order to remove constant artifacts, leaving
M EEG signals oscillating positively and negatively around
the zero line. The N samples of the resulting M -dimensional
centered ictal EEG signal can then be modeled as follows [15]:
x[n] = A(e) s(e) [n] + A(b) s(b) [n] + A(m ) s(m ) [n] + ν[n] (1)
where {s(e) [n]}, {s(b) [n]}, {s(m ) [n]}, and {ν[n]} are centered vector signals representing Pe ictal epileptic activities,
Pb background activities, Pm muscular activities, and an M dimensional instrument noise, respectively, with Pe + Pb +
Pm > M . The mixing matrices A(e) , A(b) , and A(m ) of
size (M × Pe ), (M × Pb ) and (M × Pm ), model the transfer function from all possible activities within the brain to scalp
electrodes.
In addition, we can assume that the four vector signals
{s(e) [n]}, {s(b) [n]}, {s(m ) [n]}, and {ν[n]} generate four linearly independent subspaces of RN , respectively, since they
correspond to different physiological/physical phenomena. Let
P̃e , P̃b , P̃m , and P̃ν be the dimensions of the four previous
subspaces. Then, we will also assume the following inequality
P̃ ≤ M where P̃ = P̃e + P̃b + P̃m + P̃ν .
As a result, at best we can hope to identify the four subspaces
generated by the epileptic activities, the muscular activities, the
background activities, and the instrument noise, respectively, but
not exactly the P = Pe + Pb + Pm electrophysiological activities and the M noise signals involved in (1). Note that this subspace identification is sufficient for the EEG denoising problem
since we do not want to exactly extract the Pe epileptic activities;
in fact, we just want to remove the contribution of the muscular
activities, the background activities and the instrument noise
from the scalp data {x[n]}.
Let the P̃e -dimensional signal {s̃(e) [n]}, the P̃b -dimensional
signal {s̃(b) [n]}, the P̃m -dimensional signal {s̃(m ) [n]}, and the
P̃ν -dimensional signal {s̃(ν ) [n]} be an orthogonal centered vec-

tor basis of the epileptic, background, muscular, and instrument
noise subspaces, respectively, and be mutually orthogonal. Then
(e)
(b)
there exists four matrices of coordinates, namely Ã , Ã ,
(m )
(ν )
Ã , and Ã , such that:
x[n] = Ã

(e) (e)

+Ã

s̃

[n] + Ã

(ν ) (ν )

s̃

(b) (b)

s̃

[n] + Ã

(m ) (m )

s̃

[n]

(2)

[n] = Ã s̃[n]

where the P̃ rows {s̃p [n]} of the vector signal {s̃[n]} are pairwise orthogonal. Consequently, by assigning the following inner
product of RN :
{y[n]}, {z[n]} =

N


y[n] z[n]

(3)

n =1

the (P̃ × P̃ ) matrix C s̃ , whose (p1 , p2 )-th component is equal
to {s̃p 1 [n]}, {s̃p 2 [n]}, is a diagonal matrix.
As a result, by computing an orthogonal vector basis {s̃(e) [n]}
(e)

of the epileptic subspace and the corresponding Ã matrix of
coordinates from the measurements {x[n]}, the M -dimensional
(e)

signal {x(e) [n]} given by x(e) [n] = Ã s̃(e) [n] will represent
the denoised ictal EEG data.
In the following sections, the p-th ictal source and the
p-th source will correspond to the p-th vector of the epileptic basis {s̃(e) [n]} and the p-th vector of the whole basis {s̃[n]},
respectively. In addition, we denote by Tx m [n, k] the linear timefrequency transform of the m-th recorded ictal EEG signal, in
the time sample n and frequency sample k. The M -dimensional
vector Tx [n, k] then contains the (n, k)-th linear time-frequency
samples of the M channels. Therefore, according to (2), for each
couple (n, k) of {1, . . . , N } × {1, . . . , K}, we have
Tx [n, k] =

P̃


ãp Ts̃ p [n, k] = Ã Ts̃ [n, k]

(4)

p=1

where Ts̃ p [n, k], Ts̃ [n, k] denote the linear time-frequency transform of the p-th source and that of the P̃ sources in the timefrequency sample (n, k), respectively.
According to the property that the energy of the P̃e ictal
epileptic activities is local in the time-frequency domain [10],
for the p-th ictal source, we assume that the largest portion
of its energy is reserved in a time-frequency subset TF (p) of
{1, ..., N } × {1, ..., K}. Thus, we aim at computing an orthogonal vector basis of the epileptic subspace using this a priori
information on the ictal sources through specific time-frequency
matrices. Let us assign the following inner product of C N ×K :
{y[n, k]}, {z[n, k]} =

N 
K


y[n, k] z[n, k]∗

(5)

n =1 k =1

where z[n, k]∗ denotes the conjugate of z[n, k]. Given an
L-dimensional signal {u[n]} and its linear time-frequency
transform {Tu [n, k]}, we define the time-frequency matrices
 u and C
 (p) as the (L × L) matrices whose (1 , 2 )C
u


th component is equal to {Tu  1 [n, k]}, {Tu  2 [n, k]}


and
{Tu  1 [n, k] 1TF ( p ) [n, k]}, {Tu  2 [n, k] 1TF ( p ) [n, k]} ,

HAJIPOUR SARDOUIE et al.: DENOISING OF ICTAL EEG DATA USING SEMI-BLIND SOURCE SEPARATION METHODS

Fig. 1.

841

Flowchart of the denoising procedure to extract the p-th ictal subspace corresponding to the p-th ictal source.

respectively, where 1TF ( p ) [n, k] is equal to one if (n, k) belongs
to TF (p) and zero otherwise. We, thus, define the (L × L)
 ( p̄) by C
 ( p̄) = C
u − C
 (p) . Note that
time-frequency matrix C
u
u
u
for L = 1, i.e., for a monodimensional signal {u[n]}, we will
replace the bold capital letter C by the lower case letter c. It is
also noteworthy that  will denote the pseudoinverse operator
in the following sections.
III. METHODOLOGY
In this section, we propose two semi-blind source separation
methods to denoise ictal EEG signals. They use some a priori information on the ictal sources in the time-frequency domain that
should be initially extracted. The general flow chart of the proposed methods to extract the ictal subspace corresponding to the
p-th ictal source is shown in Fig. 1. As shown in this figure,
the proposed methods consist of three main steps: 1) extracting the linear time-frequency signature of the p-th ictal source,
2) calculating the time-frequency transform of the observations,
and 3) applying a time-frequency-based semi-blind denoising
method to linear time-frequency transform of the observations.
The proposed methods only differ in the third block where either TF-GEVD or TF-DSS is used for the denoising procedure.
These steps are explained in details in the rest of this section
and then the relation between the two proposed methods is
studied.
A. Extracting Time-Frequency Mask Corresponding to Each
Ictal Source
The CCA approach is a BSS method that extracts the sources
from observations with the main assumption that the sources are
mutually uncorrelated as well as maximally autocorrelated [8].
As shown in previous studies [8], [10], CCA surpasses other
methods for the denoising of ictal signals. Nevertheless, it can
not achieve good results in some instances such as low SNRs.
In the method we propose, we use the CCA method to extract
some a priori information on ictal sources in order to improve
the ictal noise cancelation process. To this end, we apply the
CCA method on the observed EEGs to obtain M sources. The
next step consists in selecting the sources of ictal activity. A
visual selection of ictal sources from their time course is difficult and sometimes impossible. Therefore, different methods
have been proposed to select ictal sources from all extracted
ones, such as methods based on the time-frequency transform
of each source [10] and methods based on spectral coherence

Fig. 2. Procedure used to create the time-frequency mask corresponding to an
ictal source, (a) selected ictal source generated by CCA, (b) time-frequency representation (absolute value of CWT) of the ictal source, and (c) time-frequency
mask corresponding to the ictal source of (a).

of sources [12]. To select the sources corresponding to ictal
activities, we use the linear time-frequency representation of
each source and then we choose the sources of interest based
on a signature that consists of a narrow-band, high-frequency
mode at the beginning of the seizure, that decreases in frequency over time. Fig. 2(a) and (b) shows an example of the
selected ictal source extracted by CCA and its linear timefrequency representation, respectively. In this paper, we use the
Continuous Wavelet Transform (CWT) with real Morlet mother
wavelet which shows a good representation of ictal sources in
the time-frequency domain. As explained later in this section,
since the real-valued data should be used in the proposed algorithms, CWT with real Morlet mother wavelet is an appropriate
choice. After selecting the sources of interest, we use an automatic procedure to generate the time-frequency mask. To this
end, we use an appropriate threshold to select the dominant
time-frequency samples from the linear time-frequency representation of each source of interest. The threshold used for
the source of interest s̃p is obtained as ths̃ p = m|T s̃ p | + σ|T s̃ p | ,
where m|T s̃ p | and σ|T s̃ p | are the mean value and standard deviation of the absolute values of Ts̃ p [n, k] over all (n, k) ∈
{1, ..., N } × {1, ..., K}, respectively. Then, the absolute value
of Ts̃ p [n, k] is compared with ths̃ p at each time-frequency

842

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

sample (n, k) and the p-th time-frequency mask S (p) is obtained
as follows:

1, if |Ts̃ p [n, k]| ≥ ths̃ p
S (p) [n, k] =
(6)
0,
o.w.
Then, we consider the obtained time-frequency mask S (p) as a
binary image and modify it by using morphological operators.
To this end, we use the morphological “closing” operator [16]
with a disk structuring element of size 1. The “closing” operator
performs morphological closing on the grayscale or binary image by applying a dilation followed by an erosion, using the same
structuring element for both operations. By using this operator,
the holes in the initial time-frequency mask are filled. Fig. 2(c)
shows the time-frequency mask created by the aforementioned
procedure. The time-frequency samples corresponding to the
p-th ictal source are then reserved in the set TF (p) :
TF

(p)

= {(n

(p)

,k

(p)

) ∈ the p-th ictal mask}.

(7)

The obtained samples will then be used in the proposed
TF-GEVD or TF-DSS methods to denoise ictal signals.

based method to denoise ictal EEG data in the time-frequency
domain.
The TF-DSS algorithm is based on a whitening of the
linear time-frequency transform of observations, {Tx [n, k]},
 z of the output signal
such that the time-frequency matrix C

z[n] = Θ x[n] is equal to the identity matrix. In practice,
Θ is computed as a square root of the time-frequency ma x . By means of this whitening procedure, the matrix Ã
trix C
defined in (2) is transformed into an orthogonal matrix of size
(P̃ × P̃ ).
The four consequent steps are the main steps of the TF-DSS
method which are repeated in an iterative procedure to extract
the p-th ictal source [14]. First, by using a P̃ -dimensional initial
vector wp of unit norm, a noisy estimate of the time-frequency
transform of the p-th ictal source for each time-frequency sample
(n, k) is calculated as follows:
Ty ( e ) [n, k] = w
p Tz [n, k].
p

The next step, called the denoising step, is the main stage of the
algorithm. In this stage, the current estimated time-frequency
transform of the p-th ictal source, for each time-frequency sample (n, k), is modified or denoised as follows:

B. TF-GEVD

T +( e ) [n, k] = Ty ( e ) [n, k] 1TF ( p ) [n, k].

In this section, we propose a GEVD-based method to identify
the p-th ictal source using its time-frequency support TF (p) .
More particularly, we aim at computing the M -dimensional
(e)
(e)
vector wp such that the signal {yp [n]} defined by yp [n] =

wp x[n] is an estimate of the p-th ictal source. To this end, we
maximize the following quotient of energies on and outside the
time-frequency support TF (p) :
(p)

J

(p)


c
(w) =

(e )

yp
( p̄)


c

(e )
yp

=

 (p) w
w C
x

yp

p

yp

and normalized as follows:
+
+

w+
with
p = [wp,1 , · · · , wp, P̃ e ]


+
{Tz p 	 [n, k]}, {T +( e ) [n, k]}
wp,p
	 =

(8)
wp =

which is a Rayleigh quotient. Finding the argument wp of the
maximum of (8) is equivalent to solving a specific GEVD problem, i.e., computing the eigenvector associated with the largest
−1
 ( p̄) ) C
 (p) .
eigenvalue of the (M × M ) matrix (C
x
x
By executing the aforementioned procedure for each p ∈
(e)
{1, ..., P̃e }, P̃e vectors wp are extracted and the matrix Ã
of coordinates can be estimated as X(Y (e) ) , where X and
Y (e) are the (M × N ) and (P̃e × N ) matrices standing for the
M -dimensional signal {x[n]} and the P̃e -dimensional signal
(e)
(e)
{y (e) [n]}, respectively, with y (e) [n] = [y1 [n], . . . , yP̃ [n]] .

w+
p

w+
p 


.

(11)
(12)

Then, the present estimated mixing vector wp is passed to the
first step given by (9) and this procedure continues until its convergence. The global convergence of the iterative DSS scheme
is proved in [14]. The outputs of the algorithm, wp and the sig(e)
(e)
nal {yp [n]}, which is defined by yp [n] = w
p z[n], are the
separator and an estimate of the p-th ictal source.
It should be noted that if we have extracted the first p − 1
sources, to extract the p-th source, the fourth step given by (12)
can be replaced by
⊥
+
w⊥
p = Π wp

e

C. TF-DSS
The DSS [14] method is a relatively recent framework which
can be used to design new source separation algorithms. This
framework can be optimized to generate a wide range of
source separation algorithms, from completely to partially blind
methods to solve specific problems. In this framework, the
source separation algorithms incorporate denoising methods,
such that various kinds of prior knowledge are formulated based
on denoising goals [14]. In this section, we propose a DSS-

(10)

In the third and fourth steps, by using the denoised
time-frequency transform of the p-th ictal source, namely
{T +( e ) [n, k]}, a new estimation of the mixing vector is calculated

yp

 ( p̄) w
w C
x

(9)

wp =

w⊥
p

w⊥
p


(13)
(14)

where the orthogonal projector Π⊥ is defined by
Π⊥= I − B (p−1) (B (p−1) B (p−1) )−1 B (p−1)
= I − B (p−1) B (p−1)
(p−1)

(15)

= [w1 , . . . , wp−1 ].
with B
By adding this deflation step to the DSS framework, the convergence to previously extracted ictal sources is prevented [14].

HAJIPOUR SARDOUIE et al.: DENOISING OF ICTAL EEG DATA USING SEMI-BLIND SOURCE SEPARATION METHODS

843

Fig. 3. Denoising results of one trial of simulated ictal data. (a) a noise free ictal EEG, (b) the noisy ictal EEG with the SNR value of −20 dB, denoised signal
by using (c) CoM2 , (d) CCA, (e) TF-GEVD, and (f) TF-DSS. For the sake of space, we display the EEG at channel T3 only, as this channel showed the highest
amplitude of ictal activity. At the right of each row, the source localization results at the output of 4-ExSo-MUSIC are illustrated for one trial (2), as an example.
Dark brown: real patch; violet: truly estimated part of the patch; orange: falsely estimated part of the patch.

By executing the aforementioned procedure for each p ∈
{1, ..., P̃e }, all separators wp and consequently, the correspond(e)

ing ictal source are estimated. The matrix Ã of coordinates
can then be obtained similarly to the TF-GEVD method as described at the end of Section III-B.
D. Relation Between TF-GEVD and TF-DSS Methods
In this section, we study the similarity between both proposed
algorithms to extract the p-th ictal source. First, for the TF-DSS
method, we do not consider the deflation step (13), which means
that only one ictal source has to be estimated.
In the TF-GEVD method, the GEVD problem of the pair of
 ( p̄) can be reformulated as an exact joint
 (p) and C
matrices C
x
x
diagonalization by congruence problem of these two matrices.
On the other hand, when the denoising stage in DSS algorithm is linear, the whole iterative algorithm can be expressed
as a closed-form solution. In Section III-C, by inserting (9) and
(10) into (11), we can show that the four steps of the TF-DSS
algorithm can be summarized by the following procedure:
 (p)
w+
p = C z wp
wp =

w+
p

w+
p 


 (p) . Consequently, the (P̃e × M )
of the symmetric matrix C
z
(p)
(p)
matrix WDSS given by WDSS = W (p)  Θ diagonalizes by
 (p) . Moreover, due to
congruence the time-frequency matrix C
x
 x,
the orthogonality of W (p) and since Θ is a root square of C
(p)

we can easily show that the matrix WDSS also diagonalizes
 x . As a result, the
by congruence the time-frequency matrix C
TF-DSS algorithm estimates the p-th ictal source by means
 (p)
of a joint diagonalization by congruence of the matrices C
x
 x.
and C
Now by comparing the two joint diagonalization problems
corresponding to the TF-GEVD and TF-DSS methods, the for ( p̄) ,
 (p) and C
mer simultaneously diagonalizes the matrices C
x

(16)

⊥  (p)
w⊥
p = Π C z wp

(17)

wp =

which is actually the classical power method applied to matrix
 (p) in order to compute its dominant eigenvector wp . Let W (p)
C
z

be the orthogonal matrix of the P̃e eigenvectors (including wp )

x

 x,
 (p) and C
while the latter jointly diagonalizes the matrices C
x
(p)
( p̄)
x = C
 +C

where C
x
x according to the definitions given in
Section II.
Now, if we consider the deflation step (13) for the TF-DSS
method, (17) and (18) will be changed to

w⊥
p

w⊥
p


(18)
(19)

 (p) . Consewhich results in diagonalization of matrix Π⊥ C
z
quently, the TF-DSS method to extract the p-th ictal source
can be described as two serial diagonalization steps, say

844

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

Fig. 4. Average RRMSE denoising error of each one of the four algorithms in
different SNR values of −30 to 0 dB, (a) at all channels and (b) at channel T3.

 x and diagonalization of Π⊥ C
 (p) . But
diagonalization of C
z
contrarily to the previous case, it seems that these two diagonalizations cannot be simplified to a joint diagonalization problem
preventing us to compare more precisely the TF-DSS and TFGEVD algorithms when two or more ictal sources have to be
estimated.
IV. EXPERIMENTS AND RESULTS
In this section, we study the effectiveness of the two proposed
algorithms to denoise ictal EEG data by using both simulated
and real data. We also compare these two algorithms with the
CCA and ICA methods. CoM2 was used to represent the ICA
approach based on the study proposed in [15] showing the good
tradeoff between estimation accuracy and numerical complexity
of CoM2 .
A. Simulated Ictal Data
The simulated EEG data were generated using a realistic
model developed by our team [17]–[18]. To reproduce the complex geometry of the cerebral neocortex, a mesh of the cortical
surface at the interface of gray and white matter (BrainVisa,
SHFJ, Orsay, France) was built from the segmentation of 3-D
T1 MRI image. This mesh is composed of 40500 triangles of
mean surface 5 mm2 . Each triangle of the mesh has been associated with an elementary current dipole located at the centroid of
each triangle and perpendicular to its surface. The source of ictal
epileptic activity is manually delineated on the mesh. We consider a source in the left superior temporal gyrus consisting of
100 contiguous triangles (patch) which represents a source area
around 5 cm2 . The temporal dynamics of the activity associated

Fig. 5. Source localization results obtained from original, noisy, and denoised
ictal simulated data. The average source localization ROC curves (top) of the
four algorithms, and the source localization results (bottom) for a single trial
(9) are displayed for SNR values of (a) −30 dB, (b) −20 dB, and (c) −10 dB.
Dark brown: real patch; violet: truly estimated part of the patch; orange: falsely
estimated part of the patch.

with each triangle are generated by a macroscopic model of neuronal populations [18]. To generate the ictal discharge dynamics,
we apply the settings to get a fast activity during the first 10 s
and then tune the parameters to obtain a slow rhythmic activity
during the last 15 s. Between these two activities, we consider a
linear transition period of 2 s. We assigned this ictal activity to
all the dipoles forming the patch. From this setup, the simulated
ictal EEG was obtained at the level of 32 scalp electrodes (placed
over the scalp according to the international 10–20 and 10–10
systems). In order to solve the forward problem, we used a realistic head model made of three nested homogeneous surfaces
shaping the brain, the skull, and the scalp and the Boundary
Element Method (ASA, ANT, Enschede, Netherlands).
Following this procedure, 50 Monte Carlo simulations were
generated (i.e., original simulated data). In order to get noisy

HAJIPOUR SARDOUIE et al.: DENOISING OF ICTAL EEG DATA USING SEMI-BLIND SOURCE SEPARATION METHODS

845

Fig. 6. Real EEG recorded from an epileptic patient during two separate ictal periods: (a) an almost noise free ictal EEG. The channel C3 shows ictal activity
consists of three parts: 1) rhythmic spikes (red box), 2) fast activity (green box), and 3) slower irregular activity (blue box). (b) another ictal EEG contaminated by
muscle activity.

data, 50 realizations of a signal of noninterest were added to
the original simulated signals with a specified signal-to-noise
ratio (SNR). Signals of noninterest were composed of muscle
activity, background EEG, and instrument noise extracted from
real 32-channel EEG data.
To analyze the effectiveness of the proposed algorithms to
denoise ictal data, we compared them with the CCA and ICA
methods by using two criteria. The first criterion is the relative
root-mean-squared error (RRMSE) [8] given by


2
M N 	 (e)
(e)
1
x
[n]
−
x̂
[n]
m
m
m =1
n =1
MN

(20)
RRMSE =
M N 	 (e) 
2
1
m =1
n =1 xm [n]
MN
(e)

(e)

where xm [n] and x̂m [n] are the original and estimated epileptic
subspaces on the m-th channel, respectively. We also compared
source localization results obtained on noise-free, noisy and denoised data by the 4-ExSo-MUSIC algorithm [19] using the
receiver operating characteristic (ROC) curve as a performance
criterion. This criterion represents the mathematical expectation
of the True Positive Fraction (TPF) as a function of the mathematical expectation of the False Positive Fraction (FPF). The
TPF is the fraction between the area of the patch truly retrieved
and the total patch area, while the FPF is the fraction between
the area falsely localized outside the patch and the total cortical
area minus the patch area [20].
Fig. 3 shows an example of the denoising and source localization results. Fig. 3(a) shows the original noise free signal.
The maximal amplitude of the simulated ictal signal is obtained
at electrode T3. Fig. 3(b) illustrates the same trial of ictal data,
after adding muscle activity (noisy data: −20 dB). Fig. 3(c)–(f)
shows the denoised signal by using the CoM2 , CCA, TF-GEVD,
and TF-DSS algorithms, respectively. It should be noted that for
the CoM2 algorithm, we varied the number of sources in the
range P ∈ {4, 8, 12, 16, 20, 24, 28, 32} and chose the value of
P yielding the best RRMSE. As shown in these figures, CCA,

TF-GEVD, and TF-DSS preserved ictal activity at electrode T3.
But CoM2 could not perfectly denoise the signal at this electrode
and kept some undesired activity at the other electrodes. Although the CCA method worked well to preserve ictal activity
in the electrodes that record the highest amplitude of ictal activity in original data, it decreased the activity in other electrodes
such as FP1 and FP2. This bias affected the source localization
results. The best source localization results are obtained from
TF-GEVD and TF-DSS denoised data.
Fig. 4 shows the average RRMSE of each one of the four
algorithms for different SNR values of −30 to 0 dB. In Fig. 4(a)
and (b), RRMSE is calculated at all channels and at channel
T3, respectively. As illustrated in these figures, the errors of the
proposed algorithms TF-GEVD and TF-DSS are similar and
are clearly smaller than the errors of CoM2 and CCA for low
SNR values. These results show that the proposed algorithms
are good both on a global point of view (i.e., when all electrodes
are considered) and on a more local point of view (i.e., when
only T3 electrode is considered).
Fig. 5(a)–(c) shows the average source localization ROC
curves of the four algorithms over the 50 trials for SNR =
−30 dB, SNR = −20 dB, and SNR = −10 dB, respectively.
In these figures, the ROC curves corresponding to noisy and
noise-free signals are also drawn. The source localization results for a single trial are depicted at the bottom of each column
to ease the comparison between the denoising methods. As it
can be seen in these figures, the proposed algorithms denoise
better, and consequently, give better source localization results
than those obtained from CoM2 or CCA denoised signals.
B. Real Ictal Data
The denoising algorithms were also tested on real ictal data
recorded from a 23-year-old patient. These data were collected
from a long-term video-EEG recording (32 electrodes, 256 Hz,
BP [0.3–100] Hz) in which we could collect several ictal signals.
One of these segments is a low noise ictal EEG with very little

846

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

Fig. 7. Time courses and time-frequency representations at the channel C3 of: (a) the noise free ictal EEG, (b) the noisy ictal segment, (c) TF-GEVD denoised,
(d) TF-DSS denoised, (e) CCA denoised, and (f) CoM2 denoised EEGs. Ictal fast activity is shown in the white circle on the time-frequency representation.

HAJIPOUR SARDOUIE et al.: DENOISING OF ICTAL EEG DATA USING SEMI-BLIND SOURCE SEPARATION METHODS

muscle activity, that can be used as a reference signal. We apply
our proposed algorithms on the signal acquired during a second seizure that was highly contaminated with muscle activity.
Six channels of the low noise and noisy ictal signals are shown
in Fig. 6(a) and (b), respectively. As shown in Fig. 6(a), the
ictal activity of channel C3 can be segmented to three parts:
1) rhythmic spikes (red box), 2) fast activity (green box), and 3)
slower irregular activity (blue box). During the second seizure
these activities, except the first rhythmic spikes, are covered
with muscular activity as shown in Fig. 6(b).
Fig. 7(a) and (b) shows the time course and time-frequency
representations of the channel C3 for the unnoisy and noisy
ictal signals. The ictal fast activity is highlighted in the
time-frequency representation of the noise free segment [see
Fig. 7(a)]. This time-frequency signature is almost invisible
in the time-frequency representation of the noisy segment
[see Fig. 7(b)]. Fig. 7(c)–(f) shows the time course and timefrequency representations of the channel C3 of the ictal signals
of the second seizure, denoised by the TF-GEVD, TF-DSS,
CCA, and CoM2 algorithms, respectively. As shown in these figures, the time-frequency signature of the ictal activity appears in
the denoised signals. The time course of the denoised signals are
cleaner than the noisy data, showing three ictal patterns similar
to what had previously been identified during the first unnoisy
seizure. Qualitatively, it is noteworthy that although all methods provide fairly good denoising, the best result is obtained
with TF-DSS, which could retrieved the fast activity with the
highest amplitude. CCA and TF-GEVD gave similar results for
the fast activity, but with TF-GEVD some of the spike rhythmic
activity has been removed by the denoising procedure. CoM2
can retrieve part of the fast activity but leaves a large amount of
muscle activity.
V. CONCLUSION
In this paper, we propose two new semi-blind algorithms,
namely TF-GEVD and TF-DSS, to denoise ictal EEG data.
These methods use the time-frequency signature of ictal sources
as a priori information to denoise ictal data. To extract the timefrequency signature of ictal sources, we use a method based on
the CCA algorithm. To evaluate and quantify the performance
of the proposed methods on denoising of ictal EEGs, we apply
them on simulated ictal data and compared their results with
those of CCA and CoM2 algorithms. The results show the superiority of the proposed algorithms in comparison with CCA
and CoM2 . We also study the utility of the proposed methods in
denoising of a real ictal data. In that case, the performance of the
denoising algorithms cannot be quantified because the ‘ground
truth’ is unknown. However, a comparison of denoised signals
with a different nonnoisy ictal signal suggests that the proposed
algorithms can be useful for denoising real ictal data.

847

[2] F. Bartolomei, P. Chauvel, and F. Wendling, “Epileptogenicity of brain
structures in human temporal lobe epilepsy: A quantified study from intracerebral EEG,” Brain, vol. 131, no. 7, pp. 1818 –1830, 2008.
[3] F. Wendling, F. Bartolomei, J.-J. Bellanger, J. Bourien, and P. Chauvel,
“Epileptic fast intracerebral EEG activity: Evidence for spatial decorrelation at seizure onset,” Brain, vol. 126, no. 6, pp. 1449–1459, 2003.
[4] G. Alarcon, C. Binnie, R. Elwes, and C. Polkey, “Power spectrum and
intracranial EEG patterns at seizure onset in partial epilepsy,” Electroencephalography Clin. Neurophysiol., vol. 94, no. 5, pp. 326–337, 1995.
[5] F. Bartolomei, D. Cosandier-Rimele, A. McGonigal, S. Aubert, J. Régis,
M. Gavaret, F. Wendling, and P. Chauvel, “From mesial temporal lobe to
temporoperisylvian seizures: A quantified study of temporal lobe seizure
networks,” Epilepsia, vol. 51, no. 10, pp. 2147–2158, 2010.
[6] N. M. Wetjen, W. R. Marsh, F. B. Meyer, G. D. Cascino, E. So, J. W.
Britton, S. M. Stead, and G. A. Worrell, “Intracranial electroencephalography seizure onset patterns and surgical outcomes in nonlesional extratemporal epilepsy,” J. Neurosurgery, vol. 110, no. 6, pp. 1147–1152,
2009.
[7] C. Stamoulis, and B. S. Chang, “Application of matched-filtering to extract
EEG features and decouple signal contributions from multiple seizure foci
in brain malformations,” in Proc. 4th Int. IEEE/EMBS Conf. Neural Eng.,
2009, pp. 514–517.
[8] W. De Clercq, A. Vergult, B. Vanrumste, W. Van Paesschen, and S. Van
Huffel, “Canonical correlation analysis applied to remove muscle artifacts from the electroencephalogram,” IEEE Trans. Biomed. Eng., vol. 53,
no. 12, pp. 2583–2587, Nov. 2006.
[9] H. Hallez, M. De Vos, B. Vanrumste, P. Van Hese, S. Assecondi, K. Van
Laere, P. Dupont, W. Van Paesschen, S. Van Huffel, and I. Lemahieu,
“Removing muscle and eye artifacts using blind source separation techniques in ictal EEG source imaging,” Clin. Neurophysiol., vol. 120, no. 7,
pp. 1262–1272, 2009.
[10] D. Safieddine, “Apport des méthodes statistiques et déterministes à la
réduction d’artefacts et de bruits dans les signaux EEG épileptiques,” Ph.D.
dissertation, Department of Signal Processing and Telecommunications.
Univ. Rennes 1, Rennes, France, 2012.
[11] C. Stamoulis, I. Sanchez Fernandez, B. S. Chang, and T. Loddenkemper,
“Signal subspace integration for improved seizure localization,” in Proc.
IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., 2012, pp.1016–1019.
[12] N. P. Subramaniyam, J. Peltola, J. M. Tanskanen, K. Wendel-Mitoraj,
J. Hyttinen, and J. Malmivuo, “Source localization based on ictal electroencephalographic recordings,” in Proc. Int. Symp. Biomed. Eng. Med.
Phys., 2013, pp. 26–30.
[13] E. Urrestarazu, J. Iriarte, M. Alegre, M. Valencia, C. Viteri, and J. Artieda,
“Independent component analysis removing artifacts in ictal recordings,”
Epilepsia, vol. 45, no. 9, pp. 1071–1078, 2004.
[14] J. Sarela and H. Valpola, “Denoising source separation,” J. Mach. Learning
Res., vol. 6, pp. 233–272, 2005.
[15] L. Albera, A. Kachenoura, P. Comon, A. Karfoul, F. Wendling, L. Senhadji,
and I. Merlet, “ICA-based EEG denoising: A comparative analysis of
fifteen methods,” Special Issue Bull. Polish Acad. Sci., vol. 60, pp. 407–
418, 2012.
[16] R. C. Gonzalez and R. E. Woods, Digital Image Processing, 2nd ed. Upper
Saddle River, NJ, USA: Prentice-Hall, 2002.
[17] D. Cosandier-Rimélé, I. Merlet, J. M. Badier, P. Chauvel, and F. Wendling,
“The neuronal sources of EEG: Modeling of simultaneous scalp and intracerebral recordings in epilepsy,” vol. 42, no. 1, pp. 135–146, Apr. 2008.
[18] F. Wendling, J. J. Bellanger, F. Bartholomei, and P. Chauvel, “Relevance of
nonlinear lumped-parameter models in the analysis of depth-EEG epileptic
signals,” Biol. Cybern., vol. 83, pp. 367–378, 2000.
[19] G. Birot, L. Albera, F. Wendling, and I. Merlet, “Localization of extended
brain sources from EEG/MEG: The ExSo-music approach,” NeuroImage,
vol. 56, no. 1, pp. 102–113, May 2011.
[20] D. Safieddine, A. Kachenoura, L. Albera, G. Birot, A. Karfoul, A.
Pasnicu, A. Biraben, F. Wendling, L. Senhadji, and I. Merlet, “Removal of muscle artifact from EEG data: comparison between stochastic
(ICA and CCA) and deterministic (EMD and wavelet-based) approaches,”
EURASIP J. Advances Signal Process., vol. 127, pp. 1–15, 2012.

REFERENCES
[1] J. Bancaud and J. Talairach, La stéréo-électroencéphalographie
dans l’épilepsie: Informations neurophysiopathologiques apportées
par l’investigation fonctionnelle stéreotaxique: rapport a la Société
d’électroencephalographie de langue française (Marseille, Octobre
1962). Paris, France: Paris, 1965.

Authors’ photographs and biographies not available at the time of publication.

