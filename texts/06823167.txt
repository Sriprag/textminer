2740

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Effect of Statistically Derived Fiber Models
on the Estimation of Cardiac Electrical Activation
Karim Lekadir∗ , Ali Pashaei, Corné Hoogendoorn, Marco Pereanez, Xènia Albà,
and Alejandro F. Frangi, Fellow, IEEE

Abstract—Myocardial fiber orientation plays a critical role in
the electrical activation and subsequent contraction of the heart.
To increase the clinical potential of electrophysiological (EP) simulation for the study of cardiac phenomena and the planning of interventions, accurate personalization of the fibers is a necessary yet
challenging task. Due to the difficulties associated with the in vivo
imaging of cardiac fiber structure, researchers have developed alternative techniques to personalize fibers. Thus far, cardiac simulation was performed mainly based on rule-based fiber models.
More recently, there has been a significant interest in data-driven
and statistically derived fiber models. In particular, our predictive
method in [1] allows us to estimate the unknown subject-specific
fiber orientation based on the more easily available shape information. The aim of this work is to estimate the effect of using such
statistical predictive models for the estimation of cardiac electrical
activation times and patterns. To this end, we perform EP simulations based on a database of ten canine ex vivo diffusion tensor
imaging (DTI) datasets that include normal and failing cases. To
assess the strength of the fiber models under varying conditions, we
consider both sinus rhythm and biventricular pacing simulations.
The results show that 1) the statistically derived fibers improve the
estimation of the local activation times by an average of 53.7% over
traditional rule-based models, and that 2) the obtained electrical
activations are consistently similar to those of the DTI-based fibers.
Index Terms—Cardiac fibers, diffusion tensor imaging (DTI),
rule-based models, simulation of electrophysiology, statistical predictive models.

I. INTRODUCTION

M

ULTISCALE computational models of the heart require
the personalization of several anatomical and biophys-

Manuscript received January 14, 2014; revised April 10, 2014 and May 8,
2014; accepted February 12, 2014. Date of publication May 29, 2014; date of
current version October 16, 2014. The work of K. Lekadir was supported by a
Juan de la Cierva research fellowship from the Spanish Ministry of Science and
Innovation. The work of A. Pashaei was partly supported by the research grant
TIN2011-28067 from the Spanish Ministry of Economy and Competitiveness.
The work of X. Albà was supported by an FPU grant from the Spanish Ministry
of Education, Culture and Sport. Asterisk indicates corresponding author.
∗ K. Lekadir is with the Center for Computational Imaging and Simulation
Technologies in Biomedicine, Universitat Pompeu Fabra, 08002 Barcelona,
Spain (e-mail: karim.lekadir@upf.edu).
A. Pashaei is with the l’Institut de Rythmologie et Modélisation
Cardiaque, Institut Hospitalo-Universitaire,Université de Bordeaux, 33076
Bordeaux France (e-mail: ali.pashaei@ihu-liryc.fr).
C. Hoogendoorn, M. Pereanez, and X. Albà are with the Center for Computational Imaging and Simulation Technologies in Biomedicine, Universitat
Pompeu Fabra, 08002 Barcelona, Spain (e-mail: corne.hoogendoorn@upf.edu;
marco.pereanez@upf; xenia.alba@upf.edu).
A. F. Frangi is with the Center for Computational Imaging and Simulation Technologies in Biomedicine, University of Sheffield, Sheffield S10 2TN,
U.K. (e-mail: a.frangi@sheffield.ac.uk).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2327025

ical parameters [2]–[4]. Amongst these, the myocardial fibers,
which represent the spatial distribution of the ventricular myocytes [5], are of critical importance for EP simulation, as
they contribute to the definition of the shape and velocity of
the electrical waves propagating throughout the myocardium.
Accurate estimation of the subject-specific fiber orientations
is therefore critical to obtain simulations that are meaningful
for the in silico planning of EP interventions [6]. In practice, however, while the personalization of cardiac shape from
medical images has received significant attention [7]–[12],
the data-driven estimation of fibers is still currently a great
challenge.
To model cardiac fibers in vivo, a natural candidate imaging technology is diffusion tensor imaging (DTI). However, the
technique is known to be sensitive to the motion of the heart and
creates distortions in diffusion measurements. Methods such as
pulse or cardiac gated imaging can be used to lower the effects
of cardiac motion [13], [14], but the high acquisition costs and
time taken make the use of cardiac DTI in vivo a challenging
task. As a result, DTI is mostly used for ex vivo studies and
researchers have investigated alternative estimation methods,
in particular rule-based and statistical methods, to personalize
fiber orientation in new subjects.
Based on existing histological studies [15], rule-based methods make a priori assumptions on the fiber distribution and
derive a set of simple and predefined ad hoc rules for fiber
estimation. In contrast, statistical models learn an optimal predictive model for the fiber orientations based on a training data
sample.
Rule-based estimation of the myocardial fibers has been the
gold standard approach in cardiac simulation ever since the pioneering work of Streeter [15] based on histological canine studies. Essentially, the technique generates fiber orientations that
rotate counterclockwise in the myocardium in pseudo-parallel
lines, while varying smoothly between the endocardium and the
epicardium [15]. The rule-based technique is available in several
open source libraries, such as in the simulation package Chaste
[16], [17], which facilitates its wide use in the cardiac modeling community [16], [18]–[27]. However, existing research
has shown that while rule-based models approximate well the
overall fiber distribution, they tend to generate idealistic fiber
orientations when compared to DTI-based fibers [28]. Furthermore, several algorithms [22], [29]–[32] and parameter settings
[15], [29], [33]–[36] can be used to derive the fibers, thus making the choice of the correct rule-based implementation for a
given dataset, simulation protocol, or cardiac phenomena, both
challenging and time consuming.

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

LEKADIR et al.: EFFECT OF STATISTICALLY DERIVED FIBER MODELS ON THE ESTIMATION OF CARDIAC ELECTRICAL ACTIVATION

More recently, with the availability of online ex vivo DTI
databases [37], some researchers have shown interest in datadriven techniques in order to derive improved fiber models
[1], [38]–[42]. In particular, statistical-based methods have the
advantage of considering the variability between individuals.
Recently, we developed in [1] a nonlinear model to learn the
optimal statistical relationship between morphology and fiber
orientation from a training sample of ex-vivo DTI datasets.
The regression model is then used to predict the unavailable
fiber orientations from the available and more easily extracted
subject-specific morphology in new subjects.
To the best of our knowledge, statistics-based fiber models
have not yet been used in EP simulation and the rule-based
estimation technique remains state of the art in the field, as
illustrated in these works [16], [18]–[27], [32].
The goal of this paper is to assess whether a statistical model
with a higher precision for the personalization of fiber orientation translates into any marked improvement in the estimation
of ventricular activation times and patterns as compared to traditional rule-based models. To this end, we perform a simulation
study based on a database of ex vivo DTI images, which include
both normal and failing hearts. We evaluate the effect of the
statistical fiber models in terms of the estimation of the local activation times (LATs) and the electrical propagation patterns for
both sinus rhythm and biventricular pacing simulations. A preliminary version of this work has been reported in [43], which
is extended to both the LV and RV, with additional and more
detailed experimental results.

II. METHODS
A. DTI-Based Fibers
In order to train and evaluate the statistical predictive model
for fiber estimation, we use a set of DTI image data, which also
serve as the reference subject-specific fibers in the study. We
choose DTI as the modality in this work, as existing research
has demonstrated good agreement between the real fibers and
those measured by DTI. For example, Hsu et al. [44] measured a
mean angular error of 2.3°, which is minimal for fiber modeling.
However, in this paper, we only use ex vivo cases as in vivo highresolution 3-D DTI is still unfeasible in practice.
The sample consists of ten canine subjects from the online
database of John Hopkins University (JHU) [37], which has
been extensively used for the validation of electrophysiological modeling techniques. The sample includes seven normal
cases and three failing hearts. The images were acquired in a
1.5-T GE CV/i MRI scanner using an enhanced gradient system with 40-mT/m maximum gradient amplitude and a 150T/m/s slew rate. The volumes have been acquired with different number of gradient directions (between 17 and 27). From
the diffusion weighted images available in the dataset, the DTI
volumes have been computed by means of a weighted least
square estimation algorithm. Finally, the fiber orientation at
each voxel is calculated as the first eigenvector of the diffusion
tensor.

2741

B. Statistical Fiber Model
Various learning-based methods can be used to statistically
approximate the subject-specific fiber models, such as using
joint shape-fiber statistics [42], an average fiber atlas [38], or
our recent predictive model [1]. Thus far, however, the benefits
of statistics-based models have not been evaluated for cardiac
simulation and the aim of this study is to assess the potential gain
in performance for the estimation of electrical activation. Due
to its ability to take into account the inter-subject variability, as
well as due to its nonlinear formulation, our recently developed
statistical model [1] improves the fiber prediction over the average atlas technique in [38]. For the canine DTI dataset of JHU
used in this paper, we obtained a mean improvement of 11.4%.
The method is based on the principle that form follows function [45]. Initially formulated in architecture and arts, the principle was later on extended to biology and medicine [46]–[49].
In our case, we want to statistically formalize the link between
myocardial morphology (heart structure) and fiber orientation
(force development function). By modeling this relationship, the
fundamental goal is to infer the unavailable fiber information
from the more easily extracted subject-specific cardiac shape.
To achieve this, we require a training population to build the
statistical predictive model and we use cardiac shapes and fibers
extracted from the ex vivo DTI data from Section II-A.
The model construction follows the schematic diagram in
Fig. 1. In particular, two key technical issues are addressed in
the framework. Firstly, to allow for consistent manipulation of
the fiber orientation vectors, which are non-directional (i.e., opposite vectors y and −y must correspond to the same fiber orientation), invariant tensor descriptors are calculated as follows
(Step 4 in Fig. 1):
⎛

y12

⎜
yyT = ⎝ y1 y2
y1 y3

y1 y2
y22
y2 y3

y1 y3

⎞

⎟
y2 y3 ⎠ .

(1)

y32

Next, based on the recent developments in Log-Euclidean
representation [50], through which one can map symmetric tensors onto an Euclidean space, the matrix logarithm of yyT is
calculated, thus obtaining a 3 × 3 matrix L(y) = log(yyT ).
Subsequently, for the description of the fibers in the regression
model, we use the following 6-D vector:
√
√
√
z(y) = (L11 , L22 , L33 , 2L12 , 2L13 , 2L23 )T
(2)
where the Lk l coefficients are the matrix logarithm components.
Once the input shapes X and output fiber matrices Z are
obtained, the next stage (Step 6 in Fig. 1) involves the estimation
of an optimal regression model, which is achieved using kernel
partial least squares regression (PLSR) [51], [52]. Given a new
cardiac shape xnew and a kernel Gramm function K used to
unfold the underlying nonlinear relationships in the data, the
fiber prediction ẑnew is calculated using the following regression
equation:
ẑnew = K(xnew )A

(3)

2742

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Fig. 2. Schematic diagram of the procedure used in this study for automatic
extraction of the cardiac geometry.

C. Personalization of Geometry

Fig. 1. Schematic diagram summarizing the main steps involved in the construction of the statistical fiber model. The red arrows indicate the obtained
input (shape) and output (fiber) data that are subsequently used in the regression
model.

where A is the optimal regression matrix calculated from the
training matrices X and Z as
A = U(TT K(X)U)−1 TT Z

(4)

where T and U are the PLSR latent matrices (see [52] for more
details). The advantage of this regression approach is that it
explicitly estimates the model parameters that best fit the training data, which leads to statistically optimal predictions. No
a priori assumptions are made about the type of relationship or
model between the cardiac shape and fiber orientations. Moreover, being essentially an eigendecomposition method, PLSR
can identify and smooth out the noisy fibers in the form of output information that is uncorrelated with the input data. More
specifically, the noise is accumulated in the latent variables of
low frequency, which are not used for the predictions due to
their limited predictive power.
Finally, it is important to note that we use as many regression
equations as there are fibers in the volumetric mesh, which
means the statistical model is also optimized for each node,
unlike the rule-based fibers which are generated with a unique
model for all nodes.
More details on the properties and implementation of the
statistical predictive model can be found in [1].

In order to construct the fiber models as well as for the modeling of electrophysiology, the geometrical meshes for all subjects
need to be extracted in this study. To achieve this, we use an automatic procedure based on image registration (see the schematic
diagram in Fig. 2). The idea is to manually segment a single reference image volume, and the obtained mesh is then propagated
to other subjects based on the transformations computed from
nonrigid registration of the image volumes [53]. In this work,
the transformation model used in the registration between the
subject images and the reference image is a composition of an
affine transformation followed by two B-spline-based transformations with control point spacing of 32 mm. The B-spline
grids are centered on the image, and their deformations are constrained as in [53] in order to produce invertible deformations.
To avoid bias from the tensor information, it is important to
note that the registration of the DTI data is performed directly
on image masks derived from the B0 images (these images indicate the presence of signal in diffusion tensor images due to
the fibers and therefore facilitate the automatic localization of
the myocardium, see Fig. 2).
It is important to note that in this study, the papillary muscles
are excluded from the walls for all the fiber models.
D. EP Simulations
An important goal of the fiber personalization is ultimately
to simulate with the highest accuracy the electrical activation,
both in terms of propagation times and patterns. Furthermore,
the computational complexity of the simulations must be kept
within certain limits to be able to perform large scale repetitive
tests representing virtual experiments or virtual populations.
This is the case, for example, for the selection of optimal implantation sites of pacing leads or placement of ablation tips in
the context of cardiac rhythm management therapies [6].
To this end, one of the most simple and popular approaches
for EP simulation is the Eikonal equation, which has been
used and validated extensively for the description of wave front

LEKADIR et al.: EFFECT OF STATISTICALLY DERIVED FIBER MODELS ON THE ESTIMATION OF CARDIAC ELECTRICAL ACTIVATION

propagation [21], [54]–[56]. Existing research has shown that a
limited loss of accuracy can be obtained with such models [18],
while obtaining computationally efficient solutions.
In this paper, we model myocardial electrophysiology using
the anisotropic formulation by Pashaei et al. [56]. More specifically, the EP wave propagation is modeled only through element
edges in the myocardium based on a one-manifold implementation of the fast marching method. Information exchange across
the domains is achieved through their nodal connectivity, thus
keeping the solution on a one-manifold. With this formulation,
the electrical waves pass through the connecting edges across
nodes, similar to what happens at the cellular level for intercellular ionic exchange.
In order to evaluate the performance of the fiber models under different electrophysiological conditions, we consider two
simulation protocols in this study: 1) the sinus rhythm that describes the normal beating of the heart (see Section III-A);
and 2) biventricular pacing that is used in EP interventions
(Section III-B).
Sinus rhythm is simulated in this study by replicating activation originating from the Purkinje terminals. More specifically,
multiple terminal nodes are activated on the endocardium such
that appropriate timings of the stimuli are reached, i.e. they
match the reported 3-D electrical measurements and propagation maps of the normal heart as reported in the experimental
data from two popularly cited papers by Durrer et al. [57] and
Spach and Barr [58]. This is achieved by using a total of 30
initial activation points on the endocardium of the left and right
ventricles.
Furthermore, to demonstrate the clinical potential of the proposed approach, we also run simulation experiments for biventricular pacing, an EP intervention that is used in cardiac resynchronization therapy (CRT) [6], [59]. In this EP intervention,
simultaneous pacing of the left and right ventricles is performed
in order to resynchronize hearts that have regions with delayed
myocardial activation and contraction, a phenomena that is common in patients with heart failure [59]. For EP simulation of
CRT, pacing is carried out by stimulating two initial activations
respectively on the free walls of the left and right ventricles near
the apex points [56].
In all simulations, the following EP parameters were used: the
conduction velocity for the working myocardial velocity along
the fiber orientations was set to 0.75 m/s, and the transversal
conduction velocity to 0.3 m/s, as reported in the literature on
canine datasets [33].

E. Comparison to Rule-Based Models
For comparison to rule-based fibers, we consider in this paper
the minimal distance implementation in Chaste [16], [22], [60],
which is widely used in cardiac modeling. With this approach,
the fiber orientation at each node position x in the myocardium
is interpolated based on its distances to the endocardium and
epicardium dendo and depi . To this end, it is important to define
the boundary conditions, i.e., the angular values αendo and αepi
at the endocardial and epicardial walls, respectively.

2743

Various angular values have been reported in the literature
for αendo and αepi for canine datasets [15], [32], [33], mostly
ranging from 40° and 70° in absolute values. In this paper,
in order to obtain the best EP simulations with the rule-based
fibers, αendo and αepi are optimized by evaluating several pairs
of angular values for both the sinus rhythm and biventricular
pacing simulations. We obtained the lowest errors compared
to DTI with αendo = +40 and αepi = −50. This is consistent
with the recent simulation results by Bayer et al. [32] with the
same canine datasets, as well as with the original DTI studies by
Helm et al. [34]. Note that the same optimal angular values were
obtained for both the normal and failing hearts, which concurs
with the conclusions of Helm et al. [61] ], who showed that there
are no significant differences in the fiber structure between the
normal and failing hearts used in this study.
In order to be able to perform the fiber interpolation at each
node position x, the minimal distances to the ventricular walls
are first calculated, i.e., dLV to the LV endocardium, dLV to the
RV endocardium, and depi to the epicardium of the ventricles.
We then obtain dendo = dLV for the LV and dendo = dRV for the
RV, while depi is the minimal distance to the epicardial walls.
An ambiguity can occur at the septum, which is resolved by
using dendo = min(dLV , dRV ) [60]. Averaging of the distances
is performed for each node based on its neighbors in the volumetric mesh, which is beneficial to deal with the regions of
the ventricles where the free walls and the septum meet. More
details on the construction and implementation of the minimal
distance rule-based fiber models can be found in [60].
III. EXPERIMENTAL RESULTS
We report in this section the simulation results for the ten
cases based on the rule-based and statistical models, which we
compare against the DTI-based fibers. The accuracy of all methods is evaluated by calculating the relative absolute errors of the
LATs. Note that for the statistical fiber models, leave-one-out
tests are carried out (the simulated case is removed from the
training of the statistical model).
A. Sinus Rhythm Simulations
For all sinus rhythm simulations, the absolute relative errors
in the estimation of the LATs are plotted in Fig. 3 for each of
the ten datasets (mean error plus one standard deviation). The
letter N in the figure denotes the normal cases, while the letter F
indicates the failing hearts. Furthermore, Table I summarizes the
error statistics for the normal and failing hearts separately, and
displays the improvement achieved by using the statistical model
over the rule-based technique. It can be seen from the results that
the statistical fiber orientations produce improved estimations
of the LATs consistently for all datasets, with a mean absolute
error of only 1.72% with respect to the DTI-based fibers. As
shown in Table I, this accounts for a significant improvement
of 49.6% over the LATs calculated using the rule-based fibers.
Furthermore, the large standard deviations in Fig. 3 for the rulebased approach indicate that its performance is inconsistent
between regions of the ventricles.

2744

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

TABLE I
ABSOLUTE RELATIVE ERRORS OF THE RULE-BASED AND STATISTICAL MODELS
FOR THE ESTIMATION OF LATS FOR THE SINUS RHYTHM SIMULATIONS (IN %)
Rule-based fibers

Normal
Failing
Total

Statistical fibers

Improvement (in %)

Mean

Std

Min

Max

Mean

Std

Min

Max

Mean

Std

Min

Max

3.38
3.43
3.40

0.25
0.20
0.23

3.02
3.23
3.02

3.80
3.64
3.80

1.66
1.83
1.72

0.15
0.23
0.18

1.41
1.56
1.41

1.89
2.01
2.01

−50.8
−46.7
−49.6

3.9
4.3
4.2

−46.1
−43.2
−43.2

−55.7
−516
−55.7

Fig. 3. Relative absolute LAT errors (in %) of the rule-based and statistical
fiber models (mean errors and one standard deviation) for the sinus rhythm
simulations.

To illustrate the local distribution of the estimation errors
in the ventricles, horizontal and vertical cross-sections through
the 3-D error maps of one normal case and one failing heart
are displayed in Fig. 4. It can be seen that the statistical fiber
models estimate the activation times with a consistent accuracy
throughout the myocardium (blue shading). The rule-based fiber
orientations, on the other hand, produce localized errors in various areas of the ventricles.
Fig. 5 shows two illustrations (one normal case and one failing heart) of the electrical propagation patterns as obtained with
the DTI-, rule-, and statistics-based fibers. No major differences
in the propagation patterns are observed between the results
derived with the three fiber models for the sinus rhythm simulations. They all agree on the overall isochrones of propagations,
with the exception of some small localized differences by the
rule-based technique.
B. Biventricular Pacing
To demonstrate the clinical potential and the versatility of
the proposed approach, in this section, we report the simulation results for biventricular pacing that is used in CRT. The
individual results plotted in Fig. 6 and summarized in Table II
show that the statistical approach maintains a good performance
for the estimation of the LATs. The improvement with respect
to the rule-based fiber orientations is better for the biventricu-

Fig. 4. Two examples of local error maps for the sinus rhythm simulation
showing the distribution of the absolute LAT errors (in ms), for (a) one normal
case and (b) one failing heart.

lar pacing than for the sinus rhythm simulations (up to 63.5%
improvement, see Table II). This can be explained by the fact
that the biventricular pacing has only two points of initial activation, which makes the entire process more sensitive to errors

LEKADIR et al.: EFFECT OF STATISTICALLY DERIVED FIBER MODELS ON THE ESTIMATION OF CARDIAC ELECTRICAL ACTIVATION

2745

TABLE II
ABSOLUTE RELATIVE ERRORS OF THE RULE-BASED AND STATISTICAL MODELS
FOR THE ESTIMATION OF LATS FOR THE BIVENTRICULAR PACING SIMULATIONS (IN %)

Mean
Normal
Failing
Total

5.11
5.36
5.20

Rule-based fibers
Std
Min
0.57
0.56
0.55

4.28
4.78
4.28

Max

Mean

6.10
5.92
6.10

2.12
2.32
2.18

Statistical fibers
Std
Min
0.38
0.22
0.34

1.72
2.10
1.41

Max

Mean

2.63
2.56
2.63

−58.5
−56.6
−57.9

Improvement (in %)
Std
Min
Max
4.9
4.4
4.6

−50.4
−52.4
−50.4

−63.5
−61.2
−63.5

Fig. 7. Degree of agreement in the LATs (ms) for the rule-based (left) and the
statistical (right) models versus DTI-based fibers at all myocardial locations.
Fig. 5. Two examples of electrical propagation for the sinus rhythm simulation
as obtained using the three fiber models, for (a) one normal case and (b) one
failing heart.

Fig. 6. Relative absolute LAT errors (in %) of the rule-based and statistical
fiber models (mean errors and one standard deviation) for the biventricular
pacing simulations.

in the distribution of the fibers throughout the ventricles. As a
result, the mean absolute relative LAT error of the rule-based
approach increases to 5.20% on average and up-to 6.10% relative errors. In contrast, the statistically derived fibers maintain
a relatively small error of 2.18% (versus 1.72% for the sinus
rhythm simulations), due the similarity between the predicted
fibers and those derived from the DTI images.
Fig. 7 illustrates the extent of agreement in the estimation of
LATs at all myocardial locations for both the rule-based (left)
and statistical models (right). It can be seen from the figure that
the simulated activation times (ordinates) using the statistical
model correlate well with the DTI-based values (abscissae). In
contrast, the LATs derived with the rule-based models display
larger differences as compared to the DTI-based fibers (large
variation perpendicular to the correlation line). Furthermore, it
can be seen that the distribution of the errors with respect to DTI,
changes between subjects for the rule-based models. These inconsistencies can affect the analysis of simulation results across
datasets and studies.
Fig. 8 displays the propagation patterns for biventricular pacing for the same normal and failing hearts of Fig. 5. While

2746

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

nomena. As a result, the same level of performance can be
maintained when using different simulation protocols (e.g., sinus activation versus biventricular pacing).
Time complexity is another fundamental issue in cardiac
modeling, in particular for personalized planning of EP interventions, which can require the testing of various strategies (for
example, by considering different biventricular pacing locations
for CRT [6]). Fortunately, as described in the schematic diagram
of Fig. 1, the statistical model is built only once and then saved
for future use in fiber predictions (Step 7 of the framework). In
other words, the computationally demanding part (which takes
hours) is performed only at the training stage and there is no
need to rebuild the predictive model for each new simulation. For
new fiber predictions, only a kernel transformation followed by
a matrix multiplication is performed (see (3)). Unlike the rulebased method, which requires the calculation of the distances
to the walls for each new case, there is no need for any computational demanding tasks during the statistical predictions.
Consequently, the fiber predictions themselves are performed
on average within a minute.
B. Limitations
Fig. 8. Two examples of electrical propagation for the biventricular pacing
simulation as obtained using the three fiber models, for (a) one normal case and
(b) one failing heart.

for the sinus rhythm, all fiber models produce similar electrical
propagation, the patterns of rule-based fiber orientations (top
row of Fig. 8) differ significantly from those obtained with the
DTI-based fibers (middle row) in this case. In contrast, the statistical method produces patterns (bottom row) that are nearly
identical to those obtained with DTI. This result applies to both
the normal case on the left and to the failing heart on the right of
Fig. 8. This demonstrates that the proposed approach maintains
a consistent performance under different EP conditions or simulation protocols, due to its ability to produce fiber orientations
that are similar to those obtained with DTI and less idealistic
than rule-based fibers [28].
IV. DISCUSSION AND CONCLUSION
A. Advantages of Statistical Fiber Models
In addition to its accuracy and consistency as demonstrated
in this study, the proposed technique addresses one fundamental
limitation of rule-based fibers, namely that there are several different rule-based implementations [22], [29]–[32], which means
the user needs to explore and choose the correct one for each
new experiment. Furthermore, several angular parameter settings such as for αen do and αepi have been proposed for the
rule-based models in the literature (e.g., for canine datasets:
+70, –50 in [33], +60, –45 in [35], +40, –50 in [32]). In
contrast, a unique data-driven fiber model is obtained with the
proposed statistical approach based on the subject-specific geometry, which enables us to quickly run simulations matching
a specific DTI atlas for any simulation protocol or cardiac phe-

There are two limitations for the proposed statistical approach
that are important to mention in this discussion. Firstly, it is
not possible to adapt a statistical model of fiber orientation to
any other specie without re-training. In contrast, the rule-based
models can be easily derived for different species and/or groups
simply by changing the boundary conditions (the angles of the
fibers at the endo- and epicardial walls). The proposed statistical
model requires the collection of new representative sample of
DTI data, which are not always available. It can be argued
that, in future, an increasing number of DTI datasets will be
available with increasing interest in the topic, from which new
specie-specific statistical models of fiber orientation can be built
following the proposed framework.
Second, the statistical models of fiber orientation are, by definition, dependent on the resolution of the input DTI data. This
is a general limitation of statistical approaches, which can only
model the information that is given to them as an input. However, in the case of fibers, several developments in DTI modeling
can be combined with the proposed framework to artificially
increase the resolution of the fiber meshes through tensor interpolation, such as by using the well-known Log-Euclidean
framework by Arsigny et al. [62].
C. Future Perspective
In this paper, we demonstrated how a statistical model of
fiber orientation can improve the estimation of cardiac electrical
times and propagation. For the simulation of cardiac mechanics, a statistical model of the laminar sheet in addition to the
fiber orientation can be of high importance. Fortunately, laminar sheet similarly to fiber orientation is described in DTI with
a 3-D vector, i.e., the third eigenvector of the diffusion tensor,
and therefore it can also be used as the output of the nonlinear
regression model. However, some adaptations in the statistical

LEKADIR et al.: EFFECT OF STATISTICALLY DERIVED FIBER MODELS ON THE ESTIMATION OF CARDIAC ELECTRICAL ACTIVATION

formulation might be necessary to deal with the higher variability of the laminar structure.
Furthermore, we hope that the approach presented in this
study will promote more generally the broader use of statistical personalization in cardiac modeling, with the goal to obtain
improved estimation results and to enhance the clinical applicability of cardiac simulation.
REFERENCES
[1] K. Lekadir, C. Hoogendoorn, M. Pereanez, X. Alba, A. Pashaei, and A. F.
Frangi, “Statistical personalization of ventricular fiber orientation using
shape predictors,” IEEE Trans. Med. Imag., vol. 33, no. 4, pp. 882–890,
Apr. 2014.
[2] J. Bassingthwaighte, P. Hunter, and D. Noble, “The cardiac physiome:
Perspectives for the future,” Exp. Physiol., vol. 94, no. 5, pp. 597–605,
2009.
[3] N. A. Trayanova, T. O’Hara, J. D. Bayer, P. M. Boyle, K. S. McDowell,
J. Constantino, H. J. Arevalo, Y. Hu, and F. Vadakkumpadan, “Computational cardiology: How computer simulations could be used to develop
new therapies and advance existing ones,” Europace, vol. 14, no. suppl.
5, pp. v82–v89, 2012.
[4] M. Sermesant, R. Chabiniok, P. Chinchapatnam, T. Mansi, F. Billet,
P. Moireau, J.-M. Peyrat, K. Wong, J. Relan, and K. Rhode, “Patientspecific electromechanical models of the heart for the prediction of pacing
acute effects in CRT: A preliminary clinical validation,” Med. Image Anal.,
vol. 16, no. 1, pp. 201–215, 2012.
[5] R. H. Anderson, S. Y. Ho, K. Redmann, D. Sanchez-Quintana, and P.
P. Lunkenheimer, “The anatomical arrangement of the myocardial cells
making up the ventricular mass,” Eur. J. Cardio-Thoracic Surg., vol. 28,
no. 4, pp. 517–525, 2005.
[6] C. Tobon-Gomez, N. Duchateau, R. Sebastian, S. Marchesseau, O. Camara, E. Donal, M. De Craene, A. Pashaei, J. Relan, and M. Steghofer,
“Understanding the mechanisms amenable to CRT response: From preoperative multimodal image data to patient-specific computational models,” Med. Biol. Eng. Comput., vol. 51, pp. 1235–1250, 2013.
[7] K. Lekadir, R. Merrifield, and G.-Z. Yang, “Outlier detection and handling
for robust 3D active shape models search,” IEEE Trans. Med. Imag.,
vol. 26, no. 2, pp. 212–222, Feb. 2007.
[8] C. Butakoff, F. Sukno, A. Doltra, E. Silva, M. Sitges, and A. F. Frangi,
“Order statistic based cardiac boundary detection in 3d+ t echocardiograms,” in Functional Imaging and Modeling of the Heart. New York,
NY, USA: Springer, 2011, pp. 359–366.
[9] K. Lekadir, N. Keenan, D. Pennell, and G.-Z. Yang, “An inter-landmark
approach to 4-D shape extraction and interpretation: Application to myocardial motion assessment in MRI,” IEEE Trans. Med. Imag., vol. 30,
no. 1, pp. 52–68, Jan. 2011.
[10] C. Petitjean and J.-N. Dacher, “A review of segmentation methods in short
axis cardiac MR images,” Med. Image Anal., vol. 15, no. 2, pp. 169–184,
2011.
[11] Y. Zheng, A. Barbu, B. Georgescu, M. Scheuering, and D. Comaniciu, “Four-chamber heart modeling and automatic segmentation for 3D cardiac CT volumes using marginal space learning and steerable
features,” IEEE Trans. Med. Imag., vol. 27, no. 11, pp. 1668–1681,
Nov. 2008.
[12] O. Ecabert, J. Peters, M. J. Walker, T. Ivanc, C. Lorenz, J. von Berg,
J. Lessick, M. Vembar, and J. Weese, “Segmentation of the heart and great
vessels in CT images using a model-based adaptation framework,” Med.
Image Anal., vol. 15, no. 6, pp. 863–876, 2011.
[13] U. Gamper, P. Boesiger, and S. Kozerke, “Diffusion imaging of the in
vivo heart using spin echoes–considerations on bulk motion sensitivity,”
Magn. Resonance Med., vol. 57, no. 2, pp. 331–337, 2007.
[14] S. Nielles-Vallespin, C. Mekkaoui, P. Gatehouse, T. G. Reese, J. Keegan,
P. F. Ferreira, S. Collins, P. Speier, T. Feiweier, and R. de Silva, “In vivo
diffusion tensor MRI of the human heart: Reproducibility of breath-hold
and navigator-based approaches,” Magn. Resonance Med., vol. 70, no. 2,
pp. 454–465, 2012.
[15] D. D. Streeter, H. M. Spotnitz, D. P. Patel, J. Ross, and E. H. Sonnenblick,
“Fiber orientation in the canine left ventricle during diastole and systole,”
Circulation Res., vol. 24, no. 3, pp. 339–347, 1969.
[16] J. Pitt-Francis, P. Pathmanathan, M. O. Bernabeu, R. Bordas, J. Cooper,
A. G. Fletcher, G. R. Mirams, P. Murray, J. M. Osborne, and A. Walter,
“Chaste: A test-driven approach to software development for biological

[17]

[18]

[19]

[20]

[21]

[22]

[23]

[24]

[25]

[26]

[27]

[28]
[29]

[30]
[31]
[32]
[33]

[34]

2747

modelling,” Comput. Phys. Commun., vol. 180, no. 12, pp. 2452–2471,
2009.
G. R. Mirams, C. J. Arthurs, M. O. Bernabeu, R. Bordas, J. Cooper,
A. Corrias, Y. Davit, S.-J. Dunn, A. G. Fletcher, and D. G. Harvey, “Chaste:
An open source C++ library for computational physiology and biology,”
PLoS Computat. Biol., vol. 9, no. 3, p. e1002970, 2013.
M. Wallman, N. P. Smith, and B. Rodriguez, “A comparative study of
graph-based, Eikonal, and monodomain simulations for the estimation
of cardiac activation times,” IEEE Trans. Biomed. Eng., vol. 59, no. 6,
pp. 1739–1748, 2012.
R. Sebastian, V. Zimmerman, D. Romero, D. Sanchez-Quintana, and
A. Frangi, “Characterization and modeling of the peripheral cardiac conduction system,” IEEE Trans. Med. Imag., vol. 32, no. 1, pp. 45–55,
2013.
J. Weese, A. Groth, H. Nickisch, H. Barschdorf, F. Weber, J. Velut, M.
Castro, C. Toumoulin, J.-L. Coatrieux, M. De Craene, G. Piella, C. TobónGomez, A. F. Frangi, D. Barber, I. Valverde, Y. Shi, C. Staicu, A. Brown, P.
Beerbaum, and D. Hose, “Generating anatomical models of the heart and
the aorta from medical images for personalized physiological simulations,”
Med. Biol. Eng. Comput., vol. 51, pp. 1–11, 2013.
M. Sermesant, E. Konukoglu, H. Delingette, Y. Coudière, P. Chinchapatnam, K. S. Rhode, R. Razavi, and N. Ayache, “An anisotropic multi-front
fast marching method for real-time simulation of cardiac electrophysiology,” in Functional Imaging and Modeling of the Heart. New York, NY,
USA: Springer, 2007, pp. 160–169.
M. Potse, B. Dubé, J. Richer, A. Vinet, and R. M. Gulrajani, “A comparison of monodomain and bidomain reaction-diffusion models for action
potential propagation in the human heart,” IEEE Trans. Biomed. Eng.,
vol. 53, no. 12, pp. 2425–2435, Dec. 2006.
M. J. Bishop, G. Plank, R. A. Burton, J. E. Schneider, D. J. Gavaghan,
V. Grau, and P. Kohl, “Development of an anatomically detailed MRIderived rabbit ventricular model and assessment of its impact on simulations of electrophysiological function,” Amer. J. Phys.-Heart Circulatory
Physiol., vol. 298, no. 2, pp. H699–H718, 2010.
R. Sebastian, E. Heidenreich, L. Dux-Santoy, J. F. Rodriguez,
J. M. Ferrero, and J. Saiz, “Modeling drug effects on personalized 3D
models of the heart: A simulation study,” in Statistical Atlases and Computational Models of the Heart. New York, NY, USA: Springer, 2010,
pp. 222–231.
D. Gil, A. Borràs, R. Aris, M. Vázquez, P. Lafortune, G. Houzeaux,
J. Aguado, M. Ballester, C. H. Li, and F. Carreras, “What a difference
in biomechanics cardiac fiber makes,” in Statistical Atlases and Computational Models of the Heart. Imaging and Modelling Challenges. New
York, NY, USA: Springer, 2013, pp. 253–260.
S. Marchesseau, H. Delingette, M. Sermesant, R. Cabrera-Lozoya, C.
Tobon-Gomez, P. Moireau, R. M. Figueras i Ventura, K. Lekadir, A. Hernandez, and M. Garreau, “Personalization of a cardiac electromechanical
model using reduced order unscented Kalman filtering from regional volumes,” Med. Image Anal., vol. 17, no. 7, pp. 816–829, 2013.
D. Romero, R. Sebastian, B. H. Bijnens, V. Zimmerman, P. M. Boyle,
E. J. Vigmond, and A. F. Frangi, “Effects of the Purkinje system and
cardiac geometry on biventricular pacing: A model study,” Ann. Biomed.
Eng., vol. 38, no. 4, pp. 1388–1398, 2010.
J. D. Bayer, “Modeling fiber orientation in unstructured meshes of cardiac
tissue using image- and rule-based approaches,” presented at the CARP
Workshop, Banff, AB, Canada, 2008.
R. Sebastian, V. Zimmerman, F. Sukno, B. Bijnens, and A. Frangi,
“Cardiac modelling for pathophysiology research and clinical applications. The need for an automated pipeline,” in Proc. World Congr. Med.
Phys. Biomed. Eng., 2010, pp. 2207–2210.
P. Bovendeerd, J. Rijcken, D. Van Campen, A. Schoofs, K. Nicolay, and
T. Arts, “Optimization of left ventricular muscle fiber orientation,” in Proc.
IUTAM Symp. Synthesis Bio Solid Mech., 2002, pp. 285–296.
J. Wong and E. Kuhl, “Generating fibre orientation maps in human heart
models using Poisson interpolation,” Comput. Methods Biomechanics
Biomed. Eng., vol. 17, pp. 1217–1226, 2012.
J. Bayer, R. Blake, G. Plank, and N. Trayanova, “A novel rule-based
algorithm for assigning myocardial fiber orientation to computational heart
models,” Ann. Biomed. Eng., vol. 40, no. 10, pp. 2243–2254, 2012.
R. C. Kerckhoffs, O. P. Faris, P. H. Bovendeerd, F. W. Prinzen, K. Smits,
E. R. McVeigh, and T. Arts, “Timing of depolarization and contraction
in the paced canine left ventricle,” J. Cardiovascular Electrophysiol.,
vol. 14, no. s10, pp. S188–S195, 2003.
P. A. Helm, M. F. Beg, M. I. Miller, and R. L. Winslow, “Measuring
and mapping cardiac fiber and laminar architecture using diffusion tensor

2748

[35]
[36]

[37]
[38]

[39]
[40]

[41]

[42]
[43]

[44]

[45]
[46]
[47]
[48]
[49]

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

MR imaging,” Ann. New York Acad. Sci., vol. 1047, no. 1, pp. 296–307,
2005.
J. Peyrat, “Comparison of cardiac anatomy and function: Statistics on
fibre architecture from DT-MRI and registration of 4D CT Images,” Ph.D.
dissertation, Nice Sophia Antipolis Univ., Nice, France, 2009
E. Munoz-Moreno, R. Cárdenes, and A. F. Frangi, “Analysis of the helix
and transverse angles of the muscle fibers in the myocardium based on
diffusion tensor imaging,” in Proc. Annu. Int. Conf. IEEE Eng. Med. Biol.
Soc. , 2010, pp. 5720–5723.
P. A. Helm, R. L. Winslow, and E. McVeigh. Available:
http://gforge.icm.jhu.edu/gf/project/dtmri_data_sets/
J.-M. Peyrat, M. Sermesant, X. Pennec, H. Delingette, C. Xu, E. R.
McVeigh, and N. Ayache, “A computational framework for the statistical analysis of cardiac diffusion tensors: Application to a small database
of canine hearts,” IEEE Trans. Med. Imag., vol. 26, no. 11, pp. 1500–1514,
Nov. 2007.
D. Gil, J. Garcia-Barnes, A. Hernandez-Sabate, and E. Marti, “Manifold
parametrization of the left ventricle for a statistical modelling of its complete anatomy,” Proc. SPIE, 2010.
H. Lombaert, J.-M. Peyrat, P. Croisille, S. Rapacchi, L. Fanton, F. Cheriet,
P. Clarysse, I. Magnin, H. Delingette, and N. Ayache, “Human atlas of the
cardiac fiber architecture: Study on a healthy population,” IEEE Trans.
Med. Imag., vol. 31, no. 7, pp. 1436–1447, Jul. 2012.
F. Vadakkumpadan, H. Arevalo, C. Ceritoglu, M. Miller, and
N. A. Trayanova, “Image-based estimation of ventricular fiber orientations for personalized modeling of cardiac electrophysiology,” IEEE
Trans. Med. Imag., vol. 31, no. 5, pp. 1051–1060, May 2012.
H. Lombaert and J.-M. Peyrat, “Joint statistics on cardiac shape and fiber
architecture,” in Proc. Med. Image Comput. Comput.-Assist. Intervention,
vol. 8150, 2013, pp. 492–500.
K. Lekadir, A. Pashaei, C. Hoogendoorn, M. Pereanez, X. Alba, and
A. F. Frangi, “Personalized modeling of cardiac electrophysiology using
shape-based prediction of fiber orientation,” in Statistical Atlases and
Computational Models of the Heart. New York, NY, USA: Springer, 2013.
E. Hsu, A. Muzikant, S. Matulevicius, R. Penland, and C. Henriquez,
“Magnetic resonance myocardial fiber-orientation mapping with direct histological correlation,” Amer. J. Phys.-Heart Circulatory Physiol.,
vol. 274, no. 5, pp. H1627–H1634, 1998.
L. H. Sullivan, “The tall office building artistically considered,” Lippincott’s Mag., vol. 57, no. 3, p. 406, 1896.
J. Opper, Science and the Arts: A Study in Relationships From 1600–1900.
Hackensack, NJ, USA: Fairleigh Dickinson, 1973.
D. D. Chiras, “Principles of structure and function,” in Human Biology.
Burlington, MA, USA: Jones & Bartlett, 2011.
B. K. Hall, Evolutionary Developmental Biology. New York, NY, USA:
Springer, 1999.
J. E. Pizzorno and M. T. Murray, Textbook of Natural Medicine. New
York, NY, USA: Elsevier Health Sciences, 2012.

[50] X. Pennec, P. Fillard, and N. Ayache, “A Riemannian framework for tensor
computing,” Int. J. Comput. Vis., vol. 66, no. 1, pp. 41–66, 2006.
[51] H. Abdi, Partial Least Squares Regression (PLS-Regression). Thousand
Oaks, CA, USA: Sage, 2003, pp. 792–795.
[52] R. Rosipal and L. J. Trejo, “Kernel partial least squares regression
in reproducing kernel Hilbert space,” J. Mach. Learning Res., vol. 2,
pp. 97–123, 2002.
[53] D. Rueckert, P. Aljabar, R. A. Heckemann, J. V. Hajnal, and A. Hammers, “Diffeomorphic registration using B-splines,” in Proc. Med. Image
Comput. Comput.-Assist. Intervention, 2006, pp. 702–709.
[54] A. J. Pullan, K. A. Tomlinson, and P. J. Hunter, “A finite element method
for an Eikonal equation model of myocardial excitation wavefront propagation,” SIAM J. Appl. Math., vol. 63, no. 1, pp. 324–350, 2002.
[55] E. Konukoglu, J. Relan, U. Cilingir, B. H. Menze, P. Chinchapatnam,
A. Jadidi, H. Cochet, M. Hocini, H. Delingette, and P. Jaı̈s, “Efficient
probabilistic model personalization integrating uncertainty on data and
parameters: Application to Eikonal-diffusion models in cardiac electrophysiology,” Progr. Biophys. Molecular Biol., vol. 107, no. 1, pp. 134–146,
2011.
[56] A. Pashaei, D. Romero, R. Sebastian, O. Camara, and A. F. Frangi,
“Fast multiscale modelling of cardiac electrophysiology including Purkinje system,” IEEE Trans. Biomed. Eng., vol. 58, no. 10, pp. 2956–2960,
Oct. 2011.
[57] D. Durrer, R. Van Dam, and E. Freud, “Total excitation of the isolated
human heart,” Circulation, vol. 41, p. 899, 1970.
[58] M. S. Spach and R. C. Barr, “Ventricular intramural and epicardial potential distributions during ventricular activation and repolarization in the
intact dog,” Circulation Res., vol. 37, no. 2, pp. 243–257, 1975.
[59] W. T. Abraham and D. L. Hayes, “Cardiac resynchronization therapy for
heart failure,” Circulation, vol. 108, no. 21, pp. 2596–2603, 2003.
[60] M. Bernabeu, M. Bishop, J. Pitt-Francis, D. Gavaghan, V. Grau, and
B. Rodriguez, “High performance computer simulations for the study of
biological function in 3D heart models incorporating fibre orientation and
realistic geometry at para-cellular resolution,” in Proc. Comput. Cardiol.,
2008, pp. 721–724.
[61] P. A. Helm, L. Younes, M. F. Beg, D. B. Ennis, C. Leclercq, O. P. Faris,
E. McVeigh, D. Kass, M. I. Miller, and R. L. Winslow, “Evidence of
structural remodeling in the dyssynchronous failing heart,” Circulation
Res., vol. 98, no. 1, pp. 125–132, 2006.
[62] V. Arsigny, P. Fillard, X. Pennec, and N. Ayache, “Log-Euclidean metrics
for fast and simple calculus on diffusion tensors,” Magn. Resonance Med.,
vol. 56, no. 2, pp. 411–421, 2006.

Authors’ photographs and biographies not available at the time of publication.

