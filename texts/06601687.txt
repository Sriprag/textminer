264

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Amorphous Regions-of-Interest Projection Method
for Simplified Longitudinal Comparison of Dynamic
Regions in Cancer Imaging
Yaniv Gal∗ , Nicholas Dowson, Pierrick Bourgeat, Olivier Salvado, Paul Thomas, Michael Fay, Stephen Rose,
Rosalind L. Jeffery, Amir Fazlollahi, and Stuart Crozier

Abstract—Tumors are typically analyzed as a single unit, despite
their biologically heterogeneous nature. This limits correlations
that can be drawn between regional variation and treatment outcome. Furthermore, despite the availability of high resolution 3-D
medical imaging techniques, local outcomes, (e.g., tumor growth),
are not easily measured. This paper proposes a method that uses
streamlines to divide a 3-D region of interest (e.g., tumor) into units
where local properties can be measured over the paths of growth.
The parameters such as directional length and mean intensity can
be measured locally at sequential time points and then compared.
The method is evaluated on synthetic objects, simulated tumors,
and medical images of brain tumors. The evaluations suggest that
the method is suitable for mapping amorphous dynamic objects.
Index Terms—Brain cancer, image analysis, image processing,
medical imaging, region of interest (ROI).

I. INTRODUCTION
HREE-dimensional medical imaging is widely used for
the diagnosis and treatment planning for cancer. Despite
the fact that high-resolution 3-D images of tumors can be

T

Manuscript received December 12, 2012; revised July 23, 2013; May 30,
2013; accepted September 12, 2013. Date of publication September 17, 2013;
date of current version January 16, 2014. This work was supported by the Australian National Health and Medical Research Council funding scheme under
Project Grant 631567. First two authors contributed equally to this work. Asterisk indicates corresponding author.
∗ Y. Gal is with the School of Information Technology and Electrical
Engineering, University of Queensland, Brisbane, Qld. 4072, Australia (e-mail:
ygal@itee.uq.edu.au).
N. Dowson, P. Bourgeat, O. Salvado, S. Rose, and A. Fazlollahi are with the
Australian E-Health Research Center, Royal Brisbane and Women’s Hospital,
Herston, Qld. 4006, Australia (e-mail: Nicholas.Dowson@csiro.au; Pierrick.
Bourgeat@csiro.au; olivier.salvado@csiro.au; stephen.rose@cai.uq.edu.au;
Amir.Fazlollahi@csiro.au).
P. Thomas is with the Queensland Nuclear Medicine, Royal Brisbane and Women’s Hospital, Herston, Qld. 4006, Australia (e-mail: Paul_
Thomas@health.qld.gov.au).
M. Fay is with the Department of Radiation Oncology, Royal Brisbane and
Women’s Hospital, Herston, Qld. 4006, Australia (e-mail: mikefay@me.com).
R. L. Jeffery is with the Department of Neurosurgery, Royal Brisbane and
Women’s Hospital, Herston, Qld. 4006, Australia (e-mail: r.jeffree@uq.edu.au).
S. Crozier is with the School of Information Technology and Electrical
Engineering, University of Queensland, Brisbane, Qld. 4072, Australia (e-mail:
stuart@itee.uq.edu.au).
This paper has supplementary downloadable material available at
http://ieeexplre.ieee.org (file size: 554 kB).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2282402

obtained and that tumors are biologically heterogeneous, the
treatment outcomes are generally measured in terms of patient survival and whole-tumor growth [1]–[3]. Such analysis
has limitations in revealing the local factors involved in the
tumor progression. Similarly, histological and genetic studies
of cancer use biopsy samples often taken from a few (often
one) locations [4] with the assumption that the whole tumor is
homogeneous. Regional analysis, however, may provide better
data for establishing prognostics and for treatment planning and
monitoring.
Although resection allows detailed characterization of tumors, methods for analyzing residual tumor in vivo are needed.
Imaging can characterize factors such as metabolism and blood
brain barrier breakdown at every location within a tumor volume. The analysis of such data is challenging due to the overwhelming amount of information in the 3-D images and the
difficulty in associating corresponding regions from different
images.
The outcome can be measured in different ways, including
changes in metabolism or changes in shape and volume. Such
measurements consider changes in local tissue properties as a
function of time. Hence, there is a requirement for a one-to-one
mapping from a location at one time point to its new position at another time point. Moreover, as tumor shape usually
changes in time, the comparison of the images of the tumor acquired at different time points (e.g., before and after the course
of radiotherapy) is often limited in showing in which regions
of the tumor growth or shrinkage has occurred. Spatial mappings can be obtained using registration, either rigid [5], [6] or
nonrigid [7], [8]. However, registration methods suffer from an
implicit ambiguity as to whether a change is due to local changes
in intensity or changes in the object morphology. Sensible constraints on registration algorithms [9] can be made that limit
the ambiguity, but a second problem arises, namely the division
of the tumor into units for which outcome can be meaningfully evaluated. In simulations, meaningful units such as cells
or contiguous biological environments can be selected [10], but
they may not always be inferred from images without bias. Furthermore, registration algorithms are intrinsically challenged to
give results that are biologically feasible. This problem is the
main application of interest in this paper: finding spatial correspondences between regions within a tumor in images taken at
different stages of the tumor development (e.g., before and after
radiotherapy).

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

GAL et al.: AMORPHOUS REGIONS-OF-INTEREST PROJECTION METHOD FOR SIMPLIFIED LONGITUDINAL COMPARISON

The previous work has looked at localizing tumors using
expectation maximization and using normal brain atlases as
a prior [11], using nonparametric generative approaches [12],
and Bayesian models [13], with some success. Likewise, the
methods to detect subtle changes from images have been proposed [14]. However, all the aforementioned methods consider
tumors as a whole. Nonrigid image registration fields have never,
to our knowledge, been successfully used to locally link biological factors with local outcomes in longitudinal studies.
This paper proposes a new method for achieving local analysis of outcomes in tumors. The method is based on projecting
(2-D or 3-D) a region of interest (ROI) from an internal reference (core) point to the exterior surface, using streamlines as an
indicator for tumor local direction of growth. This allows the
placement of tumors into a standard coordinate system despite
their amorphous shape. Further, with the modest requirements
of rigid alignment and moderate movement, spatial correspondences over time are obtained allowing local outcomes to be
referred to. The method is agnostic to dimensionality and image resolution as demonstrated by its application to synthetic
images. The correspondence of the streamlines to the local tumor growth was tested on simulated tumor images using the
simulation scheme proposed in [15].

265

A. Defining the ROI Surface
An image can be described as a mapping of D-dimensional
spatial coordinates into intensities. Given an image, I(x) :
RD → R, with quantitative intensities, I(xi ), and an ROI,
R ⊆ RD , to be processed, it is assumed that R is a single connected component. It is preferred (but not essential) that the
surface of R is homeomorphic to a sphere (i.e., an orientable
surface of genus zero). This makes the projection map easier to
interpret in terms of correspondence between the map and the
original ROI topology. For practical reasons, we assume that I
and R are defined on a discrete set of voxel coordinates, i.e.,
xi ∈ ZD . In such case, the surface of R is defined to be the set of
/ R ∧ {N (xi ) ∩ R} 	= ∅}, where N (x) is
voxels R̄ = {xi | xi ∈
the set of (26) immediate neighbors of the voxel x. In the case
of multiple connected components or ROIs from the same tumor (e.g., metastases), it is possible to either apply the method
to each individual ROI, if independent analysis is required or
to define an encapsulating (bounding) ROI that contains all the
other ROIs. In such case, the voxels in the encapsulating ROI
that are outside of all the original ROIs will be ignored during
the projection process.

B. Obtaining a Projection Reference Point
II. METHOD
The method, proposed in this paper, called amorphous ROI
projection (ARP), is designed to project a 3-D object, described
by an ROI, to a 2-D projection map using a set of streamlines to
allow effective, yet efficient, local analysis of tissue properties.
The projection of a 3-D object onto a 2-D map imposes some
loss of information. However, the underlying assumption of this
paper is that the ROI analysis is not performed on an individual
voxel basis, and thus, the information from sets of voxels can
be augmented into a single value with no impact on the analysis
results. Furthermore, the geometrical correspondence between
the projection map and the original image is preserved to allow
tracking the source voxels in the projection map.
In this paper, tumors are represented as ROIs in the image
where a reference (core) point is defined. Finally, a set of streamlines is constructed from the ROI surface (i.e., boundary) to the
core point and from the surface to a bounding sphere that is then
projected to an easy-to-interpret 2-D map.
A desirable feature of such projections is that local changes in
the original ROI (e.g., local growth of tumor over time) will yield
local changes in the projection map. This means that changes
in the ROI morphology or intensity levels in a specific region
will be translated to changes in a corresponding region in the
projection map and thus makes it possible to locate the region
in the original ROI that produced these changes.
The method is designed for longitudinal studies, where ROIs
from different time points are compared (e.g., tumor post treatment and a follow-up scan for detecting regrowth). However, the
proposed method is also useful for within time point analysis
as the spatial correspondence allows interpretation of measurements, despite the object’s amorphous shape.

Defining a reference (i.e., core) point is the first step of the
ARP method. It is required to be inside the ROI, regardless of
its morphological properties (e.g., convexity) in order for the
method to be able to capture internal properties of the ROI under inspection (e.g., intensity mean and variance in different
regions of the ROI). Also, the core points of similar ROIs (e.g.,
a follow-up study of a tumor) are required to be in close proximity in order to allow analysis of change. A morphological
skeletonization algorithm was adapted for this purpose. For the
2-D ROI case, an algorithm from [16] was adapted, while for
a 3-D ROI, the authors adapted the skeletonization algorithm
from [17]. Once a skeleton, K ⊂ R, 
has been formed, the ROI
x i ∈R
center of mass is calculated, m = |R
| , where |R| is the
number of elements in R. The voxel ROI core point is then
chosen to be xc = arg minx i ∈K xi − m. In some special, yet
rare, cases (e.g., when the ROI shape is a torus), the core point
may become unstable under small changes in the ROI topology.
None of the images that were tested for this paper exhibited
such ROI topology. When comparing two or more ROIs, the
core points may not correspond due to such sensitivity. This
can usually be solved by selecting a reference ROI, calculating
its core point xc and using (the same) xc for all other ROIs
under comparison. In case xc falls outside the ROI, the closest
point inside the ROI can be selected as a core. This solution,
however, assumes that all ROIs are spatially registered which is
sometimes hard to achieve. Thus, when spatial alignment cannot be achieved, the aforementioned method should be used for
each ROI independently. Further, stability of the core location
is obtained by iteratively computing the core point, while downweighting the influence of points distant from the center of mass
(i.e., outliers).

266

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Fig. 1. Synthetic object formed from a uniform sphere with irregularities in
boundary and intensity level. (a) shows the original object outline (dark grey)
and the region of high uptake (white) and (b) shows the object streamlines, R̄,
to the core, xc , and from R̄ to the sphere S.

C. Extracting ROI Streamlines
In order to project the ROI onto its surface, Laplace’s equation
is utilized in a similar way to [18] and [19]. Laplace’s equation
is a second-order partial differential equation defined on a scalar
field, f , and is given by
∇2 f (x) = 0.

(1)

As boundary conditions, we set f (xc ) = 0 and f (xi ∈ R̄) =
1. We use LR to denote the solution of the Laplace equation
inside R, i.e., LR : (R\xc ) → R. Next, the gradient field, ∇LR ,
is calculated and a streamline, ψj , is extracted for each voxel,
xj ∈ R̄, by following the gradient directions from xj to xc .
Each streamline is treated as a parameterized curve ψj (t) : R →
RD , such that ψj (0) = xj and ψj (1) = xc . An example of the
streamlines created in this manner, using the synthetic data,
is shown in Fig. 1(b), in blue. The properties of the Laplace
solution ensure that the streamlines never cross as they converge
on the reference point xc . Also, all the voxels in R are intersected
by at least one streamline, because no local minima apart from
xc exist within LR .
The reference point is chosen in a manner that is insensitive
to changes in region shape, and the Laplacian method ensures
that the streamlines are primarily influenced by the position of
the proximal region boundary. Hence, the variation of streamlines with small changes in region shape is low. This limited
variation allows correspondences between streamlines from a
region defining a tumor at two points in time to be inferred.
The defined streamlines, ψj , allow multiple useful properties
to be measured, including:
1) The total length of a streamline
 1
  
ψj (t) dt.
(2)
PL j = PL (ψj ) =
0

2) The mean intensity along the streamline
 1
1
PI j = PI (ψj ) =
I (ψj (t)) dt.
L(ψj ) 0

(3)

The length of the streamline is measured in real world units
and when measured at two time points and subtracted is an
approximate measure of growth. Similarly, the regional mean
intensity in brain positron emission tomography (PET) images is

measured as an indication of local changes in metabolic activity.
The aforementioned properties are calculated and stored for
each surface voxel, resulting in a pair of values for each voxel
xj ∈ R̄. These measures were chosen to demonstrate the utility
of the approach. Other useful measures can be extracted from
the streamlines based on the application. The total variance,
for instance, can provide information on irregular changes in
intensity which is a meaningful feature in the breast cancer
analysis [20], [21].
The characterization of the region’s properties along each
streamline is essentially a summarization of the object onto a
manifold with one less dimension. Hence, the scalar properties
of a 3-D region can be projected onto a 2-D scalar field (and
similarly a 2-D object onto a 1-D profile), which is not only
convenient for visualization, but is useful for certain applications. In particular, when reporting on tumors after resection,
individual regions of the residual tumor within the periphery of
the resection cavity may progress at different rates.
D. Projecting the ROI Onto a 2-D Map
An additional advantage of the ARP method is its ability to
project the internal content of the ROI on a 2-D rectangular map
that can be easily interpreted by humans. The projection process
is based on the constructed streamlines and is performed by
projecting the outer surface onto a sphere and then transforming
the sphere into a 2-D map (plane).
1) Projecting the ROI Surface Onto a Sphere: Once the desired properties have been measured inside the ROI, based on
the internal streamlines, the calculated values are stored in correspondence to the boundary voxels which are the starting points
of the streamlines. The ROI surface topology is then simplified
by projecting it onto a sphere, S. S is chosen to be a sphere
with a center at xc and a radius large enough to entirely encompass R̄, i.e., R ⊂ B, where B is the ball bounded by S.
Although the ARP method is relatively insensitive to the choice
of radius, too large a radius may “diffuse” local changes to
surrounding streamlines thus diminishing the visibility of the
change. It is hence recommended that S be as small as possible
under the above constraints. The transformation between R̄ and
S is performed by solving the Laplace equation where S and R̄
are the initial conditions (i.e., f (xj ∈ R̄) = 1, f (xk ∈ S) = 0).
Once a solution is established, gradient-based stream lines,
ηj are formed for each xj ∈ R̄, such that ηj (0) = xj and
ηj (1) = sj ∈ S. For each point sj ∈ S, we can now assign the
corresponding values PL j and PI j . The points {sj } are then
transformed into a pair (one each for growth and change in intensity) of 2-D projection maps, ML and MI , holding the values
{PL j } and {PI j } of the corresponding voxels sj on the sphere.
An example of the streamlines created in this manner, using the
synthetic data is shown in Fig. 1(b), in red. A simplified version of the proposed method can skip the sphere construction
stage by projecting the measured values PL j and PI j directly to
the corresponding maps ML and MI , based on the corresponding streamline direction of entry toward the core point. This
method, however, has decreased sensitivity to small changes in
R̄ as streamlines originating at small curvatures on the surface

GAL et al.: AMORPHOUS REGIONS-OF-INTEREST PROJECTION METHOD FOR SIMPLIFIED LONGITUDINAL COMPARISON

267

(i.e., “outwards” tumor growth) tend to gather toward the core
point and thus represent the change on the surface in a very small
angular region near the core. This property can cause such small
changes to be averaged away when calculating ML and MI .
2) Transforming the Sphere S Into a 2-D Map: The sphere
S can be transformed into a 2-D rectangular map using a Mercator projection [22] (i.e., projecting the sphere onto a bounding
cylinder, aligned with the z-axis, and then unfolding the cylinder). For consistency, azimuth 0 is defined as the direction of
y − (i.e., inferior) and is increasing clockwise. This definition
is especially useful for simplifying the analysis of the maps
in brain imaging, for instance, as the center of the map corresponds to the direction of the patient’s nose (i.e., anterior). Once
a correspondence between voxels on the sphere and pixels in
the map has been established, each pair of values PL j , PI j is
assigned to the row and column in ML and MI that correspond
to the azimuth and slice of sj , respectively. The set sj ⊆ S will
usually not occupy all the voxels in S. Hence, the maps ML
and MI may also not be fully occupied and will contain gaps
of undefined values. The gaps in the maps can be covered by
(linear or nearest-neighbor) interpolation of the existing values.
It is important to note that such interpolation must be cyclic on
the azimuth (column) axis of the map (i.e., the first column is
subsequent to the last).

III. EXPERIMENTS AND RESULTS
A. Synthetic Data
In the first experiment, the ARP method was qualitatively
applied to the synthetic data in order to test its ability to identify
small inhomogeneities in shape and intensity. The method was
first applied to selected slices in a 3-D image and then to the
image as a whole.
For an ROI with a shape of a perfect sphere and uniform
intensity, ML and MI are, respectively, expected to be uniform.
When irregularities in the boundary or intensity occur, a corresponding change is observed in the projections of ML (for
shape) or MI (for intensity). Fig. 2 demonstrates this for two
2-D regions with irregularities in boundary and intensity. In this
experiment, each object was constructed from a (discrete) circle
and a narrow rectangle attached to it. A high intensity location
(lesion) was embedded inside the spherical part of the region.
In order to examine the results of the model with 3-D data,
various synthetic 3-D objects were constructed, including: 1)
a sphere with uniform intensity, 2) a sphere with a “hot spot”
(i.e., small region with high intensity), 3) a sphere with a hot
spot and a narrow cuboid attached to it, pointing toward y − , and
4) a sphere with a hot spot and a narrow cuboid attached to it,
pointing toward z + .
The calculated ML and MI for item 3 is presented in Fig. 3.
The results demonstrate how an irregularity in either intensity
levels or boundary shape can be easily identified in the projected
maps by looking for local changes. The changes can then be
tracked back to the location of the corresponding streamline by
constructing a hash table that relates each pixel in the maps to
the corresponding voxel in R̄ during the projection process.

Fig. 2. Results of two 2-D objects (ROIs) with irregularity in shape and
intensity. Top row: original ROIs, Middle row: corresponding M L , Bottom
row: corresponding M I . In the graphs, the vertical axis represents the measured
quantity while the horizontal axis represents azimuth (in degrees).

B. Simulated Growth
The goal of the second experiment was to test the ARP method
on small changes in the tumor shape with as realistic data as
possible. The Konukoglu [15] tumor growth simulation was
used for this purpose. The Konukoglu simulation is based on
the reaction–diffusion method [23] and accounts for directional
diffusion based on tract direction. The Konukoglu method was
chosen because it accounts for the diffusion properties of white
matter and grey matter in the brain, providing a good approximation to the actual brain tumor growth process. Nine different
tumors were simulated in different locations in the brain. The
extent of each tumor was recorded and analyzed with the proposed model in several time points during the growth of the
tumor (approximately every five days, based on the simulation
time scale). The extent of sample simulated tumors in the different time points and the resulting ML maps in the corresponding
time points are presented in Fig. 4, note that all the simulations
and resulting maps demonstrated similar behavior. A core location sensitivity test has also been carried out using the simulated
data. The results showed that movement of the core within a
range of 5 mm can cause insignificant changes in the difference
between the ML maps (less than 5% of maximum intensity).
C. Analyzing the Biological Meaning of the Model Streamlines
The simulations were also used to test the hypothesis that
the model streamlines ψj provide a reasonable prediction of

268

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Fig. 3. M L and M I resulting from a 3-D sphere with an irregularity in shape
(horizontal cuboid) and intensity.

Fig. 5. Mean results of the streamline quasi-distance. The horizontal axis
represents simulation days prior to the final tumor state while the vertical axis
represents mean distance between the model streamlines and simulated line of
growth. The dashed red lines represent the maximum and minimum values, the
blue dashed lines represent one standard deviation and the green line represents
the mean over all simulations.

distance between the streamlines ψi and γi for a selected time
T is given by


ds = max
(4)
min (γi (t1 ) − ψi (t2 )) .
t 1 ∈[0,T ]

t 2 ∈[0,1]

The directional correlation at location xi is given by the inner
product
  +

ψj (0 ), γi (0+ )
.
(5)
Ci =
ψj (0+ ) · γi (0+ )

Fig. 4. Simulated tumor growth, using the Konukoglu method. Top row: the
extent of the tumor in different time points; ten days after tumor seeding, and
every five days afterwards. Bottom row: the corresponding M L maps (in mm).

short-term local direction of growth. In order to test this hypothesis, two properties were measured: First, the mean streamline
quasi-distance (defined below) between the model streamlines
and the simulation line of growth for a given time, and; second,
the directional correlation between each model streamline and
the actual direction of growth (extracted from the simulation),
on the surface of the tumor.
Let γi be the “line of growth” of the tumor from the tumor
seed xs (i.e., where it started from) to the voxel xi , such that
γi (0) = xi and γi (1) = xs . Given a streamline ψi between the
ROI core xc and the ROI surface voxels xi ∈ R̄, the quasi-

The quasi-metric (4) measures the spatial difference between
the line of growth and the model corresponding streamline. Intuitively, this asymmetric variation of the Hausdorff distance
indicates how far the model streamline can get from the real
line of growth in the defined past time period. The streamline
quasi-distance was averaged over all streamlines of each simulation and the results are presented in Fig. 5. The results show
that the model streamlines follow the actual line of growth, with
only a few millimeters maximum deviance for a period of almost a (simulation) month prior to tumor imaging. Thus, the
results indicate that the model streamlines correspond well with
the actual tissue line of growth for the past few weeks. The directional correlation on the surface of the tumor tests the ability
of the model streamlines to predict the direction of growth on
the surface in the short term. The directional correlation was
measured and averaged over all streamlines in each simulated
tumor. The results of the comparison for one of the simulated
tumors are given in Fig. 6. The mean directional correlation over
all tumors was 0.98, with minimum correlation of 0.95, maximum 0.99, and median value of 0.99, providing evidence that
the direction of the streamlines ψj (t) (t ≈ 0) closely concurs
with the direction of simulated growth.

GAL et al.: AMORPHOUS REGIONS-OF-INTEREST PROJECTION METHOD FOR SIMPLIFIED LONGITUDINAL COMPARISON

269

Fig. 6. Directional correlation between model streamlines ψ j and the actual
direction of the simulated growth, using the Konukoglu method. The blue lines
represent the model streamlines while the red segments represent the direction
of growth near the boundary. The mean directional correlation values between
the model streamlines and the tumor growth for the above tumor was 0.99.

D. Clinical Data
To qualitatively evaluate the utility of the method on clinical
data, longitudinal brain and breast tumor images were acquired.
Datasets from three brain cancer patients (patient 1, 2, and 3)
and one breast cancer patient (patient 4) were used.
1) Brain Tumor Data: All brain patients (aged 58, 71,
and 70, respectively) were diagnosed with a (Glioblastoma)
high grade primary brain tumor. 4-dihydroxy-6-[1 8F]-fluoroL-phenylalanine (FDOPA) PET and contrast enhanced MR
(CEMR) images were acquired at two time points: four weeks
after resection of the tumor (t1), and four months after resection
(t2). The two time points were, respectively, after a tumor resection and after a course of (temozolamide) chemo-radiotherapy.
In each of the studies, the tumor was delineated manually
by an experienced nuclear-medicine physician (PT) and the unmodified delineations were used to define the ROI. The sample
slices from the images with the manual delineation overlaid are
presented in Figs. 7 and 9. Note the significant change in size and
intensity between the first (t1) and second image (t2) of patient
1. The ML and MI generated from patient 1 ROI images are
presented in Fig. 8. The core location points were selected in the
t1 image using the method described at Section II-B and were
reused in the t2 images after rigid registration (i.e., translation
and orientation). The ML graphs indicate that the tumor shrank
due to therapy. However, the MI graphs show an increase of
tracer uptake levels within the tumor, which suggest that treatment did not eliminate all the active tumor and that recurrence
is likely. The resulting MI and ML from a 3-D ROI projection
of patient 2 data, for both time points, are presented in Figs. 10
and 11, respectively. In these images, ML was measured in
millimeters, MI of the PET was measured in standardized uptake value ratio [24] which is a method for interpatient PET
uptake normalization. MI of the CEMR was measured in absolute contrast enhancement between the precontrast anatomical
and postcontrast, taken 4 min after the injection of the contrast
agent. The region of largest change in ML between t1 and t2 is
marked by a black arrow in Fig. 11, with a corresponding arrow
in the 3-D diagram of the tumor in Fig. 12.

Fig. 7. Patient 1 brain tumor images: FDOPA-PET in “hot iron” on top,
CEMR on bottom, with manual delineation overlaid (green line): (a,c) three
months postresection, (b,d) six months postresection.

2) Breast Cancer Data: The breast cancer data (patient 4)
were acquired in two time points: initial image (t1), at the age
of 42 and a follow-up scan (t2) three years later. Each dataset
contains a T1 /T2 anatomical and a dynamic contrast-enhanced
magnetic resonance imaging. The initial scan detected a suspicious lesion in the right breast. The cytological examination
confirmed that the suspicious lesion was benign. The followup scan showed changes in the lesion shape. The cytological
examination confirmed the lesion to be a malignant carcinoma.
In each of the images, the lesion was delineated manually
by an experienced clinician and the unmodified delineations
were used to define the ROI. The sample slices from the images
with the manual delineation overlaid are presented in Fig. 13.
The ML generated for the two time points are presented in
Fig. 14. Due to deformation of the organ under examination,
no unambiguous spatial correspondence between the images
could be established. Thus, the location of the core point was
estimated using the method in Section II-B for each time point
independently. Also, as breast MR images are acquired in a
prone position (i.e., face down), it is assumed that the organ
orientation is approximately consistent between scans and no
further correction is required.
The resulting ML maps indicate that the tumor has generally
shrunk but the shape of the tumor has changed (see Fig. 15).
IV. DISCUSSION
A new method was proposed to describe dynamic amorphous
ROIs. The method allows spatial correspondences between the
objects to be obtained despite structural changes, by defining a

270

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Fig. 8. Intensity maps M I of a 2-D ROI from patient 1: Left: PET, center: CEMR, and; Right: length maps M L . Green: Three months postresection (t1). Blue:
Six months postresection (t2).

Fig. 11. 3-D distance maps M L of t1 (Left) and t2 (Right) time points of
patient 2. The black arrows point to a region with indicated shrinkage of the
tumor.

Fig. 9. Patient 2 brain tumor images: FDOPA-PET in “hot iron”on top, CEMR
on bottom, with manual delineation overlaid (green line): (a,c) Three months
postresection. (b,d) Six months postresection.

Fig. 10. 3-D intensity maps M I of t1 (Left) and t2 (Right) time points of
patient 2. The black arrows points to an area of indicated increase in uptake
(potential tumor regrowth) between t1 and t2.

Fig. 12. 3-D model of patient 2 tumor: left image shows the tumor at t1, while
the right image shows the tumor at t2. The colors represent the M L values at the
corresponding position. The arrow indicates the location of a significant change
in the M L value between t1 and t2 and corresponds to the arrow location in
Fig. 11.

Fig. 13. Patient 4 breast CEMR images with manual delineation overlaid
(green line): (a) Initial image. (b) Three years follow-up.

GAL et al.: AMORPHOUS REGIONS-OF-INTEREST PROJECTION METHOD FOR SIMPLIFIED LONGITUDINAL COMPARISON

271

The selection of the core point for the model is a crucial step
in producing a meaningful representation of changes in the object under inspection. The task of selecting the core point in
longitudinal studies should be carefully examined when spatial correspondence is not achievable. Also, the orientation of
the object under inspection should be approximately consistent
between scans.
V. CONCLUSION
Fig. 14. 3-D distance maps M L of t1 (Left) and t2 (Right) time points of
patient 4. Note the overall shrinkage of the tumor.

This paper has proposed a simple method to subdivide tumors
using streamlines. The streamlines are shown to be biologically
meaningful models of paths of previous growth with predictable
error. Furthermore, the streamlines demonstrated to be useful
for longitudinal analysis of dynamic amorphous 3-D shapes
such as tumors and can be used to measure multiple useful
parameters such as metabolism or geometry. The experiments
demonstrated that the method can be an effective tool for the
analysis of amorphous tumors in 3-D medical images.
ACKNOWLEDGMENT

Fig. 15. 3-D model of patient 4 breast tumor: left image shows the tumor at
t1, while the right image shows the tumor at t2. The colors represent the M L
values at the corresponding position. Note the overall shrinkage of the tumor
and the change in shape on the left end (arrow).

The authors would like to thank D. McClymont for providing
the breast images.
REFERENCES

reference point, a boundary, and a set of streamlines between
the boundary and reference point.
The method also allows the description of complex 3-D objects via a 2-D projection of the data where each streamline is
presented by a single point. This property is useful for examining biologically relevant measures such as tissue heterogeneity
and regional mean uptake in PET and MR images.
The method was evaluated on the synthetic data, images of
simulated tumor growth, and on brain tumor PET and MR images from clinical practice. The results on the synthetic data
suggest that there is intuitive correspondence between the projection maps and the original images for simple shapes. The
tumor growth simulation provides evidence that such correspondence also exists when the shape is amorphous. The analysis of
directional correlation between the model streamlines and the
simulated tumor suggests that the model streamlines provide
good indication of expected direction local tumor growth. A
possible explanation for that is that tumor cells have higher
probability to grow toward tissue with low cell density which
sits with the tendency of the streamlines to remain “as far” as
possible from each other.
The evaluation on clinical data shows that the method is
stable enough to deal with large and complex 3-D volumes
that change significantly over time. Furthermore, the projection
maps provide simplified visualization of the data, which reveal
subtle changes in shape and intensity in the ROI over time.
The model can be generated in a relatively short-time (usually less than a minute) using a single-core workstation, for an
average size ROI. Furthermore, parallelization of the method on
a multicore CPU or a general-purpose graphical processing unit
is relatively straight-forward.

[1] W. Chen. (2007, Sep.). Clinical applications of PET in brain tumors. J. Nuclear Med.: Offic. Publication, Soc. Nucl. Med. [Online]. 48(9), pp. 1468–
1481, PMID: 17704239. Available:http://www.ncbi.nlm.nih.gov/pubmed/
17704239
[2] B. J. Fueger, J. Czernin, T. Cloughesy, D. H. Silverman, C. L. Geist, M.
A. Walter, C. Schiepers, P. Nghiemphu, A. Lai, M. E. Phelps, and W.
Chen. (2010, Oct.). Correlation of 6-18F-fluoro-L-dopa PET uptake with
proliferation and tumor grade in newly diagnosed and recurrent gliomas.
J. Nuclear Med.: Offic. Publ., Soc. Nucl. Med. [Online]. 51(10), pp. 1532–
1538, PMID: 20847166. Available:http://www.ncbi.nlm.nih.gov/pubmed/
20847166
[3] C. Schiepers, W. Chen, T. Cloughesy, M. Dahlbom, and S. Huang.
(2007, Oct.,). 18f-fdopa kinetics in brain tumors. J. Nucl. Med. [Online].
48(10), pp. 1651–1661. Available:http://jnm.snmjournals.org/cgi/content/
abstract/48/10/1651
[4] M. Gerlinger, A. J. Rowan, S. Horswell, J. Larkin, D. Endesfelder, E.
Gronroos, P. Martinez, N. Matthews, A. Stewart, P. Tarpey, I. Varela, B.
Phillimore, S. Begum, N. Q. McDonald, A. Butler, D. Jones, K. Raine,
C. Latimer, C. R. Santos, M. Nohadani, A. C. Eklund, B. Spencer-Dene,
G. Clark, L. Pickering, G. Stamp, M. Gore, Z. Szallasi, J. Downward,
P. A. Futreal, and C. Swanton. (2012, Mar.). Intratumor heterogeneity
and branched evolution revealed by multiregion sequencing. New Engl. J.
Med. [Online]. 366(10), pp. 883–892, PMID: 22397650. Available:http:
//www.ncbi.nlm.nih.gov/pubmed/22397650
[5] J. West, J. M. Fitzpatrick, M. Y. Wang, B. M. Dawant, J. Maurer, C R,
R. M. Kessler, R. J. Maciunas, C. Barillot, D. Lemoine, A. Collignon,
F. Maes, P. Suetens, D. Vandermeulen, P. A. van den Elsen, S. Napel, T.
S. Sumanaweera, B. Harkness, P. F. Hemler, D. L. Hill, D. J. Hawkes, C.
Studholme, J. B. Maintz, M. A. Viergever, G. Malandain, and R. P. Woods.
(1997, Aug.). Comparison and evaluation of retrospective intermodality
brain image registration techniques. J. Comput. Assist. Tomogr. [Online].
21(4), pp. 554–566, PMID: 9216759. Available:http://www.ncbi.nlm.nih.
gov/pubmed/9216759
[6] M. Jenkinson, P. Bannister, M. Brady, and S. Smith, “Improved optimization for the robust and accurate linear registration and motion correction
of brain images,” NeuroImage, vol. 17, no. 2, pp. 825–841, Oct. 2002.
[7] B. B. Avants, C. L. Epstein, M. Grossman, and J. C. Gee, “Symmetric
diffeomorphic image registration with cross-correlation: evaluating automated labeling of elderly and neurodegenerative brain,” Med. Image
Anal., vol. 12, no. 1, pp. 26–41, Feb. 2008.
[8] D. Rueckert, C. Hayes, C. Studholme, P. Summers, M. Leach, and D.
J. Hawkes. (1998). “Non-rigid registration of breast MR images using

272

[9]
[10]

[11]

[12]

[13]

[14]

[15]

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

mutual information,” in Medical Image Computing and ComputerAssisted Interventation? MICCAI98, vol. 1496, W. M. Wells, A. Colchester, and S. Delp, Eds. Berlin/Heidelberg, Germany: Springer-Verlag,
1998, pp. 1144–1152. [Online]. Available:http://www.springerlink.com/
content/f272v611l25g27q7/
J. P. Pluim, J. B. Maintz, and M. A. Viergever, “Mutual-information-based
registration of medical images: A survey,” IEEE Trans. Med. Imag.,
vol. 22, no. 8, pp. 986–1004, Aug. 2003.
Z. Wang and T. S. Deisboeck, “Computational modeling of brain tumors:
discrete, continuum or hybrid?,” in Scientific Modeling and Simulations,
S. Yip, T. D. Rubia, T. J. Barth, M. Griebel, D. E. Keyes, R. M. Nieminen,
D. Roose, and T. Schlick, Eds., (Lecture Notes in Computational Science
and Engineering Series). vol. 68Amsterdam, The Netherlands: SpringerVerlag, 2009, pp. 381–393.
A. Gooya, K. M. Pohl, M. Bilello, G. Biros, and C. Davatzikos. (2011).
“Joint segmentation and deformable registration of brain scans guided
by a tumor growth model,” Med. Image Comput. Comput.-Assist. Intervent.: MICCAI . . . Int. Conf. Med. Image Comput. Comput.-Assist.
Intervent., vol. 14, no. Pt 2, pp. 532–540, PMID: 21995070 PMCID: PMC3246749, [Online]. Available:http://www.ncbi.nlm.nih.gov/
pmc/articles/PMC3246749/
M. R. Sabuncu, B. T. T. Yeo, K. Van Leemput, B. Fischl, and P. Golland. (2010, Oct.). A generative model for image segmentation based on
label fusion. IEEE Trans. Med. Imag. [Online]. 29(10), pp. 1714–1729.
Available:http://dspace.mit.edu/handle/1721.1/64791
J. Corso, E. Sharon, S. Dube, S. El-Saden, U. Sinha, and A. Yuille, “Efficient multilevel brain tumor segmentation with integrated Bayesian model
classification,” IEEE Trans. Med. Imag., vol. 27, no. 5, pp. 629–640, May
2008.
K. Pohl, E. Konukoglu, S. Novellas, N. Ayache, A. Fedorov, I. Talos,
A. Golby, W. Wells, R. Kikinis, and P. Black, “A new metric for detecting change in slowly evolving brain tumors: Validation in meningioma
patients,” Neurosurgery, vol. 68, pp. 225–233, 2011.
E. Konukoglu, O. Clatz, B. Menze, B. Stieltjes, M. Weber, E. Mandonnet,
H. Delingette, and N. Ayache, “Image guided personalization of reactiondiffusion type tumor growth models using modified anisotropic Eikonal
equations,” IEEE Trans. Med. Imag., vol. 29, no. 1, pp. 77–95, Jan. 2010.

[16] L. Lam, S.-W. Lee, and C. Y. Suen, “Thinning methodologies-a comprehensive survey,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 14, no. 9,
pp. 869–885, Sep. 1992.
[17] Y. Ge, D. Stelts, and D. Vining, “3D skeleton for virtual colonoscopy,”
in Visualization in Biomedical Computing.. New York, NY, USA:
Springer-Verlag, 1996, pp. 449–454.
[18] S. Jones, B. Buchbinder, and I. Aharon, “Three-dimensional mapping
of cortical thickness using Laplace’s equation,” Human Brain Mapping,
vol. 11, no. 1, pp. 12–32, 2000.
[19] O. Acosta, P. Bourgeat, M. Zuluaga, J. Fripp, O. Salvado, and S. Ourselin,
“Automated voxel-based 3d cortical thickness measurement in a combined
Lagrangian–Eulerian PDE approach using partial volume maps,” Med.
Image Anal., vol. 13, no. 5, pp. 730–743, 2009.
[20] American College of Radiology, “Breast imaging reporting and data system (BIRADS),” American College of Radiology (ACR), 2006. Available:
www.arc.org
[21] Y. Gal, A. Mehnert, A. Bradley, D. Kennedy, and C. Stuart, “New spatiotemporal features for improved discrimination of benign and malignant
lesions in dynamic contrast-enhanced-magnetic resonance imaging of the
breast,” J. Comput. Assist. Tomography, vol. 35, no. 5, pp. 645–654, 2010.
[22] O. M. Miller, “Notes on cylindrical world map projections,” Geograph.
Rev., vol. 32, no. 3, pp. 424–430, 1942.
[23] O. Clatz, M. Sermesant, P. Bondiau, H. Delingette, S. Warfield,
G. Malandain, and N. Ayache, “Realistic simulation of the 3-D growth of
brain tumors in MR images coupling diffusion with biomechanical deformation,” IEEE Trans. Med. Imag., vol. 24, no. 10, pp. 1334–1346, Oct.
2005.
[24] B. Lopresti, W. Klunk, C. Mathis, J. Hoge, S. Ziolko, X. Lu, C. Meltzer,
K. Schimmel, N. Tsopelas, S. DeKosky, and J. Price, “Simplified quantification of Pittsburgh compound b amyloid imaging pet studies: A comparative analysis,” J. Nucl. Med., vol. 46, no. 12, pp. 1959–1972, 2005.

Authors’ photographs and biographies not available at the time of publication.

