IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

1089

Inertial Sensor-Based Stride Parameter Calculation
From Gait Sequences in Geriatric Patients
Alexander Rampp∗ , Jens Barth, Samuel Schülein, Karl-Günter Gaßmann, Jochen Klucken,
and Björn M. Eskofier, Member, IEEE

Abstract—A detailed and quantitative gait analysis can provide
evidence of various gait impairments in elderly people. To provide an objective decision-making basis for gait analysis, simple
applicable tests analyzing a high number of strides are required.
A mobile gait analysis system, which is mounted on shoes, can
fulfill these requirements. This paper presents a method for computing clinically relevant temporal and spatial gait parameters.
Therefore, an accelerometer and a gyroscope were positioned laterally below each ankle joint. Temporal gait events were detected
by searching for characteristic features in the signals. To calculate
stride length, the gravity compensated accelerometer signal was
double integrated, and sensor drift was modeled using a piece-wise
defined linear function. The presented method was validated using
GAITRite-based gait parameters from 101 patients (average age
82.1 years). Subjects performed a normal walking test with and
without a wheeled walker. The parameters stride length and stride
time showed a correlation of 0.93 and 0.95 between both systems.
The absolute error of stride length was 6.26 cm on normal walking test. The developed system as well as the GAITRite showed an
increased stride length, when using a four-wheeled walker as walking aid. However, the walking aid interfered with the automated
analysis of the GAITRite system, but not with the inertial sensorbased approach. In summary, an algorithm for the calculation of
clinically relevant gait parameters derived from inertial sensors
is applicable in the diagnostic workup and also during long-term
monitoring approaches in the elderly population.
Index Terms—Accelerometers, gait alterations, gait analysis, gyroscopes, stride length, stride parameters.

Manuscript received April 30, 2014; revised August 18, 2014 and October 7,
2014; accepted October 27, 2014. Date of publication November 7, 2014; date
of current version March 17, 2015. This work was supported by the Bavarian
Research Foundation (AZ 974-11), the EFIMoves project of the FriedrichAlexander University Erlangen-Nürnberg Emerging Fields Initiative, and by an
unrestricted project grant ASTRUM IT GmbH. Sport shoes were provided by
adidas. Asterisk indicates corresponding author.
∗ A. Rampp is with the ASTRUM IT GmbH, 91058 Erlangen, Germany
(e-mail: alexander.rampp@astrum-it.de).
J. Barth is with the ASTRUM IT GmbH, 91058 Erlangen, Germany (e-mail:
jens.barth@astrum-it.de).
S. Schülein and K.-G. Gaßmann are with the Department of Geriatrics Centre Erlangen, Waldkrankenhaus St. Marien, 91054 Erlangen,
Germany (e-mail: Samuel.Schuelein@waldkrankenhaus.de; karl.gassmann@
waldkrankenhaus.de).
B. M. Eskofier is with the Digital Sports Group of the Pattern Recognition Lab,
Department of Computer Science, Friedrich-Alexander University ErlangenNürnberg, 91054 Erlangen, Germany (e-mail: bjoern.eskofier@cs.fau.de).
J. Klucken is with the University Hospital Erlangen, FriedrichAlexander University Erlangen-Nürnberg, 91054 Erlangen, Germany (e-mail:
jochen.klucken@uk-erlangen.de).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2368211

I. INTRODUCTION
AIT analysis is an indispensable assessment tool for a variety of movement disorders in the clinical workup (e.g.,
neurological [1] or musculoskeletal [2] diseases). Sensor-based
objective mobility data analysis is increasingly developed to
identify health risk factors, to support clinical diagnostics and
monitor medical treatments, and to complement easily applicable assessment of the quality of life in the elderly [3]. Sensorbased gait analysis can also provide indicators for a beginning
gait alternation in the elderly. With increasing age, people have
significantly lower walking speed [4], [5] and a higher variability in stride time [6], [7]. Hausdorff et al. [5] and Verghese et al.
[8] also showed that the stride length, the corresponding variability, as well as the swing time variability are key parameters
for gait characteristics in elderly adults.
Specialists for movement disorders are able to identify and
classify the above mentioned impairments in the everyday clinical workup. However, typical examinations require long-time
experience and remain arbitrary and subjective. Several electronic measurement systems have been developed to improve
assessment of temporal and spatial gait parameters in a clinical
population. One example for an electronic measurement system is a camera-based stationary 3-D tracking system [7]. Here,
markers have to be affixed to the body to track motion with submillimeter accuracy. Such a system is expensive and requires
a complex and time-consuming preparation of the subject. The
usage of these systems requires special laboratory environment
and is therefore not suitable for standard clinical settings.
In contrast, computerized walkways need almost no preparation of the subjects. The GAITRite system (GAITRite; CIR
Systems Inc., Havertown, PA, USA) consists of a carpet with
embedded pressure sensors placed on 1.27-cm centers [9]. However, application of the GAITRite system in the clinical workup
requires a laboratory environment for gait analysis. Also, 3-D
parameters like heel strike (HS) and toe-off (TO) angles, or foot
clearance during one gait cycle cannot be assessed.
Gait impairment in the elderly often requires the use of walking aids. Four-wheeled walkers (WW) are prescribed routinely
during geriatric rehabilitation. Thus, it is important to analyze
gait characteristics with and without the use of walking aids,
in particular, to assess their clinical benefit. Due to technical
difficulties of external gait assessment strategies, the automated
distinction between the WW track and the spatiotemporal gait
parameters is limited for external motion analysis systems.
Inertial sensors are often used for a mobile and unobtrusive
gait analysis [10], [11]. Various studies report a spatiotemporal
analysis of human gait using gyroscopes only [12]–[15]. From

G

0018-9294 © 2014 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1090

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

gyroscope data, the orientation of the sensor can be determined.
However, accelerometers provide valuable information for spatial parameters, since a double integration of acceleration leads
to distance [16], [17]. Consequently, this additional sensor data
can be used to improve the quality of spatial parameters.
Yet, the double integration amplifies sensor noise, which results in a drift of the signal. To compensate drift, points in time
where the foot is assumed to have no velocity were defined [18],
[19]. The drift can be modeled as a function defined between
these zero velocity points and can be subtracted from the signal. Most of the studies used a linear model [16], [17], [20] for
drift compensation. Mariani et al. [21] showed that a nonlinear
drift model can make stride length more accurate, as it takes
into account that most measurement errors occur during swing
phase. This shows that a sophisticated design of the drift model
is promising. There were no studies so far, which adapted the
drift model to the length of each individual stride.
In the literature, a wide variation of validation procedures
for stride parameter calculation from inertial sensors exist.
An established gold standard for gait parameter calculation is
the instrumented walkway with embedded pressures sensors
GAITRite [7], [8], [14], [22]. The mentioned gait parameters:
stride length, stride time, swing time, and stance time can be
validated by the usage of this system.
In the field of inertial sensor-based stride analysis, one major
problem is the handling of altered gait that is often found in
geriatric patients. The work of Greene et al. [23] shows, for example, that algorithms have difficulties detecting temporal gait
events, like initial contact or terminal contact when shuffling gait
is recorded. Presented methods were validated with young and
healthy subjects [14]–[16], [21], as well as elderly healthy subjects [12]. There are a few studies like [13], [20], where patients
with Parkinsons disease or subjects with joint impairments [24]
were addressed. However, the number of participants here were
less than 21, except [24] who included 42 participants. To investigate the performance in a real-world scenario, it is important
to develop the algorithms on a greater amount of subjects with
gait alternations.
The purpose of the present study was twofold. First, to built
an improved method for the calculation of the parameters stride
length, stride time, swing time, and stance time from a large
amount of altered gait data and with an individualized drift
model. The results were compared to the gold standard system
GAITRite. Second, to show that the mobile gait analysis system
is applicable without interference by the use of walking aids.
To strengthen this importance, we compared the automatically
detected difference in stride length by the inertial sensor-based
gait analysis and by the GAITRite system with and without a
WW. We believe that our validation study describing a mobile
gait analysis system provides the basis for a long-term monitoring of a large cohort of patients with gait impairment during
every day life.
II. METHODS
A. Sensor Platform and Setup
For data collection, the inertial sensor platform Shimmer 2R
[25] was used. It consists of a three-axis gyroscope (range:

Fig. 1.

Placement of the sensor and direction of axes.

±500 ◦ /s) and a three-axis accelerometer (range: ±6 g). Subjects wore shoes with a sensor placed laterally right below each
ankle joint (see Fig. 1). Every subject wore the same shoe model
(adidas Duramo 3) to avoid influences on gait parameters caused
by different shoe models [26], [27]. Data were collected with
a sampling rate of 102.4 Hz, and a resolution of 12 bits. The
x-axis was defined in posterior–anterior direction, y-axis was
in superior–inferior direction, and z-axis was in medio-lateral
direction (see Fig. 1). No manual filtering for accelerometer
and gyroscope signals, and no automatic filtering for the accelerometer signal was applied. However, the Shimmer2R sensor units use an integrated low-pass filter with a cutoff frequency
of 140 Hz for the gyroscope signals. The established analysis
system GAITRite [22], [28] consisting of an electronic walkway containing pressure sensors and a computer with a software
that derived the gait parameters from the sensor signals was defined as the gold standard. The device used in this study had
a sensitive area of 609.60 cm × 60.96 cm, a spatial accuracy
of ±1.27 cm, and a track width of 84 cm. Data were sampled
at 120 Hz and processed using GAITRite Platinum software
version 4.7.1.
B. Data Collection
Data of 116 geriatric inpatients (see Table B1 in the appendix
for most frequent diagnoses) were collected at the Geriatrics
Centre Erlangen (Waldkrankenhaus St. Marien, Erlangen, Germany). In all patients, inertial sensor and GAITRite data were
recorded and analyzed by the same physical therapist (Samuel
Schülein, with ten years of experience in physical therapy and
three years of experience in clinical gait analysis).
Written informed consent was obtained prior to data collection in accordance with the approval by the ethical committee of
the medical faculty of Friedrich-Alexander University ErlangenNürnberg (Re.-No. 4208).
Sixty two percent of the subjects had been using a fourWW for five days or more. Each subject used the same WW
(Bischoff and Bischoff GmbH, Model B) for the trials. The
WW got adjusted by the therapist to the subject’s height, and
every subject was introduced to usage of the walking aid.
The patients performed tests of a detailed geriatric assessment
that took about 1 h. The assessment included, for example, an
orthostatic hypotention test, an eye test, depth sensitivity test,

RAMPP et al.: INERTIAL SENSOR-BASED STRIDE PARAMETER CALCULATION FROM GAIT SEQUENCES IN GERIATRIC PATIENTS

1091

TABLE I
SUBJECT CHARACTERISTICS
Characteristic

Normal walk

WW

N
Sex (m/f)
Age (y)
Height (cm)

101
46 / 55
82.1 ± 6.5
164.0 ± 10.0

84
38 / 46
82.1 ± 6.3
164.0 ± 10.0

Age and height in mean ± standard deviation.

posturography analysis, timed “up and go” test, and a dual task
test. The protocol of the walking tests can be seen in Table A1
in the appendix.
We included data from 1) Normal walking: Subjects passed
10-m distance at their subjective comfortable walking speed
over the GAITRite instrumentation and 2) WW: Subjects repeated test 1) walking with the help of a WW. In both tests,
subjects were asked to walk at save and comfortable speed.
Each subject performed both tests within a time period of several minutes. Subjects that were using a WW for less than five
days (similar to [29]), were asked to walk 1–2 min with the assistive device. No practice trials were performed on the GAITRite
system. During testing time each subject was allowed to rest
for 1–2 min between each trail to avoid symptoms or signs of
fatigue.
Datasets of ten subjects had to be excluded completely—eight
for medical reasons and two for recording errors from inertial
sensor data (malfunction of a sensor). Furthermore, there were
five exclusions in the normal walk test and 23 exclusions in the
WW test due to measurement errors of the GAITRite system.
A measurement error of the GAITRite system was defined as a
stride with a measured stride length being higher than μ + 2σ
or lower than μ − 2σ, where μ is the mean and σ is the standard
deviation of all strides of all subjects. Consequently, we included
101 subjects in the normal walk and 84 subjects in the WW test
(see Table I).
To exclude the gait initiation from the sensor data recordings,
subjects started walking 2 m prior to reaching the electronic
walkway and stopped 2 m beyond it [30]. To establish a relationship between strides derived from the GAITRite system and
strides from inertial sensors, the number of strides a subject took
to reach the carpet were counted and removed manually from
the inertial sensor signals.
C. Stride Segmentation
For stride segmentation, a previously developed algorithm on
the basis of subsequent dynamic time warping was used [31].
To apply the stride segmentation, a template of a single stride
was defined manually from the gyroscope z-axis. To segment
strides, the algorithm searched for parts in the continuous signal that were similar to the template. This approach provided a
method for a time-invariant template matching. The results of
stride segmentation (dashed vertical lines in Fig. 2) were verified manually and corrected if segmentation errors occurred.
In test 1), five (0.4 %) missed strides out of three subjects had
to be inserted and one (0.1 %) stride had to be removed. In

Fig. 2.
signal.

Three segmented strides with TO, HS, and MS events of a typical gait

TABLE II
WW DATA OF 23 EXCLUDED PATIENTS FROM GAITRITE

Strides per subject
Stride length (cm)
Stride time (s)

Without correction

With correction

14.3 ± 4.7
132.1 ± 89.2
3.24 ± 2.20

11.5 ± 1.9
92.1 ± 5.3
1.26 ± 0.08

Table shows parameters before and after manual data correction.
Values are given in mean values ± standard deviation.

test 2), 19 (1.6 %) missed strides out of 14 subjects had to be
inserted.
D. Calculation of Gait Parameters
1) Gait Events: At TO, the movement of the ankle joint
changes from an plantar flexion to a dorsal extension in the
sagittal plane [32]. This change results in a zero crossing of the
gyroscope’s z-axis signal, which was defined as TO [15] (red
cross in Fig. 2).
At HS, the foot decelerates abruptly when the heel hits the
ground. To detect HS, only the segment between the absolute
maximum and the end of the first half of the gyroscope’s z-axis
signal was considered. Within this segment, HS was found by
searching for the minimum between the point of the steepest
negative slope and the point of steepest positive slope in following signal. After that the x-axis of the accelerometer signal was
searched for a minimum (green cross in Fig. 2) in the area 50 ms
before and 20 ms after the described minimum in the gyroscope
signal.
At mid stance (MS), the foot has the lowest velocity. It was
defined to be the middle of the window with the lowest energy
in all axes of the gyroscope signal [19] (blue circle in Fig. 2).
The window size was 140 ms (similar to [19]) and the windows
overlapped by 70 ms.
2) Temporal Gait Parameters: Temporal gait parameters
were calculated on the basis of above mentioned gait events.

1092

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

Borders of the used stride segmentation results were not identical to these gait events and could not directly be used. Therefore,
temporal parameters were defined from two consecutive strides
as defined in the following. Definitions of TO, HS, and MS
were modeled as functions tTO (i), tHS (i), and tM S (i). These
functions delivered the point in time within the stride i, where
the event occurred. To get the results in seconds, each temporal
gait parameter was divided by the sampling frequency fs
StrideTime(i) =

tHS (i + 1) − tHS (i)
fs

(1)

SwingTime(i) =

tHS (i) − tTO (i)
fs

(2)

tTO (i + 1) − tHS (i)
StanceTime(i) =
.
fs

where

and


φ
qx = cos
2

ψ
qz = cos
2

sin

φ
2

(3)

(4)

0 0

(5)

0 0

−ay
−az
−ax
tan ψ = 
.
a2y + a2z

gx (j)

gy (j)

gz (j)]).

q  (j) = q(j − 1) + q̂(j)

(9)

(7)
(8)

(10)



and the interim result q (j) was normalized by its two norm to
fulfill the unit quaternion constraint
q(j) =

q  (j)
.
q  (j)2

(11)

Gravity removal: To remove gravity from the accelerometer
signal a method described in [17] was used. The gravity component of the signal at sample j was described as a vector aG (j).
It was computed by projecting the gravity vector of the world
frame with the orientation quaternions estimated before [17]
aG (j) = q(j) ⊗ [0
aG (j) =

−1

0

0] ⊗ q ∗ (j)

aG
aG 2

(12)
(13)

q ∗ (j) is the conjugate of quaternion q(j) defined as
q ∗ (j) = [q1 (j)

− q2 (j)

− q3 (j)

− q4 (j)]

(14)

over q(j)’s components q1 (j), q2 (j), q3 (j), and q4 (j).
Finally, projected gravity aG (j) was subtracted from sensor measurements aS (j) to get a gravity corrected acceleration
ˆE (j)
vector a
ˆE (j) = aS (j) − aG (j).
a

(15)

ˆE contains
De-drifted integration: The acceleration vector a
drift that occurred when integrating the gyroscope signal. This
drift was modeled by a drift function da (j). The values of y0
and y1 are the mean of the first kn and the last ln samples of
ˆE of the current stride and defined as
the acceleration vector a
1
rnd(kn)

(6)

The angles φ and ψ are rotation angles that describe the displacement between sensor and world frame in rotations around
x- and z-axes. These angles were calculated from the accelerometer signals ax , ay , and az [33, eq. 25f]
tan φ =

1
· (q(j − 1) ⊗ [0
2fs

y0 =



ψ
sin
.
2

q̂(j) =

This rate was added to the previous estimate [35]

3) Spatial Gait Parameter—Stride length: To calculate the
stride length, a double integration of the gravity corrected accelerometer signal was carried out. To minimize sensor drift,
the signal was segmented at MS events assuming that the velocity of the foot is zero at these points. The following section
describes the calculation of the stride length of one single stride
that contains n samples between two subsequent MS events.
Therefore, sample 0 is equal to tM S (i) and sample n is equal to
tM S (i + 1).
Orientation estimation at MS: To describe the orientation of
the sensor, quaternions were used. They depict the mapping
between the sensor frame and the world frame. The y-axis of
the world frame was aligned with the gravity axis of the earth
frame. At MS events, orientation was estimated by using the
accelerometer as a tilt sensor. It was assumed that there is no
movement at this point in time. With this assumption, rotations
around x- and z-axes could be described in context to the world
frame. Due to the parallelism of the y-axis to the gravity vector,
rotation around the y-axis is negligible and assumed to be zero.
A quaternion that describes orientation in context of x- and
z-axes at this time instance was defined as the quaternion product
q = qx ⊗ qz

These equations defined the orientation at one specific MS event.
The next paragraph shows how to get a continuous orientation
for each time point in a stride.
Orientation estimation during stride: Between MS events,
orientation was computed by integrating the gyroscope signals.
The rate of change q̂(j) at sample j was defined as the quaternion
product of a previously estimated orientation q(j − 1) and the
current angular rates gx (j), gy (j), gz (j) scaled with fs [34]

y1 =

1
rnd(ln)



rnd(kn)−1

âE (j)

(16)

j =0
n


âE (j)

(17)

j =n −rnd(ln)+1

where rnd() is the round function. Between these plateaus, the
drift function interpolates a straight line
⎧
y0 ,
if j ≤ rnd(k · n)
⎪
⎪
⎨
if j ≥ n − rnd(l · n)
da (j) = y1 ,
⎪
⎪
⎩y + (y − y ) j −k , else.
0

1

0 n −l−j

(18)

RAMPP et al.: INERTIAL SENSOR-BASED STRIDE PARAMETER CALCULATION FROM GAIT SEQUENCES IN GERIATRIC PATIENTS

1093

TABLE III
RESULTS OF OUR INERTIAL SENSOR-BASED SYSTEM (INERTIAL SENSORS) ARE COPARED TO THE RESULTS OF THE GOLD STANDARD (GAITRITE)
Test

Parameter

Unit

Inertial sensors

GAITRite

Mean error

Abs. error

CC

n

Normal
walk

Stride time
Swing time
Stance time
Stride length

s
s
s
cm

1.227 ± 0.189
0.364 ± 0.068
0.863 ± 0.154
79.76 ± 24.25

1.226 ± 0.189
0.372 ± 0.081
0.854 ± 0.161
80.02 ± 23.41

0.002 ± 0.068
−0.008 ± 0.045
0.009 ± 0.069
−0.26 ± 8.37

0.029 ± 0.062
0.025 ± 0.038
0.033 ± 0.061
6.26 ± 5.56

0.95
0.90
0.95
0.93

1220 strides
101 subjects

Stride time
Swing time
Stance time
Stride length

s
s
s
cm

1.239 ± 0.181
0.405 ± 0.057
0.833 ± 0.141
96.52 ± 18.07

1.233 ± 0.197
0.405 ± 0.076
0.828 ± 0.157
98.51 ± 16.83

0.006 ± 0.084
0.000 ± 0.046
0.006 ± 0.083
-1.99 ± 11.87

0.030 ± 0.079
0.023 ± 0.040
0.030 ± 0.077
8.27 ± 8.75

0.95
0.89
0.94
0.80

797 strides
84 subjects

WW

Quality of the measurement is denoted as the difference of the measured values (mean error), the mean of the absolute error (abs. error),
and Spearman correlation coefficient (CC). Results, mean error, and abs. error are given as mean ± standard deviation.

In this study, the length of y0 was defined empirical as 4% (k =
0.04), and the length of y1 was defined as 2% (l = 0.02) of the
current stride length.
A drift compensated acceleration signal was computed by
ˆE (j)
subtracting the drift from the estimate a
ˆE (j) − da (j).
aE (j) = a

(19)

By integrating this acceleration signal, a velocity estimate

 n
aE (j) dj
(20)
vˆ(j) =
0

was calculated. Integration of the discrete signal values was
accomplished using the trapezoidal rule.
To eliminate the drift from the integration of the accelerometer
signal, the effect of the zero velocity assumption was used. The
zero velocity assumption is shown by Peruzzi et al. [18] and says
that on each MS event, the velocity is zero v (0) = v (n) = 0.
Hence, the estimate vˆ(n) describes the drift accumulated by
integration.
This drift was modeled as a straight line between the origin
and the mean of the last five integrated points
y1
dv (j) = j
n
n
1  ˆ
y1 =
v (j).
5 j =n −4

(21)
(22)

Again, drift was compensated by subtraction
v (j) = v̂(j) − dv (j).

(23)

After that, the position of the sensor was calculated by trapezoidal integration of the velocity

 n
v (j) dj.
(24)
p(j) =
0

Finally, the stride length was defined as the two norm of a 2-D
vector containing the distance in x- and z-direction at the end of
the stride



 px (n) 

 = px (n)2 + pz (n)2 .
SL = 
(25)
pz (n) 2

E. Evaluation Strategy
The precision of our method was quantified by the measures
accuracy, absolute error, and correlation coefficient.
Accuracy was defined as mean and standard deviation over the
signed difference of each stride. This measure shows if results
of the evaluated method tend to be smaller or larger compared to
the gold standard. Due to cancellation of negative and positive
values, it cannot quantify the discrepancy between gold standard
and results of the evaluated method.
The absolute error was defined as mean and standard deviation
over the absolute difference of each stride. It quantifies the
discrepancy between gold standard and evaluated method in
absolute values.
The correlation coefficient quantifies the statistical dependence between the results of the evaluated method and the gold
standard. For this evaluation, we used the Spearman correlation
coefficient as it is more robust against outliers.
Furthermore, the results were visualized with Bland–Altman
plots [36]. These plots show the mean of the measurement on
the x-axis and the differences of the measurements on the yaxis. It also shows a dashed line at ±1.96σ—so 95% of the
measurements are within these two bounds.
III. RESULTS
Table III shows evaluation results of the presented method.
Temporal parameters could be estimated with an absolute
error ≤33 ms in both tests. Spearman correlation between results
of our method and results of the gold standard was ≥0.94 for
stride time and stance time, and ≥0.89 for swing time. stride
length could be calculated with 6.27-cm mean absolute error
and correlation 0.93 in normal walk, and 8.27-cm mean absolute
error and correlation 0.80 in the WW test.
Fig. 3 shows Bland–Altman plots comparing the two measurement results. In both tests, accuracy of temporary parameters suffered from outliers, while most differences of stride
length were within the 1.96σ line.
Both systems showed, in tests for statistical significance, that
the stride length increased significantly when subjects used a
WW (see Fig. 4, p < 0.0001). Furthermore, both systems showed
that stance time decreased and swing time increased significantly
(p < 0.004). No significant difference was shown in stride time
(see Table III, p > 0.42).

1094

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

Fig. 4. Scatter plot comparing results of both systems in both tests. Both
systems showed that the stride length increased significantly when subjects
used a WW (p < 0.0001).

Fig. 5. GAITRite recorded the tracks of the walking aid [see Fig. 5(a)] additionally to the strides of the subject. When using the automatic removal tool
of the GAITRite software, those tracks caused errors in the stride parameter
calculation. For that reason the tracks were removed manually [see Fig. 5(b)].
(a) GAITRite signal containing tracks of the WW. (b) GAITRite signal after
manual removed tracks of the WW.

IV. OUTLIER ANALYSIS OF GAITRITE DATA

Fig. 3. Bland–Altman plots of the evaluation results. The x-axis shows the
arithmetic mean of results of our method and the gold standard, the y-axis shows
the difference between the results. The dashed line in the middle is the arithmetic
mean of the differences, the lines above and below denote 1.96σ (σ = standard
deviation), where 95% of the differences are in between. (a) Normal walk. (b)
WW.

Both systems showed a substantial increase in stride length in
the group that used a WW compared to the normal walk group
(see Fig. 4, p < 0.0001). Stance and swing time could also be
analyzed in both groups and showed decreased/increased values
in the WW group for all strides (p < 0.004). No significant
difference was found for stride time (see Table III, p > 0.42).

Due to errors in the measurements of the gold standard system, 23 datasets of the WW data were excluded from the analysis. As the main focus was on stride length calculation, an
outlier and measurement error was defined as a stride length
with a difference higher than 2σ from the mean over all strides
of all subjects.
A detailed analysis of these outliers showed that the tracks
from the WW caused these errors [see Fig. 5(a)]. After manual removal of the tracks [see Fig. 5(b)], gait parameters were
recalculated and are shown in Table II.
The main difference can be observed in the standard deviation.
Especially for stride length, the standard deviation decreased
after recalculation by a factor of 16.
V. DISCUSSION
This study described a method to calculate clinically relevant
gait parameters using inertial sensors. The method was validated
by comparing results to measurements of the valid gold standard

RAMPP et al.: INERTIAL SENSOR-BASED STRIDE PARAMETER CALCULATION FROM GAIT SEQUENCES IN GERIATRIC PATIENTS

GAITRite [22], [28]. The inertial sensor system was able to
measure and analyze the same indications of gait alternation as
the gold standard.
Mariani et al. [21] calculated stride length with a similar
correlation (0.96), but a lower standard deviation of the mean
error (1.5 ± 6.8 cm). Compared to Salarian et al. [13], stride
length was similar (mean error: 3.5 ± 8.5 cm), but their method
was more accurate in stride time (mean error: 0.0022 ± 0.0232 s)
and stance time (mean error: 0.0059 ± 0.0296 s). This accuracy
was achieved by using six gyroscopes, which is not applicable
for a non stigmatizing day-by-day long-time monitoring system.
Doheny et al. [14] calculated stride length using two gyroscopes
placed on the shank (mean error: 9 ± 7 cm), but they already
discussed that their method could have problems with altered
gait.
In general, comparison with results from other studies is difficult because there are various statistical measures which cannot
be compared with each other. Moreover, the source of the analyzed data was very diverse ([14] had young, [13] had old
subjects, [14], [21] had healthy subjects, and [13] had patients
as well as healthy controls) and the number of subjects differed
(from 7 to 20). To improve the comparability in the future, we
published our data on the Internet (http://www.activitynet.org).
We invite other studies to run their algorithm on the published
data and calculate the validation parameters suggested in our
study.
Stride segmentation was achieved using a previously published method [31]. There were some erroneously detected
strides that had to be corrected by hand. This step was necessary
to ensure clearly initial conditions, namely correctly segmented
data, because stride segmentation was not at the focus of this
study.
In order to calculate the important gait events during one
stride, methods out of the literature were used for TO and MS
calculation [15], [19], [32]. For detecting HS, previous studies
showed that this event is just before the change in angular velocity between swing and stance phase [15]. While other studies
used the gyroscope signal solely, we used the accelerometer
signal as an additional source of information. A HS always
causes a deceleration of the foot, which results in a peak in the
accelerometer signal, and should therefore be a more accurate
estimation of this event. To make HS detection more robust,
we considered just the relevant part of the signal. As the swing
phase lasts 40% of a stride [32], it is sufficient to search in the
first half of the stride’s signal. Moreover, it is obvious that the
HS event occurs after the mid swing event, which can be easily detected as the absolute maximum of the gyroscope’s z-axis
signal [13]. However, with the signal of one particular subject,
HS detection still caused problems, which shows up as outliers
in the temporal parameter plots of Fig. 3.
The window size for MS detection was derived from an assumed common stride time of 1s, where the MS phase lasts
19 % of a stride [37]. Since MS occurs during a small ammount
of time, a smaller window size is sufficient. However, the actual
ammount of the window size for MS as well as the window
size for HS detection were adapted to our data and need further
evaluation for generalization.

1095

For the intermediate task of orientation estimation and gravity
removal of the accelerometer signal, a quaternion-based calculation was used. This method had the advantages compared to
Euler angles that it required less computational operations as
well as avoided the problem of a gimbal lock [34].
To compensate the drift that appears in gyroscope integration,
a piece-wise defined linear function was used. This function
takes into account that the foot is assumed to stand still at the
beginning and end of every stride. In contrast to all other studies
that used a static function to model drift, we adapted the drift
function individually to every single stride. This approach is very
promising as it takes into account that most drift occurs during
swing phase and the duration of the swing phase depends on the
duration of the whole stride.
Furthermore, the calculation of stride length is based on the
assumption that a foot has zero velocity at a specific point in
time during stride. In reality, velocity reaches minimum at this
point [18]. Results tend to get better when setting the velocity
not to zero but to a small amount when resetting the integration.
This relationship should be examined in a separate study where
subjects walk at different paces, since it can be assumed that the
relationship is highly dependent on the gait speed.
Results of the validation procedure of our system compared
to the gold standard GAITRite showed that the absolute differences and also the correlation coefficients are comparable
to the literature [15], [21]. Together with the high number of
subjects and their advanced age, it can be supposed that the
method is applicable in geriatric medicine. Since it works for
altered gait, it can also be assumed that the developed method is
usable in a lot of other settings, for example, analyzing gait disorders in general or searching for indicators of an increased fall
risk.
The presented method also tracked sensor’s orientation for
gravity removal using quaternions. These quaternions made it
possible to quantify angles between foot and floor during the
complete stride and for example, at the HS and TO events. As
the GAITRite system is not able to measure angles, there is no
validation for these parameters so far.
However, the time of double support is also an important
parameter in clinical gait analysis [7]. So far, there is no synchronization between left and right sensor in the used measurement system. Consequently, it is not possible to calculate the
double-support time. This would be a necessary improvement
for further studies with the described sensor system.
Another aspect of the study was to show that the developed
system was able to quantify clinically relevant differences in
gait parameters. As a concrete example, the parameters from
both systems were compared for normal walk and walk with a
walking aid. Results of our system as well as results of the gold
standard system showed a significant increase of the parameters
stride length, stride time, and swing time when subjects used a
WW.
However, the use of walking aids interfered with the correct
automated detection of gait parameters in the GAITRite system.
Our study showed that the WW influences the measurement of
stride parameters by the automated GAITRite analysis setup. In
particular, the stride length was longer than 200 cm in individual

1096

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

cases. Therefore, we analyzed outliers based on the stride length.
However, further outliers showed up in temporal parameters,
which were not detected by the outlier analysis. In the WW trial,
eight strides from six subjects can be assumed to be errors that
were caused by GAITRite. In seven strides, the swing time was
<0.01s, in one stride it was >0.7s. Furthermore, five strides from
one subject in normal walk and two strides from two subjects
in the WW trial caused outliers due to improper HS detection.
An implementation of the presented method could detect these
outliers and exclude them from the further analysis.
Results in Table II show that after manual data correction, the
standard deviation decreased by a factor of 16, indicating more
stable results. This time-consuming recalculation is not required
if an inertial sensor-based system is used, where the sensor is
directly fixed on the shoe. The quantification of clinical relevant
parameters makes the usage of an inertial sensor-based system
reliably and beneficial for daily use in geriatric medicine.
We ensured that the WW was setup and used correctly because
it is known that gait is influenced by a not correctly set up
walking aid [38]. Experience of WW use also influences gait
parameters [29], [39]. Accordingly, we found differences in
the averaged stride parameters when comparing normal walk
to WW supported walking. This underlines the applicability of
inertial sensor-based gait analysis in clinical gait diagnostics.
Future studies will decipher the influence of additional clinical
parameters and subgroup analysis of different patient cohorts
(e.g., used, versus not used to WW, fallers versus nonfallers) on
the gait parameter changes by walking aids.
An enormous advantage of the introduced mobile gait analysis system, is the possibility to record a very large number of
strides over a long period of time. A specialized environment
like a laboratory is not required and a measurement can be done
on nearly everywhere. The usage of walking aids like WW does
not influence the calculation of results of our system.
The presented algorithm can be implemented into a recording software running on a mobile device (for example a tablet
computer). This allows a mobile and simple to use gait lab
concept providing objective gait parameters without complex
postprocessing of the data. It is also applicable in standard inand outpatient units that do not have complex equipped motion
laboratories.

VI. CONCLUSION
We presented a method that is able to calculate clinically
relevant gait parameters from inertial sensor data of gait sequences. It was shown that the algorithm yields proper results
when applying it on altered gait that is typically for geriatric
patients.
To improve comparability with other studies, we published
our data (http://www.activitynet.org) and invite other studies to
apply their method on our data.
In the future, the sensor should be integrated in the shoe to
give the possibility of a data recording over at least a complete
day. This would give the possibility for a detailed long-term gait
monitoring.

APPENDIX A
TEST PROTOCOL
Table A1 shows the whole test protocol. Data of the bold
marked trials (4 and 7) were used for this study.
TABLE A1
PROTOCOL OF TESTS PERFORMED BY EACH SUBJECT
#

Trial

Description

1

heel-toe-tapping

2

timed up-and-go

3

drawing circles

4

normal walk

5

dual tasking

6

walk and turn

7

WW

Subject sits on a chair
and has to tap heel and
toe alternatively.
Subject has to stand up
from a chair, walk around
a pylon and sit down
again.
Subject sits on a chair
and has to draw circles
with the foot just above
the ground.
Subject has to walk in a
self-selected,
comfortable speed over
the GAITRite carpet
without any help.
Subject has to enumerate
months of a year in
reverse order while
walking over the
GAITRite carpet.
Subject has to walk 10 m,
then turn in the direction
the instructor tells, walk
back to start and turn
again in a told direction.
Subject has to walk in a
self-selected,
comfortable speed over
the GAITRite carpet
with the help of a WW.

In this study, datasets of the tests “normal walk” and “WW” were analyzed.

APPENDIX B
MOST FREQUENT DIAGNOSES
TABLE B1
MOST FREQUENT DIAGNOSES OF SUBJECTS
Position
1
2
3
4
5
6
7
8
9
10

Diagnose

Percent

heart rhythm disorder
arterial hypertension
gait disorders/fall proneness
coronary artery disease
hypercholesterolemia/dislipedemia
cardiac valve disorder
kidney disease
diabetes mellitus
degenerative spine disorder
heart failure

69.92
69.11
53.66
40.65
26.83
26.02
21.95
20.33
20.33
20.33

ACKNOWLEDGMENT
The authors would like to thank Prof. J. Winkler, Department of Molecular Neurology, Friedrich-Alexander University Erlangen-Nürnberg, for support of this study. They would

RAMPP et al.: INERTIAL SENSOR-BASED STRIDE PARAMETER CALCULATION FROM GAIT SEQUENCES IN GERIATRIC PATIENTS

also like to thank all the participants of this study, for their
contributions.
REFERENCES
[1] N. Giladi, F. B. Horak, and J. M. Hausdorff, “Classification of gait disturbances: Distinguishing between continuous and episodic changes,” Mov.
Disorders, Off. J. Mov. Disorder Soc., vol. 28, no. 11, pp. 1469–1473,
2013.
[2] J. A. Block and N. Shakoor, “ The biomechanics of osteoarthritis: Implications for therapy,” Current Rheumatol. Rep., vol. 11, no. 1, pp. 15–22,
2009.
[3] C. Nı́Scanaill, S. Carew, P. Barralon, N. Noury, D. Lyons, and G. M.
Lyons, “A review of approaches to mobility telemonitoring of the elderly
in their living environment,” Ann. Biomed. Eng., vol. 34, no. 4, pp. 547–
563, 2006.
[4] B. Maki, “Gait changes in older adults: Predictors of falls or indicators of
fear,” J. Amer. Geriatr. Soc., vol. 45, no. 3, pp. 313–320, 1997.
[5] J. M. Hausdorff, D. A. Rios, and H. K. Edelberg, “Gait variability and fall
risk in community-living older adults: A 1-year prospective study,” Arch.
Phys. Med. Rehabil., vol. 82, no. 8, pp. 1050–1056, 2001.
[6] J. Hausdorff, “Gait dynamics, fractals and falls: Finding meaning in the
stride-to-stride fluctuations of human walking,” Human Mov. Sci., vol. 26,
no. 4, pp. 555–589, 2007.
[7] R. W. Kressig, R. J. Gregor, A. Oliver, D. Waddell, W. Smith, M. O’Grady,
A. T. Curns, M. Kutner, and S. L. Wolf, “Temporal and spatial features of
gait in older adults transitioning to frailty,” Gait Posture, vol. 20, no. 1,
pp. 30–35, 2004.
[8] J. Verghese, R. Holtzer, R. B. Lipton, and C. Wang, “Quantitative gait
markers and incident fall risk in older adults,” J. Gerontol. Ser. A, Biol.
Sci. Med. Sci., vol. 64A, no. 8, pp. 896–901, 2009.
[9] U. Givon, G. Zeilig, and A. Achiron, “Gait analysis in multiple sclerosis: Characterization of temporal-spatial parameters using GAITRite
functional ambulation system,” Gait Posture, vol. 29, no. 1, pp. 138–142,
2009.
[10] J. Klucken, J. Barth, P. Kugler, J. Schlachetzki, T. Henze, F. Marxreiter, Z.
Kohl, R. Steidl, J. Hornegger, B. Eskofier, and J. Winkler, “Unbiased and
mobile gait analysis detects motor impairment in Parkinson’s disease,”
PLoS ONE, vol. 8, no. 2, p. e56956, 2013.
[11] J. Barth, M. Sünkel, K. Bergner, G. Schickhuber, J. Winkler, J. Klucken,
and B. Eskofier, “Combined analysis of sensor data from hand and gait
motor function improves automatic recognition of Parkinson’s disease,” in
Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., 2012, pp. 5122–5125.
[12] K. Aminian, B. Najafi, C. Büla, P.-F. Leyvraz, and P. Robert, “Spatiotemporal parameters of gait measured by an ambulatory system using
miniature gyroscopes,” J. Biomech., vol. 35, no. 5, pp. 689–699, 2002.
[13] A. Salarian, H. Russmann, F. J. G. Vingerhoets, C. Dehollain, Y. Blanc,
P. R. Burkhard, and K. Aminian, “Gait assessment in Parkinson’s disease:
Toward an ambulatory system for long-term monitoring,” IEEE Trans.
Bio-Med. Eng., vol. 51, no. 8, pp. 1434–1443, Aug. 2004.
[14] E. P. Doheny, T. G. Foran, and B. R. Greene, “A single gyroscope method
for spatial gait analysis,” in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol.
Soc., 2010, pp. 1300–1303.
[15] A. Mannini and A. M. Sabatini, “A hidden Markov model-based technique
for gait segmentation using a foot-mounted gyroscope,” in Proc. IEEE
Annu. Int. Conf. Eng. Med. Biol. Soc., 2011, pp. 4369–4373.
[16] A. Sabatini, C. Martelloni, S. Scapellato, and F. Cavallo, “Assessment of
walking features from foot inertial sensing,” IEEE Trans. Bio-Med. Eng.,
vol. 52, no. 3, pp. 486–494, Mar. 2005.
[17] A. Sabatini, “Quaternion-based strap-down integration method for applications of inertial sensing to gait analysis,” Med. Biol. Eng. Comput., vol.
43, pp. 94–101, 2005.
[18] A. Peruzzi, U. DellaCroce, and A. Cereatti, “Estimation of stride length
in level walking using an inertial measurement unit attached to the foot:
A validation of the zero velocity assumption during stance,” J. Biomech.,
vol. 44, no. 10, pp. 1991–1994, 2011.
[19] I. Skog, P. Händel, J.-O. Nilsson, and J. Rantakokko, “Zero-velocity detection in pedestrian navigation systems—An algorithm evaluation,” Biomed.
Eng., vol. 57, no. 11, pp. 2657–2666, 2010.
[20] S. J. M. Bamberg, A. Y. Benbasat, D. M. Scarborough, D. E. Krebs,
and J. A. Paradiso, “Gait analysis using a shoe-integrated wireless sensor
system,” IEEE Trans. Inf. Technol. Biomed., vol. 12, no. 4, pp. 413–423,
Jul. 2008.

1097

[21] B. Mariani, C. Hoskovec, S. Rochat, C. Büla, J. Penders, and K. Aminian,
“3D gait assessment in young and elderly subjects using foot-worn inertial
sensors,” J. Biomech., vol. 43, no. 15, pp. 2999–3006, 2010.
[22] A. McDonough, M. Batavia, F. C. Chen, S. Kwon, and J. Ziai, “The validity
and reliability of the GAITRite system’s measurements: A preliminary
evaluation,” Arch. Phys. Med. Rehabil.., vol. 82, no. 3, pp. 419–425,
2001.
[23] B. R. Greene, D. McGrath, R. O’Neill, K. J. O’Donovan, A. Burns, and
B. Caulfield, “An adaptive gyroscope-based algorithm for temporal gait
analysis,” Med. Biol. Eng. Comput., vol. 48, no. 12, pp. 1251–1260, 2010.
[24] B. Mariani, H. Rouhani, X. Crevoisier, and K. Aminian, “Quantitative
estimation of foot-flat and stance phase of gait using foot-worn inertial
sensors,” Gait Posture, vol. 37, no. 2, pp. 229–234, 2013.
[25] A. Burns, B. R. Greene, M. J. McGrath, T. J. O’Shea, B. Kuris, S. M. Ayer,
F. Stroiescu, and V. Cionca, “SHIMMER—A wireless sensor platform for
noninvasive biomedical research,” IEEE Sensors J., vol. 10, no. 9, pp.
1527–1534, Sep. 2010.
[26] J. C. Menant, J. R. Steele, H. B. Menz, B. J. Munro, and S. R. Lord,
“Optimizing footwear for older people at risk of falls,” J. Rehabil. Res.
Develop., vol. 45, no. 8, pp. 1167–1181, 2008.
[27] J. C. Menant, J. R. Steele, H. B. Menz, B. J. Munro, and S. R. Lord, “Effects
of walking surfaces and footwear on temporo-spatial gait parameters in
young and older people,” Gait Posture, vol. 29, no. 3, pp. 392–397, 2009.
[28] K. E. Webster, J. E. Wittwer, and J. a. Feller, “Validity of the GAITRite
walkway system for the measurement of averaged and individual step
parameters of gait,” Gait Posture, vol. 22, no. 4, pp. 317–321, 2005.
[29] K. Lucki, M. Bach, W. Banzer, and L. Vogt, “Walker use affects Timed
Up and Go and gait speed measures,” J. Amer. Geriatr. Soc., vol. 57,
no. 10, pp. 1963–1965, 2009.
[30] R. W. Kressig, O. Beauchet, E. Gaitrite, and N. Group, “Guidelines for
clinical applications of spatio-temporal gait analysis in older adults,” Aging Cli. Exp. Res., vol. 18, no. 2, pp. 174–176, 2006.
[31] J. Barth, C. Oberndorfer, P. Kugler, D. Schuldhaus, J. Winkler, J. Klucken,
and B. Eskofier, “Subsequence dynamic time warping as a method for
robust step segmentation using gyroscope signals of daily life activities,”
in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., 2013, pp. 6744–6747.
[32] D. Beckers and J. Deckers, Ganganalyse und Gangschulung. Berlin,
Germany: Springer, 1997, p. 297.
[33] M. Pedley. (2013). Tilt sensing using linear accelerometers.
[Online]. Available: http://www.freescale.com/files/sensors/doc/app_
note/AN3461.pdf
[34] J. Cooke, M. Zyda, D. Pratt, and R. Mcghee, “NPSNET: Flight simulation
dynamic modeling using quaternions,” Presence, vol. 1, no. 4, pp. 404–
420, 1994.
[35] S. Madgwick, A. Harrison, and A. Vaidyanathan, “Estimation of IMU and
MARG orientation using a gradient descent algorithm,” in Proc. IEEE Int.
Conf. Rehabil. Robot., 2011, pp. 1–7.
[36] J. Bland and D. Altman, “Statistical methods for assessing agreement
between two methods of clinical measurement,” Lancet, vol. 1, no. 8476,
pp. 307–310, 1986.
[37] M. W. Whittle, Gait Analysis: An Introduction, 3rd ed. Burlington MA,
USA: Butterworth-Heinemann, 2001.
[38] H. H. Liu, “Assessment of rolling walkers used by older adults in seniorliving communities,” Geriatr. Gerontol. Int., vol. 9, no. 2, pp. 124–30,
2009.
[39] M. Schwenk, M. Schmidt, M. Pfisterer, P. Oster, and K. Hauer, “Rollator
use adversely impacts on assessment of gait and mobility during geriatric
rehabilitation,” J. Rehab. Med., Off. J. UEMS Eur. Board Phys. Rehabil.
Med., vol. 43, no. 5, pp. 424–429, 2011.

Authors’ photographs and biographies not available at the time of publication.

