IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

471

Surface EMG Decomposition Based on K-means
Clustering and Convolution Kernel Compensation
Yong Ning, Xiangjun Zhu, Shanan Zhu, and Yingchun Zhang, Senior Member, IEEE

Abstract—A new approach has been developed by combining
the K-mean clustering (KMC) method and a modified convolution
kernel compensation (CKC) method for multichannel surface electromyogram (EMG) decomposition. The KMC method was first
utilized to cluster vectors of observations at different time instants
and then estimate the initial innervation pulse train (IPT). The
CKC method, modified with a novel multistep iterative process,
was conducted to update the estimated IPT. The performance of
the proposed K-means clustering—Modified CKC (KmCKC) approach was evaluated by reconstructing IPTs from both simulated
and experimental surface EMG signals. The KmCKC approach
successfully reconstructed all 10 IPTs from the simulated surface
EMG signals with true positive rates (TPR) of over 90% with a
low signal-to-noise ratio (SNR) of −10 dB. More than 10 motor
units were also successfully extracted from the 64-channel experimental surface EMG signals of the first dorsal interosseous (FDI)
muscles when a contraction force was held at 8 N by using the KmCKC approach. A “two-source” test was further conducted with
64-channel surface EMG signals. The high percentage of common
MUs and common pulses (over 92% at all force levels) between
the IPTs reconstructed from the two independent groups of surface EMG signals demonstrates the reliability and capability of the
proposed KmCKC approach in multichannel surface EMG decomposition. Results from both simulated and experimental data are
consistent and confirm that the proposed KmCKC approach can
successfully reconstruct IPTs with high accuracy at different levels
of contraction.
Index Terms—Convolution kernel compensation (CKC), innervation pulse train (IPT), K-means clustering, motor unit, surface
EMG.

I. INTRODUCTION
NCOURAGED by highly successful achievements [1]–
[7] in the decomposition of indwelling electromyograms
(EMG) signals, various approaches have been developed over
the past years to decompose surface EMG signals into their
constituent motor unit action potential (MUAP) trains [8]–[10].
However, surface EMG signal decomposition presents many
technical challenges [10], e.g., shape changes across different

E

Manuscript received December 12, 2013; revised April 6, 2014; accepted
May 24, 2014. Date of publication June 2, 2014; date of current version
March 2, 2015. This work was supported in part by NIH K99DK082644,
NIH R00DK082644, University of Houston and NSF of Zhejiang Province of
China (LY13F010010).
Y. Ning and S. Zhu are with the College of Electrical Engineering,
Zhejiang University, Hangzhou, Zhejiang 310027, China (e-mail: ningyong0816@126.com; zsa@zju.edu.cn).
X. Zhu is with the Zhijiang College, Zhejiang University of Technology,
Hangzhou, Zhejiang 310027, China (e-mail: zxjsd@hotmail.com).
Y. Zhang is with the Department of Biomedical Engineering, University of
Houston, Houston, TX 77204, USA (e-mail: yzhang94@uh.edu).
Color versions of one or more of the figures in this paper are available online
at link http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2328497

action potentials from each motor unit (MU), similarities of
shape at various times among the action potentials of different
MUs, the large dynamic range of amplitudes present among the
action potentials of different interested MUs, and the overlap
of action potentials from different MUs. These phenomena may
also present together to make the surface EMG decomposition
task even more difficult.
Recently, multichannel amplifiers and high-density surface
electrode grids which can partially solve aforementioned problems have become available for the noninvasive recording of
human motor units [11]. Subsequently, a variety of techniques,
including pattern recognition and blind source separation (BSS),
that are capable of handling the multichannel surface EMG data
have also been developed [12]–[14]. Kleine et al. [15] investigated the importance of 2-D spatial filters in decomposing
surface EMG signals, and the presented results demonstrate
that the proposed 2-D spatial filtering approach can detect the
firing times of MUs with a high level of accuracy, but has difficulty in separating MUs with identical MUAP shapes. Gazzoni
et al. [16] utilized a classification and template matching segmentation technique to extract and classify single MUAPs and
further investigated the anatomical and physiological properties of the detected MUs. The main limitation of this method
is that it is difficult to obtain complete firing patterns due to
the superposition of MUAPs. Garcia et al. [17] modeled surface EMG signals as an instantaneous mixture of MUAP trains
in order to separate MUs and claimed that they could successfully solve overlaps of MUAPs, even at 60% maximum voluntary contraction (MVC), by combining the preprocessing filters,
independent component analysis, and template-matching techniques. Holobar and Zazula proposed both a convolution kernel
compensation (CKC) method [18] and latterly a gradient convolution kernel compensation method (GCKC) [19] to handle
convolution mixtures of innervation pulse trains (IPTs). The
CKC method estimates the IPTs directly without calculating
the unknown mixing matrix, and results show that more than
30 concurrently active MUs can be extracted from multichannel
surface EMG signals with good quality [19]. This CKC method,
however, is mainly applied in the case of relatively low force
contractions for better results [20], [21]. The GCKC method
has been demonstrated in previous studies to perform with high
accuracy and noise robustness in decomposing surface EMG
signals [19], but it has a requirement for the length of the signal to converge when a certain gradient-based update rule is
utilized [22].
In this study, a new hybrid surface EMG decomposition
approach (KmCKC) was successfully developed by combining the K-means clustering (KMC) method and the CKC

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

472

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

method modified with a novel multistep iteration strategy to
further improve the efficiency, noise robustness, and accuracy
of multichannel surface EMG decomposition.

A solution can then be achieved via (3) for the decomposition
of a linear and convolution mixture of IPTs.
In order to improve sn 0 (n), X̄(n0 ) in (3) is replaced with the
average value CX̄ sj [18],

II. METHODS
CX̄ sj =

A. K-Means Clustering Method, Data Model,
and Convolution Kernel Compensation
The KMC method is employed in the proposed KmCKC approach for data clustering. If a set of data and the number of
clusters were given, the data would be repeatedly put into different groups by the KMC by evaluating a distance function. The
clustering criterion adopted in the KMC is the distance between
two elements within the same group. A two-stage iterative algorithm [23] is used also to minimize the sum of point-to-center
distances over all clusters.
Given a linear time-invariant (LTI) multiinput multioutput
(MIMO) system, the equation of CKC model can be stated as
[18], [19], [24]:
X(n) = H s̄(n) + e(n)

(1)

T

where X(n) = [x1 (n), . . . , xM (n)] is the group of M convolution observations and xj (n) is the nth sample of the jth
observation. e(n) = [e1 (n), . . . , eM (n)]T is a vector of temporally and spatially zero mean white noise
s̄(n) = [s1 (n), s1 (n − 1), . . . , s1 (N − P + 1), . . . ,
sN (n), sN (n − 1), . . . , sN (n − P + 1)]T
is an extended form of N sources s(n) = [s1 (n), . . . , sN (n)]T
and H is the mixing matrix, which consists of all of the channel
responses hij = [hij (0), . . . , hij (P − 1)] (the jth source in surface EMG signals appearing in the ith measurement) of length
P samples.
In order to improve the knowns-to-unknowns ratio, the model
(1) is extended with K–1 delayed repetitions of each original
observation [18], [19]:
X̄(n) = [x1 (n), x1 (n − 1), . . . , x1 (n − K + 1), . . . ,
xM (n), xM (n − 1), . . . , xM (n − K + 1)]T .
Adopting the extended form X̄(n) and the model from (1),
an activity index of global pulse train can be written as [18],
[19]:
−1
X̄(n)
γ(n) = X̄ T (n)CX
X

(2)

where CX X stands for the correlation matrix of the extended
observationsX̄(n), and T and −1 stand for transpose and inverse, respectively. Suppose the premultiplying vector X̄(n0 ) is
fixed in (2) to the sampling time n0 , and the expression can be
rewritten as [18]:
−1
X̄(n).
sn 0 (n) = X̄ T (n0 )CX
X

(3)

It has been proven that if only the jth source is active in time
instant n0 , sn 0 (n) yields the estimation of the IPT of the jth
source [18]:
sn 0 (n) ≈ s̄j (n).

(4)


1
X̄(ϕn )
card(ϕn )

(5)

where ϕn = {n0 , n1 , . . . , nm } denotes a set of firing times of
the jth MU, and card(ϕn ) denotes the cardinal number of ϕn .
B. KmCKC Method
A pulse train sn 0 was first estimated using time instant n0 according to (3), where a pulse was randomly selected and denoted
by n1 —the time of its occurrence [18]. Then, a new pulse train
sn 1 is obtained by using (3). According to [18], there should
be one pulse train denoted by sj which is active in pulse train
sn 1 . Some of the time instants (usually 30–60 time instants)
associated with the highest peaks can then be selected from
sn 1 and denoted by ϕn c = {nc1 , nc2 , . . . , nck }, where these
instants are usually generated by one or more MUs. The observations X̄(n) corresponding to ϕn c can then be classified into
groups (usually 2–4 groups are classified) by using the KMC.
The group which contains the largest number of elements will
be selected and the time instants in this group will be denoted
by ϕn v = {nv 1 , nv 2 , . . . , nv n }, where most of time instants
in ϕn v should be fired by one MU in general. Then, an initial
pulse train ˆs̄j 0 can be estimated from the observations X̄(n)
corresponding to ϕn v . Usually the initially estimated pulse train
is not acceptable in cases with a low signal to noise ratio (SNR).
Hence, the multistep iteration as described below is necessary
to improve the pulse train. The detailed algorithm steps are
depicted below.
Step 1: Compute the correlation matrix of observations CX̄ X̄
and the associated inverse matrix.
Step 2: Compute γ(n) and n0 = median(γ(n)) with (2) and
arg

compute sn 0 with (3) [18]; find the maximum value in sn 0 , its
time of occurrence n1 , and reconstruct sn 1 according to (3).
Identify k time instants corresponding to the highest peaks in
sn 1 , denoted by ϕn c = {nc1 , nc2 , . . . , nck }.
Step 3: X̄(nci ), nci ∈ ϕn c are clustered into groups by using the KMC method. The group which contains the largest
number of elements, denoted by ϕn v = {nv 1 , nv 2 , . . . , nv n },
is then selected. According to (5), the observations X̄(n)
over all time instants from ϕn v can be averaged as CX̄ sj 0 =

1
X̄(ϕn v ). An initial pulse train is estimated as
card(ϕ n v )
ˆs̄j 0 = C T C −1 X̄(n) by using CX̄ sj 0 to replace X̄(n0 ) in
X sj 0 X X
(3).
Step 4: Find r different highest peaks in ˆs̄j 0 and their time
of occurrence ϕn u = {n
u 1 , nu 2 , . . . , nu r }. Average X̄(ϕn u )
1
X̄(ϕn u ) and a new pulse train can
as CX̄ sj 1 = card(ϕ
)
nu
T
C −1 X̄(n) according to (3) and
be estimated as ŝj 1 = CX
sj 1 X X
(5). The r + N p (N p ≥ 1) highest peaks in ˆs̄j 1 , denoted
by ϕn q = {nq 1 , nq 2 , . . . , nq p }, and their times of occurrence
are continually found, and X̄(ϕn q ) is averaged as CX̄ sj 2 =

NING et al.: SURFACE EMG DECOMPOSITION BASED ON K-MEANS CLUSTERING AND CONVOLUTION KERNEL COMPENSATION



1
X̄(ϕn q ). The pulse train is then
card(ϕ n q )
−1
T
CX̄ sj 2 CX X X̄(n) and r is set to r + Np.

473

updated as ˆs̄j 2 =

Step 5: Repeat step 4 for h times, until finally the jth pulse
T
C −1 X̄(n) is obtained.
train ˆs̄j (h+1) = CX
sj (h+1) X X
Step 6: Set γ(d) = 0, ∀ d ∈ ϕn v [18].
Step 7: Repeat steps 2–6 for Nm dl times (usually depending
on the maximum number of motor units that can be extracted).
Finally, the IPTs are classified into groups for each specific MU.
C. Simulated Surface EMG Signals
1) Test 1: Test With Signals Generated by a Random Mixing
Matrix: Ten trails were conducted in this test with the number
of sources N being set to 10, and Nm dl in step 7 from Section IIB was set to 150. All the simulated signals were generated with
the same protocol as described in [18], but the mean interpulse
interval (IPI) of each input pulse train was set to 100 samples,
parameter τ was set to 10 samples, and the number of observations M was set to 25. The number of delayed repetitions K was
set to 9 [18] so that the number of extended IPTs was 190 and
the number of observations was 250. Each generated signal was
corrupted by Gaussian zero-mean noises with the SNRs being
set to −10, −5, 0, 5, and 10 dB, respectively. The number of
highest peaks r was set to 10 and the number of time instants
(Np) added in each iteration step was also set to 10, while the
number of iteration steps h (step 5 in Section II-B) was set to
20.
2) Test 2: Test With Synthetic Surface EMG Signals: Synthetic surface EMG signals were generated by using a planar volume conductor model as described in [25]. The intracellular action potential of a muscle fiber was modeled
as a current tripole (impulse amplitudes: I1 = 24.6 A/m2 ,
I2 = −35.4 A/m2 , I3 = 10.8 A/m2 ; distances between poles:
a = 2.1 mm, b = 6.9 mm) [26].
A grid of 8 × 8 electrodes with a 5-mm interelectrode distance
in both directions was assumed in the study for recording surface
EMG signals. These surface EMG signals were sampled at a
frequency of 2000 Hz. Ten simulation trails were performed by
assuming ten different active MUs, where the number of fibers,
position of the active MUs, discharging patterns, and conduction
velocity were all generated randomly in each trail. The surface
EMG signals were corrupted by additive Gaussian zero-mean
noises with different SNRs varying from 0 to 20 dB, and the
number of delayed repetitions of each original observation was
set to 9 [18], [19].
D. Experimental Surface EMG Signals of the First-Dorsal
Interosseous (FDI) Muscles
1) Test 3: Test With Experimental Multichannel EMG Signals:
The experimental surface EMG signals were collected from the
first dorsal interosseous (FDI) muscles of three adult subjects.
The study protocol was approved by the Institutional Review
Board (IRB) of Northwestern University (Chicago, USA). Subjects were seated upright in a mobile Biodex chair (Biodex,
Shirley, NY). A standard 6 degrees-of-freedom load cell (ATI
Inc, Apex, NC) setup and procedures for minimizing spurious

Fig. 1. Compares the performance of difference decomposition methods with
the simulated surface EMG signals. (a) shows the number of reconstructed
IPTs, (b) shows TPR and (c) shows the accuracy of the time instants of the
reconstructed IPTs, achieved by different decomposition methods at different
noise levels. The results are obtained by averaging the ten simulation trails (Test
1).

force contributions from unrecorded muscles as described in
[27] were used to accurately record the isometric contraction
force of the FDI muscles during index finger abduction. Surface
EMG signals were recorded from the FDI muscles with a Refa
amplifier (TMS International BV, The Netherlands) using a flexible 2-D 64-channel (individual recording probes were 1.2 mm
in diameter in 8 × 8 formation, with a center-to-center probe distance of 4 mm) surface electrode array (TMS International BV,
The Netherlands). The skin over the tested muscle was carefully
prepared with gentle abrasion and a small amount of absorbable
conductive electrode cream [28]. The electrode array was attached to the FDI muscle with a double adhesive sticker and
further secured with medical tapes. The maximum voluntary
contraction (MVC) was first measured; after that, each subject
was asked to generate an isometric contraction force of the FDI
muscles at different contraction levels at 2N, 4N, 6N, and 8N,
respectively. Multiple trials were performed at each force level
in which the subject was asked to maintain the force as stable
as possible for up to 10 s. The signals were sampled at 2-kHz
per channel, with a band-pass filter setting at 10–500 Hz.
III. RESULTS
A. Simulated Surface EMG Signals
1) Test 1 Results: Fig. 1(a) shows the number of reconstructed
IPTs and Fig. 1(b) shows the true positive rate (TPR) [20]
achieved by the linear minimum mean square error (LMMSE)
estimator [18], KmCKC, GCKC, and classic CKC, respectively,
at different noise levels. Parameters utilized in the KmCKC
method and the corresponding computation times in this test
are listed in Table I, where Ls is the number of samples in each
channel’s signal, tc is the computing time, and r, Np, h, and Nm dl
refer to the steps 4, 5, and 7 in Section II-B. The same amount of
IPTs were reconstructed by all the four decomposition methods
with SNRs over 0 dB, but the KmCKC method achieved a higher
TPR than either the GCKC or classic CKC methods. All the ten
assumed IPTs were successfully reconstructed by the KmCKC

474

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

TABLE I
PARAMETERS USED AND COMPUTING TIMES IN THE IMPLEMENTATION OF THE
KMCKC METHOD IN THE 3 TESTS (TESTS 1–3)
Signal

Nm d l

r

Np

h

Ls

tc (s)

Test 1
Test 2
Test 3

150
200
350

10
5
5

10
5
5

20
7
40

20 000
6001
27 001

37.3
9.4
339.4

method when the SNR is set to −5 or −10 dB, while both the
GCKC and classic CKC methods failed to achieve such results.
These results demonstrate that the proposed KmCKC method is
robust to noise. Note that the LMMSE estimator assumes prior
information that is known in the computer simulation, but is not
available in experimental EMG signals. Therefore, the LMMSE
method stands for an ideal solution here but is not practicable in
reality—the LMMSE results are listed here only as a reference.
Let TIA denote the accuracy of time instants, TIT denote
the total number of correctly identified time instants that were
fired by one MU before estimating the final pulse train (e.g., for
KmCKC, TIT stands for the total number of correctly identified
time instants in step 5 used to calculate CX̄ sj (h+1) ; whereas
for CKC, TIT stands for the total number of correctly identified
time instants in a common set Ψj in step 5 [18]), and TIW
denote the total number of time instants fired by this MU, then
TIA can be given as
TIA =

TIT
× 100%.
TIW

(6)

Note that TIA is an important parameter to decide the quality
of reconstructed IPTs, and TPR is a parameter utilized to measure the accuracy of time instants that are correctly identified
after obtaining the final pulse train. Fig. 1(c) shows the average time instant accuracy achieved by the KmCKC and classic
CKC, respectively, at different noise levels. It can be seen that
the time instant accuracy of the IPTs reconstructed by the KmCKC reaches about 100% for all SNRs over −5 dB. The time
instant accuracy of the reconstructed IPTs does drop to about
30% when the SNR is set to −10 dB, but overall the KmCKC
approach offers higher time instant accuracy than the classic
CKC at all noise levels.
It can also be seen that the performance of the KmCKC approach is similar to that of the LMMSE estimator. Please note
that the original IPTs were delayed by samples in the range
of 1–10 to achieve better results when the LMMSE estimator
was implemented. When the classic CKC was implemented,
the number of nr , denoted by Nn r , was selected from 200–
300 [18], as it would not improve results to further increase
the number of nr beyond this value. A threshold Thp was set
to determine the number of pulses in the product of (11) of
[18]. The parameter R was set to 4 and the number of combinations (n3 , n4 , . . . , nR −1 ), denoted by Nc, contributing the
number of pulses exceeding the threshold J in the common set ψj
was selected from 60–400 [18]. The main decomposition loops
([steps 2–8 in Fig. 1 of [18]]) were performed 20 times with different parameters chosen from the above range in order to best

Fig. 2. (a) Top panel represents the sum of the MUAP trains (red lines)
reconstructed by the KmCKC method compared to the raw signals (blue lines)
in one typical channel from the synthetic surface EMG signals with SNR =
20 dB, the middle panel shows an expanded segment of the raw signal, and
the bottom panel represents the residual after the subtraction of reconstructed
MUAP trains from the raw surface EMG signals. (b1) shows the number of
reconstructed IPTs and (b2) shows the TPR of the reconstructed IPTs achieved
by different decomposition methods at different noise levels. The results are
averaged over ten simulation trails (Test 2).

fit the parameters for the classic CKC. The results were compared and the values that could reconstruct the greatest number
of IPTs were selected, the main decomposition loops were then
performed 300 times to obtain the final results (it again would
not improve the results any more to further increase the number
of main decomposition loops). The number of main decomposition loops and the number of iterations were set to 500 and 40,
respectively, to estimate ĉt j X in (5) of [19] when the method of
GCKC was implemented. The scalar function f (t) = (1/3)t3
was used as in (9) of [19]. The IPT was considered as real when
its TPR was greater than 75%.
2) Test 2 Results: The sum of MUAP trains reconstructed
by KmCKC from one typical channel of the synthetic surface EMG signals and the associated residual are shown in
Fig. 2(a). Fig. 2(b1) shows the number of reconstructed IPTs
and Fig. 2(b2) shows the TPRs achieved by the LMMSE estimator, KmCKC, GCKC, and classic CKC, respectively. Parameters utilized in the KmCKC approach and the computing time
are listed in Table I. The implementation of the classic CKC
method in this test is similar to its implementation in Test 1, but

NING et al.: SURFACE EMG DECOMPOSITION BASED ON K-MEANS CLUSTERING AND CONVOLUTION KERNEL COMPENSATION

475

the main decomposition loops were performed 350 times. The
parameters used in the GCKC method in this test are the same
as in Test 1. Results show that the number of reconstructed IPTs
achieved by all four of the decomposition methods increases as
the SNR goes up. A maximal reconstructed IPT number of 4
is achieved by the classic CKC and GCKC methods when the
SNR is increased to 15 dB, but does not increase further when
the SNR is further increased to 20 dB. This phenomenon seems
hint that only the MUs contributing significantly to the surface
EMG signals can be identified by the classic CKC and GCKC
methods. The maximal reconstructed IPT number of 8 achieved
by the KmCKC demonstrates a superior level of performance
in reconstructing MUs.
B. Experimental Surface EMG Signals
1) Test 3 Results: Parameters utilized in the KmCKC method
and the computing time are listed in Table I. Note that the implementation the classic CKC method in this test is similar to
the implementation in Test 1, but the main decomposition loops
were performed 400 times. The parameters used in the GCKC
method in this test are the same as the parameters used in the
Test 1. The sums of the MUAP trains extracted by KmCKC
and the residual after the subtraction of these extracted MUAP
trains from the raw surface EMG signals of the FDI muscles
are shown in Fig. 3(a). Fig. 3(b) shows the MUs identified by
the classic CKC and KmCKC methods. Results show that both
the KmCKC and classic CKC can identify the first six MUs, but
the last eight MUs can only be identified by the KmCKC approach. The number of MUs extracted by the KmCKC, GCKC,
and classic CKC methods corresponding to different force levels
of contraction of three subjects are reported in Table II, where
NM U-64 denotes the number of MUs extracted from all 64 channels. Overall the number of MUs identified by the KmCKC
increases with the increasing contraction force, but the number
of MUs identified by the classic CKC is reduced.
Experimental multichannel surface EMG recordings from the
three subjects were also utilized to validate the performance of
the proposed KmCKC method in surface EMG decomposition
by using the “two source” approach. Surface EMG channels
were divided into two independent groups: channels with odd
channel numbers formed one group and channels with even
channel numbers formed the other group. The number of MUs
extracted from all channels for each independent group (denoted
by NM UG 1 and NM UG 2 , respectively), the number of common
MUs extracted from the two independent groups (denoted by
NCOM M U ), and the percentage of common pulses generated
by the common MUs (denoted by PCOM PUL ) are reported in
Table II. It is not surprising that the number of extracted MUs
decreases significantly when the number of channels drops by
half, especially in the case of high-force contractions. The fact
that the percentage of common MUs and common pulses are still
very high even when the number of MUs extracted is reduced
demonstrates the reliability of the proposed KmCKC method
in multichannel surface EMG decomposition. In addition, to
study the effect of number of channels on the decomposition
performance, the first and last 16 channels as well as the first

Fig. 3. (a) Top panel shows the sum of the MUAP trains (red lines) extracted by
the KmCKC method compared to the raw surface EMG (blue lines) recordings
from FDI muscles (Subject B) in one typical channel, the middle panel shows
an expanded segment of the signal, and the bottom panel shows the residual (red
lines) after subtraction of extracted MUAP trains from the raw surface EMG
compared to the raw surface EMG (blue lines). (b) Shows MU firing patterns
identified by the KmCKC (red lines) and classic CKC (blue lines) from surface
EMG signals of the FDI muscles, the isometric constant force of contraction
was held at 10% MVC (Test 3).

and last 48 channels were used to decompose sEMG signals,
respectively. These results are also presented in Table II, where
NM U-16 and NM U-48 denotes the number of MUs extracted from
16 channels and 48 channels, respectively.
IV. DISCUSSION
There are two innovations in the proposed KmCKC approach
compared to the classic CKC and the GCKC. One innovation is
the employment of the KMC method in step 3, while the other
is the use of the novel multistep iteration approach in steps 4–5
in the proposed KmCKC approach.
Since the MUAPs generated by the same MU have a certain
degree of similarity in multichannel surface EMG signals, the
firing times of the same MU can be clustered by using the
KMC method via evaluating a distance function. The firing
times of different MUs are often mixed into a single group if
a small number of groups is clustered by KMC in step 3 (see
Section II-B) and a large number of time instants in ϕn c is
identified in step 2 (see Section II-B). Therefore, the number of

476

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

TABLE II
EXPERIMENTAL SURFACE EMG DECOMPOSITION RESULTS (MEAN ± STD.
DEV.) ACHIEVED FROM DIFFERENT NUMBERS OF CHANNELS AT DIFFERENT
FORCE LEVELS OF CONTRACTION (TEST 3)
Method

CKC
GCKC
KmCKC

Parameters

N M U -6 4
N M U -6 4
N M U -6 4
N M U -4 8
NM U G 1
NM U G 2
NC O M M U
P C O M P U L (%)
N M U -1 6

Contraction Force
2N

4N

6N

8N

4.7 ± 1.5
5.7 ± 2.5
10.7 ± 4.2
7.7 ± 2.8
6.7 ± 2.5
6.7 ± 1.5
5.7 ± 2.5
92.2 ± 5.6
3.3 ± 1.6

5.7 ± 2.5
8.0 ± 0
10.7 ± 1.5
10.5 ± 1.2
9.3 ± 1.5
8.0 ± 1.0
7.7 ± 0.6
92.2 ± 5.4
4.2 ± 1.2

3.3 ± 2.3
5.7 ± 4.0
10.7 ± 3.1
8.2 ± 2.3
8.0 ± 1.7
7.3 ± 2.5
6.3 ± 2.1
94.3 ± 4.2
3.7 ± 1.9

2.7 ± 2.5
6.7 ± 2.3
12.7 ± 0.6
8.3 ± 1.6
5.7 ± 2.1
6.0 ± 2.6
5.0 ± 2.6
97.0 ± 4.1
2.5 ± 1.5

clustered groups and time instants should ensure that the time
instants in one group are fired by the same MU as completely
as possible. In general, 30–60 time instants are identified in ϕn c
and 2–4 groups are clustered by KMC.
If the quality of the multichannel surface EMG signals is
good, as with signals generated in the case of low force muscle contraction with high SNR, the IPTs can be satisfactorily
reconstructed even when steps 4 and 5 are skipped. In the case
of complex surface EMG signals, such as the signals generated
with high force level of contraction, the time instants fired by
the same MU may not be clustered into one group successfully
by using the KMC method, which means the IPTs cannot be
satisfactorily reconstructed by only using the KMC method. In
this case, the multistep iteration approach proposed in the steps
4–5 is needed to improve the initial pulse train ˆs̄j 0 .
It is critical to obtain a satisfactory correlation matrix CX̄ sj
in (5) for all the CKC methods, including the classic CKC, the
GCKC, and the proposed KmCKC methods, in order to achieve
good decomposition results. The CX̄ sj 2 estimation approach
proposed in the KmCKC is novel, where CX̄ sj 2 is calculated as
an arithmetic mean of X̄(ϕn q ) in each iteration step. Once an
IPT is estimated, the time instants corresponding to the highest
peaks in the IPT, which are usually fired by the same MU [18],
will be used to update the original IPT to form a new one.
The quality of the new IPT will be improved when compared
to the previous one, and new time instants corresponding to
the highest peaks in the new IPT fired by the same MU will
be identified. The new IPT will be updated by combining the
new time instants with the previous ones. In this way, the IPT
will be iteratively updated and the quality of the IPT will be
significantly improved after such a multistep iteration process.
In the tests conducted in this study, nearly all of the IPTs could
be reconstructed after 10–30 iteration steps. Clearly, the CX̄ sj
estimating process employed in the proposed KmCKC methods
is different from the existing CKC methods, including the classic
CKC and GCKC methods. The feature that the IPTs can be
gradually improved by the iterative process in steps 4–5 of the
proposed CX̄ sj estimating approach help to select more time
instants fired by the same MU, and thereby push its performance
to better approximate the performance of the LMMSE method.

This then leads to its superior performance when compared to
the GCKC and classic CKC methods in terms of the number of
reconstructed MUs and TPRs, which is demonstrated in Figs. 1,
2(b1), (b2), 3(b), and Table II.
Fig. 1(c) shows that the time instant accuracy of the IPTs
reconstructed by the KmCKC approach is as low as approximately 30% when a low SNR of −10 dB is considered. The
time instant accuracy of 30% presented in Fig. 1(c) is an average
value over all of the reconstructed IPTs, meaning that some of
the reconstructed IPTs have time instant accuracies lower than
30% while others have time instant accuracies higher than 30%.
It is surprising that the TPR of some reconstructed IPTs is still
above 90%, even the time instant accuracy is lower than 5%.
This may indicate that some time instants that do not belong to
the same IPT will be helpful to improve CX̄ sj for obtaining better results. The proposed method also demonstrates better noise
robustness in test 1 when compared to the test 2. This is mainly
because some of the signal components generated by smaller or
deeper motor units are often considered as noise with low SNR
[see Fig. 2(b1), (b2)].
The “two source” method was employed in this study to further evaluate the performance of the proposed KmCKC with experimental EMG signals. The high percentage of common MUs
observed by the KmCKC method from the two independent
groups of signals demonstrates its reliability in multichannel
surface EMG decomposition (see Table II). Results also show
that the number of reconstructed MUs significantly decreases as
the number of surface EMG channels decreases. Therefore, it is
important to increase the number of surface EMG channels in
order to satisfactorily decompose surface EMG signals in cases
of high force contraction.
V. CONCLUSION
In conclusion, a new KmCKC approach has been developed
by combining a modified CKC method and the K-mean clustering method for multichannel surface EMG decomposition. The
KMC is performed as an initial step to cluster the time instants
fired by the same MU, and the classic CKC, which is modified
with a novel multistep iterative process, is performed to update
the IPTs iteratively. These two innovations lead to the superior
performance of the proposed KmCKC method in decomposing multichannel surface EMG signals when compared to the
GCKC method and classic CKC method in terms of the decomposition accuracy and robustness against noise. The present
promising simulation and experimental results suggest that the
proposed KmCKC method can be expected to accurately and
efficiently decompose multichannel surface EMG signal from
different levels of contraction.
ACKNOWLEDGMENT
The authors would like to thank Dr. W. Z. Rymer at the Rehabilitation Institute of Chicago (RIC) for providing experimental
surface EMG data and useful discussion. The authors would
also like to thank T. Potter from the University of Houston for
editing the manuscript.

NING et al.: SURFACE EMG DECOMPOSITION BASED ON K-MEANS CLUSTERING AND CONVOLUTION KERNEL COMPENSATION

REFERENCES
[1] R. S. LeFever and C. J. De Luca, “A procedure for decomposing the
myoelectric signal into its constituent action potentials—Part I: Technique,
theory, and implementation,” IEEE Trans. Biomed. Eng., vol. BME-29,
no. 3, pp. 149–157, Mar. 1982.
[2] D. Stashuk, “EMG signal decomposition: How can it be accomplished
and used?,” J. Electromyography Kinesiol., vol. 11, no. 3, pp. 151–173,
Jun. 2001.
[3] K. C. McGill, Z. C. Lateva, and H. R. Marateb, “EMGLAB: An interactive
EMG decomposition program,” J. Neurosci. Methods, vol. 149, no. 2,
pp. 121–133, Dec. 15, 2005.
[4] S. H. Nawab, R. P. Wotiz, and C. J. De Luca, “Decomposition of indwelling
EMG signals,” J. Appl. Physiol., vol. 105, no. 2, pp. 700–710, Aug. 2008.
[5] Z. Erim and W. Lin, “Decomposition of intramuscular EMG signals using
a heuristic fuzzy expert system,” IEEE Trans. Biomed. Eng., vol. 55, no.
9, pp. 2180–2189, Sep. 2008.
[6] C. D. Katsis, T. P. Exarchos, C. Papaloukas, Y. Goletsis, D. I. Fotiadis, and
I. Sarmas, “A two-stage method for MUAP classification based on EMG
decomposition,” Comput. Biol. Med., vol. 37, no. 9, pp. 1232–1240, 2007.
[7] J. R. Florestal, P. A. Mathieu, and A. Malanda, “Automated decomposition
of intramuscular electromyographic signals,” IEEE Trans. Biomed. Eng.,
vol. 53, no. 5, pp. 832–839, May 2006.
[8] Z. Q. Xu, S. J. Xiao, and Z. R. Chi, “ART2 neural network for surface
EMG decomposition,” Neural Comput. Appl., vol. 10, no. 1, pp. 29–38,
2001.
[9] C. J. De Luca, A. Adam, R. Wotiz, L. D. Gilmore, and S. H. Nawab,
“Decomposition of surface EMG signals,” J. Neurophysiol., vol. 96, no. 3,
pp. 1646–57, Sep. 2006.
[10] S. H. Nawab, S. S. Chang, and C. J. De Luca, “High-yield decomposition
of surface EMG signals,” Clin. Neurophysiol., vol. 121, no. 10, pp. 1602–
1615, Oct. 2010.
[11] I. Gligorijevic, J. P. van Dijk, B. Mijovic, S. Van Huffel, J. H. Blok, and
M. De Vos, “A new and fast approach towards sEMG decomposition,”
Med. Biol. Eng. Comput., vol. 51, no. 5, pp. 593–605, May 2013.
[12] F. J. Theis and G. A. Garcı́a, “On the use of sparse signal decomposition in
the analysis of multi-channel surface electromyograms,” Signal Process.,
vol. 86, no. 3, pp. 603–623, 2006.
[13] M. F. Lucas, A. Gaufriau, S. Pascual, C. Doncarli, and D. Farina, “Multichannel surface EMG classification using support vector machines and
signal-based wavelet optimization,” Biomed. Signal Process. Control, vol.
3, no. 2, pp. 169–174, Apr. 2008.
[14] S. Maekawa, T. Arimoto, and M. Kotani, “MU decomposition from multichannel surface EMG signals using blind deconvolution,” Electron. Commun. Japan (Part III: Fundam. Electron. Sci.), vol. 90, no. 2, pp. 22–30,
2007.
[15] B. U. Kleine, J. P. van Dijk, B. G. Lapatki, M. J. Zwarts, and D. F.
Stegeman, “Using two-dimensional spatial information in decomposition
of surface EMG signals,” J. Electromyography Kinesiol., vol. 17, no. 5,
pp. 535–548, Oct. 2007.

477

[16] M. Gazzoni, D. Farina, and R. Merletti, “A new method for the extraction
and classification of single motor unit action potentials from surface EMG
signals,” J. Neurosci. Methods, vol. 136, no. 2, pp. 165–177, Jul. 30, 2004.
[17] G. A. Garcia, R. Okuno, and K. Akazawa, “A decomposition algorithm
for surface electrode-array electromyogram. A noninvasive, three-step
approach to analyze surface EMG signals,” IEEE Eng. Med. Biol. Mag.,
vol. 24, no. 4, pp. 63–72, Jul./Aug. 2005.
[18] A. Holobar and D. Zazula, “Multichannel blind source separation using
convolution kernel compensation,” IEEE Trans. Signal Process., vol. 55,
no. 9, pp. 4487–4496, Sep. 2007.
[19] A. Holobar and D. Zazula, “Gradient convolution kernel compensation
applied to surface electromyograms,” Proc. Ind. Compon. Anal. Signal
Separation, vol. 4666, pp. 617–624, 2007.
[20] A. Holobar, D. Farina, M. Gazzoni, R. Merletti, and D. Zazula, “Estimating
motor unit discharge patterns from high-density surface electromyogram,”
Clin. Neurophysiol., vol. 120, no. 3, pp. 551–62, Mar. 2009.
[21] A. Holobar, M. A. Minetto, A. Botter, and D. Farina, “Identification of
motor unit discharge patterns from high-density surface EMG during high
contraction levels,” in Proc. 5th Eur. Conf. Int. Fed. Med. Biol. Eng., Pts
1 And 2, 2012, vol. 37, pp. 1165–1168.
[22] A. Holobar, V. Glaser, J. A. Gallego, J. L. Dideriksen, and D. Farina,
“Non-invasive characterization of motor unit behaviour in pathological
tremor,” J. Neural Eng., vol. 9, no. 5, Oct. 2012.
[23] MATLAB (R2010b), Help Files, “Kmeans.” Mathworks, Inc., Natick, MA,
USA, 2010.
[24] A. Holobar and D. Zazula, “Correlation-based decomposition of surface
electromyograms at low contraction forces,” Med. Biol. Eng. Comput.,
vol. 42, no. 4, pp. 487–495, Jul. 2004.
[25] X. J. Zhu and Y. C. Zhang, “High-density surface EMG decomposition
based on a convolutive blind source separation approach,” in Proc. IEEE
Annu. Int. Conf. Eng. Med. Biol. Soc., 2012, pp. 609–612.
[26] M. R. Parker and R. Merletti, Electromyography: Physiology, Engineering,
and Non-Invasive Applications. New York, NY, USA: Wiley, 2004.
[27] X. Li, A. Suresh, P. Zhou, and W. Z. Rymer, “Alterations in the peak
amplitude distribution of the surface electromyogram poststroke,” IEEE
Trans. Biomed. Eng., vol. 60, no. 3, pp. 845–852, 2013.
[28] P. Zhou, N. L. Suresh, and W. Z. Rymer, “Surface electromyogram analysis of the direction of isometric torque generation by the first dorsal
interosseous muscle,” J. Neural Eng., vol. 8, no. 3, p. 036028, Jun. 2011.

Authors’ photographs and biographies not available at the time of publication.

