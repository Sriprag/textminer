IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

1159

Assess Sleep Stage by Modern Signal
Processing Techniques
Hau-tieng Wu, Ronen Talmon, and Yu-Lun Lo‚àó

Abstract‚ÄîIn this paper, two modern adaptive signal processing techniques, empirical intrinsic geometry and synchrosqueezing
transform, are applied to quantify different dynamical features of
the respiratory and electroencephalographic signals. We show that
the proposed features are theoretically rigorously supported, as
well as capture the sleep information hidden inside the signals. The
features are used as input to multiclass support vector machines
with the radial basis function to automatically classify sleep stages.
The effectiveness of the classification based on the proposed features is shown to be comparable to human expert classification‚Äî
the proposed classification of awake, REM, N1, N2, and N3 sleeping
stages based on the respiratory signal (resp. respiratory and EEG
signals) has the overall accuracy 81.7% (resp. 89.3%) in the relatively normal subject group. In addition, by examining the combination of the respiratory signal with the electroencephalographic
signal, we conclude that the respiratory signal consists of ample
sleep information, which supplements to the information stored in
the electroencephalographic signal.
Index Terms‚ÄîBreathing pattern variability, empirical intrinsic
geometry (EIG), sleep stage, synchrosqueezing transform (ST).

I. INTRODUCTION
N human beings, sleep is a universal recurring dynamical and
physiological activity, and the quality of sleep influences our
daily lives in diverse ways. However, it was not until recently
that sleep became a branch of medicine and found its role in
several seemingly unrelated clinical problems. Physiologically,
it is divided into two broad stages: rapid eye movement (REM),
and nonrapid eye movement (NREM) [1]. Normally, sleep proceeds in cycles in between REM and NREM. The NREM stage
is further divided into shallow sleep (stage N1 and N2) and deep
sleep (stage N3). In all procedures identifying sleep stages, we
need a sleep scoring process with the help of polysomnography (PSG), which includes electroencephalography (EEG),
electromyogram (EMG), and electrooculogram (EOG), etc.
Among these physiological signals, EEG signals are the most
concentrated ones since the clinically acceptable stage of the
sleep is majorly determined by reading the recorded EEG based

I

Manuscript received August 22, 2014; revised October 21, 2014; accepted
November 15, 2014. Date of publication November 26, 2014; date of current
version March 17, 2015. R. Talmon was supported by European Union‚Äôs Seventh
Framework Programme (FP7) under Marie Curie Grant 630657. Y.-L. Lo was
supported by the Taiwan National Science Council Grant 101-2220-E-182A-001
and Grant 102-2220-E-182A-001. Asterisk indicates corresponding author.
H.-T. Wu is with the Department of Mathematics, University of Toronto.
R. Talmon is with the Department of Electrical Engineering, Technion ‚Äì Israel
Institute of Technology.
*Y.-L. Lo is with the Department of Thoracic Medicine, Chang Gung Memorial Hospital, Chang Gung University, School of Medicine, Taipei 105, Taiwan (e-mail: loyulun@hotmail.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2375292

on the R&K criteria, which were standardized in 1968 by
Rechtschaffen and Kales [2] and further developed by the American Academy of Sleep Medicine on 2007 (AASM 2007) [3].
However, due to the subjective judgment and different training background, the agreement of manual sleep scoring among
trained clinicians and professionals has been known to be limited [4], thereby motivating the development of an objective and
automatic scoring system.
Based on these clinical findings, various features of the EEG
signals have been proposed to study the sleep dynamics, for example, time-domain summary statistics, spectral analysis, coherence, time-frequency analysis, entropy, to name but a few
[5]‚Äì[8]. Recently, a theoretically solid approach suitable to
model the underlying dynamics of the brain activity and estimate the evolutionary dynamics from recorded EEG signal
was proposed in [9] and [10], and had been successfully applied
to predict the preseizure state from the intracranial EEG signals
[11], [12].
However, it is well known that sleep is a global and systematic behavior not localized solely in the brain. For example, the muscular atonia and low-amplitude EMG are related
to the significant changes in the breathing pattern during normal sleep: during NREM sleep, especially stage N3, breathing
is remarkably regular, while during REM sleep, breathing is
irregular with sudden changes. The above physiological facts
hint that the respiratory pattern of the recorded breathing signal during sleep might well reflect the sleep stage. There have
been some reported studies of the sleep stage from analyzing
the respiratory signal [13]‚Äì[17]. In [13] (resp. [14]), an averaged respiratory rate over a fixed window is used to estimate
the REM and NREM (resp. awake and sleep). In [15], a notch
filter based instantaneous frequency (IF) estimator is applied
to extract features to differentiate awake, REM and NREM. In
[16], [17], the adaptive harmonic model and a modern timefrequency analysis technique have been applied to further quantify the notion of respiratory dynamic. In particular, the instantaneous respiratory rate has been related to awake, REM,
shallow and deep sleep stages, with a rigorous mathematical
foundation.
The aforementioned physiological patterns inside the EEG
and the respiratory signals are actually outcomes of the intricate
deformation of the underlying sleep dynamics, which we call
intrinsic dynamical features of the sleep, that are not directly
accessible to us. Although it is not an easy task to fully model
or estimate the dynamical system underlying sleep, we might
expect to benefit if we are able to quantify and integrate these
hidden intrinsic dynamical features. In this paper, we propose
to combine two modern adaptive signal processing techniques,
empirical intrinsic geometry (EIG) and Synchrosqueezing

0018-9294 ¬© 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1160

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

transform (SST), to estimate these intrinsic dynamical features
of sleep guiding the observed EEG and respiratory signals‚Äîwe
define an index, referred to as Sleep Index, to quantify these
features. Then, by applying the suitable classifier algorithm,
we show that the extracted features are highly correlated to the
sleep stage determined by reading the EEG by the AASM 2007
criteria. Indeed, the proposed classification based on the respiratory signal (resp. respiratory and EEG signals) has the overall
accuracy 81.7% (resp. 89.3%) in the relatively normal subject
group, which is comparable to human expert classification.
The paper is organized in the following way. In Section II,
we summarize the theoretical background of EIG and SST and
the associated models. Then, the Sleep Index is introduced in
Section III. In Section IV, the proposed Sleep Index is applied to
study the whole night sleep signals. We conclude with discussion
in Section V.
II. TWO ALGORITHMS‚ÄîSST AND EIG
The work presented in this paper is an application of the modern signal processing techniques to study the sleep dynamics. In
particular, we will extract different features from the respiratory
and EEG signals by the well-studied EIG [9], [18] and SST
[17], [19]. As such, the theoretical material will be presented in
a compact, informal manner emphasizing on the intuitions. We
provide a formal and rigorous summary without proof of the
details. Those interested in the proofs are encouraged to read
the associated references.
A. Adaptive Harmonic Model and SST
The major characteristic pattern of the respiratory signal is
that it is almost periodic. We call the movement of air from
the environment into the lungs inspiration and the movement
of air in the opposite direction expiration. An inspiration and
an expiration constitute a respiratory cycle. Breathing process
is a physiological process consists of a sequential respiratory
cycles. In this paper, we focus on the breathing process and call
the time-varying volume occupying the lung space the physiological respiratory signal. This general observation leads us
to the following phenomenological model for the respiratory
signal R(t) (without noise):
R(t) = A(t) s(œÜ(t))

(1)

where we shall call s(¬∑) the wave shape function; it is a 1periodic real function that satisfies some mild technical conditions. See [16] for the details. The respiratory signals recorded
from different devices, like the airflow measuring device or the
chest wall movement, shall be understood as observations of
the respiratory system. Different observations lead to different
shape functions. We call the derivative œÜ (t) of the function œÜ(t)
the IF of the respiratory signal R(t). We require IF to be positive,
but it does not required to be constant as long as the variations
are slight from one period to the next, i.e., |œÜ (t)| ‚â§ œÜ (t) for
all time t, where  is some small, preassigned positive number.
Likewise, We call A(t) the amplitude modulation (AM) of R(t),
which should be positive, but is allowed to vary slightly as well,
i.e., |A (t)| ‚â§ œÜ (t) for all time t. We refer the interested reader

to [17] for the technical details and a further discussion of the
well definedness of the definition of AM and IF. Note that our
treatment of the respiratory signal is purely phenomenological;
that is, the parameters and indices we will derive from the signal will be based solely on these signals themselves, and not on
explicit, quantitative models of the underlying mechanisms.
Physiologically, the quantities œÜ (t), A(t), and s in the model
(1) quantify the dynamics of the breathing process, which we
refer to as phenomenological dynamical features. For example,
one way to quantify the widely used notion breathing rate variability [20]‚Äì[22] is considering the IF and AM [23]. Indeed, if
œÜ (t0 ) > œÜ (t1 ), where t1 = t0 , we know that the subject breaths
faster at time t0 than at time t1 . We mention that this ‚Äúfast-slow‚Äù
momentary behavior in the respiratory signal has been shown
to be clinically informative and can be helpful in the ventilator weaning prediction [22], [23] and sleep stage estimation
[16], [17].
Due to the inevitable measurement error and other outliers
appearing inside the system, we model the recorded respiratory
signal as
Y (t) = R(t) + œÉ(t)Œæ(t)

(2)

where Œæ(t) is a stationary generalized random process and œÉ
is a smooth function that varies slowly. Here, Œæ(t) models the
noise and other outliers and œÉ models the possible nonstationary nature of the noise. A particular example for Œæ frequently
encountered in practice is the Gaussian white noise. We refer
the read having interest to [17] for further information about this
noise model and its mathematical details.
To estimate the phenomenological dynamical features of
R(t), œÜ (t), and A(t), from Y (t), we apply the SST, which
is a special reallocation technique [17], [19]. In a nutshell, we
evaluate any linear time-frequency analysis on the observation
Y (t), for example, the short time Fourier transform or the continuous wavelet transform, and we take the phase information
hidden inside the chosen linear time-frequency analysis into
account to obtain a sharpened time-frequency representation,
which is denoted as SY (t, Œæ). In addition to capturing the phenomenological dynamical features of R(t), the SST provides a
sharper time-frequency representation compared with the other
traditional time-frequency analyses. See Fig. 1 for an example
of the respiratory signal and its IF. We refer the reader to [17],
[19] for more details.
B. EIG and its Underlying Mathematical Model
In many real-world applications, the seeming complicated
time series collected from the system is controlled by a relatively simple underlying process. In some situations, when the
underlying evolutionary process lies on a low-dimensional Riemannian manifold, it can be parameterized through a manifold
learning framework, which was first introduced and studied in
[24]. The main idea in [24]1 and its extensions to time-series
1 In the original paper [24], the method was referred to as nonlinear independent component analysis. However, for the sake of avoiding possible confusion
with independent component analysis, the name EIG was adapted in [9]
and [10].

WU et al.: ASSESS SLEEP STAGE BY MODERN SIGNAL PROCESSING TECHNIQUES

Fig. 1. Time-frequency representation of the respiratory signal determined
by the SST superimposed by the respiratory signal (the gray curve) and the IF
(the gray dashed curve). The y-axis tick of the time-frequency representation
is shown on the left-hand side in black and the y-axis tick of the IF is shown
on the right-hand side in gray. The dominant black curve shown in the timefrequency representation indicated by the vertical arrows represents the IF of
the respiratory signal. The IF is obtained by fitting a curve to the dominant black
curve and is shown in the gray dashed curve. Note that the dominant curve is
relatively light near, for example, the 125th s indicated by the vertical arrow. This
stems from the fast IF change. Also, note that in addition to the dominant black
curve, there are some wiggly black traces in the time-frequency representation
indicated by the horizontal arrow. They stem from the nonharmonic nature of
the oscillatory respiratory pattern, that is, the shape function [16]. It is clear
that the subject breathes faster during the time indicated by the vertical arrow
(the 105th s) than during the time indicated by the vertical arrow (the 180th s).
This observation is captured by the IF indicated by the arrows at the 105th and
180th s.

[9], [10] is to bridge between data mining, and in particular manifold learning, and dynamical systems. The authors‚Äô observation
that the accessible measurements at hand do not necessarily
convey the true essence of the system led to the development of
a more generalized model, which separates between measurements and intrinsic hidden variables.
One particular example for such a dynamical system is the respiratory signal recorded during sleep‚Äîwe consider the model
that the evolutionary process governing the respiratory signals is
restricted to a low-dimensional Riemannian manifold, which is
fundamentally different from the phenomenological model (2).
This dependency is encoded using the state-space formalism
and the model of the recorded respiratory signal (2) is extended
as follows:

[measurement equation]
Y (t) = RŒ∏ (t) + œÉ(t)Œæ(t),
dŒ∏i (t) = ai (Œ∏i (t))dt + dwi (t),

[state equation]

(3)
where Œ∏(t) := (Œ∏1 (t), . . . , Œ∏d (t)) forms the inaccessible intrinsic state at time t that governs the respiratory signal RŒ∏ (t) and
evolves in time with unknown drifts ai and independent standard
Brownian motions wi , i = 1, . . . , d.
The idea that lies behind the model (3) is twofold. First, the
measured signal Y (t) has typical (unknown) dynamics, modeled
here by the state equation, which need to be taken into account
and encoded in the desired features. Second, the accessible signal is viewed as a measurement of the neural system controlling
the sleep cycle. While it can be effected by numerous factors
relating to the measurement modality (e.g., measurements of
airflow or chest movements), the used equipment (e.g., the type
of sensors and their exact positions), and noise, the true intrinsic

1161

variable we have interest in is the intrinsic states controlling the
respiratory signal (represented here by Œ∏(t)). Indeed, the notation RŒ∏ (t) implies that the respiratory signal depends upon the
‚Äúreal‚Äù physiological variable Œ∏ in an unknown way, possibly
through its amplitude AŒ∏ (t), wave shape sŒ∏ (¬∑), or IF œÜŒ∏ (t).
In the above model (3), however, due to noise and other
nuisance factors, the measurement Y (t) might be too redundant
to faithfully describe the dependency of the respiratory signal
on the underlying state and its temporal evolutionary. Thus, to
improve the underlying state observability, we introduce a highdimensional (possibly nonlinear) observer Œ¶ to the measured
signal [12], i.e.,
Z(t) = Œ¶(Y (t)) ‚àà Rm ,

[observation equation]

(4)

where Œ¶ is a map from the suitable scalar valued functional
space to the Rm -valued functional space and m ‚â• 1 is an integer
specified by the observer.
With the sampled observation set Z := {Z(ti )}N
i=1 , a natural
question is how to estimate Œ∏(t), namely, the system intrinsic
state and dynamics of interest. Such an analysis may complement the phenomenological dynamical features provided by the
SST. While the SST mainly carries instantaneous information,
recovering the intrinsic state of the dynamical system Œ∏(t) provides a characterization of coarser, slower dynamical changes
of the shape and structure of the signal, especially when the
observer Œ¶ is implemented as a transform that relies on short
time frames analysis.
It was shown in [24] that if the observations Z(t) can be
written as a regular deterministic function f : Rd ‚Üí Rm of the
samples of the underlying state, i.e., Z(t) = f (Œ∏(t)), then, by
ItoÃÇ‚Äôs formula, we have

d 
d


1 j
fii + ai fij dt +
fij dwi (t)
(5)
dZj (t) =
2
i=1
i=1
where fij = ‚àÇfj /‚àÇŒ∏i and fiij = ‚àÇ 2 fj /‚àÇŒ∏i2 . By a direct calculation, the covariance matrix C(t) ‚àà Rm √óm of the observation at
time t define by
Cj,k (t) : = Cov(dyj (t), dyk (t))

(6)

satisfies C(t) = J (t)J T (t), where J = ‚àáf ‚àà Rm √ód is the Jacobian of f . This key result along with the assumption that Œ∏(t)
is locally stationary evolving much more slowly than the observation scale so that the it stays closely on a low-dimensional
manifold M embedded in Rd , which is referred to as the intrinsic state manifold, as well as the assumption that f is stably
invertible on its range, allow the authors [24] to estimate the inaccessible state through the solution of an eigenvector problem,
which will be described later in this section. The main step leading to the solution theory is the following estimation. Suppose
Œ∏(t), Œ∏(œÑ ) ‚àà M, Z(t) = f (Œ∏(t)), and Z(œÑ ) = f (Œ∏(œÑ )). By the
Taylor expansion of f , up to the error term O(
Z(t) ‚àí Z(œÑ )
4 )
[24], we have

Œ∏(t) ‚àí Œ∏(œÑ )
2Rd = 12 (Z(t) ‚àí Z(œÑ ))T
√ó[C ‚àí1 (t) + C ‚àí1 (œÑ )](Z(t) ‚àí Z(œÑ )).

(7)

1162

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

Note that in our example, the function f leading to the observation depends on the observer Œ¶. As a result, with the estimated
covariance matrix from the accessible collected data Z, we
can build a graph Laplacian associated with the intrinsic state
manifold from the finite observations Z using the estimated Euclidean distance between the corresponding underlying samples
Œ∏(ti ) (7). This graph Laplacian gives rise to reparameterization
of the intrinsic manifold through diffusion maps (DM) [25].
This reparameterization procedure aiming to extract the intrinsic dynamics of the observation is referred to as EIG.
The remaining key question is the choice or design of a
‚Äúproper‚Äù observer Œ¶ to the system in (4). In particular, in order
to accommodate the inevitable noise in real-world signals, estimates of the conditional probability density p(Z|Œ∏) (e.g., histograms) were proposed as observers in [9]. The analysis relies
on the following facts: 1) any measurement noise is translated to
a linear transformation in the conditional densities domain, and
2) the distance (7), which is the Mahalanobis distance, is invariant under linear transformations. Indeed, these two facts allow
for the estimation of the distance between two nearby samples
on the intrinsic manifold in adverse noisy conditions. However,
estimating the conditional probability densities requires a large
amount of data and often is not feasible. Unfortunately, standard representations based on the Fourier transform are also
inadequate for respiratory signals. By linear approximation of
the function œÜ(t) around a nearby sample at t0 , the respiratory
signal in (1) can be approximated by
R(t) ‚âà A(t0 ) s(œÜ(t0 ) ‚àí t0 + œÜ (t0 )t).

(8)

As a result, the modulus of the Fourier transform of R(t) around
t0 is approximated by


|RÃÇ(t0 , œâ)| ‚âà |A(t0 ) sÃÇ(œâ/œÜ (t0 ))|

(9)

where œâ is the frequency, RÃÇ(t0 , œâ) is the Fourier transforms
of R(t) around t0 , and sÃÇ(œâ) is the Fourier transform of s(t),
respectively, assuming A(t) changes slowly with time. The approximation in (9) implies that even an almost linear function
œÜ(t) (i.e., when the IF is œÜ (t) ‚âà 1) is translated to large deformations in the Fourier domain in high frequencies (œâ  1) [26].
Consequently, if we take the short time Fourier transform as the
observer, the observations exhibit instabilities, thereby leading
to irregular f and a poor estimation of the Euclidean distance
on the underlying intrinsic state manifold (7).
To overcome the instability of the Fourier representation, following [12], we use the scattering transform as an observer. The
scattering transform has a low variance because it is based on
first order moments of contractive operators, it linearizes deformations, and it can represent effectively intermittent behavior
[26], [27]. The scattering transform is computed based on a
cascade of wavelet transforms and nonlinear modulus operators
[26]. Here, we briefly review the construction procedure of its
first- and second-order levels, since they were empirically shown
to provide a sufficient representation of the signals considered
in this paper.
Let œà(t) be a complex wavelet, whose real and imaginary
parts are orthogonal and have the same L2 norm. Let œàj (t) denote the dilated wavelet, defined as œàj (t) := 2‚àíj œà(2‚àíj t), ‚àÄj ‚àà

Z. Let Œ¶s (RŒ∏ (t)) denote the observations computed by applying the first- and second-level scattering transform to the signal
samples RŒ∏ (t), which are given by
Œ¶s (RŒ∏ (t)) = (||RŒ∏ (t) ‚àó œàj 1 (t)| ‚àó œàj 2 (t)| ‚àó w(t)
‚àÄ(j1 , j2 ) ‚àà Zn , n ‚àà {1, 2})j 1 ,j 2
where w(t) is a smoothing window, i.e., a scaling function associated with the mother wavelet. The scattering transform has
been shown to be an observer that is especially suitable for deformations and intermittencies [12]. In particular, it was shown
that it is regular with respect to time deformations. In other
words, as opposed to (9), small variations of the IF œÜ(t) are not
translated to large variations of the transformed signal, thereby
leading to accurate estimation of the Euclidean distance between the underlying intrinsic states in (7) and respecting the
manifold assumption. Intuitively, this stability is attained by the
wavelet transform. In (9), it is apparent that large deformations
appear in high frequencies even when the variations of the IF
are small. Such deformations are suppressed by the Wavelet
transform since dilated Wavelets have large support in high frequencies. Therefore, the application of the scattering transform
to the respiratory signal is particularly suitable.
Building on the generality of the described analysis, in this
study, we use it to represent the EEG signals as well. As the
respiratory signal, the EEG signal measures a physiological
phenomenon (‚Äúthe brain activity‚Äù), but, it is subject to noise,
interferences, and nuisance factors. Likewise, it can be represented using a state-space model, similar to (3), given by

[measurement equation]
X(t) = EŒ∂ (t) + V (t)
dŒ∂i (t) = Œ±i (Œ∂i (t))dt + dui (t)


[state equation]


where EŒ∂ (t) ‚àà Rm and X(t) ‚àà Rm are the clean and noisy
EEG signals, V (t) is a measurement noise, and Œ∂(t) :=
(Œ∂1 (t), . . . , Œ∂d  (t)) denotes the inaccessible intrinsic state representing the brain activity that governs the EEG signal EŒ∂ (t)
and evolves in time with unknown drifts Œ±i and independent
standard Brownian motions ui , i = 1, . . . , d . By applying EIG
to the recorded EEG signals, we may reconstruct the intrinsic
states Œ∂. We remark that this approach was applied to identify
the preseizure state from intracranial EEG data [11], [12]. We
refer the interested reader to [9], [10], [12] for more technical
details and references.
Before closing this section, we summarize the construction
of the graph Laplacian parameterization. In a nutshell, the main
ingredient is integrating local similarities at different scales,
which leads to a global description of the data set. Unlike linear
methods such as principal component analysis, a graph Laplacian parameterization embodies nonlinear relationships among
the variables. In addition to the mathematical analysis results
[25], [28], [29], it has been shown to be robust to noise perturbation [30], [31] and it is computationally efficient. We outline
the algorithm here and refer the readers to these literatures for
further theoretical details.
Take N multivariate measurement samples Z = {Z(ti )}N
i=1
and build a complete graph with vertices Z. We first build an
affinity matrix (or adjacency matrix) W of size N √ó N . The

WU et al.: ASSESS SLEEP STAGE BY MODERN SIGNAL PROCESSING TECHNIQUES

1163

Fig. 2. Intrinsic dynamical features of the cortical activity extracted from the O1A2 EEG signal by the scattering EIG. The 90-s O1A2 EEG signal is shown on
the left top figure. On the left bottom figure, the scattering EIG is illustrated‚Äîthe graph Laplacian is built up from the Mahalanobis distance from the EEG signal
via the scattering operator. On the right, the top three nontrivial eigenvectors of the graph Laplacian are used to show the underlying evolutionary dynamics. The
blue circles (resp. cyan circles, yellow circles, orange circles and red circles) represent the awake (resp. REM, N1, N2 and N3) sleep stage. It is clear that the
extracted dynamical features well parametrize the sleep stages in the sense that different sleep stages are located in different places.

affinity between a pair of samples is defined by a metric d in the
following way:
Wij = e‚àí

d 2 ( Z( t i ) , Z( t j ) )


,

for i, j = 1, . . . , N, i = j.

(10)

Note that according to the noise analysis in [31], when the signal
to noise ratio is small, it is beneficial to set the diagonal terms of
the affinity matrix to 0. In the present study, following the analysis in [24], the metric we choose is the Mahalanobis distance
(7). It is clear that the matrix W is symmetric. Note that theoretically (and practically) we can choose a more general kernel
function, but we focus on the Gaussian kernel to simplify the
exposition. Then, we define the diagonal degree/density matrix
D of size n √ó n, consisting of the sum of rows of W
Dii =

N


Wij ,

for i = 1, . . . , N.

j =1

Based on W and D, the graph Laplacian is defined by
L := I ‚àí D‚àí1 W.
Note that under the manifold assumption, D‚àí1 exists. Also
note that D‚àí1 W can be viewed as a transition matrix of a
Markov chain on the samples. Since L is similar to the symmetric matrix I ‚àí D‚àí1/2 WD‚àí1/2 , it has a complete set of right
eigenvectors œï1 , œï2 , . . . , œïN with corresponding eigenvalues
0 = Œª1 < Œª2 ‚â§ . . . ‚â§ ŒªN ‚â§ 1, where œï1 = (1, 1 . . . , 1)T [25].
By the aforesaid construction, the eigenvectors œï1 , . . . , œïN are
vectors in RN . Through the eigenvectors, the measurement samÀÜ
ples are mapped into Rd via
Z(ti ) ‚Üí (œï2 (ti ), . . . , œïdÀÜ(ti )),

for i = 1, . . . , N

(11)

where dÀÜ is an estimate of the dimension of the intrinsic state
of the system and is usually dÀÜ  N . Estimating the intrinsic
dimension of the system d extends the scope of this paper and
is empirically set according to the spectral gap in the decay of

the eigenvalues, as will be described in Section III. In (11), we
ÀÜ
obtain a d-dimensional
parameterization of the measurements.
In particular, we view the jth coordinate of the parameterization
of Z(ti ), i.e., œïj +1 (ti ), as the jth coordinate of the recovered
hidden intrinsic state Œ∏j (ti ), which we view as the features
associated with the sleep stage in this analysis. An illustration of
the DM reparameterization process with the first three nontrivial
eigenvectors is shown in Fig. 2.
III. MATERIAL AND METHOD
A. Data Collection
Standard PSG was performed with at least 6 h of sleep to
confirm the presence or absence of obstructive sleep apnea
from the clinical subjects suspicious of sleep apnea in the sleep
center at Chang Gung Memorial Hospital (CGMH), Linkou,
Taoyuan, Taiwan. The institutional review board of the CGMH
approved the study protocol (No. 101-4968A3) and the enrolled
subjects provided written informed consent. Four channel EEG
signals (C3A2, C4A1, O1A2, and O2A1), two channel EOG
signals, and chin EMG were recorded at the sampling rate
200 Hz for sleep staging. Chest and abdominal motions are
recorded by the piezoelectric bands and airflow was measured
using thermistors and nasal pressure, both at the sampling rate
100 Hz. All signals were acquired on the Alice 5 data acquisition system (Philips Respironics, Murrysville, PA, USA). The
sleep stage, apneas, and hypopneas were defined and scored
by an experienced sleep technologist based on the AASM 2007
guideline [3]. After obtaining the automatic annotation result by
our algorithm, another experienced scorer was invited to repeat
the annotation for comparison. The second scorer is blinded to
the first one.
Take the recorded EEG signals, denoted as Ek , k = 1, . . . , 4,
and the respiratory signal, denoted as R. Suppose the recording time period is T = [0, T ]. We divide T into contiguous

1164

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

subintervals Ti of œÑ s long, i = 1, . . . , N ; that is, T = ‚à™N
i=1 Ti
and Ti ‚à© Tj = ‚àÖ for all i = j. We call Ti the ith epoch. We will
extract p > 0 features out of the recorded respiratory and EEG
signals for each epoch.
B. Features From the Respiratory Signal
Given a recorded respiratory signal R(t), we extract its phenomenological dynamical features, including the IF œÜ (t) and
the AM A(t) by applying the SST. Denote the estimated IF by
œÜÃÉ (t) and the AM by AÃÉ(t). The mean of AÃÉ(t) restricted to the
ith epoch, denoted as the Ai , and the mean of œÜÃÉ (t) restricted
to the ith epoch, denoted as œÜi , form the first two features for
the respiratory signal for the ith subinterval. The third feature,
denoted as vi , is obtained by evaluating the standard deviation
of œÜÃÉ (t) on the interval of length 30 s centered on the middle of
the ith epoch.
We apply the analysis described in Section II-B to R(t) in
order to complement the phenomenological dynamical features
and to obtain a characterization of the structural, slower underlying variables of the data. Here, as well we obtain the graph Laplacian L(R ) ‚àà RN √óN . Then, the eigenvectors and eigenvalues of
(R )
(R ) (R )
L(R ) are given by L(R ) œïj = Œªj œïj . The first dÀÜ(R ) ‚â• 1 nontrivial eigenvectors are chosen based on the following ‚Äúspectral
gap‚Äù thresholding criteria:
(R )

ŒªdÀÜ( R ) +1 < Œ¥

and

(R )

ŒªdÀÜ( R ) +2 ‚â• Œ¥

(12)

where 0 < Œ¥ < 1 is the threshold chosen by the user. Thus,
using (11), we obtain dÀÜ(R ) intrinsic dynamical features of the
respiratory system.
C. Features From the EEG Signal
Given the EEG signal Ek (t) recorded from the kth channel,
we run the analysis described in Section II-B and obtain the
graph Laplacian L(E ,k ) ‚àà RN √óN . Then, the eigenvectors and
(E ,k )
(E ,k ) (E ,k )
eigenvalues of L(E ,k ) are given by L(E ,k ) œïj
= Œªj
œïj
(E ,k )
(E ,k )
(E ,k )
ÀÜ
with 0 = Œª1
‚â§ Œª2
‚â§ . . . The first d
‚â• 1 nontrivial
eigenvectors are chosen based on the thresholding criteria (12)
with the same Œ¥. Using the eigenvectors, each subinterval of
the EEG signal Ek (t) is mapped into a subvector of dÀÜ(E ,k ) dimensions according to (11). By collecting the low-dimensional
vectors
of all the channel, we obtain a vector consisting of
4 ÀÜ(E
,k )
intrinsic dynamical features of the cortical activk =1 d
ity for each subinterval.
D. Sleep Index
We consider the following two feature vectors. The first one
is extracted only from the respiratory signal and is referred as
the Respiratory Index


(R )
(R )
ri := Ai , œÜi , vi , œï2 (i), . . . , œïdÀÜ( R ) +1 (i) .

An analysis result of the O1A2 EEG signal, denoted as

 (E ,1)
(E ,1)
(i), . . . , œï4
(i) , is shown in Fig. 2. Clearly, different
œï2
sleep stages represented in different colors have different features and are well clustered. In addition, these different sleep
stages are organized in a continuous but nonlinear way‚Äîfrom
the right-hand side of the figure to the left-hand side, we have
awake REM, N1 and N2, and deep sleep stages.
Next, the three phenomenological respiratory features, the
dÀÜ(R ) intrinsic respiratory features and the intrinsic dynamical
features of the cortical activity at the ith epochare combined
together to comprise the Sleep Index with p = 4k =1 dÀÜ(E ,k ) +
3 + dÀÜ(R )


si := ri , ei .
E. Sleep Stage Classifier
Support vector machine (SVM) is a commonly used technique for the purpose of classification in statistical learning
theory [32]. In a nutshell, SVM determines a hyperplane in the
space separating the data set into two disjoint subsets, such that
each subset is lying in a different side of the hyperplane. With
the help of the reproducing kernel Hilbert space theory, SVM is
generalized to the kernel SVM, which allows for classification
with nonlinear relationship; that is, a nonlinear surface separating the data set into two disjoints subsets may be used. We refer
the interested reader to [32] for technical details. For the sake
of identifying the (possible) nonlinear relationship between different sleep stages, in this paper, we choose the radial-based

x‚àíx 
2
function (RBF), K(x, x ) = exp(‚àí 2œÉ 2 2 ), where œÉ > 0, as
the kernel function. Note that our dataset is multiclass‚Äîthe response has more than two categories‚Äîtherefore, we need to
further generalize the kernel SVM to the multiclass SVM to
complete our mission. To this end, we apply the one-versusall classification scheme [33]. Despite its simplicity, the oneversus-all classification scheme is highly effective and useful,
as was extensively shown and discussed in [33]. Group data
will be reported as mean ¬± standard deviation unless otherwise
specified.
IV. RESULT
Ten subjects without sleep apnea (AHI less than 5) were
chosen for this study. The demographic characteristics of the
individuals whose data were used are as follows: six males and
four females, age: 45.9 ¬± 12.3 years, range 28‚àí61 years; BMI:
23.6 ¬± 1.9 kg/m2 , range 21.5‚àí28 kg/m2 ; AHI: 1.9 ¬± 1.1, range
0.4‚àí3.4. The total recorded time is of length 384 ¬± 27.8 min
with range 363‚àí443 min and we have a sleep period time of
367 ¬± 27.5 min with range 338‚àí428 min for the sleep stage
estimation.
We divide the whole night sleep into contiguous epochs of
length 2.56 s. We take Œ¥ = 0.01 and the dimension of the Sleep
Index p is 11.2 ¬± 1.69. We consider the sleep stages in this study

The second one is extracted only from the EEG signals and is
R = {Awake, REM, N1, N2, N3} =: {1, 2, . . . , 5}.
referred as the EEG Index
 (E ,1)
 Here, to simplify the notation, we reindex the set of sleep
(E ,1)
(E ,4)
(E ,4)
(i), . . . , œïdÀÜ( E , 1 ) +1 (i), . . . , œï2
(i), œïdÀÜ( E , 4 ) +1 (i) . stages and use the teletype-font to avoid confusion; that is, 1
ei := œï2

WU et al.: ASSESS SLEEP STAGE BY MODERN SIGNAL PROCESSING TECHNIQUES

1165

Fig. 3. Sleep stage prediction error based on the three indices. The upper (resp. lower) subfigure is the SE (resp. specificity) of predicting different sleep stages
by different indices over 25 random subsampling validation repetitions. The black (resp. light gray and dark gray) curve is for the Sleep Index (resp. Respiratory
Index and EEG Index). The x-axis is the subject index ranging from 1 to 10.

is the awake stage, etc. Then, we generate the different indices,
N
N
{si }N
i=1 , {ri }i=1 , and {ei }i=1 , from the recorded EEG and respiratory signals. The sleep stages in R are determined by the
first sleep expert as the ground truth.
The one-versus-all kernel SVM with the RBF kernel with
œÉ = 1 is applied to classify the different sleep stages. Suppose
there are n subintervals with sleep stage , where  = 1, . . . , 5,
in the validation dataset. Denote ni,j to be the number of subintervals with the sleep stage i as the gold standard, but classified
as the sleep stage j. We call the 5 √ó 5 matrix N with the (i, j)th
entry ni,j the confusion matrix. We also define the confusion pern
centage matrix P as a 5 √ó 5 matrix with its (i, j) entry  5 i , jn .
j=1

i,j

We will call Pi,i the sensitivity (SE) of the sleep stage i prediction, which is denoted as SE(i). We
will also report the overall
5
n
accuracy (AC) denoted as AC :=  5 i = 1 ni , i and the specificity
i,j= 1

i,j



nj,j

j = i
(SP) of the sleep stage i denoted as SP (i) :=  
.
k
j = i n j , k
Note that these definitions are direct generalizations of the AC,
SE, and SP of the binary categorical response data.
To prevent overfitting and confirm the classification result, we
run the repeated random subsampling validation 25 times and
evaluate the average. To be more precise, we randomly partition
the data into the training dataset and the validation dataset‚Äîthe
training dataset comprises 80% of the features and the rest are
used to form the validation dataset. The trained classifier based
on the training dataset is applied to predict the sleep stages of
the validation dataset.
With the above preparation, first, we show that the proposed
features capturing the sleep information hidden inside the respiratory signal are not only theoretically rigorously supported,
but also useful in practice. The overall AC is 81.7%. The error
bar of SE and SP of correlating the respiratory Index and the
sleep stages R over 25 repeated random subsampling validation
for the ten subjects is shown in the light gray curve in Fig. 3.
The average SE‚Äôs (resp. SP‚Äôs) over ten subjects for the awake,
REM, N1, N2, and N3 stages are 82%, 89%, 72%, 82%, and
62% (resp. 81%, 81%, 83%, 82%, and 82%).
Second, we show that the EEG Index also correlates with
the sleep stages. The overall AC is 71.6%. The error bar of the
SE and SP over 25 repeated random subsampling validation for
the ten subjects is shown in the dark gray curve in Fig. 3. The

average SE‚Äôs (resp. SP‚Äôs) over ten subjects for the awake, REM,
N1, N2 and N3 stages are 70%, 67%, 50%, 74% and 54% (resp.
70%, 71%, 73%, 65% and 71%).
Next, we combine all the features extracted from the respiratory signal and the EEG signals and show the result is better
than simply using the Respiratory Indices or EEG Indices. The
overall AC is 89.3%. The error bar of the SE and SP over 25
repeated random sub-sampling validation for the 10 subjects is
shown in the black curve in Fig. 3. The average SE‚Äôs (resp. SP‚Äôs)
over 10 subjects for the awake, REM, N1, N2 and N3 stages are
85%, 94%, 79%, 90% and 68% (resp. 89% 89%, 90%, 87% and
90%).
We then apply the Mann-Whitney U test to test if the Sleep Index better predicts sleep stage than the Respiratory Index under
our setup. The p value less than 0.01 is considered significant.
For the 25 realizations of sub-sampling validation from 10 subjects, we obtained 250 SE‚Äôs and 250 SP‚Äôs for different indices
respectively. The Mann-Whitney U test is applied to see if the
SE‚Äôs and SP‚Äôs are significantly different. The performance of the
Sleep Index compared with the Respiratory Index on the awake,
REM, N1, N2 and N3 stages in the sense of SE (resp. SP) are
all significant with p-values < 0.001 (< 0.001).
To better present the classification result, the averaged confusion percentage matrices over all subjects and subsampling
realizations based on the Respiratory Index, EEG Index and the
Sleep Index are shown in Fig. 4. Note that the diagonal entries
are the SE‚Äôs of sleep stage prediction. We also show a typical
hypnogram in Fig. 5 to provide more visible prediction accuracy. Lastly, we compare the agreement among the first and the
second sleep experts. The agreement is on average 86.6% over
all subjects (range: 74.2% ‚àí 93.2%), while the Cohen‚Äôs kappa
among them is on average 78.5% (range: 60% ‚àí 88.4%).
V. DISCUSSION
The results in Section IV show that an accurate estimation
of all sleep stages by solely analyzing the respiratory signal
is possible by combining EIG and SST. Indeed, in addition to
the overall AC 81.7%, the average SE is greater than 72% except N3, and the average SP is greater than 81%. Note how we
combine the proposed techniques to achieve the accuracy‚Äîthe
EIG is applied to extract sleep dynamics information from the

1166

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

Fig. 4. Averaged confusion percentage matrices over all subjects and subsampling realizations based on the Respiratory Index (resp. EEG Index and Sleep Index)
is shown in the left (resp. middle and right) subfigure. The percentage is represented by the color. The darker the entry is, the higher the value is. The precise value
is shown in the color bar on the top of each matrix. Here, 1 (resp. 2, 3, 4 and 5) in the x- and y-axes tick label stands for awake (resp. REM, N1, N2, and N3). It is
clear to see the inclination of misclassifying N3 into N2.

Fig. 5. Typical hypnogram of one subject and the prediction result for the whole night sleep (349 min). To increase the visibility, the first 3-h result is shown on
the top row and the second 3-h result is shown on the bottom row. The sleep stage determined by the sleep expert is plotted in the gray and piecewisely constant
curve. The predicted sleep stages of the testing dataset based on our proposed algorithm are superimposed as the black dots, and the erroneous predictions are
emphasized by the black circles.

features extracted by SST and the scattering operator. Indeed,
the seemingly complicated techniques actually run in a simple
flow‚Äîwe first extract dynamical features from the respiratory
signal by SST and the scattering operator, and then feed these
features to EIG to capture the underlying dynamics ruling the
sleeping cycle. We mention that although not reported, if we
count on the features solely determined by SST or the scattering operator, the result is worse. The main reason is that these
two methods extract different features hidden inside the respiratory signal‚Äîthe scattering operator captures slower dynamical
changes of the shape and structure of the signal, while SST
carries instantaneous information.
On the other hand, we mention that while the features of the
respiratory signal extracted by EIG and SST are complementary,
only EIG can be applied to the EEG signal, since the EEG signal
cannot be modeled by the adaptive harmonic model. The overall
AC based on EIG applied to the EEG signals is 71.8%, the SE
is greater than 67%, except N1 and N3, and the average SP is
greater than 65%. Namely, the performance of the EEG Index
is not better than the respiratory index. Nevertheless, we see

an improvement in the classification performance based on the
sleep index, which contains information from both the respiratory and EEG signals. The overall AC is increased to 89.3%, the
average SE is now greater than 79% except N3, and the average
SP is greater than 87%. In addition, it has been shown that
the SE and SP of the sleep index are significantly better
than those of the respiratory index. Moreover, the confusion
percentage matrices also indicate that except N3, the misclassification does not land in any specific sleep stage. The aforesaid
findings lead to the following two tentative conclusions: 1) in
addition to the EEG signals, the respiratory signal contains ample information about the sleep stage; 2) combining the relevant
but different information hidden inside the respiratory and the
EEG signals leads to a better result.
The main innovation in our sleep depth analysis is the combination of the clinical observation and modern adaptive signal
processing techniques. From the clinical standpoint, we take
the well-known physiological fact that in addition to the brain
activity, sleep is a global dynamical process involving different
subsystem dynamics, in particular, the significant changes in

WU et al.: ASSESS SLEEP STAGE BY MODERN SIGNAL PROCESSING TECHNIQUES

the respiratory pattern among different sleep stages. From the
signal processing standpoint, we emphasize the importance of
the nonlinearity controlling the sleep cycle and focus on finding
suitable mathematical tools not only adaptive to the signal but
also with sufficient rigorousness to quantify the clinical observation. Indeed, since the unaccessible intrinsic sleep dynamics
is reflected in the nonlinear behavior of the respiration, and the
two modern signal processing techniques, EIG and SST, have
being theoretically studied to well quantify this nonlinearity,
we obtain effective features by analyzing the recorded respiratory signal, which surrogate the intrinsic sleep dynamics. While
we do not report in the current paper, if we simply apply DM to
the time series, we obtained without the Mahalanobis distance or
scattering operator, we cannot properly recover the underlying
variables and the classification performance is poor.
The meaning of accuracy deserves some discussion. It is well
known that the sleep stage determination agreement between
different sleep experts is limited to 85% even when the subjects
under examination are normal, and it is even worse on the abnormal subjects [4].2 Although our cases are not diagnosed as
sleep apnea, they cannot be considered as in the normal population either. Also, note that the agreement between different
scorers in our study is on average 86.6%, which is compatible with that reported in [4]. Thereby attaining accuracy rates
higher than 80% in our subjects may not be meaningful. On
the other hand, we found that the classification of N3 stage is
consistently worse and its misclassification tends to land in N2,
as is shown in Fig. 4. Notice that the subjects in our study are
on average 48-years old, and the distribution of N3 sleep stages
in the normal population of this age is 4‚àí20%. However, the
N3 sleep stages in our study cases is 3.1% ¬± 3.26% with 25%
and 75% quantiles 0.8% and 5%, respectively, which is much
fewer than those in the normal population. Since the number
of N3 in the training set is relatively small, even by applying
the weighted SVM to handle the unbalanced data, we do not
expect to attain a compatible classification rate of N3. This unbalanced training set issue, combined with the stable breathing
pattern during N2 and N3, might explain the inclination of misclassifying N3 into N2. Furthermore, while the accuracy of our
classification is compatible with/better than the state-or-art reported results, we are able to better classify between different
sleep stages. Indeed, in [14], the overall accuracy of classifying awake and sleep is 83.6% based on the respiratory signal;
in [13], an averaged respiratory rate classifies REM and NREM
with accuracy over 85%; in [15], a notch filter-based IF estimator
is applied to extract respiratory features, which classifies awake,
REM, and NREM with mean accuracy approximately 70%; in
[17], the IF estimated by SST is shown to be able to distinguish
awake, REM, shallow, and N3 with statistical significance. With
the aforesaid discussions, we conclude that our features and the
selected classifier are accurate.
The sleep depth estimation by the EEG Index is inferior with
respect to the traditional EEG analysis. To understand this result,
2 It is reported in [4] that the mean agreement in the normal subset is higher
(mean 76%, range 65‚Äì85%) than in the subset of sleep disordered breathing
(mean 71%, range 65‚Äì78%).

1167

we briefly revisit how a sleep expert determines the sleep stage.
Based on the protocol criteria, in addition to an EEG signal of
duration that exceeds 30 s, the expert also takes into account
past and future EEG signals to determine the sleep stage. Note
that although these rules have been well established, they are
discovered by humans based on obvious signal features so that
human eyes can interpret. In our study, however, the EEG Index
is based on the signal in epochs of length 2.56 s. The choice
of 2.56-s interval is for the sake of balancing between the dimension and number of data points in EIG. In addition to the
short period, the temporal relationship among EEG signals suggested in the guideline is missing. Note that although the local
covariance structure of the EEG signal is taken into account in
the EIG analysis, this relationship is different from the protocol
criteria. As a result, we do not expect to obtain a compatible
stratification power. Nevertheless, we see that even if we only
focus on these short-term EEG signals, we still can predict the
sleep stage up to some accuracy and it does help to attain a better classification rate when combined with the respiratory index.
This fact indicates that the features we acquire from the EEG
signals are actually finer and hidden deeply inside the signal,
which may not be easily identified by human‚Äôs naked eyes. We
can, thus, view the tool as a ‚Äúmicroscope,‚Äù which helps us parse
the signal and extract different features hidden inside EEG signals. How to integrate these features into sleep stage annotation
is an interesting potential and the study will be reported in the
future work.
The discussion would not be complete without mentioning the
shortcomings of our study. First, we focus on a small database
containing only ten relatively normal subjects in this study. To
confirm the usefulness of the proposed features, we need to study
a larger database with different types of subjects. Second, the
chosen features, in particular the features selected by EIG, are
subject dependent. Indeed, different subjects might have different dynamical systems and the number of dominant components
determined by EIG might vary. A theoretical and practical study
of integrating the proposed features among different subjects is
undergoing.
In conclusion, by applying modern signal processing techniques to respiratory and EEG signals, we find a set of suitable
features, which allow us to predict the sleep stages accurately.
In addition to gaining insight into the dynamics controlling
the sleep dynamics, the automatic annotation system based on
the analysis might lead to an objective classification as well
as reduce the required human expert analysis involved in sleep
evaluation.
ACKNOWLEDGMENT
H.-t. Wu and R. Talmon would like to thank Prof. R. Coifman
for the helpful discussions. The authors would also like to thank
the anonymous referees for their constructive comments that led
to a substantial improvement of this paper.
REFERENCES
[1] T. Lee-Chiong, Sleep Medicine: Essentials and Review. London, U.K.:
Oxford Univ. Press, 2008.

1168

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 4, APRIL 2015

[2] A. Rechtschaffen and A. Kales, A Manual of Standardized Terminology,
Techniques and Scoring System for Sleep Stages of Human Subjects. Washington, DC, USA: Public Health Service, US Government Printing Office,
1968.
[3] C. Iber et al., The AASM Manual for Scoring of Sleep and Associated
Events-Rules: Terminology and Technical Specification. Darien, IL, USA:
Amer. Acad. Sleep Med., 2007.
[4] R. Norman et al., ‚ÄúInterobserver agreement among sleep scorers from
different centers in a large dataset,‚Äù Sleep, vol. 23, no. 7, pp. 901‚Äì908,
2000.
[5] V. Bajaj and R. B. Pachori, ‚ÄúAutomatic classification of sleep stages based
on the time-frequency image of EEG signals,‚Äù Comput. Methods Programs
Biomed., vol. 112, no. 3, pp. 320‚Äì328, 2013.
[6] N. Kannathal et al., ‚ÄúEntropies for detection of epilepsy in EEG,‚Äù Comput.
Methods Programs Biomed., vol. 80, pp. 187‚Äì194, 2005.
[7] S. Blanco et al., ‚ÄúTime-frequency analysis of electroencephalogram series,‚Äù Phys. Rev. E, vol. 51, no. 3, pp. 2624‚Äì2631, 1995.
[8] S. Geng et al., ‚ÄúEEG non-linear feature extraction using correlation dimension and hurst exponent,‚Äù Neurological Res., vol. 33, no. 9,
pp. 908‚Äì912, 2011.
[9] R. Talmon and R. Coifman, ‚ÄúEmpirical intrinsic geometry for nonlinear
modeling and time series filtering,‚Äù Proc. Nat. Acad. Sci., vol. 110, no. 31,
pp. 12 535‚Äì12 540, 2013.
[10] R. Talmon and R. R. Coifman, ‚ÄúIntrinsic modeling of stochastic dynamical
systems using empirical geometry,‚Äù Appl. Comput. Harmon. Anal., 2014,
Tech. Rep. YALEU/DCS/TR1467.
[11] D. Duncan et al., ‚ÄúIdentifying preseizure state in intracranial EEG data
using diffusion kernels,‚Äù Math. Biosci. Eng., vol. 10, pp. 579‚Äì590, 2013.
[12] R. Talmon et al., ‚ÄúManifold learning for latent variable inference in dynamical systems,‚Äù Submitted, 2014, Tech. Report YALEU/DCS/TR1491.
[13] G. S. Chung et al., ‚ÄúREM sleep classification with respiration rates,‚Äù
in Proc. 6th Int. Special Topic Conf. Inf. Technol. Appl. Biomed., 2007,
pp. 194‚Äì197.
[14] G. Guerrero-Mora et al., ‚ÄúSleep-wake detection based on respiratory
signal acquired through a pressure bed sensor,‚Äù in Proc. Annu. Int. Conf.
Eng. Med. Biol. Soc., 2012, pp. 3452‚Äì3455.
[15] J. Sloboda and M. Das, ‚ÄúA simple sleep stage identification technique for
incorporation in inexpensive electronic sleep screening devices,‚Äù in Proc.
IEEE Nat. Aerosp. Electron. Conf., 2011, pp. 21‚Äì24.
[16] H.-T. Wu, ‚ÄúInstantaneous frequency and wave shape functions (I),‚Äù Appl.
Comput. Harmon. Anal., vol. 35, pp. 181‚Äì199, 2013.
[17] Y.-C. Chen et al., ‚ÄúNonparametric and adaptive modeling of dynamic
seasonality and trend with heteroscedastic and dependent errors,‚Äù J. Roy.
Stat. Soc. B, vol. 76, pp. 651‚Äì682, 2014.

[18] R. Talmon et al., ‚ÄúDiffusion maps for signal processing: A deeper look at
manifold-learning techniques based on kernels and graphs,‚Äù IEEE Trans.
Signal Process., vol. 30, no. 4, pp. 75‚Äì86, Jul. 2013.
[19] I. Daubechies et al., ‚ÄúSynchrosqueezed wavelet transforms: An empirical
mode decomposition-like tool,‚Äù Appl. Comput. Harmon. Anal., vol. 30,
pp. 243‚Äì261, 2011.
[20] M. Engoren, ‚ÄúApproximate entropy of respiratory rate and tidal volume
during weaning from mechanical ventilation,‚Äù Critical Care Med., vol. 26,
pp. 1817‚Äì1823, 1998.
[21] G. Benchetrit, ‚ÄúBreathing pattern in humans: Diversity and individuality,‚Äù
Respir. Physiol., vol. 122, no. 2/3, pp. 123‚Äì129, 2000.
[22] M. Wysocki et al., ‚ÄúReduced breathing variability as a predictor of unsuccessful patient separation from mechanical ventilation,‚Äù Critical Care
Med., vol. 34, pp. 2076‚Äì2083, 2006.
[23] H.-T. Wu et al., ‚ÄúEvaluating physiological dynamics via synchrosqueezing: Prediction of ventilator weaning,‚Äù IEEE Trans. Biomed. Eng., vol. 61,
no. 3, pp. 736‚Äì744, Mar. 2013.
[24] A. Singer and R. R. Coifman, ‚ÄúNon-linear independent component analysis with diffusion maps,‚Äù Appl. Comput. Harmon. Anal., vol. 25, no. 2,
pp. 226‚Äì239, 2008.
[25] R. R. Coifman and S. Lafon, ‚ÄúDiffusion maps,‚Äù Appl. Comput. Harmon.
Anal., vol. 21, no. 1, pp. 5‚Äì30, 2006.
[26] S. Mallat, ‚ÄúGroup invariant scattering,‚Äù Pure Appl. Math., vol. 10, no. 65,
pp. 1331‚Äì1398, 2012.
[27] J. Bruna et al., ‚ÄúMultiscale intermittent process analysis by scattering,‚Äù
Submitted, arXiv:1311.4104, 2013.
[28] M. Belkin and P. Niyogi, ‚ÄúConvergence of laplacian eigenmaps,‚Äù in Proc.
Conf. Adv. Neural Inf. Process. Syst. 19, 2007, vol. 19, p. 129.
[29] A. Singer and H.-T. Wu, ‚ÄúSpectral convergence of the connection laplacian
from random samples,‚Äù Submitted, 2013.
[30] N. El Karoui, ‚ÄúOn information plus noise kernel random matrices,‚Äù Ann.
Stat., vol. 38, no. 5, pp. 3191‚Äì3216, 2010.
[31] N. El Karoui and H.-T. Wu, ‚ÄúConnection graph Laplacian methods can be
made robust to noise,‚Äù Ann. Stat., 2014, accepted for Publication.
[32] B. Scholkopf and A. Smola, Learning With Kernels. Cambridge, MA:
MIT Press, 2002.
[33] R. Rifkin and A. Klautau, ‚ÄúIn defense of one-vs-all classification,‚Äù J.
Mach. Learn. Res., vol. 5, pp. 101‚Äì141, 2004.

Authors‚Äô photographs and biographies not available at the time of publication.

