2724

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Neonatal Seizure Detection Using Atomic
Decomposition With a Novel Dictionary
Sunil Belur Nagaraj∗ , Student Member, IEEE, Nathan J. Stevenson, Member, IEEE,
William P. Marnane, Member, IEEE, Geraldine B. Boylan, and Gordon Lightbody, Member, IEEE

Abstract—Atomic decomposition (AD) can be used to efficiently
decompose an arbitrary signal. In this paper, we present a method
to detect neonatal electroencephalogram (EEG) seizure based on
AD via orthogonal matching pursuit using a novel, applicationspecific, dictionary. The dictionary consists of pseudoperiodic Duffing oscillator atoms which are designed to be coherent with the
seizure epochs. The relative structural complexity (a measure of
the rate of convergence of AD) is used as the sole feature for
seizure detection. The proposed feature was tested on a large clinical dataset of 826 h of EEG data from 18 full-term newborns
with 1389 seizures. The seizure detection system using the proposed dictionary was able to achieve a median receiver operator
characteristic area of 0.91 (IQR 0.87–0.95) across 18 neonates.
Index Terms—Complex dictionary, neonatal electroencephalogram (EEG), orthogonal matching pursuit (OMP), seizure
detection.

I. INTRODUCTION
EONATAL seizures are most commonly caused by conditions such as hypoxic ischemic encephalopathy, stroke,
and infection and occur at the rate of 1–3/1000 births [1].
Seizures are caused by an imbalance between the excitatory
and inhibitory influences in the neonatal brain [2]. Neonates
with seizures are also at higher risk of developing epilepsy in
later life [3]. Neonatal seizures occur within several days of birth
and are associated with increased damage to the brain [4]–[6].
As a result, most clinicians aggressively treat neonatal seizures
with antiepileptic drugs (AEDs) such as phenobarbitone, phenytoin, midazolam, and lignocaine [7], [8]. These AEDs are not
without side effects and the decision to treat requires careful
consideration. The accurate identification of seizures is critical
when administering AEDs and for monitoring the response of
these AEDs.

N

Manuscript received February 19, 2014; revised April 16, 2014; accepted May
14, 2014. Date of publication May 29, 2014; date of current version October 16,
2014. This work was supported by the Science Foundation Ireland under Grant
SFI/10/IN.1/B3036 and the Science Foundation Ireland Research Centres under
Award 12/RC/2272. Asterisk indicates corresponding author.
∗ S. B. Nagaraj is with the SFI INFANT Research Centre and the Department
of Electrical Engineering, University College Cork, Cork, Ireland (e-mail:
sunil@eleceng.ucc.ie).
N. J. Stevenson and G. B. Boylan are with the SFI INFANT Research Centre
and the Department of Pediatrics and Child Health, University College Cork,
Cork, Ireland (e-mail: n.stevenson@ucc.ie; g.boylan@ucc.ie).
W. P. Marnane and G. Lightbody are with the SFI INFANT Research Centre
and the Department of Electrical Engineering, University College Cork, Cork,
Ireland (e-mail: l.marnane@ucc.ie; g.lightbody@ucc.ie).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2326921

In neonates, only about one-third of all neonatal seizures
are clinically visible and many remain undetected in the busy
NICU [9]. The electroencephalogram (EEG) is the gold standard for the detection of seizures in the NICU [2], [10]. The
electrographic manifestation of seizures in neonates is quite
different from that in adults: the frequency content is often
much slower (down to 0.3 Hz), and the background patterns
differ greatly from that seen in the adult [11]. In general,
the detection of neonatal seizures requires specific expertise
and is performed by visual interpretation of the neonatal EEG
by an experienced neurophysiologist or paediatric neurologist.
However, this expertise is not acutely available on a 24 h
basis in most NICUs. For this reason, methods for the automated detection of seizures in the NICU can provide valuable
information to the clinician facilitating medical intervention
[12].
The automated detection of seizures attempts to classify the
EEG into two states: nonseizure and seizure. The nonseizure
EEG consists of background EEG, which can be modeled as an
amplitude-modulated, colored random noise process contaminated by several sources of artefact of electrical and biological
origin [13]–[15]. The seizure patterns in the newborn EEG, however, are more highly structured and characterized by periods of
rhythmic spiking or repeated sharp waves [16], [17].
A number of groups have published methods to automatically detect neonatal seizures using linear, nonlinear, and nonstationary signal analysis (see [16] and [18]–[22]). A method
for detecting seizures based on atomic decomposition (AD) was
outlined in [15] and was inspired by the analysis of Durka et al.
[23]. AD is a nonstationary signal analysis technique, in which a
nonstationary signal is optimally decomposed into atoms drawn
from an overcomplete (redundant) dictionary. The main advantage of AD is that the dictionary of atoms can be designed
to suit the application, resulting potentially in a sparse signal
representation; this sparsity is useful in signal classification.
Several techniques have been proposed for the optimal selection of atoms in AD; these include the matching pursuit (MP),
basis pursuit (BP), and orthogonal matching pursuit (OMP) algorithms [24]–[26]. Rankine et al. proposed a novel measure
called relative structural complexity (RSC) which is based on
analyzing the convergence of an AD implemented with an MP
estimate of atom weights. In this context, convergence refers
to the rate at which AD via MP approximates the signal [15].
The RSC, however, is highly dependent on the coherence of
the dictionary with the signal classes under analysis. For high
seizure discrimination, the atoms in the dictionary should have a
high coherence with seizure (low RSC) and low coherence with

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

NAGARAJ et al.: NEONATAL SEIZURE DETECTION USING ATOMIC DECOMPOSITION WITH A NOVEL DICTIONARY

nonseizure (high RSC). Rankine et al. [15] used a dictionary,
based on the modeling of neonatal EEG seizure, that consisted
of linear frequency-modulated (LFM) atoms and Gabor atoms
to complete the dictionary.
Recent developments in modeling the neonatal EEG may provide a better choice of dictionary [27]. These advances suggest
that using a dictionary based on short duration wideband atoms
rather than narrowband atoms may result in an RSC that is better
able to differentiate between seizure and nonseizure.
In this paper, we have expanded our preliminary study on AD
in which we compared several dictionaries for seizure detection
[28]. We first modify the RSC feature for computational reliability. As RSC is dependent on the type of dictionary used in AD,
a new dictionary based on the Duffing oscillator is developed
where atoms in the dictionary are highly coherent with neonatal
seizure. The use of the RSC with the proposed dictionary was
compared to the RSC with several other dictionaries for the detection of neonatal seizures. The effect of dictionary size and
decomposition level was also investigated. The performance of
the RSC for neonatal seizure detection was then estimated on
a large database of neonatal EEG using leave-one-out (LOO)
cross validation.
II. NEONATAL EEG DATA
The dataset consisted of EEG recordings from 18 neonates
who had seizures. The EEG recordings were recorded in the
NICU of the Cork University Maternity Hospital, Cork, Ireland.
The patients were full-term neonates ranging in gestational age
from 39 to 42 weeks. The EEG was recorded using the Viasys
NicOne EEG system, with a sampling frequency of 256 Hz.
The data were annotated using eight EEG channels in bipolar
montage: F4-C4, C4-O2, F3-C3, C3-O1, T4-C4, C4-Cz, Cz-C3,
and C3-T3. All seizures were annotated independently by two
experienced neonatal electroencephalographers with the assistance of simultaneously recorded video. Any disagreement in
annotations was resolved by consensus. The median recording
length was 50.6 h (IQR: 29.7–59.8 h) with a combined recording
duration of 826 h. There were 1389 recorded seizures including
both electrographic-only and electroclinical seizures of focal,
multifocal, and generalized types with a mean duration of 194 s
(median 249 s, IQR 96–356 s). The ratio of seizure to nonseizure
duration had a median of 5.9%, IQR (4.2–12.1%). Additional
details of this database can be found in [29]. All EEGs were
recorded with informed parental consent and under ethical approval of the CUMH and the University College Cork. All data
were anonymized at the time of recording. The EEG was downsampled from 256 to 32 Hz with an antialiasing filter set at 12.8
Hz, as the significant energy in the newborn EEG (> 95%) does
not exceed alpha band (8–12 Hz) [30]. The data were also filtered with a single pole high-pass filter with a cutoff of 0.5 Hz
and then segmented into 8-s epochs with a 4-s overlap.
III. SEIZURE DETECTION USING AD
AD is a technique that uses a large dictionary of signal atoms
to efficiently represent a given signal. Given a complex dictionary of M atoms D = [φ1 φ2 . . . φM ] ∈ C N ×M , where each

2725

column represents a single atom of length N and M ≥ N , a
signal x ∈ RN can be represented as
x = 2{Dγ}

(1)

where γ is an M × 1 vector containing the analysis coefficients
[31]. The aim of AD is to estimate γ to find a suitable approximation of the signal. Ideally, γ should contain a minimum
number of nonzero coefficients for a given approximation accuracy (a sparse solution). MP was originally proposed by Mallat
and Zhang [24]. It is a greedy algorithm that selects atoms using
a maximum inner product criteria. The coefficient value is the
maximum inner product. MP is iterated until a certain level of
signal approximation is achieved. BP uses linear programming
to minimize the L1 -norm, but unlike MP, the BP decomposition technique does not select atoms iteratively. The use of the
L1 -norm attempts to minimize the number of atoms used to
approximate a signal at a given level. It was shown that MP
provides a sparser signal approximation when compared to BP
[32]. OMP uses the same criteria as MP for atom selection but
estimates the entire coefficient vector using pseudomatrix inversion at each iteration in order to minimize the mean square
error. As a result, OMP will not select an atom more than once.
In this paper, we have used the OMP to decompose neonatal
EEG [26] as OMP has a faster convergence rate. By convergence, we refer to the rate at which OMP approximates the
signal. The OMP algorithm using a complex dictionary can be
summarized as follows [26], [31]:
1) Initialize the residual r0 = x, the index set Ψ0 = ∅, the
dictionary D0 = ∅, and the iteration count k = 1.
2) Find ǐ = arg max |rTk −1 φi |, φi ∈ D.
i∈
/ Ψ k −1

3) Update the index set Ψk = Ψk −1 ∪ ǐ and the active dictionary, Dk = [Dk −1 : φǐ ] ∈ C N ×k .
4) Estimate γ k by solving a least squares problem using Moore–Penrose pseudoinverse method [33], γ k =
arg min x − 2{Dk γ}2 .
γ ∈ Ck

5) Update the residual, rk = rk −1 − 2{Dk γ}.
6) Update the iteration count, k = k + 1. Repeat from Step
2 until the given stopping criteria is reached (k = K).
After K iterations, the OMP provides the sparse approximation of the input signal x as
x̂ = 2{DK γ K }.

(2)

Given a full-rank dictionary and large enough K, x = x̂.
AD via MP has been used as the basis of a method to detect neonatal seizures in the EEG [15]. This method exploited
differences in the rate of convergence of the MP algorithm for
seizure detection (the dictionary was chosen so that AD converged faster for seizures compared to nonseizure). The rate of
convergence was measured using the number of atoms required
to reach a set signal-to-error ratio (SER). The SER at a given
level of decomposition, K, is given by


x2
(3)
SERK = 20log10
rK 2
where x is the input EEG signal and rK is the residual obtained
after K iterations of AD. In our present study, we have used

2726

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Fig. 1. Neonatal seizure detection system based on atomic decomposition. The input signal is passed through an antialiasing filter set at 12.8 Hz, downsampled
to 32 Hz and segmented into 8-s epochs with 4-s overlap. Sharp transients in the RSC output are then suppressed using a median filter of 32 s in duration. The
maximum RSC across all channels was then computed. The RSC decision threshold was varied and seizure was detected if it exceeded a set threshold. An adaptive
collar was then applied to extend the duration of the preliminary detection. An automated annotation of seizure is then obtained.

the SER after K OMP iterations to define the RSC. A set decomposition level, rather than approximation level, was used
as it ensures that the OMP algorithm will be computationally
tractable.
In order to enhance the ability of the RSC to separate seizure
from nonseizure, an application specific dictionary was introduced by Rankine et al. [15]. This dictionary was based on a
model of EEG seizure and consisted of a series of LFM sinusoids supplemented by Gabor atoms in order to generate a
full-rank dictionary. Our current work investigates the use of alternate dictionaries with the aim of improving seizure detection.
The results of this investigation were used to develop a seizure
detection algorithm (SDA) based on AD (see Fig. 1 ). The main
structural difference to the SDA proposed by Temko et al. (apart
from the feature used) is in the postprocessing stage. A mean
operation is substituted with a median operation and the fixed
collar is replaced with an adaptive collar. The adaptive collar
extends the detection results in proportion to the initial detection
duration and is constrained from 30 to 80 s such that ac = 30 s
when Td < 30 s, ac = Td when 30 ≤ Td ≤ 80 s, and ac = 80 s
when Td > 80 s, where Td is the duration of the detected seizure
(in seconds). The assumption of this collar is that the decay in
seizure amplitude is proportion to its duration.
IV. DICTIONARIES FOR SEIZURE DETECTION
In this paper, a complex dictionary is utilized. The use of a
complex dictionary improves the convergence rate of the OMP
algorithm as additional phase information can improve the alignment of atoms in time. Consider the general mother atom g(t; λ)
for some particular parameter vector λ ∈ Λ. The analytic associate of each atom can then be generated using the Hilbert
transform.
The complex dictionary D ∈ C N ×M is then constructed from
the sampled version of the complex mother atom. The complex
dictionary is D = [φ1 φ2 . . . φM ], where the ith complex atom
φi is the time-sampled version of the complex mother atom with
parameter vector choice λi ∈ Λ = {λ1 , λ2 , . . . , λM }. Hence,
for a given signal duration of T and sample time Ts seconds,
we can express the nth element of φi as
φi (n) = g(nTs ; λi ) + jḡ(nTs ; λi ) = g + jH(g)

(4)

where 0 ≤ nTs < T .
A. Gabor Dictionary: DG ∈ C N ×M G
As a benchmark, we first used a Gabor dictionary consisting
of translated (α), scaled (m), and modulated (β) versions of a
Gaussian window to test the proposed SDA
t −α 2
1
gG (t; λG ) = √ e−π ( m ) sin(βt)
m

(5)

where λG = [α, m, β]T ∈ ΛG are the time–frequency parameters. Here, T = 8 s is the time duration of the EEG epoch, Ts =
1/fs , fs = 32 Hz, and N = 256.
The result of AD on an epoch of seizure and nonseizure
EEG is shown in Fig. 2(i). As the Gabor dictionary is more
coherent with seizure, due to its inherent structure, AD provides
a more accurate representation of seizure, at a set decomposition
level, than nonseizure. Fig. 2(ii) shows the changes in RSC with
respect to the number of atoms used for decomposition.
B. LFM Dictionary: DL ∈ C N ×M L
The dictionary proposed by Rankine et al. consisted of LFM
atoms as it had been shown that the variation in the frequency
content of seizure could be broadly categorized with a piecewise
linear function [15], [34]. The set of LFM atoms used were of
the form
  2

π at
+ 2bt .
(6)
gL (t; λL ) = A(λL ) cos
fs fs
Here, the parameter vector λL = [a b]T ∈ ΛL , fs is the sampling frequency (Hz), a (Hz/s) is the frequency rate, and b (Hz)
is the initial frequency. For each choice of λL ∈ ΛL , the normalizing constant A(λL ) is chosen such that gL (t; λL )2 =1.
C. Duffing Dictionary: DD ∈ C N ×M D
Recent advances in modeling the neonatal EEG seizure signal
offer the potential to improve the dictionary used for seizure
detection [27]. An alternate model of neonatal EEG seizure was
based on a Duffing oscillator. Seizure was modeled as
ẍ(t) = u(t) − cẋ(t) − k2 x3 (t)

(7)

NAGARAJ et al.: NEONATAL SEIZURE DETECTION USING ATOMIC DECOMPOSITION WITH A NOVEL DICTIONARY

2727

Fig. 3. Example atoms in the dictionaries corresponding to (a) Gabor,
(b) LFM, (c) Duffing, and (d) pseudoperiodic Duffing dictionaries, respectively.
(e) Complex Duffing oscillator atom obtained after Hilbert transform (− real,
−− imaginary atom).

This results in an atom defined as


P (a,b)−1

gD̃ (t; λD̃ ) =

h ((t − τp (a, b)); c, k2 )

(9)

p=0

where λD̃ = [c, k2 , a, b]T
⎛
τp (a, b) = fs ⎝

Fig. 2. Illustration of atomic decomposition of an 8-s EEG epoch using a
variable number of Gabor atoms. (i) a, b, c are the actual (x), reconstructed
(x̂), residual seizure epoch (r), and d, e, f are the actual (x), reconstructed (x̂),
residual nonseizure epoch (r), respectively, using 15 atoms, and (ii) RSC for 15
8-s seizure and nonseizure epochs for 1–25 atoms (−seizure, −− nonseizure).

where x(t) represents the recorded EEG voltage, [c, k2 ] are the
nonlinear spring constant and damping coefficient, respectively,
and u(t) is an impulse train with time-varying period [27]. The
set of Duffing atoms used were of the form
gD (t; λD ) = h ((t − τ ); c, k2 )

(8)

where λD = [c, k2 , τ ]T ∈ ΛD ,τ ∈ {Ts , 2Ts , . . . , N Ts } is the
time shift.
D. Pseudoperiodic Duffing Dictionary: DD̃ ∈ C N ×M D̃
This dictionary was based on a pseudoperiodic sequence of
Duffing outputs, which captures both the morphological and
repetitive characteristics of seizure in a single atom. As the
random nature of the periodicity used in [27] precludes a systematic implementation of a dictionary, the linear instantaneous
frequency laws outlined in Rankine et al. were used instead.

−b +

	

b2 + a(2p + 12 )
a

p = [0, 1, . . . , P (a, b) − 1]


2aT 2 + 4 ab T − 1
P (a, b) =
4

⎞
⎠

(10)

where (.) is the floor operator.
The various atoms described above are illustrated in Fig. 3(a)–
(d). As an example, a complex Duffing oscillator atom, obtained
using the Hilbert transform, is shown in Fig. 3(e). In addition to
the aforementioned dictionaries, we also used a standard Fourier
dictionary (DF ) for the purpose of comparison.
V. TRAINING AND TESTING
A LOO cross-validation method was used in this paper to
assess the performance of the proposed algorithm for patientindependent seizure detection. This approach is known to provide an almost unbiased estimation of the generalization error
[36] and is in keeping with the development of a patient independent SDA [37]. For each iteration within the LOO framework
adopted here, the continuous unpruned dataset from one neonate
was first reserved as an unseen testing set. A training set consisting of 85 min of seizure data and 850 min of nonseizure data was
then selected from the EEG data of the remaining 17 neonates
(5 min of seizure and 50 min of nonseizure per patient). The

2728

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

parameters of the seizure detection scheme (dictionary type,
size, and decomposition level) were then selected to provide the
optimal performance over the training set. This trained algorithm was then tested on the continuous unpruned multichannel
EEG data from the remaining (left out) neonate and the performance reported. This process was repeated (total number of
iterations here is 18) until the data from each neonate had been
used once for testing.
The area under the receiver operator characteristic (ROC)
curve (AUC) was used as an epoch-based performance metric
for the training phase and for each unseen test neonate. The
ROC curve displays the relationship between the sensitivity
of the algorithm and its specificity as a single classification
threshold is varied. The sensitivity and specificity are defined as
T P/(T P + F N ) and T N/(T N + F P ), respectively, where
TP is the number of seizure epochs correctly detected as seizure,
FP is the number of nonseizure epochs incorrectly detected
as seizure, TN is the number of nonseizure epochs correctly
detected as nonseizure, and FN is the number of seizure
epochs incorrectly detected as nonseizure. The individual
ROC curves of all the test neonates were combined (mean or
median) to provide an estimate of the performance curve of
the algorithm over unseen data. The AUC provides a good
estimate of the ability of the algorithm to discriminate between a
seizure and a nonseizure epoch from a new, unseen neonate [38].
For each dictionary (except DF ), an overcomplete dictionary
was first constructed from d subdictionaries as
DD = [D1 D2 · · · Dd ] ∈ C N ×dN .

(11)

In the training phase, the P “best” subdictionaries are then
selected from this overcomplete dictionary, to produce the optimal AUC. This then yields an optimal trained dictionary of size
M = PN.
For the Gabor overcomplete dictionary, seven subdictionaries were constructed with atom parameters chosen from the
dyadic sequence of integers: m = 2q , 0 ≤ q ≤ L, N = 2L , α ∈
{2, 4, 8, 16, 32, 64, 128}, and β ∈ {128, 64, 32, 16, 8, 4, 2}.
For the LFM overcomplete dictionary, a single (N × N/2)
LFM subdictionary was constructed for N/2 possible choices
of a and b (a ∈ [−0.06, 0.06] Hz/s and b ∈ [0.25, 8.5] Hz). In
order to span the TF plane, additional Gabor atoms were used to
fill the high frequency segment of the TF plane (8–16) Hz [24],
[35]. This dictionary was augmented with six (N × N ) Gabor
subdictionaries to form an overcomplete dictionary.
In the Duffing and pseudoperiodic Duffing dictionary, it was
important that the overcomplete dictionary captured the wide
variety of seizure impulses seen in practice. For the Duffing
overcomplete dictionary, 37 (N × N ) subdictionaries were generated by sampling the distribution of [c, k2 ] in [27, Fig. 5].
However, for the pseudoperiodic Duffing overcomplete dictionary, each subdictionary corresponded to N choices of a and b
obtained from the LFM dictionary.
The optimized method for estimating the RSC was then
tested on the full recording of the remaining neonate and used
to generate an automated annotation of seizure (see Fig. 1).
The level of agreement between the human and automated

Fig. 4. Training results for several different dictionaries on the training sets.
(a) AUC versus number of atoms and (b) AUC versus dictionary size. AUC is the
median AUC across 18 training folds of the LOO. Note, the Fourier dictionary
cannot be increased above 256 atoms.

TABLE I
PERFORMANCE OF THE SDA FOR EACH UNSEEN TEST PATIENT
ID

AUC

Sens

Spec

SN

MSD

SDR0 . 5

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18

0.74
0.70
0.94
0.90
0.63
0.85
0.91
0.89
0.92
0.91
0.99
0.96
0.95
0.95
0.92
0.92
0.91
0.96

64.3
65.2
86.4
84.2
58.6
74.3
83.1
81.3
82.5
83.4
95.6
90.3
91.2
91.6
82.3
84.5
83.4
91.2

66.5
67.8
87.5
85.6
56.8
76.4
81.7
78.5
87.6
84.5
94.4
89.5
90.4
88.7
81.5
81.3
87.6
90.5

17
3
209
84
62
46
99
17
201
41
43
150
60
21
121
190
21
4

90
370
110
98
397
68
92
356
299
291
147
96
206
493
91
303
331
574

52.9
66.6
72.1
77.6
55.3
65.4
85.5
76.5
75.3
68.1
86.2
84.5
98.5
85.6
62.3
81.2
57.5
99.4

Here, ID = Patient ID, Sens = Sensitivity (%), Spec =
Specificity (%), SN = Number of seizures, MSD = Mean
seizure duration (seconds), and SDR0 . 5 = SDR at 0.5 FD/H.

annotation of seizure was then assessed using time (sensitivity
and specif icity) and event [seizure detection rate (SDR) and
false detections per h (FD/h)] based metrics [39]. After testing,
a subset of false and true seizure detections were analyzed [40].
VI. RESULTS
The effect of dictionary type, dictionary size, and decomposition level is shown in Fig. 4. The maximum likelihood estimate
across the training iterations would result in a RSC calculated
using a pseudoperiodic Duffing dictionary (DD̃ ) of size 2N and
a decomposition level of five atoms. A median AUC of 0.92
(mean = 0.91) was obtained across training folds.

NAGARAJ et al.: NEONATAL SEIZURE DETECTION USING ATOMIC DECOMPOSITION WITH A NOVEL DICTIONARY

2729

TABLE II
EFFECT OF DICTIONARY TYPE AND POSTPROCESSING ON THE PERFORMANCE
OF THE PROPOSED SDA WHEN APPLIED TO EACH TEST FOLD (N = 18)
Dictionary type

without postprocessing

with adaptive collaring

Mean

Median
(IQR)

Mean

Median
(IQR)

D D̃

0.79

0.88

DL

0.72

DD

0.68

DF

0.63

DG

0.66

0.81
(0.72–0.84)
0.73
(0.68–0.81)
0.69
(0.58–0.77)
0.64
(0.58–0.68)
0.67
(0.62–0.77)

0.91
(0.87–0.95)
0.78
(0.70–0.87)
0.77
(0.64–0.87)
0.79
(0.66–0.85)
0.71
(0.62–0.84)

0.76
0.75
0.75
0.70

Mean, median, and IQR of the AUC are presented.

TABLE III
TESTING RESULTS (MEDIAN) USING THE PROPOSED SDA AT SEVERAL FD/H
FD/h
0.1
0.5
1.0

SDR (IQR) %

Sensitivity (IQR) %

Specificity (IQR) %

56.5 (50.5–65.2)
75.9 (65.4–85.5)
82.3 (78.8–93.2)

53.5 (48.4–65.6)
63.9 (58.6–75.8)
82.5 (76.2–90.3)

97.5 (93.6–98.8)
93.4 (86.3–95.4)
86.5 (75.9–91.7)

The performance of the SDA for each patient (test fold) is
given in Table I. Table II demonstrates how the performance of
the algorithm, as measured by the mean or median AUC of the
ROC across all testing folds, depends on the dictionary type and
the use of the adaptive collar. The use of the pseudoperiodic
Duffing dictionary as a basis for AD and the addition of postprocessing stages improved the performance of the SDA. Time
and event based metrics at 0.1, 0.5, and 1.0 FD/h are shown in
Table III. The SDA has a median SDR of 82.3% at 1 FD/h and
56.5% at 0.1 FD/h (a more clinically relevant threshold [41]).
An example illustrating the behavior of the RSC corresponding
to seizure and nonseizure is shown in Fig. 5. It can be seen that
the RSC increases in the presence of seizure since the atoms selected during AD are coherent with seizure, thereby decreasing
the reconstruction error. A comparison of the SDA performance
and other methods reported in the literature is shown in Fig. 6.
While the comparison of SDA performance is fraught with difficulty [29], the proposed SDA has comparable performance with
existing methods.
The signal characteristics of the false and detected seizures
for a defined false alarm rate of 1 FD/h were investigated with
other quantitative measures of EEG [40]. The results are shown
in Table IV. The spectral entropy and AR fit show significant difference between correctly detected seizures and false detections
across the cohort of 18 neonates.
Fig. 7 shows the performance of the proposed SDA with
respect to the seizure duration. Seizures less than 30 s in duration were more difficult to detect and the largest amount of
false detections were less than 30 s in duration. EEG recordings from three neonates resulted in significantly reduced SDA

Fig. 5. Example of the behavior of the proposed RSC for patient 3. (a) raw
100-s single channel (F4-C4) EEG with a seizure event emerging from low
voltage activity and (b) its corresponding RSC. Note that RSC increases in the
presence of seizure as the atoms in the dictionary are coherent with seizure
which provides improved reconstruction of seizure compared to nonseizure.

Fig. 6. Performance curves of the proposed SDA. These are the ROC and the
SDR/false detections per hour curves, determined as the median over the 18
unseen neonates in the LOO cross-validation. These curves present an almost
unbiased estimate of the performance of the proposed SDA on unseen data.
As a comparison, the performance curves of Temko et al. [29] are included.
The reported results of other key research groups are also reported here for
comparison [18], [21], [22], [42], [44].

performance. Fig. 8 shows the distribution of mean RSC for
high (15/18) and low (3/18) performing neonates.
VII. DISCUSSION
In this paper, a method for the detection of neonatal seizures
from EEG is presented. The method was based on a single feature (RSC) of the EEG signal which was defined as the SER
obtained using a set number of atoms for decomposition. It was
observed that the number of atoms used to decompose the signal and the size of the dictionary can significantly improve the
detection performance of the RSC feature. The major factor in
RSC performance was, however, the type of dictionary used for

2730

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

TABLE IV
ANALYSIS OF SOME ADDITIONAL FEATURES ON TRUE (TD) AND FALSE (FD)
SEIZURE DETECTIONS BY THE SDA AT 1 FD/H

Feature
RMS amplitude(μV)
Maxima and minima
Number of extrema
AR Fit
Bandwidth
Spectral Entropy

Detected seizures

False alarms

median
(IQR)

median
(IQR)

15.3
(7.78–24.25)
50
(26–56)
4.74
(3.44–7.87)
0.64
(0.34–1.11)
2.95
(2.15–4.23)
0.42
(0.34–0.55)

16.3
(13.72–20.98)
38
(23–46)
5.79
(4.25–7.16)
1.19
(1.10–1.39)
3.67
(3.20–4.19)
0.63
(0.52–0.68)

p-value
p = 0.889
p = 0.289
p = 0.962
p = 0.002
p = 0.091
p = 0.001

The median was used to summarize the feature value across each neonate. A
Mann Whitney U test was used to test the difference between TDs and FDs
across the cohort of neonates (N = 18). For details on the features, see [40].

Fig. 7. Illustration of the SDR (%) and corresponding number of false detections of seizures of different duration by the proposed SDA at 1 FD/h using
testing data. Most false detections occur when the duration of seizure is less than
30 s. As the duration of seizure increases, the SDR increases and the number of
false detections decreases.

AD. We show that a novel pseudoperiodic dictionary based on
Duffing atoms results in an RSC with superior seizure detection
performance. Atoms in the pseudoperiodic Duffing dictionary
have a high correlation with seizure waveforms and a low correlation with nonseizure waveforms. As a result, the RSC will
increase in the presence of seizure. As seizure tends towards a
higher energy than nonseizure, further increases in the RSC are
observed, due to the improved SER.
It should be noted that there is a large difference in the training
and testing results (mean AUC = 0.91 versus 0.79). This is
most likely due to the fact that the training data consisted of
single channel EEG epochs whereas testing is performed on
multichannel EEG recordings which require a postprocessing
stage (a maximum across EEG channels) to generate a decision.
The effect of this maximum operation is not examined during

Fig. 8. Boxplot showing the distribution of RSC (mean values) obtained for
all seizure and nonseizure epochs for (a) 15/18 high performing and (b) 3/18
low performing neonates using testing data.

training. The use of further postprocessing (a median filter and
collaring operation), however, alleviated this difference (mean
AUC = 0.91 versus 0.88).
There are many SDAs proposed in the literature, although
a fair comparison between methods is difficult [29], as there
are 1) differences within datasets used and 2) methodological differences particularly when validating a SDA. The differences in datasets mean that only some datasets reflect the
reality of neonatal monitoring for seizures and so permit the
robustness of an SDA to be tested. There is also large differences in the prevalence index (typically, EEG consists of 90%
more nonseizure than seizure) of the datasets which means that
traditional methods of assessing agreement such as Cohen’s
Kappa statistic are highly variable and, therefore, not sufficient.
This results in a large array of different metrics for the analysis
of SDA performance [29]. Methodological differences include
cross-pollination between training and testing data resulting in
optimistic assessments of SDA performance.
The proposed SDA is conceptually similar to that in [18]
and [22], but rather than attempting to estimate periodicity by
looking at the correlation between the outputs of an adaptive
segmentation procedure, the correlation is performed between
the EEG signal and a dictionary of possible nonstationary atoms.
The performance of the proposed SDA (see Fig. 6) is comparable to these methods (mean SDR = 0.82 versus 0.89, 0.88)
(see [18] and [22]). It should be noted that Navakatikyan et al.
and Deburchraeve et al. trained and tested on the same data.
The performance of the proposed SDA was similar to that of
the multistage neonatal SDA proposed by Mitra et al. (GDR
= 80% at 0.74 FD/h) in which 121 h of EEG recordings with
artifacts were used to test the SDA [44]. However, in our study,
the results were obtained on a larger dataset, which comprises
826 h of unedited neonatal EEG. Proper comparison is difficult
since only performance points rather than performance curves
are provided from the literature. The performance of the proposed SDA exceeded the single feature method of Stevenson
et al. [43], but was less than the SDA proposed by Temko et al.
[29]. This comparison offers a better reflection of true results as

NAGARAJ et al.: NEONATAL SEIZURE DETECTION USING ATOMIC DECOMPOSITION WITH A NOVEL DICTIONARY

the datasets used in these methods are the same. The superior
performance of the method of Temko et al. (a method based on
55 features) is not uniform across the cohort but is significant
on a subset of three neonates which the proposed SDA performs
poorly (mean AUC = 0.69 versus 0.92). In these three neonates,
RSC does not provide sufficient discrimination between seizure
and nonseizure states, primarily due to a lack of response to
seizure epochs (see Fig. 8). The use of additional features as
used by Temko et al. [29] may better represent seizure in this
subset of poorly performing neonates and reduce the number of
false alarms. Table IV gives the analysis of the performance of
additional features to discriminate detected seizures from false
alarms. From this analysis, AR fit, bandwidth, and spectral entropy measures provide the best additional discriminative power
for reducing the false detections.
A shortcoming of the proposed SDA is its inability to detect
short-duration seizures (the seizure detection rate drops below
80% for seizures less than 30 s in duration). A significant proportion of false detections (12%) is also less than 30 s in duration.
A limit on seizure duration will improve the performance and
may also permit the relaxation of the analysis epoch duration
resulting in more data to be processed for a decision. The simplest solution to the short seizure duration problem would be
simply to redefine the length of a seizure to 30 s (the minimum
duration of 10 s that is currently used is relatively arbitrary) as
the majority of seizures in our database were longer than 93 s. A
change in minimum seizure duration would improve the median
AUC to 0.94 (IQR 0.89–0.97) and the mean AUC to 0.92.
VIII. CONCLUSION
A nonparametric feature for seizure detection is presented.
This feature is based on analysis of the atomic decomposition of the EEG signal with a novel dictionary. The proposed
novel dictionary captures both the time-varying frequency and
morphological characteristics of the EEG signal and its use improved the discriminatory performance of the RSC feature. An
SDA based on the RSC resulted in a median AUC of 0.91.
REFERENCES
[1] J. J. Volpe, Neurology of the Newborn, 5th ed. Philadelphia, PA, USA:
Saunders, 2008.
[2] E. Niedermeyer and F. H. Lopes da Silva, Electroencephalography: Basic
Principles, Clinical Applications, and Related Fields, 5th ed. Philadelphia,
PA, USA: Lippincott Williams and Wilkins, 2004.
[3] L. F. Silva, M. L. Nunes, and J. C. Costa, “Risk factors for developing epilepsy after neonatal seizures,” Pediatric Neurol., vol. 30, no. 4,
pp. 271–277, 2004.
[4] C. J. Wusthoff, D. J. Dlugos, A. C. Gutierrez, A. Wang, N. Cook,
M. Donnelly, R. Clancy, and N. S. Abend, “Electrographic seizures during
therapeutic hypothermia for neonatal hypoxic-ischemic encephalopathy,”
J. Child Neurol., vol. 26, pp. 724–732, 2011.
[5] N. Lynch, N. Stevenson, V. Livingstone, J. Rennie, and G. Boylan, “The
temporal evolution of electrographic seizure burden in neonatal hypoxic
ischemic encephalopathy,” Epilepsia, vol. 53, pp. 549–557, 2012.
[6] S. T. Bjorkman, S. M. Miller, S. E. Rose, C. Burke, and P. B. Colditz,
“Seizures are associated with brain injury severity in a neonatal model of
hypoxia-ischemia,” Neuroscience, vol. 166, no. 1, pp. 157–167, 2010.
[7] R. M. Pressler and B. Mangum, “Newly emerging therapies for neonatal
seizures,” Semin. Fetal Neonatal Med., vol. 18, pp. 216–223, 2013.
[8] J. Rennie and G. B. Boylan, “Treatment of neonatal seizures,” Arch. Dis.
Child. Fetal. Neonatal., vol. 92, pp. 148–150, 2007.

2731

[9] D. Murray, G. B. Boylan, I. Ali, C. Ryan, B. Murphy, and S. Connolly,
“Defining the gap between electrographic seizure burden, clinical expression and staff recognition of neonatal seizures,” Arch. Dis. Child. Fetal.
Neonatal., vol. 93, pp. 187–191, 2008.
[10] G. B. Boylan, N. J. Stevenson, and S. Vanhatalo, “Monitoring neonatal
seizures,” Semin. Fetal Neonatal Med., vol. 18, pp. 202–208, 2013.
[11] J. Engel and T. A. Pedley, Epilepsy: A Comprehensive Textbook. Philadelphia, PA, USA: Lippincott Williams and Wilkins, 2008.
[12] P. Celka and P. Colditz, “Nonlinear nonstationary wiener model of infant
EEG seizures,” IEEE Eng. Med. Biol. Mag., vol. 49, no. 6, pp. 556–564,
Oct.
[13] N. J. Stevenson, I. Korotchikova, A. Temko, G. Lightbody, W. P. Marnane,
and G. B. Boylan, “An automated system for grading EEG abnormality
in term neonates with hypoxic-ischaemic encephalopathy,” Ann. Biomed.
Eng., vol. 41, no. 4, pp. 775–785, 2013.
[14] M. Roessgen, A. M. Zoubir, and B. Boashash, “Seizure detection of newborn EEG using a model-based approach,” IEEE Trans. Biomed. Eng.,
vol. 45, no. 6, pp. 673–685, 1998.
[15] L. Rankine, M. Mesbah, and B. Boashash, “A matching pursuit-based
signal complexity measure for the analysis of newborn EEG,” Med. Biol.
Eng. Comput., vol. 45, no. 3, pp. 251–260, 2007.
[16] J. Gotman, D. Flanagan, J. Zhang, and B. Rosenblatt, “Automatic seizure
detection in the newborn: Methods and initial evaluation,” Electroencephalogr. Clin. Neurophysiol., vol. 103, no. 3, pp. 356–362, 1997.
[17] W. H. Trescher, “Pediatric epilepsy: Diagnosis and therapy,” Ann. Neurol.,
vol. 34, no. 3, p. 419, 1993.
[18] M. Navakatikyan, P. Colditz, C. Burke, T. Inderd, J. Richmond, and
C. Williams, “Seizure detection algorithm for neonates based on wavesequence analysis,” Clin. Neurophysiol., vol. 117, pp. 1190–2003, 2006.
[19] A. Liu, J. S. Hahn, G. P. Heldt, and R. W. Coen, “Detection of neonatal
seizures through computerized EEG analysis,” Electroencephalogr. Clin.
Neurophysiol., vol. 82, pp. 30–37, 1992.
[20] P. Celka and P. Colditz, “A computer-aided detection of EEG seizures
in infants: A singular spectrum approach and performance comparison,” IEEE Trans. Biomed. Eng., vol. 49, no. 5, pp. 455–462,
May 2002.
[21] A. Aarabi, R. Grebe, and F. Wallois, “A multistage knowledge-based
system for EEG seizure detection in newborn infants,” Clin. Neurophysiol.,
vol. 118, pp. 2781–2797, 2007.
[22] W. Deburchgraeve, P. Cherian, M. Vos, R. Swarte, J. Blok, G. Visser,
P. Govaert, and S. Huffel, “Automated neonatal seizure detection mimicking a human observer reading EEG,” Clin. Neurophysiol., vol. 119, pp.
2447–2454, 2008.
[23] P. J. Durka, D. Ircha, and K. J. Blinowska, “Stochastic time-frequency
dictionaries for matching pursuit,” IEEE Trans. Biomed. Eng., vol. 49, no.
3, pp. 507–510, Mar. 2001.
[24] S. G. Mallat, and Z. Zhang, “Matching pursuits with time-frequency dictionaries,” IEEE Trans. Signal Process., vol. 41, no. 12, pp. 3397–3415,
Dec. 1993.
[25] S. S. Chen, D. L. Donoho, and M. A. Saunders, “Atomic decomposition
by basis pursuit,” SIAM J. Sci. Comput., vol. 20, pp. 33–61, 1998.
[26] J. A. Tropp and A. C. Gilbert, “Signal recovery from random measurements via orthogonal matching pursuit,” IEEE Trans. Inf. Theory, vol. 53,
no. 12, pp. 4655–4666, Dec. 2007.
[27] N. J. Stevenson, M. Mesbah, G. B. Boylan, P. B. Colditz, and B. Boashash,
“A nonlinear model of newborn EEG with nonstationary inputs,”Ann.
Biomed. Eng., vol. 38, no. 9, pp. 3010–3021, 2010.
[28] S. B. Nagaraj, N. J. Stevenson, W. Marnane, G. Boylan, and G. Lightbody,
“A novel dictionary for neonatal EEG seizure detection using atomic
decomposition,” in Proc. 34th Annu. Int. Conf. IEEE Eng. Med. Biol.
Soc., 2012, pp. 1073–1076.
[29] A. Temko, E. Thomas, G. Boylan, W. Marnane, and G. Lightbody, “EEGbased neonatal seizure detection with support vector machines,” Clin.
Neurophysiol., vol. 122, no. 3, pp. 464–473, 2011.
[30] M. Scher, M. Sun, D. Steppe, R. Guthrie, and R. Sclabassi, “Comparison of
EEG spectral and correlation measures between healthy term and preterm
infants,” Pediatr. Neurol., vol. 10, no. 2, pp. 104–108, 1994.
[31] M. M. Goodwin, and M. Vetterli, “Matching pursuit and atomic signal
models based on recursive filter banks,” IEEE Trans. Signal Process.,
vol. 47, no. 7, pp. 1890–1902, Jul. 1999.
[32] L. Rankine, M. Mesbah, and B. Boashash, “Atomic decomposition for
detecting changes in signal structure: Application to EEG,” in Proc. Int.
Conf. Biomed. Eng., 2004, pp. 285–288.
[33] R. Penrose, “A generalized inverse for matrices,” Math. Proc. Cambridge
Philosoph. Soc., vol. 51, pp. 406–413, 1955.

2732

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

[34] L. Rankine, N. Stevenson, M. Mesbah, and B. Boashash, “A nonstationary
model of newborn EEG,” Med. Biol. Eng. Comput., vol. 54, no. 1, pp. 19–
28, Jan. 2007.
[35] R. Rubinstein, A. M. Bruckstein, and M. Elad, “Dictionaries for sparse
representation modeling,” Proc. IEEE, vol. 98, no. 6, pp. 1045–1057, Jun.
2010.
[36] V. Vapnik, Estimation of Dependences Based on Empirical Data. New
York, NY, USA: Springer-Verlag, 1982.
[37] A. Temko, W. Marnane, G. Boylan, and G. Lightbody, “Robust detection
of neonatal seizures through adaptive background EEG modelling,” Int. J.
Neural. Syst., vol. 23, no. 4, 2013.
[38] A. Temko, E. Thomas, W. Marnane, G. Lightbody, and G. B. Boylan, “Performance assessment for EEG-based neonatal seizure detectors,” Clin.
Neurophysiol., vol. 122, no. 3, pp. 474–482, 2011.
[39] A. Temko, N. Stevenson, W. Marnane, G. Boylan, and G. Lightbody,
“Inclusion of temporal priors for automated neonatal EEG classification,”
J. Neural Eng., vol. 9, no. 4, 2012.
[40] B. R. Greene, W. Marnane, G. Lightbody, R. B. Reilly, and G. B. Boylan,
“A comparison of quantitative EEG features for neonatal seizure detection,” Clin. Neurophysiol., vol. 119, pp. 1248–1261, 2008.
[41] R. Lawrence and T. Inder, “Neonatal status epilepticus,” Semin. Pediatric
Neurol., vol. 17, pp. 163–171, 2010.
[42] L. S. Smit, R. J. Vermeulen, W. P. F. Fetter, R. L. M. Strijers, and
C. J. Stam, “Neonatal seizure monitoring using non-linear EEG analysis,”
Neuropediatrics, vol. 35, pp. 329–335, 2004.
[43] N. J. Stevenson, J. M. OToole, L. J. Rankine, G. B. Boylan, and
B. Boashash, “A nonparametric feature for neonatal EEG seizure detection based on a representation of pseudo-periodicity,” Med. Eng. Phys.,
vol. 34, no. 4, pp. 437–446, 2012.
[44] J. Mitra, J. R. Glover, P. Y. Ktonas, A. T. Kumar, A. Mukherjee, and
N. B. Karayiannis, “A multistage system for the automated detection
of epileptic seizures in neonatal encephalography,” Clin. Neurophysiol.,
vol. 26, pp. 218–226, 2009.

Sunil Belur Nagaraj (S’13) received the B.E. degree
in electrical and electronics from the M. S. Ramaiah
Institute of Technology, Bangalore, India, in 2006,
and the M.Eng. degree in electrical and computer engineering from the University of Victoria, Victoria,
BC, Canada, in 2010. He is currently working toward
the Ph.D. degree at University College Cork, Cork,
Ireland, at the Neonatal Brain Research Group in the
Irish Centre for Fetal and Neonatal Translational
Research.
His research interests include the areas of biomedical and digital signal processing, optimization techniques, time–frequency signal analysis, dictionary design, and wavelets.

Nathan J. Stevenson (M’06) received the M.Eng.
degree from the Queensland University of Technology, Brisbane, Australia, in 2003, and the Ph.D. degree from the University of Queensland, Brisbane,
Australia, in 2008.
He is currently working on the methods of automated diagnosis and prognosis for sick babies using
physiological measurements at the Neonatal Brain
Research Group, University College Cork, Cork, Ireland. His research interests include biomedical signal
processing with interests in joint time–frequency signal analysis and neonatal electrophysiology.

William P. Marnane (M’09) received the B.E. degree in electrical engineering from the National University of Ireland, Cork, Ireland, in 1984, and the
Ph.D. degree from the University of Oxford, Oxford,
U.K., in 1989.
He was a Lecturer at the School of Electronic
Engineering Science, University of Wales, Bangor,
U.K., from 1989 to 1993. In 1993, he was appointed
as a Lecturer in digital signal processing in the Department of Electrical and Electronic Engineering,
University College Cork (UCC), Cork, and as a Senior Lecturer in 1999. He was appointed as the Dean of Graduate Studies for
UCC in 2013. His research interests include biomedical signal processing and
digital design for DSP, coding, and cryptography.

Geraldine B. Boylan received the M.Sc. degree in
physiology and the Ph.D. degree in clinical medicine
from University College London, London, U.K.
She is currently a Professor of neonatal physiology at the Department of Paediatrics and Child
Health, University College Cork, Cork, Ireland, and
the Director of the Irish Centre for Fetal and Neonatal Translational Research. She has worked in the
area of clinical neurophysiology for many years, and
since 1996, he has worked exclusively in the field
of neonatal neurophysiology. She leads the Neonatal Brain Research Group in the INFANT centre—a multidisciplinary research
team focused on neurological monitoring in the neonatal intensive care unit,
particularly for seizure detection and automated EEG analysis. Researchers in
the group have developed a seizure detection algorithm for newborn babies and
this algorithm is currently under clinical evaluation. She is also the Coordinator
of the FP7-funded NEMO study which aims to evaluate antiepileptic drugs for
neonatal seizures.

Gordon Lightbody (M’13) received the M. Eng.
(with distinction) and Ph.D. degrees in electrical
and electronic engineering from Queen’s University
Belfast, Belfast, U.K.
After completing a one-year postdoctoral position funded by DuPont, he was appointed by Queen’s
University as a Lecturer in modern control systems.
In 1997, he was appointed as a Lecturer in control
engineering at University College Cork, Cork, Ireland, and subsequently as a Senior Lecturer in 2008.
His current research interests include artificial intelligence techniques for intelligent control and signal processing, focusing on
energy/power and biomedical applications.
Dr. Lightbody is an Associate Editor of Control Engineering Practice.

