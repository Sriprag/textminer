1494

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Spatial Normalization of Human Back Images
for Dermatological Studies
Hengameh Mirzaalian, Tim K. Lee, Member, IEEE, and Ghassan Hamarneh, Senior Member, IEEE

Abstract—A large number of pigmented skin lesions (PSLs) are
a strong predictor of malignant melanoma. Many dermatologists
advocate total body photography for high-risk patients because
detecting new-appearing, disappearing, and changing PSL is important for early detection of the disease. However, manual inspection and matching of PSL is a subjective, tedious, and error-prone
task. A computer program for tracking the corresponding PSL
will greatly improve the matching process. In this paper, we describe the construction of the first human back template (atlas),
which is used to facilitate spatial normalization of the PSL during the matching process. Four pairs of anatomically meaningful
landmarks (neck, shoulder, armpit, and hip points) are used as
reference points on the back image. Using the landmarks, a grid
with longitudes and latitudes is constructed and overlaid on each
subject-specific back image. To perform spatial normalization, the
grid is registered into the back template, a unit-square rectilinear grid. To demonstrate the benefits of using the back template,
we apply several state-of-the-art point-matching algorithms on 56
pairs of real dermatological images and show that utilizing spatially
normalized coordinates improves the PSL matching accuracies.
Index Terms—Atlas, computer aided diagnosis, melanoma, template, tracking pigmented skin lesions (PSLs).

I. INTRODUCTION
ELANOMA is one of the fastest growing cancers among
the white population in the world with an average 3%
increase in incidence for the last four decades. In USA and
Canada alone, there were approximately 73 720 cases in 2009
[1], [2]. The mechanism of melanoma development is not fully
understood. Nevertheless, a large number of pigmented skin
lesions (PSLs) have been reported as the strongest risk factor [3],
and about half of the cases originates from pre-existing PSL [4].
Early detection is therefore critical to the treatment process and
the prognosis.
Dermoscopy (also called epiluminescence microscopy) is
a noninvasive method for the early recognition of malignant

M

Manuscript received April 22, 2013; revised August 22, 2013; accepted
October 24, 2013. Date of publication December 11, 2013; date of current
version June 30, 2014. This work was supported in part by a scholarship from
CIHR Skin Research Training Centre and by grants from the Natural Sciences
and Engineering Research Council of Canada, and Canadian Dermatology Foundation. The work of H. Mirzaalian was supported by the CIHR Skin Research
Training Centre.
H. Mirzaalian and G. Hamarneh are with the Medical Image Analysis Lab at
the School of Computing Science, Simon Fraser University, Burnaby, BC V5A
1S6, Canada (e-mail: hengameh.mirzaalian@gmail.com; hamarneh@sfu.ca).
T. K. Lee is with the Department of Dermatology and Skin Science, Photomedicine Institute, University of British Columbia, Vancouver, BC V6T 1Z4,
Canada and the Vancouver Coastal Health Research Institute, Vancouver, BC
V5Z 1M9, Canada and also with the Cancer Control Research, BC Cancer
Agency, Vancouver, BC V5Z 1L3, Canada (e-mail: tlee@bccrc.ca).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2288775

Fig. 1.

Examples of back images of the same subject at different times [22].

melanoma, allowing a better visualization of the skin structures.
Using the high-resolution digital dermoscopic images (e.g.,
22 pixels/mm), physicians assess the skin lesion based on the
presence or absence of the different dermoscopic features. Recently, a considerable amount of research has focused on automating the lesion segmentation, feature extraction and classification of dermoscopic images as a key step toward computeraided diagnosis [5]–[9]. A review of the existing computerized
methods to analyze single skin lesions in dermoscopic images
and multiple lesions captured by digital imaging has been recently reported in [10].
Besides the dermoscopic images for early detection of MM,
dermatologists advocate total body photography for high-risk
patients to identify new-appearing, disappearing, and changing
PSL by tracking PSL in the 2-D digital color images (e.g., 8
pixels/mm) collected during regular examinations (see Fig. 1)
[11]–[14]. However, manual inspection and matching of PSL
is time consuming, error prone, and suffers from inter- and intrarater variability. Although computer-based systems provide
sophisticated functionalities for automated feature extraction
and lesion assessment for quantitative analysis, there exists limited works to computerize matching between lesions, which will
ease the workload and may improve the matching accuracy and
reduce the variability. Given two or more initial matches among
the PSLs of the two back images, Prednia and White [15] performed affine registration between the two sets of PSLs and
defined the other matches as the closest neighboring points. To
automate the initial matching, they used Gabriel graph representation of the points [16]. Note that their method does not take
into account the elastic deformation of the human back. Roning
and Riech [17], [18] defined a set of geometric properties as a
similarity metric to find the corresponding PSLs. Their method
requires determining manually two initial matches. Huang and
Bergstresser [19] developed a PSL-matching algorithm based
on Voronoi decomposition of the image space. We previously
developed an automated computer program to match the PSL
between two back images based on hypergraph matching [20]
and a relaxed labeling of an association graph [21].
By abstracting a PSL as a point, PSL tracking can be performed by applying existing point matching algorithms (see [23]

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

MIRZAALIAN et al.: SPATIAL NORMALIZATION OF HUMAN BACK IMAGES FOR DERMATOLOGICAL STUDIES

Fig. 2. (a) Anatomically meaningful landmarks of the back image and
(b) our proposed human back template. The green points in (b) correspond to
the reference anatomical landmarks overlaid on the image in (a). (a) Landmark.
(b) Template.

for a recent survey). Due to the sparse number of PSL, we classify PSL matching as sparse point matching problem. Typically,
sparse correspondence methods rely on a set of shape descriptors (shape statistics) including information of the neighborhood
area, e.g., color, curvature, etc. [24]. However, defining such
kind of local discriminative features is not practicable for PSL
in the skin images since the size and color of the PSLs are time
varying.
In this paper, we hypothesize that integrating human-back
anatomy with the spatial location of the PSL, would improve
the PSL matching accuracy. To this end, inspired by the works
on the human brain atlases, which provides a common frame of
reference that facilitates cross-sectional and longitudinal comparisons of the brain anatomy [25]–[29], we define the first
human back template. We use the proposed back template to
transform the back images into a common normalized coordinate space, which leads to anatomically meaningful comparison
between the PSL in the human back images. To the best of our
knowledge, this paper proposes the first attempt to create such
an atlas focused on the human back.
The remainder of this paper is organized as follows. In
Section II-A, we first describe the back template coordinates
system. Next, in Section II-B, we detail the procedure of mapping the human back coordinates, e.g., PSL coordinates in a
novel image, to the template’s coordinate system. Applying 56
pairs of real human back digital color images (see Section III),
we validate the matching methods in terms of three different
error measurements introduced in Section IV. Experimental results in Section IV indicate that applying anatomy-based normalized PSLs coordinates substantially improve the accuracy of
six state-of-the-art point matching methods.
II. METHOD: HUMAN BACK TEMPLATE
A. Template Coordinate System
Fig. 2(a) shows four pairs of anatomically meaningful landmarks (i.e., type I and II landmarks, as defined in [30] and [31])
of the human back, as follows:
1) The point where the left (right) side of the neck meets the
left (right) shoulder, or neck-left nl (neck-right nr ) for
short;
2) The point where the left (right) shoulder meets the left
(right) arm, denoted by shoulder-left sl (shoulder-right
sr );

1495

3) The left and right armpits (al and ar , respectively);
4) The left hip point (hl ) and right hip point (hr ).
According to the classification of the landmarks by Bookstein [30], [31], a type I landmark is defined as the discrete
juxtapositions of tissues, e.g., the point where three structures
meet, the branching point of the tree structures, or the intersections of extended curves with planes of symmetry. Adopting
this nomenclature, the armpit point is the lateral intersection of
left (right) arm and the back’s left (right) silhouette and, hence,
can be classified as type I. Landmark type II is defined as the
maximum curvature point or other local morphogenetic process.
The neck and shoulder points are of this type.
In our construction of the human template, we attempt to
design a template, which properly encodes the aforementioned
anatomical landmarks of the image domain, ω ⊂ R2 , to the
template space, Ω ⊂ R2 . To this end, as shown in Fig. 2(b), we
define our template as a unit-square patch1 with domain Ω ⊂
[−0.5, 0.5] × [−0.75, 0.25], attached with four pairs of points
corresponding to the anatomically meaningful landmarks, e.g.,
Nl (Nr ), Sl (Sr ), Al (Ar ), and Hl (Hr ), which are mapping to
nl (nr ), sl (sr ), al (ar ), and hl (hr ) in ω, respectively. Note that
we use capital letters for the points inside the template domain Ω
and small letters for image space domain ω. These landmarks are
then used to establish a number of basic longitude and latitude
lines, which are in turn used to construct a rectilinear grid on
the template and a curvilinear grid on each subject specific back
image (more details will be provided later in Section II-B1).
It should be mentioned that the locations of the anatomical
landmarks in the template space are at specific coordinates (except Nl and Nr , while their x coordinate is allowed to slide left or
right), A = (±0.5, 0), H = (±0.5, −0.75), S = (±0.5, 0.25),
whereas the landmarks of the subjects can be any spatial coordinates in the physical image space. The specific locations of
the landmarks in Ω are selected such that the ratios of the line
segments in ω reflect the same ratios with the ones in Ω, e.g.,
|sl al |/|al hl | ≈ |Sl Al |/|Al Hl |, where |ab| denotes the length
of the line segment which connects points a and b in the 2-D
space. The numerical results of the estimated ratios are reported
in Section IV.
Given the four pairs of anchor points defined (“1”–“4”
above), we construct a set of basic latitude and longitude
lines. The central latitude is a straight horizontal line segment
Al Ar which connects Al and Ar , whereas the central longitude is the line segment Nm Hm connecting the medial point
Nm = (0, 0.25) with Hm = (0, −0.75) and passing through
Sm = (0, 0.25) and Am = (0, 0), where the subscript m indicates the midpoint between the corresponding left and right
reference points, e.g., Am = (Al + Ar )/2. The topmost (superior) latitude Sl Sr , the bottommost (inferior) latitude Hl Hr ,
the leftmost longitude Sl Hl , and the rightmost longitude Sr Hr
define the borders of the domain Ω of the template. Note that
in the template space: Al Ar ⊥Nm Hm , Sl Hl  Nm Hm  Sr Hr
and Sl Sr  Al Ar  Hl Hr where ⊥ denotes perpendicular and 
denotes parallel. Finally, based on the anatomical landmarks and
the reference central latitude and longitude, a template-based
1 Without loss of generality, we choose a unit square patch template instead
of a trapezoid, since squares and trapezoids are linearly transformable to each
other, i.e., by performing anisotropic scaling (a bijective transformation).

1496

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Fig. 3. Procedure for calculating the basic longitudes and latitudes and the grid construction in the image domain. (a) Points inserted by the user (blue and
red are the edge points and landmarks, respectively). (b) Left and Right longitudes: a B-spline curve [32] of degree 3 defined by ten control points fitted to the
lateral edge points of the back’s left and right silhouettes. (c) Central longitude: medial curve situated between the left and right longitudes. (d) Superior latitude:
a degree 6 polynomial least-squares fitted to the superior edge points. (e) Central latitude: a straight line connecting the armpit points. (f) Inferior latitude: straight
line connecting the hip points. (g) Equal arc length samplings of the basic latitudes and longitudes in (b)–(f). (h) Interpolating latitudes between the superior and
central latitudes. (i) Interpolating latitudes between the central and inferior latitudes. (j) Equal arc length samplings of all the latitudes. (k) Interpolating longitudes.
(l) The final grid overlaid on the back image.

rectilinear coordinate system is defined and a complete Cartesian grid is overlaid on the template [see Fig. 2(b)].
B. Spatial Normalization of Back Coordinates
The spatial normalization of the human back coordinates
(e.g., PSL coordinates) in a dermatological image is done by
the following steps: detecting the basic longitudes and latitudes
in the image space, constructing the grid, and establishing a
mapping between the continuous image space and the template.
Details of these steps are described below.
1) Detecting the Basic Longitudes and Latitudes: To perform spatial normalization, we overlay a set of six basic latitudes
(superior, central, and inferior) and longitudes (left, right, and
central) on each subject specific back image to register it into
the template coordinate system (see Fig. 3). The latitudes and
longitudes are constructed using the aforementioned anatomical landmark points, lateral edge points of the left and right
silhouette of the back, and superior edge points of both shoulders’ silhouettes [see Fig. 3(a)]. Note that most of the latitudes
and longitudes in the image space are smooth curves fitted to
the anatomical landmarks and medial lines as explained below.
Consequently, the grid in the image space is no longer rectilinear but rather curved. We now provide the details on how the
latitudes and longitudes are constructed in the image space.
Left (right) longitude is a B-spline curve [32] of degree 3
defined by ten control points and least-squares fitted to the lateral
edge points of the back’s left (right) silhouette. We use a degree
3 polynomial because it provides sufficient degrees of freedom
to model the sides without excessive inflection points. Degree 2
is not flexible enough and higher degree than 3 would increase
the complexity in addition to overfitting the curve to the noise
in the selected edge points.
Central longitude [see Fig. 3(c)] is the medial curve between
the left and right longitudes and is calculated as follows: First,

Fig. 4. Detecting the central longitude using the DT. (a) Left and right longitudes (blue) overlaid on the color image. (b) Binary image containing the left
and right longitudes. (c) The DT of (b). (d) Local maxima of (c). (e) Comparison
of the central longitudes obtained from the DT method (red) with the alternative
method of computing the loci of the midpoint between the left and right longitudes (blue). A closeup of the small rectangular region near the neck is shown
on the right.

we calculate the distance transform (DT) between the left and
right longitudes [see Fig. 4(a)–(c)]. Next, we calculate the gradient of the DT image: (DT), which captures the amount by
which the DT image changes along the vertical and horizontal
directions. Finally, we construct the center longitude via a degree 3 polynomial least-squares fitted to the local maxima of
the gradient magnitude of DT: |(DT)| [see Fig. 4(d)]. Alternatively, we can calculate the center longitude as the loci of
midpoints between the left and right longitudes [Fig. 4(e) shows
the results of both methods]. We obtained similar results using
both approaches. Given an image of size N1 × N2 , the computational complexity of these methods are O(N1 N2 ) and O(N1 ),
respectively. Therefore, the second definition is preferable because of its simplicity.
Superior latitude [see Fig. 3(d)] is a degree 6 polynomial
least-squares fitted to the superior edge points of both shoulders’
silhouettes. Degree 6 is chosen to accommodate the number of
concavities and convexities that can occur along these superior
edge points.
Central latitude [see Fig. 3(e)] is a straight line segment al ar
connecting al to ar .

MIRZAALIAN et al.: SPATIAL NORMALIZATION OF HUMAN BACK IMAGES FOR DERMATOLOGICAL STUDIES

Fig. 5. Mapping between a point in the image and the template domains.
(a) A point p is shown in a rectangle in the image domain. (b) The corresponding
point P in the template domain. (c) Closeup views of the cell containing p
(p ∈ cell(p)) and the corresponding cell, CELL(P ), in the template domain are
shown in the top and bottom panels of (c), respectively.

Inferior latitude [see Fig. 3(f)] is a straight line segment hl hr
connecting hl and hr .
As a result, the image domain ω ⊂ R2 of a specific subject’s
back is bounded by the left and right longitudes and superior
and inferior latitudes.
2) Constructing the Grid: The intersections of the basic longitudes and latitudes can be considered as control points for the
mapping between the image and the template domains. As more
control points increase the precision of the mapping, we interpolate as many additional longitudes and latitudes to achieve
a desired accuracy. The lines are interpolated between the basic longitudes and latitudes using equal arc length sampling
points, which can be classified as type III landmarks [30]. Note
that equal arc length sampling is adopted due to the absence of
additional stable landmarks between the basic longitudes and
latitudes. Fig. 3(g)–(l) shows the steps of interpolating the longitudes and latitudes of the grid.
3) Establishing the Mapping Between the Continuous Image
and Template Domains: Now that the control points (intersection of the grid lines) are defined in both the template and
the images domains, we establish correspondence between any
point in one of the continuous domains to its counterpart in the
other domain (not restricted to the landmarks, the points on the
latitudes and longitudes or their intersections) by warping the
grid to the template. We evaluated two interpolation methods
to achieve this warp: Barycentric coordinates (BC) [33] and
thin-plate splines (TPS) [34].
The BC Method: The BC method establishes correspondence
between points using the following steps:
1) For each point, p = (px , py ) ∈ ω, find the cell cell(p) ⊂ ω
containing p, i.e., cell(p) is the area enclosed between the
two nearest longitudes and latitudes to p. As shown in
Fig. 5, we locate the points a = (ax , ay ), b = (bx , by ),
and c = (cx , cy ).
2) Find the corresponding cell CELL(P ) ⊂ Ω in the template
domain. CELL(P ) is the area enclosed by the corresponding longitudes and latitudes of the bounding cell(p) in the
image domain. For example, we locate the control points
A, B, and C as shown in Fig. 5.
3) Compute the BC coordinates (t1 , t2 , t3 ) of p using (1) [33]
  
  
ax bx cx −1 px
t1
t2 = ay by cy
py .
(1)
t3
1 1 1
1
2 ColorBrewer was used to select perceptually-motivated color schemes used
in this figure and similar ones later in the paper [35].

1497

Fig. 6. Mapping between the image domain and the template. Corresponding
cells, longitudes and latitudes in the image, and template domain are shown
with the same colors2 .

4) The point P ⊂ Ω is determined by the same BC coordinates as P = t1 A + t2 B + t3 C.
The TPS Method: TPS warps points from one domain to
another domain by mimicking the deformation of a thin plate
minimizing its bending energy. In particular, interpolated coordinates using TPS are given by [34]
f (x, y) =

K


ci φ((x, y) − (xi , yi )) + a10 x + a01 y + a00

i=1

(2)
where . denotes the usual Euclidean distance, (xi , yi ) is a set
of control points, and aij and ci are warping coefficients representing the affine transformation and nonaffine deformations,
respectively. φ is referred to as the kernel function of the thin2
plate
 spline and is given by φ = r logr, where r is the distance
2
2
x + y . The kernel models elasticity and nonrigid transformation, and governs the displacement of the control points.
Our control points are intersections of the longitudes and
latitudes. TPS fits a function f such that any point (xi , yi ) ⊂
ω is mapped to (Xi , Yi ) = f (xi , yi ) ⊂ Ω by minimizing the
following energy function [34]:

E=
2

(Eb (x, y))2 )dxdy
2

2

(3)

d f 2
where Eb (x, y) = ( ddxf2 )2 + 2( dxdy
) + ( ddyf2 ) is a measure of
the bending energy at (x, y).
The result of these two alternative interpolation methods (BC
and TPS) is to establish a bijective function f : ω → Ω mapping points between the two domains. In the BC method, curves
bounding the cells are approximated by straight lines when establishing correspondence between the two continuous domains.
TPS does not rely on this assumption and hence is more accurate. However, TPS is more computationally expensive than BC.
Using our database of back images described in Section III, the
difference between the normalized coordinates using BC and
TPS in the unit square patch is: |f BC (x, y) − f TPS (x, y)| =
2.3 × 10−5 ± 1.87 × 10−7 , which shows that the increase in accuracy does not justify the additional computational complexity
of TPS.
Fig. 6 demonstrates the mapping between the two spaces.
Cells, longitudes and latitudes in the image and template space
are colored with the same colors.

1498

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

Fig. 7. Back-to-template mapping with PSL overlaid. First row: The landmarks used in the construction of the grid (green points). Second row: The overlaid
grids on the back images. Third row: The resultant normalized coordinates of the PSL (red points) using the proposed template. Corresponding cells on the grid
and the template are shown with the same color.

III. DATA: HUMAN BACK COLOR IMAGES
Fifty-six pairs of real human back digital color images were
used in the validation tests. Our dataset was obtained from an
epidemiologic study investigating the relationship between sunscreen use and PSL development [22]. This was a 3-year study
in which the back of each participant was photographed using
a color slide format at the entrance and exit of the study. The
color slides were then digitized at 2000 dots per inch, with a
final resolution of 0.25 mm/pixel. Fig. 1 shows one of the image pairs. The PSL-matching ground truth was provided by an
expert human operator.
IV. EXPERIMENTAL RESULTS
Fig. 7 shows the construction of the grids on four images.
The grids are overlaid on the back images and the normalized
coordinates of the PSL are determined based on our proposed
template. Corresponding latitudes and longitudes on the image
and template space are shown in the same color.
As mentioned in Section II-A, the ratios of the line segments
connecting the landmarks in the template space reflect the same
ratios within the image. To estimate the ratios of the different
line segments in the image space, we examined two approaches
as follows:
1) Estimating the ratios per image in our dataset and then
averaging the ratios over all the images.
2) Estimating the ratios for the average of the registered landmarks. The registration between the landmarks is performed by aligning the armpit points of the images to the
same spatial coordinates as shown in Fig. 8.

Fig. 8. Registered landmarks and curvilinear template. (a)–(b) Landmarks in
the image space before (a) and after (b) registration of the landmarks by aligning
the armpit points of the images to the same spatial coordinates. (c) Curvilinear
template based on the average of the landmarks in (b), the green dots, which are
used to compute the ratios in Table I.
TABLE I
ESTIMATED RATIOS OF THE DIFFERENT LINE SEGMENTS CONNECTING THE
ANATOMICAL LANDMARKS ON OUR DATASET

Table I showsthe statistical ratios using the aforementioned
methods based on Euclidean and geodesic3 distances. Note that
3 Path length along the curve between the two points, e.g. the leftmost (rightmost) lateral edge of the body, which connects armpits and hip points.

MIRZAALIAN et al.: SPATIAL NORMALIZATION OF HUMAN BACK IMAGES FOR DERMATOLOGICAL STUDIES

1499

Fig. 10. Comparison of the matching accuracy of the six graph matching
algorithms without (blue) and with (red and green by applying the square
and the curved-linear templates, respectively) spatial normalization using three
error measurements: NIM, HDE, and SED [20]. It can be clearly seen that using
our proposed anatomy-based normalized coordinates, the accuracy of the PSL
matching is improved for all error indicators and algorithms.

Fig. 9. PSL matching examples. Each row is a different participant. The
images in the right column were captured three years after the left column. The
matched lesions are joined by lines.

in the square template, we only take care of the ratio between the
upper and lower part of the body, defined as |sl al |/|al hl |, which
is around 0.34. Therefore, we allocate the upper and lower back
of the template to 25% and 75%, respectively, e.g., Sl Al = 0.25
and Al Hl = 0.75 (25/75 = 0.33). Note that by considering the
whole ratios in Table I, we can define a curvilinear template
shown in Fig. 8(c) (the overlaid grid can be constructed utilizing
the same manner mentioned in Section II-B1 used to overlay a
grid on each subject specific back image).
The remaining of the section verifies the effectiveness of
the proposed spatially normalized coordinates. The main hypothesis of this paper is the following: using spatially normalized coordinates (i.e., in the template space) improves the PSL
matching accuracy of computerized methods. To test our hypothesis, we compared automated PSL matching experiments,
with and without spatial normalization. Note that our goal is
not to obtain higher matching accuracy than the human operator
(we use the manually prepared matching as ground truth in our
study, i.e., to calculate the accuracy of the matching obtained
via the automated methods). The automated matching algorithms tested are: shape contexts (PAMI02) [36], spectral graph
matching (ICCV05) [37], hypergraph matching (CVPR08) [38],
a modified version of the hypergraph matching (CVPR09) [20],
tensor-based graph matching (PAMI11) [39], and uncertaintybased feature learning method (MICCAI12) [21]. The details
of the aforementioned algorithms are provided in the respective references. We provide a brief summary of each algorithm
herein for convenience. PAMI02 [36] uses shape context features in the similarity measurement to find the corresponding
points. Then, PAMI02 calculates an optimal nonrigid alignment
of two shapes. In ICCV05 [37], after constructing an adjacency
matrix representing the pair-wise agreements between edges,
eigenvector (spectral) decomposition is used to recover the cor-

Fig. 11. Perturbing the landmark locations for sensitivity analysis. (a)–(d)
Different levels of uniformly distributed noise added to the landmark locations.
This is used to validate the propagation of errors in the landmark positions to
the PSL matching algorithm. For a given noise interval, noise∈[r1 , r2 ], noisy
landmarks would be generated inside the area between two circles of radii r1 and
r2 . The colored line segments emanate from the noise free landmark position
and extend to the new noise-corrupted location. (e)–(h) Grids constructed from
the original landmarks (red) and from the noisy landmarks (blue).

rect assignment based on how strongly they belong to the main
cluster of the matrix. CVPR08 [38] finds corresponding hyperedges (e.g., triplets of vertices) and then corresponds points in
two graphs using a probabilistic approach. CVPR09 [20] is an
extension to CVPR08 [38] which finds the maximum probability of matching the PSL between two images according to the
lengths and angles of edges in the graphs. PAMI11 is a generalization of spectral techniques. MICCAI12 solves the matching
problem as a relaxed labeling of an association graph and leverage high confidence matching to sequentially constrain a learnt
objectivefunction.
After identifying the locations of the PSL manually in 56
image pairs (described in Section III), we applied the above six
matching algorithms, with and without the back template-based
spatial normalization of the PSL coordinates. To evaluate the
accuracy of the PSL matching algorithms (with and without

1500

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

TABLE II
ANOVA TEST RESULTS (P-VALUES) [40] OF COMPARISON BETWEEN THE MATCHING ERRORS IN FIG. 10

Fig. 12. Matching performance versus different levels of uniformly distributed noise added to the landmark locations. (a) For a given noise interval, noise∈[r1 , r2 ],
noisy landmarks are generated inside the area between two circles of radii r1 and r2 , which are represented with the different colors. (b)–(d) Y-axis represents
the percent difference in the error measurements (NIM, HDE, and SED) compared to the zero noise level. Different color bars correspond to the different noise
intervals shown in (a). The results indicate less than 7% sensitivity for up to 8 mm (32 pixels) noise level.

template normalization), we compare the algorithms’ matching
results with the ground truth matching provided by an expert.
To this end, we define the following three error measurements
(which are detailed in [20]):
1) Number of incorrect matching (NIM): Given the ground
truth for PSL matching between two images, NIM is measured as the difference between the total number of pairs
in the ground truth and number of correctly detected pairs.
Let C, N , and D represent sets of common PSLs, newly
appearing, and disappearing PSLs between the images,
respectively. NIM takes into account incorrect matching
for the PSLs only in set C.
2) Hamming distance error (HDE): HDE is similar to NIM,
but it also takes into account the disappearing and newly
appearing PSL. In other word, incorrect matching for the
PSLs in all the sets (C, N , and D), are considered in
computing HDE.
3) Spatial Euclidean distance (SED): The SED is the sum of
the Euclidean distance between the ground truth matched
target and the actual matched target (in the normalized
space). Therefore, a PSL erroneously matched to a nearby
mole will not be penalized as much as a PSL erroneously
matched to a farther mole. The reader is referred to [20]
for more details.
Fig. 9 shows the matching results of two of the image pairs.
Fig. 10 shows the estimated errors for all the six matching algorithms. The blue, red, and green bars show the error results using
image space coordinates (without spatial normalization using
the proposed back template), normalized space coordinates by
applying the square, and the curvilinear templates [see Fig. 8(c)],
respectively. As clear from Fig. 10, by applying normalized
coordinates obtained by applying the templates, PSL matching accuracy is improved for all the error indicators and algorithms. To study the significance of the improvement in the point
matching step considering spatially normalized coordinates, we
perform analysis of variance (ANOVA [40]) on the matching errors of the 56 skin image pairs with (square templates)

and without applying spatial normalization, for each of the six
graph matching algorithms. The results reported in Table II indicate that 16 out of the 18 cases have p-values less than 0.01,
which we declare as statistically significant differences.
To quantify the propagation of errors to the matching algorithms due to imprecise landmark positions, we measure matching performance of MICCAI12 for different levels of uniformly
distributed noise added to the landmark locations. Fig. 11 shows
examples of the noisy landmarks and the constructed grids from
them. Fig. 12 represents the percent difference of the error measurements (NIM, HDE, and SED) compared to the noise free
baseline. The percent difference between two values, x and x0 ,
0|
× 100%. The results indicate
is given by x0 : Diff% = |x−x
x0
less than 7% sensitivity for up to 8 mm (32 pixels) noise level
for images of size 2716 × 1808 pixels (679 × 452 mm).
We also evaluate the effect of the different resolutions of the
grid on the matching accuracies. The results indicate that for
grid resolutions of 5 × 9 or higher, the error variation does not
change too much.
V. CONCLUSION
An automated method for matching PSL on human back
images is of utmost importance for early detection of potential malignancies using the total body photograph. In order to
have an anatomically meaningful comparison between PSL in
the back images captured at different times, we need to perform spatial normalization. In this paper, we propose the first
human back template to perform such normalization. Our test
results show that the anatomy-based normalized coordinates
substantially improve the accuracy of six state-of-the-art PSL
matching methods. We do not claim that our template is the best
possible template, so we plan to continue exploring alternative
approaches and we anticipate other groups will do too.
One of the challenges, as observed in this study, will be to develop a robust definition of the hip anatomical landmark, which
we plan to address through future discussions and consultations

MIRZAALIAN et al.: SPATIAL NORMALIZATION OF HUMAN BACK IMAGES FOR DERMATOLOGICAL STUDIES

with dermatologists. Further, for subjects with highly deformed
shapes (e.g., suffering from severe scoliosis), our proposed template prove too inflexible, and hence, a different approach would
need to be developed (e.g., a highly flexible template). We are
also working on image processing methods for identifying the
PSL and the anatomical landmarks automatically. This will complement our work on PSL matching [20] and spatial normalization presented in this paper, in order to produce an end-to-end
system for reading pairs of human back images, counting the
PSL, and detecting appearing and disappearing PSL. Suspicious
PSL will be further analyzed using shape and color and texture
properties as in [41].
REFERENCES
[1] Cancer facts and figures 2009. American Cancer Society, Atlanta, GA,
USA.
[2] Canadian Cancer Statistics 2009. Canadian Cancer Society’s Steering
Committee. Toronto, ON, Canada.
[3] R. Gallagher and D. McLean, “The epidemiology of acquired melanocytic
nevi—A brief review,” Dermatol. Clin., vol. 13, no. 3, pp. 595–603, 1995.
[4] T. Kalnenas, D. English, and P. Heenan, “Benign melanocytic lesions: Risk
markers or precursors of cutaneous melanoma?” Amer. Acad. Dermatol.,
vol. 33, no. 6, pp. 1000–1007, 1995.
[5] I. Maglogiannis and C. Doukas, “Overview of advanced computer vision systems for skin lesions characterization,” IEEE Trans. Inf. Technol.
Biomed., vol. 13, no. 5, pp. 721–733, Sep. 2009.
[6] M. Silveira, J. Nascimento, J. Marques, A. Marcal, T. Mendonca,
S. Yamauchi, J. Maeda, and J. Rozeira, “Comparison of segmentation
methods for melanoma diagnosis in dermoscopy images,” IEEE J. Sel.
Topics Signal Process., vol. 3, no. 1, pp. 35–45, Feb. 2009.
[7] R. Garnavi, M. Aldeen, and J. Bailey, “Computer-aided diagnosis of
melanoma using border- and wavelet-based texture analysis,” IEEE Trans.
Inf. Technol. Biomed., vol. 16, no. 6, pp. 1239–1252, Nov. 2012.
[8] A. Sadri, M. Zekri, S. Sadri, N. Gheissari, M. Mokhtari, and
F. Kolahdouzan, “Segmentation of dermoscopy images using wavelet networks,” IEEE Trans. Biomed. Eng., vol. 60, no. 4, pp. 1134–1141, Apr.
2013.
[9] C. Lu, M. Mahmood, N. Jha, and M. Mandal, “Automated segmentation
of the melanocytes in skin histopathological images,” IEEE J. Biomed.
Health Informat., vol. 17, no. 2, pp. 284–296, Mar. 2013.
[10] K. Korotkov and R. Garcia, “Computerized analysis of pigmented skin
lesions,” Artif. Intell. Med., vol. 56, pp. 69–90, 2012.
[11] W. Slue, A. Kopf, and J. Rivers, “Total-body photographs of dysplastic
nevi,” Arch. Dermatol., vol. 124, pp. 1239–1243, 1988.
[12] D. Shriner, J. Glowczwski, and R. Wagner, “Techniques of full-scale
colour total body photography: A useful tool in the management of patients
with the dysplastic naevus syndrome,” J. Dermatol. Treatment, vol. 1,
pp. 181–185, 1990.
[13] A. Halpern, “Total body skin imaging as an aid to melanoma detection,”
Semin. Cutan. Med. Surg., vol. 22, no. 1, pp. 2–8, 2003.
[14] W. Green, S. Wang, and J. Cognetta, “Total-body cutaneous examination,
total-body photography, and dermoscopy in the care of a patient with Xeroderma pigmentosum and multiple melanomas,” Arch. Dermatol., vol. 145,
no. 8, pp. 910–915, 2009.
[15] D. Perednia and R. White, “Automatic registration of multiple skin lesions
by use of point pattern matching,” Comput. Med. Imag. Graph., vol. 16,
no. 3, pp. 205–216, 1992.
[16] G. White and D. Perednia, “Automatic derivation of initial match points
for paired digital images of skin,” Comput. Med. Imag. Graph., vol. 16,
pp. 217–225, 1992.
[17] J. Roning and M. Riech, “Registration of nevi in successive skin images
for early detection of melanoma,” in Proc. IEEE Int. Conf. Pattern Recog.,
1998, vol. 1, pp. 352–357.
[18] M. Riech, “Skin cancer detection system registration of moles in skin
images,” Ph.D. dissertation, Dept. Elect. Eng., Eindhoven Univ. Technol.,
Eindhoven, The Netherlands, 1997.

1501

[19] H. Huang and P. Bergstresser, “A new hybrid technique for dermatological
image registration,” in Proc. IEEE Int. Conf. BioInformat. BioEng., 2007,
pp. 1163–1167.
[20] H. Mirzaalian, G. Hamarneh, and T. K. Lee, “Graph-based approach to
skin mole matching incorporating template-normalized coordinates,” in
Proc. IEEE Conf. Comput. Vis. Pattern Recog., 2009, pp. 2152–2159.
[21] H. Mirzaalian, T. K. Lee, and G. Hamarneh, “Uncertainty-based feature
learning for skin lesion matching using a high order MRF optimization
framework,” in Proc. Int. Conf. Med. Image Comput. Comput.-Assisted
Intervention, 2012, vol. 7511, pp. 98–105.
[22] R. Gallagher, J. Rivers, T. K. Lee, C. D. Bajdik, D. I. McLean, and
A. J. Coldman, “Broad-spectrum sunscreen use and the development of
new nevi in white children: A randomized controlled trial,” J. Amer. Med.
Assoc., vol. 283, no. 22, pp. 2955–2960, 2000.
[23] O. Kaick, H. Zhang, G. Hamarneh, and D. Cohen, “A survey on shape
correspondence,” Comput. Graph. Forum, vol. 30, pp. 1681–1707, 2011.
[24] U. Castellani, M. Cristani, S. Fantoni, and V. Murino, “A survey on shape
correspondence,” Comput. Graph. Forum, vol. 2, no. 27, pp. 643–652,
2008.
[25] J. Talairach and P. Tournoux, Co-Planar Stereotaxic Atlas of the Human
Brain: 3-Dimensional Proportional System : An Approach to Cerebral
Imaging. U.K.: Thieme Medical Publishers, 1988.
[26] L. Thurfjell, C. Bohm, and E. Bengtsson, “CBA—An atlas-based software
tool used to facilitate the interpretation of neuroimaging data,” Comput.
Methods Progr. Biomed., vol. 47, no. 1, pp. 51–71, 1995.
[27] A. C. Evans, M. Kamber, D. L. Collins, and D. MacDonald, “MRI-based
probabilistic atlas of neuroanatomy,” in An MRI-Based Probabilistic Atlas
of Neuroanatomy. New York, NY, USA: Plenum, 1994, pp. 263–274.
[28] J. Mazziotta, A. Toga, A. Evans, P. Fox, and J. Lancaster, “A probabilistic
atlas of the human brain: Theory and rationale for its development: The
international consortium for brain mapping,” NeuroImage, vol. 2, (Part 1),
pp. 89–101, 1995.
[29] D. Hill, P. Batchelor, M. Holden, and D. Hawkes, “Medical image registration,” Phys. Med. Biol., vol. 46, pp. R1–R45, 2001.
[30] F. Bookstein, Morphometric tools for landmark data. Cambridge, U.K.:
Cambridge Univ. Press, 1997.
[31] T. F. Cootes, C. J. Taylor, D. H. Cooper, and J. Graham, “Active shape
models: Their training and application,” Comput. Vision Image Understanding, vol. 61, no. 1, pp. 38–59, 1995.
[32] F. Andersson, “Bezier and B-Spline Technology,” Umea Universitet,
Umea, Sweden, Master’s Thesis, 2003.
[33] O. Bottema, “On the area of a triangle in Barycentric coordinates,” Crux
Mathematicorum, vol. 8, pp. 228–231, 1982.
[34] F. L. Bookstein, “Principal warps: Thin-plate splines and the decomposition of deformations,” IEEE Trans. Pattern Analysis Mach. Intell., vol. 11,
no. 6, pp. 567–585, Jun. 1989.
[35] M. Wijffelaars, R. Vliegen, J. Wijk, and E. Linden, “Generating color
palettes using intuitive parameters,” Comput. Graph. Forum, vol. 27, no. 4,
pp. 743–750, 2008.
[36] S. Belongie, J. Malik, and J. Puzicha, “Shape matching and object recognition using shape contexts,” IEEE Trans. Pattern Analysis Mach. Intell.,
no. 4, pp. 509–522, Apr. 2002.
[37] M. Leordeanu and M. Hebert, “A spectral technique for correspondence
problems using pairwise constraints,” in Proc. IEEE Int. Conf. Comput.
Vision, 2005, vol. 2, pp. 1482–1489.
[38] R. Zass and A. Shashua, “Probabilistic graph and hypergraph matching,”
in Proc. IEEE Conf. Comput. Vis. Pattern Recog., 2008, pp. 1–8.
[39] O. Duchenne, F. Bach, I. Kweon, and J. Ponce, “A tensor-based algorithm
for high-order graph matching,” IEEE Trans. Pattern Analysis Mach. Intell., vol. 1, no. 99, pp. 1–13, Dec. 2011.
[40] W. Rice, “Analyzing tables of statistical tests,” Evolution, vol. 43, no. 1,
pp. 223–225, 1989.
[41] P. Wighton, M. Sadeghi, T. K. Lee, and S. Atkins, “A fully automatic
random walker segmentation for skin lesions in a supervised setting,”
in Proc. Int. Conf. Med. Image Comput. Comput.- Assisted Intervention,
2009, vol. 5762, pp. 1108–1115.

Authors’ photographs and biographies not available at the time of publication.

