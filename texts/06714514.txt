1274

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

Bimodal BCI Using Simultaneously NIRS and EEG
Yohei Tomita∗ , Member, IEEE, François-Benoı̂t Vialatte, Member, IEEE, Gérard Dreyfus, Fellow, IEEE,
Yasue Mitsukura, Member, IEEE, Hovagim Bakardjian, Member, IEEE, and Andrzej Cichocki, Fellow, IEEE

Abstract—Although noninvasive brain–computer interfaces
(BCI) based on electroencephalographic (EEG) signals have been
studied increasingly over the recent decades, their performance is
still limited in two important aspects. First, the difficulty of performing a reliable detection of BCI commands increases when EEG
epoch length decreases, which makes high information transfer
rates difficult to achieve. Second, the BCI system often misclassifies the EEG signals as commands, although the subject is not
performing any task. In order to circumvent these limitations, the
hemodynamic fluctuations in the brain during stimulation with
steady-state visual evoked potentials (SSVEP) were measured using near-infrared spectroscopy (NIRS) simultaneously with EEG.
BCI commands were estimated based on responses to a flickering
checkerboard (ON-period). Furthermore, an “idle” command was
generated from the signal recorded by the NIRS system when the
checkerboard was not flickering (OFF-period). The joint use of
EEG and NIRS was shown to improve the SSVEP classification.
For 13 subjects, the relative improvement in error rates obtained
by using the NIRS signal, for nine classes including the “idle” mode,
ranged from 85% to 53%, when the epoch length increase from
3 to 12 s. These results were obtained from only one EEG and one
NIRS channel. The proposed bimodal NIRS–EEG approach, including detection of the idle mode, may make current BCI systems
faster and more reliable.
Index Terms—Brain–computer interface (BCI), bimodal, simultaneous electroencephalographic (EEG) and near-infrared spectroscopy (NIRS), steady-state visual evoked potentials (SSVEP).

I. INTRODUCTION
IRECT communication techniques enabling the exchange
of information between the brain and computers such as
brain–computer interfaces (BCIs) have been gaining momentum over the recent decades. One of the pioneering studies using monkeys was proposed in [1]. Although, in these early BCI
experiments, the subject was not human, and a steel plug was

D

Manuscript received October 8, 2013; revised December 16, 2013; accepted
January 7, 2014. Date of publication January 16, 2014; date of current version
March 17, 2014. Asterisk indicates corresponding author.
∗ Y. Tomita is with the Department of Technology Elements Development,
Foster Electric Co. Ltd., Tokyo 164-0001, Japan (e-mail: tomita@foster.co.jp).
F.-B. Vialatte and G. Dreyfus are with the SIGMA Laboratory, École
Supérieure de Physique et de Chimie Industrielles de la Ville de Paris, Paris
75005, France (e-mail: francois.vialatte@espci.fr; gerard.dreyfus@espci.fr).
Y. Mitsukura is with the Department of System Design Engineering, Keio
University, Kanagawa 108-8345, Japan (e-mail: mitsukura@sd.keio.ac.jp).
H. Bakardjian is with the IHU-A-ICM Paris Institute of Translational Neurosciences, Pitie-Salpetriere Hospital (INSERM), Paris 75013, France (e-mail:
h.bakardjian-ihu@icm-institute.org).
A. Cichocki is with the Laboratory ABSP, Riken BSI, Saitama 351-0198,
Japan and with the Institute of Systems Research Polish Academy of Science,
01-447 Warszawa, Polska, Poland (e-mail: cia@brain.riken.jp).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2300492

permanently implanted over the precentral cortex, subsequent
studies demonstrated the possibility of noninvasive analysis of
the human brain due to the rapid development of neuroimaging
modalities and signal processing techniques [2]–[4]. Currently,
several noninvasive functional imaging modalities are available for research, such as electroencephalography (EEG), magnetoencephalography (MEG), functional magnetic resonance
imaging (fMRI), and near-infrared spectroscopy (NIRS). They
encompass the most active areas of BCI research [5].
Among these brain imaging modalities, EEG has most often
been used for BCI due to the high temporal resolution of the
measured brain signals, device portability, and low cost. Recently, coordinated scientific efforts have been made in order
to develop EEG-based BCI systems, as can be illustrated by
the emergence of open-access data and EEG-based BCI competitions (see for instance [6], [7]), which led to improvements
of signal processing and classification algorithms. The short
response times of the brain processes underlying EEG allow
users to control an external device in near-real-time [8]–[10].
For instance, Hill and coauthors [11], in an evaluation of motor imagery based BCI, compared the performance of EEG,
MEG, and electrocorticography recording modalities, and concluded that EEG allowed better general performance than the
other modalities. Furthermore, Millán et al. proposed a mental task recognition technique using near-real-time spontaneous
EEG signals: they were able to classify correctly three mental tasks with a success rate of 70% [12]. Other studies, based
on P300 evoked potentials, obtained higher classification performance [13]. BCI systems based on steady-state visually
evoked potentials (SSVEP) turned out to be very successful
[14]–[17].
Nevertheless, improving EEG-based BCI performance is still
a challenge. First of all, the reliability of command detection decreases as recording time decreases. The search for paradigms
that can detect BCI commands with high temporal resolution is
still active. In addition, most studies ignore BCI system behavior in an idle mode when the user does not require any action.
In BCI systems, using visual stimuli, the subjects can activate
a command by focusing his attention on one of several stimuli.
However, in practice, it is not easy to focus attention for a long
time, as subjects may become diverted, drowsy, or unwilling
to look at the stimulation. Consequently, SSVEP BCIs often
send signals when the user did not intend to convey anything
(called false positives), which can be especially problematic during breaks or resting periods [18]. Such occurrences should be
identified explicitly as an idle mode, otherwise the BCI system
may erroneously issue a command.
To overcome these substantial limitations, we exploit simultaneously an additional source of information, namely the hemodynamic changes measured by NIRS. Recently, a wide variety

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

TOMITA et al.: BIMODAL BCI USING SIMULTANEOUSLY NIRS AND EEG

Fig. 1.

1275

Principles of a bimodal BCI using EEG and NIRS simultaneously.
TABLE I
PREVIOUS STUDIES RELATED TO NIRS-BASED BCI

of NIRS devices has been made available. Expensive models
feature numerous sensor probes and analysis tools, but quick
medical examinations can be carried out with cheaper devices
featuring a smaller number of probes. The advantages of NIRS
are that it is impervious to the widely-spread environmental
electrical noise and much less sensitive to EMG (muscle) artifacts than EEG. NIRS measures oxygenated hemoglobin (Hb)
and deoxygenated Hb concentrations. In addition, the blood
oxygenation level-dependent signal elicited by visual stimulation has been well described using fMRI [24], [25]. Blood Hb
concentration changes have been clearly shown to be related to
the presence and absence of the stimulation. Other studies using
EEG, fMRI, and NIRS [19], [23], [26]–[28] lead to the conclusion that hemodynamic changes may be a promising indicator
to overcome the limitations of the command detection. For instance, for a wheelchair control BCI, the detection of onset and
offset responses improves the BCI usability—when the subject
is not willing to execute a command, the wheelchair should not
move.
Fig. 1 illustrates the joint use of EEG (for command detection)
and NIRS (the detection of stimulation onset and offset) in a
BCI system. In this study, we present such an approach and
demonstrate its use in a BCI system based on SSVEP.
The organization of the paper is as follows. Section II gives
details on the NIRS BCI and on NIRS signal processing. In
Section III, the experimental protocol and the joint EEG—NIRS
BCI design are presented. Sections IV, V, and VI contain results,
discussions, and conclusions, respectively.
II. FEATURE EXTRACTION FOR HEMODYNAMIC RESPONSES
Before describing the joint EEG–NIRS BCI paradigm, we
will first present a rationale for our approach based on some

previously published NIRS-based BCI techniques. New perspectives for NIRS–BCI could arise from these investigations
although so far there have been only a few BCI studies using
the NIRS recording modality as compared to EEG. The basic
hemodynamic brain response, as well as the noise cancellation
technique which is applied before the feature extraction step,
are also explained in this section.
A. Existing NIRS–BCI Methods
Table I shows a summary of NIRS–BCI research publications.
Many of these studies were based on motor imagery of finger and
arm movements. They detected blood oxygenation responses
(slow oscillations at 0.1–0.5 Hz) following motor imagery, and
concluded that motor imagery was appropriate for NIRS–BCI
applications [19]–[21]. On another hand, it was suggested that
the reliability of NIRS—BCI could be improved by combining NIRS with other brain recording modalities. The concept
of combining recording modalities is detailed in [18], [22],
and [23]. For example in [23], the performance of a sensory
motor rhythm based BCI was significantly improved by simultaneous measurement of EEG and NIRS. Another study with
simultaneous recording of NIRS and EEG [22] measured the
responses to electrical stimulation at the right median nerve,
and concluded that evaluating NIRS and EEG simultaneously
provided useful information.
In the present paper, we merge EEG and NIRS modalities in
an SSVEP-based BCI. SSVEP is already a powerful paradigm
for EEG-based BCI because responses to steady-state visual
stimuli have a very good signal-to-noise ratio. The idea that
NIRS could be used as a brain switch to turn ON or OFF the
SSVEP detection in an SSVEP-based BCI is discussed in [18],
but using a different approach—a cognitive NIRS response is

1276

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

(a)

(b)

Fig. 2. Hemodynamic response changes (O2 Hb and HHb) corresponding to visual stimulations indicated by the gray colored periods (see Section III in details).
(a) Block-averaged result for all 37 blocks after low-pass filtering (red: O2 Hb, blue: HHb) and (b) trial-averaged result for 37 (blocks) × 8 (trials of consecutive
ON- and OFF-periods pairs). (a) Block averaging. (b) Trial averaging.

(a)

(b)

(c)

Fig. 3. Event related NIRS features. (a) Hemodynamic responses (red: O2 Hb, blue: HHb, black: O2 Hb-HHb). (b) and (c) show the 1st and 2nd derivatives of
O2 Hb–HHb, respectively. Positive and negative of 1st derivative, and extrema of 2nd derivative are shown. (a) Hemodynamic response. (b) Derivative. (c) 2nd
derivative.

detected in the prefrontal area, whereas we will focus in this
paper on sensory responses in the occipital area. Indeed, NIRS
studies of SSVEP brain responses show that even though the
hemodynamic responses are slower, they do exhibit changes
after stimulation onset and offset [29]. Therefore, the onset and
the offset could be estimated by detecting the hemodynamic
fluctuations in response to visual stimuli.
B. Hemodynamic Responses to SSVEP Stimulation
Changes in blood oxygenation accompany neural activity. Although they are slow and delayed with respect to neural activity,
they convey information about the timing of neural activity.
Hemodynamic signal changes due to SSVEP visual stimulation
are affected by physical and physiological noise. In most offline
studies, the noise is canceled out by averaging trials over time.
Fig. 2(a), (b) show the changes of oxygenated Hb (O2 Hb) and
of deoxygenated Hb (HHb) concentrations during steady-state
visual stimulation. The signals were time-averaged for 37 trials
in an experiment using pseudorandomly displayed stimuli (see
Section III for details). Fig. 2 indicates that NIRS responses to
the visual stimulation appear with a delay of 2–3 s after the
beginning and the end of the stimulation.
Fig. 2 also shows that changes in O2 Hb and HHb are nearly
symmetric. We make use of the first and second derivatives of
the difference between the concentrations of oxygenated and
deoxygenated hemoglobin O2 Hb–HHb [see Fig. 3(a), (b), and
(c)]. The derivative is positive in most regions of the ON-period,
and vice versa for the OFF-period. Moreover, an extremum
of the second derivative can be detected at the beginning of
each period. Therefore, the first and second derivatives may
be useful features to detect the onset and offset of the visual
stimulation.

C. Noise Reduction for NIRS Signal
NIRS signals are subject to noise, arising for instance from
body movements, heart rate, and respiration effects [30]. For the
purpose of BCI, noise components should be removed in real
time from the hemodynamic signals. So far, NIRS signal noise
removal algorithms have been implemented focusing on specific
types of noise (cardiac, Mayer wave, and respiration). In many
studies, noise-canceling algorithms have been investigated using
methods such as the Kalman estimator for generalized linear
models coefficient updating [31], least squares regression [32],
wavelet-based filtering, independent component analysis [33],
and adaptive filtering [33]–[35].
When investigating the properties of NIRS signal noise offline, phase-locked brain responses evoked by the same stimulation in multiple trials can be averaged in the time domain. Using
this approach, one expects noise components to be canceled out
because they are assumed to be additive of zero expectation
value. Fig. 2 shows the signals averaged over N = 37 blocks:
x̄(t) =

N
1 
xi (t)
N i=1

(1)

where xi (t) is the hemodynamic response at time t of the ith
trial. The signal-to-noise ratio of a given NIRS event related
potential is therefore enhanced when several trials are averaged.
In order to evaluate the optimal frequency for the NIRS response
to reversing checkerboards, we averaged all the trials in the
Fourier domain. Letting Xi (ej ω ) be the Fourier transform of a
NIRS signal xi (t), the average Fourier power is


N

1 
jω
jω 
(2)
F (ω) = |X̄(e )| =
Xi (e ) .


N
i=1

TOMITA et al.: BIMODAL BCI USING SIMULTANEOUSLY NIRS AND EEG

1277

Fig. 4. EEG electrodes and NIRS probes are positioned in the occipital area. Each NIRS channel is located between an optical source and an optical detector.
Four EEG electrodes are positioned at the same locations as the corresponding four NIRS channels (NIRS-2, NIRS-9, NIRS-12, NIRS-13, and NIRS-16).

We normalize this spectrum as follows:
R(ω) = F (ω)/G(ω),

G(ω) =

N
1 
|Xi (ej ω )|.
N i=1

(3)

The pulsation that maximizes R(ω) in (3), is the most relevant
component, that we estimated at ω ≈ 0.033 Hz.
III. METHODS
Thirteen healthy subjects, who did not suffer from any brain
disorder, with normal or corrected to normal vision, and who
did not have any prior training participated in this experiment
after signing written informed consent forms. The experimental
design and the analysis methods for joint EEG–NIRS–BCI are
detailed thereafter.
A. Recording and Stimulation
A special head cap was designed to record simultaneously the
NIRS and EEG signals. This cap was flexible enough to fit the
surface of the head. The head cap contained circular incisions for
the EEG electrodes and similar incisions for the NIRS probes,
placed over the occipital area as shown on Fig. 4. The distance
between any two NIRS sensors was fixed at 3 cm. The EEG
electrodes were placed between the NIRS sensors.
The setup of the NIRS instrument (OMM 3000, Shimadzu,
Co. Ltd) consisted of six optical source probes (Near-IR semiconductor lasers) and six detector probes covering the occipital
area. NIRS signals were recorded using pairs of neighboring
source and detector probes. The midpoint between such a pair of
probes was regarded as the probable location of the brain hemodynamic changes recorded by the corresponding NIRS channel.
There were 17 NIRS channels (see the locations in Fig. 4),
recorded with a sampling of 70 ms. All signals were passed
through a digital Butterworth low-pass filter of order 3 and
with a 0.04-Hz cutoff frequency. Hemodynamic changes were
estimated for each NIRS channel using three different wavelengths (780±5, 805±5, and 830±5 nm) and Hb concentration
changes were estimated as O2 Hb, HHb, and total Hb change
(O2 Hb+HHb) based on the modified Lambert–Beer law.
The experimental setup of the EEG system (V-amp, Brain
Products GmbH) included six active electrodes. Before each
recording, a small amount of gel was applied directly to the scalp

to minimize the impedance (below 20 kΩ in our experiment) for
all electrodes. 20 kΩ is a valid threshold when using active
electrodes. The reference electrode was placed on the mandible
bone near the left ear, and the ground electrode was placed
at Cz according to the international 10/20 system. The most
posterior electrode (EEG-5) was placed at Oz according to the
international 10/20 system. All EEG measurement electrodes
were positioned at the midpoint between the NIRS probes. This
ensured that the locations of the EEG electrodes coincided with
the locations of the NIRS channels. The sampling rate of the
EEG recording was 500 Hz. All signals were passed through a
digital Butterworth low-pass filter of order 3 and with a 40-Hz
cutoff frequency, and a digital Butterworth high-pass filter of
order 3 and with a 0.5-Hz cutoff frequency.
EEG and hemodynamic changes were recorded while the subjects focused on visual stimulations displayed on a screen. Subjects were seated 1.0 m from a 17-inch LCD computer display
operated at a nominal refresh rate of 60 Hz. They were instructed
to fix their gaze on a small cross appearing in the center of the
screen. In this setup, the display had a 25-cm height, therefore
the visual angle of the display was calculated to be 7.3◦ arc
at most (θ ≈ (25/2)/100 rad). Continuous SSVEP stimulation
was presented using reversing black-and-white checkerboards
with 18×18 squares. A broad range of stimulation frequencies
was presented (eight different reversing frequencies from 4.8 to
11.8 Hz): 4.8, 5.3, 5.8, 6.5, 7.3, 8.4, 9.8, and 11.8 Hz (see [17]
for frequency optimization). All stimulation frequencies were
displayed once each during a recording (defined as a block). A
block had an overall duration of about 4 min. During each block,
one trial for each of the eight possible reversal frequencies was
recorded, with stimuli presented in a randomized order. During
a given block, each stimulus was displayed for 15 s, followed by
a 15 s period where the checkerboard pattern stopped reversing
and remained still. We define as an “ON-period” the period of
time when the checkerboard is reversing (whatever the stimulus
frequency), and as an “OFF-period” the period of time when
the checkerboard is not reversing. In a SSVEP BCI application,
commands should be detected only when the subject is focusing
on as stimulus, therefore during an ON-period (corresponding
to a selective attention switch/gaze target change in a multistimulus system [17]). In this condition, SSVEP can be observed
in response to the reversing pattern. During the OFF-period,
the subject is not focusing on any command, and therefore the

1278

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

system should clearly identify the event as an idle mode (no
command). Subjects attended several recording sessions (each
subject participated 2–4 times). Recording sessions were carried out on different days (two blocks maximum per day and
per subject) to reduce fatigue effects. The number of the recording sessions varied due to the failure of some subjects to fulfill
attention-related inclusion criteria: having enough sleep on the
night before the recording, and not feeling tired before the experiment. A total of 37 blocks were recorded for all subjects
(hence, 37 trials per stimulation frequency).

(a)

B. Feature Extraction
In this study, we intend to detect the difference between active and idle states using NIRS. We can observe (see Fig. 2) that
O2 Hb increases after the beginning of stimulation and decreases
after the end of stimulation, and vice versa for HHb. These
variations in hemodynamic responses may be measured using
temporal derivative estimations, which are efficient in extracting
information during rapid transients. However, in the presence of
high-frequency noise, temporal derivatives are prone to instabilities and inaccuracies. Therefore, we used a combination of
low-pass and Savitzky–Golay (SG) filters to measure the variations of hemodynamic responses. The low-pass filter served to
remove most noise components, and afterwards the derivative
of the signal was estimated using the output of a SG filter. The
basic idea of the SG filter is based on least-squares polynomial
fitting. The polynomial of degree K is expressed as
p(t) =

K


ak tk

where tk represents the kth power of time t (k = 0, . . . , K),
and the scalars ak are the polynomial coefficients. The fitting of
the coefficients ak are performed by minimizing a cost function
(t). Fitting curve is defined as
x̂(t) = argmin (t)
p(t)



M

(t) =
−M


{p(t + τ ) − x(t + τ )}2 dτ

(5)

where [−M, M ] represents the time range centered on t for
fitting. Then, temporal derivatives can be extracted such as

d
x̂(t) =
kak tk −1
dt
K

(6)

k =1


d2
x̂(t)
=
k(k − 1)ak tk −2 .
dt2
K

(7)

k =1

The active and the idle modes were estimated using the following workflow:
1) A low-pass filter was applied to extract slow NIRS oscillations with resulting signals xO 2 Hb (t) and xHHb (t) [see
Fig. 5(a)].
2) Define y(t) considering O2 Hb and HHb changes, and its
derivative as
y(t) = x̂O 2 Hb (t) − x̂HHb (t)

(c)
Fig. 5. Estimated onset and offset flags. (a) Low-pass-filtered signal from one
trial data (red: xO 2 H b , blue: xH H b ). (b) Difference of derivatives of xO 2 H b
and xH H b . (c) Estimated onset and offset flags. Values of 1 and −1 represent
the onset and offset flags, respectively. All calculated flags are extracted at their
2
correct positions. (a) Noise canceled sample (xO 2 H b , xH H b ). (b) ddt 2 y. (c)
Detected flags.

(4)

k =0



(b)

(8)

d
d
d
y(t) = x̂O 2 Hb (t) − x̂HHb (t).
(9)
dt
dt
dt
The derivatives of y(t) was estimated using a SG filter
with M = 0.1 s and K = 2. The difference of the second
derivatives of y(t) was also calculated [shown in Fig. 5(b)].
3) Onset flag and Offset flags were calculated for each time
point t as shown in Fig. 5(c) when the following conditions
using extrema were satisfied:
Onset flag:
d
d3

Sonset = t y(t) > 0, 3 y(t) = 0,
dt
dt

3
d3
d
−
+
y(t
)
<
0,
y(t
)
>
0
.
(10)
dt3
dt3
Offset flag:
d
d3

Soﬀset = t y(t) < 0, 3 y(t) = 0,
dt
dt

3
3
d
d
−
+
y(t
)
>
0,
y(t
)
<
0
.
(11)
dt3
dt3
Here, the increase and decrease of the hemodynamic respod
y(t). Moreover,nses to SSVEP stimulation is expressed as dt
d3
d3
−
the following three signal derivations ( dt 3 y(t), dt
3 y(t ),
d3
+
dt 3 y(t )) were used to extract the beginning and the end of the
stimulation based on the extremum of the second derivatives.
These onset and offset flags were used to detect if the subject is

TOMITA et al.: BIMODAL BCI USING SIMULTANEOUSLY NIRS AND EEG

Fig. 6. Block diagram of EEG and NIRS analysis consisting of an EEG
analysis module, a NIRS analysis module, and a joint classification module.

in active or idle mode. There are two possible outcomes from
this feature extraction procedure: either there is one flag only
(either onset or offset flag), and in that case, a decision is taken
(OFF or ON period is detected); or there are both flags and no
flags in the analysis window, and in that case, no decision is
taken (unknown condition). The NIRS signal analysis therefore
led to a two-class classification, with a third output class (reject
class).
C. Joint EEG–NIRS–BCI
In this study, SSVEP–BCI command classification was performed using simultaneous EEG and NIRS signals (see Fig. 6)
in order to optimize the detection. For each trial, the NIRS signal
was used to detect if the subject was in an active or idle mode.
The EEG signal was used to estimate which command was to
be activated. The system shall therefore detect either one of the
eight possible commands, or an idle state.
The reversing checkerboard stimulation elicited SSVEP responses in the EEG signal, with peaks at the stimulus frequency
as well as its harmonics. To detect SSVEPs, short EEG epochs
(1-14 s) were extracted to compute the Fourier transform. In this
study, the power spectrum of each trial was normalized by subtraction of the spectrum of the first OFF-period in each block.
For command detection, only the fundamental frequency was
used because the power of the other harmonics was not high
enough to distinguish commands (the fundamental frequency
provided the highest estimation accuracy). The SSVEP measurement was enhanced by computing the ratio of the Fourier
power of the SSVEP peak to the Fourier power at neighboring
frequencies, the so-called SSVEP signal-to-noise ratio (SSVEP
SNR) [16].
From the EEG signal, a BCI command was estimated when
the SSVEP response exceeded a threshold (±0.1-Hz frequency
centered at each stimulation frequency). First of all, the SSVEP
SNR values were normalized by computing z-scores across all
trials. Therefore, the normalized SNR peaks had an average
value of 0 and a standard deviation of 1, whatever the frequency. The threshold parameter controlled the sensibility and
specificity of BCI command detections. With a low threshold,
BCI commands would be estimated at a higher rate, but with an
increased risk of false detections during OFF-periods (a false
positive). For a higher threshold, the risk of false detection was
lower, but the BCI commands were estimated at a lower rate
during the ON-period. We used two thresholds 1.0×std (std is
the standard deviation calculated from the first OFF-period in

1279

every block) as the lower threshold (TH1) and 2.3×std as the
higher threshold (TH2).
The EEG features (command estimates) and NIRS features
(onset and offset flags, described in Section III-B) were then
fed into a joint classifier. One EEG and one NIRS channel with
the best classification performance were selected (same channel
for all subjects). As explained previously, the NIRS feature
extraction led to a two-class classification (OFF- or ON-period)
with a reject class (undetermined period). When an ON-period
was detected, the command detection was based on the best
command detected using EEG (regardless of the threshold).
When an OFF-period is detected, an idle command is returned.
When the reject output class is detected, the BCI command
estimation is based on the best command detected using EEG,
but taking into account a reject threshold (either TH1 or TH2)
to detect the idle command. These thresholds were selected
to compare sensibility and specificity in ON/OFF period. In a
practical system, it can be optimized by minimizing error rates
with a receiver operating characteristic curve.
In this study, only one EEG and one NIRS channels were
selected individually for each subject, because BCI system with
small number of channels has advantages in terms of computational cost and practical use. The EEG channel, with which
the best BCI command detection was achieved, was selected.
Similarly, the NIRS channel was selected based on the best
active/idle mode detection. Spatial SSVEP patterns which are
widely distributed over the occipital were not used, although
it is helpful to reduce classification errors. Analysis techniques
considering multiple signals of EEG and NIRS will be discussed
later.
IV. RESULTS
To validate this approach, we used the EEG and NIRS recordings to estimate the BCI commands offline. First, we will demonstrate the effect of epoch length on the performances of ONand OFF-modes estimation using NIRS signals. Then, we will
present the results obtained using the joint classification approach described previously (see Section III-C).
A. NIRS Feature Extraction
As described in Section III, NIRS signal was used to detect
three possible states: “ON”, “OFF”, and “Unknown”. Detection performance was evaluated using different epoch lengths.
Epochs were extracted from all trials in ON- and OFF-periods
using different time durations starting from the beginning of
each period. A single epoch is extracted from each trial. Fig. 7
shows results obtained on 296 trials of ON- and OFF-periods,
investigated separately. The result using only trials of ON-period
is shown in Fig. 7(a), and Fig. 7(b) is for OFF-period. We define
the ratio of detected trials using the three detection states as
follows:
NON + NOFF
.
(Ratio of detected trials) =
NON + NOFF + NUnknown
(12)
where NON , NOFF , and NUnknown represent number of “ON”,
“OFF”, and “Unknown” estimation results, respectively.

1280

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

(a)

(b)

Fig. 7. Active and idle modes detection using condition flags. The number of
active and idle trials detected using NIRS increased for longer epoch lengths. It
decreased slightly for epoch lengths larger than about 13 s, which may be due
to attentional drops over long periods of stimulation (it is difficult for a subject
to focus for long periods of time). (a) ON-period. (b) OFF-period.

These detected trials can be further subdivided into truepositives (“True” in Fig. 7) and false positives (“Error” in Fig. 7).
False positives are defined as:
(Error) =

(Total of wrong estimation)
.
(Total of detected trials)

(13)

From Fig. 7, it can be observed that the number of detected
trials increased with epoch time length. In both conditions, the
maximum of detected trials was about 80%, most of them being
correctly detected (true-positives).

errors were improved when using the joint EEG–NIRS classifier.
It can be observed that events were estimated correctly by NIRS
and the incidence of false positive onset or offset events was
decreased. According to the averaged performances for each
threshold, TH2 induced better classification results than TH1
(see Table V). Indeed, using TH2 percentages of errors were
decreased of 96%, 85%, 76%, 58%, and 53% for epoch lengths
of 1, 3, 5, 9, and 12 s, respectively.
Furthermore, the performance of our BCI system was assessed on the basis of the Shannon’s information transfer rate
(ITR). For equiprobable user commands C and s commands
performed per minute, where each command was correctly decoded with equal probability p, ITR is given by the following
equation:
1−p
)]. (14)
C −1
ITRs were evaluated offline as shown in Tables VII and VIII.
We considered the epoch duration as an estimate of the “activation delay”. With eight commands and an idle mode (C = 9), p
varies depending on the classification errors from Table V. Because the inclusion of the idle mode slows down our BCI system,
we obtained a rather slow ITR. Nevertheless, our approach of
joint EEG–NIRS classification clearly improves ITRs, notably,
for epoch durations of 1 and 3 s.
ITR = s[log2 (C) + plog2 (p) + (1 − p)log2 (

B. Evaluation of Joint EEG–NIRS–BCI
This subsection presents results obtained with the joint EEG–
NIRS classifier (defined in Section III-C). Before discussing the
overall results, we will first of all present results pertaining to
data gathered in a single block (eight ON-periods and eight
OFF-periods). As was done for the study presented previously
in Section IV-A, ON- and OFF-periods trials were investigated
separately.
We compared the results obtained using only EEG-based detection against the results obtained using a joint EEG–NIRS
classifier. Eight commands and the idle mode (total of nine
classes) were estimated. Detection results are shown in Fig. 8.
In this investigation, NIRS-10 and EEG-3 were selected as the
most relevant channels and only these channels were used. Selected channels with the best classification performance for each
subject were summarized in Table II. As expected, the error using the EEG-based classifier was higher for offset events using
TH1 compared to TH2, and conversely the error was higher for
onset events using TH2 compared to TH1. When using the joint
EEG–NIRS classifier, the error decreased for OFF-period when
using TH1, and for ON-period when using TH2. These results
are summarized in Tables III and IV. For both TH1 and TH2, error decreased with longer time epochs. Moreover, performance
is improved for longer time epochs. Using NIRS features, the
lowest error from Table III was 6% for a 9 s time epoch and TH1.
In this case, comparing an EEG-based classification against a
joint EEG–NIRS classification, the error decreased by 11%.
The same investigation was performed on the whole database.
Results are summarized in Fig. 9 and Tables V and VI. In Fig. 9,
similar characteristics were observed as the results obtained
using the single block data. As shown in Fig. 9(a2) and (b1),

V. DISCUSSIONS
Current progress shows that NIRS features effectively improve BCI performance not only for motor imagery but also
for SSVEP. Previous studies shown in Table I revealed that
blood oxygenation responses are useful especially for a sensory motor rhythm based BCI. Such hemodynamic responses
to visual stimulation were investigated mostly in fMRI studies.
It was seldom investigated with NIRS. From our experimental results, hemodynamic responses recorded with NIRS can
improve SSVEP-based BCI. Our hypothesis was that hemodynamic changes may be a promising indicator to overcome
the limitations of the command detection based on short time
epochs, and of false positives during the OFF-period. In these
two aspects, EEG–BCI was actually improved with inclusion of
NIRS features. Bimodal recording using EEG and NIRS can improve existing EEG–BCI performances. Furthermore, reaching
beyond the specific goals of this study, we point out several approaches for further improvement of NIRS analysis, especially
regarding online NIRS based BCI.
First, noise reduction may be the most important preprocessing step in the extraction of NIRS features. We applied a simple
low-pass filter, which could be improved using more advanced
processing techniques (such as adaptive filtering and wavelet filtering as discussed in Section II). Indeed, noise patterns varied
between subjects, and nonlinear components were present such
as body movement, heart rate, and respiration effects. Moreover,
spatial distribution considering multiple signals will be useful
to reduce classification errors in both aspects of EEG-based
command estimation and of NIRS-based active/idle mode detection. Spatial SSVEP patterns in EEG have been investigated

TOMITA et al.: BIMODAL BCI USING SIMULTANEOUSLY NIRS AND EEG

1281

(a1)

(a2)

(b1)

(b2)

Fig. 8. BCI command detection errors [%] were calculated using one single block. Errors obtained with (red) or without (blue) taking into account the information
provided by NIRS are shown, depending on the epoch length. In (a1) and (a2), TH1 was applied for SSVEP estimation. Errors decreased when the joint EEG–NIRS
classifier was used during the OFF-period. In (b1) and (b2), TH2 was applied for SSVEP estimation. Errors decreased when the joint EEG–NIRS classifier was
used especially during the ON-period. In all cases, the active and the idle modes estimation was useful to decrease false positives during both ON- and OFF-periods.
(a1) TH1, ON-period. (a2) TH1, OFF-period. (b1) TH2, ON-period. (b2) TH2, OFF-period.

Fig. 9. BCI command detection errors [%] were calculated using the whole database. The average errors obtained with (red) or without (blue) taking into account
the information provided by NIRS are shown, depending on the epoch length. Vertical lines represent the standard deviation. In (a1) and (a2), TH1 was applied
for command estimation. Errors decreased when the joint EEG–NIRS classifier was used during the OFF-period. In (b1) and (b2), TH2 was applied for SSVEP
estimation. Errors decreased when the joint EEG–NIRS classifier was used during the ON-period. In all cases, the active and the idle modes estimation was useful
to decrease false positives during both ON- and OFF-periods. (a1) TH1, ON-period. (a2) TH1, OFF-period. (b1) TH2, ON-period. (b2) TH2, OFF-period.

in many studies. Friman et al. investigated six different spatial
signal processing techniques, and concluded that the minimum
energy combination was the most useful method [36]. In more
recent years, some advanced techniques, such as a regularized
common spatial patterns (CSP) [37] and the analytic CSP [38],
have been proposed. Compared to EEG analysis, there are fewer

studies in NIRS analysis. Most of them selected only a region of
interest (ROI) in which task related patterns are appeared. For
further improvement, signal processing using ROI and nonROI
simultaneously should be developed.
Detection time is the main bottleneck for BCI systems. ITRs
are being severely constrained by the command detection rate; in

1282

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

TABLE II
SELECTED EEG AND NIRS CHANNELS WITH THE BEST CLASSIFICATION
PERFORMANCE FOR EACH SUBJECT

TABLE V
SUMMARY OF JOINT BCI COMMAND ESTIMATION RESULTS [%], AS SHOWN IN
FIG. 9

TABLE VI
SUMMARY OF COMMAND ESTIMATION IMPROVEMENT [%], AS SHOWN IN FIG. 9

TABLE III
SUMMARY OF JOINT BCI COMMAND ESTIMATION RESULTS [%], AS SHOWN
IN FIG. 8

TABLE VII
INFORMATION TRANSFER RATES (ITR) FOR NINE COMMANDS INCLUDING THE
IDLE MODE, CORRESPONDING TO ALL SETS IN TABLE V

TABLE IV
SUMMARY OF COMMAND ESTIMATION IMPROVEMENT [%] BY NIRS,
AS SHOWN IN FIG. 8

TABLE VIII
IMPROVEMENT OF INFORMATION TRANSFER RATES (ITR) WITH INCLUSION
OF NIRS FEATURES [%]

order to develop an efficient BCI system, NIRS features should
be correctly detected within a time interval as short as 2–3 s.
In this and previous studies, slow NIRS oscillations at the beginning and at the end of stimulation are observed. However,
these responses were delayed by 2–3 s after the neural activity—
therefore, a simple measurement of the NIRS signal amplitude
is of limited interest (too slow) for BCI systems. We presented
here an approach based on signal derivatives, and demonstrated
its usefulness for the fast detection of NIRS responses. However, caution is necessary since this measure is sensitive to high
frequency noise components. Preprocessing of artifacts is necessary to ensure the detection quality, which is why we removed
higher frequency components with a low-pass filter. However,
these frequency components, as well as the information from the
rejected channels—which we did not use in this analysis—may
also contain valuable information. Therefore, there is still room
for improvements.
One limit of our study is the stimulation protocol used. NIRS
feature extraction could be tested using different time ranges of
stimulation, but for practical reasons, we could only record fixed
epochs of 15 s in our study. Despite this approach allowed us

to collect interesting data, in practical applications for an online
BCI system, the NIRS response may change depending on the
stimulation time. In addition, the use of NIRS features to detect
idle modes on short intervals should only be done with proper
care. Indeed, the estimated flags may cause false positives when
a subject focuses on the SSVEP stimulation for too short a time
(< 2–3 s). To circumvent that risk, we suggestthat a threshold
could be adapted to the second derivative depending on the
epoch length, in that case, oscillations with too low amplitudes
could be ignored.
Finally, our proposed methodology can be applied to other
modalities such as a motor imagery task. Although NIRS signals
have lower time resolution than EEG signals, it can be used to
reduce false positives.

TOMITA et al.: BIMODAL BCI USING SIMULTANEOUSLY NIRS AND EEG

VI. CONCLUSION
In this study, we propose an integrated signal processing approach for a new dual-modality or joint EEG–NIRS–BCI based
on the SSVEP paradigm which improved the performances as
compared to an EEG-only BCI. Our method addressed some
important drawbacks of EEG-based BCI designs by reducing
the required epoch lengths and the false positive commands
during periods when the subject is not executing any command
(OFF-period). The classification error for nine classes, including eight commands and an idle state output, were decreased
with the inclusion of NIRS features. For 13 subjects, nine class
estimation errors for 3, 5, 9, 12-s epochs were 40%, 31%, 22%,
and 17%, respectively. In each time epoch, improved error ratios by NIRS (error with NIRS to error without NIRS) were
85%, 76%, 58%, and 53%, respectively. These results were
obtained from only one EEG and one NIRS channel. It is possible for future studies to improve further the proposed NIRS
feature extraction especially by optimizing artifact removal
techniques.

REFERENCES
[1] E. Fetz, “Operant conditioning of cortical unit activity,” Science, vol. 163,
no. 3870, pp. 955–958, 1969.
[2] N. Birbaumer, “Breaking the silence: Brain–computer interfaces (BCI)
for communication and motor control,” Psychophysiology, vol. 43, no. 6,
pp. 517–532, Nov. 2006.
[3] N. Birbaumer and L. G. Cohen, “Brain–computer interfaces: Communication and restoration of movement in paralysis,” J. Physiol., vol. 579,
no. 3, pp. 621–636, Mar. 2007.
[4] J. R. Wolpaw, N. Birbaumer, D. J. McFarland, G. Pfurtscheller, and
T. M. Vaughan, “Brain–computer interfaces for communication and control,” Clin. Neurophysiol.: Offic. J. Int. Federat. Clin. Neurophysiol.,
vol. 113, no. 6, pp. 767–791, Jun. 2002.
[5] B.-K. Min, M. J. Marzelli, and S.-S. Yoo, “Neuroimaging-based approaches in the brain-computer interface,” Trends Biotechnol., vol. 28,
no. 11, pp. 552–560, Nov. 2010.
[6] C. Brunner and R. Leeb, (2014, Jan. 26). BCI Competition
2008—Graz data set A. [Online]. Available: http://www.bbci.de/
competition/iv/desc_2a.pdf
[7] H. Bakardjian. (2014, Jan. 26). SSVEP database (EEG) [Online].
Available: http://www.bsp.brain.riken.jp/∼hova/ssvep_data_Bakardjian_
LABSP.html
[8] S. Sanei and J. A. Chambers, EEG Signal Processing.. London, U.K.:
Wiley, 2007.
[9] A. Bashashati, M. Fatourechi, R. K. Ward, and G. E. Birch, “A survey
of signal processing algorithms in brain-computer interfaces based on
electrical brain signals,” J. Neural Eng., vol. 4, no. 2, pp. R32–57, Jun.
2007.
[10] F. Lotte, M. Congedo, A. Lécuyer, F. Lamarche, and B. Arnaldi, “A review
of classification algorithms for EEG-based brain–computer interfaces,” J.
Neural Eng., vol. 4, no. 2, pp. R1–R13, Jun. 2007.
[11] N. J. Hill, T. N. Lal, M. Schr, T. Hinterberger, G. Widman, C. E. Elger,
B. Sch, and N. Birbaumer, “Classifying event-related desynchronization
in EEG, ECoG and MEG signals,” Lecture Notes Comput. Sci., vol. 4174,
pp. 404–413, 2006.
[12] J. D. R. Millan, J. Mourino, M. Franze, F. Cincotti, M. Varsta,
J. Heikkonen, and F. Babiloni, “A local neural classifier for the recognition of EEG patterns associated to mental tasks,” IEEE Trans. Neural
Netw./Publicat. IEEE Neural Netw. Council, vol. 13, no. 3, pp. 678–86,
Jan. 2002.
[13] M. Thulasidas, C. Guan, and J. Wu, “Robust Classification of EEG Signal
for Brain-Computer Interface,” IEEE Trans. Neural Syst. Rehabil. Eng.:
Publicat. IEEE Eng. Med. Biol. Soc., vol. 14, no. 1, pp. 24–29, Mar.
2006.

1283

[14] Z. Lin, C. Zhang, W. Wu, and X. Gao, “Frequency recognition based
on canonical correlation analysis for SSVEP-based BCIs,” IEEE Trans.
Biomed. Eng., vol. 54, no. 6, pp. 1172–1176, Jun. 2007.
[15] Y. Wang, X. Gao, B. Hong, C. Jia, and S. Gao, “Brain–computer interfaces
based on visual evoked potentials,” IEEE Eng. Med. Biol. Mag.: Quart.
Mag. Eng. Med. Biol. Soc., vol. 27, no. 5, pp. 64–71, Sep./Oct. 2008.
[16] F.-B. Vialatte, M. Maurice, J. Dauwels, and A. Cichocki, “Steady-state
visually evoked potentials: Focus on essential paradigms and future perspectives,” Prog. Neurobiol., vol. 90, no. 4, pp. 418–438, Apr. 2010.
[17] H. Bakardjian, T. Tanaka, and A. Cichocki, “Optimization of SSVEP brain
responses with application to eight-command brain–computer interface,”
Neurosci. Lett., vol. 469, no. 1, pp. 34–38, Jan. 2010.
[18] G. Pfurtscheller, B. Z. Allison, C. Brunner, G. Bauernfeind, T. SolisEscalante, R. Scherer, T. O. Zander, G. Mueller-Putz, C. Neuper, and
N. Birbaumer, “The hybrid BCI,” Front. Neurosci., vol. 4, no. April, Jan.
2010.
[19] S. Coyle, T. Ward, C. Markham, and G. McDarby, “On the suitability
of near-infrared (NIR) systems for next-generation brain-computer interfaces,” Physiol. Meas., vol. 25, no. 4, pp. 815–822, Aug. 2004.
[20] R. Sitaram, H. Zhang, C. Guan, M. Thulasidas, Y. Hoshi, A. Ishikawa,
K. Shimizu, and N. Birbaumer, “Temporal classification of multichannel
near-infrared spectroscopy signals of motor imagery for developing a
brain-computer interface,” NeuroImage, vol. 34, no. 4, pp. 1416–1427,
Feb. 2007.
[21] K. Tai and T. Chau, “Single-trial classification of NIRS signals during
emotional induction tasks: Towards a corporeal machine interface,” J.
Neuroeng. Rehabil., vol. 6, p. 39, Jan. 2009.
[22] M. Takeuchi, E. Hori, K. Takamoto, A. H. Tran, K. Satoru, A. Ishikawa,
T. Ono, S. Endo, and H. Nishijo, “Brain cortical mapping by simultaneous
recording of functional near infrared spectroscopy and electroencephalograms from the whole brain during right median nerve stimulation,” Brain
Topogr., vol. 22, no. 3, pp. 197–214, Nov. 2009.
[23] S. Fazli, J. Mehnert, J. Steinbrink, G. Curio, A. Villringer, K.-R. Müller,
and B. Blankertz, “Enhanced performance by a hybrid NIRS–EEG brain
computer interface,” NeuroImage, vol. 59, pp. 519–529, Aug. 2011.
[24] A. M. Dale and R. L. Buckner, “Selective averaging of rapidly presented
individual trials using fMRI,” Human Brain Mapp., vol. 5, no. 5, pp. 329–
340, Jan. 1997.
[25] M. Bianciardi, L. Bianchi, G. Garreffa, M. Abbafati, F. Di Russo,
M. G. Marciani, and E. Macaluso, “Single-epoch analysis of interleaved
evoked potentials and fMRI responses during steady-state visual stimulation,” Clin. Neurophysiol.: Offic. J. Int. Federat. Clin. Neurophysiol.,
vol. 120, no. 4, pp. 738–747, Apr. 2009.
[26] N. K. Logothetis, J. Pauls, M. Augath, T. Trinath, and A. Oeltermann,
“Neurophysiological investigation of the basis of the fMRI signal,” Nature,
vol. 412, no. 6843, pp. 150–157, Jul. 2001.
[27] Z. Liu, C. Rios, N. Zhang, L. Yang, W. Chen, and B. He, “Linear and
nonlinear relationships between visual stimuli, EEG, and BOLD fMRI
signals,” NeuroImage, vol. 50, no. 3, pp. 1054–1066, Apr. 2010.
[28] T. J. Huppert, R. D. Hoge, S. G. Diamond, M. A. Franceschini, and
D. A. Boas, “A temporal comparison of BOLD, ASL, and NIRS hemodynamic responses to motor stimuli in adult humans,” NeuroImage, vol. 29,
no. 2, pp. 368–382, Jan. 2006.
[29] S. P. Koch, J. Steinbrink, A. Villringer, and H. Obrig, “Synchronization
between background activity and visually evoked potential is not mirrored
by focal hyperoxygenation: implications for the interpretation of vascular
brain imaging,” J. Neurosci.: Offic. J. Soc. Neurosci., vol. 26, no. 18,
pp. 4940–4948, May 2006.
[30] F. Matthews, B. Pearlmutter, T. Ward, C. Soraghan, and C. Markham,
“Hemodynamics for brain–computer interfaces,” IEEE Signal Process.
Mag., vol. 25, no. 1, pp. 87–94, Jan. 2008.
[31] X.-S. Hu, K.-S. Hong, S. S. Ge, and M.-Y. Jeong, “Kalman estimatorand general linear model-based on-line brain activation mapping by nearinfrared spectroscopy,” Biomed. Eng. Online, vol. 9, no. 1, p. 82, Jan.
2010.
[32] G. Gratton and P. M. Corballis, “Removing the heart from the brain:
compensation for the pulse artifact in the photon migration signal,” pp.
292–299, May 1995
[33] F. C. Robertson, T. S. Douglas, and E. M. Meintjes, “Motion artifact removal for functional near infrared spectroscopy: A comparison of methods,” IEEE Trans. Biomed. Eng., vol. 57, no. 6, pp. 1377–1387, Jun. 2010.
[34] Q. Zhang, G. E. Strangman, and G. Ganis, “Adaptive filtering to reduce
global interference in noninvasive NIRS measures of brain activation: How
well and when does it work?” NeuroImage, vol. 45, no. 3, pp. 788–794,
2010.

1284

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

[35] Q. Zhang, E. N. Brown, and G. E. Strangman, “Adaptive filtering for
global interference cancellation and real-time recovery of evoked brain
activity: A Monte Carlo simulation study,” J. Biomed. Opt., vol. 12, no. 4,
pp. 044 014-1–044 014-12, 2012.
[36] O. Friman, I. Volosyak, and A. Gräser, “Multiple channel detection of
steady-state visual evoked potentials for brain–computer interfaces,” IEEE
Trans. Biomed. Eng., vol. 54, no. 4, pp. 742–750, Apr. 2007.
[37] F. Lotte and C. Guan, “Regularizing common spatial patterns to improve
BCI designs: Unified theory and new algorithms,” IEEE Trans. Biomed.
Eng., vol. 58, no. 2, pp. 355–362, Feb. 2011.

[38] O. Falzon, K. P. Camilleri, and J. Muscat, “The analytic common spatial
patterns method for EEG-based BCI data,” J. Neural Eng., vol. 9, no. 4,
p. 045009, Aug. 2012.

Authors’ photographs and biographies not available at the time of publication.

