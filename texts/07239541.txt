IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, 2015

833

Multistage Nonlinear Optimization to Recover
Neural Activation Patterns From Evoked
Compound Action Potentials of Cochlear
Implant Users
Stefano Cosentino∗ , Etienne Gaudrain, John M. Deeks, and Robert P. Carlyon

Abstract—Objective: Electrically evoked compound action potentials (ECAPs) have been employed as a measure of neural activation evoked by cochlear implant (CI) stimulation. A forwardmasking procedure is commonly used to reduce stimulus artefacts.
This method estimates the joint neural activation produced by
two electrodes—one acting as probe and the other as masker;
as such, the measured ECAPs depend on the activation patterns
produced by both. We describe an approach—termed panoramic
ECAP (“PECAP”)—that allows reconstruction of the underlying
neural activation pattern of individual channels from ECAP amplitudes. Methods: The proposed approach combines two constrained
nonlinear optimization stages. PECAP was validated against simulated and physiological data from CI users. The physiological data
consisted of ECAPs measured from four users of Cochlear devices.
For each subject, an 18 × 18 ECAP amplitude matrix was measured using a forward-masking method. Results: The results from
computer simulations indicate that our approach can reliably estimate the underlying activation patterns from ECAP amplitudes
even for instances of neural “dead regions” or cross-turn stimulation. The operating signal-to-noise ratio (SNR) for the proposed
algorithm was 5 dB or higher, which matched well the SNR measured from human physiological data. Human ECAPs were fitted
with our procedure to determine neural activation patterns. Conclusion: PECAP can be used to identify undesirable features of the
neural activation pattern of individual CI users. Significance: Our
approach may have clinical application as an objective measure
of electrode-to-neuron interface and may be used to devise ad hoc
stimulation strategies.
Index Terms—Cochlear implant (CI), evoked compound action
potential (ECAP), neural activation patterns, optimization.

I. INTRODUCTION
HE electrically evoked compound action potential (ECAP)
is thought to reflect the compound activity of auditory
nerve fibres that are electrically stimulated. ECAPs are often
used as clinical objective diagnostics for cochlear implant (CI)

T

Manuscript received June 23, 2015; revised August 5, 2015; accepted August
31, 2015. Date of publication September 3, 2015; date of current version March
17, 2016. This work was supported by the Medical Research Council U.K. (MCA060-5PQ70) and by Action on Hearing Loss (MC-A060-5PQ75). Asterisk
indicates corresponding author.
∗ S. Cosentino was with MRC Cognition and Brain Sciences Unit, Cambridge
CB2 7EF, U.K. (e-mail: stefano.cosentino@mrc-cbu.cam.ac.uk).
E. Gaudrain was with MRC Cognition and Brain Sciences Unit. He is now
with the , Centre de Recherche en Neurosciences de Lyon.
J. M. Deeks and R. P. Carlyon were with MRC Cognition and Brain Sciences
Unit.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2476373

users both during and after implantation. They provide a fast
noninvasive measure of the compound auditory nerve response,
without the need for any behavioral response from the patient.
Yet, the scarce correlation between ECAPs and behavioral measurements within and across subjects has led some of the research community to question the usefulness of ECAPs [1]–[3].
One aim of this study is to propose a method of processing
ECAP amplitude data that provides a more valid measure of
neural activation patterns.
One concern about the reliability of the measured ECAP relates to the size of the measured evoked response, which is
generally several orders of magnitude smaller than that of the
stimulus used to evoke that response. As such, it is essential to
employ a recording paradigm capable of attenuating the stimulation artifact. The most common and reliable (see Cohen et al.
[4]) approach to achieve this is by using a forward-masking
paradigm first described by Brown et al. [5]. This paradigm
involves obtaining four responses to, respectively, a) a probe
pulse, b) probe preceded by a masker pulse, c) masker alone,
d) non-stimulation. By adding and subtracting the responses according to the formula ECAP = a − (b − c) − d, one can obtain the neural response to the probe uncontaminated by stimulus
artifact or dc bias (see Fig. 1 for a schematic of the method).
In a clinical context, forward-masking ECAPs have often
been used to measure neural response for a given current level,
in conditions where both masker and probe are on the same
electrode. Researchers have expanded this approach to measure
the ECAP amplitude for each electrode combination (“ECAP
masking pattern”), in a paradigm where either the probe position
is fixed and masker position is varied [4], or vice versa [6].
The forward-masking ECAP for any combination of masker
and probe electrode will reflect two main contributions. First,
it will depend on the total neural activation produced by the
stimulation of the probe electrode. Second, the measured ECAP
will depend on the proportion of the probe response that is not
masked by the masker, which we can term k. If masking is
complete, k = 0 and the measured ECAP will mostly reflect the
neural activation due to the probe. Hence, for each masker/probe
electrode combination, the measured ECAP will reflect the proportion of the neural response to the probe that is masked by
the masker, i.e., their joint activation pattern, which can be expressed as
ECAP ∼ (1 − k) · p

(1)

0018-9294 © 2015 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

834

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, 2015

Fig. 2. Illustrative example of (a) simulated ECAP masking pattern measured
on E9 and (b) excitation patterns for E5 to E13.

Fig. 1. Schematics of forward-masking paradigm. Last two columns report
the artifact and neural components that are produced after each waveform by
the following sources: p ∼ probe, m ∼ masker, Φ ∼ baseline activity, θ ∼
amplifier switch-on; and k is the proportion of the probe neural response that is
not masked by the masker.

where p is the neural activation produced by the probe.
Crucially, this measure relies on the masker reducing the
neural response to the probe and, hence, reflects the amount
of neural overlap between the neural “activation patterns” (AP,
also known as “excitation pattern”) elicited by the masker and
probe. Hence, when interpreting the size of any single ECAP,
it is not possible to determine the AP of either the masker or
probe electrode.
Previous research has treated ECAP masking patterns as direct measures of neural activation patterns, but the reasoning
of the current study is not in agreement with this view, as can
be illustrated by a simple extreme example. Consider the case
where the neural APs for a number of electrodes are Gaussian
with widths of the patterns for odd electrodes being four times
as broad as for even electrodes [see Fig. 2(b)]. The simulation
in Fig. 2(a) shows the predicted ECAP masking pattern that
would be measured with masker on electrode 9 (“E9”), derived
by multiplying the excitation pattern for E9 with that for each
of the other electrodes. It shows a “zig-zag” effect, being large
near odd-numbered electrodes and small near even-numbered
electrodes. This effect is due to the excitation patterns of the
other electrodes rather than to E9, and so is misleading.
Our approach, termed panoramic ECAP (PECAP), is to disambiguate this information by recording ECAPs to every possible combination of masker and probe. In order to achieve
a mathematically tractable solution, we make assumptions on
both the production of the ECAP (the ECAP amplitude model
described in Section II-A) and on the properties of the neural

activation patterns (described in Section II-C). If these assumptions hold, the proposed method can recover the AP from the
ECAP amplitudes.
A second objective for the proposed method is to be able to
detect “unwanted exceptions” in the electrode-to-neuron mapping. Such exceptions are instances of poor spatial selectivity
that are likely to reduce the benefit that patients obtain from their
CI. One such case is referred to as neural dead regions; if neurons near a given electrode have not survived, then stimulating
that electrode will produce maximal excitation at one or more
additional places, typically near adjacent electrodes. Another
unwanted exception is caused by cross-turn stimulation. In this
case, stimulating an electrode at, e.g., the apex can cause current
to spread to another cochlear turn. Cross-turn stimulation often
results in an additional peak in the neural excitation pattern at
a point several electrodes away from the one that is stimulated.
Finally, ectopic stimulation can sometimes occur, where the return current exits near the base of cochlea, even when current is
injected to an apical electrode, thereby exciting basal auditory
nerve fibers [7]. As a first step, we describe a method that is
capable of detecting instances of “unwanted exceptions” on a
single electrode per subject.
II. METHODS
A. ECAP Amplitude Model
The proposed approach to recover AP from ECAP amplitudes, termed PECAP, relies on a simple model of forwardmasking ECAPs. The necessary assumptions are reported
below along with a description of the model. A discussion of
these assumptions can be found in Section IV.
1) Symmetry Assumption: The model assumes that ECAPs
are generated by the joint neural activation pattern of both probe
and masker electrodes, thus the ECAP amplitude for a given
combination of probe and masker electrodes (p, m) can be expressed as

Ap (k) · Am (k)
(2)
Mp,m =
k

COSENTINO et al.: MULTISTAGE NONLINEAR OPTIMIZATION TO RECOVER NEURAL ACTIVATION PATTERNS FROM ECAPs

where Ai (k) is the neural AP produced by electrode i stimulated
at most comfortable level (MCL) as function of place k along the
cochlea. Let us define a set of electrodesN : (p, m) ∈ N . The
matrix containing the ECAP amplitudes for all combinations of
p and m will be
M = A · AT .

(3)

−

( k −μ i ) 2
2 ·σ i

.

(4)

Let us denote with B the parameter vector containingμ,σ,
and α for each row of A.
3) APs at Fixed MCL Have Equal Area: If electrodes are
stimulated at the same loudness level (e.g., at MCL), we assume
that the area under the excitation patterns for different electrodes
is roughly the same. Hence, the amplitude parameter α is a
dependent variable of both mean (μ) and width (σ), and B can
be simplified as
⎤
⎡
σ1
μ1
⎥
⎢
⎢
.. ⎥ .
(5)
B = ⎢ ...
. ⎥
⎦
⎣
μN

σN

B. Inverse Problem
	 and meaGiven a set of ECAP amplitude measurements M
surement noise ε,
	 = M + ε.
M

strong assumptions are made on the activation patterns to be
recovered. A second stage follows where potential exceptions
to the simple ECAP model described above are to be detected.
2) STAGE I: Constrained Nonlinear Optimization: STAGE
I of the PECAP approach includes the following main steps.
First, the average along the diagonal of M̂ is computed
T

Hereafter, M is the matrix containing the ECAP amplitudes
obtained with forward-masking method and is assumed to be
symmetric.
2) AP can be Modeled With Gaussian Functions: The neural
activation Ai for electrode i is modeled as a Gaussian, i.e., each
row of A is a Gaussian controlled by three parameters: mean
(μ), standard deviation (σ), and amplitude (α), so that
Ai (k) = αi · e

835

(6)

We are interested in recovering the parameters in B of the
Gaussians that approximate the true neural activation patterns
A as:
⎤
⎡
σ̂1
μ̂1


⎥
⎢
A = AB̂
⎥
⎢ ..
.
.. ⎥ →
(7)
B̂ = ⎢ .
⎦
⎣
M = AB̂ · ATB̂
μ̂N σ̂N
where AB̂ is the AP reconstructed using (4) with means and
widths contained in B̂. Since the solution is not unique, a numerical approach is followed instead, as described next.
C. PECAP Approach
1) Optimization Overview: PECAP consists of a multistage nonlinear optimization. The combination of constrained
(STAGE I) and lessconstrained (STAGE II) optimizations is
necessary because the system is undetermined, thus the solution
is generally not unique: For a given ECAP amplitude measurement matrix M , there is not a unique neural activation pattern
A that can produce it. A first optimization stage is run where

M̂ + M̂
.
(8)
Ms =
2
This is possible having assumed symmetry in the ECAP amplitude model,Mp,m = Mm ,p . By computing M s , the measurement noise ε should be reduced, under the general assumption
that ε is normally distributed [8].
Second, the parameters of B are found that minimize the
error

 

(9)
εM = M B̂ − M s  = AB̂ · ATB̂ − M s  .
A constrained nonlinear optimization algorithm based on the
Barrier method [9] is employed to find the minimum for (9). For
any electrode p, the following constraints are imposed:
⎧
|μp − p| < 0.5
a) ⎪
⎪
⎨
b)
μp−1 ≤ μp ≤ μp+1
(10)
⎪
⎪
⎩
c)
0 < σp ≤ 6.
The first two constraints ensure that the modeled means of
the excitation patterns are within 0.5 electrode spacing from the
expected mean (note that b) is always true when a) is). Constraint
c) imposes an upper limit on the widths of the Gaussians.
3) STAGE II: Partially Constrained Optimization to Detect
Exceptions: The approach in STAGE I to minimize the error in
(9) is highly constrained, and while it prevents solutions with
unrealistic electrode-to-neuron mappings, realistic exceptions
in the activation patterns such as dead regions or cross-turn
stimulations might be undetected. Hence, a second optimization
step is run where constraints are relaxed in a row-by-row order in
A to allow instances of dead regions or cross-turn stimulations
to be detected. This is obtained through two parallel steps run
in parallel.
1) STAGE II (SP): For each probe electrode p, the error in
(9) is computed relaxing constraints a) and b) in (10) (Ai
for i = p will still be constrained) yielding an updated

parameter vector B̂ . A dead region is detected if the new
fit produces a smaller error such that




(11)
εM − AB̂  · ATB̂  − M S  ≥ βεM
β = 10% was derived empirically as a threshold for the
reduction in error to be significant.
2) STAGE II (BI): A stage similar to that described above is
in use to detect instances of cross-turn stimulation. Specifically, for each p, the error in (9) is computed relaxing the
constraints in (10) and allowing Ap to be bimodal. Hence,

the updated parameter vector B̂ contains two additional
values: The mean and the standard deviation of the second peak in the bimodal Ap . An instance of cross-turn
stimulation is detected if the new fit produces a smaller

836

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, 2015

TABLE I
PARAMETERS CHOSEN FOR THE TEN CONDITIONS [COLUMNS (I) AND (II)] AND RESULTS OF THE COMPUTER SIMULATION [COLUMNS (III) AND (IV)]
Channels

Absolute error after
STAGE I.

Simulated
condition

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20 E b i m

1. Canonical μ
with narrow

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

σ

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

.5

–

2. Canonical μ
with unit

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

widths

σ

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

–

3. Canonical μ
with wide

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

widths

σ

5

5

5

5

5

5

5

5

5

5

5

5

5

5

5

5

5

5

–

4. Zig-zag

μ

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

widths

σ

4

1

4

1

4

1

4

1

4

1

4

1

4

1

4

1

4

1

–

widths

5. Displaced μ

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

σ

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

–

E8

6. Displaced μ

3

4

5

6

7

10

10

10

11

12

13

14

15

16

17

18

19

20

–

σ

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

1

–

7. Variable

μ

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

–

widths

σ

1

1.3 3.2 0.9 1.8 1.7 2.8 0.4 2.7 1.9 0.5 1.9 1.7 1.8

2.3

1.9

2.5

1

–

8. Variable
widths &

μ

15

15.3

16.4

18.5

20

–

1.3 3.2 0.9 1.8 1.7 2.8 0.4 2.7 1.9 0.5 1.9 1.7 1.8

3.5 3.8 6.2 7.7 7.8 9.2 10

means

σ

1

9. Bimodal

μ

3

in E8+6

σ

10. Bimodal

μ

in E8+10

σ

11

11

12

12

13

14

2.3

1.9

2.5

1

–

16

17

18

19

20

14

0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5

0.5

0.5

0.5

0.5

0.5

3

4

4

5

5

6

6

7

7

8

8

9

9

10

10

11

11

12

12

13

13

14

14

15

16

17

18

19

20

18

0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5

15

0.5

0.5

0.5

0.5

0.5

(i)

(ii)





Υμ

Υσ

0.14

0.00

0.79

0.12

0.52

Percent improvement after
STAGE II.



A

M

Υμ

Υσ

2.90

↑84

↑86

0.0

↑100

0.00

2.30

–

–

–

–

0.04

0.00

0.70

–

–

–

–

0.65

0.10

0.00

1.60

↑83

↑70

0.0

↑100

0.82

0.16

0.04

2.60

↑90

↑88

↑100 ↑100

0.94

0.22

1.09

2.30

↑72

↑45

↑100 ↑100

0.80

0.11

0.00

3.20

↑46

↑18

0.0

↑69

0.88

0.27

4.54

4.80

↑44

↑19

↑22

↑50

1.36

0.22

1.00

5.40

↑62

↑55

↑100

↑70

1.33

0.22

1.00

5.20

↑73

↑64

↑100

↑73

A

M

1.14

(iii)

(iv)

Column (ii) contains the electrode location of the second mean (E b i m ) for the bimodal conditions 9 and 10. The results were obtained averaging across 20 individual runs and six
SNR values [dB]: 0, 5, 10, 15, 20, and +. Values for STAGE II are reported as percent improvement on error values from STAGE I.

error as per (11). Whenever both the first and second steps
of STAGE II fulfil (11) for a given probe electrode, the
larger of the two improvements will be taken as indication
of either a shifted peak or of bimodality.
The search for exceptions in the neural activation carried out
in STAGE II is restricted to instances of single exceptions: If
one or more electrodes are in a dead region or produce crossturn stimulation, STAGE II will likely fail to detect them. This
limitation is discussed further in Section IV.
III. DATA VALIDATION
Three tests were designed to validate the PECAP approach
and, indirectly, the ECAP amplitude model also described in
Section II. Both simulated and actual CI data were used.
A. Test 1: Simulated Data
1) Stimuli and Methods: Simulated measurement M s were
generated using the model described in Section II-A. In order
to validate the ability of PECAP to predict activation patterns
A known a priori, M s were generated for a number of different conditions and at different signal-to-noise ratios (SNRs).

Different SNRs were obtained by adjusting the RMS of a noise
matrix (ε in (6)) which was linearly added to the simulated
M . The parameters were chosen to simulate ten conditions that
encompass possible neural activation scenarios and that are reported in Table I. Conditions 1–3 simulate scenarios where the
neural activation are centred on the stimulating electrode (i.e.,
the expected mean values), whereas their widths can be between
0.5 and 5 for all electrodes. In condition 4, the widths of odd
electrodes differ significantly from the widths of the even electrodes (this example was also described in Section I). Condition
5 simulates a dead region, where the neural activation for E8
peaks on E9. In Condition 6, both E8 and E9 are displaced and
their APs peak on E10. Condition 7 simulates variable widths
(in the range of 0.2 and 3.5) across different electrodes. Condition 8 combines the variable widths of condition 7 with variable
means, thus reflecting a very heterogeneous neural survival in
the cochlea. Finally, conditions 9 and 10 simulate instances of
bimodality where E8 has a second peak in the activation pattern
that is 6 or 10 electrodes basally to the probe, respectively.
2) Simulation Results and Discussion: Four metrics were
used to quantify the discrepancy between true values and
those produced by the PECAP reconstruction. Two metrics are

COSENTINO et al.: MULTISTAGE NONLINEAR OPTIMIZATION TO RECOVER NEURAL ACTIVATION PATTERNS FROM ECAPs

837

Fig. 3. Error metrics as function of SNR estimated for the computer simulation results of Test 1. To aid readability, each metric was normalized across the ten
conditions. Note that normalized errors should not be compared across metrics. Color image online.

the RMSE computed between true and fitted neural activation
patterns A (ΣA ), and between true and reconstructed measurement matrix M (ΣM ). Two more metrics are the number of
cases where the mean or width in the modeled APs differ from
true values by more than a fixed amount, and are labeled as Υμ
and Υσ , respectively; the “fixed amount” is 1 electrode for the
computation of Υμ , and 50% from the original value for the
computation of Υσ . The results for the four metrics over the ten
conditions are reported as the function of SNR in Fig. 3. Average results for a subset of SNR are reported in columns (iii) and
(iv) of Table I. Conditions 8–10 yielded larger errors than other
conditions for PECAP STAGE I (red curves). This is somewhat expected since the high variability in the expected means
(condition 8) and the bimodality (conditions 9 and 10) violate one or more assumptions made by the PECAP method in
STAGE I. For instance, the unimodal Gaussian activation patterns assumed in STAGE I will fail to detect the second mean
and width for the bimodal pattern in E8 of conditions 9 and 10.
The addition of STAGE II allowed a better modeling for
these conditions. Note that while bimodal fitting in STAGE II
increases the degrees of freedom of PECAP, thus potentially
allowing only nonnegative improvements of the fitting between
observed and reconstructed measurement matrix M , larger
RMSE could in principle have been observed between true
and reconstructed activation pattern A. This was not observed
and improvements relative to errors from STAGE I were reported in the range of 0% (no exception detected) and 100%, as
shown in columns (iv) of Table I. Note that the errors remaining after STAGE II were likely influenced by the fact that our
present implementation of STAGE II corrects only for single
exceptions.
Overall, error functions for STAGES I and II in Fig. 3 approach zero for SNR values greater than about 5 dB.
B. Test 2: Human Data
1) Data Measurement: Five independent ECAP datasets
were measured from four users of the CI24RE implant manufactured by Cochlear (CIC4 chip). Data reported as S4 and

S5 are from the same CI user, after first and second implantation, respectively. The forward-masking procedure described
earlier was employed [10], [11]. Two consecutive runs were
measured placing the recording electrode either two electrodes
basally (for subject S1), or two electrodes apically (for S2 and
S3) relative to the probe; a spacing of one electrode was used
when the assigned recording electrode was used as masker.
Only one run was available for S4 and S5. Note that the choice
of recording electrode has a considerably smaller effect than the
masker-probe separation because the ECAP is conducted along
the length of the cochlea [12], and this effect is, thus, neglected
in the model. Eighteen probe electrodes were tested, leading to
324(m, p) combinations. The total number of recordings was,
therefore, 2592 (2 recording electrodes ×4 measures [a, b, c,
and d in Fig. 1] ×324) repeated 50 times at a rate of 80 Hz, thus
leading to a total recording time of 27 min. Each electrode was
stimulated at MCL, which was estimated by manually increasing
current levels and asking the subject to report the perceived loudness on an 11-point loudness chart, where MCL corresponded to
point 7, labeled “MOST COMFORTABLE. You could listen to
this level for a long time without discomfort.” Measured MCLs
did not vary significantly within subject: The standard deviation
across electrodes was within 6 μA, and the largest difference
for any two electrodes was 20 μA. When the masker and probe
were on the same electrode, they had the same level. All pulses
were charge-balanced biphasic pulses 25 μs in duration, and
stimulation mode was monopolar. The return ground was MP1
for the stimulating electrode and MP2 for the recording electrode. The ECAP amplitudes were extracted from the average
ECAP as the amplitude difference between the first negative
and positive peaks (N1 and P1, respectively). An ECAP was
considered valid if N1 occurred between 156 and 497 μs of the
recorded segment, and if P1 occurred at least 48.8 μs after N1
and before 888 μs. Example ECAPs are reported in Fig. 4.
2) Reconstruction of AP via PECAP: The M s from five
ECAP datasets were analyzed with the PECAP method and
results summarizing the detection of exceptions in the excitation
pattern are reported in Table II. Note that although we do not
know the true value of A for the human data, the fitting algorithm

838

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, 2015

TABLE II
ESTIMATED ELECTRODE MEANS (WIDTHS) AFTER STAGE II (SP) AND (BI)
USING HUMAN DATA OF TEST 2 AND 3
Result from Test 2

S1

Result from Test 3

STAGE II (SP)

STAGE II (B1)

x

x

STAGE II (SP)

STAGE II (B1)

E in BP
3–12

x

3(6)–16.2(6)

S2 12(3.1)→13.5(2.7) 12(1.1)–15.7(2.3)

–

–

–

S3

x

x

x

8(2)–18.2(1.5)

8–18

S4

x

5(5.8)–22(6)

–

–

–

S5

x

x

x

11.8(6)–21.5(1.7)

12–22

(i)

(ii)

(iii)

(iv)

(v)

Values in parenthesis are estimated widths. The mean (width) values to the left and right of
the arrow in column (i) indicate the mean (width) values after STAGE I and after STAGE
II (SP), respectively. Values in column (ii) and (iv) are the estimated bimodal parameters
after STAGE II (BI).

Fig. 4. Typical ECAP responses. Top plot: ECAP responses measured for all
subjects when both probe and masker are on electrode 8. ECAP amplitudes
(which are used to populate matrix M) were computed from N1 and P1 reported
as downward and upward facing triangles, respectively. Bottom plot: ECAP
measured for S3 as function of masker electrode position. The probe electrode
was E14, whereas the masker electrodes were E14, E16, E18, E20, and E22.
Color image online.

minimizes the fit between the observed and reconstructed M,
which is available. Possible exceptions were found for S2 and
S4.
For S2, STAGE II detected one instance of a shifted peak and
one of bimodality, both on electrode 12. Allowing a bimodal
activation pattern on E12, with second peak 3.7 electrodes more
apically, improved the fitting by 12.6%, whereas the shifted
peak showed an improvement of 10.6%, hence just above the
significant level β set to 10% [see (11)]. A shifted peak in the
excitation pattern is often interpreted as an instance of a dead
region, whereas bimodal APs have been linked with cross-turn
stimulation [13]–[15]. Modeled A and M following STAGES I
and II are shown in Fig. 5. Overall, results are consistent with an
exception around E12; it is possible that a region of lower neural

Fig. 5. Top panel: Measured and modeled M for S2 on E12; bottom: modeled
A after STAGE I, STAGE II to detect shifted peaks (SP), or STAGE II to detect
bimodality (BI). Color image online.

density is found near E12, and that stimulating E12 produces
another focus of excitation more basally.
An instance of bimodality was detected also for S4, where
modeling the activation pattern on E5 as a bimodal Gaussian
with second peak on E22, led to a reduction in the error (see (9)
and (11)) of 15.3%. Interestingly, the data after reimplantation
of the same subject (reported as S5 in this study) do not show
any bimodality. Reimplantation for S4 was motivated by poor
subject performance, possibly due to a faulty first device.
C. Test 3: Simulated Bimodality in Human Data
1) Data Measurement: In order to further assess the PECAP
ability to detect instances of bimodality from ECAP measurements, bimodality was artificially introduced in the data by
means of bipolar stimulation. One channel in the array was
stimulated in bipolar mode with electrode separation of +9 or
+10 between the two stimulated electrodes in each bipolar pair,
in order to mimic cross-turn stimulation [15]. The channel in

COSENTINO et al.: MULTISTAGE NONLINEAR OPTIMIZATION TO RECOVER NEURAL ACTIVATION PATTERNS FROM ECAPs

839

bipolar mode was E3 for S1, E8 for S3, and E12 for S5 (see
column (v) in Table II). Data from S2 and S4 were excluded as
instances of bimodality had already been shown in Test 2. The
data collection procedure described in III-B1 was adopted also
for Test 3.
2) Results: Results are reported in column (iii) and (iv) of
Table II. Instances of bimodality were detected in all three subjects after STAGE II of PECAP. The activation pattern for the
electrode stimulated in bipolar mode was always better modeled
by PECAP using a bimodal Gaussian function, which overall
reduced the error between the measured and modeled ECAP
measurement M by more than 10%. No shifted peak was detected, consistent with results from Test 2.
D. Operating SNR for PECAP Based on Human Data
1) Test-Retest Reliability: The PECAP approach is intended
as a first step toward the development of an objective diagnostic
tool to detect exceptions in electrode-to-neuron mapping of CI
users. The output of such a tool may inform different stimulation
strategies that can affect the outcome of the device for individual
subjects. As such, it is crucial to determine the lowest SNR at
which the PECAP can be reliably applied. From the computer
simulation in Test 1, acceptable errors were obtained for SNR of
5 dB or higher (see Section III-A2; Fig. 3). This was determined
by tracking four performance measures as a function of SNR and
using ten artificial conditions (see Table I). Note that this value
is dependent on the exact conditions that have been simulated.
Having determined the operating SNR for ECAP, it is necessary to estimate the amount of SNR that is found in physiological
data. We determined this value using ECAP data of Test 2. The
RMSE between the M of two simulated runs was compared
against the RMSE between two consecutive measurements of
M, which were available for S1, S2, and S3. Both simulated and
actual Ms were linearly normalized before RMSE computation.
2) Results: Fig. 6 reports the RMSE obtained for simulated
and for physiological M s. The RMSE for simulated M s as a
function of input SNR was fitted with a fifth-order polynomial.
The intercept of the fit with the RMSE measured from physiological data is indicative of realistic SNRs in human data. A
SNR greater than 5 dB was found for the three subjects, therefore within the PECAP operating SNR range. In general, for
subjective data where the RMSE between two ECAP runs corresponds to SNR smaller than 5 dB, the PECAP reconstruction
may not be reliable. A reliable behavior of the approach was
defined as low misestimation of means Υμ and widths Υσ of
the Gaussian APs and the ability of detecting single instances
of bimodality or displaced means.
IV. DISCUSSION
This study describes a novel approach to recover neural activation patterns from ECAP amplitudes. The approach, termed
PECAP, consists of two stages that combine a highly constrained
and a lessconstrained optimization to ensure convergence. Constraining is necessary because the solution is generally not
unique. The PECAP was shown to be able to predict both simulated and measured data for realistic SNR values. The multistage

Fig. 6. Test-retest variability. RMSEs obtained from two runs of simulated
M’s at various SNR (×). RMSEs obtained from human data are also plotted
(o) on the intercept with the polynomial fit. The shaded area indicates the SNR
space in physiological measurements where PECAP outcomes are reliable.
Color image online.

approach includes a search for two types of exceptions in the
excitation pattern: shifted peaks or bimodality. A number of limitations of the PECAP and further discussion points are reported
below.
A. On the Symmetry Assumption
ECAP amplitudes reflect the joint neural activation pattern
of both masker and probe activation patterns; as such, any two
electrodes should produce the same ECAP amplitude irrespective of which is used as masker and which as probe. While the
theoretical bases for this mechanism have been described in
other studies, it has often been neglected from the interpretation of the data, with ECAPs being used as a direct measure of
the probe’s excitation [4], [16], [17]. In this study, a symmetry
assumption was incorporated in the ECAP model (see (2) and
(3), which is used by the proposed PECAP algorithm to recover
activation patterns.
B. On the Shape of the Activation Patterns
In Section II-A, it is assumed that AP patterns can be described by Gaussian functions each with a single mean. While
the unimodality assumption is relaxed through STAGE II, this
remains possible for only one channel at the time. In normal,
acoustic hearing the excitation patterns of the masker and probe
have flat tops and steep low-frequency skirts [18]. The exact
shape of the excitation patterns in CI cannot be generalized for
all CI users; however, based on forward and interleaved masking
experiments, it is likely to be some variation of a bell-shaped
pattern [19]–[21].
A related assumption is made on the area of the activation
patterns (see Section II-A3). Specifically, it is assumed that the
area under the excitation pattern for a given stimulus should
reflect the perceived loudness of such stimulus. There is some
evidence that this is the case for acoustic hearing [22].

840

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, 2015

C. Robustness of the Algorithm
The current implementation of the PECAP algorithm suffers
from two limitations. First, STAGE II of the PECAP algorithm
is limited to the detection of a single exception. When multiple
instances of shifted peaks and/or bimodality (e.g., dead regions
and cross-turn stimulation) occur in the same subject, the AP
reconstructed using PECAP is likely to be inaccurate.
Second, the algorithm is dependent on the arbitrary choice
of certain parameters, such as β, the constraints in (10), or the
optimization algorithm.
Further investigation of these aspects is essential, as the robustness of the algorithm has particular relevance when considering its clinical applicability as a diagnostic tool.
D. Operating SNR for PECAP
ECAP measurements reflect a combination of neural activity and measurement noise. Depending on factors such as the
equipment used for data collection, the procedure in place or
the subject, the SNR in the measured ECAPs may vary considerably. The PECAP approach would provide different degrees
of accuracy depending on the SNR in the human data. Being
able to determine what is the lowest SNR in the human data at
which the PECAP can provide a reliable solution has obvious
clinical relevance. In Section III-D, this value was determined to
be 5 dB, which was smaller than the corresponding SNRs found
in human data of this study. It is important to note, however, that
for activation patterns that are different from those simulated in
Section III-A, a different operating SNR may be necessary for
reliable predictions of PECAP.
V. CONCLUSION
A novel algorithm—termed PECAP—was described that can
recover neural activation patterns from evoked compound actions potentials in CI users. The algorithm performs multistage optimizations to model Gaussian activation patterns and to
detect single exceptions in the expected patterns, such as bimodality or shifted peaks. PECAP performed reliably on both
computer simulated and actual human data from this study. The
algorithm has potential as clinical tool for CI users.
ACKNOWLEDGMENT
The authors would like to thank S. M. Bierer and J. A. Bierer
for their insights during earlier stages of this work, and two
expert reviewers for their helpful comments.
REFERENCES
[1] C. McKay et al., “Can ECAP measures be used for totally objective
programming of cochlear implants?” J. Assoc. Res. Otolaryngol., vol. 14,
pp. 879–890, Dec. 1, 2013.
[2] H. Thai-Van et al., “Modeling the relationship between psychophysical
perception and electrically evoked compound action potential threshold
in young cochlear implant recipients: Clinical implications for implant
fitting,” Clin. Neurophysiol., vol. 115, pp. 2811–2824, 2004.

[3] S. Vlahović et al., “Differences between electrically evoked compound
action potential (ECAP) and behavioral measures in children with cochlear
implants operated in the school age vs. operated in the first years of life,”
Int. J. Pediatric Otorhinolaryngol., vol. 76, pp. 731–739, 2012.
[4] L. T. Cohen et al., “Spatial spread of neural excitation in cochlear implant
recipients: Comparison of improved ECAP method and psychophysical
forward masking,” Hearing Res., vol. 179, pp. 72–87, 2003.
[5] C. J. Brown et al., “Electrically evoked whole-nerve action potentials:
Data from human cochlear implant users,” J. Acoust. Soc. Amer., vol. 88,
pp. 1385–1391, 1990.
[6] M. L. Hughes and L. J. Stille, “Effect of stimulus and recording parameters
on spatial spread of excitation and masking patterns obtained with the
electrically evoked compound action potential in cochlear implants,” Ear
Hearing, vol. 31, pp. 679–692, 2010.
[7] C. C. Finley et al., “Role of electrode placement as a contributor to variability in cochlear implant outcomes,” Otol. Neurotol., vol. 29, pp. 920–928,
2008.
[8] J. A. Undurraga et al., “Evaluating the noise in electrically evoked compound action potential measurements in cochlear implants,” IEEE Trans.
Biomed. Eng., vol. 59, no. 7, pp. 1912–1923, Jul. 2012.
[9] R. H. Byrd et al., “A trust region method based on interior point techniques
for nonlinear programming,” Math. Program., vol. 89, pp. 149–185, Nov.
1, 2000.
[10] P. J. Abbas et al., “Channel interaction in cochlear implant users evaluated using the electrically evoked compound action potential,” Audiol.
Neurotol., vol. 9, pp. 203–213, 2004.
[11] C. Miller et al., “Electrical excitation of the acoustically sensitive auditory nerve: Single-fiber responses to electric pulse trains,” J. Assoc. Res.
Otolaryngol., vol. 7, pp. 195–210, 2006.
[12] M. L. Hughes and L. J. Stille, “Effect of stimulus and recording parameters
on spatial spread of excitation and masking patterns obtained with the
electrically evoked compound action potential in cochlear implants,” Ear
Hearing, vol. 31, pp. 679–692, 2010.
[13] J. H. Goldwyn et al., “Modeling the electrode–neuron interface of cochlear
implants: Effects of neural survival, electrode placement, and the partial
tripolar configuration,” Hearing Res., vol. 268, pp. 93–104, 2010.
[14] B. C. J. Moore and J. I. Alcantara, “The use of psychophysical tuning
curves to explore dead regions in the cochlea,” Ear Hearing, vol. 22,
pp. 268–278, 2001.
[15] J. H. M. Frijns et al., “The importance of human cochlear anatomy for
the results of modiolus-hugging multichannel cochlear implants,” Otol.
Neurotol., vol. 22, pp. 340–349, 2001.
[16] M. L. Hughes and L. J. Stille, “Psychophysical versus physiological spatial forward masking and the relation to speech perception in cochlear
implants,” Ear Hearing, vol. 29, pp. 435–452, 2008.
[17] M. L. Hughes and L. J. Stille, “Psychophysical and physiological measures
of electrical-field interaction in cochlear implants,” J. Acoust. Soc. Amer.,
vol. 125, pp. 247–260, 2009.
[18] B. C. J. Moore and B. R. Glasberg, “Suggested formulae for calculating
auditory-filter bandwidths and excitation patterns,” J. Acoust. Soc. Amer.,
vol. 74, pp. 750–753, 1983.
[19] J. A. Bierer et al., “Identifying cochlear implant channels with poor
electrode-neuron interfaces: Electrically evoked auditory brain stem responses measured with the partial tripolar configuration,” Ear Hearing,
vol. 32, pp. 436–444, Jul./Aug. 2011.
[20] D. A. Nelson et al., “Forward-masked spatial tuning curves in cochlear
implant users,” J. Acoust. Soc. Amer., vol. 123, pp. 1522–1543, 2008.
[21] M. Azadpour et al., “Place specificity measured in forward and interleaved masking in cochlear implants,” J. Acoust. Soc. Amer., vol. 134,
pp. EL314–EL320, 2013.
[22] Z. Chen et al., “A new method of calculating auditory excitation patterns
and loudness for steady sounds,” Hearing Res., vol. 282, pp. 204–215,
2011.

Authors’ photographs and biographies not available at the time of publication.

