IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

1281

Probabilistic Multiple Sclerosis Lesion Classification
Based on Modeling Regional Intensity Variability
and Local Neighborhood Information
Rola Harmouche∗ , Nagesh K. Subbanna, D. Louis Collins, Douglas L. Arnold, and Tal Arbel, Member, IEEE

Abstract—Goal: In this paper, a fully automatic probabilistic
method for multiple sclerosis (MS) lesion classification is presented,
whereby the posterior probability density function over healthy tissues and two types of lesions (T1-hypointense and T2-hyperintense)
is generated at every voxel. Methods: During training, the system
explicitly models the spatial variability of the intensity distributions
throughout the brain by first segmenting it into distinct anatomical regions and then building regional likelihood distributions for
each tissue class based on multimodal magnetic resonance image
(MRI) intensities. Local class smoothness is ensured by incorporating neighboring voxel information in the prior probability through
Markov random fields. The system is tested on two datasets from
real multisite clinical trials consisting of multimodal MRIs from
a total of 100 patients with MS. Lesion classification results based
on the framework are compared with and without the regional information, as well as with other state-of-the-art methods against
the labels from expert manual raters. The metrics for comparison include Dice overlap, sensitivity, and positive predictive rates
for both voxel and lesion classifications. Results: Statistically significant improvements in Dice values (p < 0.01), for voxel-based
and lesion-based sensitivity values (p < 0.001), and positive predictive rates (p < 0.001 and p < 0.01 respectively) are shown
when the proposed method is compared to the method without
regional information, and to a widely used method [1]. This holds
particularly true in the posterior fossa, an area where classification
is very challenging. Significance: The proposed method allows us
to provide clinicians with accurate tissue labels for T1-hypointense
and T2-hyperintense lesions, two types of lesions that differ in appearance and clinical ramifications, and with a confidence level
in the classification, which helps clinicians assess the classification
results.
Index Terms—Entropy, Markov random fields (MRFs),
maximum a posteriori (MAP), multiple sclerosis lesion
classification, probabilistic classification, spatial information.

Manuscript received March 28, 2014; accepted December 9, 2014. Date of
publication December 9, 2014; date of current version April 17, 2015. This
work was supported by a Canadian National Science and Engineering Research
Council Strategic Grant (STPGP 350547-07) and a Canadian National Science
and Engineering Research Council Collaborative Research and Development
Grant (CRDPJ 411455-10). Asterisk indicates corresponding author
∗ R. Harmouche is with the Surgical Planning Laboratory, Brigham and
Women’s Hospital and Harvard Medical School Boston, MA 02115 USA
(e-mail: rharmo@bwh.harvard.edu).
N. K. Subbanna and T. Arbel are with the Department of Electrical and
Computer Engineering, McGill University.
D. L. Collins is with the Department of Biomedical Engineering, McGill
University.
D. L. Arnold is with the Montreal Neurological Institute, McGill University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2385635

I. INTRODUCTION
ULTIPLE sclerosis (MS) is an inflammatory demyelinating disease of the central nervous system (CNS),
characterized by clinical attacks of CNS dysfunction usually referred to as relapses. The frequency of focal inflammatory events
in cerebral white matter is approximately an order of magnitude
greater than the frequency of clinical relapses [2]. Therefore,
the detection and quantification of white matter lesions is an
attractive marker of disease activity that provides statistical advantages over counting relapses. Understanding the evolution
of the focal inflammatory demyelinating disease process is also
critical for understanding the pathogenesis of MS. However,
manually locating and identifying lesions on MRI scans can be
very time consuming and is associated with considerable intraand inter-rater variability. An automated method for MS lesion
classification offers advantages in speed and provides a more
consistent and objective method for lesion identification.
Several MRI modalities varying in tissue intensity characteristics are used in order to classify MS lesions. Generally
speaking, MS lesions appear bright on T2-weighted (T2w) and
proton density (PD) MRIs, with better contrast provided with
T2w imaging. However, it is difficult to distinguish between
CSF and lesions on the latter. T1-hypointense lesions are a subset of T2-hyperintense lesions that appear dark on T1-weighted
(T1w) MRIs when compared to the remainder of the lesions.
Classifying T1-hypointense lesions is also important when assessing tissue damage in MS, since in their chronic form, they
are associated with damage and disability [2]. Finally, FLAIR
imaging is very useful in highlighting the contrast between lesions and cerebro-spinal fluid (CSF). It is also very useful in
capturing the less hyperintense juxta cortical lesions as they are
still considerably more hyperintense in FLAIR than they are
in other modalities. However, severe T2-hyperintense lesions
appear similar to CSF in FLAIR.
The automatic classification of MS lesions is difficult for multiple reasons due to which, according to a recent review paper
by Garcia-Lorenzo et al. [3], there has been no completely satisfactory solution proposed to date. First, the MRI intensity distributions vary significantly between acquisitions obtained from
different scanners, which is often the case in multisite clinical
trials. Moreover, within a specific MRI brain acquisition, the intensities of lesions and normal tissues vary in different areas of
the brain. Previous works have noted tissue intensity variations
between the basal ganglia and the cortex. Similar variations
occur in the posterior fossa where lesion intensities resemble

M

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1282

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

the intensities of other tissues in that area, particularly those of
gray matter. Posterior fossa lesions are particularly difficult to
segment since, in addition to tissue intensity variations, the contrast between lesions and surrounding tissues is low in that area.
Posterior fossa lesions are nonetheless important to segment
in order to assess disease progression, although most methods
avoid them. Second, the “dirty white matter,” which is sometimes present around lesions, renders the lesion delineation task
more difficult. Finally, with regard to T1-hypointense lesions,
there is yet to be a consensus on the lesion boundaries. These
factors challenge the effectiveness of intensity-based classifiers.
Fig. 1. Segmented regions considered for likelihood estimation. Axial (left)
and sagittal (right) slices are shown.

A. Previous Works
A variety of approaches have been used for the classification of T2-hyperintense MS lesions. An extensive review of
those approaches can be found in [3]. Some of the more recent
approaches include fuzzy reasoning methods and contouring approaches [4]–[6], artificial and cellular neural networks [7]–[9],
neighborhood operators [10]–[12], hidden Markov models [13],
[14], probabilistic and Bayesian approaches [1], [15]–[28], clustering methods [29], outlier detection techniques [1], [4], tree
algorithms [23], geometric models [30], [31], graph cuts [32],
[33], and artificial immune networks [34].
Spatial information for T2-hyperintense lesion classification,
i.e., information about the location of the lesion in the brain, has
been incorporated either through the classifier features [8], [11]
or by the use of a statistical atlas [1], [6], [16], [19]. Relative
spatial information has also been used, mainly with Markov random fields (MRFs) [1], [25], [28], or by including neighborhood
information as features in the classifier [8], [26]. However, studies and empirical evidence show that tissue-specific intensities
on T1w, T2w, and PD-MRIs vary with location in the brain due
to variations in image acquisition, to preprocessing and to the intrinsic intensity differences in different regions of the brain [35].
Furthermore, statistical atlases may not always be accurate due
to intersubject variability in tissue location [36]. Probabilistic
methods usually incorporate the spatial information into their
prior distribution only and do not have likelihood functions that
vary spatially in the brain. Given that intersubject registration is
not always accurate down to the voxel level, the use of voxelspecific locations for building intensity distributions, as is done
by Fischl et al. [37] for the classification of regular tissue, will
result in inaccuracies if applied to lesion classification.
There has been much less focus on the automatic classification of T1-hypointense lesions. The few methods found in
the literature that report results on T1-hypointense lesion classification use morphological operators and fuzzy connectivity
[38], region growing [39], and thresholding techniques [40].
All of these T1-hypointense lesion classification methods required some level of user intervention, resulting in subjective,
longer classification times. The few methods provided in the
literature report on only a few patients: Wu et al. [12] classify
black holes on six patient MRIs using the k-nearest neighbor
algorithm. Subbanna et al. [28] and Schmidt et al. [41] model
black holes in their classification framework but do not provide
explicit results for this type of lesion.

B. Proposed Method
In this paper, we aim to classify both T2-hyperintense and
T1-hypointense lesions in the entire brain, including the posterior fossa, and to provide experts with a confidence level in
the classification results. To this end, a probabilistic framework
for the classification of tissue and MS lesions was developed,
which takes into account both intensity and spatial information.
The proposed approach first segments the brain into regions
that share similar tissue intensity distributions. This regionbased modeling reduces the inaccuracies associated with voxelspecific distributions all while incorporating spatial information.
The likelihood distribution of multimodal MR image intensities
is then modeled using a distinct multivariate Gaussian for each
tissue class and in each of the following regions of the brain (see
Fig. 4): central brain region, frontal lobe, parietal lobe, occipital lobe, temporal lobe, and posterior fossa. The probabilistic
approach allows for spatial information to be incorporated into
a location-specific a priori distribution, modeled using a brain
atlas [42]. Finally, the incorporation of MRFs in the likelihood
and the prior serves to further disambiguate between tissue class
intensities, by taking local neighboring voxels into account. The
MRF smooths the resulting classification and removes salt and
pepper noise associated with false positives and negatives. As
in the case of other probabilistic approaches, this probabilistic
framework allows for a degree of uncertainty to be represented
along with the classification. This is used in order to provide a
confidence level for the classifier results, an approach that has
not yet been presented in previous works for MS lesion classification. This confidence level is given to the experts assessing
the classification results and can be used in order to correct only
for the false positive and false negative lesions that are classified with high uncertainty. This reduces the changes made by
the expert following automatic classification, thus resulting in a
more consistent and reproducible classification. Preliminary results using this method were previously reported in [43], though
only ten patients of the same dataset and acquired with the same
MRI scanner were tested. Unlike most previous works, we test
the method in the present work on 100 real full MS patient
brain volumes from multisite clinical trials. The aim is to show
that, unlike previous works, our method is generalizable, as it
adapts to MRIs coming from different machines and thus having different intensity characteristics. Such a general method is

HARMOUCHE et al.: PROBABILISTIC MS LESION CLASSIFICATION BASED ON MODELING REGIONAL INTENSITY VARIBAILITY

often what is needed in practical situations. In addition, we have
performed a more thorough validation, by calculating the Dice
kappa measure and voxel-based and lesion-based true positive
(sensitivity) and positive predictive rates (PPR) between our results and a silver standard lesion classification obtained from
multiple expert raters. Results show T2-hyperintense and T1hypointense lesion segmentations where such data are available
and also show segmentations in the posterior fossa, which is a
particularly difficult region to segment. The results obtained using the proposed method are compared with those obtained with
the same patient volumes using Van Leemput’s method [1]. They
are also compared with the variability between the expert raters
and with two probabilistic classification methods: one that does
not use the regional information and one that does not use MRFs.
The proposed method provides an overall statistically significant
improvement in Dice values (p < 0.01), voxel-based and lesionbased sensitivity values (p < 0.001), and PPR (p < 0.001 and
p < 0.01 respectively), over Van Leemput’s method, and over
the methods that do not include MRFs or regional information.
It also particularly succeeds at detecting smaller lesions. The
adaptability of the method, the provision of a confidence level
along with the classification, and the successful validation on
real multisite data are all of particular use when dealing with
large multisite clinical trials with lesions of varying sizes. The
method can thus be used to objectively assess disease progression in patients with MS.
II. MATERIALS AND METHODS
A. Probabilistic Approach to MS Lesion Segmentation
The goal of the proposed framework is to classify the MRI
voxels into one of the following six classes: background voxels (Bkg), gray matter (GM), white matter (WM), CSF, T1hypointense lesions (T1les), and T2-hyperintense lesions excluding T1-hypointense lesions (T2les). The lesions are separated into two distinct classes based on their appearance on MRI,
particularly on T1w-MRIs, as lesions with T2 hyperintensities
can be with or without associated T1 hypointensities. In the
present framework, the a posteriori probability density function
is generated at each voxel i, representing the probability of each
tissue class, described by the random variable Li , given the MRI
intensity vector, Ii , and the voxel location (xi , yi , zi ). This can
be described as follows:
p(Ii |Li , xi , yi , zi )p(Li |xi , yi , zi )
p(Ii |xi , yi , zi )

(1)

p(Li |Ii , xi , yi , zi ) ∝ p(Ii |Li , xi , yi , zi )p(Li |xi , yi , zi ).

(2)

p(Li |Ii , xi , yi , zi ) =
or

p(Ii |Li , xi , yi , zi ) is the likelihood of the label (tissue class)
Li at each location. To model this, one would require learning the
variation in the intensity vector Ii given Li at location (xi , yi , zi )
in the patient brain MRI. p(Li |xi , yi , zi ) is the prior probability
density function for Li at location (xi , yi , zi ). p(Ii |xi , yi , zi ) is
the probability density function of the intensity vector Ii at a
particular location. Since the likelihood term, p(Ii |xi , yi , zi )),
is independent of class, it can be disregarded when

Fig. 2.

1283

Flowchart for the training stage.

comparing between classes. In this particular application, Ii consists of T1w-MRI, T2w-MRI, PD-MRI, and FLAIR intensities,
although the formulation remains the same should other imaging
modalities be included. We adopt a supervised method for the
classification. The main drawback of supervised classification
methods is that they require a training database consisting of
prelabeled volumes. However, given a representative database,
which we have available, they provide a simple way to perform
classification leveraging previously obtained knowledge. Our
method is divided into two stages: training and classification.
During the training stage, the parameters of the likelihood function and voxel-specific prior probability distributions are learned
from training images. During the classification stage, one can
choose to label each voxel i with the tissue class li ∈ Li , which
maximizes the posterior probability density function:
li = arg max p(Li |Ii , xi , yi , zi ).

(3)

Li

Figs. 2 and 3 summarize the steps required for the training and
classification stages. We now describe our probabilistic tissue
and lesion classification scheme.
B. Training Stage
1) Modeling the Likelihood: Due to inaccuracies in intersubject registration, building local likelihood distributions at
each voxel is not feasible. We choose instead to build likelihood distributions over regions with similar tissue intensity
characteristics. The proposed approach works as follows: a patient brain MRI is segmented into the following six regions using registration-based segmentation [42]: central brain region,
frontal lobe, parietal lobe, occipital lobe, temporal lobe, and posterior fossa. A different likelihood distribution for each tissue
class is modeled in each region. As such, small misregistrations
that occur when segmenting the brain into regions would only
affect a small number of voxels and would thus have little effect
on the shape of the likelihood for each lobe. Building distributions in the different anatomical regions of the brain is based on

1284

Fig. 3.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Flowchart for the classification stage.

empirical evidence supporting the assumption that tissue intensities tend to be clustered within each region of the brain and vary
between regions. For example, the Jeffrey divergence (D(a, b))
[44] between the T2les distributions in the left frontal lobe and
the right frontal lobe is 0.12. The divergence between the left
frontal lobe and the posterior fossa, and the right frontal lobe
and the posterior fossa are 3.02 and 3.33, respectively. This is an
indication that the frontal lobe distributions are relatively similar, and those distributions differ substantially from the posterior
fossa distribution (as can be seen in Fig. 4). Given the strong
overlap between the intensity distributions of the left and right
frontal lobes, and dissimilarity between those distributions and
that of the posterior fossa, we can assume that the intensity
distributions do not vary smoothly within the brain. Modeling
the intensities on a region-by-region basis thus decreases the
overall variance in the distributions and reduces the overlap in
distributions between tissue classes.
Due to significant overlap in the different class intensity distributions within each region of the brain, the observations in
each region are better represented as multidimensional feature
vectors consisting of intensities from all available MRI modalities (i.e., T1w, T2w, PD, and FLAIR). Empirical evidence has
shown that the intensity likelihood distributions for each class
in each region are adequately modeled as multivariate Gaussians in this multidimensional space. The likelihood, therefore,
becomes
T
1
1
−1
(4)
e− 2 (I−μ) Σ (I−μ)
p(Ii |Li , Ri ) = 
k
(2π) |Σ|
where I is a 3-D or 4-D intensity vector (depending on whether
FLAIR imaging is incorporated), and Ri is the region. Likelihood model parameters (means and full covariance matrices)
for each of the tissue classes and brain regions are estimated using labeled MRI volumes from training data. The ground truth
lesion labels are obtained through manual labeling performed
by experts trained in MS lesion segmentation. This supervised
classifier requires relatively few training cases and needs only

Fig. 4. T2-les Intensity distributions for the left and right frontal lobes and
the posterior fossa. It can be seen that the left and right frontal lobe distributions
overlap significantly, and the posterior fossa distribution is dissimilar.

to be retrained if new image modalities are introduced as inputs to the classification framework, as we will show that it
can successfully classify cases obtained from multiple sites and
scanners.
2) Modeling the Prior: The prior distribution for each tissue class is modeled using a statistical atlas with tissue class
information specific to each anatomical location. The statistical atlas is built as follows: First, the labeled training images
are registered to standard stereotaxic space [45]. Probabilities1
are then estimated by counting tissue class occurrences at every
anatomical location in this standardized space and normalizing
by the total number of patients in the training database. To help
account for errors due to voxel-based registration, the atlas is
blurred with a full-width at half-maximum of 4. Several of the
lesions encountered in the training data are at typical lesion locations and thus have a higher probability. In order to avoid having
lesion probabilities of 0 at locations where there are no lesions
in the training data, those probabilities are adjusted by adding a
percentage of WM and GM probabilities to each voxel location
of the lesion maps. These percentages can be estimated based
on expert opinion of most probable lesion locations in the brain.
Evidence supports a separate classifier in the cerebrum and the
posterior fossa, as they have different intensity and tissue class
characteristics. In order to obtain patient-specific prior probabilities, the a priori atlas is registered onto patient space using the
inverse patient-to-standard-space transformation. The latter is
derived from the stereotaxic registration of the patient images to
Talairach space as described in [45]. A slice of patient-specific
customized prior probability spectral maps from the cerebrum
and the posterior fossa can be seen in Figs. 5 and 6, respectively.
3) Incorporating MRFs: As voxels in close physical proximity are more likely to come from the same tissue class, we
choose to incorporate contextual neighboring spatial information explicitly through MRFs in both the prior and likelihood
1 These

probabilities are technically frequencies.

HARMOUCHE et al.: PROBABILISTIC MS LESION CLASSIFICATION BASED ON MODELING REGIONAL INTENSITY VARIBAILITY

the energy of the likelihood as

log[p(Ii |Li , Ri )].
U (I|L, R) = −

1285

(7)

i∈S

The energy of the prior U (L|R) consists of the sum of clique potentials for all cliques (neighbor relations). A first-order neighborhood has been shown to produce effective results in MRI
classification while maintaining reasonable computation times
[47]. This allows for the use of only 1-voxel and 2-voxel clique
potentials. However, given that lesions are typically very sparse
and small when compared to surrounding tissues, 2-voxel clique
potentials might not be sufficient to fully capture their shape
characteristics. Intuitively, expert raters consider all immediate
neighbors simultaneously when manually classifying lesions.
The prior energy then becomes


V1 (Li |Ri ) +
Vc (Li , {Li }c |Ri ) (8)
U (L|R) =
i∈S

Fig. 5. Tissue brain atlas superimposed on a patient’s T1w-MRI in the cerebrum used for a priori information in the probabilistic classification is shown.
Patient-specific spectral prior probability maps display the lowest values (0.01–
0.1) in violet and the highest values (0.75–1) in red. Values between 0.1 and
0.35 are shown in blue, values between 0.35 and 0.65 are shown in green, and
values between 0.65 and 0.75 are shown in yellow. (a) Bkg. (b) CSF. (c) GM.
(d) WM. (e) T2-les. (f) T1-les.

i∈S c∈C

where C is the set of all clique sizes considered. Here, V1 is
the 1-voxel clique potential for voxel i at location (x, y, z).
Similarly, we consider V2 which is the 2-voxel clique potential
for voxel i and one of its six first-order neighbors, V5 which is
the 5-voxel clique potential for voxel i and its four first-order
neighbors in the axial plane (the voxel sampling is finer in that
plane), and V7 which is the 7-voxel clique potential for voxel i
and all its six first-order neighbors. Given the neighborhood that
we have chosen, we ignore some combinations of cliques for
the simplicity of our work. Here, we include cliques that should
be beneficial for lesion detection. In order to further reduce
the number of parameters required, an isotropic homogeneous
model is considered for cliques of order 2 and above. This is done
as lesions are mostly blobs, which implies that neighborhood
information is direction and location independent. Training of
the MRF consists of first finding the joint probabilities for all
possible combinations of voxel labels within each clique c ∈ C.
As an example, the 2-voxel clique potentials are defined in the
following way:
V2 (Li , Lj |Ri ) = −log(P (Li , Lj |Ri ))

Fig. 6. Tissue brain atlas in the posterior fossa used for a priori information
in probabilistic classification is shown, with prior probability maps displayed
in the same manner as in the cerebrum. (a) Bkg. (b) CSF. (c) GM. (d) WM. (e)
T2-les. (f) T1-les.

models. This essentially results in a smoothing of the classification in addition to taking intensity characteristics into account.
Let S be the set of sites, here all voxels i in the image, to be
labeled with one of the six possible tissue classes. We, therefore,
maximize the following probability [46]:


1
1
(5)
P (L|I, R) = exp − U (L|I, R)
Z
T
where T is the temperature and the energy of the posterior is
U (L|I, R) = U (I|L, R) + U (L|R).

(6)

The training process consists of defining the likelihood and the
prior energies, U (I|L, R) and U (L|R), respectively. We define

(9)

where the joint probabilities are calculated using the frequency
of occurrence of pairwise labels {Li , Lj } in the training set
for Ri . As joint probabilities of lesions will always be very
low, the clique potentials are calculated by normalizing these
probabilities. We now describe the classification of each voxel
in the test image.
C. Classification Stage
1) Maximizing the Posterior Probability: Finding L that
maximizes the posterior probability is intractable as it requires
a search over all possible label configurations. We maximize
the posterior probability using the Iterated Conditional Modes
(ICM) algorithm [48]. This greedy method finds a new configuration at each iteration m such that
lim +1 = argminL i U (Li |Ii , Ri )m .

(10)

ICM is chosen as it is simple and fast. However, it
tends to converge to local minima if an inappropriate initial

1286

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

configuration is used. We thus initialize the ICM classification with the maximum a posteriori (MAP) solution without
the inclusion of neighborhood information estimated using (3).
Since the MAP classification is close to the optimal solution,
the chances of arriving at an optimal solution are high [47].
2) Entropy, Posterior Probability, and Probability Ratio:
With the probabilistic approach used here, confidence in the
classification result can be defined by the posterior probability distribution over classes obtained prior to the application of
the MRF. This allows experts to assess the uncertainty in the
classification and to exclude lesion voxels classified with high
uncertainty or to include lesion voxels omitted with high uncertainty. Furthermore, Shannon’s entropy (H) [49] for the discrete
posterior distribution given location information is defined as

p(li |Ii , Ri ) log[p(li |Ii , Ri )]
H(Li |Ri ) = −
l i ∈L i

(11)
and can serve as an indicator of uncertainty over the entire posterior distribution. The higher the entropy, the wider the posterior
probability distribution and less confidence in the MAP solution. Whereas the MAP probability measures the certainty in
the current label li , the entropy provides extra information about
confidence over the entire distribution of classes Li . The probability ratio between the second most probable class l2n d and the
most probable one lm axprob is also used to indicate whether a
tissue class is competing with the most probable one. When this
ratio is high, there is high competition from another class and
thus the confidence in the classification reduced. Following the
application of the ICM algorithm, the probability distributions
before the inclusion of neighborhood information are used in
order to eliminate false positives: voxels that are classified as
lesions with a posterior probability that is lower than threshold
a, an entropy that is higher than threshold b, or a probability
ratio that is higher than threshold c are removed.
III. EXPERIMENTS, RESULTS, AND DISCUSSION
A. Experimental Setup
1) Databases: In order to show the generality of our method,
testing is performed on two datasets showing a large variability in disease stage and lesion size, position, and frequency.
This variability translates into an accompanying variability in
lesion intensity characteristics. Axial slices of 3-mm thickness
are acquired with a 1-mm2 in-plane voxel resolution. This discretization results in the presence of some partial volume effects,
specifically in the z-direction. This problem is addressed in the
MRF clique potentials, which are isotropic in the axial plane
but differ in the z-direction. Partial volume voxels misclassified as lesions will also be removed by thresholding based on
uncertainty. The databases are now described.
a) Database 2: This is a multisite multiscanner database
that has 90 patients with relapsing remitting MS. The cases are
separated randomly for threefold analysis. The volumes come
from 34 different scanners at a field strength of 1.5 T except for
three volumes that have been acquired using 3-T scanners. The

lesion volume for these 90 patients varies from 0.02 to 19 cc. For
each fold, 60 volumes are used for training and 30 are used for
testing. The number of training cases is small when compared to
the size of a dataset in the context of a clinical trial. The volumes
are available in T1, T2, PD, and FLAIR modalities. Since it is
a multiscanner database, the volumes show a wide disparity in
intensities of the various tissue classes, making it challenging
for intensity based classifiers. Testing on this database shows the
method’s ability to deal with new datasets, as the main difference
between datasets is the variability in acquisition parameters.
b) Database 2: Database 2 is a set of ten MS patients with
expanded disability status scale (EDSS) scores ranging from 0
to 9.5, and lesion volumes ranging from 1.1 to 62.0 cc. MR
images are acquired using a 1.5-T Philips Gyroscan ACS II
(Philips Medical Systems, Best, The Netherlands). An important reason for testing on this database is that we have expert
classifications for both T1-hypointense and T2-hyperintense lesions. PD-MRIs, T2w-MRIs, and T1w-MRIs are used. Training
data consist of 37 patients, both men and women, with a variety
of age and EDSS scores. In order to speed up the manual classification, the protocol involved having experts manually correct
the classification results of an automated classification system.2
2) Methods: Lesion labels classified by the proposed
method are compared with a silver standard derived from
manual labels produced by experts. For database 1, only T2hyperintense lesions are labeled by a single expert in the cerebrum and the posterior fossa. For this reason, validation is only
performed on T2-hyperintense lesions. In this database, 15 patients have posterior fossa lesions and results specific to this
region are reported. For database 2, both T2-hyperintense and
T1-hypointense lesions are manually classified by five expert
raters in the cerebrum. Any voxel that is labeled as a lesion by
the majority of the raters is assigned as a lesion in the silver
standard. We thus tested the T1-hypointense lesion segmentation on database 1 all while showing that good results can also
be obtained for T2-hyperintense lesion segmentations.
Results from the proposed method for both datasets are compared to the method proposed by Van Leemput et al. [1], which
models lesions as outliers to normal tissue distributions. We
used the MATLAB implementation that Van Leemput has made
available [50]. In order to test the advantage of the incorporation
of MRFs, we compare our results to ones obtained by excluding
the MRF (no-MRF). Also, in order to verify the advantage of
the regional intensity characterization, we compare our method
with an identical one without region-specific distributions (nonregional).
3) Metrics: Variability of the labeling by expert raters is
compared to the variability between the automatic methods
and the silver standard by means of lesion volume and spatial overlap. The latter is assessed on the basis of a modified
Kappa statistic (originally suggested by Dice [51]) as a spatial
similarity measure
Kappa = 2(A ∩ B)/(A + B)

(12)

2 The particular classifier used here was a k-means clustering tissue classifier
[29] that models each tissue class using Gaussian distributions.

HARMOUCHE et al.: PROBABILISTIC MS LESION CLASSIFICATION BASED ON MODELING REGIONAL INTENSITY VARIBAILITY

1287

where A is the expert labeling and B is the automatic labeling. A value of zero indicates no agreement (i.e., no overlap)
and a value of one indicates perfect agreement. Note that the
Dice Kappa is sensitive to the surface to volume ratio. Small
blobs, which have a higher surface-to-volume ratio than bigger
ones, typical to the case of lesions, result in lower Dice Kappa
values. For database 2 where multiple expert segmentations are
provided, the quality of expert labels is calculated in two ways.
The first is the average inter-rater Kappa over pairs (IRKOP) of
expert raters, which measures the degree to which raters agree
with each other. The second is the silver standard Kappa (SSK)
which measures the agreement between the manual raters and
the resulting silver standard. It essentially depicts the average
confidence with which raters choose the lesion label. Finally,
monitoring the lesion count is an important measure of disease
progression. Thus, voxel-based and lesion-based sensitivity and
PPR are computed in order to verify the method’s ability to detect lesions as entities without the influence of subjective lesion
border issues. Sensitivity and PPR values are defined as
Sensitivity = TP/(TP + FN)
PPR = TP/(TP + FP)

(13)

where TP are the true positives, FP are the false positives, and FN
are the false negatives. Results are also provided for lesions of
different sizes separately and using different lesion definitions.
In order to establish statistical significance when comparing the
methods using different metrics, two-tailed paired t-tests are
performed, with statistical significance if p < 0.05.
B. Implementation Details
Prior to training and classification, the MRI volumes undergo
preprocessing, which includes bias field correction using N3
[52], intrasubject registration of the multimodal volumes [45],
extraction of brain parenchyma [53], and intensity range normalization [54]. A piecewise linear normalization is performed.
This renders the volumes comparable to the training model in
both intensity and anatomy in a common patient space. For the
particular experiments performed in this paper, the prior probabilities were adjusted using the following formula: 2% of the
WM probability and 0.2% of the GM probability are added to
the lesion prior probabilities in the cerebrum, and 7% of the
WM prior probability and 0.7 % of the GM prior probability are
added to the lesion prior probabilities in the posterior fossa. The
results are robust against small perturbations in these percentages, but significant changes would affect classification results.
Following classification with the ICM, voxels that were initially
classified as lesions with less than a 0.5 posterior probability,
an entropy above 0.5, and a probability ratio between the most
probable and second most probable class lower than 0.4 are discarded. These values are obtained empirically from results with
a test case. Classification results are not sensitive to changes
in these values. The algorithm was implemented in C with a
processing time of approximately 2 min per subject using a Dell
Optiplex 980 quad-core machine. There is no significant difference in the running time with the incorporation of region-based
likelihoods and MRFs.

Fig. 7. Classification results in the cerebrum are shown for case 5 from
Database 1 along with the MR images. Entropy and posterior spectral maps
display the lowest values (0.01–0.1) in violet and highest values (0.75–1) in
red. Values between 0.1 and 0.35 are in blue, values between 0.35 and 0.65 are
in green, and values between 0.65 and 0.75 are in yellow. The classified labels
are Bkg (dark blue), CSF (light blue), GM (green), WM (yellow), T2les (red),
and T1les (white). The extracted lesions are shown in green. (a) T1w-MRI. (b)
T2w-MRI. (c) PD-MRI. (d) Regions. (e) MAP probability. (f) Entropy. (g) Classifier. (h) T2-hyperintense lesions classified. (i) T2-hyperintense lesions SS. (j)
T1-hypointense lesions classified. (k) T1-hypointense lesions SS.

C. Qualitative Results
Examples of classifications in the cerebrum (see Fig. 7) and
the posterior fossa (see Fig. 8) of a patient volume from Database
1 are shown. The brain is first separated into the six proposed
regions [see Figs. 7(d) and 8(d)]. MAP probability values for the
class that maximizes the MAP at each voxel and entropy values
(before application of the MRF algorithm) are shown in Fig. 7(e)
and (f) for the cerebrum and in Fig. 8(e) and (f) for the posterior
fossa, and classification of all tissues using the proposed method
are shown in Figs. 7(g) and 8(g). Entropy values for lesions are
generally higher than those of other tissues, due, in part to,
lesion prior probabilities being generally lower than those of

1288

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

pared to one false positive in our case. Fig. 9 also shows that,
although the no-MRF classifier is as able to detect small lesions,
this classifier results in many small false positives (salt and pepper noise), which our classifier is able to eliminate following the
application of the MRF.
D. Quantitative Results

Fig. 8. Classification results in the posterior fossa. The labels have the same
color coding as in the cerebrum (see Fig. 7). (a) T1w-MRI. (b) T2w-MRI.
(c) PD-MRI. (d) Regions. (e) MAP probability. (f) Entropy. (g) Classifier.
(h) T2-hyperintense lesions classified. (i) T2-hyperintense lesions SS. (j) T1hypointense lesions classified. (k) T1-hypointense lesions SS.

other tissues. The T2-hyperintense [see Figs. 7(h) and 8(h)] and
T1-hypointense lesions [see Figs. 7(j) and 8(j)] are then shown
and compared with the T2-hyperintense [see Figs. 7(i) and 8(i)]
and T1-hypointense [see Figs. 7(k) and 8(k)] silver standard
labels (SS). All silver standard lesions are successfully detected
by the proposed method. Building region-specific likelihood
distributions leads to the successful classification of the lesion
appearing in the posterior fossa. The MRF removed salt and
pepper noise, in addition to strengthening the cohesiveness of
the tissue classes. However, a few false positives in areas of
so-called dirty white matter can be seen in the posterior region
of the centrum semioval, just above the lateral ventricles. Areas
of false positives are pointed to by an arrow in Fig. 7(h). The
T2les posterior probability of a voxel in this area is 0.8, and the
entropy is moderate with a value of 0.35, indicating certainty
in the false positive. This area is classified as lesion since it
is in a higher a priori probability lesion area, as lesions are
often present in the periventricular area [see Fig. 5(e) and (f)].
Also, even though these false positives are not classified as
lesions by the silver standard, they lie in hyperintense T2wMRI and PD-MRI regions and are, in fact, abnormal. Clinicians
can thus potentially relate the confidence level with the severity
of pathology in this area.
Fig. 9 compares qualitative results from the different classification methods. We can see that seven lesions are missed by Van
Leemput’s method (most of which are small lesions) compared
to two lesions in the case of our proposed method, and Van
Leemput’s method results in two false positives lesions com-

1) Dice Kappa Analysis: We compare T2-hyperintense lesion classifications obtained using our proposed method with
Van Leemput’s method, and with the nonregional classifier
and the classifier without MRFs for database 1. Fig. 10 shows
the means and standard deviations for all 90 patient results
and demonstrates the statistically significant improvement (p <
0.01) in the average Kappa values when our method is used
compared to Van Leemput’s method, and to the no-MRF and
nonregional methods. Note that for small lesions that are a few
voxels in diameter, the kappa value drops quickly when there
is only a one or two voxel error on the edge of a lesion. For
all patients, Kappa values obtained using our proposed method
(average Kappa of 0.56) are either equivalent or superior to Van
Leemput’s method (average Kappa of 0.50), to the nonregional
method (average Kappa of 0.43), and to the no-MRF method
(average Kappa of 0.38). A statistically significant improvement (p < 0.01) is particularly noticeable in the posterior fossa
(see Fig. 11), where average Kappa values of 0.37 are obtained
when our method is used and 0.22 when Van Leemput’s method
is used. This also shows the importance of modeling tissue intensities on a regional basis especially in the posterior fossa,
where the distributions are particularly different from the rest of
the brain.
2) Sensitivity and PPR: In this section, we demonstrate sensitivity and PPR obtained with our proposed method compared
with those obtained using Van Leemput’s method, the nonregional, and the no-MRF methods for the database 1. Sensitivity
and PPR values are computed both for lesions and voxels. For the
lesion-based rates, lesion localizations using automatic methods
are compared to the expert localisations, where a lesion is said
to be detected if at least 50% of the voxels in it are detected
by the algorithm. In order to verify the effect of lesion size
and definition on the quality of the detection, results are also
shown on lesion definitions of 1 voxel and 3 voxels, and results
for different lesion sizes are reported.
T2-hyperintense voxel-based and lesion-based sensitivity
mean and standard deviation plots in the entire brain for all
90 patients of database 1 are shown in Fig. 12. Average voxelbased and lesion-based sensitivity values are 0.729 and 0.699
in the Van Leemput case, whereas they are 0.784 and 0.777 for
our method. Our method provides better results in both cases
(p < 0.001), with a slightly bigger improvement in the lesionbased case. Our method also provides an improvement in lesionbased and voxel-based sensitivity values over the nonregional
and no-MRF methods, except for the lesion-based no-MRF case.
The no-MRF has better results in that case because some the
smallest lesions are lost (smoothed out) when the MRF is applied. However, fewer voxels are caught in that case compared to
the proposed method, and a lot more false positives are present.

HARMOUCHE et al.: PROBABILISTIC MS LESION CLASSIFICATION BASED ON MODELING REGIONAL INTENSITY VARIBAILITY

1289

Fig. 9. Example of lesion classifications for the different methods compared and expert agreement. False negatives are labeled in green and false positives are
labeled in blue. (a) Proposed method. (b) Van Leemput’s method. (c) Nonregion. (d) No-MRF. (e) Expert labels.

Fig. 10. T2-hyperintense lesion Kappa mean and standard deviation plot for
different classification methods for all 90 patients of Database 1 in the entire
brain (Cerebrum and posterior fossa).

Fig. 12. Mean and standard deviation plots for voxel-based and lesion-based
T2-hyperintense lesion sensitivity values in the entire brain for Database 1. (a)
Voxel-based. (b) Lesion-based.

Fig. 11. T2-hyperintense lesion Kappa values using the proposed method and
Leemput’s method for Database 1 in the posterior fossa. Only 15 of the first
30 patients have posterior fossa lesions. Cases 1, 7, 12, 13 and 15 have Kappa
values close to 0 for Leemput’s method.

Similarly, voxel-based and lesion-based PPR mean and standard deviation plots for all 90 patients are shown in Fig. 13. Our
method provides a statistically significant improvement over
Van Leemput’s method in both cases. Average voxel-based and
lesion-based PPR values are 0.399 and 0.605 in the Van Leemput case, whereas they are 0.455 and 0.629 for our method (p <
0.001 and p < 0.01, respectively). Our method also provides an
improvement in lesion-based and voxel-based PPR values.
Lesion-based sensitivity and PPR values for different lesions
of different voxel size are presented in Fig. 14. Results using the
proposed method and Van Leemput’s method are compared with
detected lesions defined as having either a minimum of 1 voxel

detected, 3 voxels detected, or 50% detected. The results show
that although sensitivity and PPR values do not show a marked
improvement with larger lesions (20+ voxels), a much more statistically significant improvement is marked when our method
is compared to that of Van Leemput when smaller lesions are
considered (3–5 voxels). This is particularly true for the sensitivity values, which demonstrates the ability of our method to
detect smaller lesions that intensity-based methods tend to miss
due to their particularly low contrast. This was demonstrated in
Fig. 9, where lesions were missed by the Van Leemput method
but detected by our method. Finally, our method outperforms
the nonregional method in both sensitivity and positive predictive value (PPV), due to the more precise class modeling that
we benefit from.
During the MS segmentation challenge held at a MICCAI
workshop in 2008, the winner reported voxel sensitivity and
PPR values of 0.1975 and 0.3, respectively. Geremia et al. used
the same data and reported voxel sensitivity and PPV values

1290

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Fig. 15. T2-hyperintense lesion Kappa values in the entire brain for all cases
using expert raters and different classification methods for Database 2.

Fig. 13. Mean and standard deviation plots for voxel-based and lesion-based
T2-hyperintense lesion PPR values in the entire brain for Database 1. (a) Voxelbased. (b) Lesion-based.

Fig. 16. T1-hypointense lesion Kappa values for expert raters and different
classification methods in the cerebrum for Database 2.

Fig. 14. Lesion based Sensitivity versus PPR values for Database 1 for different lesions of different voxel sizes. Results using the proposed method and Van
Leemput’s method are compared with detected lesions defined as having either
a minimum of 1 voxel detected, 3 voxels detected, or 50% detected.

of 0.3985 and 0.4035, respectively. We are fortunate enough to
have a large dataset of trained expert raters as part of a large
multisite clinical trial and have thus decided to use it instead of
the segmentation challenge data.
3) Database 2 Results: Fig. 15 compares T2-hyperintense
lesion Dice Kappa values in the cerebrum for the proposed
method, the nonregional classifier, and Van Leemput’s method.

IRKOP and SSK values are also shown. SSK values are higher
than other values, as they provide an upper-bound on Kappa
results. Cases 4 and 9 show the lowest Kappa values, which
can be partially attributed to their low lesion volume.
For all T2-hyperintense lesion cases, the proposed classifier
(with a mean Kappa of 0.62) tends to outperform the classifier without regional information (with a mean Kappa of 0.48),
with statistical significance (p < 0.01). Similar improvements
are observed when our method is compared to the no-MRF
method. Finally, our proposed method outperforms Van Leemput’s method (mean Kappa of 0.51) for all cases in Database 1
except for case 8.
Fig. 16 shows results for T1-hypointense lesions for Database
2. The values are generally lower than in the case of
T2-hyperintense lesions. This is due to the fact that T1hypointense lesions have a smaller volume and thus a higher
surface-to-volume ratio, which in turn has a negative effect on
Kappa values. As an example, two small synthetic lesions were
compared to a big one with a lesion volume of 0.175 cm3 , which
is equal to the sum of the two smaller ones. For such a case, a 3voxel translation between the silver standard and two classified
lesions results in a Kappa value of 0.607, as opposed to a value
of 0.705 for the one lesion case. Nonetheless, T1-hypointense
Kappa values have also exhibited a statistically significant improvement upon the incorporation of spatial information.
T2-hyperintense lesion Kappa values are comparable to previously reported results obtained using T1w-MRI, T2w-MRI,
and PD-MRI sequences. Studies [11], [26], [30], [55] all report
Kappa values that are close to or considerably lower than 0.6.

HARMOUCHE et al.: PROBABILISTIC MS LESION CLASSIFICATION BASED ON MODELING REGIONAL INTENSITY VARIBAILITY

However, these Kappa values are generated using either only a
few selected slices or using only silver standard lesion voxels, or
generate their silver standard using intensity thresholding which
biases the results. Van Leemput et al. [1] performed a thorough
validation on ten patients and 20 MRI volumes, with an average Kappa value of 0.45. In fact, outlier-based methods such
as Van Leemput’s tend to miss lesions, as their main focus is
the removal of false positives. The work by Schmidt et al. [41]
is the only work in the literature that provides results for the
posterior fossa, with reported Kappa values of 0.94. In order
to compare their results to ours, we used their proposed method
on our first database in the posterior fossa. We obtained an average Kappa value of 0.32 and lesion-based sensitivity and PPV
values of 0.39 and 0.54, respectively. These values are significantly lower than those obtained using our proposed method.
When omitting FLAIR data using our method, a performance
decrease of 30–35% and 10–15% is observed when dealing with
lesions that are 3–5 voxels and 5–20 voxels in size, respectively.
This is because small lesions are much less visible on the other
modalities. When comparing the two databases we used during our validation, we can see a bigger improvement using our
method for the first database. This shows that our method can
particularly deal with the larger range of tissue intensity characteristics that occur with a multisite database. Finally, none of
the methods mentioned above provide a level of uncertainty in
the classification.
IV. CONCLUSION
An automatic method for classifying tissues, including T1hypointense and T2-hyperintense MS lesions, was presented.
The method separates the brain into regions with similar tissue
intensity characteristics and finds the posterior probability distributions given region-based tissue class likelihoods and voxelbased a priori information. The MAP classification is refined
using MRFs classification, which takes neighborhood information into account. The posterior probability distribution and the
entropy are also used to eliminate false positives in the classification. The proposed approach leads to a fully automated
lesion classification method that performs similarly to experts
for both T1-hypointense lesions and T2-hyperintense, with the
advantage of providing better reproducibility. The modeling of
likelihood distributions on a region-by-region basis also allows
for a more accurate classification of MS lesions in the posterior
fossa, as the quantitative results show significant improvement
upon the inclusion of regional intensity information. The MAP
probability and entropy can serve as indicators of confidence in
the classifier’s result. These confidence maps have the potential
of providing a more objective measure of uncertainty in areas
where experts disagree on the classification results. Validation
was performed on a large cohort of multisite clinical data and the
method was compared to that proposed by Van Leemput et al.
using the Dice kappa measure and lesion-based and voxel-based
sensitivity and PPR. Results demonstrate that our method is particularly successful at detecting smaller lesions, in addition to
lesions in the posterior fossa. In future work, we aim to explore
more sophisticated MRF models, which would be required in

1291

order to improve the segmentation in the posterior fossa. Also,
the confidence measures derived with the help of the probabilistic approach could be further studied in order to assess the
level of disease burden, as opposed to simply using the binary
classification results, as is presently done. This will result in a
more precise analysis of disease evolution in patients, all while
maintaining the reproducibility of the automated method, which
is essential for better understanding the progression of MS.
ACKNOWLEDGMENT
The authors gratefully acknowledge J. Maranzano (NeuroRX Research) for expert segmentation and review of new MS
lesions.
REFERENCES
[1] K. Van Leemput et al., “Automated segmentation of multiple sclerosis
lesions by model outlier detection,” IEEE Trans. Med. Imag., vol. 20,
no. 8, pp. 677–688, Aug. 2001.
[2] D. Miller et al., “Guidelines for the use of magnetic resonance techniques
in monitoring the treatment of multiple sclerosis,” Ann. Neurol., vol. 39,
no. 1, pp. 6–16, 1996.
[3] D. Garcia-Lorenzo et al., “Review of automatic segmentation methods
of multiple sclerosis white matter lesions on conventional magnetic resonance imaging,” Med. Image Anal., vol. 17, pp. 1–18, Jan. 2013.
[4] O. Freifeld et al., “MS lesion detection using constrained GMM and curve
evolution,” Int. J. Biomed. Imag., 2009.
[5] Y. Wolff et al., “Improved CSF classification and lesion detection in MR
brain images with multiple sclerosis,” Proc. SPIE, vol. 6512, p. 65122P,
2007.
[6] N. Shiee et al., “A topology-preserving approach to the segmentation
of brain images with multiple sclerosis lesions,” Neuroimage, vol. 49,
pp. 1524–1535, 2010.
[7] F. Admasu et al., “Segmentation of multiple sclerosis lesions from
MR brain images using the principles of fuzzy-connectedness and artificial neuron networks,” in Proc. Int. Conf. Image Process., 2003,
pp. 1081–1084.
[8] A. Hadjiprocopis and P. S. Tofts, “Towards an automatic lesion segmentation method for dual echo magnetic resonance images using an ensemble
of neural networks.” in Proc. 14th Italian Workshop Neural Nets, 2003,
pp. 148–157.
[9] A. Cerasa et al., “A cellular neural network methodology for the automated
segmentation of multiple sclerosis lesions,” J. Neurosci. Methods, vol. 203,
no. 1, pp. 193–199, 2012.
[10] B. R. Sajja et al., “A unified approach for lesion segmentation on MRI of
multiple sclerosis,” in Proc. 26th Annu. Intl. Conf. IEEE Eng. Med. Biol.
Soc., 2004, pp. 1778–1781.
[11] P. Anbeek et al., “Automated MS lesion segmentation using k-nearest
neighbour classification,” in Proc. MICCAI Workshop MS Lesion Segmentation, 2008.
[12] Y. Wu et al., “Automated segmentation of multiple sclerosis subtypes with
multichannel MRI,” Neuroimage, vol. 32, pp. 1205–1215, 2006.
[13] S. Bricq et al., “MS lesion segmentation based on hidden Markov
chains,” in Proc. 11th Med. Image Comput. Comput. Aided Intervention,
2008.
[14] B. R. Sajja et al., “Unified approach for multiple sclerosis lesion segmentation on brain MRI,” Ann. Biomed. Eng., vol. 34, no. 1, pp. 142–151,
2006.
[15] L. Ait-ali et al., “STREM: A robust multidimensional parametric method
to segment MS lesions in MRI,” in Proc. 8th Med. Image Comput.
Comput.-Assisted Intervention, Oct. 2005, pp. 409–416.
[16] E. A. Ashton et al., “Accuracy and reproducibility of manual and semiautomated quantification of MS lesions by MRI,” J. Magn. Reson. Imag.,
vol. 17, no. 3, pp. 300–308, 2003.
[17] A. Bijar et al., “Segmentation of MS lesions using entropy-based EM
algorithm and Markov random fields,” J. Biomed. Sci. Eng., vol. 4, no. 8,
pp. 552–561, 2011.
[18] X. Descombes et al., “An object-based approach for detecting small brain
lesions: Application to virchow-robin spaces,” IEEE Trans. Med. Imag.,
vol. 23, no. 2, pp. 246–255, Feb. 2004.

1292

[19] G. Dugas-Phocion et al., “Hierarchical segmentation of multiple sclerosis lesions in multi-sequence MRI,” in Proc. IEEE Int. Symp. Biomed.
Imaging: Nano to Macro, 2004, pp. 157–160.
[20] F. Forbes et al., “Adaptive weighted fusion of multiple MR sequences for
brain lesion segmentation,” in Proc. IEEE Int. Symp. Biomed. Imaging:
Nano to Macro, 2010, pp. 69–72.
[21] D. Garcia-Lorenzo et al., “Combining robust expectation maximization
and mean shift algorithms for multiple sclerosis brain segmentation,” in
Proc. MICCAI Workshop Med. Image Anal. Multiple Sclerosis, 2008.
[22] D. Garcı́a-Lorenzo et al., “Trimmed-likelihood estimation for focal lesions
and tissue segmentation in multisequence MRI for multiple sclerosis,”
IEEE Trans. Med. Imag., vol. 30, no. 8, pp. 1455–1467, Aug. 2011.
[23] E. Geremia et al., “Spatial decision forests for MS segmentation in multichannel MR images,” in Proc. 13th Int. Conf. Med. Image Comput. Comput. Aided Intervention, 2010, pp. 111–118.
[24] H. Greenspan et al., “Constrained Gaussian mixture model framework for
automatic segmentation of MR brain images,” IEEE Trans. Med. Imag.,
vol. 25, no. 9, pp. 1233–1245, Sep. 2006.
[25] R. Khayati et al., “Fully automatic segmentation of multiple sclerosis
lesions in brain MR FLAIR images using adaptive mixtures method and
Markov random field model,” Comput. Biol. Med., vol. 38, pp. 379–390,
2008.
[26] D. Kroon et al., “Multiple sclerosis detection in multispectral magnetic
resonance images with principal components analysis,” in Proc. 3D Segmentation Clinic: A Grand Challenge II: MS lesion segmentation, Sep.
2008.
[27] J. Souplet et al., “An automatic segmentation of T2-FLAIR multiple sclerosis lesions,” in Proc. Midas J., IJ-2008 MICCAI Workshop, MS Lesion
Segmentation, 2008.
[28] N. K. Subbanna et al., “MS lesion segmentation using Markov random
fields,” in Proc. MICCAI Workshop Med. Image Anal. Multiple Sclerosis,
2008.
[29] S. Francis, “Automatic lesion identification in MRI of multiple sclerosis
patients,” Master’s thesis, McGill Univ., Montreal, QC, Canada, 2004.
[30] D. Goldberg-Zimring et al., “Assessment of multiple sclerosis lesions with
spherical harmonics: comparison of MR imaging and pathologic findings,”
Radiology, vol. 235, no. 3, pp. 1036–1044, Apr. 2005.
[31] F. Yang et al., “White matter lesion segmentation from volumetric MR
images,” in Proc. Int. Workshop Med. Imaging Augmented Reality, 2004,
pp. 113–120.
[32] D. Garcia-Lorenzo et al., “Multiple sclerosis lesion segmentation using
automatic multimodal graph cuts,” in Proc. Med. Image Comput. Comput.
Aided Intervention, 2009, pp. 584–591.
[33] J. Lecoeur et al., “Multiple sclerosis lesions segmentation using spectral gradient and graph cuts,” in Proc. MICCAI Workshop Med. Image
Anal. Multiple Sclerosis (Validation and Methodological Issues), 2008,
pp. 92–103.
[34] A. Younis et al., “MS lesions detection in MRI using grouping artificial
immune networks,” in Proc. 7th IEEE Conf. Bioinform. Bioeng., 2007,
pp. 1139–1146.
[35] R. Harmouche, “Bayesian MS lesion classification modelling using regional and local spatial information,” Master’s thesis, McGill Univ., Montreal, QC, Canada, 2006.
[36] R. Cardenes et al., “An efficient algorithm for multiple sclerosis lesion
segmentation from brain MRI,” in Proc. Int. Workshop Comput. Aided
Syst. Theory, 2003, pp. 542–552.
[37] B. Fischl et al., “Whole brain segmentation: Automated labeling of neuroanatomical structures in the human brain,” Neuron, vol. 33, no. 3,
pp. 341–355, 2002.
[38] S. Datta et al., “Segmentation and quantification of black holes in multiple
sclerosis,” NeuroImage, vol. 29, no. 2, pp. 467–474, 2006.
[39] H.-P. Adams et al., “Hypointense and hyperintense lesions on magnetic
resonance imaging in secondary-progressive MS patients,” Eur. Neurol.,
vol. 41, no. 1, pp. 52–63, 1999.
[40] P. Molyneux et al., “The precision of T1 hypointense lesion volume quantification in multiple sclerosis treatment trials: A multicenter study.” Multiple Sclerosis, vol. 6, no. 4, pp. 237–240, 2000.
[41] P. Schmidt et al., “An automated tool for detection of flair-hyperintense
white-matter lesions in multiple sclerosis.” NeuroImage, vol. 59, no. 4,
pp. 3774–3783, 2012.
[42] D. L. Collins et al., “Automatic 3D model-based neuroanatomical segmentation,” Human Brain Mapp., vol. 3, no. 3, pp. 190–208, 1995.
[43] R. Harmouche et al., “Bayesian MS lesion classification modeling regional
and local spatial information,” in Proc. Int. Conf. Pattern Recog., 2006,
pp. 984–987.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

[44] J. Puzicha et al., “Non-parametric similarity measures for unsupervised
texture segmentation and image retrieval,” in Proc. IEEE Comput. Soc.
Conf. Comput. Vision Pattern Recog., 1997, pp. 267–272.
[45] D. Collins et al., “Automatic 3D intersubject registration of MR volumetric
data in standardized Talairach space.” J. Comput Assisted Tomography,
vol. 18, pp. 192–205., 1994.
[46] S. Z. Li, Markov Random Field Modeling in Image Analysis. Secaucus,
NJ, USA: Springer-Verlag, 2001.
[47] K. Held et al., “Markov random field segmentation of brain MR images,”
IEEE Trans. Med. Imag., vol. 16, no. 6, pp. 878–886, Dec. 1997.
[48] J. Besag, “The statistical analysis of dirty pictures,” J. Royal Statist. Soc.
Ser. B, vol. 48, no. 1, pp. 259–302, 1986.
[49] C. Shannon, “A mathematical theory of communication,” Bell Syst. Tech.
J., vol. 27, no. 4, pp. 379-423–623-656, 1948.
[50] K. V. Leemput. (1999). PVEM applet. [Online]. Available:
http://nmr.mgh.harvard.edu/ koen/PVEM.html
[51] L. R. Dice, “Measures of the amount of ecologic association between
species,” Ecology, vol. 26, no. 3, pp. 1037–1044, 1945.
[52] J. Sled and G. Pike, “Correction for B(1) and B(0) variations in quantitative T(2) measurements using MRI,” Magn. Reson. Med., vol. 43, no. 4,
pp. 589–593, 2000.
[53] S. Smith, “Fast robust automated brain extraction,” Hum. Brain Mapp.,
vol. 17, no. 3, pp. 143–155, 2002.
[54] L. G. Nyl and J. K. Udupa, “On standardizing the MR image intensity
scale,” Radiology, pp. 581–582, 1998.
[55] A. P. Zijdenbos et al., “Automatic pipeline analysis of 3-D MRI data for
clinical trials: Application to multiple sclerosis,” IEEE Trans. Med. Imag.,
vol. 21, no. 10, pp. 1280–1291, Oct. 2002.
Rola Harmouche received the B. Eng. and M.Eng. degrees from McGill University, Montreal, QC, Canada, and the Ph.D. from Ecole Polytechnique in
Montreal, Montreal.
She is currently a Postdoctoral Fellow at the Brigham and Women’s Hospital
and the Harvard Medical School, Boston, MA, USA. She currently focuses on
image analysis techniques of CT for the characterization of chronic obstructive
pulmonary disease.
Nagesh K. Subbanna received the B.Eng. degree in computer science from
Bangalore University, Bengaluru, India, in 2001, and the M.Sc. degree from the
Technion—Israel Institute of Technology, Haifa, Israel, in 2006. He is currently
working toward the Ph.D. degree at McGill University, Montreal, QC, Canada,
focusing on context segmentation of brain pathology.
His research interests include biomedical image analysis, bioinformatics,
and time frequency analysis.
D. Louis Collins received Ph.D. degree in biomedical engineering from the
Department of Biomedical Engineering and Montréal Neurological Institute
McGill University Montréal, QC, Canada, in 1994 respectively.
He is a Scientist in the McConnell Brain Imaging Centre of the Montreal Neurological Institute and a Professor in Neurology & Neurosurgery and
Biomedical Engineering, McGill University, Associate member of the McGill
Centre for Studies in Aging, Associate member of the Centre for Intelligent Machines at McGill and Graduate Program Director in the Department of Biomedical Engineering, McGill University. He conducted is postdoctoral research at
the Université de Rennes, France, in the Laboratoire Signaux et Images en
Médecine. His research interests included automated anatomical segmentation
and atlasing in a neuroanatomical context for the analysis of normal aging (from
childhood to old age), the effect of neurological diseases on the brain, as well
as modelling and visualization for planning and guidance of neurosurgery.
Douglas L. Arnold received M.D. degree from Montreal Neurological Hospital and Institute, Montreal, QC, Canada, he is currently a Professor at the
Department of Neurology and Neurosurgery, McGill University, Montreal, QC,
Canada, and the President of NeuroRx Research, a CNS imaging CRO. He has
special expertise in advanced MRI acquisition and analysis techniques, particularly as they relate to understanding the evolution of multiple sclerosis and
neurodegeneration.
Tal Arbel (M’04) received Ph.D. degree in History of Science from Harvard
University, MA, USA, in 2000, she is an Associate Professor at the Department of Electrical and Computer Engineering, McGill University, Montreal,
QC, Canada, and a Member of the Centre for Intelligent Machines. She has
expertise in the development of probabilistic methods in computer vision and
medical image analysis, particularly for segmentation, registration, detection,
and classification.

