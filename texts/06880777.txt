296

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Reconstruction of Instantaneous Phase of Unipolar
Atrial Contact Electrogram Using a Concept
of Sinusoidal Recomposition
and Hilbert Transform
Pawel Kuklik∗ , Stef Zeemering, Bart Maesen, Jos Maessen, Harry J. Crijns, Sander Verheule,
Anand N. Ganesan, and Ulrich Schotten

Abstract—The Hilbert transform has been used to characterize wave propagation and detect phase singularities during cardiac fibrillation. Two mapping modalities have been used: optical
mapping (used to map atria and ventricles) and contact electrode
mapping (used only to map ventricles). Due to specific morphology of atrial electrograms, phase reconstruction of contact electrograms in the atria is challenging and has not been investigated in
detail. Here, we explore the properties of Hilbert transform applied to unipolar epicardial electrograms and devise a method for
robust phase reconstruction using the Hilbert transform. We applied the Hilbert transform to idealized unipolar signals obtained
from analytical approach and to electrograms recorded in humans.
We investigated effects of deflection morphology on instantaneous
phase. Application of the Hilbert transform to unipolar electrograms demonstrated sensitivity of reconstructed phase to the type
of deflection morphology (uni- or biphasic), the ratio of R and
S waves and presence of the noise. In order to perform a robust
phase reconstruction, we propose a signal transformation based
on the recomposition of the electrogram from sinusoidal wavelets
with amplitudes proportional to the negative slope of the electrogram. Application of the sinusoidal recomposition transformation
prior to application of the Hilbert transform alleviates the effect of
confounding features on reconstructed phase.

I. INTRODUCTION

ARDIAC fibrillation is a complex phenomenon requiring
sophisticated approaches to characterize wave propagation dynamics. One of the suggested approaches is reconstruction of the instantaneous phase of local electrical activity introduced by Winfree [1]. Instantaneous phase denotes at which
point of the local cycle a given oscillatory process is. The spatial distribution of the phase across the mapped field provides
insight into wave propagation dynamics and enables localization of phase singularities corresponding with the tips of the
functional reentry waves (so-called “rotors”). For review of the
concept of phase in cardiac electrophysiology, see a paper by
Umapathy et al. [2].
Phase reconstruction has been introduced as a technique to
understand complex spatiotemporal dynamics of cardiac fibrillation in experimental models and humans. Phase reconstruction has been first applied to transmembrane signals using both temporal encoding [3] and state space encoding using
time-delay embedding [4] followed by applications to contact
Index Terms—Biomedical signal processing, cardiology, fibrilla- electrograms [2]–[5]. More recently, phase analysis based on
Hilbert transform has been introduced to calculate instantation, phase estimation.
neous phase and to facilitate mapping of cardiac fibrillation
in humans [5]–[8]. However, to our knowledge, with an excepManuscript received February 20, 2014; accepted August 3, 2014. Date of tion of a study by Shors et al. [7], all studies focus on analysis
publication August 20, 2014; date of current version December 18, 2014. This of ventricular signals leaving application of Hilbert transform
work was funded by the European Network for Translational Research in AF to atrial electrograms unaddressed. Application of the Hilbert
(FP7 collaborative project EUTRAF, No. 261057), and CTMM COHFAR. Astransform to ventricular unipolar electrograms during ventricterisk indicates corresponding author.
∗ P. Kuklik is with the of Physiology, Maastricht University Medical Cenular tachycardia has been successful because of the sinusoidal
ter, Maastricht 6211 LK, The Netherlands, and also with University Heart
morphology of the signal (lack of significant iso-electric inCenter, Department of Cardiology and Electrophysiology, University Hospital Hamburg-Eppendorf, 20246, Hamburg, Germany (e-mail: pawel.kuklik@ tervals between consecutive deflections). Atrial electrograms,
maastrichtuniversity.nl).
because of the smaller volume of the atrial musculature, are
B. Maesen and J. Maessen are with the Department of Cardio- characterized by long iso-electric intervals between consecutive
thoracic Surgery, Maastricht University Medical Centre, Maastricht 6211
deflections.
LK, The Netherlands (e-mail: b.maesen@maastrichtuniversity.nl; j.g.maessen@
mumc.nl).
We hypothesized that the presence of such intervals could
H. Crijns is with the Department of Cardiology, Maastricht University result in a higher sensitivity of phase reconstruction to noise
Medical Centre, Maastricht 6211 LK, The Netherlands (e-mail: hjgm.crijns@
in the signal—even small amplitude variations may result in
mumc.nl).
S. Zeemering, S. Verheule, and U. Schotten are with the Department of
artifacts in reconstructed phase. In addition, we further hypothPhysiology, Maastricht University, Maastricht 6211 LK, The Netherlands esized that morphology features of atrial unipolar electrogram
(e-mail: s.zeemering@maastrichtuniversity.nl; s.verheule@maastrichtuniversity.
could significantly affect phase reconstruction. In this study,
nl; schotten@maastrichtuniversity.nl).
A. N. Ganesan is with the Centre for Heart Rhythm Disorders, South
we aim to explore basic properties of Hilbert transform apAustralian Health and Medical Research Institute, University of Adelaide plied to unipolar electrograms and suggest a signal preprocessand Royal Adelaide Hospital, Adelaide, SA 5005, Australia (e-mail: anand.
ing method leading to a robust phase reconstruction of atrial
ganesan@adelaide.edu.au).
Digital Object Identifier 10.1109/TBME.2014.2350029
electrograms.

C

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KUKLIK et al.: RECONSTRUCTION OF INSTANTANEOUS PHASE OF UNIPOLAR ATRIAL CONTACT ELECTROGRAM

297

analytic considerations. This approach enabled us to control the
morphology of the electrograms (such as the amplitude of R and
S waves and the level of noise) and assess their effect on the
reconstructed phase. Details of the mathematical approach are
presented in the Appendix.
C. AF Electrograms Acquisition

Fig. 1. Definition of the instantaneous phase using the motion of an object
along the circle as an example. (a) Position of the object along Y-axis. (b) Corresponding instantaneous phase. (c) Completion of one full rotation corresponds
with a change of the phase from a minimum to maximum value.

II. METHODS
A. Definition of Hilbert Transform and Instantaneous Phase
Hilbert transform is a linear operator transforming a function
u(t) into a function H(u)(t)
 ∞
u(t)
1
dτ
(1)
H(u)(t) = P
π
−∞ t − τ
where P is the Cauchy principal value of the integral. The Hilbert
transform has found a widespread use, especially in signalprocessing applications, where it is used to obtain an analytic
representation of the signal, allowing calculation of instantaneous frequency and phase [9]. Phase is defined as an angle
between the original signal and the Hilbert transform of the signal. Exact formulations of the phase vary between studies. In
our study, we define instantaneous phase as follows:


−(u(t) − u∗ )
(2)
φ(t) = arctan
H(u)(t) − u∗
where u∗ sets the origin of the phase plane with respect to which
phase is computed.
Instantaneous phase increases monotonically within consecutive cycles of oscillation, reverting to a base value after completion of each cycle. This property results in a “sawtooth” appearance of the instantaneous phase plot. An illustration of the
definition of the phase is shown in Fig. 1, using as an example a
motion of an object with constant velocity along circular trajectory [see Fig. 1(a)]. The position of such object along y-axis is
a sinusoid [see Fig. 1(b)] in which one completion of the rotation corresponds with one period of the sinusoid. Instantaneous
phase of this sinusoid is shown in Fig. 1(c). Each period of the
sinusoid corresponds with one segment in the phase “sawtooth”
plot.
B. Construction of Idealized Unipolar Signals
In order to assess effects of specific features of the unipolar
deflection morphology, we constructed idealized signals using

Unipolar electrograms were collected in 40 patients [12
pts with Paroxysmal AF (PAF) and nine with Persistent AF
(PersAF)] during cardiac surgery. Rectangular plaques (16×16
electrodes, 1.5-mm interelectrode spacing) were placed on the
epicardial surface of the atria. The plaque was positioned on the
left atrial posterior wall and the right atrial free wall. Atria were
mapped sequentially with a 256-channel computerized mapping
system (bandwidth, 0.5 to 500 Hz; sampling rate 1 kHz, resolution 12 bits). Far-field QRS complexes were subtracted from the
unipolar fibrillation electrograms by a single-beat cancellation
method [10], [11]. After exclusion of poor contact recordings,
we included 23 recordings in PAF group (11 in left and 12 in
right atria) and 17 recordings in PersAF group (eight in left and
nine in right atria).
D. Calculation of Hilbert Transform and Instantaneous Phase
All signal processing was conducted in MATLAB (version
7.12, Mathworks Inc., Natick, MA, USA). The Hilbert transform was calculated using the “Hilbert” function. Phase was
calculated using (2) using four-quadrant inverse tangent function “atan2.”
E. Electrogram Transformation: Sinusoidal Recomposition
We propose a transformation of atrial unipolar electrograms
that should be applied prior to application of the Hilbert transform. We designed this transformation based on following
assumptions.
1) Due to the mathematical properties of the Hilbert transform, phase reconstruction of the instantaneous phase
performs best in case of a sinusoidal morphology of the
signal.
2) Local activity in unipolar signals related with a beginning
of new cycle is proportional to the signal slope.
Based on these considerations, we proposed the following
transformation:
1) The transformed signal is a sum of sinusoidal waves of
one period length (called “sinusoidal wavelets” below).
2) For each time point of the original signal, one sinusoidal
wavelet is created.
3) The amplitude of the sinusoidal wavelet is proportional to
the slope of the signal at a given time point.
4) A wavelet is generated only if a derivative of the signal is
negative (since a negative slope in unipolar electrogram
corresponds with the passing of a wave).
5) The period of the sinusoidal wavelet is equal to the mean
cycle length of the electrogram derived from dominant
frequency of given electrogram [[12]].

298

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Fig. 2. Schematic of the “sinusoidal recomposition” transformation. (a) Original signal. (b) Sinusoidal wavelets are created for each time point of the original
signal (signal was down-sampled for clarity). (c) Recomposed signal is a sum
of all sinusoidal wavelets. (d) Corresponding instantaneous phase.

Fig. 3. Instantaneous phase of atrial unipolar electrograms recorded in paroxysmal (left) and persistent (right) atrial fibrillation. From top to bottom: original
signal, phase obtained applying Hilbert transform to original electrogram, electrogram after sinusoidal recomposition, phase of the recomposed electrogram.
Dots in original electrogram denote positions of intrinsic deflections calculated
using template matching. Dots in instantaneous phase plots denote positions of
phase inversions (time point at which phase changes from p to – p).

F. Study Design
These steps can be summarized in a following equation:


t+ T2

w(t)
t− T2

 
dv
 dv  1 − sign( dt
)
dt sin(t − t )   
dt
2




(3)

where w(t) is a transformed signal, v(t) is an original electrogram, and T is a mean cycle length of the original electrogram
(derived from dominant frequency of the electrogram) and sign()
is the signum function. A schematic explaining the construction of the transformed signal is shown in Fig. 2. Examples of
phase reconstruction are shown in Fig. 3. Since we use sinusoidal wavelets to construct transformed signals, we term this
transformation a “sinusoidal recomposition.” The phase of the
recomposed signal was calculated using (2).
Since the recomposed signal is a sum of sinusoidal wavelets
with a mean value equal to zero and wavelets of the greatest
amplitude are clustered around the negative slope of the local
deflection, the resultant recomposed signal also has a sinusoidal
morphology oscillating around zero value. Based on this consideration, we set u∗ (origin of the phase space with respect to
which phase is computed; see (2)) to zero.
We used a specific definition of phase presented in (2) in order to obtain timing of the phase inversion (time point at which
phase changes value from maximum to minimum denoting a
beginning of a new cycle) coinciding with the timing of the
local deflection in the electrogram. Formulation in (2) results,
in case of a sinusoidal signal, in phase inversion occurring at
position of the maximum negative slope of sinusoid. Since during sinusoidal recomposition individual sinusoidal wavelets are
triggered according to the timing of the negative slope in electrogram, this will result in timings of the phase inversions centered
at timings of the local deflections in electrogram.

In order to assess the properties of the Hilbert transform applied to contact electrograms, we employed two approaches:
1) analysis of idealized morphologies obtained from mathematical modeling of unipolar electrograms, and 2) analysis of contact unipolar electrograms obtained during epicardial mapping
of human AF. Taking advantage of the customizability of idealized electrograms, we investigated how instantaneous phase
is affected by: 1) monophasic and biphasic morphology of the
deflection, 2) R versus S wave ratio of the unipolar electrogram,
and 3) noise added to the signal. We used contact electrograms
recorded during human AF to: 1) assess agreement between
estimation of mean and standard deviation of cycle length and
2) investigate a possibility of using timings of phase inversions
to assess wave propagation complexity. We compared number
of reconstructed waves and their mean size based on timings
of phase inversions versus timings based on intrinsic deflections (using previously validated wave reconstruction algorithm
[11]).
III. RESULTS
A. Instantaneous Phase of Monophasic and Biphasic
Deflection Morphology
Ideally, a deflection in a unipolar electrogram corresponding
with local conduction event should be biphasic, i.e., contain two
peaks [R and S waves; see Fig. 2(a)] [13]. However, in experimental recordings, a monophasic morphology of deflections is
often observed [see Fig. 3(b)]. Instantaneous phase in case of
the monophasic and biphasic deflection morphology is shown
in Fig. 4. In the case of biphasic deflection, phase morphology
obtained by application of Hilbert transform directly to electrogram is distorted, showing a sudden increase just prior to end of

KUKLIK et al.: RECONSTRUCTION OF INSTANTANEOUS PHASE OF UNIPOLAR ATRIAL CONTACT ELECTROGRAM

299

Fig. 4. Instantaneous phase (a) in case of monophasic (b) and biphasic deflection morphology.

the cycle [see red curve in bottom plot in Fig. 4(b)]. This effect
is also present in case of monophasic morphology [Fig. 4(a)]
but much less pronounced. Phase inversion of the recomposed
signal (green line) is located in the middle of down slope and
has triangular morphology in both cases.

Fig. 5. Effect of varying ratio of R and S waves amplitude on morphology
of reconstructed phase (a) Electrogram in blue. Instantaneous phase of the
original signal in red. (b) Instantaneous phase of the recomposed signal in
green. Definition of R and S amplitude.

B. Effect of R/S Amplitude Asymmetry
in Unipolar Electrogram
In order to assess the effect of R/S amplitude asymmetry in
unipolar electrograms on phase reconstruction, we multiplied
left and/or right portion of the deflection by a constant value,
which resulted in asymmetric R and S waves [see blue signals in
Fig. 5(a) and (b) for the definition of R and S waves]. In general,
different ratios of R and S waves resulted in distinct shapes of
reconstructed phase [see red curves in Fig. 5(a)].
Closer inspection of the relation of the phase to the morphology of the electrogram (blue) shows that the general shape of
the phase follows the shape of the electrogram: It is fully convex
if electrogram is convex [see Fig. 5(a), R = 0], fully concave in
case of a concave electrogram for S = 0 [see Fig. 5(a), S = 0],
and it exhibits both a convex and concave shape in between the
R = 0 and S = 0 extremes [e.g., see Fig. 5(a), S = 2/3R: first and
second half of the phase (red) between consecutive deflections].
Phase reconstruction based on recomposed electrogram was not
affected by R/S ratio [see Fig. 5(a), green curves].
C. Effect of Noise Added to the Unipolar Electrogram
In order to investigate the effect of noise on phase reconstruction, we added low- or high-frequency noise to the signal. Highfrequency noise was defined as a Gaussian noise of a specified
standard deviation σ. Low-frequency noise was also obtained
from Gaussian noise, however, after applying a low-pass filter at
a specified cutoff frequency. Since we aim at qualitative exploration, we selected just one frequency cutoff, 40 Hz, resulting in
an electrogram fractionation resembling morphology observed

Fig. 6. Effect of Gaussian noise added to the signal on the reconstruction of
instantaneous phase. Electrogram in blue. Instantaneous phase of the original
signal in red. Instantaneous phase of the recomposed signal in green. For σ >
0.01|R|, additional phase inversion occurrences appear.

in experimental setting. The amplitude of the noise was controlled by the standard deviation of the noise σ and expressed
as a proportion of the R-wave amplitude. Results are shown in
Figs. 6 and 7. In case of high-frequency noise, with an increasing
amplitude, additional phase inversions occur with a significant
increase in number at σ > 0.01|R| (see Fig. 6).
Low-frequency noise also caused an occurrence of additional
phase inversions (for σ > 0.2|R|), however, with a broader morphology and fewer in number (see Fig. 7). Phase reconstruction
based on recomposed electrograms did not exhibit additional
phase inversions with increasing noise. Instead, for σ > 0.8|R|,
a timing of the phase inversion began to be affected (see green
line in Fig. 7 with especially pronounced shift of first deflection
for σ = 1.4|R|).

300

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Fig. 7. Effect of low-frequency noise added to the unipolar signal on instantaneous phase reconstruction. Electrogram in blue. Instantaneous phase of the
original signal in red. Instantaneous phase of the recomposed signal in green.

D. Assessment of Local Cycle Length Using
Phase Reconstruction
Since the timing of a phase inversion corresponds with a
position of intrinsic deflection in the electrogram (see Fig. 3), we
explored the possibility of using timings of the phase inversions
to reconstruct local cycle length and compare to previously
validated assessment of cycle length based on timing of intrinsic
deflections (see Fig. 3 for both definitions of cycle lengths).
We used algorithms previously developed and validated in our
group to determine timings of the intrinsic deflections [11]. We
compared the mean and SD of the cycle length per recorded
episode (23 paroxysmal and 17 persistent AF recordings) using
both methods. Results are shown in Fig. 8. Both methods show
very good agreement with R2 = 0.99 in PAF group and R2 =
0.76 in PersAF group for mean cycle lengths, and R2 = 0.90
in PAF group and R2 = 0.92 in PersAF group for SD of cycle
lengths.
E. Reconstruction of Wave Propagation Using
Instantaneous Phase
We used timings of phase inversions as a starting point of an
individual activation wave reconstruction. Wave reconstruction
was performed using an algorithm previously developed and
validated in our group [11]. We compared the number and mean
size of reconstructed waves using timings of intrinsic deflections
versus timings corresponding with phase inversions.
The mean number of the waves and mean wave size were
estimated per AF episode (23 paroxysmal AF and 17 persistent
AF recordings). An example of individual waves reconstructed
using both approaches is shown in Fig. 9(a) and (b). The total number of waves was correlated with R2 = 0.95 in PAF
group and R2 = 0.94 in PersAF group [see Fig. 9(c) and (e) respectively]. Mean wave size correlated with R2 = 0.68 in PAF

Fig. 8. Comparison of mean local cycle length in (a) PAF group and in
(c) PersAF group, standard deviation of local cycle length in (b) PAF group
and in (d) PersAF group assessed using phase reconstruction versus intrinsic
deflection annotation.

group and R2 = 0.96 in PersAF group [see Fig. 9(d) and (f),
respectively].
IV. DISCUSSION
In this paper, we aimed to achieve two goals: 1) explore
the properties of instantaneous phase reconstruction using the
Hilbert transform applied to atrial unipolar contact electrograms
and 2) devise a method for robust phase reconstruction of such
electrograms. With respect to first goal, we applied the Hilbert
transform to idealized electrograms derived from analytic considerations and demonstrated that the reconstructed phase is
influenced by electrogram morphology (mono-/biphasic shape,
R/S wave ratio) and is very sensitive to high-frequency noise
added to the signal (which is very relevant in case of atrial electrograms characterized by long isoelectric line between consecutive deflections during which noise can be interpreted as a new
deflection). Those properties make application of the Hilbert
transform directly to electrograms recorded in experimental settings inappropriate due to great variability of aforementioned
factors and presence of noise in broad range of frequencies. In
order to overcome this difficulty, we devised a signal preprocessing method (which we coined “sinusoidal recomposition”) that
should be applied prior to application of the Hilbert transform.
Phase reconstruction of electrograms after sinusoidal recomposition showed large robustness and little dependence on all
confounding factors we identified (mono-/biphasic shape, R/S
ratio variability, noise added to signal) resulting in the expected triangular shape of the phase morphology. We applied
our method to electrograms recorded during AF in humans and

KUKLIK et al.: RECONSTRUCTION OF INSTANTANEOUS PHASE OF UNIPOLAR ATRIAL CONTACT ELECTROGRAM

Fig. 9. Example identification of individual waves (example case from PersAF
group) based on clustering electrodes with similar activation times (see [11])
(a) using timings of local deflections in electrogram and (b) using timings
of phase inversions. Each color denotes an individual wave at given time
point (whole square corresponds with 16×16 electrodes plaque). Number of
individual waves and their mean size was calculated for each AF recording using both methods. Number of reconstructed waves for (c) PAF group
and (e) PersAF group. Mean wave size for (d) PAF group and (f) PersAF
group.

demonstrated its ability to robustly estimate the mean and SD
of cycle length, the number of fibrillation waves, and their mean
size.
There are two important factors related with phase reconstruction: 1) the timing of the phase inversion and 2) the morphology of the reconstructed phase. Correct timing of the phase
inversions (with respect to a feature in the signal related with
change of the cycle) is important since it defines starting and
ending point of each cycle. The exact position of the phase inversion depends on the definition of phase [see (2)]. We chose
the definition presented in (2) since it results in timing of the
phase inversion simultaneous with timing of the greatest negative slope in electrogram. With respect to the morphology of
the reconstructed phase, the ideal phase reconstruction should
result in a “sawtooth” shape. Such morphology denotes linear
change of the phase between consecutive cycles. A linear phase
change is especially important in assessment of coherence and
synchronization between different signals. Such measures rely
on the difference in phase between two electrograms; therefore,
each deviation from linear morphology (e.g., related with R/S

301

asymmetry as shown in Fig. 5) will confound the obtained measures. We found that phase computed on recomposed signals
robustly exhibits linear shape in presence of such confounding
factors as R/S asymmetry, morphology type, and added noise.
The question whether such morphology of the phase properly
reflects atrial repolarization and allows detection of phase singularities will be addressed in future work.
We did not perform any form of signal filtering prior to the
application of the Hilbert transform. This may be viewed as a
failure to explore the potential benefits proper filtering may bring
to the quality of phase reconstruction. However, based on the
literature review and our own experience, we argue that signal
filtering does not have the potential to remedy and compensate for the effects of features specific to atrial electrograms in
their extensive range of amplitudes and corresponding frequencies encountered in practice [especially in case of electrograms
recorded during atrial fibrillation (AF)]. Additionally, there is
no consensus regarding proper filtering of atrial unipolar electrograms in the context of phase reconstruction, and it would be
arbitrary to devise a method to compare against. A notable development was suggested by Bray and Wikswo in [6], where authors applied pseudo-Empirical Mode Decomposition (pEMD)
to optical signals during cardiac fibrillation in order to properly
reconstruct phase and identify phase singularities. However, the
pEMD approach assumes that an oscillation related to the underlying electrical activity is reflected in the signal amplitude.
This condition is true in case of transmembrane voltage during fibrillation, but not in case of atrial unipolar electrograms,
where local activity related with a passing wave is reflected in
sudden change of electrogram slope, which may be of smaller
amplitude than far-field components.
Phase singularities in cardiac fibrillation (corresponding with
a tip of rotating wave) have been a subject of significant research
effort due to their potential role in initiation and maintenance
of fibrillation. Their properties and methods of localization became an interest of clinical and basic electrophysiology [14].
Recently, Narayan et al. applied the Hilbert transform to unipolar signals during atrial fibrillation (AF) in order to identify the
core of reentrant waves and subsequently terminate arrhythmia
by ablation at those sites [8], [15] reporting very encouraging
results. Unfortunately, details of the signal processing used in
these studies were not disclosed, therefore hampering their replication and validation by other groups. We hope our contribution
addresses this need by providing a simple and robust method
of phase mapping using contact mapping of atrial fibrillation
electrograms.
The main assumption of the proposed method of phase reconstruction is local stability of the underlying cycle length.
In the current approach, we used Fast Fourier Transform (see
[12] for details) applied to the whole electrogram to estimate
dominant frequency, which was then used to derive the length
of the sinusoidal wavelet used in sinusoidal recomposition. This
assumption may not hold in case of AF with greatly variable
frequencies. Several approaches may help to overcome this
problem through adapting the length of sinusoidal wavelet to
local frequency such as computing FFT in sliding window or
application of wavelet transform [16].

302

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

The presented method of phase reconstruction could be applied to other types of signals reflecting oscillatory processes
beyond unipolar electrograms recorded during atrial fibrillation.
There are two conditions such signal should fulfill: 1) relatively
stable frequency and 2) existence of specific features corresponding with transition between cycles (such as presence of a
large negative slope in unipolar electrogram related with passing wave). A sinusoidal recomposition algorithm could be then
adjusted to generate sinusoidal wavelets with amplitude proportional to quantified magnitude of given “change of cycle” feature
in the signal. For example, in case of bipolar electrograms, it
could be an electrogram amplitude (since the spike in a bipolar
electrograms is related with passing wave).
APPENDIX
CALCULATION OF THE IDEALIZED UNIPOLAR ELECTROGRAM
A wavefront of the planar activation wave in the Cartesian
coordinate system propagating along X-axis can be described in
parametric form as
x(p; t) = wt
y(p; t) = p; p ∈ (−∞, ∞)

(A1)

where w is a conduction velocity, t denotes the time, and p is a
parameter. In general, the unipolar electrogram at given point in
space is given by
 −
→
r ∇v(r, t)
1
→
u(−
re , t) = −
dv
(A2)
→
4πσe v
|−
r |3
where σe is the extracellular conductance and v(r, t) is the transmembrane voltage distribution in volume V [17]. For simplicity,
we will assume a homogeneous medium and thus omit 1/4πσe
from the equation. In our geometrical approach, we assume
that only wavefronts of the activation wave contributes to the
unipolar electrogram (i.e., only phase 0 of the action potential).
Therefore, we can replace gradient of the voltage by a constant.
Equation (2) then takes the form
 p=∞
→
−
[x(p) − xe , y(p) − ye )] Ads
(A3)
u(xe , ye , t) = −
3
p=−∞ |[x(p) − xe , y(p) − ye )]|
where xe and ye are coordinates of the point at which unipo→
−
lar electrogram is calculated [(0,0) in our case] and ds is an
infinitesimal vector perpendicular to the wavefront. Parameter
A denotes the contribution of a given portion of the wavefront
toward unipolar electrogram. We assume this contribution to
be constant along the wavefront (therefore A does not depend
on parameter p). Since in case of a planar wave propagating in
direction of X-axis
→
−
ds = [1, 0] dp.
(A4)
Then, the equation for unipolar electrogram expressed using
only parameter p is given by
 p=∞
wt
dp
(A5)
u(t) = −A
|[wt,
p]|3
p=−∞

Above equation has been integrated in MATLAB environment to obtain the morphology of an idealized, single unipolar
deflection with a width controlled by the conduction velocity
(parameter w).
REFERENCES
[1] A. T. Winfree, When Time Breaks Down: The Three-Dimensional Dynamics of Electrochemical Waves and Cardiac Arrhythmias. Princeton, NJ,
USA: Princeton Univ. Press, 1987.
[2] K. Umapathy, K. Nair, S. Masse, S. Krishnan, J. Rogers, M. P. Nash, and
K. Nanthakumar, “Phase mapping of cardiac fibrillation,” Circ. Arrhythm.
Electrophysiol., vol. 3, pp. 105–14, Feb. 2010.
[3] I. R. Efimov, Y. Cheng, D. R. Van Wagoner, T. Mazgalev, and P. J.
Tchou, “Virtual electrode-induced phase singularity: A basic mechanism of defibrillation failure,” Circ. Res., vol. 82, pp. 918–25, May 4,
1998.
[4] R. A. Gray, A. M. Pertsov, and J. Jalife, “Spatial and temporal organization
during cardiac fibrillation,” Nature, vol. 392, pp. 75–8, Mar. 5, 1998.
[5] M. P. Nash, A. Mourad, R. H. Clayton, P. M. Sutton, C. P. Bradley,
M. Hayward, D. J. Paterson, and P. Taggart, “Evidence for multiple mechanisms in human ventricular fibrillation,” Circulation, vol. 114, pp. 536–42,
Aug. 8, 2006.
[6] M. A. Bray and J. P. Wikswo, “Considerations in phase plane analysis
for nonstationary reentrant cardiac behavior,” Phys. Rev. E Statistical
Nonlinear Soft Matter. Phys., vol. 65, pp. 051902-1–051902-8, May 2002.
[7] S. M. Shors, A. V. Sahakian, H. J. Sih, and S. Swiryn, “A method for
determining high-resolution activation time delays in unipolar cardiac
mapping,” IEEE Trans. Biomed. Eng., vol. 43, no. 12, pp. 1192–1196,
Dec. 1996.
[8] S. M. Narayan, D. E. Krummen, M. W. Enyeart, and W. J. Rappel, “Computational mapping identifies localized mechanisms for ablation of atrial
fibrillation,” PLoS One, vol. 7, p. e46034, 2012.
[9] R. N. Bracewell, The Fourier Transform and Its Applications, 3rd ed.
Boston, MA, USA: McGraw-Hill, 2000.
[10] B. P. Hoekstra, C. G. Diks, M. A. Allessie, and J. DeGoede, “Nonlinear
analysis of the pharmacological conversion of sustained atrial fibrillation
in conscious goats by the class Ic drug cibenzoline,” Chaos, vol. 7, pp. 430–
446, Sep. 1997.
[11] S. Zeemering, B. Maesen, J. Nijs, D. H. Lau, M. Granier, S. Verheule, and
U. Schotten, “Automated quantification of atrial fibrillation complexity by
probabilistic electrogram analysis and fibrillation wave reconstruction,” in
Proc. IEEE Eng. Med. Biol. Soc. Conf., 2012, vol. 2012, pp. 6357–6360.
[12] M. K. Stiles, A. G. Brooks, B. John, Shashidhar, L. Wilson, P. Kuklik,
H. Dimitri, D. H. Lau, K. C. Roberts-Thomson, L. Mackenzie,
S. Willoughby, G. D. Young, and P. Sanders, “The effect of electrogram
duration on quantification of complex fractionated atrial electrograms and
dominant frequency,” J. Cardiovasc. Electrophysiol., vol. 19, pp. 252–258,
Mar. 2008.
[13] B. M. Steinhaus, “Estimating cardiac transmembrane activation and recovery times from unipolar and bipolar extracellular electrograms: A simulation study,” Circ. Res., vol. 64, pp. 449–62, Mar. 1989.
[14] A. N. Ganesan, P. Kuklik, D. H. Lau, A. G. Brooks, M. Baumert,
W. W. Lim, S. Thanigaimani, S. Nayyar, R. Mahajan, J. M. Kalman,
K. C. Roberts-Thomson, and P. Sanders, “Bipolar electrogram shannon
entropy at sites of rotational activation: implications for ablation of atrial
fibrillation,” Circ. Arrhythm. Electrophysiol., vol. 6, pp. 48–57, Feb. 2013.
[15] S. M. Narayan, D. E. Krummen, K. Shivkumar, P. Clopton, W. J.
Rappel, and J. M. Miller, “Treatment of atrial fibrillation by the ablation of
localized sources: CONFIRM (conventional ablation for atrial fibrillation
with or without focal impulse and rotor modulation) trial,” J. Amer. Coll.
Cardiol, vol. 60, pp. 628–36, Aug. 14, 2012.
[16] R. Q. Quiroga, O. W. Sakowitz, E. Basar, and M. Schurmann, “Wavelet
transform in the analysis of the frequency composition of evoked potentials,” Brain Res. Protocols, vol. 8, pp. 16–24, Aug. 2001.
[17] R. Plonsey and R. C. Barr, Bioelectricity: A Quantitative Approach, 3rd ed.
New York, NY, USA: Springer, 2007.

Authors’ photographs and biographies not available at the time of publication.

