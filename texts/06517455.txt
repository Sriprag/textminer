670

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

A Motion-Tolerant Adaptive Algorithm for Wearable
Photoplethysmographic Biosensors
Rasoul Yousefi, Student Member, IEEE, Mehrdad Nourani, Senior Member, IEEE,
Sarah Ostadabbas, Student Member, IEEE, and Issa Panahi, Senior Member, IEEE

Abstract—The performance of portable and wearable biosensors
is highly influenced by motion artifact. In this paper, a novel realtime adaptive algorithm is proposed for accurate motion-tolerant
extraction of heart rate (HR) and pulse oximeter oxygen saturation
(SpO2 ) from wearable photoplethysmographic (PPG) biosensors.
The proposed algorithm removes motion artifact due to various
sources including tissue effect and venous blood changes during
body movements and provides noise-free PPG waveforms for further feature extraction. A two-stage normalized least mean square
adaptive noise canceler is designed and validated using a novel
synthetic reference signal at each stage. Evaluation of the proposed algorithm is done by Bland–Altman agreement and correlation analyses against reference HR from commercial ECG and
SpO2 sensors during standing, walking, and running at different
conditions for a single- and multisubject scenarios. Experimental
results indicate high agreement and high correlation (more than
0.98 for HR and 0.7 for SpO2 extraction) between measurements
by reference sensors and our algorithm.
Index Terms—Adaptive filter, motion artifact, noise reduction,
photoplethysmography (PPG), pulse oximeter, wearable biosensor.

I. INTRODUCTION
A. Motivation
HOTOPLETHYSMOGRAPHY (PPG) is a noninvasive
measurement of the blood flow at the surface of the skin
by using red and infrared lights. Two common applications of
the PPG are calculations of the arterial oxygen saturation and
heart rate (HR). There are several new applications in different stages of maturity that require various analyses on the PPG
signal including amplitude, rhythm, peripheral pulse, respiratory variability, and tissue perfusion. For example, increased
and decreased signal amplitude can be signs of vasodilation
and vasoconstriction, respectively [1]. The amplitude is directly
proportional to the vascular distensibility [2]. PPG signals were
also found to be useful for detection and diagnosis of cardiac
arrhythmias [3], [4]. PPG signal is known to be sensitive to
pulsatile blood flow and captures the peripheral pulses. The
pressure at which the pulse is captured highly corresponds to

P

Manuscript received October 23, 2012; revised January 8, 2013 and April 1,
2013; accepted May 13, 2013. Date of publication May 20, 2013; date of current
version March 3, 2014.
The authors are with the Quality of Life Technology Laboratory, The University of Texas at Dallas, Richardson, TX 75080 USA (e-mail: r.yousefi@utdallas.
edu; nourani@utdallas.edu; sarahostad@utdallas.edu; issa.panahi@utdallas.
edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2264358

the systolic blood pressure (BP) [5]. The respiratory rate can
be reliably determined by PPG signal [6]–[8]. Noninvasive continuous tissue perfusion and peripheral blood flow detection is
another potential advantage of the PPG signal.
All the aforementioned applications require a clean and enhanced signal for feature extraction, analysis, and monitoring.
Therefore, the signal quality is critical for wearable PPG signals and systems [9], [10]. In new wearable and implantable
devices/applications, the biometric signal needs to be monitored
during daily activities where motion is always present. Motion
artifact is the most problematic source of noise which deteriorates signal integrity and can, in the worst case, corrupt it to
such an extent that it might be rendered clinically unusable. Examples from motions of the patient in real-world clinical setting
are movement during transport, rubbing, waving, seizures, and
kicking in neonates/infants. As a side effect, inaccurate reading
and interpretation of the PPG signal due to motion artifact can
increase caregiver’s workload which can lead to an increased
cost of care and inefficiency of patient’s treatment [11]–[13].
Therefore, there is a high demand for an effective algorithm
for wearable and mobile PPG biosensors to enhance the signal
quality in the presence of motion artifact.
B. Current State of the Art
Despite all the attractive benefits and applications of the PPG
signal and ease of integration into wearable devices, most of
the useful information can be distorted or concealed by motion
artifact. This is true in all wearable and portable applications in
both clinical settings and daily activities. One of the commonly
used methods to reduce artifact is adaptive noise cancellation
using accelerometers as a noise reference signal [14], [15]. A
2-D active noise cancellation has been tried using the directional
accelerometer data for finger PPG sensor [16]. The addition of a
reflectance PPG sensor as the reference signal was implemented
in [10]. Unfortunately, the reflectance PPG sensor is itself susceptible to motion. The main drawback of all these methods is
the cost of extra hardware for the noise reference. Additionally,
using three-axis accelerometer data is computationally intensive [10] and they truly reflect motion (as opposed to motioninduced noise). More precisely, researchers found no direct or
high correlation between acceleration data from accelerometer and motion artifact in PPG signal [17]. To deal with this
problem, a synthetic noise generation method is proposed using
concurrent usage of singular value decomposition (SVD), independent component analysis (ICA), and fast Fourier transform
(FFT) [18]. The algorithm basically assumes that the original
PPG signal has only power at certain frequencies and the rest

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

is noise and then uses FFT, SVD, and ICA to generate three
noise references. The algorithm switches between three generated reference noise signals by quantifying the randomness of
each signal using skewness and kurtosis. Such assumption on
motion artifact does not correlate well with different real-world
sources of noise. Moreover, the highest randomness does not
necessarily mean the highest correlation with the true motion
artifact in the PPG signal.
On the industry side, Masimo Corporation has introduced discrete saturation transform (DST) to find pulse oximeter oxygen
saturation in the presence of motion in portable devices [19],
[20]. Typically, the DST algorithm consists of a reference signal generator, an adaptive filter, and a peak finder to find the
most likely SpO2 value based on the incoming signals. In this
approach, the reference signal generator produces reference signals for all possible SpO2 values. For each reference signal, the
adaptive filter produces an output signal. Energy of each output
signal is computed and plotted versus corresponding SpO2 values. The right-most peak of the power plot (the largest saturation
value) is nominally considered as oxygen saturation of arterial
blood flow. Since this approach does not remove the motion
artifact (e.g., due to tissue effect), the effect of motion artifact
will be literally transformed to the output power plot in DST.
More specifically, in presence of motion artifact, new peaks will
be present on the output plot [21] and the peak finder may fail
to find the peak corresponding to accurate SpO2 . Conversely,
the peak corresponding to SpO2 may be concealed due to high
motion noise power causing the peak search to fail for that time
window.

C. Main Contribution and Paper Organization
In order to address motion artifact issues and design a practical wearable PPG sensor, different sources of motion-induced
error need to be identified, quantified, and estimated. In this
paper, we enhance and expand our earlier work reported in [22]
and use the basic optical theory of pulse oximetry to design and
develop signal-processing techniques for noise reduction and
signal enhancement. We propose a novel two-stage adaptive algorithm that efficiently removes the effect of tissue and venous
blood noise during motion. This algorithm extracts fundamental period of the PPG signal, the HR, and the oxygen saturation
level. The key contribution of our technique is to separate an
extremely clean signal corresponding to the arterial blood flow.
Once the clean signal is provided, a conventional technique can
be used to extract the oxygen saturation value. In this paper, for
experimentation, we have used the conventional ratio of ratios
technique for SpO2 extraction [23].
This paper is organized as follows. In Section II, a brief
review of optical techniques of the PPG signal generation and
optical theory behind the source of PPG signal are presented.
In Section III, we quantify different noise components due to
various sources and propose a reference noise generator. Then,
we formulate the problem of optimum noise source generation
to be used in the adaptive algorithm. The proposed algorithm is
described in Section IV. The experimental setup and validation

Fig. 1.

671

Blood circulation.

of the algorithm are in Section V and VI, respectively. The
concluding remarks are in Section VII.
II. BACKGROUND
A. PPG Signal
A conventional pulse oximeter uses two small and easy to
drive LED light sources with different wavelengths, i.e., a red
LED and an infrared (IR) LED. A photodiode receiver captures
the transmitted or reflected light sources. The analog front-end
hardware uses a time-multiplexed approach with three phases:
1) activated red LED, 2) activated IR LED, and 3) dark phase.
A transimpedance amplifier amplifies the current generated in
photodiode due to optical density during active phases and provides a voltage signal. This signal will be filtered, amplified,
and then sampled with an analog-to-digital converter for further
processing.
The basic circulation of blood is conduced by heart, which
pumps blood periodically and rhythmically into a branching
system of arteries. The pulsations generated periodically will
dampen by the time they reach the capillaries which are in contact with cells of tissues. As depicted in Fig. 1, the blood then
returns in an almost steady stream to the heart with another
pulsation stimulated in veins by muscular activity and the respiratory pump. An electronic interface captures these changes by
an optical sensor on the site of measurement (e.g., finger) and
provides the PPG signal with different components as shown in
Fig. 2.
B. Theory of Optical Density
The source of the PPG signal is the optical density transmitted
or reflected. As such, we will discuss and use optical theories
developed for pulse oximetry. The basis of optical absorption
is defined by Lambert–Beer’s law [25] that explains the optical
density (A) for both scatterer and nonscatterer as


Lin
d
=E·C ·D
(1)
A = log
Lout
where Lin and Lout are incident and transmitted light intensities, and C and D are the concentration and thickness of the

672

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

independent effect of both blood and tissue thickness changes.
Using this experimentally validated theory of operation, we will
present a noise removal technique in the next two sections.

Arterial blood
Venous blood
capillaries
Skin, bone, tissue

Components of PPG

Amplitude (not to scale)

Resultant PPG signal

Time
Fig. 2.

Components of a typical PPG signal (from [24] with permission).

optical absorber, respectively. E is extinction coefficient which
is intrinsic to the absorber and wavelength. The assumption in
this formulation is that the object is uniform and nonscattering,
so it only provides a rough estimation about scatterers. Two
basic theories of optical scattering, which give us more precise
prediction of scattering behaviors, are Rayleigh–Mie’s theory
and Schuster’s theory [26]. Aoyagi who reported the principle
of pulse oximetry in 1974 [27] has adopted the Schuster’s theory and introduced the optical theory behind PPG. According
to [26] and [27], the following relationship describes the optical density changes ΔA as a function of blood vessel thickness
changes ΔDb for a given blood vessel (see also Fig. 1):

ΔA = [ Eh (Eh + F )Hb + Zb ]ΔDb
(2)
d

where Eh = SEo + (1 − S)Er , in which Eo and Er are the
extinction coefficient of oxyhemoglobin and deoxyhemoglobin,
respectively. S is oxygen saturation, Hb is hemoglobin concentrations of the blood, and F is the scattering coefficient. Zb is a
constant which becomes zero when the optical receiver is wide
enough and independent of the working wavelength.
Tissue effect is reported to be one of the main sources of error
in obtained optical density leading to undesired fluctuation in
acquired PPG signal [26], [27]. Considering the effect of tissues,
(2) is modified by adding a new term (Zt ΔDt ) and becomes

ΔA = Eh (Eh + F )Hb ΔDb + Zb ΔDb + Zt ΔDt (3)
where Zt is approximated to be a constant independent of the
wavelength and ΔDt is the thickness change of the tissue.
Therefore, there is an optical density change (e.g., Zb ΔDb +
Zt ΔDt ) which is wavelength independent.
Equation (3) considers only one blood vessel. Considering the
effect of both arterial and venous blood vessels, there are both
arterial and venous blood changes. Therefore, ΔA is expressed
as

ΔA = Ea (Ea + F )Hba ΔDa

+ Ev (Ev + F )Hbv ΔDv + ΔAs .
(4)
Subscripts a and v refer to arterial blood and venous blood,
respectively. ΔDv and ΔDa are venous and arterial blood
thickness changes, respectively [26], [27]. ΔAs is independent of wavelength and it captures the accumulated wavelength-

III. CHARACTERIZATION AND FORMULATION
OF MOTION ARTIFACT
In this section, first we formulate optical density to define a
reference signal and a reference noise for removal of tissue effect
and venous effect, respectively. Then, we model the arterial
signal and define a cost function to find the optimum noise
reference for removal of venous effect over time.
A. Effect of Tissue
When the body remains still, ΔDt is close to zero and the
effect of tissue manifests itself as a dc component in the recorded
PPG signal, as shown in Fig. 2. This dc component can be
removed in analog front-end or by digital filtering. However, in
the presence of motion, this component is no longer constant.
Fluctuations caused by body movements, for example, during
walking, running, and treadmill exercise, can be clearly seen
in the recorded PPG signal. Such new rhythmic pattern and
variation in PPG signal can lead to an inaccurate and unreliable
fundamental period for PPG signal. To deal with these issues,
we employ two wavelengths to cancel out the effects of Zt
and Zb that are independent of the wavelength [26], [27]. More
specifically, we subtract optical densities [see (4)] corresponding
to two-wavelength PPG biosensor (subscript i and j are used
for wavelengths and t to represent tissue effect) and define the
result by


ΔAij t = [ Ea i (Ea i + F ) − Ea j (Ea j + F )]Hba ΔDa


+ [ Ev i (Ev i + F ) − Ev j (Ev j + F )]Hbv ΔDv .
(5)
Note that the term ΔAs in (4) is independent of wavelength [27]
and the time difference between recording of both wavelengths
is negligible compared to typical time for human motions. This
term is now effectively removed in (5). Consequently, the signal
portion due to blood pulsation will remain in ΔAij t and the
effect of tissue during body movement will be canceled out. As
it will be discussed later, the reference signal associated with
ΔAij t will effectively be used in an adaptive filter to enhance
signal quality for extracting the PPG fundamental period. Fundamental period will, therefore, be reliably extracted after signal
enhancement using the generated reference signal.
B. Venous Blood Movement
Another main source of error and interference is the change
of venous blood during motions. Effect of venous blood appears
in calculation of oxygen saturation more noticeably, while effect
of tissue hinders extraction of HR significantly. In the first step
of the algorithm (see Section IV), motion artifact due to tissue
effect is removed using ΔAij t as a reference signal. This is
equivalent to considering ΔAs = 0 in the second step where we

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

remove effect of venous blood movement. Therefore, we get the
following equations for a two-wavelength PPG biosensor:

⎧
ΔAi = Ea i (Ea i + F )Hba ΔDa
⎪
⎪
⎪

⎪
⎪
⎨
+ Ev i (Ev i + F )Hbv ΔDv
(6)

⎪
⎪
ΔAj = Ea j (Ea j + F )Hba ΔDa
⎪
⎪
⎪

⎩
+ Ev j (Ev j + F )Hbv ΔDv .
There are two sources of information, ΔAi and ΔAj , and each
source is a mixture of arterial blood (represented by subscript
a) and venous blood (represented by subscript v) at a particular
wavelength. The first term of optical density in (6) represents
the arterial signal and the second term represents the venous
blood signal. We introduce weighted subtraction of these two
sources, venous reference noise, ΔAij v = ΔAi − βΔAj as




⎧
ΔAij v = (ra − β) Ea j (Ea j + F ) Hba ΔDa
⎪
⎪
⎪




⎪
⎪
⎨
+ (rv − β) Ev j (Ev j + F ) Hbv ΔDv
(7)


⎪
⎪
⎪ ra = Ea i (Ea i + F )/ Ea j (Ea j + F )
⎪
⎪

⎩

rv = Ev i (Ev i + F )/ Ev j (Ev j + F )
where ra is the ratio of arterial optical densities which is linearly
related to arterial oxygen saturation and rv is the ratio of venous
optical densities. After removal of the tissue effect, the weighted
subtraction of optical densities can be used to separate two signal
sources related to artery and venous. Equation (7) implies that
with proper tuning of β, signal associated with ΔAij v may
contain venous source (i.e., β = ra ), artery source (i.e., β = rv )
or a combination of these two sources. In other words, we can
sweep β and generate a reference signal for the various values
of β. There is always a range of β where the reference signal
has the venous component and a wider range where the output
signal has the arterial component.
Successful separation of the venous component in (7) allows
us to use it as the reference noise signal in an adaptive filter to
remove the venous noise from (6). In order to find β that removes
arterial signal [first term of (7)] and keeps venous signal, we
need a criteria to quantify the performance of any given β. The
arterial signal is a periodic signal with a temporal structure.
The more pronounced periodic property of the arterial term in
(7) will be exploited by the subsequent adaptive and prediction
error filtering to separate these two signals leading us to obtain
good estimate of the arterial signal. In the next section, we
formulate this problem to find the optimum β (βopt ) to be used
in estimating the venous noise reference signal and to implement
an adaptive filter for removal of venous blood movement noise.

(a)

(b)

Fig. 3.

Modeling temporal structure using predictor filter.

the arterial component using previous values of the signal and
generate the prediction error.
Inputs x1 and x2 corresponding to the optical densities ΔAi
and ΔAj in (6) are linear combinations of arterial and venous
signals. Using arterial and venous optical density ratios, ra and
rv , defined in (7), x1 and x2 can be expressed as

x1 = ra sa + rv sv
(8)
x2 = sa + sv .
The subtracter generates weighted subtraction of input signals
x1 and x2 and generates a noise reference signal corresponding
to ΔAij v in (7). The adaptive filter uses this noise reference
signal to filter out the noise, second term of (6). Arterial source
signal is a temporally correlated signal. As shown in Fig. 3(a),
the temporal structure of the enhanced arterial signal can be
modeled with an adaptive filter with the z-transform of B(z) at
the output of the adaptive enhancer. The predictor filter models the generated arterial signal, ra ŝa (n). The role of B(z)
is to estimatera ŝa for any given β. For the optimum value
of β, ra ŝa ≈ Ea i (Ea i + F )Hb ΔDa (i.e., the first term of
ΔAi ), which is a predictable (periodic) signal representing arterial signal. Therefore, for βopt , the variance of the prediction
error will be minimized.
In order to find optimum β, algorithm of Fig. 3(b) is implemented. This algorithm first extracts a scaled estimate of the
arterial signal in x1 (i.e. ŝas ) by minimizing variance of the
error signal e(n) at the output of the linear predictor. The error
signal, e, is the difference between current sample of ŝas (n)
and the output of the linear predictor filter B(z) which can be a
simple finite impulse response (FIR) filter. This relation can be
mathematically expressed as
e(n) = (1 − B(z))ŝas (n).

(9)

Generally, the FIR prediction filter of order P can be expressed
as

C. Optimum β
To explain the algorithm for optimum β, model of Fig. 3(a)
is developed. This model consists of three main units: weighted
subtracter, adaptive enhancer, and predictor filter. The adaptive
enhancer is added to remove the second term of ΔAi in (6) and
keep the arterial component using the subtracter output as the
reference noise. The prediction error filtering is used to predict

673

B(z) =

P


bl z −l .

(10)

l=0

Optimization of rv and coefficient of B(z) can be done by
minimizing mean square error defined as the cost function:
J(rv , b) = E[e2 ]

(11)

674

Fig. 4.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

Proposed motion-tolerant algorithm for signal enhancement.

where b is the vector of coefficient of FIR filter. This cost function has been previously used in the context of blind signal
extraction [28]. In order to simplify the computation and use the
extracted fundamental period of the signal, a linear predictor is
chosen, B(z) = bz −T a , where Ta is the fundamental period of
the arterial source signal in discrete time and b is the only coefficient of the filter. The cost function, E[e2 ], can be manipulated
and written as
J(rv , b) = E[ŝ2as (n)] − 2bE[ŝas (n)ŝas (n − Ta )]
+ b2 E[ŝ2as (n − Ta )].

(12)

When the gradients of the cost function with respect to rv and
b are zero, the prediction error has its minimum value. So, by
equating gradient of the cost function with respect to rv and b
to zero, we obtain a system of equations. Solving this system of
equations, we have
−E[x21 ]E[ŝasD x2 ] + E[x1 x2 ]E[ŝasD x1 ]
E[x22 ]E[ŝasD x1 ] − E[x1 x2 ]E[ŝasD x2 ]

(13)

b = E[ŝas (n)ŝas (n − Ta )]/E[ŝ2as (n − Ta )].

(14)

rv =
and

It can be proven that for every given b, including b for which
∂ J (r v ,b)
= 0, the error curve is a quadratic function of rv and
∂ rv
there is always a single minimum on the error curve. After
extraction of the scaled estimate of the arterial signal (i.e., ŝas )
in x1 , the reference noise is extracted by removing estimate of
arterial signal from x1 . This is done by minimizing variance of
signal e1 (reference noise) in Fig. 3(b). By taking gradient of

E[e21 ] with respect to α, we obtain
α=

E[x21 ] − rv E[x1 x2 ]
.
E[ŝas ]

(15)

Signal e1 in Fig. 3(b) is actually the reference noise. Therefore,
linear combination of signals x1 and x2 (i.e., x1 − βx2 ) with
αrv
, in Fig. 3(b) provides an estimate of
optimum β, βopt = 1−α
the reference venous noise source.
IV. PROPOSED NOISE-TOLERANT ALGORITHM
The proposed algorithm for signal enhancement and extraction of SpO2 /HR is shown in Fig. 4. Our adaptive algorithm has
five main steps:
1) Remove motion noise due to tissue effect from red and
infrared signals.
2) Extract fundamental period using enhanced red or infrared
signals of step 1.
3) Find optimum venous noise reference (i.e., finding βopt )
using red or infrared signals of step 1.
4) Enhance red and infrared signals using time-variant βopt
for monitoring and further feature extraction.
5) Calculate HR and SpO2 using signal obtained after removal of motion noise due to tissue and venous blood
changes during bodily movement.
Next, we explain each of the aforementioned steps implemented in block diagram of Fig. 4.
A. Tissue Effect
As we discussed in Section III, by subtracting the red and
infrared signals, a reference signal is obtained (i.e., point P1

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

Fig. 6.

675

Real-time fundamental period estimator.

(a)

desired signals in filters M 1 and M 2 [i.e., input I1 in Fig. 5(b)].
The reference signal in filters M 1 and M 2 of Fig. 4 represent
the true signal. The enhanced output x1 and x2 in Fig. 4 are
red and infrared signal after the removal of tissue effect coming
from enhanced signal output in Fig. 5(b).
(b)

Fig. 5. Adaptive noise canceler (a) with reference noise (N) and (b) with
reference signal (M).

in Fig. 4) which corresponds to ΔAij t in (5). This reference
signal is used in adaptive filters (M 1 and M 2 blocks in Fig. 4)
to enhance the red and infrared signals, respectively. As shown
in Fig. 5, adaptive noise canceler basically consists of a filtering
process which applies a linear filter on a reference input. For instance, the reference signal I2 in Fig. 5(a) is linearly correlated
with d(n), the noise component in I1 . Hence, by subtracting
ˆ
the filter output, d(n),
from a desired response, s(n) + d(n) an
estimation error will be generated. An adaptive process automatically updates the coefficient of the filter based on a criteria
extracted from the estimation error. This criteria will be defined
by the adaptive algorithm used for automatic update of the coefficients. One of the most commonly used algorithms is the
least mean square algorithm and its variations. The adaptive algorithm used in this study is the normalized least mean square
(NLMS) algorithm due to its lower complexity compared with
other techniques and immunity to the fluctuation in the signal
energy.
Given the desired signal, input reference signal I2 , and the
current value of the filter coefficient w(n), the update equation
can be expresses as
w(n + 1) = w(n) +

2η
I2 (n)e(n) (16)
N −1 2
ε + i=0 I2 (n − i)

where N is the length of the adaptive filter and 0 < η < 1. ε is
a small number to avoid division by zero due to numerical and
fixed-point computations. The error signals e(n) in Fig. 5(a)
ˆ
and (b) are s(n) + d(n) − d(n)
and d(n) + s(n) − ŝ(n), respectively. In adaptive noise canceler of Fig. 5(a), the reference
signal is only correlated with the noise source. Therefore, minimizing error power minimizes the noise power in mean square
sense and enhanced signal will be obtained at the output. Similarly, in adaptive noise canceler of Fig. 5(b), the reference signal
is only correlated with the signal source s(n). Therefore, minimizing error power results in an enhanced noise at the primary
output, but an enhanced signal output ŝ(n) is also available.
Input red and infrared signals corrupted by motion noise are

B. Fundamental Period Extraction
The autocorrelation function C(t) preserves periodicity information of the input signal. When N samples of signal are
available, autocorrelation can be expressed as
N −1
1 
x1 (n)x1 (n + t)
C(t) =
N n =0

(17)

for N larger than period of C(t), Ta , where x1 (n) denotes PPG
signal at the adaptive noise canceler M 2 in Fig. 4, t is a lag value,
and n is discrete time. Both n and t are integers representing time
indices. The autocorrelation sequence has its maximum value at
lag zero and integer multiples of its fundamental period, Ta .
The autocorrelation-based method used for pitch detection in
speech signals [29] works well in the presence of additive noise.
Adopting and tuning this technique from speech processing,
we have developed a fundamental period estimator for PPG
biosensors shown in Fig. 6. It is assumed that the period stays
the same, i.e., the signal is stationary on each frame. The three
key steps involved in this technique are as follows.
1) The autocorrelation of PPG signal is computed, i.e., point
X in Fig. 6 (Window length of autocorrelation function is
1500 samples).
2) For each T in the limited range of the period, a window,
α1 δ(t − T ) + α2 δ(t − 2T ) + α3 δ(t − 3T ), is generated
(i.e., point Y in Fig. 6). Windows are multiplied with
autocorrelation function in time domain. This step results
in a modified autocorrelation function for each window in
point Z of Fig. 6 which is zero for all T’s except T, 2T ,
and 3T .
3) For all modified autocorrelations of step 2, summation
of the autocorrelation function is computed and the window passing maximum energy defines period and hence
fundamental period, Ta .
α1 , α2 , and α3 are empirically obtained as 1, 0.9, and 0.8,
respectively, to enhance the accuracy of period estimator and
prevent gross errors. The decreasing amplitude of window is
considered to reduce susceptibility to period doubling. The extracted fundamental period, Ta , is used in prediction error filter
to find the optimum β.

676

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

C. Updating Optimum β

Reference Pulse Oximeter
Reference ECG Sensor

After removing motion noise due to tissue effect and extracting fundamental period, Ta , two signals x1 and x2 in Fig. 4
associated with ΔAi and ΔAj are ready. Weighted subtraction
of these two signals with current βopt is used to form (7) as a reference noise for adaptive filters N1 and N2 in Fig. 4. Extracted
fundamental period is used in the linear predictor to generate
prediction error, e. The optimum β is updated using update rules
(13) and (15) for rv and α, respectively. This process is done
on a frame basis, and for each frame a new βopt is extracted.
βopt gives us the best noise reference, and consequently, the enhanced output signals contain only arterial component needed
to extract features such as SpO2 .
D. Signal Enhancement

Analog and Sampling
Finger Sensor

Fig. 7.

Units

Experimental setup used for data collection

V. EXPERIMENTAL SETUP

The time-variant βopt that provides the best estimation of
motion noise due to venous blood change is used to generate a
synthetic noise reference signal, the input I2 , in adaptive filters
N 1 and N 2 of Fig. 4. Since noise reference is provided for
adaptive noise cancelers N 1 and N 2, adaptive noise canceler
of Fig. 5(a) is used. The enhanced red and infrared signals can
be used for further feature extraction and monitoring purposes.
Dominant and high-power motion noise conceal the waveform
amplitude of arterial component when no enhancement algorithm is applied. The proposed technique provides clean signals
at the output preserving peak-to-peak value of the arterial signal
for amplitude analysis.
E. SpO2 and HR Extraction
One of the frequently used techniques for the measurement
of SpO2 in pulse oximetry is the ratio of ratios technique [23],
[25]. This technique extracts the dc and ac parts of the red and
IR PPG signals and computes the ratio of ratios, R, as
R=

Bluetooth Connection

Rac /Rdc
IRac /IRdc

(18)

where Rac and Rdc denote the magnitudes of the pulsatile and
the dc parts, respectively, of the PPG obtained at the red wavelength. Similarly, IRac and IRdc are the magnitudes of the pulsatile and dc portions of the IR PPG, respectively. SpO2 is then
calculated by employing the following empirical equation [18],
[25]:
SpO2 % = (K1 + K2 R)%

(19)

where K1 and K2 are constants empirically found and tuned for
a particular sensor platform.
In our algorithm, the fundamental period is actually the HR.
Therefore, the HR is calculated using result of “Fundamental
Period Extraction” unit in Fig. 4. However, once the clean signal
is obtained as the result of our algorithm in Fig (4), any available
HR extraction method in the literature can be applied based on
the application and the need.

A sensor platform is developed using a finger probe with red
LED and infrared LED working at 660 and 895 nm, respectively.
Analog conditioning circuit limits bandwidth of the signal to
70 Hz and it is acquired with sampling rate of 250 Hz using
battery powered TMS320C5515 Evaluation Module by Texas
Instrument [30]. Hamming window and a low-pass filter, with
cutoff frequency at 8 Hz, are implemented on TMS320C5515 in
order to attenuate the unwanted signals. The step size used for
updating the filter coefficient in adaptive noise cancelers M 1
and M 2 of Fig. 4 is 0.002, and for both N 1 and N 2, the step
size is 0.0008. Adaptive filters of the length 256 are used for M 1
and M 2 and length 1024 for N 1 and N 2 in Fig. 4. K1 and K2
for SpO2 computation [see (19)] is 105 and −23, respectively.
Institutional Review Board approved and volunteers consent
were obtained prior to experimentations.
For the performance evaluation, as shown in experimental
setup of Fig. 7, in addition to our sensor platform, participants
wore commercially available wireless ECG and SpO2 sensors
(BioHarness BT by Zepher Technologies and Onyx II, Model
9560 by Nonin Medical Inc.). The experiment was done on a
treadmill (Triumph 400T) to have control over speed and durations. To test and validate the proposed algorithm, PPG signal is
collected from different subjects doing various motions. Three
experimentations are designed to observe effect of motion artifact and quantify enhancement using objective and subjective
tests. Fig. 8(a) shows the red PPG signal collected when the user
worn the finger PPG sensor during first experiment to observe
effect of motion artifact. Motion types in this test are standing, up-down, and left-right motions of the hand with different
speed and acceleration, bending of the finger, walking, and running at different speeds. Six subjects between ages of 19–50
participated in the experimentation. For the objective test, an
experimentation was designed to validate the performance of
the algorithm during normal physical activities (standing, walking, and running). One participant, male 28 years old, did a
30-min exercise test. This exercise consisted of 5 min walking
at 1 m/h, 5 min walking at 2 m/h, 5 min walking at 3 m/h, 5 min
running at 4 m/h, 5 min running at 5 m/h, and then a 5 min cool
down. The cool down included 1 min running at 4 m/h, 1 min
walking at 3 m/h, 1 min walking at 2 m/h, and 1 min standing

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

677

Fig. 8. (a) Sample red PPG signal collected using our sensor system during different motion types and comparing original and enhanced signals. (b) Time
domain. (c) Autocorrelation. (d) Power spectrum. (e) HR. (f) SpO2 .

at rest. Six participants completed controlled subjective experiment by walking on the treadmill for 1.5 min at 2 m/h, then
running at the speed of 3.5 m/h for another 1.5 min, and finally
running for 2 min at 5 m/h.

0.8

Scaled Power

VI. EXPERIMENTAL RESULTS AND DISCUSSION

1

0.4

10
8
6
4
2
Time
0

0.2

A. Effect of Motion Artifact

0
6

4.8

3.6

2.4

1.2

0

(a)
0.7
0.6

Scaled Power

To see the effect of motion on the PPG signal, spectrogram of
the original [see Fig. 8(a)] and enhanced PPG signal are shown
in Fig. 9(a) and (b), respectively. The spectrogram is computed
using short-time fourier transform with window size of 2048,
overlap size of 1024 and 4096 point FFT. High-power noise
component which leads to inaccurate and unreliable computation of the HR and SpO2 can be clearly seen in the spectrogram
pictured in Fig. 9(a). The removal of high-power noise components can be seen in Fig. 9(b) which leads to restoration of the
true power of the signal. Harmonic enhancement can also be
observed which results in enhancement of the autocorrelation
function and reliable HR computation.
As an example, for the portion of the signal shown in Fig. 8(b),
motion artifact has changed the shape and periodicity of the signal. Fig. 8(c) depicts autocorrelation function of the original and
enhanced signal. The improvement of the autocorrelation can be
observed which enables us to have a reliable HR computation.

0.6

0.5
0.4
0.3
10
8
6
4
2
Time
0

0.2
0.1
0
6

4.8

3.6

2.4

1.2

0

(b)
Fig. 9. Spectrogram of the PPG signal. (a) Original [see Fig. 8(a)].
(b) Enhanced.

678

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

0

−1
514.4

40

20

1.96 sd

0

mean

−20

Difference

40
Difference

Amplitude

1

−1.96 sd

−40
516.4
Second

518.4

20
0
−20
−40

50
100
150
200
Average Heart Rate by ECG & PPG (bpm)

50
100
150
200
Average Heart Rate by ECG & PPG (bpm)

(b)

(c)

(a)

0

−1
514.4

50
1.96 sd
mean
−1.96 sd

0
−50

Heart Rate (bpm)

2
0
−2

516.4
Second

518.4

80

(d)
180
160
140
120
100
80
60

Difference

Difference

Amplitude

1

90
100
Average SpO2 (%)

110

80

(e)

Reference

Enhanced

1 mph

Original

2 mph

5

110

(f)

3 mph
5 mph

4 mph

0

90
100
Average SpO2 (%)

10

Cool Down

15
Minute (g)

20

25

30

15
Minute (h)

20

25

30

110
SpO2 (%)

Reference

Enhanced

Original

105
100
95
90

0

5

10

Fig. 10. (a) 5-s ECG waveform from reference ECG sensor. (b) Bland–Altman plot for original HR. (c) Bland–Altman plot for enhanced HR. (d) 5-s PPG signal
from our finger sensor. (e) Bland–Altman plot for original SpO2 . (f) Bland–Altman plot for enhanced SpO2 . (g) Comparison of HR from reference ECG sensor,
original signal, and enhanced signal. (h) Comparison of SpO2 from reference oximeter, original signals, and enhanced signals.

Fig. 8(d) shows the frequency content of original and enhanced
signals.
After reducing the effect of motion, HR and SpO2 are computed every 6 s (e.g., 1500 samples) with no overlap between
frames of data for original noisy signal of Fig. 8(a). The fundamental period extracted using algorithm of Fig. 6 is used for
computation of the HR. Fig. 8(e) shows the HR computed using
both original motion corrupted and enhanced signals (e.g., after
removal of tissue effect). As seen in Fig. 8(e), after enhancing
the signal, our method provides a robust HR computation. SpO2
computation is very sensitive to the motion. Fig. 8(f) shows the
SpO2 computed using original motion corrupted signal and enhanced signal. The SpO2 values extracted from original signal in
quite unreliable, while the enhanced signal (e.g., after removal
of tissue and venous effect) provides robust computation of the
SpO2 .
B. Performance Evaluation, Objective, and Subjective Tests
Fig. 10(a) and (d) shows portion of ECG and PPG signals,
respectively, collected using ECG sensor and our finger clip
PPG sensor during objective experiment. As shown, there is
a corresponding peak value for every QRS complex of ECG

waveform. Bland–Altman difference plots were used to analyze
the agreement between results from our algorithm and reference measurements. Limit of Agreement (LOA) in this analysis
is defined as average difference ±1.96 standard deviation of the
difference ([μ − 1.96σ, μ + 1.96σ]). 95% of all differences lies
inside the LOA. HR and SpO2 values are extracted every 6 s.
Three hundred pairs of HR measurement are obtained. Fig. 10(g)
depicts the reference, original, and enhanced HR. Fig. 10(b) and
(c) shows the agreement between HR before and after applying
our algorithm. Before applying the algorithm, in many cases,
the ratio of ratios fails to compute the SpO2 . This can be graphically seen in Fig. 10(h) in which the computed SpO2 is shown
for reference stationary sensor, original, and enhanced signal.
Fig. 10(b) and (c) shows the agreement between HR computed
using original and enhanced signals, respectively. Fig. 10(e)
and (f) shows the Bland–Altman plot for SpO2 computed using
original and enhanced signals, respectively.
Correlation coefficient is defined as the covariance of the
variables divided by their standard deviations. Correlation and
agreement analyses are compared in Table I. Much higher correlation and agreement are achieved after applying our algorithm
on the raw signal for SpO2 and HR. Correlation coefficient of
SpO2 measurement after applying our algorithm was 0.71 with

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

TABLE I
COMPARISON OF HR AND SpO2 ACHIEVED BEFORE AND AFTER ALGORITHM

0.91
0.99
0
0.1
0.73

Mean
Bias
−2.3
0.36
−1.8
−5.3
0.15

Mean Abs.
Bias
8.7
2.1
6.9
25.6
0.6

LOA

1.5
1.96 sd

6

[−23.5, 19.0]
[−5.3, 6.0]
[−26.5, 23.0]
[−54.3, 43.9]
[−1.3, 1.6]

1.96 sd

1

4

0.5

2
0

Difference

Heart Rate (Orig.)
Heart Rate (Enh.)
SpO2 (Orig./Eqn. (19))
SpO2 (Orig./DST)
SpO2 (Enh.)

Corr.

2

8

Difference

Parameters

10

679

mean

0

−2

−1

−4

−1.5
−1.96 sd

−2

−6
−1.96 sd

−8

−2.5
−3

−10
50
100
150
200
Average Heart Rate by ECG & PPG (bpm)

80

(a)
Fig. 12.

mean

−0.5

90
100
Average SpO2 (%)

110

(b)

Bland–Altman plots of HR and SpO2
TABLE II
EVALUATION ON MULTISUBJECT EXPERIMENT

Fig. 11. Power plot of DST in the presence of motion artifact. (A) No arterial
peak. (B) Arterial peak is small. (C) Increasing function with no arterial peak.
(D) Increasing function with an out-of-range arterial peak.

p-value, probability of getting a correlation as large as the one
obtained randomly, less than 0.00001. There is no correlation
between SpO2 computed before applying the algorithm due to
high-power noise component in the signal.
For the purpose of comparison, the DST algorithm is also implemented using an adaptive filter of order 32. Reference signals
are generated by sweeping SpO2 with step size of 0.01 from 0%
to 100%. SpO2 is computed by finding the right-most peak of
the power plot and results are summarized in Table I. There is a
low correlation between DST algorithm and the reference SpO2
measurements. Our proposed approach provides a more reliable
SpO2 reading with higher correlation. Fig. 11 shows some of
common errors in our experimentation where the DST algorithm
reports a false reading due to motion artifact. To observe the behavior of the output power plot, SpO2 is intentionally swept
in a larger range. The algorithm expects multiple peaks in the
range of 0–100% where the assumption is that the right-most
peak corresponds to arterial oxygen saturation. The amplitude
of the peak associated with arterial oxygen saturation is typically very small as shown in power plot B in Fig. 11. These
peaks can easily be affected and concealed by motion artifact
as shown in power plots A and B of Fig. 11 where there is no
peak related to arterial oxygen saturation on curve A. In power
plots C and D, not only the peaks are affected by motion artifact
but also the power curves are an increasing functions of SpO2
in the range 0–100%. To compare our algorithm versus DST

Parameters

Corr.

Heart Rate
SpO2

0.98
0.7

Mean
Bias
−0.57
−0.35

Mean Abs.
Bias
2.7
0.71

LOA
[−7.0, 5.9]
[−1.9, 1.2]

more specifically, we computed the correlation coefficient for
various levels of motions, i.e., [1 m/h, 3 m/h, 5 m/h]. The correlation coefficients for our algorithm were [0.85, 0.78, 0.64] and
for DST became [0.52, 0.09, 0.03], respectively. As expected,
our algorithm performs much better than DST for high level of
motion artifact.
Bland–Altman plots of Fig. 12(a) and (b) show results of
subjective experiment for HR and SpO2 measurements. A total
of 300 HR measurement pairs and 295 valid SpO2 readings are
computed after enhancement of the red and infrared signals. Results of this experimentation are summarized in Table II. These
results for multisubject experiment overall show high level of
agreement and correlation between reference measurement and
our algorithm.
C. Discussion on Special Cases and Limitations
In some application such as abnormal heart rhythms and large
Respiratory Sinus Arrhythmias (RSA), rapid changes in HR occur. For instance, RSA can modulate RR interval by 40–50%
over a respiratory cycle [31]. In the proposed algorithm, the
fundamental period is extracted using an autocorrelation-based
method after removal of tissue effect. The autocorrelation-based
method may result in a limited estimation error of fundamental
period in such applications when compared with beat-to-beat
HR. Also, batch algorithm derived for removal of venous component works on consecutive blocks of data with finite number
of samples to optimize the reference noise. These sources of
error might temporarily reduce quality of reference noise and
consequently the filtering in the second stage. There are no such
effects on the first stage of the algorithm where tissue effect

680

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 2, MARCH 2014

TABLE III
BEAT-TO-BEAT HR
Parameters

Error

Corr.

Orig. Clean BP
Noisy BP Signal
Enh. BP Signal

0.021
0.49
0.024

0.99
0.78
0.98

Mean
Bias
0
0.10
0

Mean Abs.
Bias
1.12
8.22
1.32

LOA
[−4.28, 4.28]
[−21.12, 21.24]
[−4.59, 4.59]

is removed. In order to observe sensitivity of filtering to rapid
changes of HR, we have extracted beat-to-beat HR after enhancing the noisy signal with second stage of the algorithm while
using autocorrelation-based fundamental period extractor and
update rule for βopt .
Due to high similarity of BP signal with PPG signal, we
have used BP signal from the MIT-BIH polysomnographic [32]
database (slp01a) to evaluate beat-to-beat HR. This database
includes BP and ECG signals. For evaluation purpose, reference
HR is derived from annotated ECG signal in database. BP signal
is standardized to have zero mean and unity variance. Noise is
artificially added to 1 h of clean BP signal and signals x1 and
x2 are generated according to (8) with ra = 0.9 and rv = 0.6
[typical optical density ratios in artery and vein; see also (7)].
The noise N (0, 1) is filtered with an FIR low-pass filter with
cutoff frequency of 8 Hz and multiplied by a gain factor to have
unity variance in x1 .
To extract the beat-to-beat HR from BP signal, a thresholdbased method is used which finds maximum point on the signal
in each cycle. BP signal is converted to frames of size 700
samples. For each new frame, the mean value is subtracted from
signal and a clipping level is extracted by computing a fixed percentage of the maximum amplitude of the signal in that frame.
The center clipped signal, the original signal minus the clipping
level, is extracted and a peak finder finds the location of the
peak value on center clipped waveform. Result are summarized
in Table III. The relative Error in Table III is used in [33] for
quantifying beat-to-beat HR and defined as


2
N 
1 
HR(j) − Ref (j)
(20)
Error = 
N j =1
Ref (j)
where N is the total number of beats, and HR and Ref are measured HR and the reference HR obtained from annotated ECG
signal in database, respectively. Our simulation on MIT-BIH
database shows that beat-to-beat HR can reliably be extracted
using our algorithm even though there is an estimation error in
fundamental period due to rapid changes of the HR. Due to rapid
changes in HR and high power of added noise, the thresholdbased method has poor performance in extracting HR from noisy
BP signal even though threshold is adaptively adjusted to have
the best result. There is a high correlation between beat-to-beat
HR from enhanced signal and reference beat-to-beat HR. To
further reduce the effect of rhythm irregularities on reference
noise in special applications, the algorithm can be tuned appropriately based on features that are supposed to be extracted
from the enhanced output signals for that particular application. For instance, the size of autocorrelation window can be
tuned based on the rate of changes of heart beat or it can be

replaced with available reliable beat-to-beat HR extractor. As
an example, Barros and Ohnishi [33] used RSA as a frequency
modulation occurring on the signal. This study proposed heart
instantaneous frequency with highly accurate estimation of the
beat-to-beat HR. More complex prediction filter with higher order and adaptability can also be deployed to reduce impact of
rhythm irregularities.
VII. CONCLUSION
In this paper, a novel adaptive algorithm was developed for
signal enhancement against motion artifact. The algorithm is
then used for robust extraction of HR and oxygen saturation in
wearable and portable PPG biosensors. We considered different
sources of error during body movement from optical theories
describing pulse oximetry optics. The problem was mathematically formulated, and at each stage of enhancement, a reference
signal was generated and utilized in NLMS adaptive filter. The
experimental results validated reliable extraction of HR and
oxygen saturation with correlation of more than 0.98 and 0.7,
respectively, compared to reference stationary sensors in the
presence of the motion artifact.
REFERENCES
[1] K. H. Shelley, “Photoplethysmography: Beyond the calculation of arterial
oxygen saturation and heart rate,” Anesth. Analg., vol. 105, no. 6, pp. S31–
S36, Dec. 2007.
[2] J. C. Dorlas and J. A. Nijboer, “Photo-electric plethysmography as a
monitoring device in anaesthesia. Application and interpretation,” Br. J.
Anaesth., vol. 57, pp. 524–530, 1985.
[3] V. F. Blanc, M. Haig, M. Troli, and B. Sauve, “Computerized photoplethysmography of the finger,” Can. J. Anaesth., vol. 40, pp. 271–278,
1993.
[4] A. Awad, M. A. Ghobashy, R. G. Stout, D. G. Silverman, and
K. H. Shelley, “How does the plethysmogram derived from the pulse
oximeter relate to arterial blood pressure in coronary artery bypass graft
patients?,” Anesth. Analg., vol. 93, pp. 1466–1471, 2001.
[5] B. Jonsson, C. Laurent, T. Skau, and L. G. Lindberg, “A new probe for ankle systolic pressure measurement using photoplethysmography (PPG),”
Ann. Biomed. Engl., vol. 33, pp. 232–239, 2005.
[6] P. A. Leonard, J. G. Douglas, N. R. Grubb, D. Clifton, P. S. Addison,
and J. N. Watson, “A fully automated algorithm for the determination of
respiratory rate from the photoplethysmogram,” J. Clin. Monit. Comput.,
vol. 20, pp. 33–36, 2006.
[7] L. Nilsson, A. Johansson, and S. Kalman, “Respiration can be monitored
by photoplethysmography with high sensitivity and specificity regardless of anaesthesia and ventilatory mode,” Acta Anaesth. Scand., vol. 49,
pp. 1157–1162, 2005.
[8] J. Y. Foo and S. J. Wilson, “Estimation of breathing interval from the
photoplethysmographic signals in children,” Physiol. Meas., vol. 26, no. 6,
pp. 1049–1058, 2005.
[9] P. Bonato, D. De Rossi, A. Dittmar, S. Jayaraman, I. Korhonen,
A. Lymberis, E. Mc Adams, and Y. Zhang, “IEEE EMBS technical committee on wearable biomedical sensors and systems: Position paper,” in
Proc. Int. Workshop Wearable Implantable Body Sensor Netw., 2006,
pp. 212–214.
[10] H. H. Asada, P. Shaltis, A. Reisner, S. Rhee, and R. C. Hutchinson, “Mobile monitoring with wearable photoplethysmographic biosensors,” IEEE
Eng. Med. Biol. Mag., vol. 22, no. 3, pp. 28–40, May/Jun. 2003.
[11] R. T. Brouillette, J. Lavergne, A. Leimanis, G. M. Nixon, S. Ladan, and
C. D. McGregor, “Differences in pulse oximetry technology can affect detection of sleep-disordered breathing in children,” Anesth. Analg., vol. 94,
pp. 47–53, 2002.
[12] C. G. Durbin and S. K. Rostow, “More reliable oximetry reduces the
frequency of arterial blood gas analyses and hastens oxygen weaning after
cardiac surgery: A prospective, randomized trial of the clinical impact of
a new technology,” Crit. Care Med., vol. 30, pp. 1735–1740, 2002.

YOUSEFI et al.: MOTION-TOLERANT ADAPTIVE ALGORITHM FOR WEARABLE PHOTOPLETHYSMOGRAPHIC BIOSENSORS

[13] B. Bohnhorst and C. F. Poets, “Major reduction in alarm frequency with
a new pulse oximeter,” Intens. Care Med., vol. 24, pp. 277–278, 1998.
[14] L. B. Wood and H. Asada, “Low variance adaptive filter for cancelling
motion artifact in wearable photoplethysmogram sensor signals,” in Proc.
Conf. IEEE Eng. Med. Biol. Soc., Aug. 2007, pp. 652–655.
[15] S. H. Kim, D. W. Ryoo, and C. Bae, “Adaptive noise cancellation using
accelerometers for the PPG signal from forehead,” in Proc. Conf. IEEE
Eng. Med. Biol. Soc., Aug. 2007, pp. 2564–2567.
[16] H. Han, M. J. Kim, and J. Kim, “Development of real-time motion artifact
reduction algorithm for a wearable photoplethysmography,” in Proc. Conf.
IEEE Eng. Med. Biol. Soc., Aug. 2007, pp. 1538–1541.
[17] H. H. Asada, H. Jiang, and P. Gibbs, “Active noise cancellation using
MEMS accelerometers for motion-tolerant wearable bio-sensors,” in Proc.
Conf. IEEE. Eng. Med. Biol. Soc., Sep. 2004, vol. 1, pp. 2157–2160.
[18] M. R. Ram, K. V. Madhav, E. H. Krishna, N. R. Komalla, and
K. A. Reddy, “A Novel approach for motion artifact reduction in PPG
signals based on AS-LMS adaptive filter,” IEEE Trans. Instrum. Meas.,
vol. 61, no. 5, pp. 1445–1457, May 2012.
[19] J. M. Goldman, M. T. Petterson, R. J. Kopotic, and S. J. Barker, “Masimo
signal extraction pulse oximetry,” J. Clin. Monit., vol. 16, pp. 475–483,
2000.
[20] J. M. Graybeal and M. T. Petterson, “Adaptive filtering and alternative calculations revolutionizes pulse oximetry sensitivity and specificity during
motion and low perfusion,” in Proc. IEEE Eng. Med. Biol. Soc., 2004,
vol. 7, pp. 5363–5366.
[21] Masimo Corp. (2012). Signal extraction technology. [Online]. Available:
http://www.masimo.com/pdf/whitepaper/LAB1035R.PDF
[22] R. Yousefi, M. Nourani, and I. Panahi, “Adaptive cancellation of motion
artifact in wearable biosensors,” in Proc. Int. Conf. IEEE Eng. Med. Biol.
Soc., Aug. 2012, pp. 2004–2008.
[23] J. E. Sinex, “Pulse oximetry: Principles and limitations,” Amer. J. Emerg.
Med., vol. 17, no. 1, pp. 59–68, Jan. 1999.
[24] K. A. Reddy, B. George, N. M. Mohan, and V. J. Kumar, “A novel
calibration-free method of measurement of oxygen saturation in arterial
blood,” IEEE Trans. Instrum. Meas., vol. 58, no. 5, pp. 1699–1705, May
2009.
[25] J. G. Webster, Design of Pulse Oximeters. New York, NY, USA: Taylor
& Francis, 1997.
[26] T. Aoyagi, M. Fuse, N. Kobayashi, K. Machida, and K. Miyasaka, “Multiwavelength pulse oximetry: Theory for the future,” Anesth. Analg.,
vol. 105, no. 6, pp. S53–S58, Dec. 2007.
[27] T. Aoyagi, “Pulse oximetry: Its invention, theory, and future,” J. Anesth.,
vol. 17, pp. 259–266, 2003.
[28] A. K. Barros and A. Cichocki, “Extraction of specific signals with temporal structure,” Neural Comput., vol. 13, no. 9, pp. 1995–2003, 2001.
[29] J. D. Wise, J. R. Caprio, and T. W. Parks, “Maximum likelihood pitch
estimation,” IEEE Trans. Acoust. Speech Signal Process., vol. 24, no. 5,
pp. 418–423, Oct. 1976.
[30] Texas Instrument Inc. (2013). [Online]. Available: http://www.ti.com/tool/
tmdxevm5515
[31] J. A. Hirsch and B. Bishop, “Respiratory sinus arrhythmia in humans:
How breathing pattern modulates heart rate,” Amer. J. Physiol., vol. 241,
no. 4, pp. 620–629, 1981.
[32] MIT-BIH Arrhythmia Database. (2013). [Online]. Available: www.
physionet.org/physiobank/database/mitdb
[33] A. K. Barros and N. Ohnishi, “Heart instantaneous frequency (HIF): An
alternative approach to extract heart rate variability,” IEEE Trans. Biomed.
Eng., vol. 48, no. 8, pp. 850–855, Aug. 2001.

Rasoul Yousefi (S’11) received the B.S. degree
in electrical engineering from Shiraz University,
Shiraz, Iran, and the M.Sc. degree in circuits and systems from the University of Tehran, Tehran, Iran, in
2006 and 2009, respectively. He is currently working
toward the Ph.D. degree in electrical engineering at
the University of Texas at Dallas, Richardson, USA.
His research interest includes digital circuits and
systems and signal processing with an emphasis on
medical devices and biomedical sensors. Since 2010,
he has been a member of SoC Design and Test laboratory and the QoLT laboratory, University of Texas at Dallas.
Mr. Yousefi is a student member of the IEEE Engineering in Medicine and
Biology Society.

681

Mehrdad Nourani (S’91–M’94–SM’05) received
the B.Sc. and M.Sc. degrees in electrical engineering from the University of Tehran, Tehran, Iran, and
the Ph.D. degree in computer engineering from Case
Western Reserve University, Cleveland, OH, USA.
He is currently a Professor of Electrical Engineering at the University of Texas at Dallas (UTD),
Richardson, USA. He is a Co-Founder of the Quality of Life Technology laboratory, UTD, where he
conducts an interdisciplinary research lab focused on
developing innovative technology and systems that
improve people’s quality of life. He has published more than 250 papers in journals and refereed conference proceedings. His current research interests include
fault-tolerant architectures, system-on-chip testing, design for reliability, and
special-purpose IC/system design for biomedical/biological applications.
Dr. Nourani is a recipient of multiple awards from Clark Foundation Research
Initiation Grant, National Science Foundation Career, Cisco Systems Inc., and
Semiconductor Research Corporation. He is a member of the IEEE Computer
Society and the ACM SIGDA.

Sarah Ostadabbas (S’11) received the B.Sc. degree
in both electrical and biomedical engineering from
Amirkabir University of Technology, Tehran, Iran, in
2005, and the M.Sc. degree in control engineering
from the Sharif University of Technology, Tehran,
in 2007. She is currently working toward the Ph.D.
degree in electrical engineering at the University of
Texas at Dallas, Richardson, USA.
Her research interests include embedded systems
and signal processing with an emphasis on medical/biological applications and modeling. A major
application of her research is the prevention of pressure ulcer formation and
amputation through predictive modeling and scheduling therapeutic care. She
is a member of the Quality of Life Technology Laboratory, University of Texas
at Dallas.
Ms. Ostadabbas is a student member of the IEEE Engineering in Medicine
and Biology Society and the IEEE Women in Engineering Society.

Issa Panahi (S’84–M’88–SM’07) received the M.Sc.
degree in electrical engineering from Florida Institute of Technology, Melbourne, Florida, USA and
the Ph.D. degree from the University of Colorado at
Boulder, Colorado, USA.
He is currently an Associate Professor of Electrical Engineering and also an Associate Research
Faculty of biomedical engineering at the University
of Texas at Dallas (UTD), Richardson, USA. He is
Founding Director of the Statistical Signal Processing and Acoustic Research Laboratories. His research
interests include audio/acoustic/speech signal processing, stimation, identification, source separation, and noise cancellation. He joined the faculty of UTD
after working in research centers and industry for 16 years. He was a DSP
Chief Architect, Chief Technology Officer, and Advance Systems Development
Manager in the embedded DSP systems business unit at Texas Instruments. He
holds one US patent and is author/co-author of four Texas Instruments books
and more than 80 technical journal and conference articles.
He was the Founder and Vice Chair of the IEEE-Dallas Chapter of the IEEE
Engineering in Medicine and Biology Society (EMBS). He is the Chair of the
IEEE Dallas Chapter of IEEE Signal Processing Society. He received the 2005
and the 2011 “Outstanding Service Award” from the IEEE Section. He was
an organizing member and Chair of the Plenary Sessions of the 2010 IEEE
International Conference on Acoustics, Speech, and Signal Processing. He has
been session organizer and chair of several tracks at EMBS conferences.

