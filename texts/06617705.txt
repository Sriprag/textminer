590

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Accurate Localization of In-Body Medical Implants
Based on Spatial Sparsity
Mohammad Pourhomayoun, Student Member, IEEE, Zhanpeng Jin∗ , Member, IEEE,
and Mark L. Fowler, Senior Member, IEEE

Abstract—Wearable and implantable wireless communication
devices have in recent years gained increasing attention for medical diagnostics and therapeutics. In particular, wireless capsule
endoscopy has become a popular method to visualize and diagnose
the human gastrointestinal tract. Estimating the exact position of
the capsule when each image is taken is a very critical issue in
capsule endoscopy. Several approaches have been developed by researchers to estimate the capsule location. However, some unique
challenges exist for in-body localization, such as the severe multipath issue caused by the boundaries of different organs, inconsistency of signal propagation velocity and path loss parameters
inside the human body, and the regulatory restrictions on using
high-bandwidth or high-power signals. In this paper, we propose a
novel localization method based on spatial sparsity. We directly estimate the location of the capsule without going through the usual
intermediate stage of first estimating time-of-arrival or receivedsignal strength, and then a second stage of estimating the location.
We demonstrate the accuracy of the proposed method through
extensive Monte Carlo simulations for radio frequency emission
signals within the required power and bandwidth range. The results show that the proposed method is effective and accurate, even
in massive multipath conditions.
Index Terms—Capsule endoscopy, medical implant, receivedsignal strength (RSS), sparsity, time of arrival (TOA).

I. INTRODUCTION AND BACKGROUND
IRELESS devices for medical diagnostics and therapeutics have gained increasing attention in the context
of quality healthcare. Implantable and wearable medical devices, such as pacemakers, smart pills, insulin pumps, body
sensors, and etc., have been playing significant roles in healthcare systems by capturing, transmitting, and controlling the vital information of patients. Recent advances in semiconductor
technology also enable designing smaller and cheaper wireless
medical devices that are more convenient to be worn outside

W

Manuscript received April 16, 2013; accepted September 29, 2013. Date of
publication October 2, 2013; date of current version January 16, 2014. Asterisk
indicates corresponding author.
M. Pourhomayoun was with the Department of Electrical and Computer
Engineering at the Binghamton University, and is now with the Wireless Health
Institute, University of California Los Angeles (UCLA), Los Angeles, CA 90095
USA (e-mail: mpourhoma@cs.ucla.edu).
∗ Z. Jin is with the Department of Electrical and Computer Engineering, and
the Department of Bioengineering, Binghamton University, State University of
New York, Binghamton, NY 13902-6000 USA (e-mail: zjin@binghamton.edu).
M. L. Fowler is with the Department of Electrical and Computer Engineering,
Binghamton University, State University of New York, Binghamton, NY 139026000 USA (e-mail: mfowler@binghamton.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2284271

or to be implanted inside a human body for special medical
interventions.
Recently, wireless capsule endoscopy (WCE) has become an
admired method and preferred technique to diagnose and visualize the human gastrointestinal (GI) tract [1]. WCE has many
advantages for physicians and patients compared to other inbody diagnostic methods because it is a noninvasive, highly
accurate, and portable procedure [1], [2]. Unlike traditional endoscopic methods, such as colonoscopy and gastroscopy which
can only reach the first or last several feet of the GI tract, WCE
is capable of visualizing the entire GI tract [3].
As a critical component of capsule endoscopic examination,
physicians need to know and recognize the precise position of
the endoscopic capsule when each image is taken during the
process of endoscopy. Thus, accurate capsule localization becomes essential in capsule endoscopy [1], [2] and has been
extensively investigated in the past few years [1]–[9]. Among
the different techniques that have been proposed for capsule positioning, radio frequency (RF)-signal based techniques have the
advantages of lower hardware costs and wider applicability (i.e.,
nonapplication specific) [1], [3]. The Medical Implant Communication Services (MICS) standard regulates the two-way
communications with medical implants to be in frequency band
401–406 MHz with the maximum transmitted power of 25 μW
and the maximum bandwidth of 300 kHz [2]. It is, therefore, desirable to pursue novel localization techniques that are effective
and accurate under these constraints.
The classic approaches to RF-based localization use a twostep estimation process to determine location. The first step is
to estimate one or more signal parameters that are related to
the transmitter position, such as received-signal strength (RSS),
time-of-arrival (TOA), or angle-of-arrival (AOA). The second
step uses these estimated parameters to subsequently estimate
the location. In the first step, the wireless implant plays the role
of a signal emitter by propagating an RF signal. The sensors
(mounted on the human body) receive the transmitted signals
(as shown in Fig. 1), and then the localization system uses the
received signals to estimate the location-dependent parameters
such as TOA or RSS. In the second step, the collection of the estimated parameters is used in statistical algorithms to determine
the best achievable estimate of the implants location.
There are two significant and unique challenges for the localization procedure inside a human body compared to the localization problems in other environments. The first challenge is
the immense RF signal absorption by body tissues that causes
a remarkable path loss. The second difference is the dependence of the signal propagation velocity on the specific tissue
layer that the signal is passing through. In our method, we

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

POURHOMAYOUN et al.: ACCURATE LOCALIZATION OF IN-BODY MEDICAL IMPLANTS BASED ON SPATIAL SPARSITY

Fig. 1. Examples of sensor configurations on body. (a) Capsule and sensors
configuration for three sensors. (b) Sensor array mounted on body surface or
inside a wearable jacket.

exploit these characteristics as location-dependent parameters
to achieve more accurate estimations.
It is important to note that the classic two-stage methods
are not necessarily optimal because in the first stage of these
methods, the parameter estimates are obtained by ignoring the
fact that all measurements should be consistent with a single
emitter location. In other words, each stage is itself optimal
but the cascade of the two stages is not necessarily optimal
[11]–[13].
In [14], we presented preliminary results for a twodimensional (2-D) positioning method based on spatial sparsity.
However, it suffers from various idealistic assumptions made
for the purpose of simplification and ease of implementation.
For example, in [14] the human body is assumed to be uniformly
made of only one tissue type. Consequently, a constant relative
permittivity and signal propagation velocity have been used for
the entire human body. The method presented in this paper overcomes that limitation of [14] by investigating a more realistic
body model consisting of multiple diverse tissue layers.
In this paper, we develop a novel one-stage tissue-adaptive
method based on both path loss and TOA, and considering the
tissue configuration and electrical characteristics changes in various tissues. We exploit the spatial sparsity of the emitter (implant) in a three-dimensional (3-D) space to estimate the emitters
position. We use convex optimization theory and 1 -norm minimization to estimate the emitter location directly without going
through the intermediate stage of TOA or path loss estimation.
Since the emitter location is estimated based on the original
received signals altogether, rather than the parameters derived
individually from each signal, the proposed method shows high
performance and accuracy in localization. Furthermore, the effect of multipath will be degraded in this method, because the
indirect signal reflections are usually not consistent with a single
location. Pushing the sparsity in a position domain also helps

591

to reduce multipath effect, and make the algorithm capable of
achieving accurate position estimations even in severe multipath
condition which is a serious problem in the localization of inbody implants due to the massive reflections from organ boundaries.
If we view the location of the emitter as a grid point in a
fine 2-D grid plane X–Y or a 3-D grid space X–Y–Z, then the
number of emitters (even if more than one is present) is much
smaller than the total number of grid points. Thus, by allocating a
nonzero value to each grid point containing an emitter (implant)
and allocating zeros to the rest of the grid points, we will thus
have a very sparse grid matrix that can be reshaped as a sparse
vector. Since each element of this sparse vector corresponds to
one grid point in the grid space, we can estimate the position
of the emitter by finding the positions of nonzero elements of
the sparsest vector that minimizes the error between predicted
received signals and actual received signals.
In principle, the sparsity of a vector can be enforced by
0 -norm minimization (where 0 -norm is defined as the number
of nonzero elements of the vector). However, since the 0 -norm
minimization is an NP-hard nonconvex optimization problem,
it is common to approximate that with 1 -norm minimization,
which is a convex optimization problem that obtains the sparse
solution very well [15]. Therefore, after formulating our localization problem in terms of the unknown sparse grid vector,
we estimate that vector by enforcing the sparsity on that using
1 -norm minimization, and at the same time minimizing the
cost between predicted received signals (that satisfy the delay
and signal strength relationship) and actual received signals by
forming a least-squares problem.
The performance and accuracy of the proposed method is
evaluated using Monte Carlo simulations in shadow fading distortion and massive multipath conditions. The results show that
the proposed technique can achieve a rather high accuracy of
localization and low processing time, even with small number of
receiver sensors and low signal-to-noise ratios; this provides a
significant advantage over traditional two-stage methods based
on TOA or RSS.
II. RELATED WORK
Conventional two-stage RF-based localization techniques
highly rely on the choice of location-dependent signal parameters (such as TOA, RSS, or AOA) and the accuracy of the parameter estimation in the first stage. Specifically, the TOA-based
methods are usually more accurate compared to the methods
based on AOA or RSS. In [2], the authors compare the classic
TOA-based methods [4] against the RSS-based methods for the
purpose of endoscopic capsule localization. The results demonstrate that the methods based on TOA achieve more accurate
location estimation compared to RSS-based ones. However, the
accuracy of classic TOA-based approaches usually suffers from
severe multipath conditions that are caused by signal reflections
at the boundaries of human body organs [4].
Since the human body includes various organs with different
types of tissues, the electrical characteristics of the entire body
such as the relative permittivity, power absorption, conductivity,

592

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

and path loss show vast heterogeneity. For instance, the signal
propagation velocity is expressed as a function of the relative
permittivity. Since the relative permittivity value varies according to the tissue type, the signal propagation speed and consequently the TOA highly depends on the specific tissue layers that
the signal passes through on the path from the implant (emitter)
to each sensor (receiver) [4]. The path-loss exponent and power
absorption parameter also depend on the tissue thickness [10].
This then requires the use of some prior information about the
implant (capsule) position in classic RSS-based methods.
Kawasaki and Kohno [4] proposed an iterative method based
on TOA estimation. In their approach, the tissue configuration of
the area of interest is acquired beforehand from the CT or MRI
system. Given this body model, the average relative permittivity
and signal propagation velocity are calculated. The TOAs are
also estimated using classic correlation methods. Then, in a second step, the estimated TOAs and the computed average relative
permittivity are used to estimate the approximate location of the
capsule by least-square techniques. In the following iteration,
the approximate position of the capsule is used to find a more
accurate relative permittivity, signal propagation velocity, and
finally, the more accurate position estimation. However, similar to other classic TOA-based methods, the TOA estimation
step suffers from severe multipath conditions. Moreover, in this
method, the ultrawideband (UWB) signals are used to attain
higher resolution in TOA estimation, which unfortunately are
not compliant with the MICS standard.
III. PROBLEM FORMULATION
A. Signal Model and Parameters
Suppose that the emitting capsule transmits an RF signal,
and L receiver sensors are employed to capture that signal. The
complex base-band signal received by the lth sensor is
rl (t) = αl s(t − τl ) + nl (t),

(1)

where s(t) is the transmitted signal, τl is the delay, nl (t) is a
complex, zero mean, white Gaussian noise, and αl represents
the signal path loss in addition to a phase shift. It can be written
as αl = βl ej ϕ l , where βl represents the real path loss, ϕl =
−2πfc τl is the constant phase, and fc is the carrier frequency
[16], [17]. The path loss model is given by [10]
PL(d) = PL(d0 ) + 10βlog 10 (d/d0 ) + S,

d ≥ d0

(2)

where PL(d) is the path loss in dB at distance d, PL(d0 ) is the
path loss at the reference distance d0 = 50 mm, S ∼ N (0, δs2 ) is
a Gaussian random variable representing the shadowing effect,
and β is the path loss exponent value [1], [10]. We have to note
that the term ej ϕ l = e−j 2π f c τ l includes important information
about the signal phase and delay. This information can be beneficial in location estimation, especially for narrowband signals
where it is difficult or impossible to estimate the delay from
the signal samples. Traditional TOA-based localization methods usually do not exploit the term ϕl = −2πfc τl in location
estimation, and that is why for narrowband signals (such as the
signals we use for in-body localization), the traditional methods fail to achieve accurate results. However, in the proposed

TABLE I
PATH LOSS PARAMETERS: IMPLANT TO BODY SURFACE MODEL

method, since we use the entire signal to estimate the location
directly, we take advantage of this term to achieve much more
accurate results.
Table I demonstrates the parameters for the path loss model
shown in (2). For instance, the implant in deep tissue will have
larger path loss, which is consistent with our intuitive sense. In
this model, a distance larger than 10 cm from body surface is
considered as deep tissue [3].
In free space, it is completely reasonable to assume that the
signal propagation velocity is constant. However, as mentioned
before, for in-body localization the propagation velocity varies
with the specific biological transmission media (i.e., tissues).
The propagation velocity v(ω) at frequency ω in a homogeneous
tissue layer is given by
v(ω) = 

c
εr (ω)

(3)

where c is the speed of light in free space and εr (ω) is the relative
permittivity of the tissue at frequency ω [4]. As we see in (3),
the relative permittivity depends on the frequency. However,
the curves and values of the relative permittivity in terms of
the frequency are available for various tissue types (such as fat,
muscle, bone, intestine, stomach, and etc.) [4], [18], [19]. We
can compute the overall delay and the equivalent propagation
velocity for the path where the signal is passing through as
follows [4]:
τ=

Nl


τi

i=1
l
√
d
ki εi
c i=1

N

=

veq = N l
i=1

ki =

di
d

c

√
ki εi
(4)

where εi is the relative permittivity of the ith tissue layer at
frequency of interest, Nl is the number of different tissue types
on the path (line-of-sight) from the capsule to the receiving
sensor, and ki is the length percentage of ith tissue layer on
the overall signal path. Obviously, ki is equal to the length of
a part of the signal path which is located within the ith tissue
(di ) divided by the total length of the overall signal path (d)
from the emitter to the sensor (line-of-sight). Similar to [4], we
assume that the approximate tissue configuration for the area of
interest (e.g., torso) is acquired beforehand from a CT or MRI
system [21]–[27]. Nonetheless, computing the length of di and
consequently the value of ki is challenging because the boundary
surfaces of tissues are not mathematically determined. We thus

POURHOMAYOUN et al.: ACCURATE LOCALIZATION OF IN-BODY MEDICAL IMPLANTS BASED ON SPATIAL SPARSITY

593

Fig. 2. Minimization over all grids p on the surface to find the minimum of
(L 1 + L 2 ) that corresponds to the intersection point I.

need to compute di as the length of a portion of the line-of-sight
that is limited between two boundary surfaces. To this end, we
seek an effective algorithm to find the intersections between the
line-of-sight and each of the tissue boundary surfaces.
We propose to find the intersection points between line-ofsight (passes through from the emitter to the sensor) and the
boundary surfaces by solving the minimization equation over
all grid points on each one of the boundary surfaces
I = arg min(L1 + L2 )

(5)

p

where L1 is the length of the line from the sensor to the grid
point p, L2 is the length of the line from grid point p to the
emitter (implant), and I is the intersection point. Fig. 2 shows
the minimization problem for one boundary surface.
After finding the intersection point that meets the minimization condition in (5) for each of the boundary surfaces, the length
di can be obtained for each tissue layer as the distance between
the two intersection points. After obtaining all di s for a specific
path, we are able to calculate the veq for that path using (4).
Fig. 3 shows an example configuration for three boundary
surfaces among various tissue layers (from two different views).
In this figure, the top surface is the skin, the middle surface is
the boundary between fat and muscle, and the third surface is
the boundary between muscle and stomach tissue.
B. Sparsity-Based In-Body Localization
Assume that each receiving sensor captures Ns signal samples
from the implant (emitter) at the sampling rate Fs = 1/Ts . Then,
we have
r l = αl D l s + nl

(6)

where s = [s(t1 ), s(t2 ), . . . , s(tN s )]T is the column vector containing Ns samples of the transmitted signal by the implant,
r l = [rl (t1 ), rl (t2 ), . . . , rl (tN s )]T is Ns samples of the received
signal by the lth sensor, nl is the noise samples vector, and

Fig. 3. An example of tissue configuration. The top surface is the skin, the
middle surface is the boundary between fat and muscle, and the third surface is
the boundary between muscle and stomach tissue. The red points on the body
skin are the sensors and the blue line is the line-of-sight from one of the sensors
to the emitter. I1 and I2 show the intersection points.

D l is the time sample shift operator by kl = (τl /Ts ) samples
where τl = (dl /veq,l ) is the delay. dl is the distance between
the implant and the lth sensor and veq,l is the average propagation velocity on the path from the implant to the lth sensor
derived from (4). We can express D l = D k l where D is an
Ns × Ns permutation matrix defined as [D]ij = 1 if i = j + 1,
[D]0,N −1 = 1 and [D]ij = 0 otherwise:
⎡

0 0

⎢1 0
⎢
D=⎢
⎢ .. ..
⎣. .
0 0

···
···
..
.
1

1

⎤

0⎥
⎥
.. ⎥
⎥,
.⎦
0

⎡

0

⎢1
⎢
Dl = ⎢
⎢ ..
⎣.
0

0 ···

1

⎤k l

0 ···
.. . .
.
.

0⎥
⎥
.. ⎥
⎥ . (7)
.⎦

0

0

1

594

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

To simplify the notations, we formalize the equations for 2-D
localization in the (X–Y) plane. It is easy to expand the equations
to the 3-D case.
Let ζx,y be a number corresponding to the grid point at (x, y),
where the value is 1 if the grid point (x, y) contains an emitter
and is zero if it does not. Thus, the signal samples vector received
by the lth sensor will be

ζx,y αl,x,y D l,x,y s + nl ,
(8)
rl =
x

y

where αl,x,y and D l,x,y are the path loss and sample shift operator with respect to sensor l assuming that the implant is located
in the grid point (x, y). The summations are over all grid points
in the (x, y) range of interest. Note that αl,x,y and D l,x,y are
known in (8) because the locations of each grid point (x,y) and
also the sensor l are known. Thus, we can compute the path loss
and the delay from (2) and (4), for the distance from the grid
point (x,y) to the sensor l. The unknown values ζx,y represent
which of the grid points contains the emitter (i.e., endoscopic
capsule).
If we rearrange the indices and form all of the grid points into
a column vector z = [ζ1 , ζ2 , . . . , ζN ]TN ×1 , then we have
rl =

N


ζn αl,n D l,n s + nl .

θ2

···

θ N ]L N s ×N

(12)

then we can express the received signals by all L sensors as
r =Θ×z+n
[r T1

r T2

(13)

r TN ]TL N s ×1

where r =
...
is the vector of all L
received signals, z = [ζ1 ζ2 · · · ζN ]TN ×1 is the unknown
sparse vector of ζ-values assigned to each grid point, and n is
the noise vector. Now, we can solve our localization problem
by estimating the vector z. To this end, we form a basis pursuit
with inequality constraints (BPIC) problem [20] as follows:

ẑ = arg min  z 1
(14)
s.t.  Θ × z − r 2 ≤ ε
or regularized basis pursuit denoising (BPDN) problem [20] as
(15)
ẑ = arg min  Θ × z − r 2 +λ  z 1

p
p
where  · p is the p -norm defined as  v p =
i |vi | , ε is
an appropriately chosen bound of noise magnitude, and λ is the
regularization parameter balancing the sparsity and estimation
cost.
IV. SIMULATION RESULTS

It is worth mentioning that the only difference between 3-D
and 2-D localizations is that the grid vector z (the vector of
unknown values assigned to grid points) will be longer in 3-D
case because it includes more number of grid points.
Now, we define the operator matrix Λn as the path loss and
delay operator with respect to all L sensors, assuming that the
emitter (implant) is located at the grid point n:
α2,n D T2,n

Θ = [θ 1

(9)

n =1

Λn = [ α1,n D T1,n

Now, if we arrange the vectors θ n (for all n ∈ {1, 2, . . . , N })
as the columns of the prediction matrix Θ, we will have

···

αL ,n D TL ,n ]N s ×L N s .
(10)
To generate Λn , we need to compute the delay and path loss
according to the path from grid point n to each one of the sensors.
To this end, we first use (5) and the minimizing approach on
each boundary surface to find the position of intersection points
between line-of-sight and boundary surfaces (demonstrated in
Figs. 2 and 3). Then, having the length of each part of the
line-of-sight, we can calculate the average velocity using (4),
and use it to compute the TOA and delay operator D (7) for
the path between the grid point n and each sensor. Notice that
the position of the grid point and sensors and, consequently,
the distance between them are known. However, we still do
not know which one of the grid points includes the capsule.
Similarly, we calculate the path loss α using (2) having the
distance d between grid point n to each one of the sensors.
Now, by applying the operator matrix Λn , we will define θ n ,
n ∈ {1, 2, . . . , N } as an LNs × 1 vector including all signal
samples received by all L sensors assuming that the emitter is
located in the grid point n,
θ n = ΛTn × s
where (.)T is the matrix transpose.

(11)

We evaluated the performance and accuracy of the proposed
method using Monte Carlo computer simulations in various scenarios. In the first scenario, we ran the simulation for various
numbers of receiving sensors (4, 8, 12, and 16 sensors) and
various SNR values (0, 10, and 20 dB) in multipath conditions.
The random variables S in (2) are generated with the parameters
available in Table I. In this simulation, the sensors are mounted
on the human body surface with the configuration shown in
Fig. 4. The locations of the implant and the reflector points have
been chosen randomly (the implant and reflector locations are
not necessarily on grid points. The term reflectors refer to the
points that reflect the transmitted signal and lead to multipath
problem. The signal reflection usually happens at boundaries
of organs). In this simulation, the signals are BPSK modulated,
with frequency of 406 MHz and bandwidth of 300 kHz which
is compliant with the MICS standard. Each sensor collects only
128 signal samples and the grid size is (20 × 20) cm with spacing of 0.5 cm.
We implemented and ran this simulation using MATLAB on
a computer with a 2.1 GHz dual core CPU and 4 GB RAM. It
took about 10 s for each run with 16 sensors and about 3 s for
each run with four sensors. However, the standard MATLAB
environment is not well suited to real-time computing so much
shorter times would be achievable using a real-time computing
environment.
Fig. 5 shows the RMS errors in X and Y directions versus
number of sensors for capsule localization in the (x, y) plane, as
well as the overall RMS error defined in (16), according to the
sensor topologies shown in Fig. 4. Consistent with our expectation, the accuracy is dramatically improved by increasing the
number of the sensors. Meanwhile, the results demonstrate that

POURHOMAYOUN et al.: ACCURATE LOCALIZATION OF IN-BODY MEDICAL IMPLANTS BASED ON SPATIAL SPARSITY

595

Fig. 4. Sensors location and configuration on the body skin for 4, 8, 12, and
16 sensors. (The scale units are in centimeter.)

Fig. 6. Sample tissue configuration (units are in cm). (a) Perfectly known
boundaries. (b) Approximately known boundaries generated by adding unknown
random noise to the boundary surfaces.

Fig. 5. RMS error versus number of sensors for three cases: SNR = 0 dB,
SNR = 10 dB, and SNR = 20 dB. (a) RMS error for X and Y dimensions.
(b) Overall RMS error.

the proposed method can achieve a very high performance even
for the low SNR cases. It is worth mentioning that it is even
possible to achieve higher accuracy by increasing the number
of observed signal samples and using finer grids (reducing the
grid point size).

Comparing the results with other RF-based methods shows
the high positioning accuracy of the proposed method. For example, the classic TOA-based method proposed in [4], despite
using the UWB signal (which is not compliant with the MICS
standards), has found more than 10 cm RMS error for SNR =
0 and 10 dB, and around 1.5 cm RMS error for SNR = 20 dB
in the best cases. As another example, the classic RSS-based
method in [3] has found around 7 cm RMS error using 16 receiver sensors, and 5 cm RMS error in the case when they use
32 receiver sensors.

596

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Fig. 7. Overall RMS error versus SNR using 16 sensors for two cases:
1) perfectly known boundaries, 2) approximately known boundaries generated
by adding unknown random noise to the boundary surfaces.

In the second scenario, we examined the performance of the
proposed method in the case when the body tissue configuration
is not exactly known and there are some levels of uncertainties on
the tissue configuration and tissue boundaries. Fig. 6 shows an
example when the signal (emitted by the implant) travels through
three different layers to reach the external sensors. Fig. 6(a)
shows the case when the tissue configuration is exactly known
and 6(b) illustrates the case when some levels of uncertainty of
tissue boundaries exist. To emulate such uncertainty, we added
unknown random noises to the simulated, exactly determined
tissue boundaries.
The implant localization results are shown in Fig. 7. The
overall localization error is less than 8.8 mm when the tissue
configuration is exactly known and less than 7.5 mm (in the
worst case) for underdetermined tissue boundaries. It is worth
highlighting that a boundary variation level of 5 mm only increased the localization error by about 1 mm.
In the third scenario, we used 16 sensors to estimate the 3-D
location of a moving endoscopy capsule in a 3-D space. We
used a noisy BPSK signal with frequency of 406 MHz and
bandwidth of 300 kHz and SNR=20 dB. In this simulation, we
also simulated the multipath condition (signal reflections from
tissue boundaries) using reflector points at randomly chosen
locations.
Fig. 8(a) demonstrates the sample implant trajectory (in blue),
and the estimated position by the proposed method (in red).
In this simulation, we assume that the capsule moves on the
path shown in Fig. 8(a), starting from the point (0, 0.05, 0) in
X–Y–Z space. Note that Fig. 8(a) is a sample trajectory used to
demonstrate that the proposed method is capable of estimating
the implant position in 3-D space. However, it is not necessarily a real endoscopic capsule trajectory inside the stomach
or intestine. In this simulation, we used the tissue configuration
shown in Fig. 3 including three different tissues (small intestine,
muscle, fat). Also, note that the position of the implant is not
necessarily on the grid points. In this case, the algorithm finds
the nearest grid point to the implant location. Fig. 8(b) shows
the overall RMS error in positioning defined as

e=

e2x + e2y + e2z

(16)

Fig. 8. Simulated trajectory of the capsule versus the estimated positions.
(a) Actual trajectory of the endoscopic capsule (in blue) and the estimated
position (in red). (b) Error in positioning for each location in part (a).

where e2x , e2y , and e2z are the RMS errors of positioning in X, Y,
and Z dimensions. It is shown that the positioning error is less
than 7 mm in the worst case.
V. CONCLUSION
WCE has become an admired method and preferred technique to diagnose and visualize the human GI tract. Accurate
estimation of the capsules position is one of the most critical
steps in the process of capsule endoscopy, because the physicians must accurately determine the focus and scope of disease
if any, relying on the exact position of the capsule in the endoscopy process. In this paper, we develop an effective method
to estimate the position of the wireless endoscopic capsule using
both RSS and TOA based on sparsity of the capsule (emitter) in
3-D space. Some unique challenges exist for in-body localization of a medical implant due to the complex nature within the
human body, such as the dependence of the propagation velocity on type of the tissues, the dependence of the parameters of

POURHOMAYOUN et al.: ACCURATE LOCALIZATION OF IN-BODY MEDICAL IMPLANTS BASED ON SPATIAL SPARSITY

the path loss model on tissue thickness (deep or near surface),
and the multipath problem caused by signal reflections at organ boundaries. Furthermore, the safety restrictions on signal
power and bandwidth with regard to the protection of human
health also make it more difficult to achieve accurate implant
location estimation.
In this paper, we developed a novel tissue-adaptive method
by considering both signal propagation velocity and path loss
exponent as location-dependent parameters that can be exploited
to estimate the implant (i.e., endoscopic capsule) location more
precisely. Unlike the classic methods, we directly estimate the
implant location without going through the intermediate stage
of RSS or TOA estimations. In this method, we estimate the
weighted average of the signal propagation velocity as well as
the path loss model parameters for the path from each one of
the grid points to the receiving sensors. After formulating the
localization model in terms of the unknown sparse grid vector,
we estimate that vector by enforcing the sparsity, and at the same
time minimizing the cost between predicted received signals and
actual received signals by forming a BPIC or BPDN problem.
The performance and accuracy of the proposed method were
evaluated using various computer simulations under different
scenarios including 2-D and 3-D localizations for various capsule positions, various numbers of receiving sensors, and different SNRs (with 500 runs each time). The results demonstrate
that the proposed method is very accurate in location estimation even when we use a small number of sensors (only four
sensors) and a small number of signal samples (only 64 signal
samples). Furthermore, the system shows robust operations and
high performance in noisy environments (low SNRs). It means
that we are able to achieve high localization accuracy even with
very low wireless transmitted power which helps to reduce the
size of the implant device, increase the implants battery life, and
also reduce the risk of interfering with other users of the same
band.
REFERENCES
[1] Y. Wang, R. Fu, Y. Ye, U. Khan, and K. Pahlavan, “Performance bounds
for RF positioning of endoscopy camera capsules,” in Proc. IEEE Top.
Conf. Biomed. Wireless Technol., Netw., Sens. Syst., Jan. 2011, pp. 71–74.
[2] U. Khan, K. Pahlavan, and S. Makarov, “Comparison of TOA and RSS
based technologies for RF localization inside human tissue,” in Proc. IEEE
Annu. Int. Conf. Eng. Med. Biol. Soc., Aug. 2011, pp. 5602–5607.
[3] Y. Ye, U. Khan, N. Alsindi, R. Fu, and K. Pahlavan, “On the accuracy
of RF positioning in multi-capsule endoscopy,” in Proc. IEEE 22nd Int.
Symp. Pers. Indoor Mobile Radio Commun., Sep. 2011, pp. 2173–2177.
[4] M. Kawasaki and R. Kohno, “A TOA based positioning technique of medical implanted devices,” in Proc. Int. Symp. Med. Inf. Commun. Technol.
(ISMICT), Feb. 2009, pp. 1–5, no. 1D01.
[5] K. Arshak and F. Adepoju, “Adaptive linearized methods for tracking a
moving telemetry capsule,” in Proc. IEEE Int. Symp. Ind. Electron., Jun.
2007, pp. 2703–2708.
[6] J. Lee, J. Oh, S. K. Shah, X. Yuan, and S. J. Tang, “Automatic classification
of digestive organs in wireless capsule endoscopy videos,” in Proc. ACM
Symp. Appl. Comput., Mar. 2007, pp. 1041–1045.

597

[7] A. Glukhovsky, M. Frisch, and D. Levy, “Array system and method for
locating an in vivo signal source,” U.S. Patent 7618366, Nov. 2009.
[8] D. Fischer, R. Schreiber, D. Levi, and R. Eliakim, “Capsule endoscopy:
The localization system,” Gastrointest. Endosc. Clin. North Amer., vol. 14,
no. 1, pp. 25–31, Jan. 2004.
[9] J. Bulat, K. Duda, M. Duplaga, R. Fraczek, A. Skalski, M. Socha, P. Turcza,
and T. P. Zielinski, “Data processing tasks in wireless GI endoscopy:
Image-based capsule localization & navigation and video compression,”
in Proc. IEEE Int. Conf. Engr. Med. Biol. Soc., Aug. 2007, pp. 2815–2818.
[10] K. Sayrafian-Pour, W.-B. Yang, J. Hagedorn, J. Terrill, and
K. Y. Yazdandoost, “A statistical path loss model for medical implant
communication channels,” in Proc. IEEE. Int. Symp. Pers. Indoor Mobile
Radio Commun., Sep. 2009, pp. 2995–2999.
[11] A. Weiss, “Direct position determination of narrowband radio frequency
transmitters,” IEEE Trans. Signal Process., vol. 11, no. 5, pp. 513–516,
May 2004.
[12] A. Amar and A. Weiss, “Localization of narrowband radio emitters based
on Doppler frequency shifts,” IEEE Trans. Signal Process., vol. 56, no. 11,
pp. 5500–5508, Aug. 2008.
[13] N. Vankayalapati and S. Kay, “Asymptotically optimal localization of an
emitter of low probability of intercept signals using distributed sensors,”
IEEE Trans. Aerosp. Electron. Syst., vol. 48, no. 1, Jan. 2012.
[14] M. Pourhomayoun, M. Fowler, and Z. Jin, “A novel method for medical
implant in-body localization,” in IEEE Proc. Int. Conf. Eng. Med. Biol.
Soc. (EMBC), Aug. 2012, pp. 5757–5760.
[15] R. G. Baraniuk, “Compressive sensing,” IEEE Signal Process. Mag., vol.
24, no. 4, pp. 118–121, Jul. 2007.
[16] R. E. Blahut, “Theory of remote surveillance algorithms,” Inst. Math.
Appl., vol. 32, no. 1, pp. 1–65, 1991.
[17] M. Pourhomayoun and M. Fowler, “Exploiting cross ambiguity function
properties for data compression in emitter location systems,” in Proc. 45th
Annu. Conf. Inf. Sci. Syst., Mar. 2011, pp. 1–5.
[18] C. Gabriel, “Compilation of the dielectric properties of body tissues at RF
and microwave frequencies,” Armstrong Laboratory, Brooks Air Force
Base, Arlington, TX, USA, Tech. Rep. AL/OE-TR-1996-0004, Jan. 1996.
[19] C. Gabriel, S. Gabriel, and E. Corthout, “The dielectric properties of
biological tissues: I. Literature survey,” Phys. Med. Biol., vol. 41, no. 11,
pp. 2231–2249, 1996.
[20] M. F. Duarte and Y. C. Eldar, “Structured compressed sensing: From theory to applications,” IEEE Trans. Signal Process., vol. 59, no. 9, pp. 4053–
4085, Sep. 2011.
[21] A. Patel and K. Mehta, “3D modeling and rendering of 2D medical image,”
in Proc. Int. Conf. Commun. Syst. Netw. Technol., 2012, pp. 149–152.
[22] H. Wang, F. Luo, and J. Jiang, “3D reconstruction of CT images based
on isosurface construction,” in Proc. Int. Conf. Intell. Comput. Technol.
Autom., 2008, pp. 55–59.
[23] S. Zachow, M. Zilske, and H.-C. Hege, 3D Reconstruction of Individual
Anatomy from Medical Image Data.. Berlin, Germany: Konrad-ZuseZentrum fr Informationstechnik, 2007.
[24] S. Wesarg and M. Kirschner, “3D visualization of medical image data
employing 2D histograms,” in Proc. Int. Conf. Vis., 2009, pp. 153–158.
[25] H. Wang, “Three-dimensional medical CT image reconstruction,” in Proc.
Int. Conf. Meas. Technol. Mechatron. Autom., 2009, pp. 548–551.
[26] F. Cordier and N. M. Thalmann, “Comparison of two techniques for organ reconstruction using visible human dataset,” in Proc. Visible Human
Project Conf., 1998, pp. 1–11.
[27] Y. Huang, Z. Qiu, and Z. Song, “3D reconstruction and visualization from
2D CT images,” in Proc. Int. Symp. IT Med. Educ., Dec. 2011, vol. 2,
pp. 153–157.

Authors’ photographs and biographies not available at the time of publication.

