290

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Intelligent Closed-Loop Insulin Delivery
Systems for ICU Patients
Youqing Wang, Senior Member, IEEE, Hongzhi Xie, Xu Jiang, and Bo Liu

Abstract—Good glycemic control through insulin administration among intensive care unit (ICU) patients can reduce mortality
significantly; however, it remains a big challenge because of scarcity
of individualized models for ICU patients. To deal with this challenge, a new combination of particle swarm optimization (PSO)
and model predictive control (MPC) has been proposed to identify the model online as well as to optimally design the input, i.e.,
the insulin delivery rate automatically. According to the population distribution, ten typical linear dynamic models were selected
such that any patient’s model could be approximated by a linear
combination of these ten typical models. PSO was used to update
the weight coefficients while MPC was used to design the insulin
delivery rate based on the combination model identified by using
PSO. The proposed strategy was compared with the Yale protocol
on 30 virtual subjects. According to the control-variability grid
analysis, the percentage values in A + B zone were, respectively,
100% under the proposed strategy and while 51% under the Yale
protocol, which demonstrates the superior performance of the proposed strategy. As a good candidate for the full closed-loop insulin
delivery method, this new combination can control the glucose level
by bringing it to a safe range promptly thereby reducing the risk
of death.
Index Terms—Automatic insulin delivery, intensive care unit
(ICU), model predictive control (MPC), particle swarm optimization (PSO).

I. INTRODUCTION
RITICALLY ill patients often suffer from stress-induced
hyperglycemia and insulin resistance, even without diabetes mellitus. Unlike a basal glucose concentration of about
70–110 mg/dL for a healthy individual, a critically ill patient
suffering from stress hyperglycemia often have blood glucose
concentrations higher than 200 mg/dL [1], [2]. Stress-induced
hyperglycemia can induce stroke, sepsis, multiple-organ failure,
trauma, and even death. A prospective, randomized, controlled

C

Manuscript received December 9, 2012; revised April 29, 2013; accepted June
10, 2013. Date of publication June 18, 2013; date of current version December
31, 2013. This work was supported in part by the National Natural Science
Foundation of China under Grant 61074081 and Grant 71101139, in part by the
Doctoral Fund of Ministry of Education of China under Grant 20100010120011,
in part by the Beijing Nova Program 2011025, and in part by the Fok Ying-Tong
Education Foundation under Grant 131060.
Y. Wang, H. Xie, and X. Jiang are with the College of Information Science and Technology, Beijing University of Chemical Technology, Beijing
100029, China (e-mail: wang.youqing@ieee.org; Xiehongzhi1989@163.com;
2010000787@grad.buct.edu.cn).
B. Liu is with the Center for Forecasting Science, Academy of Mathematics
and Systems Science, Chinese Academy of Sciences, Beijing 100864, China.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2269699

study from Leuven, Belgium demonstrated that the normalization of blood glucose level using an intensive insulin infusion
protocol (IIP) improved clinical outcome of patients in a surgical
intensive care unit [3]. In that study, intensive insulin therapy to
maintain blood glucose levels less than 110 mg/dL reduced cardiac surgical ICU patient mortality by up to 45%. There is clear
clinical evidence that lowering glucose concentrations with tight
control offers increased benefits in terms of reducing mortality
and reductions in other measurable clinical outcomes, and is far
superior to some current practice of tolerating a level of hyperglycemia among patients admitted in the ICU [1]. Therefore,
in clinical practice, it is valuable to find a method to reduce
the blood glucose concentrations of ICU patients efficiently and
thereby maintain them within the safe range.
Many hospitals use table lookup or paper-based protocols to
assist ICU nurses to administer intravenous insulin infusions
based on the patient’s current and previous glucose measurements. These protocols require the nursing staff to accurately
take repeated blood glucose (BG) measurements according to
the recommended protocols. Furthermore, severe hypoglycemia
can result as a consequence of increased insulin administration
and such errors can have dramatic adverse effects, such as coma
and even death. Computer-based methods have been developed
to enable more complex protocols for insulin adjustment to be
used. Indeed, the implementation of simple protocols within an
automated computer-based environment can reduce the nurses’
workload and the error rate of such paper-based protocols. That
is why it is receiving increasing attention by physicians and endocrinologists [2], [4]–[8]. However, finding a universal method
for glycemic control in the ICU remains a big challenge because
most patients admitted to the ICU are unconscious and very little
prior information may be available [6]. To deal with this challenge, an intelligent glycemic control strategy based on particle
swarm optimization (PSO) and model predictive control (MPC)
is being proposed in this study. The proposed combination integrates the optimization ability of PSO to identify the patients’
models online and the robust tuning ability of MPC to design
the insulin infusion speed automatically based on the identified
individualized model.
For an ICU patient, there is generally no set individualized
model at the beginning. However, as in-patient time increases,
more and more input and output data are obtained, which can
be used to identify model parameters for the patient. Furthermore, even though the specific model of the current patient is
unknown, there are numbers of individualized models available
from the database for previous patients. Therefore, a novel way
was proposed in this study for identifying model parameters of
a new patient. First, a library of typical models was obtained

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

WANG et al.: INTELLIGENT CLOSED-LOOP INSULIN DELIVERY SYSTEMS FOR ICU PATIENTS

according to the population distribution of patients admitted to
the ICU. Second, an individualized model for a new treated
patient was considered a linear combination of the typical models. Then, identifying parameters of an individualized model
equals to finding the optimal coefficients for the combination
model, which is in fact an optimization problem. To solve this
optimization problem, PSO might be a good candidate.
Compared with traditional online identification methods, e.g.,
the recursive least-squares method [9], the proposed PSO-based
identification method has some advantages: first, those clinical
data from previous patients can be exploited and utilized sufficiently, while traditional methods did not use those important
information; second, the proposed combination model could
guarantee that the identified model had a suitable physiological
range, while traditional methods often get ill model, e.g., the
ARX model which is identified by using the recursive leastsquares method is not in the physiological range in the first
couple hours [6].
PSO is an evolutionary computation technology developed by
Kennedy and Eberhart in 1995 [10]. It originated from a simulation of a simplified foraging behavior of bird swarm. The basic
idea was to find optimal solutions through the collaboration and
sharing of information among individuals in the group [11]. In
PSO, a set of agents (feasible solutions) are initialized in the
solution space. These agents search for the optimal solution of a
problem by recalling and following the current optimal particle
and continuously updating their own positions and speeds. PSO
has the advantages of fast convergence, easily realizing, and
only having a few parameters to adjust. Besides, it also has a
profound intelligence background, which makes it suitable for
both scientific research and engineering application [12], [13].
Therefore, PSO has become a new research hotspot in the field
of intelligent optimization and evolutionary computation since it
was proposed. At present, PSO has been put into use in various
areas, such as objective function optimization, dynamic environment optimization, neural network training, fuzzy control
system, etc.
For BG control, the designed control system must satisfy
constraints on both plasma glucose levels and insulin delivery rates. MPC may be the most suitable approach to design
control systems in the presence of nonlinearities, delays, and
constraints, due to its superior abilities in dealing with these
challenges [14]–[17]. Basic MPC formulations can be solved
analytically and in some situations are equivalent to classical
proportional- integral-derivative (PID) controllers [18]. MPC
has been used previously for glycemia control. Because of the
clinical disturbances, such as meals, the glucose level controlled
by MPC is not flat enough if the set-point is fixed to be the target.
For the application of MPC strategies to BG control, the reader
is referred elsewhere [16]–[20].
To our knowledge, in all reported combinations of PSO and
MPC in the literature [21], [22], PSO was used to optimize the
cost function of MPC online. In those studies, the prediction
models are all assumed to be available; however, this assumption is not true for ICU glycemic control. Therefore, this paper
proposes a dual-framework by integrating PSO and MPC, in
which, PSO is used in the outer loop to do identification and to

291

get the better models for MPC; based on the identified model,
an MPC controller is designed in the inner loop to adjust the
insulin infusion rate directly.
The proposed method has been tested on 30 virtual subjects.
The glucose level could be controlled under 180 mg/dL in less
than 6 h for all subjects; after 10 h, glucose concentrations
were between 70 and 130 mg/dL for all subjects. The simulation results demonstrated that this control strategy has good
control performance, which can effectively reduce the virtual
subjects’ BG into safe range in a short period of time without
hypoglycemic events.
II. PRELIMINARY KNOWLEDGE
A. Critically Ill Patient Metabolism Model
The effectiveness of the proposed control strategy is evaluated
in silico on a metabolism model for critically ill patients, which
was proposed and validated by Hovorka et al. [23]. This model
is used to describe glucoregulation of a critically ill patient irrespective whether diabetes was diagnosed prior to the ICU admission. This model is semi-physiological and semi-empirical, and
it represents the effects of nutrients and subcutaneous insulin
on BG. It consists of five submodels dealing with endogenous
insulin secretion, insulin kinetics, enteral glucose absorption, insulin action, and glucose kinetics, respectively [24]. The whole
model takes the intravenous insulin infusion and the carbohydrate content of parenteral and enteral nutrition as inputs; it
provides the BG concentration as an output. The basal insulin
concentration, a time-variant parameter, represents the temporal variation of insulin sensitivity and corresponds to the plasma
insulin concentration necessary to maintain euglycemia. This
comprehensive glucoregulation model comprises 15 equations
with 32 patient-dependent parameters [23]–[25]. All parameters of the model have been described about their corresponding
physical significance, and each parameter was drawn from a
univariate informed probability distribution. In conclusion, this
metabolism model has been developed to create a population
of virtual critically ill patients facilitating in silico testing of
closed-loop controllers.
B. Yale Insulin Protocol
Among all kinds of paper-based protocols that have been
proposed for BG control in critically ill patients [26], the Yale
protocol was selected to compare the proposed method in this
paper. The Yale IIP is one of the most popular currently available IIP, with a chief objective to normalize the BG level within
the conservative target range of 110–139 mg/dL, while avoiding
a specified hypoglycemic threshold of 70 mg/dL [6], [27]. The
efficacy and safety of the Yale protocol have been demonstrated
in patients of the Yale New Haven Hospital, US [27], [28]. In
designing the protocol, three data elements are used by experienced endocrinologists to adjust intravenous insulin infusions:
(1) the current BG value, (2) the previous BG value, and (3)
the current insulin infusion rate. That means this IIP was based
primarily on the velocity of glycemic change, rather than on
absolute BG levels [29]. In the Yale protocol, the IPP consists

292

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

TABLE I
PERFORMANCE METRICS OF PSO–MPC IMPLEMENTED ON THE STANDARD SUBJECT IN VARIOUS SITUATIONS

of two steps based on blood samples taken every 1 or 2 h, depending on the variability of the BG values. First, the nurse
determines the current BG value and its rate of change based
on the last two values, and then nurse administers the change of
intravenous insulin infusion rate based on the recommendations
in a look-up table [6], [28]–[30].
III. PROPOSED INTENSIVE INSULIN INFUSION THERAPY
To our best knowledge, existing literature regarding the combination of PSO and MPC generally used PSO to solve the cost
function optimization problem for MPC [21], [22]. While this
paper combines the optimization ability of PSO with MPC, a
search for the best model of MPC is needed to design the control
signal [31].
A. Model Predictive Control
For tight BG control, the designed control system must satisfy
constraints on both BG levels and insulin delivery rates. MPC
may be the most suitable approach to design control systems in
the presence of delays and constraints [17].
Models offer the chance to create patient-specific drug delivery, as model parameters can be fit to observed or measured
behavior [32]. MPC is a class of computer control algorithms,
which utilize an explicit process model to predict the future
response of the controlled plant [14]. MPC is based on the receding horizon philosophy, and the key algorithmic components
of MPC include a prediction model, cost function, and receding
horizon optimization. At each sampling step, an optimal control
problem is solved starting with the current state over a finite
horizon. At the next sampling time, the computation is repeated
starting the new state and over a shifted horizon, leading to a
receding horizon optimization policy [15], [16], [18], [33].
An ARX model is used to approximate the relationship between insulin delivery rate and glucose level, as shown here:
A(z −1 )y(t) = B(z −1 )u(t − nd)

(1)

where z −1 is the backward shift operator; nd is the time delay;
y(t) is the output, particularly BG values in this study; u(t) is
the input, particularly insulin delivery rate in this study.

Fig. 1.

Illustration of model predictive control.

Based on the ARX model in (1), the output prediction y(t +
nd + j|t) can be obtained for any designed control sequence
u(t + i|t) over a prediction horizon, which is shown in Fig. 1.
The cost function of MPC is given as follows:
J=

N


α1 [y(t + nd + j|t) − yr (t + nd + j)]2

j =0

+

M


[α2 (u(t + i|t))2 + α3 (Δu(t + i|t))2 ]

(2)

i=0

where integers N and M (N > M ) are referred to, respectively, as the prediction horizon and control horizon, respectively; weights α1 , α2 , and α3 adjust the relative importance
of tracking error suppression, input penalty, and input variation penalty, respectively; yr (t) is the setpoint for MPC. Cost
function (2) is a weighted sum of the output tracking error
square and the input variation square. The cost function should
be minimized to get the optimal control law sequence, and the
optimization problem is solved as follows:
u(t + i|t)|M
i=0 = arg min J .

(3)

u (t+i|t)

After a feasible solution u(t + i|t)|M
i=0 is obtained, only the
first term u(t|t) is implemented at current step; at step t + 1, the
above-mentioned optimization procedure will be repeated [16].

WANG et al.: INTELLIGENT CLOSED-LOOP INSULIN DELIVERY SYSTEMS FOR ICU PATIENTS

293

B. Particle Swarm Optimization
Developed in 1995 by Kennedy and Eberhart [10], PSO has
been shown to be effective in optimizing difficult multidimensional discontinuous problems in a variety of fields. PSO is
based on the bionic principle. It is a global optimization algorithm that deals with problems in which a best solution can
be represented as a point or surface in multidimensional space.
Currently, PSO has been widely used in objective function optimization, dynamic environment optimization, neural network
training, fuzzy control system, and so on. The algorithm firstly
initializes particle swarm randomly in the multidimensional
space and speed space, distributing each particle the initial position and initial speed. Then, it evaluates each particle according
to the fitness function, achieving each particle’s optimal position and the whole group’s optimal position in a certain moment.
During their search, members of the swarm interact with each
other in a certain way to optimize their search experience. In
each iteration, particle with the best solution shares its position
coordinates information with the rest swarms. After that, each
particle’s speed and position will be iteratively updated according to certain formulas until meeting the termination condition
of the iteration [12], [34]–[36]. The conventional particle swarm
algorithm is as follows:
vit+1 = wvit + c1 r1 (pti − xti ) + c2 r2 (ptg − xti )

(4)

xt+1
= xti + vit+1
i

(5)

where vi represents the velocity for particle i; xi represents the
position of particle i; pi represents the best previous position
of particle i (i.e., local-best position or its experience); pg represents the best position among all particles (i.e., global-best
position); w is the inertia weight. A larger value of w can conductively make the particle break away from the local optimum,
while a lower value of w can increase the convergence rate. c1
and c2 are positive acceleration constant parameters called acceleration coefficients, which control the maximum step size. r1
and r2 are two independently uniformly distributed random variables with range [0, 1]. Many research studies have been carried
out on how to design these parameters [10]–[13]. Equation (4) is
used to calculate the new velocity based on its previous velocity
and the distances from its current position to, respectively, its
own best historical position and the global best position. Then,
the particle moves to a new position according to (5). Interested
readers could refer to Kennedy and Eberhart [10] for more details. An improved PSO, adaptive particle swarm optimization
(APSO), was used in this paper. APSO can adapt its inertia
weight automatically through the fitness value [37]–[39]. The
inertial weight is designed as follows:
⎧
⎨ w = wm in + (wm ax − wm in )(f − fm in ) , f ≤ favg
favg − fm in
.
⎩
w = wm ax ,
f > favg
(6)
Among them, wm ax and wm in are the maximum and minimum of inertia weight, respectively. f is the current fitness value
of the particle, favg and fm in are the average and minimum fitness values of all particles in the current iteration, respectively.

Fig. 2.

Block diagram of the PSO-MPC algorithm.

It enables the automatic control of inertia weight that can effectively balance the exploration ability and development ability of
particles, which means good particles tend to perform exploitation to refine results by local search, while bad particles tend to
perform large modification to explore space with large step. In
other words, APSO provides a good way to maintain population
diversity and to sustain good convergence capacity.
C. PSO–MPC Dual-Framework Algorithm
It is well known that it is very difficult to exercise effective
control over an unknown object. This could be the case of a new
critically ill patient who is just sent to the ICU as an emergency,
without an individualized model.
This paper suggests fitting out the ICU patient’s
combined
model  through multiplying L known models

M1 M2 . . . ML from a patient model library by their corresponding coefficients [w1 w2 · · · wL ], and then continuously
updating the coefficients
using PSO so that to make the com
bined model M = Li=1 ωi Mi more and more close to the patient’s truly dynamic characteristics (see Fig. 2). In theory, any
points in a polygon can be linearly fitted by the endpoints of
the polygon, so any patient’s dynamic characteristics could be
approximated by using a good enough patient model library.
The conventional control algorithms contain two parts: identification part and control part. In this algorithm, the function of
identification is achieved by using PSO.
As shown earlier, the controlled object (ICU patient) is a
single-input single-output system: insulin delivery rate as the
input; BG concentration as the output. PSO was used to update
the coefficients for the combined model using input and output
data and then to provide the new combined model for MPC. At
the next sampling time, the computation was repeated starting
the new data over adjusted coefficients for the combination.
As time increased, more and more input and output data were
obtained, so PSO had enough data to identify a more accurate
combined model for MPC.
This paper selects ten typical ARX models [ M1 M2 ... M10 ]
to build up the model library, and the initial coefficients
[w1 w2 · · · w10 ] are chosen as [0.1 0.1 · · · 0.1]. All these ARX
models should have the same order, and the order is fixed to be 2
−1
according to [40], as shown below: G(k) = 1+a 1 zb 1−1z +a 2 z −2 u(k),

294

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Fig. 3. Step responses for three subjects in model library with 0.1 U/h basal
insulin change: (a) library subject 1 who is sensitive to insulin; (b) library
subject 4 who is insensitive to insulin; (c) library subject 7 who responds to
insulin moderately.

Fig. 4. Blood glucose responses for the standard subject: (a) different glucose
response curves with different meal sizes (CHO = 40 g, 80 g, and/or 120 g)
taking at second hour; (b) different glucose response curves with different bolus
insulin (1U, 2U, and/or 4U) injecting at fifth hour.

IV. In Silico TESTS ON STANDARD VIRTUAL SUBJECT
where G and u represent the BG value and insulin infusion
rate, respectively, and a1 , a2 , and b1 are model parameters. To
make the model library to cover with larger population, these
models were identified from ten virtual subjects: Subjects 1–3
are sensitive to insulin, subjects 4–6 are insensitive to insulin,
and subjects 7–10 respond to insulin moderately. The step responses of subjects 1, 4, and 7 are shown in Figs. 3(a), (b), and
(c), respectively. Even though there are some subjective factors
to select a model library, different model libraries would not
conclusively affect controller performance. Given the transfer
b 1 z −1
functions of ten library models are M1 = 1+a 1 z 1−1 +a 1 z −2 , M2 =
b 21 z −1
1+a 21 z −1 +a 22 z −2

b 1 0 z −1

1

2

,. . ., M10 = 1+a 1 0 z1−1 +a 1 0 z −2 , and define A1 =
1
2
10

10
i
i
i
w
a
,
A
=
w
a
and
B
= 10
i
2
i
1
1
2
i=1
i=1
i=1 wi b1 , then we
B 1 z −1
can get the combined model: M = 1+A 1 z −1 +A 2 z −2 . Therefore, identifying the individualized model equals to solve a
10-D optimization problem. PSO could update the coefficients
[w1 w2 · · · w10 ] for the combined model using input and output data and then provide the new combined model to MPC
for insulin infusion rate design. The current continuous glucose
monitoring system (CGMS) [40] can get a new reading every 1
or 5 min, and it is assumed that the sampling period is 5 min in
this study. Theoretically, the insulin infusion rate can be changed
every 5 min; however, it is changed every 30 min in this study
mainly for two reasons: first, slower frequency of changes to
the insulin delivery rate has better robustness to possible measurement noises and external disturbances; second, there are
more open-loop data for model identification; however, if the
frequency of changes is too slow, the closed-loop control performance will be limited or deteriorate. Every 30 min, PSO was
used to update the coefficients for the combination and then to
get a new combined model. After that, MPC was used to design
the insulin delivery rate based on this combination model, and
the insulin delivery rate was unchanged in the following 30 min.
Then, the same cycle was repeated.

Based on above-mentioned critically ill metabolism model
and its suggested parameter settings in publication [23], one
virtual ICU subject was built. For convenience, the subject was
named standard subject. The standard subject was used to simulate a critically ill patient [23]. Basically, the standard virtual
subject was characterized by normal dynamic response to insulin
administration. The following simulation tests were finished on
the standard virtual subject.
The initial glucose concentration was set at 300 mg/dL, so
the setpoint yr (t) in (2) is given as follows:
⎧
y (t) = 300 − 7.78t
0 < t < 18
⎪
⎨ r
yr (t) = 210 − 2.73t
(7)
18 ≤ t < 40
⎪
⎩
t ≥ 40
yr (t) = 100
where t denotes sampling steps with sampling period ΔT =
5 min; therefore, for example, t = 18 means 90th min.
Fig. 4(a) shows the open-loop BG dynamic response to different sizes of oral meals taking at second hour. Without any
oral meal in the first 2 h, the BG of standard virtual subject can
be sustained at about 100 mg/dL with 0.4 U/h intravenous infusion of insulin. Then at second hour, the virtual subject takes
different sizes of oral CHO. Due to the existence of endogenous
insulin, the BG increment is not proportional to the size of oral
CHO as in Fig. 4(a). Fig. 4(b) shows the open-loop BG response
curves to a different step increases in the intravenous infusion
rate of insulin. In the first 5 h, the virtual subject is given tiny
intravenous infusion of insulin to maintain BG at 150 mg/dL,
and then injected different doses of bolus insulin to show their
response curves. In the rest of this section, several contrast experiments between PSO–MPC control and the Yale protocol
were tested in the standard subject.
Fig. 5(a) shows the BG response of the standard subject under the PSO–MPC method, where there is 8 g/h enteral nutrition all the time. The PSO–MPC method effectively brings a

WANG et al.: INTELLIGENT CLOSED-LOOP INSULIN DELIVERY SYSTEMS FOR ICU PATIENTS

Fig. 5. Closed-loop control results of the standard subject under PSO–MPC:
(a) glucose response with 8 g/h enteral nutrition all the time; (b) intravenous
insulin infusion, endogenous insulin secretion, and plasma insulin.

295

Fig. 7. Closed-loop control results of the standard subject with taking oral
meal under PSO–MPC: (a) glucose response of the standard subject with taking
70 g oral meal at 12th hour (no meal announcement); (b) intravenous insulin
infusion, endogenous insulin secretion, and plasma insulin.

Fig. 6. Closed-loop control results of the standard subject with parenteral
nutrition under PSO–MPC: (a) glucose response with 10 g/h parenteral nutrition
from 12th hour; (b) intravenous insulin infusion, endogenous insulin secretion,
and plasma insulin.

hyperglycemic patient into the euglycemic range and almost
stabilizes the BG concentrations between 95 and 110 mg/dL
since fifth hour, without any hypoglycemic events (i.e., BG <
70 mg/dL). The infused intravenous insulin and the endogenous
insulin secretion together with the resulting plasma insulin concentration in the standard subject are shown in Fig. 5(b). Figs. 6
and 7 show the performance of the proposed method for dealing
with different nutritions when the BG concentration is stable.
Gaussian distributed measurement noises with standard deviation of 5 mg/dL and mean value of zero were added to the BG
measurements. This standard deviation is larger than the value
of 3.3 mg/dL used in the literature [6]. The noisy data were
filtered with a first-order filter:
Gf (k) = αG(k) + (1 − α)Gf (k − 1)

(8)

where k is the sampling instant (k = 1, 2, 3, . . .); G is the
BG measurement; Gf is the filtered value of G(k); α = 0.54
is the filter constant. This filter was also used in paper [6].
More telling comparisons of PSO–MPC and the Yale protocol

Fig. 8. Closed-loop control comparison for the standard subject with 8 g/h
enteral nutrition all the time, where measurement noises have standard deviation
of 5 mg/dL and mean value of zero: (a) glucose response curves under PSO–
MPC and the Yale protocol, respectively; (b) insulin delivery rates designed by
using PSO–MPC and the Yale protocol, respectively.

are given in Figs. 8–10. They compare the performance of two
control strategies in rejecting Gaussian noises.
In order to evaluate these in silico results in Figs. 5–10 numerically, some quantized results were displayed in Tables I
and II. 10 g/h parenteral nutrition or 70 g oral meal was given
from or at 12th hour to evaluate the robustness of the proposed control strategy when BG concentration is stable. The
minimum BG values in various situations for PSO–MPC control are all above 80 mg/dL without any hypoglycemic events,
while the minimum BG values for the Yale protocol are all below 60 mg/dL. The average percentage value, when BG level
is within the safe range (60–180 mg/dL), is more than 90%
under PSO–MPC, which is better than 80% for the Yale protocol. Although oscillations cannot be completely eliminated
by the proposed method, marked decreases in amplitudes of

296

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

V. In Silico TESTS ON GROUP SUBJECTS
A. Method to Create Group Virtual Subjects

Fig. 9. Closed-loop control comparison for the standard subject with
10 g/h parenteral nutrition since 12th hour, where the measurement noises have
standard deviation of 5 mg/dL and mean value of zero: (a) glucose response
curves under PSO–MPC and the Yale protocol, respectively; (b) insulin delivery
rates designed by PSO–MPC and the Yale protocol, respectively.

In order to test whether the controller performed well for
different subjects, the proposed strategy is evaluated on 30 virtual subjects. The original work of the critically ill metabolism
model [23] has presented the parameter values of six critically ill
patients. In this study, 24 more virtual subjects have been generated. The experimental studies in [23] provided sufficient information to generate other virtual patients. By the way, the insulin
sensitivity would be changed over triple for all virtual subjects.
Model parameters represent the high intersubject and temporal
variation in insulin needs in the critically ill. The metabolism
model consists of 32 free parameters and different combinations
of them represent different virtual patients. These parameters are
assumed to be log-normally distributed to ensure their nonnegativity. Twenty-four virtual subjects were generated using the
joint distribution, i.e., 24 realizations of the log-transformed parameter vector were randomly extracted from the multivariate
normal distribution characterizing intersubject variability. Finally, the parameters in these 30 virtual subjects were obtained
by using antitransformation [19]. In our opinion, these 30 subjects could represent a wide range of critical ill population.
B. Method to Create Group Virtual Subjects

Fig. 10. Closed-loop control comparison for the standard subject with taking
70 g oral meal at 12th hour (no meal announcement), where measurement noises
have standard deviation of 5 mg/dL and mean value of zero: (a) glucose response
curves under PSO–MPC and the Yale protocol, respectively; (b) insulin delivery
rates designed by PSO–MPC and the Yale protocol, respectively.

All simulation results were demonstrated in BG response
curves and control-variability grid analysis (CVGA) plots [41].
All these 30 subjects followed a 24-h scenario with initial
glucose of 300 mg/dL. The BG response curves and CVGA
results under PSO–MPC and the Yale protocol are given in
Figs. 11–14.
All subjects are within zones A and B under PSO–MPC, and
while 51% of subjects are within Zones A and B under the Yale
protocol as shown in Figs. 13–14. These results indicate that the
proposed closed-loop control algorithm can provide satisfactory
BG control, and it is more effective, more flexible, and less
labor-intensive than the Yale protocol for critically ill subjects.
In summary, the proposed PSO–MPC strategy performs better
than the Yale protocol in terms of effective responses and less
hypoglycemic events, which is an interesting candidate for tight
BG control.
VI. DISCUSSION

oscillations have been achieved by PSO–MPC compared with
the Yale protocol. The immoderate response of the Yale protocol tends to lead the patient into hypoglycemia, which might
lead to increase the risk of mortality. Furthermore, all standard
deviations under PSO–MPC are less than their corresponding
terms under the Yale protocol, which means that less fluctuation
occurred under the PSO–MPC strategy. No subject experienced
any hypoglycemic event using PSO–MPC in various situations,
which indicates that the proposed algorithm has excellent robustness with respect to unannounced meal distributions and
measurement noises. These simulation results demonstrate that
for a wide range of situations, PSO–MPC has superior glycemic
control performance compared with the Yale protocol.

The proposed control strategy integrates the excellent optimization ability of PSO to identify the patients’ models online
and the robust tuning ability of MPC to design the insulin infusion speed automatically based on the identified individualized
model. After a patient is admitted to the ICU, the BG concentration is regulated automatically by using the proposed method.
The indentified parameters of an individualized model may have
dramatic fluctuations during a short initial period (e.g., 3 h), then
these parameters would change smoothly. We believe that this
performance is tolerable in clinical practice, because very little
data may be available to set an accurate individualized model
in the initial period. Tight glucose control can reduce morbidity and mortality in critically ill patients but excessive insulin

WANG et al.: INTELLIGENT CLOSED-LOOP INSULIN DELIVERY SYSTEMS FOR ICU PATIENTS

297

TABLE II
PERFORMANCE METRICS OF THE YALE PROTOCOL IMPLEMENTED ON THE STANDARD SUBJECT IN VARIOUS SITUATIONS

Fig. 11. BG distribution of 30 subjects under PSO-MPC: all subjects follow a
24-h protocol with the same initial glucose value of 300 mg/dL and taking 8 g/h
enteral nutrition all the time. At each time step, the maximum, upper quartile,
median, lower quartile, and minimum BG values for 30 subjects were given in
this plot.

infusions increase the risk of severe hypoglycemia. As shown in
Fig. 12, nearly half of the subjects experienced hypoglycemic
events under the Yale protocol, because many of them are sensitive to insulin. That is to say, the hypoglycemic events may
be more frequent in these patients who are sensitive to insulin,
which requires us to take a more effective and safe control
strategy for these subjects. Furthermore, most hypoglycemic
events appeared in the first 5 h as shown in Fig. 12, because
the patients would be injected large amounts of insulin according to the Yale protocol when BG values are high (e.g., BG >
200 mg/dL). Once these patients who are sensitive to insulin are
injected excessive insulin, they may have very high risk to experience hypoglycemic events. Therefore, the Yale protocol may
be not an effective and safe control strategy for these subjects.
Fortunately, the proposed PSO–MPC strategy is an interesting
candidate for tight BG control, avoiding hypoglycemic events,
and with less labor demand.
To further improve the performance of the proposed method,
future studies would focus on the following aspects. First, ten
typical ARX models were selected to build up the model library
based on experiences in this paper; however, more theoretical
studies should be done to determine the optimal number of

Fig. 12. BG distribution of 30 subjects under the Yale protocol. All subjects
follow a 24-h protocol with the same initial glucose value of 300 mg/dL and
taking 8 g/h enteral nutrition all the time. At each time step, the maximum,
upper quartile, median, lower quartile, and minimum BG values for 30 subjects
were given in this plot.

Fig. 13. Control-variability grid analysis (after 3 h) for 30 subjects under the
PSO–MPC algorithm, where 67% in A zone, 33% in B zone, 0% in C zone, 0%
in D zone, and 0% in E zone.

the typical ARX models. Second, to achieve better identification performances and reduce computation burden, a modified
PSO should be proposed for the PSO–MPC dual-framework

298

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Fig. 14. Control-variability grid analysis (after 3 h) for 30 subjects under the
Yale protocol, where 14% in A zone, 37% in B zone, 49% in C zone, 0% in D
zone, and 0% in E zone.

algorithm. Third, we hypothesize that using of age, height, and
weight of a subject would make predictions more accurate for
individualized model; hence these data should be explored in
further research. More important, clinical trials are required to
further test the proposed method.
VII. CONCLUSION
A novel intelligent closed-loop insulin delivery system has
been developed for critically ill patients. This combination of
PSO and MPC is superior to the Yale protocol in terms of less labor demand, less hypoglycemic events, dampened oscillations,
more glucose concentrations within the safe range, and better robustness to meal disturbances/measurement noise/subject
variability. Hence, the proposed strategy could reduce the risk of
death. This simple and effective method can become a valuable
asset for intensive insulin therapy in the ICU. Further testing in
clinic will begin following protocol approval.
REFERENCES
[1] J. G. Chase, G. M. Shaw, X. W. Wong, T. Lotz, J. Lin, and C. E. Hann,
“Model-based glycaemic control in critical care—A review of the state of
the possible,” Biomed. Signal Process. Control, vol. 1, pp. 3–21, 2006.
[2] B. W. Bequette, “Analysis of algorithms for intensive care unit blood
glucose control,” J. Diabetes Sci. Technol., vol. 1, pp. 813–824, 2007.
[3] G. Van den Berghe, P. Wouters, F. Weekers, C. Verwaest, F. Bruyninckx,
M. Schetz, D. Vlasselaers, P. Ferdinande, P. Lauwers, and R. Bouillon,
“Intensive insulin therapy in critically ill patients,” New England J. Med.,
pp. 1359–1367, 2001.
[4] T. Van Herpe, B. De Moor, and G. Van den Berghe, “Towards closed-loop
glycaemic control,” Best Practice Res. Clinical Anaesthesiol., vol. 23,
pp. 69–80, 2009.
[5] M. Hoekstra, M. Vogelzang, E. Verbitskiy, and M. W. N. Nijsten, “Health
technology assessment review: Computerized glucose regulation in the
intensive care unit,” Critical Care, vol. 13, pp. 223–230, 2009.
[6] M. Ottavian, M. Barolo, H. Zisser, E. Dassau, and D. E. Seborg, “Improved blood glucose control for critically ill subjects,” J. Process. Control, vol. 21, pp. 331–342, 2011.
[7] J. Bondia, E. Dassau, H. Zisser, R. Calm, J. Vehi, L. Jovanovič, and
F. J. Doyle III, “Coordinated basal-bolus infusion for tighter postprandial
glucose control in insulin pump therapy,” J. Diabetes Sci. Technol., vol. 3,
pp. 89–97, 2009.

[8] J. Lin, N. N. Razak, C. G. Pretty, A. Le. Compte, P. Docherty,
J. D. Parente, G. M. Shaw, C. E. Hann, and J. G. Chase, “A physiological intensive control insulin-nutrition-glucose (ICING) model validated
in critically ill patients,” Comput. Methods Programs Biomed., vol. 102,
pp. 192–205, 2011.
[9] F. Ding and T. W. Chen, “Hierarchical least squares identification methods
for multivariable systems,” IEEE Trans. Autom. Control, vol. 50, no. 3,
pp. 397–402, Mar. 2005.
[10] J. Kennedy and R. Eberhart, “Particle swarm optimization,” in Proc. IEEE
Int. Conf. Neutral Netw., Australia, 1995, vol. 4, pp. 1942–1948.
[11] M. Clerc and J. Kennedy, “The particle swarm-explosion, stability, and
convergence in a multidimensional complex space,” IEEE Trans. Evol.
Comput., vol. 6, no. 1, pp. 58–73, Feb. 2002.
[12] S. Rana, S. Jasola, and R. Kumar, “A review on particle swarm optimization algorithms and their applications to data clustering,” Artif. Intell. Rev.,
vol. 35, pp. 211–222, 2011.
[13] I. C. Trelea, “The particle swarm optimization algorithm: Convergence
analysis and parameter selection,” Inform. Process. Lett., vol. 85, pp. 317–
325, 2003.
[14] S. J. Qin and T. A. Badgwell, “A survey of industrial model predictive
control technology,” Control Eng. Practice, vol. 11, pp. 733–764, 2003.
[15] Y. Q. Wang, E. Dassau, and F. J. Doyle III, “Closed-loop control of artificial pancreatic beta-cell in type 1 diabetes mellitus using model predictive
iterative learning control,” IEEE Trans. Biomed. Eng., vol. 57, no. 2,
pp. 211–219, Feb. 2010.
[16] Y. Q. Wang, H. Zisser, E. Dassau, L. Jovanovič, and F. J. Doyle III, “Model
predictive control with learning-type set-point: Application to artificial
pancreatic beta-cell,” AIChE J., vol. 56, pp. 1510–1518, 2010.
[17] L. Magni, D. M. Raimondo, L. Bossi, C. D. Man, G. De Nicolao,
B. Kovatchev, and C. Cobelli, “Model predictive control of type 1 diabetes: An in silico trial,” J. Diabetes Sci. Technol., vol. 1, pp. 804–812,
2007.
[18] R. A. Harvey, Y. Q. Wang, B. Grosman, M. W. Percival, W. Bevier,
D. A. Finan, H. Zisser, D. E. Seborg, L. Jovanovič, F. J. Doyle III, and
E. Dassau, “Quest for the artificial pancreas: Combining technology with
treatment,” IEEE Eng. Med. Biol. Mag., vol. 29, no. 2, pp. 53–62, Mar./Apr.
2010.
[19] L. Magni, M. Forgione, C. Toffanin, C. D. Man, and B. Kovatchev, “Runto-run tuning of model predictive control for type 1 diabetes subjects: In
silico trial,” J. Diabetes Sci. Technol., vol. 3, pp. 1091–1098, 2009.
[20] R. Hovorka, J. M. Allen, D. Elleri, L. J. Chassin, J. Harris, D. Y. Xing,
C. Kollman, T. Hovorka, A. M. F. Larsen, M. Nodale, A. De Palma,
M. E. Wilinska, C. L. Acerini, and D. B. Dunger, “Manual closed-loop
insulin delivery in children and adolescents with type 1 diabetes: A phase
2 randomised crossover trial,” Lancet, vol. 375, pp. 743–751, 2010.
[21] X. H. Wang and J. M. Xiao, “PSO-based model predictive control for
nonlinear processes,” in Advances in Natural Computation (Lecture Notes
in Computer Science 3611), L. Wang, K. Chen, and Y. S. Ong, Eds.
Berlin, Germany: Springer, 2005, pp. 196–203.
[22] F. Kawai, H. Ito, C. Nakazawa, T. Matsui, Y. Fukuyama, R. Suzuki, and
E. Aiyoshi, “Automatic tuning for model predictive control: Can particle
swarm optimization find a better parameter?,” in Proc. 22nd IEEE Int.
Symp. Intell. Control, Part IEEE Multi-conf. Syst Control, Singapore,
2007, pp. 646–651.
[23] R. Hovorka, L. J. Chassin, M. Ellmerer, J. Plank, and M. E. Wilinska, “A
simulation model of glucose regulation in the critically ill,” Physiological
Meas., vol. 29, pp. 959–978, 2008.
[24] J. C. Lee, M. Kim, K. R. Choi, T. J. Oh, M. Y. Kim, Y. M. Cho, K. Kim,
H. C. Kim, and S. Kim, “In silico evaluation of glucose control protocols
for critically ill patients,” IEEE Trans. Biomed. Eng., vol. 59, no. 1, pp. 54–
57, Jan. 2012.
[25] J. J. Hsu, J. I. Wang, A. Lee, D. Y. Li, C. H. Chen, S. Huang, A. Liu,
B.-K. Yoon, S.-K. Kim, and T.-J. Tsai, “Automated control of blood
glucose in the OR and surgical ICU,” in Proc. Annual Int. Conf. IEEE
Eng. Med. Biol. Soc., 2009, pp. 1286–1289.
[26] M. Wilson, J. Weinrebi, and G. W. S. Hoo, “Intensive insulin therapy in
critical care—A review of 12 protocols,” Diabetes Care, vol. 30, pp. 1005–
1011, 2007.
[27] M. Tamaki, T. Shimizu, A. Kanazawa, Y. Tamura, A. Hanzawa, C. Ebato,
C. Itou, E. Yasunari, H. Sanke, H. Abe, J. Kawai, K. Okayama,
K. Matsumoto, K. Komiya, M. Kawaguchi, N. Inagaki, T. Watanabe,
Y. Kanazawa, T. Hirose, R. Kawamori, and H. Watada, “Efficacy and
safety of modified Yale insulin infusion protocol in Japanese diabetic patients after open-heart surgery,” Diabetes Res. Clinical Practice, vol. 81,
pp. 296–302, 2008.

WANG et al.: INTELLIGENT CLOSED-LOOP INSULIN DELIVERY SYSTEMS FOR ICU PATIENTS

[28] P. A. Goldberg, “Memoirs of a root canal salesman: The successful implementation of a hospital-wide intravenous insulin infusion protocol,”
Endocrine Practice, vol. 12, Suppl 3, pp. 79–85, 2006.
[29] P. A. Goldberg, O. V. Sakharova, P. W. Barrett, L. N. Falko,
M. G. Roussel, L. Bak, D. Blake-Holmes, N. J. Marieb, and S. E. Inzucchi,
“Improving glycemic control in the cardiothoracic intensive care unit:
Clinical experience in two hospital settings,” J. Cardiothoracic Vascular
Anesthesia, vol. 18, pp. 690–697, 2004.
[30] P. A. Goldberg, M. D. Siegel, and R. S. Sherwin, “Implementation of a
safe and effective insulin infusion protocol in a medical intensive care
unit,” Diabetes Care, vol. 27, pp. 461–467, 2004.
[31] H. Z. Xie, X. Jiang, Y. Q. Wang, and B. Liu, “Intensive insulin therapy
for ICU patients using particle swarm intelligence and predictive power
[abstract],” Diabetes, vol. 60, Suppl 1, pp. A254–A255, 2011.
[32] J. G. Chase, G. M. Shaw, T. Lotz, A. LeCompte, J. Wong, J. Lin,
T. Lonergan, M. Willacy, and C. E. Hann, “Model-based insulin and nutrition administration for tight glycaemic control in critical care,” Current
Drug Del., vol. 4, pp. 283–296, 2007.
[33] P. Dua, F. J. Doyle III, and E. N. Pistikopoulos, “Model-based blood glucose control for type 1 diabetes via parametric programming,” IEEE Trans.
Biomed. Eng., vol. 53, no. 8, pp. 1478–1491, 2006.
[34] K. Kameyama, “Particle swarm optimization—A survey,” IEICE Trans.
Inf. Syst., vol. E92D, pp. 1354–1361, 2009.
[35] J. Kennedy, R. C. Eberhart, and Y. Shi, Swarm Intelligence. San Francisco: Morgan Kaufman Publishers, 2001.
[36] B. Liu, L. Wang, and Y. H. Jin, “An effective PSO-based memetic algorithm for flow shop scheduling,” IEEE Trans. Syst. Man Cybern. Part
B—Cybern., vol. 37, no. 1, pp. 18–27, 2007.
[37] A. Nickabadi, M. M. Ebadzadeh, and R. Safabakhsh, “A novel particle
swarm optimization algorithm with adaptive inertia weight,” Appl. Soft
Comput., vol. 11, pp. 3658–3670, 2011.
[38] Z. H. Zhan, J. Zhang, Y. Li, and H. S. H. Chung, “Adaptive particle swarm
optimization,” IEEE Trans. Syst. Man Cybern. Part B—Cybern., vol. 39,
no. 6, pp. 1362–1381, 2009.
[39] B. Liu, L. Wang, Y. H. Jin, F. Tang, and D. X. Huang, “Improved particle swarm optimization combined with chaos,” Chaos Solitons Fractals,
vol. 25, pp. 1261–1271, 2005.
[40] J. Bondia, C. Tarin, W. Garcia-Gabin, E. Esteve, J. M. Fernandez-Real,
W. Ricart, and J. Vehi, “Using support vector machines to detect therapeutically incorrect measurements by the MiniMed CGMS,” J. Diabetes
Sci. Technol., vol. 2, pp. 622–629, 2008.
[41] L. Magni, D. M. Raimondo, C. D. Man, M. Breton, S. Patek,
G. D. Nicolao, C. Cobelli, and B. P. Kovatchev, “Evaluating the efficacy
of closed-loop glucose regulation via control-variability grid analysis,” J.
Diabetes Sci. Technol., vol. 2, pp. 630–635, 2008.

Youqing Wang (M’09–SM’12) received the B.S.
degree from Shandong University, Jinan, Shandong,
China, in 2003, and the Ph.D. degree in control
science and engineering from Tsinghua University,
Beijing, China, in 2008.
He was as a Research Assistant in the Department
of Chemical Engineering, Hong Kong University
of Science and Technology, from February 2006 to
August 2007. From February 2008 to February 2010,
he was a Senior Investigator in the Department
of Chemical Engineering, University of California,
Santa Barbara, CA, USA. From March 2008 to December 2011, he was an Adjunct Senior Investigator in Sansum Diabetes Research Institute. He is currently
a Full Professor in the Beijing University of Chemical Technology, Beijing,
China. His current research interests include modeling and control of biomedical
processes (e.g., artificial pancreas system), health informatics, batch processes,
iterative learning control, model predictive control, and fault-tolerant control.
Dr. Wang is in the editorial board of Mathematical Problems in Engineering
and ISRN Applied Mathematics. He is a member of the International Federation of Automatic Control Technical Committee on Biological and Medical
Systems. He is the recipient of several research awards (including the Journal
of Process Control Survey Paper Prize and the Zhang Zhong-Jun Academician
Outstanding Paper Award). He was the Session Chair or Co-chair for several
international conferences.

299

Hongzhi Xie was born in Hunan, China, in 1989. He
received the B.S. degree in automation and the M.S.
degree in control science and engineering from the
Beijing University of Chemical Technology, Beijing,
China, in 2010 and 2013, respectively.
He is currently a member of Technical Department, Daya Bay Nuclear Power Operations and Management Company Limited. His research interests
include optimization algorithm, model predictive
control, and closed-loop glycemic control for critically ill patients.

Xu Jiang was born in Jiangxi, China, in 1989. He
received the B.S. degree in automation and M.S. degree in control science and engineering both from the
Beijing University of Chemical Technology, Beijing,
China, in 2010 and 2013, respectively.
He is currently a member of East China Engineering Science and Technology Company Limited.
His interests include data driven method, model predictive control, and closed-loop glycemic control for
critically ill patients.

Bo Liu received the B.S. degree in electrical engineering from Xi’an Jiaotong University, China, in
2001, and the Ph.D. degree in control science and
engineering, Department of Automation, Tsinghua
University, China, in 2007.
He was a Post-doctorial Research Staff on economic system analysis in the Centre for World Food
Studies (SOW-VU), Vrije Universiteit, Amsterdam,
the Netherlands during 2007–2009. He is currently
an Assistant Professor with the Academy of Mathematics and Systems Science, Chinese Academy of
Sciences, Beijing, China. His research interests include the field of modeling, analysis, control and optimization for scheduling, control and economic
systems.
Dr. Liu is the Technical Committee Member of Task Force on Mimetic Computing in the IEEE Computational Intelligence Society.

