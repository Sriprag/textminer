IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

361

Uncertainty Quantification in Transcranial Magnetic
Stimulation via High-Dimensional
Model Representation
Luis J. Gomez∗ , Student Member, IEEE, Abdulkadir C. Yücel, Luis Hernandez-Garcia, Stephan F. Taylor,
and Eric Michielssen, Fellow, IEEE

Abstract—A computational framework for uncertainty quantification in transcranial magnetic stimulation (TMS) is presented.
The framework leverages high-dimensional model representations
(HDMRs), which approximate observables (i.e., quantities of interest such as electric (E) fields induced inside targeted cortical
regions) via series of iteratively constructed component functions
involving only the most significant random variables (i.e., parameters that characterize the uncertainty in a TMS setup such as the
position and orientation of TMS coils, as well as the size, shape,
and conductivity of the head tissue). The component functions of
HDMR expansions are approximated via a multielement probabilistic collocation (ME-PC) method. While approximating each
component function, a quasi-static finite-difference simulator is
used to compute observables at integration/collocation points dictated by the ME-PC method. The proposed framework requires
far fewer simulations than traditional Monte Carlo methods for
providing highly accurate statistical information (e.g., the mean
and standard deviation) about the observables. The efficiency and
accuracy of the proposed framework are demonstrated via its application to the statistical characterization of E-fields generated
by TMS inside cortical regions of an MRI-derived realistic head
model. Numerical results show that while uncertainties in tissue
conductivities have negligible effects on TMS operation, variations
in coil position/orientation and brain size significantly affect the
induced E-fields. Our numerical results have several implications
for the use of TMS during depression therapy: 1) uncertainty in
the coil position and orientation may reduce the response rates
of patients; 2) practitioners should favor targets on the crest of a
gyrus to obtain maximal stimulation; and 3) an increasing scalpto-cortex distance reduces the magnitude of E-fields on the surface
and inside the cortex.
Index Terms—Generalized polynomial chaos (gPC), highdimensional model representation (HDMR), magnetic stimulation,
multielement probabilistic collocation (ME-PC), sensitivity analysis, surrogate model, transcranial magnetic stimulation (TMS),
uncertainty quantification.
Manuscript received February 22, 2014; revised May 26, 2014; accepted
August 20, 2014. Date of publication September 4, 2014; date of current version
December 18, 2014. This work was supported in part by the AFOSR/NSSEFF
Program under Award FA9550-10-1-0180 and the Office of Naval Research
under Award N00014-11-1-0720. Asterisk indicates corresponding author.
L. J. Gomez is with the Department of Electrical Engineering and Computer
Science, University of Michigan, Ann Arbor, MI 48109 USA (e-mail: luisgo@
umich.edu).
A. C. Yücel and E. Michielssen are with the Department of Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, MI 48109
USA (e-mail: acyucel@umich.edu; emichiel@umich.edu).
L. Hernandez-Garcia is with the Department of Biomedical Engineering, University of Michigan, Ann Arbor, MI 48109 USA (e-mail: hernan@umich.edu).
S. F. Taylor is with the Department of Psychiatry, University of Michigan,
Ann Arbor, MI 48109 USA (e-mail: sftaylor@umich.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2353993

I. INTRODUCTION
RANSCRANIAL magnetic stimulation (TMS) is a noninvasive procedure used to study brain function [1]–[5] and
to treat neuropsychiatric disorders [2], [6]–[8]. During TMS, one
or more coils located near the scalp are used to modulate brain
function in targeted cortical regions. These coils produce magnetic (H) fields that in turn induce electric (E) fields and Eddy
currents inside the conductive brain tissue. The TMS induced
E-fields may cause them to depolarize, leading to an action potential and affecting brain activity [9], [10]. The mechanisms by
which E-fields generate action potentials are manifold [11] and
their net effect on brain activity are complex and dependent on
the specific arrangement of the intricate neural circuits of the
cortex. While it is generally accepted that TMS-induced brain
activity is proportional to the E-field amplitudes [7], [8], many
factors contribute to variability and uncertainty of the evoked
neuronal responses. Thus, an understanding of how uncertainty
in TMS setup and patient variability results in uncertainty in the
TMS-induced E-fields should aid TMS practitioners in understanding the capabilities/limitations of current TMS procedures
and better assess the effect of procedural refinements.
Although several procedures have been developed to optimally position a TMS coil over the desired cortical targets, they
all involve varying amounts of uncertainty that translate into uncertainty in the generated E-field distribution. At present, there
exist no satisfactory methods to estimate how uncertainty in
TMS setup (e.g., coil position and orientation) and uncertainties
stemming from differences in brain anatomy (e.g., the conductive properties of the underlying neural tissue and the size of
the brain) affect uncertainty in the E-field. To ensure the E-field
distribution inside a targeted cortical region is above a given
threshold, the relationship between E-fields and uncertainty in
TMS setup and brain anatomy should be computationally quantified. Computational methods for achieving this task should be
capable of providing the statistics of E-fields given the uncertain quantities, as well as aiding the TMS practitioner to assess
the sensitivity of E-fields to each uncertain quantity. This paper
presents an efficient computational framework possessing these
attributes.
Uncertain quantities in a TMS setup include the position [12]
and orientation [13] of TMS coils relative to targeted cortical region. TMS practitioners aim to position the coils on the
scalp directly above the targeted cortical regions as the coils
generate E-fields that are strongly concentrated below the coil

T

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

362

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

centers. Unfortunately, procedures for achieving the latter are
error prone, resulting in misalignment of the TMS coils relative
to the targeted cortical regions. For example, in depression therapy, the coils often are placed 5–5.5 cm anterior of the location
on the scalp where the coils induce a motor response in the
hand (the “5 cm rule”) [14], [15]. But MRI experiments have
shown that this procedure leads to coils not positioned directly
above the targeted cortical region in 32 out of 100 instances
[16]. In other TMS procedures, practitioners often place coils
using the international ten twenty electrode system [17], by
which the locations on the scalp directly above cortical regions
are determined using a number of cranial landmarks. Again,
MRI experiments have shown that the coils are not positioned
directly above the targeted cortical region in 10 out of 100 instances [18]. Aside from errors in positioning coils due to the
misidentification of the ideal coil position, TMS practitioners
often cannot place coils with an accuracy better than 5 mm [19],
[20]. The cumulative effect of misidentification and placement
errors can result in a 2 cm deviation from the ideal coil position
[19], [20].
Variability in brain anatomy is another source of uncertainty.
TMS coils are often oriented in such a way that the E-fields
generated directly under the center of the coils point nearly perpendicular to the gyral folding patterns of the boundary between
cerebrospinal fluid (CSF) and gray matter (GM) [21]. However,
the specific gyral folding patterns at the targeted cortical regions vary between patients. Consequently, optimum orientation of TMS coils cannot be determined unless the practitioner
has access to MRI images that clearly depict the gyral structure directly under the coil. Note that uncertainty in the position
and orientation of TMS coils can be significantly reduced using
novel “neuro-navigated” coil positioning systems that use MRI
images of the brain and robotic arms [22], [23]. However, such
systems are costly and typically not employed outside research
settings. Consequently, the optimal orientation of coils relative
to the underlying tissue is not known during most TMS procedures and varies from patient to patient [19]. Other anatomical
differences between patients include brain size [24] and the values of tissue conductivities [25]. There exists a 10% variation
of brain size between individuals [26], some of which results
from a variation in the scalp-to-cortex distance [27]. For each
millimeter increment in the scalp-to-cortex distance, the TMS
output has to be increased by 3% to induce the same level of
stimulation [28]. Individual brain tissues are highly inhomogeneous and the values of tissue conductivities exhibit variations
from 10% to 25% around their average values [29].
The effects of uncertainties that affect TMS—henceforth referred to as random variables—can be quantified via Monte
Carlo (MC) methods [25]. MC methods however require the
evaluation of observables (e.g., E-fields induced inside targeted
cortical regions in TMS simulations) using deterministic electromagnetic (EM) simulators for many random realizations of
the EM system and its excitation (i.e., random values of tissue conductivities, random positions of coils in TMS simulations). These random realizations are selected while accounting
for the assumed/known probability density functions (PDFs) of
the random variables. While classical MC methods are easy to

implement, they usually require a large number of costly deterministic EM simulations to converge [30]. The authors of
[25] used MC to quantify the effects of uncertainty in values
of tissue conductivities on E-fields and currents induced on an
MRI-derived head model. However, the accuracy of the statistics of E-fields and currents presented in [25] is questionable as
they were obtained from a small number of deterministic EM
simulations.
This paper presents a new computational framework that
quantifies uncertainties in TMS simulations via a two-step procedure. First, a “surrogate model” of the observables as functions of the uncertain parameters is constructed. Second, the
surrogate model is probed via the classical MC method to compute the statistics of observables while accounting for the PDFs
of random variables. The surrogate model consists of a piecewise multivariate polynomial fit of the observables and can be
evaluated much more efficiently than the true observable, which
requires execution of a costly EM simulator. Furthermore, the
number of EM simulator runs required for construction of the
surrogate model dwarfs in comparison with the number of observable evaluations during MC. The surrogate models are generated using high-dimensional model representation (HDMR)
expansions [31], which approximate observables by finite sums
of “component functions” representing individual and multivariate contributions of random variables. HDMR methods are well
known to outperform other uncertainty quantification methods
in high-dimensional settings [32], [33], as they yield models
that only include component functions for the “most important”
random variables or combinations thereof [33]. The component
functions included in HDMR expansions are constructed using
the multielement probabilistic collocation (ME-PC) method, an
h-adaptive variant of the polynomial chaos methods that have
been applied effectively to problems of uncertainty quantification in EM compatibility and interference [34]–[38], channel modeling [39]–[41], periodic structure analysis [42], and
EM dosimetry [43]. The h-adaptive nature of the ME-PC methods permits their application to modeling of multimodal functions, as encountered in TMS. The observable values at collocation/integration points identified by the ME-PC method are
computed using a quasi-static finite-difference (FD) solver.
The accuracy and efficiency of the proposed computational
framework are demonstrated via its applications to the statistical characterization of E-fields induced inside three-sphere and
MRI-derived head models. Numerical results show that typical
uncertainties in TMS setup and uncertainty in an individual’s
brain anatomy may result in 40% change in the E-field at a
targeted point. Furthermore, coil position/orientation and brain
size significantly contribute to variances of the TMS-induced
E-fields while the contributions due to uncertainty in tissue conductivities are negligible. These results have important implications for the use of TMS in various experimental and clinical
settings.
II. FORMULATION
Let x = [x , x , . . . , xN d o f −1 , xN d o f ] denote an Ndof dimensional vector defined over a random domain D =
1

2

GOMEZ et al.: UNCERTAINTY QUANTIFICATION IN TRANSCRANIAL MAGNETIC STIMULATION VIA HIGH-DIMENSIONAL MODEL

N d o f

Di ; each element xi , i = 1, . . . , Ndof , of x is a random
variable that parameterizes one uncertain quantity in a TMS
setup or one uncertain quantity related to brain anatomy. In
what follows, all random variables are assumed mutually independent; moreover, variable xi is assumed distributed with
known/assumed PDF wi (·) across a finite 1-D random domain
Di = [ai , bi ]. Let V (x) represent an observable (e.g., the E-field
at a given point in the targeted cortical region); V (x) typically
is a complicated, nonlinear, and multimodal function of x.
The proposed computational framework leverages the HDMR
technique to obtain the statistics of V (x). Specifically, the
HDMR technique is used to generate an approximate but accurate surrogate model of V (x). To this end, the technique
decomposes the Ndof -variate observable V (x) into lower dimensional component functions, each of which is approximated
using the ME-PC method described in [44]–[46]. While iteratively constructing the HDMR expansion, the technique automatically selects the component functions pertinent to the
most significant random variables and thereby substantially reduces the cost of surrogate model generation. Upon generation of an accurate surrogate model, the MC method is used
to probe the surrogate model while accounting for the distributions wi (·) = i = 1, . . . , Ndof and thereby obtain the statistics
of V (x).
i=1

A. HDMR Technique
The HDMR expansion approximates V (x) in terms of component functions as

363

Using the component functions in (2), the HDMR expansion
can be constructed as
V (x) = V0 + V1 (x1 ) + V2 (x2 ) + V3 (x3 ) + V12 (x1 , x2 )
+ V13 (x1 , x3 ) + V23 (x2 , x3 ) + V123 (x1 , x2 , x3 ).
(3)
To illustrate the advantage of such decomposition, consider
an observable that consists of a constant term and monomials,
i.e., V (x) = 1 + (x1 )2 + (x2 )2 + (x3 )2 (Note: the indices of
the random variables are contained inside the parentheses while
their powers are intentionally left outside the parentheses). The
component functions V0 , V1 (x1 ), V2 (x2 ), and V3 (x3 ) in (3) all
are needed to approximate V (x) while the remaining ones in (3)
are redundant. Just as in this trivial example, many real-world
physical observables can be accurately approximated by loworder component functions [32]. This fact renders the HDMR
expansion highly suitable for surrogate model generation of
V (x) in high-dimensional random domains.
There exist two HDMR techniques that differ in how the
component functions Vu (xu ) are estimated: analysis of variance HDMR and CUT-HDMR. The former is not suitable for
surrogate model generation in high-dimensional random domains [33] and hence not considered herein. The CUT-HDMR
technique obtains Vu (xu ) using the observable values on lines,
planes, and hyperplanes, i.e., cuts, passing through a reference
point, x̄, in D, i.e.

Vu (xu ) = V (xu )|x= x̄\x u −
Vv (xv )
(4)
v⊂u

V (x) =



Vu (xu )

(1)

u⊆Ω

where Ω = {1, . . . , Ndof } is the set of random variable indices,
u is a subset of Ω, i.e., u ⊆ Ω, and |u| denotes the cardinality
of subset u. xu is a |u|-dimensional random vector and Vu (xu )
represents component functions defined over D. For example,
for u = ∅, Vu (xu ) = V∅ (x∅ ) = V0 is the zeroth-order component function which is constant over D. For u = {1}, V1 (x1 ) is
the first-order component function that represents the individual
contribution of x1 to V (x). For u = {1, 2, 4}, V124 (x1 , x2 , x4 )
is the third-order component function that describes the combined contribution of x1 , x2 , and x4 to V (x). The HDMR
expansion in (1) can perhaps best be described by an example.
Assume that Ndof = 3 and Ω = {1, 2, 3}. All possible subsets
of Ω, u, their cardinalities |u|, and all component functions
Vu (xu ) corresponding to these possible subsets are
u = ∅,
u = {1},
u = {2},
u = {3},
u = {1, 2},
u = {1, 3},
u = {2, 3},
u = {1, 2, 3},

|u| = 0,V0
|u| = 1,V1 (x1 )
|u| = 1,V2 (x2 )
|u| = 1,V3 (x3 )
|u| = 2,V12 (x1 , x2 )
|u| = 2,V13 (x1 , x3 )
|u| = 2,V23 (x2 , x3 )
|u| = 3,V123 (x1 , x2 , x3 ).

(2)

where x = x̄\xu indicates that the random variables with indices not belonging to subset u are set to their corresponding
values at reference point x̄. Typically, x̄ is the center of mass
of D, i.e., x̄ = [x̄1 , . . . , x̄N d o f ] = [(a1 + b1 )/2, . . . , (aN d o f +
bN d o f )/2]. For the previous example, Vu (xu ), u ⊆ Ω, obtained
by CUT-HDMR technique are
u = ∅,
u = {1},
u = {2},
u = {3},
u = {1, 2},

V0 = V (x̄)
V1 (x1 ) = V (x1 , x̄2 , x̄3 ) − V0
V2 (x2 ) = V (x̄1 , x2 , x̄3 ) − V0
V3 (x3 ) = V (x̄1 , x̄2 , x3 ) − V0
V12 (x1 , x2 ) = V (x1 , x2 , x̄3 )
 
 
−V0 − V1 x1 − V2 x2
u = {1, 3},
V13 (x1 , x3 ) = V (x1 , x̄2 , x3 )
−V0 − V1 (x1 ) − V3 (x3 )
u = {2, 3},
V23 (x2 , x3 ) = V (x̄1 , x2 , x3 )
−V0 − V2 (x2 ) − V3 (x3 )
V123 (x1 , x2 , x3 ) = V (x1 , x2 , x3 )
−V12 (x1 , x2 )
u = {1, 2, 3},
−V13 (x1 , x3 ) − V23 (x2 , x3 )
−V1 (x1 ) − V2 (x2 ) − V3 (x3 ) − V0 .

(5)

In CUT-HDMR, the surrogate model of V (x)is generated
by interpolating Vu (xu ), u ⊆ Ω, either directly from the component function with the highest cardinality, or recursively,

364

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

starting from the component function with the lowest cardinality. The former strategy is efficient if significant/redundant
component functions are known a priori. However, as that
information typically is not available, the latter strategy often
is employed. That is, the observable value at reference point
x̄ (for |u| = 0) is computed first and then observable values
on lines (for |u| = 1), planes (for |u| = 2), and hyperplanes
(for |u| ≥ 3) passing through x̄ are interpolated consecutively,
in our case using the ME-PC method. That said, the number of component functions in the HDMR expansion scales
|u|
with j =0 Ndof !/(j!(Ndof − j)!) and increases rapidly with
increasing Ndof . This high cost of the HDMR technique for
large Ndof can be reduced substantially by leveraging an iterative scheme that automatically selects random variables that significantly contribute to V (x) and iteratively includes the higher
order component functions pertinent to these variables in the
HDMR expansion [33], [47], [48]. Iterative scheme starts by
computing the weights associated with the first-order component functions as [33]
ζu = |E[Vu (xu )] / V0 | ;

|u| = 1.

(6)

The weights ζu are measures of the contributions
 of first-order
component functions’ means, i.e., E[Vu (xu )] = Vu (xu )dxu ,
to the mean of V (x) computed via the constant zeroth-order
component function. If ζu is larger than a prescribed tolerance
ε1 , then the component function (or random variable) is assumed
to contribute significantly to V (x). The second-order component functions involving these significant random variables are
marked as candidates for constructing the HDMR expansion at
the second level; they are only added to the expansion if their
weights are larger than ε1 . This scheme is repeated in an iterative
manner for all levels. For example, assume that the indices of the
significant random variables are found to be {1, 2, 4}. Then, the
second-order component functions with indices {1, 2}, {1, 4},
and {2, 4} are considered for inclusion in the HDMR expansion
at the second level. At the end of second level, assume that any
of the second-order component functions with indices {1, 2},
{1, 4}, and {2, 4} is found to be insignificant. Then, none of
the third-order component functions is considered for inclusion in the HDMR expansion since all second-order component
functions with indices that are the subsets of the index set of a
candidate third-order component function should be identified
as significant. Note that at the higher levels, the weights of the
component functions Vu (xu ), |u| ≥ 2 are computed by [33]

 

u  
ζu = E[Vu (x )] / 



E[Vv (x )] ;
v

|v|< |u|−1

computed by [33]
E [V (x)] =



E [Vu (xu )].

(8)

u⊆Ω

Similarly, the variance of V (x) can be calculated using [33]

var [V (x)] =
var[Vu (xu )]
(9)
u⊆Ω

where var[Vu (x )] = E[(Vu (xu ))2 ] − (E[Vu (xu )])2 .
u

B. ME-PC Method
While in principle any multivariate interpolator can be used
to interpolate observable values and hence Vu (xu ), u ⊆ Ω, the
ME-PC method is especially useful as it effectively tailors polynomial bases on cuts by adaptively and recursively dividing
the cut into small elements and generating separate low-order
generalized polynomial chaos (gPC) polynomial approximation
to V (x) on each element. While obtaining the coefficients of
each low-order gPC expansion on each element, the method
uses the quasi-static FD simulator to obtain V (x) on collocation/integration points dictated by the selected multidimensional
integration rule. The reader is referred to [44]–[46] for details
of the ME-PC method.
C. Quasi-Static FD-Based TMS Simulator
To approximate each component function, the observable
values at integration/collocation points required by the MEPC method are computed using a quasi-static FD simulator.
This simulator outputs the magnitudes of E-fields induced at
Nobs points rn , n = 1, . . . , Nobs , selected on the head model
(i.e., E(rn ) = (Ex (rn )2 + Ey (rn )2 + Ez (rn )2 )0.5 ). The Efields are generated by TMS coils driven with a time-varying
current p(t) with maximum frequency in the 1–10 kHz range.
Therefore, the electric and magnetic fields induced at rn are
actually time varying. However, because of the frequency range
of p(t), the following quasi-static assumptions are valid: 1)
inductive coupling involving Eddy and displacement currents
generated inside the brain are neglected; and 2) the time variation of H- and E-fields is proportional to the current pulse and
its time derivative, respectively, i.e., H(rn , t) = H(rn )p(t), and
E(rn , t) = E(rn )dp(t) / dt. Consequently, the quasi-static FD
simulator determines the E-field per unit dp(t) / dt (i.e., E(rn ))
generated during TMS (see [49] for more information about
quasi-static FD simulator).
III. NUMERICAL RESULTS AND DISCUSSION

|u| ≥ 2.

(7)
As an additional stopping criterion, the relative difference
between observable means computed at two consecutive levels is used [33]; if it is smaller than a prescribed tolerance ε2 ,
then the HDMR expansion is assumed to have converged. Once
the surrogate model of V (x) is computed, the statistical moments of V (x) are estimated via MC. If wi (·), i = 1, . . . , Ndof ,
are uniform distributions, the mean of V (x) can directly be

This section illustrates the application of the proposed computational framework to the calculation of means and standard
deviations of TMS-induced E-fields inside three-sphere and realistic MRI-derived head models. Unless specified otherwise,
an iterative HDMR technique with ε1 = 10−4 and ε2 = 10−16
is used to construct the HDMR expansions that define V (x)’s
surrogate models. Also, the random variables are assumed uniformly distributed within specified ranges and the means and
standard deviations (i.e., square roots of the variance) of V (x)

GOMEZ et al.: UNCERTAINTY QUANTIFICATION IN TRANSCRANIAL MAGNETIC STIMULATION VIA HIGH-DIMENSIONAL MODEL

365

TABLE I
VALUES OF a i , bi , AND x̄i , i = 1, . . . , 5 (FOR THE THREE-SPHERE HEAD
MODEL SCENARIO)

i
i
i
i
i

Fig. 1. (a) Three-sphere head model with the Figure-8 coil positioned 1 cm
above the head and centered about the z-axis. (b) Statistics of E-fields’ magnitudes are obtained on a Cartesian grid (indicated with red points on a green
square plane in top view).

are computed using (8) and (9). The observables are the magnitudes of E-fields, Vn (x) = E(rn , x), n = 1, . . . , Nobs , computed at Nobs points selected in the head models. The average
error in the surrogate models of the E-fields’ magnitudes is
computed using
err =
1
Nobs

N
obs

n =1

	


160

160


(Vns (xi ) − Vn (xi ))2 /
Vn (xi )2
i=1

i=1

(10)
where xi is the randomly chosen evaluation point and Vns (xi ) is
the approximate observable value at xi probed from the surrogate model of the E-field’s magnitude at the nth point selected
in the head model. In what follows, x with dot(s) represents a
random vector of random variables with indices belonging to
u  Ω = {1, . . . , Ndof }; the random variables with indices not
belonging to u are set to their corresponding mean values.
A. Three-Sphere Head Model
To provide intuition regarding the effects of uncertainties
on TMS-induced E-fields, the proposed method is first applied
to statistically characterize E-field magnitudes inside a simple
three-sphere head model formed by three concentric spheres
with radii of 8.0, 8.5, and 9.2 cm [see Fig. 1(a)]. The layers in
the head model represent brain (innermost), the skull, and skin
(outermost) tissues [see Fig. 1(a)]. The head model is assumed
centered about the origin and excited by a (simulated) Figure-8
coil [50] located at (0, 0, 10.2) cm that consists of two filamentary circular loops with radii of 2.3 cm; each loop is positioned
perpendicular to the z-axis and driven with a current varying at
a rate of 1.368 A/ns.
Five parameters characterize the uncertainty in the head
model and TMS setup (Ndof = 5): the conductivity of the brain

=
=
=
=
=

1, σ b r a i n (S/m)
2, σ s k u l l (S/m)
3, σ s k i n (S/m)
4, C x (cm)
5, C y (cm)

ai

bi

x̄ i

0.3825
0.0425
0.3825
−1.0
−1.0

0.5175
0.0575
0.5175
1.0
1.0

0.4500
0.0500
0.4500
0.0
0.0

σbrain , the conductivity of the skull σskull , the conductivity of
the skin σskin , the position of Figure-8 coil along the x-direction
Cx , and the position of the Figure-8 coil along the y-direction Cy
(i.e., x = [σbrain , σskull , σskin , Cx , Cy ]). All five random variables are assumed to be uniformly distributed in ranges [ai , bi ],
i = 1, . . . , 5; ai and bi are given in Table I. (Note: the means of
the random variables pertinent to the tissues’ conductivities in
Table I, i.e., x̄i , i = 1, . . . , 3, correspond to the values of tissues’
conductivities of the three-sphere model in [51].) The observables are the magnitudes of E-fields computed at 121 points
(Nobs = 121) selected on a Cartesian grid that is centered at
(0, 0, 0.65) cm and positioned perpendicular to the z-axis; the
points are situated 0.3 cm apart from each other [see Fig. 1(b)].
Surrogate models of all observables Vns (x), n = 1, . . . , 121 are
obtained using the proposed method, required 680 deterministic FD simulations and err = 2.16 × 10−4 . Using the surrogate models, the means and standard deviations of Vn (x),
n = 1, . . . , 121, are computed [see Fig. 2(a) and (b)]. To separately assess the sensitivity of the E-field magnitudes to uncertain quantities in TMS setup and uncertain quantities related to
brain anatomy, two types of data are extracted from the surrogate models. First, the random variables are restricted to the coil
parameters, i.e., ẋ = [Cx , Cy ], and the means and standard deviations of Vn (ẋ) are computed [see Fig. 2(c) and (d)]. Second,
the random variables are limited to the tissue conductivities,
i.e., ẍ = [σbrain , σskull , σskin ], and the means and standard deviations of Vn (ẍ) are computed [see Fig. 2(e) and (f)].
Several observations about the results in Fig. 2(a)–(f) are as
follows.
1) The results in Fig. 2(a) and (b) appear very similar to
those in Fig. 2(b) and (d), respectively. This implies that
uncertainty in the coil position significantly affects the
induced E-fields.
2) In Fig. 2(a) and (c), the means of the E-fields on points
near the center of the grid, i.e., right below the coil, are
larger than those on points near to the (left and right) edges
of the grid. This is not surprising since points right below
the coil are closer to the coil than the points near the edges
of grid. In Fig. 2(b) and (d), the standard deviations of the
E-fields on points near the (left and right) edges of the grid
are larger than those on points closer to the center since
the distance from the center of the coil to the edges of the
grid exhibits a larger variation than that of points near the
center of the grid.
3) The maximum standard deviation of Vn (ẍ) [see Fig. 2(f)]
is 70 times smaller than the minimum standard deviation

366

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Fig. 3. Realistic head model generation procedure: (i) conductivity values are
assigned to the segmented images of the skin (green) CSF (yellow), skull (gray),
WM (red), and GM (blue). (ii) WM and GM are shrunk and the displaced volume
is replaced with CSF. (iii) Images are combined to generate an MRI-derived head
model.

Fig. 2. Statistical moments of the E-fields’ magnitudes on points selected on
a Cartesian grid: (a) means and (b) standard deviations of V n (x), (c) means
and (d) standard deviations of V n (ẋ), and (e) means and (f) standard deviations
of V n (ẍ).

of Vn (x) [see Fig. 2(b)]. Hence, it is concluded that uncertainty in values of tissue conductivities do not significantly
affect the induced E-fields.
B. MRI-Derived Realistic Head Model
Next, the proposed computational framework is used to
estimate the statistics of E-field magnitudes induced inside
MRI-derived realistic head models, each of which contains
skin, skull, CSF, GM, and white matter (WM) tissues (see
Fig. 3). The head models were derived from an MRI image of a male subject’s head obtained using a 3T GE Signa
scanner (Waukesha, WI) that generated an IR-prepped, 3-D,
SPGR pulse sequence (TR = 9.03, TE = 1.84, TI = 500 ms,
FOV = 24 cm, slice thickness = 1.2 mm, number of voxels =
256 × 256 × 124). The MRI image was segmented into GM,
WM, and ventricular CSF using the SPM5 segmentation toolbox
available in [52]. The remaining unclassified tissue was further
partitioned into bone, muscle, and CSF, using FAST component
of the image analysis package available in [53] (see Fig. 3). The
head models are obtained by 1) shrinking the GM and WM tissues in size by a shrink factor sf ; 2) adding CSF to the displaced
volume; 3) assigning conductivities to the segmented images of
skin σskin , skull σskull , CSF σCSF , GM σGM , and WM σW M ,

Fig. 4.

Configuration of Medtronic MC-B70 Figure-8 coil (P/N 9790).

respectively; and 4) assigning a conductivity to each voxel equal
to the average conductivities of tissues inside it (see Fig. 3). For
each head model, a global Talairach coordinate system is defined
[54]. The model is excited by a (simulated) Medtronic MC-B70
Figure-8 coil (P/N 9790) [12] (see Fig. 4) consisting of two
spiral wings, each of which has ten wire turns and inner/outer
radii of 12 mm/54 mm, and is driven by a current varying at a
rate of 0.171 A/ns. The left and right windings are bent by angles
of 18.5° and 16°, respectively, and positioned 5 mm away from
one another (measured at the center of the coil) (see Fig. 4).
The coil is centered at rcoil = Cx x̂ + Cy ŷ + rcen , where Cx
and Cy represent the coil position along x - and y  -directions
defined along orthonormal vectors x̂ and ŷ , respectively; rcen
is defined as the origin of the local coordinate system (i.e., the
nominal position of the coil center in the global Talairach coordinate system) (see Fig. 5). The coil is rotated by angle θ defined

GOMEZ et al.: UNCERTAINTY QUANTIFICATION IN TRANSCRANIAL MAGNETIC STIMULATION VIA HIGH-DIMENSIONAL MODEL

367

Fig. 5. Coil is positioned along x and y  directions defined along x̂  and ŷ 
unit vectors in a local coordinate system. The coil is rotated with θ angle defined
between the line connecting the centers of wings (indicated with dotted red line)
and x̂  unit vector.
TABLE II
VALUES OF a i , bi , AND x̄i , i = 1, . . . , 9 (FOR THE MRI-DERIVED HEAD
MODEL SCENARIO)

i
i
i
i
i
i
i
i
i

=
=
=
=
=
=
=
=
=

1, σ s k i n (S/m)
2, σ s k u l l (S/m)
3, σ C S F (S/m)
4, σ W M (S/m)
5, σ G M (S/m)
6, sf
7, C x (cm)
8, C y (cm )
9, θ ( ◦ )

ai

bi

x̄ i

0.3952
0.0085
1.3073
0.1131
0.3400
0.0
−1.0
−1.0
0

0.5348
0.0115
1.7687
0.1530
0.4600
0.1
1.0
1.0
90

0.4650
0.0100
1.5380
0.1331
0.4000
0.05
0.0
0.0
45

between the line joining the centers of the wings and the x̂ unit
vector (see Fig. 5); the line joining the centers of the wings is
parallel to the x̂ and ŷ unit vectors when θ = 0 ◦ and θ = 90 ◦ ,
respectively (see Fig. 5). (Note: parametric descriptions for the
variations of gyral folding patterns between individuals’ brains
are not available in the literature; hence, the effects of uncertainty in the gyral folds on the TMS-induced E-fields are not
quantified in this study.)
Nine parameters characterize the uncertainty in the
head model and TMS setup (Ndof = 9): x = [σskin ,
σskull , σCSF , σW M , σGM , sf, Cx , Cy , θ]. All random variables
are assumed uniformly distributed in ranges [ai , bi ], i =
1, . . . , 9; ai and bi are given in Table II. (Note: the means of
random variables pertinent to the tissues’ conductivities in Table II, i.e., x̄i , i = 1, . . . , 5, correspond to the values of these
tissues’ conductivities in [55].) The observables are the magnitudes of the E-fields at the centers of voxels which have GM
inside and are inside a hexahedral region (with dimensions of
4.56 × 5.16 × 8.28 cm) centered at (−3.66, 3.72, 0.9) cm (in
the Talairach coordinate system) (see Fig. 6). The total number of voxels inside the hexahedral region that sit in the GM is
Nobs = 24 642. The surrogate models of all observables Vns (x),
n = 1, . . . , 24 642 are obtained using the proposed method, required 1416 deterministic simulations and err = 3.32 × 10−2 .
Using the surrogate models, the means and standard deviations
of Vn (x), n = 1, . . . , 24 642 are computed [see Fig. 7(a) and
(b)].
1) Combined Effects of Uncertain Quantities to the E-Fields:
To separately observe the combined effects of random variables pertinent to the TMS setup and the combined effects of

Fig. 6. Statistics of E-fields’ magnitudes are obtained at centers of voxels
inside a targeted hexahedral region (indicated as the red region in an MRIderived head model); each voxel has GM inside. The red dot on targeted region
indicates targeted point.

Fig. 7. Statistical moments of the E-fields’ magnitudes at centers of voxels:
(a) means and (b) standard deviations of V n (x), (c) means and (d) standard
deviations of V n (ẋ), and (e) means and (f) standard deviations of V n (ẍ). The
red dot indicates the targeted point.

random variables related to brain anatomy on E-fields’ magnitudes, two types of data are extracted from the surrogate models.
First, the random variables are restricted to the coil parameters,
i.e., ẋ = [Cx , Cy , θ], and the means and standard deviations
of Vn (ẋ) are computed [see Fig. 7(c) and (d)]. Second, the
random variables are limited to the quantities related to brain
anatomy, i.e., ẍ = [σskin , σskull , σCSF , σW M , σGM , sf ], and the
means and standard deviations of Vn (ẍ) are computed [see
Fig. 7(e) and (f)]. (Note: Table III lists the random variables in
each case.)

368

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

TABLE III
DESCRIPTION OF RANDOM VARIABLES AND THE RATIOS OF THE STANDARD
DEVIATIONS OF THE INDUCED E-FIELDS TO THEIR MEANS IN THREE CASES

x = [σ s k i n , σ s k u l l , σ C S F , σ W M , σ G M , sf , C x , C y , θ ]
ẋ = [C x , C y , θ ]
ẍ = [σ s k i n , σ s k u l l , σ C S F , σ W M , σ G M , sf ]

TABLE IV
DESCRIPTION OF RANDOM VARIABLES AND THE RATIOS OF THE STANDARD
DEVIATIONS OF THE INDUCED E-FIELDS TO THEIR MEANS IN FOUR CASES

Description

Ratio

Random Vector

All parameters
Coil parameters
Head parameters

0.40
0.27
0.29

ẋ = [C x , C y ]
ẍ = [θ ]
...
x = [sf ]
....
x = [σ s k i n , σ s k u l l , σ C S F , σ W M , σ G M ]

...

Fig. 8. Standard deviations of (a) V n (ẋ), (b) V n (ẍ), (c) V n ( x ), and (d)
....
V n ( x ). The red dot indicates the targeted point.

Several observations about the results in Fig. 7 are as follows.
1) In Fig. 7(a), (c), and (e), the maxima of the means of
the induced E-fields occur directly under the coil wings.
The means of Vn (ẍ) diffuse rapidly [see Fig. 7(e)].
On the other hand, as the changes in coil parameters directly affect the location and bounds of the stimulated region, the means of Vn (x) and Vn (ẋ) [see Fig. 7(a) and (c)]
diffuse slowly compared those of Vn (ẍ) [see Fig. 7(e)].
In other words, the E-field plot in Fig. 7(e) has a sharper
color gradient from red to dark blue compared to the plots
in Fig. 7(a) and (c).
2) In Fig. 7(b), (d), and (f), the maxima of the standard deviations of Vn (x), Vn (ẋ), and Vn (ẍ) are 29 V/m, 22 V/m,
and 22 V/m, respectively. Therefore, the induced E-fields
appear sensitive to uncertain quantities in the TMS setup
and uncertain quantities related to brain anatomy.
To separately and quantitatively assess the combined effects
of all random variables, x, the random variables pertinent to
the TMS setup, ẋ, and the random variables related to brain
anatomy, ẍ, on the magnitude of E-field at the targeted point
(indicated in Fig. 7), the ratios of the standard deviations of
E-fields to their means are computed for these three cases and
presented in Table III. Needless to say, the uncertainty in TMS
setup and the uncertainty related to brain anatomy have equal
impact on the E-fields induced on targeted point. And uncertainty in TMS setup and uncertainty related to brain anatomy
collectively change the E-field at the targeted point by 40%.
2) Individual and Combined Effects of Uncertain Quantities
to the E-fields: To observe the individual and combined effects

Description

Ratio

Coil position
Coil orientation
Shrink factor
Tissue conductivities

0.13
0.22
0.28
0.01

of uncertain quantities in TMS setup and uncertain quantities
related to brain anatomy on the induced E-fields, four types
of data are extracted from the surrogate models. The random
variables are restricted to the positions of coil along x - and y  directions, i.e., ẋ = [Cx , Cy ], orientation of coil, i.e., ẍ = [θ],
...
the shrink factor, i.e., x = [sf ], and the tissue conductivities,
....
i.e., x = [σskin , σskull , σCSF , σW M , σGM ], and the standard de...
viations of Vn (ẋ) [see Fig. 8(a)], Vn (ẍ) [see Fig. 8(b)], Vn ( x)
....
[see Fig. 8(c)], and Vn ( x ) [see Fig. 8(d)], are computed, respectively. (Note: Table IV lists the random variables in each case.)
Several observations about the results in Fig. 8 are as follows.
1) In Fig. 8(a), the standard deviations of E-fields induced
on the region right below the center of the coil (i.e., the
region around the targeted point) are smaller than the
standard deviations of those induced in other regions. This
is because the proximity of this region to the coil does not
change significantly compared to those of nearby regions
when the position of the coil is changed (just like in threesphere head model). In Fig. 8(b), the standard deviations
of the E-fields induced on the targeted point do not change
much because this point is the center of rotation of the coil.
On the other hand, as expected, the standard deviations of
E-fields induced on regions surrounding this point change
significantly. Note that the standard deviations of Vn (ẍ) on
the regions surrounding the targeted point [see Fig. 8(b)]
are considerably larger than those of Vn (ẋ) on the same
regions [see Fig. 8(a)].
2) In Fig. 8(c), the standard deviations of induced E-fields
at the targeted point and its surrounding region are large.
This is not surprising as the magnitudes of induced Efields directly under the coil decrease significantly when
the brain is shrunk, i.e., the scalp-to-cortex distance is
increased. Like in the three-sphere head model example,
it is apparent from Fig. 8(d) that uncertainty in the values
of tissue conductivities does not significantly affect the
induced E-fields.
To quantitatively and separately assess the combined effect of
the random variables pertinent to positions of coils, ẋ, the individual effect of random variable related to orientation of coil, ẍ,
the individual effect of random variable related to shrink factor,
...
x, and the combined effect of random variables related to tissue
....
conductivities, x , on the magnitude of E-field at the targeted
point (indicated in Fig. 8), the ratios of the standard deviations
of E-fields to the means of E-fields are computed for these four
cases and presented in Table IV. Apparently, the uncertainty
in coil orientation and the uncertainty in the scalp-to-cortex

GOMEZ et al.: UNCERTAINTY QUANTIFICATION IN TRANSCRANIAL MAGNETIC STIMULATION VIA HIGH-DIMENSIONAL MODEL

369

Fig. 9. (a) Coronal slice (depicted by the purple transparent plane) passing
through the cortical region. The standard deviations of (b) V n (ẋ), (c) V n (ẍ),
...
and (d) V n ( x ).

distance have significant impact on the E-fields induced on targeted point.
Fig. 8 shows the statistics of the induced E-fields on the
surface of targeted cortical region. To observe the statistics of
induced E-fields inside cortical region, a coronal slice passing
through the cortical region is selected [see Fig. 9(a)]. The standard deviations of Vn (ẋ) [see Fig. 9(b)], Vn (ẍ) [see Fig. 9(c)],
...
and Vn ( x) [see Fig. 9(d)] on the coronal slice are computed.
Not surprisingly, the standard deviations of induced E-fields on
the surface of cortical region are larger than those inside the
cortical region [see Fig. 9(b)–(d)].
In addition, E-field distributions in the stimulated region, assumed to be the region inside which the magnitudes of E-fields
are larger than half of the maximum E-field’s magnitude, are
observed when each of the random variables Cx , Cy , θ, and sf
is set to end points on its corresponding 1-D random domain
while all remaining random variables are set to their mean values
[see Fig. 10(a)–(h)]. Specifically, the E-field distribution in the
stimulated region are shown for Cx = −1.0 cm [see Fig. 10(a)],
Cx = 1.0 cm [see Fig. 10(b)], Cy = −1.0 cm [see Fig. 10(c)],
Cy = 1.0 cm [see Fig. 10(d)], θ = 0◦ [see Fig. 10(e)], θ = 90◦
[see Fig. 10(f)], sf = 0.0 [see Fig. 10(g)], and sf = 0.1 [see
Fig. 10(h)].
Several observations about the results in Fig. 10 are as follows.
1) Fig. 10(a)–(d) shows that a change in coil position results
in a shift of the location of the stimulated region.
2) Fig. 10(e) and (f) demonstrates that a change in the orientation of the coil results in a rotation of the elliptical
stimulated region around the targeted point.
3) Fig. 10(g) and (h) shows that the maximum E-field magnitude is reduced by a factor of 2.28 when the scalp-to-cortex
distance increases, yet the shape and location of the stimulated region remain nearly the same. For that reason, a
TMS practitioner should adjust the driver currents of the
coil for different brain sizes as pointed out in [28].

Fig. 10. E-field distribution on stimulated region when (a) C x = −1.0 cm, (b)
C x = 1.0 cm, (c) C y = −1.0 cm, (d) C y = 1.0 cm, (e) θ = 0 ◦ , (f) θ = 90 ◦ ,
(g) sf = 0.0, and (h) sf = 0.1. The red dot indicates the targeted point.

4) Although the target point is stimulated in all cases, the
stimulated region surrounding the target point changes
significantly from case to case [see Fig. 10(a)–(h)].
IV. CONCLUSION
A computational framework is proposed for uncertainty quantification in TMS. The framework leverages surrogate models of E-fields induced during TMS by iteratively constructing
HDMR component functions pertinent to the most significant
random variables. Each component function in the HDMR expansions is approximated by the ME-PC method, which effectively tailors the polynomial bases on the support of the component function. The observable values on integration/collocation
points identified by the ME-PC method are computed via a
quasi-static FD solver. The proposed computational framework is highly efficient and accurate compared to traditional
MC methods.
The application of the proposed framework to realistic MRIderived head models showed that differences in tissue conductivities have a small effect on E-field magnitudes, while the coil

370

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

position and orientation, and brain size have significant effects
on the magnitude of the E-field. Quantitatively, 2 cm uncertainty
in the positions of a coil along the x and y  directions results in
13% change in the induced E-fields at the targeted point while
90◦ uncertainty in the coil orientation results in 22% change in
the induced E-fields at the targeted point. In addition, an uncertainty of 10% of the brain volume results in a 28% change in
the induced E-fields at the targeted point. It has been recognized
that an increasing scalp-to-cortex distance reduces the strength
of the E-field at the cortex [27], [28], and the results presented
here show how this effect extends across the underlying cortex.
Assuming that the electric field is oriented along the axon on a
bend [9], the results clearly show the significant advantage of
stimulation at gyral crests compared to sulci. Thus, when MRIguided neuronavigation is available [56], practitioners consider
the potential advantage derived from stimulating at the crest
of a gyrus to obtain maximal stimulation. In standard clinical
use without neuronavigation, referenced either to scalp-based
landmarks or motor cortex, variations in induced E-fields due
to the gyral anatomy may affect treatment response. This effect may be somewhat mitigated by the spread of the E-field,
with a full width half-maximum in the range of 2–3 cm, but
with gyral dimensions in a similar size range, individual differences in gyral anatomy will affect the strength of the neural
response.
Significant amounts of deviation were found in the E-field
magnitude associated with coil placement, evaluating the effects over 2 cm in each direction of a 2-D plane of TMS coil.
This may be considered a conservative estimate of the range of
difference between scalp location and intended cortical target,
and the results demonstrate the wide extent of cortex which
might be affected with this level of uncertainty in positioning,
covering the better part of the dorsal–lateral prefrontal cortex.
Certainly, it is possible to reduce this uncertainty within an
individual patient by developing reliable coil placement procedures combined with neuronavigation. However, with current
estimates of inaccuracy between the scalp location and desired
cortical target, the simulations give a precise quantification of
the effect of this inaccuracy on cortical targeting. The quantified
inaccuracy may reduce the response rates of the therapy.
The present work has developed an efficient computational
framework enabling the accurate estimation of uncertainty in
the E-field strength with TMS as commonly practiced for neuropsychiatric treatment. However, the computational framework
should have other implications for the field of TMS research
and practice. For instance, practitioners often need to adjust coil
position to minimize painful scalp stimulation. A precise derivation of the range in which acceptable levels of stimulation occur
would permit adjustment of coil position without sacrificing potential therapeutic effects. A relatively simple extension of the
technique can incorporate the effect of the level of TMS intensity, as this variable is often altered during treatment without a
good understanding of how the underlying E-field is affected.
Neuronal network architecture of course is patient specific and
probably influences the response rates of TMS therapy. In the
future, uncertainty quantification techniques could be applied to
analyze how uncertainty in the topology of a neuronal network

results in uncertainty in the outcome of the TMS procedure.
Furthermore, experimental setups can use this framework to incorporate observed error in coil placement into the estimate of
E-field strength at the cortex.
REFERENCES
[1] A. Ellison and A. Cowey, “Time course of the involvement of the ventral
and dorsal visual processing streams in a visuospatial task,” Neuropsychologia, vol. 45, pp. 3335–3339, 2007.
[2] N. Levit-Binnun, N. Z. Handzy, E. Moses, I. Modai, and A. Peled,
“Transcranial magnetic stimulation at M1 disrupts cognitive networks
in schizophrenia,” Schizophrenia Res., vol. 93, pp. 334–344, 2007.
[3] A. Pascual-Leone, V. Walsh, and J. Rothwell, “Transcranial magnetic
stimulation in cognitive neuroscience—Virtual lesion, chronometry, and
functional connectivity,” Curr. Opin. Neurobiol., vol. 10, pp. 232–237,
2000.
[4] D. Pitcher, V. Walsh, G. Yovel, and B. Duchaine, “TMS evidence for the
involvement of the right occipital face area in early face processing,” Curr.
Biol., vol. 17, pp. 1568–1573, 2007.
[5] J. C. Rothwell, “Paired-pulse investigations of short-latency intracortical facilitation using TMS in humans,” Transcranial Magn. Stimulation,
vol. 51, pp. 113–119, 1999.
[6] T. Burt, S. H. Lisanby, and H. A. Sackeim, “Neuropsychiatric applications
of transcranial magnetic stimulation: A meta analysis,” Int. J. Neuropsychopharmacol., vol. 5, pp. 73–103, 2002.
[7] S. Kähkönen and R. J. Ilmoniemi, “Transcranial magnetic stimulation: Applications for neuropsychopharmacology,” J. Psychopharmacol.,
vol. 18, pp. 257–261, 2004.
[8] S. H. Lisanby, L. H. Kinnunen, and M. J. Crupain, “Applications of TMS
to therapy in psychiatry,” J. Clin. Neurophysiol., vol. 19, pp. 344–360,
2002.
[9] B. J. Roth, “Mechanisms for electrical stimulation of excitable tissue,”
Crit. Rev. Biomed. Eng., vol. 22, pp. 253–305, 1994.
[10] P. J. Maccabee, V. E. Amassian, L. P. Eberle, and R. Q. Cracco, “Magnetic
coil stimulation of straight and bent amphibian and mammalian peripheral
nerve in vitro: Locus of excitation,” J. Physiol., vol. 460, pp. 201–219,
1993.
[11] S. Silva, P. Basser, and P. Miranda, “Elucidating the mechanisms and
loci of neuronal excitation by transcranial magnetic stimulation using a
finite element model of a cortical sulcus,” Clin. Neurophysiol., vol. 119,
pp. 2405–2413, 2008.
[12] A. Thielscher and T. Kammer, “Electric field properties of two commercial Figure-8 coils in TMS: Calculation of focality and efficiency,” Clin.
Neurophysiol., vol. 115, pp. 1697–1708, 2004.
[13] A. Thielscher, A. Opitz, and M. Windhoff, “Impact of the gyral geometry on the electric field induced by transcranial magnetic stimulation,”
Neuroimage, vol. 54, pp. 234–243, 2011.
[14] M. S. George, E. M. Wassermann, W. A. Williams, A. Callahan, T. A.
Ketter, P. Basser, M. Hallett, and R. M. Post, “Daily repetitive transcranial
magnetic stimulation (rTMS) improves mood in depression,” NeuroReport, vol. 6, pp. 1853–1856, 1995.
[15] A. Pascual-Leone, B. Rubio, F. Pallardó, and M. D. Catalá, “Rapid-rate
transcranial magnetic stimulation of left dorsolateral prefrontal cortex in
drug-resistant depression,” Lancet, vol. 348, pp. 233–237, 1996.
[16] U. Herwig, F. Padberg, J. Unger, M. Spitzer, and C. Schönfeldt-Lecuona,
“Transcranial magnetic stimulation in therapy studies: Examination of
the reliability of “standard” coil positioning by neuronavigation,” Biol.
Psychiatry, vol. 50, pp. 58–61, 2001.
[17] H. H. Jasper, “The ten twenty electrode system of the international federation,” Electroencephalogr. Clin. Neurophysiol., vol. 10, pp. 371–375,
1958.
[18] U. Herwig, P. Satrapi, and C. Schönfeldt-Lecuona, “Using the International 10-20 EEG system for positioning of transcranial magnetic stimulation,” Brain Topogr., vol. 16, pp. 95–99, 2003.
[19] R. Sparing, D. Buelte, I. G. Meister, T. Pauš, and G. R. Fink, “Transcranial
magnetic stimulation and the challenge of coil placement: A comparison
of conventional and stereotaxic neuronavigational strategies,” Hum. Brain
Mapping, vol. 29, pp. 82–96, 2008.
[20] R. Ahdab, S. S. Ayache, P. Brugières, C. Goujon, and J. P. Lefaucheur,
“Comparison of “standard” and “navigated” procedures of TMS coil
positioning over motor, premotor and prefrontal targets in patients
with chronic pain and depression,” Neurophysiol. Clin., vol. 40,
pp. 27–36, 2010.

GOMEZ et al.: UNCERTAINTY QUANTIFICATION IN TRANSCRANIAL MAGNETIC STIMULATION VIA HIGH-DIMENSIONAL MODEL

[21] T. Kammer, M. Vorwerg, and B. Herrnberger, “Anisotropy in the visual
cortex investigated by neuronavigated transcranial magnetic stimulation,”
Neuroimage, vol. 36, pp. 313–321, 2007.
[22] P. T. Fox, S. Narayana, N. Tandon, H. Sandoval, S. P. Fox, P. Kochunov,
and J. L. Lancaster, “Column-based model of electric field excitation of
cerebral cortex,” Hum. Brain Mapping, vol. 22, pp. 1–14, 2004.
[23] L. Richter, P. Trillenberg, A. Schweikard, and A. Schlaefer, “Stimulus
intensity for hand held and robotic transcranial magnetic stimulation,”
Brain Stimulation, vol. 6, pp. 315–321, 2013.
[24] S. Knecht, J. Sommer, M. Deppe, and O. Steinsträter, “Scalp position
and efficacy of transcranial magnetic stimulation,” Clin. Neurophysiol.,
vol. 116, pp. 1988–1993, 2005.
[25] N. Toschi, M. E. Keck, T. Welt, and M. Guerrisi, “Quantifying uncertainty
in transcranial magnetic stimulation—A high resolution simulation study
in ICBM space,” in Proc. Ann. Int. Conf. IEEE Eng. Med. Biol. Soc., 2012,
pp. 1218–1221.
[26] E. R. Sowell, B. S. Peterson, E. Kan, R. P. Woods, J. Yoshii, R. Bansal, D.
Xu, H. Zhu, P. M. Thompson, and A. W. Toga, “Sex differences in cortical
thickness mapped in 176 healthy individuals between 7 and 87 years of
age,” Cerebral Cortex, vol. 17, pp. 1550–1560, 2007.
[27] J. Sommer, O. Steinstrater, C. Breitenstein, A. Jansen, C. Konrad, M.
Deppe, A.-F. Foerster, E. Ringelstein, and S. Knecht, “Interindividual
variability in the cortex-to-scalp distance,” Neuroimage, vol. 19, p. S47,
2003.
[28] M. G. Stokes, C. D. Chambers, I. C. Gould, T. R. Henderson, N. E.
Janko, N. B. Allen, and J. B. Mattingley, “Simple metric for scaling
motor threshold based on scalp-cortex distance: Application to studies using transcranial magnetic stimulation,” J. Neurophysiol., vol. 94,
pp. 4520–4527, 2005.
[29] S. Gabriel, R. Lau, and C. Gabriel, “The dielectric properties of biological
tissues: II. Measurements in the frequency range 10 Hz to 20 GHz,” Phys.
Med. Biol., vol. 41, pp. 2251–2269, 1996.
[30] G. S. Fishman, Monte Carlo: Concepts, Algorithms, and Applications.
Berlin, Germany: Springer-Verlag, 1995.
[31] H. Rabitz, Ö. F. Alis, J. Shorter, and K. Shim, “Efficient input-output
model representations,” Comput. Phys. Commun., vol. 117, pp. 11–20,
1999.
[32] J. Foo and G. E. Karniadakis, “Multi-element probabilistic collocation
method in high dimensions,” J. Comput. Phys., vol. 229, pp. 1536–1557,
2010.
[33] X. Ma and N. Zabaras, “An adaptive high-dimensional stochastic model
representation technique for the solution of stochastic partial differential
equations,” J. Comput. Phys., vol. 229, pp. 3884–3915, 2010.
[34] A. C. Yucel, H. Bagci, and E. Michielssen, “Fast probability density
function estimation for statistical EMC/EMI characterization,” presented
at the Proc. USNC/URSI National Radio Science Meeting, Charleston,
SC, USA, 2009.
[35] H. Bagci, C. Yavuz, A. C. Yucel, J. S. Hesthaven, and E. Michielssen, “A
fast and parallel Stroud-based stochastic collocation method for statistical
EMI/EMC analysis,” in Proc. IEEE Int. Symp. Electromagn. Compat.,
Detroit, MI, USA, 2008, pp. 1–5.
[36] L. R. A. X. de Menezes, A. Ajayi, C. Christopoulos, P. Sewell, and G.
A. Borges, “Efficient computation of stochastic electromagnetic problems
using unscented transforms,” IET Sci. Meas. Technol., vol. 2, pp. 88–95,
2008.
[37] H. Bagci, A. C. Yucel, J. S. Hesthaven, and E. Michielssen, “A fast Stroudbased collocation method for statistically characterizing EMI/EMC phenomena on complex platforms,” IEEE Trans. Electromagn. Compat.,
vol. 51, no. 2, pp. 301–311, May 2009.
[38] F. Diouf and F. Canavero, “Crosstalk statistics via collocation method,”
in Proc. IEEE Int. Symp. Electromagn. Compat., Austin, TX, USA, 2009,
pp. 92–97.
[39] A. C. Yucel, Y. Liu, H. Bagci, and E. Michielssen, “Statistical characterization of electromagnetic wave propagation in mine environments,” IEEE
Antennas Wireless Propag. Lett., vol. 12, pp. 1602–1605, 2013.
[40] A. C. M. Austin, N. Sood, J. Siu, and C. D. Sarris, “Application of polynomial chaos to quantify uncertainty in deterministic channel models,” IEEE
Trans. Antennas Propag., vol. 61, no. 11, pp. 5754–5761, Nov. 2013.
[41] O. Bakir, A. C. Yucel, E. Michielssen, and H. Bagci, “Statistical characterization of wave propagation in mine environments,” in Proc. IEEE
Antennas and Propag. Soc. Int. Symp., 2012, pp. 1–2.
[42] J. S. Ochoa and A. C. Cangellaris, “Expedient electromagnetic analysis
of the impact of statistical disorder in periodic waveguides,” IEEE Trans.
Microw. Theory Tech., vol. 60, no. 12, pp. 3919–3926, Dec. 2012.
[43] O. Aiouaz, D. Lautru, M.-F. Wong, E. Conil, A. Gati, J. Wiart, and V. F.
Hanna, “Uncertainty analysis of the specific absorption rate induced in a
phantom using a stochastic spectral collocation method,” Ann. Telecommun., vol. 60, pp. 409–418, 2011.

371

[44] J. Foo, X. Wan, and G. E. Karniadakis, “The multi-element probabilistic collocation method (ME-PCM): Error analysis and applications,”
J. Comput. Phys., vol. 227, pp. 9572–9595, 2008.
[45] A. C. Yucel, H. Bagci, and E. Michielssen, “An adaptive multi-element
probabilistic collocation method for statistical EMC/EMI characterization,” IEEE Trans. Electromagn. Compat., vol. 55, no. 6, pp. 1154–1168,
Dec. 2013.
[46] A. C. Yucel, H. Bagci, and E. Michielssen, “An h-adaptive stochastic
collocation method for stochastic EMC/EMI analysis,” in Proc. IEEE Int.
Symp. Antennas Propag., 2010, pp. 1–4.
[47] A. C. Yucel, H. Bagci, and E. Michielssen, “Efficient stochastic EMC/EMI
analysis using HDMR-generated surrogate models,” in Proc. 30th URSI
Gen. Assem. Sci. Symp., 2011, pp. 1–4.
[48] A. C. Yucel and E. Michielssen, “Efficient GA-based electromagnetic
optimization using HDMR-generated surrogate models,” in Proc. IEEE
Antennas Propag. Soc. Int. Symp., 2012, pp. 1–2.
[49] G. Cerri, R. De Leo, F. Moglie, and A. Schiavoni, “An accurate 3-D
model for magnetic stimulation of the brain cortex,” J. Med. Eng. Technol.,
vol. 19, pp. 7–16, 1995.
[50] S. Ueno, T. Tashiro, and K. Harada, “Localized stimulation of neural
tissues in the brain by means of a paired configuration of time-varying
magnetic fields,” J. Appl. Phys., vol. 64, pp. 5862–5864, 1988.
[51] S. Rush and D. A. Driscoll, “EEG electrode sensitivity—An application
of reciprocity,” IEEE Trans. Biomed. Eng., vol. BME-16, no. 1, pp. 15–22,
Jan. 1969.
[52] SPM5 Segmentation Toolbox Web Site (2005). [Online]. Available:
http://www.fil.ion.ucl.ac.uk/spm/software/spm5/
[53] FMRIB’s Automated Segmentation Tool Web Site (2004). [Online]. Available :http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FAST
[54] J. Talairach and P. Tournoux, Co-Planar Stereotaxic Atlas of the Human
Brain. 3-Dimensional Proportional System: An Approach to Cerebral
Imaging. Stuttgart, Germany: Geroge Thieme, 1988.
[55] F. Salinas, J. Lancaster, and P. Fox, “3D modeling of the total electric field
induced by transcranial magnetic stimulation using the boundary element
method,” Phys. Med. Biol., vol. 54, pp. 3631–3647, 2009.
[56] S. Neggers, T. Langerak, D. Schutter, R. Mandl, N. Ramsey, P. Lemmens,
and A. Postma, “A stereotactic method for image-guided transcranial
magnetic stimulation validated with fMRI and motor-evoked potentials,”
Neuroimage, vol. 21, pp. 1805–1817, 2004.

Luis J. Gomez (S’08) received the B.S. degrees in
electrical engineering and mathematics from the University of Florida, Gainesville, FL, USA, in 2008.
Since August 2008, he has been a Research Assistant
in the Radiation Laboratory, University of Michigan
at Ann Arbor, Ann Arbor, MI, USA, where he is currently working toward the Ph.D. degree.
His main research interest is in computational
electromagnetism, with a focus on wave propagation in highly heterogeneous materials, volume integral equations, and biomedical applications of electromagnetism.
Mr. Gomez received the National Science Foundation Graduate Fellowship.
Abdulkadir C. Yücel received the B.S. degree in
electronics engineering (Summa Cum Laude) from
the Gebze Institute of Technology, Kocaeli, Turkey,
in 2005, and the M.S. and Ph.D. degrees in electrical
engineering from the University of Michigan, Ann
Arbor, MI, USA, in 2008 and 2013, respectively.
From September 2005 to August 2006, he was a
Research and Teaching Assistant in the Electronics
Engineering Department, Gebze Institute of Technology. From August 2006 to May 2013, he was a
Graduate Student Research Assistant in the Radiation
Laboratory, University of Michigan, where he has been a Research Fellow since
May 2013. His research interests include various aspects of computational electromagnetics with emphasis on uncertainty quantification for electromagnetic
analysis on complex platforms, electromagnetic compatibility and interference
analysis, nature-based design of electromagnetic devices, and integral equationbased frequency and time-domain solvers and their accelerators.
Dr. Yücel received the Fulbright Fellowship in 2006 and Electrical Engineering and Computer Science Departmental Fellowship of University of Michigan
in 2007.

372

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Luis Hernandez-Garcia received the B.S. degree in
applied science from the University of North Carolina at Chapel Hill, Chapel Hill, NC, USA, where
he also received the M.S. and Ph.D. degrees in 1994
and 1998, respectively.
He became a Postdoctoral Research Fellow in
the Wake Forest University School of Medicine in
1999, when he joined the faculty of the University
of Michigan, Ann Arbor, MI, USA, as a Research
Scientist in the Biomedical Engineering Department
and the Functional MRI Laboratory. In 2006, he became an Associate Research Professor. He has been serving on the University
of Michigan FMRI Laboratory Advisory Executive Committee since 2011 and
on the Advisory Board member for Advances in Neuropsychiatric Treatment
Conference, San Francisco, CA, USA, since 2012. He served as the Primary
Organizer for the Midwest Regional Fall symposium on MRI, Ann Arbor, in
2007. He is also an Advisor on the Board for the Pediatric Functional Neuroimaging Research at the Cincinnati Children’s Hospital. He has authored or
coauthored 38 peer-reviewed articles and book chapters and 90 presentations at
international conferences, including 14 invited lectures. His research focus is
centered on functional MRI of the brain and on the development of brain stimulation techniques, often in conjunction with each other. More specifically, he has
developed acquisition and analysis techniques for mapping cerebral perfusion
dynamically, and probes for transcranial as well as ultrasound stimulation of the
brain.
Dr. Hernandez-Garcia has served as a Reviewer for major journals in his field
including Neuroimage and Magnetic Resonance in Medicine. He has also served
as a Grant Reviewer for the National Science Foundation and the National Institutes of Health. He has received two major grants from the National Institutes
of Health as the Principal Investigator and as Co-investigator on 12 others. He
received the James Crawford Award to the best graduate in the Applied Science
program from the University of North Carolina at Chapel Hill in 1992. In the
course of his Ph.D. studies, he was awarded a graduate student fellowship from
Magnex Scientific.

Stephan F. Taylor received the B.A. degree from
Northwestern University, Evanston, IL, USA, in
1980, and the M.D. degree from Washington University, St Louis, MO, USA, in 1988.
He completed his psychiatry training at the University of Michigan, as well as a research fellowship
at the Mental Health Research Institute, University
for Michigan in 1993. He joined the faculty at the
University of Michigan, Ann Arbor, MI, USA, in
1993, where he is currently a Professor of psychiatry and an Adjunct Professor of psychology. He also
serves as a Vice-Chairman of the University of Michigan Institutional Review
Board in the Medical School. His research has focused on understanding higher
brain function in the context of psychiatric disorders. Areas of specific focus
have included brain circuits involved in emotion and attention, and disorders
of interest have included schizophrenia, obsessive–compulsive disorder and depression. This work has been carried out with tools provided by neuroimaging
(PET and functional MRI) and event-related potentials. Clinically, he has extensive experience with the treatment of schizophrenia and related psychotic
disorders, and has recently begun the Program for Risk Evaluation and Prevention, designed to identify youth at risk of serious mental illness such as
schizophrenia and conduct research into the early stages of psychosis. He also
directs the Psychiatric Neuromodulation Program, which provides clinical treatment with transcranial magnetic stimulation (TMS), and research using TMS
and deep brain stimulation to translate the understanding of brain pathology
gained through neuroimaging studies to develop and refine new treatments.
Dr. Taylor is a past-President of the Psychiatric Research Society, a member
of the Society of Biological Psychiatry, Society for Neuroscience, Organization
for Human Brain Mapping, and a fellow of the American College of Neuropsychopharmacology. He serves on the editorial boards of Biological Psychiatry
and Neuropsychopharmacology, and he is a standing member of the Adult Psychopathology and Disorders of Aging Study Section of the National Institutes
of Health.

Eric Michielssen (F’02) received the M.S. degree
(Summa Cum Laude) from the Katholieke Universiteit Leuven, Leuven, Belgium, in 1987, and
the Ph.D. degree from the University of Illinois at
Urbana-Champaign (UIUC), Urbana, IL, USA, in
1992, both in electrical engineering.
He joined the faculty of the UIUC Department of
Electrical and Computer Engineering in 1993, reaching the rank of a Full Professor in 2002. In 2005, he
joined the University of Michigan (UM) as a Professor of Electrical Engineering and Computer Science.
Since 2009, he has been directing the UM Computational Science Certificate
Program. He authored or coauthored more than 160 journal papers and book
chapters and more than 300 papers in conference proceedings. His research
interests include all aspects of theoretical and applied computational electromagnetics. His research focuses on the development of fast frequency and
time-domain integral-equation-based techniques for analyzing electromagnetic
phenomena, and the development of robust optimizers for the synthesis of electromagnetic/optical devices.
Dr. Michielssen received a Belgian American Educational Foundation Fellowship in 1988 and a Schlumberger Fellowship in 1990. Furthermore, he
received a 1994 International Union of Radio Scientists (URSI) Young Scientist Fellowship, a 1995 National Science Foundation CAREER Award, and the
1998 Applied Computational Electromagnetics Society (ACES) Valued Service
Award. In addition, he was named 1999 URSI United States National Committee Henry G. Booker Fellow and selected as the recipient of the 1999 URSI
Koga Gold Medal. He also was awarded the UIUC’s 2001 Xerox Award for
Faculty Research, appointed 2002 Beckman Fellow in the UIUC Center for Advanced Studies, named 2003 Scholar in the Tel Aviv University Sackler Center
for Advanced Studies, selected as UIUC 2003 University and Sony Scholar; in
2011, he received the UM College of Engineering David E. Liddle Research
Excellence Award. He is a member of URSI Commission B. He served as the
Technical Chairman of the 1997 ACES Symposium (Review of Progress in
Applied Computational Electromagnetics, March 1997, Monterey, CA, USA),
and served on the ACES Board of Directors (1998–2001 and 2002–2003) and
as ACES Vice-President (1998–2001). From 1997 to 1999, he was an Associate
Editor for Radio Science, and from 1998 to 2008 he served as an Associate
Editor for the IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION.

