348

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Patient Specific Hardware-in-the-Loop Testing
of Cerebrospinal Fluid Shunt Systems
Manuel Gehlen, Vartan Kurtcuoglu, and Marianne Schmid Daners∗

Abstract—Goal: The development of increasingly sophisticated
cerebrospinal fluid (CSF) shunts calls for test beds that can reproduce an ever larger range of physiologic and pathophysiologic
behaviors. In particular, upcoming smart and active devices will require extensive testing under complex dynamic conditions. Herein,
we describe a test bed that allows for fast, cost effective, and realistic
in vitro testing of active and passive, gravitational and nongravitational CSF shunts based on the hardware-in-the-loop principle.
Methods: The shunt to be tested is placed in a dynamic in vitro setup
that interfaces with a mathematical model of the patient’s relevant
physiology, which is evaluated numerically in real time. The model
parameters can be identified using standard clinical tests. The test
bed accounts for posture-dependent behavior and viscoelastic effects. Results: Simulations of infusion tests, of intracranial pressure
modulation by cardiovascular action, and of the effects of postural
changes show good agreement with published results. Evaluation
of valves without and with gravitational units show in modeled sitting patients the expected behavior of overdrainage and avoidance
thereof, respectively. Finally, a 24-h test cycle based on recorded
patient data elucidates the interaction between patient and shunt
system expressed by drainage rate and intracranial pressure during typical daily activities. Conclusion: We envision this test bed as
a tool to quantify a shunt’s performance within a realistic yet reproducible testing environment. Significance: The test bed can improve
our understanding of the complex interaction between patient and
shunt system and may catalyze the development of active shunts,
while reducing the number of necessary in vivo experiments.
Index Terms—Animal testing alternatives, cerebrospinal fluid
(CSF), hardware-in-the-loop, hydrocephalus, in vitro, posture,
shunt, testing.

I. INTRODUCTION
N our current, evolving understanding, “hydrocephalus is an
active distension of the ventricular system of the brain related
to inadequate passage of cerebrospinal fluid (CSF) from its point

I

Manuscript received November 18, 2014; revised March 14, 2015 and June
5, 2015; accepted July 11, 2015. Date of publication July 16, 2015; date of
current version January 16, 2016. This work was supported by grants from the
Swiss Academy of Engineering Sciences (2014-080), the 3R Research Foundation (140-14), and the Swiss National Science Foundation through NCCR
Kidney.CH. Asterisk indicates corresponding author.
M. Gehlen is with the Institute for Dynamic Systems and Control, Department
of Mechanical and Process Engineering, ETH Zurich and also with the Institute
of Physiology, University of Zurich.
V. Kurtcuoglu is with the Institute of Physiology, and also the Neuroscience
Center Zurich, and the Zurich Center for Integrative Human Physiology, University of Zurich.
∗ M. Schmid Daners is with the Product Development Group, Department of
Mechanical and Process Engineering, ETH Zurich, 8092 Zurich, Switzerland
(e-mail: marischm@ethz.ch).
This paper has supplementary downloadable material available at http://
ieeexplore.ieee.org, provided by the authors. This includes one multimedia MP4
format movie clip, which visualizes the test bed described in this manuscript.
This material is 87.8 MB in size.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2457681

of production within the ventricular system to its point of absorption into the systemic circulation” [1]. While this distension
leads to elevated intracranial pressure (ICP) and a deformation
of the brain parenchyma in the short term, it can cause a degeneration of this tissue in the long term. The accompanying
symptoms range from headaches to dementia, gait disturbance,
and urinary incontinence [2]. Hydrocephalus is usually treated
by diverting CSF from the cerebral ventricles through a shunt
into the peritoneal space. Although implantable ventriculoperitoneal shunts have been used since the 1960s [3], the overall
failure rate is still high (38% after 1 year and 48% after 2 years
[4]). The most common modes of failure are over- or underdrainage, obstruction, and infection [5], [6].
To prevent siphoning-induced overdrainage in upright postures, shunt valves can be complemented by gravitational units,
antisiphon devices, and adjustable mechanisms [3], which lead
to increasingly complex shunt systems. This unsatisfactory situation has led to the vision of an active and smart shunt that could
overcome the drawbacks of current systems through continuous
monitoring of the patient using integrated sensors and feedback
controlled drainage [7].
For the existing passive shunts, a large number of in vitro
studies has already been performed to analyze their fluid dynamic properties, the effect of ICP pulsations and posture on
these properties, and long-term stability [8]–[14]. In these studies, the intracranial and peritoneal pressures were assumed to
be independent of CSF drainage. Yet in reality, drainage does
decrease mean ICP, in general also ventricular volume, and may
in addition influence the amplitude of ICP pulsations [15], [16].
These effects have been demonstrated in other setups that replicated parts of the patient’s CSF system in vitro [17]–[21].
For the envisioned active valves, this interdependence of valve
and patient becomes even more pronounced: The shunt does
not only influence the patient, but also adapts to the measured
state of the patient. Up to now, analysis of this interdependence
required in vivo experiments or was performed entirely in silico
[22]. The former is closest to the clinical application, but is
expensive, time consuming, and raises ethical concerns. For
these reasons, in vivo experiments are hardly used during the
early development phases of new shunts. The latter approach is
fast and cost effective, but the behavior of the shunt has to be
known precisely. Thus, numerical simulations are a good tool
for developing concepts for new shunts, but in vitro or in vivo
testing is still necessary for the hardware development.
Here, we propose to combine an in vitro setup with mathematical modeling of the patient’s relevant physiology to a hybrid
test bed. This concept is referred to as hardware-in-the-loop
(HIL) testing. It is commonly used during the development
of embedded systems [23] and combustion engines [24]. The

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

GEHLEN et al.: PATIENT SPECIFIC HARDWARE-IN-THE-LOOP TESTING OF CEREBROSPINAL FLUID SHUNT SYSTEMS

349

Fig. 1. Flow chart illustrating the interaction of software (in silico) and hardware (in vitro) parts of the HIL setup: The basis of each experiment is a test scenario
that determines the angles α 1 and α 2 , venous pressure at the hydrostatic indifference point p V , H IP , and arterial inflow Q a rte ria l . The set values of α 1 and α 2 are
applied to the shunt by the posture mechanisms as illustrated in Fig. 3. Based on the signals prescribed by the test scenario and the measured flow rate through the
eas
shunt Q m
shu nt , the patient simulation determines the set values for ICP and IPP. ICP and IPP are then applied to the respective catheter ends by two pressure interfaces
also shown in Fig. 2. The input current i for each of the actuators in the hardware–software interfaces is provided by an amplifier. The set values ise t for these
e a s , α m e a s , ICP m e a s , and IPP m e a s and their respective references (superscript set).
amplifiers are determined by controllers, based on the measured signals α m
1
2

method has also been applied successfully in the evaluation of
ventricular assist devices [25]. Applied to the shunt test bed, the
HIL concept implies that: 1) the patient’s relevant physiology is
replicated in real time by a mathematical model; 2) the relevant
simulated pressures for a ventriculoperitoneal CSF shunt [ICP
and intraperitoneal pressure (IPP)] are applied to the proximal
and the distal ends of the drainage catheter; and 3) the drainage
rate of CSF is measured and fed back to the in silico simulation
in real time.
In principle, any viable mathematical model of the patients
physiology that yields the two necessary pressure signals as a
function of the continuous measurement of the CSF drainage
rate could be implemented. However, the necessity to interact
with the hardware in real time currently precludes complex computational fluid dynamics simulations that can model the CSF
dynamics in detail [26]. Thus, lumped parameter models are best
suited. In 1973, Marmarou [27] published a lumped parameter
model of the CSF dynamics whose parameters are even used
to characterize hydrocephalus [28]. Today, there are a number
of ICP models that build upon the exponential function of this
model that describes the pressure dependence of the compliance
and extend it to capture also other characteristics of the CSF system [29]. While the model of Marmarou describes the absolute
compliance of the CSF system, which is defined relative to the
ambient pressure, explicit modeling of the membranes between
adjacent fluid compartments led to the concept of local compliances [30]. Some models are even representations of the whole
body and include detailed descriptions of the cardiovascular
system and its regulatory mechanisms [31]. However, most of
these models assume that the patient is in supine position. To
predict ICP of mobile patients, it is necessary to incorporate its
posture dependence [32].
In the following, we describe an HIL test bed and investigate
its suitability for analyzing the interdependence of shunt and

patient dynamics and evaluating the performance of passive
and active shunts during daily life situations including posture
changes. The resulting drainage rates and ICPs are compared to
a reference simulation without shunt and clinical results reported
in the literature.
II. METHODS AND MATERIALS
A. General Concept
The test bed consists of an in vitro and an in silico domain
(see Fig. 1). Pressure interfaces link these two domains by
applying simulated ICP and IPP to the respective ends of the
catheter. A posture mechanism moves the shunt according to
the current posture of the mimicked patient. The feedback
loop is closed through a flow probe that measures the flow rate
through the shunt and feeds this signal back into the patient
simulation in real time.
The patient model, all controllers and the data acquisition
simultaneously run in a Real-Time Windows Target environment
on a Windows 7 PC equipped with two data acquisition boards
(MF634 and MF624 I/O cards, Humusoft s.r.o., Prague, Czech
Republic). The code for the real-time environment is compiled
from MATLAB/Simulink using an implicit fixed-step solver
(ode14x) with a step size of 1 ms. This leads to a sampling rate
of 1 kHz for all analog control and measured signals from and
to the PC, while the drainage rate Qshunt is transmitted through
a digital connection and sampled at 100 Hz.
B. Hardware–Software Interfaces
1) ICP and IPP Interfaces: The pressures at the proximal
and the distal ends of the catheter are applied through two
pressure controlled fluid reservoirs (see Fig. 2), each consisting of a rigid reservoir (polymethyl methacrylate) and a bellows

350

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

TABLE I
CONSTANT PARAMETERS OF TEST BED AND PATIENT MODEL

Fig. 2. Schematic drawing of the pressure interfaces that apply ICP and IPP
calculated by the patient simulation to the respective ends of the catheter. In
Figs. 1 and 3, they are identified as ICP and IPP interface, respectively. The
reservoirs are pressurized by a voice coil actuator and feedback controlled
through a ceramic pressure transducer. A distance sensor provides information
on the fluid volume in the CSF reservoir.

(polytetrafluorethylene bellows, ElringKlinger Kunststofftechnik GmbH, Bietigheim-Bissingen, Germany) that is compressible in vertical direction [21]. The pressure in the reservoirs is
controlled by varying the force applied to the bellows. The force
is generated by a linear circular voice coil actuator (LVCM051-064-01, MotiCont, Van Nuys, USA), which is powered by
a four-quadrant servo amplifier (ADS 50/10 4-Q-DC, Maxon
Motor AG, Sachseln, Switzerland), and transferred through an
air bearing (Air Bushing, New Way Air Bearings Inc.) supported shaft. This low friction actuation allows a resolution of
0.01 mmHg in the applied reservoir pressure. The reservoir
pressure is measured by a piezoresistive pressure sensor (PR41X, Keller AG, Winterthur, Switzerland) with an accuracy of
0.1 mmHg and a resolution of 0.01 mmHg. The reservoir volume
is computed from a laser-based measurement of the bellows position (optoNCDT 1700, Micro-Epsilon, Ortenburg, Germany).
This volume information is used to regulate the recirculation of
the test medium, which enables, in principle, infinite experiment
duration. It further allows verification of the flow measurement.
2) Posture Mechanism: The patient’s posture is simulated
by moving the shunt and the aforementioned pressure interfaces
with the mechanism shown in Fig. 3. The mechanism has two
degrees of freedom that replicate rotational movements of the
torso (α1 ) and the head and neck (α2 ). The beam lengths l1 and
l2 are listed in Table I, where l1 is the distance between waist
and shoulder and l2 between shoulder and eye height, which
is close to the height of the external auditory canal usually
used as the reference position for ICP measurements. Both values are based on [33] and correspond to the dimensions of

Name

Value

Source

Qfo rm
R o u t (physiologic)
R o u t (pathologic)

0.35 mL/min
8.57 mmHg/(mL/min)
37.14 mmHg/(mL/min)

[30], [34]–[36]
[35], [36]

EF V = EB V = E M

0.1 mL-1

[21], [35], [36]

p0 , F V = p0 , B V = pv
p1 , F V = p1 , B V = pM
b
pV , H IP
kB V
kF V = 1 − kB V
RF B
ΔhH IP
Δhju g

7 mmHg
10 mmHg
7 mmHg
0.35
0.65
1 mmHg/(mL/min)
33.8 cm
11.0 cm

[36]
[21], [30], [36]
[32]

l1

47.6 cm

[33]

l2

16.5 cm

[33]

[32]
[32]

a 50th-percentile 40-year-old American male. However, these
lengths can be easily adapted to specific patients. The necessary
torques to manipulate α1 and α2 are provided by two DC motors
with planetary gearhead and integrated encoder (RE 50, G52C
1:113, and HEDS 5540, Maxon Motors AG). These driving units
are powered by four-quadrant servo amplifiers (ESCON 50/5,
Maxon Motors AG).
3) Flow Probe: The flow through the shunt is measured
using a thermal MEMS sensor (SLI-2000, Sensirion AG,
Staefa, Switzerland) with negligible hydrodynamic resistance
(< 0.05 mmHg). The measurement signal is fed back to the
patient simulation through an RS-232 connection at 100 Hz
sampling rate.
C. Patient Simulation
Fig. 4 outlines the lumped parameter model used in the
following experiments. It is based on a four-compartment
model developed by Stevens and Lakin [30], but modified and
extended to include posture dependence, ICP pulsations, and
viscoelastic effects.
1) Structure: Four fluid filled compartments—denoted F, B,
A, and V—are used to model the patient’s relevant physiology.
Compartment F is the central CSF compartment that includes
the ventricular system, the choroid plexus and the cranial and
spinal subarachnoid space. This implicitly assumes equal pressure across the fluid spaces that are lumped into Compartment F.
All viscoelastic effects within the craniospinal space are lumped
into Compartment B (mainly brain tissue) that is connected to
the main CSF space (F) through the constant resistance RFV .
The cerebral arteries and the cerebral and spinal veins are represented by the compartments A and V, respectively. The dynamics
in each of these compartments are governed by a volume balance of all inflowing and outflowing volume flows Q and an
additional algebraic equation that links the fluid volume V in
the compartment to the fluid pressure p.

d
Vi (t) = −
Qij (pi (t), pj (t), t)
(1)
dt
j
Vi (t) =


j

ΔVij (pi (t), pj (t), t)

(2)

GEHLEN et al.: PATIENT SPECIFIC HARDWARE-IN-THE-LOOP TESTING OF CEREBROSPINAL FLUID SHUNT SYSTEMS

351

Fig. 3. Overview over the posture mechanism and the integration of the shunt into the system of pressure interfaces, water bath, and incubator. (a) Schematic
with the posture mechanism mimicking the semirecumbent position shown in the upper right corner. l1 and l2 are the lengths of the two beams that represent the
torso and the neck, respectively. Accordingly, α 1 and α 2 denote the orientations of these two beams with respect to the horizontal plane. A more detailed drawing
of the ICP and IPP interfaces is shown in Fig. 2. (b) Picture of the test bed without the surrounding incubator in supine position. A movie of the test bed in action
can be found in the supplementary materials.

where t is time, and i and j are indices referring to two interconnected compartments. The compliance function ΔVij (·) describes the amount by which the volume of compartment i is increased and the one of compartment j is decreased or vice versa
due to the pressure-dependent deformation of the boundary that
separates the two fluid compartments i and j [30]. In contrast
to the commonly used pressure-based description, this volumebased representation allows time-varying compliances and is
more intuitive [37]. However, it turns the system of otherwise
ordinary differential equations into a system of differential algebraic equations that is not guaranteed to be solvable in real time.
2) Compliance: The global relationship between ICP and
CSF volume is typically described by Marmarou’s model [27],
[35]
M E
pM
IC = pb e

M

·Δ V

M

(3)

which expresses ICP pM
IC relative to ambient pressure as an
exponential function of the added CSF volume ΔV M , baseline
M
(see
pressure pM
b , and the brain elastance coefficient E
Table I). The local compliance functions ΔVij (·) introduced in (2) are chosen such that for slow volume changes
(pF (t) ≈ pB (t)) and pF (t) ≥ pV (t) the global pressure–
volume relationship of the patient model is equivalent to the
original Marmarou model (see Fig. 5)
⎧
kij
pi (t) − pj (t) + p0,ij
⎪
⎪
· ln
,
⎪
⎪
E
p1,ij
⎪
⎪
⎪ ij
⎪
⎪
for pi (t) ≥ pj (t)
⎨
ΔVij (t) =



⎪
⎪
kij
p0,ij
pj (t) − pi (t) + p0,ij
⎪
⎪
·
·
ln
−
ln
2
,
⎪
⎪
⎪
Eij
p1,ij
p1,ij
⎪
⎪
⎩
for pi (t) < pj (t)

(4)

for the parameters listed in Table I. The resulting pressure–
volume relationship is inverted for reversed pressure gradients
(see Fig. 5). A similar S-shape of this global pressure–volume
relationship was observed in vivo [38], [39] and it can explain negative ICP as it occurs following excessive drainage
[30], [40].
3) CSF Formation and Absorption: The overall rate of CSF
formation Qform is assumed constant [34], [35], [41]. While the
relative contribution of the different sites of CSF absorption are
still being researched, it appears clear that the arachnoid granulations are a major pathway; the overall outflow is thus positive and depends linearly on the hydrostatic pressure gradient
[34], [35]
	
(pF − pV )/Rout , for pF ≥ pV
(5)
Qabs =
0,
for pF < pV .
In case of shunting, an additional CSF flow Qshunt is diverted
from compartment F. Qshunt is an input to the mathematical
model and its actual value originates from the flow probe, which
measures the flow rate through the tested shunt in vitro (see
Fig. 1).
4) Brain Compartment: From an anatomical point of view,
the compartment B represents the brain tissue and peripheral
parts of the CSF system. It allows for modeling of the viscoelastic response that is, e.g., observed during bolus infusions [36].
The effects that may be responsible for this behavior entail limited wave propagation speeds between distant locations of the
CSF space [42], fluid exchange between CSF and interstitial
fluid [43], and the viscoelastic mechanical response of the brain
tissue [44], [45]. For a simplified model with constant compliances, it can be shown that with RFB = 1 mmHg/(mL/min) and

352

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 4. Lumped parameter model that is used to simulate the relevant ICP
dynamics (see Fig. 1), which include the ventricular system and spinal canal
(F), the brain tissue (B), the cerebral arteries (A), and the spinal and cerebral
veins (V). Volume flows are denoted with Q i and arrows indicate their usual
direction. Wavy lines depict compliant vessel walls. Arterial inflow Q a rte ria l ,
venous pressure p V , and the drainage rate Q shu nt as measured by the flow
probe are inputs to this lumped parameter model. The main output is the CSF
pressure p F in Compartment F that is used as the ICP set value in the ICP
interface.

Fig. 6. Simulated response of pressures p F and p B in the compartments F
and B, respectively, to infusions into compartment F. The results are compared
P
to the ICPs p M
IC and p IC calculated with Marmarou’s model [27] and the
viscoelastic model introduced by Bottan et al. [36], respectively. (a) Continuous
flow infusion (constant infusion rate of 1.5 mL/min between t = 0 and 30 min).
(b) Bolus infusion (infusion of 10 mL between t = 0 and 0.1 min).

5) Cardiovascular System and Posture: While the cardiovascular system greatly influences the intracranial dynamics, the
blood flows are hardly altered by the CSF production or absorption due to the in comparison negligible flow rates. Therefore,
the arterial inflow is a given input to the system and any theoretical or measured flow function can be applied. Since pulsations
in the intracranial fluid system, which are introduced through the
cardiac action, play an important role in the distribution of CSF,
and more importantly, can alter the drainage rates through the
shunt [12], we use a periodic pulsating arterial flow function for
Qarterial . The values of this function are based on phase-contrast
magnetic resonance imaging of the internal carotid artery in 94
elderly patients (68 ± 8 years of age) [46].
Compared to the pulsatile flow component of arteries, pulsatility of capillary vessels is small. The blood flow through the
capillaries Qcap is thus assumed to be nonpulsatile. Its value is
given by the volume balance
Qcap = Qarterial − Qform

Fig. 5. Pressure–volume relationship of the patient model in steady state—
implying equal pressures in Compartments B and F (p B = p F )—and for the
cerebral venous pressure p V = 7 mmHg with respect to the total change in CSF
volume (ΔV F V + ΔV B V ). As a reference, the exponential compliance curve
of Marmarou’s model (3) is plotted for baseline pressure p M
b = 10 mmHg and
brain elastance coefficient E M = 0.1 mL −1 , which are typical parameters for
a healthy subject [36].

kBV = 0.35, this lumped compartment approach is equivalent
to the model of Bottan et al. [36] (see Fig. 6). Their model is an
extended version of Marmarou’s model that uses a Prony series
to map the viscoelastic effects and showed good accordance
with measured infusion tests.

(6)

where Qarterial is the mean arterial flow over one cardiac cycle
and Qform is the constant rate of CSF formation. Therefore, the
volume of the blood in compartment A is modeled independent
of any pressure. Since the cerebral artery pressure pA is much
higher than the pressures pF and pB in the compartments F
and B at all times, one can assume a constant ratio between
ΔVAB and ΔVAF , which then simplifies the patient model to a
system of ordinary differential equations. Further assuming that
the ratio of arterial to venous blood vessels is the same at the
boundaries of the compartments F and B leads to
ΔVAB (t)/ΔVAF (t) = kBV /kFV .

(7)

GEHLEN et al.: PATIENT SPECIFIC HARDWARE-IN-THE-LOOP TESTING OF CEREBROSPINAL FLUID SHUNT SYSTEMS

On the venous side, the system boundary is defined by a nonpulsatile venous pressure, which depends on the patient’s posture.
This posture dependence is implemented using the concept of
a hydrostatic indifference point in the venous system and taking collapsible jugular veins into account when calculating the
hydrostatic pressure component of the cerebral venous pressure
pV [32]
	
pV ,HIP − ΔpHIP , for pV ,HIP ≥ ΔpHIP − Δpjug
pV =
−Δpjug ,
for pV ,HIP < ΔpHIP − Δpjug
(8)
where pV ,HIP is the pressure in the hydrostatic indifference point
(HIP) of the venous system, ΔpHIP the hydrostatic pressure
difference in blood between the lateral ventricles and the HIP,
and Δpjug between the lateral ventricles and the jugular veins.
In the HIL setup, ΔpHIP and Δpjug are functions of the angles
α1 and α2
ΔpHIP = ρ · g · (l2 · sin α2 + (ΔhHIP − l2 ) · sin α1 )
Δpjug = ρ · g · Δhjug · sin α2 .

353

TABLE II
MODELING OF RELEVANT POSTURES AND DAILY ACTIVITIES
Activity
Lying (supine)
Sitting
Standing
Sitting up
Lying down
Coughing

Modeling

Source
◦

IPP = 1.8 mmHg, α 1 = α 2 = 0
IPP = 16.7 mmHg, α 1 = α 2 = 90 ◦
IPP = 20.0 mmHg, α 1 = α 2 = 90 ◦
gradual trunk (α 1 ) and head (α 2 ) movement
reversed sit-up movement
simultaneous increase in IPP and p V , H I P by up to
68 and 43 mmHg, respectively

[47]
[47]
[47]
[49]
[50]

(9)
(10)

Due to the concept of local compliances, the posture-dependent
cerebral venous pressure pV has an immediate effect on the
pressures in the adjacent compartments pF and pB .
D. Shunt
In principle, any CSF shunt can be tested with the presented
test bed. For the purpose of analyzing and validating the HIL
setup, three identical ball and cone valves (miniNAV, Christoph
Miethke GmbH & Co. KG, Potsdam, Germany) with 7.4 mmHg
(10 cmH2 O) opening pressure are used. In the following, the
three valves will be denoted as Valve No. 1, 2, and 3. In one
experiment, Valve No. 1 is complemented by a gravitational
unit (proSA, Christoph Miethke GmbH & Co. KG, Potsdam,
Germany) that has 0 mmHg opening pressure in horizontal orientation and is set to 14.7 mmHg (20 cmH2 O) opening pressure
in upright orientation. The valve and, if used, the gravitational
unit are connected to the pressure interfaces through catheters
with 1.2 mm inner diameter. The catheter lengths from the ICP
interface to the valve and from the valve to the IPP interface are
20 and 84 cm, respectively.
E. Test Medium and Ambient Conditions
The test medium, which imitates CSF, is deionized and deaerated water. The valve and both catheters are submerged in a
water bath filled with the same medium (see Fig. 3).
The entire in vitro setup is enclosed within an incubator kept
at 37 ± 1 °C, which equals the tissue temperature at the typical
implantation site of the valve and fulfills the requirements mandated by the standards BS EN ISO 7197:2009 and ASTM F64794(2006). This is done through two feedback controlled fan
heaters (HGL 046 - 400 W, Stego Elektrotechnik GmbH, Germany). Continuous temperature measurements are taken using
10 kΩ NTC Thermistors (BetaCurve Interchangeable Thermistor, BetaTHERM Sensors, Galway, Ireland) at five locations: 1)
in the ICP reservoir; 2) in the IPP reservoir; 3) in the water bath

Fig. 7. Experiment 1: Pressure-flow characteristics during opening and closing of the tested valves. The curves represent mean values over four repetitions
of Experiment 1 in horizontal position and four repetitions in upright position.
Error bars indicate the standard deviations at 5, 10, 15, 20, and 25 mmHg. (a)
Ball and cone valves No. 1–3. (b) Valve No. 1 combined with the gravitational
unit (GU) with separate curves for horizontal and upright position.

next to the valve; 4) in the air inside the incubator; and 5) in the
ambient air outside of the incubator.
F. Experiments
Initial three sets of experiments were performed to validate the
proposed shunt test bed, to analyze the interaction between shunt
and patient, and to study how this interaction is changed upon
inclusion of a gravitational unit. This was examined in a synthetic situation where overdrainage would occur in vivo, as well
as during a 24-h period that resembles a typical day of a patient.
1) Experiment 1 (Shunt Characteristic): The shunts’
pressure-flow characteristics during opening and closing of the
valve were determined by measuring the flow through the shunt
while linearly increasing the pressure difference between the
proximal and the distal ends of the catheter from 0 to 30 mmHg
within 2 mins, and then, linearly decreasing it back to 0 mmHg
at the same rate. The experiment was performed twice before
and twice after each of the other experiments: once with the
postural mechanism in horizontal position (α1 = α2 = 0◦ ) and
once in upright position (α1 = α2 = 90◦ ). While ICP changed
continuously during this experiment, IPP was kept constant at
1.8 and 16.7 mmHg for the experiment in horizontal and upright

354

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

TABLE III
MEAN VALUES AND PEAK-TO-PEAK AMPLITUDES OF ICP AND SHUNT FLOW AFTER STEADY STATE WAS REACHED DURING EXPERIMENT 2
ICP (mmHg)
Posture

Valve

Supine

Sitting

Shunt Flow (mL/min)

Opening Pressure (mmHg)

mean

amplitude

mean

amplitude

no shunt
No. 1
No. 2
No. 3
No. 1 + grav. unit
No. 1 (increased R o u t )

8.34 ± 0.32
6.65 ± 0.39
6.47 ± 0.11
8.54 ± 0.80
8.29 ± 0.46

10.00
9.60 ± 0.08
8.82 ± 0.08
8.89 ± 0.02
9.69 ± 0.04
11.61 ± 0.48

1.14
1.09 ± 0.01
1.01 ± 0.01
1.01 ± 0.00
1.10 ± 0.00
1.32 ± 0.05

0.00
0.05 ± 0.01
0.14 ± 0.01
0.13 ± 0.00
0.03 ± 0.00
0.22 ± 0.01

0.00
0.04 ± 0.01
0.06 ± 0.02
0.06 ± 0.01
0.02 ± 0.00
0.13 ± 0.01

no shunt
No. 1
No. 2
No. 3
No. 1 + grav. unit
No. 1 (increased R o u t )

8.62 ± 0.64
6.52 ± 0.62
6.44 ± 0.10
16.98 ± 1.05
8.12 ± 0.30

−5.10
−19.36 ± 0.33
−21.68 ± 0.62
−22.15 ± 0.03
−9.07 ± 0.06
−20.25 ± 0.51

1.14
2.14 ± 0.04
2.41 ± 0.07
2.47 ± 0.00
0.94 ± 0.01
2.24 ± 0.06

0.00
0.35 ± 0.01
0.34 ± 0.01
0.35 ± 0.00
0.35 ± 0.02
0.35 ± 0.00

0.00
0.35 ± 0.01
0.38 ± 0.03
0.39 ± 0.01
0.04 ± 0.00
0.30 ± 0.06

position, respectively. These are realistic IPP values for subjects
in supine and sitting position [47], [48].
2) Experiment 2 (Synthetic Posture Change): The setup’s
ability to mimic postural changes and posture related
overdrainage was tested by simulating a patient who quickly
moves (within 5 s) from supine position to sitting and then goes
back to supine position again (see Table II). Each of the three
postures was held for 1 h to guarantee equilibrium conditions at
the end of each period. The transitions were gradual changes of
α1 , α2 , and IPP. The initial state of the patient simulation was
the equilibrium state without shunting (pF = pB = 10 mmHg).
In addition to the physiological case with Rout = 8.57 mmHg,
the experiment was also repeated for a pathological case with an
elevated CSF outflow resistance of 37.14 mmHg, which corresponds to a patient with an ICP of 20 mmHg in supine position
without shunting. The experiment was repeated three times for
each valve combination. Experiment 2 was also used to quantify
the performance of the pressure interfaces. This was done by
comparing the desired and measured pressures in the ICP interface, where the ICP pulsations pose high dynamic requirements
for the pressure control.
3) Experiment 3 (Daily Routine): The idea behind the third
experiment is that for future smart and active shunts it will not be
sufficient to only consider the static characteristic of the valve,
because the valve will adapt to the patient. Therefore, we need a
new means to assess and compare the performance of these new
devices. One promising approach to this problem is to define a
scenario that resembles the daily routine of the targeted patient or
patient group most realistically. This idea can be compared to the
driving cycles that are used to estimate the fuel consumption and
emissions of a given car or truck within a typical environment
[51], [52]. We generated a cycle from a case study of a subject’s
daily routine that was recorded over 24 h [50] consisting of the
postures and activities listed in Table II. While this cycle cannot
be considered to be representative, it does serve its purpose of
providing a proof of principle. Valve No. 1 with and without the
gravitational unit was used in connection with the pathologic
case for this cycle. The ICP of a healthy subject (physiologic
outflow resistance) without a shunt was simulated as a benchmark to which the ICP recorded during the cycle was compared.

III. RESULTS
All recordings of the experiments were filtered with a secondorder zero-phase Butterworth filter with 50-Hz cutoff frequency
using the MATLAB function filtfilt. Results that are based on
multiple measurements are given as mean values ± standard
deviation.
A. Experiment 1 (Shunt Characteristic)
The pressure-flow characteristics of the tested valves are
depicted in Fig. 7, and their measured opening pressures are
listed in Table III. The valve manufacturer defines the opening
pressure as the pressure necessary to obtain a drainage rate of
0.083 mL/min (5 mL/h). According to this definition, the measured opening pressure over the valve, both catheters and the
flow sensor is 7.17 ± 1.02 mmHg (measurements on the three
separate ball and cone valves of the same type). The nominal
opening pressure for the valves without catheters is 7.4 mmHg
(10 cmH2 O). Adding the gravitational unit to one of the ball and
cone valves (Valve No. 1) does not change the measured opening pressure of this valve in supine position notably. It does,
however, increase flow resistance above the opening pressure
[see Fig. 7(b)] and it increases the opening pressure in upright
position to 16.98 ± 1.05 mmHg (see Table III).
B. Experiment 2 (Synthetic Posture Change)
Experiment 2 shows how the drainage rate and ICP evolves
when a patient sits up or lies down, and how this behavior is affected by the addition of a gravitational unit to the ball and cone
valve. As an example, Fig. 8 shows the ICP and flow rate through
the shunt for one iteration of the experiment and compares the
measurements to reference values obtained by simulation without shunt. In this reference case, mean ICP is 10.00 mmHg in
supine position. In sitting position, the proximal catheter tip
rises above the CSF system’s point of hydrostatic indifference.
This posture-induced reduction in the hydrostatic pressure at the
ICP reference point leads to negative mean ICP (−5.10 mmHg)
relative to ambient pressure [32]. The corresponding movements of the posture mechanism are visualized in a video clip

GEHLEN et al.: PATIENT SPECIFIC HARDWARE-IN-THE-LOOP TESTING OF CEREBROSPINAL FLUID SHUNT SYSTEMS

355

Fig. 8. Experiment 2: Simulation of a patient with physiological outflow resistance of R o u t = 8.57 mmHg/(mL/min) and an implanted ball and cone valve
(Valve No. 2). The patient sits up from supine position at t = 60 min and lies back down at t = 120 min. As a reference, the experiment is plotted for the same
patient without shunt. The signals are plotted with 0.1 s sampling time, thus the line widths are proportional to the amplitude of the signal pulsations. Two zoomed
segments of this plot, which give detailed views of the effect of vasculature pulsation, are shown in Fig. 9.

Fig. 9. Comparison between set (by the in silico domain) and measured (in
the in vitro domain) ICP values in Experiment 2 presented in Fig. 8. The bottom
panels show the corresponding measured pulsatile drainage rate. (a) Supine
position: Time window starts at t1 = 40 min into the experiment. (b) Sitting:
Time window starts at t2 = 100 min.

accompanying this manuscript. We use the equilibrium conditions in supine and sitting posture and the time it takes to
reach these to quantify the experimental results. The equilibrium
values are averaged over the periods 20 min < t < 60 min and
80 min < t < 120 min for supine and sitting position, respectively. In the following, we consider equilibrium to have reached
when the mean ICP is and stays within 1 mmHg of this value.
1) Physiological Case: For the physiological case with
Rout = 8.57 mmHg/(mL/min) and supine position, the shunt
decreases ICP from 10 mmHg (reference case, no shunt) to 9.10
± 0.38 mmHg. After sitting up, ICP instantaneously falls to
−6.24 ± 0.36 mmHg due to the increased hydrostatic pressure

difference. However, this fall in ICP and the modeled increase
in IPP (from 1.8 to 16.7 mmHg) does not fully compensate the
hydrostatic water column in the catheter, which leads to a maximum drainage rate of 4.41 ± 0.20 mL/min (averaged over one
cardiac cycle). Equilibrium is reached after 9.21 ± 1.49 min at
ICP of −21.06 ± 1.34 mmHg. The patient’s recovery from this
overdrainage is slower and takes 34.68 ± 1.12 min.
A metric that gives an indication of the patient’s current compliance is the amplitude of the ICP pulsations. In the reference
case, the peak-to-peak amplitude is 1.14 mmHg independent of
the patient’s posture. With the shunt, this decreases slightly to
1.04 ± 0.04 mmHg for the supine position and increases to 2.34
± 0.16 mmHg while sitting.
2) Pathological Case: When conducting the same experiment, but with increased outflow resistance, ICP is only decreased to 11.61 ± 0.48 mmHg in supine position while diverting 0.22 ± 0.01 mL/min through the shunt. The overdrainage in
the sitting posture (0.35 ± 0.00 mL/min) still leads to an equilibrium ICP of −20.25 ± 0.51 mmHg. As expected, the difference
to the physiological case is small here, because the resulting
ICP is below the cerebral venous pressure pV (−8.10 mmHg
in sitting posture). Therefore, the entire CSF production
(0.35 mL/min) is diverted through the shunt in both cases.
3) Gravitational Valve: Adding a gravitational unit to the
valve does not change the equilibrium ICP in the supine position notably (9.69 ± 0.04 mmHg). During the sitting phase
of the experiment, all of the CSF produced is still drained
through the shunt. The ICP, however, is only lowered to −9.07
± 0.06 mmHg, which also keeps the ICP pulsations (0.94 ±
0.01 mmHg) closer to the reference scenario.
4) Pressure Control: For Experiment 2, Fig. 9 compares
within a time window of three seconds the pulsatile ICP values prescribed by the in silico domain with the ICP measured
in the reservoir of the ICP interface. The mean absolute error
(MAE) in the interface is 0.075 mmHg over all experiments.

356

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

Fig. 10. Experiment 3: Simulation of a shunted patient’s routine activities over a 24-h period. The patient has increased outflow resistance. No gravitational unit
is implanted. As a reference, the same activities of a healthy, not shunted subject with physiological outflow resistance are simulated. The signals are plotted with
0.1 s sampling time, thus the line widths are proportional to the amplitude of the signal pulsations.

The maximum absolute error stays below 1 mmHg in all experiments. After compensating for the delay of 25 ms between
the in silico and the in vitro domains, the MAE decreases to
0.007 mmHg. For the IPP interface, the MAE is 0.027 mmHg.
Compensating for the delay does not significantly change the
error here, because the reference signal for this compartment is
not pulsatile.

C. Experiment 3 (Daily Routine)
Fig. 10 depicts the results of Experiment 3 carried out with
valve No. 1, without the gravitational unit. At nighttime, the
simulated patient is in supine position, and the ICP stabilizes
around the equilibrium ICP in supine position that was determined in the synthetic posture change experiment. At daytime,
the patient is mainly sitting or standing. There are numerous
transitions between these postures. Therefore, the simulated IPP
alternates between 16.7 and 20 mmHg, while the vertical distance between the proximal and the distal end of the catheter
remains constant. In the reference simulation, which mimics a
healthy subject without shunt, the mean ICP is −5.10 mmHg in
sitting or standing position. The behavior of the shunted patient
is different in two ways: First, overdrainage occurs and low ICP
values as measured in Experiment 2 can be observed. Second,
CSF drainage rate and with it ICP are directly dependent on
IPP. This means that the ICP in standing position is higher than
in sitting position. Adding a gravitational unit hardly influences
ICP at nighttime, but reduces overdrainage while the patient is
sitting or standing. The pressure spikes in Fig. 10 are the result
of coughing, which is modeled as outlined in Table II. These
pressure peaks result in mainly negative spikes in the measured
flow rate, which will cause the valve to close. However, they do
not have any significant and prolonged effect on the ICP. Over
the entire 24-h cycle, the mean absolute difference in ICP between shunted patient and healthy subject is 9.16 mmHg without
gravitational unit and 2.29 mmHg with.

IV. DISCUSSION
The results presented at hand demonstrate that the HIL test
bed can be used to study the static and dynamic properties of
CSF shunts, and their interaction with the patient.
The opening pressures and characteristics obtained in Experiment 1 compare well with the manufacturer’s specifications,
but also show marked differences between the measured mean
opening pressures of valve No. 1 and the remaining two valves,
which are larger than the experiments’ standard deviations.
In Experiment 2, we were able to reproduce the problem of
overdrainage when using a standard differential pressure valve,
and observe how the addition of a gravitational unit can prevent
it. The high measured flow rates and the subsequent fall in ICP
are in good agreement with the literature [8].
In the same experiment, we observed that in supine position the valves start continuously draining before the difference
between mean ICP and IPP rises above the valve’s opening pressure (see Fig. 9). While it is known that the apparent opening
pressure is lowered in the presence of pressure pulsations [12],
it was assumed that CSF is only drained during the pressure
peaks. The continuous flow in our experiment might be due to
a hysteresis in the valve opening. This result highlights that the
drainage is influenced by ICP pulsations; these should thus be
taken into account when testing CSF shunts.
We know from in vivo studies that the amplitude of ICP pulsations increases with elevated mean ICP and can be decreased
through shunting until a certain minimum amplitude [53], [54].
In supine position, we can reproduce the reduction in ICP pulse
amplitude with all shunts. In sitting position, however, the amplitude is only decreased with the gravitational unit. For the
very low ICP values that are reached during overdrainage, we
measure even higher amplitudes than without shunting, which is
due to the symmetry of the compliance curve around the venous
pressure (see Fig. 5). A similar amplitude increase at negative ICP has been observed after withdrawal of CSF in dogs
[40], [55].

GEHLEN et al.: PATIENT SPECIFIC HARDWARE-IN-THE-LOOP TESTING OF CEREBROSPINAL FLUID SHUNT SYSTEMS

Experiment 2 further proves that the feedback controllers of
the critical pressure interfaces are able to follow the respective
reference curves precisely. The interfaces can apply any pathophysiologic pulse waveform or pressure spike to the shunt. The
delay that is introduced by the controlling feedback loop is
small. It is even irrelevant when looking at periodically pulsating signals.
The cycle simulated in Experiment 3 is only based on the
recordings of one subject, and should thus not be considered
representative of any subpopulation of hydrocephalus patients.
The experiment does, however, demonstrate the feasibility of
simulating an arbitrary daily routine for a period of 24 h or
longer. By comparing the simulated ICPs of such an experiment
to a reference simulation, we can provide a simple metric that
quantifies the performance of CSF shunts for a realistic scenario.
The two results of the shunt with and without the gravitational
unit suggest that the metric is sensitive to improvements in shunt
technology. In contrast to measurements of the shunt’s pressureflow characteristic, the results will even be meaningful for active
shunts that adapt to the posture of the patient, mean ICP or the
ICP pulse waveform.
Compared to pure in vitro implementations, the main advantages of the HIL approach used for our setup are the flexibility
of the patient model and its determinism: The simulated patient
or the severity of the pathology can be changed by adjusting
the model parameters. Sets of parameters representing specific
patients or patient groups can at least in part be derived from
available clinical data such as ICP recordings during lumbar infusions tests. Physiologic and pathophysiologic increases in abdominal pressure as they occur, respectively, during pregnancy
and due to obesity can be taken into account by increasing mean
IPP. Finally, HIL testing can be extended to ventriculoatrial and
ventriculopleural shunts by adapting the posture mechanism and
patient model.
V. CONCLUSION
Our test bed can be used to quantify and assess the expected
performance of passive and active shunts in a realistic environment. The HIL approach on which the test bed is based does
not only provide a means of comparison for existing shunts; it
can also stimulate the development of smart and active shunts
by lowering the burden of implementing and testing new concepts and ideas. In combination with comprehensive and wellspecified test cycles, we can imagine the application of HIL
testing during the regulatory approval process of new devices.
ACKNOWLEDGMENT
The authors would like to thank M. Hubacher, D. Wagner, and
D. Brühlmann for their work on the test bed, and T. Vasileiou for
his spadework. The tested valves were provided by Christoph
Miethke GmbH & Co. KG (Potsdam, Germany).
REFERENCES
[1] H. L. Rekate, “The definition and classification of hydrocephalus: A
personal recommendation to stimulate debate,” Cerebrospinal Fluid Research, vol. 5, no. 1, p. 2, 2008, doi:10.1186/1743-8454-5-2.

357

[2] R. D. Adams et al., “Symptomatic occult hydrocephalus with normal
cerebrospinal-fluid pressure: A treatable syndrome,” New Eng. J. Med.,
vol. 273, no. 3, pp. 117–126, Jul. 1965.
[3] A. Aschoff et al., “The scientific history of hydrocephalus and its treatment,” Neurosurg. Rev., vol. 22, no. 2, pp. 67–93, 1999.
[4] J. Kestle et al., “Long-term follow-up data from the shunt design trial,”
Pediatric Neurosurg., vol. 33, no. 5, pp. 230–236, 2000.
[5] S. R. Browd et al., “Failure of cerebrospinal fluid shunts: Part I: obstruction
and mechanical failure,” Pediatric Neurol., vol. 34, no. 2, pp. 83–92, Feb.
2006.
[6] S. R. Browd et al., “Failure of cerebrospinal fluid shunts: Part II:
Overdrainage, loculation, and abdominal complications,” Pediatric Neurol., vol. 34, no. 3, pp. 171–176, Mar. 2006.
[7] B. R. Lutz et al., “New and improved ways to treat hydrocephalus:
Pursuit of a smart shunt,” Surgical Neurol. Int., vol. 4, no. 2, p. 38,
2013.
[8] A. Aschoff et al., “Overdrainage and shunt technology, a critical comparison of programmable, hydrostatic and variable-resistance valves and
flow-reducing devices,” Child’s Nervous Syst., vol. 11, no. 4, pp. 193–202,
Apr. 1995.
[9] Z. Czosnyka et al., “Posture-related overdrainage: Comparison of the
performance of 10 hydrocephalus shunts in vitro,” Neurosurgery, vol. 42,
no. 2, pp. 327–333, Feb. 1998.
[10] Z. Czosnyka et al., “Laboratory testing of hydrocephalus shunts—
Conclusion of the U.K. shunt evaluation programme,” Acta Neurochirurgica, vol. 144, no. 6, pp. 525–538, Jun. 2002.
[11] Z. Czosnyka et al., “Evaluation of three new models of hydrocephalus
shunts.” Acta Neurochirurgica Supplement, vol. 95, pp. 223–227, 2005.
[12] Z. Czosnyka et al., “Hydrocephalus shunts and waves of intracranial pressure,” Med. Biol. Eng. Comput., vol. 43, no. 1, pp. 71–77, 2005.
[13] A. Eklund et al., “Assessment of cerebrospinal fluid outflow resistance,”
Med. Biol. Eng. Comput., vol. 45, no. 8, pp. 719–735, Jul. 2007.
[14] F. B. Freimann et al., “In vitro performance and principles of
anti-siphoning devices,” Acta Neurochirurgica, vol. 156, no. 11,
pp. 2191–2199, Aug. 2014.
[15] P. K. Eide and W. Sorteberg, “Changes in intracranial pulse pressure
amplitudes after shunt implantation and adjustment of shunt valve opening pressure in normal pressure hydrocephalus,” Acta Neurochirurgica,
vol. 150, no. 11, pp. 1141–1147, Oct. 2008.
[16] G. Petrella et al., “How does CSF dynamics change after shunting?” Acta
Neurologica Scandinavica, vol. 118, no. 3, pp. 182–188, Sep. 2008.
[17] S. Hakim et al., “A critical analysis of valve shunts used in the treatment
of hydrocephalus,” Developmental Med. Child Neurol., vol. 15, no. 2,
pp. 230–255, Nov. 1973.
[18] M. A. Hafez and O. Kempski, “A nonlinear biomechanical model for
evaluation of cerebrospinal fluid shunt systems,” Child’s Nervous Syst.,
vol. 10, no. 5, pp. 302–310, Jul. 1994.
[19] M. U. Schuhmann et al., “Application of clinically recorded ICP patterns—
An extension of conventional shunt testing,” Child’s Nervous Syst.,
vol. 16, no. 12, pp. 856–861, Dec. 2000.
[20] S. Bottan et al., “Phantom model of physiologic intracranial pressure and
cerebrospinal fluid dynamics,” IEEE Trans. Biomed. Eng., vol. 59, no. 6,
pp. 1532–1538, Jun. 2012.
[21] M. Schmid Daners et al., “Craniospinal pressure-volume dynamics
in phantom models,” IEEE Trans. Biomed. Eng., vol. 59, no. 12,
pp. 3482–3490, Dec. 2012.
[22] I. Elixmann et al., “ Simulation of existing and future electromechanical
shunt valves in combination with a model for brain fluid dynamics,” in
Hydrocephalus, ser. Acta Neurochirurgica Supplementum, G. A. Aygok
and H. L. Rekate, ed. New York, NY, USA: Springer, 2012, vol. 113,
pp. 77–81.
[23] R. Ernst, “Codesign of embedded systems: Status and trends,” IEEE Des.
Test. Comput., vol. 15, no. 2, pp. 45–54, Apr. 1998.
[24] R. Isermann et al., “Hardware-in-the-loop simulation for the design and
testing of engine-control systems,” Control Eng. Practice, vol. 7, no. 5,
pp. 643–653, May 1999.
[25] G. Ochsner et al., “A novel interface for hybrid mock circulations to
evaluate ventricular assist devices,” IEEE Trans. Biomed. Eng., vol. 60,
no. 2, pp. 507–516, Feb. 2013.
[26] B. Siyahhan et al., “Flow induced by ependymal cilia dominates nearwall cerebrospinal fluid dynamics in the lateral ventricles,” J. Roy. Soc.
Interface, vol. 11, no. 94, p. 20131189, Mar. 2014.
[27] A. Marmarou et al., “A nonlinear analysis of the cerebrospinal fluid system and intracranial pressure dynamics,” J. Neurosurg., vol. 48, no. 3,
pp. 332–344, 1978.

358

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 2, FEBRUARY 2016

[28] M. Czosnyka et al., “Modeling of CSF dynamics: Legacy of professor
anthony marmarou,” Acta Neurochirurgica Supplementum, vol. 113, pp.
9–14, Nov. 2012.
[29] W. Wakeland and B. Goldstein, “A review of physiological simulation
models of intracranial pressure dynamics,” Comput. Biol. Med., vol. 38,
no. 9, pp. 1024–1041, Sep. 2008.
[30] S. Stevens and W. Lakin, “Local compliance effects on the global pressurevolume relationship in models of intracranial pressure dynamics,” Math.
Comput. Model. Dynamical Syst., vol. 6, no. 4, pp. 445–465, Dec. 2000.
[31] W. D. Lakin et al., “A whole-body mathematical model for intracranial
pressure dynamics,” J. Math. Biol., vol. 46, no. 4, pp. 347–383, Apr. 2003.
[32] S. Qvarlander et al., “Postural effects on intracranial pressure: Modeling
and clinical evaluation,” J. Appl. Physiol., vol. 115, no. 10, pp. 1474–1480,
Sep. 2013.
[33] Man-Syst. Integration Standards, ser. NASA-STD. National Aeronautics
and Space Administration, United States, no. Bd. 3, 1995.
[34] R. Cutler et al., “Formation and absorption of cerebrospinal fluid in man,”
Brain, vol. 91, no. 4, pp. 707–720, 1968.
[35] M. Czosnyka et al., “Cerebrospinal fluid dynamics,” Physiol. Meas.,
vol. 25, no. 5, pp. R51–R76, Aug. 2004.
[36] S. Bottan et al., “Assessment of intracranial dynamics in hydrocephalus:
effects of viscoelasticity on the outcome of infusion tests,” J. Neurosurg.,
vol. 119, no. 6, pp. 1511–1519, Dec. 2013.
[37] W. Wakeland and B. Goldstein, “ A computer model of intracranial pressure dynamics during traumatic brain injury that explicitly models fluid
flows and volumes,” in Proc. Intracranial Pressure Brain Monitoring XII,
ser. Acta Neurochirurgica Supplementum, W. Poon et al., Eds. New York,
NY, USA: Springer, 2005, vol. 95, pp. 321–326.
[38] J. Lfgren et al., “The pressure-volume curve of the cerebrospinal
fluid space in dogs,” Acta Neurologica Scandinavica, vol. 49, no. 4,
pp. 557–574, 1973.
[39] H. Sullivan and J. Allison, “Physiology of cerebrospinal fluid,” Neurosurgery, vol. 3, pp. 2125–2135, 1985.
[40] J. Drake et al., “Computer modeling of siphoning for CSF shunt design
evaluation,” Pediatric Neurosurg., vol. 21, no. 1, pp. 6–15, 1994.
[41] S. A. Stevens et al., “Modeling steady-state intracranial pressures in
supine, head-down tilt and microgravity conditions,” Aviation, Space, Environ. Med., vol. 76, no. 4, pp. 329–338, Apr. 2005.
[42] A. Behrens et al., “Are intracranial pressure wave amplitudes measurable through lumbar puncture?” Acta Neurologica Scandinavica, vol. 127,
no. 4, pp. 233–241, Jul. 2012.
[43] A. Brodbelt and M. Stoodley, “CSF pathways: A review,” Brit. J. Neurosurg., vol. 21, no. 5, pp. 510–520, Jan 2007.
[44] B. S. Elkin et al., “A detailed viscoelastic characterization of the p17 and
adult rat brain,” J. Neurotrauma, vol. 28, no. 11, pp. 2235–2244, Nov.
2011.
[45] K. Laksari et al., “Constitutive model for brain tissue under finite compression,” J. Biomechan., vol. 45, no. 4, pp. 642–646, Feb. 2012.
[46] Y. Hoi et al., “Characterization of volumetric flow rate waveforms at the
carotid bifurcations of older adults,” Physiol. Meas., vol. 31, no. 3, p. 291,
Mar. 2010.
[47] W. S. Cobb et al., “Normal intraabdominal pressure in healthy adults,” J.
Surgical Res., vol. 129, no. 2, pp. 231–235, Dec. 2005.
[48] A. Al-Hwiesh et al., “Intraperitoneal pressure and intra-abdominal pressure: Are they the same?” Peritoneal Dialysis Int., vol. 31, no. 3,
pp. 315–319, Feb. 2011.
[49] P. Cordo et al., “The sit-up: complex kinematics and muscle activity in
voluntary axial movement,” J. Electromyography Kinesiol., vol. 13, no. 3,
pp. 239–252, Jun. 2003.
[50] I. M. Elixmann et al., “Case study of relevant pressures for an implanted
hydrocephalus valve in everyday life,” in Proc. IEEE Annu. Int. Conf.
Eng. Med. Biol. Soc., Aug. 2012, pp. 1635–1638.

[51] H. Steven, “Development of a worldwide harmonised heavy-duty engine
emissions test cycle,” Final Report. 2, Apr. 2001.
[52] M. André, “The artemis European driving cycles for measuring car pollutant emissions,” Sci. Total Environ., vol. 334, pp. 73–84, Dec. 2004.
[53] D. Farahmand et al., “Intracranial pressure in hydrocephalus: Impact of
shunt adjustments and body positions,” J. Neurol., Neurosurg. Psychiatry,
vol. 86, no. 2, pp. 222–228, Jun. 2014.
[54] S. Qvarlander et al., “The pulsatility curve-the relationship between
mean intracranial pressure and pulsation amplitude,” Physiological Meas.,
vol. 31, no. 11, p. 1517, Nov. 2010.
[55] E. Foltz, “Hydrocephalus and CSF pulsatility: Clinical and laboratory
studies,” Hydrocephalus. New York, NY, USA: Raven Press, 1984,
pp. 337–362.

Manuel Gehlen received the degree in mechanical
engineering from ETH Zurich, Zurich, Switzerland,
in 2013. He is currently working toward the Ph.D.
degree at The Interface Group, Institute of Physiology, University of Zurich, Zurich, Switzerland and at
the Institute for Dynamic Systems and Control, ETH
Zurich.
His research interests include the development of
actively controlled cerebrospinal fluid shunts for the
treatment of hydrocephalus.

Vartan Kurtcuoglu received the degree in mechanical engineering from the ETH Zurich, Zurich,
Switzerland, after completing his diploma thesis at
the French National Center of Scientific Research,
CNRS PROMES. His Doctoral dissertation at ETH
was on the computational modeling of CSF flow in
the human ventricular system.
He is currently an Assistant Professor of computational and experimental physiology at the University
of Zurich, Zurich, Switzerland.

Marianne Schmid Daners received the Graduate degree in mechanical engineering from the ETH Zurich,
Zurich, Switzerland, where under the supervision of
Prof. L. Guzzella, she received the Ph.D. degree in
2012 from the Institute for Dynamic Systems and
Control on the topic “Adaptive Shunts for Cerebrospinal Fluid Control.”
She currently leads the Biomedical Systems group
of the Product Development Group Zurich and is responsible for the project coordination of the Zurich
Heart. Her research interests include the modeling
and control of biological systems and the development and control of biomedical devices.

