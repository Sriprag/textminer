240

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

Model-Based Estimation of Aortic and Mitral Valves
Opening and Closing Timings in Developing
Human Fetuses
Faezeh Marzbanrad, Student Member, IEEE, Yoshitaka Kimura, Kiyoe Funamoto, Sayaka Oshio, Miyuki Endo,
Naoaki Sato, Marimuthu Palaniswami, Fellow, IEEE, and Ahsan H. Khandoker, Senior Member, IEEE

Abstract—Electromechanical coupling of the fetal heart can be
evaluated noninvasively using doppler ultrasound (DUS) signal
and fetal electrocardiography (fECG). In this study, an efficient
model is proposed using K-means clustering and hybrid Support
Vector Machine–Hidden Markov Model (SVM–HMM) modeling
techniques. Opening and closing of the cardiac valves were detected
from peaks in the high frequency component of the DUS signal decomposed by wavelet analysis. It was previously proposed to automatically identify the valve motion by hybrid SVM-HMM[1] based
on the amplitude and timing of the peaks. However, in the present
study, six patterns were identified for the DUS components which
were actually variable on a beat-to-beat basis and found to be different for the early gestation (16–32 weeks), compared to the late
gestation fetuses (36–41 weeks). The amplitude of the peaks linked
to the valve motion was different across the six patterns and this
affected the precision of valve motion identification by the previous
hybrid SVM-HMM method. Therefore in the present study, clustering of the DUS components based on K-means was proposed and
the hybrid SVM-HMM was trained for each cluster separately. The
valve motion events were consequently identified more efficiently
by beat-to-beat attribution of the DUS component peaks. Applying
this method, more than 98.6% of valve motion events were beatto-beat identified with average precision and recall of 83.4% and
84.2% respectively. It was an improvement compared to the hybrid method without clustering with average precision and recall
of 79.0% and 79.8%. Therefore, this model would be useful for
reliable screening of fetal wellbeing.
Index Terms—Doppler ultrasound, fetal assessment, fetal cardiac intervals, hidden Markov models (HMM), hybrid SVMHMM, K-means clustering, support vector machine (SVM),
wavelet analysis.

Manuscript received May 14, 2014; revised August 21, 2014; accepted October 7, 2014. Date of publication October 16, 2014; date of current version
December 31, 2015. This work was supported by an Australian Research Council Linkage under Grant LP100200184 between the University of Melbourne,
Tohoku University and Atom Medical Corporation in Japan. A part of the work
was carried out under the Coordination, Support and Training Program for
Translational Research, Ministry of Education, Culture, Sports, Science and
Technology in Japan. (Corresponding author: A. H. Khandoker.)
F. Marzbanrad, A. H. Khandoker, and M. Palaniswami are with the
Electrical and Electronic Engineering Department, University of Melbourne,
Melbourne 3010, Australia (e-mail: f.marzbanrad@student.unimelb.edu.au;
ahsank@unimelb.edu.au; palani@unimelb.edu.au).
A. H. Khandoker is with the Biomedical Engineering Department, Khalifa
University of Science, Technology and Research, Abu Dhabi, UAE (e-mail:
ahsan.khandoker@kustar.ac.ae).
Y. Kimura, K. Funamoto, S. Oshio, M. Endo, and N. Sato are with the
Graduate School of Medicine, Tohoku University, Sendai 980-8577, Japan
(e-mail: ykimura@med.tohoku.ac.jp; kiyoe-konno-funamoto@med.tohoku.ac.
jp; sayakannbou@hotmail.com; miyukien@med.tohoku.ac.jp).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2363452

I. INTRODUCTION
ETAL assessment techniques generally attempt to identify
fetuses at risk of intrauterine compromise or death. Fetal
cardiac assessment is the main factor of evaluating fetal circulation which provides information on the fetal wellbeing during
pregnancy [2]. This information can be used for early diagnosis
of fetal diseases, such as various types of Congenital Heart Diseases (CHDs) or abnormal intrauterine conditions, such as fetal
distress due to insufficient oxygen supply for the fetus. These
conditions may threaten the life of the fetus if left untreated,
while early detection reduces perinatal morbidity and mortality,
and provides tremendous medical, psychological and economic
benefits [3], [4].
Although fetal assessment techniques are widely used, there is
still limited evidence of their effectiveness in improving perinatal outcomes. Therefore, it is worthwhile to find methods which
provide sensitive markers for fetal cardiac assessment. Current
methods are generally used to monitor fetal heart rate, which are
useful, but not enough for a thorough assessment of fetal heart.
A more detailed investigation of the fetal heart wellbeing can
be performed by evaluation of the electromechanical coupling
of the fetal heart using the markers based on the opening and
closure timings of the cardiac valves [5]–[7].
Valve motion timings can be detected non-invasively from
either fetal echocardiography or Doppler Ultrasound (DUS) together with fetal electrocardiography (fECG) as a reference. Fetal echocardiography is expensive, highly specialized, requires
skilled specialists to operate and is only performed for particular fetal and maternal conditions. Therefore, the DUS technique
which is simpler and requires less skill is more suitable for this
purpose. In this technique, the Doppler shift of the ultrasound
beam which is reflected from moving valves of the fetal heart,
manifests the movement of the cardiac valves [5], [8], [9].
In order to identify the valve motion using the DUS signal, the
component corresponding to valve motion should be extracted
from the components related to the movement of the cardiac
wall or other organs. Early studies in the 1980s proposed noninvasive methods which mainly aimed to analyze the systolic
time interval, using non-invasive abdominal ECG and the DUS
signal [7], [8], [10], [11]. All of these methods used band pass
filtering approaches to extract the high frequency component
of the DUS, from which the valve movements were identified
manually by experts using fECG as a reference. There were
two main issues with these methods needing to be resolved.
Firstly, due to the noisiness and variability of the DUS data

F

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

MARZBANRAD et al.: MODEL-BASED ESTIMATION OF AORTIC AND MITRAL VALVES OPENING AND CLOSING TIMINGS IN DEVELOPING

on a beat-to-beat basis, as well as the wide changes in the
signal contents and spectral characteristics over time, band pass
filters could not effectively provide the component originated
by the valve motion. Secondly, manual identification of beat-tobeat opening and closing of valves is time consuming, requires
special expertise and is subject to inter and intra observer and
visual errors. Improvement in the aforementioned aspects is
essential to make this technique more reliable and applicable
with less expertise.
Several studies suggested applying improved signal processing techniques and more powerful processors to extract the information content of the DUS signal and improve the quality
of the separation of fECG [9], [12]–[14]. Short Time Fourier
Transform (STFT) analysis of the DUS signal showed that the
component with a higher frequency band (above 100 Hz) is
generally linked to valve movement, while the low frequency
component is associated with the cardiac wall motion [9]. However the frequency range of the valve motion related component
is not constant over time. Therefore, multi-resolution wavelet
analysis was proposed to be applied to the DUS signal [13],
which is for decomposing the nonstationary signals with variable spectral characteristic over time. Using the wavelet analysis, valve movements were visualized as peaks in the detailed
signal (at level 2 wavelet decomposition). Empirical Mode Decomposition (EMD) was also proposed as an alternative which
is a data-driven algorithm used for decomposing nonlinear and
non-stationary time series. This algorithm can effectively separate the component linked to valve movements [1], [14].
Since fECG is used as a reference, it is necessary to have a
reliable and precise detection of the R waves from the fECG.
Non-invasively recorded fECG is contaminated by noise. It is
also mixed with the maternal ECG and other interferences such
as: maternal respiration, motion artifacts and uterine contractions. Different methods have been proposed and utilized to
extract the fECG from the mixture, including but not limited
to adaptive filtering, linear and non linear decomposition and
blind source separation techniques [15], [16]. A blind source
separation with reference method was proposed by Sato et al.,
to separate the fECG used in our previous studies [1], [13], [17].
Another challenge is the need for automated identification of
valve movement. A method based on Hidden Markov Model
(HMM) was proposed for this purpose [14]. Opening and closing of different valves, assumed as hidden states, were identified from the observed sequences of the peaks of the DUS
signal component using HMM [14]. It was later found that the
amplitude of the peaks can improve valve movement identification, in addition to the timing of the peaks. Therefore, a hybrid method composed of HMM and Support Vector Machines
(SVM-HMM) was used, in which both the transition model of
the valve motion and pattern of the peaks were used to identify
the valve motion events from the observed peaks of the DUS
signal component [1].
Although SVM-HMM provides a better estimation of fetal
cardiac timings compared to HMM, non-stationary characteristics of the DUS signal complicate the classification of the peaks.
The variable pattern of the DUS component is observed for both
inter and intra subjects, which primarily depends on the orien-

241

tation of the fetal heart with respective to the transducer [9].
For example, the peak corresponding to aortic valve opening is
sometimes smaller and sometimes larger than the peak representing the mitral closure. If a common training set is used for
all existing patterns of the DUS components, the identification
precision of valve motion by hybrid SVM-HMM is decreased.
In this paper, a K-means clustering method is first used to
find the patterns of the DUS components and match each beatto-beat DUS components to one of the models. Then, the valve
motion events are identified from the peaks of the DUS component using hybrid SVM-HMM trained specifically for its corresponding cluster. In this study, six patterns were identified for
DUS components and the occurrence rate of each pattern was
also analyzed for the fetuses in two age groups to investigate its
relationship with the gestational age.
II. MATERIALS AND METHODS
A. Data
The DUS signal from 1.5 MHz Ultrasonic Transducer 5700
and the abdominal ECG signals were collected by a multichannel data acquisition system (fetal monitor 116, Corometrics
Medical Systems Inc) with 1000 Hz sampling frequency and
16 bit resolution. Twelve electrodes were used for abdominal
ECG recordings, ten of which were arranged on the mother’s
abdomen, one reference electrode on the back and one electrode was set at the right thoracic position. The DUS transducer
was placed on the lower abdomen and the audio output was
connected to the input channel of the fetal monitor.
Doppler ultrasound and the abdominal ECG signals were
recorded simultaneously from 61 pregnant women at the gestational age of 16 to 41 (33 ± 6) weeks with normal single
pregnancy at Tohoku University Hospital, Japan. DUS signal
patterns were compared in two age groups of early gestation
(16–32 weeks) and late gestation (36–41 weeks), including 24
and 28 fetuses respectively. All recordings were 1 min in length
and sampled at 1 kHz with 16-bit resolution.
The study protocol was approved by Tohoku University Institutional Review Board and written informed consent was obtained from all participants. M-mode and pulsed-wave Doppler
were acquired simultaneous with DUS and fECG recordings,
using convex 3.5 Hz of HITACHI ultrasound scanner, to verify
the mitral and aortic valve opening and closing time obtained
from the DUS signal. Ultrasonic diagnostic instrument Model
EUB-525; from Hitachi health medical corporation and ACCUVIX A30; from Samsung Medison were used in this experiment.
More details about the experimental set up can be found in our
previous study [17].
B. fECG Extraction
Data from 12 channels were recorded bipolarly from the electrodes placed on the maternal abdomen, sampled every 1 ms
(1 kHz sampling) with 16-bit resolution and bandpass filtered
by 1–100 Hz finite impulse response filter. To separate fECG
from the composite abdominal signal, a combination of maternal
ECG cancelation and blind source separation with the reference

242

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

sis functions to decompose the signal into the detailed and the
approximate signals, which are the higher and lower frequency
components, respectively. The decomposition is repeated on the
approximation signal to obtain detail and approximation signals
at the next level. In this study, the second order complex Gaussian was used as mother wavelet. The detailed signal of the DUS
signal at level 2 is the high frequency component (100–200 Hz)
which corresponds to the valve motion events [Fig. 1(b)] [9],
[13]. The envelope of the absolute value of this signal was taken
by interpolating its maxima and smoothing by low pass filter
[Fig. 1(c)]. In the rest of the paper, this envelope is called “DUS
component” for simplicity.
D. Segmentation and Normalization
The DUS component was segmented into cardiac cycle sections and then normalized. Segmentation was performed using
R-peaks of the simultaneously recorded fECG. Each segment of
the DUS component was taken from R-R intervals of the corresponding fECG. It was then normalized by subtracting the mean
and dividing by the standard deviation of the DUS component
estimated over the segment. An example is shown in Fig. 1(c).
E. Training
Fig. 1. The decomposition of the DUS signal using the second order complex
Gaussian as mother wavelet; (a) the DUS signal, (b) the detailed signal at level
2, (c) the envelope of the detailed signal (the DUS component) and its segments
divided by dash-dot lines, (d) Simultaneously recorded fECG.

signal (BSSR) was used [17]. In brief, electrical activities of the
heart can be modeled as a vector in the direction of excitation
called the heart vector [18]. The maternal ECG component was
excluded by subtracting the linear combination of mutually orthogonal projections of the heart vector. After that, BSSR which
is a kind of neural network method, was used to extract fECG
from complex mixture using DUS signal as a reference [17].
The R-peaks of fECG were then automatically detected by
applying a lower threshold (e.g. 5 times the mean of fECG over
10 s intervals) and the first and second derivatives of the signal.
C. DUS Signal Decomposition
The collected DUS signal [Fig. 1(a)] contained components
linked to the movement of the fetal cardiac valves, walls or
other organs. It has been shown in [9] that the high frequency
component of the DUS signal is linked to the valve movement,
while the low frequency component is associated with the cardiac wall motion. Considering the synchronous operation of
left and right sides of the fetal heart, the motion of semilunar
and atrioventricular valves is expressed as the aorta and mitral
valve movement respectively throughout this paper. To obtain
the valve motion related component, the DUS signal was decomposed by the multiresolution Wavelet analysis [13], [19].
It is established as a powerful tool to analyze non-stationary
signals with variable spectral characteristics over time such as
the DUS signal. The wavelet transform (WT) uses a set of ba-

The training phase consists of three sections: Clustering in
which different models of the segments of the DUS components
were automatically obtained using K-means clustering, HMM
training in which the transition model was estimated from the
training data and SVM training in which the SVM structure
was developed. Training data set was obtained from 345 cardiac
cycles of DUS components and fECG from 21 fetuses. The
cardiac valve motion events for this train set, were identified
manually based on expertise.
1) Clustering: K-means clustering method was used to estimate different templates for the segments of the DUS components. The k-means clustering [20] is a classical, most widely
known and well-studied unsupervised learning approach, which
iteratively clusters data into groups with members close to each
other and far from members of other clusters. It is a fast algorithm with uncomplicated computation for each iteration and
converges in few iterations [21].
For clustering and template matching, the first 350 samples
(350 msec) of the DUS component in each segment were used
(x in (1)). However for HMM-SVM training and recognition,
all samples (full length) of the segments were considered. The
K-means clustering algorithm was performed based on Euclidean distance. It was used to find the clusters C1 , . . . , Ck ,
such that:
arg min

C 1 ,...,C k

k



 xo − μh 2 , (o = 1, 2, . . . , M ) (1)

h=1 x o ∈C h

where xo is the observed DUS component of segment (o), M
is the number of observation segments (e.g. 345 segments) and
μh is the mean of the observation segments in cluster Ch . Different number of clusters k from 3 to 16 was tested and the
mean silhouette value was the highest for 6 clusters. The final

MARZBANRAD et al.: MODEL-BASED ESTIMATION OF AORTIC AND MITRAL VALVES OPENING AND CLOSING TIMINGS IN DEVELOPING

Fig. 2. The DUS component segments which were clustered into six profiles
are shown in the top figure (a), the centroid of each cluster are shown in the
bottom figure (b). The mean ± SD duration of the valve motion timings of
the training set for each cluster is marked with downward-pointing triangles in
figure (b).

number was therefore decided to be six (k = 6) which resulted
a reasonable combination of the mitral and aortic valve motion peaks with different comparative sizes across the clusters. The centroid of the clusters and the DUS component
segments of each cluster are shown in Fig. 2. K-means clustering function from statistics toolbox of MATLAB was used for
clustering.
The percentage of observing each pattern was calculated
for each fetus. Then the percentage of each pattern was compared for early and late gestation groups applying Mann-MannWhitney–Wilcoxon test.
2) SVM-HMM Training: The hybrid SVM-HMM method
was developed for speech recognition applications [22] and
proposed for recognizing the fetal valve motion in our previous
paper [1]. In brief SVM and HMM were combined to automatically identify the valve motion events based on the transition of
the states and pattern of the observation. This method includes
training and testing processes which are described below and in
the next section (F.2), respectively.

243

HMM was used for automated identification of fetal valve
motion [1], [14], [19] and HMM training procedure can be
summarized as follows. HMM deals with the problems in which
the observed symbols are emitted from some ”hidden” states
[23], [24]. In this application eight hidden states are defined,
including the valve motion and the transition events between
them which are not linked to any valve motion, namely: Mitral
closing (Mc), transition 1 (TR1), Aorta opening (Ao), transition
2 (TR2), Aorta closing (Ac), transition 3 (TR3), Mitral opening
(Mo), transition 4 (TR4). The HMM observation is the DUS
component and the features are the timing and amplitude of the
peaks of each segment of DUS component. In the hybrid SVMHMM training, the transition matrix is estimated from HMM
training process and the emission matrix is obtained from SVM
training. The SVM-HMM training process was performed for
the training data of each cluster (Ch , h = 1 . . . , 6) separately.
Let us assign si , where i = 1, 2, . . . , 8 to the hidden states
defined above. Each ij th element of the transition matrix was
estimated from the number of times sj followed si in the training
set, divided by the number of times si occurred in the set. The estimated transition matrix was used in the automated recognition
of valve motion events by hybrid SVM-HMM.
Emission matrices were estimated using SVM, which was
developed by Vapnik [25] as a powerful classification technique. Classically two class SVM is designed to find a separating hyperplane with the maximum margin with the classes. In
this application the observation was classified into eight classes
which were the same as the hidden states as described above,
i.e. Mc, TR1, Ao, TR2, Ac, TR3, Mo, TR4. Therefore, we used
one-against-all approach to design a multiclass SVM [26]. The
Radial Basis Function (RBF) (σ = 1) was used as kernel to enable nonlinear classification. For the training process, all peaks
of each segment of DUS components were identified using the
derivative of the signal. Then the amplitude of each peak and
the interval between the peak and its proceeding R-wave were
acquired as the classification features. In the SVM training process, the SVM classifier was trained and the support vectors were
identified. This process was performed on the training data of
each cluster separately to obtain the SVM classifier specific to
each of the six clusters.
F. Automated Recognition of Valve Motion
The main algorithm for identification of cardiac valve events
includes template matching and hybrid SVM-HMM. The latter
uses the trained models from the training process to find the
valve timings for the new (test) data.
1) Template Matching: The DUS components of the test
data were segmented into cardiac cycles using their corresponding fECG R-R intervals. Then each segment was attributed to
one of the clusters which gave the minimum Euclidean distance
between the first 350 samples of each segment (y) and centroid
of the cluster:
H(y) = argmin  y − μh 2 , (h = 1, 2, . . . , 6)
h

(2)

where y is a segment of DUS component from test data and H
is the cluster index. In order to identify the valve motion events

244

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

TABLE I
P-VALUE RESULTS FOR COMPARISON OF THE PERCENTAGE OF DIFFERENT
PATTERNS FOR THE FETUSES IN EARLY GESTATION (16–32 WEEKS) AND LATE
GESTATION (36–41 WEEKS), APPLYING MANN-WHITNEY-WILCOXON

Fig. 3.

Patterns

p-value

1
2
3
4
5
6

0.0083
0.1541
0.0422
0.0061
0.0448
0.0258

Block diagram of the training and testing processes.

in each segment, the trained model for its matched cluster was
used in hybrid SVM-HMM process.
2) Hybrid SVM-HMM: For each segment of the DUS components in the test data (y), the time and amplitude of the peaks
were used to classify them by SVM classifier trained for the
corresponding cluster of that segment (CH (y ) ). Since HMM is
based on probability models, a probabilistic output of SVM
was required. Therefore Platt’s method was used, which transforms the distance of each sample from the separating hyperplane to the posterior probability of classifying the sample, i.e.
P (class|input) [27]. The emission probability distribution was
estimated using the output of the platt’s SVM through the Bayes’
rule [1].
The transition probability (from HMM training) and the emission probability matrices specific to each cluster were used to
find the most likely sequence of events for each new segment of
the DUS component, using Viterbi algorithm [24]. The hybrid
SVM-HMM process was effectively used for identification of
the valve motion events [1]. The block diagram of the training
and testing process is shown in Fig. 3.
III. RESULTS
A. Clustering
In the training phase the segments of the DUS components
were clustered by K-means method. Six clusters with different
patterns of the DUS component segments are shown in Fig. 2.
The mean ± standard deviation (SD) ranges of the valve motion
timings are shown in Fig. 2(b) for each cluster. The cluster centroids have peaks in the time range of the valve motion events,
but with different comparative amplitude across 6 clusters.
B. Comparison of Patterns for Gestational Age
The percentage of beats with each DUS pattern was calculated
for 24 and 28 fetuses in early (16–32 weeks) and late gestation
(36–41 weeks), respectively. The percentage of each pattern was
compared between two groups using Mann-Whitney-Wilcoxon

Fig. 4. The median and 25%–75% quartile ranges of the occurrence percentage of each pattern in early (16–32 weeks) and late (36–41 weeks) gestation
groups. Groups were compared by Mann-Whitney U test and significant differences were marked as follows: P < 0.05 (*) and P < 0.01 (**).

test, considering p-value < 0.05 as significant. Table I shows
the p-values for comparing each pattern and Fig. 4 shows the
median and 25%–75% quartile ranges of the percentage of occurring for each pattern in early and late gestation groups. The
Result shows that the patterns 1 and 6 occurred with significantly higher rate after 36 weeks, compared to the cases before
32 weeks. On the other hand patterns 3, 4 and 5 were observed
with significantly higher rates for the early gestation group. The
percentage difference between two age groups was not significant for pattern 2.
C. Validation with Echocardiography Images
M-mode and pulsed-wave Doppler were acquired simultaneous to DUS and fECG recordings for two fetuses to validate

MARZBANRAD et al.: MODEL-BASED ESTIMATION OF AORTIC AND MITRAL VALVES OPENING AND CLOSING TIMINGS IN DEVELOPING

245

Fig. 5. (a) The M-mode image of the opening and closing time of the aortic
valve. The dashed lines depict the aorta opening (Ao) and closing (Ac) events.
(b) The DUS components and the events identified by the automated method.
(c) Simultaneously recorded fECG.

the aorta and mitral motion timings respectively. The data from
these two cases were not involved in the training process and
only used for testing.
M-mode image is used to evaluate the structure and operation
of the valves. Fig. 5 shows opening and closing of the aorta using
M-mode recording for 5.7 s, which are marked and compared
with the results of the proposed method. This figure shows that
the aorta opening and closing events identified by the proposed
method were aligned with the events shown in the M-mode
image. The identified opening and closing events of mitral are
not shown to avoid confusion.
The direction and the characteristics of blood flow through
the valves are usually examined with Pulsed wave Doppler.
The blood flow Doppler waveform through the mitral valve is
shown in Fig. 6(a). The valve motion events were identified in
two ways; using K-means clustering and hybrid SVM-HMM
for each cluster [Fig. 6(b)] and using the hybrid SVM-HMM
without clustering [Fig. 6(c)] [1], [19]. For both methods wavelet
was used to obtain the DUS component, applying the same
training set, but the set was partitioned into the clusters for the
new method.
Fig. 6 shows that the identified mitral movement events by the
new method were aligned with the pulsed wave doppler images
[Fig. 6(b)], while some of them were misidentified by the previous method [Fig. 6(c)]. This comparison can be investigated in
more details by considering the mitral opening event occurred

Fig. 6. (a) Pulsed wave Doppler signal of fetal mitral valve movements annotated to show the mitral opening (Mo) and closing (Mc), (b) The DUS component
and the valve motion events identified by the proposed method (K-means and
hybrid SVM-HMM), (c) The DUS component and the valve motion events
identified by the hybrid SVM-HMM without clustering [1], (d) Simultaneously
recorded fECG.

at 1543 msec, misclassified by the previous method. The new
technique found the segment of 1268–1700 msec closest to the
cluster 2. The range of mitral opening event for this cluster is
illustrated in Fig. 7(a). It is shown that the amplitude of this
peak and its interval from the preceding R-peak of fECG at
1543 msec, is well situated in range of Mo events in Fig. 7(a).
On the other hand, the trained range of the Mo peak amplitude in Fig. 7(b) was wider and included even small amplitudes,
because clustering was not performed in the previous method
and training was based on the DUS components with various
patterns. This is one reason why the peak at 1596 msec was
wrongly recognized as Mo. It is worth noting that SVM is only
a part of classification, and transition of the events takes part in
recognition of the events in the HMM part of the hybrid method.
D. Cross Validation Results
To quantitatively compare the results of the new method with
the previous method which was based on SVM-HMM without
clustering [1], 10-fold cross validation was performed on the

246

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

TABLE III
MEAN ± STANDARD ERROR (SE) OF THE INTERVALS BETWEEN R-PEAK
OF FECG AND VALVE MOTION AND THE RATE OF IDENTIFIED EVENTS
Intervals
R-R
R-Mc
R-Ao
R-Ac
R-Mo

Mean ± SE (msec)

Rate*

420.5 ± 34.1
24.2 ± 4.1
59.8 ± 5.0
220.2 ± 7.9
304.6 ± 11.0

100 %
98.6 %
99.8 %
99.7 %
98.8 %

The rate is calculated from the number of identified valve motion events out
of 8510 beats belonging to 61 fetuses.

ferent identified events by two methods. Cross validation result
shows improvement of precision and recall of identifying mitral opening by 10.8% and 9.4%, respectively and aorta closing
by 10.7%. Overall, the average precision and recall were improved in the new method (precision: 83.4% and recall: 84.2%)
compared to the previous approach (precision: 79.0% and
recall: 79.8%) [1].
E. Extended Results

Fig. 7. (a) The trained SVM for classification of mitral opening for the second
cluster, used by the new method. (b) The trained SVM for classification of mitral
opening for all training data regardless of the clusters by the previous method.

TABLE II
PRECISION (%) AND RECALL (%) OF VALVE MOTION IDENTIFICATION USING
THE NEW HYBRID SVM-HMM WITH CLUSTERING VERSUS THE PREVIOUS
SVM-HMM APPROACH WITHOUT CLUSTERING [1]
Parameter

Methods

Mc

Ao

Ac

Mo

Average

Precision

New
Previous [1]
New
Previous [1]

89.5
91.6
92.4
93.4

87.8
89.7
89.2
90.8

86.3
75.6
86.3
75.6

69.9
59.1
68.7
59.3

83.4
79.0
84.2
79.8

Recall

training data. Training data containing 345 segments of DUS
component from 21 fetuses were partitioned into training and
testing sub-sets. Partitioning was performed for each cluster to
include all clusters in training and testing. The identification
precision and recall of each valve timing event were calculated
as follows and averaged over the 10 folds:
Precisioni =
Recalli =

Ti +
Ti +

Ti

j

Fij

j

Fj i

Ti


(3)
(4)

where i refers to one of the valve motion events (Mo, Mc, Ao
or Ac), Ti is the number of true estimation of event i and Fij
indicates the number of times event j was mistakenly identified
as event i. Table II summarizes the precision and recall of dif-

The proposed method was also applied on data from other
fetuses not involved in training, to evaluate the identification
rate and valve timing intervals. The average intervals between
R-peak of the fECG and valve openings and closings for 8510
beats belonging to 61 cases and the rate of identified events are
summarized in Table III.
IV. DISCUSSION
The DUS signal has a transient nature and the signal content
is widely variable even on a beat-to-beat basis, depending on the
orientation of the fetal heart and the DUS transducer. The DUS
signal variability for inter and intra subjects was also discussed
by shakespeare et al. [9]. In the current study, it was shown that
the development and maturation of the fetal heart also take part
in the variability of the patterns. It was proposed in previous
studies to use STFT, Wavelet transform or EMD to extract the
component linked to the valve motion, but this component does
not have a single pattern for all beats and different fetuses.
Fig. 1(c) shows an example in which the change in the pattern
of DUS component is observed in successive beats. The DUS
component patterns were clustered into six groups by K-means
and the DUS components had peaks linked to the valve motion
in a common range of timing and amplitude within each groups,
different from other clusters. Fig. 2 shows the centroid of each
cluster and the range of valve motion events determined from
the training data specific to each cluster, which demonstrates
the difference in the average amplitude of peaks linked to each
event across clusters. This was the point to use clustering to
train the SVM-HMM for each cluster separately and decode the
peaks of the DUS components based on trained SVM-HMM
specific to the matched cluster.
Comparing to the method in which clustering was not performed, this method achieved better precision and recall. Because the DUS components of the training set without clustering,

MARZBANRAD et al.: MODEL-BASED ESTIMATION OF AORTIC AND MITRAL VALVES OPENING AND CLOSING TIMINGS IN DEVELOPING

had different patterns and the amplitude and timing range of the
peaks representing the events were wide and disparate. When
data were clustered before training, the peaks linked to each
event were concentrated and more unified in a certain range of
timing and amplitude, from which the valve opening and closing
were better identified. For example the trained SVM for one of
the clusters by the new method [Fig. 7(a)] was compared with
the SVM trained based on the whole training set regardless of
their pattern [Fig. 7(b)] according to the previous method. The
first SVM could better discriminate the range of amplitudes corresponding to Mo. The Systolic Time Intervals (STI) were found
as significant indicators of myocardial function. For example,
PEP is the interval from onset of QRS complex to Ao and was reported as a sensitive indicator of the fetal myocardium function.
Development of hypoxemia and acidosis are early manifested
by prolongation of PEP [5]. ICT is the Mc-Ao interval which
is a reliable index of fetal cardiac contractility [28]. The STIs
which depend on the onset of QRS complex of fECG, Mc, Ao
and Ac could be estimated with more than 98.6% identification
rate and higher than 86.3% precision by this method.
Fetal echocardiography is a method which is currently used
to obtain the fetal cardiac intervals [29]–[32]. The pulsed wave
Doppler and M-mode echocardiography may be performed for
this purpose but need skilled specialists to perform and are
highly specialized compared to the Doppler Ultrasound method
suggested in this study. The use of DUS signal and fECG provides a simpler way and with the automated technique proposed,
beat-to-beat valve motion timings are continuously evaluated
with less time and skill for operation. Furthermore, using pulsedwave Doppler, the recording is captured in one screen size and
the motion of only one valve (e.g. mitral or aorta) at a time is
monitored; while DUS signal enables identification of opening
and closure of mitral and aorta in each beat with a recording of
DUS and fECG. In this paper M-mode and pulsed wave doppler
images were used to verify the results of automated identification. More quantitative comparisons can be performed in future
studies.
V. CONCLUSION
Opening and closing of fetal cardiac valves are reflected as
peaks in the high frequency component of the DUS signal. In
this study, we found six different patterns for the DUS component. The occurrence rate of five patterns for the fetuses with less
than 32 weeks of age was different from the fetuses older than
36 weeks. Each pattern had different amplitude range and timing of the peaks linked to the aortic and mitral valve motion.
K-means clustering was applied to the DUS components in
training set and SVM-HMM was trained for each cluster separately. In this way, valve motion events were detected from
each DUS component based on the trained SVM-HMM specific to its matching cluster. The identification of opening and
closing of the mitral by SVM-HMM was improved using clustering compared to the method without clustering as verified by
pulsed wave Doppler image. The average precision and recall of
the method with clustering were 83.4% and 84.2% respectively,
which were higher than the method without clustering. More

247

than 98.6% of cardiac valve motion events were identified by
the new method.
ACKNOWLEDGMENTS
The authors would like to thank the team of clinical support
service at Tohoku University for providing the fetal Doppler and
fECG data.
REFERENCES
[1] F. Marzbanrad, Y. Kimura, K. Funamoto, R. Sugibayashi, M. Endo, T. Ito,
M. Palaniswami, and A. Khandoker, “Automated estimation of fetal cardiac timing events from doppler ultrasound signal using hybrid models,” IEEE J. Biomed. Health Informat., vol. 18, no. 4, pp. 1169–1177,
Oct. 2013.
[2] P. Malcus, “Antenatal fetal surveillance,” Current Opinion Obstetrics Gynecol., vol. 16, no. 2, pp. 123–128, 2004.
[3] E. Merz, Ultrasound in Obstetrics and Gynecology. Stuttgart, Germany:
Georg Thieme Verlag, 2004.
[4] A. B. Hameed and M. S. Sklansky, “Pregnancy: maternal and fetal heart
disease,” Current Problems Cardiol., vol. 32, no. 8, pp. 419–494, 2007.
[5] Y. Murata and J. C. B. Martin, “Systolic time intervals of the fetal cardiac
cycle,” Obstetrics Gynecol., vol. 44, no. 2, pp. 224–232, 1974.
[6] I. E. Zador, R. N. Wolfson, S. K. Pillay, I. E. Timor-Tritsch, and
R. H. Hertz, “Fetal cardiac time intervals and their potential clinical applications,” Clinical Obstetrics Gynecol., vol. 22, no. 3, pp. 651–663,
1979.
[7] T. Koga, N. Athayde, and B. Trudinger, “The fetal cardiac isovolumetric
contraction time in normal pregnancy and in pregnancy with placental
vascular disease: the first clinical report using a new ultrasound technique,”
Brit. J. Obstetrics Gynaecol., vol. 108, no. 2, pp. 179–185, 2001.
[8] Y. Murata, C. B. Martin, T. Ikenoue, and P. Lu, “Antepartum evaluation of
the pre-ejection period of the fetal cardiac cycle,” Amer. J. Obstet Gynecol,
vol. 132, pp. 278–284, 1978.
[9] S. Shakespeare, J. Crowe, B. Hayes-Gill, K. Bhogal, and D. James, “The
information content of doppler ultrasound signals from the fetal heart,”
Med. Biological Eng. Comput., vol. 39, no. 6, pp. 619–626, 2001.
[10] M. B. Sampson, “Antepartum measurement of the preejection period in
high-risk pregnancy,” Obstetrics Gynecol., vol. 56, no. 3, pp. 289–290,
1980.
[11] L. Organ, A. Bernstein, and P. Hawrylyshyn, “The pre-ejection period as
an antepartum indicator of fetal well-being.” Amer. J. Obstetrics Gynecol.,
vol. 137, no. 7, pp. 810–819, 1980.
[12] T. Kupka, J. Jezewski, A. Matonia, K. Horoba, and J. Wrobel, “Timing
events in doppler ultrasound signal of fetal heart activity,” in Proc. IEEE
26th Annu. Int. Conf. Eng. Med. Biol. Soc., 2004, vol. 1, pp. 337–340.
[13] A. H. Khandoker, Y. Kimura, T. Ito, N. Sato, K. Okamura, and
M. Palaniswami, “Antepartum non-invasive evaluation of opening and
closing timings of the cardiac valves in fetal cardiac cycle,” Med. Biological Eng. Comput., vol. 47, no. 10, pp. 1075–1082, 2009.
[14] F. Marzbanrad, A. H. Khandoker, K. Funamoto, R. Sugibayashi, M. Endo,
C. Velayo, Y. Kimura, and M. Palaniswami, “Automated identification of
fetal cardiac valve timings,” in Proc. IEEE 35th Annu. Int. Conf. Eng.
Med. Biol. Soc., 2013, pp. 3893–3896.
[15] R. Sameni and G. D. Clifford, “A review of fetal ecg signal processing;
issues and promising directions,” Open Pacing, Electrophysiol. Therapy
J., vol. 3, pp. 4–20, 2010.
[16] Y. Kimura, N. Sato, J. Sugawara, C. Velayo, T. Hoshiai, S. Nagase, T. Ito,
Y. Onuma, A. Katsumata, K. Okamura et al., “Recent advances in fetal
electrocardiography,” Open Med. Devices J., vol. 4, pp. 7–12, 2012.
[17] M. Sato, Y. Kimura, S. Chida, T. Ito, N. Katayama, K. Okamura, and
M. Nakao, “A novel extraction method of fetal electrocardiogram from
the composite abdominal signal,” IEEE Trans. Biomed. Eng., vol. 54,
no. 1, pp. 49–58, Jan. 2007.
[18] E. Symonds, D. Sahota, and A. Chang, Fetal Electrocardiology. London,
U.K.: Imperial College Press, 2001.
[19] F. Marzbanrad, Y. Kimura, K. Funamoto, R. Sugibayashi, M. Endo,
T. Ito, M. Palaniswami, and A. Khandoker, “Development of fetal cardiac intervals throughout 16 to 41 weeks of gestation,” in Proc. IEEE
Comput. Cardiol. Conf., 2013, pp. 1155–1158.
[20] J. MacQueen et al., “Some methods for classification and analysis of
multivariate observations,” in Proc. 5th Berkeley Symp. Math. Statistics
Probability, Berkeley, CA, USA, 1967, vol. 1, pp. 281–297.

248

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 1, JANUARY 2016

[21] S. Theodoridis, A. Pikrakis, K. Koutroumbas, and D. Cavouras, Introduction to Pattern Recognition: A Matlab Approach. New York, NY, USA:
Academic, 2010.
[22] A. Ganapathiraju, J. Hamaker, and J. Picone, “Hybrid SVM/HMM architectures for speech recognition,” in Proc. Interspeech, Citeseer, 2000,
pp. 504–507.
[23] L. E. Baum, T. Petrie, G. Soules, and N. Weiss, “A maximization technique
occurring in the statistical analysis of probabilistic functions of markov
chains,” Ann. Math. Stat., vol. 41, no. 1, pp. 164–171, 1970.
[24] L. Rabiner, “A tutorial on hidden Markov models and selected applications
in speech recognition,” Proc. IEEE, vol. 77, no. 2, pp. 257–286, Feb. 1989.
[25] V. Vapnik, The Nature of Statistical Learning Theory. New York, NY,
USA: Springer, 2000.
[26] S. Abe, Support Vector Machines for Pattern Classification. New York,
NY, USA: Springer, 2010.
[27] J. Platt et al., “Probabilistic outputs for support vector machines and
comparisons to regularized likelihood methods,” Advances Large Margin
Classifiers, vol. 10, no. 3, pp. 61–74, 1999.
[28] Y. Yumoto, S. Satoh, Y. Fujita, T. Koga, N. Kinukawa, and H. Nakano,
“Noninvasive measurement of isovolumetric contraction time during hypoxemia and acidemia: Fetal lamb validation as an index of cardiac contractility,” Early Human Develop., vol. 81, no. 7, pp. 635–642, 2005.
[29] N. A. Mensah-Brown, R. T. Wakai, B. Cheulkar, S. Srinivasan, and
J. F. Strasburger, “Assessment of left ventricular pre-ejection period in the
fetus using simultaneous magnetocardiography and echocardiography,”
Fetal Diagnosis Therapy, vol. 28, no. 3, pp. 167–174, 2010.
[30] K. Mäkikallio, P. Jouppila, and J. Räsänen, “Human fetal cardiac function
during the first trimester of pregnancy,” Heart, vol. 91, no. 3, pp. 334–338,
2005.
[31] M. Nii, R. M. Hamilton, L. Fenwick, K. S. Roman, E. T. Jaeggi et al.,
“Assessment of fetal atrioventricular time intervals by tissue doppler and
pulse doppler echocardiography: normal values and correlation with fetal
electrocardiography,” Heart, vol. 92, no. 12, pp. 1831–1837, 2006.
[32] R. Cruz-Martı́nez, F. Figueras, M. Bennasar, R. Garcı́a-Posadas, F. Crispi,
E. Hernández-Andrade, and E. Gratacós, “Normal reference ranges from
11 to 41 weeks’ gestation of fetal left modified myocardial performance
index by conventional doppler with the use of stringent criteria for delimitation of the time periods,” Fetal Diagnosis Therapy, vol. 32, no. 1/2,
pp. 79–86, 2012.

Faezeh Marzbanrad (S’13) received the B.Sc. and
M.Sc. degrees in electrical engineering from Shiraz
University, Shiraz, Iran, in 2007 and 2010, respectively. She is currently working toward the Ph.D.
degree in the Department of Electrical and Electronic Engineering, the University of Melbourne,
Melbourne, Australia.
Her research interests include statistical signal
processing, time-frequency analysis, and machine
learning, with special emphasis on fetal cardiac
assessment.

Yoshitaka Kimura received the Master of Science
degree in mathematics in 1982 and the M.D. degree
in 1997 from Tohoku University, Sendai, Japan.
From 1998 to 2004, he was a Lecturer in the Departments of Obstetrics and Gynecology, Graduate
school of Medicine, Tohoku University. From 2003
to 2004, he was a Visiting Researcher at New York
University Medical Center. From 2004 to 2012, he
was a Professor in the Telecommunication and Information Technology, Biomedical Engineering Research Organization, Tohoku University. Since 2012,
he has been a Professor in the Graduate School of Medicine, Disability Science,
Advanced Interdisciplinary Biomedical Engineering, Tohoku University, and
Graduate School of Biomedical Engineering, Next Generation Biological Information Technology, Tohoku University. His research interests include detection,
processing, and interpretation of fetal electrocardiogram for the clinical diagnosis and combination of the information theory with the infinite dimensional
geometry to analyze the nonlinear and nonstationary signals.

Kiyoe Funamoto, Sayaka Ooshio, Miyuki Endo, and Naoaki Sato’s photographs and biographies not available at the time of publication.

Marimuthu Palaniswami (S’84–M’87–SM’94–
F’12) received the M.E. degree from the Indian Institute of Science, Bangalore, India, the M.Eng.Sc. degree from The University of Melbourne, Melbourne,
Australia, and the Ph.D. degree from the University
of Newcastle, Callaghan, Australia.
He is currently a Professor with the Department
of Electrical and Electronic Engineering, The University of Melbourne. He has published more than 400
refereed research papers and leads one of the largest
funded Australian Research Councils, Research Network on Intelligent Sensors, Sensor Networks, and Information Processing
programme. His research interests include support vector machines sensors and
sensor networks, Internet of things (IoT), machine learning, neural network,
pattern recognition, signal processing, and control.
Dr. Palaniswami has been a Grants Panel Member for NSF, an advisory
board member for the European FP6 Grant Center, a Steering Committee Member for National Collaborative Research Infrastructure Strategy, Great Barrier
Reef Ocean Observing System, Smart Environmental Monitoring and Analysis
Technologies, and a Board Member for Information Technology and supervisory
control and data acquisition companies. He has been funded by several ARC
and industry grants (over 40 m) to conduct research in sensor network, IoT,
health, environmental, machine learning, and control areas. He is representing
Australia as a core partner in European Union FP7 projects such as SENSEI,
SmartSantander, Internet of Things Initiative, and SocIoTal.

Ahsan H. Khandoker (M’07–SM’12) received the
B.Sc. electrical and electronic engineering from the
Bangladesh University of Engineering and Technology, Dhaka, Bangladesh in 1996, the M. Eng.Sc. in
1999 from Multimedia University, Malaysia, and the
M. Engg in 2001 and Doctor of Engineering degree
in physiological engineering from the Muroran Institute of Technology, Muroran, Japan, in 2004.
He is currently working as an Assistant Professor
in the Department of Biomedical Engineering, Khalifa University, Abu Dhabi, UAE. He is also working
as a Senior Research Fellow for Australian Research Council Research Networks on Intelligent Sensors, Sensor Networks and Information Processing,
University of Melbourne, Melbourne, Australia. He has published 38 peerreviewed journal articles and more than 75 conference papers the research
field of physiological signal processing and modeling in fetal cardiac disorders,
sleep disordered breathing, diabetic autonomic neuropathy, and human gait dysfunction, and is passionate about research helping clinicians to noninvasively
diagnose diseases at early stage. He has also worked with several Australian
Medical device manufacturing industries, as well as hospitals as a research consultant focusing on integration of technology in clinical settings.

