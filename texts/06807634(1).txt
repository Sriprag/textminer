IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

581

Volumetric Fibular Transfer Planning
With Shape-Based Indicators
in Mandibular Reconstruction
Megumi Nakao, Member, IEEE, Mamoru Hosokawa, Yuichiro Imai, Nobuhiro Ueda, Toshihide Hatanaka,
Tadaaki Kirita, and Tetsuya Matsuda, Member, IEEE

Abstract—In preoperative planning for mandibular reconstructive surgery, it is necessary to determine the osteotomy lines for
fibular shaping and the proper placement of fibular segments in
the mandible. Although virtual surgical planning has been utilized
in preoperative decision making, current software designs require
manual operation and a trial-and-error process to refine the reconstruction plan. We have developed volumetric fibular transfer
simulation software that can quickly design a preoperative plan
based on direct volume manipulation and quantitative comparison
with the patient’s original mandible. We propose three quantitative shape indicators—volume ratio, contour error, and maximum
projection—for symmetrical lesions of the mandible, and have implemented a parallel computation algorithm for the semiautomatic
placement of fibular segments. Using this virtual planning software,
we conducted a retrospective study of the computed tomography
data from nine patients. We found that combining direct volume
manipulation with real-time local search of placement improved
the applicability of the planning system to optimize mandibular
reconstruction.
Index Terms—Fibular transfer, mandibular reconstruction,
shape indicator and volume manipulation, surgical planning.

I. INTRODUCTION
ICROVASCULAR free fibular transfer has become a
common procedure in mandibular reconstruction [1],
[2]. In this procedure, fibular segments are transplanted into the
mandibular defect, conserving the curved shape and the mastication functions of the mandible [3]. The procedure includes
transplanting bone segments and blood vessels from the patient’s
fibula to the mandible, and connecting the transferred blood
vessels to those in the neck. The merits of native bone trans-

M

Manuscript received March 10, 2014; revised April 17, 2014; accepted
April 24, 2014. Date of publication April 29, 2014; date of current version
March 2, 2015. This work was supported by the Grant-in-Aid for Scientific
Research for Young Scientists (A) (21680044) from The Ministry of Education,
Culture, Sports, Science and Technology, Japan.
M. Nakao and T. Matsuda are with the Kyoto University, Kyoto 606-8501,
Japan (e-mail: megumi@i.kyoto-u.ac.jp; tetsu@i.kyoto-u.ac.jp).
M. Hosokawa was with the Kyoto University, Kyoto 606-8501, Japan. He is
now with the NTT West, Japan (e-mail: mhosokawa@sys.i.kyoto-u.ac.jp).
Y. Imai, N. Ueda, T. Hatanaka, and T. Kirita are with the Nara Medical
University, Nara 634-8521, Japan (e-mail: yimai@nmu-gw.naramed-u.ac.jp;
n-ueda@naramed-u.ac.jp;
thatanak@naramed-u.ac.jp;
tkirita@naramedu.ac.jp).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2320720

plantation as opposed to artificial bone transplantation are quick
engraftment of the bone and earlier new bone formation. The
goal of this surgery is to achieve stable and precise mandibular
reconstruction with structural, esthetic, and functional recovery
for the patient.
In preoperative planning for mandibular reconstructive
surgery, it is necessary to determine the osteotomy for fibular shaping, the number of fibular segments, and the proper
placement of the fibular segments in the mandible. This planning is generally more complex than planning for artificial bone
manufacture, because the patient’s own fibular segments are
used. Two-dimensional radiographs or CT/MRI image slices
have been used in traditional preoperative planning. However,
accurately segmenting and arranging the fibula according to
plan are challenging even for highly skilled surgeons, and additional cutting is often needed during the operation. Although
clinical efforts have been made to improve the accuracy of reconstruction [2], fibular osteotomy and mandible reconstruction remain challenging and are still largely dependent on the
surgeon’s experience, intraoperative decisions, and technical
skills.
Virtual surgical planning has recently gained attention as a
means of supporting the preoperative design of reconstructive
procedures using patients’ CT volume data [4]–[8]. The advantage of computer-aided planning is that it allows rapid design
of a patient-specific surgical procedure, and visualization of
3-D structures that can be intuitively shared among surgeons,
technicians, and other medical personnel [4]. Various reconstruction plans can be discussed using the image of the patient’s own fibula superimposed onto the mandibular defect. In
a recent study, a complex reconstruction called a double-barrel
vascularized fibula flap was investigated, based on geometrical analysis with virtual planning software [9]. Another advantage of virtual planning is that the planned results are directly
available for real stereolithographic model generation using 3-D
printer systems [10], [11]. With the planning data, fibular cutting guides and a plate-bending template can be manufactured, in addition to stereolithographic models of the mandible
[12], [13].
Optimizing the preoperative virtual plan is essential to improve surgical outcomes while reducing intraoperative challenges. Recent clinical studies have focused on the accuracy
of virtual planning by comparing the plan with the reconstruction results [14]–[16]. Fibular segments, prefabricated surgical plates, and cutting guides planned with software were

2168-2194 © 2014 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

582

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Fig. 1. Geometrical descriptions for fibular transfer simulation. (a) Initial setup of controllable virtual surfaces placed on the volumetrically rendered mandibular
image, (b) three fibular segments superimposed on the resection area, and (c) original fibular volume annotated with the surgical plan. The user can interactively
refine the surgical plan while observing the simulation results. The obtained cutting line is directly available for fibular osteotomy.

compared with actual treatment results. Some researchers report that the use of both virtual planning and stereolithographic
models gives reliable surgical outcomes, especially in complicated cases [15], [16]. To optimize the procedure, the virtual
plan should be quantitatively assessed during preoperative planning. Biomechanical behavior of the mandible after marginal
resection has also been investigated based on finite-element
analysis [17]. In mandibular reconstruction, the postoperative
appearance of the patient’s face is a key factor in improving the
patient’s quality of life. To address appearance, shape analysis
is important, but quantitative indicators are not well established
in fibular transfer surgery.
Regarding the usability of virtual planning software, current planning procedures are largely based on manual operation and require a trial-and-error process to refine the reconstruction plan [4], [11]. Because coordination and placement
of fibular segments require complex procedures including 3-D
translation and rotation in the virtual space, it is often difficult
to achieve fine adjustment of the transfer plans, such as boneto-bone contact. In addition, most planning software in plastic
surgery uses surface representation to visualize bone structures.
In fibular transfer planning, a remeshing process can occur at
every step, modifying the surgical plan and shaping the fibular
models. Frequent updating of the complex geometrical models
is computationally cumbersome and limits the usability of the
planning software. For these reasons, the use of virtual planning is currently limited to biomedical engineers, and requires
additional communication between surgeons and engineers
[11].
We focused on designing virtual planning software that can
quickly evaluate the preoperative plan based on a quantitative
comparison with the patient’s original mandible. To support
fibular transfer surgery, it is important to determine a mathematically adequate osteotomy and the optimal placement of the
fibular segments during the mandibular reconstruction process.
Much effort has been made to develop a variety of surgical planning software programs for implant surgery [18], [19], aesthetic
plastic surgery [20], [21], and other orthopedic surgery [22].

To the best of our knowledge, a virtual planning system with
quantitative shape indicators has not been previously described
for fibular transfer surgery. In developing our program, we focused on interactive software design and user-friendly interfaces
suitable for direct use by surgeons.
This paper proposes a volumetric surgical planning system
that supports preoperative planning of free fibular transfer in
mandibular reconstruction. Unlike previous planning software
and systems, we utilize solely the volumetric representation of
bone structures. This enables us to avoid the mesh generation
process frequently used in shape editing. In the system we have
developed, fibular segments are fused with mandibular structures and volumetrically rendered based on updates to the user’s
surgical plan. To optimize preoperative planning, we have introduced new shape indicators to quantify planned mandibular
reconstruction for symmetrical lesions of the central part of the
mandible. The proposed software and indicators were tested by
applying the CT data from nine patients with oral cancer near
the mentum. This paper presents some planning examples and
discusses the computation results of the shape indicators.
II. VOLUMETRIC FIBULAR TRANSFER PLANNING
A. Modeling
In the proposed preoperative planning system, the resection
area is first determined to ensure appropriate margins for tumor
removal or for reconstruction of mandibular defects. As shown
in Fig. 1, the resection area Ωc is determined using the boundary
surfaces in the mandibular image volume Ωm and semitransparently visualized through volume rendering. We introduce a set
of 3-D vectors (Pi Ni ) (i = 0, . . . , n, n: the number of fibular
segments) that define a virtual surface Si [see Fig. 1(a)]. P0
and Pn represent connection points between the patient’s native mandible and the fibular segments and define their boundaries [see Fig. 1(b)]. Similarly, Pk (k = 1,. . . , n–1) is used as
a connection point between the two fibular segments Ωf k −1 and
Ωf k .These connection points are first placed on the surface of
the volumetrically rendered native mandible. When a pixel on

NAKAO et al.: VOLUMETRIC FIBULAR TRANSFER PLANNING WITH SHAPE-BASED INDICATORS IN MANDIBULAR RECONSTRUCTION

583

Fig. 2. Volume visualization results of fibular transfer simulation. (a) Two-segment case, (b) three-segment case, and (c) semitransparent visualization of the
patient’s original mandible to assess the positional relationship between teeth and fibular segments.

the rendered image is indicated, our framework estimates the
corresponding voxel in the volumetric space by accumulating
opacity (or alpha) values at sample points in the eye direction.
This process is similar to the ray-casting protocol [23] commonly used in the volume-rendering scheme. When the accumulated opacity values exceed a threshold, we simply assume
that the voxel at the current sample point was selected by the
user. This direct pointing scheme in a volumetric space has also
been employed in a volume sculpting study [24], [25]. Fig. 1(a)
shows four connection points initially placed on the mandibular
image. The position of the connection points can be modified
manually or systematically. Details of the update methods are
described next.
Next, another set of virtual planes Ŝj (j = 0, . . . , 2n−1) is
configured on the fibular volume data to define fibular segments.
Fig. 1(c) shows three fibular segments defined by six planes
Ŝ0 , . . ., Ŝ5 . A two-segment case is similarly defined using four
virtual planes. In our system, the control point Pj of the virtual
plane Ŝj is constrained on the centerline of the fibular bone.
The sampled points of the centerline are precomputationally
obtained through simple 2-D image processing that computes
a center of gravity of the fibular area for each image slice. In
addition, based on (1), each plane Ŝj : (Pj ,Nj ) is mapped to
the corresponding plane Si placed on the rendered mandibular
images




|Pi+1 − Pi | = P̂j +1 − P̂j 
(1)
Ni+1 · Ni = N̂j +1 · N̂j
i = 0 , . . . , n − 1, j = 2i.
This scheme uniquely defines the relative positions of the
virtual surfaces Ŝ2i+1 and Ŝ2i for the fibular osteotomy, and
simultaneously updates them while synchronizing with manipulation of the virtual surface Si . For example, when translating
or rotating the boundary surface S1 between first (red) and second (green) segments, the corresponding virtual surfaces Ŝ2
and Ŝ3 are updated based on (1). Similarly, when translating or
rotating the virtual surfaces Ŝ2 or Ŝ3 on the fibular image, the
boundary surface S1 is simultaneously updated. Thus, the user
can refine the plan while observing simulation results on both
the mandibular reconstruction and the fibular osteotomy.

B. Visualization
The proposed simulation system has two views for visualizing the mandibular reconstruction plan. The main view renders
the mandibular image with fibular transfer simulation results.
Fig. 2(a) shows a planning example for mandibular reconstruction with two fibular segments. Fig. 2(b) shows another planning
example using three fibular segments. The fibular segments are
superimposed onto the resection area, a useful step to check
visual consistency of the reconstruction plan. Contact between
fibular segments and between the patient’s original mandible
and a fibular segment must be checked for accurate mandibular
reconstruction. A fused image with cross-sectional views of the
objects is important for this purpose. The second view displays
the fibula with cutting lines [see Fig. 1(c)], based on the virtual
surfaces configured in the main view. The estimated fibular segments are visualized by coloring part of the fibular volume. The
annotated cutting lines delineate the fibular osteotomy and can
be used for intraoperative support.
A key feature of this system is that it employs volume rendering to render the simulation results for all views. The surfaces
of the fibular segments and of the partially resected mandibular structure are not modeled during planning. As mentioned
earlier, frequent updating of the complex geometrical models
can occur when modifying the surgical plan. Therefore, we do
not handle 3-D shapes but we visualize transfer simulation results using volume clipping and multicolored volume rendering,
which generates fused images in real time. This scheme avoids
a computationally heavy modeling process and achieves interactivity. We applied a slice-based (or texture-based) volume
rendering approach [26], [27] and extended it for visualization
purposes.
Fig. 3 shows the basic concept of the visualization algorithm.
In our system, we assume that the fibular segment Ωf i is defined
by two virtual surfaces Si and Si+1 . Similarly, the resection area
Ωc is a part of the mandibular volume Ωm between Si and Si+1 .
Traditional slice-based volume rendering generates axis-aligned
or view-aligned proxy planes to allow slice-by-slice sampling
of the target area. In the three-segment case, four objects (i.e.,
the mandible and three segments) must be rendered as a fused

584

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Fig. 3. Volume visualization scheme for superimpoing fibular segments on the
mandibular volume. Multiple proxy planes generated from the fibular segments
Ω f k and from the mandiblar volume Ω m are fused in the eye direction and
rendered from back to front.

image while keeping their depth cues. We generate a set of
proxy planes from one rendering target. For example, in Fig. 3,
red proxy planes are generated from the mandibular domain
Ωm . The sampling pitch is Δd, and the normal vectors of the
plane are parallel to the eye vector. Yellow planes with the same
sampling pitch Δd are generated from a fibular segment domain
Ωf i and inserted into the space between red planes. In the same
fashion, all sets of proxy planes are generated and sorted in the
eye direction. Finally, the proxy planes are clipped by the given
virtual surfaces and rendered from back to front using different
color lookup tables.
Fig. 2(c) shows semitransparent visualization of the patient’s
original mandible with the superimposed fibular segments. Direct volume rendering of the internal structures allows evaluation of the positional relationship between the teeth and estimated fibular segments.

Fig. 4. Visualization and editing of the fibular segments. (a) Changes in the
virtual surfaces from the initial plan, (b) selection of a thicker region, and (c)
3-D surface model annotated with the surgical plan for fibular osteotomy.

on the mandibular image with fibular segments placed in the
resection area.
Fig. 4(a) shows the changes in the virtual surfaces between the
initial placement and the planned result in a two-segment case.
The user can also change segmentation of the fibular bone on
the subview. A thicker portion of fibula is more appropriate for
mandibular reconstruction while maintaining adequate margins
for each segment [see Fig. 4(b)].
Step 3: (Stereolithographic model generation) After the reconstruction plan is formulated, the 3-D surface of the fibular
bone with an annotated surgical plan [see Fig. 4(c)] is constructed for stereolithographic model production. The created
model is stored in STL format and can be directly applied to a
3-D printer.

C. Interface and Planning Procedures
In our system, all operations for preoperative planning can
be performed using a 2-D pointing interface such as a standard
mouse or a touch screen. This section summarizes the planning
flow and the interface implemented with the developed system.
Step 1: (Virtual resection) Using the direct pointing scheme
introduced earlier, the user can place the connection points Pi by
a simple pointing operation on the rendered mandibular image.
There are three connection points in two-segment cases and
four in three-segment cases. Next, the resection area Ωc and
the virtual surfaces Si and Ŝj are initialized as a background
process. The initial simulation results and the shape indicators
are displayed.
Step 2: (Fibular transfer simulation) Next, the user can interactively manipulate (i.e., translate and rotate) the placed virtual
planes Si and Ŝj to refine the surgical plan. To allow 3-D translation of the virtual surfaces, the 2-D displacement obtained by
dragging the mouse is transformed into 3-D displacement Ti
parallel to the view-aligned slicing plane. By rotating the scene,
the user can interactively translate the segments in 3-D. In the
case of 3-D rotation Ri , 2-D displacement is transformed into
a rotation axis and a magnitude of the angle. In response to the
user’s operation in one virtual plane, other virtual planes are
updated simultaneously to maintain their connection and physical constraints. These operations can be interactively performed

III. SHAPE INDICATORS
To refine the reconstruction plan, traditional planning software requires trial-and-error manual operation that relies on the
user’s clinical experience and anatomical knowledge. Because
3-D manipulation is necessary to ascertain the optimal reconstruction plan, manual operation may cause placement errors
resulting from lack of 3-D information about occlusion and
depth cues, for example. To address these problems, our system
implements quantitative indicators to evaluate the current planning state. As a first approach to quantification, we introduce
here three shape indicators: volume ratio, contour error, and
maximum projection.
To compute the indicators from the patient’s CT data, we
introduce the occlusal coordinate, a patient-specific coordinate
based on the occlusal surface. In maxillofacial surgery, the occlusal surface is commonly used as an anatomical reference in
restoring the mandible and its mastication function. Fig. 5(a)
shows the definition of the occlusal coordinates. The three vertices are placed on the occlusal surfaces of the left and right first
molars and the central incisors. The direct pointing scheme described in Section II is used to determine the 3-D position. Based
on this occlusal coordinate, our system computes the following
three indicators in real time.

NAKAO et al.: VOLUMETRIC FIBULAR TRANSFER PLANNING WITH SHAPE-BASED INDICATORS IN MANDIBULAR RECONSTRUCTION

585

Fig. 5. (a) Three-dimensional occlusal coordinates and (b) 2-D illustration of the shape indicators to quantify geometrical differences between patient’s original
mandible and the reconstruction plan.

A. Volume Ratio
The reconstructed mandible must have sufficient volume
to maintain its postoperative mastication function and physical strength as a part of facial bone structure [17]. We focus
especially on the volume ratio that quantifies the amount of
filling of the resection regions with the fibular segments. The
indicator Ev for the volume ratio is described by

Vﬁb
(2)
Ev =
Vcut

where Vcut is the volume of the resected area and Vﬁb is the
sum of the volumes of the fibular segments placed in the resection area. This indicator is affected by fibular osteotomy and
placement of the fibular segments. For example, if thicker sections are selected from the fibular volume, the indicator shows
higher values.

the y- and z-directions from the discrete points pi (i = 0 ,. . .,
n−1) composing the centerline of the fibula (see Fig. 6).
C. Maximum Projection

B. Contour Error
The postoperative appearance of the patient’s face is affected
by the contour of the reconstructed mandible. To quantify the
contour in the given surgical plan, we define the contour error
Ec using the average distance between the contour of the placed
fibular segments (Cr ) and the original contour of the patient’s
mandible (Co ). This indicator is defined using
n −1

Ec =

Fig. 6. Computing methods for contour error E c . The surfaces of the native
mandible and the fibular segment are scanned from the centerline of the fibular
bone.

1
|Dr (pi ) − Do (pi )|
n i=0

(3)

where pi is a discrete point on the centerline of the fibula, and
n is the total number of discrete points. Do (p)i is the scalar
distance between pi and the corresponding sample point on
the patient’s original contour Co . In this computation, the xyzcoordinates are first placed on mandibular images based on the
occlusion plane of the patient’s mandible. The normal vector of
the occlusal surface is set as the z-axis, as shown in Fig. 5(a).
Next, we compute |Dr (pi ) − Do (pi )| as the Euclidean distance
between discrete sample points on the two contours Cr and Co
[see Fig. 5(b)]. The sample points are obtained by scanning two
surface positions of the mandible and of the fibular segment in

The two shape indicators introduced earlier do not evaluate
the degree to which fibular segments extend beyond the resection area [see Fig. 5(b)]. Although protruding bone can be
additionally resected during surgery, the available margin for
resection is restricted by the thickness of the cortex. Therefore,
we employ maximum projection Ep as a third indicator to filter
inadequate placement of the fibular segments. Ep is obtained
using
Ep = max(Dr (pi ) − Do (pi )).
i

(4)

IV. EXPERIMENTS AND RESULTS
We implemented the overall algorithms and software interface
using C++, GLSL, and CUDA on a standard PC (CPU: Intel
Core i7, 2.93 GHz, memory: 8 GB) with a general-purpose
graphics card (nVidia GeForce GTX580). The developed system
was tested by applying CT datasets of measurements from nine
patients with oral cancer near the mentum. The CT slice images
were first resampled as volume data with 2563 voxels. The
mandible was extracted from the head CT data, and the fibula
from the foot CT data. This segmentation step was completed

586

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

TABLE I
COMPUTATION RESULTS OF THE THREE SHAPE INDICATORS BASED ON DATA FROM NINE PATIENTS

Fig. 7. Statisitical comparison of the three indicators between two-segment and three-segment cases. The contour error E c in three-segment cases is significantly
lower than in two-segment cases. The maximum projection E p was a positive values in all cases.

in 2–3 min for each case, based on region growing-based ROI
selection and manual removal of voxels with a 3-D cutting tool
[25].
A. Experiments
In the experiment, oral surgeons and dental technicians reproduced past surgical plans retrospectively without relying on
the proposed shape indicators. Mandibular reconstruction using
two and three fibular segments was interactively simulated for
each patient. Fig. 2(b) shows the surgical plan adjusted through
manual operation by the dental technician. Three connection
points P0 , P1 , and P2 were first placed on the mandibular image by clicking a mouse. P0 and P2 were moved to fit the fibular
segments to the arc of the patient’s mandible. Next, the angle
of the two fibular segments was updated through translation of
the connection point P1 . The fibular regions selected for fibular
segments in the subview were also changed. Fig. 2(c) shows a
three-segment case interactively configured. The two connection
points P1 and P2 between the segments were similarly translated to fit the contour of the patient’s mandible. To maintain the
postoperative strength of the reconstructed mandible, the plan

was modified under the condition that each fibular segment had
sufficient length.
After establishing a surgical plan for all cases, the experimenter computed the proposed three shape indicators: the volume ratio Ev , the contour error Ec , and the maximum projection
Ep . Table I shows the computation results based on data for all
nine patients in two-segment and three-segment cases. We first
confirmed the distribution and the possible outliers of the data
using a box plot. On each graph in Fig. 7, the edges of the
box represent the 25th and 75th percentiles, the central line is
the median, and the whiskers extend to the most extreme values.
Next, we conducted a t-test hypothesizing normal distribution of
the data. The result revealed a significant difference in contour
error between the two-segment and the three-segment procedures. The average contour error was 2.78 mm in two-segment
cases and 1.64 mm in three-segment cases. This result suggests
that three-segment reconstructions are more likely to achieve
better reconstruction of the mandibular contour. This result is
mathematically reasonable (i.e., linear interpolation of the facial curve). Fig. 7(c) shows the interesting finding that maximum
projection Ep values were positive for all nine planning results.
The average of the maximum projection Ep assigned by the

NAKAO et al.: VOLUMETRIC FIBULAR TRANSFER PLANNING WITH SHAPE-BASED INDICATORS IN MANDIBULAR RECONSTRUCTION

dental technician was +1.93 mm. We discussed this finding
with the oral surgeon and the dental technician who participated
in the experiment, and they agreed with this result. According
to their comments, rather than arranging the fibular segments to
fit completely within the resection area, they planned it to extend slightly from the patient’s native mandible. They made this
choice because they felt that better shape can be empirically obtained when the fibular segment protrudes slightly. Our findings
demonstrate that the proposed indicators achieve valid quantification that agrees with the empirical knowledge of surgeons and
technicians and suggest that empirically established techniques
or knowledge in mandibular reconstruction can be confirmed
quantitatively through the proposed indicators. We additionally
note that over 30 frames per second was achieved during all planning manipulations, and that it was possible to conduct natural,
interactive manipulations of the fibular segments superimposed
on the volumetrically rendered mandibular images.

587

TABLE II
LOCALLY EXPLORED POSITIONS OF THE CONNECTION POINT P 1 THAT
MINIMIZES THE CONTOUR ERROR IN TWO-SEGMENT CASES

B. Application
Our experiment suggests that mandibular reconstruction using three segments is more likely to produce a mandible matching the original jaw shape than two-segment reconstruction. In
spite of this, two-segment reconstruction is still often chosen
because of the intraoperative challenges of three-segment procedures. If reconstruction with similar shape and mastication
function were possible using two segments rather than three,
it would reduce surgery time and would decrease the burden
on the surgeon and patient. Because the contour error in lateral
cases is relatively smaller than in anterior cases, optimizing the
two-segment procedure in preoperative planning is useful to assess various possibilities. We also focused on the finding that
better shape can be obtained if the fibular segment protrudes
slightly from the original mandible. However, because coordination and placement of fibular segments require complex
operation including 3-D translation and rotation in the virtual
space, manual adjustment of the reconstruction plans requires a
time-consuming process of trial and error.
To address this problem, our second experiment examined
how the contour error changes when the fibular segments are
locally adjusted, and the possibility of placement to obtain a
better result than manual placement by a surgeon using two
segments. Based on discussion with the oral surgeon, we have
hypothesized an improved surgical procedure: if it were possible to place the fibular segments with greater projection than if
they were placed by the surgeon and to trim the projecting portion of the fibular segment, better reconstruction with smaller
contour error could be possible using two segments. During
surgery, oral surgeons sometimes trim the surface of the cortical
bone to adjust the shape, as long as the inner cancellous bone is
not exposed. Therefore, in the second experiment, we explored
the local position of the connection point P1 that minimized
the contour error under the condition that slight cutting of the
projecting portion was allowed. This search was conducted by
repositioning the connection point P1 from –3 to +3 voxels
in the xyz-direction. Three hundred forty-three placement patterns were examined, and the optimal position with minimum

Fig. 8. Contour errors for two-segment, three-segment, and the optimized
two-segment case.

contour error was locally determined. In addition, the following
information was used to filter the search results.
1) If the volume ratio Ev after repositioning was less than that
in the placement specified by the surgeon, it was removed
from the search results.
2) If the maximum projection Ep of the repositioned result
was more than +1.93 mm, it was skipped as an invalid
placement. The average value obtained by manual placement in the previous experiment was +1.93 mm.
The results of this local search are shown in Table II. In
seven of nine cases, better reconstruction with lower contour
error Ec was obtained than with manual placement by the surgeon. No position with lower contour error was found for Case
2 or Case 4. The central graph in Fig. 8 shows the average
contour error Ec recomputed after repositioning the connection
point in the two-segment case. As a reference, the left graph
shows the average error of the two-segment cases by manual
operation, and the right is the average error of three-segment
cases. These graphs demonstrate that the average contour error improved to 2.07 mm from 2.78 mm after the local search
around the manually placed connection point. Additionally, in
our system, GPU-based parallel computing using CUDA was
applied to this search. We have confirmed that average overall
computation time to obtain the optimal position was 476.7 ms.
This is fast enough in the use of real-time rearrangement to

588

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

to consider future clinical experiments that will separately address errors in preoperative planning and intraoperative errors
from actual surgical procedures. However, to discuss clinical
outcomes quantitatively, we should design further long-term
experiments, which may include comparison of results obtained
with versus without virtual planning. In summary, we plan to
investigate the clinical performance of the developed system in
our future work.
VI. CONCLUSION
Fig. 9. Local adjustment of the fibular segments to the original mandibular
arc under the condition that some cutting of the projecting portion is allowed.

support interactive preoperative planning. This local search suggests the possibility of automatic adjustment of the reconstruction plan, which can reduce the challenges of 3-D adjustment
by the users (see Fig. 9). Thus, the shape indicators can quantify the surgical plan from geometrical aspects and improve
the applicability of the planning system to optimize mandibular reconstruction. Combining interactive simulation and local
exploration of the reconstruction plan based on the shape indicators will provide a good planning environment for fibular
transfer surgery.
V. DISCUSSION
In this paper, we have presented a novel fibular transfer planning system for mandibular reconstruction. Our experiments
showed that semiautomatic, interactive planning was achieved
by combining direct volume manipulation and real-time local
search of placement for fibular segments based on shape indicators. The new system still has the following limitations: 1) The
current algorithm for computing the shape indicators can only
be applied to the central part of the mandible including the mentum, because the computation results are affected by the scan
direction. 2) The effectiveness of the proposed shape indicators
was tested in two-segment and three-segment cases. More complex cases, such as a double-barreled reconstruction [9], require
further evaluation. 3) GPU-based parallel computing worked
in our local optimization of the fibular segments. Efficient optimization algorithms should be implemented to support complex
reconstruction cases. We also note that the thinnest region of the
cortical bone was about 3.66 mm in our data. Therefore, the filter
value of 1.91 mm is considered sufficient to prevent exposure of
cancellous bone, suggesting the possibility of further optimization of our system in surgical reconstruction planning. In the
future, careful consideration should be given to searching with
a maximum threshold projection of approximately 3 or 4 mm.
Because the cortical bone of the fibular segment is trimmed,
it will also be necessary to analyze postreconstructive strength
and the advisability of trimming.
The experiments described in this paper were retrospectively
performed using preoperative CT data from previous surgeries.
Comparison between virtual planning results and actual postoperative CT volumes is important to confirm the clinical outcomes
obtained by optimizing preoperative planning. We are beginning

This paper presents a new software design for preoperative
virtual planning of free fibular transfer in mandibular reconstructive surgery. Direct volume manipulation and visualization
of multiple objects allow interactive editing of the surgical plan,
including virtual resection, without the need for a surface modeling process. We also introduced three shape indicators, volume ratio, contour error, and maximum projection, to evaluate
the surgical plan’s geometrical aspects. The proposed indicators
quantify the difference between two-segment and three-segment
approaches and optimize preoperative planning while satisfying appropriate fibular segment placement margins. Our future
work will explore further quantification for physical evaluation
of the reconstruction plan, automation of the preoperative planning protocol, and the clinical performance of semiautomatic
planning.
REFERENCES
[1] A. F. Flemming, M. D. Brough, N. D. Evans, H. R. Grant, M. Harris,
D. R. James, M. Lawlor, and I. M. Laws, “Mandibular reconstruction
using vascularised fibula,” Brit. J. Plastic Surg., vol. 43, no. 4, pp. 403–
409, 1990.
[2] R. D. Foster, J. P. Anthony, A. Sharma, and M. A. Pogrel, “Vascularized
bone flaps versus nonvascularized bone grafts for mandibular reconstruction: An outcome analysis of primary bony union and endosseous implant
success,” Head Neck, vol. 21, no. 1, pp. 66–71, 1999.
[3] J. P. Shah, “The role of marginal mandibulectomy in the surgical management of oral cancer,” Arch. Otolaryngol. Head Neck Surg., vol. 128,
pp. 604–605, 2002.
[4] O. Tepper, D. Hirsch, J. Levine, and E. Garfein, “The new age of threedimensional virtual surgical planning in reconstructive plastic surgery,”
Plastic Reconstructive Surg., vol. 130, no. 1, pp. 192–194, 2012.
[5] D. L. Hirsch, E. S. Garfein, and A. M. Christensen, “Use of computeraided design and computer-aided manufacturing to produce orthognathically ideal surgical outcomes: A paradigm shift in head and neck reconstruction,” J. Oral Maxillofacial Surg., vol. 67, pp. 2115–2122, 2009.
[6] P. Juergens, Z. Krol, and H. F. Zeilhofer, “Computer simulation and rapid
prototyping for the reconstruction of the mandible,” J. Oral Maxillofacial
Surg., vol. 67, pp. 2167–2170, 2009.
[7] J. Sink, D. Hamlar, D. Kademani, and S. S. Khariwala, “Computer-aided
stereolithography for presurgical planning in fibula free tissue reconstruction of the mandible,” J. Reconstructive Microsurg., vol. 28, no. 6, pp. 395–
403, 2012.
[8] W. H. Wang, J. Y. Deng, M. Li, J. Zhu, and B. Xu, “Preoperative threedimensional reconstruction in vascularized fibular flap transfer,” J. Craniomaxillofacial Surg., vol. 40, pp. 599–603, 2012.
[9] W. H. Wang, J. Zhu, J. Y. Deng, B. Xia, and B. Xu, “Three-dimensional virtual technology in reconstruction of mandibular defect including condyle
using double-barrel vascularized fibula flap,” J. Cranio-Maxillo-Facial
Surg., vol. 41, pp. 417–422, 2013.
[10] Y. Yamanaka, H. Yajima, T. Kirita, H. Shimomura, S. Tamaki, K. Aoki,
N. Yamakawa, and Y. Imai, “Mandibular reconstruction with vascularised fibular osteocutaneous flaps using prefabricated stereolithographic
mandibular model,” J. Plastic Reconstructive Aesthetic Surg., vol. 63,
pp. 1751–1753, 2010.

NAKAO et al.: VOLUMETRIC FIBULAR TRANSFER PLANNING WITH SHAPE-BASED INDICATORS IN MANDIBULAR RECONSTRUCTION

[11] A. K. Antony, W. F. Chen, A. Kolokythas, K. A. Weimer, and
M. N. Cohen, “Use of virtual surgery and stereolithography-guided osteotomy for mandibular reconstruction with the free fibula,” Plastic Reconstructive Surg., vol. 128, no. 5, pp. 1080–1084, 2011.
[12] G. S. Zheng, Y. X. Su, and G. Q. Liao, “Stereolithographic cutting guide
in mandible reconstruction,” Oral Surg. Oral Surg. Oral Med. Oral Pathol.
Oral Radiol., vol. 113, no. 6, pp. 712–713, 2012.
[13] D. Rohner, R. Guijarro-Martı́nez, P. Bucher, and B. Hammer, “Importance of patient-specific intraoperative guides in complex maxillofacial
reconstruction,” J. Cranio-Maxillo-Facial Surg., vol. 41, pp. 382–390,
2013.
[14] S. M. Roser, S. Ramachandra, and H. Blair, “The accuracy of virtual
surgical planning in free fibula mandibular reconstruction: Comparison of
planned and final results,” J. Oral Maxillofacial Surg., vol. 68, pp. 2824–
2832, 2010.
[15] Y. Shen, J. Sun, J. Li, T. Ji, M. Li, W. Huang, and M. Hu, “Using computer
simulation and stereomodel for accurate mandibular reconstruction with
vascularized iliac crest flap,” Oral Surg. Oral Med. Oral Pathol. Oral
Radiol., vol. 114, no. 2, pp. 175–182, 2012.
[16] B. D. Foley, W. P. Thayer, A. Honeybrook, S. McKenna, and S. Press,
“Mandibular reconstruction using computer-aided design and computeraided manufacturing: An analysis of surgical results,” J. Oral Maxillofacial Surg., vol. 71, no. 2, pp. e111–e119, 2013.
[17] J. Kimsal, B. Baack, L. Candelaria, T. Khraishi, and S. Lovald, “Biomechanical analysis of mandibular angle fractures,” J. Oral Maxillofacial
Surg., vol. 69, no. 12, pp. 1798–1806, 2011.
[18] F. Valente, G. Schiroli, and A. Sbrenna, “Accuracy of computer-aided
oral implant surgery: A clinical and radiographic study,” Int. J. Oral
Maxillofacial Surg., vol. 24, no. 2, pp. 234–242, 2009.
[19] X. Chen, J. Yuan, C. Wang, Y. Huang, and L. Kang, “Modular preoperative planning software for computer-aided oral implantology and the
application of a novel stereolithographic template: A pilot study,” Clin.
Implant Dent. Relat. Res., vol. 12, no. 3, pp. 181–193, 2010.

589

[20] T. Lee, Y. Sun, Y. Lin, L. Lin, and C. Lee, “Three-dimensional facial
model reconstruction and plastic surgery simulation,” IEEE Trans. Inf.
Technol. Biomed., vol. 3, no. 3, pp. 214–220, Sep. 1999.
[21] A. Bottino, M. De Simone, A. Laurentini, and C. Sforza, “A new 3-D tool
for planning plastic surgery,” IEEE Trans. Biom. Eng., vol. 59, no. 12,
pp. 3439–3449, Dec. 2012.
[22] T. Okada, Y. Iwasaki, T. Koyama, N. Sugano, Y. W. Chen, K. Yonenobu,
and Y. Sato, “Computer-assisted preoperative planning for reduction of
proximal femoral fracture using 3-D-CT data,” IEEE Trans. Biomed. Eng.,
vol. 56, no. 3, pp. 749–759, Mar. 2008.
[23] M. Levoy, “Efficient ray-tracing of volume data,” ACM Trans. Graph.,
vol. 9, no. 3, pp. 256–261, 1990.
[24] M. Nakao, K. W. C. Hung, S. Yano, K. Yoshimura, and K. Minato, “Adaptive proxy geometry for direct volume manipulation,” in Proc. IEEE Pacific Vis. Symp., 2010, pp. 161–178.
[25] K. Imanishi, M. Nakao, M. Kioka, M. Mori, M. Yoshida, T. Takahashi,
and K. Minato, “Interactive bone drilling using a 2D pointing device to
support microendoscopic discectomy planning,” Int. J. Comput. Assisted
Radiol. Surg., vol. 5, no. 5, pp. 461–469, 2010.
[26] B. Cabral, N. Cam, and J. Foran, “Accelerated volume rendering and
tomographic reconstruction using texture mapping hardware,” in Proc.
ACM Symp. Volume Vis., 1994, pp. 91–98.
[27] R. Kahler and H. C. Hege, “Texture-based volume rendering of adaptive
mesh refinement data,” Visual Comput., vol. 16, no. 8, pp. 481–492, 2002.

Authors’ photographs and biographies not available at the time of publication.

