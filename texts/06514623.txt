IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

139

3-D Vascular Skeleton Extraction and Decomposition
Ashirwad Chowriappa, Yong Seo, Sarthak Salunke, Maxim Mokin, Peter Kan, and Peter Scott

Abstract—We introduce a novel vascular skeleton extraction and
decomposition technique for computer-assisted diagnosis and analysis. We start by addressing the problem of vascular decomposition as a cluster optimization problem and present a methodology
for weighted convex approximations. Decomposed vessel structures are then grouped using the vessel skeleton, extracted using
a Laplace-based operator. The method is validated using presegmented sections of vasculature archived for 98 aneurysms in 112
patients. We test first for vascular decomposition and next for vessel skeleton extraction. The proposed method produced promising
results with an estimated 80.5% of the vessel sections correctly decomposed and 92.9% of the vessel sections having the correct number of skeletal branches, identified by a clinical radiological expert.
Next, the method was validated on longitudinal study data from
n = 4 subjects, where vascular skeleton extraction and decomposition was performed. Volumetric and surface area comparisons
were made between expert segmented sections and the proposed
approach on sections containing aneurysms. Results suggest that
the method is able to detect changes in aneurysm volumes and
surface areas close to that segmented by an expert.
Index Terms—Analysis, decomposition, skeleton, vascular.

I. INTRODUCTION
UBARACHNOID hemorrhage caused by the rupture of an
aneurysm is one of the common causes of stroke. Each year,
approximately 795 000 Americans experience a new or recurrent stroke [1]. To perform pre- or poststroke assessment, some
form of analysis of the vasculature has to be carried out [2], [3].
In this paper, we focus on vascular decomposition and vessel
skeleton extraction as a fundamental approach to understand the
nature of complex vascular structures in computer-assisted diagnosis (CAD) and analysis. The weighted approximate convex
decomposition (WACD) methodology for vessel decomposition
was first proposed in [4]. We extend this prior work and propose
a twofold vessel segmentation approach. We first decompose
the vasculature into substructures. Next, the substructures are
grouped using the extracted vessel skeleton (see Fig. 1).

S

Manuscript received October 28, 2012; revised February 20, 2013 and April
22, 2013; accepted April 27, 2013. Date of publication May 7, 2013; date of
current version December 31, 2013.
A. Chowriappa and P. Scott are with the Department of Computer Science
and Engineering, The State University of New York, Buffalo, NY 14214 USA
(e-mail: ajc48@buffalo.edu; peter@buffalo.edu).
Y. Seo and S. Salunke are with the Department of Mechanical and Aerospace
Engineering, The State University of New York, Buffalo, NY 14214 USA
(e-mail: yongwons@buffalo.edu; ssalunke@buffalo.edu).
M. Mokin and P. Kan are with the Department of Neuroscience, Buffalo
General Hospital, Buffalo, NY 14214 USA (e-mail: maximmokin@gmail.com;
peterkantzeman@yahoo.ca).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2261998

A. Previous Work on Decomposition and Skeleton Extraction
The literature shows several 2-D/3-D vascular segmentation
and skeleton extraction methods [4]–[9]. For extended reviews
on vessel segmentation algorithms, we refer the reader to the following surveys [10]–[12]. Methods adapted from generic segmentation algorithms generally use a model-based approach,
whereas others use the notion of vessel skeleton (centerline) for
segmentation.
On skeleton-based approaches, Ertan et al. [13] presented a
unified coarse-to-fine approach for extracting the medial axis
of the vascular tree. An innovative 3-D multibranch tubular
structure and centerline extraction method is proposed in [14].
Although the classical minimal path techniques can only detect
a single curve between two predefined initial points, this method
propagates outward from only one initial seed point to detect 3-D
multibranch tubular surfaces and centerlines simultaneously. In
[15], vessel centerlines are obtained from a homotopic thinning
of the vessels segmented using a level set method.
In contrast to skeleton-based methods, model-based techniques naturally capture the physics and geometry of vascular structures (more generally, tube-like structures) that vary
spatially. A geometric deformable model for segmenting tubular structures is presented in [16]. The main advantage of this
technique is its ability to segment twisted, convoluted, and occluded structures without the need for user interaction. Christian
et al. [17] present an approach for simultaneously separating and
segmenting multiple interwoven tubular tree structures. Also
in [18], the authors discus a deformable model for detecting
bifurcations and providing structural analysis.
B. Our Vascular Decomposition Approach
In this paper, we propose a hybrid approach that 1) first decomposes the vasculature into subcomponents. 2) Next, a grouping of subcomponents is performed from the extracted vessel
skeleton. Our approach uses convex decomposition, a topic that
has been significantly investigated [19], [20]. However, exact
convex decomposition is not well suited for complex shapes
such as vascular structures. An exact decomposition of a complex shape such as a vascular tree can lead to unacceptably
large number of components which may not have meaningful
relationships. To overcome this problem, we propose a WACD
methodology that is well suited for vessel decomposition illustrated in Fig. 1. It can be seen that an approximate decomposition [see Fig. 1(c)] produces a parsimonious representation of
the vessel structure.
Our proposed vascular decomposition approach can be directly performed on the surface mesh without the need for skeleton extraction. However, when dealing with complex and highly
tortuous structures seen in the vasculature, such decomposition would produce subcomponents without correct anatomical

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

140

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Fig. 1. (a) Reconstructed surface mesh of a tortuous vessel tree, followed by (b) decomposition using the WACD strategy produces nine clusters for the vessel
tree. Clusters are shown as different colored convex hulls of varying sizes. (c) Vessel skeleton is extracted and (d) decomposed clusters are grouped according to
skeleton branches.

associations [since several decomposed components can belong
to the same vessel branch, shown in Fig. 1(b)]. Using the vessel
skeleton, we group the decomposed components into parsimonious descriptions with useful physiological significance [see
Fig. 1(d)].
C. Our Vascular Skeleton Extraction Approach
We introduce a new vessel skeleton extraction technique that
is applied directly on the vascular mesh representation. The
method that we propose is similar to that of Cao et al. [21].
However, their approach only works on point cloud models and
does not consider the mesh topology. In our approach, the vessel
two-manifold surface is iteratively shrunk into an approximate
zero-volume degenerate mesh that abstracts the given vessel
skeleton topology [see Fig. 1(c)]. The contraction process is
setup as an energy minimization problem involving a discrete
Laplace operator [22], [23] that removes the vessel geometry details along the normal directions. Appropriate weight functions
are chosen such that the surface mesh contracts into a minimal
volume skeletal representation. This skeleton representation of
the vasculature is also important for diagnosing and treating
pathologies, and in follow-up study analysis.
The two main contributions of this paper are as follows: 1)
We propose a novel Laplacian-based vessel skeleton extraction
methodology. 2) We extend our WACD approach [4] and use the
proposed vessel skeleton methodology to perform vascular segmentation (aneurysm and bifurcation decomposition) in CAD
analysis.
This paper is organized as follows. In Section II-A, we introduce surface mesh generation for clinical data. In Section II-B,
we compute the dual graph and define curvature parameters that
drive the decomposition cost function. Vessel skeleton extraction using the Laplace smoothing is discussed in Section II-C.
Finally, we present our results in Section III and conclude in
Section IV.
II. MATERIALS AND METHODS
A. Data Preprocessing and Mesh Generation
The clinical dataset consisting of contrast enhanced CTA data
(slick thickness: 1.25 mm, stored using DICOM standards) was
used for the mesh generation. Volumes of interest around identified vascular structures are specified using maximum intensity projections (MIP). More specifically, the following vessel

sections are reconstructed: basilar artery (BA), anterior communicant artery (ACoA), posterior communicant artery (PCoA),
middle cerebral artery (MCA), internal carotid artery (ICA),
and superior cerebelar artery (SCA). Prior to segmentation and
reconstruction, an anisotropic diffusion filter is applied [24].
This filter reduces the noise while preserving small vascular
structures enabling better segmentation, which is important in
the region of the brain. Next, we remove the skull bones, the
sinuses and the skin, having similar intensity as the vessels, using double thresholding (dt1 , dt2 , dt3 , dt4 ). A 3-D model of the
vessel is obtained as an isosurface of intensity zero, resulting
from the level set evolution, implemented utilizing ITK [25].
For a detailed description, we refer the reader to [26]. In order
for small vessels to be included, isosurface Iiso = 118 value
is used. Values for the level set threshold lt = 36, variance
lσ 2 = 0.3, and number of iteration it = 120 in ITK were chosen.
The parameter settings that were used in double thresholding
were dt1 = 183 (bone), dt2 = 318 (bone boundary), dt3 = 714
(mean bone boundary), and dt4 = max(I) (maximum intensity
of the dataset).
B. Vascular Decomposition
In this section, we summarize our WACD methodology [4].
From the computed vessel surface representation, convex decomposition is employed to partition the mesh into a minimal
set of convex subsurfaces, S = {s1 , s2 , ..sn }. The two-manifold
surface S is defined in R3 as V = {v1 , v2 , v3 , .., vi }, T =
{t1 , t2 , t3 , .., tj }, and E = {e1 , e2 , e3 , . . . , ek } (where V is the
vertex set, T is the set of triangles, and E is the edge set). We
define the dual graph D∗ associated with the surface mesh S.
Edge weights for D∗ are computed from shape indices to favor
certain features over others. In mesh decimation, vertices of D∗
are iteratively clustered by applying a decimation operator that
minimizes a weighted cost function.
1) Computing Shape Index and Edge Weights: The curvature of a point on the surface can be defined by its maximum
and minimum curvatures (k1 , k2 ). Using these curvature measures, we determine whether the given point lies on a concave,
convex, ridge, or saddle region (see Fig. 2). Saddle regions are
characterized by being concave on one plane and convex from
another (e.g., horse saddle) and most frequently correspond to
surfaces at vessel bifurcations. Ridges on the other hand can be
found on aneurysm heads and ostiums (neck). For each node
in the graph D∗ , we define a set of rings around the node as

CHOWRIAPPA et al.: 3-D VASCULAR SKELETON EXTRACTION AND DECOMPOSITION

141

TABLE I
SHAPE TYPES FOR SI RANGE

Fig. 2. Primitive shape types for corresponding surface characteristics of an
aneurysm sac.

following criteria:
⎧
⎪
⎨ θ1 , 0 < SI ≤ 0.5 (umbilicpoints)
λ = θ2 , 0.5 < SI ≤ 0.75 (hyperbolicpoints)
⎪
⎩
θ3 , 0.75 < SI ≤ 1.0.

(2)

One advantage of using shape indices as edge weights is that
transition from one shape type to another is continuous; hence,
they can be used to describe subtle vessel shape variations.
2) Mesh Decimation: Following the assignment of the edge
weights to the dual graph D∗ , convex decomposition is initiated by iteratively applying a half-edge collapse operation on
neighboring vertices. A half-edge collapse operator, defined as
hcol(u, v), when applied to two vertices (u, v) connected by an
edge in 50 < ε < 250 merges v with u and all incident edges
on v are connected to u. The decimation process using the halfedge collapse operator is governed by a cost function that is
weighted on λ and minimizes for concavity. The cost associated
with hcol(u, v) is given by
C(u, v) = αAR(u, v) + λ

Fig. 3. Decomposition using WACD on sections of vasculature, (a) and (b)
shows decomposition of vessel tree with bifurcations, (c)–(f) shows decomposition used to separate vessel sections fused with sections of cranium.

follows: the ith ring around node vj is defined as the set of
vertices v ∗ ∈ V for which there exists a shortest path from vj
to v ∗ containing i edges. The L−ring neighborhood of node vj
is defined as the set of rings i < L about node vj . To capture
the shape of the L−ring neighborhood (in our implementation
a three-ring neighborhood), we use the shape index introduced
by Cees et al. [27], where the shape index SI derived from the
principal curvatures is given as
SI =

1
km in + km ax
1
− arctan
.
2 π
km in − km ax

(1)

The values of SI varies in the closed interval [0.0, 1.0] and
every distinct surface shape (see Table I) corresponds to a unique
value of SI (except for planar surfaces, which will be mapped
to the value 0.5, together with saddle shapes).
Edge weights are then computed from the SI ranges as follows. Two neighboring vertices connected by an edge in the
dual graph D∗ are assigned an edge weight λ determined by the

Con(S(u, v))
N

(3)

where Con is the concavity of surface S(u, v) and N is the
normalization factor which is set as the diagonal of the bounding
box of S(u, v). The parameters α and λ control contributions of
the aspect ratio AR and concavity Con(S(u, v)). We set α = 2
to favor the generation of compact disks in which case the cost
is unity. The aspect ratio AR of the surface S(u, v) is defined
by
AR(u, v) =

γ(S(u, v))2
2π ∗ σ(S(u, v))

(4)

where γ is the perimeter and σ is the area of the surface S(u, v).
After each edge collapse operation, λ is locally recomputed for
surface S(u, v) and the new edge weight λnew obtained from
(5) is used in the update of D∗ :


1−δ
λnew =
λ.
(5)
δ
An influence parameter δ is used in order to minimize the
influence of newly formed surface features caused by the decimation in successive iterations of hcol.
3) Mesh Partitioning: With each iteration of the hcol operator, the lowest mesh simplification cost is applied to a new
partition ϕ(n) = {ϕn1 , ϕn2 , ϕn3 , ϕn4 , . . . , ϕnP (n ) } minimizing C
the cost function.
C(u, v)

∀k ∈ {1, . . . , P (n)} ,

ϕnk = pnk ∪ H(pnk )

(6)

142

Fig. 4.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Contraction of vassel manifold surface for aneurysm sac and inlets through three iterations of Laplace contraction.

ranges. We determined on optimal range of 150 < ε < 200 that
match closest to expert segmented section both in volume and
number of decomposed parts.
C. Vascular Skeleton Extraction

Fig. 5.

Decomposition of vessel branch section for ε values.

TABLE II
DECOMPOSITIONS OBTAINED FOR CONCAVITY RESOLUTION RANGES,
50 < ε < 250. COMPARISONS MADE BETWEEN NUMBER OF WACD
SEGMENTED PARTS (WP) AND WACD SEGMENTED VOXELS (WV), NUMBER
OF EXPERT SEGMENTED PARTS (EP), AND EXPERT SEGMENTED VOXELS (EV)

The vascular skeleton extraction technique that we propose is
applied directly on the vascular mesh representation. Skeleton
extraction is addressed as follows: we start with formulating
the problem of global surface contraction [22]. We contract
the mesh so that it continues to conform to the geometry of
the initial vessel surface. Anchor points are used that act as
attractors, causing the mesh vertices to contract (converge) to
an approximate skeleton of the vessel shape (see Fig. 4).
1) Differential Coordinates: The vessel two-manifold surface Sis defined in R3 as an undirected weighted graph
D∗ = {V, E}. We define the differential coordinates of a vertex
vi as
⎡
⎤
1 	
1 ⎣ 	
ωij (vi − vj ) = ω
ωij vj ⎦ − vi
L(vi ) = ω
ij j ∈N (i)

where (pnk )k ∈ {1, . . . , P (n)} represents the dual graph D∗ obtained after n edge collapse operations on P clusters. This procedure is iteratively performed until all edges of D∗ are in clusters
with concavity lower than a determined concavity resolution
value ε. In the next section, these clusters (subcomponents) are
grouped using the vessel skeleton.
4) Parameter Estimation: Estimation of the concavity resolution ε was determined by volumetric comparisons made
on n = 65 preselected sections that were segmented by an
expert (containing cerebral aneurysms and vessel bifurcations). In order to obtain topological consistence, it is essential that the WACD algorithm not separate the volumes into
more parts (Fig. 5). Vessel sections were decomposed using
WACD and voxelized. In our experimental setup, parameters
θ1 = −0.78, θ2 = 0.04, θ3 = 0.83, and δ = 0.67 were used. Table II shows the decomposition obtained (for a single branch
section and aneurysm section) for various concavity resolution

ij

j ∈N (i)

(7)
where L(vi ) is the Laplace operator on vi , N (i) is the set of
neighbors of the ith vertex, and ωij is the edge weight of
edge E(i, j). Weighting is utilized to approximating the geometric properties of the mesh. The literature shows two generally used approaches; cotangent weighting and uniform weighting [28]. In uniform weighting, edges are assigned unit weights
wij = 1 ∀i, j. In this approach, only the mesh topology is considered and not its geometry. For a complete approximation of
the surface geometry, it is necessary to include information of
the angles formed between the edges of the mesh. We use cotangent weights that are more effective for mesh contraction. Using
cotangent weights, the differential coordinates approximate the
curvature normal to the surface mesh [28], [29].
2) Laplace Contraction: The vessel surface is contracted
by the Laplace operator that removes surface features along
the vertex curvature normal directions. In our approach, vertex
contractions are obtained by equating
Lc V = 0

(8)

CHOWRIAPPA et al.: 3-D VASCULAR SKELETON EXTRACTION AND DECOMPOSITION

143

Fig. 6. Cotangent weights of vertex v i used to approximate the local shape
characteristics (normal direction and mean curvature) of the surface.

where Lc is the Laplacian matrix with cotangent weights defined
by
⎧
ωij = cot αij + cot βij , if (i, j) ∈ E
⎪
⎪
⎪
⎪
l
⎨ 	
−ωil ,
if i = j
Lc =
(9)
⎪
⎪
(i,l)εE
⎪
⎪
⎩
0,
otherwise.
Angles α and β used in (9) are shown in Fig. 6. The vertices
of the surface mesh V are contracted by solving (8), where mesh
vertices are moved along the direction of their curvature normal.
3) Anchor Constraints: Iteratively solving Lc V  = 0 implies that we remove the normal component and contract the
mesh geometry [30], where V  represents the displaced (contracted) geometry. However, the contracting mesh is required
to abstract the original vessel shape as close as possible rather
than contract to a singular point. For this anchor, constraints are
set on the mesh geometry. All vertices are constrained to their
current position using weights and solving the linear system




0
Wc Lc
(10)
V =
Wa
Wa V
where Wa and Wc are the anchor and contraction weight matrices used to regulate the contraction forces, respectively. The
solution to (10) is equivalent to minimizing the quadratic energy [31]
	
2
2
Wc LV   +
Wa2 vk − vk  .
(11)
k

The first term shrinks the mesh by smoothing the mesh surface characteristics along the normal direction, while the second
term preserves the vessel geometry. In this sense, the rows of
the Laplacian act as contraction constraints that provide forces
to contract the mesh. In Fig. 4, after the first iteration of contraction, it can be seen that high-frequency mesh characteristics
are filtered out, leaving the resulting vessel shape noticeably
contracted. However, initial mesh connectivity is not changed
after the mesh contraction process.
In order for the vessel shape to converge to a 1-D vessel
skeleton, several iterations of (11) are required while updating
Wc and Wa . Using the same contraction and anchor weights
does not contract the mesh to a singular (≈0) volume skeleton. Hence, the weights of Wc are updated for each vertex vk
according to the area of its Lk1 -ring neighborhood. Since we

Fig. 7. 1-D vessel skeleton obtained by the Laplace contraction. Vessel
connectivity is performed on the induced skeleton mesh to identify skeleton
branches.

want vertices with smaller L1 -ring area to contract less. Each
iteration is evaluated
 i i as follows:


Wc Lc
0
i+1
1) solve
=
V
, for V i+1
Wai Lic
Wai
2) update Wci+1 = ρc Wci , and Wai+1 = Wci (σk0 /σki )
with contracted ver3) compute new Laplace operator Li+1
c
tices V i+1
where σk0 , σkt are the initial and current L1 - ring areas of vertex
vk , and ρc is the convergence rate constant. In general, larger
weights in Wa enforce positional constraints and thus preserve
the original geometry, which can be useful for tortuous vessel
section and branch sections (see Fig. 7). On the other hand,
larger weights in Wc enforce regular triangle faces in surface
contraction. We iterate until the ratio of the current and the initial
vessel volume is smaller than the threshold γ.
Parameters: The key to contraction lies in the initialization
of weights Wc and Wa . These forces are defined such that the
contracted regions at the thinner vessel branches act as strong
anchors retaining the key structural features of the vessel. These
thinner vessel branches always collapse first, while the thicker
structures take more iterations to collapse. In our experiment, we
√
use the following initial setting: Wa0 = 1.2 and Wc0 = 10−2 ρc .
By setting ρc = 3.0 and γ = 1e − 4, the vessel surface was
found to contract efficiently, usually in less than six iterations.
4) One-Dimensional Skeleton Extraction and Vessel Connectivity: After mesh contraction, the resultant vascular mesh
has close to zero volume and is geometrically a 1-D skeleton of
the vessel shape. However, this contracted mesh has the connectivity of the initial vessel mesh and needs to be converted into
a vessel skeleton graph (see Fig. 8). To distribute the vertices
of the vessel skeleton uniformly, vertices within a minimum
Euclidean distance are selected, and edges incident on these
vertices are then removed.
The skeleton structure is built from the condensed mesh S
by imposing initial connectivity, and then by applying an edge
collapse operation. Using farthest-point sampling with ball radius sr , the set of points closest to vertex vk are merged by a

144

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Fig. 8. Four iteration of surface contraction is performed to obtain a minimal
volume mesh. Merging of vertices using a half-edge collapse operator results in
a 1-D vessel skeleton graph.

Fig. 9. (a) Half-edge collapse of contracted mesh, (b) and (c) merging of
branches (G1–G9) with intersecting nodes within sphere radius S R resulting in
vessel branches (G1–G3).

Fig. 10. (a) Skeleton extraction and decomposition of vascular tree, (b) decomposed parts belonging to the same branch are grouped together (G1–G8).
(c) Skeleton extraction and decomposition of vessel section with aneurysm (G4),
and (d) decomposed parts (G1–G6) are grouped.

III. EXPERIMENT AND RESULTS
half-edge collapse operator. For each half-edge collapse operation hcol (k → j), the operator mergers vertex vk to vj and
removes all faces that are incident on vertex vj [see Fig. 9(a)].
However, this may result in the skeleton having more complex
branching structures than the anatomical relevant branches of
the vessel skeleton. We further simplify the skeleton ∀k = j, we
connect vk and vj if they share a common L1 -ring neighborhood
and merge branch nodes using hcol (k → j) where |vk | < |vj |
that are within the larger sphere radius sR [see Fig. 9(b)]. A
skeleton graph of uniformly distributed nodes is obtained shown
in Fig. 9(c).
5) Vessel Skeleton-Based Grouping: This skeleton mesh
connectivity process removes all the faces in the contracted
mesh, leaving a 1-D connected graph as the vessel skeleton. Using the adjacency matrix of the skeleton graph, vessel branches
Gi are identified (vertices that have three or more adjacent
nodes). Next, the WACD algorithm is used to decompose the
surface mesh into subcomponents, components belonging to
the same vessel branch are grouped together. WACD decomposed vessel sections are formed by the union of subcomponents
Pi ∈ S that belong to the same skeleton branch Gk = ∪i Pi ,
where Gi ∩ Gi = ∅, ∀i = j. In Fig. 10, we illustrate this grouping approach; the vessel skeleton is extracted and branches are
identified [see Fig. 10(a) and (c)]. After WACD, vessel subcomponents that belong to the same branch are grouped together
[shown in Fig. 10(b) and (d)].

We demonstrate our vessel decomposition and skeleton extraction methodology in Figs. 3, 4, 7, and 10. In addition,
the methodology was tested on labeled sections of the neurovasculature: BA, ACoA, PCoA, MCA, ICA, and SCA extracted
from clinical datasets. Presegmented sections (that included sections containing aneurysms and vessel bifurcations) of vasculature was archived for 98 aneurysms in 112 patients, and used
for validation and testing.
A. Section Decomposition and Skeleton Extraction
Sections of vasculature (n = 256) were classified by a clinical radiological expert into linear, curved, branch, and aneurysm
sections. For each class of vessel sections, the cluster range (decomposed subcomponents) and the number of skeleton branches
were identified, yielding the ground truth data. Table IV documents our results for vessel decomposition and skeleton extraction; using our WACD approach approximately 80.5% of the
structures were decomposed into the same number of components and 92.9% of the vascular skeletons extracted had correct
number of branches identified as the ground truth. In Fig. 3, we
illustrate the decomposition using WACD where close conformity with ground truth was obtained. For vessel branches [see
Fig. 3(b)], WACD clustered bifurcations with minimal number
of cluster while maintaining close structural representation of
the branched section. In Fig. 3(d) and (f), WACD was used to

CHOWRIAPPA et al.: 3-D VASCULAR SKELETON EXTRACTION AND DECOMPOSITION

145

TABLE III
VOLUMETRIC AND SURFACE AREA COMPARISONS BETWEEN WACD VOLUME (VOX), WACD SURFACE AREA (SA) OF EXTRACTED ANEURYSM SAC SECTIONS
AND EXPERT SEGMENTED ANEURYSM SAC VOLUME (EV) AND SURFACE AREA (EA)

TABLE IV
EXPERT CLASSIFIED SAMPLES (EC) AND EXPERT SPECIFIED CLUSTER RANGE
(CR) FOR EACH OF THE SHAPE CLASSES; CORRECTLY DECOMPOSED SAMPLES
(CDS) USING WACD; EXPERT SPECIFIED SKELETON BRANCHES (ESB) FOR
THE SHAPE CLASS AND CORRECTLY EXTRACTED SKELETON BRANCHES (CSB)

detection of ACoA aneurysm sac [pathological dilation of the
vessel shown in Fig. 12(a) and (d)], one of the most common
aneurysms [33] is shown.
C. Longitudinal Study Analysis

cluster vessel sections fused with the skull. Although we did
not intend to use it for separation of vessels fused to other
cranial structures, preliminary results seemed to favor its use.
Figs. 7 and 10 show vascular skeletons extracted using our
method. It can be seen that all the extracted skeletons represent
well the geometry and topology of the original vessel structure.
Fig. 7 demonstrates that our method also works well for vessel
aneurysm and bifurcation vessel shapes.
B. Skeleton Extraction and Decomposition
of the Circle of Willis
Studies have suggested that identifying geometric characteristics of the cerebral vessels of the circle of Willis may provide meaningful association with vascular disease formation
and progression [32], [33]. In particular, cerebral aneurysms
are frequently located at or near arterial bifurcations and after
regions of high vascular curvature, in arteries of the circle of
Willis [33]. We test the effectiveness of the methodology in
extracting the vascular skeleton and segmenting the circle of
Willis. In Fig. 12, we illustrate the decomposition of the circle of Willis using our vascular skeleton WACD approach. In
Fig. 12(b), and (e), the decomposition of the ACoA and the

The proposed methodology is to provide a means for CAD.
To demonstrate the clinical benefits of this approach, we test
for automated vessel skeleton extraction and decomposition using longitudinal study data on four patients with a prior history of unruptured and untreated cerebral aneurysms. These
aneurysms were not treated because they were determined to be
small and nonthreatening. We perform analysis on the following subjects: Case 1: A 31-year-old male with known history
of bilateral ICA dissection and EC-IC bypass due to a moyamoya type changes, post-ICA dissection having tiny basilar
apex aneurysm. CT stroke study showed enlargement of the
known basilar aneurysm. Case 2: A 44-year-old female with
known history of aneurysms and had previously stent coiled
posterior communicating artery aneurysm on the right. A 5 ×
5 mm incidental R PCoA aneurysm, unchanged in size was followed over a period of two months. Case 3: A 62-year-old female
was followed for incidental right-sided middle cerebral artery
(MCA) aneurysm, overall appeared stable (shown in Fig. 11).
Case 4: A 54-year-old female with post carotid sacrifice and
clipping of right MCA aneurysm and clipping of the left PCoA
aneurysm. Follow-up studies show a small A1 aneurysm that
appeared stable in size.
1) Aneurysm Data: Data were acquired on the aforementioned cases that had pretty much diffused vascular aneurysms
(ten CTA datasets). Segmentation of the vasculature and 3-D
surface reconstruction was performed. Measurements were performed on the sections containing aneurysms; aneurysm maximum diameters ranged from 1 to 5 mm (mean, 2 mm± 1[standard deviation]), and aneurysm neck sizes ranged from 1 to 3
mm (mean, 1.4 mm±1.2). Volume of aneurysm in terms of voxels ranged from 116 to 873 and aneurysm surface area ranged
from 10.63 to 35.31mm2 (see Table III). None of the aneurysms
had previously been treated with coils.
2) Skeleton Extraction and Decomposition: Using the proposed vascular skeleton extraction and WACD, the reconstructed
vasculature was decomposed resulting in subcomponents of
vessel sections (see Fig. 11). Follow-up analysis (volumetric
and surface area computation) was performed on the extracted
aneurysm sacs from longitudinal data (preliminary, follow-up I,

146

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 1, JANUARY 2014

Fig. 11. Case 3: A 62-year old female was followed for incidental right-sided MCA aneurysm. (a) Maximum intensity projection (MIP) of the internal carotid
artery and MCA shows a 4-mm aneurysm (arrow) with a 3-mm wide neck in the M1 segment of the right MCA; (b) and (c) 3-D reconstruction and vessel skeleton
extraction of the patient vasculature. (d) WACD extraction of MCA aneurysm.

segmented aneurysm sections. Fig. 11(a) and (b) illustrates Case
3, where MCA aneurysm on right-hand side followed over
a period of two months; MIP indicated noticeable change in
aneurysm size (see Table III). Using skeleton extraction and
WACD [see Fig. 11(b), (c), and (d)], the decomposed aneurysm
sac was extracted. We were able to detect changes in aneurysm
volumes (4.5% error) and surface areas (8.4% error) that were
close to that segmented by an expert.

IV. DISCUSSION AND CONCLUSION

Fig. 12. Vascular skeleton is extracted for the circle of Willis, (a), (c), and
(d) with large Anterior Communicating Artery (ACoA) aneurysm, and (b, and
c) using WACD aneurysm sacs are identified.

follow-up II). Expert segmented aneurysm sections are used
as ground truth. Table III documents our results; volumetric and surface area comparisons were made between expert
segmented aneurysm sections and the proposed approach. We
obtained a mean error rate of 7.78% for volumetric comparison and 10.38% for surface area comparisons between expert

The quantitative results above validate the feasibility of
the proposed vascular skeleton extraction and decomposition
methodology. Results obtained suggest that we attain near optimal decomposition close to expert segmented sections, with
approximately 80.5% of the vessel sections decomposed into the
correct number of components and 92.9% of the sections having
the correct number of skeleton braches. This skeleton representation of the vasculature is important for diagnosing and treating
pathologies, and follow-up studies. The method was also validated for CAD on a longitudinal study of four cases having
internal cerebral aneurysms. The main reason for the follow-up
study analysis was to demonstrate the effectiveness of this approach in automated segmentation of aneurysms. Results show
that we were able to segment aneurysms and detect changes in
aneurysm sac volumes and surface areas that are close to expert
segmented sections.
Our primary objective was the decomposition of the vasculature and extraction of the vessel skeleton for CAD analysis.
We have demonstrated that the proposed approach is a promising method for vascular analysis capable of producing effective
decomposition (which include bifurcations and aneurysms), a
parsimonious description on which vascular analysis can be
performed. From our initial longitudinal study, findings suggest that our methodology can provide a basis for vascular
analysis. However, a much larger follow-up study, and also a
comparative study with patients with ruptured and unruptured
aneurysms, would be necessary to determine the clinical efficacy
of this methodology on decomposing and identifying vascular
aneurysms.

CHOWRIAPPA et al.: 3-D VASCULAR SKELETON EXTRACTION AND DECOMPOSITION

REFERENCES
[1] R. Véronique et al., “Heart disease and stroke Statistics-2012 update: A
report from the American Heart Association,” Circulation 125.1: e2-e220,
2012.
[2] X. Tizon, “Algorithms for the analysis of 3D magnetic resonance angiography images,” Ph.D. Thesis, Centre for Image Analysis, Swedish Univ.
Agricultural Sci., Uppsala, Sweden, 2004.
[3] Y. Wang and P. Liatsis, “3-D quantitative vascular shape analysis for
arterial bifurcations via dynamic tube fitting,” IEEE Trans. Biomed. Eng.,
vol. 59, no. 7, pp. 1850–1860, Jul. 2012.
[4] A. Chowriappa, T. Kesavadas, M. Mokin, P. Kan, S. Salunke, S. Natarajan,
and P. Scott, “Vascular decomposition using weighted approximate convex
decomposition,” Int. J. Comput. Assisted Radiol. Surg., vol. 8, no. 2,
pp. 207–209, 2012.
[5] Y. Shang, R. Deklerck, E. Nyssen, A. Markova, J.D. Mey, Y. Xin, and
S. Kun, “Vascular active contour for vessel tree segmentation,” IEEE
Trans. Biomed. Eng., vol. 58, no. 4, pp. 1023–1032, Apr. 2011.
[6] B. Chen, T. Kitasaka, H. Honma, H. Takabatake, M. Mori, H. Natori,
and K. Mori, “Automatic segmentation of pulmonary blood vessels and
nodules based on local intensity structure analysis and surface propagation
in 3D chest CT images,” Int. J. Comput. Assisted Radiol. Surg., vol. 7,
no. 3, pp. 465–482, 2011.
[7] B. Ren, Y. Zhang, and D. X. B. Chen, “A novel method for 3Dsegmentation of vascular images,” Adv. Natural Sci., vol. 3, no. 2, pp. 55–
61, 2010.
[8] X. Wu, V. Luboz, K. Krissian, S. Cotin, and S. Dawson, “Segmentation
and reconstruction of vascular structures for 3D real-time simulation,”
Med. Image Anal., vol. 15, no. 1, pp. 22–34, 2011.
[9] J. F. Carrillo, M. Orkisz, and M. H. Hoyos, “Extraction of 3D vascular
tree skeletons based on the analysis of connected components evolution,”
in Computer Analysis of Images and Patterns (Lecture Notes Computer
Science vol. 2691). Berlin, Germany: Springer, 2005, pp. 604–611.
[10] A.G. Radaelli and J. Peiro, “On the segmentation of vascular geometries
from medical images,” Int. J. Numerical Methods Biomed. Eng., vol. 26,
no. 1, pp. 3–34, 2010.
[11] C. Kirbas and F. K. H. Quek, “A review of vessel extraction techniques and
algorithms,” ACM Comput. Surveys (CSUR), vol. 36, no. 2, pp. 81–121,
2004.
[12] M. Attene, S. Biasotti, M. Mortara, G. Patane, M. Spagnuolo, and
B. Falcidieno, “Computational methods for understanding 3 D shapes,”
Comput. Graphics, Spec. Issue, vol. 30, no. 3, pp. 323–333, 2006.
[13] H. E. Cetingul, M. A. Gulsun, and H. Tek, “A unified minimal path tracking and topology characterization approach for vascular analysis,” in Proc.
5th Int. Conf. Med. Imag. Augmented Reality, 2010, pp. 11–20.
[14] H. Li, A. Yezzi, and L. Cohen, “3D multi-branch tubular surface and
centerline extraction with 4D iterative key points,” Med. Image Comput.
Comput. Assist. Interv., vol. 5762, pp. 1042–1050, 2009.
[15] X. Wu, V. Luboz, K. Krissian, S. Cotin, and S. Dawson, “Segmentation
and reconstruction of vascular structures for 3D real-time simulation,”
Med. Image Anal., vol. 15, no. 1, pp. 22–34, 2011.
[16] E. Franchini, S. Morigi, and F. Sgallari, “Segmentation of 3D tubular
structures by a PDE-Based anisotropic diffusion model,” in Mathematical
Methods for Curves and Surfaces (Lecture Notes Computer Science vol.
5862). Berlin, Germany: Springer, 2010, pp. 224–241.

147

[17] B. Christian, P. Thomas, S. Erich, B. Horst, and B. Reinhard, “Segmentation of interwoven 3 D tubular tree structures utilizing shape priors and
graph cuts,” Med. Image Anal., vol. 14, no. 2, pp. 172–184, 2010.
[18] M. Chris and H. Ghassan, “Vessel crawlers: 3D physically-based deformable organisms for vasculature segmentation and analysis,” in Proc.
IEEE Comput. Soc. Conf. Comput. Vision Pattern Recog., 2006, pp. 1084–
1091.
[19] J. M. Lien, J. Keyser, and N. M. Amato, “A simultaneous shape decomposition and skeletonization,” in Proc. ACM Symp. Solid Phys. Model.,
2006, pp. 219–228.
[20] S. Katz and A. Tal, “Hierarchical mesh decomposition using fuzzy clustering and cuts,” in Proc. ACM SIGGRAPH—Trans. Graph., 2003, vol. 22,
no. 3, pp. 954–961.
[21] J. Cao, Y. He, Z. Li, X. Liu, and Z. Su, “Orienting raw point sets by
global contraction and visibility voting,” Comput. Graphics, vol. 35, no. 3,
pp. 733–740, Jun. 2011.
[22] Z. Ji, L. Liu, and G. Wang, “A global Laplacian smoothing approach
with feature preservation,” in Proc. 9th Int. Conf. Comput. Aided Design
Comput. Graph., Hong Kong, 2005, pp. 269–274.
[23] D. Field, “Laplacian smoothing and Delaunay triangulations,” Commu.
Appl. Numerical Methods, vol. 4, pp. 709–712, 1988.
[24] K. Krissian, “Flux-based anisotropic diffusion applied to enhancement of
3-D angiogram,” IEEE Trans Med Imag., vol. 21, no. 11, pp. 1440–1442,
Nov. 2002.
[25] L. Ibanez, W. Schroeder, L. Ng, and J. Cates, The ITK Software Guide.
Clifton Park, NY, USA: Kitware Inc., 2005.
[26] L. Antiga, “Patient-specific modelling of geometry and blood flow in large
arteries,” Ph.D. dissertation, Dept. Bioengineering, Politecnico di Milano,
Milan, Italy, 2002.
[27] W. Cees, F. R. Vincent, M. V. Frans, and J. V. Lucas, “Detection and
segmentation of colonic polyps on implicit isosurfaces by second principal
curvature flow,” IEEE Trans. Med. Imag., vol. 29, no. 3, pp. 688–698,
2010.
[28] M. Meyer, M. Desbrun, P. Schroder, and A. H. Barr, “Discrete differentialgeometry operators for triangulated 2-manifolds,” in Proc. Vis. Math. III,
Berlin, Germany, 2003, pp. 35–58.
[29] A. Nealen, T. Igarashi, O. Sorkine, and M. Alexa, “Laplacian mesh optimization,” in Proc. 4th Int. Conf. Comput. Graph. Interactive Tech.
Australasia Southeast Asia, New York, NY, USA, 2006, pp. 381–389.
[30] L. Liu, C.L. Tai, Z. Ji, and G. Wang, “Non-iterative approach for global
mesh optimization,” Comput.-Aided Design, vol. 39, no. 9, pp. 772–782,
2007.
[31] O. Sorkine and D. Cohen-Or, “Least-squares meshes,” in Proc. IEEE Int.
Conf. Shape Model. Appl., 2004, pp. 191–199.
[32] N. K. Rooij, B. K. Velthuis, A. Algra, and G. J. E. Rinkel, “Configuration
of the circle of Willis, direction of flow, and shape of the aneurysm as risk
factors for rupture of intracranial aneurysms,” J. Neurol., vol. 256, no. 1,
pp. 45–50, Jan. 2009.
[33] J. L. Brisman, J. K. Song, and D. W. Newell, “Cerebral aneurysms,” N.
Engl. J. Med., vol. 355, no. 9, pp. 928–939, Aug. 2006.

Authors’ photographs and biographies not available at the time of publication.

