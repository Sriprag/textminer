1718

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Nonlinear Dynamic Modelling of Platelet
Aggregation via Microfluidic Devices
Miguel E. Combariza, Member, IEEE, Xinghuo Yu∗ , Fellow, IEEE, Warwick S. Nesbitt,
Arnan Mitchell, Member, IEEE, and Francisco J. Tovar-Lopez

Abstract—The recent application of new microfluidic technologies and methods has facilitated significant progress in the understanding of the fundamental mechanisms governing blood platelet
function and how these parameters affect pathological thrombus
formation. In-line with these new bioengineering approaches, the
application of nonlinear dynamic systems analysis holds particular potential to extend our understanding of the complex interplay between mechanical and biochemical factors that underlie
this complex biological phenomenon. In this paper we propose a
simple mathematical model of the main dynamics of platelet aggregation/disaggregation observed experimentally in a novel microfluidic device that approximates a severe arterial stenosis. We
apply dynamic systems theory (system identification) to explore
the dynamics of the biomechanical platelet aggregation response
to a range of shear stress rates, inhibiting blood-born chemical
pathways of platelet activation (ADP, TXA2, and thrombin). We
demonstrate that the proposed model is able to replicate experimental results with low variation, and suggest that the reduced set
of model parameters has the potential to be used as a simplified
way to evaluate the biomechanical dynamics of platelet aggregation. The proposed model has application to the development of
automatic controllers within the context of microfluidic systems
that may show great utility in the clinical assessment of platelet
hyperfunction.
Index Terms—Blood, diagnosis, disturbed flow, microfluidics,
platelet aggregate, platelet function, shear rate, system identification.

I. INTRODUCTION
LATELETS play a key role in the arrest of bleeding
(haemostasis) and subsequent vascular repair. This is
achieved through their adhesion and aggregation at sites of
blood vessel damage. However, alterations of normal blood

P

Manuscript received August 15, 2013; accepted January 20, 2015. Date of
publication February 18, 2015; date of current version June 16, 2015. Asterisk
indicates corresponding author.
M. E. Combariza, F. J. Tovar-Lopez, and A. Mitchell are with the Microplatforms Research Group, School of Electrical and Computer Engineering, RMIT
University.
∗ X. Yu is with the Platform Technologies Research Institute, RMIT University, Melbourne, VIC 3001, Australia (e-mail: x.yu@rmit.edu.au).
W. S. Nesbitt is with the Bionics Institute Australia.
This paper has supplementary downloadable material available at http://
ieeexplore.ieee.org, provided by the authors. This includes one multimedia
AVI format movie clip, which shows epi-fluorescence images of platelet aggregation/disaggregation in response to different shear rate conditions, and one
PDF file, containing the Supplementary Information: SI Appendix 1 presents
details on the image processing algorithm employed in this study, SI Appendix
2 shows Computational Fluid Dynamics simulations demonstrating the presence of a flow vortex proximal to the aggregate when it reaches a particular
size, and SI Appendix 3 presents a summary of the operational parameters of
microfluidics device employed for this study. This material is 12 MB in total
size.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2403266

Fig. 1. Dynamics of platelet aggregation under stenotic flow. Conceptual
model in which platelet aggregation is regulated by two complementary mechanisms: rheological (biomechanical) and soluble-agonist-dependent. Shear microgradients produce initial platelet aggregation and subsequent soluble agonists
accumulate downstream of the stenosis in vortices further enhancing platelet activation and aggregation. Adapted from [2] Copyright 2009 by International Society on Thrombosis and Haemostasis. Reprinted by permission of John Wiley
& Sons, Inc.

flow at sites of atherosclerotic plaque rupture or vessel narrowing (stenosis), can significantly amplify the platelet response
leading to pathological platelet aggregation and thrombosis. Despite decades of research into the underlying platelet functional
parameters that put patients at risk of thrombotic disease, the
underlying mechanisms by which mechanical and biochemical
parameters affect platelet function remain difficult to observe
and analyze. Existing clinical testing relies on functional screens
that are time consuming and fail to account for the integration of
both mechanical and biochemical parameters. The application
of advanced microfluidic technologies and the use of control
engineering methods to platelet functional analysis offer new
opportunities for the development of point of care diagnostics.
Recent work suggests that under conditions of blood flow
disturbance current antiplatelet therapies may be ineffective in
limiting platelet aggregation. These studies have demonstrated
a major role for shear rate microgradients in the initiation and
maintenance of platelet aggregation [1]. A conceptual model
of this process is illustrated in Fig. 1, in which initial platelet
aggregation and thrombus development are regulated by two
distinct, complementary processes [2]. These new insights into
the mechanisms of platelet aggregation have motivated the development of flow-based devices for measuring platelet function
that consider shear stress and blood flow disturbances [3]–[11].
Several spatial-temporal mathematical models of platelet aggregation have benefited from new experimental microfluidic
platforms available, and focused their analysis on the impact
of blood flow on thrombus formation [12]–[19]. Microfluidic
devices have evident advantages over traditional parallel-plate
chambers, and cone-and-plane viscometery methods [20], such
as precise control of blood flow parameters, and the ability to
perform multiple experiments with small blood sample volumes,

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

COMBARIZA et al.: NONLINEAR DYNAMIC MODELLING OF PLATELET AGGREGATION VIA MICROFLUIDIC DEVICES

and high throughput [9]. Furthermore, due to the enhanced precision, complexity, and parallelism that is possible with these
platforms, there is the potential to evaluate multiple aspects of
platelet function and thrombus formation simultaneously [3].
Evaluation of platelet function under flow conditions typically
consists of analysing the time-dependent adhesion and aggregation profile. Analyses are commonly represented by parameters
such as: lag time, aggregation rate, maximum thrombus size,
or total aggregation, for each shear rate tested [8]. The result is
often a set of data of considerable size and large coefficient of
variation. Furthermore, postprocessing of experimental results
can be time consuming and are often subjective in nature. In
this paper, we present a new approach to platelet aggregation
analysis, with an aim to develop a robust, and potentially automatic means of quantifying platelet function. The main chemical
pathways of platelet activation (ADP, TXA2 and thrombin) are
inhibited in order to isolate the main biomechanical response.
This paper is structured as follows. Section II introduces the
experimental platform employed for this study. Then, Section III
presents the dynamics of thrombus formation in response to a
simple step increase in flow velocity from static conditions to
sufficient velocity, and hence shear stress, to induce aggregation. Section IV interrogates the aggregation response to dynamic fluctuations in flow rate, and hence shear stress, and uses
the observed response to develop a simple nonlinear mathematical model of the aggregation response. The model parameters
include τ representing the time constant of the aggregation response, c0 representing the initial proportional relation between
platelet aggregate size and shear rate, and c1 regulating the effect of a time-varying enhancing effect on the aggregation of
platelets. Next, Section V uses this model to analyse the aggregation response for a given sequence of shear stress rates and
the utility of this model is evaluated and discussed with an interdonor variability study. Finally, in Section VI, the key findings
of this paper are summarized, and opportunities for future work
are identified.

II. REVIEW OF MICROFLUIDIC DEVICE FOR THE MONITORING
OF PLATELET AGGREGATION
Aggregation in response to multiple shear rates has been accomplished using parallel microchannels of various sizes and
syringe drivers [6], [7], [10], [11], or controlling the pressure
over well-plates connected to microfluidic channels [4], [5].
Other platforms have included structures in the microchannels
that mimic vessel injuries or stenosed arteries [8], [21].
While microfluidic platforms at the forefront of high content platelet evaluation [8], [22] claim to increase throughput by
having parallel test microchannels simultaneously driven by a
single actuation mechanism, two main disadvantages outweigh
the promised benefits. The first and major problem is that the
forming aggregate in the channels generates a build-up of pressure that alters the preset conditions of shear rate for the other
channels as demonstrated by Colace et al. [23], resulting in a
large source of uncertainty in the results. The second problem is
that in order to evaluate the multiple test microchannels expensive computerised micropositioners are required to place each of
the channels under the microscope field of view. This invalidates

1719

the purpose of portability and simplicity of operation offered by
microfluidic devices.
In this study, a microfluidics device recreating a scenario of induced stenosis was employed to explore the dynamics of platelet
aggregation induced by disturbed flow. Different conditions of
shear rate were obtained by dynamically altering the value of
the flow rate in the device. For detailed information on the development of such device, as well as some other fundamental
parameters that affect the platelet aggregation response in the
device please refer to Ref. [21] and SI Appendix 3 (available at
http://ieeexplore.ieee.org).
Blood was perfused through the device using a syringe pump,
and the forming aggregate of platelets was monitored using fluorescence microscopy as described in Ref. [21]. A diagram of
the device is presented in Fig. 2, where it can be seen that anticoagulated whole blood was deposited into 250 μL reservoirs
[A], each connected to a microfluidic channel [D]. The negative
pressure exerted in the channel exhaust [E] induced blood flow
from the reservoirs into the microchannels, passing through a filter designed to block undesired inclusions [B]. Then, the blood
was funnelled into the main channels and perfused through six
replicas of microcontractions, mimicking a scenario of arterial
stenosis at 80%. Finally, waste was collected through a bore
exhaust connected to the end of the microchannel. The chip
was fabricated using a cast of a biocompatible organic polymer,
Polydimethylsiloxane or PDMS, on a mould of negative photoresist (KMPR from Microchem) using standard photolithographic processes. A photograph of the resulting device is presented in Fig. 2(b).
In order to isolate the rheological effects of blood flow under disturbances from the major blood-born chemical pathways of platelet activation (ADP, TXA2 and thrombin), blood
was pretreated with pharmacological inhibitors of the canonical
platelet amplification loops (amplification loop blockade ALB:
Indomethacin, Apyrase, MRS2179, 2-MeSAMP, and Hirudin)
[1]. Lipophilic membrane dye DiOC6 was used to label platelets
and an imaging system, comprising of an inverted microscope
and a CCD camera, monitored the epi-fluorescence illumination of the aggregates of platelets over time, at one frame
per second. The size of the forming aggregates was estimated
frame-by-frame in Matlab R2010a by thresholding the brightness of video, segmenting the main aggregate, and calculating
the area of pixels above a minimal value (see SI Appendix 1 for
more details on this image processing algorithm, available at
http://ieeexplore.ieee.org). Fig. 2(c) presents a sequence of images of the detected epi-fluorescence from the aggregate in one
of the microchannels, over a period of 10 min. The measured
aggregate size was the area contained within the detected edge
of the aggregate (white boundary). This image processing algorithm reduced background noise and gave a suitable indication
of the development of the aggregate over time.

III. PLATELET AGGREGATION IN RESPONSE TO A STEP
INCREASE IN SHEAR STRESS
A straightforward approach to characterize the dynamics of a
system is analyzing its transient response [24]. Transient analysis often uncovers intrinsic characteristics of the system; such

1720

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Fig. 2. Microfluidics platform for real-time monitoring of platelet aggregation under stenotic flow. (a) Schematics of the microfluidics chip comprising
anticoagulated blood reservoirs [A], undesired particles filter [B], interrogation area containing six identical microcontractions [C], microfluidic channels [D],
and bore exhausts to connect syringe driver [E]. Close-up of microcontraction geometry [F] showing the point V x , at which shear rate is calculated (near the
wall and upstream of microcontraction). (b) Photograph of the operating microfluidics platform. (c) Sequence of epi-fluorecent images of blood perfusion under
physiological conditions (γ = 1800 s−1 ) and detected aggregate -white boundary, over time.

as its time constant, value of static gain and, in some cases,
an approximate idea of the ‘order’ of the system—the highest
derivative degree of the differential equation that models the
system—which is an important characteristic when attempting
to construct a model. It basically consists of analysing the evolution of the output of a system over time, when the input is
changed abruptly from one value to another. Let us denote the
input and output of the system at time t by u(t) - shear rate, and
y(t) - aggregate size, respectively. A step is defined by:

u(t) =

u0

if t < t0 ,

u1

if t ≥ t0 .

(1)

In order to test the step response of platelet aggregation
in our experimental platform, blood flow experiments from
a healthy donor on single channels (n = 6) were carried out
with a physiological shear rate set at the input (γ = 1800 s−1 ,
produced by Q = 15 μL/min), for a total time of 10 min:
u0 = 0, u1 = 1800 s−1 , t0 = 0, t = 0 : 10 min.
Traces from the aggregation response of these experiments
are shown in Fig. 3. In all cases, aggregation was minimal for the
first 2 min of the experiment. Following this initial time lag, the
platelet aggregate grew rapidly for about 3 min until reaching a
plateau. After some time of slow growth in the plateau, in each
experiment, a second phase of growth was observed, which
did not reach a steady state by the end of the experiment. A
trace which is the average of the six measurements shows the
consistency of the experiment, in which all the mentioned phases
were exhibited [25]. Only one of the experiments (purple trace)
deviated from the average. In this case, the aggregate presented a

Fig. 3. Short-term dynamics of platelet aggregation in response to a step
increase in shear stress. Six trials of blood perfusion from a healthy donor
(discontinuous traces), n 1 in Table II, and average (continuous trace). Blood
flow conditions: u 0 = 0, t0 = 0, u 1 = 1800 s−1 .

sudden loss of material at approximately t = 6 min, and, despite
of this event, it reached a final size close to the average value.
These aggregation traces indicate the presence of a nonlinearity in the response, since the aggregate continues to grow
after an apparent plateau, as opposed to approaching a steady
state as time goes on. The initial response, 2 < t < 6 min, resembles a typical overdamped response of a physical system of
low order, until it reaches the stage of plateau. However, after
the plateau is reached (t > 6 min), the aggregate continues to
grow. This is not simply a transient response to the step increase
in flow velocity at the syringe pump, as it would be expected
that these forced conditions would have reached steady state
after the plateau (6 < t < 10 min), yet the aggregate continues
to grow.

COMBARIZA et al.: NONLINEAR DYNAMIC MODELLING OF PLATELET AGGREGATION VIA MICROFLUIDIC DEVICES

Perfusion of the microfluidic system for t > 10 min resulted
in a relative plateau of platelet aggregation in which platelet
accrual and loss lead to a fluctuating mean aggregate size of
ȳ = 1961 μm2 and standard deviation of σ = 474 μm2 (76%).
Although approximate linear models can be formulated from
these experiments, these models are limited in reproducing experimental results with different shear rates. More importantly,
these models do not consider the inherent nonlinearity evident
in the experiments, which is of vital importance for the consolidation of the platelet aggregate. A nonlinear model structure,
representing the dynamics of platelet aggregation under disturbed flow, in conjunction with a more sophisticated modelling
methodology is required. Fig. 3 presents sufficient information
to characterize the linear transient response of the system, but
does not present sufficient information about the nonlinear response as this is only evident towards the end of the experiment.
This nonlinear response must be studied further in order to effectively construct a model of platelet aggregation under disturbed
flow.

IV. EXTRACTION OF THE NONLINEAR DYNAMIC MODEL
PARAMETERS OF PLATELET AGGREGATION USING SYSTEM
IDENTIFICATION
In this section, we take a new approach to the generation
and interpretation of the results of platelet aggregation in response to disturbed flow. To begin pursuing this goal, we set
out to extract a reduced number of parameters that describe the
observed platelet aggregation behaviour. For this, we treat the
platelet aggregation in response to a range of shear rates within
a microfluidic device [21] as an abstract unknown nonlinear
system, and draw on concepts common in Dynamic and Control
Systems, namely System Identification [26].
System identification is a methodology to obtain dynamic
mathematical models from observed experimental data [26],
[27]. As opposed to the step-response experiment presented in
Section III, the input is typically varied dynamically over time
through different levels of amplitude in order to explore in detail
the dynamics of the system. Although this methodology arose
from the need to obtain differential equations, states-space, or
transfer functions, to design controllers for mechanical systems,
it has had increasing application in a number of disciplines,
including biomedicine [28]–[31].
An initial approach to this task is to use black-box modelling
to determine some attributes of the system, such as time delay, order of the system, and the grade of linearity. A previous
study explored linear models of platelet aggregation under blood
flow disturbances and found that low-order linear systems can
approximate the initial aggregation response (t < 3 min) [32].
However, the inherent nonlinear nature of the system makes
these linear models inaccurate to predict the medium and longterm aggregation response.
The investigation is divided into a number of short sections
as follows. Section IV-A, presents the design of an experiment
that aims to reveal the dynamics of platelet aggregation under different conditions of disturbed flow. Then, Section IV-B
presents a nonlinear model structure that considers the physiological insight of the mechanisms affecting the dynamics of

1721

Fig. 4. Block diagram of conceptual model in which platelet aggregation
is regulated by two complementary mechanisms: rheological (biomechanical)
and soluble-agonist dependent. Shear microgradients produce initial platelet
aggregation and subsequent soluble agonists accumulate downstream of the
stenosis in vortices further enhancing platelet activation and aggregation. I(t)
is the platelet density represented by the measured mean intensity, c(t) is the
enhancing aggregation response, u(t) is the input of the system (shear rate),
and y(t) is the output of the system (thrombus size measured by its area).

platelet aggregation under flow disturbances illustrated in Fig. 1.
Section IV-C then introduces a method for calculating the parameters in the model in order to fit experimental data. Finally,
in Section IV-D, methods for evaluating the quality of the model
are presented.
A. Experimental Design
The objective of this initial experiment is to design an input
signal u(t) that can expose as many properties of the system as
possible, and then record the measured response of the system
y(t) to this input over a time interval 1 ≤ t ≤ N :
Z N = {u(1), y(1), . . . , u(N ), y(N )}.

(2)

Ideally, it would be desirable to use an infinitely long input
signal, containing all possible values of amplitude and frequency
in order to fully characterize the system. However, in practice,
there are several constraints. As we are primarily interested in
the effect of the mechanical blood flow factors on platelet aggregation, these are isolated by blocking the chemical pathways
of platelet activation with pharmaceutical inhibitors [1], which
remain effective for approximately 1 h, and thus, the duration
of the experiment is constrained to this time frame.
The selected signal for the initial characterization of the system u(t) was a discrete pseudo-random sequence due to its
desirable statistical properties [33]. The amplitude values of
the levels in the sequence were selected from physiological
and pathological values of shear rate reported in the literature
{120 s−1 − 2400 s−1 }[34]. The duration for which each level
was held was 5 min. This was considered sufficiently long for
the system to present a complete transient response. Measurements were carried out every three seconds.
B. Model Structure and Parametrization
The proposed model structure is conceived to represent the
main mechanisms that promote platelet aggregation observed in
Section III. A block diagram of this representation is shown in
Fig. 4. In this diagram, the main block represents the biomechanical response of platelet aggregation to shear rate microgradients, of which transfer function is approximated by a first-order

1722

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

linear system. A second block represents an enhancement of the
aggregation response through a feedback mechanism coupled to
the main block. This model suggests that the aggregated platelet
density is responsible for generating the release of agonists not
targeted by the Amplification Loop Blockade treatment (ALB),
which in turn activate more platelets enhancing the aggregation
response. This leads to the formulation of the model:
dy
+ y = c(t)u(t)
τ
dt
c0

c(t) =
−c
1+e 1

(3a)
I (η )dη

.

(3b)

The parameter τ corresponds to the time constant of the nonlinear system. An approximation of the time constant for a linear
system can be obtained by measuring the time to reach 95% of
steady-state value when a step is input to the system, and this
time should correspond to approximately t = 3τ . The parameter
c0 represents the proportional gain between output and input.
In this specific instance, this will be the gain of platelet aggregation in response to shear rate. The parameter c1 regulates
the effect of the enhancing phenomena on the growth of the
aggregate. The function c(t) represents the enhancing nonlinear effect due to expression of agonists not targeted by ALB,
and such an effect
 is modelled to be proportional to cumulative
platelet density ( I(η)dη). The function c(t) follows a sigmoid
growth from experimental observations of the time-varying behaviour of the aggregate (For more details on the measurement
of I(t) from the platelet dynamics, see SI Appendix 1, available
at http://ieeexplore.ieee.org).

Fig. 5. Experimental data employed for model estimation Z N . Platelet aggregate size over time y(t) (marker +) in response to the blood flow conditions
u(t) (continuous trace). The size of the aggregate is represented by the area
measured inside the detected aggregate from the epi-fluorescent images, and
the blood flow conditions are represented by the shear rate in the microchannel
upstream of the contraction. The values at the input ranged from low to high
physiological shear rates: 120, 600, 1200, 1800, 2400 s−1 .

then, a sequence of prediction errors is formed,
e(t, θ) = y(t) − ŷ(t, θ),

t = 1, 2, . . . , N

(6)

and finally, minimization of the sum of errors in the sequence is
formulated as
θ̂N = arg min
θ

N
1 
eF (t, θ),
N t=1

(7)

where eF is the error signal after being filtered by a stable linear
filter.
Here, any minimization method can be applied, such as subspace Gauss–Newton direction, or Levenberg–Marquardt [35].
We have chosen to work with Nonlinear Least-Squares Method
since it is optimum in the search of nonlinear spaces [36], [37].

C. Estimation Method

D. Model Validation

Once the structure of the system has been selected, the next
step is finding the set of parameters of the model, θ = [τ, c0 , c1 ],
that best fit the observed data, θ̂N . This can be achieved with
the well-known Prediction Error Method (PEM) [27].
For this, the model is first represented in a state-space matrix
form:

A standard method to evaluate the goodness of fit of a calculated model is the coefficient of determination (R-square) [38]:
N
(yi − ŷi )2
,
(8)
R2 = 1 − iN
2
i (yi − ȳ)

1
1
x˙1 (t) = − x1 (t) + x2 (t)u(t)
τ
τ


x2 (t) x2 (t)
x˙2 (t) = c1 1 −
c0
x3 (t)
x˙3 (t) = I(t)
y(t) = x1 (t),

(4b)

where yi is the measured experimental data, ŷi is the output of
the fitted model, and ȳ is the mean of yi .
Ultimately, a simple way of inspecting the performance of
the models was realized by visual inspection of the model performance in comparison to the measured data.

(4c)

V. RESULTS AND DISCUSSION

(4d)

Having developed a potential nonlinear model in Section III,
this section aims to validate this model through the application
of measured experimental data.

(4a)

where the state variables x1 (t) represents the size of the aggregate over time, x2 (t) represents the magnitude of the enhanced
aggregation function, and x3 (t) represents the cumulative
platelet density. While x1 and x3 are variables that can be measured, state variable x2 is a representation of an unmeasurable
internal state.
In PEM, a model will be a predictor of the next output y(t),
given past observations Z t−1 , parameterized in terms of a parameter vector θ [26]:
ŷ(t|θ) = g(θ, Z t−1 )

(5)

A. Initial Experimental Results
Results from the identification experiment described in Section IV-A are illustrated in Fig. 5. These results show the
evolution of the aggregate size, y(t), as the shear rate experienced by the platelets was altered dynamically, u(t) (See
Supplementary Movie 1, which shows epi-fluorescence images from this experiment of platelet aggregation/disaggregation
in response to different shear rate conditions, available

COMBARIZA et al.: NONLINEAR DYNAMIC MODELLING OF PLATELET AGGREGATION VIA MICROFLUIDIC DEVICES

at http://ieeexplore.ieee.org). Evidently, the physical conditions set by the shear rate, largely dominated the aggregation/disaggregation of platelets.
As expected, the amount of aggregation was proportional to
the magnitude of the shear rate in the experiment [7], [8], [39].
The lowest value of shear rate set at the input, u(t) = 120 s−1 ,
led to complete platelet aggregate disintegration, y(t) ≈ 0.
Other studies have described a threshold in shear rate above
300 s−1 to support platelet aggregation [1], [8].
At the start of the experiment, a time delay of about 1.5 min
occurred before the aggregation of platelets was observed, similar to the lag time of 2 min present in Fig. 3. However, once the
shear rate was increased again at t = 10 min, the aggregation
response was instantaneous. Aggregation responses to subsequent steps set at the input had an immediate response on the
size of the aggregate. This initial time delay has been explained
in the literature as the time required to build an initial monolayer of platelets [2]. Furthermore, it has been established that
this phenomenon is insensitive to the value of shear rate set
at the input [8]. It is rather, dependent on the absorption kinetics of the glycoprotein Von Willebrand Factor (vWF) to the
substrate of the platform ( in this case PDMS).
A particularly noteworthy feature of the results in Fig. 5 is the
difference in the aggregation response obtained by apparently
identical pulses of the same magnitude and initial conditions
at the input, such as the steps at times t = 0, and t = 50 min.
While the former pulse produced a small aggregate size of approximately 1000 μm2 , the latter produced an aggregate almost
six times larger. This evident increase in the aggregation response verifies the existence of an inherent amplification of
the aggregation response over time. In fact, although the measurement of aggregate size was zero at the start of the pulses
at t = 0 and and t = 50 min, their initial physiological conditions were completely different. Before the latter pulse occurred,
t = 50 min, the stenosis wall included a highly active monolayer
of platelets, not registered in the aggregate size measurement due
to its small size, expressing an effect that greatly enhanced the
amount of aggregation. It is possible that this active monolayer
released ATP (from dense granules) and caused activation of
other platelets, through calcium channel P2X1, producing the
observed amplification effect [40].
B. Model Estimation of Initial Results
Once the model structure of the dynamics of platelet aggregation in response to shear rate was identified in Section IV,
and the experimental data collected, shown in Fig. 5, the next
procedure was to realise the estimation of the model parameters θ̂N ,N L M od . An initial computation of the coefficients of
the linearized model (c1 = 0) was realised directly using the
Least Squares Method-LSM, θ̂N ,L M od with zero initial conditions x0,L = [0 0]T . The calculated coefficients from LSM
were employed as a starting point in the nonlinear search of the
optimal coefficients for the nonlinear model (4).
The value of the estimated parameters of the linear and nonlinear models, and their covariance, are shown in Table I. These
results show that the time constant (τ ) for both models was
consistent, as expected. The parameter representing the linear

1723

TABLE I
MODEL PARAMETERS AND PERFORMANCE OF MODEL FROM INITIAL
EXPERIMENT

θ̂ L *
θ̂ N L

τ

c0

c1

R2

1.5557
(1.7 × 10 −2 ) **
1.7292
(9.3 × 10 −5 )

1.7731
(5.6 × 10 −2 )
5.7002
(2.1 × 10 −3 )

0
(0)
0.1217
(2.2 × 10 −6 )

0.53
0.85

∗

θ̂ N , Initial parameters calculated with LSM. θ̂ N , Estimated parameters
for nonlinear model.
∗ (σ ), Covariance of parameter.

∗

TABLE II
CHARACTERISTICS OF BLOOD FROM DONORS*

n1
n2
n3
n4

PLT [/μL ]

HCT [% ]

WBC [/μL ]

RBC [/μL ]

245 × 10 3
191 × 10 3
174 × 10 3
300 × 10 3

43.4
44.9
45.9
44.1

5 × 10 3
4.5 × 10 3
5.70 × 10 3
4.90 × 10 3

4.60 × 10 6
4.96 × 10 6
5.14 × 10 6
5.16 × 10 6

∗
PLT: platelet count, HCT: haematocrit, WBC: white cell count,
RBC: red blood cell.

gain between shear rate and aggregation response (c0 ) presented
a variation larger than twofold. Setting the parameter c1 in (4) to
be nonzero significantly improved the model fit of the nonlinear
model in comparison to its linear counterpart, as measured by
R2 values in Table I. In addition, the covariance of the nonlinear
model parameters was significantly lower.
C. Interdonor Variability of Model Parameters
This section aims to explore the variation of the calculated
model parameters when fitting with blood with different characteristics. Blood samples from four healthy donors, with blood
properties in Table II, were tested in the microfluidics assay
presented in Section II using equal conditions of shear rate. In
order to maximise the changes in the platelet aggregation response to changes of shear rate, the selected dynamic sequence
was a binary signal varying between two states: a maximum
of u(t) = 1800 s−1 , and a minimum of u(t) = 120 s−1 , each
during 5 min.
The platelet aggregation response obtained experimentally
for each of the donors is shown in Fig. 6. Notably, the aggregation responses of donors with higher platelet count, n1 and
n4 , presented larger aggregate sizes and were more responsive
to changes of shear rate than the responses of n2 and n3 .
Although, it is expected that blood samples with higher
platelet counts achieve larger aggregates, the proportion of such
relationship is not straightforward. For example, the aggregate
from n1 presented double the size of the aggregate from n2
despite having an approximately 30% count value.
Fig. 7 illustrates the proportion of the aggregation responses
presented in Fig. 6, normalized by their corresponding platelet
counts. Interestingly, although the initial aggregation response
from the different donors varied widely, the final aggregate size
of all donors appeared to converge near to y(t) = 2000 μm2 .

1724

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Fig. 6. Interdonor platelet aggregation response. y(t) is the measured aggregate size, for donors in Table II, in response to the dynamic sequence of shear
rate u(t).
Fig. 8. Fit of model to interdonor experimental data. y is the platelet aggregation obtained experimentally for each donor in Fig. 6. y m is the output of the
calculated model for each donor.

TABLE III
INTERDONOR VARIATION OF MODEL PARAMETERS

n1 *
n2
n3

Fig. 7. Aggregation responses for donors n 1 to n 4 normalised by their respective platelet count (PLT).

n4

∗
∗

Another evident observation in Fig. 7 is the presence of a timevarying effect on the aggregation response, where the initial
transients resulted in smaller aggregates than subsequent ones.
Fitting of the experimental results obtained in this section was
carried out as described in Section IV-C. Simulation of the estimated models for each experiment, presented in Fig. 8, demonstrate the ability of the model to represent the biomechanical
dynamics of the aggregation experiments. As observed in Fig. 8
and Table III, all experimental results were well approximated
by the fitted models (R2 > 0.8 in all cases).
The calculated time-varying function c(t) for each experiment
is shown in Fig. 9. Such functions are in agreement with the
time-varying effect observed in Fig. 6, in particular in capturing
the start of the initial aggregation, as well as the time required to
reach a saturation in the response. In addition, these results
suggest that a shorter identification sequence may be required
to fully characterise the aggregation response, with all cases
presenting a minimal variation in c(t) after 30 min of the start
of the experiment.
The calculated model parameters after fitting the aggregation
responses of Fig. 6 are presented in Table III, as well as their
fitting performance as indicated by the coefficient of determination R2 . Variation between the calculated parameters for the
four donors is illustrated in Fig. 10. The differences observed in

τ

c0

c1

R2

5.6804
(4.1 × 10 −4 ) **
43.407
(3.4 × 10 −2 )
6.5337
(1.4 × 10 −3 )
6.3939
(4.7 × 10 −4 )

10.9131
(1.6 × 10 −2 )
3.2146
(1.7 × 10 −3 )
1.5175
(1.8 × 10 −3 )
3.5890
(3.5 × 10 −4 )

0.0192
(9.9 × 10 −9 )
0.0433
(1.3 × 10 −5 )
0.0250
(5.5 × 10 −6 )
0.1095
(2.8 × 10 −6 )

0.84
0.92
0.80
0.83

n 1 to n 4 are the donors whose blood characteristics are presented in Table II.
∗ Covariance of parameter (σ ).

Fig. 9. Calculated time-varying effect of the aggregation response c(t) (Eq.
(3b)) from experimental results in Fig. 6.

the aggregation responses from different donors were reflected
in the model parameters as follows.
The time constant of the system, symbolised by the model
parameter τ , presented low variation between donors n1 , n3 ,
and n4 . However, the calculated value for τ for donor n2 was
largely different and the calculated covariance for this parameter
was significantly higher. This is consistent with the aggregation
response illustrated in Fig. 8, where n2 presented a very slow

COMBARIZA et al.: NONLINEAR DYNAMIC MODELLING OF PLATELET AGGREGATION VIA MICROFLUIDIC DEVICES

Fig. 10. Interdonor variation of the estimated model parameters. τ represents
an approximation of the transient response time of platelet aggregation when
the shear rate is altered. c0 represents the proportional gain between aggregation
and shear rate. c1 represents the coefficient of regulation of the time-varying
enhancing effect c(t), as defined in Eq. (3b). f it measures the goodness-of-fit
of the estimated models, as described in 8.

response to changes of shear rate set in the microplatform, in
particular in the first 30 min of the experiment. An important
note is that the time constant of the system τ can be affected
significantly by components of the testing system including the
response time of the syringe driver and the elasticity of the
microfluidic connectors.
The initial gain between the size of the platelet aggregate
and shear rate, represented by the model parameter c0 , was also
significantly different for one of the donors. The aggregation size
obtained after the initial time delay from donors n2 , n3 , and n4
was in the range of 400 < y(t) < 800 μm2 . However, the initial
aggregation response from donor n1 was around 2800 μm2 .
Consequently, the calculated value of c0 was much larger for
donor n1 than for the other three donors.
Finally, the severity of the time-varying effect on the aggregation response, represented by the model parameter c1 , was
considerably higher for donor n4 . This reflects the fact that the
maximum aggregate size, obtained just before t = 35 min, was
almost four times larger than the aggregation obtained in the
initial transient.
In summary, this section presented the parameter variation
of the proposed model when fitting experimental results from
different blood donors. We suggest that these model parameters
have the potential to serve as an indication of platelet function in
scenarios of disturbed blood flow. This systematic approach to
extracting reduced sets of parameters from the rather complex
blood flow experiments has the potential to eventually render
these type of platforms more attractive candidates for point of
care diagnostics that can be operated and interpreted by nonspecialists.
D. Discussion
Several factors are attributed to the appearance of the observed nonlinearity in platelet aggregation response. Our hypothesis is that the aggregate grows in a linear fashion initially, in

1725

response to transport of platelets through laminar flow [21], [41].
However, as the aggregate grows and reaches the fastest flow
regions of the stenosis, it reaches a plateau in size, and instead
of continuing to grow, it continues to recruit platelets and becomes denser [12]. As the aggregate grows, it changes the blood
flow dynamics, and particle-to-particle interactions, and forms
a vortex downstream, which starts enhancing the transport of
platelets to the aggregate [42] (See SI Appendix 2, which shows
Computational Fluid Dynamics simulations demonstrating the
appearance of a flow vortex proximal to the aggregate after it
reaches a critical size, available at http://ieeexplore.ieee.org). In
addition, it is possible that other biochemical mechanisms, such
as ATP mediated activation, contribute to the amplification of
the aggregation response over time. To further understand this
phenomenon, it is suggested that methods to measure the calcium flux [3] and other chemical gradients be integrated into the
microplatform in future studies.
All experiments carried out in this study utilized blood samples treated with both purinergic receptor antagonists, COX-2
antagonist and hirudin to inhibit thrombin activity. The dynamic
nature of the steady state observed in this study reflects the wellcharacterized reversibility of platelet aggregation when P2Y12
signalling is blocked. Previously published data using an equivalent microfluidic system have demonstrated that the unstable
aggregation in the device is dependent on both GP1b binding to
vWF and adhesion mediated by integrin IIbIIIa, with blockade
of either resulting in no aggregation in the device. Our underlying hypothesis is that initial platelet capture is mediated by GPb
engagement of vWF while the aggregate is dependent on IIbIIIa
to partially stabilise the aggregate under flow. Two possibilities
exist; either IIbIIIa binding in its low affinity state is sufficient
to transiently stabilise formed aggregates, or mechanical activation of platelets through an integrin outside-in mechanism leads
to an intermediate affinity change of the integrin which is sufficient to transiently stabilize aggregates under shear. Preliminary
unpublished observations examining platelet Ca2+ flux suggest
that platelets in aggregates in the device are in a reversible or
intermediate state of activation.
The model presented here will be used for the development
of control systems able to regulate the size of the platelet aggregate in the microplatform through the manipulation of shear
rate. This will allow the optimization of the sequence needed to
fully characterize the dynamics of the type of blood being tested,
and therefore minimise the time require to perform evaluation of
platelet function. In this way, the random sequence of one hour
duration presented in this paper, will be reduced by a control
system to shorter optimal time on the order of minutes. These
control systems could also have application in automatic screening of newly developed antithrombotic treatments considering
dynamic ranges of shear rate experienced by the platelets.

VI. CONCLUSION
We have proposed a nonlinear dynamic model of platelet
aggregation in response to shear rate microgradients, in a microfluidic device mimicking a stenotic flow. In order to isolate
the main biomechanical response, the main chemical agonists of
platelet activation were inhibited (TXA2, ADP and thrombin).

1726

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

The model comprises of only three parameters which represent:
the time constant response to shear rate τ ; initial proportional
gain between platelet aggregate size and shear rate c0 ; and a
coefficient regulating the enhancing effect of nonlinear microrheological events and non targeted soluble agonists c1 . The
model was able to approximate the dynamics of platelet aggregation in response to dynamic shear rate of blood samples from
four donors. It was suggested that the parameters of the proposed
model have the potential to represent the dynamics of platelet
function in a scenario of disturbed blood flow. The ability of
this methodology to reduce the complexity of results produced
by high throughput experimental platforms into reduced measures, offers new opportunities for microfluidic technologies in
point-of-care diagnosis of platelet function.
ACKNOWLEDGMENT
The authors would like to thank the Australian Centre for
Blood Diseases for the insights, expertise, and access to equipment and materials.
REFERENCES
[1] W. Nesbitt et al., “A shear gradient-dependent platelet aggregation mechanism drives thrombus formation,” Nat. Med., vol. 15, no. 6, pp. 665–673,
2009.
[2] S. P. Jackson et al., “Dynamics of platelet thrombus formation,” J. Thromb.
Haemost., vol. 7 Suppl 1, pp. 17–20, 2009.
[3] L. Tran et al., “Agonist-induced calcium response in single human
platelets assayed in a microfluidic device,” Anal. Biochem., vol. 341,
no. 2, pp. 361–368, 2005.
[4] C. G. Conant et al., “Using well-plate microfluidic devices to conduct
shear-based thrombosis assays,” JALA–J. Lab. Autom., vol. 16, no. 2,
pp. 148–152, 2011.
[5] C. G. Conant et al., “Well plate microfluidic system for investigation of
dynamic platelet behavior under variable shear loads,” Biotechnol. Bioeng., vol. 108, no. 12, pp. 2978–2987, 2011.
[6] E. Gutierrez et al., “Microfluidic devices for studies of shear-dependent
platelet adhesion,” Lab Chip, vol. 8, no. 9, pp. 1486–1495, 2008.
[7] A. Kantak et al., “Platelet function analyzer: Shear activation of platelets
in microchannels,” Biomed. Microdevices, vol. 5, no. 3, pp. 207–215,
2003.
[8] R. R. Hansen et al., “High content evaluation of shear dependent platelet
function in a microfluidic flow assay,” Ann. Biomed. Eng., vol. 41, no. 2,
pp. 250–262, 2013.
[9] B. Prabhakarpandian et al., “Microfluidic devices for modeling cellcell
and particlecell interactions in the microvasculature,” Microvasc. Res.,
vol. 82, no. 3, pp. 210–220, 2011.
[10] B. Lincoln et al., “Integrated system investigating shear-mediated platelet
interactions with von Willebrand factor using microliters of whole blood,”
Anal. Biochem., vol. 405, no. 2, pp. 174–183, 2010.
[11] N. J. Kent et al., “Shear-mediated platelet adhesion analysis in less than
100 μL of blood: Toward a POC platelet diagnostic,” IEEE Trans. Biomed.
Eng., vol. 58, no. 3, pp. 826–830, Mar. 2011.
[12] K. Leiderman and A. Fogelson, “Grow with the flow: A spatial-temporal
model of platelet deposition and blood coagulation under flow,” Math.
Med. Biol., vol. 28, no. 1, p. 47, 2011.
[13] A. Tokarev et al., “Continuous mathematical model of platelet thrombus
formation in blood flow,” Russ. J. Numer. Anal. Math. Model., vol. 27,
no. 2, pp. 191–212, 2012.
[14] Z. Xu et al., “Study of blood flow impact on growth of thrombi using a
multiscale model,” Soft Matter, vol. 5, no. 4, pp. 769–779, 2009.
[15] A. Fogelson and R. Guy, “Immersed-boundary-type models of intravascular platelet aggregation,” Comput. Meth. Appl. Mech. Eng., vol. 197,
no. 25–28, pp. 2087–2104, 2008.
[16] E. Sorensen et al., “Computational simulation of platelet deposition and
activation: I. Model development and properties,” Ann. Biomed. Eng.,
vol. 27, no. 4, pp. 436–448, 1999.

[17] E. Sorensen et al., “Computational simulation of platelet deposition and
activation: II. Results for Poiseuille flow over collagen,” Ann. Biomed.
Eng., vol. 27, no. 4, pp. 449–458, 1999.
[18] V. Zarnitsina et al., “A mathematical model for the spatio-temporal dynamics of intrinsic pathway of blood coagulation. i. the model description,”
Thromb. Res., vol. 84, no. 4, pp. 225–236, 1996.
[19] V. Zarnitsina et al., “A mathematical model for the spatio-temporal dynamics of intrinsic pathway of blood coagulation. ii. results,” Thromb.
Res., vol. 84, no. 5, pp. 333–344, 1996.
[20] Y. Nemerson and V. Turitto, “The effect of flow on hemostasis and thrombosis,” Thromb. Haemost., vol. 66, no. 3, p. 272, 1991.
[21] F. Tovar-Lopez et al., “A microfluidics device to monitor platelet aggregation dynamics in response to strain rate micro-gradients in flowing
blood,” Lab Chip, vol. 10, no. 3, pp. 291–302, 2010.
[22] K. Hosokawa et al., “A novel automated microchip flow-chamber system to quantitatively evaluate thrombus formation and antithrombotic
agents under blood flow conditions,” J. Thromb. Haemost., vol. 9, no. 10,
pp. 2029–37, 2011.
[23] T. V. Colace et al., “Thrombus growth and embolism on tissue factorbearing collagen surfaces under flow role of thrombin with and without
fibrin,” Arterioscler. Thromb. Vasc. Biol., vol. 32, no. 6, pp. 1466–1476,
2012.
[24] D. C. Karnopp et al., System Dynamics: Modeling, Simulation, and Control of Mechatronic Systems. New York, NY, USA: Wiley, 2012.
[25] M. Combariza et al., “Four-stage mechanistic model of dynamic platelet
aggregation in a microfluidic chip,” in Proc. Sixteenth Micro. Total Anal.
Syst. Okinawa, Japan: Chemical and Biological Microsystems Society,
Oct. 2012, pp. 1564–1566.
[26] L. Ljung, System identification: Theory for the user, 1999.
[27] L. Ljung, System Identification. New York, NY, USA: Wiley Online Library, 1999.
[28] S. Su et al., “Identification and control for heart rate regulation during treadmill exercise,” IEEE Trans. Biomed. Eng., vol. 54, no. 7,
pp. 1238–1246, Jul. 2007.
[29] T. Cheng et al., “Nonlinear modeling and control of human heart rate
response during exercise with various work load intensities,” IEEE Trans.
Biomed. Eng., vol. 55, no. 11, pp. 2499–2508, Nov. 2008.
[30] H. Wei et al., “Model estimation of cerebral hemodynamics between
blood flow and volume changes: A data-based modeling approach,” IEEE
Trans. Biomed. Eng., vol. 56, no. 6, pp. 1606–1616, Jan. 2009.
[31] D. Ludvig et al., “Identification of time-varying intrinsic and reflex joint
stiffness,” IEEE Trans. Biomed. Eng., vol. 58, no. 6, pp. 1715–1723, Feb.
2011.
[32] M. E. Combariza et al., “Modeling of dynamic platelet aggregation in
response to shear rate micro-gradients in a microfluidics device,” in Proc.
IEEE Biosig. Biorob. Conf., Rio de Janeiro, Brazil, 2013, pp. 1–5.
[33] J. Sjöberg et al., “Nonlinear black-box modeling in system identification: A unified overview,” Automatica, vol. 31, no. 12, pp. 1691–1724,
1995.
[34] S. Dopheide et al., “Shear-dependent tether formation during platelet
translocation on von Willebrand factor,” Blood, vol. 99, no. 1,
pp. 159–167, 2002.
[35] J. Dennis and R. Schnabel, Numerical Methods for Unconstrained Optimization and Nonlinear Equations. Philadelphia, PA, USA: SIAM, 1987,
vol. 16.
[36] T. F. Coleman and Y. Li, “On the convergence of interior-reflective Newton
methods for nonlinear minimization subject to bounds,” Math. Program.,
vol. 67, no. 1–3, pp. 189–224, 1994.
[37] T. F. Coleman and Y. Li, “An interior trust region approach
for nonlinear minimization subject to bounds,” SIAM J. Optim.,
vol. 6, no. 2, pp. 418–445, 1996.
[38] L. Ljung, “Perspectives on system identification,” Annu. Rev. Control,
vol. 34, no. 1, pp. 1–12, 2010.
[39] M. Maxwell et al., “Identification of a 2-stage platelet aggregation process
mediating shear-dependent thrombus formation,” Blood, vol. 109, no. 2,
pp. 566–576, 2007.
[40] B. Hechler et al., “A role of the fast ATP-gated P2X1 cation channel
in thrombosis of small arteries in vivo,” J. Exp. Med., vol. 198, no. 4,
pp. 661–667, 2003.
[41] F. J. Tovar-Lopez et al., “Structural and hydrodynamic simulation of an
acute stenosis-dependent thrombosis model in mice,” J. Biomech., vol. 44,
no. 6, pp. 1031–1039, 2011.
[42] F. J. Tovar-Lopez et al., “An investigation on platelet transport during
thrombus formation at micro-scale stenosis,” PloS one, vol. 8, no. 10,
p. e74123, 2013.

COMBARIZA et al.: NONLINEAR DYNAMIC MODELLING OF PLATELET AGGREGATION VIA MICROFLUIDIC DEVICES

Miguel E. Combariza (M’10) received the B.Eng.
(Hons.) and Ph.D. degrees from RMIT University,
Melbourne, Australia, in 2009 and 2014, respectively.
He is currently a Research Officer with the School
of Electrical and Computer Engineering of RMIT
University. He has worked with the Microelectronics
and Materials Technology Centre of RMIT University (now MicroNano Research Facility) since 2009,
where he has developed automated electronic control systems for optical communication devices and
for point-of-care health diagnostic technologies. His
research interests include modeling, control systems, and microplatform development for biomedical applications. He is a Member of the IEEE.

Xinghuo Yu (M’92–SM’98–F’08) received the
B.Eng. and M.Eng. degrees from the University of
Science and Technology of China, Hefei, China, in
1982 and 1984, respectively, and the Ph.D. degree
from Southeast University, Nanjing, China, in 1988.
He is currently with RMIT University (Royal Melbourne Institute of Technology), Melbourne, VIC,
Australia, where he is the Founding Director of
RMITs Platform Technologies Research Institute.
His research interests include variable structure and
non-linear control, complex and intelligent systems
and networks, and industrial applications. He received a number of awards for
his achievements, including the 2013 Dr.-Ing. Eugene Mittelmann Achievement Award of IEEE Industrial Electronics Society and 2012 IEEE Industrial
Electronics Magazine Best Paper Award. He is serving Vice-President for Publications (2012–2015) and an IEEE Distinguished Lecturer of IEEE Industrial
Electronics Society. He is a Fellow of the IEEE.

1727

Warwick Nesbitt received the Ph.D. degree in biochemistry and molecular biology from Monash University, Melbourne, VIC, Australia, in 1998.
He has worked in both academic and commercial sectors, across hematology, drug development
and medical device R&D. Dr Nesbitt was a Senior
Research Fellow within the Australian Centre for
Blood Diseases (ACBD), Monash University where
he was involved in research projects applying lab-onchip microfluidic technologies to the investigation of
platelet mechano-biology and function.
Arnan Mitchell (M’98) received the Ph.D. degree
from RMIT University, Melbourne, VIC, Australia,
in 1999.
He is currently the Leader of the Microplatforms
Research Group, Platform Technologies Research Institute, RMIT University, and a Chief Investigator
with the Australian Research Council Centre of Excellence for Ultrahigh bandwidth Devices for Optical
Systems. He works closely with a large team of early
career researchers working toward research in a broad
range of fields including integrated optics, lab-on-achip platforms, microwave photonics, radio frequency microplatforms, functional materials, and microsystems. He is a Member of the IEEE.
Francisco J. Tovar-Lopez received the B. Eng. degree in mechanical engineering from the National Autonomous University of Mexico, Mexico City, Mexico, in 2004, and the Ph.D. degree in biomedical engineering from RMIT University, Melbourne, VIC,
Australia, in 2011.
He has experience working internationally as a
mechanical engineer in the biomedical industry. He is
currently a postdoctoral fellow at the Microplatforms
Research Group, Platform Technologies Research Institute, RMIT University. His research interests include fluid mechanics, biomechanics, microfabrication, transport phenomena,
and microrheology.

