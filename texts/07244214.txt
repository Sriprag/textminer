850

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, APRIL 2016

Automatic Classification of the Vestibulo-Ocular
Reflex Nystagmus: Integration of Data Clustering
and System Identification
Mina Ranjbaran∗ , Student Member, IEEE, Heather L. H. Smith, and Henrietta L. Galiana, Fellow, IEEE

Abstract—The vestibulo-ocular reflex (VOR) plays an important
role in our daily activities by enabling us to fixate on objects
during head movements. Modeling and identification of the VOR
improves our insight into the system behavior and improves
diagnosis of various disorders. However, the switching nature of
eye movements (nystagmus), including the VOR, makes dynamic
analysis challenging. The first step in such analysis is to segment
data into its subsystem responses (here slow and fast segment
intervals). Misclassification of segments results in biased analysis
of the system of interest. Here, we develop a novel three-step
algorithm to classify the VOR data into slow and fast intervals automatically. The proposed algorithm is initialized using a K-means
clustering method. The initial classification is then refined using
system identification approaches and prediction error statistics.
The performance of the algorithm is evaluated on simulated and
experimental data. It is shown that the new algorithm performance
is much improved over the previous methods, in terms of higher
specificity.
Index Terms—Classification algorithm, data clustering, nystagmus, system identification, vestibulo-ocular reflex.

I. INTRODUCTION
HE vestibulo-ocular reflex causes involuntary eye movements that stabilize retinal images during head movements.
The reflex consists of slow compensatory eye movements, usually but not always in the opposite direction to head rotation, and
fast reorienting eye movements usually but again not always in
the same direction as the head movement. The switching mechanism between the slow and fast phases is a result of burst neuron
activities in the brainstem. Switching keeps the eyes within the
orbital margin during gaze stabilization. Fig. 1 shows an example of recorded conjugate angular eye position (average of
the left and right eye position) and eye velocity during 1/6 Hz
sinusoidal head rotation in the dark, using electrooculography
(EOG). Sample slow and fast phase segments are marked with
dashed black and dashed gray rectangles in Fig. 1.
The first step in analyzing VOR data is to segment slow and
fast phases since they have distinct characteristics, preferably
objectively. It is common in the literature to remove the fast

T

Manuscript received February 10, 2015; revised August 27, 2015; accepted
August 28, 2015. Date of publication September 7, 2015; date of current version
March 17, 2016. This work was supported by the Canadian Institutes of Health
Research, Natural Sciences and Engineering Research Council.
* M. Ranjbaran is with the Department of Biomedical Engineering, 3775 University, Montreal, QC, H3A 2B4, Canada (e-mail: mina.
ranjbaranhesarmaskan@mail.mcgill.ca).
H. L.H. Smith and H. L. Galiana are with the Department of Biomedical
Engineering.
Digital Object Identifier 10.1109/TBME.2015.2477038

Fig. 1. VOR in response to sinusoidal head rotation recorded with EOG.
(a) Conjugate eye position and scaled head position (deg). (b) Conjugate eye
velocity and scaled head velocity (deg/s). Sample slow and fast phase segments
are marked with dashed black and dashed gray rectangles, respectively.

phases from the eye velocity data and use envelope approaches
to analyze the dynamics, i.e., replacing the removed data using
interpolation—this envelope defines VOR dynamics. However,
this ignores the effects of variable initial conditions (IC) due to
the switching on each segment. Since the system dynamics are
slow, the effect of these ICs does not die away quickly in a given
segment. Worse, the duration of the slow segments is usually
much shorter than the time constants of the slow phase system.
So if the ICs are ignored in an analysis, estimation of the VOR
dynamics is biased [1], [2]. Moreover, misclassification of the
nystagmus segments also results in biased identification of slow
(or fast) dynamics.
Prior methods for the classification of nystagmus were not
very objective—they relied on a-priori assumptions such as:
forcing the slow phase eye velocity segments to belong to an
envelope resembling the profile of head velocity [3] and data
segregation according to eye trajectories such as direction relative to the head and velocity thresholds [4], [5] or according
to reduced model predictions [6]. However, these methods require professional operator interaction to either correct misclassification, or manually adjust thresholds that can vary across
subjects and records. Instead, Ghoreyshi and Galiana [7] developed a method, GNL-HybELS (hybrid extended least squares)
where classification and identification are automatic; to initialize

0018-9294 © 2015 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

RANJBARAN et al.: AUTOMATIC CLASSIFICATION OF THE VESTIBULO-OCULAR REFLEX NYSTAGMUS

this iterative algorithm, they used generalized principal component analysis (GPCA), an unsupervised subspace segmentation
method. However, the performance of the GPCA method deteriorates rapidly with noise. Hence, in some VOR records, it
fails to provide an initial classification to start the process and
its convergence is not guaranteed.
Other methods focus on detection of saccades, because saccade research is the goal, or the assumption that remaining
segments are presumed slow phases. Recent saccade detection
algorithms use adaptive thresholds on eye velocity or acceleration profiles [8]–[10], using the statistical distribution of the
decision signal. Although selection of thresholds in these methods is automatic, there are several fixed parameters and criteria
that can vary between subjects and experimental conditions,
e.g., enforcing minimum saccade duration thresholds. Hence,
there remains a strong reliance of expert adjustment of such
algorithms. These methods have been tested during pursuit eye
movements, but not during more complex eye movements such
as active or passive head rotations, e.g., VOR nystagmus. Moreover, the efficiency of these methods has not been validated in
vestibular patients. This being said, whether detecting saccades
or slow phases, a VOR classification is more robust and accurate
if based on current dataset characteristics, rather than presumed
uniform properties.
In this study, we have developed a new method to classify
and identify VOR data which is totally objective (no subjective
parameter values). We emphasize as a goal: classification of slow
phase segments with a minimum number of false positives. The
initial classification pass is based on K-means cluster analysis,
an algorithm to group objects based on features into k groups
[11]. This iterative algorithm minimizes the sum of squares of
distances between data and the estimated cluster centroids [12].
The benefit of such an unsupervised clustering is that it does
not require setting decision thresholds for different subjects and
data records, and it is efficient, fast, and simple.
Although the K-means algorithm is a powerful classification
tool, its performance is not optimum in the case of noisy data.
Filtering the noisy data heavily does not help, instead introduces
classification errors around the switching points. Therefore, we
use K-means only for initialization of the classification algorithm (step 1) and then use system identification and prediction
errors to refine the classification (steps 2 and 3). Thus, classification relies on both the dynamics and statistics of the eye
movement record at hand, which solves the problem of variability in subjects or protocols.
The proposed algorithm was first evaluated using virtual simulated VOR data. Robustness to noise was tested using different
Gaussian white noise sequences as well as realistic EOG noise
profiles [13]. We then applied the new algorithm to experimental VOR data recorded using EOG in the dark from both healthy
subjects and vestibular patients. In this case, the results were
compared to manual classification by an expert (the second author) and to the GNL-HybELS algorithm. The validation study
suggests that the new algorithm’s performance on experimental
data resulted in more accurate classification of the VOR data in
terms of fewer false positives compared to the former algorithm
[7]. Given more consistent slow phase clustering, identification

851

of VOR dynamics was also more robust and unbiased from the
dynamics obtained with expert classification.
It should be emphasized that although this method is tested
with EOG recordings, the algorithm itself is not dependent on the
recording approach and is applicable to data from any recording
technique, e.g., video-oculography or scleral coils.
II. METHODS AND MATERIALS
The algorithm comprises three steps. The first step is the initial
classification of the VOR nystagmus using K-means clustering.
This initial classification allows a first estimate of the dynamics
of the VOR and refinement of the classification based on the
model prediction errors, performed in two steps.
A. Data Preparation
For better visualization of the classification algorithm, we discuss the results of each step with an experimental VOR record
from a healthy subject (Figs. 3–5) during 1/6 Hz rotation in the
dark (peak velocity 200 ◦ /s). Data are recorded with EOG at
1 kHz, digitally low-pass filtered to 58 Hz and decimated to 250
Hz. Low-pass filtering to 58 Hz here is sufficient to reduce the
effect of 60-Hz electrical noise in EOG signals while preserving
the systems’ bandwidth information. If other recording methods are used, e.g., video-oculography, low-pass filtering can
be adjusted according to the noise sources in the signal. However, the bandwidth of eye movements is at least 30 Hz, which
puts a lower bound on allowed sampling rates (≥ 150 Hz) and
noise filtering cutoff (≥≈ 60 Hz)—violating these conditions
will distort and corrupt data. For details of the experimental
setup and calibration protocols, see [14]. In Fig. 3(a), the VOR
slow phases are marked as the gold standard by a highly experienced expert in the field using computer-aided protocols for
manual classification. The expert was not involved in evaluation
of the algorithm.
For validation using simulation studies, virtual VOR data are
generated using a linear version of a hybrid model of the angular
VOR [15] with Simulink (Mathworks) and sampling frequency
of 1 kHz. Knowing the nominal parameters of the system dynamics as well as the exact switching instances between fast
and slow modes allows precise evaluation of the classification
algorithm.
The added noise sequences to virtual VOR data are either
white Gaussian or realistic, i.e., the latter neither white nor
Gaussian. This is done by replicating the noise profiles found
in a noise analysis study in [13], which incorporates the electrical noise in EOG recordings, random small spikes akin to
microsaccades and larger spikes due to blinks. Virtual data are
preprocessed like the experimental data, i.e., digitally low-pass
filtered to 58 Hz and decimated to 250 Hz.
B. Identification Method
The model formulation assumed for the VOR slow phase
system is described with a cascade of two blocks (see Fig. 2)
[16]. To summarize: the first block is a high-pass filter with a
time constant of Tv (s) to represent the processed sensory stage

852

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, APRIL 2016

Fig. 2. Assumed structure of the slow phase VOR. Ḣ is head velocity (deg/s),
Ḣ c is the processed sensory signal (spikes/s), and E is conjugate eye position
(deg).

that includes both the transducer and intermediate processing
in the brainstem; the second block represents the VOR central
processing in the brainstem that projects to motoneurons and
includes the eye plant, with low-pass first-order dynamics (gain
g and time constant TN I ). We search for Tv in the range of 2–20
s and estimate the ICs and the unknown parameters (g, TN I )
for the second stage using the subspace identification method
(details in [16]).
If multiple datasets are selected (e.g., slow phase intervals),
ICs for each experiment (interval) are estimated separately,
while forced dynamics are kept in common [16]. Assuming
first-order dynamics for the conjugate VOR after the first stage,
I
E0 + noise, where E0 is the IC
then E = T N Igs+1 Ḣc + T NTINs+1
at each slow phase segment and Ḣc (spikes/s) is the processed
sensory signal.
The VOR, particularly in patients, often has a bias due to
asymmetric resting rates in the neural circuitry as well as asymmetries in processing at each stage (sensor/central). Hence, the
sensory description is expanded to include a bias term. Therefore, the state–state representation of our model is
⎧



R
g 
−1
⎨
1 Ḣc + Ke(t)
x(t) +
ẋ(t) =
TN I
TN I TN I
⎩
E = x(t)
(1)
where R represents the sensory bias term, which could be directionally sensitive especially in vestibular patients.
C. Evaluation of the Performance
To evaluate the performance of the classification method,
we calculate the sensitivity and the specificity of the results
[17]. Both sensitivity and specificity values vary in the range of
[0 − 1], where a value close to one is desirable. In other words,
⎧
TP
⎪
⎪sensitivity =
⎨
TP + FN
(2)
⎪
TN
⎪
⎩specificity =
TN + FP
where
⎧
TP: true positive ⇒ correctly marked slow phase
⎪
⎪
⎪
⎪
⎪
⎨TN: true negative ⇒ correctly marked nonslow phase
⎪
FP: false positive ⇒ wrongly marked slow phase
⎪
⎪
⎪
⎪
⎩
FN: false negative ⇒ wrongly marked nonslow phase.
(3)

Sensitivity and specificity are standard measures in evaluating
classification methods. In addition, a classification tool with
fewer false positives is of more interest to study VOR data,
since misclassification of the nonslow phase samples results in
biased identification of the VOR dynamics. Therefore, a higher
specificity value, or lower fall-out value, i.e., (1 − specif icity)
is desirable.
D. Classification Algorithm
1) Step 1 (Initial Classification): The K-means algorithm iteratively clusters data into k groups to minimize within-cluster
variability. In this study, we used the K-means algorithm implemented in the statistics toolbox of MATLAB (The MathWorks
Inc., Natick, MA, USA). An appropriate candidate for K-means
is the VOR velocity signal (deg/s). The velocity profile of VOR
nystagmus resembles the head velocity profile in opposite direction during the slow phase segments that are interrupted by
high velocity peaks during the fast phase intervals. In order to
segment the eye velocity signal into k = 2 clusters, the input
to the K-means algorithm is selected as: Ė × sign(Ḣ), where
Ė (deg/s) is the eye velocity and Ḣ (deg/s) is the head velocity,
and sign(.) simply represents the sign function [see Fig. 3(b)].
Normalizing the eye velocity signal, Ė, with respect to the sign
of Ḣ cancels the effect of direction of rotation. With K-means,
the initial classification of the VOR nystagmus is obtained without using any decision thresholds [see Fig. 3(c)]. It should be
noted that if there are any blinks in the EOG recording, they are
removed from the slow phase data after this step.
Although K-means successfully clusters the VOR nystagmus
into slow and fast segments, its performance is not always optimal based on the velocity profile. In real VOR data, fast phases
may occur with short durations or very low velocity, sometimes
zero velocity [18]. ICs at each switching point modify the fast
phase trajectory in addition to its goal. For instance, if at the
switching point, the starting point is already the goal point,
then the trajectory would be a constant value at the goal, i.e.,
a zero velocity trajectory. Therefore, short or low velocity saccadic movements may be buried in the noisy velocity signal and
misclassified by K-means, as pointed out in Fig. 3(c). In this
sample VOR record (see Fig. 3), classification with K-means
results in a sensitivity of 1 and specificity of 0.63; hence, the
initial classification must be refined to improve the specificity.
2) Step 2 (Refining the Classification With Estimation
of the Vestibular Time Constant): Before full identification of
the VOR dynamics (see Fig. 2), the slow phase segments marked
in the previous step are fitted with a first-order low-pass system (with Ḣ as the input and E as the output). Since the sensory stage has high-pass dynamics with an expected large time
constant [19], the overall VOR system can be approximated
with a first order low pass system. Although it is an inaccurate
model, at this stage, a simplified model is sufficient to reduce
the number of false positives. Therefore, the slow phase segments from the initial classification are pooled and a first-order
system and ICs are estimated using the state-space method described in [16]. Given the order of the system to be estimated,
the minimum length for the slow phases to be considered for this

RANJBARAN et al.: AUTOMATIC CLASSIFICATION OF THE VESTIBULO-OCULAR REFLEX NYSTAGMUS

identification is set to seven samples, i.e., 28 ms for data at 250
Hz. Segments that are less than this length are discarded for this
identification.
The estimated first-order model is then used to compute the
p-step ahead prediction on the entire VOR record, i.e., slow/fast
segments. In general, to predict the model response p steps into
the future (p ≥ 1) from the current time t, one requires the input
up to time (t + pTs ) and outputs up to time t. The prediction
horizon, p, corresponds to predicting output at time pTs , where
Ts is the sampling interval in seconds.
Here, we used the implementation of the prediction function,
predict(model,data,p). For data at 250 Hz, a p = 4 step ahead
prediction of the response [see Fig. 4(a)] to head velocity provides a 16-ms forward horizon. The predicted response follows
the slow phases closely but deviates during the fast phases due to
switching and the fact that fast phases have different dynamics
than those estimated to fit slow phases. The difference between
the eye position signal and the prediction, the residual signal, is
shown in Fig. 4(b). We use the residual as the decision signal
since its values during the slow phases are small with large peaks
during the fast phases. As the prediction signal is obtained from
a reduced model order, i.e., a first-order model, the residual signal during the slow phases is not white and shows a harmonic
component. Nevertheless, the decision threshold is selected automatically based on the distribution of the decision signal values during the slow phases marked at step 1, shown in Fig. 6(a)
and (b). The decision threshold is a percentile of this distribution
according to the receiver operating characteristic (ROC) curve
to optimize the sensitivity and specificity of the classification at
step 2 [20] [see Fig. 6(c)]. The lower and upper decision thresholds are varied from [T HRl T HRu ] = [10 90] percentiles to
[1 99] percentiles with steps of [−1 + 1]. Here, the optimum
decision thresholds are selected as: [T HRl T HRu ] = [4 96]
percentiles of the decision signal values during the marked slow
phases at step 1 [circled in Fig. 6(c)]. With these thresholds,
the sensitivity is greater than 0.95 and fall-out, i.e., 1 − specificity, is less than 0.15. The associated thresholds are shown as
dashed red lines on the decision signal in Fig 4(b). In our experience, this threshold, [T HRl T HRu ] = [4 96], appears to
be the optimum value regardless of the head rotation profile or
noise level, whether tested with simulation data or experimental
data marked by experts.
The initial classification is refined by accepting the data samples of the decision signal that fall between the lower and the
upper threshold:


slow phase,
if T HRl ≤ decision signal ≤ T HRu
nonslow phase,

otherwise.

(4)
The result of this classification (step 2) is shown in Fig. 4(c)
for the VOR data record of Fig. 3(a). Previous misclassified
points are now marked correctly, but there still remain a few fast
phases marked as slow phases (false positives) as pointed out in
Fig. 4(c).
In order to optimize the sensitivity and specificity of the classification method, a final refining step is performed where instead
of a reduced model order, a more realistic structure is estimated

853

on this improved classification. Therefore, as in [16], the refined
classification of step 2 is used to search for the sensory processing time constant, Tv . To summarize, the head velocity input
signal, Ḣ, is filtered through a unity gain high-pass filter with a
variable time constant, Tv , over the range [2 s 20 s] reported in
experimental studies [21], using increments of 1 s. The filtered
Ḣ, now the processed sensory signal Ḣc (spikes/s), is then
used as the input signal to the identification problem to estimate
g and TN I of the central stage as well as the ICs. Finally, we
compare the goodness of fit to data for the different Tv and
accept the value that results in the best fit.
3) Step 3 (Final Classification and Identification of VOR
Segments Dynamics): We now repeat step 2 with the optimal
canal signal (with selected Tc ) as the VOR input to the second
dynamic component in Fig. 2. Based on data from the refined
classification of step 2, we estimate again the VOR dynamics
and the ICs [16].
Finally, the estimated model in Fig. 2 is used to compute an
updated p-step ahead prediction on the entire VOR data. Similar
to step 2, we select p = 4 as the prediction horizon for data at 250
Hz. The decision signal is again defined as the residual signal
[see Fig. 5(a)]. Unlike the decision signal in Fig. 4(b), the residual signal no longer has a harmonic baseline during the slow
phases—increasing the model complexity has improved identification of the dynamics. The decision thresholds are again
chosen based on the distribution of the decision signal during
the slow phase segments marked at step 2 [see Fig. 7(a) and (b)].
According to the ROC curve [see Fig. 7(c)], the optimum decision thresholds are selected as [T HRl T HRu ] = [1 99] percentiles of the decision signal that provide a sensitivity greater
than 0.91 and fall-out, i.e., 1 − specificity, less than 0.03. As in
(4), data points are accepted as slow phase if the value of the
decision signal falls between the upper and lower threshold [see
Fig. 5(a) and (b)].
The final refining step results in a classification of the VOR
nystagmus into segments that have similar dynamical properties
during slow phases. We name this algorithm three-step classification summarized in Table I.
III. CLASSIFICATION RESULTS
The proposed algorithm is evaluated with virtual data and
experimental VOR data from our archive (see Section II). The
algorithm is implemented in MATLAB (The MathWorks Inc.,
Natick, MA, USA).
A. Validation by Simulation
In clinical tests, it is very common to use low-frequency
sinusoidal head rotation to evaluate the VOR. It should be noted
that a low-frequency sinusoidal input may seem insufficient as a
persistently exciting input for dynamic identification. But here,
the switching mechanism increases the effective bandwidth of
the input due to new random ICs at every switching instance.
We simulate two rotation profiles: sinusoidal rotation at 1/6 Hz
with 210 ◦ /s peak velocity—typical clinical profile; and rotation
based on a sum of three sinusoids (1/6,1/5, and 3/7 Hz) with

854

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, APRIL 2016

Fig. 3. Experimental VOR data at 250-Hz sampling rate, during 1/6 Hz rotation with peak velocity of 200 ◦ /s. (a) VOR slow phases marked by an expert. (b)
Input signal to the K-means algorithm. (c) VOR slow phases marked by the K-means algorithm (step 1). Red arrows point to misclassified intervals.

Fig. 4. Experimental VOR data from Fig. 3, at step 2 of classification. (a) Eye position and four step ahead prediction from the first-order model identified in
step 2. (b) Decision signal obtained as the difference between the eye position signal and the prediction signal with decision thresholds (dashed red lines). (c) VOR
slow phases marked at step 2. Misclassified intervals are denoted with red arrows.

Fig. 5. Experimental VOR data from Fig. 3, at step 3 of classification. (a) Decision signal obtained as the difference between the eye position signal and the
prediction signal with decision thresholds (dashed red lines) at step 3. (b) VOR slow phases marked at step 3. Blue arrows point to the segments that are now
correctly classified.

RANJBARAN et al.: AUTOMATIC CLASSIFICATION OF THE VESTIBULO-OCULAR REFLEX NYSTAGMUS

Fig. 6. Decision threshold selection at step 2. (a) Normalized histogram of the
decision signal values during the slow phases marked at step 1. (b) Cumulative
histogram and its [4 96] percentiles (gray dashed lines). (c) ROC curve of
the classifier performance at step 2 based on alternate decision thresholds in
percentile range from [10 90] to [1 99]. The circled point is the [4 96] point
where the sensitivity is greater than 0.95 and fall-out is less than 0.15.

Fig. 7. Decision threshold selection at step 3. (a) Normalized histogram of the
decision signal values during the slow phases marked at step 2. (b) Cumulative
histogram and its [1 99] percentiles (gray dashed lines). (c) ROC curve of the
classifier performance at step 3 based on decision thresholds from [10 90] to
[1 99] percentiles. The circled point is the [1 99] point where the sensitivity is
greater than 0.91 and fall-out is less than 0.03.

peak velocity of 195 ◦ /s, to provide a pseudorandom profile.
The model is simulated at 1 kHz for 60 s in each case. The
nominal values for the slow phase model [15] are T = 5.00 s
and g = −4.98. The vestibular time constant is set to Tv = 6 s.
Data preparation is discussed in Section II-A.
First, we show the effect of misclassification of the VOR data
on its identified dynamics. For this purpose, given the perfect
classification flags available from simulations, we consider two
cases of intentional misclassification in slow phase data with
realistic additive noise. In the first case, one fast phase segment

855

is selected randomly and is marked as slow phase intentionally.
In the second case, ten slow phase segments (out of 201 segments) are selected randomly and two samples before and after
the switching instances are also added to the slow phase segment, i.e., the switching instants are misclassified. Both these
cases are repeated 100 times and the slow phase system is identified for each. The Bode plots for the 100 identified systems are
plotted in Fig. 8 (gray curves) as well as the nominal bode plot
of the system (black). It was shown previously that given perfect nystagmus classification, the identification algorithm [16]
provides unbiased estimation of the slow phase dynamics with
the same noise characteristics. Now, it can be seen how misclassification of slow phase data can result in considerably biased
identification of the dynamics, especially when fast phases are
included as slow phase data [see Fig. 8(a)]. This simple example
emphasizes the importance of a reliable classification with a low
misclassification rate, i.e., higher specificity.
The three-step classification is now applied to segment the
two simulated VOR datasets with 100 realistic noise sequences
in a Monte–Carlo approach. Fig. 9 shows the sensitivity and
specificity of the classification at each step, together with their
95% confidence intervals. Improvement in classification with
each step is clear. The K-means algorithm initially results in segmenting data with a high sensitivity but low specificity. Refining
the classification with a reduced model increases the specificity
at the cost of lower sensitivity. Finally, refining according to a
complete model formulation, i.e., including the sensory stage
dynamics, results in improvement in both the sensitivity and
specificity of the classification.
The robustness of the three-step classification to noise level
is tested by performing 100 Monte–Carlo tests in each of the
following four cases using the two virtual datasets (1/6 Hz and
sum of three sinusoids):
1) Case 1: Realistic output noise for EOG, SNR =
31 dB.
2) Case 2: White Gaussian output noise, SNR = 30 dB.
3) Case 3: White Gaussian output noise, SNR = 20 dB.
4) Case 4: White Gaussian output noise, SNR = 10 dB.
The results are then compared with the earlier GNL-HybELS
approach. The final results for each case are presented in terms
of the sensitivity and specificity values as well as the 95% confidence intervals for both methods (see Fig. 10). On average, the
three-step classification shows higher sensitivity and slightly
higher specificity in low noise levels, i.e., cases 1, 2, and 3,
compared to the GNL-HybELS method. However, at higher
noise levels, the three-step method performs significantly better
than the GNL-HybELS for the first dataset (see Fig. 10(a), case
4). For the second dataset with a more complex input bandwidth, the GNL-HybELS method failed to provide any initial
classification with higher additive noise levels (see Fig. 10(b),
case 4). The three-step method is more accurate and robust in
the presence of noise at least with simulated nystagmus.
B. Validation With Experimental Gold Standard
For the purpose of evaluating the performance of the threestep classification on experimental data, we used seven VOR

856

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, APRIL 2016

TABLE I
SUMMARY OF THE THREE-STEP VOR NYSTAGMUS CLASSIFICATION
Step 1

Step 2

Step 3

• Obtain initial classification using K-means.
• Estimate a reduced order model of slow segments.
• Calculate the model p step ahead prediction in the entire VOR record.
• Decision signal: prediction residual.
• Decision threshold:[T H R l T H R u ] = [4 96] percentiles of the decision signal value during slow segments from step 1.
• Label slow phase if T H R l ≤ decision sig n al ≤ T H R u
• Estimate the sensory time constant T v .
• Estimate VOR slow dynamics including the sensory dynamics from step 2.
• Calculate the model p step ahead prediction for the entire VOR record.
• Decision signal: prediction residual.
• Decision threshold: [T H R l T H R u ] = [1 99] percentiles of the decision signal value during slow segments from step 2.
• Label slow phase if T H R l ≤ decision sig n al ≤ T H R u

Fig. 8. Bode plot of 100 systems (gray) estimated from the same VOR data
record with intentional misclassification compared to the nominal system’s bode
plot (black). (a) Case 1: one fast phase segment is randomly misclassified. (b)
Case2: Two samples before and after the switching instances are marked slow
phase in ten segments.

Fig. 9. Sensitivity and specificity of each classification step tested on two
simulated datasets with 100 Monte–Carlo realistic noise realization. (a) Head
rotation at 1/6 Hz. (b) Head rotation with sum of three sinusoids (1/, 1/5, and
3/7 Hz). Black bars show the 95% confidence interval of results.

records obtained with EOG sensors from four healthy subjects
(data1 to data7 ) and three VOR records from two patients with
unilateral partial vestibular lesions (data8 to data10 ). All the
experiments were taken from our archives of former studies
(details in [14]). The second author manually marked the slow
phases in all records as the gold standard. The rotation profile
in these datasets are either 1/6 Hz rotation with 200 ◦ /s peak
velocity (6 of the VOR data) or a sum of three sinusoids with
165 ◦ /s peak velocity (4 of the VOR data).
First, we repeat the three-step sequence of analysis on real
data, just as presented in simulated cases. As above, the algorithm initialization with K-means (step 1) has a relatively
low specificity=0.62 ± 0.09 (mean±std across datasets) but
very high sensitivity=0.99 ± 0.00. The second step improves

Fig. 10. Sensitivity (sen) and specificity (spe) of three-step classification versus GNL-HybELS method, tested on two simulated datasets with 100 Monte–
Carlo noise realizations in four cases of four types (cases, see text). (a) Pure
harmonic. (b) Unpredictable sum of sines. Black bars show the 95% confidence
interval of the values. The GNL-HybELS method failed to provide classification
in case 4 of (b), deteriorating at higher noise levels.

the specificity to 0.86 ± 0.05, while the sensitivity decreases
to 0.92 ± 0.04. Finally, the final refining of the classification
results has a specificity of 0.94 ± 0.03 and sensitivity of
0.86 ± 0.04 (step 3). Therefore, in each classification step, our
method improves systematically across datasets and protocols.
Moreover, there is no significant difference in the performance
of the classification method for data from healthy (data1 to
data7 ) versus clinical subjects (data8 to data10 ), despite variable VOR profiles.
It may seem that the results from steps 2 and 3 are not significantly different. However, the higher specificity of the classification improves identification of the dynamics in experimental
data—the ultimate goal. For example, Fig. 11(a) shows that
identified Bode plots for data7 from step 3 are much closer to
those obtained from the gold standard and unbiased in the low
bandwidth compared to slow segments from step 2.
We also compared the performance of the three-step classification with the GNL-HybELS method on the experimental data. In all the available data records, the specificity of
the three-step classification (mean±std=0.93 ± 0.03) is significantly better than GNL-HybELS (0.85 ± 0.08) with pvalue =
0.013 < 0.05. The sensitivity of the three-step classification

RANJBARAN et al.: AUTOMATIC CLASSIFICATION OF THE VESTIBULO-OCULAR REFLEX NYSTAGMUS

Fig. 11. Bode diagram of the identified VOR dynamics from data 7 using
classification from the three-step method, the GNL-HybELS method, and the
manual classification. Colored shades show 3sd confidence interval on the identified system. (a) Comparing effects of the classification from step 2 and step
3 on the identified dynamics. (b) Comparing identification results from the
three-step versus GNL-HybELS final classification.

method (0.86 ± 0.04) is higher than the GNL-HybELS method
(0.80 ± 0.12), but, not significantly (pvalue = 0.16).
The effect of higher specificity of the classification in identification of the dynamics is tested again for data7 , where the
sensitivity and specificity of both methods were close. The identified slow phase dynamics from both methods are shown in
Fig. 11(b) as well as the dynamics estimated using the manual
classification. Clearly, the identified dynamics from the slow
phase segments marked by the three-step method are considerably closer to the ones from the manual classification. This
simply highlights the importance of a low false positive rate in
classification.
IV. CONCLUSION
This study introduces a new algorithm for automatic classification of the vestibulo-ocular reflex, initialized with a hands-off
clustering approach, i.e., the K-means (step 1). Although the
sensitivity of the K-means algorithm is very high, close to unity,
its specificity is low when data are contaminated with additive
noise. This is remediated by using sequential steps of prediction errors obtained from identified models and using them as
decision signals to upgrade the specificity of the classification.
Step 2 of the classification is based on estimating a reduced
model order for the slow phases. Decision thresholds are automatically selected based on the statistics of the decision signal
during marked slow phases. The updated classification of step
2 is then used to estimate more realistic models of the sensor
and switching state (see Fig. 2), which improves the detection
power of the decision signal. Thus, the final classification of
VOR nystagmus adds consistent dynamic characteristics for the
slow segments rather than simply their statistical properties as
in previous methods [8]–[10]. Thus, decision thresholds are de-

857

termined automatically, regardless of the rotation profile, noise
characteristics or health status of the subject.
The performance of the new method and its robustness to
noise is evaluated using realistic virtual data with known switching instants. The method is also tested on experimental VOR data
recorded in the dark during harmonic tests on both healthy and
unilateral vestibular patients, where manual classification by
an expert was available. Any errors in classification are shown
to bias identification of the VOR dynamics. This emphasizes
the importance of a low false negative rate in classification of
nystagmus, i.e., high specificity. The results of simulation and
experimental studies suggest that the new three-step method
provides considerable improvements over previously developed
algorithms, including unsupervised operation, guaranteed convergence, and high specificity.
In summary, the three-step method is the first automatic classification algorithm that segments slow phases from VOR data
based on both their dynamic properties and their statistical characteristics, reducing sensitivity to protocol conditions and subject state. This method can be adapted easily to segmentation
of other switching eye movements, e.g., fixation and saccade
intervals with visual input, whether the head is fixed or free.
Furthermore, the algorithm is applicable to any method of eye
recording, regardless of sampling rate, instrument resolution,
or noise properties (EOG versus video-oculography or scleral
coils). Interested readers are invited to contact authors MR or
HLG for access to the algorithms.

REFERENCES
[1] H. Galiana, “A nystagmus strategy to linearize the vestibulo-ocular reflex,”
IEEE Trans. Biomed. Eng., vol. 38, no. 6, pp. 532–543, Jun. 1991.
[2] A. Ghoreyshi and H. Galiana, “A hybrid extended least squares method
(hybels) for vestibulo- ocular reflex identification,” in Proc. Ann. Int. Conf.
IEEE Eng. Med. Biol. Soc., Sep. 2009, pp. 4958–4961.
[3] G. R. Barnes, “A procedure for the analysis of nystagmus and other eye
movements.” Aviat Space Environ Med., vol. 53, no. 7, pp. 676–682, 1982.
[4] F. Behrens and L.-R. Weiss, “An algorithm separating saccadic from nonsaccadic eye movements automatically by use of the acceleration signal,”
Vision Res., vol. 32, no. 5, pp. 889–893, 1992.
[5] S. Faucheux et al., “Automatic detection and removal of fast phases from
nystagmographic recordings by optimal thresholding,” Biomed. Signal
Process. Control, vol. 2, no. 2, pp. 144–150, 2007.
[6] C. Rey and H. Galiana, “Parametric classification of segments in ocular
nystagmus,” IEEE Trans. Biomed. Eng., vol. 38, no. 2, pp. 142–148, Feb.
1991.
[7] A. Ghoreyshi and H. Galiana, “Automatic classification and robust identification of vestibulo-ocular reflex responses: From theory to practice,” J.
Comput. Neurosci., vol. 31, no. 2, pp. 347–368, 2011.
[8] M. S. Mould et al., “A simple nonparametric method for classifying eye
fixations,” Vision Res., vol. 57, no. 0, pp. 18–25, 2012.
[9] L. Larsson et al., “Detection of saccades and postsaccadic oscillations
in the presence of smooth pursuit,” IEEE Trans. Biomed. Eng., vol. 60,
no. 9, pp. 2484–2493, Sep. 2013.
[10] F. Behrens et al., “An improved algorithm for automatic detection of
saccades in eye movement data and for calculating saccade parameters,”
Behavior Res. Methods, vol. 42, no. 3, pp. 701–708, Aug. 2010.
[11] J. MacQueen, “Some methods for classification and analysis of multivariate observations,” in Proc. 5th Berkeley Symp. Math. Statistics Probab.,
Statist., 1967, pp. 281–297.
[12] H. Spath, The Cluster Dissection and Analysis Theory FORTRAN Programs Examples. Upper Saddle River, NJ, USA: Prentice-Hall, 1985.
[13] M. Ranjbaran et al., “Analysis and modeling of noise in biomedical
systems,” in Proc. 35th Ann. Int. Conf. IEEE Eng. Med. Biol. Soc., Jul.
2013, pp. 997–1000.

858

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 4, APRIL 2016

[14] E. Khojasteh and H. Galiana, “Primate disconjugate eye movements during the horizontal avor in darkness and a plausible mechanism,” Exp.
Brain Res., vol. 198, pp. 1–18, 2009.
[15] M. Ranjbaran and H. Galiana, “Hybrid model of the context dependent
vestibulo-ocular reflex: Implications for vergence-version interactions,”
Frontiers Comput. Neurosci., vol. 9, no. 6, 2015. [Online]. Available:
http://www.frontiersin.org/computational_neuroscience/10.3389/fncom.
2015.00006/abstract
[16] M. Ranjbaran and H. L. Galiana, “Identification of the vestibulo-ocular
reflex dynamics,” in Proc. 36th Ann. Int. Conf. IEEE Eng. Med. Biol. Soc.,
Aug. 2014, pp. 1485–1488.
[17] D. G. Altman, Practical Statistics for Medical Research. Boca Raton, FL,
USA: CRC Press, 1990.
[18] M. Paré and D. Guitton, “Brain stem omnipause neurons and the control
of combined eye-head gaze saccades in the alert cat,” J. Neurophysiol.,
vol. 79, no. 6, pp. 3060–3076, 1998.
[19] J. M. Goldberg and C. Fernandez, “Physiology of peripheral neurons
innervating semicircular canals of the squirrel monkey. I. resting discharge
and response to constant angular accelerations,” J. Neurophysiol., vol. 34,
pp. 635–660, 1971.
[20] C. D. Brown and H. T. Davis, “Receiver operating characteristics curves
and related decision measures: A tutorial,” Chemometrics Intell. Lab.
Syst., vol. 80, no. 1, pp. 24–38, 2006.
[21] D. A. Robinson, “Linear addition of optokinetic and vestibular signals in
the vestibular nucleus,” Exp. Brain Res., vol. 30, nos. 2/3, pp. 447–50,
1977.

Mina Ranjbaran (S’08) received the M.A.Sc. degree in electrical engineering from Concordia University, Montreal, QC, Canada, in 2010. She is currently working toward the Ph.D. degree in biomedical
engineering at McGill University, Montreal.
Her research interests include modeling and identification of biomedical systems and signals and
sensory-motor mapping in physiological systems.
Ms. Ranjbaran was the Vice Chair of women in
engineering affinity group, Montreal, from 2009 to
2011.

Heather L. H. Smith received the Bachelor’s degree in electrical engineering from McGill University,
Montreal, QC, Canada, in 1988, and the Master’s degree in electrical engineering (biomedical) in 1988.
She is currently a Research Assistant with the Department of Biomedical Engineering, McGill University and Royal Victoria Hospital, Montreal. Her
research interests include model simulations and signal processing of the vestibular ocular reflex in both
normal subjects and vestibular patients.

Henrietta L. Galiana (F’02) received the Bachelor’s
(Hons.) degree in electrical engineering from McGill
University, Montreal, QC, Canada, in 1966, and the
Master’s degree in electrical engineering (biomedical) in 1968. She received the Ph.D. degree in electrical engineering (biomedical) from McGill University
in 1981.
In 1983, she was a staff in the new Department
of Biomedical Engineering, where she is currently
a Full Professor and received the position of Chair,
from 2005 to 2012. Her research interests include
biosignal processing and the modeling of control strategies for the orientation
of eyes and head, or segmented arms, and related issues of platform coordination
and sensory fusion. Theoretical predictions are applied in the vestibular clinic
for patient evaluation, and are ported to biomimetic robot systems to test novel
control approaches.
Dr. Galiana is a Fellow of the Engineering Institute of Canada and was the
President of the IEEE Engineering in Medicine and Biology Society, in 2002.
She has chaired the TAB Strategic Planning Committee and was a Member of
the TAB Society Review Committee.

