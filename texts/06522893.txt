IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

2867

A Modified Generalized Series Approach:
Application to Sparsely Sampled fMRI
Hien M. Nguyen∗ , Member, IEEE, and Gary H. Glover, Member, IEEE

Abstract—In functional MRI, it is often desirable to reduce the
readout duration to make the acquired data less prone to T2∗ susceptibility artifacts. In addition, a shorter readout length allows for
a shorter minimum TE, which is important for optimizing SNR.
This can be achieved by undersampling the k-space. However, the
conventional Fourier transform-based reconstruction method suffers from under-sampling artifacts such as high-frequency ringing and loss of resolution. To address this problem, we revisit
the constrained-model approach using the generalized-series (GS)
which has been proposed to address the undersampling problem
for dynamic MRI. We propose a modification to the conventional
use of the model in order to reflect small hemodynamic signal
changes typical in fMRI. Specifically, while realizing that having
high model order is necessary to capture missing information, we
found that it is not necessary to span all frequencies of GS basis
functions uniformly. Instead, having k-space and GS “sampling”
trajectories covering low-frequencies uniformly while spanning
high-frequencies sparsely, was observed to be an efficient strategy.
The ability of the method over the conventional GS approach in improving resolution of functional images and activation maps while
reducing undersampling ringing is demonstrated by simulations
and experiments at 3T. Reduction in the readout time allowed an
increase of statistical signal power as compared to the fully sampled
acquisition. Unlike compressed sensing approaches, the proposed
method is linear and hence has lower computational complexity.
The method could prove useful for other imaging modalities where
the signal change is smaller than the baseline component.
Index Terms—Constrained reconstruction, functional MRI, generalized series (GS), undersampling.

I. INTRODUCTION
UNCTIONAL magnetic resonance imaging (fMRI) using
blood oxygen level-dependent (BOLD) contrast [1]–[4]
has become a powerful and widely used noninvasive imaging technique for advancing fundamental understanding of the
brain by measuring the metabolic correlates of neuronal activity.
Specifically, BOLD fMRI typically uses T2*-weighted imaging
to detect changes in deoxygenated hemoglobin concentration

F

Manuscript received March 13, 2013; revised May 20, 2013; accepted May
22, 2013. Date of publication June 3, 2013; date of current version September 14, 2013. This work was supported in part by grant from the NIH (P41
EB015891) and in part by the Vietnam Education Foundation. Asterisk indicates corresponding author.
∗ H. M. Nguyen is with the Lucas Center for MR Spectroscopy and Imaging, Department of Radiology, Stanford University, Palo Alto CA 94304 USA
(e-mail: hnguyen6@stanford.edu).
G. H. Glover is with the Lucas Center for MR Spectroscopy and Imaging, Department of Radiology, Stanford University, Palo Alto CA 94304 USA
(e-mail: gary.glover@stanford.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2265699

consequent to altered neural metabolism. The acquired fMRI
signal is conventionally modeled as

d(k, t) = ρ(r, t)e−j 2π k·r dr + ξ(k, t)
(1)
where ρ(r, t) denotes the desired functional image at particular
time point t, and ξ(k, t) is the modeled measurement noise.
A key challenge in fMRI (as well as in other spatiotemporal
imaging) is to achieve both high spatial and high temporal resolution while minimizing sensitivity to susceptibility induced
off resonance. This difficulty is due to acquisition time limitation and the fact that BOLD fMRI has low-sensitivity, due to
small relative differences in BOLD signal that are used to infer
neural differences in the brain state. Long echo train readout
times, which are typical for high-resolution fMRI, result in images that are more sensitive to motion and off-resonance effects,
causing artifacts. Thus, it is important that each functional image be acquired with the shortest possible duration consistent
with SNR requirements. This paper addresses the problem of
reducing scan time by undersampling k-space combined with a
reconstruction scheme that reduces undersampling artifacts.
Many advanced methods have been proposed to address the
problem of overcoming Nyquist limits and undersampling kspace. For example, parallel imaging using phased array coils
provides an effective method to sparsely sample k-space [5]–[7].
An alternative method is to use signal models that incorporate
prior information to sparsely sample k-space. This prior information is used to compensate for the missing data in the reconstruction process, as opposed to the conventional Fourier reconstruction method which treats the unmeasured data as zeros.
One of the earliest parametric modeling approaches investigated
the use of linear prediction for data extrapolation [8]–[10]. Recent successful model-based approaches include the use of compressed sensing such as k-t SPARSE [11] and k-t FOCUSS [12],
spatial-spectral support constraint [13], [14], the spatial and temporal correlation of the signal captured in a training dataset [15],
and modeling the signal using partially separable functions and
assuming low-rank constraints [16]–[18].
While there are many mentioned advanced reconstruction
methods proposed for undersampling k-space, the purpose of
this study is to revisit the constrained-model approach using
the generalized series (GS) model [19], [20] and make it applicable to fMRI. The GS model has been developed by Liang
and Lauterbur, and the method is known as the reduced encoding imaging by generalized-series reconstruction (RIGR). The
method uses a static high-resolution reference image and represents missing dynamic frequency components using the set
of GS basis functions that are Fourier series sampled uniformly

0018-9294 © 2013 IEEE

2868

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

at low frequencies. RIGR has been used in various dynamic
imaging experiments such as diffusion-tensor imaging, spectroscopic imaging, and cardiac imaging [21]–[23]. In these applications, there is significant global change in image constrast
(diffusion imaging) or structure (cardiac imaging), so having
low-frequencies GS basis functions was sufficient to represent
the missing image structure. However, this is not the case for
fMRI. Unlike other imaging modalities, in fMRI the changes
in amplitude reflecting BOLD contrast are small. When applied
to fMRI, we found (as it was also pointed out independently
in [24]) that the conventional RIGR method was insufficient to
capture small hemodynamic temporal changes that are at most
a few percent of the maximal baseline low-frequency intensity.
In [24], it was suggested to represent the image with conventional GS basis functions but with increased model order. While
recognizing that high GS model order is important for fMRI
applications, this approach is limited to phase-encoding acquisitions. In this method, total variation (TV) regularization was
imposed on the image obtained from the GS coefficients to alleviate high-frequency artifacts due to high model order. Because
TV regularization assumes piecewise smoothness of the image,
this regularization faces the risk of smoothing out BOLD signal,
as shown later in Fig. 1.
In this study, we consider arbitrary k-space sampling trajectory and propose a simple but important modification to the
conventional use of the GS model that allows a better balance toward representing missing high-frequency information
in fMRI data. Specifically, we suggest that one should not be
limited to sampling the space of GS basis functions uniformly
on a Cartesian grid, i.e., we suggest to use the GS basis functions that are Fourier series sampled nonuniformly: densely at
low-frequencies and sparsely at high-frequencies. In this way,
one can effectively reduce the number of unknowns given a
fixed number of k-space measurements, while being able to
capture high-frequency information reflecting small BOLD signal changes. Our empirical observations showed that an efficient
strategy to balance between the level of undersampling ringing
and loss of spatial resolution is to have variable-density k-space
trajectory that samples high-frequencies nonuniformly (such as
variable-density spiral) and set the same GS sampling as the
k-space sampling.
Depending on the level of undersampling, a penalized
maximum-likelihood framework is proposed to further stabilize
the reconstruction. Unlike [24], we instead use a simple smoothness penalty applied on the GS coefficients directly. Although
simple, this approach achieves the desired reconstruction stabilization, avoids the TV “oil painting” effect that is undesirable
in fMRI, and it is computationally efficient. We validated the
proposed method with arbitrary sampling trajectory (reduced
phase-encoding EPI, nonuniform EPI, and variable-density spiral). Results on various BOLD fMRI datasets showed the ability
of the method to reduce the Gibbs artifact and improve spatial
resolution of functional data. A better balance between the image quality (less high-frequency artifacts in the form of ringing
and improved spatial resolution) and spatial resolution of activation maps was observed, comparing to the zero filling, conventional RIGR, and k-t FOCUSS methods. While the proposed

method allowed high-resolution reconstruction from undersampled BOLD fMRI data, reduction in the readout time allowed an
increase of number of time frames, leading to more statistical
signal power as compared to the fully sampled acquisition.
II. PROPOSED METHOD
A. Proposed Reconstruction Scheme
The GS model is a general mathematical model developed
for constrained image reconstruction [19], [20] where the image is represented as a linear combination of weighted complex
sinusoids. We propose a relaxed form of these basis functions.
Specifically, a functional image at a certain time point t is represented as

cl (t)e−j 2π gl (t)·r
(2)
ρ(r, t) = Iref (r)
l∈L

where Iref (r) is the reference image that contains a priori
boundary information and helps to incorporate high spatial resolution features, cl (t) are unknown GS model coefficients that
are functions of time, and {g l (t)|g l (t) ∈ G, l = 1 . . . L} defines
a set of points that sample the conceptual 2-D GS space at a fixed
time point t.
Conventional 1-D model used in [19] and [20] is a special case
of (2) when gl = lΔk, meaning that the GS space is sampled
uniformly on a Cartesian grid to a maximal extent of LΔk.
In this case, a functional image at a certain time point t is
represented as

cl (t)e−j 2π lΔ k·r
(3)
ρ(r, t) = Iref (r)
l∈L

where Δk represents sampling interval satisfying the Nyquist
criterion and l ∈ L = {−L/2, −L/2 + 1, . . . , L/2 − 1}. When
no nontrivial a priori information is available, that is Iref (r) =
1, then (3) reduces to the conventional Fourier series model.
While the reference is static, cl (t) provides temporal data adaptation from time point to time point. Hence, it is important to
estimate cl (t) accurately in order to reflect hemodynamic functional changes over time.
The choice of what GS basis functions to choose, or equivalently how to sample the GS space, depends on the characteristics of the time-varying signal component that is missing in
the data with respect to the reference image. For fMRI specifically, this component represents BOLD signal change that is
small compared to the baseline signal intensity (on the order
of 1%). Thus, for fMRI applications, we suggest to sample the
GS space covering both low- and high-frequency regions. If
activation map is the only concern, then one should use GS
basis functions at all high frequencies. However, if the goal is
to achieve a better tradeoff between minimizing undersampling
ringing in the image, spatial resolution of image, and spatial
resolution of activation map, then one should consider sampling
the GS space nonuniformly, covering the maximum extent. The
downside of having too many basis functions corresponding to
high frequencies is overmodeling which results in the instability
of the reconstruction.

NGUYEN AND GLOVER: MODIFIED GENERALIZED SERIES APPROACH: APPLICATION TO SPARSELY SAMPLED fMRI

Assume that the measured data d(k, t) is available over a
set of points {km |km ∈ D, m = 1 . . . M } that sparsely sample
k-space for each time point t. We then define the undersampling
rate as
N
(4)
R=
M
where N is the number of samples in the fully sampling case.
Given the signal model (1) and the GS model described in (2),
we formulate the reconstruction at each time point t as solving the following penalized maximum-likelihood optimization
problem:
ĉ = arg min d − SΨc22 + λc22
c

(5)

where d is the measured data vector, S is the linear matrix operator which defines the data measurement and sampling, Ψ is
the matrix operator whose columns are the GS basis functions
derived from (2), and λ is the regularization parameter. Having
estimated coefficients ĉ, one can reconstruct the corresponding
functional image using (3). This procedure is repeated independently to obtain functional images at every time point until the
whole dataset is reconstructed.
The regularization functional in (5) is used to impose an optional stability constraint on the GS coefficients cl (t) as opposed
to strongly constrain image features. In [24], regularization was
imposed by minimizing TV norm of the image obtained from
GS coefficients cl (t). Imposing this type of regularization may
have a risk of smoothing out BOLD signal, which would detract from the goal of improving spatial resolution and minimizing high-frequency artifacts while undersampling to reduce
the readout duration. Note that the regularization (either 2 or
TV) serves the purpose of additionally reducing high-frequency
artifacts observed in the estimated functional image but it does
not help to improve spatial resolution of activation maps. In
fact, extreme regularization leads to loss of resolution of both
functional image and activation map.
B. Improved GS Performance
In the conventional use of the GS model employed by the
RIGR method [20], the GS basis functions at low-frequencies
were used to model the object. We suggested that 1) using GS
basis functions at high frequencies is critical in allowing the
Fourier series terms in the GS model to capture information that
reflects changes in the hemodynamic activity of the brain and 2)
in order to achieve a better tradeoff between minimizing undersampling ringing in the resulting images and improving spatial
resolution of images and of activation map, one should sample
the GS space nonuniformly. This section shows a set of simulation results to illustrate ability to improve spatial resolution by
the proposed method when compared to the conventional use of
the GS model.
BOLD fMRI experiment consisted of eight “on” and “off”
blocks with visual checkerboard flashing at 8 Hz presented
together with a randomized tone sequence. Full dataset with
64 × 64 EPI encodings with 131 time frames was obtained
as explained in Section III-A. Undersampling was performed
by masking the center low-frequency k-space along the

2869

Archimedean spiral trajectory [25] while the high-frequency
region was sampled along variable-density spiral [26], resulting
in the undersampling rate R = 3.2 (see Fig. 2(a) for the resulting trajectory). Reconstructions of functional images were
performed using zero-filling (missing k-space data points where
set to zeroes) and GS-based methods. In the latter case, several
choices of the GS basis functions were exploited:
Method I (2-D RIGR): GS space was sampled in the center low-frequency region uniformly, as suggested by the conventional GS approach (resulted in L = 26 for this particular
simulation);
Method II: the whole GS space was sampled uniformly to the
maximum extent which is determined by the number of desired
high-resolution phase encodings (i.e., L = 64 in this simulation
study);
Method III: same as Method II, and in addition, the TV regularization was applied on the image obtained from the GS
coefficients [24];
Method IV (Proposed): same as Method II, and in addition,
the smoothness penalty was applied as described in (5);
Method V (Proposed): GS space was sampled nonuniformly
along the same variable-density spiral that was used for k-space
sampling.
To investigate the quality of reconstructions, we show an
estimated functional image averaged over all time frames, activation map obtained by performing linear regression against the
modeled block waveform, and functional SNR (fSNR) maps
in Fig. 1. The modeled block waveform is a binary stimulus
vector modeling eight “on”/“off’ blocks which last for 15 s
each. This waveform was convolved with canonical hemodynamic response functions [27] and correlation of fMRI data
with the resulting kernel was performed [28]. The correlation
coefficient map was then converted to statistical t-score values,
which we refer to as activation map and denote as a. The fSNR
map was obtained as the signal difference in BOLD activation
between “on” and “off” stages, divided by the residual noise
variance [29]. To assess resolution and amount of ringing in the
images and the activation maps resulting from different reconstruction methods, we calculated 2-D autocorrelation function
Rρ for each image and autocorrelation function Ra for each
activation map. Second and fourth row in Fig. 1 show 1-D plots
of the autocorrelation functions extracted in the middle along
horizontal direction (in blue) and vertical direction (in green).
Results show that zero filling yielded very blurry images and
activation maps as evident from autocorrelation functions (the
full width at half-maximum (FWHM) of image autocorrelation
function almost doubled from 5 to 9.3 pixels), with boosted
fSNR due to the fact that only one third of the total data points
were used (see Fig. 1(a), second column). With the conventional GS method (Method I), the resulting functional image
had enhanced spatial features that were missing/blurred in the
image obtained from the zero-filling method (see Fig. 1(a), third
column). In fact, the image autocorrelation function closely resembled that of the ground truth, with a slight increase in the
FWHM (from 5 to 5.6 pixels). However, the corresponding
activation map was still of low resolution (the FWHM of image autocorrelation function increased from 3.5 to 4.8 pixels),

2870

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 1. Improved performance of the GS model: (a) functional images averaged over time, activation maps, their autocorrelation functions, and functional SNR
maps estimated from the ground truth, zero-filling, and various GS-based methods; (b) Estimated time series at two representative voxels (left) with and (right)
without BOLD fMRI activation. 1-D plots of autocorrelation functions along horizontal direction are shown in blue and along vertical direction are shown in green.
For clarity, this figure should be viewed in color.

because the low model order was not sufficient to capture small
temporal dynamic changes in the data. Increasing the model
order to the maximum and sampling the whole GS space as
in Method II succeeded in obtaining higher resolution activation map as also evident from the corresponding autocorrelation
function, but at the cost of inducing high-frequency artifacts
in the image (high-magnitude side lobes of the image autocorrelation function) and loss in fSNR as shown in Fig. 1(a),
fourth column. The artifact and fSNR loss were alleviated by
regularizing the GS coefficients as in Methods III and IV or
sampling the GS space nonuniformly as in Method V. Given

the approximately same resulting amount of ringing in the averaged functional image (see image autocorrelation functions
corresponding to Methods III and IV), the resulting image and
activation map from Method IV had a slightly better resolution
than those obtained from Method III (FWHM of autocorrelation
function of the images and activation maps were 5.2 versus 5
pixels and 4.5 versus 4.0 pixels, respectively). In addition, we
can observe greater activation volumes resulting from Method
III that in fact are false positives. The Method V, shown in the last
column, was the most efficient in terms of obtaining both highresolution image with least level of high-frequency artifacts

NGUYEN AND GLOVER: MODIFIED GENERALIZED SERIES APPROACH: APPLICATION TO SPARSELY SAMPLED fMRI

2871

in the time-series estimated from Methods II–V. On the other
hand, zero filling and Method I showed false enhanced on/off
patterns. These false-positives are also reflected by the increase
of the t-score by the factor of 2 (t-score was 0.4 for the ground
truth and 0.9 for both zero filling and Method I).
C. Algorithm Implementation and Characteristics

Fig. 2. (a) Variable-density spiral trajectory and (b) nonuniform EPI used in
the simulation study.
TABLE I
FWHM OF AUTOCORRELATION FUNCTION Rρ OF THE FUNCTIONAL IMAGE,
AVERAGED OVER TIME FRAMES, AND FWHM OF AUTOCORRELATION
FUNCTION Ra OF THE ACTIVATION MAP FOR RECONSTRUCTION METHODS
USED IN THE SIMULATION STUDY IN FIG. 1

Solution to formulation (5) has a closed-form expression and
can be obtained as
ĉ = (AH A + λI)−1 AH d

(6)

A = SΨ.

(7)

where

Equation (6) can be solved efficiently using the iterative
conjugate-gradient optimization method for each time frame independently. Note that the proposed minimization cost function
(5) embeds a general measurement and sampling operator S, to
be applied for the data sampled along an arbitrary trajectory.
III. RESULTS AND DISCUSSIONS
A. Simulations
(smallest in magnitude side lobes of the corresponding image
autocorrelation function) and high-resolution activation map, at
the expense of slightly losing image spatial resolution as compared to the Method IV. In addition, the fSNR map of Method
V best matched the ground truth. This simulation study suggested that if one is concerned with improving image resolution
only, then all methods that consider high-frequency GS basis functions such as Methods III–V perform well; however,
Method V is preferrable when the tradeoff between amount of
high-frequency undersampling artifacts, image resolution, and
resolution of activation map is of more concern. In addition, TV
regularization (Method III) may result in false positives due to
the piecewise-smoothness penalty. For reference, FWHM values
of autocorrelation functions are reported in Table I for all reconstruction methods. Those values that best matched the groud
truth are marked in bold.
Typical temporal series, extracted from two representative
voxels are shown in Fig. 1(b). Because none of the considered reconstruction methods exploited temporal constraint in the data,
the enhancement in temporal resolution was not expected. One
can clearly observe eight “on”/“off” blocks from the ground
truth temporal BOLD signal in voxel 1 (left-most in the figure).
For voxel 1, the corresponding temporal series estimated from
zero filling and the Method I (conventional GS use) yielded
lower on/off block contrast (t-score were 1.9 and 1.2, respectively, as compared to the t-score of 2.4 for the ground truth),
while the use of higher frequency GS basis functions (Methods
II–V) succeeded in reconstructing temporal series quite accurately. The second voxel was purposely chosen from the region
of BOLD in-activity (right-most in the figure). The ground truth
time series in this voxel clearly shows noisy baseline with lack
of on/off block pattern. The similar noise pattern was observed

To illustrate performance of the proposed method, we show
simulation results from acquired fMRI EPI data with 64 × 64
encodings, TE = 30 ms, TR = 2.04 s, 131 frames, 30 slices,
FOV = 22 cm. A block design consisted of eight “on” and
eight “off” blocks, each lasting for 15 s, resulting in the total
duration time of 4 min. “On” periods consisted of simultaneous visual and auditory stimulation: the visual stimulus was
a circular checkerboard of alternating black and white contrast
that reversed at 4 Hz; auditory stimuli consisted of a randomized
tone sequence, synchronized with the visual stimuli. This dataset
served as the ground truth for the fully sampled dataset. To obtain the reference required in the proposed method, a separate
fully sampled fMRI EPI scan at one time point was performed
before the actual fMRI task.
To obtain undersampled data, we masked the fully sampled
k-space data according to two trajectories, one being a variabledensity spiral and the other a nonuniform EPI with skipped phase
encoding lines, shown in Fig. 2. The variable-density spiral
trajectory was parametrized with two variables r and α which
correspondingly define 1) the fraction of k-space that constitutes
a critically sampled Archimedean section and the fraction that
constitutes a sparsely sampled section (0 < r < 1, with r = 1
implying that the whole k-space is critically sampled along
Archimedean trajectory) and 2) how sparse k-space is sampled
between the turns of the spiral in the variable-density section
(α ≥ 1, with α = 1 implying that the variable-density section of
the spiral is fully sampled). For more details on parametrization
of the variable-density spiral trajectory, the interested reader is
referred to [26].
In this simulation study, parameters for the variable-density
spiral were chosen to be r = 0.3 and α = 10, resulting in the
undersampling rate R = 3.2, where R is defined as in (4). In
the case of EPI trajectory, the center of k-space was retained

2872

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 3. Simulation results: functional activation maps for three slices overlayed on the averaged functional images, obtained from ground truth, zero-filling, k-t
FOCUSS, and proposed method in the case of variable-density spiral (undersampling factor 3.2) and nonuniformly sampled EPI (undersampling factor 3.6). For
clarity, this figure should be viewed in color.

with eight symmetric phase encoding lines and the rest of the kspace was sampled by skipping four out of five encoding lines,
resulting in 5 k-space encoding lines evenly distributed on each
half-side of the k-space. The undersampling rate in this case
was R = 3.6.
We compared the proposed method with the zero-filling and
k-t FOCUSS methods. In the zero-filling method, the missing
data points were set to zeros and discrete Fourier transform
was performed to obtain functional images. The k-t FOCUSS
method [12] iteratively estimates the global image component
and residual sparse component from the k-t data. The available
code at http://bisp.kaist.ac.kr/ktFOCUSS.htm was employed
with four iterations guaranteeing convergence of the solution.
Functional activation maps (statistical t-score values) were then
obtained by performing linear regression against the modeled
task waveform as explained in Section II-B.
Fig. 3 shows resulting time-averaged functional images and
corresponding activation maps overlayed on the top, with different choices of variable-density spiral or nonuniform EPI sampling trajectory. Three different slices are shown in each row.
Most of fMRI BOLD activation was observed in the primary
visual and auditory area, as expected from the designed experiment. It can be clearly seen that in both variable density-spiral
and nonuniform-EPI sampling cases, the conventional zerofilling method yielded lower resolution images with blurred activation maps. Note the Nyquist ghost artifact along phase encoding direction seen in the case of the non-uniform EPI sampling.
These artifacts were alleviated using the k-t FOCUSS method
and the resulting functional images together with corresponding activation maps had improved spatial resolution. However,
residual ghost ringing can still be visually observed in all three
slices and for all scenarios, and the estimated activation map had
an extra boost in the functional signal, compared to the ground
truth. The proposed method, however, did not have the problem

Fig. 4. NRMSEs of activation maps for three slices estimated using conventional zero-filling method (blue), k-t FOCUSS (black), and the proposed method
(red). (a) and (b) shows the cases of variable-density spiral and nonuniform EPI
trajectories, respectively. For clarity, this figure should be viewed in color.

of false positives and was able to obtain both high-resolution
functional images and high-resolution activation map. In addition, no high-frequency artifacts in the functional images were
observed. Quantitatively, the normalized root mean-squared error (NRMSE) for estimated activation maps was computed as
NRMSE(x̂) =

x̂ − x2
.
x2

(8)

Fig. 4 shows NRMSEs of activation maps estimated using
conventional zero-filling method, k-t FOCUSS, and the proposed method. For all three slices and for both cases of variabledensity spiral and nonuniform EPI the proposed method yielded
the least NRMSEs.
B. fMRI Experiments
A single-shot variable-density spiral-out sequence was performed at (128 × 128) resolution. BOLD functional data
(30 slices, 4 mm slice thickness, TR = 3.1 s, TE = 68 ms,
83 time frames, FOV = 22 cm, 8 coils) from two human volunteers were obtained using the same sensory task as explained in

NGUYEN AND GLOVER: MODIFIED GENERALIZED SERIES APPROACH: APPLICATION TO SPARSELY SAMPLED fMRI

2873

Fig. 5. Experimental results with undersampling rate R = 4 from 2 slices: activation maps overlayed on the averaged functional images, estimated from
fully-sampled scan (first column) and under-sampled scan (the rest of the columns) with gridded DFT reconstruction, 2-D RIGR, k-t FOCUSS, high GS model
order combined with total variation regularization, and proposed method. For clarity, this figure should be viewed in color.

Section III-A with an axial slice orientation. The first fMRI scan
was performed with full sampling density using Archimedean
spiral (r = 1, α = 1) and the second scan was sparse sampling
(r = 0.3, α = 7) with undersampling rate R = 4. The readout
time per one slice and one time frame was 103 ms for the first
scan and 69 ms for the second scan. The reference image was
obtained with the regular Archimedean spiral at a single time
point and matching field of view. The first three time frames
were discarded to eliminate magnetic saturation effects.
Conventional gridded DFT reconstruction was performed on
the fully sampled dataset from the first scan, while the sparsely
sampled single-coil dataset from the second scan was passed to
the gridded DFT reconstruction, 2-D RIGR, k-t FOCUSS, and
high-order GS combined with TV regularization as suggested
in [24], and the proposed method. In all cases, the images were

reconstructed for each coil separately and then combined as
the weighted sum-of-squares with weights obtained from noise
measurements during prescan [30]. For all methods the data
were gridded to Cartesian sampling using Kaiser–Bessel gridding kernel before the corresponding reconstruction method was
performed. fMRI statistical analysis was performed using linear
regression against the modeled task waveform and converting
correlation coefficients to t-scores, as explained in Section III-A.
Fig. 5 shows resulting activation maps (t-scores) overlayed
on the time-averaged functional images for two particular slices
which have strong fMRI BOLD activation in the visual area and
weaker activation in the auditory area for the second slice. To
quantify resolution, autocorrelation functions were also computed for the estimated averaged functional images and corresponding activation maps. Gridded DFT reconstruction from

2874

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

Fig. 6. Efficiency of undersampled acquisition over fully sampled acquisition given the same total scan time (4 min 27 s): scan 1 was fully sampled acquisition
with TR = 4.1 s and 64 time frames; scan 2 was undersampled by factor of 4 with TR = 3.1 s and 83 time frames, leading to higher statistical power. For clarity,
this figure should be viewed in color.

the fully sampled scan served as validation for the activation
pattern consistency. Though the exact activation pattern cannot
be guaranteed for two separate (fully sampled and undesampled) scans, the results show high correspondence in activation
regions between the two scans.
From Fig. 5, one can observe that the gridded DFT method
on the undersampled dataset yielded substantial blurring of both
images and activation maps, as evident from the increase in
FWHM of the autocorrelation functions. Reconstructed images
from the 2-D RIGR method matched the images from the full
scan well because of the reference and low GS model order
used in the method; however, the resolution of the image was
only slightly improved and the resolution of the activation map
was not improved comparing to the gridded DFT method. The
k-t FOCUSS method improved image resolution at the cost of
high-frequency ringing which is visible from the image and can
be quantified by an increase in the magnitude of the side lobes
of the autocorrelation function. The resolution of activation map
was improved but the method had also resulted in an extra boost
in the signal activation compared to the gridded DFT. This effect
was observed in simulation studies in Sections II-B and III-A. In
the method using high GS order with TV penalty, the regularization parameter was chosen by performing exhaustive search to
match resolution improvement of the averaged functional image
as compared to the k-t FOCUSS method. The TV regularization
method yielded less high-frequency ringing as compared to the
k-t FOCUSS method but with slight loss in resolution. The proposed method yielded the lowest resolution of the image and
activation map while having the least amount of high-frequency
ringing in the images. The computational time for the proposed
method to reconstruct all 664 images per single slice (83 images
for each coil, 8 coils in total) was 5.4 mins on Intel (R) Xeon (R)
CPU X5650 at 2.67 GHz, 6 cores, 12 threads, 12.29 GB RAM.
For k-t FOCUSS and TV regularization methods, which represent compressed-sensing-based approaches, the corresponding
computational time were 15 mins (optimized k-t FOCUSS toolbox) and 6 h, respectively. For TV regularization, Nesterov’s

gradient descent method for complex sparse recovery (NESTA
algorithm) was implemented [31], [32]. The fast computation
time and good reconstruction quality indicate the efficiency of
the proposed method.
In the second experiment, we illustrate the efficiency of undersampled fMRI acquisition schemes. Given fixed total scan time
of 4 min 27 s, we considered two different acquisition schemes.
In the first scheme, we acquired BOLD fMRI data using a singleshot Archimedean spiral-out sequence at 128 × 128 resolution,
8 coils, FOV = 22 cm, TE = 30 ms, TR = 4.1 s, 64 time frames.
In the second scheme, BOLD fMRI data were acquired using a
single-shot variable-density spiral (r = 0.3, α = 7 resulting in
the under-sampling factor R = 4) with reduced TR of 3.1 s and
increased number of time frames of 83. All other acquisition
parameters were kept identical to the first acquisition scheme.
Fig. 6 shows activation maps overlayed on anatomical images
from two scans. One can clearly observe increase in the statistical power of BOLD signal in the second scan, due to the
increased number of time frames. A similar effect was observed
in [26]. However, with conventional Fourier reconstruction, activation maps experienced the loss of resolution (see second
row in Fig. 6). The proposed reconstruction method improved
resolution of activation maps, making the high-resolution reconstruction with enhanced BOLD activation power possible.
This experiment illustrates a more efficient way to acquire and
reconstruct BOLD fMRI data comparing to conventional fully
sampled scheme, given the same available total scan time.
C. Characterization of Resolution Improvement
Unlike many other sparse reconstruction methods, the proposed reconstruction is linear and hence the algorithm can be
characterized by computing the point spread function (PSF) as
hn = ΨGSen

(9)

G = (AH A + λI)−1 AH

(10)

where G is the matrix

NGUYEN AND GLOVER: MODIFIED GENERALIZED SERIES APPROACH: APPLICATION TO SPARSELY SAMPLED fMRI

2875

Fig. 7. (a) Point spread functions for the gridded DFT and proposed methods at different undersampling rates R, defined according to (4). For R=1.4 case,
reference was set to identity leading to the identical PSF as that of the gridded DFT. (b) 1-D plots of PSFs resulting from the gridded DFT and proposed method
confirm reduction of the ringing achieved by the method. All PSFs are shown on the logarithmic-10th scale. For clarity, this figure should be viewed in color.

and en is the unit vector with nth element being equal to one.
This function depends on the reference image, i.e., the computation of hn involves the use of the reference Iref (r). The
width of the main lobe of PSF can be used to characterize spatial resolution of the reconstruction, and its side lobes provide
information about the spatial leakage/artifacts introduced by the
reconstruction. In the special case when Iref (r) is the identity
and λ = 0, the PSF characterizes resolution and artifact properties of the conventional Fourier reconstruction. Note that unlike
autocorrelation functions, the calculation of PSF does not require reconstructing image retrospectively.
For illustrations, we considered fMRI experimental data acquired with variable-density spiral as described in Section III-B
and computed the PSFs for the gridded DFT method and for
the proposed method, according to (9). Fig. 7 shows typical
obtained PSFs. Three different sampling rates, defined in (4),
were considered: 1) R = 2.5 corresponding to spiral trajectory
parameters (r = 0.3, α = 3); 2) R = 3 corresponding to spiral
trajectory parameters (r = 0.3, α = 5); and 3) R = 4 corresponding to spiral trajectory parameters (r = 0.3, α = 7). For
definition of the spiral trajectory parameters r and α, see Section III-A. Due to the Fourier series, the gridded DFT reconstruction introduced spatial leakage in the form of the ringing, as
shown in the top row of Fig. 7. This ringing was more prominent
as the amount of undersampling increased. The signal leakage

was attenuated by applying the proposed method in every undersampling case, especially in the region outside of the object,
as observed from the logarithmic scaling of the PSF in the second row of Fig. 7. This is explained due to the reference image
which provides a priori information for the basic spatial features and boundaries. All observations are further confirmed by
considering the 1-D plot of the PSF, extracted from the middle
row of the PSFs (see Fig. 7).
D. Choice of the Reference Image
A reference with high spatial resolution is used in (3) to
provide boundary constraints. Hence, it is important to obtain
accurate boundaries, as otherwise the reconstruction will suffer
from residual ringing. There are various choices for obtaining the reference: 1) fully sampled fMRI scan (T2∗ -weighted)
at only one time point and 2) anatomical T1 - or T2 -weighted
scan. We suggest the first approach, which guarantees accurate
boundary information. We found that this choice of the reference gives the best performance in terms of the quality of
the functional images and time series. This results because the
mutual information between the reference image and sampled
image is greatest when they share a common relaxation weighting and common spatial distortion. In the case2), one should
be careful if the boundaries are not matched exactly, missing,

2876

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 10, OCTOBER 2013

or new boundaries are introduced due to different contrast between reference and functional images. Inaccuracy in the static
boundary information will in turn introduce errors in matching
the dynamic (over time) Fourier series to the measured data. If
however, the image quality is of less concern, we observed that
with T1 − /T2 -weighted reference, one might still obtain higher
resolution activation maps than those estimated from zero filling
the missing k-space points. The strong dependence of PSF on
the reference image in (9) suggests that the proposed method
yields perfect reconstruction only when the reference is the perfect prior ρ. Different relaxation weighting in the reference will
distort the perfect reconstruction and the PSF can be used to
characterize the distortion effect.
IV. CONCLUSION
This paper has presented an application of the GS approach
to sparsely sampled fMRI with improved modification to the
conventional use of the GS model (RIGR method). This modification is critical for the GS model to be useful in fMRI. Specifically, we recognize the importance of including the GS basis
functions at higher frequencies in order to reflect small BOLD
signal changes. We propose to realize this by not only increasing
the GS model order but also by nonuniformly covering the space
of chosen GS basis functions. Together with variable-density kspace trajectory that samples low-frequencies uniformly while
spanning high-frequencies sparsely, this strategy was found to be
efficient in obtaining both high-resolution functional images and
high-resolution activation maps while minimizing the amount
of artifacts. A penalized maximum-likelihood framework with
optional additional 2 penalty on GS coefficients directly has
been proposed. Simulation and experimental results with different subsampling trajectories demonstrated that the method can
effectively suppress undersampling artifacts and improve spatial
resolution of both functional image and activation map, compared to the zero-filling and conventional RIGR methods. While
the proposed method allows high-resolution reconstruction from
undersampled data, reduction in the readout time allows an
increase of number of time frames, leading to more statistical power of BOLD activations. Comparing with compressedsensing (CS)-based reconstruction (k-t FOCUSS), the proposed
method provided a better tradeoff between the quality of functional images and activation map. In addition, since the proposed reconstruction is linear, the computation complexity is
reduced compared to the CS-based reconstructions and the algorithm can be characterized by the point spread function. We
suggest that the reference used in the GS model should have
the same T2∗ -weighting as fMRI data in order to guarantee accurate boundaries and same contrast. The method provides an
elegant implementation that is straightforwardly applicable to
fMRI studies. This method can also be applicable to other temporal imaging modalities where the temporal signal change of
interest is typically much smaller than the baseline component.
REFERENCES
[1] P. A. Bandettini, E. C. Wong, R. S. Hinks, R. S. Tikofsky, and J. S. Hyde,
“Time course EPI of human brain function during task activation,” Magn.
Reson. Med., vol. 25, pp. 390–397, 1992.

[2] K. K. Kwong, J. W. Belliveau, D. A. Chesler, I. E. Goldberg,
R. M. Weisskoff, B. P. Poncelet, D. N. Kennedy, B. E. Hoppel,
M. S. Cohen, and R. Turner, “Dynamic magnetic resonance imaging of
human brain activity during primary sensory stimulation,” Proc. Natl.
Acad. Sci., vol. 89, pp. 5675–5679, 1992.
[3] P. Mansfield, “Multi-planar image formation using NMR spin echoes,” J.
Phys. C, vol. 10, pp. L55–L58, 1977.
[4] S. Ogawa, T. M. Lee, A. R. Kay, and D. W. Tank, “Brain magnetic resonance imaging with contrast dependent on blood oxygenation,” Proc.
Natl. Acad. Sci., vol. 87, pp. 9868–9872, 1990.
[5] K. P. Pruessman, M. Weigher, M. B. Scheidegger, and P. Boesiger,
“SENSE: Sensitivity encoding for fast MRI,” Magn. Reson. Med., vol. 42,
pp. 952–962, 1999.
[6] X. Golay, J. A. de Zwart, Y.-C. L. Ho, and Y.-Y. Sitoh, “Parallel imaging
techniques in functional MRI,” Magn. Reson. Imag., vol. 15, pp. 255–265,
2004.
[7] D. K. Sodickson and W. J. Manning, “Simultaneous acquisition of spatial harmonics (SMASH): Fast imaging with radiofrequency coil arrays,”
Magn. Reson. Med., vol. 38, pp. 591–603, 1997.
[8] Z.-P. Liang, F. E. Boada, R. T. Constable, E. M. Haacke, P. C. Lauterbur,
and M. R. Smith, “Constrained reconstruction methods in MR imaging,”
Rev. Magn. Reson. Med., vol. 4, pp. 67–185, 1992.
[9] M. R. Smith, S. T. Nichols, R. M. Henkelman, and M. L. Wood, “Application of autoregressive moving average parametric modeling in magnetic
resonance image reconstruction,” IEEE Trans. Med. Imag., vol. 5, no. 3,
pp. 132–139, Sep. 1986.
[10] R. Rakow-Penner, G. Gold, B. Daniel, K. Stevens, J. Rosenberg, S. Mazin,
J. Pauly, and G. H. Glover, “Reduction of truncation artifacts in rapid 3-D
articular cartilage imaging,” J. Magn. Reson. Imag., vol. 27, pp. 860–865,
2008.
[11] M. Lustig, J. M. Santos, D. L. Donoho, and J. M. Pauly, “k-t SPARSE:
High frame rate dynamic MRI exploiting spatiotemporal sparsity,” in Proc.
ISMRM, 2006, p. 2420.
[12] H. Jung, K. Sung, K. S. Nayak, E. Y. Kim, and J. C. Ye, “k-t FOCUSS:
A general compressed sensing framework for high resolution dynamic
MRI,” Magn. Reson. Med., vol. 61, pp. 103–116, 2009.
[13] N. Aggarwal and Y. Bresler, “Patient-adapted reconsruction and acquisition dynamic imaging method (PARADIGM) for MRI,” Inverse Problems,
vol. 24, pp. 1–29, 2008.
[14] B. Sharif, J. A. Derbyshire, A. Z. Faranesh, and Y. Bresler, “Patientadaptive reconstruction and acquisition in dynamic imaging with
sensitivity encoding,” Magn. Reson. Med., vol. 64, pp. 501–513,
2010.
[15] J. Tsao, P. Boesiger, and K. P. Pruessmann, “k-t BLAST and k-t SENSE:
Dynamic MRI with high frame rate exploiting spatiotemporal correlations,” Magn. Reson. Med., vol. 50, pp. 1031–1042, 2003.
[16] Z.-P. Liang, “Spatiotemporal imaging with partially separable functions,”
in Proc. IEEE Int. Symp. Biomed. Imag., 2007, pp. 988–991.
[17] J. P. Haldar and Z.-P. Liang, “Spatiotemporal imaging with partially separable functions: A matrix recovery approach,” in Proc. IEEE Int. Symp.
Biomed. Imag., 2010, pp. 716–719.
[18] B. Zhao, J. P. Haldar, A. G. Christodoulou, and Z.-P. Liang, “Image reconstruction from highly undersampled (k,t)-space data with joint partial
separability and sparsity constraints,” IEEE Trans. Med. Imag., vol. 31,
no. 9, pp. 1809–1820, Sep. 2012.
[19] Z.-P. Liang and P. C. Lauterbur, “A generalized series approach to MR
spectroscopic imaging,” IEEE Trans. Med. Imag., vol. MI-10, no. 2,
pp. 132–137, Jun. 1991.
[20] Z.-P. Liang and P. C. Lauterbur, “An efficient method for dynamic magnetic resonance imaging,” IEEE Trans. Med. Imag., vol. 13, no. 4, pp. 677–
686, Dec. 1994.
[21] D. Xu, E. Wiener, M. Aref, L. Ying, J. Ji, and Z.-P. Liang, “Integrting parallel imaging with generalized series for accelerated dynamic imaging,”
in Proc. IEEE Eng. Med. Biol., 2005, pp. 1434–1437.
[22] J. Xiuquan and Z.-P. Liang, “Generalized series dynamic imaging with
deformable references,” in Proc. IEEE Int. Symp. Pattern Recogn., 2002,
pp. 789–792.
[23] S. Chandra, Z.-P. Liang, A. Webb, H. Lee, H. D. Morris, and
P. C. Lauterbur, “Application of reduced-encoding imaging with
generalized-series reconstruction (RIGR) in dynamic MR imaging,” J.
Magn. Res. Imag., vol. 6, pp. 783–797, 1996.
[24] S. Yun, S. S. Oh, Y. Han, and H. Park, “High-resolution fMRI with
higher-order generalized series imaging and parallel imaging techniques (HGS-Parallel),” J. Magn. Reson. Imag., vol. 29, pp. 924–936,
2009.

NGUYEN AND GLOVER: MODIFIED GENERALIZED SERIES APPROACH: APPLICATION TO SPARSELY SAMPLED fMRI

[25] J. B. Ra, C. Y. Rim, and Z. H. Cho, “Application of single-shot spiral
scanning for volume localization,” Magn. Reson. Med., vol. 17, pp. 423–
433, 1991.
[26] C. Chang and G. H. Glover, “Variable-density spiral-in/out functional
magnetic resonance imaging,” Magn. Reson. Med., vol. 65, pp. 1287–
1296, 2011.
[27] G. H. Glover, “Deconvolution of impulse response in event-related BOLD
fMRI,” Neuroimage, vol. 9, pp. 416–429, 1999.
[28] G. H. Glover, “Overview of functional magnetic resonance imaging,”
Neurosurg. Clin. N. Amer., vol. 22, pp. 133–139, 2011.
[29] S. A. Huettel, A. W. Song, and G. McCarthy, Functional Magnetic Resonance Imaging, 2nd ed. MA, USA: Sinauer Associates, Inc., 2009.
[30] M. A. Bernstein, M. Grgic, T. J. Brosnan, and N. J. Pelc, “Reconstructions of phase contrast, phased array multicoil data,” Magn. Reson. Med.,
vol. 32, pp. 330–334, 1994.
[31] Y. Nesterov, “Smooth minimization of non-smooth functions,” Math. Program. Ser. A, vol. 103, pp. 127–152, 2005.
[32] S. Becker, J. Bobin, and E. J. Candes, “NESTA: A fast and accurate firstorder method for sparse recovery,” SIAM J. Imag. Sci., vol. 4, pp. 1–39,
2011.

Hien M. Nguyen (M’10) received the B.S. degree in computer science from the Hanoi University of Technology, Hanoi, Vietnam, in 2002, and
the M.S. and Ph.D. degrees in electrical and computer engineering from the University of Illinois at
Urbana-Champaign, Urbana, USA, in 2007 and 2011,
respectively.
She is currently a Postdoctoral Researcher at
Richard M. Lucas center for Imaging, Department of
Radiology, Stanford University, Stanford, CA, USA.
Her research interests include multidimensional signal processing, parameter estimation, and inverse problems in biomedial imaging applicatoins, with particular emphasis on magnetic resonance.

2877

Gary H. Glover (M’65) received the Ph.D. degree in electrical engineering from the University of
Minnesota, Minnesota, MN, USA, in 1969. His academic research interests encompass the physics, biophysics, and mathematics of biomedical/diagnostic
imaging, primarily with magneticresonance.
He is currently a Director of Radiological Sciences
Lab, Lucas Center for Imaging, Stanford University,
Stanford, CA, USA. His research interests include
exploration of rapid MRI scanning methods using
spiral and other non-Cartesian k-space trajectories
for dynamic imaging of brain function. Using these techniques, his students develop MRI pulse sequences and processing methods for mapping cortical brain
function.
Dr. Glover has received many honors, including membership in the National
Academy of Engineering, Outstanding Researcher of the RSNA, Fellow of the
ISMRM, Fellow of AIMBE, and the Gold Medal of the ISMRM.

