1768

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

A Comparison of SVM and GMM-Based Classifier
Configurations for Diagnostic Classification
of Pulmonary Sounds
Ipek Sen∗ , Murat Saraclar, Member, IEEE, and Yasemin P. Kahya, Member, IEEE

Abstract— Goal: The aim of this study is to find a useful methodology to classify multiple distinct pulmonary conditions including the healthy condition and various pathological types, using
pulmonary sounds data. Methods: Fourteen-channel pulmonary
sounds data of 40 subjects (healthy and pathological, where the
pathologies are of obstructive and restrictive types) are modeled
using a second order 250-point vector autoregressive model. The
estimated model parameters are fed to support vector machine and
Gaussian mixture model (GMM) classifiers which are used in various configurations, resulting in eight different methodologies in total. Results: Among the eight methodologies, the hierarchical GMM
classifier yields the best performance with a total correct classification rate of 85%, where the term hierarchical refers here to first
classifying the data into healthy and pathological classes, then the
pathological class into obstructive and restrictive types. Both the
sensitivity and specificity for the healthy versus pathological classification at the first stage of hierarchy are 90%. Conclusion: The
newly proposed methodologies provide improved results compared
to the previous study. The hierarchical framework is suggested for
diagnostic classification of pulmonary sounds, although the algorithms are still open for further improvements. Significance: This
study proposes new methodologies for diagnostic classification of
pulmonary sounds, and suggests using a hierarchical framework
for the first time.
Index Terms—Diagnostic classification, Gaussian mixture model
(GMM), pulmonary sounds, support vector machine (SVM), vector
autoregressive (VAR) model.

I. INTRODUCTION
PATHOLOGICAL condition developed in the lungs is
usually revealed in the altered characteristics of pulmonary sounds heard at the chest wall. Therefore, auscultation
provides invaluable information about the condition of the lungs,
and stethoscope auscultation is still the common and primary
practice in clinics for the diagnosis of pulmonary diseases. On
the other hand, stethoscope auscultation is subjective by nature,
because it depends on the hearing ability and the experience
of the physician, and objective comparison is not possible due

A

Manuscript received July 4, 2014; revised November 11, 2014 and January
20, 2015; accepted February 2, 2015. Date of publication February 12, 2015;
date of current version June 16, 2015. This work was supported by the Bogazici
University Research Fund under Projects 09A203D and 13A02P2. Asterisk
indicates corresponding author.
∗ I. Sen was with the Department of Electrical and Electronics Engineering,
Bogazici University, 34342 Istanbul, Turkey (e-mail: ipekbounee@gmail.com).
M. Saraclar and Y. P. Kahya are with the Department of Electrical and Electronics Engineering, Bogazici University, 34342 Istanbul, Turkey (e-mail: murat.saraclar@boun.edu.tr; kahya@boun.edu.tr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2403616

to the lack of the means to quantify the acoustic information.
Besides, a stethoscope attenuates the frequencies above approximately 120 Hz, thereby filtering out the frequency band that is
most relevant [1].
Computerized pulmonary sounds analysis techniques that
have developed over the past decades enable quantitative and
objective analysis, thereby overcoming the limitations of stethoscope auscultation, although they are far from becoming a clinical routine. These techniques provide means to reveal the information residing in pulmonary sounds that can not be perceived
by ear, to assess the characteristics through signal processing
and pattern recognition methods, and to compare and follow
pulmonary conditions. Using these techniques, it is possible to
exploit particular sound characteristics in different pulmonary
conditions (including the healthy condition and various diseases) to develop a helpful and complementary tool for clinical diagnosis. In this study, diagnostic classification refers to
classification of pulmonary sounds with respect to pulmonary
conditions in this sense.
Several studies in the literature address pulmonary sounds
classification with respect to pulmonary conditions [2]–[6].
Most of the pulmonary diseases belong to one of two main
categories, namely, obstructive (e.g., asthma, emphysema,
bronchiectasis) and restrictive (e.g., interstitial lung disease
(ILD), the term referring to a broad group of diseases including
pneumonia). In the majority of studies [2]–[4], the binary case of
healthy versus pathological classification was considered, where
the pathological classes were composed of several diseases from
both obstructive and restrictive categories [2], [3] or of a group
of diseases from a single category [4]. Only two of the studies adopted a three-class structure, where the obstructive and
restrictive classes are considered separately, in addition to the
healthy class [5], [6]. This three-class structure, which is physiologically meaningful as well, constitutes a sensible step after the
initial (the most general) healthy versus pathological classifier
towards the final (the most specific) diagnostic classifier.
Auto-regressive (AR) model parameters were used as the
mathematical features in the majority of studies [2]–[5]. Percentile frequencies [4], eigenvalues of covariance matrices [4],
and cepstral coefficients [5] were also used. The multivariate
version of the AR model, namely, vector auto-regressive
(VAR) model, has been used in two recent studies [4], [6]. For
classification, k-nearest neighbor [2], [3] and artificial neural
network [4], [5] algorithms were adopted. Only one study has
employed a support vector machine (SVM) classifier for
pulmonary sounds analysis so far [6]. None of the studies

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

SEN et al.: COMPARISON OF SVM AND GMM-BASED CLASSIFIER CONFIGURATIONS FOR DIAGNOSTIC CLASSIFICATION

in the literature has employed Gaussian mixture models
(GMMs) for classification of pulmonary conditions yet. In
computerized pulmonary sounds analysis literature, GMMs
were used to recognize and classify crackles [7], rather
than pulmonary conditions. However, both SVM and GMM
classifiers are widely adopted for acoustic signal interpretation
(e.g., speech recognition), therefore, are worth being studied
for interpretation of pulmonary sounds.
The purpose of this study is to explore a useful methodology for the classification of the three-class structure (healthyobstructive-restrictive), with the ultimate goal of developing
a useful diagnostic classifier. For this purpose, 14-channel pulmonary sounds data are modeled using a second order 250-point
VAR model, and the estimated model parameters are fed to SVM
(of discriminative type) and GMM (of generative type) classifiers designed in various classifier configurations.
The sounds acquired at the chest wall originate in the airways
and alveoli through which the inhaled or exhaled air flows. The
airflow rate and direction change over a full respiration cycle,
therefore, the sound characteristics and the airways and alveoli
contributing to the sound production are different in successive
subphases. Moreover, adventitious sound components (e.g.,
crackles and wheezes), which are indicators of pathological conditions, are informative about the disease by their timing within
the respiration cycle as well as their other (spectral, temporal,
and spatial) characteristics. To make use of their distinctive
information, the six subphases of the flow cycle are considered
separately, until being suitably combined at the decision level.
The linear kernel function is adopted for the SVM classifier since it yields satisfactory results [6] with low computational complexity. The classifier configurations are designed so
as to investigate the following points of view: 1) Conducting
the classification either: a) By performing on the three classes at
once (one three-class classifier), or, b) By adopting a hierarchical approach such that first the data are classified into healthy
and pathological classes and then the pathological class into
obstructive and restrictive (two consecutive binary classifiers),
2) Making dimensionality arrangements and/or set simplifications in the feature space prior to SVM classification. The rationale behind the first viewpoint is that the obstructive and
restrictive groups are further divisions (implying distinct characteristics) under the pathological group (implying common characteristics), therefore a hierarchical viewpoint may improve the
overall classification success. The rationale behind the second
viewpoint is that linear SVM is known to perform successfully
in high dimensional feature spaces.
The order and the sample size of the VAR model are determined based on a previous study [8], where the goodness of
the model was measured by the ability of model parameters to
maximize the within-group similarities and between-group differences inherent in pulmonary sounds with regard to healthy
and pathological subject groups. The optimal model to represent pulmonary sounds [8] has also been shown to be useful for
diagnostic classification purposes [6]. Improving the method in
[6] by testing new classifier algorithms and configurations falls
in the scope of this study, however, the search of additional
mathematical features is subject of another work.

1769

TABLE I
SPIROMETRY TEST SCORES OF THE PATHOLOGICAL SUBJECT GROUPS,
AND THE DISEASE HISTORY IN YEARS

FVC (% pred)
FEV1 (% pred)
FEV1/FVC (% )
Disease history (years)

Bronchiectasis

ILD

66.50 ± 38.04
66.67 ± 43.97
79.60 ± 17.07
7.19 ± 8.10

48.40 ± 10.08
53.87 ± 9.00
85.17 ± 7.60
2.74 ± 2.97

The novelty of this study resides in the following aspects:
1) Using GMMs, and comparing GMM and SVM classifiers, in
classification of pulmonary sounds with respect to pulmonary
conditions, 2) Introducing the hierarchical approach to classify
healthy, obstructive and restrictive groups, as opposed to multiclass classification at once.
The rest of the paper is organized as follows. The data acquisition system and the data used in this study are described
in Section II. Sections III-A, III-B and III-C summarize the
methodology including VAR modeling, SVM classification,
and GMM classification, respectively. The classifier configurations are described in detail in Section III-D, the perspectives
adopted to evaluate the classifier performances are explained in
Section III-E, and the performance measures are addressed in
Section III-F. The results are presented in Section IV, followed
by Sections V and VI on discussions and conclusions.
II. DATA ACQUISITION SYSTEM AND DATA
Pulmonary sounds data of 20 healthy and 20 pathological
subjects are used in this study. Half of the pathological subjects had bronchiectasis (obstructive) and the remaining half
had ILD (restrictive). Pathological data were acquired in Istanbul Yedikule Teaching Hospital for Chest Diseases and Thoracic
Surgery, from subjects under the surveillance of the three expert physicians that contributed to this study. Healthy subjects
were nonsmokers who had no history of any serious lung disease. An informed consent was taken from each subject before
recording. The data acquisition procedure of this study has been
approved by the Second Ethical Committee on Clinical Research of Istanbul (is in compliance with the Declaration of
Helsinki).
The average spirometry test scores of the subject groups are
given in Table I, together with the average years of disease history. The pulmonary sounds were recorded via the 14-channel
pulmonary sound data acquisition and processing system [9]
that was designed and implemented in the Bogazici University
Lung Acoustics Laboratory. The system is composed of 14 aircoupled electret microphones (SONY ECM-44 BPT) attached
on the posterior chest wall (see Fig. 1), an analog amplifier-filter
unit (with a gain of 100 and a pass band of 80 to 4000 Hz), a
Fleisch type pneumotachograph (Validyne CD379) to measure
the flow-cycle simultaneously for synchronization, a data acquisition card (NI DAQCard-6024E, 12-bit) for digitization, and a
laptop computer to control the process (via an interface program
implemented in LabVIEW) and store the data. The data are sampled at a rate of 9600 samples per second, and an acquisition ses-

1770

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

TABLE II
PERCENTAGES OF THE ADVENTITIOUS SOUNDS AND NOISE IN THE DATA

Crackle

Wheeze

Fig. 1.

Microphone locations on the posterior chest wall.

Outside noise
(environmental,
bad contact of
microphone, etc.)
Other (friction noise,
DAQ system
malfunction, etc.)

Bronchiectasis

ILD

70% of the subjects
(predominantly
inspiratory, medium or
coarse, in the middle and
lower zones of the lungs)
50% of the subjects (small
in amplitude and rare in
occurrence)

100% of the subjects
(inspiratory, fine, in the
middle and lower zones
of the lungs)

60% of the subjects (small
in amplitude and rare in
occurrence. Finer as
compared to the
Bronchiectasis group)
< 0.5% of the overall data

< 2% of the overall data

Fig. 3. Segmentation of the flow cycle into its six subphases. Numerical values
represent air volumes in percentages.

Fig. 2. (a)–(b) Sample signals selected from the healthy, (c)–(e) bronchiectasis
and (f)–(g) ILD groups.

sion lasts for 15 s. Some sample signals selected from the three
groups (healthy, bronchiectasis and ILD) are shown in Fig. 2.
Based on aural observation, the percentages of adventitious
sounds and various types of noise in the recorded sound data are
summarized in Table II.
During the recording sessions, subjects sit upright and wear a
nose clip while breathing through the mouthpiece of the flowmeter. A target flow rate was not imposed; instead, the patients
were required to breathe as they feel comfortable (i.e., spontaneous breathing), since this is a practical and realistic criterion
to be adopted for such a diagnostic classifier in clinical practice.
The averages and standard deviations of the resulting flow rates

are as the following: 1) Healthy subjects: 1.19 ± 0.65 L/s, 2)
Subjects with bronchiectasis: 0.66 ± 0.36 L/s, and 3) Subjects
with ILD: 1.21 ± 0.45 L/s.
As a preprocessing step, flow cycle is automatically divided into respiratory subphases (i.e., early/mid/late inspiration/expiration). First, the inspiration and expiration phases are
determined by the flow signal portions above and below a threshold band allocated around the zero level, where the band is
determined as a small percentage of the maximum flow signal deviation. Then, subphases are determined according to the
area under the curve, i.e., the volume of air inhaled and exhaled.
Early and late phases represent 30 percent of total air inhaled
(or exhaled) during one inspiration (or expiration) period, while
the midphase represents the remaining 40 percent (see Fig. 3).
Thereby, one complete inspiration-expiration cycle is composed
of six respiratory subphases (flow-phases hereafter).
III. THEORY AND METHODOLOGY
As AR parameters reveal the temporal dependencies in a
single channel measurement, VAR parameters reveal the spatiotemporal dependencies in multichannel measurements. Therefore, VAR processes are more suitable to model those systems
that are characterized by multichannel observations. They are
already used in economics and meteorology to predict future
trends, or in neuroscience to analyze causality of brain areas.
SVM and GMM classifiers are widely used in bioinformatics or speech and image recognition. SVM is a discriminative

SEN et al.: COMPARISON OF SVM AND GMM-BASED CLASSIFIER CONFIGURATIONS FOR DIAGNOSTIC CLASSIFICATION

method that finds the optimal hyperplane separating the two
groups. On the other hand, GMM is a generative model where
the classes are described by probability distributions and the
class memberships are decided accordingly.
In the following sections, theoretical background for the three
methods are summarized, and the details of the methodology
are explained, including the classifier configurations and the
performance evaluation perspectives.
A. VAR

(W N )si,j , 1  i  (F CN )s }, defined per flow-phase per subject, j = 1, 2, ..., 6, and s = 1, 2, ..., 40. These sets constitute
the inputs of the classification algorithm.
B. SVM
For binary classification problems, SVM algorithm proposes
a method to find the optimal separating hyperplane. Suppose we
have data vectors xt ∈ X , t = 1, 2, ..., |X |, and the class labels
are denoted by rt , rt = +1 if xt ∈ C1 and rt = −1 if xt ∈ C2 .
Then the optimal separating hyperplane is such that

A K-dimensional VAR process of order p (VAR(p) process)
can be expressed as [10]
yn = v + A1 yn −1 + ... + Ap yn −p + un ,
n = 0, ±1, ±2, ...

(1)

where yn  [y1n , ..., yK n ]T is a (K × 1) random vector, v 
[v1 , ..., vK ]T is a fixed (K × 1) vector of intercept terms allowing for the possibility of a nonzero mean E{yn }, Ai are fixed
(K × K) coefficient matrices as
⎤
⎡
α11,i · · · α1K ,i
⎢
.. ⎥ , i = 1, ..., p
Ai  ⎣ ... . . .
(2)
. ⎦
αK 1,i · · · αK K ,i
and finally, un  [u1n , ..., uK n ]T is a K-dimensional white
noise, i.e., E{un } = 0 and

Σu , if n1 = n2
E{un 1 uTn 2 } =
(3)
0, otherwise
where Σu can be either diagonal or not. The process yn is assumed to be stable and stationary, the latter assumption allowing
v and Ai to be accepted as fixed (time invariant).
Since the pulmonary sound data are inherently nonstationary,
the data are segmented into shorter intervals before fitting the
model, to meet the stationarity assumption. The segment size
and the model order are set to 250 and 2, respectively, following
a previous study [8] (please see Section I), and K = 14 since the
pulmonary sounds are recorded via 14 channels.
Each full (inspiration-expiration) cycle is divided into six
flow-phases and labeled as explained in Section II. Let
s
denote one such flow-phase, where i = 1, 2, ..., (F CN )s ,
Pi,j
j = 1, 2, ..., 6 (flow-phase index, from early inspiration to
late expiration) and s = 1, 2, ..., N (subject index, N = 40).
(F CN )s is the total number of full cycles for subject s, and i
is the full cycle index.
s
, the data are automatically divided into 250For each of Pi,j
point 50% overlapping segments. Let (W N )si,j denote the maxs
. For each segimum number of such segments fitting into Pi,j
ment, a VAR(2) model is fitted and the parameter matrices Â1
and Â2 are estimated, where they are (14 × 14) matrices since
K = 14 in (2). These are concatenated to form the (14 × 28)
matrices Â = [Â1 , Â2 ] which can be denoted as Âsk ,{i,j }
where k = 1, 2, ..., (W N )si,j . Each such matrix is converted
into a row vector âsk ,{i,j } ∈ Rd where d = 14 × 28 = 392, and
Asj is the set of these row vectors, Asj = {âsk ,{i,j } : 1  k 

1771

rt (wT xt + w0 )  +1

∀t

(4)

where w is the normal vector of the hyperplane. If there is
no hyperplane to separate the two classes, the one that incurs
the least error is searched. Including slack variables ξt  0 to
represent the deviations from the margin, the relation becomes
rt (wT xt + w0 )  1 − ξt

∀t.

(5)

To solve for w, one should minimize
	
1
Lp = ||w||2 + C
ξt
2
t
	
	
−
αt [rt (wT xt + w0 ) − 1 + ξt ] −
μt ξt
t

t

(6)
where αt and μt are the Lagrange multipliers for the two constraints (for (5) and for ξt  0, respectively), and C is the penalty
factor to trade off complexity and data misfit [11]. In this study,
the optimal values for the penalty factor are searched over the
range C = 10−7 , 10−6 , ..., 107 .
It is a convex quadratic optimization problem to solve for w
in (6). Throughout this study, LIBSVM [12] is used to solve
for w, in other words, to train (and validate) the SVM classifier. For multiclass problems, LIBSVM follows one-against-one
approach, which can be summarized as considering two of the
classes at each time to predict a label for the instance, then
deciding on the true label by majority voting.
C. GMM
In the single Gaussian case the likelihood of vector x ∈ X
under class r is p(x|Cr ) ∼ N (μr , Σr ) where the mean vector
μr and the covariance matrix Σr are maximum
likelihood (ML)


estimates calculated over Xr , such that X = r Xr , where
denotes the exclusive union of sets (the intersections are empty).
In the GMM case, on the other hand, the likelihood p(x|Cr )
is written as
p(x|Cr ) =

M
	

P (Crm )p(x|Crm )

(7)

m =1

where M is the total number of components in the mixture, P (Crm ) is the probability of the mth component, and
m
p(x|Crm ) ∼ N (μm
r , Σr ) is the likelihood of x under the mth
m
m
and Σr are ML estimates calculated over Xrm ,
component (μr 

such that Xr = m Xrm ).

1772

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

Fig. 4. Diagram depicting the design of the classifier configurations and the
corresponding letter codes.

Then, given a vector y lying in the same space, the posterior
probability of class r is calculated by Bayes’ rule as
p(Cr |y) =

p(y|Cr )P (Cr )
p(y|Cr )P (Cr )
=
p(y)
r p(y|Cr )P (Cr )

(8)

where P (Cr ) and p(y) are called the class prior probability
and the evidence, respectively, and the likelihood p(y|Cr ) is
calculated using the mixture model in (7).
The components in the GMM are estimated using unsupervised learning (clustering) methods, the most popular being
the expectation maximization algorithm [11], which is the one
adopted in this study as well. To search for the best fitting GMM,
the whole range of component counts from one to ten is experimented. Note that GMM with one component corresponds to
Gaussian naive Bayes. Component counts above ten are not experimented since they force the mixtures to be too small for a
reliable model fit.
D. Design of the Classifier Configurations
Since the data size is not large enough to partition the data
as to have separate and sufficiently large training, validation
and test sets, 40-fold (leave-one-subject-out) cross validation
scheme [11] is adopted here. In other words, the data of one
subject is omitted from the dataset at each fold, the classifiers
are trained on the complementing set, and the omitted subject
data are used for validation.
As introduced in Section I, the following two viewpoints
are possible to approach the three-class structure: 1) Treating
all the classes at once and perform a multiclass classification,
and 2) Classifying the data into healthy versus pathological,
then the pathological group into obstructive and restrictive (into
bronchiectasis and ILD), which corresponds to performing two
successive binary classifications. The former is referred to as all
at once and coded with an “O,” and the latter is referred to as
hierarchical and coded with an “H” (see Fig. 4).
The aforementioned viewpoints yield the four (two for SVM
and two for GMM) of the eight classifier configurations in total.

In these four configurations, the classifiers are trained and validated for the six flow-phases separately, to be combined later
at the decision level. In the remaining four configurations, however, combining the six flow-phases in the feature space prior to
the classification is considered. The relative pertinences of the
six flow-phases are still taken into consideration in this case,
however, through newly added dimensions in the feature space
rather than through separate classifiers. These four configurations are designed especially for the SVM classifier, since the
linear SVM is known to be useful in high dimensional feature
spaces even for relatively small data sets. The higher dimensionality version is not applicable for GMM since the number
of instances (feature vectors) are insufficient to estimate the covariance matrices in that case. The two approaches can be listed
as: 1) Training the classifier for each respiratory flow-phase
separately, with a later combination at the decision level, and
2) Combining the flow-phases at the feature level and training the classifier on the new feature space. The former is in
the original feature space (of dimensionality 392), therefore is
coded with number “1.” The latter, on the other hand, is coded
with number “6” since the feature space has six times higher
dimensionality (392 × 6).
For the precombination of the six flow-phases at the featurelevel, another pair of viewpoints is considered: 1) Concatenating
the feature vectors directly, such that the vectors with the same
segment-order indices in the six consecutive flow-phases are
aligned, and 2) Concatenating the averages of the feature vectors
within the flow-phases. Direct concatenation requires omitting
the excess segments from both ends of the flow-phase until the
segment count of the shortest flow-phase within that flow cycle
is reached. This does not cause loss of important information,
because the middle portions of all the flow-phases are the most
characteristic (therefore important), rather than the beginning
or the end. The averaging in the second viewpoint is done with
an aim to see whether the average vectors are still sufficient to
represent the classes, relying on the generalization capability of
linear SVM for small sets in high dimensionality, as addressed
previously. Direct use of vectors will be referred to as self and
coded with an “S,” and averaging them will be referred to as
average and coded with an “A.”
The diagram in Fig. 4 summarizes the designs of the classifier
configurations, and presents the complete list of code-words
used for the configurations hereafter.
E. Evaluation Perspectives
At the lowest level, there are only feature vectors, and the
success rate associated with each validation set corresponds to
the percentage of correctly classified vectors. For the configurations with dimensionality code 1, the second level combines
the predicted labels (or, probabilistic scores) of the vectors to
decide for the flow-phase, and the third level combines the predicted labels (or, probabilistic scores) of the six flow-phases to
decide for the subject. On the other hand, for the configurations
with dimensionality code 6, the second level is skipped since the
individual flow-phases are not accessible, and the combination
of vector level decisions directly leads to subject level decisions.

SEN et al.: COMPARISON OF SVM AND GMM-BASED CLASSIFIER CONFIGURATIONS FOR DIAGNOSTIC CLASSIFICATION

TABLE III
FORMAT FOR CONFUSION MATRICES

C = C1
C = C2

Ĉ = C 1

Ĉ = C 2

n 1 |1 (f 1 |1 )
n 1 |2 (f 1 |2 )

n 2 |1 (f 2 |1 )
n 2 |2 (f 2 |2 )

because the correct classification rates of both classes are desired
to be high simultaneously.
Two more success measures, namely, recall and precision
rates are also incorporated here to observe the behavior of a
particular classifier in more detail. For C1 , the recall rate is
Recall(C1 ) = 100 ×

C /Ĉ : True/Predicted class label, C 1 /C 2 :
Class 1/2.

F. Performance Measures
The format of the confusion matrix for the binary classification scheme is given in Table III. In the table, n stands for
the number, and f for the frequency (percentage within the true
class) of instances.
The total correct classification rate is denoted here by η,
where
η = 100 ×

n1|1

n1|1
n1|1 + n2|1

(%)

(11)

and is equal to the correct classification rate of C1 (i.e., to f1|1 ).
On the other hand, the precision rate for C1 is

The three levels (perspectives) to evaluate the classification performances are listed below.
1) Perspective 1 (P1)—On the Level of Vectors: Each feature
vector corresponding to a 250-point data segment that the
VAR model is fitted on (dimensionality code 1), or each
augmented-vector formed by concatenating those vectors
over successive flow-phases (dimensionality code 6), is
assigned a class label, bearing the notion of percentages
of correctly and incorrectly classified feature vectors.
2) Perspective 2 (P2)—On the Level of Flow-Phases: Vector
decisions are combined to produce one common decision for the flow-phase, bearing the notion of percentages
of correctly and incorrectly classified flow-phases. (Valid
only for dimensionality code 1)
3) Perspective 3 (P3)—On the Level of Subjects: The six
flow-phase decisions (dimensionality code 1), or the
augmented-vector decisions (dimensionality code 6), are
combined to produce one common decision for the subject, bearing the notion of correctly and incorrectly classified (diagnosed) subjects.
The SVM classifier yields a class label directly. On the other
hand, the GMM classifier yields a likelihood (7), and the class
label is predicted according to the maximum a posteriori (MAP)
decision rule where the posterior probability is calculated as in
(8) and the prior probabilities are calculated as the frequencies
of classes in the training set. Therefore, decision combination
for P2 and P3 is done by majority voting over the labels in the
SVM case, whereas, it is done by comparing the log-summed
(P2) or summed (P3) posterior probabilities in the GMM case.

n1|1 + n2|2
+ n2|1 + n1|2 + n2|2

1773

(%).

(9)

Although η is a measure of success for the overall classification, another success metric, ζ, is defined here to summarize
the whole confusion matrix in one single value for comparing
several classifiers. It is defined as a harmonic mean, i.e.

(10)
ζ  f1|1 f2|2 (%)

P recision(C1 ) = 100 ×

n1|1
n1|1 + n1|2

(%)

(12)

and interpreted as the proportion of true members of class C1 in
all those instances classified as C1 . While the recall rate implies
success in recognition, the precision rate implies reliability of
claim. In medical applications where an abnormality is to be
detected, a high prediction rate for the normal class should
especially be pursued, since there should be as little doubt as
possible when a subject passes the diagnostic test.
In the medical field, the conventional success measures are
sensitivity (SE) and specificity (SP). Either one corresponds to
the correct classification rate of one of the two classes, the
attributions depending on which class is defined as the positive
one. SE and SP are defined as
SE = 100 ×

TP
TP + FN

(%)

(13)

SP = 100 ×

TN
TN + FP

(%)

(14)

where TP/FP and TN/FN denote the numbers of true/false positives and negatives, respectively. In healthy (C1 ) versus pathological (C2 ) classification, since the existence of a pathology
is the case to be detected, the pathological class is usually the
positive one. Then, SE is equal to the recall rate of C1 (hence,
to f1|1 ) and SP is equal to the recall rate of C2 (hence, to f2|2 ).
(The counterpart of precision in medical nomenclature is positive predictive value.)
Although the definitions are given here for binary classification, they can also be extended to the multiclass case, except for
SE and SP. Here, SE and SP are only reported for the healthy
versus pathological classification, where the measures adhere to
their true nature.
IV. RESULTS
The bar plot of ζ is given in Fig. 5 for the eight classifier
schemes, in the order from top to bottom as in the diagram of
Fig. 4. Note that P2 becomes irrelevant for those configurations
with dimensionality code 6, therefore the corresponding bars
are absent in the figure. The optimal component counts in the
mixture models are found to be five for GMM1SO and seven
for GMM1SH. The optimal SVM penalty factor is C = 105 for
the first two SVM schemes (SVM1SO and SVM1SH), and are
in various values in the range C = 0.001 to C = 0.1 for the
remaining four (SVM6-SO/SH/AO/AH).

1774

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

TABLE IV
CONFUSION MATRIX FOR GMM1SH

The optimal component counts for the two GMM schemes
(five for GMM1SO and seven for GMM1SH) are worth noting.
Since the latter is the hierarchical version, the obstructive and
restrictive groups are together in the pathological group at the
first stage of the hierarchy, i.e., the healthy versus pathological
classification. Therefore, the observation that the number of
clusters modeling the distribution best turns out to be greater for
the latter is in accordance with the expectation.
Considering that the average features are used, the last two
configurations perform better than expected, and they are comparable to their counterparts where the dimensionality is the
same (392 × 6) yet feature vectors are used directly as themselves (no averages are taken). It seems that the average feature
vectors are still sufficient to represent the distribution of the
classes in the feature space. SVM configurations with dimensionality code 6 are more successful, having the highest P1 and
P3 scores of all except for P3 of GMM1SH. This implies that,
when SVM is adopted, precombination of flow-phases at the
feature level yields better classification performance than majority voting over the individual decisions of the flow-phases.
Moreover, recalling that the maximum optimal penalty factor is
C = 0.1 for these four schemes whereas it is C = 105 for the
other two SVMs (those with the dimensionality code 1), one
can conclude that when the flow-phases are precombined at the
feature-level, the discrimination of the two classes by SVM is
easier (i.e., the classes are more distinctly spaced).
An important observation is that the hierarchical versions are
consistently better than the counterparts, where the only exception is holding for P3 of SVM1SH (P1 and P2 of SVM1SH obey
this general tendency). A closer observation on the predicted
class labels of subjects (not reported here explicitly) reveals that
the indecisive cases in the combined decisions of flow-phases
due to majority voting are incidentally very frequent for this
scheme.
Although GMM1SH has comparable P1 and P2 scores with its
three neighbors (the moderately successful schemes GMM1SO,

Ĉ = B

Ĉ = I

P1

C =H
C =B
C =I

82.3
45.2
12.8

11.9
31.4
15.3

5.8
23.4
71.9

P2

C =H
C =B
C =I

87.5
36.7
3.3

8.3
36.7
10.0

4.2
26.6
86.7

P3

C =H
C =B
C =I

90
20
0

10
60
0

0
20
100

Healthy
Bronchiectasis
ILD

Recall
90
60
100

Precision
90
75
83.3

η /ζ

Fig. 5. Bar-plot of ζ scores for P1, P2 and P3, for the eight classifier
configurations.

Ĉ = H

85 / 81.4

C /Ĉ : True/Predicted class label, H : Healthy, B : Bronchiectasis, I : ILD.

SVM1-SO/SH), it makes an apparent breakthrough at P3, attaining the highest score among all. Although the last four SVM
schemes are considerably more successful than GMM1SH in
P1, the discriminative ability of GMM1SH increases at each
step of decision combination, eventually surpassing the others
in P3. The power of GMM comes from that it is a probabilistic
model, and going from P1 to P3 corresponds to combining the
probabilistic scores rather than the discrete decisions.
GMM1SH is observed to be the most successful among all the
eight classifier configurations. The confusion matrices for P1,
P2 and P3, and the success scores calculated for P3, are given
explicitly in Table IV. Although the majority of the bronchiectasis instances are diagnosed correctly, the recall rate (60%) is still
low. Bronchiectasis is observed to be confused equally with the
other two classes (20% of instances per each). Healthy and ILD
recall (90% and 100%, respectively) and precision (90% and
83.3%, respectively) rates are rather high, which validates that
the classifier is promising in general (with a total correct classification rate of 85%), except for the bronchiectasis discrimination
(with recall and precision rates of 60% and 75%, respectively).
The results for the healthy versus pathological classification at
the first stage of GMM1SH are given in Table V. Both SE and
SP are rather high (90%), which is promising for prospective
clinical applicability if the aim is to detect a deviation from the
normal (healthy) condition.
V. DISCUSSION
The results imply that a hierarchical point of view is worth
consideration for classification of multiple distinct pulmonary
conditions, rather than a multiclass classification performed at
once. The GMM classifier is shown to be the most successful
in terms of subject-level decisions, however, the success of the
SVM classifier can not be neglected, especially when the flowphases are precombined at the feature level, even when the
average feature vectors are used. SVM algorithm is used here
in its original form, i.e., it predicts class labels for the instances

SEN et al.: COMPARISON OF SVM AND GMM-BASED CLASSIFIER CONFIGURATIONS FOR DIAGNOSTIC CLASSIFICATION

TABLE V
CONFUSION MATRIX FOR THE FIRST (HEALTHY VERSUS PATHOLOGICAL
CLASSIFICATION) STAGE OF GMM1SH
Ĉ = H

Ĉ = P

P1

C =H
C =P

82.3
29.1

17.7
70.9

P2

C =H
C =P

87.5
20

12.5
80

P3

C =H
C =P

90
10

10
90

Healthy
Pathological

Recall
90
90

Precision
90
90

S E /S P
η /ζ

90 / 90
90 / 90

C /Ĉ : True/Predicted class label, H : Healthy,
P : Pathological.

according to which side of the hyperplane they lie. Alternatively,
the individual distances of support vectors to the hyperplane
could be considered (e.g., could be turned into probabilities)
which would give more information than two discrete class
labels, which in turn would possibly increase the success of the
method.
As the MAP classifier with Gaussianity assumption is already
probabilistic and its flexibility is increased with the mixture
model approach, SVM methodology is based on the basic theory
in this study, allowing GMM and SVM classifiers to complement
each other. Therefore, exploration with other variants of SVM
is kept out of scope of this study, however, it should still be
considered in future studies for further improvements of the
methodology.
According to the average flow levels of the subject groups
reported in Section II, the bronchiectasis group has lower flow
levels, probably due to the limitations they feel. This does not
introduce a factor to be eliminated, from the classifiers’ point
of view, for two reasons. First, the VAR model summarizes the
spatio-temporal relationships, therefore, its discriminative ability is not affected by different sound intensities due to different
flow levels [8]. Second, although a change in the flow level may
cause a change in the system characteristics (of the lungs), hence
in the VAR model parameters, this should also be learned by the
classifier, if the change is consistent for the group as a typical
consequence of the pathological condition.
Through employment of the VAR model, the temporal relationships across the channels are also taken into consideration
besides those within the channel. In this respect, the VAR model
promises a better representation for multichannel measurements
than the AR model, which is already used successfully to model
pulmonary sounds data. However, the multichannel sounds data
are still modeled without paying special attention to the existence of adventitious sound components such as crackles and
wheezes, and it is assumed that the effect of such sound components are already reflected in the estimated model parameters.
Consideration of the background sounds and adventitious sound
components (if they exist) separately to calculate the features,

1775

or, detection of the adventitious components to extract their distinctive characteristics to be incorporated in the classification,
are out of scope of this study. However, these are suggested for
future studies to improve the diagnostic ability.
The main contribution of this study is provided through the
hierarchical framework. Although the study in [5] addresses a
two-stage approach for classification of healthy, obstructive and
restrictive groups, the term two-stage does not refer to the hierarchical structure proposed in this study. Although the success
scores are higher in this study, a direct comparison between
the results of the two studies is not reliable, because in [5], the
subject dataset is different, the sounds are single-channel, and
the training and validation processes use odd-indexed and evenindexed segments, respectively, of the same data. This study
can be compared to [6], since it has been conducted as a further
step of improvement toward a diagnostic classifier, on the same
subject dataset.
SVM1SO of this study is equivalent to the three-class classifier of the study in [6], although the two use different kernel
functions. A comparison of the results of the two studies reveals
the performance improvements introduced by the GMM classifier and the hierarchical viewpoint. The recall rate of bronchiectasis has been increased from 30% to 60%, and the healthy
precision has been increased from 76% to 90%. Although the
total correct classification rate for the three-class classification
is not given explicitly in [6], it can be calculated (referring to
the corresponding confusion matrix) to be 80%, which has been
increased to 85% in this study. For the binary classification into
healthy versus pathological groups, the total correct classification rate has been increased from 85% to 90% with the use of
GMM.
VI. CONCLUSION
The results of this study suggest a hierarchical approach to be
adopted for diagnostic classification of pulmonary conditions,
i.e., first, a discrimination between healthy versus pathological
conditions, second, a discrimination between obstructive versus
restrictive types under the pathological condition. Although the
GMM classifier has been shown to be more successful compared to the SVM classifier, the probabilistic variants of the
SVM classifier are still suggested for future studies, depending
on the performances obtained in the augmented feature space.
The methodology of this study is proposed as a promising diagnostic framework to consider for clinical purposes. To improve
the methodology further, it is strongly suggested to incorporate
in the classifier the information obtained from various assessment layers of the data. Detection of adventitious sound components if they exist, extraction of their distinctive characteristics,
modeling the background pulmonary sounds separately, and
combining all the information in the diagnostic classifier, are
the primary suggestions for future studies on diagnostic classification of pulmonary sounds.
ACKNOWLEDGMENT
The authors would like to thank Sibel Yurt, MD, from Istanbul Yedikule Chest Disease and Thoracic Surgery Education

1776

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 7, JULY 2015

and Research Hospital for her guidance and advices on data
acquisition and diagnosis of pulmonary disorders of patients.
REFERENCES
[1] M. Abella et al., “Comparison of the acoustic properties of six popular
stethoscopes,” J. Acoust. Soc. Am., vol. 91, no. 4, pp. 2224–2228, 1992.
[2] B. Sankur et al., “Comparison of AR-based algorithms for respiratory
sounds classification,” Comput. Biol. Med., vol. 24, no. 1, pp. 67–76,
1994.
[3] S. Alsmadi and Y. P. Kahya, “Design of a DSP-based instrument for realtime classification of pulmonary sounds,” Comput. Biol. Med., vol. 38,
no. 1, pp. 53–61, 2008.
[4] S. Charleston-Villalobos et al., “Assessment of multichannel lung sounds
parameterization for two-class classification in interstitial lung disease
patients,” Comput. Biol. Med., vol. 41, no. 7, pp. 473–482, 2011.
[5] E. C. Guler et al., “Two-stage classification of respiratory sound patterns,”
Comput. Biol. Med., vol. 35, no. 1, pp. 67–83, 2005.
[6] I. Sen et al., “Computerized diagnosis of respiratory disorders—SVM
based classification of VAR model parameters of respiratory sounds,”
Method. Inform. Med., vol. 53, no. 4, pp. 291–295, 2014.
[7] L. Xiaoguang and M. Bahoura, “An integrated automated system for
crackles extraction and classification,” Biomed. Signal Process. Control.,
vol. 3, no. 3, pp. 244–254, 2008.
[8] I Sen et al., “Exploring an optimal vector autoregressive model for multichannel pulmonary sound data,” Comput. Meth. Prog. Bio., vol. 111,
no. 3, pp. 550–560, 2013.
[9] I. Sen and Y. P. Kahya, “A multi-channel device for respiratory sound data
acquisition and transient detection,” in Proc. IEEE Eng. Med. Biol. Soc.
Int. Conf., 2005, pp. 6658–6661.
[10] H. Lütkepohl, New Introduction to Multiple Time Series Analysis. New
York, NY, USA: Springer, 2005.
[11] E. Alpaydin, Introduction to Machine Learning. Cambridge, MA, USA:
MIT Press, 2010.
[12] C.-C. Chang and C.-J. Lin, “LIBSVM: A library for support vector machines,” ACM Trans. Intell. Syst. Technol., vol. 2, no. 3, pp. 27:1–27,
Apr. 2011.

Ipek Sen received the B.S., M.S., and Ph.D. degrees
in electrical and electronics engineering in 2002,
2005 and 2013, respectively, from Bogazici University, Istanbul, Turkey.
From 2002 to 2014, she was with Bogazici
University Lung Acoustics Laboratory. Her research
interests include biomedical instrumentation and signal processing, especially for pulmonary sounds
analysis.

Murat Saraclar (M’00) received the B.S. degree in
1994 from the Electrical and Electronics Engineering
Department, Bilkent University, Ankara, Turkey, the
M.S.E. degree in 1997 and the Ph.D. degree in 2001
from the Electrical and Computer Engineering Department, Johns Hopkins University, Baltimore, MD,
USA.
From 2000 to 2005, he was with the Multimedia
Services Department, AT&T Labs Research. In 2005,
he joined the Electrical and Electronics Engineering
Department, Bogazici University, Istanbul, Turkey,
where he is currently an Associate Professor. He was a Visiting Research Scientist at Google Inc., New York (2011–2012) and an Academic Visitor at IBM
T. J. Watson Research Center (2012–2013). He has more than 100 publications
in journals and conference proceedings. He was a Member of the IEEE Signal
Processing Society Speech and Language Technical Committee. He served as
an Associate Editor for IEEE SIGNAL PROCESSING LETTERS (2009–2012). He
is currently serving as an Associate Editor for IEEE TRANSACTIONS ON AUDIO,
SPEECH, AND LANGUAGE PROCESSING and he is on the editorial boards of Computer Speech and Language, and Language Resources and Evaluation.
Dr. Saraclar was awarded the AT&T Labs Research Excellence Award in
2002, the Turkish Academy of Sciences Young Scientist (TUBA-GEBIP) Award
in 2009, and the IBM Faculty Award in 2010.

Yasemin P. Kahya (M’92) received the B.S. degree
in electrical engineering and in physics from Bogazici
University, Istanbul, Turkey, with the highest honors
in 1980, the M.S. degree in engineering and applied
science from Yale University, New Haven, CT, USA,
in 1981, and the Ph.D. degree in biomedical engineering from Bogazici University in 1987.
She is a Professor and Chair in the Department
of Electrical and Electronics Engineering, Bogazici
University, where she has been teaching since 1988.
Her current research interests are in the areas of
biomedical instrumentation, respiratory acoustics and biomedical signal processing applications. She was the Program Cochair of IEEE-EMBS 2001 Conference which was held in Istanbul and has served on the Adcom of IEE-EMBS.

