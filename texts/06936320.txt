754

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Electronic Cleansing in Fecal-Tagging Dual-Energy
CT Colonography Based on Material Decomposition
and Virtual Colon Tagging
Wenli Cai∗ , June-Goo Lee, Da Zhang, Se Hyung Kim, Michael Zalis, and Hiroyuki Yoshida

Abstract—Dual-energy CT provides a promising solution to
identify tagged fecal materials in electronic cleansing (EC) for
fecal-tagging CT colonography (CTC). In this study, we developed
a new EC method based on virtual colon tagging (VCT) for minimizing EC artifacts by use of the material decomposition ability in dualenergy CTC images. In our approach, a localized three-material
decomposition model decomposes each voxel into a material mixture vector and the first partial derivatives of three base materials:
luminal air, soft tissue, and iodine-tagged fecal material. A Poissonbased derivative smoothing algorithm smoothes the derivatives and
implicitly smoothes the associated material mixture fields. VCT is
a means for marking the entire colonic lumen by virtually elevating the CT value of luminal air as high as that of the tagged fecal
materials to differentiate effectively soft-tissue structures from airtagging mixtures. A dual-energy EC scheme based on VCT method,
denoted as VCT-EC, was developed, in which the colonic lumen was
first virtually tagged and then segmented by its high values in VCT
images. The performance of the VCT-EC scheme was evaluated
in a phantom study and a clinical study. Our results demonstrated
that our VCT-EC scheme may provide a significant reduction of EC
artifacts.
Index Terms—Dual-energy CT (DE-CT), electronic cleansing
(EC), partial volume effect (PVE), virtual colonoscopy.

I. INTRODUCTION
ECAL tagging in CT colonography (CTC) is a promising
method for differentiating residual feces from colonic softtissue structures in CTC images by “marking” of fecal materials
with an oral contrast agent (iodine or barium) [1]–[5]. Electronic cleansing (EC), or digital bowel cleansing, is a promising
technique for identifying tagged fecal materials and subtracting
them from CTC images after image acquisition [6], [7]. The
goal of EC is to “virtually cleanse” the colon by removal of

F

Manuscript received April 5, 2013; revised March 20, 2014; accepted October
15, 2014. Date of publication October 24, 2014; date of current version January
16, 2015. This work was supported by Research Scholar Grant RSG-11-07601-CCE from the American Cancer Society. Asterisk indicates corresponding
author.
∗ W. Cai is with the Department of Radiology, Massachusetts General Hospital
and Harvard Medical School, Boston, MA 02114 USA (e-mail: cai.wenli@
mgh.harvard.edu).
J.-G. Lee is with the Department of Radiology, University of Pittsburgh,
Pittsburgh, PA 15260 USA (e-mail: junegoo.lee@gmail.com).
D. Zhang, M. Zalis, and H. Yoshida are with the Department of Radiology, Massachusetts General Hospital and Harvard Medical School, Boston,
MA 02114 USA (e-mail: zhangda82@gmail.com; mzalis@mgh.harvard.edu;
yoshida.hiro@mgh.harvard.edu).
S. H. Kim is with the Department of Radiology, Seoul National University
Hospital College of Medicine, Seoul 110-744, Korea (e-mail: shkim@radcom.
snu.ac.kr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2364837

tagged fecal materials that can obscure the colonic mucosal surface, and by preservation of colonic soft-tissue structures such
as folds and polyps.
The early work on EC dates back to the late 1990s [8]–[10].
The term “EC” was first introduced by Wax et al. [8]. After
more than a decade of investigation, EC has reached a level of
sophistication that allows for visualization of the entire colonic
surface [11]. Various EC methods have been developed, including voxel classification [12], [13], gradient-based edge detection
[7], [14], material transition [15], structure analysis [16], mosaic
decomposition [17], and hybrid methods [18]–[20]. However,
existing EC methods tend to generate artifacts and pitfalls in
cleansed CTC images, which impair the diagnostic performance
of cleansed CTC images [21], [22]. To our knowledge, none of
the existing EC methods provide a complete solution that is free
from artifacts. Therefore, artifact-free EC remains challenging
because of the cleansing artifacts that are observed with existing
EC methods, particularly in noncathartic fecal-tagging CTC.
Three major types of EC artifacts are categorized in terms of
their underlying imaging causes of the artifacts, including softtissue degradation (Type 1), pseudo soft-tissue structures (Type
2a), false fistula (Type 2b), false patch (Type 2c), and incomplete
cleansing (Type 3) [21], [22], as listed in Table I. Type 1 EC
artifacts are caused by the pseudoenhancement of the contrast
agent in the surrounding tagged fecal materials. Type 2(a-c) EC
artifacts are caused by the partial volume effect (PVE), which is
a mixture of CT numbers (attenuation values) of multiple materials in a single voxel. A typical mixture in fecal-tagging CTC
images caused by the PVE is the air-tagging boundary, which
is the contacting surface between air lumen and tagged fecal
residues. This air-tagging boundary not only has CT values significantly overlapping that of soft-tissue structures, but also may
have gradient values that are close to those of thin soft-tissue
structures [23]. Erroneous removal of a part of or the entire thin
soft-tissue structure (colonic folds or wall) that is sandwiched
between an air lumen and tagged regions causes a false fistula on
the colonic wall and folds, as shown in Fig. 1(a), whereas erroneous preservation of a part of or the entire air-tagging boundary,
especially at locations where an air-tagging boundary intersects
the colonic wall, creates pseudo soft-tissue structures, as shown
in Fig. 1(b). Type 3 EC artifacts are caused by inhomogeneous
tagging due to different contrast concentrations, and by mixtures
of air bubbles and food stuffs in the tagged fecal materials. The
PVE and tagging inhomogeneity are the major causes of EC
artifacts in existing EC methods. To address these artifacts, advanced methods, such as the morphological analysis [23] or statistical classification [13], have been proposed. However, these
solutions are heuristic and incomplete because EC involves

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

755

TABLE I
MAJOR EC ARTIFACTS AND PITFALLS COMMONLY OBSERVED IN EXISTING EC METHODS
Type
1) Soft-tissue structure degradation
2a) Pseudo soft-tissue structures
2b) False fistula

2c) False patch
3) Incomplete cleansing

Cause

Common Pitfalls

Inappropriate cleansing of folds and polyps submerged in
tagged fecal materials as tagged regions.
Failure to remove parts of or an entire air-tagging boundary.
Erroneous removal of parts of or an entire thin soft-tissue
structure (colonic fold or wall) sandwiched between the air
lumen and a tagged region.
Insufficient/over-cleansing at junctions where an air-tagging
boundary intersects the colonic wall.
Failure to remove inhomogeneously tagged fecal materials
such as air bubbles and untagged food stuffs.

Broken or shrunken folds, deformed or shrunken polyps.

Fig. 1. Demonstrations of type 2 EC artifacts caused by the PVE. (a) False
fistula (pointed by white arrows) caused by the erroneous removal of a soft-tissue
structure sandwiched between an air lumen and tagged regions. (b) Pseudo softtissue structures (pointed by white arrows) caused by the erroneous preservation
of air-tagging mixtures at the air-tagging boundary or at the locations where an
air-tagging boundary intersects the colonic wall.

multiple materials, including air, soft tissue, and tagged fecal
materials, and the determination of these material mixtures at
one voxel is an ill-posed condition if only one CT value is
considered. This cannot be completely solved as far as the conventional single-energy CT scan (such as X-ray tube voltage of
120 kVp) is used.
Dual-energy CT (DE-CT), which recently became widely
available in clinical practice owing to technical advances such
as dual-source CT [24] and rapid kVp switching [25], provides
a theoretical means for solving the material mixtures by an analysis of two CT values acquired simultaneously at two different
X-ray energies (such as 80 and 140 kVp) [26], [27]. The resulting material decomposition ability in DE-CT works especially
well for materials such as iodine [28], [29], which is a commonly used orally administered contrast agent in fecal-tagging
CTC [30]. Applying fecal-tagging dual-energy CTC (DE-CTC)
images in EC provides a promising solution to removal of the
residual fecal materials in CTC images while largely reducing
the major EC artifacts in existing EC methods, such as spectral
EC [31] and dual-energy index (DEI) EC [32]. The former is
based on a material-specific spectral response to identify and
segment tagged fecal materials, and the latter is based on the
DEI values of materials to identify the air and tagging mixture.
In this study, we developed a new EC method based on “virtual colon tagging” (VCT) using the three-material decomposition in DE-CTC images for minimizing EC artifacts, denoted
as VCT-EC. Different from our previous DEI-EC method [32],
which used DEI to differentiate soft tissue from other mate-

Pseudo folds/polyps, pseudo colonic wall.
False fistula on colonic wall or on folds.

Pseudo depressed or flat lesions.
Stalactite-like or stalagmite-like objects in the colonic
lumen.

rials, this paper presents a localized three-material decomposition model that decomposes each voxel into a mixture of
three base materials: air, soft tissue, and tagged fecal materials, and calculates the partial derivatives of the base materials.
A Poisson-based derivative smoothing algorithm smoothes the
derivatives and implicitly smoothes the associated scalar field,
i.e., the material mixture field of each base material. In order
to solve the ambiguity caused by the PVE of air-tagging mixture, VCT method virtually elevates the CT value of luminal
air as high as that of the tagged fecal materials for virtually
tagging the entire colonic lumen, which consists of luminal air,
tagged fecal materials, and their mixtures. A preliminary version of VCT-EC work appeared in IEEE EMBS 2012 [33]. This
paper presents the new technical developments on the localized material decomposition, the decomposition of first partial
derivatives, the Poisson-Based derivative smoothing, and the
segmentation of tagged regions in VCT images. Furthermore,
we present a colon phantom study and a clinical fecal-tagging
DE-CTC study to evaluate the performance of our VCT-EC
scheme. The results showed that VCT-EC provides a promising
solution to significant reduction of EC artifacts in the cleansing
of CTC images.
The remainder of the paper is organized as follows: Section
II introduces two major algorithms for VCT: a localized threematerial decomposition model and a Poisson-based derivative
smoothing algorithm, followed by the VCT method and the
VCT-EC scheme. Section III describes the experimental results
for evaluation of the VCT-EC scheme by use of a colon phantom
and of clinical DE-CTC cases. Sections IV and V present a
discussion and conclusions, respectively.
II. METHODS
A. Three-Material Decomposition Model
Suppose that the material at a point x m(x) is a mixture of three base materials M1 , M2 , and M3 , which can be
represented by
m (x) = p1 (x) M1 + p2 (x) M2 + p3 (x) M3

(1)

where pi is the mixture ratio or the relative amountof base material Mi inside the voxel at point x, and it satisfies 3i=1 pi = 1
and 0 ≤ pi ≤ 1.
In DE-CT imaging, there are two CT values at a point x,
uL (x) and uH (x), which are the CT values at low- (such as
80 kVp) and high-energy (such as 140 kVp), respectively.

756

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Because the CT value of an unknown material can be represented by the linear combination of known base materials, the
two CT values at a point x in DE-CT images (uL (x) , uH (x))
can be represented by
 L 
 L 
 L 
 L 
uM 1
uM 2
u 3
u (x)
= p1 (x) H + p2 (x) H + p3 (x) M
(2)
uM 1
uM 2
uH
uH (x)
M3
where (uLM i , uH
M i ) are the two CT values of base material Mi at
low and high X-ray energies, respectively.
Based on (1) and (2), we may form an equivalent linear system
A · P = U,
⎛ L
⎞
⎞ ⎛ L
⎞ ⎛
uM 1 uLM 2 uLM 3
u (x)
p1 (x)
⎜ H
⎟
⎟ ⎜ H
⎟ ⎜
(3)
uH
⎝ uM 1 uH
M2
M 3 ⎠ · ⎝ p2 (x) ⎠ = ⎝ u (x) ⎠
1

1

1

p3 (x)

1

where P (x) = (p1 (x) , p2 (x) , p3 (x)) is the material mixture
vector at point x.
In DE-CTC images, we may define the three base materials to be luminal air (M1 ), soft tissue (M2 ), and iodine-tagged
fecal material (M3 ). Existing DE-CT material decomposition
methods tend to employ a pair of constant CT values for each
base material throughout the entire DE-CT dataset [27], [34].
Generally speaking, CT values of air and soft tissue are relatively stable at a specified X-ray energy level. However, in
the case of fecal-tagging CTC, the CT values of tagged fecal materials differ substantially in terms of different bowel
preparation and tagging regimens. They vary substantially at
different parts of the colon and even within one tagged region. In order to apply material decomposition in DE-CTC
images, we developed a localized three-material decomposition model that uses the local CT values of base materials instead of a global constant, especially the local CT values of
tagged fecal materials at every points, to calculate the material
mixtures.
B. Localized Three-Material Decomposition
Suppose that (1) a single-material region is composed of only
one of the three base materials; and (2) a mixture region is
composed of single materials that are located in the vicinity of
the mixture.
Three types of single-material regions are defined by CT
values and gradient magnitudes [18], as well as the DEI [35] in
DE-CTC images, as follows:
Hair (x) = {∀x : u(x) < −800 HU
and|∇u(x)| < GHom o }
HST (x) = {∀x : − 150HU < u(x) < 150 HU

100; and DEI(x) = (HU L (x) − HU H (x))/(HU L (x) +
HU H (x) + 2000) [34].
Based on our supposition, the CT value of a mixture voxel is
affected by the neighboring single-material voxels. On the other
hand, each single-material voxel possesses a localized spatial
domain in which it contributes to the mixture of materials. For
simplicity, we assume that the spatial domain impacted by a
single-material voxel follows a normal distribution and its local
contribution can be approximated by a 3-D Gaussian function
with a standard deviation of σ. The size of the localized spatial
domain, or the impact space, is a local window size of 7σ + 1 in
which each element has a nonzero contribution (ࣙ 0.001) to the
mixture voxel. A large σ implies a wider Gaussian function and
a large impact space. Therefore, the local CT value of a base
material Mi at point x, uM i (x) can be estimated by a weighted
average of the neighboring single-material voxels in HM i (x),
as shown in
uM i (x) =

Gauss (0; x; σ) ∗(HM i (x) · u (x) )
Gauss (0; x; σ) ∗HM i (x)

(5)

where Gauss (0; x; σ) is an isotropic Gaussian function
with a mean value of 0 and a standard deviation of σ,
and binary operator (a ∗ b) represents a convolution. In our
study, we set σ = 3σ0 , where σ0 is one unit of the voxel
size.
By use of the local CT values of three base materials, uLM i (x)
and uH
M i (x), that are estimated in both high- and low-energy
images with (5), we may perform a localized three-material
decomposition for DE-CTC images by using (3). In case, there
are no single-material voxels for a specific base material in the
local window at point x, the default CT value of that material
is applied, which is calculated by the average CT values within
the entire region of HM i (x).
Fig. 2(a)-(b) shows a pair of DE-CTC images of a segmented
colonic region at both low and high energies. Fig. 2(c)–(e) displays the material mixture vectors, or the decomposed material mixture fields for luminal air, soft tissue, and tagged fecal
material, respectively, which were calculated by our localized
three-material decomposition model.
Suppose that the local CT values for the three base materials
are constants at point x. By taking the partial derivatives of
(3), we can calculate
of the material
 the first partial derivatives

∂ p i (x) ∂ p i (x) ∂ p i (x)
mixture vector P ,
, as follows:
∂x , ∂y , ∂z
⎛

uLM 1

⎜ H
⎝ uM 1
1

uLM 2

uLM 3

uH
M2

uH
M3

1

1

⎞ ⎛ ∂ p 1 (x)
∂ xi
⎟ ⎜
∂ p 2 (x)
⎜
⎠ · ⎝ ∂ xi
∂ p 3 (x)
∂ xi

⎞

⎛

∂ u L (x)
∂ xi

⎞

⎟ ⎜
⎟ = ⎝ ∂ u H (x) ⎟
⎠
⎠
∂ xi
0

(6)

and |∇u (x)| <GHom o and |DEI (x) |<0.015} where x = x, y, z. The partial derivatives ∂ u L (x) and ∂ u H (x)
i
∂ xi
∂ xi
can be calculated by a convolution of the partial derivatives of
Htagging (x) = {∀x : u(x) > 200 HU and |∇u (x)| < max
a Gaussian function and CT values at point x of the original
(GHom o , 0.5 ∗ u (x)) and DEI (x) > 0.1}
low- and high-energy images, uL (x) anduH (x). Thus, the
 first
L
L
L
∂
u
∂
u
∂
u
(4) partial derivatives in DE-CTC images, ∂ x , ∂ y , ∂ z and

 H
∂u
∂ uH ∂ uH
where u (x) and |∇u (x) | are the local CT value and gra, can be decomposed into the partial deriva,
,
∂x
∂y
∂z


dient magnitude at point x; GHom o is a predefined gradient
∂ pi ∂ pi ∂ pi
magnitude for the single-material region; we set GHom o = tives of three base materials ∂ x , ∂ y , ∂ z .

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

757

Fig. 2. Localized three-material decomposition model. (a–b) Pair of axial DE-CTC images of a colonic region at (a) low energy of 80 kVp and at (b) high
energy of 140 kVp. (c–e) Material mixture fields for (c) luminal air, (d) soft tissue, and (e) tagged fecal material. (f–h) Magnitude of first partial derivatives for
(f) luminal air, (g) soft tissue, and (h) tagged fecal material. The arrows point out an intersection between an air-tagging boundary and the colonic wall. Voxels at
the intersection region are mixtures of three base materials. Our three-material decomposition model clearly reveals the different local boundary structures at the
intersection for each base material, in which images (f, h) present a boundary along the air-tagging surface, whereas image (g) presents a continuous soft-tissue
boundary along the colonic wall at the intersection. The arrow heads in (d) indicate the inconsistency of mixtures of soft tissue at air-tagging boundaries caused
by strike artifacts.

Fig. 2(f)–(h) shows the magnitude of decomposed first partial derivatives, or gradient magnitude, for the material mixture fields of three base materials in Fig. 2(c)–(e), respectively;
they represent the local boundary structures with respect to
a specific base material. For example, at the intersection region pointed by the arrows, where an air-tagging boundary
intersects the colonic wall, our three-material decomposition
model clearly reveals the underlying local structure for each
base material. These decomposed first partial derivatives provide the information on local structures or boundaries of the base
materials.
C. Poisson-Based Derivative Smoothing
One of the major issues in DE-CT material decomposition is that image noise and artifacts tend to introduce the
inconsistency in the material mixture vectors. In the case of
Fig. 2, we applied a conventional Gaussian filter to the original DE-CTC images prior to material decomposition. Random
noise in three material mixture fields and the strike artifacts
at air-tagging boundaries in the soft-tissue mixture field [as
pointed out by the white arrow heads in Fig. 2(d)] are observed. We, thus, developed a Poisson-based derivative smoothing method that combined both the material mixtures and their
partial derivatives to produce a smoothed material mixture
field.

The Helmholtz–Hodge vector field decomposition [36] states
that a smooth 3-D vector field V can be uniquely decomposed into an irrotational part V irrot and a divergence-free part
(solenoidal) V sol . Thus,
V = V irrot + V sol = ∇φ + ∇ × v

(7)

where φ is a scalar potential field with ∇ × (∇φ) = 0, and
v is a vector potential field with ∇ · (∇ × v) = 0. Taking the
divergence of (7) yields
∇ · V = ∇2 φ.

(8)

Equation (8) is a Poisson equation for the scalar function φ,
2
2
2
in which ∇2 = ∂∂x 2 + ∂∂y 2 + ∂∂z 2 is the Laplacian operator, and
∂V

∇ · V = ∂∂Vxx + ∂ yy + ∂∂Vzz is the divergence of vector V =
(Vx , Vy , Vz ).
Let φi,j,k be the approximating solution at point (xi , yj , zk )
on a 3-D uniform discrete grid. The discrete Poisson equation
can be written as
6φi,j,k − (φi−1,j,k + φi+1,j,k + φi,j −1,k + φi,j +1,k + φi,j,k −1
+ φi,j,k +1 ) = −(∇ · V )x i ,y j ,z k .

(9)

Suppose that φi,j,k (t) is the approximation for φi,j,k after
the tth iteration, and bi,j,k = −(∇ · V )x i ,y j ,z k . We obtain the

758

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 3. Poisson-based derivative field smoothing. After five iterations of smoothing by using the discrete Poisson Equation (10), the mixture fields of (a) air, (b)
soft tissue, and (c) tagged fecal material are well smoothed while preserving local structures. Images are displayed with the same window level as those in Fig. 2
(c)–(e).

reduced, and the boundaries are well preserved in each material
mixture field.
D. Virtual Colon Tagging
Considering the fact that a colonic lumen consists of luminal air, tagged fecal materials, and their mixtures, whereas the
colonic wall is composed of soft tissue, EC is regarded as a
process for differentiating the colonic lumen from colonic wall.
Thus, we developed a VCT method that marks the entire colonic
lumen by virtually elevating the CT value of luminal air to be
as high as that of tagged fecal materials for virtually tagging the
entire colonic lumen.
Suppose that P (x) = (pair (x) , pST (x) , ptagging (x)) is
the material mixture vector at point x. Based on (2), VCT recalculates the CT value at each point, uV C T (x), by using
Fig. 4. (a) Diagram of the VCT-EC scheme. (b) Original 2-D transverse image
of the fused DE-CTC images before cleansing. (c) Cleansed 2-D transverse
images of (b) after the application of our VCT-EC scheme. All of the irregularshaped fecal residuals were completely cleansed, and the colonic wall and folds
were clearly visualized.

iterative numerical solution to the Poisson equation
φi,j,k (t + 1) = (φi−1,j,k + φi+1,j,k + φi,j −1,k + φi,j +1,k
+ φi,j,k−1 + φi,j,k+1 + bi,j,k )/6

(10)

where the initial estimation φi,j,k (0) = pm (xi , yj , zk ) and
bi,j,k = −(∇ · ( ∂∂pxm , ∂∂pym , ∂∂pzm ))i,j,k , in which pm is the mth
component of the initial material mixture vector estimated by
(3), and ∂∂pxmi is the first partial derivative of the base material m
estimated by (6).
The single-material regions defined by (4) are formulated as
the Dirichlet boundary condition of the Poisson equation, φ∗i,j,k ,
for base material m, as follows:

0; |(xi , yj , zk ) ∈
/ Hm
∗
(11)
φi,j,k |m =
1; |(xi , yj , zk ) ∈ Hm .
Equation (10) is a 3-D discrete form of the Jacobi algorithm
[37] and is guaranteed to converge because linear Equation (9)
is strictly diagonally dominant.
Fig. 3(a)–(c) displays the three mixture fields of air, soft tissue, and tagged fecal material, after performing five iterations
of the Poisson-based derivative smoothing based on (10). Compared to Fig. 2(c)–(e), we observed that noise is significantly

· pair (x) + uVSTC T · pST (x)
uV C T (x) = uVCT
air
+ uVCT
tagging · ptagging (x)

(12)

CT
where uVairC T , uVSTC T , and uVtagging
are constant CT values for
air, soft tissue, and tagged fecal material, respectively. In order
to solve the ambiguity caused by the overlapping CT values
between
 VCT  soft tissue and the air-tagging

mixture, we set both air
uair
and tagged materials uVCT
tagging as having substantially
higher CT values than that of soft tissue. For example, we may
V CT
set uVairC T = 600 HU, uVCT
= 0 HU, to
tagging = 500 HU, and uST
virtually enhance the entire colonic lumen as shown in Fig. 5(a).

E. VCT-EC Scheme
Based on our previously developed structural-analysis EC
(SA-EC) scheme [16], we have developed a dual-energy EC
scheme by using the dual-energy material decomposition model
and VCT method, denoted as VCT-EC. The major steps in the
VCT-EC scheme are illustrated in Fig. 4(a). In the VCT-EC
scheme, after the first step of initial segmentation of the colon,
material decomposition and VCT are applied to DE-CTC images
to generate VCT images of the colon [see Fig. 5(a)]. Then, the
local morphologic structures in the VCT images are analyzed to
enhance fold-like and polyp-like structures by use of the same
structural-enhancement functions as those in SA-EC, as shown
in Fig. 5(b). Finally, the entire virtually tagged colonic lumen
in the VCT images is segmented and then subtracted, except for
the enhanced fold-like and polyp-like structures, as indicated by
the red-colored mask in Fig. 5(c).

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

759

Fig. 5. VCT and EC of Fig. 2(a) and (b). (a) Virtual-colon-tagging image, in which both luminal air and tagged fecal materials are enhanced or marked.
(b) Structural-enhanced image of (a) after application of Hessian analysis. (c) Lumen segmented image, in which the red-colored mask indicates the segmented
colonic lumen including luminal air, tagged fecal material, and the air-tagging mixtures.

To segment the entire colonic lumen in VCT images and
subsequently remove (cleanse) them from the CTC images, we
employed a level-set method combined with the gradient field
(G), the VCT image (VCT), and the Hessian response field (H).
The level-set front is initialized by the enhanced regions in
VCT images, and it is evolved by use of the following partial
differential equation:
∂Φ/∂t = − (FH (x) + FV C T (x) + FG (x) + FS ) |∇Φ|
(13)
where x is the point on the level-set front and F is a speed
function. We employed the sparse-field implementation of the
level-set model [38], in which Φ is represented by the cityblock distance. The surface normal and curvature, which require
second-order derivatives, are calculated by the finite-difference
derivatives with using of a 3 × 3 × 3 kernel.
This evolution equation has three speed functions from images: the speed function of image gradients FG (x), which acts
as a growing term to expand the virtually tagged colonic lumen;
the speed function of the VCT images FV C T (x), which acts as
a stopping term for the level-set front at soft-tissue material, i.e.,
the colonic wall; and the speed function of the Hessian response
field FH (x), which acts as a stopping term for the level-set
front at the submerged soft-tissue structures in VCT images.
We employed the same form of a conventional threshold speed
function as that in SA-EC scheme [16]. These speed functions
are balanced with FS , which is a smoothing term of the shape
of the level-set front that is proportional to the mean curvature flow FS ∝ ∇(∇Φ/|∇Φ|) ensuring the numerical stability
of the forward-in-time, centered-in-space solution of the partial
differential [39].
Finally, the segmented entire colonic lumen was replaced with
air and followed by a mucosal smoothing filter [7] for reducing
the discontinuity between the subtracted layer and the original
soft-tissue layer. Fig. 4(b)–(c) demonstrates the effectiveness
of the VCT-EC scheme in cleansing the irregular-shaped and
inhomogeneously tagged fecal residuals and the corresponding
air-tagging boundaries.

III. EXPERIMENTS AND RESULTS
We conducted a phantom study and a clinical DE-CTC study
for evaluation of the cleansing quality and the clinical performance of polyp detection of the proposed VCT-EC scheme.

A. Phantom Study
In the phantom study, we used a custom-ordered anthropomorphic colon phantom (Phantom Laboratory, Salem, NY,
USA) that had features designed to resemble those observed in
conventional single-energy (120 kVp) CTC images. The phantom was made of a synthetic abdominal-fat material that had
a CT value of −100 ± 10 HU (120 kVp), cast around synthetic bony structures of a pelvis, two femurs, and three lumbar vertebrae. We installed a question-mark-shaped simulated
colon with a length of approximately 50 cm and diameters of
3.5–4.0 cm. The synthetic soft-tissue material of the colon had
CT values of 16 ± 5 HU (120 kVp). Twenty-four (24) polyps
ࣙ 6 mm were embedded randomly on the colonic surface of the
phantom including five pedunculated and 19 sessile-flat morphology. To simulate the tagged fecal materials in fecal-tagging
CTC, we filled the phantom, prior to imaging, with 300 cc of
simulated tagged fecal material, which was a mixture of aqueous
fiber (30 g of psyllium), ground food stuff (10 g of cereal), and
nonionic iodinated agent (300 cc of 20 mg/ml concentration of
Omnipaque iohexol, GE Healthcare)—the same contrast agent
that we used for clinical fecal-tagging CTC cases.
The phantom filled with the tagged materials (hereafter
called fecal-tagging phantom) was scanned by a DE-CT scanner
(SOMATOM Definition Flash, Siemens Healthcare) with two
imaging modes: the dual-energy mode (tube voltages: 80 and
140 kVp), denoted as DE-CTC scanning, and the single-energy
mode (tube voltage: 120 kVp), denoted as SE-CTC scanning. In
each imaging mode, we scanned the phantom nine times with
different tube current settings. By manually adjusting the tube
current in the single-energy mode, we scanned the phantom with
the same radiation dose as in the corresponding scan in dualenergy mode. Table II lists the tube currents in both imaging
modes, as well as the corresponding values of the CT radiation dose index (CTDIvol) exported by the scanner. For both
DE-CTC and SE-CTC scanning, we employed the same set of
reconstruction parameters: the soft-tissue reconstruction kernel
(B30f) and a 0.60-mm slice reconstruction interval. The fecaltagging phantoms in both modes, namely, the DE-CTC images
and SE-CTC images, were subjected to the VCT-EC and SA-EC
[16], respectively, for cleansing purposes, and thus generated a
cleansed phantom in each mode.
Before we filled in the tagged materials, the colon phantom
was scanned in a native state without having tagged materials
(hereafter called reference phantom) under the single-energy

760

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

TABLE II
NINE TUBE CURRENT SETTINGS AND CORRESPONDING VALUES OF THE CT
RADIATION DOSE INDEX (CTDIVOL) IN DUAL-ENERGY (DE-CTC) SCANNING
MODE AND IN SINGLE-ENERGY (SE-CTC) SCANNING MODE OF THE PHANTOM
EXPERIMENT

TABLE III
COMPARISONS OF THE PERFORMANCE OF THE CLEANSING RATIO AND
SOFT-TISSUE PRESERVATION RATIO BETWEEN VCT-EC AND SA-EC IN THE
PHANTOM EXPERIMENT
Dual-Energy EC (VCT-EC)

DE-CTC

Scan #

1
2
3
4
5
6
7
8
9

SE-CTC

Tube
Current at
140 kVp
(mAs)

Tube
Current at
80 kVp
(mAs)

Tube
Current at
120 kVp
(mAs)

12
15
20
30
40
50
60
70
74

60
75
100
150
200
250
300
350
370

41
51
68
101
135
168
202
236
249

CTDIvol
(mGy)

Scan #

1
2
3
4
5
6
7
8
9

2.79
3.50
4.65
6.83
9.10
11.34
13.65
15.92
16.77

mode (120 kVp) with the highest radiation dose (CTDIvol:
16.77 mGy, refer to Table II). CT images obtained from the
reference phantom served as the reference standard. Because
the phantom was removed from the CT table while it was being
filled with tagged materials, the fecal-tagging phantoms were
registered rigidly to the reference phantom by use of a 3-D
rigid-body transformation before the applications of VCT-EC
and SA-EC [40].
The colon mask segmented from the reference phantom
(Mcolon ), including the colonic air lumen and colonic wall with
a thickness of 10 voxels (approximate 6 mm), was classified into
air and soft tissue by the thresholding function Dair as follows:

1(air),
if I (x) < −800 HU
Dair (x ∈ Mcolon ) =
0(soft tissue),
otherwise.
(14)
For evaluation of the cleansing quality, we employed two EC
quality metrics the cleansing ratio (REC ) and the soft-tissue
preservation ratio (RST ). An ideal EC will have REC = 100%
and RST = 100%. REC was defined as the ratio of the number
of voxels in the tagging regions that were cleansed, i.e., those
that became air voxels in the cleansed phantom (IEC ), to the
total number of voxels in the tagging regions
Size{∀x, x ∈ Mtagging : Dair (x|IE C ) = 1}
× 100%
Size{Mtagging }
(15)
where the tagging regions (Mtagging ) were defined as the regions
of the air lumen in the reference phantom (Ireference ) that were
covered by the tagged materials in the fecal-tagging phantom
(Itagging )
REC =

Mtagging = {∀x, x ∈ Mcolon : Dair (x|Ireference ) = 1
∩ Dair (x|Itagging ) = 0}.

(16)

In a similar manner, we defined the colonic soft-tissue region
(MST ) and the ratio of soft-tissue preservation (RST )
MST = {∀x, x ∈ Mcolon : Dair (x|Ireference ) = 0}

(17)

RST =

Single-Energy EC (SA-EC)

Cleansing
Ratio
(R E C )

Soft-tissue
Preservation
Ratio
(R S T )

Cleansing
Ratio
(R E C )

Soft-tissue
Preservation
Ratio
(R S T )

95.36%
95.48%
95.52%
95.63%
95.66%
95.65%
95.71%
95.74%
95.74%

96.73%
97.05%
97.40%
97.64%
97.91%
97.95%
97.99%
98.06%
98.09%

95.26%
95.46%
95.50%
95.53%
95.58%
95.60%
95.62%
95.60%
95.59%

95.75%
95.80%
95.93%
95.94%
95.97%
95.99%
95.97%
95.97%
95.98%

Size{∀x, x ∈ MS T |Dair (x|IE C ) = 0}
× 100%.
Size{MST }

Table III lists the performance of the cleansing ratio (REC )
and the soft-tissue preservation ratio (RST ) of both VCT-EC
and SA-EC in nine DE-CTC and SE-CTC scans of the phantom.
Under the condition of the same radiation dose, a paired t-test
showed that VCT-EC demonstrated a significantly better performance (p ࣘ 0.001) on both REC and RST than those of SA-EC.
The results demonstrated that dual-energy EC can achieve better EC performance compared to conventional single-energy EC
with less radiation dose.
To assess the performance of polyp detection in cleansed CTC
images, we conducted two experiments: an observers’ performance experiment and a computer-aided detection (CAD) experiment to find polyps in CTC images cleansed by VCT-EC
and SA-EC, respectively. The per-polyp true-positives (TPs) and
false-positives (FPs) were used as the evaluation metrics of the
performance.
In the experiment of observers’ performance of polyp detection, two radiologists read the nine scans of DE-CTC phantoms and SE-CTC phantoms cleansed by VCT-EC and SA-EC
schemes, respectively, in the order of radiation dose CTDIvol.
from low to high. Table IV lists the averaged per-polyp performance of both VCT-EC and SA-EC schemes in the nine
DE-CTC and SE-CTC scans of the phantom.
In the CAD of polyp experiment, we employed a CAD scheme
that detects all “bumps” (polyp candidates) on the colonic wall
based on local shapes calculated from Hessian analysis [41].
Because image texture features change substantially at different
radiation doses, we turned off the texture-based FP reduction
procedure and evaluated the CAD performance of cleansed CTC
images by using the initial detection of all polyp candidates.
Table V lists the CAD performance of polyp detection in both
VCT-EC and SA-EC in nine DE-CTC and SE-CTC scans.
In both experiments, we observed that the numbers of FPs
from VCT-EC is in average 60% less than those from SA-EC
based on the same or superior TPs. This indicated a significant
reduction of pseudo soft-tissue structures caused by EC artifacts
in VCT-EC images compared to those in SA-EC images. Both

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

761

TABLE IV
AVERAGE PERFORMANCE OF POLYP DETECTION IN CTC IMAGES CLEANSED BY VCT-EC AND SA-EC IN THE PHANTOM STUDY
Dual-Energy EC (VCT-EC)
ࣙ6 mm (n = 24)

ࣙ10 mm (n = 14)

1
2
3
4
5
6
7
8
9

ࣙ6 mm (n = 24)

ࣙ10 mm (n = 14)

Scan #

TPs

FPs

TPs

FPs

TPs

FPs

TPs

FPs

1
2
3
4
5
6
7
8
9

20.5
20.0
21.5
22.0
23.0
23.0
22.0
23.0
23.0

3.0
1.5
2.5
2.0
1.0
1.0
1.0
0.5
0.5

13.5
13.5
14.0
14.0
14.0
14.0
14.0
14.0
14.0

0
0
0
0
0
0
0
0
0

19.5
19.5
21.0
20.0
20.0
20.5
21.0
21.0
21.0

7.5
6.5
5.0
5.5
5.5
6.5
5.5
5.0
5.0

13.5
13.5
13.5
13.5
13.5
13.5
13.5
13.5
13.5

0.5
0
0
0
0
0
0
0
0

TABLE V
CAD PERFORMANCE FOR POLYP DETECTION IN CTC IMAGES CLEANSED BY
VCT-EC AND SA-EC IN THE PHANTOM STUDY

Scan #

Single-Energy EC (SA-EC)

Dual-Energy EC (VCT-EC)

Single-Energy EC (SA-EC)

TPs

FPs

TPs

FPs

21
23
22
22
22
21
22
22
22

28
18
18
18
15
6
11
12
11

21
21
21
21
22
20
21
21
21

43
41
37
36
36
39
36
40
36

The CAD performance of the reference phantom is TPs: 21 and FPs: 26.

experiments demonstrated that VCT-EC applied to DE-CTC
scans may achieve a better performance in polyp detection than
that of SA-EC to SE-CTC at the same levels of radiation dose.
B. Clinical Study
For the clinical evaluation of our VCT-EC scheme, we retrospectively collected 21 adult outpatients (>18 years) who had
symptoms suggestive of colorectal cancer and a clinical need for
whole-colon examination. The 21 symptomatic patients underwent a 24-hour bowel preparation with a low-fiber, low-residue
diet, and oral administration of 50 ml of nonionic iodine contrast agent (300 mg/ml concentration of Omnipaque iohexol, GE
Healthcare). DE-CT scanning (SOMATOM Definition Flash,
Siemens Healthcare) was performed at tube voltages of 140
and 80 kVp with the automatic dose exposure control module
(CARE Dose 4D) in both supine and prone positions. For both
supine and prone scans, we used the soft-tissue reconstruction
kernel (B30f) and a 0.625-mm slice reconstruction interval. In
addition, all subjects had a video-assisted optical colonoscopy
in one week after the DE-CTC examination, which served as
the reference standard for the presence of polyps.
Of the 21 patients, ten patients were diagnosed positives for
polyps ࣙ10 mm, 15 positives for polyps ࣙ8 mm, and 16 positives for polyps ࣙ6 mm. In total, there were 33 pathologyconfirmed polyps ࣙ6 mm in these 21 patients, in which there

were 13 polyps ࣙ10 mm and 19 polyps ࣙ8 mm. Eight (8) polyps
were found to be submerged in tagged fecal materials at supine
position and 9 submerged polyps at prone position.
1) Visual Assessment of EC Artifacts: We applied both the
VCT-EC and V3D-EC (Version 3.2.3.0, Viatronix, Inc.) to all
of the 21 clinical fecal-tagging DE-CTC cases (both supine
and prone positions), in which V3D-EC was applied to the
standard fused DE-CTC images with a mixing of 30% 80
kVp and 70% 140 kVp [i.e., 0.3 · uL (x) + 0.7 · uH (x)]. A
visual assessment was conducted for evaluating the EC quality by marking of the regions with EC artifacts observed in
the fly-through of the colon on a 3-D CTC workstation (V3D,
Viatronix Inc.). All of the marked regions were categorized
into five types of EC artifacts based on Table I in terms of
the dominant artifacts in each region. The results are summarized in Table VI. We observed that the total number of EC
artifacts in VCT-EC was reduced significantly by 83% compared to V3D-EC. In particular, the number Type 2a EC artifacts (pseudo soft-tissue structures), which may mimic polyp
structure and is the major source of FPs in polyp detection, were
reduced approximately 96%. This demonstrates that VCT-EC
may substantially reduce the FPs of polyp detection in cleansed
CTC images. In addition, we examined all of the 15 Type
1 EC artifacts (soft-tissue degradation) in VCT-EC and confirmed that they were caused by the thin broken folds that were
submerged in the tagged materials instead of the submerged
polyps.
Fig. 6 demonstrates a group of virtual colonoscopic snapshots taken while flying through the colons that were cleansed
by V3D-EC and VCT-EC, respectively. Compared to the original images before cleansing (left column), we observed various types of EC artifacts in the V3D-EC-cleansed images in
the middle column, as pointed out by the white arrow lines.
In the right column, in which the images were generated after
the application of the VCT-EC scheme, all images were free
from any of the types of EC artifacts observed in V3D-EC.
The middle row shows a false-negative example of V3D-EC,
in which the submerged polyp was erroneously cleansed (Type
1 artifact), whereas the air-tagging boundary was erroneously
preserved (Type 2a artifact) after the application of V3D-EC.
These artifacts were not observed in the VCT-EC-cleansed
images.

762

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

Fig. 6. Comparison of virtual colonoscopic images cleansed by V3D-EC and VCT-EC in the clinical experiment. Left column was the results from the original
images before the application of EC. Middle column was the results from the V3D-EC. Right column was the results from the VCT-EC scheme. White arrow lines
indicate the types of EC artifacts.

2) Observers’ Performance of Polyp Detection: The observers’ performance of polyp detection in VCT-EC was
assessed by two experienced radiologists, who were blind to
the pathology reports and the original fecal-tagging CTC images. They read the 21 cleansed DE-CTC cases by the proposed
VCT-EC scheme to find the polyps by recording the size and
location of each finding, as well as the confidence score regarding whether each finding is a polyp ࣙ6 mm. The confidence
score is a scale ranging from 1 to 10, in which 1 indicates “definitely no polyp present,” and 10 indicates “definitely there is a
polyp present.” A score larger than 5 indicates a polyp finding.
The reading results were analyzed in two ways: 1) individual
patient detection (per-patient analysis) and 2) individual polyp

detection (per-polyp analysis). The per-patient analysis is summarized in Table VII: VEC-EC yielded an average sensitivity
of 90.6%, 93.3%, and 95.0% for polyps ࣙ6 mm, ࣙ8 mm, and
ࣙ10 mm, respectively. The per-polyp analysis is summarized
in Table VIII. For six missed polyps ࣙ8 mm (false-negative)
(five from reader 1 and one from reader 2), only one of them
was submerged in tagged materials at prone position and, thus,
was a cleansed polyp by VCT-EC. Five (5) of six false-negative
findings were sessile-flat morphology.
A polyp conspicuity assessment was also conducted between
cleansed polyps and air-exposed native polyps. Table IX summarizes the confidence scores of both readers in the detection
of polyps. The confidence scores were compared in two ways:

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

TABLE VI
NUMBERS OF EC ARTIFACTS OBSERVED IN THE VISUAL ASSESSMENT
EXPERIMENT OF 21 DE-CTC CASES CLEANSED BY THE VCT-EC AND
V3D-EC (VIATRONIX, INC.)
EC Artifact Type
1
2a
2b
2c
3
Total

V3D-EC

VCT-EC

Reduction

56
121
38
70
30
315

15
5
12
14
9
55

41 (73%)
116 (96%)
26 (68%)
56 (80%)
21 (70%)
260 (83%)

1) we analyzed all of the 33 polyps ࣙ6 mm, i.e., 66 confidence
scores in both supine and prone positions; 2) Of 17 polyp cases
submerged in either supine (8) or prone (9) scans, we compared
the confidence scores of 13 polyps submerged in tagged materials at one position (thus cleansed), whereas exposed in the
luminal air at another position. The results indicate that the submerged polyps after the application of VCT-EC, aka “Cleansed
Polyps,” have no statistically significant difference in visual
appearance from “Air-Exposed” nonsubmerged polyps with respect to the confidence scores for detection of colonic polyps.
IV. DISCUSSION
One limitation of the observers’ performance experiment in
the phantom study is that the readers’ performance in the succeeding readings may be biased by the preceding readings considering the fact that the location and size of the polyps are fixed
in the phantom. To minimize this bias, readers were required to
read these cases in the order of radiation dose from low to high
by assuming that low-dose CTC scans may have lower TPs and
higher FPs than high-dose CTC scans. In addition, the readers
were required to make the decision of a polyp based on its shape
and appearance instead of their memory of the location and size
of the polyps in the preceding readings. On the other hand, the
CAD experiment may be more consistent by applying the same
detection criteria of “bumps” to each phantom scan. These two
experiments are complementary to evaluate the image quality
and the clinical performance of the cleansed CTC images.
We also noticed that the DE-CTC phantom cleansed by the
VCT-EC scheme had similar or superior performance with regards to both TP and FP compared to not only the SA-EC
cleansed phantom but also the reference phantom, i.e., the native
phantom without the filling of tagging materials. This outperformance may be caused by several reasons: 1) the major part of
the colonic surface in the phantom was submerged underneath
the tagged materials and, thus, are cleansed artifacts-free by the
VCT-EC; 2) the cleansed phantom presents a clear boundary
between luminal air and colonic wall because the “filled-air”
by VCT-EC had a uniform CT value of −1000 HU; and 3)
the reconstructed colonic surface is smoothed by our mucosal
smoothing filter [7], which significantly reduced the PVE and
image noise in the colonic wall compared to the reference phantom. The PVE and noise may affect the calculation of second
partial derivatives in the detection of local structures, and thus
result in the higher FP detection in the reference phantom compared to VCT-EC cleansed phantoms.

763

Some parameters in our VCT-EC were set empirically. We
did not explore the possibility to optimize them further in this
paper because an optimal setting of the parameters may be
related to the specific DE-CTC imaging protocols and to the
bowel preparation and tagging methods. Thus, we chose the
parameters to be general, not optimized for our specific DECTC scanning and bowel preparation.
The gradient magnitude threshold GHom o for the singlematerial region in (4) was set to 100, which was based on the
noise level in standard fused DE-CTC images. Low-dose DECTC images may present a high noise level, and thus GHom o
may need to be adjusted. In addition, the CT values for classification of the three base materials in the homogeneous regions
were defined based on common knowledge. We set the CT value
of soft tissue had a large range from −150 to 150 HU in order
to cover both fat and soft-tissue materials in the colonic regions.
The threshold for tagged regions was also adjustable based on
the fecal-tagging protocols. We employed a commonly used
value of 200 HU for tagged materials. To deal with the inhomogeneity caused by different contrast concentration, we employed
an adjustable gradient threshold for identifying single-material
regions of tagged fecal residuals, which is similar to the method
in [18].
The window size of the Gaussian function in (5) was calculated based on the minimum nonzero contribution defined by
the function. In this study, we defined the minimum threshold for a nonzero contribution to be ࣙ0.001. Considering a
Gaussian function with a mean of 0 and a standard deviation
of 1, Gauss (0; x; 1), the inverse of Gaussian function returns
approximately 3.09 for errors <0.001 on both side of the function. Thus, the size of the local window can be estimated to be
2 ∗ 3.09 ∗ σ + 1 for Gauss (0; x; σ) with a mean value of 0 and
a standard deviation of σ. Considering the uniform discrete grid
of the data, we thus defined the window size to be 7 ∗ σ + 1 to
ensure the accuracy of the contribution to be ࣙ 0.001.
Strictly speaking, the standard deviation σ in the Gaussian
function may be determined by the underlying point-spreadfunction in CT reconstruction, which can be approximately by a
3-D Gaussian function [42]. Because we employed isotropic reconstruction, i.e., the slice thickness of DC-CTC images equals
the on-plane resolution, which was approximately 0.6 mm, the
standard deviation σ was set empirically to be 3.0 in voxel units.
It is possible that σ could be optimized for different DE-CTC
imaging protocols. However, the determination of an optimal
point-spread function is beyond the scope of this paper and
the optimal values may not significantly affect the resulting CT
values of local base materials, particularly after smoothing.
In the calculation of VCT images (12), by setting of uVairC T >
CT
CT
uVtagging
such as uVairC T = 600 HU and uVtagging
= 500 HU,
air-tagging boundaries in VCT images have a reversed gradient
direction compared to that in the original CTC images. This
may provide an additional means of distinguishing air-tagging
boundaries from boundaries between soft tissues and tagged
fecal materials.
Although dual-energy EC represents promising technical advances in CTC, the main limitation of DE-CTC scanning is the
increased radiation dose, which is one of the major concerns
for the application in clinical practice. Therefore, reduction of
the radiation dose is clinically significant for the application of

764

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 2, FEBRUARY 2015

TABLE VII
PER-PATIENT READERS’ PERFORMANCE OF POLYP DETECTION IN DE-CTC IMAGES CLEANSED BY VCT-EC SCHEME
ࣙ6 mm (n = 16)

Reader 1
Reader 2

ࣙ8 mm (n = 15)

ࣙ10 mm (n = 10)

Sensitivity

Specificity

Sensitivity

Specificity

Sensitivity

Specificity

14/16 (87.5%)
15/16 (93.8%)

3/5 (60.0%)
5/5 (100.0%)

13/15 (86.7%)
15/15 (100.0%)

5/6 (83.3%)
6/6 (100.0%)

9/10 (90.0%)
10/10 (100.0%)

11/11 (100.0%)
11/11 (100.0%)

Of the 21 patients, ten patients were diagnosed positives for polyps ࣙ10 mm, 15 positives for polyps ࣙ8 mm, and 16
positives for polyps ࣙ6 mm.

TABLE VIII
PER-POLYP READERS’ PERFORMANCE OF POLYP DETECTION IN DE-CTC IMAGES CLEANSED BY VCT-EC SCHEME
ࣙ6 mm (n = 33)

Reader 1
Reader 2

ࣙ8 mm (n = 19)

ࣙ10 mm (n = 13)

TPs

FPs

TPs

FPs

TPs

FPs

21
27

3
5

14
18

2
1

11
12

0
1

Of the 33 pathology-confirmed polyps ࣙ6 mm, there were 13 polyps ࣙ10 mm and 19 polyps ࣙ8 mm.

TABLE IX
COMPARISON OF POLYPS CONFIDENCE SCORES BETWEEN SUBMERGED POLYPS CLEANSED BY VCT-EC AND AIR-EXPOSED NATIVE POLYPS
All polyps ࣙ6 mm

Reader 1
Reader 2

Paired polyps submerged at one position

Cleansed (n = 17)

Air-Exposed (n = 49)

p-value

Cleansed (n = 13)

Air-Exposed (n = 13)

p-Value

5.7
7.0

6.5
7.1

0.52
0.93

9.0
8.1

8.2
8.0

0.52
0.68

DE-CTC scanning. Our phantom experiment demonstrated the
feasibility and the effectiveness of applying VCT-EC to lowdose DE-CTC. VCT-EC can achieve better image quality compared to SA-EC applied to conventional single-energy CTC, but
with a less radiation dose. Thus, VCT-EC has the potential to
maintain the quality of EC with a substantially reduced radiation
dose in DE-CTC imaging. Detailed investigation of the effect
of VCT-EC for low-dose DE-CTC is one of our major future
research work.
Another subject for future research work is the reduction of
the high computational cost of the present VCT-EC scheme.
It takes approximately 30 to 40 min to cleanse the DE-CTC
images from a scan of a patient on a standard PC. We are developing a high-performance computing platform (HPC-Platform)
[43] for conventional EC as well as for the dual-energy EC by
optimization and parallelization of the EC codes. The preliminary evaluation of the performance on an eight-core computer
(Intel Xeon series, 3 GHz, 16-GB memory) showed that the
HPC-Platform can effectively reach an approximately tenfold
reduction of the execution time for EC.
V. CONCLUSION
This paper presents a dual-energy EC method based on material decomposition and VCT, which provides an effective solution for significantly reduction of EC artifacts. Unlike the
existing EC methods for conventional single-energy CTC, our
VCT-EC method can accurately and precisely decompose each

voxel into a mixture of three base materials: air, soft tissue,
and tagged material, and then virtually marks the entire colonic
lumen by use of the material mixtures of air and tagged materials. In the virtual-colon-tagging images, colonic soft-tissue
structures can be clearly differentiated from the air-tagging mixtures. Initial evaluation based on the colon phantom and clinical
DE-CTC cases showed that our VCT-EC scheme provides a very
promising solution for a significantly reduction of EC artifacts,
and it may lead to artifact-free visualization of the colon.
REFERENCES
[1] M. R. Callstrom, C. D. Johnson, J. G. Fletcher, J. E. Reed, D. A. Ahlquist,
W. S. Harmsen, K. Tait, L. A. Wilson, and K. E. Corcoran,, “CT colonography without cathartic preparation: Feasibility study,” Radiology, vol.
219, pp. 693–698, 2001.
[2] M. E. Zalis, J. Perumpillichira, C. Del Frate, and P. F. Hahn, “CT colonography: Digital subtraction bowel cleansing with mucosal reconstruction:
Initial observations,” Radiology, vol. 226, pp. 911–917, Mar. 2003.
[3] P. A. Lefere, S. S. Gryspeerdt, M. Baekelandt, and B. G. Van Holsbeeck,
“CT colonography after fecal tagging with a reduced cathartic cleansing
and a small volume of barium,” Amer. J. Roentgenol., vol. 182, pp. 75–76,
2004.
[4] P. Lefere, S. Gryspeerdt, M. Baekelandt, and B. Van Holsbeeck, “Laxativefree CT colonography,” Amer. J. Roentgenol., vol. 183, pp. 945–948, Oct.
2004.
[5] R. Iannaccone, A. Laghi, C. Catalano, F. Mangiapane, A. Lamazza, A.
Schillaci, G. Sinibaldi, T. Murakami, P. Sammartino, M. Hori, F. Piacentini, I. Nofroni, V. Stipa, and R. Passariello, “Computed tomographic
colonography without cathartic preparation for the detection of colorectal
polyps,” Gastroenterology, vol. 127, pp. 1300–1311, Nov. 2004.
[6] M. E. Zalis and P. F. Hahn, “Digital subtraction bowel cleansing in CT
colonography,” Amer. J. Roentgenol., vol. 176, pp. 646–648, 2001.

CAI et al.: ELECTRONIC CLEANSING IN FECAL-TAGGING DUAL-ENERGY CT COLONOGRAPHY BASED ON MATERIAL DECOMPOSITION

[7] M. E. Zalis, J. Perumpillichira, and P. F. Hahn, “Digital subtraction bowel
cleansing for CT colonography using morphological and linear filtration methods,” IEEE Trans. Med. Imag., vol. 23, no. 11, pp. 1335–1343,
Nov. 2004.
[8] M. Wax, Z. Liang, R. Chiou, A. Kaufman, and A. Viswambharan, “Electronic colon cleansing for virtual colonscopy,” in Proc. 1st Symp. Virtual
Colonscopy, Boston, MA, USA, 1998, p. 94.
[9] Z. Liang, F. Yang, M. Wax, J. Li, J. You, A. Kaufman, L. Hong, H.
Li, and A. Viswambharan, “Inclusion of a priori information in segmentation of colon lumen for 3D virtual colonoscopy,” in Proc. IEEE
Nuclear Sci. Soc. – Med. Imag. Conf., Albuquerque, NM, USA, 1997,
pp. 1423–1427.
[10] Z. Liang, D. Chen, R. Chiou, B. Li, A. Kaufman, M. Wax, and A. Viswambharan, “On segmentation of colon lumen for virtual colonoscopy,” in Proc.
SPIE Med. Imag., San Diego, CA, USA, 1999, pp. 270–278.
[11] W. Cai and H. Yoshida, “Electronic cleansing in ct colonography: Past,
present, and future,” in Proc. 2nd Int. Conf. Virtual Colonoscopy Abdominal Imag., 2011, pp. 1–8.
[12] D. Chen, Z. Liang, M. R. Wax, L. Li, B. Li, and A. E. Kaufman, “A novel
approach to extract colon lumen from CT images for virtual colonoscopy,”
IEEE Trans. Med. Imag., vol. 19, no. 12, pp. 1220–1226, Dec. 2000.
[13] Z. Wang, Z. Liang, X. Li, L. Li, B. Li, D. Eremina, and H. Lu, “An improved electronic colon cleansing method for detection of colonic polyps
by virtual colonoscopy,” IEEE Trans. Bio-Med. Eng., vol. 53, no. 8, pp.
1635–46, Aug. 2006.
[14] S. Lakare, D. Chen, L. Li, A. Kaufman, and Z. Liang, “Electronic colon
cleansing using segmentation rays for virtual colonoscopy,” in Proc. SPIE
Med. Imag., San Diego, CA, USA, 2002, pp. 412–418.
[15] I. W. Serlie, R. Truyen, J. Florie, F. Post, L. van Vliet, and F. M. Vos, “Computed cleansing for virtual colonoscopy using a three-material transition
model,” in Proc. 6th Int. Conf. Med. Image Comput. Comput.-Assisted
Intervention, Montreal, QC, Canada, 2003, pp. 175–83.
[16] W. Cai, M. E. Zalis, J. Näppi, G. J. Harris, and H. Yoshida, “Structureanalysis method for electronic cleansing in cathartic and non-cathartic CT
colonography,” Med. Phys., vol. 35, pp. 3259–77, Jul. 2008.
[17] W. Cai, J. G. Lee, M. E. Zalis, and H. Yoshida, “Mosaic decomposition:
An electronic cleansing method for inhomogeneously tagged regions in
noncathartic CT colonography,” IEEE Trans. Med. Imag., vol. 30, no. 3,
pp. 559–574, 2011.
[18] M. J. Carston, A. Manduca, and D. Johnson, “Electornic stool subtraction using quadratic regression, morphological operations, and distance
transform,” in Proc. SPIE Med. Imag.: Physiol., Function, Structure From
Med. Images, San Diego, CA USA, 2007, pp. 6511W 1–6511W 12.
[19] M. Franaszek, R. M. Summers, P. J. Pickhardt, and J. R. Choi, “Hybrid
segmentation of colon filled with air and opacified fluid for CT colonography,” IEEE Trans. Med. Imag., vol. 25, no. 3, pp. 358–368, Mar. 2006.
[20] M. G. Linguraru, N. Panjwani, J. G Fletcher, and R. M Summer, “Automated image-based colon cleansing for laxative-free CT colonography
computer-aided polyp detection,” Med. Phys., vol. 38, no. 12, p. 6633,
2011.
[21] P. J. Pickhardt and J. H. Choi, “Electronic cleansing and stool tagging in
CT colonography: Advantages and pitfalls with primary three-dimensional
evaluation,” Amer. J. Roentgenol., vol. 181, pp. 799–805, Sep. 2003.
[22] W. Cai, H. Yoshida, M. E. Zalis, J. Näppi, and G. J. Harris, “Informatics in radiology: Electronic cleansing for noncathartic CT colonography: A structure-analysis scheme,” RadioGraphics, vol. 30, pp. 585–602,
May/Jun. 2010.
[23] W. Cai, H. Yoshida, M. E. Zalis, and J. Näppi, “Delineation of tagged
region by use of local iso-surface roughness in electronic cleansing for
CT colonography,” in Proc. SPIE Med. Imag.: Comput.-Aided Diagnosis,
2007, pp. 65141–65149.
[24] T. G. Flohr, C. H. McCollough, H. Bruder, M. Petersilka, K. Gruber, C.
Suss, M. Grasruck, K. Stierstorfer, B. Krauss, R. Raupach, A. N. Primak,
A. Kuttner, S. Achenbach, C. Becker, A. Kopp, and B. M. Ohnesorge,
“First performance evaluation of a dual-source CT (DSCT) system,” Eur.
Radiol., vol. 16, no. 6, pp. 1405–1405, 2006.
[25] X. Wu, D. A. Langan, D. Xu, T. M. Benson, J. D. Pack, A. M. Schmitz,
E. J. Tkaczyk, L. Jaynne, and P. Licato, “Monochromatic CT image representation via fast switching dual kVp,” in Proc. SPIE Med. Imag., vol.
7258, p. 725845, 2009.

765

[26] M. Bazalova, J. Carrier, L. Beaulieu, and F. Verhaegen, “Dual-energy
CT-based material extraction for tissue segmentation in Monte Carlo dose
calculations,” Phys. Med. Biol., vol. 53, no. 9, pp. 2439–2456, 2008.
[27] T. R. Johnson, B. Krauss, M. Sedlmair, M. Grasruck, H. Bruder, D.
Morhard, C. Fink, S. Weckbach, M. Lenhard, B. Schmidt, T. Flohr, M.
F. Reiser, and C. R. Becker, “Material differentiation by dual energy CT:
Initial experience,” Eur. Radiol., vol. 17, pp. 1510–1517, Jun. 2007.
[28] E. Roessl and R. Proksa, “K-edge imaging in x-ray computed tomography
using multi-bin photon counting detectors,” Phys. Med. Biol., vol. 52,
no. 15, pp. 4679–4696, 2007.
[29] J. P. Schlomka, E. Roessl, R. Dorscheid, S. Dill, G. Martens, T. Istel, C.
Baumer, C. Herrmann, R. Steadman, G. Zeitler, A. Livne, and R. Proksa,
“Experimental feasibility of multi-energy photon-counting K-edge imaging in pre-clinical computed tomography,” Phys. Med. Biol., vol. 53, no.
15, pp. 4031–4047. 2008.
[30] M. E. Zalis, J. J. Perumpillichira, C. Magee, G. Kohlberg, and P. F. Hahn,
“Tagging-based, electronically cleansed CT colonography: evaluation of
patient comfort and image readability,” Radiology, vol. 239, pp. 149–159,
Apr. 2006.
[31] R. Eliahou, Y. Azraq, R. Carmi, S. Y. Mahgerefteh, and J. Sosna, “Dualenergy based spectral electronic cleansing in non-cathartic computed tomography colonography: An emerging novel technique,” Semin. Ultrasound CT MRI, vol. 31, pp. 309–314, 2010.
[32] W. Cai, S. H. Kim, J. G. Lee, and H. Yoshida, “Informatics in radiology:
Dual-energy electronic cleansing for fecal-tagging CT colonography,”
Radiographics, vol. 33, no. 3, pp. 891–912, 2013.
[33] W. Cai, S. Kim, J. Lee, and H. Yoshida, “Virtual colon tagging for electronic cleansing in dual-energy fecal-tagging CT colonography,” in Proc
IEEE Eng. Med. Biol. Soc., 2012, pp. 3740–3743.
[34] A. Graser, T. R. Johnson, M. Bader, M. Staehler, N. Haseke, K. Nikolaou,
M. F. Reiser, C. G. Stief, and C. R. Becker, “Dual energy CT characterization of urinary calculi: Initial in vitro and clinical experience,” Invest.
Radiol., vol. 43, no. 2, pp. 112–119, 2008.
[35] W. Cai, D. Zhang, Y. Shirai, J. Lee, S. Kim, and H. Yoshida, “Dual-energy
index value of luminal air in fecal-tagging CT colonography: Findings and
impact on electronic cleansing,” J. Comput. Assisted Tomography, vol. 37,
no. 2, pp. 183–94, 2013.
[36] R. Abraham, J. E. Marsden, and T. S. Ratiu, Manifolds, Tensor Analysis,
and Applications, 2nd ed., vol. 75. New York, NY, USA: Springer, 1988.
[37] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery, Numerical Recipes in C: The Art of Scientific Computing. Cambridge, U.K.:
Cambridge Univ. Press, 1992.
[38] R. T. Whitaker, “A level-set approach to 3d reconstruction from range
data,” Int. J. Comput. Vis., vol. 29, pp. 203–231, 1998.
[39] S. Ho, E. Bullitt, and G. Gerig, “Level set evolution with region competition: Automatic 3-D segmentation of brain tumors,” in Proc. 16th Int.
Conf. Pattern Recog., 2002, pp. 532–535.
[40] P. Thévenaz and M. Unser, “A pyramid approach to subpixel registration
based on intensity,” IEEE Trans. Image Process., vol. 7, no. 1, pp. 27–41,
Jan. 1998.
[41] J. G. Lee, J. Hyo Kim, S. Hyung Kim, H. Sun Park, and B. Ihn Choi,
“A straightforward approach to computer-aided polyp detection using a
polyp-specific volumetric feature in CT colonography,” Comput. Biol.
Med., vol. 41, no. 9, pp. 790–801, 2011.
[42] G. Wang, M. W. Vannier, M. W. Skinner, M. G. Cavalcanti, and G. W.
Harding, “Spiral CT image deblurring for cochlear implantation,” IEEE
Trans. Med. Imag., vol. 17, no. 2, pp. 251–262, Apr. 1998.
[43] H. Yoshida, Y. Wu, W. Cai, and B. Brett, “Scalable, high-performance
3D image computing platform: System architecture and application to
virtual colonoscopy,” in Proc IEEE Annu. Eng. Med. Biol. Soc., 2012, pp.
3994–3997.

Authors’ photographs and biographies not available at the time of publication.

