IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

1161

Optimization of Heartbeat Detection in Fiber-Optic
Unobtrusive Measurements by Using Maximum
A Posteriori Probability Estimation
Sebastijan Šprager, Member, IEEE, and Damjan Zazula, Senior Member, IEEE

Abstract—This paper deals with an optimized heartbeat detection multimethod by using maximum a posteriori probability
(MAP). The approach was derived for unobtrusive fiber-optic
measurements of cardiac activity. Multiple independent detection
methods were selected and characterized by their delays and variability referring to cardiac electrical excitation (R waves). Validation of the approach was performed in two experiments involving
24 participants: 10 interferometric signals were recorded at rest,
14 with variable heart rate after physical exercise. The proposed
MAP heartbeat detection was assessed by a cross validation in 250
iterations. Obtained results show the overall efficiency, which was
estimated by a product of the sensitivity, precision, and variability
of heartbeat detections, yields 97.04 ± 3.36% for the experiment
with physical exercise and 97.07 ± 4.49% at rest. The method’s
accuracy guarantees that the heartbeat detections differ for 22 ±
5 ms and 22 ± 3 ms from the ECG reference in the two types of
experiments, respectively.
Index Terms—Heartbeat detection, maximum a posteriori probability (MAP) estimation, multimethod data analysis, unobtrusive
heartbeat monitoring.

I. INTRODUCTION
NOBTRUSIVE heartbeat monitoring has become an attractive field of research since high-sensitive sensors
reached technological maturity [1]. It is widely applicable, in
particular while observing long-term health status of subjects,
mostly within risk groups, such as infants, elderly, etc. The main
purpose of unobtrusive heartbeat monitoring is to supplement,
or even to replace to a certain degree, the classical, well-known
techniques, e.g., electrocardiogram (ECG) as golden standard,
where the wired connections and electrodes significantly affect
the comfort and mobility of the subject.
Unobtrusive observations need special sensors that are in direct or indirect contact with the patient, installed in the environment, such as sown in bed mattress, which is the most
common use, or made wearable. The acquired sensory signals

U

Manuscript received March 20, 2013; revised July 10, 2013 and August 19,
2013; accepted September 16, 2013. Date of publication September 17, 2013;
date of current version June 30, 2014. This work was supported by the Slovenian
Research Agency under Contract 1000-08-310100.
The authors are with the Faculty of Electrical Engineering and Computer
Science, University of Maribor, SI-2000 Maribor, Slovenia (e-mail: sebastijan.
sprager@uni-mb.si; zazula@uni-mb.si).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2282403

encompass features that are related to individual heartbeats.
Some signal-processing and pattern-recognition analysis can
extract this information. A variety of sensors and methods rely
on mechanical (ballistocardiography—BCG) or audible cardiac
activity (phonocardiography—PCG). Brief overviews of such
sensors and methodologies are given in [2]–[6].
The classical ECG observations locate heartbeats very precisely when based on sharp R waves. Detecting heartbeats from
the BCG or PCG observations can be considerably less accurate, in particular if measurements are done unobtrusively in
uncontrolled environments. These are prone to movement artifacts that affect the accuracy of heartbeat detection [1], [7].
Moreover, if the detection depends on only a single analysis
method or a limited set of features, its efficiency lags far behind
the optimum one.
The latest investigations have shown that an improvement of
efficiency and accuracy can be obtained in two different ways.
The first one uses array sensor systems relying on multiple observations [8], [9] or combines multiple sensors of different types
exploiting their multimodal nature [10]–[12]. This increases the
complexity of sensory systems, which results in higher costs.
The other way originates from a multimethod approach which
relies on signal processing by a set of independent methods.
These produce multiple detections of the same heartbeat. The
obtained heartbeat positions differ more or less, but are related
to the actual cardiac activity. A kind of fusion process is needed
to optimally assess every heartbeat instant. The approach was
proposed in [13] and was successfully evaluated on the ballistocardiographic signals.
When using very sensitive sensors, the sensory signal contains contributions generated in different frequency bands by
the fundamental heart rate, mechanical myocardium activity, and acoustic myocardium activity. It has been shown in
[14] that all the influences can be captured by a single optical interferometer. The interferometer reacts strongly to micrometric, and even nanometric, elongations of the optical
fiber.
A novel approach we propose in this paper involves a larger
set of independent detection methods. It comprises two steps: the
first one statistically characterizes the methods involved, while
the second one estimates heartbeat instants from fiber-optic unobtrusive measurements by maximum a posteriori probability
(MAP). Priors on, physiological limitations are also deployed.
The proposed approach increases the potential of fiber-optic
sensors for monitoring human heartbeat, respiration, and movements unobtrusively in dwelling environments (beds, chairs,

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1162

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

household appliances), in the elderly and people with special
needs in their homes, during the sleep detecting the arrhythmias
or apnea, in the infants’ incubator, etc. [1], [2].
II. BACKGROUND
The optimization of individual heartbeat positioning is based
on statistical parameter estimation of K heartbeat detection
methods. As described by the multimethod approach [14], heartbeat detection dependent on cardiac mechanical or audible activity is delayed after cardiac electrical excitation. The delay is
specific for each of the detection methods and depends on the
signal content that the method is sensitive for. The accuracy of
the method is tightly related to the variability of obtained detections. We expect more accurate (stable) methods produce lower
variability around the detected heartbeat instants.
Suppose τ̄k and σ̄k stand for the mean delay and standard
deviation of the kth method detections according to the ECG
reference, respectively. Due to delays τ̄ measured from the referential R waves, any heartbeat detection can be aligned with the
corresponding R wave when the detection is subtracted from its
delay. Afterward, σ̄ reflects the deviation of heartbeat detections
from the referential R waves.
As we assume that all K detection methods are independent
and their detections can be modeled with Gaussian distribution,
maximum likelihood estimator (MLE) is directly applicable to
reduce the variance of heartbeat estimation. Moreover, due to
a periodic nature of cardiac activity, information about past
beat-to-beat intervals can be used to predict the most probable
time instant of the next heartbeat. This is the prior which leads
to a MAP estimation. The obtained posterior joins K-method
likelihood estimation and the prior. Both the MLE and the prior
assess instants in time, which involves probability densities for
all K detection methods and the prior dependent on a single
variable being the time. However, it is clear that the prognosis
made by the prior is based on previous beat-to-beat distances.
When observing the referential ECG, a well-known notion of
RR intervals applies.
Two separate estimators for likelihood and the prior can be
replaced by a single estimator if a two-dimensional representation is adopted. It is spanned by the time and distance between
consecutive heartbeats. We must recall that beat-to-beat distances depend entirely on consecutive heartbeat instants, and
that the distribution of the former entirely depends on the distribution of detections of the latter. Nevertheless, the extension
to the two-dimensional representation introduces two benefits:
a derivation of a compact MAP estimator becomes feasible, as
will be explained in the following section, and intuitive physiological constraints can be easily applied to suppress the outliers.
A preliminary study of locating the heartbeats in the introduced
two-parametric representation was presented in [15].
Let t denote time instants and υ time distances between the
pairs of consecutive heartbeats. Both variables are parameterized by θ = (t, υ). Adapt also the designations of the method
means and deviations. By the assumption of Gaussian distribution, we adopt the following symbols: μt k for mean delays
τ̄k , σt k for standard deviations σ̄k , μυ k for mean differences

between consecutive heartbeats according to referential RR intervals, and συ k for their standard deviations.
Consider the importance of parameters μυ k and συ k . In the
case of ideal heartbeat detection, deviation parameter σt k equals
zero. In real situations, we cannot rely on the absolute accuracy
of detection methods; hence, the value of σt k will be greater
than zero. Observing the time distance between consecutive
detections, it directly depends on two detected time instants and
varies according to this dependence. When it is compared to
the corresponding RR intervals, we expect zero-mean Gaussian
distribution with συ k as its standard deviation (μυ k = 0 assumes
that the means of beat-to-beat distances and RR intervals are
equal).
Before deriving a closed-form heartbeat MAP estimator, summarize all the assumptions.
1) Differences between heartbeat detections and referential
R waves have normal distribution. Actually, the tails of
this distribution are truncated at lags equal to the maximum RR interval. The same is inferred for the distribution of differences between beat-to-beat distances and RR
intervals.
2) In order to maximize the efficiency of proposed approach,
it is necessary to use a sufficient number, K, of different
heartbeat detection methods.
3) A sufficiently large training set of fiber-optic interferometric signals (including the references) has to be collected.
It is used to estimate method-dependent parameters μt k
and σt k , and compute parameters συ k out of these.
4) All the K methods must be independent. Therefore, based
on the training set of signals, the dependent methods are
sought and eliminated from further consideration. This can
be done by determining the cross correlation of detections
obtained by the methods on the same training signals.
III. METHODOLOGY
A. Derivation of Heartbeat Estimator by Using MAP
Heartbeat detections are obtained as K independent observations each, x = [x1 , x2 , . . . , xK ], considered as realizations of
a random variable X . We seek parameters θ that maximize the
posterior p (θ |X ) with the help of Bayes’ rule [16]:
p (θ |X ) =

p (X |θ ) p (θ)
p (X )

(1)

where p (X |θ ) models evidence X by the best parameters,
p (X ) stands for marginal likelihood, and p (θ) for prior distribution. When maximizing the posterior, marginal likelihood
p (X ) only means a normalization factor, which can be omitted.
Due to the fact that the evidence X consists of 
K independent
observations x, p (X |θ ) may be replaced by x∈X p (x |θ ).
Thus, it is easier to maximize the posterior if we first take a
logarithm [17].
A MAP estimation of heartbeat instants is based on the following a priori knowledge originating from the points 1–4 earlier.
1) Mean delays and variability of detection methods, i.e.,
μt k , σt k , and συ k , are known (μυ k = 0 is considered as
well).

ŠPRAGER AND ZAZULA: OPTIMIZATION OF HEARTBEAT DETECTION IN FIBER-OPTIC UNOBTRUSIVE MEASUREMENTS

1163

Joint probability density for δt and δυ yields


p t̂i , υ̂i

Fig. 1. A priori knowledge used in our derivation of the heartbeat MAP estimator: (a) influence of the mean delays and variability of methods illustrated
by ellipses; (b) linear relationship between the heartbeat instants and interbeat
distances—formation of heartbeat line. Points belong to the detections of all
methods, asterisks point out estimated and the circle predicted heartbeat locations, respectively.

2) A straightforward linear dependence exists between predictions of heartbeat instants and interbeat distances. The
ith distance denoted by υi is measured between heartbeat
instants ti and ti−1 : υi = ti − ti−1 . This corresponds to
a line in the representation of interbeat distances versus
time, and in ideal cases next heartbeat would always appear on this line. For this reason, wecall itheartbeat line.
The ith heartbeat is estimated by θ̂ i = t̂i , υ̂i , where t̂i and
υ̂i stand for the estimates of the ith heartbeat time instant and
temporal distance between heartbeats i and i − 1 (reciprocal
value of the instantaneous heart rate), respectively. For better
comprehension, a priori knowledge is depicted graphically in
Fig. 1.
In line with point 1, the following normal distribution can be
defined for the kth method observations:
Nk (μt k , σt k , μυ k , συ k ) =
⎛

−⎝

1
√
e
2πσt k συ k

(t i , k −tˆi −μ t k )
2σ 2
tk

2

+

(υ i , k −υ̂ i −μ υ k )
2
2σ υ

k

2

⎞
⎠

(2)

where the distribution applies to the differences between
heart
beat detections by the kth method and estimates t̂i , υ̂i , i.e.,
ti,k − t̂i and υi,k − υ̂i . This has been shown in (2) and Fig. 1(a).
Joint probability distribution involving the contributions of all
K methods is then defined as

	 	 

K
Nk (μt k , σt k , μυ k , συ k ) dtdυ. (3)
p(x |θ ) =
t

υ

k =1


−
1
=√
e
2πσc

(( t i −1 + υ i −1 ) −tˆi ) 2
2 σ c2

+

( υ i −1 −υ̂ i ) 2
2 σ c2



(5)

where σc denotes expected deviation of errors made while determining time instants of heartbeats. It can be understood as
a parameter that regulates the importance of heartbeat detections according to their distances from heartbeat line and can be
initialized with the deviation of K detection methods:


K
1 
σc = 
σt2k .
(6)
K
k =1

Following the general
 method for MAP [17], (3) and (5) lead
to a function u t̂i , υ̂i :

2
(ti−1 + υi−1 ) − t̂i
(υi−1 − υ̂i )2
u(t̂i, υ̂i ) = −
−
2σc2
2σc2


2
K

ti,k − t̂i − μt k
(υi,k − υ̂i )2
+
−
+
2σt2k
2συ2 k
k =1

(7)
and to a derivation of the MAP estimator:


θ̂ M AP = arg max u t̂i , υ̂i .

(8)

θ



Maximization of function u t̂i , υ̂i is performed by partial
derivatives to function arguments and by setting derivatives
equal to 0:


K
∂u t̂i, υ̂i
t̂i − ti−1 − υi−1  ti,k − t̂i − μt k
=−
+
=0
σc2
σt2k
∂ t̂i
k =1
(9)
and


K
∂u t̂i , υ̂i
υ̂i − υi−1  υi,k − υ̂i
=−
+
= 0.
(10)
∂ υ̂i
σc2
συ2 k
k =1

By solving the obtained system of linear equations, the final
MAP estimator for parameters that determine the ith heartbeat
adopts the following form:


K μ t k
K t i , k
−
ti−1 + υi−1 + σc2
k =1 σ t2
k =1 σ t2
k
k
t̂i =
(11)
K σ c2
1 + k =1 σ 2
tk

Point 2 shows the importance of heartbeat line for the prior.
A heartbeat prediction relies on the previous heartbeat instant
ti−1 and previous distance between heartbeats υi−1 . Considering
heartbeat
Fig. 1(b), distances δt and δυ between

 the predicted
parameters and estimated parameters t̂i , υ̂i can be calculated
as
δt = (ti−1 + υi−1 ) − t̂i
and
δυ = υi−1 − υ̂i .



(4)

and



υi , k
K
υi−1 + σc2
k =1 σ υ2
k
.
υ̂i =
K σ c2
1 + k =1 σ 2

(12)

υk

B. Automatic Heartbeat Estimation Procedure
Applying the MAP estimator for heartbeats as derived in
previous section, a procedure for automated estimation of consecutive heartbeats is constructed. It consists of the following
steps.

1164

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

1) A selection of detection methods processes statistically
significant number of fiber-optic interferometric and corresponding reference signals (training set). Based on a
comparison of detected heartbeats and referential R waves,
parameters μt k , σt k , and συ k ; k = 1, . . . , K, are assigned
to K methods.
2) Based on a cross-correlation comparison of detected sequences of heartbeats, dependent methods are eliminated
(those exceeding a preselected correlation threshold).
3) Heartbeat instants are estimated in test-set signals by the
proposed MAP estimator.
In the first step, the initial set of methods is made available.
Dealing with heartbeat detection from fiber-optic observations,
a variety of detection methods can be conceived by combining
several disjoint frequency bands and processing techniques as
described in the multimethod approach [14]. For all the methods,
parameters μt k , σt k , and συ k are estimated.
Statistical dependence of detection methods is assessed in
the second step by the cross correlation between the sequences
of heartbeat instants, as detected by different methods on a
single interferometric signal. For each pair of methods, Pearson’s correlation coefficient is calculated. Correlation coefficients between any ith and jth method are denoted by c(i, j);
i = 1, . . . , K, j = i + 1, . . . , K. Cross correlations are computed based on all signals from the training set. A decision
on the dependence of any pair of methods takes into account
the mean value of correlation coefficients obtained for that pair
on all tested signals. If the obtained value exceeds a preselected threshold, such as determined by a portion of the overall
mean value for all correlation coefficients on all signals from
the training set (see Section IV for results), we consider the
pair of methods dependent. All detections on the training set are
also used for assessing the methods’ efficiency and accuracy.
From a dependent pair of methods, always less efficient and
accurate method is discarded. The elimination is repeated until
only independent methods are selected for further processing.
The last, third step deploys MAP estimation to detect heartbeats in the test set of signals. A short signal segment illustrates
the detection procedure in Fig. 2.
The proposed heartbeat detection procedure needs an initialization with the initial time instant t0 , which is supposed to
coincide with one of heartbeats. The initial heartbeat can be detected by using any of heartbeat detecting methods; it can even
be determined randomly. Due to good convergence (shown in
Section IV-C), the proposed procedure synchronizes in a few
heartbeats time.
It is characteristic for all the detection methods applied that
their detections concentrate around the heartbeat line. As we
have mentioned, the prior’s deviation σc can regulate the importance of detections according to their distance from heartbeat
line. Additional physiological restrictions may also be put on
detections. Upper and lower bounds for heartbeats are determined by the highest and lowest expected heart rate, i.e., 210
and 40 bpm, resulting in 0.29 and 1.5 s beat-to-beat intervals.
Thus, the heartbeat detection region is bounded by a pentagon,
as depicted in Fig. 2. Only heartbeat detections falling inside
the region enter the MAP estimation. The estimated instant ti

Fig. 2. Cut-out from the graphical representation of automated heartbeat detection by using the proposed MAP estimator: solid lines denote heartbeat lines,
pentagons bounded by dashed lines limit search regions around heartbeat lines
in accordance with cardiac physiology, points belong to the detections for all
methods, crosses point out referential heartbeats, and asterisks show places of
estimated heartbeats.

locates the ith heartbeat. Searching for the (i + 1)th heartbeat,
it defines the intersection of next heartbeat line with the time
axis.
IV. RESULTS
A. Experimental Protocol
In order to compare the efficiency and accuracy of the proposed method, we performed the same experimental protocol
as it was used in the experiments with the multimethod approach [14]. We designed two different experiments. The first
one deals with the signals acquired at rest, which produces stable
heart rate. This is the most common situation expected during
sleep. The second type of experiments introduces situation with
variable heart rate and higher amount of motion artifacts, as it
takes place immediately after submaximal exercise testing.
Ten young healthy male subjects with age of 35.2 ± 9.6 years,
height of 176.2 ± 3.1 cm, and weight of 79.0 ± 7.9 kg participated in the first experiment. In order to acquire the referential
ECG signal, electrodes were attached to the subjects’ limbs.
Subjects were then asked to lie supine on a flexible mattress.
Spirally twisted optical fiber was inserted between the mattress
and a thin layer of foam. Interferometric and referential ECG
signals were acquired simultaneously in 1-min tests when subjects lay still and breathed normally.
The second experiment involved 14 subjects (11 males and 3
females) with age of 29.7 ± 9.0 years, height of 176.6 ± 6.4 cm,
and weight of 77.2 ± 15.49 kg. When the referential ECG electrodes were firmly attached to the subjects, they were asked to
cycle an ergometer until they reached their submaximal heart
rate, calculated as (220 − age) · 0.8 bpm [18]. After that, they
immediately lay supine on the mattress prepared in the same

ŠPRAGER AND ZAZULA: OPTIMIZATION OF HEARTBEAT DETECTION IN FIBER-OPTIC UNOBTRUSIVE MEASUREMENTS

way as during the experiments at rest. Subjects were asked to
refrain from any movement and breathe normally. Interferometric and referential ECG signals were taken simultaneously for
5 min. Heart rate decreased significantly during this interval.
Such protocol allows for observation of the different physiological properties provoked by dynamic changes of heart rate,
which increases the burden on the heartbeat detection approach.
Variable heart rate intensifies the mechanical and audible influences on fiber-optic interferometer both by the heart activity and
respiration [14].
Interferometric and referential ECG signals were acquired by
a custom-made sampling device at 500 Hz sampling frequency.
Hardware synchronization of the two channels was performed.
Standard Schiller AT-1 ECG device was used in order to acquire
the referential ECG signals. Four electrodes were applied on
the extremities and lead II was taken as the referential channel.
Time instants of the R waves were extracted by the well-known
Pan-Tompkins QRS detector [19]. All detections were checked
manually in order to prevent false references on heartbeats.
B. Evaluation of Results
The optimization of heartbeat detection by using MAP estimation was evaluated by signals acquired at rest and after
exercising on a bicycle-ergometer. The training and test sets included the signals from both experiments. Originating from 10
signals acquired at rest (with stable heart rate) and 14 signals
acquired after exercise (with variable heart rate), we built the
training set with 14 signals, 8 with variable and 6 with stable
heart rate. Test set was composed out of remaining 10 signals,
6 with variable and 4 with stable heart rate.
We constructed 120 heartbeat detection methods. The methods are based on three different processing steps in the same
way as described in [14]: six different filter types, four different envelopes, and four different heartbeat detection techniques
were combined in 120 different methods.
All the methods estimated the heartbeats in the training set
of signals. Their efficiency and accuracy verified against the
referential R-wave detections were used to rank the methods.
Heartbeat estimates were also involved in cross correlations to
exclude all statistically dependent methods and keep only the
highest ranking independent ones. Cross validations were performed in 250 iterations. In each iteration, a new training set
of 14 signals (eight with variable and six with stable heart rate)
was chosen randomly by uniform distribution out of the total
of 24 experimental signals. If the correlation coefficient for a
pair of methods exceeded 0.1 [20], a lower ranked method was
eliminated. We wanted to find the best elimination tradeoff.
Therefore, we considered heartbeat detections of the two compared methods identical under different conditions. The strictest
case assumed two detections identical only if exactly aligned in
time. Three more relaxed cross correlations considered two detections identical if their time instants were up to ±3, ±5, or
±7 ms (tolerance intervals).
The results of the proposed approach for the elimination of
dependent methods are shown in Table I. Mean correlation
coefficients for all methods and the numbers of selected and

1165

TABLE I
MEAN CORRELATION COEFFICIENTS CALCULATED IN 250 CROSS-VALIDATION
ITERATIONS FOR ALL POSSIBLE PAIRS OF METHODS: HEARTBEAT DETECTIONS
WERE CONSIDERED IDENTICAL AT DIFFERENT TOLERANCE INTERVALS

discarded methods are depicted versus the different comparison tolerances. If the tolerances for declaring two heartbeat
detections identical are too loose, too many methods appear dependent, and vice versa. Hence, we interpret Table I based on
the expected mean absolute error (MAE) of heartbeat detections
(about 20 ms) [13]–[15]. Comparisons with time tolerances of
2, 6, 10, or 14 ms cover 10%, 24%, 42%, or 58% of the expected error interval, respectively. The results in Table I show
that by widening the tolerance interval from the initial exact
one, the mean cross correlations do not increase substantially,
while their standard deviations remain practically the same.
The two groups of independent and dependent methods demonstrate significantly different mean correlation coefficients, so
that any tolerance interval produces a set of acceptable, independent methods, but for the statistical reasons, we decided for
the largest one, which demands exact coincidence of heartbeat
detections to be considered identical.
Thus, K = 89 independent methods were selected and characterized by their means and standard deviations μt k , σt k , and
συ k ; k = 1, . . . , K. They entered the final MAP heartbeat estimation of test signals according to (11) and (12), as derived
in Section III-B. The prediction deviation σc was set equal to
±160 ms.
It is worthwhile to think about the methods with low efficiency
and accuracy. They are not wanted in the final selection, but it is
quite probable that their heartbeat detections would not coincide
a lot with the detections of superior methods. This means that
they appear independent and may be selected. However, their
dispersion is high and, consequently, they do not degrade the
MAP estimates. Their detections also often appear as outliers
that are suppressed by the pentagon of physiological limitations
mentioned in Section III-B.
The efficiency of the optimization based on MAP was cross
validated by using three different metrics: sensitivity, precision,
and variability score. We compared detected instants of heartbeats with R-wave positions in the referential ECG signals.
The efficiency of the proposed detection approach was evaluated by declaring all detections that fall within a predefined
interval around the R wave true positive (TP). In [14], this interval was defined within two consecutive referential R waves,
which correspond to an RR interval. In our interpretationhere, a
TP is counted
for heartbeat detection between tri − tri−1 2 and

r
r
ti+1 − ti 2, where tri stands for the time instant of the ith referential R wave. If this interval does not contain any heartbeat,

1166

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

a false-negative (FN) event is recognized. Sensitivity rs is then
calculated as T P /(T P + F N ). A false positive (FP) can happen if two heartbeat detections fall within the same RR interval.
Precision rp is computed according to T P /(T P + F P ).
We compared the results of heartbeat detections for different
widths of the interval around the referential R waves. Assuming
that, we can calculate the probability of heartbeat detection
introducing variability score rv :
rv = P (|tri − ti | < d)

(13)

where P stands for statistical probability, ti and tri indicate
the time of the ith heartbeat detection and the corresponding
R wave instant, respectively, while d defines admissible deviation around tri . The widths d varied between 35 and 100 ms.
Particular attention was paid to the interval ±75 ms around
R waves, since this tolerance is taken from the IEC standard,
which makes our results comparable to existing similar detection
methods [14]. Variability score rv is used as the third efficiency
metric and, together with the sensitivity and precision, defines
the overall efficiency score r [14]:
r=

√
3

rs · rp · rv .

(14)

The accuracy of heartbeat detections was measured standard
deviations of the offsets of detected heartbeats from their referential R waves.
Detection accuracy was also evaluated by the absoluter error obtained by comparing the detected and corresponding referential distances between two consecutive heartbeats. MAE,
median absolute error, and a dispersion of calculated errors by
using P90 , yielding the value with 90% of errors below it, were
computed.
Fig. 3 shows the overall mean efficiency and accuracy in heartbeat detection for the subjects in the experiment with variable
heart rate. We ran 250 iterations of cross validation. Overall sensitivity is equal to 97.64 ± 3.48% and overall precision 98.34 ±
1.95%, while overall variability score rv for all subjects, if the
verification interval extends ±75 ms around the referential R
waves, yields 95.23 ± 5.25%. Overall efficiency score r is then
equal to 97.04 ± 3.36%. Overall mean delay after the referential
R waves equals 11 ± 25 ms with 39 ± 17 ms standard deviation, while overall MAE equals 22 ± 5 ms, overall median of
absolute errors 18 ± 4 ms, and overall mean of P90 47 ± 10 ms.
In the same way, we evaluated the efficiency and accuracy
of heartbeat detections for subjects during rest. The results are
shown in Fig. 4. Overall sensitivity rs is equal to 99.43 ± 0.72%
and overall precision 97.65 ± 4.69%, while overall variability score rv for all subjects, if the verification interval extends
±75 ms around the referential R waves, equals 94.43 ± 8.77%.
Overall efficiency score r equals 97.07 ± 4.49%. Overall mean
delay from the referential R waves yields 24 ± 58 ms with 40 ±
25 ms standard deviation, while the overall MAE equals 22 ±
3 ms, overall median of absolute errors 18 ± 2 ms, and overall
mean of P90 47 ± 8 ms.

Fig. 3. Results of heartbeat detection by using MAP: the signals with variable
heart rate were considered; the results indicate overall means obtained by the
cross validation in 250 iterations. Each subject is shown with: (a) efficiency
of the detected heartbeats shown with sensitivity rs , precision rp , variability
score rv , and efficiency score r—efficiency axis is truncated below 75% for
better readability; (b) overall mean probability of heartbeat detection rv versus
different interval widths d around the referential R waves; (c) mean delays of
detected heartbeats from the referential R waves; (d) absolute error between
detected distances of consecutive heartbeats and corresponding referential RR
intervals.

C. Convergence Test
The proposed heartbeat MAP estimator needs an initial hint
on the heartbeat to begin with. It can also happen that a misidentification allocates a heartbeat instant far from the referential
one, e.g., when strong disturbances emerge. In both cases, the
detection algorithm is expected to converge to correct detections
as soon as possible. A convergence test can provide new insights
into the stability of the proposed approach. Its convergence was
examined by shorter, 10-s-long signal segments taken separately
from the two experiments described in Section IV-A.
Each signal was divided into 12 equally distributed segments.
The onsets of signal segments were 25 s apart for 5-min-long
signals totaling in 168 segments, and 4 s apart for 1-min-long
signals totaling in 120 segments. To entirely control the test, we
selected the signal segments with no motion artifacts, so that
the proposed algorithm can detect all heartbeats if initialized
by a proper initial time instant t0 . Only segments with both the
sensitivity and precision of 100% were considered, which resulted in 128 and 107 selected signal segments. The acceptance
of detections was assessed by offsets from the corresponding

ŠPRAGER AND ZAZULA: OPTIMIZATION OF HEARTBEAT DETECTION IN FIBER-OPTIC UNOBTRUSIVE MEASUREMENTS

1167

Fig. 5. Mean values ei and their deviations for: (a) signals acquired at variable
heart rate and (b) signals acquired at rest.

converges in about four heartbeats, if matching of detected heartbeats with the referential R waves within 75 ms intervals (see the
dashed line in Fig. 5) at a 95% confidence level (two standard
deviations) is considered acceptable for correct detections.
V. DISCUSSION
Fig. 4. Results of heartbeat detection by using MAP: the signals recorded
at rest were considered; the results indicate overall means obtained by the
cross validation in 250 iterations. Each subject is shown with: (a) efficiency
of the detected heartbeats shown with sensitivity rs , precision rp , variability
score rv , and efficiency score r—efficiency axis is truncated below 75% for
better readability; (b) overall mean probability of heartbeat detection rv versus
different interval widths d around the referential R waves; (c) mean delays of
detected heartbeats from the referential R waves; (d) absolute error between
detected distances of consecutive heartbeats and corresponding referential RR
intervals.

referential R waves. Heartbeat time instant ti was linked to the
r
R-wave time

following relationship held:
 rti if the
referential
r
r
ti − ti−1 2 ≤ ti < ti+1 − tri 2. Convergence test began
from the initial time t0 set equal to the exact time of the first
referential R wave, t0 = tr0 , at the beginning of selected signal
segment. Then, we shifted the initial time instant toward the subsequent referential R wave tr1 in steps of 40 ms and, in every step,
heartbeats were detected by the proposed approach. By shifting
initial t0 , the accuracy of heartbeat detections is expected to
decrease, due to the detections becoming more and more late.
Worst accuracy turns up at the moment when t1 is not detected
any more in the expected interval tied to tr1 . At that moment,
vector es is calculated with eight elements for eight consecutive heartbeat detections, ei,s = |ti − tri | ; i = 2, . . . , 9, where
s indicates the trial number. After trials with different signal segments, conducted separately for the two types of heartbeat detection experiments, means and standard deviations were computed
over all trials for each detection: ei ; i = 2, . . . , 9. Convergence
analysis is illustrated by Fig. 5. The obtained means and deviations prove that the proposed heartbeat detection algorithm

The proposed MAP estimator significantly improves heartbeat detection accuracy when comparing it with the recent results obtained in a multimethod approach [14]. This has been
proven by an exhaustive cross-validation process. A set of independent detection methods was selected very strictly, so that the
mean of their correlation coefficients yields 0.0369 ± 0.0201
(see Table I).
The efficiency of proposed heartbeat detection was examined
by two different experimental protocols. At rest, we obtained
improved results in comparison to similar heartbeat detection
methods [13]–[15], while the results on variable heart rate even
show significant improvement. Obtained results show equal accuracy in both cases.
It is reasonable to compare MAP-detection results with the
ones obtained by the multimethod approach in [14]. In order
to reduce the bias, we used the same set of interferometric
signals, i.e., only the signals involving variable heart rate. Detection efficiency was assessed by the efficiency score r. The
overall efficiency obtained by the proposed approach is equal to
97.57 ± 2.75%, which surpass 93.81 ± 7.03% obtained by the
multimethod approach. The results are in acceptable tolerances
when compared with the recent research [21] considering that
our approach was evaluated on much shorter signals acquired
at variable heart rate and that 100% coverage of the signals was
taken, without eliminating the motion artifacts.
The proposed MAP heartbeat detection is also more accurate
than the multimethod approach. That can be proved by comparing the variability of detected heartbeats. While detections by
the multimethod approach vary ±59 ms about the referential R
waves, on average, MAP estimates them in a ±20 ms interval.

1168

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 4, JULY 2014

MAE obtained by MAP is equal to 22 ± 5 ms, which aligns
with the multimethod approach; only the deviation is 4 ms
lower here. This proves high stability of the proposed MAP
heartbeat detection, and also less proneness to disturbances in
the interferometric signals. Obtained scores are high in spite of
subjects 12 and 13 who induced a lot of unwanted movement
and, consequently, decreased the efficiency indexes. We intentionally avoided any extra suppression of disturbances to be able
to assess the proposed approach robustness.
Although it has been shown that during the sleep the amount
of motion disturbances is minimal, about 3% as reported in [22],
we still want heartbeat detection cope with those as efficiently
as possible. Convergence tests in Section IV-C point out that
an entirely missed detection may cause misplacement of not
more than four subsequent heartbeat detections. Of course, highintensity disturbances may prevent correct detections and recovery until they last.
We must emphasize that the proposed MAP optimization can
be applied to any multimethod approach, whose methods and
input data fulfill the assumptions and criteria from Section II.
VI. CONCLUSION
We proposed the optimized heartbeat detection based on MAP
estimation and exploited statistical properties of multiple analysis methods in terms of their detection delays and variability
versus the myocardium electrical excitation. The prior to build
the MAP estimator stems from a repetitive nature of cardiac
activity. Joint interpretation of the likelihood and prior enabled
a derivation of common heartbeat MAP estimation. Obtained
results show significant accuracy and robustness, which is most
important for future clinical use.
Further research is planned to focus on validation in a clinical environment by performing experiments with long-term
heartbeat monitoring, including healthy subjects and subjects
suffering from different cardiac disorders.
REFERENCES
[1] E. Pinheiro, O. Postolache, and Pedro Girão, “Theory and developments
in an unobtrusive cardiovascular system representation: Ballistocardiography,” Open Biomed. Eng. J., vol. 4, no. 1, pp. 201–216, Oct. 2010.
[2] O. Postolache, P. S. Girão, E. Pinheiro, and G. Postolache, “Unobtrusive
and non-invasive sensing solutions for on-line physiological parameters
monitoring,” in Wearable and Autonomous Biomedical Devices and Systems for Smart Environment. New York, NY, USA: Springer-Verlag,
2010, pp. 277–314.
[3] S. Rajala and J. O. Lekkala, “Film-type sensor materials PVDF and EMFi
in measurement of cardiorespiratory signals—A review,” IEEE Sensors
J., vol. 12, no. 3, pp. 439–449, Mar. 2012.
[4] M. R. Neuman, “Vital signs: Heart rate,” IEEE Pulse, vol. 1, no. 3, pp. 51–
55, Nov./Dec. 2010.

[5] O. T. Inan, M. Etemadi, R. M. Wiard, L. Giovangrandi, and
G. T. A. Kovacs, “Robust ballistocardiogram acquisition for home monitoring,” Physiol. Meas., vol. 30, no. 2, pp. 169–185, Jan. 2009.
[6] J. Paalasmaa, “A respiratory latent variable model for mechanically measured heartbeats,” Physiol. Meas., vol. 31, no. 10, pp. 1331–1344, Aug.
2010.
[7] D. C. Mack, J. T. Patrie, P. M. Suratt, R. A. Felter, and M. Alwan, “Development and preliminary validation of heart rate and breathing rate
detection using a passive, ballistocardiography-based sleep monitoring
system,” IEEE Trans. Inf. Technol. Biomed., vol. 13, no. 1, pp. 111–120,
Jan. 2009.
[8] C. Bruser, A. Kerekes, S. Winter, and S. Leonhardt, “Multi-channel optical
sensor-array for measuring ballistocardiograms and respiratory activity in
bed,” in Proc. Conf. Proc. IEEE Eng. Med. Biol. Soc., Aug./Sep. 2012,
pp. 5042–5045.
[9] J. M. Kortelainen, M. van Gils, and J. Parkka, “Multichannel bed pressure sensor for sleep monitoring,” in Proc. Comput. Cardiol., Sep. 2012,
pp. 313–316.
[10] Y. Chuo, K. Tavakolian, and B. Kaminska, “Evaluation of a novel integrated sensor system for synchronous measurement of cardiac vibrations
and cardiac potentials,” J. Med. Syst., vol. 35, no. 4, pp. 445–455, Aug.
2011.
[11] L. Grajales and I. V. Nicolaescu, “Wearable multisensor heart rate monitor,” in Proc. Int. Workshop Wearable Implantable Body Sensor Netw.,
Apr. 2006, pp. 157–160.
[12] O. T. Inan, “Novel technologies for cardiovascular monitoring using ballistocardiography and electrocardiography,” Ph.D. Thesis, Dept. Elect.
Eng., Stanford University, Stanford, CA, USA, 2009.
[13] C. Brüser, K. Stadlthanner, and S. de Waele, “Adaptive beat-to-beat heart
rate estimation in ballistocardiograms,” IEEE Trans. Inf. Technol. Biomed.,
vol. 15, no. 5, pp. 570–578, Sep. 2011.
[14] S. Šprager and D. Zazula, “Heartbeat and respiration detection from optical
interferometric signals by using a multimethod approach,” IEEE Trans.
Biomed. Eng., vol. 59, no. 10, pp. 2922–2929, Oct. 2012.
[15] S. Šprager and D. Zazula, “Optimization of heartbeat detection based on
clustering and multimethod approach,” in Proc. Conf. Proc. IEEE Eng.
Med. Biol. Soc., Aug./Sep. 2012, pp. 5–8.
[16] D. Barber, Bayesian Reasoning and Machine Learning. Cambridge,
U.K.: Cambridge Univ. Press, 2012.
[17] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation
Theory. Englewood Cliffs, NJ, USA: Prentice-Hall, 1993.
[18] H. Tanaka, H. D. Monahan, and R. D. Seals, “Age-predicted maximal
heart rate revisited,” J. Amer. College Cardiol., vol. 37, no. 1, pp. 153–
156, Jan. 2001.
[19] J. Pan and W. J. Tompkins, “A real-time QRS detection algorithm,” IEEE
Trans. Biomed. Eng., vol. 32, no. 3, pp. 230–236, Mar. 1985.
[20] J. Cohen, Statistical Power Analysis for the Behavioral Sciences. Hillsdale, NJ: Lawrence Erlbaum, 1988.
[21] C. Brüser, S. Winter, and S. Leonhardt, “Robust inter-beat interval estimation in cardiac vibration signals,” Physiol. Meas., vol. 34, no. 2,
pp. 123–138, Feb. 2013.
[22] V. Verhaert, B. Haex, D. Berckmans, M. Vandekerckhove, J. Verbraecken,
and J. V. Sloten, “Unobtrusive assessment of motor patterns during sleep
based on mattress indentation measurements,” IEEE Trans. Inf. Technol.
Biomed., vol. 15, no. 5, pp. 787–794, Sep. 2011.

Authors’ photographs and biographies not available at the time of publication.

