2556

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Lag-Specific Transfer Entropy as a Tool to Assess
Cardiovascular and Cardiorespiratory
Information Transfer
Luca Faes∗ , Member, IEEE, Daniele Marinazzo, Alessandro Montalto, and Giandomenico Nollo, Member, IEEE

Abstract—In the study of interacting physiological systems,
model-free tools for time series analysis are fundamental to provide a proper description of how the coupling among systems
arises from the multiple involved regulatory mechanisms. This
study presents an approach which evaluates direction, magnitude,
and exact timing of the information transfer between two time series belonging to a multivariate dataset. The approach performs
a decomposition of the well-known transfer entropy (TE) which
achieves 1) identifying, according to a lag-specific informationtheoretic formulation of the concept of Granger causality, the set
of time lags associated with significant information transfer, and 2)
assigning to these delays an amount of information transfer such
that the total contribution yields the aggregate TE. The approach
is first validated on realizations of simulated linear and nonlinear multivariate processes interacting at different time lags and
with different strength, reporting a high accuracy in the detection of imposed delays, and showing that the estimated lag-specific
TE follows the imposed coupling strength. The subsequent application to heart period, systolic arterial pressure and respiration
variability series measured from healthy subjects during a tilt test
protocol illustrated how the proposed approach quantifies the modifications in the involvement and latency of important mechanisms
of short-term physiological regulation, like the baroreflex and the
respiratory sinus arrhythmia, induced by the orthostatic stress.
Index Terms—Autonomic nervous system, cardiovascular control, conditional entropy (CE), dynamical systems, Granger causality, multivariate time series, mutual information.

I. INTRODUCTION
HE short-term cardiovascular and cardiorespiratory regulation, which is manifested in the spontaneous beat-to-beat
variability of heart period (HP, measured as the inverse of the
heart rate), arterial pressure (AP), and respiratory activity (RA),

T

Manuscript received November 27, 2013; revised March 7, 2014 and April 30,
2014; accepted May 6, 2014. Date of publication May 12, 2014; date of current
version September 16, 2014. This work was supported in part by the Healthcare
Research Implementation Program (IRCS), Provincia Autonoma di Trento and
Bruno Kessler Foundation, Italy, by the University of Gent (Special Research
Funds for visiting researchers) and by the Belgian Science Policy (IUAP VII
project CEREBNET P7 11). Asterisk indicates corresponding author.
∗ L. Faes is with the IRCS-FBK and BIOtech, Department of Industrial Engineering, University of Trento, Trento 38123, Italy (e-mail:
faes.luca@gmail.com).
D. Marinazzo and A. Montalto are with the Department of Data Analysis,
Gent University, Gent 9000, Belgium (e-mail: daniele.marinazzo@ugent.be;
montalto.alessandro@gmail.com).
G. Nollo is with the IRCS-FBK and BIOtech, Department of Industrial Engineering, University of Trento, Trento 38123, Italy (e-mail:
nollo@science.unitn.it).
Digital Object Identifier 10.1109/TBME.2014.2323131

is known to be the result of the dynamical interaction among
several physiological mechanisms, including both reflex pathways and central and peripheral oscillators [1]. In particular, the
cardiovascular regulation is accomplished through a closed-loop
interaction between HP and systolic AP (SAP), whereby the cardiac baroreflex acts as a delayed negative feedback of SAP on
HP, and modifications of ventricular filling and diastolic runoff
determine feedforward effects from HP to SAP [1]–[4]. Moreover, cardiac and vascular dynamics are continuously perturbed
by RA, e.g., through the mechanical effects of breathing on
intrathoracic pressure and stroke volume [5] and through the
coupling between respiratory centers and vagal outflow [6].
To address this complex picture of physiological interactions
several methods for multivariate time series analysis, ranging
from parametric models studied in time or frequency domains
to model-free approaches working in the information domain
[7], have been devised and applied in recent years to the shortterm variability of HP, AP, and RA [8]. While the usefulness of
model-based approaches is indubitable, model-free techniques
are gaining more and more attention due to the awareness that,
especially in integrated system physiology, the likelihood that
a predefined model class matches with good approximation the
mechanism generating the observed dynamics can be very low.
A natural framework for the model-free analysis of coupled
systems is provided by information theory, where a well-known
measure of directional interaction between two time series of a
multivariate dataset is the so-called transfer entropy (TE) [9].
The popularity of TE stems from its inherent ability to incorporate directional and dynamical information, its sensitivity to
both linear and nonlinear interactions, and its close connection
with the ubiquitous concept of Granger causality [10]. Additionally, the recent introduction of data-efficient estimation procedures aimed at limiting the number of variables involved in
entropy computation has made it possible to provide reliable
TE estimates from short realizations of multivariate time series
[11]–[15].
A limitation of the TE is that it is not lag-specific, i.e., it
quantifies the information transfer between time series without detecting the timing through which such a transfer occurs.
However, evaluating the exact coupling delays among interacting time series is of great importance to gain a complete
understanding of the function of complex networks [16]. Time
delays arise naturally in coupled systems as a consequence of
propagation effects, or may be introduced through closed-loop
control schemes [17]. This is the case for the networks subserving cardiovascular and cardiorespiratory regulation, where

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

assessing time-lagged information transfers would be desirable
to complement the evaluation of direction and strength of a
detected interaction with the evaluation of its timing, thus providing useful information about the latency of the physiological
mechanisms under investigation.
The present study introduces an approach for the detection
of time-lagged information transfer between two time series
belonging to a multivariate dataset. The approach decomposes
the TE between the series into a sum of terms, the so-called
lag-specific TEs, each quantifying the information transfer at a
given time delay. To implement the method, a procedure facing
the problem of entropy estimation in high dimensions is devised,
which also provides the basis for assessing the lags associated
with significant transfer of information. The overall approach is
first validated on simulations reproducing linear and nonlinear
interactions among multiple time series. Then, it is applied to HP,
SAP, and RA time series measured from healthy subjects during
an experimental protocol inducing expected modifications of
the physiological mechanisms underlying cardiovascular and
cardiorespiratory regulation, i.e., head-up tilt testing. Part of this
paper has been presented in a preliminary form in a conference
contribution [18].
II. METHODS
A. Lag-Specific Granger Causality and TE
Let us consider an overall dynamical system composed
of M interacting (sub)systems, and assume that the states
visited by the systems are described as discrete-time stationary stochastic processes. Suppose that we are interested in evaluating the information flow from an assigned
source system, described by the process X, to a destination system, described by the process Y, in the presence
of the remaining systems, described by the set of processes
(k )
Z = Zk =1,...,M −2 . Let us further denote Xn , Yn , and Z n as the
random variables obtained sampling the processes at time n, and
Xn− = {Xn −1 , Xn −2 , . . .}, Yn− = {Yn −1 , Yn −2 , . . .}, and Z −
n =
{Z n −1 , Z n −2 , . . .} as the sets of variables describing the past
of the processes. Then, according to the definition of Granger
causality [10], G-causality from X to Y, Xn− → Yn , exists if Xn−
contains information that helps predicting Yn above and beyond
the information contained in Yn− and Z −
n . A more general formulation of this notion is based on conditional probabilities,
and can be formulated in the information domain in terms of
the well-known TE [9] stating that Xn− → Yn if and only if
T EX →Y |Z > 0 [19], where


(1)
TEX →Y |Z = I Yn ; Xn− |Yn− , Z −
n .
The TE, which is formulated in (1) as a conditional mutual
information (CMI), can be interpreted as the reduction of uncertainty about Yn when learning the past of X, if the past of Y
and the past of Z are already known.
The TE measures aggregate Granger-causal influence of X
at past lags, and thus is not lag-specific. In order to characterize Granger-causal influences between processes for specific
time lags, the definition of G-causality can be intuitively item-

2557

ized as follows [13]: G-causality exists from X to Y at lag u,
Xn −u → Yn , if Xn −u contains information that helps predicting Yn above and beyond the information contained in Yn− , Z −
n
and in Xn− \Xn −u (where\denotes subtraction from a set). In
the information domain, this definition can be formulated stating that Xn −u → Yn if and only if IX →Y |Z (u) > 0 [13], where
the CMI IX →Y |Z (u) is defined as


−
(2)
IX →Y |Z (u) = I Yn ; Xn −u |Yn− , Z −
n , Xn \Xn −u .
The CMI in (2) can be interpreted as the reduction of uncertainty about Yn when learning the past of X at lag u, if the past
of X at all other lags and the whole past of Y and Z is already
known. While the condition IX →Y |Z (u) > 0 allows assessing
lag-specific G-causality, the modulus of IX →Y |Z (u) cannot be
directly related to the information transfer measured by the TE.
To relate lag-specific and overall information transfers, we propose to decompose the TE as
L
T EX →Y |Z (uk )
(3)
T E X →Y |Z =
k =1

where T EX →Y |Z (uk ) = I(Xn −u k ; Yn |Xn −u k +1 , . . . , Xn −u L ,
Yn− , Z −
n ), and the sum is extended to the set of lags Λ =
{u1 , . . . , uL } with significant lag-specific G-causality (i.e.,
Xn −u k → Yn if and only if uk ∈ L; here, the lags are in ascending order). Thus, lag-specific TE analysis is performed first
computing the CMI in (2) to determine the lags uk associated
with significant G-causality, and then computing the measures
T EX →Y |Z (uk ) to be used in (3) as the terms of the TE decomposition. As a result, this decomposition puts in evidence
lag-specific information transfers, defined in a way such that
their aggregate contribution yields the overall TE. The formal
proof of the decomposition (3) is reported in the Appendix.
B. Estimation Approach
In this section, we describe a procedure for estimating the
set Λ of the lags bearing G-causality according to (2), and
then the overall T EX →Y |Z as well as the individual contributions T EX →Y |Z (u) according to (3). The procedure is based
on recognizing that any CMI can be expressed as the difference between two conditional entropy (CE) terms, e.g., the
TE can be expressed as T EX →Y |Z = I(Yn ; Xn− | Yn− , Z −
n)
−
−
−
)
−
H(Y
|
X
,
Y
,
Z
),
where
H(Y
|V
)
= H(Yn | Yn− , Z −
n
n
n
n
n
n
is the CE measuring the entropy of the scalar variable Yn conditioned to the vector variable V. Then, we compute the CE
according to a sequential procedure for nonuniform conditioning whereby the conditioning vector V is updated progressively
taking all relevant processes into consideration at each step and
selecting the components that mostly reduce the uncertainty
about the target variable Yn [11], [12], [14]. Specifically, a set
of initial candidate components is first defined including the
past of all relevant processes up to a maximum lag Lm ax , i.e.,
Ω = {Xn −1 , . . . , Xn −L m a x , Yn −1 , . . . , Yn −L m a x , Z n −1 , . . . ,
Z n −L m a x }. Then, the entropy of Yn conditioned to Ω is computed starting from an empty conditioning vector, V 0 = [.],
and proceeding as follows: 1) at each step k  1, form the candidate vector [W, V k −1 ], where W ∈ Ω\V k −1 , and compute
the CE H(Yn |W, V k −1 ); repeat the computation for all

2558

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

possible candidates; 2) retain the candidate component for which
the estimated CE is minimum, i.e., set V k = [Wk , V k −1 ] such
that Wk = arg minW H(Yn |W, V k −1 ); and 3) terminate the
procedure when an irrelevant component has been selected,
i.e., when I(Yn ; Wk |V k −1 ) = H(Yn |V k −1 ) − H(Yn |V k ) is
not significant. In this study, statistical significance of the reduction in the CE brought by the component Wk selected at the k th
step is assessed empirically using surrogate data. Specifically,
the CMI I(Yn ; Wk |V k −1 ) is compared with the 100(1 − α)th
percentile of its distribution computed over Ns surrogates of the
last selected component Wk , each generated shifting the original
Wk of a randomly selected lag (larger than a minimum lag τm in
set to exclude autocorrelation effects) with respect to Yn and
V k −1 . This independent shift generated surrogates with uncoupling between Wk and Yn . Then, if the original CMI is above the
percentile threshold, Wk is included in the conditioning vector;
otherwise, it is discarded and the procedure terminates including k − 1 components in the final vector V = V k −1 . Note that,
since surrogates are derived only on the basis of the new component Wk , the significance test is actually performed on the
entropy term H(Yn |V k ).
After termination of the procedure for component selection,
the conditioning vector is composed as V = [V X , V Y , V Z ],
where V X , V Y , and V Z denote the components of V belonging
to X, Y, and Z. Then, the CMI in (2) can be estimated as:
IX →Y |Z (u) = H(Yn |V \Xn −u ) − H(Yn |V )

(4)

and, according to the definition of lag-specific G-causality,
Xn −u → Yn if Xn −u is selected by the conditioning procedure, since IX →Y |Z (u) > 0 if Xn −u ∈ V and IX →Y |Z (u) = 0
if Xn −u ∈ V . Thus, the estimate of the set of lags bearing
G-causality from X to Y is Λ = {uk : Xn −u k ∈ V X }. As a
consequence, the lag-specific information transfer in (3) is estimated as T EX →Y |Z (u) = 0 if u  Λ (i.e., if Xn −u ∈ V ), and
as
T E X →Y |Z (uk ) = H(Yn |V Y , V Z , Xn −u k + 1 , . . . , Xn −u L )
− H(Yn |V Y , V Z , Xn −u k , . . . , Xn −u L )

(5)

if u = uk ∈ Λ (i.e., if Xn −u ∈ V ). Finally, the aggregate TE
results either summing up all lag-specific terms or computing
T EX →Y |Z = H(Yn |V Y , V Z ) − H(Yn |V ). In this study, practical estimation of CE from time series data was performed by
the classical histogram-based method, that consists in coarsegraining the observed dynamics using Q quantization levels, and
computing entropies by approximating probability distributions
with the frequencies of occurrence of the quantized values [20].
III. VALIDATION
In this section, we test the ability of the proposed estimator
of lag-specific TE on simulation examples reproducing different
types of interaction between multivariate time series. We considered both linear stochastic and nonlinear deterministic systems
interacting at different time lags and with different strength. For
each simulation scheme, 100 realizations of the simulated processes were generated, lasting either N = 300 or N = 600 points.
The conditioning procedure was executed using Q = 6 quanti-

zation levels in the histogram-based entropy estimation and including Lm ax = 10 (Simulation 1) or Lm ax = 5 (Simulation 2)
past components from each series in the set of candidates. The
termination criterion was run over Ns = 100 surrogates of the
selected component, each generated by circular shift of the component of at least τm in = 20 points [14], and setting α = 0.05
as statistical significance level.
A. Linear Stochastic Processes
In the first simulation, we considered M = 3 stochastic systems defined by the linear equations:
Xn = a1 Xn −1 + a2 Xn −2 + 0.07Yn −1 + 0.5Zn −1 + Un
Yn = 0.2Zn −1 + C1 Xn −δ 1 + C2 Xn −δ 2 + C3 Xn −δ 3 + Vn
Zn = b1 Zn −1 + b2 Zn −2 + Wn

(6)

where Un , Vn , and Wn are independent white noises with
zero mean and unit variance. The parameter design in (6)
is explicitly chosen to simulate the rhythms and interactions commonly observed in cardiovascular and cardiorespiratory variability [21]. The autoregressive parameters a1 , a2 ,
and b1 , b2 , are set to mimic the self-sustained RA (process Z) and the activity of the so-called Mayer waves in AP
(Process X). These autonomous oscillations are generated at
the typical frequencies for AP and RA oscillations, respectively
fx = 0.1 Hz and fz = 0.3 Hz, and were obtained designing
two complex-conjugate poles with modulus ρx,z and phases
ϕx,z = 2πfx,z ; in this study, we set ρx = 0.8 and ρz = 0.9 to get
the values: a1 = 2ρx × cos ϕx = 1.2944, a2 = −ρ2x = −0.64,
b1 = 2ρz × cos ϕz = −0.5562, b2 = −ρ2z = −0.81. The other
parameters in (6) identify causal effects between pairs of processes, which are imposed with fixed strength and delay along
the directions Z → X, Z → Y, and Y → X, and with strength
and delay dependent on the parameters C1,2,3 and δ1,2,3 along
the direction X → Y. The effects Z → X and Z → Y simulate
the known respiratory-related modulations of AP and HP, while
the effects X → Y and Y → X simulate the closed-loop cardiovascular regulation [22]–[26]. Fine tuning of all parameters in
(6) was performed to reproduce as much as possible the spectral
properties of cardiovascular and cardiorespiratory variability series; this is seen in Fig. 1(a), showing that the power spectral
densities of the simulated SAP, HP, and RA series closely resemble those typically observed in real short-term variability
[21].
The analysis was performed focusing on the evaluation of
lag-specific G-causality from X to Y at varying the coupling
and delay parameters. First, we consider the case of G-causality
imposed from X to Y at lags δ1 = 1, δ2 = 2, and δ3 = 8 with
equal coupling C1 = C2 = C3 = 0.5. An example of the analysis performed for a single realization is reported in Fig. 1. The
conditioning procedure starts at k = 0 with an empty vector of
selected components, V 0 = [·], and a CE value initialized at the
entropy of the target series, H(Yn |V 0 ) = 1.49 [see Fig. 1(b)].
At the first step, the candidate component minimizing the CE
is Xn −2 , which is selected for entering the conditioning vector because the CMI is above its corresponding threshold for

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

2559

Fig. 2. Overall results on 100 realizations of Simulation 1 performed
with parameters δ1 = 1, δ2 = 2, δ3 = 8, C 1 = C 2 = C 3 = 0.5, with series
length N = 300 (a) and N = 600 (b). Plots depict the distribution of lagspecific TE (T E X →Y |Z (u); gray boxes: median and 25–75th quantiles,
whiskers: 10–90th percentiles; crosses: 5–95th percentiles) and the corresponding number of realizations for which lag-specific G-causality was detected
(n(IX →Y |Z (u) > 0), gray bars).

Fig. 1. Example of lag-specific TE analysis performed for a realization of
Simulation 1 with parameters δ1 = 1, δ2 = 2, δ3 = 8, and C 1 = C 2 = C 3 =
0.5. (a) Power spectral densities of the three processes generated according to
(6). (b) Left: CMI between the present component of the target process, Y n ,
and the component selected at the kth step of the conditioning procedure, W k ,
conditioned to the vector of previously selected components V k −1 (circles),
plotted together with its corresponding threshold for significance (crosses);
right: entropy of Y n conditioned to the vector of components selected up to the
kth step, V k . The component selected at each step is indicated in the plot (the
component in gray is discarded due to nonsignificant CMI). (c) Lag-specific
TE (T E X →Y |Z (u), circles) and aggregate TE (T E X →Y |Z , dashed line); gray
and white circles denote respectively uncoupled and coupled lags.

significance; then, the procedure selects progressively the components W2 = Xn −8 and W3 = Xn −1 , and terminates at the
fourth step because the component with minimum CE, i.e.,
W4 = Zn −1 such that H(Yn |Zn −1 , V 3 ) < H(Yn |W, V 3 ) for
any W, yields a nonsignificant CMI. Thus, the estimated conditioning vector is V = V 3 = [Xn −2 , Xn −8 , Xn −1 ], differing
from the expected vector only because Zn −1 was excluded at the
fourth step. The exclusion of Zn −1 from the embedding would
lead to missing the detection of the coupling from Z to Y. On
the contrary, the coupling structure from X to Y is detected correctly, with an estimated lag-specific TE that is nonzero exactly
at the lags 1, 2, and 8 and is uniformly zero for all other lags
[see Fig. 1(c)]. Fig. 2 reports the results of the analysis extended
to 100 realizations of the simulation. The good performance of
lag detection is denoted by the TE values distributed above zero
when computed for the coupled lags 1, 2, and 8, and at the zero
level when computed for the other lags. The result is evident for
a series length of N = 600 points, while for N = 300 the lower
quantiles of the TE at lags 1 and 2 touch the zero level. Moreover, the percentage of detection of G-causality at lags 1, 2 is
low for N = 300, while it improves for N = 600. Fig. 2(a) shows
also that, although the coupling parameters was the same for all
three coupled lags, the magnitude of the estimated lag-specific
TE was different.
Then, we considered the case of two lagged effects from X
to Y, imposed at lag δ1 with coupling C1 = C, and at lag δ2

with coupling C2 = 1 − C (setting C3 = 0). We studied the
dependence of the lag-specific TE on the coupling parameter,
letting C vary from 0 to 1 in steps of 0.1, and on the temporal
separation between the two lagged effects, setting the absolute difference between the two lags at predetermined values
(|δ1 − δ2 | = 1, 3, 5, 7, with otherwise random δ1 and δ2 ). Fig. 3
reports the results obtained with N = 300. While the aggregate
TE remains constant at 0.75 (black circles), the lag-specific
TE increases progressively at lag δ1 (white circles), decreases
progressively at lag δ2 (black triangles), and is kept at very low
values for the other time lags (white triangles). Moreover, the accuracy in the detection of lag-specific G-causality, documented
by the number of realizations for which IX →Y |Z (u) > 0, is high
for high C and decreases for lower C at lag δ1 , is high for low
C and decreases for higher C at lag δ2 , and is always very low
for the other time lags (see Fig. 3, right). These results indicate
that the modulus of the lag-specific TE reflects the coupling
imposed for specific time delays, and suggest a good sensitivity
and specificity in the detection of lag-specific G-causality.
B. Nonlinear Multivariate Systems
In the second simulation, we considered the system of
M = 5 coupled Henon maps defined as [12]:
Ym ,n = 1.4 − Ym2 ,n −1 + 0.3Ym ,n −2

for m = 1, M

Ym ,n = 1.4 − [0.5C(Ym −1,n −δ 1 + Ym +1,n −δ 2 )
+ (1 − C)Ym ,n −1 ]2 + 0.3Ym ,n −2

for m = 1, M
(7)

where the parameter C modulates the strength of coupling from
the (m − 1)th and (m + 1)th systems to the mth system. In
this study, we varied C from 0 to 0.8 in steps of 0.1; this
range of values assures that realizations of the driven processes
do not explode and that complete synchronization is avoided
for any pair of processes [12]. In this simulation, the imposed
G-causality relations are Ym −1,n −δ 1 → Ym ,n and Ym +1,n −δ 2 →
Ym ,n . Different realizations of the simulation were obtained

2560

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Fig. 4. Example of lag-specific TE analysis performed for a realization of
Simulation 2 with parameters δ1 = 4, δ2 = 5, and C = 0.4. (a) CMI (left) and
CE (right) computed progressively by the conditioning procedure; symbols are
as in Fig. 1(b). (b) Lag-specific TE computed with Y 3 as destination process and
taking either Y 1 , Y 2 , Y 4 , or Y 5 as source process, collecting the remaining four
processes in the vector Z; gray and white circles denote respectively uncoupled
and coupled lags.

Fig. 3. Overall results on 100 realizations of Simulation 1 performed with time
series length N = 300, with coupling parameters C 1 = C, C 2 = 1 − C, C 3 =
0, and with delay parameters δ 1 and δ 2 such that their absolute difference
increased progressively: (a) |δ1 − δ2 | = 1; (b)|δ1 − δ2 | = 3; (c)|δ1 − δ2 | =
5; and (d)|δ1 − δ2 | = 7. Left panels depict the mean of TE from X to Y computed for the coupled lags (u = δ1 , white circles; u = δ2 , black triangles) and
for the uncoupled lags (u = δ1 , u = δ2 , gray triangles), as well as the aggregate
TE from X to Y (black circles). The right panels depict the number of realizations
for which lag-specific G-causality was detected at lag u = δ1 (white bars), at
lag u = δ2 (black bars), and at lags u = δ1 , δ2 (mean over lags, gray bars).

varying the initial conditions and taking series of length N after
a transient of 103 points. At each realization, the lags δ1 and
δ2 were chosen randomly between 1 and 5. The analysis was
performed assuming Y3 as target process and taking one of the
other maps as source process.
Fig. 4 reports an example of the analysis performed for a
single realization of the simulation of length N = 300, with
coupling C = 0.4 and imposed delays δ1 = 4 and δ2 = 5. As

seen in Fig. 4(a), in this example the sequential conditioning
procedure selects the lagged components of the target process
with lags 1 and 2 at the first and fourth steps, and the components
of other processes with delays matching the imposed delays (i.e.,
Y2,n −4 and Y4,n −5 ) at the second and third step, terminating with
an embedding vector that fully corresponds with the terms set
in (7) for Y = Y3 . As a consequence, the estimated lag-specific
TE closely reflects the expected profiles, i.e., T EX →Y |Z (u) is
always zero for X = Y1 and X = Y5 , while it is nonzero only
at lag u = δ1 = 4 for X = Y2 and only at lag u = δ2 = 5 for
X = Y4 [see Fig. 4(b)].
Fig. 5 reports the overall results of lag-specific TE analysis with target process Y3 , performed separately for the uncoupled source processes [X = Y1 , X = Y5 ; Fig. 5(a) and
(b)] and the coupled source processes (X = Y2 , X = Y3 ), in
the latter case separating the values relevant to the coupled
lags [see u = δ1 , δ2 ; Fig. 5(c) and (d)] from those relevant
to the uncoupled lags [u = δ1 , δ2 ; Fig. 5(e) and (f)]. Along
the uncoupled directions, the lag-specific TE was flattened at
the zero level, and the corresponding relative frequency of detected G-causality was very low [see Fig. 5(a) and (b)]. The
same results were essentially found when considering the TE
evaluated along the coupled directions but for the uncoupled
lags [see Fig. 5(e) and (f)], thus demonstrating the high specificity of the approach for this simulation. When computed for
the lags at which causality was imposed in the simulation, the
TE was distributed at progressively higher values at increasing the parameter C; the corresponding number of significant
detected links also increased with C [see Fig. 5(c) and (d)].

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

2561

TABLE I
CLASSIFICATION RESULTS FOR SIMULATION 2
N = 300

Accuracy
Sensitivity
Specificity

N = 600

α = 0.1

α = 0.05

α = 0.01

α = 0.1

α = 0.05

α = 0.01

90.3%
61.0%
93.2%

92.2%
57.8%
95.5%

94.1%
57.3%
97.7%

92.8%
80.9%
93.9%

94.3%
78.1%
95.9%

96.2%
77.5%
98.1%

Results are obtained over 100 realizations of Simulation 2, considering all four analyzed
directions, nine values of C and five lags. Positives collect the detections at coupled lags
(u = δ 1 , δ 2 , C > 0); negatives collect the detections at all uncoupled lags (u = δ 1 , δ 2 ,
all C), plus those at u = δ 1 , δ 2 with C = 0.

of the conditioning procedure to select less components due to
the higher threshold. Moreover, in this simulation, a lower α determined a higher accuracy. However, given that the specificity
is always high, a higher α might be preferred to improve the sensitivity to weakly coupled dynamics. The high specificity and
the relatively lower sensitivity suggest a conservative behavior
of the procedure for component selection, which may be due to
the dimension-dependent bias of the adopted histogram-based
entropy estimator. Moreover, the reported robustness in specificity of the lag-specific TE with respect to α may be explained
by the narrow CMI distribution always observed for the resampled CMI at the terminating step compared with the range of
variation of CMI (e.g., see Figs. 1, 3, and 6 where the rejection
at the last step is always marginal).
IV. APPLICATION TO CARDIOVASCULAR AND
CARDIORESPIRATORY VARIABILITY
The proposed lag-specific TE analysis was tested on shortterm cardiovascular and cardiorespiratory variability studied
during a protocol which is known to have an impact on the
cardiovascular control systems, i.e., head-up tilt. The considered dynamical systems were the heart, vascular and respiratory
systems, with descriptive processes, respectively, represented
by the variability of HP (process H), SAP (process P), and RA
(process R) measured on a beat-by-beat basis.
Fig. 5. Overall results on 100 simulations of Simulation 2 performed with series length N = 300 (a), (c), (e) and N = 600 (b), (d), (f). Plots depict the distribution of lag-specific TE (T E X →Y |Z (u)) and the corresponding number of realizations for which lag-specific G-causality was detected (n(IX →Y |Z (u) > 0)),
computed as a function of the coupling parameter C. Results are presented
grouping X = Y 1 and X = Y 5 , averaging over all lags u = 1, 2, 3, 4, 5
(a), (b); grouping X = Y 2 and X = Y 4 and averaging over the coupled lags
u = δ1 , u = δ2 (c), (d); grouping X = Y 2 and X = Y 4 and averaging over
the uncoupled lags u = δ1 , u = δ2 (e), (f).

To investigate the dependence of lag-specific coupling detection on the significance level adopted for candidate selection, the
analysis was repeated for different values of the upper percentile
of the surrogate CMI distribution, obtained setting α = 0.1,
α = 0.05, and α = 0.01. The results obtained over sets of 100
process realizations are reported in Table I in terms of binary
classification. As expected, decreasing the significance α led to
lower sensitivity and higher specificity, reflecting the tendency

A. Experimental Protocol and Data Analysis
Fifteen young healthy subjects (8 males, 25 ± 3 years old),
in sinus rhythm and breathing spontaneously, were considered
for the analysis. The experimental protocol consisted of 15 min
of data collection in the resting supine position, followed by
head-up tilting performed using a motorized table, and by another 15 min of acquisition in the 60° upright position. The
acquired signals (1 KHz sampling rate, 12 bit precision) were
the surface ECG (lead II), the finger photopletismographic arterial blood pressure (Finapres), and the respiratory nasal flow (by
differential pressure transducer). The beat-to-beat time series of
HP, SAP, and RA were measured offline respectively as the sequences of the temporal distances between consecutive R waves
of the ECG, the local maxima of the arterial pressure signal inside each detected HP, and the values of the respiratory signal
sampled at the onset of each HP. After removing artifacts and

2562

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Fig. 6. Example of application of the proposed conditioning procedure to the physiological variability series measured from a representative subject in the supine
position (a) and in the upright position after passive head-up tilt (b). Panels depict the variability series of RA (R n ), SAP (P n ) and HP (H n ), as well as the
CMI applied to each series (black circles) and the corresponding significance threshold (gray crosses); the components bringing a significant contribution to the
description of the target series are indicated within each CMI plot.

slow trends, two stationary time series of N = 300 points were
selected for each subject, one in the supine position (2 min
before tilting) and one in the upright position (2 min after
tilting). Weak stationarity was checked for each series verifying
the stability of mean and variance in subportions the selected
window [27]. Each series was normalized to zero mean and unit
variance, obtaining the dimensionless series related to HP, Hn ,
SAP, Pn , and RA, Rn (n = 1, . . . , N).
Nonuniform conditioning was performed quantizing the series with Q = 6 levels, setting the parameters of the criterion
for termination of candidate selection at Ns = 100, τm in = 20
and α = 0.05, and including Lm ax = 10 past samples for each
series into the set of candidates. As the adopted measurement
convention allows instantaneous (i.e., not delayed) effects from
RA to systolic SAP and to HP, as well as from SAP to HP, the
zero-lag term, i.e., Rn or Pn , was included into the set of initial
candidates when appropriate [15].
The statistical significance between the distributions of a
given TE measure (aggregate or lag-specific) computed in the
supine and upright positions was assessed by the Wilcoxon
signed rank test for paired data. For an assigned condition
(supine or upright), the statistical significance among the TE
distributions computed at different lags was assessed by the
nonparametric one-way ANOVA (Kruskall–Wallis test); when
the null hypothesis of equal median for all lag-specific TEs was
rejected, the statistical significance between pairs of distributions was assessed by a posthoc analysis (Wilcoxon test) using
the Tukey’s honestly significant difference criterion to correct
for multiple comparisons. A p < 0.05 was considered as statistically significant.
B. Results
Fig. 6 reports a representative example of nonuniform
conditioning performed in the two considered experimental

conditions (supine and upright body positions) taking each of the
three physiological systems (heart, pressure, and respiration) as
target system. We see that, in both supine and upright positions,
the respiration system acts as an isolated system. Indeed, the
present state of R, described by the variable Rn , is explained—
in terms of CMI—exclusively by its own past states [see Rn −1
and Rn −2 in Fig. 6(a), and Rn −1 and Rn −3 in Fig. 6(b)].
Conversely, the states visited by the vascular system (process
P) are explained not only by its own past, but also by the past
of R and H in the supine position (see Fig. 6(a): a significant
contribution to the description of Pn in terms of CMI is brought
by the components Rn −1 and Hn −6 ), and by the past of R in
the upright position (see Fig. 6(b): Rn −3 contributes to the description of Pn ). As to the heart system (process H), we see that
significant contributions to the description of its dynamics come
from its own past in both body positions, as well as from the
past of R in the supine position and from the lag-zero component
of P in the upright position (denoting a fast, within-beat interaction). From these results we can infer, in this representative
subject: 1) the presence of significant information transfer from
RA to SAP (G-causality at lag 1 and at lag 3 in the supine and
upright positions, respectively) and to HP (G-causality at lag 1
in the supine position only); 2) significant information transfer
from HP to SAP in the supine position (G-causality at lag 6)
and from SAP to HP in the upright position (G-causality at lag
0); and 3) the absence of information transfer to the respiration
system.
The analysis extended to the 15 considered subjects led to
the overall results illustrated in Fig. 7. Taking the heart as target
system [see Fig. 7(a) and (b)], we found an important information transfer from RA to HP in the supine position, documented
by the high values of the aggregate TE from R to H, which was
statistically significant in all 15 subjects [see Fig. 7(a)]; the information transfer decreased significantly moving to the upright
position. Looking at the lag-specific TE values, we found that

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

2563

Fig. 7. Results of lag-specific TE analysis of physiological time series performed (a) from RA to HP, (b) from SAP to HP, (c) from RA to SAP, (d) from HP
to SAP, (e) from SAP to RA, and (f) from HP to RA. In each panel, the upper box-whisker plots depict the distribution over 15 subjects of the aggregate (left)
and lag-specific (right) TEs estimated in the supine (gray) and upright (white) positions; the lower barplots depict the number of subjects for which aggregate TE
(left) and lag-specific TE (right) were strictly positive, denoting detection of G-causality and lag-specific G-causality. ∗, p < 0.05 supine versus upright (paired
Wilcoxon test); #, p < 0.05 versus all other time lags except those reported close to the symbol (ANOVA + posthoc test).

the transfer from RA to HP occurred almost exclusively at lag 1
in the supine position (T ER →H |P (1) was nonzero in 14 subjects
and significantly higher than T ER →H |P (u) for any u  1), and
was negligible at all lags in the upright position. The information
transfer from SAP to HP [see Fig. 7(b)] was weak in the supine
position, since T EP →H |R was significant in only five subjects
and T EP →H |R (u) was significant in less than five subjects for
all lags. In the upright position the transfer increased markedly
as documented by the significantly higher values of T EP →H |R ,
which were nonzero in 14 out of 15 subjects. Moreover, the

lag-specific analysis revealed that subjects in the upright position display substantial fast, within-beat interactions from SAP
to HP which were absent whilst supine; this was documented by
the marked increase of T EP →H |R (0), which was significantly
larger than T EP →H |R (u) for any u = 0 and was nonzero in 11
subjects.
The analysis performed with SAP as target process [see
Fig. 7(c) and (d)] indicated the presence of a significant information flow arriving from RA [see Fig. 7(c)], which was
substantial in both conditions (T ER →P |H was significant in 13

2564

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

subjects both before and after tilt); according to the ANOVA test,
this flow occurred essentially at lag 1 in the supine position, and
at lags 1 and 3 in the upright position. As shown in Fig. 7(d), the
incoming flow originating from HP, T EH →P |R , was of lower
magnitude and was significant in 9 out of 15 subjects in both
body positions; when assessed through the lag-specific analysis,
it was detected mostly at lag 2, as T EH →P |R (2) was significantly higher than when computed for the other lags (though it
was nonzero in six subjects only).
The TE analyses performed with RA as target process [see
Fig. 7(e) and (f)] indicated a lack of information transfer from
cardiac and pressure systems to respiration. This lack was documented by the low TE values and the small number of subjects
with nonzero TE observed for both aggregate and lag specific
measures (the median was zero for all distributions), as well as
by the absence of significant variations of TE across lags (the
ANOVA test did not report any statistical significance).
V. DISCUSSION
In this paper, we have introduced a modification of the wellknown TE aimed at making it able to detect, besides the direction
and the magnitude of the information transfer between coupled
processes, its exact timing. The most distinctive features of the
proposed approach are that: 1) it is model-free and fully multivariate; 2) it yields nonzero information transfer only at the
time lags for which significant causality exists according to a
lag-specific formulation of the notion of Granger causality [10];
3) it quantifies the information transfer in a way such that the
sum of all contributions at the different time lags returns the
well-known TE measure [9]; and 4) statistical significance of
information transfer estimates is implicitly tested resulting in
strictly positive values of both lag-specific and aggregate TE.
The reported simulation examples demonstrated the ability of
the approach to recover the true interaction delays, and thus to
decompose the overall information transfer over time, in short
realizations of discrete-time processes mimicking the conditions of interaction typical of physiological time series analysis.
The real data application, showing how different physiological
mechanisms can be successfully described in terms of direction, involvement, and latency, supported the feasibility of the
approach for the investigation of short-term cardiovascular and
cardiorespiratory interactions.
A. Lag-Specific TE as a Model-Free Measure of Time-Lagged
Information Transfer
The proposed model-free analysis of lag-specific information transfer complements previous developments of dynamical
information theory of multiple time series which allowed to
evolve from nondirectional to causal assessment of interactions
[20], and from purely bivariate to fully multivariate implementations [12]–[14], [28]. In this study, multivariate analysis and
delay reconstruction are obtained in virtue of the procedure for
nonuniform conditioning presented in Section II-B. Given its
sequential nature the procedure achieves a criterion for maximum relevance and minimum redundancy in selecting, among
all observed processes, their time lagged components in order

to achieve the best possible description of the target process in
terms of entropy reduction [12], [14]. Minimizing redundancy
helps to escape the curse of dimensionality [13] that would otherwise affect any standard uniform conditioning approach, and
is exacerbated in multivariate applications when components
from several time series have to be considered. Moreover, selecting the components on the basis of their relevance allows to
identify the time lags at which the source system sends a significant amount of information to the destination system. Then,
the selected time lags are exploited to allocate across time the
overall information transfer measured by the TE, using the decomposition strategy of Section II-A. The procedure for delay
reconstruction proposed in this paper further develops previous
studies from our group where component selection was also
based on CE minimization and nonuniform conditioning [14],
[29], [30]. A first development is that, instead of implementing
the component selection twice (respectively, with and without
inclusion in the set of candidates of lagged components from
the driver process), we followed the approach first proposed in
[11] of performing a single mixed embedding and then computing the information transfer by the use of properly reduced
embedding vectors [see, e.g., (4) (5)]. Moreover, in our earlier
studies [14], [29], [30], an empirical correction to the estimated
CE was introduced for compensating the estimation bias and to
let the CE reach a minimum to be used as termination criterion.
Instead of applying any correction, following an idea from [12]
in this paper we assessed the statistical significance of the contribution brought by each selected component to the description
of the target process, so that only the components bringing a
significant contribution could be selected and the procedure terminated when the new contribution is not significant. With this
approach the process of component selection, and consequently
of delay reconstruction, is grounded on a statistical basis. As
a result, the TE at any specific lag can be set to zero if the
lag does not correspond to a selected component and, at the
same time, any nonzero lag-specific TE can be taken as statistically significant without the need of posterior significance
testing.
The approach proposed in this paper is not the first attempt
to evaluate lag-specific directional interactions in the information domain. In their recent papers, Pompe and Runge [31] and
Runge et al. [32] have defined a measure, denoted as momentary
information transfer (MIT), which assesses lag-specific causality among coupled systems satisfying intuitive properties of
generality and interpretability. Very recently, Wibral et al. [16]
proposed an interesting alternative to estimate the coupling delays using lagged vector variables from the reconstructed state
space instead of lagged scalar variables as done in the present
and in previous studies [31], [32]. The approaches followed
in [31] and [16] make use of a scanning approach whereby
lag-specific measures of information transfer are computed as a
function of the delay. This approach is theoretically well founded
as the measures become maximal only at the true interaction
lags, thus allowing delay reconstruction, and has been found to
work very well for simulations with long interaction lags and
finely sampled real neurological data [16]. However, the scanning approach proposed in [16] provided statistically significant

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

measures of coupling even for delays close but different to the
true ones. Thus, it could yield unclear results when working
on coarsely sampled time series like those representing beat-tobeat cardiovascular variability. On the contrary, our approach is
explicitly designed to estimate nonzero information transfer for
all and only the delays associated with significant lag-specific
G-causality and, as such, should retain high specificity avoiding
false coupling detections at lags close to the true coupled ones.
This peculiarity of our approach arises from the fact that it first
tries to infer the set of lags bearing significant G-causality, and
then the information transfer is estimated as nonzero solely over
the inferred interaction delays. Of course, in this case the quality
of the approach depends on the accuracy of delay reconstruction.
Our simulations performed on short realizations of multivariate
time series have reported a good accuracy in the detection of
imposed delays (see, e.g., Fig. 3, Table I, Fig. 5). In the recent
literature, a two-step approach similar to that presented here has
been used by Runge et al. [32] as a development of the original formulation of their MIT measure [31]. Compared to this
latter development, our approach is different in that the interaction delays are inferred exploiting nonuniform conditioning
[11], [14] rather than causal graphical models [13], and in that
the information transfer is quantified in terms of lag-specific
TE instead of MIT. While both solutions seem feasible, a direct
comparative study would be needed to set the optimal approach
to deal with the delicate step of delay reconstruction. Another
important property of our approach, not shared with other timelagged measures of information, is in the fact that it is designed
so that the overall information transfer yielded summing the lagspecific contributions is exactly equal to the TE. According to its
original formulation [19], the TE measures the aggregate contribution of all past states of the source system to the predictive
information about the present state of the destination system.
Hence, setting a direct relationship between lag-specific and aggregate TE measures is useful because it allows to distribute
the overall information transfer over the time lags at which it
occurs.
The proposed approach for lag-specific TE estimation suffers
also from limitations. Some of them are intrinsically related with
the concept of TE. For instance, since entropy-based approaches
do not supply spectral information, the proposed TE measures
cannot retrieve the frequency content of the detected information transfer, or detect differences in the amount of information
transferred in different frequency bands. Spectral analysis of directional interactions may be rather performed employing frequency domain connectivity measures [33]–[35]. Another issue
of TE computation is that it relies on the estimation of conditional probabilities involving vector variables, which becomes
a daunting task at increasing dimensions. While nonuniform
conditioning approaches like the one employed here help in
limiting the number of variables involved in TE estimation, the
application with a large number of time series remains an open
challenge. Moreover, it has been recently shown that the TE
should be strictly interpreted as a measure of predictive information transfer, rather than of causal coupling or causal effect
size, because it may be affected by other factors than the coupling strength between two variables (like the internal system

2565

dynamics or the interaction with third variables) and may vanish
even in presence of significant causal effects [36]. In this study,
the lack of a one-to-one correspondence between information
transfer and coupling parameters has been observed at the level
of our lag-specific analysis, e.g., in Fig. 2 showing that lagged
effects weighted with equal parameter C = 0.5 are associated
with different amounts of information transfer. Nevertheless,
we found that the estimated lag-specific information transfer
follows the coupling parameter when all other parameters are
kept fixed (see Figs. 3 and 5).
As to the limitations specific of the proposed TE measure, the
main is probably in the fact that the derivation in (3) lacks of
uniqueness if the order for the terms progressively entering the
decomposition is not assigned a priori. This is a consequence of
the intrinsic arbitrariness of the chain rule for expansion of the
MI [37, p. 24]. In this study, the arbitrariness was settled making
the intuitive choice of conditioning progressively according to
the flow of time (i.e., lag-specific TEs with smaller lags are computed first). While simulations show that this choice yields reasonable results (see, e.g., Figs. 3 and 5), decompositions based
on other orderings are in principle equally valid. The prior choice
of an ordering in the decomposition has an impact also on the
contribution assigned to single lags in the presence of combined
lagged effects (e.g., of the form Xn −u 1 × Xn −u 2 ); however, situations of combined lagged effects are difficult to handle as in
this case it seems even difficult to provide a proper definition
for the contribution provided by each single lag. Also the procedure for nonuniform conditioning presents some limitations.
From a practical point of view, the selection of components performed by the procedure results somewhat cumbersome as it
is based on a computing multidimensional entropy estimations
repeatedly for all candidates, and on testing for significance of
each selected candidate. However, while the overall procedure
applied to multivariate datasets with many time series is time
consuming, the fact that it returns statistical significance of each
measured TE makes it less computationally intensive than standard uniform conditioning methods if they have to be associated
with randomization (surrogate) significance tests [12]. Finally,
the histogram-based entropy estimator adopted in this study is
known to have a bias depending on the dimension of the explored
space and on the number of quantization levels. This bias may
also explain the fact that the estimated CMI does not always
decrease at subsequent steps of the conditioning procedure (see
Figs. 1, 4, and 6), as one would intuitively expect. Although we
have shown in this and in previous studies [14], [15], [29], [30]
that the histogram method may be effective even for short-time
series if it is combined with a parsimonious approach for component selection, the use of more accurate entropy estimators
like those based on kernels or nearest neighbor methods [20]
would likely yield less biased TE estimates.
B. Lag-Specific TE Analysis in Short-Term Cardiovascular
and Cardiorespiratory Variability
The results of the application to short-term cardiovascular
and cardiorespiratory variability suggest that the proposed approach is useful to detect amount and timing of the directional

2566

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

information transfer among the cardiac, vascular and respiratory
systems in agreement with known important physiological regulatory mechanisms. First, the presence of significant information
transfer measured from RA to HP and SAP [see Fig. 7(a) and
(c)], together with the substantial absence of transfer along the
opposite direction from SAP or HP toward RA [see Fig. 7(e) and
(f)], documented the unidirectional nature of cardiovascular and
cardiorespiratory interactions. This result is in agreement with
the fact that respiration is known to act as an exogenous input on
the cardiac and vascular variables, i.e., it affects heart rate and
AP variability without being affected by them [1]. The information flow from RA to SAP reflects perturbations of breathing on
the intrathoracic pressure that are transmitted to the cardiac output and then to the vasculature [5]. The information flow from
RA to HP provides a quantification of the coupling mechanisms
associated with the well-known phenomenon of respiratory sinus arrhythmia, whereby beat-by-beat accelerations and decelerations of the heart rate occur respectively during inhalation
and exhalation [22]. The results of our aggregate TE analysis,
showing that after tilt the information transfer from RA to SAP
is preserved, while the transfer from RA to HP is blunted, followed what we found on the same dataset performing a similar
nonlag-specific analysis of causal coupling in the information
domain [30]. As a novel finding, in the present study, we noted
that information flows from the respiratory to the cardiac and
vascular systems mostly with a delay of one beat, thus indicating
fast (though not within-beat) transfer of information. Moreover,
the appearance of a significant entropy transferred from RA to
SAP at lag 3 in the upright position suggests that tilting may
induce a slowing of the vasculo-pulmonary information flow.
As to the cardiopulmonary flow, the reduced TE after tilt confirms in the information domain previous findings based on time
and frequency domain analyses showing that respiration-related
oscillations of the heart period are dampened in the upright position [23]. It is worth noting that, since the information transfer
is estimated through a multivariate approach which rules out the
transfer mediated by AP variability, the observed reduction of
respiratory sinus arrhythmia should be ascribed more to a decoupling between the central respiratory drive and the cardiac
vagal neurons [24], than to variations of the mechanical drive
of respiration on arterial pressure transmitted to the sinus node
through the baroreflex [5].
The utilization of a fully multivariate approach is also recommended to rule out the confounding effects of RA on HP
and AP variability in the analysis of cardiovascular interactions.
As observed recently following a linear model-based approach
[25], bivariate analyses of cardiovascular interactions conducted
without an explicit consideration of respiratory variability likely
yield misleading interpretation of the directional interaction effects between HP and SAP. This has been confirmed in the linear model-free framework in a paper introductory to the present
study [18]. Here, we have shown how conditioning on RA allows to detect known physiological mechanisms of interaction
between HP and SAP, and to describe their modification in response to head-up tilt. Specifically, we observed a detectable
information flow along the two directions of the cardiovascular closed loop, documenting the cardiac baroreflex feedback

whereby SAP affects HP and the mechanical feedforward effects on HP on SAP [1], [3]. Confirming previous findings [4],
[26], [30], we observed that the information transfer through the
baroreflex was weak in the supine position and increased substantially after tilt, while the feedforward transfer was balanced
in the two conditions. The increased impact of SAP on HP observed in the upright position, indicating a larger involvement of
the baroreflex in this condition, has been previously documented
and is well explained by the fact that the baroreflex is the main
mechanism responsible for the maintenance of blood pressure
levels in the presence of reduced venous return manifested during the orthostatic stress [3], [26]. As an additional result, our
entropy decomposition showed that the increased information
transfer through the baroreflex occurs almost entirely with very
short-time delays, as documented by the marked increase of TE
measured at lag 0 in the upright position compared to the supine
[see Fig. 7(b)]. This result suggests that the change of posture
involves the baroreflex mainly by means of fast, within-beat
effects of SAP on HP. Moreover, the result is physiologically
plausible, as it is consistent with experimental findings reporting
that in humans the typical values of the latency of the baroreflex
are lower than 1 s [38]. As to the feedforward effects from HP
to SAP, we found that not only the magnitude but also the delay
of the information transfer was unchanged moving from supine
to upright. This finding could be explained by the fact that, as
the response of the cardiac and vascular systems to changes
in HP is governed by mechanical rather than by neural effects
[2], it may be less affected by the orthostatic stimulus which
is known to evoke a response of the autonomic nervous system
in its sympathetic and vagal branches. Note that the lag found
as the most likely delay through which feedforward effects occur was higher than that found for feedback effects (2 beats
versus 0 or 1 beat). This difference seems to indicate that the
mechanical influences whereby heart period modifications progressively affect end-diastolic volume, stroke volume, cardiac
output and then arterial pressure are slower than the neurally
mediated influences occurring through the baroreflex.
VI. CONCLUSION
Being grounded in information theory, model-free and fully
multivariate, the approach proposed in this study to assess directional lag-specific interactions is applicable to virtually any
field of science where the observed phenomena can be understood in terms of complex networks, including gene networks,
economy and finance, climatology, brain circuits, and physiological networks, provided that stationary time series of at least
a few hundred points may be measured for the observed dynamics. The flexibility of the tool has been demonstrated by its
successful application to both linear stochastic and nonlinear
chaotic time series studied in the short-term conditions typical
of real-world time series analysis. In the field of cardiovascular
and cardiorespiratory variability, such a flexibility allows investigating complex physiological interactions without the need of
matching the presumed mechanisms of data generation with a
predefined model class. Moreover, a thorough assessment of
physiological interactions is offered by the possibility to infer,

FAES et al.: LAG-SPECIFIC TE AS A TOOL TO ASSESS CARDIOVASCULAR AND CARDIORESPIRATORY INFORMATION TRANSFER

in addition to the direction and the magnitude, also the timing
of the information transfer between coupled variables. While
this study has mainly confirmed the capability of the proposed
approach to describe expected mechanism alterations in terms
of the known cardiovascular physiology, future applications in
clinical settings would clarify its power in diagnosing pathological conditions, supporting medical treatments, managing patients at risk, or testing drugs.

[3]

[4]

[5]

APPENDIX
[6]

Here, we provide the formal derivation of the decomposition
of the TE given in (3). We start defining the set of all and only the
lagged components of X associated with significant G-causality
toward Y as XnΛ = {Xn −u k : uk ∈ Λ} = {Xn −u k : Xn −u k →
Yn }. With this formalism, the whole past of X, Xn− , can be
expressed as the ensemble of the L scalar variables Xn −u k (k =
1, . . . , L) corresponding to the lags with significant G-causality,
plus the vector variable Xn− \XnΛ containing only components
of X which do not bear G-causality toward Y.
Next, we recall the chain rule for the CMI, stating that the
MI between the M variables A1 , . . . , AM , and the variable B,
conditioned to the variable C, can be decomposed as:
I (A1 , ..., AM ; B|C) =

M


[9]
[10]
[11]
[12]

I (Am ; B|Am +1 , ..., AM , C)
[14]

(A1)
where any variable can be also vector valued. The rule is a
simple reformulation, and extension to CMI, of the chain rule
for information [37, p. 24]. Here, (A1) is applied considering
−
Λ
B = Yn , C = {Yn− , Z −
n }, A1 = Xn \Xn , and {A2, . . . , AM }
Λ
= Xn = {Xn −u 1 , Xn −u 2 , . . . , Xn −u L }, which leads to express
the TE from X to Y defined in (1) as
TEX →Y |Z = I(Xn− ; Yn |Yn− , Z −
n)

[15]
[16]
[17]
[18]

= I(Xn− \XnΛ ; Yn |XnΛ , Yn− , Z −
n)
+

[8]

[13]

m =1

L


[7]

[19]

I(Xn −u k ; Yn |Xn −u k +1 , ..., Xn −u L , Yn− , Z −
n ).

k =1

[20]

(A2)
Then, since the set Xn− \XnΛ contains by definition only lagged
components of X which do not bear G-causality toward Y, it
follows that I(Xn− \XnΛ ; Yn |XnΛ , Yn− ,Z −
n ) = 0. This immediately
reduces (A2) to (3), thus proving the decomposition.
Note that, while the aggregate TE T EX →Y |Z is independent
on how the decomposition is arranged, the value of each lagspecific term T EX →Y |Z (uk ) depends on the position of the
lagged component Xn −u k inside the set XnΛ ; in this study, the
components are ordered respecting the flow of time, i.e., satisfying the condition u1 < u2 . . . < uL .

[21]

[22]
[23]

[24]
[25]

REFERENCES
[1] M. A. Cohen and J. A. Taylor, “Short-term cardiovascular oscillations in
man: Measuring and modelling the physiologies,” J. Physiol., vol. 542,
no. Pt 3, pp. 669–683, Aug. 2002.
[2] T. J. Mullen, M. L. Appel, R. Mukkamala, J. M. Mathias, and R. J. Cohen,
“System identification of closed loop cardiovascular control: Effects of

[26]

2567

posture and autonomic blockade,” Am. J. Physiol., vol. 272, no. 1 Pt 2,
pp. H448–H461, 1997.
G. Nollo, L. Faes, A. Porta, R. Antolini, and F. Ravelli, “Exploring directionality in spontaneous heart period and systolic pressure variability
interactions in humans. Implications in baroreflex gain evaluation,” Am.
J. Physiol., vol. 288, no. 4, pp. H1777–H1785, 2005.
L. Faes, G. Nollo, and A. Porta, “Mechanisms of causal interaction between short-term RR interval and systolic arterial pressure oscillations
during orthostatic challenge,” J. Appl. Physiol., vol. 114, no. 12, pp. 1657–
1667, Jun. 2013.
K. Toska and M. Eriksen, “Respiration-synchronous fluctuations in stroke
volume, heart rate and arterial pressure in humans,” J. Physiol., vol. 472,
pp. 501–512, Dec. 1993.
D. L. Eckberg, “The human respiratory gate,” J. Physiol., vol. 548, no. 2,
pp. 339–352, Apr. 2003.
A. Porta, S. Guzzetti, N. Montano, M. Pagani, V. Somers, A. Malliani,
G. Baselli, and S. Cerutti, “Information domain analysis of cardiovascular variability signals: Evaluation of regularity, synchronization andcoordination,” Med. Biol. Eng. Comput., vol. 38, pp. 180–188, 2000.
S. Schulz, F. C. Adochiei, I. R. Edu, R. Schroeder, H. Costin, K. J. Bar,
and A. Voss, “Cardiovascular and cardiorespiratory coupling analyses: A
review,” Phil. Trans. Roy. Soc. A, vol. 371, no. 1997, p. 20120191, 2013.
T. Schreiber, “Measuring information transfer,” Phys. Rev. Lett., vol. 85,
pp. 461–464, 2000.
C. W. J. Granger, “Investigating causal relations by econometric models
and cross-spectral methods,” Econometrica, vol. 37, pp. 424–438, 1969.
I. Vlachos and D. Kugiumtzis, “Nonuniform state-space reconstruction
and coupling detection,” Phys. Rev. E, vol. 82, p. 016207, 2010.
D. Kugiumtzis, “Direct-coupling information measure from nonuniform
embedding,” Phys. Rev. E, vol. 87, no. 6, Jun. 2013.
J. Runge, J. Heitzig, V. Petoukhov, and J. Kurths, “Escaping the curse
of dimensionality in estimating multivariate transfer entropy,” Phys. Rev.
Lett., vol. 108, p. 258701, 2012.
L. Faes, G. Nollo, and A. Porta, “Information-based detection of nonlinear
Granger causality in multivariate processes via a nonuniform embedding
technique,” Phys. Rev. E., vol. 83, nos. 5 Pt 1, p. 051112, 2011.
L. Faes, G. Nollo, and A. Porta, “Compensated transfer entropy as a tool
for reliably estimating information transfer in physiological time series,”
Entropy, vol. 15, no. 1, pp. 198–219, 2013.
M. Wibral, N. Pampu, V. Priesemann, F. Siebenhuhner, H. Seiwert,
M. Lindner, J. T. Lizier, and R. Vicente, “Measuring information-transfer
delays,” PLoS One, vol. 8, no. 2, Feb. 2013.
V. Flunkert, I. Fischer, and E. Scholl, “Dynamics, control and information
in delay-coupled systems: An overview,” Phil. Trans. Roy. Soc. A, vol.
371, p. 20120465, 2013.
L. Faes and G. Nollo, “Decomposing the transfer entropy to quantify lagspecific Granger causality in cardiovascular variability,” in Proc. IEEE
Conf. Eng. Med. Biol. Soc., 2013, pp. 5049–5052.
P. O. Amblard and O. J. Michel, “The relation between Granger causality and directed information theory: A review,” Entropy, vol. 15, no. 1,
pp. 113–143, 2013.
K. Hlavackova-Schindler, M. Palus, M. Vejmelka, and J. Bhattacharya,
“Causality detection based on information-theoretic approaches in time
series analysis,” Phys. Rep., vol. 441 pp. 1–46, 2007.
Task Force of The European Society for Cardiology and the North American Society of Pacing and Electrophysiology, “Heart rate variability:
Standards of measurement, physiological interpretation, and clinical use,”
Eur. Heart J., vol. 17, pp. 354–381, 1996.
J. A. Hirsch and B. Bishop, “Respiratory sinus arrhythmia in humans:
How breathing pattern modulates heart rate,” Am. J. Physiol., vol. 241, no.
4, pp. H620–H629, Oct. 1981.
W. H. Cooke, J. B. Hoag, A. A. Crossman, T. A. Kuusela, K. U. O.
Tahvanainen, and D. L. Eckberg, “Human response to upright tilt: a window on central autonomic integration,” J. Physiol., vol. 517, no. 2, pp.
617–628, 1999.
M. P. Gilbey, D. Jordan, D. W. Richter, and K. M. Spyer, “Synaptic mechanisms involved in the inspiratory modulation of vagal cardio-inhibitory
neurones in the cat,” J. Physiol., vol. 356, pp. 65–78, Nov. 1984.
A. Porta, T. Bassani, V. Bari, G. D. Pinna, R. Maestri, and S. Guzzetti,
“Accounting for respiration is necessary to reliably infer granger causality
from cardiovascular variability series,” IEEE Trans. Biomed. Eng., vol. 59,
no. 3, pp. 832–841, Mar. 2012.
A. Porta, A. M. Catai, A. C. Takahashi, V. Magagnin, T. Bassani,
E. Tobaldini, B. P. van de, and N. Montano, “Causal relationships between heart period and systolic arterial pressure during graded head-up
tilt,” Am. J. Physiol., vol. 300, no. 2, pp. R378–R386, Feb. 2011.

2568

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

[27] V. Magagnin, T. Bassani, V. Bari, M. Turiel, R. Maestri, G. D. Pinna,
and A. Porta, “Non-stationarities significantly distort short-term spectral,
symbolic and entropy heart rate variability indices,” Physiol. Meas., vol.
32, pp. 1775–1786, 2011.
[28] J. T. Lizier, M. Prokopenko, and A. Y. Zomaya, “Information modification
and particle collisions in distributed computation,” Chaos, vol. 20, no. 3,
Sep. 2010.
[29] L. Faes, G. Nollo, and A. Porta, “Non-uniform multivariate embedding
to assess the information transfer in cardiovascular and cardiorespiratory
variability series,” Comput. Biol. Med., vol. 42, pp. 290–297, 2012.
[30] L. Faes, G. Nollo, and A. Porta, “Information domain approach to the
investigation of cardiovascular, cardiopulmonary, and vasculo-pulmonary
causal couplings,” Front. Physiol., vol. 2, no. 90, pp. 1–13, 2011.
[31] B. Pompe and J. Runge, “Momentary information transfer as a coupling
measure of time series,” Phys. Rev. E, vol. 83, no. 5, May 2011.
[32] J. Runge, J. Heitzig, N. Marwan, and J. Kurths, “Quantifying causal coupling strength: A lag-specific measure for multivariate time series related
to transfer entropy,” Phys. Rev. E, vol. 86, no. 6, Dec. 2012.
[33] L. Faes, S. Erla, and G. Nollo, “Measuring connectivity in linear multivariate processes: Definitions, interpretation, and practical analysis,” Comp.
Math. Methods Med., vol. 2012, p. 140513, 2012.
[34] L. A. Baccalà and K. Sameshima, “Partial directed coherence: A new
concept in neural structure determination,” Biol. Cyb., vol. 84, pp. 463–
474, 2001.
[35] S. L. Bressler and A.K. Seth, “Wiener–Granger causality: A well established methodology,” Neuroimage, vol. 58, pp. 323–329, 2011.
[36] D. Chicharro and A. Ledberg, “Framework to study dynamic dependencies
in networks of interacting processes,” Phys. Rev. E, vol. 86, p. 041901,
2012.
[37] T. M. Cover and J. A. Thomas, Elements of Information Theory, 2nd ed.
New York: Wiley, 2006.
[38] T. G. Pickering and J. Davies, “Estimation of the conduction time of the
baroreceptor-cardiac reflex in man,” Cardiovasc. Res., vol. 7, no. 2,NY
USA, pp. 213–219, Mar. 1973.

Daniele Marinazzo received the Master and Ph.D.
degrees in physics from the University of Bari, Bari,
Italy in 2001 and 2007, respectively.
He has been Post-doctoral Researcher with
CNRS,Paris, France from 2008 to 2011, and is
currently a Professor at the University of Gent,
Gent, Belgium. His activity focuses on techniques of
neuroimaging data analysis and on methodological
and computational aspects of neuroscience research.
He regularly organizes workshops, conferences, and
journal special issues around connectivity methods
and their applications to neuroscience. He is involved in active collaborations
with theoretical and experimental groups in Belgium, Spain, Italy, France, and
China.

Luca Faes (M’07) received the M.S. degree in electronic engineering from the University of Padova,
Italy, in 1998, and the Ph.D. degree in electronic devices from the University of Trento, Italy, in 2003.
Since 2004, he has been a Research Fellow with the
Department of Physics, University of Trento. He is
currently with the Bruno Kessler Foundation, Trento.
His research activity is focused on the development of
methods for time series analysis and system modeling, with applications to cardiovascular neuroscience,
cardiac arrhythmias, brain connectivity, and physiological networks. He has authored more than 80 journal papers. His h-index is
17 (font: Scopus).
Dr. Faes has been IEEE EMBC Associate Editor since 2007.

Giandomenico Nollo (M’07) received the degree in
physics from the University of Trento, Trento, Italy
and the Ph.D. degree in physiology from the University of Turin, Turin, Italy.
He is Scientific Advisor of the Work and Welfare
Department of the Autonomous Province of Trento,
and for it responsible of the Healthcare Research and
Innovation Program at FBK pursued in collaboration
with local health trust and the research and academic
systems. His research interests are in the application
of frontier technologies for health, including monitoring of human biosignals and modeling of physiological systems, e-health
applications, and Health Technology Assessment. He is co-author of more than
100 papers on books and international peer review journals and proceedings.

Alessandro Montalto was born in 1984. He received
the M.S. degree from the University of Naples Federico II, Naples, Italy, in 2012. Since October 2012,
he has been working toward the Ph.D. degree at the
Department of Data Analysis of the Faculty of Psychology and Pedagogical Sciences, Ghent University,
Gent, Belgium.
His research interests include the development of
information theory tools for the multivariate analysis of neurophysiological and cardiovascular signals,
and the study of neural networks models of the brain.

