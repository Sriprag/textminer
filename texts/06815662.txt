IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

2593

Improvements in Remote Cardiopulmonary
Measurement Using a Five Band Digital Camera
Daniel McDuff∗ , Student Member, IEEE, Sarah Gontarek, and Rosalind W. Picard, Fellow, IEEE

Abstract—Remote measurement of the blood volume pulse via
photoplethysmography (PPG) using digital cameras and ambient
light has great potential for healthcare and affective computing.
However, traditional RGB cameras have limited frequency resolution. We present results of PPG measurements from a novel five
band camera and show that alternate frequency bands, in particular an orange band, allowed physiological measurements much
more highly correlated with an FDA approved contact PPG sensor. In a study with participants (n = 10) at rest and under stress,
correlations of over 0.92 (p < 0.01) were obtained for heart rate,
breathing rate, and heart rate variability measurements. In addition, the remotely measured heart rate variability spectrograms
closely matched those from the contact approach. The best results
were obtained using a combination of cyan, green, and orange
(CGO) bands; incorporating red and blue channel observations
did not improve performance. In short, RGB is not optimal for this
problem: CGO is better. Incorporating alternative color channel
sensors should not increase the cost of such cameras dramatically.
Index Terms—Blood volume pulse (BVP), heart rate variability
(HRV), photoplethysmography (PPG), remote sensing.

I. INTRODUCTION
EMOTE detection of physiological parameters holds great
potential for healthcare and affective computing. Applications that would benefit from noncontact measurement of heart
rate (HR) and heart rate variability (HRV) include: infant monitoring [1], detection of cardiac diseases [2], and stress monitoring [3]. The current gold standard methods of measuring HR
and HRV involve obtrusive devices attached to the body, in some
cases requiring sticky gels and/or uncomfortable electrodes.
HRV spectrograms (HRVs) are a useful noninvasive measure
of phenomena such as the cardiac regulatory system response
[4], anxiety [5], sleep patterns [6] or cognitive stress [7]. Mental
arithmetic tasks can increase low-frequency components and
low-frequency/high-frequency ratios in power spectral analysis
of the HRV [7]. We use a mental arithmetic task to cause changes
in HRV and show that these can be measured accurately using
a digital camera.
Photoplethysmography (PPG) is a low-cost and noninvasive
technique for measuring the cardiovascular blood volume pulse

R

Manuscript received January 28, 2014; revised April 22, 2014; accepted May
6, 2014. Date of publication May 14, 2014; date of current version September 16,
2014. This work was supported by the MIT Media Lab Member Consortium. D.
McDuff was supported by an NEC fellowship. Asterisk indicates corresponding
author.
∗ D. McDuff is with the Media Laboratory, Massachusetts Institute of Technology, Cambridge, MA 02139 USA (e-mail: djmcduff@mit.edu).
S. Gontarek and R. W. Picard are with the Media Laboratory, Massachusetts Institute of Technology, Cambridge, MA 02139 USA (e-mail:
sgontare@mit.edu; picard@media.mit.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2323695

(BVP) through variations in transmitted or reflected light [8].
Traditionally a dedicated light source and specialized sensor
(e.g., IR light) are used to measure the PPG signal. However,
recent work has demonstrated the measurement of the pulse
signal using ambient light [9]. Furthermore, it is possible to
accurately measure cardiopulmonary parameters (HR, breathing rate (BR) and high- and low-frequency components of the
HRV) using ambient light and a low-cost camera [10]. However, it was not shown whether detailed information about the
HRVS and subtle changes over time could be measured using this approach. In addition, participants were seated close to
(∼0.5 m) the camera. We present results that show we can recover, with high accuracy, both physiological parameters and
HRVSs from videos of the face taken using a digital camera
placed 3 m from the participant. This increased range opens up
more potential applications in which remote PPG could be practically used. In addition, this new method shows performance
improvements over the state of the art. As in our prior study,
the method works in ambient light, does not require a dedicated
light source, and works well regardless of skin color.
Most digital single-lens reflex (DSLR) cameras capture
three color channels [red, green, and blue (RGB)] with
16 bits/channel. We use a novel DSLR sensor that has the capability to capture five color channels (16 bits/channel): red,
green, blue, cyan, and orange (RGBCO). Each pixel on the camera sensor measures one color. The sensor we use has pixels for
detecting light in the orange and cyan frequency bands as well
as pixels for detecting light in the red, green, and blue bands.
Therefore, we are able to measure more specific frequency information. Previous work has shown the green channel in a
traditional RGB camera to capture the strongest BVP signal [9].
We performed experiments with different combinations of color
channels and show that the set of channels including the orange
band signals perform much better than the green signal alone
and much better than the set of RGB signals.
Poh et al.’s [10] method for recovering the BVP waveform
from video uses independent component analysis (ICA). In its
traditional form, the number of source signals cannot exceed
the number of observations. Therefore, by allowing for more
observations (more color channels) we have greater flexibility
in the number of source signals that may be present. Considering
that there may be many sources of noise (e.g., lighting changes,
rigid head motion, facial expressions, camera sensor noise), we
test whether more observations will allow for more accurate
recovery of the BVP.
The contributions of this paper are: 1) to show that a five band
digital camera allows highly accurate measurement of physiological parameters from a distance of 3 m and outperforms the
traditional three color bands (RGB), 2) to show that alternative

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2594

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

color bands (orange and cyan) between the red and blue bands
are particularly useful in recovering the BVP, and 3) to present
the first examples of remotely measured HRVSs from individuals in both relaxed conditions and under cognitive stress that
captures sympathetic modulation. The results presented suggest
that subtle changes in the high- and low-frequency components
of the HRV can be measured using this new approach.
II. RELATED WORK
Remote measurement of vital signs has been demonstrated
using a number of methods. HR and BR measurements have
been shown using laser doppler [11], microwave doppler [12],
milliwave doppler [13], and thermal imaging [14], [15] methods.
Verkruysse et al. [9] showed that PPG measurements could be
made using ambient light in the visual spectrum. Poh et al. [16]
presented a practical method allowing the BVP to be recovered
using a low-cost webcam, which can then be used to calculate
HR, BR, and high- and low-frequency components of HRV [10].
However, that work did not show that it was possible to gain an
accurate measurement of HRV changes over time (e.g., showing
accurate recovery of HRVSs) and all measurements were taken
with participants in a restful state (not under stress) at a distance
of 0.5 m.
Motion [16] can impact the accuracy of PPG measurements
made using ambient light and a digital camera. However, there
are many applications in which remote measurement of physiology could be very useful, where there is little rigid head motion
and slowly changing ambient lighting. Motion compensation is
also possible in cases where motion artifacts may be problematic [17]. A method of magnifying the PPG signal in a video
of the face allows the signal to be visualized [18], although the
filtering frequencies need to be set manually. Balakrishnan et al.
[19] presented a method for recovering the BVP waveform from
motion of the human head allowing the HR to be detected even
if no skin is visible. However, their system was outperformed by
camera-based PPG measurements in some cases and is likely to
be susceptible to noise due to rigid head motions. A pilot study
in infant monitoring has demonstrated accurate measurement of
HR using remote PPG measurements from a camera in realistic
conditions [1], HRV measurements were not validated.
III. METHODS
A. Camera
The camera used to collect the video sequences for analysis was a DSLR camera. The lens used was a standard Zuiko
50-mm lens. The camera’s sensor has the capability of capturing
five color bands including the typical three frequency band sensors (RGB) and also cyan and orange frequency band sensors
(RGBCO). Fig. 1 shows the sensitivities for the five band camera. In other respects, it was a standard DSLR camera. Fig. 2
shows the five band camera sensor layout. The image shows
the arrangement of the colors in a 4 × 4 pattern that repeats
across the sensor. Each pixel on the sensor measures one color
as determined by its position. Further details about the sensor
and demosaicking can be found in [21].

Fig. 1. Five band camera light sensitivity profile. In addition to red, green,
and blue light sensors this camera can measure orange and cyan bands.

Fig. 2. Five band camera sensor layout. The image shows the arrangement of
the colors in a 4 × 4 pattern that repeats across the sensor. Each pixel on the
sensor measures one color as determined by its position.

The raw image values captured by the camera can be calculated using the following formulation:

m=
e(λ)s(λ)
(1)
λ

where e(λ) is the energy of light at a given wavelength λ and
s(λ) is the camera sensitivity profile for a certain color channel.
We compare the performance recovering physiological parameters using all 31 possible combinations of the color bands in
Section IV. Custom image capture software was used to record
raw images of each frame of video. All the videos were recorded
with a frame rate of 30 frames per second (fps) and a resolution
of 960 × 720. The recording were in color (80-bit image with
five channels × 16 bits/channel).
B. Contact Sensors
For comparison of the camera measurements with a contact
sensor, BVP, respiration, and electrodermal activity (EDA) signals were measured using FDA-approved sensors (Flexcomp
Infiniti by Thought Technologies, Inc.). BVP was calculated via
the PPG signal from the index finger tip on the left hand. EDA
was measured with finger sensors on the middle and ring fingers
of both hands and respiration was measured using a chest strap.
For the validation and analysis, here we only consider the BVP
and respiration measurements.
C. Experiments
This study was approved by the Institutional Review Board
of the Massachusetts Institute of Technology (COUHES). All
experiments were conducted indoors and with a varying amount
of ambient light, provided by a changing combination of sunlight
through a nearby window and indoor illumination. Participants

MCDUFF et al.: IMPROVEMENTS IN REMOTE CARDIOPULMONARY MEASUREMENT USING A FIVE BAND DIGITAL CAMERA

2595

Fig. 3. Overview of the automated method used to recover the HRVS from videos of a human face. 1) Facial landmarks are detected using [20] and the face
ROI segmented (excluding the region around the eyes), 2) spatial averages of each color channel in the ROI over time are calculated, 3) source signals, calculated
via ICA, are filtered, 4) the channel with the estimated strongest BVP signal are selected and inverted if necessary, 5) BVP signal is interpolated to 256 Hz, peaks
detected, and IBIs calculated, 6) spectrogram are calculated with a moving window (window length 60 s, step size 1 s).

TABLE I
COMPARISON OF THE CORRELATIONS BETWEEN THE CONTACT FINGER SENSOR
MEASUREMENTS AND CAMERA MEASUREMENTS FOR ALL COMBINATIONS
OF THE CAMERA COLOR CHANNEL SIGNALS

Fig. 4. Experimental setup. Contact measurements of the BVP and EDA were
collected using finger sensors and respiration was measured using a chest strap.
A camera, placed 3 m from the participant, was used to capture videos images
at 30 fps, 960 × 720 resolution.

were seated and the data were recorded on a laptop (Toshiba
laptop running Windows 7).
Our experiments featured ten participants of both genders
(seven females), different ages (18–30), and multiple skin colors (Asian, Caucasian, Hispanic). Two participants were wearing glasses and one had facial hair. During the experiment, participants were seated approximately 3 m from the camera and
asked to face the camera while their video was recorded. Fig. 4
shows the setup used to record the data. Two-minute recordings
of the participants were taken; the contact measurements and
video sequences were time aligned by starting the recordings
simultaneously.
1) Measurements at Rest: In the first experiment, participants were told to sit still, look toward the camera, and relax. The synchronized video and physiological recordings were
taken for 2 min. For one of the sessions, the contact finger PPG
measurements were noisy due to motion artifacts; this session
was not used for the comparison of the contact and remote methods. Although the camera method is also susceptible to motion
artifacts, this highlights some of the challenges associated with
contact measurements, especially for tasks where people need
to move their hands (e.g., typing).
2) Measurements Under Cognitive Stress: In the second experiment, participants were asked to perform a mental arithmetic
test silently. Starting with the number 4000, they were required
to subtract seven then subtract seven again, and so on, as quickly
as possible. The synchronized video and physiological recording
were taken for 2 min. The participants started the task immedi-

R
G
B
C
O
RG
RB
RC
RO
GB
GC
GO
BC
BO
CO
RGB
RGC
RGO
RBC
RBO
RCO
GBC
GBO
GCO
BCO
RGBC
RGBO
RGCO
RBCO
GBCO
RGBCO

HR

BR

LF

HF

LF/HF

Lowest r

0.99
0.99
0.99
0.85
0.83
0.97
0.95
0.99
1.00
0.89
0.99
1.00
0.99
1.00
0.99
0.85
0.99
1.00
0.99
1.00
1.00
0.99
1.00
1.00
0.99
0.99
1.00
1.00
1.00
1.00
1.00

0.95
0.91
0.93
0.44
−0.02
0.66
0.89
0.67
0.93
0.75
0.83
0.98
0.68
0.92
0.67
0.67
0.75
0.92
0.69
0.92
0.90
0.77
0.93
0.93
0.84
0.89
0.81
0.90
0.90
0.72
0.74

0.60
0.63
0.68
0.64
0.43
0.72
0.47
0.69
0.88
0.44
0.82
0.88
0.61
0.87
0.40
0.45
0.67
0.83
0.71
0.83
0.91
0.80
0.84
0.93
0.69
0.72
0.79
0.87
0.81
0.83
0.81

0.60
0.63
0.68
0.64
0.43
0.72
0.47
0.69
0.88
0.44
0.82
0.88
0.61
0.87
0.40
0.45
0.67
0.83
0.71
0.83
0.91
0.80
0.84
0.93
0.69
0.72
0.79
0.87
0.81
0.83
0.81

0.57
0.63
0.70
0.64
0.34
0.74
0.47
0.73
0.89
0.44
0.82
0.88
0.65
0.87
0.48
0.46
0.71
0.86
0.68
0.83
0.89
0.78
0.83
0.93
0.77
0.68
0.81
0.86
0.77
0.80
0.79

O
RGB
CO
GB
C
RB
BC
R
RC
RBC
G
RGC
RG
BCO
B
RGBC
GBC
RGBCO
GBCO
RGBO
GC
RBCO
RBCO
GBO
RGO
RGCO
BO
RO
RCO
GO
GCO
Highest r

For all correlations p < 0.01. On the right are the channel combinations ordered from lowest
mean correlation to highest mean correlation. The GCO channel combination performed
best. Comparisons made across 19 sessions.

ately after the recordings were started. In order to increase the
cognitive stress induced, we told the participants that they were
competing against the other people to reach the lowest number
after 2 min. The participants consistently reported this task to
be more stressful.
D. Recovery of Physiology From Camera
We propose a new fully automated method for recovering
the HRVS from the recorded videos by making alterations to

2596

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

the method presented in [16]. The alterations improve the resulting measurements and are described later. Fig. 3 provides
an overview of the method. The videos were exported in an
uncompressed format. The physiological and video recordings were analyzed offline using custom software written in
MATLAB (The Mathworks, Inc.).
The LEAR [20] facial landmark detector was used to find the
x- and y- coordinates of facial landmarks on the participant’s
face in each frame of the video. As shown in Fig. 3 step 1, we
selected the full width between the outer eye corners (w) and
a height twice the width (w above the eye corners to w below
the eye corners) as a box encompassing the region of interest
(ROI). We excluded a section around the eyes (the full width
of the box and 25% of the height around the eye corners) to
remove motion artifacts due to blinking and eye movements.
This adjustment improved correlations with the contact sensor
measurements. The mean number of pixels within the ROI was
125 000 pixels (st. dev. = 19 100 pixels). This represents less
than 25% of the frame. The minimum facial ROI used across all
videos was 95 000 pixels.
A spatial average of the color channels (red, green, blue,
orange, and cyan or a subset thereof) pixel values within the
resulting ROI were calculated for each frame to form the raw
signals x1 (t), x2 (t), . . . , xN (t), respectively, where N is the number of color channels (between one and five). The raw traces
were detrended using a technique based on a smoothness priors
approach [22]. The smoothness parameter λ was set to 2000.
This allowed only very low-frequency components of the signal
to be removed, not damaging the high-frequency information.
The resulting signals were normalized by subtracting the mean
and dividing by the standard deviation. We then apply ICA to
recover source signals from the observations, maximizing the
non-Gaussianity within the sources. Using a conventional ICA
algorithm, the number of recoverable sources cannot exceed
the number of observations; thus, we assumed N underlying
source signals, represented by s1 (t), s2 (t), . . . , sN (t). We use
the JADE implementation of ICA [23]. Each of the source signals was band-pass filtered using a Hamming window filter with
low- and high-frequency cutoffs at 45 beats-per-minute (bpm)
(0.75 Hz) and 180 bpm (3 Hz), respectively. These cutoff frequencies reflect conservative lower and upper limits in HR.
ICA has two properties that make automated analysis challenging. First, the source signals are returned in a random order
and, therefore, it is not always the same source that has the
strongest BVP waveform. Second, the source signals can be
scaled arbitrarily (and subsequently flipped if scaled by a number <0). A flipped BVP signal is problematic when it comes to
peak detection as the calculated interbeat intervals (IBI) are typically much less accurate. The following steps are designed to
find the optimal source signal and invert it if the BVP component
within the source has been flipped.
The appropriate source signal was selected by calculating the
normalized fast Fourier transform (FFT) of each source and
choosing the source signal with the greatest frequency peak
within the range 45–180 bpm (the same limits as the bandpass
filter 3 dB points above). The FFTs were normalized to give a
total power across all frequencies equal to 1. This is similar to

Fig. 5. a) ICA returns the source signals in a random order. Source signal
selection is solved by choosing the signal with peak of greatest power in the
normalized FFT spectrum (between 40 and 180 bpm). In the aforesaid example,
this would mean selecting the second source signal. b) ICA returns source
signals with arbitrary scaling. Problems due to inverted signals are solved by
finding the mean absolute peak and trough heights and inverting the signal if
μ p e a ka m p < μ tro u g h a m p .

the method used by Poh et al. [10]. We verified this approach
by manually choosing the optimal source signal for the five
band signal case and the FFT method agreed on all occasions.
Fig. 5(a) shows examples of source signals and the power spectra
of each source. Clearly, the power spectrum with the highest
peak corresponds to the signal with the strongest BVP; all other
source signals have flatter spectra.
As aforementioned, when using ICA the BVP waveform may
be inverted. In order to automatically predict whether the selected source signal has an inverted BVP waveform, we calculate the mean absolute peak (μp eakam p ) and trough (μtrougham p )
amplitudes (the source signals are returned with zero mean). For
an inverted BVP signal, the mean trough amplitude is likely to
be greater than the mean peak amplitude due to the shape of
the BVP waveform. Therefore, if μp eakam p < μtrougham p the
selected source would be inverted (multiplied by −1). Fig. 5
shows examples of a noninverted and an inverted BVP signal.
Poh et al. [10] did not propose any technique for detecting inverted BVP signals. In Section IV, we show that this addition
improves the accuracy of the resulting physiological parameters.
The estimated BVP signal was interpolated with a cubic spline
function at a sampling frequency of 256 Hz. Peak detection was

MCDUFF et al.: IMPROVEMENTS IN REMOTE CARDIOPULMONARY MEASUREMENT USING A FIVE BAND DIGITAL CAMERA

TABLE II
COMPARISON OF THE CORRELATIONS BETWEEN THE CONTACT FINGER SENSOR
MEASUREMENTS AND CAMERA MEASUREMENTS FOR THE GCO CHANNEL
COMBINATION—WITH DIFFERENT PEAK DETECTION WINDOW SIZES
Win. Size

HR

BR

LF

HF

LF/HF

0.15s
0.20s
0.25s
0.30s
0.35s

0.95
1.00
1.00
1.00
0.96

0.92
0.88
0.93
0.83
0.63

0.68
0.94
0.93
0.88
0.83

0.68
0.94
0.93
0.88
0.83

0.61
0.92
0.93
0.86
0.83

Win. size: 0.25 s shows the highest correlation.

performed using a custom algorithm with a moving time window of length 0.25 s. Within the moving window, if the signal
maximum was greater than that in the previous window, the
next window would be considered. If the maximum within the
window was less than that in the previous window, then the previous maximum was selected as a peak and the process would
repeat. We tested different window sizes and found that a window of 0.25 s gave the results that were most closely correlated
with the visually verified contact sensor measurements, results
are shown in Table II. Fig. 6 shows a 30-s comparison of the
PPG waveforms from the contact sensor and the remote method
for one individual. The visually verified peaks are shown on
the contact waveform and the automatically detected peaks are
shown on the remote waveform. Notice how when using a window size of 0.35 s the beats at 50.3 and 71 s are missed but with
a window size of 0.25 s they are not.
To avoid artifacts (such as motion or ectopic beats), which
can impact the HRV analysis, the resulting IBIs were filtered
using the noncausal of variable threshold algorithm [24] with
a tolerance of 30% (Poh et al. [10] found 30% tolerance to be
effective). Finally, IBI were filtered using a low-pass filter with
cutoff frequency 0.4 Hz. In this analysis, we were interested in
measuring the high- (0.15–0.4 Hz) and low-frequency (0.04–
0.15 Hz) components of the HRV power spectra and, therefore,
we filtered with a cutoff at 0.4 Hz. We construct the HRVSs
by calculating the power spectral density (PSD) from the IBIs
for sequential windows. For each window, the PSD of the IBI
was calculated using the Lomb periodogram. In this analysis,
we use a moving window of 1 min and the sessions were 2 min
in length, the step size was 1 s. We chose these parameters as
we wanted to have a large enough window to measure highand low-frequency components of the IBIs (between 0.04 and
0.4 Hz) accurately within each window but also to capture the
temporal dynamics in the spectrograms—there was a tradeoff in
the choice of the window size between frequency and temporal
resolution.
E. Recovery of Physiology From Contact Sensors
To calculate the HRVS using the PPG measurements from the
contact finger sensor, we use the same parameters as above. PPG
peak detection was performed with a moving time window of
length 0.25 s. For comparison with the remote measurements,
the accuracy of the peak detection was then confirmed using

2597

visual inspection, any missed peaks or false detections were
corrected. Spectrograms were computed by calculating the PSD
from the IBIs for a moving window of length 1 min, step size
1 s, over each 2-min session.
F. Quantification of Physiological Parameters
For a quantitative comparison between the contact sensor and
the camera method, and also comparing to results in our previous work, we calculate the HR, BR, and HRV low-frequency
and high-frequency components. HR was calculated as 60/IBI,
where IBI is the mean of the IBI. BR can be estimated from
the high-frequency component of the HRV [25]. We determine
the BR from the frequency peak (f HFp eak ), center frequency of
the highest peak between 0.15 and 0.4 Hz, of the HRV power
spectrum. For the contact measurements, the BR was calculated
from the frequency of the dominant peak frespp eak in the PSD
of the recorded respiratory waveform as 60∗ frespp eak . The lowfrequency (LF) and high-frequency (HF) powers of the HRV
were calculated as the area under the PSD curve corresponding
to 0.04–0.15 and 0.15–0.4 Hz ,respectively. These were quantified in normalized units in order to minimize the impact of a
difference in total power. The LF component is modulated by
baroreflex activity and contains both sympathetic and parasympathetic activity [26]. The HF component reflects parasympathetic influence on the heart and is connected to respiratory
sinus arrhythmia. An estimate of sympathetic modulation (the
sympatho/vagal balance) can be made by considering the ratio
LF/HF.
IV. RESULTS
Using the analysis described in Section III we calculated
physiological parameters from the BVP waveforms extracted
from the camera signals and the contact sensor.
A. Comparison of Color Channels
In order to compare the results to those that would be recorded
with most conventional digital cameras and to analyze the impact of each color band on the performance, we repeated the
analysis described in Section III using: 1) each signal band
alone, 2) all pairs of bands, 3) all combinations of three bands,
4) all combinations of four bands, and 5) all five band (RGBCO)
channel signals. Table I shows the correlation between the camera measures and the contact finger measures for all the cases on
the left side. For the comparisons, peaks detected in the contact
measurements were confirmed visually. On the right side, we
show the color channel combinations ordered with respect to ascending mean HR, BR, LF, HF, and LF/HF correlation (r). The
GCO combination had the greatest mean correlation across all
measures. Interestingly, the O band alone had the lowest mean
correlation across all measures, but is present in all of the ten
top-performing combinations.
Fig. 7 shows the correlations between the noncontact and
contact measurements for the a) HR, b) BR, c) HRV LF, d)
HRV HF, and e) HRV LF/HF measurements. The camera values
were computed using the GCO channels. These results show
high agreement between the remote method and the finger PPG

2598

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

Fig. 6. Comparison of 30-s PPG waveforms from the contact sensor and the remote method. Top) Contact sensor waveform with visually verified peaks (blue).
Bottom) Remote measurement waveform with peaks located using a time window of 0.25 s (green) and 0.35 s (red) (peak locations offset for comparison). Notice
the beats at 50.3 and 71 s are missed by the peak detection algorithm with window size 0.35 s but not with window size 0.25 s.

Fig. 7. Scatter plots comparing the measurements of (a) HR, (b) BR, (c) HRV LF component, (d) HRV HF component, (e) HRV LF/HF ratio for the contact
sensor (finger BVP for HR and HRV and chest strap for BR) and the noncontact method described in Section III using the GCO band observations. High agreement
was observed across all measures. In all cases, p < 0.01. n.u. = normalized units. Comparisons made across 19 sessions.

measures and are improved over those presented by Poh et al.
[10] despite the camera being much further from the subject
here (3 m compared to 0.5 m).

B. HRV Spectrograms
We calculated the HRVSs from the 2-min sessions using a
1-min sliding window with 1-s increments. This is the first
example we are aware of that shows the HRVSs calculated
from noncontact video sequences. Fig. 8 shows a comparison of
spectrograms recovered from the three bands (RGB) and three
bands (GCO) recordings next to those from the contact finger
measurements. On the left are examples from sessions in which
the participants were at rest and on the right are examples in
which the participants were under cognitive stress.

C. Impact of Inversion Correction Step
Table III shows the impact of inverting the source signal
output from ICA. Without this step, some of the source signals
have an inverted BVP and in these cases calculation of the IBIs
is problematic. Our new method of detecting and correcting
for inversion gives a closer estimation of the HRV spectra and
subsequent parameters when compared to the contact measures.

D. Performance in Rest and Stress Conditions
Fig. 7 shows the correlations between the noncontact and
contact measurements for all the data. Here, we compare the
performance of the algorithm for the rest and stress conditions
separately. In the rest condition, the HR, BR, HRV LF, HF, and
LF/HF correlations with the contact sensor were: 1.0, 0.90, 0.87,
0.87, 0.86, respectively. In the stress condition, the HR, BR,
HRV LF, HF, and LF/HF correlations with the contact sensor
were: 1.0, 0.91, 0.97, 0.97, 0.95, respectively. The results show
good performance in both conditions. Although the correlations
were slightly lower in the rest condition perhaps due to the
slower BRs, which may be harder to estimate within the time
window.

V. DISCUSSION
Our results in Table I show high correlation between the
contact measures and the camera measures, despite the camera
being placed 3 m from the participant. The best performing combination of channels was GCO, which was only outperformed
by other combinations for the BR correlation. The orange band
featured in the top ten combinations of channels: This suggests
it is capturing significant information. However, other observations are also needed to help boost the signal-to-noise ratio.
The orange band is close to the green band and this supports
previous work that showed strong measurement of the BVP in

MCDUFF et al.: IMPROVEMENTS IN REMOTE CARDIOPULMONARY MEASUREMENT USING A FIVE BAND DIGITAL CAMERA

2599

Fig. 8. HRVSs calculated using: Top) RGB camera signals, middle) GCO camera signals and bottom) contact finger sensor. Qualitatively the measurements
from the GCO channels more closely match those from the contact sensor (reinforcing the quantitative comparisons in Table I). On the left are sessions in which
participants 5 and 10 were at rest and on the right are sessions in which participants 5 and 10 were under cognitive stress. There are stronger low-frequency
components in the latter as we would expect less parasympathetic nervous system activity. The measurements for participant 5, under cognitive stress, made using
the camera suggest that the camera (using GCO bands) may have been more accurate than the finger sensors.

TABLE III
COMPARISON OF THE CORRELATIONS BETWEEN THE CONTACT FINGER SENSOR
MEASUREMENTS AND CAMERA MEASUREMENTS FOR THE GCO CHANNEL
COMBINATION—WITH AND WITHOUT INVERSION CORRECTION OF THE
SELECTED SOURCE SIGNAL AFTER ICA

without inversion correction
with inversion correction

HR

BR

LF

HF

LF/HF

1.00
1.00

0.90
0.93

0.86
0.93

0.86
0.93

0.88
0.93

For all correlations p < 0.01.

the green frequency range [9]. In order to improve remote PPG
measurements using digital cameras, these results suggest one
should include color channel sensors closer to the orange, green,
and cyan frequencies.
HR measurements were highly correlated across almost all
of the channels. This is because the dominant frequency measurement is not highly susceptible to poor peak detection on
the BVP. However, the correlations of other measures—which
all rely on accurate BVP peak detection—varied greatly. The
benefit of the additional color bands stands out as they allow for
the recovery of a much cleaner BVP signal and, therefore, more
accurate source signal selection, scaling, and peak detection.
Interestingly, the RGB combination of color channels, used
in today’s standard digital cameras, was one of the worst performing combinations of channels. The measurements using
the GCO combination of color channels show high agreement
between the remote method and the finger PPG measures and
are greater than those presented by Poh et al. [10] despite the
camera being much further from the subject (3 m compared to
0.5 m) and our inclusion of variable lighting, different colors of
skin and subjects wearing glasses. The spectrogram calculated
from the five band observations is closer to that of the finger

measurements and in example P5 of Fig. 8 actually seems to be
more accurate than the finger measurements—perhaps due to
motion artifacts as a result of the fingers moving. However, we
cannot be certain that this is the case—we will investigate the
impact of motion more in future work.
We can see from the spectrograms that there is greater LF
power in the HRV spectra for those individuals under cognitive
stress, this is what we would expect due to less parasympathetic
activity. Across all participants, the mean HRV LF/HF ratio in
the stress condition (0.81) was significantly higher (p < 0.005)
than in the rest condition (0.51). Eight of ten participants had a
higher HRV LF/HF ratio during the stress condition compared
to the rest condition. Higher EDA response was also observed
in eight of ten participants in the stress condition relative to the
rest condition (seven participants had higher HRV LF/HF ratio
and higher EDA response in the stress condition).

VI. CONCLUSION AND FUTURE WORK
We have presented physiological measurements (HR, BR,
HRV LF, and HF components) from camera images of the human face. Using a novel five band camera sensor, we show that
an orange color channel helps boost the performance of physiological measurement using a digital camera. A combination
of cyan, green, and orange color channels was the best performing. The RGB channel combination was one of the poorest
performing. The GCO channel combination outperformed the
RGB channels for all individuals showing that the best performance occurred across a range of skin tones and under varying
ambient lighting conditions. We compared the camera measurements with those from traditional contact measurements. The
agreement between the contact and camera measurements was
very high. The measurements were made with a digital camera

2600

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 10, OCTOBER 2014

placed 3 m from the face of the participant, a greater distance
than in results presented previously.
We present the first examples of HRVSs calculated from
videos of the human face. Qualitative comparisons between
the spectrograms measured using the camera and the contact
sensors show close agreement.
There are certain limitations that should be noted when considering these results. In these experiments, the participants were
free to move; however, they were seated and did not turn away
from the camera. A real-time system would need to address
issues such as artifacts due to incorrect/missing face tracking
results, rigid head motions, and dramatic ambient light changes.
We have tested the system against data from ten individuals and
demonstrated very strong performance. However, for certain
applications—such as infant monitoring—testing would need to
be performed on a representative population. Future work will
consider measurements as people perform computer tasks and
investigation of whether cognitive stress can be predicted from
remotely measured changes in cardiopulmonary activity. Comparisons between the measurements made by the camera and
electrocardiogram measurements of HR and HRV components
would also be a useful extension. In this study, all the analysis
was performed offline. We leave a real-time implementation of
the approach to future work.
REFERENCES
[1] L. A. Aarts, V. Jeanne, J. P. Cleary, C. Lieber, J. S. Nelson, S. B. Oetomo,
and W. Verkruysse, “Non-contact heart rate monitoring utilizing camera
photoplethysmography in the neonatal intensive care unit—a pilot study,”
Early Human Develop., vol. 89, no. 12, pp. 943–948, 2013.
[2] R. E. Kleiger, J. P. Miller, J. T. Bigger Jr., and A. J. Moss, “Decreased
heart rate variability and its association with increased mortality after
acute myocardial infarction,” Amer. J. Cardiol., vol. 59, no. 4, pp. 256–
262, 1987.
[3] J. Delaney and D. Brodie, “Effects of short-term psychological stress
on the time and frequency domains of heart-rate variability,” Perceptual
Motor Skills, vol. 91, no. 2, pp. 515–524, 2000.
[4] M. V. Kamath, D. N. Ghista, E. L. Fallen, D. Fitchett, D. Miller, and
R. McKelvie, “Heart rate variability power spectrogram as a potential
noninvasive signature of cardiac regulatory system response, mechanisms,
and disorders,” Heart Vessels, vol. 3, no. 1, pp. 33–41, 1987.
[5] P. Jönsson, “Respiratory sinus arrhythmia as a function of state anxiety
in healthy individuals,” Int. J. Psychophysiol., vol. 63, no. 1, pp. 48–54,
2007.
[6] C. C. Yang, C.-W. Lai, H. Y. Lai, and T. B. Kuo, “Relationship between
electroencephalogram slow-wave magnitude and heart rate variability during sleep in humans,” Neurosci. Lett., vol. 329, no. 2, pp. 213–216, 2002.
[7] A. Moriguchi, A. Otsuka, K. Kohara, H. Mikami, K. Katahira, T. Tsunetoshi, K. Higashimori, M. Ohishi, Y. Yo, and T. Ogihara, “Spectral change
in heart rate variability in response to mental arithmetic before and after
the beta-adrenoceptor blocker, carteolol,” Clinical Autonomic Res., vol. 2,
no. 4, pp. 267–270, 1992.
[8] J. Allen, “Photoplethysmography and its application in clinical physiological measurement,” Physiological Meas., vol. 28, no. 3, p. R1, 2007.
[9] W. Verkruysse, L. O. Svaasand, and J. S. Nelson, “Remote plethysmographic imaging using ambient light,” Opt. Exp., vol. 16, no. 26,
pp. 21434–21445, 2008.
[10] M.-Z. Poh, D. J. McDuff, and R. W. Picard, “Advancements in noncontact, multiparameter physiological measurements using a webcam,” IEEE
Trans. Biomed. Eng., vol. 58, no. 1, pp. 7–11, Jan. 2011.
[11] S. S. Ulyanov and V. V. Tuchin, “Pulse-wave monitoring by means
of focused laser beams scattered by skin surface and membranes,”
Proc. Opt., Electro-Opt. Laser Appl. Sci. Eng., Int. Soc. Opt. Photonics,
vol. 1884, pp. 160–167, 1993.

[12] E. Greneker, “Radar sensing of heartbeat and respiration at a distance with
applications of the technology,” in Proc. Radar Conf. Publ. No. 449, 1997,
pp. 150–154.
[13] S. Bakhtiari, T. W. Elmer, N. M. Cox, N. Gopalsami, A. C. Raptis, S. Liao,
I. Mikhelson, and A. V. Sahakian, “Compact millimeter-wave sensor for
remote monitoring of vital signs,” IEEE Trans. Instrum. Meas., vol. 61,
no. 3, pp. 830–841, Mar. 2012.
[14] M. Garbey, N. Sun, A. Merla, and I. Pavlidis, “Contact-free measurement
of cardiac pulse based on the analysis of thermal imagery,” IEEE Trans.
Biomed. Eng., vol. 54, no. 8, pp. 1418–1426, Aug. 2007.
[15] J. Fei, and I. Pavlidis, “Thermistor at a distance: Unobtrusive measurement
of breathing,” IEEE Trans. Biomed. Eng., vol. 57, no. 4, pp. 988–998, Apr.
2010.
[16] M.-Z. Poh, D. J. McDuff, and R. W. Picard, “Non-contact, automated
cardiac pulse measurements using video imaging and blind source separation,” Opt. Exp., vol. 18, no. 10, pp. 10762–10774, 2010.
[17] Y. Sun, S. Hu, V. Azorin-Peris, S. Greenwald, J. Chambers, and Y.
Zhu, “Motion-compensated noncontact imaging photoplethysmography
to monitor cardiorespiratory status during exercise,” J. Biomed. Opt., vol.
16, no. 7, p. 077010, 2011.
[18] H.-Y. Wu, M. Rubinstein, E. Shih, J. Guttag, F. Durand, and W. Freeman,
“Eulerian video magnification for revealing subtle changes in the world,”
ACM Trans. Graph., vol. 31, no. 4, p. 65, 2012.
[19] G. Balakrishnan, F. Durand, and J. Guttag, “Detecting pulse from head
motions in video,” in Proc. IEEE Conf. Comput. Vision Pattern Recog.,
2013, pp. 3430–3437.
[20] B. Martinez, M. F. Valstar, X. Binefa, and M. Pantic, “Local evidence aggregation for regression-based facial point detection,” IEEE Trans. Pattern
Anal. Mach. Intell., vol. 35, no. 5, pp. 1149–1163, May 2013.
[21] Y. Monno, M. Tanaka, and M. Okutomi, “Multispectral demosaicking
using guided filter,” Proc. IS&T/SPIE Electron. Imag. Int. Soc. Opt. Photonics, vol. 8299, pp. 82990O–82990O, 2012.
[22] M. P. Tarvainen, P. O. Ranta-aho, and P. A. Karjalainen, “An advanced detrending method with application to HRV analysis,” IEEE Trans. Biomed.
Eng., vol. 49, no. 2, pp. 172–175, Feb. 2002.
[23] J.-F. Cardoso, and A. Souloumiac, “Blind beamforming for non-gaussian
signals,” IEE Proc. F (Radar Signal Process.), vol. 140, no. 6, pp. 362–
370, Dec. 1993.
[24] J. Vila, F. Palacios, J. Presedo, M. Fernández-Delgado, P. Felix, and S.
Barro, “Time-frequency analysis of heart-rate variability,” IEEE Eng. Med.
Biol. Mag., vol. 16, no. 5, pp. 119–126, Sep./Oct. 1997.
[25] T. E. Brown, L. A. Beightol, J. Koh, and D. L. Eckberg, “Important
influence of respiration on human rr interval power spectra is largely
ignored,” J. Appl. Physiology, vol. 75, no. 5, pp. 2310–2317, 1993.
[26] S. Akselrod, D. Gordon, F. A. Ubel, D. C. Shannon, A. Berger, and R. J.
Cohen, “Power spectrum analysis of heart rate fluctuation: A quantitative
probe of beat-to-beat cardiovascular control,” Science, vol. 213, no. 4504,
pp. 220–222, 1981.

Daniel McDuff (S’10) received the Bachelor’s (with
first-class honors) and master’s degrees in engineering from Cambridge University, Cambridge, U.K. He
is currently working toward the Ph.D. degree in the
Affective Computing Group at the MIT Media Lab,
Cambridge, MA, USA.
He research interests include computer vision and
machine learning to enable the automated recognition of affect. He is also interested in technology for
remote measurement of physiology.

MCDUFF et al.: IMPROVEMENTS IN REMOTE CARDIOPULMONARY MEASUREMENT USING A FIVE BAND DIGITAL CAMERA

Sarah Gontarek is an electrical engineering and
computer science student at MIT, Cambridge, MA,
USA, and a political science student at Wellesley
College, Wellesley, MA, USA.
She is with the Affective Computing Group in
the Media Lab, Cambridge, MA, USA because she
is especially interested in biomedical applications
for common digital communications technology. Her
research interests include signal processing, neuroscience, and machine learning.

2601

Rosalind W. Picard (M’81–SM’00–F’05) received
the Sc.D. degree in electrical engineering and computer science from MIT, Cambridge, MA, USA.
She is a Professor of Media Arts and Sciences at
the MIT Media Lab, the Founder and Director of the
Affective Computing Group at the MIT Media Lab.
She is also a Co-Founder of Affectiva, Inc, Waltham,
MA, USA. Her current research interests focus on
the development of technology to help people comfortably and respectfully measure and communicate
affective information, as well as on the development
of models of affect that improve decision-making and learning.
Dr. Picard is a Member of the IEEE Computer Society.

