IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

1345

A Novel System Identification Technique
for Improved Wearable Hemodynamics Assessment
Andrew D. Wiens, Student Member, IEEE, and Omer T. Inan∗ , Member, IEEE

Abstract—Recent advances have led to renewed interest in ballistocardiography (BCG), a noninvasive measure of the small movements of the body due to cardiovascular events. A broad range
of platforms have been developed and verified for BCG measurement including beds, chairs, and weighing scales: while the body is
coupled to such a platform, the cardiogenic movements are measured. Wearable BCG, measured with an accelerometer affixed
to the body, may enable continuous, or more regular, monitoring
during the day; however, the signals from such wearable BCGs
represent local or distal accelerations of skin and tissue rather
than the whole body. In this paper, we propose a novel method to
reconstruct the BCG measured with a weighing scale (WS BCG)
from a wearable sensor via a training step to remove these local effects. Preliminary validation of this method was performed with 15
subjects: the wearable sensor was placed at three locations on the
surface of the body while WS BCG measurements were recorded
simultaneously. A regularized system identification approach was
used to reconstruct the WS BCG from the wearable BCG. Preliminary results suggest that the relationship between local and central
disturbances is highly dependent on both the individual and the
location where the accelerometer is placed on the body and that
these differences can be resolved via calibration to accurately measure changes in cardiac output and contractility from a wearable
sensor. Such measurements could be highly effective, for example,
for improved monitoring of heart failure patients at home.
Index Terms—Ballistocardiography, home health monitoring,
sensor informatics, wearable sensing.

I. INTRODUCTION
ACH year, one in every four deaths in the United States
is due to cardiovascular disease (CVD), and 47% of sudden cardiac deaths occur outside of the hospital [1]. Continuous
heart monitoring has the potential to not only reduce costs associated with invasive and minimally invasive testing but also
to improve the quality of life for many who are struggling with
CVD and to provide the capability of early detection and preventative care. One method in development for noninvasively
monitoring the mechanical aspects of cardiovascular function
is ballistocardiography (BCG).
The BCG phenomenon was first discovered in the 1800s following J. W. Gordon’s paper in 1877 explaining how the needle
on a weighing scale fluctuates with the rhythm of the heart.

E

Manuscript received September 12, 2014; revised November 18, 2014; accepted December 19, 2014. Date of publication December 19, 2014; date of
current version April 17, 2015. This work was supported in part by the National Institute of Biomedical Imaging and Bioengineering, National Institutes
of Health under Grant U01 EB018818. Asterisk indicates corresponding author.
∗ O. T. Inan is with the School of Electrical and Computer Engineering, Georgia Institute of Technology, Atlanta, GA 30308 USA (e-mail: inan@gatech.edu).
A. D. Wiens is with the School of Electrical and Computer Engineering,
Georgia Institute of Technology.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2387354

Gordon speculated that the cause was ejection of blood into the
aorta, comparing the recoil to “a ball propelled from a gun [2].”
Studies with human subjects in the mid-20th century led to the
discovery that the BCG can be used to detect heart malfunctions
[3]. In an attempt to simplify the instrumentation required for
measuring such vibrations of the body in response to the heartbeat, researchers developed another similar technique named
seismocardiography (SCG), a measure of local acceleration of
the chest wall resulting from the heartbeat [4]. In contrast to
BCG, which required elaborate tables and beds, SCG could be
measured by simply placing a small accelerometer on the chest
of a supine subject. However, as the subsequent revolution in
solid-state electronics led to significant progress in electrical
heart monitoring techniques, and imaging technologies (ultrasound and magnetic resonance imaging, MRI) became widely
prevalent in clinical practice, BCG research reached a nadir in
the late 1980s [5].
Over the past two decades, developments in the semiconductor process have led to extremely low-cost and low-power
microelectromechanical systems (MEMS) sensors and microprocessors. These developments promise the ability to precisely
measure and process BCG and SCG signals with extremely
small and low-cost equipment in ways that have never before
been possible. Simultaneously, the need for inexpensive medical equipment capable of measuring large quantities of physiological parameters outside of clinical settings—such as in the
home—is imminent. Interest in the BCG is thus returning, and
the volume of publications has been trending upward [5].
Scales, chairs, and beds were developed in the last few
decades to measure the BCG and SCG signals at home [6]–
[10]. These platforms are relatively well understood, however,
they do not offer the ability to monitor cardiac function continuously throughout the day. Wearable accelerometers placed at
arbitrary locations on the upper body do offer this capability, but
the signals they produce are fundamentally different from both
the BCG and SCG: while the BCG represents movements of the
whole body, and the SCG represents accelerations of the chest
wall, the wearable BCG represents accelerations of the surface
of the skin at an arbitrary location on the body. As we showed in
a previous paper, simply interpreting the wearable BCG signal
as a displacement BCG yields incorrect cardiac assessments,
specifically of the R–J interval [11]. This paper moves far beyond our previous work to build a framework for reconstructing
the weighing scale BCG (WS BCG) from the wearable sensor
via a calibration, or training, step. Furthermore, we demonstrate
for the first time that WS BCG can even be measured from the
vertical accelerations of the wrist.
Although the wearable signal differs from these two widely
studied signals, it is related to them via the mechanics of the

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1346

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Fig. 1. Block diagram modeling the relationship between the wearable BCG
and the WS BCG. Ejection of blood into the aorta causes local and wholebody displacement perturbations at the surface of the skin and the feet via two
different mathematical systems.

body. These underlying relationships can be leveraged to cross
domains between different sensor modalities. In this paper, we
propose the relationship between the wearable BCG and the WS
BCG shown in Fig. 1, develop an improved numerical integrator to estimate the displacement of a wearable sensor from its
acceleration, build a framework to resolve the WS BCG from
the wearable BCG, and provide preliminary validation of this
framework with data from human subjects.
II. PHYSICAL OVERVIEW AND HYPOTHESES
A. Previous Studies
Comparison and refinement of different types of BCG measurements has been approached in various ways. Electric filters
were developed by Tobin et al. to correct the frequency responses of displacement and velocity BCG beds [12]. More
recently, Migeotte et al. noted several differences between 3-D
acceleration BCG measurements from two locations on the spine
in the time and frequency domain [13]. The issue of comparing
BCG displacements, velocities, and accelerations has also been
raised: Starr and Noordergraaf remarked on the similarity of the
HF BCG (displacement) to the second derivative (acceleration)
of the ULF BCG [14]. The purpose of this study is to begin
to develop a framework for converting between different BCG
modalities in order to ease such dependence on the specific
hardware used.
B. Hypotheses
The WS BCG is a measurement of displacements resulting
from cardiac ejection of blood into the vasculature [2], [15]. In
this paper, we examine the WS BCG signal in the vertical, or
head-to-foot, axis when the subject is standing upright. Recently,
several researchers have attempted to measure BCG signals
from wearable devices, most notably a miniature accelerometer attached to the surface of the skin [16]–[20]. Although this
approach may yield continuous BCG recording in naturalistic
environments, there are several outstanding scientific questions

that must be addressed to properly compare between the two
domains—wearable versus other BCG modalities.
The results of our previous study suggest that these wholebody displacements most closely match those at the surface
of the skin when the wearable sensor is located at regions
on the body that are well coupled to the rigid skeletal system. Specifically, acceleration measurements at these locations
closely matched the second derivative of the WS BCG [11].
This paper builds on our previous work by examining the relationship between these two fundamentally different BCG measurements and developing a novel method to reconstruct the WS
BCG from the wearable signal. To achieve this reconstruction,
our method relies heavily on the following hypothesis: a firstorder approximation of the WS BCG can be obtained by
twice integrating the wearable BCG.
To motivate the need for double integration, it is important
to first highlight one aspect of the wearable BCG vis-à-vis the
WS BCG. The wearable BCG in this paper is a measure of the
acceleration of the sensor’s mass on the surface of the skin. By
contrast, the weighing scale is a mass–spring-dashpot system of
the form shown in (1) where the damping b and mass m terms are
nearly zero. This is evident by the scale’s frequency response,
which was characterized extensively in [8]. As a result, the displacement term containing the spring constant k is dominant:
Hooke’s Law (2) governs the motion of the WS platform, and
the WS BCG signal is directly proportional to the platform’s
displacement. The wearable BCG and WS BCG are related primarily by the integral operator. When modeling the relationship
between the wearable and WS BCG signals, it is important to
first integrate the wearable acceleration signal twice in order to
obtain an estimate of the sensor’s displacement.
F = kx + by + ma

(1)

F = kx.

(2)

The a priori knowledge about the physical behavior of the
wearable sensor was leveraged to improve this displacement
estimate. Since the accelerometer was physically attached to
the skin and not able to move freely in space, we assume that
nearly zero low-frequency energy should exist in the acceleration, velocity, and displacement. (If low-frequency components
in these signals were allowed to persist, small errors in the acceleration measurement would accumulate into large velocities
and displacements via the integral operators, and would thus, incorrectly signify a slow drift of the sensor’s position away from
the thorax.) Therefore, numerical integration was performed in
series with high-pass filters as shown in Fig. 2 to eliminate spurious low-frequency energy, and the cutoff frequency of the filters
was determined empirically. The output of this sequence of operations was an estimate of the wearable sensor’s displacement
as a function of time, which was then used in subsequent steps
to estimate the displacement of the weighing scale.
To estimate the WS displacement, we would like to model the
relationship between the wearable and WS BCG as a mathematical system H as shown in Fig. 1. In this model, the input to H is
the wearable sensor’s estimated displacement and the output
is the WS BCG. Single-input-single-output (SISO) mechanical

WIENS AND INAN: NOVEL SYSTEM IDENTIFICATION TECHNIQUE FOR IMPROVED WEARABLE HEMODYNAMICS ASSESSMENT

1347

Fig. 2. Block diagram showing the signal processing subsystems. The calibrated configuration is shown in (a), where the system is first trained on the individual,
and (b) shows the uncalibrated configuration, where the system is pre-trained on a population of subjects.

systems, such as the classic spring-mass-dashpot system, are
generally causal as perturbations at the input result in changes
at the output only after they occur. However, since the genesis of
energy in mechanical cardiac signals like the BCG is myocardial
contraction and relaxation inside the thorax, and the resultant
ejection of blood into the aorta, we hypothesize that wearable
BCG signals recorded with an accelerometer on the surface of
the body and WS BCG signals will both be coupled to the same
source, the heart muscles and central blood movement, via two
different unknown mechanical systems in the body. In this situation, the outputs of two SISO systems, HW EAR and HW S ,
are the displacements of the wearable and WS BCG signals,
and these two systems share a common input originating from
the heart. If this hypothesis is accurate, H will be noncausal
because it involves the inverse of a causal system, HW EAR , in
series (cascaded) with HW S . Because inverting a causal system
in general results in a noncausal one, the overall series system
will also in general be noncausal.
Consequently, we posit that an approximation of H can be
obtained via system identification by training a noncausal linear finite impulse response (FIR) filter Ĥ with simultaneous
recordings of the wearable and WS BCG. Although H is almost
certainly an infinite impulse response (IIR) system due to its mechanical origins in HW EAR and HW S , an FIR filter of sufficient
length can approximate an IIR system provided that the latter is
stable. As instability would imply oscillations in the mechanical
systems over time of sustained or increasing magnitude, stability of H is almost certainly a reasonable assumption. Therefore,
if Ĥ can be made long enough to include most of the energy in
the true system, Ĥ should provide a good reconstruction of the

WS BCG from the wearable BCG. The methods we used to find
Ĥ and the error metrics we used to quantify its goodness of fit
are explained in the following section.
III. METHODS
A. Hardware and Data Acquisition
Wearable BCG measurements were made with a highresolution instrumentation-grade accelerometer oriented such
that the foot-to-head direction was positive. A small, ultralow
noise accelerometer (356A32, PCB Piezotronics, Depew, NY,
USA) was used to capture the wearable BCG and was selected
based on its low spot noise (20 μgrm s /Hz at 10 Hz) and total
noise (300 μgrm s for a bandwidth of 1–10 000 Hz), wide signal
bandwidth (0.7–5000 kHz, ±1 dB), and its relatively small size
(11.4-mm3 ) and low mass (5.4 g).
WS BCG recordings in the same axis were measured with
a modified weighing scale that also captured an electrocardiogram (ECG) with handlebar electrodes. A custom circuit
was built and implanted in the modified home weighing scale
(BC534, Tanita Corporation, Tokyo, Japan) to interface to the
strain gauge bridge in the scale and measure the fluctuations
in body weight caused by the heartbeat—the head-to-foot BCG
signal. An ultralow noise integrated bridge amplifier and 24-bit
sigma-delta analog-to-digital converter (AD7191, Analog Devices, Norwood, MA, USA) was used to amplify this differential
signal from the strain gauge bridge, and the digitized output was
connected to the input port of a microcontroller (1284P, Atmel
Corporation, San Jose, CA, USA). The digitized signal, sampled
at 120 Hz, was then wirelessly transmitted to the computer using

1348

Bluetooth and stored for postprocessing and analysis. The ECG
was sampled at 1 KHz and also transmitted via Bluetooth. The
WS BCG platform used in this study has been used in multiple
studies; for a detailed description of the hardware, refer to [8]
and [11].
A second ECG waveform was captured simultaneously with
Ag/AgCl gel electrodes to synchronize the wearable BCG and
WS BCG recordings, which were captured with separate data
acquisition units and sample rates. The second ECG recordings were measured by the BN-EL50 wireless ECG measurement module (BIOPAC Systems, Inc., Goleta, CA) with the
Ag/AgCl surface electrodes configured for a modified Lead II
measurement. The ECG data were transmitted wirelessly from
this module to the data acquisition system (MP150WSW,
BIOPAC Systems, Inc.), where they were sampled at 1 kHz and
stored on the computer. The data acquisition system recorded
the wearable BCG simultaneously at the same sample rate of
1 kHz.
All signals were recorded by a PC, resampled to a sample
rate of 1 kHz, synchronized via cross correlation of the two
ECG recordings, and analyzed offline. The scale frequency response was characterized extensively in [8]. The accelerometer
frequency response is provided by the datasheet. The coupling
of the accelerometer to the skin can influence the system frequency response for the accelerometer BCG measure. The exact
manner in which this impacts system frequency response is unknown and can depend on many variables such as body fat, skin
softness, and bone coupling. Thus, the purpose of this study is
to find a method for identification of the system without such
characterization.
B. Human Subjects
Fifteen healthy subjects with differing anthropometrics were
recruited for this study approved by the Georgia Institute of
Technology (GT) Institutional Review Board (IRB). Among
these subjects were ten men and five women aged 22 to 57.
Body mass ranged from 49 to 104 kg and height spanned 160 to
196 cm. The subjects were asked to wear three gel electrodes for
measuring the ECG while also standing on a modified weighing
scale to simultaneously capture the WS BCG. Additionally, subjects were asked to wear an accelerometer adhesively attached
to the skin at each of three locations on the body: the body of
the sternum halfway between the manubrium and the xiphoid
process, the point of maximum inflection (PMI) on the pectorals
directly above the heart, and the lumbar vertebrae at the lower
back near the body’s center of mass. The sternal BCG recorded
in this study is also known as the “vertical sternal seismocardiogram.” The subjects were asked to stand as still as possible on
the scale while wearing the ECG electrodes and the accelerometer, and recordings approximately 1 min in length were captured
with the accelerometer at each of the three locations resulting
in 45 total recordings.
In addition to the 15-subject trials, recordings were also made
on one individual over a span of nine consecutive days to determine if cardiovascular health could be monitored over time
via the wearable BCG. The wearable sensor was placed at the

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

sternum, PMI, and lower back as before; however, additional
recordings were also taken at the wrist. For the wrist trials, the
wearable sensor was attached to the body where a person would
typically place the face of a wrist watch. Cross validation was
not used. Instead, Ĥ was trained on data from the first day, the
WS BCG was reconstructed from the wearable BCG on each
day using Ĥ, and these reconstructions were evaluated using
the same error metrics as before.
C. Cross Validation and Error Metrics
K-fold cross validation is a technique commonly used to perform model selection in statistical and machine learning problems [21]. K-fold cross validation is the process of randomly
partitioning a dataset into k equal-size subsamples and performing the following procedure k times (folds): one subsample is
used to validate the results of the algorithm after training the
algorithm with the other subsamples. The k results are then
averaged and a single estimation is produced.
To use this tool on our dataset, we split the BCG and ECG
waveforms in each of the 45 recordings into individual heartbeats. Within each recording, five equal-sized sets of heartbeats were randomly partitioned. The signal processing steps
described in the next section were performed on each recording
five times, each time using four heartbeat sets to train the model
(the training set) and using the remaining heartbeat set to perform a reconstruction of the WS BCG from the wearable BCG
(the validation set). K = 5 was chosen as a tradeoff between
immunity to overfitting for large values of K and low signal-tonoise-ratio (SNR) of the ensemble average when using a small
number of heartbeats in the validation set.
Three error metrics were calculated from each fold’s reconstructed WS BCG. These error metrics were the R–J interval,
R–I interval, and I–J amplitude. These values are classical BCG
measures of different cardiac metrics, and a good reconstruction of the WS BCG should accurately reproduce these values
[7], [16], [22]. The average of these three values across all
recordings and folds was determined and used as a composite
error score to select each parameter in the model. 1-D error
traces were generated by calculating the composite error score
via cross validation for different values of one parameter while
holding other parameters constant. Likewise, 2-D error traces
were performed by varying two parameters.
D. Signal Processing
Fig. 2 shows a block diagram of the signal processing subsystems. First, band-pass filtering was performed on the BCG
signals to eliminate out-of-band noise. The passband for these
filters was 0.8–8.0 Hz. Although the BCG contains frequency
components higher than 8.0 Hz, we found that removing them
improved the reconstruction (see below).
Next, a preprocessing step was necessary to increase the SNR
of the two BCG signals. As described in the literature, the
SNR of repeating events can be improved by leveraging the
uncorrelated nature of the noise via ensemble averaging [8]. An
ensemble average of each signal was, therefore, produced by
calculating the sample-by-sample mean with respect to fiducial

WIENS AND INAN: NOVEL SYSTEM IDENTIFICATION TECHNIQUE FOR IMPROVED WEARABLE HEMODYNAMICS ASSESSMENT

1349

Fig. 3. Contour plots of 2-D error traces for the causal and noncausal BCG reconstructions from the wearable BCG at the sternum, PMI, and lower back. The
plots were generated on the same color scale so that comparisons can easily be made between them. The causal filters resulted in very large errors while the
noncausal filters performed well with an average error across the three error metrics of about 12% at the optimal filter length and N P R E .

points synchronous to the cardiac cycle. Similar to previous
studies, the R-peak in the ECG was used as the fiducial point
[16], [22], [23]. The minimum R–R interval for each recording,
RRM IN , was used as the total number of samples in the ensemble
average including and following the R-peak. A smaller number
of samples before the R-peak, NPRE , were also included in the
ensemble average to increase the total number of samples; the
total number of samples in the ensemble average was, therefore,
RRM IN + NPRE . Since cross validation was used, separate ensemble averages were constructed for the training and validation
sets.
Finally, an estimate for the accelerometer displacement was
determined via double integration and high-pass filtering. Numerical integration was performed with trapezoidal integrators,
and high-pass filters were implemented with moving average
subtractors. The output of each high-pass filter was its input
subtracted by its moving average, and the length of the moving
average was the same for all the filters. The optimal length was
determined empirically with a 1-D error trace and found to be
100 samples for our sample rate of 1000 Hz. This resolves to a
cutoff frequency of 6.0 Hz (corresponding to the filter’s −3 dB
point) and a maximum passband ripple of 1.45 dB.

E. System Identification via Least-Squares Regression
A training step was used to find the impulse response of
Ĥ. For any FIR filter, there are three parameters that must
be optimized with the objective of achieving generalization,
and thereby, avoiding overfitting: 1) causality of the system,
2) length of the filter, and 3) values for the filter weights.

The following approach was used for optimizing these three
parameters.
First, the WS BCG ensemble average was modified with a
variable delay. A zero delay resulted in the best-fit causal impulse response, while delays greater than zero produced a noncausal FIR. Performing cross validation for each case revealed
that causality had a large impact on the reconstruction accuracy.
Second, the length of the filter was determined using 2-D error
tracing. A sweep of filter lengths from 1 to 800 samples and
number samples before the R-peak (NPRE ) from 0 to 400 was
performed and the values of these two parameters corresponding
to the minimum composite error score from cross validation
were found.
Third, the impulse response of the optimal FIR filter was
found via least-squares regression. In a typical discrete linear
system, an unknown signal x modified by a known linear transform A produces a known output b as shown in the following
equation:
Ax = b.

(3)

To find the best-fit FIR filter of order m to transform one
signal f of length N into another signal d, a linear equation
can be constructed in the same form. In this case, the A matrix
contains samples from the input signal f, b contains samples
from the desired output signal d, and x is a 1−D vector of FIR
coefficients, or taps. This process is broadly named least-squares
filtering.
The explicit form of A, b, and x is shown in (4)–(6). In
this paper, signal f is the vector of samples from the wearable
BCG displacement ensemble average, d is the vector of samples
from the (possibly delayed) WS BCG ensemble average, and

1350

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

TABLE I
ERROR METRICS FOR ALL SUBJECTS
Subj. & Gdr.
Ht. (cm)
1M
2M
3F
4M
5M
6M
7M
8F
9M
10 F
11 M
12 F
13 F
14 M
15 M
Avg.
Min.
Max.
Med.
σ

Demographics
Wt. (kg) Age (yrs)

178
175
160
185
196
178
185
172
180
165
182
165
160
180
173
176
160
196
178
10.1

60
69
49
105
98
89
73
52
85
53
85
53
61
78
68
71.9
49
105
69
17.7

23
22
22
22
23
32
23
37
26
48
37
22
57
32
24
30
22
57
24
10.7

I-J Err.
0.14
0.47
0.29
0.26
0.15
0.06
0.12
0.33
0.11
0.56
0.13
0.30
0.20
0.34
0.29
0.25
0.06
0.56
0.26
0.14

Sternum
R-J Err. R-I Err.
0.02
0.12
0.05
0.02
0.02
0.01
0.01
0.14
0.01
0.04
0.01
0.01
0.20
0.14
0.02
0.05
0.01
0.2
0.02
0.06

0.07
0.12
0.08
0.05
0.09
0.07
0.02
0.22
0.05
0.11
0.02
0.12
0.28
0.23
0.05
0.10
0.02
0.28
0.08
0.08

Avg. Err.

I-J Err.

R-J Err.

0.08
0.24
0.14
0.11
0.09
0.05
0.05
0.23
0.06
0.24
0.05
0.14
0.23
0.24
0.12
0.14
0.05
0.24
0.12
0.08

0.05
0.24
0.35
0.34
0.25
0.05
0.13
0.22
0.09
0.35
0.27
0.15
0.45
0.07
0.19
0.21∗
0.05
0.45
0.22
0.12

0.02
0.02
0.09
0.03
0.02
0.004
0.02
0.02
0.03
0.03
0.01
0.02
0.29
0.04
0.06
0.05∗
0.00
0.29
0.02
0.07

PMI
R-I Err.
0.04
0.22
0.15
0.04
0.09
0.02
0.06
0.04
0.07
0.14
0.02
0.04
0.42
0.05
0.08
0.10
0.02
0.42
0.06
0.10

Avg. Err.

I-J Err.

0.04
0.16
0.2
0.13
0.12
0.02
0.07
0.09
0.06
0.17
0.10
0.07
0.39
0.05
0.11
0.12
0.02
0.39
0.10
0.09

0.10
0.48
0.35
0.16
0.26
0.11
0.19
0.10
0.20
0.46
0.04
0.22
0.23
0.14
0.25
0.22
0.04
0.48
0.20
0.13

Lower Back
R-J Err. R-I Err.
0.02
0.52
0.08
0.02
0.02
0.01
0.03
0.003
0.01
0.08
0.01
0.01
0.02
0.01
0.03
0.06
0.00
0.52
0.02
0.13

0.08
0.47
0.13
0.04
0.07
0.03
0.05
0.03
0.01
0.08
0.01
0.03
0.03
0.04
0.05
0.08∗
0.01
0.47
0.04
0.11

Avg. Err.
0.07
0.49
0.19
0.07
0.12
0.05
0.09
0.04
0.07
0.21
0.02
0.09
0.09
0.06
0.11
0.12∗
0.02
0.49
0.09
0.11

The best location is marked with an asterisk (∗).

x contains the adaptive filter coefficients.
⎡
f [m]
f [m − 1] · · ·
⎢ f [m + 1]
f [m]
···
⎢
A= ⎢
..
..
..
⎣
.
.
.
⎡

f [N ]

⎤

f [N − 1]

d [m]
⎢ d [m + 1] ⎥
⎢
⎥
b= ⎢
⎥
..
⎣
⎦
.
d [N ]
⎡
⎤
h [1]
⎢ h [2] ⎥
⎢
⎥
x = ⎢ . ⎥.
⎣ .. ⎦

···

f [1]
f [2]
..
.

⎤
⎥
⎥
⎥ (4)
⎦

f [N − m + 1]

(5)

(6)

h [m]
This particular form of A, b, and x is sometimes called the
covariance method because it uses only data that are explicitly available and does not assume that samples outside of
the available data window are zero [24]. In this context, all
of the samples in the ensemble average are used and we do not
assume that samples outside of the ensemble average window
are zero. This results in a matrix equation that is more computationally expensive to solve but improves the accuracy of the
solution.
F. Tikhonov Regularization
The regression was also regularized to reduce overfitting.
Since the data included imperfections from various sources
such as electrical noise, postural sway of the subjects, and motion artifacts from small movements like head tilts, a simple
least-squares solution would overfit the training data reducing

Fig. 4. Waveforms showing the reconstruction process of a recording with the
wearable sensor placed at the lower back. The calibrated WS BCG reconstruction is visibly superior to the uncalibrated one.

the accuracy of the reconstruction. Tikhonov regularization was
employed to mitigate this effect [25].
The ordinary least-squares solution x is that which minimizes
the square of the l2-norm of the error as shown in (7). The
solution x̂ is shown in (8).
argx min(||Ax − b||2 )

(7)

x̂ = (AT A)−1 AT b.

(8)

Since ordinary least squares is highly sensitive to noise, x̂ can
be regularized by adding a term to the minimization expression

WIENS AND INAN: NOVEL SYSTEM IDENTIFICATION TECHNIQUE FOR IMPROVED WEARABLE HEMODYNAMICS ASSESSMENT

1351

Fig. 5. Bland–Altman plots comparing the calibrated (blue) and uncalibrated (red) methods for I–J amplitude, R–I interval, and R–J interval measurements. The
calibrated reconstructions had a much smaller standard deviation than the uncalibrated counterparts.

Fig. 6. Average finite impulse responses of H and their frequency characteristics from each wearable location on the body for all subjects (solid) are shown
with the corresponding sample-by-sample standard deviations (dashed). The morphology of the H impulse responses were most consistent between subjects when
the wearable accelerometer was worn at the lower back. The impulse responses are also clearly noncausal: significant energy exists in the impulse responses for
negative and positive time, and therefore, every sample of BCG W S depends on both past and future samples of BCG W E A R .

as follows:
argx min(Ax − b2 + Γx2 ).

(9)

In this updated loss function, Γ is a Tikhonov matrix whose
effect is to give preference to certain solutions. For this study,
the scaled identity matrix in the following equation was chosen.
Γ = λI.

(10)

This particular Tikhonov matrix causes the solution vector
x̂ to shrink toward the origin. Small values of λ result in

overfitting while large values of λ result in underfitting. In other
words, the solution approaches the ordinary least-squares solution as λ → 0 and zero as λ → . The optimal value of λ
was 6.7 × 10−4 when displacements were expressed in meters
as determined with a 1-D error trace. (Tikhonov regularization
is also known as ridge regression in statistics, and this kind
of error trace is often called a ridge trace in that field [26].)
The Tikhonov-regularized solution is shown in the following
equation:
x̂ = (AT A + λ2 I)−1 AT b.

(11)

1352

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Fig. 7. Error metrics for reconstructing the WS BCG from the wearable BCG measured at the wrist. The algorithm was trained on the first day, and that calibration
was used for each subsequent day. The R–J interval reconstruction provided the lowest error of the three key features.

In this case, the solution x̂ is the FIR filter’s vector of coefficients and the impulse response of Ĥ.
G. Evaluating Results
The methods described previously were evaluated using the
composite error score. 2-D error traces were generated by
sweeping the number of samples before the R-peak (NPRE ) and
filter lengths (m) with cross validation on the entire dataset. The
optimal values for these two parameters were chosen by finding
the minimum average composite score for each of the three locations on the body to determine if these parameters depended
on the wearable sensor’s location. This process was performed
separately for the causal and noncausal cases to support or refute our causality hypothesis. Additionally, the individual error
values were extracted from the cross-validation step for the sternum, PMI, and lower back. Finally, uncalibrated reconstructions
were also made by using the average FIR filter for each body
location across all subjects to reconstruct the WS BCG for each
subject. The error scores for these uncalibrated reconstructions
were used to evaluate whether it would be possible to achieve
accurate results without the training step.
IV. RESULTS AND DISCUSSION
A. Results for All Subjects
Fig. 3 shows 2-D error traces for causal and noncausal reconstructions of the WS BCG for each wearable sensor location
on the body. Noncausal filters clearly resulted in a much better
reconstruction than the causal ones, suggesting that the underlying impulse response of H is indeed noncausal. There was little
difference in the optimal NPRE and filter length between the different locations on the body, although the optimal NPRE for the

lower back was slightly longer than the other two. The optimal
NPRE and filter length (m) in samples were 141 and 558 for an
overall error of 0.1194 at the sternum, 145 and 550 for an error
of 0.1240 at the PMI, and 162 and 550 for an error of 0.1124
at the lower back. The lower back was still the best location to
wear the sensor, but only slightly. The raw error metrics from
cross-validation testing for each subject with these values for
NPRE and m are shown in Table I.
While Fig. 3 shows that the best reconstructions were from
the lower back for short filter lengths, suggesting that the lower
back displacement is probably closest to the WS BCG and agreeing with the results of our previous paper [11], it is interesting
to note that when the techniques in this paper were applied
the difference between wearable locations almost completely
disappeared. After an initial training step, or calibration, reconstructing the WS BCG from the wearable BCG was just as
accurate from one location on the body as another. As a result, the wearable device could be placed on any location on the
body by the user themselves, and after a calibration step with the
weighing scale, the WS BCG could be accurately reconstructed
for the remainder of use.
Fig. 4 shows the waveforms of an example reconstruction
from the lower back. The uncalibrated reconstruction in this
example appears qualitatively worse than the calibrated, or
trained, reconstruction. This observation is supported by the
Bland–Altman plots [27] in Fig. 5, which compare the accuracy of the two methods in measuring I–J amplitude, R–I
interval, and R–J interval of the WS BCG for all subjects.
Specifically, the standard deviation of the uncalibrated measurements is much larger than the calibrated ones. Since the uncalibrated results are worse in all three metrics, calibration is clearly
needed to obtain the most accurate results. This suggests that
there may be large differences in the true impulse response H

WIENS AND INAN: NOVEL SYSTEM IDENTIFICATION TECHNIQUE FOR IMPROVED WEARABLE HEMODYNAMICS ASSESSMENT

between different locations on the same subject and between
different subjects at the same location. This is supported by
examination of the impulse responses produced by the system
identification technique. The average impulse responses from
each location on the body, as shown in Fig. 6, revealed high
intersubject variability, and the morphology of the FIR filters
between subjects were most similar at the lower back. This
could be part of the reason why the lower back appears to be
the best location to measure the wearable BCG; further work is
needed to gain a better understanding of H, HW EAR , and HW S .
B. Results for Multiday Trials
The error metrics over all nine days of the multiday trials
appear in Fig. 7. The I–J amplitude error spanned −16.2% to
+8.4%, the R–I interval error was between −13.5% and −0.9%,
and the R–J interval error was between −6.2% and −0.5%.
As these errors were relatively low and did not trend in any
particular direction with time, the wearable BCG is likely most
consistent within the same subject and location on the body.
It may, therefore, be possible to measure cardiac changes over
time with the wearable BCG at one location—such as with
accelerometers embedded in a smartwatch—using one initial
calibration with the scale.
V. CONCLUSION AND FUTURE WORK
In this paper, we described, for the first time, a method for
estimating the WS BCG with an accelerometer placed on the
surface of the skin and a simultaneously acquired ECG. Preliminary validation for this new technique was performed on data
from 15 consenting human subjects. Whereas it has been shown
that the acceleration on the surface of the skin differs substantially from whole-body displacement measurements taken with
WS BCG platform, training this algorithm with a WS BCG
recording from a modified weighing scale allowed accurate reconstructions of the WS BCG from three arbitrary locations on
the body for 15 subjects at rest. (And from the wrist on one
subject at rest over several days.) The lowest error was obtained
in reconstructions from the lower back; this was supported by
cross validation as well as examination of the FIR filters revealing that the lower back filter had the lowest intersubject
variability. This technique could, therefore, enable trending cardiac output and contractility with a simple wearable device using
published BCG analysis tools via a simple calibration step.
To the best of our knowledge, this is also the first demonstration of central hemodynamic measurement from the wrist. Because the BCG signal arises from central hemodynamic forces,
the ability to measure the signal from a distal location, such
as the wrist, potentially has profound applicability to the important problem of cuffless blood pressure measurement. In future
work, by pairing wearable BCG measurement from the wrist
with additional local pulse measurement modalities—such as
photoplethysmography—we plan to develop novel pulse-transit
time-based approaches for blood pressure monitoring in a smartwatch form factor.
Further studies are also needed to validate this technique
for subjects whose cardiovascular systems are modulated or
diseased since this study included only healthy subjects in

1353

quiescence. Freedom to measure the BCG beyond large appliances and the ability to place the wearable sensor on arbitrary
places on the body would open up many opportunities for heart
monitoring throughout the day, and we intend for this paper to
serve as a framework for enabling new BCG modalities and
applications going forward.
REFERENCES
[1] D. Lloyd-Jones et al., “Heart disease and stroke statistics–2010 update:
A report from the American heart association,” Circulation, vol. 121,
pp. e46–e215, Feb. 23, 2010.
[2] J. W. Gordon, “Certain molar movements of the human body produced
by the circulation of the blood,” J. Anat. Physiol., vol. 11, pp. 533–536,
Apr. 1877.
[3] H. Mandelbaum and R. A. Mandelbaum, “Studies utilizing the portable
electromagnetic ballistocardiograph: IV. The clinical significance of serial
ballistocardiograms following acute myocardial infarction,” Circulation,
vol. 7, pp. 910–915, 1953.
[4] D. M. Salerno and J. Zanetti, “Seismocardiography for monitoring changes
in left ventricular function during ischemia,” Chest, vol. 100, pp. 991–993,
1991.
[5] L. Giovangrandi et al., “Ballistocardiography: A method worth revisiting,” in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol.. Soc. , 2011,
pp. 4279–4282.
[6] J. Alihanka et al., “A new method for long-term monitoring of the ballistocardiogram, heart rate, and respiration,” Amer. J. Physiol., vol. 240,
pp. R384–R392, May 1981.
[7] A. Lindqvist et al., “Static-charge-sensitive bed ballistocardiography in
cardiovascular monitoring,” Clin. Physiol., vol. 16, pp. 23–30, 1996.
[8] O. T. Inan et al., “Robust ballistocardiogram acquisition for home monitoring,” Physiological Meas., vol. 30, pp. 169–185, 2009.
[9] T. Koivistoinen et al., “A new method for measuring the ballistocardiogram using EMFi sensors in a normal chair,” in Proc. IEEE Annu. Int.
Conf. Eng. Med. Biol. Soc., 2004, pp. 2026–2029.
[10] O. T. Inan, “Recent advances in cardiovascular monitoring using ballistocardiography,” in Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc. , 2012,
pp. 5038–5041.
[11] A. Wiens et al., “Towards continuous, non-invasive assessment of ventricular function and hemodynamics: Wearable ballistocardiography,” IEEE
J. Biomed. Health Informat., to be published.
[12] M. Tobin et al., “The elimination of body resonance distortion from the
direct-body ballistocardiogram,” Circulation, vol. 12, pp. 108–113, Jul. 1,
1955.
[13] P. F. Migeotte et al., “Three dimensional ballistocardiogram and seismocardiogram: What do they have in common?” in Proc. IEEE Annu. Int.
Conf. Eng. Med. Biol. Soc., 2014, pp. 6085–6088.
[14] I. Starr and A. Noordergraaf, “A comparison between ultralow-frequency
ballistocardiograms and those secured by an improved high-frequency
technique, with studies to explain remaining differences,” Amer. Heart J.,
vol. 64, pp. 79–100, Jul. 1962.
[15] J. L. Nickerson et al., “The cardiac output in man: Studies with the low
frequency, critically-damped ballistocardiography, and the method of right
atrial catheterization,” J. Clin. Investigation, vol. 26, pp. 1–10, Jan. 1947.
[16] D. D. He et al., “A continuous, wearable, and wireless heart monitor using
head ballistocardiogram (BCG) and head electrocardiogram (ECG),” in
Proc. IEEE Annu. Int. Conf. Eng. Med. Biol. Soc., 2011, pp. 4729–4732.
[17] M. D. Rienzo et al., “Wearable seismocardiography: Towards a beat-bybeat assessment of cardiac mechanics in ambulant subjects,” Autonomic
Neurosci., Basic Clin., vol. 178, pp. 50–59, 2013.
[18] R. M. Wiard et al., “Preliminary results from standing ballistocardiography measurements in microgravity,” in Proc. IEEE Annu. Int. Conf. Eng.
Med. Biol. Soc., 2013.
[19] G. K. Prisk et al., “Three-dimensional ballistocardiography and respiratory motion in sustained microgravity,” Aviat. Space. Environ. Med.,
vol. 72, pp. 1067–1074, 2001.
[20] P. F. Migeotte et al., “Three dimensional ballistocardiography: methodology and results from microgravity and dry immersion,” in Proc. IEEE
Annu. Int. Conf. Eng. Med. Biol. Soc., 2011.
[21] M. Stone, “Cross-validatory choice and assessment of statistical predictions,” J. Roy. Stat. Soc., vol. 36, pp. 111–147, 1974.
[22] M. Etemadi et al., “Rapid assessment of cardiac contractility on a
home bathroom scale,” IEEE Trans. Inf. Technol. Biomed., vol. 15, no. 6,
pp. 864–869, Aug. 2011.

1354

[23] O. T. Inan et al., “Novel methods for estimating the ballistocardiogram
signal using a simultaneously acquired electrocardiogram,” in Proc. IEEE
Annu. Int. Conf. Eng. Med. Biol. Soc., 2009, pp. 5334–5347.
[24] T. K. Moon and W. C. Stirling, Mathematical Methods and Algorithms for
Signal Processing. Upper Saddle River, NJ, USA: Prentice-Hall, 2000.
[25] A. N. Tikhonov, “Solution of incorrectly formulated problems and the
regularization method,” Soviet Math., vol. 5, pp. 1035–1038, 1963.
[26] A. E. Hoerl and R. W. Kennard, “Ridge regression: Biased estimation for
nonorthogonal problems,” Technometrics, vol. 12, pp. 55–67, 1970.
[27] J. M. Bland and D. G. Altman, “Statistical methods for assessing agreement between two methods of clinical measurement,” Lancet, vol. 327,
pp. 307–310, 1986.

Andrew D. Wiens (S’10) received the B.S. degrees
in electrical engineering and computer engineering
(Hons.) from Washington University, St. Louis, MO,
USA, in 2013. He is currently working toward the
Ph.D. degree in Dr. Omer Inan’s lab., Georgia Institute of Technology, Atlanta, GA, USA.
He joined the Department of Electrical and Computer Engineering, Georgia Institute of Technology,
as a Teaching Assistant in digital signal processing
in 2013, and in 2014, he became a Teaching Assistant in electromagnetics. He is currently a Research
Assistant in Dr. Omer Inan’s lab. His current research interests include bioengineering, signal processing, machine learning, and techniques for noninvasive
physiological measurements.
Mr. Wiens received the President’s Scholarship in 2013 from the Georgia
Institute of Technology.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Omer T. Inan (S’06–M’09) received the B.S., M.S.,
and Ph.D. degrees in electrical engineering from
Stanford University, Stanford, CA, USA, in 2004,
2005, and 2009, respectively.
He joined ALZA Corporation (A Johnson and
Johnson Company) in 2006 as an Engineering Intern in the Drug Device Research and Development
Group, where he designed micropower, high efficiency circuits for iontophoretic drug delivery, and
researched options for closed-loop drug delivery systems. In 2007, he joined Countryman Associates,
Inc., Menlo Park, CA, where he was a Chief Engineer, involved in designing and developing high-end professional audio circuits and systems. From
2009 to 2013, he was also a Visiting Scholar in the Department of Electrical Engineering, Stanford University. Since 2013, he has been an Assistant Professor
of electrical and computer engineering, and a Program Faculty in the Interdisciplinary Bioengineering Graduate Program, Georgia Institute of Technology,
Atlanta, GA, USA. His research interests include noninvasive physiologic monitoring for human health and performance, and applying novel sensing systems
to chronic disease management and pediatric care. He has published 40 technical articles in peer-reviewed international journals and conferences, and has
two issued and three pending patents.
Dr. Inan is an Associate Editor of the IEEE JOURNAL OF BIOMEDICAL
AND HEALTH INFORMATICS, Associate Editor for the IEEE ENGINEERING IN
MEDICINE AND BIOLOGY CONFERENCE, Member of the IEEE Technical Committee on Translational Engineering for Healthcare Innovation, and Technical
Program Committee Member or Track Chair for several other major international biomedical engineering conferences. He received the Gerald J. Lieberman
Fellowship (Stanford University) in 2008–09 for outstanding scholarship, teaching and service. He is a Three-Time National Collegiate Athletic Association
All-American in the discus throw, and a former Cocaptain of the Stanford University Track and Field Team.

