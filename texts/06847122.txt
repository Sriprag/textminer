IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

2911

A Noncontact Capacitive Sensing System
for Recognizing Locomotion Modes
of Transtibial Amputees
Enhao Zheng, Long Wang, Member, IEEE, Kunlin Wei, and Qining Wang∗ , Member, IEEE

Abstract—This paper presents a noncontact capacitive sensing
system (C-Sens) for locomotion mode recognition of transtibial
amputees. C-Sens detects changes in physical distance between the
residual limb and the prosthesis. The sensing front ends are built
into the prosthetic socket without contacting the skin. This novel
signal source improves the usability of locomotion mode recognition systems based on electromyography (EMG) signals and systems based on capacitance signals obtained from skin contact. To
evaluate the performance of C-Sens, we carried out experiments
among six transtibial amputees with varying levels of amputation
when they engaged in six common locomotive activities. The capacitance signals were consistent and stereotypical for different
locomotion modes. Importantly, we were able to obtain sufficiently
informative signals even for amputees with severe muscle atrophy (i.e., amputees lacking of quality EMG from shank muscles
for mode classification). With phase-dependent quadratic classifier and selected feature set, the proposed system was capable of
making continuous judgments about locomotion modes with an average accuracy of 96.3% and 94.8% for swing phase and stance
phase, respectively (Experiment 1). Furthermore, the system was
able to achieve satisfactory recognition performance after the subjects redonned the socket (Experiment 2). We also validated that
C-Sens was robust to load bearing changes when amputees carried 5-kg weights during activities (Experiment 3). These results
suggest that noncontact capacitive sensing is capable of circumventing practical problems of EMG systems without sacrificing
performance and it is, thus, promising for automatic recognition
of human motion intent for controlling powered prostheses.
Index Terms—Capacitive sensing, locomotion mode recognition,
lower-limb prosthesis, noncontact wearable sensing, quadratic
discriminant classifier.
Manuscript received December 28, 2013; revised June 11, 2014; accepted
June 19, 2014. Date of publication July 1, 2014; date of current version November 18, 2014. This work was supported in part by the National Natural Science
Foundation of China under Grant 61005082, Grant 31000456, Grant 31371020,
Grant J1103602, Grant 61020106005, in part by the Beijing Nova Program (No.
Z141101001814001), in part by the National High Technology Research and
Development Program of China (863 Program, 2012AA011602), and in part by
the Fundamental Research Funds for the Central Universities. Asterisk indicates
corresponding author.
E. Zheng and L. Wang are with the Intelligent Control Laboratory, College of Engineering, Peking University, Beijing 100871, China, and are
also with the Beijing Engineering Research Center of Intelligent Rehabilitation Engineering, Beijing 100871, China (e-mail: zhengenhao@pku.edu.cn;
longwang@pku.edu.cn).
K. Wei is with the Department of Psychology, Peking University,
Beijing 100871, China, and is also with the Beijing Engineering Research Center of Intelligent Rehabilitation Engineering, Beijing 100871, China (e-mail:
wei.kunlin@pku.edu.cn).
*Q. Wang is with the Intelligent Control Laboratory, College of Engineering, Peking University, Beijing 100871, China, and is also with the Beijing
Engineering Research Center of Intelligent Rehabilitation Engineering, Beijing
100871, China (e-mail: qiningwang@pku.edu.cn).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2334316

I. INTRODUCTION
HE amputee’s prosthesis plays an important role in their
daily life. Recent development of powered lower limb
prostheses has greatly enhanced the mobility of amputees
and extended the functionality of the prosthesis [1]–[10]. The
microcomputer-controlled powered prosthesis can support more
energy-efficient walking, a more symmetric gait pattern, and
better shock absorption than a passive prosthesis. To reproduce
the behaviors of missing limb, the control methods should perfectly coordinate the prosthesis movement with human body
movement [4]. A frequently used control scheme in lower
limb prosthesis control is hierarchal control [1]–[3], where the
high-level controller recognizes the user’s motion modes and
the low-level controllers, based on the specific motion modes,
are responsible for producing kinematical and kinetic details of
the prosthesis. Therefore, accurate recognition of locomotion
mode is crucial to prosthetic control.
Studies on locomotion mode recognition in controlling powered prostheses are limited. For example, the MIT powered
ankle-foot prosthesis [5] achieved transitions between level
walking and stair descending. The transitions were recognized
by electromyography (EMG) signals that were generated by volitional contractions of residual limb one step before the transition. Commercial prostheses like the Proprio foot (Össur) could
adapt its ankle movement to different terrains based on adjusting orientation angles but it had at least one step delay [11]. To
achieve smooth and continuous prosthetic motion on different
terrains, additional sensors and methods that can measure human motion information are needed. Surface EMG is one of the
major signals used for motion mode recognition [12]–[18] in
the application of prosthesis control. Some of the studies [13],
[17] have combined EMG sensors with mechanical sensors for
more reliable recognition. There are a few exceptions [3], [19],
[20] solely relying on mechanical sensors.
The advantage of the EMG signal is that it has a very short
latency from human motion intent since it is a direct measure of
muscular activity. However, EMG-based motion mode recognition systems have practical problems: surface EMG electrodes have to be firmly attached to the skin around the targeted muscles. The sites for placing the electrodes are limited
due to muscle loss on the amputee’s residual limb and they
vary across amputees. Furthermore, the shifting of electrodes
and the presence of sweating skin negatively impact the performance of motion recognition [21], [26]. The EMG signals are
weak and liable to external noise and it necessitates dedicated
onboard circuitry for signal preprocessing. To overcome these

T

0018-9294 © 2014 IEEE. Translations and content mining are permitted for academic research only. Personal use is also permitted, but republication/redistribution
requires IEEE permission. See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2912

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig. 1. Hardware design of C-Sens. (a) Positions of the C-Sens electrodes inside the socket. Ch1-6 stand for individual electrodes. (b) Positions of the capacitance
electrode on a socket. The electrodes were pasted on the surface of the stump sock with double-side adhesive tapes. (c) Electrodes of C-Sens. (d) Placement of the
sensors and boards on human body.

two challenges for wearable pattern recognition in prosthesis
control. The first one was the system’s stability against dressing/undressing of prosthesis during daily use (Experiment 2). It
is a problem for EMG sensors when donning and doffing the
prosthesis [18], [21]. The second problem was whether and how
load bearing changes influence the recognition. We systematically evaluated this problem by assessing the performance of
C-Sens with load bearing changes (Experiment 3).

Fig. 2. Sensing method of the capacitance system. The human body is a
conductor and can be seen as the ground. The copper mesh and human body
forms a capacitor C . The stump sock forms the dielectric of the capacitor. The
stump sock comprises two layers of sock made of nylon and a layer of cushion.
The right diagram shows the charging and discharging procedure of the body
capacitance. R stands for the discharge resistor. The capacitor is charged to the
supply voltage V s and then discharged to a trigger voltage V t . The cycle time
consists of charging time and discharging time.

disadvantages, we proposed to use capacitive sensing as an alternative to EMG sensing for mode recognition [22]–[24]. However, there were some problems with this first prototype. First,
a sensing band had to be placed on the thigh to obtain capacitance signals since the socket itself occupied the measurement
site, thus it was obtrusive in daily use. Second, the sensing band
was in direct contact with the skin. The skin conditions (such as
dryness) could potentially impact the system performance.
In this study, we propose a noncontact capacitive sensing
system (C-Sens) to overcome these shortcomings. We validated the proposed C-Sens by examining six motion modes
among transtibial amputees (Experiment 1). We also addressed

II. MEASUREMENT SYSTEM
A. Sensing Front Ends
C-Sens records the capacitance signals between the residual
limb and the prosthetic socket. Six pieces of copper wire mesh
were fixed on the surface of the stump sock (see Fig. 1). The human body and the copper wire mesh forms the electrodes of the
capacitor and the stump sock makes the dielectric (see Fig. 2).
During motion, the physical distance between the electrode and
the human body changes constantly. By recording and analyzing
the coupling capacitance signals, it is possible to obtain motion
information during different locomotion modes.
This novel design of sensing front ends is a significant improvement over our previous C-Sens [23], [24]. The old version
required the electrodes, made of hard copper film, to directly
contact the skin. These electrodes were rigidly fixed on a customized thermoplastic band, which was worn on the thigh of
the amputated side. This old design was cumbersome to wear,
prone to measurement noise related to skin conditions, and
easily affected by repetitive dressing/undressing. In contrast, the

ZHENG et al.: NONCONTACT CAPACITIVE SENSING SYSTEM FOR RECOGNIZING LOCOMOTION MODES OF TRANSTIBIAL AMPUTEES

2913

TABLE I
DETAILED INFORMATION FOR FIVE SUBJECTS WITH TRANSTIBIAL AMPUTATION (TTA1–TTA6)

TTA1
TTA2
TTA3
TTA4
TTA5
TTA6

Age

Weight(kg)

Height(cm)

Gender

Years post-amputation

Measured leg

Residual limb length ratio

Prosthesis

55
45
29
43
27
30

75
71
60
64
57
65

176
170
178
165
168
172

M
M
M
M
F
M

18
8
7
11
15
5

L
L
R
R
R
L

36%
40%
36%
32%
73%
31%

Teh Lin(SachFoot)
Otto Bock 1S90
Teh Lin BKTQ042
Teh Lin BK6060
Otto Bock 1S67
Teh Lin BK6060

III. METHODS
A. Subjects and Experimental Protocol

Fig. 3. Photos of residual limbs of six transtibial subjects. Their length ratio
is marked.

present version has soft electrodes built in the socket without
contacting the skin, eliminating all drawbacks aforementioned.
As leg motion in common locomotive activities (walking,
ascending stairs, etc.) is mostly constrained in the sagittal plane,
we placed four electrodes on the anterior and the posterior parts
of the shank to capture the interaction between the residual
limb and the socket [see Fig. 1. (a)]. Furthermore, normal gait
also involves internal and external rotation of knee, making the
prosthetic socket interacting with the bilateral sides of the knee.
We, thus, placed two additional electrodes on each side of the
patella.

B. Signal Processing Circuits
Compared to our previous contact-based capacitance sensing
[23], [24], the noncontact version yielded significantly lower
capacitance amplitudes (on the scale of picofarad instead of
nanofarad). We utilized a time-to-digital converter (TDC) module to measure the cycle time of capacitive charging and discharging (see Fig. 2). The multichannel capacitors (electrodes)
were charged and discharged through a time-sharing resistor.
The cycle time difference is an indicator of capacitance and
was quantified by computing the cycle time ratio between the
six capacitors and a reference capacitor (a standard capacitance of 100 pF). The TDC module was capable of calculating
the capacitance at an effective frequency of 2500 Hz. The average peak-to-peak capacitance ranged from 10 to 20 pF.
Foot pressure insoles were used to detect the foot-ground
contacts [see Fig. 1. (c)]. The capacitance signals and foot pressure signals were synchronized by a control circuit worn on the
waist. All sensor data were polled at 100 Hz and transmitted
to a computer through a 2.4-GHz wireless module. Cyclic redundancy checking and automatic retransmission methods were
used to prevent data error during wireless communication.

Six subjects with transtibial amputation were recruited and
all subjects provided written and informed consent. All the participants in our study were traumatic amputation and no comorbidities exist in the subjects’ limbs. All of them can finish
the tasks (walking, stair ascending/descending, and ramp ascending/descending) without walking aids. Their activity level
is similar to K-3 in US k-ranking system. The demographic information of the subjects is shown in Table I. The residual limb
length ratio was calculated as the ratio between the length of
the residual shank (the distance between patella to the amputated site) and that of the sound shank (measured from patella
to malleoluslateralis). Note the length ratio varied substantially
among our subjects (see Fig. 3). All subjects were asked to
wear their own prostheses as well as the C-Sens [see Fig. 1(d)].
A reference electrode was inserted arbitrarily into the stump
sock. Three experiments were carried out to validate our sensing
system. Experiment 1 was designed to test the overall recognition performance. Subjects were tested with six common locomotion modes, including normal walking (W), stair ascending (SA), stair descending (SD), ramp ascending (RA), ramp
descending (RD), and standing (ST). The experiment was divided into ten sessions. In each session, subjects were asked to
perform two trials of each locomotion mode. For normal walking, subjects were asked to walk straight at their self-selected
pace for six strides. For stair ascending and descending, subjects claimed and stepped down a four-step staircase. During
stair descending, TTA2, TTA3, and TTA5 were able to use a
normal alternating leg pattern, while TTA1, TTA4, and TTA6
descended the staircases one step at a time. For ramp ascending/descending, subjects walked up/down a 3-m ramp with a
30◦ inclination. The subjects were allowed to use the handrails
during ramp ascending/descending. They were asked to stand
still before the measurement of each trial. For standing, subjects
were asked to stand still for 8 s as a trial. Between sessions,
subjects had a mandatory rest for 2 min or longer (by request).
Experiment 2 aimed to test performance stability of C-Sens
during repetitive wearing. To investigate the wearing stability
of C-Sens, the amputees in Experiment 2 were asked to take
off their prosthesis sockets for a brief rest after the fifth session
and put them back on for the remaining sessions. All other
procedures were the same as in Experiment 1. Five of the original
subjects except TTA5 were recruited.

2914

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Experiment 3 aimed to investigate how load bearing affected
the recognition performance. The experimental procedure was
similar to that of Experiment 1, except that subjects were asked
to carry a backpack (5 kg) for five sessions. Five original amputees participated (except TTA5) and two of them carried the
backpack in the first five sessions and the others in the last
five sessions. The resting timing between sessions was slightly
longer than the other two experiments (approximately 5 min)
due to the tiring nature of the task.
B. Classification Method
In the present study, we used sliding windows to segment
the C-Sens data. On each analysis window, the features were
calculated and fed to the classifier for judgment of locomotion
modes. The sliding step (window increment) was set as 10 ms.
We explored the effect of window length on recognition performance. A larger window usually leads to higher recognition accuracy as more information can be obtained. However, a larger
window is also associated with longer latency in recognition
judgments (especially during gait transitions) and this usually
negatively impacts on real-time prosthesis control. Therefore,
the optimal window size is a tradeoff between recognition accuracy and response time. We systematically varied window
size between 100 ms and 300 ms and investigated its impact on
performance.
We used the phase-dependent classification method to recognize the motion modes. Two classifiers were trained and tested
separately for two gait phases, i.e., stance and swing phase.
Each sliding window was labeled based on the gait phase of
the window data. If a window crossed two gait phases during
sliding, it was categorized to be in the phase that contained
more of its data. The gait phases were separated by two foot
contact (FC) events, i.e., initial FC and foot off events (FO).
The two events were determined by foot pressure measurements. The moments that the total force of the four pressure
insole sensors exceeded or dropped below an individually determined threshold were regarded as FC or FO events. A firstorder lag filter was employed to remove the noise in foot pressure signals before they were used for detection of contact
events. The threshold was determined individually based on
initial measurements. Before the experiment on each individual, we measured the signals of foot pressure insole when the
subject’s amputated leg rested freely above the ground for 10
s and stand still for 10 s. We summed up the signals of four
force sensitive resistors (FSRs) on the insole, which are proportional to ground reaction force. The summation value was averaged over 10 s for two measures. The threshold was calculated
as
Threshold = AVErest + (AVEstand − AVErest )/10

(1)

where AVErest stands for the average value of data when the
amputee’s leg freely rested above the ground, while AVEstand is
that of standing. The result was defined as the threshold to detect
gait events. We rechecked the results after the experiments and
found out that there were no misdetections.

C. Feature Set and Classifier
Based on our previous investigations [25], the ten timedomain features were used after initial examination of the
C-Sens signals
f1 = avg(X), f2 = std(X)
f3 = sum(abs(diﬀ(X)))
f4 = avg(diﬀ(X)), f5 = max(X), f6 = min(X)
f7 = sum(abs(X)), f8 = std(abs(X))
f9 = std(abs(diﬀ(X))), f10 = corr(X)
where X is the data matrix of one analysis window. avg(X) and
std(X) are the average values of X and the standard deviation of
X, respectively. diﬀ(X) is the difference of X. sum(X) is the
summation of X. abs(X) is the absolute value of X. corr(X)
is the correlation coefficient of two channels of X. The features
of each channel were extracted from segments with the window
length, and then, concatenated together and fed into the classifier. Finally, a 78-dimension feature vector set was obtained
for training and classification. A forward selection method was
utilized to select the optimized feature set: individual features
were used for classification and then the ones that performed
the best were short listed. They were then grouped in pairs and
tested again. The outstanding pair was again shortlisted and
added with a third feature. These steps were repeated until all
features were evaluated. The optimized feature set was chosen
based on its recognition accuracy.
In this paper, we evaluated the performance of three classifiers: linear discriminant analysis (LDA), quadratic discriminant
analysis (QDA) and Gaussian mixture models (GMM). Though
associated with increasing complexity, all these three classifiers
used Gaussian distribution or the mixtures of Gaussians to characterize the data of each motion mode. For LDA, the covariance
matrix of the distribution was assumed to be the same among
all the classes. For QDA, the covariance matrix was estimated
separately for each class. For GMM, the mixtures of Gaussian distribution was estimated for each class (the two-mixture
components was used here). The parameters of GMM for all
the classes were determined with the expectation maximization
(EM) algorithm. The data of one motion mode were clustered
with k-means algorithm. The clusters were then used to initialize the EM algorithm for finding the parameters. We searched
the optimal feature set for each classifier separately.
D. Evaluation
In this study, tenfold leave-one-out cross validation (LOOCV)
were used for the training and testing of the classifier. In this
procedure, data of one group of experiment were used as the
testing set, and the remaining data were used as the training set.
The process was repeated for ten times until all the group data
was used for testing set.
The overall recognition error (RE) was calculated by
RE =

Nm is
× 100%
Ntotal

(2)

where Nm is was the number of misrecognized testing data and
Ntotal was the total number of testing data.

ZHENG et al.: NONCONTACT CAPACITIVE SENSING SYSTEM FOR RECOGNIZING LOCOMOTION MODES OF TRANSTIBIAL AMPUTEES

To better illustrate the recognition performance of certain
locomotion patterns, confusion matrix was defined as
⎞
⎛
c11 c12 ... c16
⎜ c21 c22 ... c26 ⎟
⎟
(3)
C=⎜
⎝ ... ... ... ... ⎠
c61 c62 ... c66
where each element was defined as
nij
cij =
× 100%.
n̄i•

(4)

nij is the number of testing data in mode i recognized as mode
j and n̄i• is the total number of testing data in mode i. A higher
value of cij (i = j) denotes that it is easier for mode i to be
misclassified as mode j.
IV. RESULTS
A. Signal Preprocessing
The capacitance signals were consistent across gait cycles
and characteristic for different locomotion modes (see Fig. 4).
The noises (not shown) in the raw data comprised low-frequency
drifts (lower than 0.1 Hz), random impulses, and high-frequency
noise. Accordingly, we used three filters in series to regulate
the capacitance signal: a median filter, a first-order DC-notch
filter and a second-order 10-Hz low-pass Butterworth filter. The
filtered signals were further segmented by using two FC events.
B. Feature Set and Classifier Selection
We explored possible feature sets and accuracy changes
for different classifiers and for two gait phases separately
(see Fig. 5). The candidate classifiers were LDA, QDA, and
two-mixture GMM. The window size for feature extraction was
set to 250 ms according to our previous investigations [25]. In
general, recognition accuracy increased with more features. For
LDA, the highest average recognition accuracies were 94.3%
and 87.8% for the swing and the stance phase, respectively. The
results were obtained from ten features. For QDA, the highest
average recognition accuracies were 96.3% and 95.1% for the
swing and the stance phase, respectively. The results were obtained with eight features. For two-mixture GMM, the highest
recognition accuracies were 96.3% and 94.3% for the swing and
the stance phase, respectively. The results were obtained with
eight features.
For selecting feature set and classifiers, the recognition
performance and computational load should be both taken into
consideration. LDA had the lowest computational load but it performed the worst in recognition. QDA classifier outperformed
the other two classifiers in average recognition accuracies by
a small margin. Moreover, its computational complexity for
computing feature set and performing classification was much
smaller than that of two-mixture GMM. Hence, we eventually
chose QDA as the classifier for subsequent analysis. In QDA, the
highest recognition accuracy was obtained with the feature set
avg(X) + sum(abs(diﬀ(X))) + std(X) + avg(diﬀ(X)) +
min(X) + sum(abs(X)) + std(abs(X)) + corr(X).

2915

C. Window Length
The recognition performance was greatly affected by the window size (see Fig. 6) with the larger window containing more
information and resulting in better accuracy. However, response
time of recognition was compromised. Of the different cycle
lengths the 300-ms analysis windows yielded the highest accuracy (96.6% and 96.0% for the swing and stance phase, respectively). We observed an increasing trend of recognition accuracy when the window size leveled off around 250 ms. We,
thus, chose 250 ms as the optimal window length, as opposed to
300 ms, for less computational load and faster time response.
Note, a reduction of 50 ms in window length leads to 20%
of saving in computational load but it sacrifice approximately
0.74% in recognition accuracy.
D. Overall Recognition Performance
With the parameters determined aforesaid (optimal feature
set, QDA classifier, and 250-ms window length), we calculated the recognition accuracies for all subjects (96.3% and
94.8% for the swing and the stance phases, respectively). The
recognition accuracies of the swing phase were higher than
those of the stance phase for all motion modes (see Table II).
Among the six motion modes, standing obtained the highest recognition accuracies for both phases. Excluding standing, the average recognition accuracies were 95.5% and 93.8%
for the swing and stance phase, respectively. For the swing
phase, the classifier performed the worst in ramp descending
(AVE: 91.6%±SEM: 3.0%), which was the only mode with
recognition accuracy lower than 95%. This mode was most
likely mislabeled as stair descending (7.4%). For the stance
phase, the lowest recognition accuracy was 93.0% in stair descending, which was often mislabeled as ramp descending.
E. Wearing Stability
Experiment 2 specifically addressed the performance stability
of C-Sens against this disturbance, where subjects doff and don
the prosthesis in between the fifth and the sixth experimental
sessions. We used three evaluation methods to access the recognition accuracy for this data set. The first one was the tenfold
LOOCV as used in Experiment 1. The second one was 6:4 cross
validation (6:4 CV). Data of the first/last five sessions plus a session randomly chosen from the last/first five sessions were used
as training data; the remaining four sessions were testing data.
The recognition accuracy was computed by averaging the results of all possible combinations. The third evaluation method
was 5:5 CV, where the first five and the last five sessions were
used as training and testing data, respectively. Their roles were
also switched for another evaluation.
The average recognition accuracies of Experiment 1 were
95.5%, 91.9%, and 88.6% for tenfold LOOCV, 6:4 CV and
5:5 CV respectively. These values served as a baseline for
evaluating the effect of donning. For Experiment 2, the average recognition accuracies (after excluding TTA6) for the three
evaluation methods were 96.4%, 92.8%, and 85.1%, respectively (see Fig. 7). The recognition performance of TTA6 was

2916

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

Fig. 4. Average capacitance signals (blue lines) and their standard deviations (red lines) during one gait cycle from a typical subject (TTA2). The signals are time
normalized to a gait cycle (from a FC to the next FC). Each row stands for one signal channel (from CH1 to CH6). Each column stands for a specific locomotion
mode. The baseline of the signals is zero after the DC notch filter. The task of standing is not shown as its signals are almost constant for all the channels.

Fig. 5. Recognition accuracies for different feature sets and classifiers. From left to right: the recognition accuracies using LDA, QDA, and GMM. The top and
the bottom row shows the results for the swing and the stance phase, respectively. Average recognition accuracies of different feature combinations were shown as
the red circles. The error bar (black line) represents the highest recognition accuracy, for a given number of features, and its standard deviation across subjects.

particularly inferior compared to those of the other subjects.
Posthoc analysis of this subject revealed that he wore two layers of thick socks between our C-Sens electrodes and the socket
since his socket no longer fitted his residue limb. When focusing
on the rest of the subjects, we found that the overall reduction
in accuracy was minimal with donning the prosthesis in between sessions. Even using the trained classifier to test data after

donning (5:5 CV), the reduction in recognition accuracy was as
small as 3%.
F. Load-Bearing Changes
The subjects were asked to carry a 5.2-kg backpack on the
back for half of the experimental sessions (ten sessions in total).

ZHENG et al.: NONCONTACT CAPACITIVE SENSING SYSTEM FOR RECOGNIZING LOCOMOTION MODES OF TRANSTIBIAL AMPUTEES

2917

was obtained with nine training sessions (tenfold LOOCV). The
average accuracy increased rapidly as the number of training
sessions increased. The effect plateaued at about five training
sessions.
V. DISCUSSION

Fig. 6. Average recognition accuracies for different window lengths. The blue
line denotes the results of swing phase while the green line denotes that of the
stance phase. The error bars (black line) denote the average recognition of the
swing phase and the stance phase (mean +/− SEM).

Three of the subjects chose to carry the bag in the first half
of the experiment, while the other two in the second half. All
subjects indicated that they seldom carried such a large load in
daily life and they reported ramp ascending and stair ascending
were particularly tiring for the second half of the experiment.
With load bearing changes, C-Sens performed equally well, if
not better, as in Experiment 1 with all CV methods. The average recognition accuracies were 97.4%, 94.8%, and 90.8% for
tenfold LOOCV, 6:4 CV, and 5:5 CV, respectively (see Fig. 8).
We also found that TTA6, whose recognition performance was
particularly bad in Experiment 2, performed fairly well in Experiment 3 (99.3%, 98.9%, 97.5% for tenfold LOOCV, 6:4 CV,
and 5:5 CV, respectively). The results demonstrated that load
bearing changes do not negatively impact the recognition performance. Mode recognition can be performed with a classifier
trained with data from either a loaded or unloaded condition
without sacrificing performance.
G. Channel Importance
We calculated the recognition accuracies of all the subsets of
the six sensing positions for each subject with the previously
determined parameters (250-ms analysis window length, eight
time-domain features, and QDA classifier). C-Sens produced
the highest average recognition accuracy with all the sensing
electrodes used. The subset with the highest recognition accuracy at that size was selected as the optimal one. We cumulated
the appearances of each sensing position of all optimal subsets
as the channel importance score (see Fig. 9). The scores of each
electrode vary among the six subjects. It demonstrated that there
were no redundant sensing electrodes.
H. Number of Training Sessions
We evaluated the performance with different number of training sessions (see,Fig. 10). There were ten-session measurements
in our experiment. We picked out sessions of data for training
and the remaining sessions for testing. For each number of
training sessions, we calculated the average recognition accuracy over all combinations of data. Highest recognition accuracy

In this paper, we validate the effectiveness of the non-contact
C-Sens for locomotion mode recognition on transtibial amputees. The system is able to measure user’s locomotion intent
without fixing sensor electrodes on the skin. The signals were
fairly distinguishable among different locomotion modes and
showed good repeatability over repetitive trials. With selected
feature sets and classifiers, the system yielded comparable performance to systems based on EMG and mechanical sensors.
Moreover, C-Sens was found to be robust when exposed to
disturbances introduced by rewearing the prosthesis and by carrying extra loads. Our new noncontact system is a considerable
improvement over the previous C-Sens, more importantly, it is
a promising EMG-alternate for recognizing locomotion modes
in powered lower limb prosthesis.
Capacitive sensing has four advantages over EMG signals for
locomotion mode recognition in amputees. First, the electrodes
of C-Sens are placed in the socket, which frees human skin from
contact with additional electrodes. The 0.1-mm electrodes are
minimally intruding to the user. This is in contrast to the chafing and pressure sores caused by EMG electrodes [17]. Second,
the C-Sens produced satisfactory performance even in subjects
with severe muscle loss, thus it might serve as the only effective
solution for these subjects. Third, C-Sens is robust to disturbance caused by doffing and donning the prosthesis. The results
of Experiment 2 showed that rewearing the socket between the
fifth and sixth session did not lead to substantial reduction in
recognition accuracy ( 3% reduction with 5:5 CV; no reduction
given one-tenth of extra training data after rewearing). In contrast, a shift of EMG sensors on muscles can lead to up to 15.8%
reduction in accuracy for LDA classifier and 23.1% for support
vector machine classifier [18]. Finally, we were able to sample
the data with a much lower frequency (100 Hz) than EMG systems (1000 Hz), because capacitance signals were slow varying.
It substantially reduced computation load, which was a critical
factor for wearable devices.
C-Sens achieved satisfactory performance in motion mode
recognition compared with EMG sensors. With selected parameters (six time-domain features, a QDA classifier, and a 250-ms
analysis window), the average recognition accuracies were
96.3% and 94.8% for the swing phase and stance phase, respectively. By combining EMG and mechanical signals, Huang et al.
also achieved recognition accuracies of 99.0% or higher and
95.0% in the stance phase and swing phase, respectively [13].
Note that the latter study used four gait phases to segment the
movements, thus their system in fact used four classifiers. This
is at the expense of mounting extra foot switch on the intact
limb. In our study, we placed a pressure insole on the amputated
side and as a result only two gait phases and two classifiers were
used. Our approach was, thus, robust to disturbances to bilateral
gait symmetry caused by terrain changes and it also reduced

2918

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

TABLE II
CONFUSION MATRIX (MEAN±SEM) FOR SIX AMPUTEES (%)
Estimation
Phase

swing

stance

Target

St

W

SA

SD

RA

RD

St
W
SA
SD
RA
RD

99.9±0.04
0.0±0.0
0.0±0.0
0.0±0.0
0.0±0.0
0.0±0.0

0.0±0.0
95.1±2.3
0.1±0.0
0.2±0.1
1.0±0.4
0.9±0.4

0.0±0.0
0.1±0.1
98.3±0.8
0.1±0.1
1.8±0.6
0.0±0.0

0.0±0.0
1.6±0.5
0.2±0.1
96.2±1.0
0.5±0.2
7.4±3.3

0.1±0.0
0.5±0.4
1.2±0.7
0.7±0.4
96.3±0.9
0.1±0.1

0.0±0.0
2.6±1.7
0.1±0.1
2.9±1.1
0.4±0.3
91.6±3.0

St
W
SA
SD
RA
RD

99.7±0.1
0.0±0.0
0.0±0.0
0.0±0.0
0.1±0.1
0.9±0.9

0.0±0.0
95.0±1.4
0.5±0.3
0.7±0.4
0.6±0.2
0.7±0.2

0.0±0.0
1.7±0.8
93.7±1.6
0.9±0.7
4.0±1.7
0.5±0.3

0.0±0.0
0.1±0.4
1.6±1.1
93.6±2.3
0.7±0.4
3.4±1.3

0.2±0.1
1.2±0.5
3.8±1.7
1.8±1.1
93.8±1.9
1.4±0.5

0.1±0.1
1.1±0.6
0.3±0.2
3.0±1.2
0.9±0.3
93.0±1.2

Fig. 7. RE rate from Experiment 2 when subjects doffed and donned their
prostheses in the mid of the experiment. The recognition was performed with
tenfold LOOCV, 6:4 CV, and 5:5 CV. Results from Experiment 1 served as
a baseline. The black dashed line denotes the results from an outlier subject
(TTA6) in Experiment 2 and the black-dotted line denotes the average REs over
the remaining subjects in Experiment 2.

Fig. 8. RE rate in Experiment 3 where subjects carried a backpack for half of
the sessions. Tenfold LOOCV, 6:4 CV, and 5:5 CV were used. The black line
denotes the average RE from Experiment 1, which serves as a baseline. The
black dotted line represents the average RE from Experiment 3.

hardware redundancy and computational load. Note that the
performance of C-Sens in the swing phase, which is critical
for real-time prosthetic control, was comparable to [13]. In our
study, the analysis window length was 250 ms and the increment 10 ms. The response time was at the same level as that
from EMG sensors [13], [15], [16]. This indicates that neuromechanical delay inherent in the capacitance sensing system does
not affect the response time. Miller et al. [18] reported 97.9%
accuracy, averaged over three phases with EMG signals alone.
However, this study only reported recognition at discrete occasions and it used a 33-fold CV. Our approach, instead, generated
continuous judgments for each 10 ms and used a tenfold validation. Above all, without mechanical sensors, C-Sens achieved
similar recognition accuracy as EMG-based systems.
The present study is a significant improvement upon our previous work on capacitive sensing [23], [24], where the amputees
were required to wear a sensing band on the thigh. The C-Sens
is unobtrusive as it is fixed in the socket without skin contact; as such it is more practical. C-Sens can also be applied
to transfemoral amputees as long as we can put electrodes in
the socket; this was impossible for our first prototype. Furthermore, rewearing the prosthesis is problematic for the previous prototype since special caution must be taken to ensure
consistent alignment of the sensing band. In contrast, C-Sens
showed higher consistency before and after rewearing.
In our present study, the experiments on motion transitions
were not involved. There are some possible influences that motion transitions have on recognition performance. First, the data
of the transition procedure show similar patterns between two
adjacent motion modes (the motion modes that before and after
the transition). It increases the difficulty of making correct judgments for the classifiers during motion transitions. One solution
to the problem is the postprocessing method (e.g., majority voting) to remove the error judgments. Second, the amputees can
perform two types of motion transitions. They can step onto a
new terrain either with the intact leg or with the amputated leg.
It is possible that the recognition accuracies decrease if only one
type of the transitions is trained in the experiment. To solve the
problem, experiments for both circumstances are needed. Third,
the influence of the prosthesis should be taken into consideration

ZHENG et al.: NONCONTACT CAPACITIVE SENSING SYSTEM FOR RECOGNIZING LOCOMOTION MODES OF TRANSTIBIAL AMPUTEES

2919

Fig. 9. Relative importance of the sensing electrodes for each participant. Darker color means higher relative importance score. Data were obtained from
Experiment 1.

Fig. 10. Recognition performance of different number of training sessions.
Data are averages for six subjects; error bars represent +/− 1 STD. The results
were obtained from Experiment 1 data.

if the subject wears the powered prosthesis [20] and more criteria
should be used to evaluate the performance (e.g., the predicted
time [13]) in addition to recognition accuracy.
The number of training sessions is an important factor that
influence the total time needed in locomotion mode recognition.
Although the increase of recognition accuracy leveled off after
the five-session training data, the recognition accuracy was not
high enough for practical use. The issue of training sessions is
also reported in [20]. One factor that affects the performance
is generalization ability of the classification methods. Better
generalization ability can reduce the training data set as it can
tolerate larger variations of the testing data. Further attempts
should be made by combining with other sensors and using
more robust classification scheme.
The C-Sens was validated on passive prosthesis in our present
study, further experiments should be conducted to achieve motion transition recognition on powered prosthesis. The powered
prosthesis is usually integrated with gyroscope, accelerometer,
and load cells [1], [3], [7], [10], [11], [20]. The mechanical
signals comprise tilt angles, angular velocity, acceleration, and
ground reaction force. It was stated in [20] that RE rates were relatively high using only mechanical sensors. Combination with
other sensors that can provide complementary information is
needed. In our study, C-Sens signals record the changes of the

gap between the residual limb and the prosthesis socket. The
signals reflect the interaction information between human body
and the prosthesis during ambulation, which cannot be measured by the mechanical sensors on prosthesis. The information
was also proved to be useful not only in stance phase but also in
swing phase by recognition results. It is possible that the combination of the C-Sens and the on-prosthesis sensors will improve
the recognition performance on powered prosthesis.
Future studies will be carried out in the following aspects:
first, only static motion modes were measured with passive
prosthesis. Further studies should be made based on powered
prosthesis and the practical problems in motion transitions will
be addressed as well. Second, C-Sens performed worse during
re-wearing if the prosthesis does not fit the residue limb as
shown in TTA6. Thus, the system performance can be further
improved if we provide subjects well-suited prosthesis. Third,
the training time does not suffice for practical use of prosthesis
control. More classification methods will be designed to shorten
the training time.
VI. CONCLUSION
In this paper, we present a noncontact C-Sens for automatic
locomotion mode recognition among transtibial amputees.
C-Sens is mounted in the prosthetic socket without direct contact with the skin and is able to circumvent practical problems of
EMG systems without sacrificing performance. The signals are
highly repeatable with sufficient information for real-time classifications even for amputees with severe muscle atrophy. We
also verify that C-Sens can perform consistently after rewearing the prosthesis and with load bearing changes. We believe
noncontact capacitive sensing is a good alternative to EMG
for controlling powered lower-limb prosthesis. Future endeavors should be directed to integrate mechanical sensors and test
the system on the powered prosthesis and further improve its
performance.
ACKNOWLEDGMENT
The authors would like to thank the anonymous reviewers for
their valuable suggestions that made possible the improvement
of this paper. They would also like to thank W. Zhao and J. Mai
for their contributions in experiments.

2920

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 12, DECEMBER 2014

REFERENCES
[1] S. Au, M. Berniker, and H. Herr, “Powered ankle-foot prosthesis to assist level-ground and stair-descent gaits,” Neural Netw., vol. 21, no. 4,
pp. 654–666, 2008.
[2] R. Jiménez-Fabián and O. Verlinden, “Review of control algorithms for
robotic ankle systems in lower-limb orthoses, prostheses, and exoskeletons,” Med. Eng. Phys., vol. 34, pp. 397–408, 2012.
[3] H. A. Varol, F. Sup, and M. Goldfarb, “Multiclass real-time intent recognition of a powered lower limb prosthesis,” IEEE Trans. Biomed. Eng.,
vol. 57, no. 3, pp. 542–551, Mar. 2010.
[4] M. Goldfarb, B. E. Lawson, and A. H. Shultz, “Realizing the promise of
robotic leg prostheses,” Sci. Tranl. Med., vol. 5, no. 210, Paper 210ps15,
2013.
[5] S. Au, J. Weber, and H. Herr, “Powered ankle-foot prosthesis improves walking metabolic economy,” IEEE Trans. Robot., vol. 25, no. 1,
pp. 51–66, Feb. 2009.
[6] R. Versluys, A. Desomer, G. Lenaerts, O. Pareit, B. Vanderborght,
G. Perre, L. Peeraer, and D. Lefeber, “A biomechatronical transtibial
prosthesis powered by pleated pneumatic artificial muscles,” Int. J. Modell. Identif. Control, vol. 4, pp. 394–405, 2008.
[7] P. Cherelle, V. Grosu, A. Matthys, B. Vanderborght, and D. Lefeber,
“Design and validation of the ankle mimicking prosthetic (AMP-) Foot
2.0,” IEEE Trans. Neural. Syst. Rehabil. Eng., vol. 22, no. 1, pp. 138–148,
Jan. 2014.
[8] J. Zhu, Q. Wang, and L. Wang, “On the design of a powered transtibial
prosthesis with stiffness adaptable ankle and toe joints,” IEEE Trans. Ind.
Electron., vol. 61, no. 9, pp. 4797–4807, Sep. 2014.
[9] F. Sup, H.A. Varol, J. Mitchell, T. Withrow, and M. Goldfarb, “Preliminary
evaluations of a self-contained anthropomorphic transfemoral prosthesis,”
IEEE/ASME Trans. Mechatronics, vol. 14, no. 6, pp. 667–676, Dec. 2009.
[10] Q. Wang, K. Yuan, J. Zhu, L. Wang, “Finite-state control of a robotic
transtibial prosthesis with motor-driven nonlinear damping behaviors for
level ground walking,” in Proc. 13th Int. Workshop Adv. Motion Control,
2014, pp. 155–160.
[11] L. Fradet, M. Alimusaj, F. Braatz, and S. I. Wolf, “Biomechanical analysis
of ramp ambulation of transtibial amputees with an adaptive ankle foot
system,” Gait Posture, vol. 32, pp. 191–198, 2010.
[12] H. Huang, T. A. Kuiken, and R. D. Lipschutz, “A strategy for identifying
locomotion modes using surface electromyography,” IEEE Trans. Biomed.
Eng., vol. 56, no. 1, pp. 65–72, Jan. 2009.
[13] H. Huang, F. Zhang, L. J. Hargrove, Z. Dou, D. R. Rogers, and
K. B. Englehart, “Continuous locomotion-mode identification for prosthetic legs based on neuromuscular-mechanical fusion,” IEEE Trans.
Biomed. Eng., vol. 58, no. 10, pp. 2867–2875, Oct. 2011.
[14] L. Du, F. Zhang, M. Liu, and H. Huang, “Toward design of an environmentaware adaptive locomotion-mode-recognition system,” IEEE Trans.
Biomed. Eng., vol. 59, no. 10, pp. 2716–2725, Oct. 2012.
[15] D. C. Tkach, R. D. Lipschutz, S. B. Finucane, and L. J. Hargrove, “Myoelectric neural interface enables accurate control of a virtual multiple
degree-of-freedom foot-ankle prosthesis,” in Proc. Int. Conf. Rehabil.
Robot., 2013, pp. 1–4.
[16] L. J. Hargrove, A. M. Simon, R. Lipschutz, S. B Finucane, and
T. A Kuiken, “Non-weight-bearing neural control of a powered transfemoral prosthesis,” J. Neuroeng. Rehabil., vol. 10, no. 64, art. no. 62,
2013.
[17] L. J. Hargrove, A. M. Simon, A. J. Young, R. D. Lipschutz, S. B. Finucane,
D. G. Smith, and T. A. Kuiken, “Robotic leg control with EMG decoding
in an amputee with nerve transfers,” New Engl. J. Med., vol. 369, no. 13,
pp. 1237–1242, 2013.
[18] J. D. Miller, M. S. Beazer, and M. E. Hahn, “Myoelectric walking
mode classification for transtibial amputees,” IEEE Trans. Biomed. Eng.,
vol. 60, no. 10, pp. 2745–2750, Oct. 2013.
[19] X. Wang, Q. Wang, E. Zheng, K. Wei, and L. Wang, “A wearable plantar
pressure measurement system: Design specifications and first experiments
with an amputee,” in Proc. 12th Int. Conf. Intell. Auton. Syst., pp. 273–281,
2012.
[20] A. J. Young, A. M. Simon, and L. J. Hargrove, “A training method for
locomotion mode prediction using powered lower limb prostheses,” IEEE
Trans. Neur. Syst. Reh. Eng., vol. 22, no. 3, pp. 671–677, May 2014.
[21] A. J. Young, L. J. Hargrove, and T. A. Kuiken, “Improving myoelectric
pattern recognition robustness to electrode shift by changing interelectrode
distance and electrode configuration,” IEEE Trans. Biomed. Eng., vol. 69,
no. 3, pp. 645–652, Mar. 2012.

[22] E. Zheng, B. Chen, Q. Wang, K. Wei, and L. Wang, “A wearable capacitive sensing system with phase-dependent classifier for locomotion mode
recognition,” in Proc. 4th IEEE RAS/EMBS Int. Conf. Biomed. Robot.
Biomechatronics, 2012, pp. 1747–1752.
[23] B. Chen, E. Zheng, X. Fan, T. Liang, Q. Wang, K. Wei, and L. Wang, “Locomotion mode classification using a wearable capacitive sensing system,”
IEEE Trans. Neur. Sys. Reh. Eng., vol. 21, no. 5, pp. 744–755, Sep. 2013.
[24] E. Zheng, B. Chen, K. Wei, and Q. Wang, “Lower limb wearable capacitive
sensing and its applications to recognizing human gaits,” Sensors, vol. 13,
pp. 13334–13355, 2013.
[25] E. Zheng, L. Wang, Y. Luo, K. Wei, and Q. Wang, “Non-contact capacitance sensing for continuous locomotion mode recognition: Design specifications and experiments with an amputee,” in Proc. Int. Conf. Rehabil.
Robot., 2013, pp. 1–6.
[26] J. W. Sensinger, B. A. Lock, and T. A. Kuiken, “Adaptive pattern recognition of myoelectric signals: Exploration of conceptual framework and
practical algorithms,” IEEE Trans. Neur. Sys. Reh. Eng., vol. 17, no. 3,
pp. 270–278, Jun. 2009.
Enhao Zheng received the Bachelor degree in automatic control from Xidian University, Xi’an, China,
in 2010. He is currently working toward the Ph.D.
degree under the supervision of Prof. Qining Wang
at the Intelligent Control Laboratory, College of Engineering, Peking University, Beijing, China.
His research interests include human motion detection, capacitive sensing, and human–machine interface.

Long Wang (M’99) received the Bachelor, Master,
and Doctorate degrees in dynamics and control from
Tsinghua University, Beijing, China, and Peking University, Beijing, in 1986, 1989, and 1992, respectively.
He has held research positions at the University of
Toronto, the University of Alberta, Canada, and the
German Aerospace Center, Munich, Germany. He is
currently a Cheung Kong Chair Professor of dynamics and control, the Director at Center for Systems
and Control, Peking University. He is also a Guest
Professor at Wuhan University, Wuhan, China, and Beihang University, Beijing,
China. His research interests are in the fields of complex networked systems,
collective intelligence, and biomimetic robotics.
Kunlin Wei received the B.E. degree in biomechanics from Beijing Sports University, Beijing, China,
the two M.A. degrees in kinesiology and electrical
engineering, respectively, and the Ph.D. degree in
kinesiology from the Pennsylvania State University,
University Park, PA, USA.
He is an Associate Professor at the Department of Psychology, Peking University, Beijing.
His research interests include sensorimotor control,
robotics, biomechanics, human–machine interaction,
and motor rehabilitation.
Qining Wang (S’06–M’09) received the Bachelor
degree in computer science and technology from
China University of Geosciences, Beijing, China, in
2004, and the Ph.D. degree in dynamics and control
from Peking University, Beijing, in 2009.
He was an Assistant Professor at the Center for
Systems and Control, College of Engineering, Peking
University, from July 2009 to July 2012. He is currently an Associate Professor at the College of Engineering, Peking University, and the Director at the
Beijing Engineering Research Center of Intelligent
Rehabilitation Engineering, Beijing. He is the Project Leader at the Robotic
Prosthesis R&D Group, Peking University. His research interests are in the
fields of bio-inspired robots and rehabilitation robotics.

