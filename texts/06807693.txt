IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

1447

A Dynamically Optimized SSVEP Brain–Computer
Interface (BCI) Speller
Erwei Yin, Zongtan Zhou∗ , Jun Jiang, Yang Yu, and Dewen Hu, Senior Member, IEEE

Abstract—The aim of this study was to design a dynamically
optimized steady-state visually evoked potential (SSVEP) brain–
computer interface (BCI) system with enhanced performance relative to previous SSVEP BCIs in terms of the number of items
selectable on the interface, accuracy, and speed. In this approach,
the row/column (RC) paradigm was employed in a SSVEP speller
to increase the number of items. The target is detected by subsequently determining the row and column coordinates. To improve spelling accuracy, we added a posterior processing after
the canonical correlation analysis (CCA) approach to reduce the
interfrequency variation between different subjects and named
the new signal processing method CCA-RV, and designed a realtime biofeedback mechanism to increase attention on the visual
stimuli. To achieve reasonable online spelling speed, both fixed
and dynamic approaches for setting the optimal stimulus duration
were implemented and compared. Experimental results for 11 subjects suggest that the CCA-RV method and the real-time biofeedback effectively increased accuracy compared with CCA and
the absence of real-time feedback, respectively. In addition, both
optimization approaches for setting stimulus duration achieved
reasonable online spelling performance. However, the dynamic
optimization approach yielded a higher practical information
transfer rate (PITR) than the fixed optimization approach. The
average online PITR achieved by the proposed adaptive SSVEP
speller, including the time required for breaks between selections
and error correction, was 41.08 bit/min. These results indicate
that our BCI speller is promising for use in SSVEP-based BCI
applications.
Index Terms—Brain–computer interface (BCI), BCI speller,
canonical correlation analysis (CCA), electroencephalogram
(EEG), steady-state visually evoked potential (SSVEP).

I. INTRODUCTION
N ELECTROENCEPHALOGRAM (EEG)-based brain–
computer interface (BCI) can provide a direct and noninvasive pathway for reestablishing communication to severely

A

Manuscript received February 18, 2014; revised March 29, 2014; accepted
April 22, 2014. Date of publication April 29, 2014; date of current version
May 18, 2015. This work was supported in part by the National High-Tech
R&D Program of China (863 Program) under Grant 2012AA011601, and the
National Natural Science Foundation of China under Grant 61375117. Asterisk
indicates corresponding author.
E. Yin, J. Jiang, Y. Yu, and D. Hu are with the College of Mechatronic Engineering and Automation, National University of Defense Technology, Changsha, Hunan 410073, China (e-mail: yinerwei1985@gmail.com;
jiangjun@nudt.edu.cn; yy87724@sina.com; dwhu@nudt.edu.cn).
∗ Z. Zhou is with the College of Mechatronic Engineering and Automation,
National University of Defense Technology, Changsha, Hunan 410073, China
(e-mail: narcz@163.com).
This paper has supplementary downloadable material available at
http://ieeexplore.ieee.org. This includes a multimedia AVI format movie clip,
which shows a natural scene. The size of the video is 7.35 MB.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org
Digital Object Identifier 10.1109/TBME.2014.2320948

disabled persons [1], [2]. In recent years, researchers have increasingly focused on BCI systems for alphabetic writing known
as BCI spellers [3]. EEG signals used for spelling mainly include
sensorimotor rhythm (SMR) [4], P300 event-related potential
(ERP) [5], and steady-state visually evoked potential (SSVEP)
[6]. The SSVEP is a periodic neural response located in the subject’s central visual field that is induced by a repetitive visual
stimulus [7]. Due to the high information transfer rate (ITR),
simple system configuration and minimal required user training
time [8], [9], the SSVEP speller has become one of the most
promising paradigms for practical BCI applications.
ITR is widely used for evaluating the performance of BCI
systems because ITR simultaneously considers the number of
selectable items, accuracy, and speed [2]. Consequently, BCI
researchers have generally focused on enhancing the ITR of
SSVEP spellers in terms of these three factors.
1) To increase the number of items, several methods have
been introduced to realize more distracters than stimulus
frequencies. Zhang et al. proposed a multiple frequencies sequential coding protocol to implement more targets
with limited frequencies. The BCI system with four targets was carried out in an offline experiment [10]. Hwang
et al. proposed a new dual-frequency stimulation method
to generalize 12 visual stimuli by combining four different frequencies [11]. Chen et al. presented an innovative
coding method using intermodulation frequencies induced
by luminance flicker (three frequencies) and color alternating (two frequencies) to build a SSVEP speller with
eight targets [12]. Jia et al. realized a BCI system comprising 15 targets with three stimulus frequencies using
the frequency and phase information [13]. However, the
number of items in these studies was insufficient to allow
every character of the BCI speller to be presented on the
monitor.
2) To enhance spelling accuracy, several signal processing
methods have been proposed, such as canonical correlation analysis (CCA) [14] and minimum energy combination [15], which have yielded better recognition results
than power spectral density analysis [16], a traditional
method for SSVEP recognition. Among these methods,
CCA has demonstrated the best performance and has
been widely used in previous SSVEP BCI studies [17].
Because the features of SSVEP responses are highly dependent on the participant, recent studies have achieved
further progress in terms of classification accuracy by
optimizing the reference signals [18] and selecting suitable stimulus frequencies [8], [19], [20] using additional
calibration runs. Unfortunately, misspellings induced by

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1448

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

interfrequency variations in the SSVEP responses at
different frequencies still occur.
3) To improve spelling speed under reliable control,
Volosyak proposed an adaptive mechanism of time segment length adaptation for SSVEP-based BCI spellers
[21]. In this system, the fixed thresholds of the SSVEP
response were determined based on the offline analysis
of EEG data collected from many subjects, with no individual information employed for threshold selection. The
recognition performance may deteriorate when directly
using the classification thresholds as a result of overfitting during the SSVEP-based spelling, particularly with a
short time window. Therefore, studies focusing on adaptive SSVEP spellers have been limited to [21].
In this study, we proposed a dynamically optimized SSVEP
speller with enhanced performance in terms of the number
of items classified, classification accuracy, and spelling speed
relative to previous SSVEP spellers. First, we introduced a
row/column (RC) paradigm into the SSVEP BCI to establish
a SSVEP speller with 36 items that uses only six frequencies.
Second, to enhance classification accuracy, we reduced the interfrequency variation in SSVEP responses by adding posterior
processing after the CCA approach and named the new signal
processing method CCA-RV (RV means reducing variation). In
addition, we implemented a real-time biofeedback mechanism
to increase attention on the visual stimuli. Third, two optimization approaches for setting the stimulus time, fixed and dynamic,
were compared using practical ITR (PITR), and the dynamic
optimization approach was implemented in our SSVEP speller
design.
The remainder of this paper is organized as follows. The stimulation paradigm design, signal processing, real-time biofeedback, optimization approaches, and experimental setup are described in Section II. The experimental results are presented
and discussed in Sections III and IV, respectively. Section V
concludes the paper.
II. METHODOLOGY
A. Stimulation Paradigm Design
The RC paradigm is widely used in P300-based BCI research.
In this paradigm, all items in the same row or column are flashed
simultaneously, and the targets are detected by their row and
column coordinates [22]. Here, the proposed SSVEP speller is
established by using the RC paradigm. The most common size
used for a BCI speller is 36 characters arranged in a 6 × 6 matrix
because this arrangement includes all basic items necessary for
spelling [23], [24].
Fig. 1 represents the graphical user interface (GUI) of the
proposed SSVEP speller, which has same number of items as
the classic BCI speller. Each cell in the proposed SSVEP speller
flickers between white and black at a unique, constant frequency.
The flickering was created using a white rectangular object
whose appearance and disappearance alternated on a black background. Because the available frequencies in a SSVEP speller
are often restricted and to decrease the difficulty of the stimulus

Fig. 1. GUI of the proposed SSVEP speller. The white rectangular objects
represent the periodic flickers used as SSVEP stimuli.

mechanism design and maintain a high classification accuracy
of the SSVEP, we employed only six frequencies, namely, 8.18,
8.97, 9.98, 11.23, 12.85, and 14.99 Hz, in the design of a periodic stimulus mechanism. The selection of these frequencies
has been discussed thoroughly in previous studies [25], [26].
Fig. 2 demonstrates the sequence in which each item on the
BCI interface flickers, with each number on a rectangular cell
denoting a stimulus frequency. As the RC paradigm, the target is detected by determining the row and column coordinates.
To identify the row coordinate of the target, all items in same
row flicker at the same frequency [see Fig. 2(a)]. Subsequently,
all items in the same column flicker at the same frequency to
detect the target’s column coordinate [see Fig. 2(b)]. This twostep stimulus mechanism occurs without stopping in between
steps.
B. CCA-RV Method and Real-Time
Biofeedback Mechanism
1) CCA-RV Method: Traditional SSVEP processing methods choose the target frequency by using the SSVEP response
with the largest score. Because the SSVEP response is likely to
be contaminated by background noise present in the subject’s
brain [18], the amplitude of the SSVEP response exhibits a
complex interfrequency variation among different subjects. As
a result, some items on the BCI interface (corresponding to a less
noisy SSVEP response) may be executed more easily than others [27], [28]. CCA achieves better classification performance
than other frequency detection approaches [14], but some misspellings still occur due to the interfrequency variation of the
SSVEP response at different frequencies. For instance, a nontarget SSVEP response may be stronger than that of the target
because the frequency associated with the nontarget is measured
from an area of the subject’s brain that is less contaminated by
background noise.
To address this issue, we propose a CCA-RV method to reduce the variation of the SSVEP response. In our approach,
CCA was used to calculate the correlation between the stimulus
frequency (Xf (t)) and the multichannel EEG data (Y ssvep (t)).
The stimulus frequency is represented as a square-wave periodic signal that can be decomposed into a Fourier series of its

YIN et al.: DYNAMICALLY OPTIMIZED SSVEP BRAIN–COMPUTER INTERFACE (BCI) SPELLER

1449

Fig. 2. Illustrations of the stimulus configuration of the SSVEP speller. The numbers in the cells represent the frequency numbers. Each cell in a row (a) or
column (b) flickered at the same frequency to enable detection of the target row and column coordinates, respectively.

harmonics

⎤

⎡

sin(2πf t)
⎢ cos(2πf t) ⎥
⎥
⎢
⎥
⎢
⎢ sin(2 · 2πf t) ⎥
⎥
⎢
⎥
⎢
1 2
N
⎢ cos(2 · 2πf t) ⎥
Xf (t) = ⎢
⎥,t = , ,···,
⎥
⎢
S S
S
..
⎥
⎢
⎥
⎢
.
⎥
⎢
⎥
⎢
⎣ sin(M · 2πf t) ⎦

(1)

cos(M · 2πf t)
where M is the number of harmonics, N is the number of
sampling points per selection, t is the current time point, and S
is the sampling rate. The correlation coefficient of each stimulus
frequency is then calculated as follows:
scorei (t) = ri (Xf i (t), Y ssvep (t))

(2)

where r is the correlation coefficient, f is the stimulus frequency, and i is the sequence number of the stimulus frequency.
The correlation coefficient r was calculated using the function
“canoncorr.m” in the MATLAB toolbox [29]. Subsequently, to
reduce the interfrequency variation of SSVEP responses, we
obtained the average nontarget scores (scoreNT
i (t)) of each frequency associated with different time points following the initial
stimulus presentation using data from calibration runs collected
prior to online spelling. During online spelling, the SSVEP response scores were evaluated in the following manner:
Scorei (t) =

scorei (t) − scoreNT
i (t)
.
scorei (t) + scoreNT
i (t)

(3)

Finally, the target coordinates of each time point were determined based on the maximum score of row and column SSVEP
responses, respectively. The target coordinates can be represented as follows:

	


max (Scoreri (t1 )) , max Scorecj (t2 )
C(t1 , t2 )= arg
i,j ∈[1,···,6]

(4)
where x and y denote the row and column coordinates of the
target, respectively. Scoreri (t1 ) and Scorecj (t2 ) are the real-time
SSVEP scores associated with row and column coordinates.
2) Real-Time Biofeedback Mechanism: Because variation in
the subject’s visual selective attention significantly influences

the amplitude of the SSVEP response, the performance of a
SSVEP speller strongly depends on the subject’s level of concentration [30], [31]. In traditional SSVEP spellers, feedback is
only given at the end of each selection as a spelling result. During
the spelling process, a subject might reduce the level of attention on the center of the SSVEP flicker, leading to a decrease
in spelling accuracy. In the proposed protocol, we designed a
real-time biofeedback mechanism to improve the efficiency of
the SSVEP speller. Feedback is given in real time to the subject
by changing the color of the current target characters (see the
supplementary data file available at stacks.iop.org). Specifically,
the system first changes the color of the characters within the
selected row and then changes the color of the character associated with selected row and column coordinates. The real-time
biofeedback is updated every 0.04 s. If subjects find that the
character they are looking at has not changed color during the
spelling process, they must increase their focus on the target
stimuli. This mechanism helps the subject enhance their level of
visual selective attention on the target stimulus, which should
consequently increase spelling accuracy.

C. Optimization Approaches for Stimulus Time
Typically, a longer stimulus time results in a higher classification accuracy but lower spelling speed in the SSVEP spelling
process, whereas a shorter stimulus time results in lower accuracy but higher speed. Due to the variation in spelling performance among subjects, there is a subject-specific tradeoff
between accuracy and speed, which leads to an optimization
problem [32].
ITR is widely used in the BCI community as an important
metric [2]. However, as discussed in [32], [33], to complete
the spelling task without error, a BCI speller needs to have an
error-correcting function in practical applications. Error correction requires the BCI user to erase a wrongly selected option
by selecting a “del” item and then select the correct option.
We employ the PITR proposed by Townsend et al., which provides a more realistic estimation of ITR [34]. The PITR can be
expressed as follows:

PITR =

(2P − 1) log2 N/T,

P > 0.5

0,

P ≤ 0.5

(5)

1450

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

where N is the number of items and P is the spelling accuracy.
Here, T is the time interval per selection, which is computed
from the following expression:
T = [(trow + tcolum n ) + I]/60

(6)

where trow and tcolum n are the row and column stimulus times,
respectively, and I is the time between successive selections
(2s). Note that I is necessary for practical BCI application and
cannot be ignored.
In our approach, the PITR was evaluated by a fivefold crossvalidation procedure with the offline data, which updated every
0.04 s. To ensure practical online spelling, we set both minimum
and maximum stimulus times, which were determined from the
offline training results. The minimum stimulus time was set
to the time point where the offline spelling accuracy reached
70% because an accuracy of greater than 70% is commonly required to achieve effective communication with a BCI [35]. To
avoid extensive waiting periods and visual fatigue, we set the
maximum stimulus time to 10 s. The peak PITR was taken as
a measure of the possible performance of the SSVEP speller.
In particular, we proposed fixed and dynamic optimization approaches for selecting the stimulus time duration by calculating
the maximum PITR for each subject:
1) Fixed optimization approach. The optimal stimulus time
is estimated using calibration data and is fixed prior to
online BCI use. During online spelling, the SSVEP speller
provides the spelling results once the optimal stimulus
time is met.
2) Dynamic optimization approach. The optimal threshold
of the SSVEP response is estimated from the calibration
data and used for online spelling. In this optimization
approach, the SSVEP stimuli stop at any time and give the
spelling result once the current SSVEP response reaches
the threshold.
Fig. 3 presents the estimated optimal stimulus time for each
subject using the fixed optimization approach and the SSVEP
threshold for the dynamic optimization approach. Here, the optimal stimulus time includes the time for both row and column
detections.
D. Experimental Setup
1) Subjects: Eleven healthy subjects (five females and six
males, age 24–29 years, mean age 27.4 years) participated in
the study. All subjects had normal or corrected-to-normal vision.
Four of the subjects had previous experience with the SSVEPbased BCI, while the other subjects did not. All subjects signed
an informed consent form in accordance with the Declaration of
Helsinki. The purpose of this study and the task required were
explained to each subject in detail before preparation for the
EEG recording.
2) Data Collection: EEG signals were recorded using a
BrainAmp dc amplifier (Brain Products GmbH, Germany). Using the 64-channel extended international 10/20 system, ninechannel active electrodes were selected for the SSVEP detection
and were placed at Pz, P3, P4, Oz, O1, O2, POz, PO7, and PO8,
referenced to P8 (right mastoid) and grounded to Fpz (fore-

head) [36]. Each of the impedances was kept below 10 kΩ prior
to recording. The EEG signals were sampled at 250 Hz and
filtered using a 50-Hz notch filter. To improve the SNR, the
data collected from the SSVEP channels were filtered using a
4–35-Hz bandpass filter. The data collection and experimental
procedure associated with the BCI speller were controlled using
the BCI2000 platform [37], which provides a Python interface
for stimuli presentation and a MATLAB interface for signal
processing.
3) Experimental Procedures: The experiments were performed in a normal office room. After preparation for the EEG
recording, the subjects were seated in a comfortable chair located approximately 70 cm from a 27 LED monitor with a
refresh rate of 60 Hz and resolution of 1680 × 1080 pixels. A
short familiarization session was performed prior to the initiation of the experiments. To verify the feasibility of the proposed
approaches, the experiments consisted of offline and online sessions. To avoid confusing the subjects and fatigue bias, a 2-s
break was provided between successive selections to allow the
subjects to locate the next symbol, and a 5-min break was provided after every run. Additional details of the experimental
design are illustrated in the supplementary video (see the supplementary data file available at stacks.iop.org) and are described
as follows:
1) To verify the effectiveness of the CCA-RV approach and
the real-time biofeedback, the offline session consisted of
two different stimuli conditions—one with real-time feedback and one without. Six runs of each condition were
collected. In each run, the subjects were required to input
12 symbols in a random order to avoid adaptation. During
the offline session, the spelling target was marked by a
green square before the stimuli appeared, and the subjects
focused their visual attention on the marked symbol during the entire stimulus period. For each letter selection,
the SSVEP stimuli appeared on the screen and remained
for 10 s, with the first 5 s used for row coordinate detection and the subsequent 5 s used for column coordinate
detection.
2) To compare the performance of the proposed optimization
approaches for setting stimulus time, the online session
was performed using both the fixed and dynamic optimization approaches. During online spelling, subjects were not
given a word to spell. Rather, to provide a standardized
spelling task, the subjects were required to spell their own
names in Latin letters three times (three runs). When an
incorrect symbol was detected, the subject had to correct
the misspelling by selecting the “del” option located at
the bottom right of the matrix, followed by the correct
letter. In addition, the minimum and maximum stimulus
times were set beforehand (see Section II-C). For the fixed
optimization approach, the stimulus time for each subject
was determined using calibration data from the offline
session. Note that the stimulus times were identical for
row and column detection. For the dynamic optimization
approach, when the current SSVEP score exceeded the
optimal threshold, the system stopped flashing and gave
the spelling result.

YIN et al.: DYNAMICALLY OPTIMIZED SSVEP BRAIN–COMPUTER INTERFACE (BCI) SPELLER

1451

Fig. 3. Optimization process for stimulus time for each subject using the fixed and dynamic optimization approaches. The curves were estimated using the
calibration data. In each subfigure, the circular maker represents the optimal stimulus time for the fixed optimization approach and the quadrate marker represents
the SSVEP threshold for the dynamic optimization approach.

III. EXPERIMENTAL RESULTS
A. Online Performance
During the online session, each participant spelled his or
her own name three times. The number of task characters Mc
and practical selections Mp were recorded directly. To facilitate PITR calculation, we employed the formula presented
in [26]:
PITR =

Mc · log2 N
.
T · Mp

optimization approach was significantly better than the fixed
optimization approach. Therefore, the dynamic optimization approach was selected for our SSVEP speller design.
The results were obtained from the online spelling tests using
the selected optimal stimulus time and the SSVEP threshold, respectively. The PITR (bit/min) included the time breaks between
selections and error correcting.
B. Offline Analysis

(7)

In addition, we performed a difference analysis of the performance using paired t-tests.
The online performance of the proposed SSVEP speller using the two optimization approaches is summarized in Table I. Specifically, the average PITR obtained across all subjects
with the dynamic optimization approach (41.08 ± 7.43 bit/min)
was significantly greater than the average PITR obtained using the fixed optimization approach (37.71 ± 7.50 bit/min)
(p < 0.0392). In addition, the spelling speed achieved using dynamic optimization was significantly faster than that obtained
using fixed optimization (3.73 s versus 4.89 s, p < 0.0015). In
terms of the number of practical selections made, the approach
used to set the stimulus duration did not significantly affect
the results (p > 0.9955). Collectively, the results demonstrated
that although both optimization approaches for determining the
stimulus duration achieved reasonable spelling, the dynamic

Fig. 4 presents a comparison of the average classification
results achieved using the proposed approaches (CCA-RV and
real-time biofeedback) and traditional SSVEP approaches (CCA
and without real-time biofeedback). The results indicate that
the proposed approaches consistently achieved higher average
classification accuracy than the traditional SSVEP approaches.
Because offline analysis is typically used to select the optimization approach for online spelling, only the accuracy between the minimum and maximum stimulus times is considered
here (see Section II-C). Note that the illustrated accuracy is
not spelling accuracy but the classification accuracy associated
with row and column detections. To make the spelling accuracy higher than 70% and stimulus
time shorter than 10 s, an
√
accuracy higher than 83.67% ( 0.7) and a corresponding time
shorter than 5 s were considered for offline analysis. In particular, the accuracies achieved using the CCA-RV and CCA
approaches were compared using data collected with and without real-time biofeedback [see Fig. 4(a) and (b)]. The shaded

1452

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

TABLE I
ONLINE PERFORMANCE COMPARISON OF THE FIXED AND DYNAMIC OPTIMIZATION APPROACHES
Subject

S1
S2
S3
S4
S5
S6
S7
S8
S9
S10
S11
AVG
STD

Task Characters

30
24
24
15
36
27
36
30
39
24
33
28.91
7.01

Fixed Optimization
Stimulus Time (s)
8.24
3.92
3.92
4.48
4.72
4.40
6.24
4.88
4.72
3.60
4.72
4.89
1.31

Practical Selections
30
28
32
19
50
31
58
42
45
28
33
36
11.40

Dynamic Optimization
PITR (bit/min)
30.29
44.91
39.30
35.59
33.24
42.21
23.37
32.20
40.01
47.48
46.16
37.71
7.50

Stimulus Time (s)
4.41
3.07
3.57
3.86
3.86
3.26
4.56
3.32
3.95
3.32
3.89
3.73
0.48

Practical Selections
30
32
32
19
56
39
66
46
57
28
35
40
14.48

PITR (bit/min)
48.36
45.90
41.79
41.79
34.02
40.83
25.81
38.04
35.68
50.02
49.68
41.08
7.43

Fig. 4. Average classification accuracy (%) comparisons between CCA and CCA-RV ((a) and (b)) and between with and without real-time biofeedback ((c) and
(d)). The shaded areas indicate significant improvement (p < 0.05) achieved by the proposed approach.

areas indicate the significant differences (p < 0.05) of classification accuracies between the CCA and CCA-RV approaches.
Moreover, the accuracies obtained under the two stimulus conditions (with and without real-time biofeedback) were compared
for each of the signal processing approaches (CCA-RV and
CCA) [see Fig. 4(c) and (d)]. The results demonstrate that the

provision of real-time biofeedback yielded higher accuracies.
However, there were no significant differences in the accuracies
achieved with and without feedback for either classification approach, even though the differences in several parts of the curves
appeared more noticeable than the shaded areas in Fig. 4(a)
and (b).

YIN et al.: DYNAMICALLY OPTIMIZED SSVEP BRAIN–COMPUTER INTERFACE (BCI) SPELLER

IV. DISCUSSION
A. Explanation for the Performance Improvement
To understand and explain why the approaches used in the
adaptive SSVEP speller design outperformed other approaches,
we analyzed the performance improvement in terms of three
aspects.
1) Dynamic Optimization Versus Fixed Optimization: Because each individual will have different spelling capabilities
when using the SSVEP speller, the fixed optimization approach
for setting stimulus duration achieves reasonable online spelling
performance by setting a simple fixed time for each subject.
However, the performance of any one individual varies from one
selection to the next during online spelling. Fixing the optimal
stimulus time beforehand can hinder the achievable accuracy by
either specifying a stimulus time that is too short or impeding
communication rates by using a stimulus time that is too long.
The dynamic optimization approach allows the SSVEP speller
to adjust to the subject’s current state by increasing or decreasing the spelling speed, thus reducing the average time required
for a selection without significantly increasing the number of
misspellings. Therefore, the PITR of the system increases (see
Table I).
2) CCA-RV Versus CCA: As discussed in Section II-B1,
SSVEP amplitudes have an interfrequency variation due to the
background noise in the subject’s brain; this variation can induce
misspellings. To demonstrate the existence of this variation and
the superiority of CCA-RV compared with CCA, we performed
an offline analyses of the data collected during the calibration
runs with real-time biofeedback. Fig. 5(a) and (b) depicts the
average and standard deviation (SD) scores of the SSVEP responses associated with targets and nontargets obtained from
CCA and CCA-RV, respectively. The obvious decrease in the SD
score induced by CCA-RV demonstrates that the interfrequency
variation was significantly decreased, which may explain the accuracy improvement obtained through the use of CCA-RV. Note
that both the target and nontarget scores obtained by the CCA
approach are higher at the beginning of the stimulus interval
than those that follow due to the overfitting that occurs within
a short time window [38] [see Fig. 5(a)]. However, the target
scores obtained by the CCA-RV approach increase smoothly
[see Fig. 5(b)], which may facilitate the threshold setting for the
dynamic optimization design. Moreover, due to the reduction
of the interfrequency variation in SSVEP responses, this simple
and effective signal processing approach may help to expand
the available frequencies of the SSVEP speller design.
3) With Versus Without Real-Time Biofeedback: Because the
subjects’ visual selective attention may move around a visual
scene independent of gaze direction [30], [31], the amplitude
of a SSVEP response generally decreases when subjects reduce
their level of concentration on the center of the SSVEP stimulus. This phenomenon often occurs with traditional SSVEP
spellers due to the absence of real-time biofeedback. However,
in the proposed paradigm with real-time biofeedback, subjects
are more likely to concentrate on the target stimulus when they
realize an error has been made, potentially enhancing accuracy.
Interestingly, no significant improvement in accuracy as a result

1453

of biofeedback was observed, even though a noticeable difference in accuracy obtained by the two conditions was observed
[see Fig. 4(c) and (d)]. This surprising result could be explained
by the variation in the subject’s attention. The real-time biofeedback mechanism may have only been helpful when the reduction
in a subject’s attention had a significant effect on the SSVEP
detection instead of the specific stimulus time, resulting in an
inconsistent enhancement due to feedback.
B. Accuracy Comparison Between Row
and Column Detections
Because the target detection of the proposed SSVEP speller
consisted of successive row and column detections with no rest
period in between the two-step recognition, the column detection (the second step) could have been influenced by the row
stimuli (the first step), which would reduce accuracy. To graphically investigate this problem, we performed comparisons of
classification accuracy between the row and column detections
under different signal processing approaches and visual stimuli
situations. As shown by the cyan dashes in Fig. 6, the results
only indicate significant differences in accuracy between row
and column detections before 1.5 s poststimulus in all situations. However, only the gray areas are considered for practical
spelling (see the minimum and maximum stimulus time selections in Section II-C), and significant differences in accuracy
were not apparent during these time periods. Overall, the column detection should not be influenced by the row stimulus
during practical spelling.
C. Future Directions
Recent work has introduced a new framework for BCI research called the hybrid BCI, in which multiple BCI approaches
are combined [39]–[42]. Such systems provide new directions
for enhancing BCI performance. Our principal objective was to
design a dynamically optimized SSVEP speller for BCI spelling.
The system performance remains unexplored, which could be
facilitated by a hybrid BCI approach. Future directions for further enhancing the performance of the proposed SSVEP speller
are discussed below:
First, because the target detection of our approach directly
depends on both the row and column detections, a mistake in
one of these two detections will lead to misspelling. To achieve
more robust performance, future work could incorporate errorrelated potentials (ErrPs) into the proposed SSVEP speller to
enhance the spelling accuracy. Here, ErrPs are a certain type of
ERP that are present in the EEG signals when the user is aware
of erroneous behavior [43], [44]. We could record the ErrPs
response from the moment the speller finishes the row or column
detections and superimpose them onto the SSVEP responses
to reduce the misspelling, thus building a SSVEP-ErrPs-based
hybrid BCI system to increase the spelling accuracy.
Second, the spelling accuracy is somewhat improved by realtime biofeedback, whereas target detection is only dependent on
the SSVEP response. The proposed SSVEP speller is a closedloop BCI system, and the subjects also could use their active
brain information. For instance, we could incorporate the SMR

1454

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

Fig. 5. Target and nontarget scores of SSVEP responses calculated by CCA (a) and CCA-RV (b). The dashed lines represent the standard deviation (SD) of the
scores among different frequencies.

Fig. 6. Average classification accuracy (%) comparisons between row and column detections under different signal processing approaches and visual stimuli
situations. The cyan shaded areas indicate significant differences (p < 0.05) between the accuracy of the row and column detections, and the gray areas (surrounded
by the single-dashed line) represent the periods considered for practical spelling. (a) CCA and without real-time biofeedback. (b) CCA-RV and without real-time
biofeedback. (c) CCA and with real-time biofeedback. (d) CCA-RV and with real-time biofeedback.

YIN et al.: DYNAMICALLY OPTIMIZED SSVEP BRAIN–COMPUTER INTERFACE (BCI) SPELLER

induced by a motor imagery (MI) task into the SSVEP speller
to enhance the spelling speed. In particular, we could employ
the left and right MI tasks as “speed up” and “slow down” commands, respectively. The subjects could implement the “speed
up” command for a certain MI task if they find that the target
character changes color and vice versa. Therefore, we could
build a SSVEP-SMR-based hybrid BCI system for variablespeed spelling.

V. CONCLUSION
In this paper, we propose a dynamically optimized SSVEP
speller with real-time biofeedback. In this approach, the RC
paradigm was first introduced into an SSVEP speller to increase
the number of items. An SSVEP speller with 36 items was established using only six frequencies. To our knowledge, the proposed SSVEP speller is the only monitor-based SSVEP speller
whose number of items reaches 36. In addition, we proposed
a CCA-RV signal processing method and a real-time biofeedback mechanism to enhance the spelling accuracy. To achieve
reasonable online performance, we designed two optimization
approaches for selecting stimulus duration, and the dynamic
optimization approach was employed for the adaptive SSVEP
speller design. Experimental results with 11 subjects suggest
that the proposed SSVEP speller can provide improved performance compared to traditional BCI approaches. More specifically, the CCA-RV method outperformed the CCA method by
decreasing the interfrequency variation of the SSVEP response,
and the real-time feedback also increased spelling accuracy by
reducing visual selective attention out of the center of target
stimuli. Both the fixed and dynamic optimization approaches
for setting stimulus duration achieved reasonable spelling rates,
and the dynamic optimization approach yielded a higher PITR
than the fixed optimization approach. The online average PITR
achieved by the proposed SSVEP speller, including the time for
breaks between selections and for error correcting, was 41.08
bit/min.

REFERENCES
[1] J. R. Wolpaw, N. Birbaumer, D. J. McFarland, G. Pfurtscheller, and T. M.
Vaughan, “Brain–computer interfaces for communication and control,”
Clin. Neurophysiol., vol. 113, no. 6, pp. 767–791, 2002.
[2] J. R. Wolpaw, N. Birbaumer, W. J. Heetderks, D. J. McFarland, P. H.
Peckham, G. Schalk, E. Donchin, L. A. Quatrano, C. J. Robinson, and
T. M. Vaughan, “Brain-computer interface technology: A review of the
first international meeting,” IEEE Trans. Rehabil. Eng., vol. 8, no. 2,
pp. 164–173, Jun. 2000.
[3] H. Cecotti, “Spelling with non-invasive brain-computer interfaces-current
and future trends,” J. Physiol.—Paris, vol. 105, pp. 106–114, 2011.
[4] K. R. Müller, M. Tangermann, G. Dornhege, M. Krauledat, G. Curio, and
B. Blankertz, “Machine learning for real-time single-trial EEG-analysis:
from brain-computer interfacing to mental state monitoring,” J. Neurosci.
Methods, vol. 167, no. 1, pp. 82–90, 2008.
[5] J. N. Mak, Y. Arbel, J. W. Minett, L. M. McCane, B. Yuksel, D. Ryan,
D. Thompson, L. Bianchi, and D. Erdogmus, “Optimizing the p300-based
brain-computer interface: current status, limitations and future directions,”
J. Neural Eng., vol. 8, art. no. 025003, 2011.
[6] X. Gao, D. Xu, M. Cheng, and S. Gao, “A BCI-based environmental
controller for the motion-disabled,” IEEE Trans. Neural Syst. Rehabil.
Eng., vol. 11, no. 2, pp. 137–140, Jun. 2003.

1455

[7] F. B. Vialatte, M. Maurice, J. Dauwels, and A. Cichocki, “Steady-state
visually evoked potentials: Focus on essential paradigms and future perspectives,” Prog. Neurobiol., vol. 90, pp. 418–438, 2010.
[8] K. Shyu, Y. Chiu, P. Lee, J. Liang, and S. Peng, “Adaptive SSVEP-based
BCI system with frequency and pulse duty-cycle stimuli tuning design,”
IEEE Trans. Neural Syst. Rehabil. Eng., vol. 21, no. 5, pp. 697–703, Sep.
2013.
[9] Y. Kimura, T. Tanaka, H. Higashi, and N. Morikawa, “SSVEP-based
brain-computer interfaces using FSK-modulated visual stimuli,” IEEE
Trans. Biomed. Eng., vol. 60, no. 10, pp. 2831–2838, Oct. 2013.
[10] Y. Zhang, P. Xu, T. Liu, J. Hu, R. Zhang, and D. Yao, “Multiple frequencies
sequential coding for SSVEP-based brain-computer interface,” PLoS One,
vol. 7, no. 3, art. no. e29519, 2012.
[11] H. Hwang, D. Han, and C. Im, “A new dual-frequency stimulation
method to increase the number of visual stimuli for multi-class SSVEPbased brain-computer interface (BCI),” Brain Res., vol. 1515, pp. 66–77,
2013.
[12] X. Chen, Z. Chen, S. Gao, and X. Gao, “Brain-computer interface based
on intermodulation frequency,” J. Neural Eng., vol. 10, art. no. 066009,
2013.
[13] C. Jia, X. Gao, B. Hong, and S. Gao, “Frequency and phase mixed coding
in SSVEP-based brain-computer interface,” IEEE Trans. Biomed. Eng.,
vol. 58, no. 1, pp. 200–206, 2011.
[14] Z. Lin, C. Zhang, W. Wu, and X. Gao, “Frequency recognition based
on canonical correlation analysis for SSVEP-based BCIs,” IEEE Trans.
Biomed. Eng., vol. 54, no. 6, pp. 1172–1176, Jan. 2007.
[15] O. Friman, I. Volosyak, and A. Graser, “Multiple channel detection of
steady-state visual evoked potentials for brain-computer interfaces,” IEEE
Trans. Biomed. Eng., vol. 54, no. 4, pp. 742–750, Apr. 2007.
[16] M. Cheng, X. Gao, S. Gao, and D. Xu, “Design and implementation of a
brain-computer interface with high transfer rates,” IEEE Trans. Biomed.
Eng., vol. 49, no. 10, pp. 1181–1186, Oct. 2002.
[17] G. Bin, X. Gao, Z. Yan, B. Hong, and S. Gao, “An online multi-channel
SSVEP-based brain-computer interface using a canonical correlation analysis method,” J. Neural Eng., vol. 6, art. no. 046002, 2009.
[18] Y. Zhang, G. Zhou, J. Jing, M. Wang, X. Wang, and A. Cichocki, “L1regularized multiway canonical correlation analysis for SSVEP-based
BCI,” IEEE Trans. Neural Syst. Rehabil. Eng., vol. 21, no. 6, pp. 887–896,
Nov. 2013.
[19] R. Kus, A. Duszyk, P. Milanowski, M. Labecki, M. Bierzynska, Z.
Radzikowska, M. Michalska, J. Zygierewicz, P. Suffczynski, and P. J.
Durka, “On the quantification of SSVEP frequency responses in human
EEG in realistic BCI conditions,” PLoS ONE, vol. 8, art. no. e77536,
2013.
[20] J. Fernandez-Vargas, H. U. Pfaff, F. B. Rodriguesz, and P. Varona, “Assisted closed-loop optimization of SSVEP-BCI efficiency,” Front. Neural
Circuits, vol. 7, art. no. 27, 2013.
[21] I. Volosyak, “SSVEP-based Bremen-BCI interface-boosting information
transfer rates,” J. Neural Eng., vol. 8, art. no. 036020, 2011.
[22] L. A. Farwell and E. Donchin, “Talking off the top of your head: Toward a mental prosthesis utilizing event-related brain potentials electroencephalogr,” Clin. Neurophysiol., vol. 70, no. 6, pp. 510–523, 1988.
[23] E. Donchin, K. M. Spencer, and R. Wijesinghe, “The mental prosthesis:
Assessing the speed of a P300-based brain–computer interface,” IEEE
Trans Rehabil. Eng., vol. 8, no. 2, pp. 174–179, Jun. 2000.
[24] D. J. Krusienski, E. W. Sellers, D. J. McFarland, T. M. Vaughan, and J.
R. Wolpaw, “Toward enhanced P300 speller performance,” J. Neurosci.
Methods, vol. 167, no. 1, pp. 15–21, 2008.
[25] E. Yin, Z. Zhou, J. Jiang, F. Chen, Y. Liu, and D. Hu, “A novel hybrid BCI
speller based on the incorporation of SSVEP into the P300 paradigm,” J.
Neural Eng., vol. 10, art. no. 026012, 2013.
[26] E. Yin, Z. Zhou, J. Jiang, F. Chen, Y. Liu, and D. Hu, “A speedy hybrid
BCI spelling approach combing P300 and SSVEP,” IEEE Trans. Biomed.
Eng., vol. 61, no. 2, pp. 473–483, Feb. 2014.
[27] M. A. Pastor, J. Artieda, J. Arbizu, M. Valencia, and J. C. Masdeu, “Human cerebral activation during steady-state visual-evoked responses,” J.
Neurosci., vol. 23, no. 37, pp. 11621–11637, 2003.
[28] Y. Wang, R. Wang, X. Gao, B. Hong, and S. Gao, “A practical VEPbased brain-computer interface,” IEEE Trans. Neural Syst. Rehabil. Eng.,
vol. 14, no. 2, pp. 234–239, Jul. 2006.
[29] W. J. Krzanowski, Principles of Multivariate Analysis: A User’s Perspective. New York, NY, USA: Oxford Univ. Press, 1988.
[30] S. Kelly, E. Lalor, C. Finucane, G. McDarby, and R. Reilly, “Visual spatial
attention control in an independent brain-computer interface,” IEEE Trans.
Biomed. Eng., vol. 52, no. 9, pp. 1588–1596, Sep. 2005.

1456

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

[31] S. Kelly, E. Lalor, C. Finucane, R. Reilly, and J. Foxe, “Visual spatial attention tracking using high-density SSVEP data for independent
brain-computer communication,” IEEE Trans. Neural Syst. Rehabil. Eng.,
vol. 13, no. 2, pp. 172–178, Jun.2005.
[32] B. D. Seno, M. Matteucci, and L. T. Mainardi, “The utility metric: A
novel method to assess the overall performance of discrete brain-computer
interfaces,” IEEE Trans. Rehabil. Eng., vol. 18, no. 1, pp. 20–28, Feb.
2010.
[33] P. Yuan, X. Gao, B. Allison, Y. Wang, G. Bin, and S. Gao, “A study of
the existing problems of estimating the information transfer rate in online
brain-computer interfaces,” J. Neural Eng., vol. 10, art. no. 026014, 2013.
[34] G. Townsend, B. K. LaPallo, C. B. Boulay, D. J. Krusienski, G. E. Frye,
C. K. Hauser, N. E. Schwartz, T. M. Vaughan, J. R. Wolpaw, and E. W.
Sellers, “A novel P300-based brain-computer interface stimulus presentation paradigm: moving beyond rows and columns,” Clin. Neurophysiol.,
vol. 121, no. 7, pp. 1109–1120, 2010.
[35] G. Pires, U. Nunes, and M. Castelo-Branco, “Comparison of a row-column
speller vs. a novel lateral single-character speller: Assessment of BCI for
severe motor disabled patients,” Clin. Neurophysiol., vol. 123, no. 6, pp.
1168–1181, 2012.
[36] Y. Liu, Z. Zhou, and D. Hu, “Gaze independent brain-computer speller
with covert visual search tasks,” Clin. Neurophysiol., vol. 122, no. 7, pp.
1127–1136, 2011.
[37] G. Schalk, D. J. McFarland, T. Hinterberger, N. Birbaumer, and J. R.
Wolpaw, “BCI2000: A general-purpose brain-computer interface (BCI)
system,” IEEE Trans. Biomed. Eng., vol. 51, no. 6, pp. 1034–1043, Jun.
2004.
[38] J. Pan, X. Gao, F. Duan, Z. Yan, and S. Gao, “Enhancing the classification
accuracy of steady-state visual evoked potential-based brain–computer interfaces using phase constrained canonical correlation analysis,” J. Neural
Eng., vol. 8, art. no. 036027, 2011.
[39] G. Pfurtscheller, B. Z. Allison, C. Brunner, G. Bauernfeind, T. SolisEscalante, R. Scherer, T. O. Zander, G. Müller-Putz, C. Neuper, and
N. Birbaumer, “The hybrid BCI,” Front. Neurosci., vol. 4, no. 30, p. 00003,
2010.
[40] B. Z. Allison, C. Brunner, V. Kaiser, G. R. Müller-Putz, C. Neuper,
and G. Pfurtscheller, “Toward a hybrid brain-computer interface based
on imagined movement and visual attention,” J. Neural Eng., vol. 7,
p. 026007, 2010.
[41] J. Long, Y. Li, T. Yu, and Z. Gu, “Target selection with hybrid feature for
BCI-based 2-D cursor control,” IEEE Trans. Biomed. Eng., vol. 59, no. 1,
pp. 132–140, Jan. 2012.
[42] Y. Li, J. Pan, F. Wang, and Z. Yu, “A hybrid BCI system combining
P300 and SSVEP and its application to wheelchair control,” IEEE Trans.
Biomed. Eng., vol. 60, no. 11, pp. 3156–3166, Nov. 2013.
[43] T. Zeyl and T. Chau, “A case study of linear classifiers adapted using
imperfect labels derived from human event-related potentials,” Pattern.
Recogn. Lett., vol. 37, pp. 54–62, 2014.
[44] N. M. Schmidt, B. Blankertz, and M. Treder, “Online detection of errorrelated potentials boosts the performance of mental typewriters,” BMC
Neurosci., vol. 13, art. no. 19, 2012.

Erwei Yin was born in Heilongjiang, China, in 1985.
He received the B.Sc. degree from Jilin University,
Changchun, Jilin, China, and M.Sc. degree from the
National University of Defense Technology, Changsha, China, in 2008 and 2010, respectively. He is
currently working toward the doctoral degree in the
National University of Defense Technology.
His research interests include brain computer interfaces and machine learning.

Zongtan Zhou was born in Henan, China, in 1969.
He received the B.Sc., M.Sc., and Ph.D. degrees from
National University of Defense Technology, Changsha, China, in 1990, 1994, and 1998, respectively.
He was a Professor in 2007. His research
interests include brain–computer interface, cognitive neuroscience, image/signal processing, computer/biologicalvision and neural networks.

Jun Jiang was born in Zhejiang, China, in 1987.
He received the B.Sc. and M.Sc. degrees from National University of Defense Technology, Changsha,
China, in 2009 and 2011, respectively. He is currently
working toward the doctoral degree at the National
University of Defense Technology.
His research interests include brain computer interfaces and machine learning.

Yang Yu was born in Liaoning, China, in 1987. He
received the B.Sc. degree from Tianjin University,
Tianjin, China, in 2010, and the M.Sc. degree from the
National University of Defense Technology, Changsha, China, in 2012, where he is currently working
toward the Ph.D. degree.
His research interests include brain–computer interface, machine learning, and neuroimage.

Dewen Hu (SM’06) was born in Hunan, China, in
1963. He received the B.Sc. and M.Sc. degrees from
Xi’an Jiaotong University, Shaanxi, China, in 1983
and 1986, respectively. He received the Ph.D. degree
from the National University of Defense Technology,
Changsha, China, in 1999.
From 1986, he was with the National University of
Defense Technology. From October 1995 to October
1996, he was a Visiting Scholar with the University
of Sheffield, U.K. He was a Professor in 1996. His
research interests include cognitive science, brain–
computer interface, image processing and neural networks. He is an Action
Editor of Neural Networks.

