924

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

A Method for Reducing Secondary Field Effects
in Asymmetric MRI Gradient Coil Design
Elliot Smith∗ , Fabio Freschi, Maurizio Repetto, and Stuart Crozier

Abstract—Goal: This research introduces an original method for
the design of MRI gradient coils that reduces secondary field effects
created by eddy current coupling. The method is able to deal with
asymmetric coils and provides a new way to ensure a reduction
in the magnitude of the eddy current induced fields. Methods:
New constraints are introduced at the surface of passive objects to
bind the normal field component below a given value. This value is
determined by first treating the passive surface as an active surface,
and then, calculating the ideal stream function on that surface to
produce the desired secondary field. Two coils were designed, one to
image the knee and the other to image the head and neck. Results:
The secondary field was analyzed using linear regression and was
found to improve the secondary field from 10.41 to 0.498 mT/m and
from 7.84 to 0.286 mT/m in the examples used. The power loss in the
passive structure also decreased to below 1% of the original value
using the new method. Conclusion: The method shows the ability
to constrain the field to values below the minimum seen under
the traditional approaches. Significance: This will allow the design
of asymmetric systems with highly linear, reduced magnitude of
secondary fields and may lead to better image quality.
Index Terms—Eddy currents, integral method, magnetic resonance imaging (MRI), optimization.

I. INTRODUCTION
AGNETIC resonance imaging (MRI) makes use of gradient coils, which superimpose a spatially varying magnetic field, onto the primary magnetic field in order to provide
localization for the imaging of soft tissue samples [1]. Typically
an MRI machine will include one gradient coil for each of the
Cartesian axes (x, y, and z). These coils provide a uniform magnetic gradient within a small volume referred to as the region
of uniformity (ROU). Fig. 1 shows diagrammatic representation
of the major components of an MRI system as well as an example of current pathways for an actively shielded asymmetric
gradient coil.
At the core of gradient coil design is a tradeoff between
the desired magnetic field and competing parameters including

M

Manuscript received May 18, 2015; revised July 23, 2015; accepted September 7, 2015. Date of publication September 16, 2015; date of current version
May 19, 2016. This work was supported in part by MedTeQ (Qld), in part by the
Australian Research Council, and in part by the National Health and Medical
Research Council of Australia. Asterisk indicates corresponding author.
* E. Smith is with the School of Information Technology and Electrical Engineering, University of Queensland, St Lucia QLD 4067, Australia (e-mail:
e.smith9@uq.edu.au).
F. Freschi and M. Repetto are with the Department of Energy, Politecnico di
Torino, Torino, Italy and also with the School of Information Technology and
Electrical Engineering, University of Queensland.
S. Crozier is with the School of Information Technology and Electrical Engineering, University of Queensland.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2479230

resistance and inductance. Various methods have been created
in order to assist in the design of these coils. These methods
can be roughly broken into two categories, analytic models and
mesh based models. Analytic solutions are usually restricted to
simple, parameterizable, surfaces and include techniques such
as Fourier methods and target field methods [2]. Mesh-based
methods discretize surfaces into small, typically triangular, elements and form a basis function expressed at the nodes of each
element. These are often integral or integral shell methods, as
opposed to finite-element methods, as they allow volumes to be
modeled as one or more thin surfaces and do not require modeling of the surrounding air. Optimization parameters such as the
magnetic field, resistance and inductance are then calculated on
this basis. When paired with the correct boundary conditions,
this formulation can be suitably used for optimisation using
techniques such as quadratic programming [3]–[6]. This is in
comparison to direct inversion methods, which use a pseudoinverse or approximated pseudoinverse of the magnetization matrix in order to constrain the field. While this approach is proved
to lead to minimum error on the target field, other factors like
power loss, magnetic energy, force, torque, are not taken into
account [7]. While these mesh-based methods inevitably introduce inaccuracies through surface discretization they have the
advantage of being able to express complex geometries without
modifying the calculations.
Induced in conductive material in the presence of a time
varying magnetic field, eddy currents cause a number of issues
including power loss, increased heating, and a secondary magnetic field [8]. This secondary field can combine with the field
generated by the gradient coil and disrupt the gradient profile [9].
In response to these issues, numerous methods to compensate
for eddy current effects have been developed. Shielding, using
both passive structures to absorb energy, and active, current carrying, structures to negate these fields, are widely employed
[10]–[15]. The design of many shielded coils aims to minimize
the magnetic field at a number of target points usually on the
surface of additional passive structures such as the cryostat. This
constraint typically leads to a shield with a conductor pattern
similar to that of the primary coil but with the current direction
reversed in the windings. Many systems also utilize a method
known as preemphasis as a means to further compensate for the
field within the ROU produced by eddy currents in these additional passive structures [16]. Preemphasis models the eddy
current response as a linear time invariant system. The input
waveform is modified such that the resulting field from the coil
and the eddy currents combine to give a linear gradient [17],
[18]. As eddy currents are the sum of many spatially varying
functions this method is only viable within the same spherical

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

SMITH et al.: METHOD FOR REDUCING SECONDARY FIELD EFFECTS IN ASYMMETRIC MRI GRADIENT COIL DESIGN

925

Fig. 1. Diagram of MRI layout showing (a) major components within the MRI scanner and (b) conductive pathways on a cylindrical surface used to induce a
magnetic gradient useful for MRI (i.e., G y = ddByz ).

harmonics as the primary field. Other high-order harmonics become difficult to compensate for using preemphasis [16]. As
such, it is important to ensure that any eddy currents generated
produce a field as close in spatial profile to the desired gradient
as possible. This issue becomes more important in asymmetric coils, which typically perform more poorly than symmetric
coils. Asymmetric gradient coils are those in which the stream
function displays an asymmetry about the axial centre of the
coil. This most commonly occurs when the ROU is designed
to be at a location other than the centre of the coil. These coils
are used in the imaging of the neck and other peripheral regions
[19], [20]. In some coils, part of the ROU may lie close to or
beyond the edge of the surface. As such, there is no possibility
of providing windings over both sides of the ROU. This leads
to complicated winding patterns in many asymmetric coils [20].
Some asymmetric coils are designed to be part of a complete
asymmetric imaging system, while others are designed to be
inserted into the bore of regular MRI systems. There is some
conjecture as to how well eddy currents within asymmetric coils
can be modeled and compensated [19]–[22].
This research aims to investigate the eddy current behavior in
asymmetric gradient coils through numerical simulation. Once
this model has been established, a new method of design will
be presented to help deal with this behavior. This goal is to
match the eddy current and primary magnetic field profile and to
minimize power losses within the passive structure. The study
builds on methods for design and simulation that have been
shown to correctly model the behavior of eddy currents in thin
conductors [23], [24].
II. METHODS
A. Modeling
Let us consider a homogeneous unbounded 3-D domain with
filamentary coils with known currents and a conductive region

Fig. 2.

Vector basis function fk (r ) associated to the node k of the mesh.

V . Assuming magnetic quasistatic approximation, the current
density J in V is divergence free and can be described with
the electric vector potential T . The study is restricted to the
case when V can be approximated by 2-D curved surfaces S,
i.e., the current density lies on these surfaces. In this case, the
vector potential can be represented as the scalar stream function,
defined as T = n(r )ψ(r ) [25], where n is the unit normal to
the current density plane. The stream function is expanded by
nodal shape functions λk so that the current is interpolated by
piece-wise constant vector basis functions fk (r )
 r) =
J(

N

k =1

ψk ∇ × (λk (r )n(r )) =

N


ψk fk (r )

(1)

k =1

where ψk is the value of the stream function at the N mesh
nodes. In case of triangular discretization, in the generic αth
triangle having k as vertex, it can be proved that


1
(α )
(α )
(α )
e
(2)
fk (r ) = ∇ × λk (r )n (α ) (r ) =
2S (α ) k
ek is the vector corresponding to the edge opposite to node k
(see Fig. 2), and Aα is the triangle area. Fig. 2 shows a graphical
representation of the vector shape function fk .

926

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Using the Green’s function, the electric field in the frequency
domain can be expressed as

 r)
 r )
J(
J(
μ0
 s (r ) (3)
+ jω
dS + ∇ϕ = −jω A
δ(r )σ(r )
4π S  |r − r  |
being r the vector pointing to the source point, r the vector
 s (r ) the magnetic vector popointing to the field point and A
tential due to the known sources in Vs . δ(r ) and σ(r ) are the
thickness and conductivity of the surface S
The equality (3) is imposed in average over the entire surface
domain S, using fj (r ) as test function, resulting in a Galerkin
scheme
N


(Rj k + jωLj k ) ψk = −jωas,j

(4)

k =1

where the resistive, inductive, and source terms are, respectively

1
Rj k =
(5)
fj (r ) · fk (r )dS
δ(
r
)σ(
r)
S


1
μ0
fk (r  )dSdS
(6)
Lj k =
fj (r ) ·
4π S
r − r  |
S  |

 s (r )dS.
as,j
(7)
fj · A
S

If the number of test functions fj (r ) is chosen equal to the
number of nodal unknowns, a N × N system of linear equation
is obtained. The magnetic flux density is then calculated directly
from the stream function value.
B. Traditional Method
The process of generating an ideal stream function solution
is a minimization problem outlined as
minimize λ1 ψ T Lψ + λ2 ψ T Rψ
subject to (1 − η1 )B0z (r) ≤ Mz ψ ≤ (1 + η1 )B0z (r)
−Bs ≤ Ms ψ ≤ Bs

(8)

where λ1 and λ2 are optimization weighting factors, η1 is an
error weighting factor, B0z (r) is the z component of the target
field within the ROU, Mz is the magnetization matrix for each
target point within the ROU, Bs is the field limit at shielding
target points, and Ms is the magnetization matrix calculated
at these points. As the matrices L and R contain values of
differing units some normalization must occur. This can take
place within the matrices themselves or by appropriately scaling
the two weighting factors λ1 and λ2 . The first constraint ensures
the magnetic field conforms to the desired gradient within some
error bounds. The second constraint aims to limit field strength
at control points to be below some given value. Typically Bs is
a vector in which each element has the same value regardless
of position. Multiple constraints may be used to limit the field
strength at different locations. When the constraint points lie
on a passive surface, such as the surface of a cryostat, these
values are not a function of the surface geometry or the desired
secondary stream function. Alongside this, the magnetization
matrix Ms is formed such that the magnitude of the magnetic

field is reduced regardless of its direction. This combination of
the minimization of field magnitude and uniform bounds will
be referred to as the traditional method. The shortcoming of this
traditional method is its reliance on the geometric symmetry of
the problem. By equally constraining the magnetic field at target
points generated by each node there is implicit weight given to
the nodes in the centre of the passive surface. This is caused as
the coils are of finite length and nodes toward the ends of the
coil have, on an average, a greater distance to all the other nodes
in the system. This does not cause an issue in symmetric coils
as this behavior is symmetric about the centre of the ROU, and
hence, the centre of the volume. In asymmetric coils, there is
increased weight of nodes to one side, this does not reflect the
node’s distance from the ROU, which is the primary concern
during this optimization. This leads to suboptimal linearity of
the secondary field as this section, often far from the ROU is
over constrained. Moreover, there is no constraint on the spatial
profile of the eddy currents induced in the passive structure.
C. Method Improvements
For eddy currents to produce a given field profile their spatial variation needs to be constrained. This can be achieved by
weighting the points in Bs in proportion to a stream function
calculated on that surface. This stream function is found by
considering the passive structure as active and determining a
solution that produces a field with the desired spatial profile.
This stream function, calculated on the passive surface shall
be referred to as ψ p . The result of this passive surface optimization becomes a constraint later in the second optimization,
which determines the coil geometry. This stream function is
then normalized so that all values are on the interval [−1, 1].
This stream function is then used to constrain the field strength
at the target points on the surface of the passive structure. As
the magnetic flux density is often bound between a minimum
and maximum value, the absolute magnitude of this normalized
stream function is used
 
 
 
 
(9)
−η2 Bs ψˆp  ≤ Ms ψ ≤ η2 Bs ψˆp 
where ψ̂ p is the normalized stream function calculated to give
a linear secondary field.
Supplement to this the minimization of the total field strength
at the surface of the passive structure through the magnetization
matrix Ms is not indicative of the resulting eddy currents produced in that structure. Eddy currents are produced proportional
to the field in the direction of the surface normal. As such, the
field in the direction of the surface normal provides a better
indicator of eddy current behavior when target points lie on the
surface of a passive structure. Calculation of the field in the
direction of the surface normal is achieved by first calculating
the field in the x, y, and z direction. These calculations form
three matrices in which each row relates to one target point. For
points that are on the surface of a passive structure these rows
are then combined with weights proportional to the x, y, and z
components of the surface normal.
Combining these two observations gives rise to a new set of
constraints that will be referred to as the surface normal flux

SMITH et al.: METHOD FOR REDUCING SECONDARY FIELD EFFECTS IN ASYMMETRIC MRI GRADIENT COIL DESIGN

density penalization method (SNFDP).
 
 
 
 
−η2 Bs ψˆp  ≤ Mn ψ ≤ η2 Bs ψˆp 

927

TABLE I
KNEE COIL DIMENSIONS AND PROPERTIES

(10)
Surface

where row j of the matrix Mn is defined as

Primary
Secondary
Passive

Mn ,j = n̂x · Mx,j + n̂y · My ,j + n̂z · Mz ,j .

Radius (mm)

Length (mm)

Resistivity (Ωm)

110
126
152.5

624
624
660

1.68e-8
1.68e-8
2.82e-8

D. Coil Performance Metrics
In order to constrain the eddy currents and leakage field outside the gradient coil, a set of points are chosen, often on or near
a passive surface. The magnitude of the magnetic field is minimized at these points [10] and the field is generally bound to be
below a certain value. In the case of secondary field analysis,
these points are the same as those used to constrain the primary
field. This allows a shielding ratio to be defined as a measure of
eddy current effects as expressed in (11) as the ratio between the
maximum field generated by the coil within the ROU compared
to the field produced by the passive structures.
η=

max(Bsecondary )
.
max(Bprim ary )

(11)

Another common measure of gradient coil performance is the
linearity of field produced by the passive structures. This can be
achieved by fitting the resulting field to a linear model. Comparing the coefficient of determination r2 value between multiple
coil designs gives an indication of the linearity of the field.
Additionally spherical harmonics can be used to determine the
spatial modes present. The field is to be evaluated over the surface of a sphere and Ylm is the harmonic of degree l and order
m
Ylm (θ, φ) = Nlm e jm φ Plm (cos θ)

(12)

where N is a scaling factor defined as


2l
+
1
(l − m)!
Nlm = −1m
4π
(l + m)!
and Plm (cos θ) is the associated Legendre polynomial. A function’s weight in any given harmonic mode is calculated in accordance with (13). Here, the domain Ω represents the surface
of the sphere on which the harmonics are to be calculated.

m
f (θ, φ)Ylm ∗ (θ, φ) dΩ.
(13)
cl =
Ω

A measure of which spherical harmonics are present in the
secondary field, is the ratio of the secondary to primary harmonics expressed as
	

c2secondary
.
(14)
=
cprim ary
In heat-sensitive applications, such as cold shields in super
conducting magnets, any increase in temperature must be minimized. The power loss within a structure gives an indication of
the resulting temperature rise and is often used as a figure of
performance in gradient coil design. Power loss within a passive

Fig. 3.

Knee coil system layout.

structure is calculated as
1 
ψp Rp ψp .
(15)
2
In which, ψp is the stream function in the passive structure and
Rp is the resistance matrix of the passive structure. The power
loss within the surrounding passive structure was calculated and
compared for both methods.
To test this method, two coils were designed and numerically
evaluated under both the traditional and new methods. The first
coil was chosen to provide imaging of the knee in an asymmetric
system. In this coil, the ROU was chosen to be a warped sphere
with a radius of 75 mm along the axial direction and a radius
of 120 mm along the z direction. The entire ROU was shifted
90 mm along the z direction. For the purposes of evaluating the
spherical harmonics present within the field, a spherical ROU
of radius 75 mm was used. The size of the surfaces, two active and one passive, are defined in Table I. All surfaces had a
thickness of 2.5 mm. Fig. 3 shows the layout of the surfaces
and the ROU. The second coil was designed to image the head
and neck region. This coil featured an ROU with a length of
160 mm along the z direction and a radius of 120 mm. The
entire ROU was shifted 70 mm from the centre along the axial
direction. For the evaluation of spherical harmonics, a spherical
ROU with a radius of 80 mm was used. The size of the surfaces
is described in Table II. All surfaces had a thickness of 2.5 mm.
Fig. 4 shows the layout of the surfaces and the ROU for the
head and neck coil. The short aspect ratio between the length
P =

928

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

TABLE II
HEAD AND NECK COIL DIMENSIONS AND PROPERTIES
Surface
Primary
Secondary
Passive

TABLE III
RESULTING FIELD FIT

Radius (mm)

Length (mm)

Resistivity (Ωm)

Coil

Method

Gradient (mT/m)

Offset (mT)

r2

150
172
208

480
480
508

1.68e-8
1.68e-8
2.82e-8

Knee

Traditional
SNFDP
Traditional
SNFDP

−10.41
−0.498
−7.842
−0.286

−1.67e-5
−2.19e-4
−5.15e-5
−2.33e-5

0.9818
0.9591
0.9773
0.9761

Head

TABLE IV
MAGNETIC FIELD RATIO
Coil
Knee coil
Head and neck coil

Traditional Method

SNFDP Method

0.289
0.215

0.015
0.008

A. Linearity of Secondary Field

Fig. 4.

Head and neck coil system layout.

and the diameter generally causes lower performance. This coil
was added to test how the changes apply to difficult coils. All
coils were be designed to produce a primary field of 40 mT/m
along the x-axis and the maximum value of the field at any of
the shielding points was constrained to 0.1 mT. Both λ1 and λ2
were given values of 100 and 1 on the normalized matrices R
and L, respectively. Primary field deviation (η1 ) was restricted
to a maximum of 1% within the ROU. The eddy currents in
the passive surface were calculated using an input waveform
frequency of 1 kHz. All metrics were calculated on the continuous solution to avoid biases due to any particular discretization method. When comparing the discretized current pathways,
all coils were split into 21 contours of the resulting stream
function.
III. RESULTS
All simulations were undertaken using MATLAB R2013b on
a machine with an Intel Xeon 3.5-GHz processor and 64 GB of
RAM. Each of the three cylinders was discretized using 3080
triangles and 1610 nodes. The ROU was constrained using 642
points on the surface of the volume. Shielding was constrained
using the nodes on the outer passive surface giving 1610 constrained points. Each coil was designed and modeled within
300 s.

The secondary field produced by the passive structure was fit
to a first-order polynomial using linear regression. The gradient,
offset, and the adjusted r2 value of the fit for both the traditional
and surface normal flux density penalization method appear
in Table III. These results show that all methods produced a
linear secondary field with these constraints. The secondary field
values are, however, significantly lower in the new method. This
is an improvement toward the ideal, which is either no secondary
field or a small secondary field with the same spatial distribution
as the primary field. The offset in both cases is small enough to
be noted as negligible, however, the traditional method results
in smaller values for this offset in the knee coil and larger values
in the head and neck coil.
The shielding ratio calculated in accordance with (11) was
determined for both methods. The ratios for both coils, using
both methods is presented in Table IV. This ratio shows the
magnitude of eddy currents produced at a given gradient and is
independent of the current used in the coil. In both cases, the
new method produces a smaller peak secondary field ratio. In
the knee coil, the new method reduced the ratio by 94.8%. In
the head and neck coil, the ratio was reduced by 96.7%. This
reduction in the secondary field shows the ability of the new
method to remove undesirable eddy current effects.
B. Spherical Harmonics
An analysis of the spherical harmonics present in the ROU
helps to determine the ability of the system to compensate for
eddy current distortions. Eddy currents in the same harmonic
as the primary field can be compensated for using preemphasis
while other low-order harmonics can be accounted for using
shim coils. Reduction of harmonics outside of the primary harmonic helps to lessen the effects of eddy currents on the image.
Under both methods, the harmonics up to the degree and order
Y55 were calculated. As the coil was designed as an x gradient
the real component of the harmonic Y11 was the primary harmonic. Table V shows the ratio of energy within the primary
and secondary harmonics up to Y55 under both methods. This
was calculated in accordance with (14). In the knee coil, the

SMITH et al.: METHOD FOR REDUCING SECONDARY FIELD EFFECTS IN ASYMMETRIC MRI GRADIENT COIL DESIGN

929

TABLE V
RATIO OF SECONDARY TO PRIMARY HARMONICS
Coil

Method

Harmonic Ratio (%)

Knee

Traditional method
SNFDP method
Traditional method
SNFDP method

21.13
13.02
39.65
42.08

Head

TABLE VI
POWER LOSS IN THE PASSIVE STRUCTURE
Coil

Method

Power Loss (W)

Knee

Traditional method
SNFDP method
Traditional method
SNFDP method

46.20
0.088
70.75
0.082

Head

Fig. 5.

Power loss in the passive structure under both methods (knee coil).

harmonic ratio was reduced by 38%. Analogous to total harmonic distortion, this ratio shows the new method more efficiently produced the primary harmonic for a given input of
power. In the head and neck design, both coils produced a large
proportion of secondary harmonics. The traditional method performed slightly better than the new method in this case.
C. Power Loss
Table VI shows the calculated power loss for the coils using
both methods. Here, the power can be seen to be significantly
reduced in both cases under the new method. This reduction in
power loss can be critical to the performance of MRI systems.
D. Sensitivity to Constraints
In order to determine the sensitivity of both methods to the
secondary field constraint, the design and modeling was repeated using 40 constraint values ranging between 1 mT and
1 μT. Fig. 5 shows the calculated power loss in the passive structure of the knee coil design. The power is, in all cases, reduced
in the new method. The traditional method appears to reach a
threshold, after which the power begins to increase again. This

Fig. 6. Power loss in the passive structure for a symmetric and asymmetric
coil (traditional Method).

Fig. 7.

Shielding ratio calculated under both methods (knee coil).

increase in power at low constraints was not observed in the new
method over the tested range. There is also no clear link between
the secondary field constraint and the power loss, which makes
optimization of such parameters difficult. The new method however, continues to decrease in power as the constraint is lessened,
which makes it a good choice for gradient descent-based optimization methods, which are commonly used in MRI gradient
coil design.
Fig. 6 shows the power loss under the traditional model for
a symmetric and asymmetric knee coil. The symmetric coil has
the same constraints as the asymmetric coil but with no offset to
the ROU. This comparison highlights the difficulty of designing
asymmetric coils. The rise in power loss at low constraints is
not seen in the symmetric design.
Fig. 7 shows the calculated shielding ratio for both methods.
Again the new method exhibits a decrease at all points. This
decrease in shielding ratios indicates the lessened effects of
eddy currents within the ROU, which helps to ensure images
are free from distortion. Under both methods, the primary field
was constrained to 1% error and all tests gave a primary field r2
value of 0.999 or higher.

930

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

Fig. 8.

Resulting 21 turn current pathways for (a) traditional and (b) SNFDP method (knee Coil) using 1 mT constraint.

Fig. 9.

Resulting 21 turn current pathways for (a) traditional and (b) SNFDP method (knee Coil) using 1 μT constraint.

E. Resulting Current Pathways
While the numeric performance of any design is important,
it must be judged against the ability for the coil to be fabricated. Some designs may provide strong numerical results but
are not realizable due to the resulting complex current pathway.
To determine the ability of both methods to create useful coil
designs, the solution was contoured at 1 mT and 1 μT. Coils
used 21 contours to determine current pathway. The resulting
current under the old method was 293 A at 1 mT and 585 A at
1 μT. The resulting current under the new method was 438 A
at 1 mT and 630 A at 1 μT. Fig. 8 shows the primary windings for both the old and traditional method using a constraint
of 1 mT. The colors indicate the two different directions of the
current through the conductors. There are some differences in
the layout of the pathways especially around the centre line of
each winding group. Both coils at this constraint show smooth

turns and distinct contour layout enabling them to be easily fabricated. Fig. 9 shows the same 21 contour pathway using the
constraint of 1 μT. Here, there is a significant difference between the two windings. The traditional method produces a coil
with complex layouts and small degenerate loops in the upper
section of the coil. Such a coil would not be fabricated in reality
and this limits the usefulness of the traditional method at such
low constraint values. The new method, however, continues to
produce smooth winding patterns even at the smaller constraint.
While there is indeed some difference between the low and high
constraint design in the new method both coils remain feasible
for construction.
IV. DISCUSSION
The aim of this research was to improve the linearity of any
secondary field produced in asymmetric coils. The coil designed

SMITH et al.: METHOD FOR REDUCING SECONDARY FIELD EFFECTS IN ASYMMETRIC MRI GRADIENT COIL DESIGN

under the new method performed better than the traditional design in terms of reducing the negative effects of eddy currents.
While the harmonics ratio was less in the head and neck coil
example under the new method, this was relative to the field
strength. Taking these values as absolute, the new method continued to outperform the traditional method in all cases. Much
of the resulting field in both cases was within the primary harmonic that allows for the effective use of preemphasis help in the
reduction of eddy current related distortion. While the magnitude of this field is much lower than the 40-mT/m primary field,
this secondary field could cause distortion in the image along
the slice selection direction. Due to the nature of the distortions
caused and their effect on the signal, it is difficult to correct for
these distortions after the signal has been acquired. The power
loss due to eddy currents is an important factor in the design of
MRI gradient coils. This power loss can lead to a temperature
rise in passive conductive surfaces. The proposed improvements
to the traditional method are seen to reduce the power loss in the
passive structure. The traditional method showed no useful link
between the constraint value and the eddy current power loss,
which makes it difficult to use this method for gradient-based
optimization methods. This issue was not seen in the symmetric
case and highlights the difficulties associated with the design
of asymmetric coils. The proposed method alleviates this issue,
presenting a power loss that decreases with the secondary field
constraint value.
The current pathways produced by both methods were seen to
be acceptable when the values of the field constraint was high.
At low constraint values, however, the traditional method produced poor quality current pathways. These impractical winding
configurations occur as the constrains on the secondary field are
increased. As the optimization limits the field deviation while
minimizing the power and inductance, the solution is over constrained. As such, the solution creates small local loops that
ensure the field profiles match as the expense of a smooth solution. It would be possible to construct a coil from this pattern with further processing on the design, however, this would
move the performance away from the reported results. As the
proposed method does not require such intervention, it shows
that this new method provides a superior optimisation method
as simulated results match closely to the physical coil with less
need for tuning and secondary simulation of the cleaned coil
design.
The changes made in the new method add very little to the
computational complexity of the simulation. The largest additional cost in complexity comes from the calculation of the
stream function on the passive structure. Traditionally, this step
is only done after the optimization as an evaluation of the results.
Here, an ideal stream function is calculated prior to optimization. The true stream function can still be calculated after the
optimization. While this adds numerical complexity to the simulation, it is a simple matter of reclassifying the surfaces and
running an existing solver on the resulting system. The switch to
using the surface normal over the total field strength is achieved
through a dot product between the surface normal and magnetic field vector. The surface normal will be calculated at the
barycenter of a triangular element rather than on the node. To

931

give the nodes a value for the normal, the average of the normals
of all connected triangles can be used.
The constraints introduced in this research aim to improve the
coil performance when points on a passive structure are used
as control points. It is possible to combine these constraints
with traditional constraints at other points in the system. As
an example, the field at some distance outside the system may
need to be constrained for safety reasons. Introducing these
additional control points does not affect the inclusion of the
constraints outlined in this method.
The model presented here was tested with only one passive
structure. In the presence of multiple passive structures, the
coupling between these structures is not accounted for. This
introduces some inaccuracies into the model, however, as the
secondary field within the ROU tends to be an order of magnitude smaller than that of the primary field. Any field created
through a coupling other than from the primary field would
contribute very little to the field within the ROU.
While the methods presented were introduced to improve
the performance of asymmetric coils, there may be scenarios
in which these changes benefit the design of symmetric coils.
Some systems feature an asymmetry in the passive structures
present within the coil or feature a combination of symmetric
and asymmetric gradients. In these cases, the system’s asymmetry may benefit from the constraints introduced here.
V. CONCLUSION
This study shows a new method to reduce the secondary field
effects when designing asymmetric gradient coils. The method
shows a reduction in secondary field strength as constraints decrease, which is not seen in the traditional method. The coils
produced using this method show a more feasible resulting design when constraints are limited to low values. This study
allows asymmetric gradient coils to be designed with higher
performance metrics. This is of interest to systems designed for
the imaging of regions such as the knee or head and neck.
REFERENCES
[1] P. T. Callaghan, Principles of Nuclear Magnetic Resonance Microscopy,
Oxford, U.K.: Clarendon Press, 1991, vol. 3.
[2] R. Turner, “Minimum inductance coils,” J. Phys. E, Sci. Instrum., vol. 21,
no. 10, pp. 948–952, 1988.
[3] H. S. Lopez et al., “Equivalent magnetization current method applied to
the design of gradient coils for magnetic resonance imaging,” IEEE Trans.
Magn., vol. 45, no. 2, pp. 767–775, Feb. 2009.
[4] M. Poole and R. Bowtell, “Novel gradient coils designed using a boundary
element method,” Concepts Magn. Resonance B, Magn. Reson. Eng.,
vol. 31, no. 3, pp. 162–175, 2007.
[5] S. Pissanetzky, “Minimum energy MRI gradient coils of general geometry,” Meas. Sci. Technol., vol. 3, no. 7, p. 667, 1992.
[6] G. N. Peeren, “Stream function approach for determining optimal surface
currents,” J. Comput. Phys., vol. 191, no. 1, pp. 305–321, 2003.
[7] M. Abe, “A design technique of MRI active shield gradient coil using node
current potentials and triangular finite elements,” IEEE Trans. Magn.,
vol. 50, no. 10, pp. 1–11, Oct. 2014.
[8] G. Ries, “Eddy current transients and forces in cryostat walls of superconducting solenoids,” IEEE Trans. Magn., vol. 24, no. 1, pp. 516–519, Jan.
1988.
[9] A. Trakic et al., “Analysis of transient eddy currents in MRI using a
cylindrical FDTD method,” IEEE Trans. Appl. Supercond., vol. 16, no. 3,
pp. 1924–1936, Sep. 2006.

932

[10] J. Carlson et al., “Design and evaluation of shielded gradient coils,” Magn.
Reson. Med., vol. 26, no. 2, pp. 191–206, 1992.
[11] R. Turner, “Gradient coil design: A review of methods,” Magn. Reson.
Imag., vol. 11, no. 7, pp. 903–920, 1993.
[12] P. Mansfield et al., “Active acoustic screening: Reduction of noise in
gradient coils by lorentz force balancing,” Magn. Reson. Med., vol. 33,
no. 2, pp. 276–281, 1995.
[13] P. Mansfield and B. Chapman, “Active magnetic screening of coils for
static and time-dependent magnetic field generation in NMR imaging,”
J. Phys. E, Sci. Instrum., vol. 19, no. 7, pp. 540–545, 1986.
[14] I. C. Atkinson et al., “Characterization and correction of system delays
and eddy currents for MR imaging with ultrashort echo-time and timevarying gradients,” Magn. Reson. Med., vol. 62, no. 2, pp. 532–537, 2009.
[15] R. Turner and R. Bowley, “Passive screening of switched magnetic field
gradients,” J. Phys. E, Sci. Instrum., vol. 19, no. 10, pp. 876–879, 1986.
[16] C. Boesch et al., “Temporal and spatial analysis of fields generated by eddy
currents in superconducting magnets: Optimization of corrections and
quantitative characterization of magnet/gradient systems,” Magn. Reson.
Med., vol. 20, no. 2, pp. 268–284, 1991.
[17] H. M. Gach et al., “A programmable pre-emphasis system,” Magn. Reson.
Med., vol. 40, no. 3, pp. 427–431, 1998.
[18] P. Jehenson et al., “Analytical method for the compensation of eddycurrent effects induced by pulsed magnetic field gradients in NMR systems,” J. Magn. Reson. (1969), vol. 90, no. 2, pp. 264–278, 1990.
[19] D. C. Alsop and T. J. Connick, “Optimization of torque-balanced
asymmetric head gradient coils,” Magn. Reson. Med., vol. 35, no. 6,
pp. 875–886, 1996.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 5, MAY 2016

[20] B. A. Chronik et al., “Design and fabrication of a three-axis edge ROU
head and neck gradient coil,” Magn. Resonance Med., vol. 44, no. 6,
pp. 955–963, 2000.
[21] C. Meier et al., “Concomitant field terms for asymmetric gradient coils:
Consequences for diffusion, flow, and echo-planar imaging,” Magn. Reson. Med., vol. 60, no. 1, pp. 128–134, 2008.
[22] H. Sanchez et al., “A simple relationship for high efficiency–gradient
uniformity tradeoff in multilayer asymmetric gradient coils for magnetic
resonance imaging,” IEEE Trans. Magn., vol. 43, no. 2, pp. 523–532, Feb.
2007.
[23] F. Tang et al., “Skin and proximity effects in the conductors of
split gradient coils for a hybrid Linac-MRI scanner,” J. Magn. Reson.,
vol. 242, pp. 86–94, 2014.
[24] H. Sanchez Lopez et al., “Multilayer integral method for simulation
of eddy currents in thin volumes of arbitrary geometry produced by
MRI gradient coils,” Magn. Reson. Med., vol. 71, no. 5, pp. 1912–1922,
2014.
[25] A. Kameari, “Transient eddy current analysis on thin conductors with
arbitrary connections and shapes,” J. Comput. Phys., vol. 42, no. 1,
pp. 124–140, 1981.

Authors’ photographs and biographies not available at the time of publication.

