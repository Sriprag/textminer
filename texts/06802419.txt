IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

2167

Nonlinear State-Space Modeling of Human
Motion Using 2-D Marker Observations
Paavo Vartiainen*, Timo Bragge, Jari P. Arokoski, and Pasi A. Karjalainen

Abstract‚ÄîA novel method for the estimation of human kinematics, based on state-space modeling, is proposed. The state consists of
the positions, orientations, velocities, and accelerations of an articulated model. Estimation is performed using the unscented Kalman
filter (UKF) algorithm with a fixed-interval smoother. Impulsive
acceleration at floor contact of the foot is estimated by implementing a contact constraint in the UKF evolution model. The constraint
inserts an acceleration impulse into the model state. The estimation method was applied to marker-based motion analysis in a
motion laboratory. Validation measurements were performed with
a rigid test device and with human gait. A triaxial accelerometer
was used to evaluate acceleration estimates. Comparison between
the proposed method and the extended Kalman smoother showed
a clear difference in the quality of estimates during impulsive accelerations. The proposed approach enables estimation of human
kinematics during both continuous and transient accelerations.
The approach provides a novel way of estimating acceleration at
foot initial contact, and thus enables more accurate evaluation of
loading from the beginning of the floor contact.
Index Terms‚ÄîHuman motion analysis, initial peak acceleration,
motion laboratory, unscented Kalman filter (UKF).

I. INTRODUCTION
AMERA-BASED motion capture systems are nowadays
increasingly utilized in the entertainment industry, in traffic applications, and also in clinical motion analysis. One widely
used method for human motion capture is the use of reflective
markers mounted on the skin. By using multiple cameras, the
position of body segments in three-dimensional (3-D) space can
be recovered. During the past few years, a considerable amount
of research has been carried out on methods that do not require
markers [1]‚Äì[4]. However, marker-based protocols are more reliable in clinical motion analysis, since they can capture the
motion of the body segments more accurately than markerless
methods [5].
Using a calibrated multiple camera system, the motion of
the markers in 3-D space is recorded. The marker observations

C

Manuscript received February 5, 2013; revised April 4, 2014; accepted April
11, 2014. Date of publication April 18, 2014; date of current version June 14,
2014. This work was supported by the strategic funding of the University of
Eastern Finland, under Grant 5960431 from Kuopio University Hospital, and
by the Academy of Finland under Project 252748.
*P. Vartiainen is with the Department of Applied Physics, University of
Eastern Finland FI-70211, Kuopio Finland (e-mail: paavo.vartianen@uef.fi).
T. Bragge and P. A. Karjalainen are with the Department of Applied
Physics, University of Eastern Finland FI-70211, Kuopio Finland (e-mail:
timo.bragge@uef.fi; pasi.Karjalainen@uef.fi).
J. P. Arokoski is with the Department of Physical and Rehabilitation Medicine,
Kuopio University Hospital FI-70211, Kuopio Finland, and also with the Institute of Clinical Medicine, University of Eastern Finland FI-70211, Kuopio
Finland (e-mail: jari.arokoski@kuh.fi).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org
Digital Object Identifier 10.1109/TBME.2014.2318354

on the camera image planes have to be identified to make reconstructions in 3-D space. Not all the markers are visible to
all cameras, and visibility also varies during human movement.
Marker observations on the cameras may also overlap, which
makes the identification procedure even more challenging.
Traditional motion capture methods, which are based on reconstructions of the 3-D coordinates of individual markers [6],
[7], have several weaknesses. Inaccuracies in marker detection
may cause high frequency noise in resulting trajectories. A sudden jump in marker trajectory may also occur when the cameras
observing a marker change. The coordinate values have to be
low-pass filtered to suppress noise, which may further distort
trajectories. In traditional methods, the pose of each segment
is directly determined by the observations, and thus the pose is
affected by inaccuracies in marker detection. Missing observations are often treated by simply interpolating coordinate values
separately, which may lead to unrealistic marker trajectories in
3-D space. A major problem in the camera-based motion analysis is soft tissue artifact [8], [9].
In biomechanical studies, motion capture provides input data
for inverse dynamics calculations, which yield estimates for
joint loadings. To accurately compute joint moments and forces,
accelerations of segments are needed. Traditionally, accelerations are acquired by differentiating position data twice, which
enhances high-frequency noise, and hence acceleration estimates have to be low-pass filtered. Low-pass filtering suppresses
rapid changes, and thus impulsive accelerations are not estimated correctly [10].
Model-based approaches [11], [12] have been developed for
recovering human pose from camera observations. An articulated multisegment model is defined in 3-D space; segments
that have specific dimensions represent major body parts. Fixed
points, so-called anchor points, are defined in the model to correspond to the marker locations in the measurement. The model
dimensions and locations of anchor points can be defined in calibration measurements. In contrast to traditional methods, these
methods simultaneously utilize all the marker observations. A
model-based method is not as sensitive to temporarily missing
data as traditional methods.
By combining state estimation with model-based motion
tracking, the kinematics of model segments can be estimated
simultaneously. A set of parameters that determine poses, velocities, and accelerations of model segments form a kinematic state. This time-varying state can then be estimated,
for example, by the Kalman filter [13] or smoother [14]. The
Kalman filter is based on a state evolution model and observation model [15], [16]. At every time step, the state evolution
model receives the previous state estimate as an input and gives

0018-9294 ¬© 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2168

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

a prediction of the state. After this, the observation model is
used to update the prediction based on observations of the time
step. The filter can estimate a state that is not observed directly,
since the observation model maps the state to the observable
space. For instance, camera calibration models can be included
in the observation model, which helps to utilize observations
on camera image planes [12] at the current time instant. Parameters of the Kalman filter determine how quickly values of
the estimates can change, and how observations are weighted
in estimation. An additional improvement to the algorithm is
the Kalman smoother [14], [17], which uses measurement data
from the past and from the future in the estimation.
In earlier studies, applicable to clinical motion analysis, the
Kalman filter evolution model and filter parameters have been
selected so that the estimates are smooth, i.e., only slow changes
in the state are possible [12], [14]. Smooth estimates are desirable when there are no rapid changes in motion. However,
natural motion includes rapid changes during collisions or, for
example, at the initial foot contact with the floor. During these
events, the accelerations may have very large values that radically differ from the past values. Previously published methods
are not capable of reliably estimating kinematics during these
kinds of impulsive accelerations.
The Kalman filter-based method may provide meaningful estimates during impulsive acceleration, if the predict step yields
an acceleration prediction that is radically different than the previous estimate. This type of behavior can be achieved by using
a nonlinear state evolution model. The description of 3-D orientations and body model formulation also introduce nonlinearities into the estimation. Earlier methods have used the extended
Kalman filter (EKF) to handle nonlinearities. However, the EKF
is based on linearization of functions and it cannot therefore reliably handle strongly nonlinear functions. A better approach to
handle arbitrary nonlinear functions in connection with Kalman
filter is unscented transformation (UT) [18].
In this study, a state estimation method for human motion
tracking is proposed. The method is based on unscented Kalman
filter (UKF) and smoother algorithms. As a novel part of the
method, a contact constraint that generates an impulsive acceleration has been implemented in the UKF evolution model. The
constraint enables meaningful estimates of the state during large
accelerations in collisions. The model has been parameterized
using unit quaternions, angular velocities, and accelerations.
Our approach is validated in measurements with both a rigid
body and human gait by comparing and acceleration estimates
with measured accelerations during initial contact and by examining 3-D trajectories of estimates.
II. THEORY AND SET UP FOR MOTION ESTIMATION
In this section, the presentation of 3-D orientation is first
introduced. Then, a hierarchical, multisegment model, suitable
for human motion modeling, is introduced. Model kinematics
is stacked in a vector that can be used in estimation algorithms.
A method for handling the statistics of nonlinear functions, UT,
is introduced in the Appendix. The most essential algorithm of
the proposed method is an implementation of the UKF, which is

used to estimate the kinematics of the multisegment model. The
contact constraint is implemented in the UKF inside the evolution model. The implementation of unscented fixed-interval
smoother is briefly reported. The focus is kept on the practical
implementation of the algorithms.
A. Presentation of Orientation
In 3-D motion tracking, orientations of segments are essential,
and transformations between segment and laboratory coordinate
systems are made.
An orientation in 3-D space can be seen as a rotation from a
reference orientation. A rotation of angle Œ∏ around a unit vector
e can be expressed as a rotation vectorwq ,wq = Œ∏e. Rotation
vectors are not practical when rotations have to be applied or
combined. Instead, the unit quaternions are more applicable.
Quaternions consist of one scalar and three imaginary components, and they have their own algebra [19]. Unit quaternions
offer an unambiguous and singularity-free way of presenting
3-D rotations.
Even though unit quaternions have four components, they
have only three degrees of freedom, since the norm is constrained to be one. Thus, the components of a unit quaternion
are not independent, and quaternions cannot be directly used
in the KF algorithm. Therefore, quaternions have to be converted, for instance, to the rotation vectors for the Kalman filter
equations.
The unit quaternion corresponding to a rotation vector w
 q is
[20]

 
 
Œ∏
Œ∏
q = cos
, esin
.
(1)
2
2
For combining rotations quaternion multiplication is used.
The multiplication q3 = q2 q1 is equivalent to rotation q1 followed by q2 . The opposite rotation to the quaternion q is described by conjugate q ‚àí1 [19]


q ‚àí1 = q(1) ‚àíq(2) ‚àíq(3) ‚àíq(4) .
(2)
The relative rotation qrel of q1 and q2 , i.e., difference between
the two orientations is defined as follows:
qrel = q2‚àí1 q1 .

(3)


A quaternion q = q(1) q(2) q(3) q(4) is converted to a rotation vector w
 q by the following calculations:


vq = q(2) q(3) q(4)


vq 
Œ∏ = 2 arctan
q(1)
w
q = Œ∏

vq
.
vq 

(4)

B. Hierarchical Multisegment Model
A system consisting of rigid segments jointed together can
be parameterized as a hierarchical model: the position (r0 ) and
the orientation (q0 ) of a base segment are defined in a laboratory reference frame and the positions of other segments are

VARTIAINEN* et al.: NONLINEAR STATE-SPACE MODELING OF HUMAN MOTION USING 2-D MARKER OBSERVATIONS

2169

be [19]
‚é°

r1 + r2

‚é§

‚é°

r1 ‚àí r2

‚é¢ q q
2 1
‚é¢
‚é¢
‚é¢ v1 + v2
x1 ‚äï x2 = ‚é¢
‚é¢œâ
2
‚é¢ 1 + œâ
‚é¢
‚é£ a1 + a2

‚é¢ q ‚àí1 q
‚é•
‚é¢ 2 1
‚é•
‚é¢
‚é•
‚é¢ v ‚àí v2
‚é•
‚é• , x1  x2 = ‚é¢ 1
‚é¢œâ
‚é•
2
‚é¢ 1 ‚àí œâ
‚é•
‚é¢
‚é•
‚é£ a1 ‚àí a2
‚é¶

Œ±
1 + Œ±
2

Œ±
1 ‚àí Œ±
2

‚é§
‚é•
‚é•
‚é•
‚é•
‚é•.
‚é•
‚é•
‚é•
‚é¶

(6)

The quaternions in the state vectors can be converted to rotation vectors using procedure (4). Other parts of the state vector
remain unchanged in the conversion. The conversion is denoted
w
 = Rotvec (x). The opposite conversion is carried out with
(1), and it is denoted x = Quat (
w).
C. Unscented Kalman Filter (UKF) Using Quaternions
Fig. 1. On the left: the test device with reflective markers and mounting
brackets for accelerometers. On the right: Model of the test device. Model
anchor points () are defined to correspond to marker locations.

determined by relative quaternions and joint points. Model geometry can be defined during calibration, when the model is
scaled to the subject size. Fixed points in segment reference
frames are defined as joint points. In addition, points are defined for the locations where reflective markers are placed in
measurements. These anchor points are used in the observation
model (see Fig. 1). In addition to model geometry, only the base
segment pose and joint angles are needed to define the pose of
all the segments.
The velocities and accelerations of the segments are also of
interest. Therefore, the state vector x of the model is defined as
follows:
0 œâ
 j1 ¬∑ ¬∑ ¬∑ œâ
 jN ¬∑ ¬∑ ¬∑ ,
x = [ r0 q0 qj 1 ¬∑ ¬∑ ¬∑ qj N v0 œâ
a0 Œ±
0 Œ±
 j1 ¬∑ ¬∑ ¬∑ Œ±
 j N ]T .

(5)

Vectors v0 and a0 are the linear velocity and acceleration of
 0 and Œ±
 0 are
the base segment. Quaternion q0 and vectors œâ
the orientation and the angular velocity and acceleration of the
base segment in the laboratory reference frame. Subindexes
j1, . . . , jN refer to the joints of the model. Relative quaternions qj 1 , . . . , qj N describe the orientation difference between
adjacent segments, and the corresponding angular velocities and
accelerations are stacked in the vector.
The state and the model geometry unambiguously define the
kinematics of each segment. Hierarchical modeling enables the
degrees of freedom of joints to be constrained, e.g., by replacing
a quaternion by a single angle and a fixed rotation axis.
When calculating sums and differences of vectors of the form
(5), quaternion parts have to be treated by quaternion multiplications. Let the sum and subtraction of state vectors x1 and x2

In this section, algorithm used for time-varying estimation of
the multisegment model state (5) is presented. The algorithm is
based on the Kalman filter (KF) [15] and UT, introduced in the
Appendix. The algorithm is called the UKF [18].
The publications of SaÃàrkkaÃà and Hartikainen [21], [22] served
as references when formulating the algorithm. The handling of
quaternions in the UKF is based on that of Kraft [20].
The novel contribution of the proposed filter lies in the state
evolution model of the UKF. In the linear KF and in the EKF,
an evolution model f (¬∑) is applied at a time step k to the previous estimate xÃÇk ‚àí1 , xÃÇk |k ‚àí1 = f (xÃÇk ‚àí1 ), and a predicted estimate
xÃÇk |k ‚àí1 is yielded. In the UKF, the UT is performed for xÃÇk ‚àí1 ,
and an evolution model is applied for a set of sigma points (see
Appendix for details).
Next, the implementation of the proposed evolution model
(f (¬∑)) for a single-state vector is presented.
1) State Evolution Model with Contact Constraint: The evolution model is a Wiener Process Acceleration (WPA) model
[23], where the derivative of acceleration is modeled as Gaussian noise. This model is used when the contact constraint is not
triggered.
For linear parts of the state vector x (5), the model is as
follows:
rk = rk ‚àí1 + vk ‚àí1 Œît + ak ‚àí1

(Œît)2
2

vk = vk ‚àí1 + ak ‚àí1 Œît

ak ‚àí1 ,
constraint not triggered
ak =
aconst , constraint triggered.

(7)
(8)
(9)

When the contact constraint is triggered, an acceleration impulse
is inserted to ak . The acceleration impulse is defined depending
on what type of collision is aimed to be modeled. In the case of
floor contact, acceleration can be chosen such that it stops the
motion of the model toward the floor, during one or several time
intervals Œît.
For angular parts of xÃÇk ‚àí1 , rotation vectors are used. First,
rotations caused by angular velocity and angular acceleration
during the time interval Œît are extracted from the input state.

2170

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Angular velocity:
œâk ‚àí1  Œît
angle : Œ∏œâ = 

(10)

œâ
 k ‚àí1
axis : eœâ =

œâk ‚àí1 

(11)

and angular acceleration:
Œ±k ‚àí1 
angle : Œ∏Œ± = 
axis : eŒ± =

(Œît)
2

2

Œ±
 k ‚àí1
.

Œ±k ‚àí1 

(12)
(13)

Corresponding quaternions qœâ and qŒ± are constructed using
(1). These quaternions are combined with the quaternions in
xÃÇk ‚àí1 by quaternion multiplications [20]:
qk = qŒ± (qœâ qk ‚àí1 ) .

(14)

For angular velocity and acceleration, WPA model is used
 k ‚àí1 + Œ±
 k ‚àí1 Œît
œâ
k = œâ

(15)

Œ±
k = Œ±
 k ‚àí1 .

(16)

2) Initialization of the Algorithm: The initial state estimate
xÃÇ0 and its covariance P0 have to be set before the filtering.
The initial pose of the model can be defined by a time frame,
where a sufficient number of observations are identified, and
checked visually. Initial velocities and accelerations may be set
to zero. The matrix P0 should be positive definite. A simple
choice is a diagonal matrix, with elements of the magnitude
10‚àí4 , . . . , 10‚àí1 on the diagonal.
3) The Algorithm at Time Step k: Unit quaternions are used
for orientation presentation in the state vector. However, matrix
calculations in the UKF are performed with rotation vectors.
Therefore, the algorithm includes conversions between quaternions and rotation vectors. Conversions are also performed for
points, which are stacked in matrices. Matrices Œ£ and all the
covariance matrices in the algorithm contain rotation vectors.
Matrices X contain quaternions.
The algorithm of the filter is as follows:
Predict step: The state estimate xÃÇk ‚àí1 and its covariance Pk ‚àí1
from the previous time step are known. The scaling parameter
c, weight matrix W, and weight vector w are explained in the
Appendix. In the predict step, UT is performed for xÃÇk ‚àí1 .
First, matrix Œ£k ‚àí1 is constructed


‚àö  
(17)
Œ£k ‚àí1 = c 0
Pk ‚àí1 ‚àí Pk ‚àí1 .
A set of sigma points Xk ‚àí1 is constructed by converting
rotation vectors in Œ£k ‚àí1 to quaternions and adding the mean to
each point:
Xk ‚àí1 = Quat (Œ£k ‚àí1 ) ‚äï [xÃÇk ‚àí1 , ¬∑ ¬∑ ¬∑ , xÃÇk ‚àí1 ] .

(18)

Next, the evolution model is applied to each sigma point and the
predicted state estimate xÃÇk |k ‚àí1 is calculated using propagated
sigma points (Xk |k ‚àí1 )
Xk |k ‚àí1 = f (Xk ‚àí1 )

(19)

xÃÇk |k ‚àí1 = Xk |k ‚àí1 w

(20)



 k |k ‚àí1 = Xk |k ‚àí1  xÃÇk |k ‚àí1 , . . . , xÃÇk |k ‚àí1
X


 k |k ‚àí1
Œ£k |k ‚àí1 = Rotvec X
Pk |k ‚àí1 = Œ£k |k ‚àí1 WŒ£Tk |k ‚àí1 + Q.

(21)
(22)
(23)

In (21) and (22), sigma points Xk |k ‚àí1 are modified for the
computation of predicted covariance Pk |k ‚àí1 . Matrix Q is the
covariance of state noise, explained later (31)
Update step:
Zk = h(Xk |k ‚àí1 )

(24)

zÃÇk = Zk w

(25)

 k = Zk ‚àí [zÃÇk , . . . , zÃÇk ]
Z

(26)

 k WZ
T + R
Sk = Z
k

(27)

 T (Sk )‚àí1
Kk = Œ£k |k ‚àí1 WZ
k

(28)

xÃÇk = xÃÇk |k ‚àí1 ‚äï Quat (Kk (zk ‚àí zÃÇk ))

(29)

Pk = Pk |k ‚àí1 ‚àí

(30)

Kk Sk KTk

.

The observation model h(¬∑) consists of a body model and projections of anchor points to the camera image planes. Matrix Zk
contains 2-D pixel coordinates of anchor points corresponding
each sigma point in (Xk |k ‚àí1 ). Vector zk consists of observed
pixel coordinates of markers on camera image planes. Not all
the markers are visible to all cameras in every time frame. Indexes corresponding to missing observations can set to zero in
both Zk and in zk .
The observation noise matrix R defines the expected uncer2
I, the variance
tainty of the observations. By setting R = œÉR
2
of the observation noise œÉR is expected to be the same for all
observations.
Matrix Sk is the covariance of the measurement residual, and
the Kalman gain matrix Kk is used in calculating the updated
state estimate xÃÇk and its covariance Pk .
Since a WPA model is used, and since the rotations are described by rotation vectors, the matrix Q is of the form [23]
‚é° (Œî t) 5
‚é§
(Œî t) 4
(Œî t) 3
20 I
8 I
3 I
‚é¢
‚é•
2 ‚é¢ (Œî t) 4
(Œî t) 3
(Œî t) 2 ‚é•
(31)
Q = œÉQ
‚é£ 8 I
3 I
2 I‚é¶
(Œî t) 3
3

I

(Œî t) 2
2

I

ŒîtI

where I is an identity matrix, size equal to the degrees of freedom
2
of the model, and œÉQ
is the selected noise covariance, state
noise. If different noise magnitudes are specified for the linear
and angular parts, block I is stacked from two blocks that have
2
coefficients.
their own œÉQ
4) Filter Parameters: Noise variances œÉQ and œÉR determine
the behavior of the filter. The smaller œÉR is, the more the observations of the current time step are weighted in the estimation,
i.e., estimates may be affected by noise in data. On the other
hand, small-state noise variance œÉQ leads to estimates that obey
the state evolution model more strictly. In the case of the WPA
model, this means that changes in estimated motions are slow.
5) Marker Identification: Estimates of the state (5) determine the pose of all model segments. Therefore, the predicted

VARTIAINEN* et al.: NONLINEAR STATE-SPACE MODELING OF HUMAN MOTION USING 2-D MARKER OBSERVATIONS

state can be utilized in marker identification. Once the filter is
properly initialized, the predict step gives an accurate estimate
for the model pose in the current time frame, and observations
can be identified before the update step, where the observations
are needed.
D. Unscented Fixed-Interval Smoother
The fixed-interval Kalman smoother consists of filtering and
backward recursion phases. Backward recursion is implemented
according to [21]. The matrices Ck and Pk |k ‚àí1 used in the
recursion are stored during the filtering for each time step k.
Matrix Ck is the cross covariance of xÃÇk and xÃÇk |k ‚àí1
Ck = Œ£k WŒ£Tk |k ‚àí1 .

(32)

Backward recursion consists of the computation of matrix Dk
and the use of the filter estimate xk and predicted estimate
xk +1|k , to form the final estimate xsmth
k
‚àí1

Dk = Ck + 1 Pk +1|k
(33)

 smth
(34)
d = Rotvec xk +1  xk +1|k


xsmth
= xk ‚äï Quat Dk d .
(35)
k
In the rest of the paper, the whole algorithm, consisting of filtering and smoothing phases, is referred to as the unscented
Kalman smoother (UKS).
E. Reference Algorithm
The extended Kalman filter in conjunction with a biomechanical model has been used for human motion tracking earlier [13],
[14], [24]. In those studies, the state models were similar to the
WPA model; they assumed the motion to be smooth. For the validation measurements, an EKF with the WPA model as the evolution model was implemented as a reference method. The filter
tuning parameters were the same in both the UKF and the EKF.
After the EKF algorithm, an extended fixed-interval smoother
was performed [25]. In the rest of the paper, the EKF with the
smoother is referred to as the extended Kalman smoother (EKS).
The smoother was used in acceleration estimation.
III. MEASUREMENTS
Measurements were performed in the motion analysis laboratory of the Department of Applied Physics, University of
Eastern Finland. The laboratory has been planned and built especially for clinical gait analysis [26]‚Äì[28]. The equipment consists of high-speed cameras with an in-house developed camera
data acquisition system and a walkway with two force platforms embedded. Different types of measurement devices can
be synchronized with the camera system using photo cells, radio
frequency triggers, and WLAN connections.
The camera system consists of six high-speed Firewire (IEEE
1394) cameras (model Basler A602f) for motion capture. The
resolution of the cameras is 656 √ó 491 pixels, and the frame rate
used in this study was 100 frames/s. The cameras are equipped
with IR illumination LEDs and IR filters. Reflective, spherical

2171

markers (diameter 18 mm) are used for motion capture. Other
materials visible to the cameras are selected so that they do
not reflect IR light. Raw images from the cameras are saved
as 8-bit gray-scale images. Pixel coordinates of the centroids
of the markers are detected from these images using an inhouse developed algorithm, implemented in NI LabVIEW 2010.
The walkway is covered with a black rubber mat. The two
force platforms (Model OR6-7MA, AMTI Inc., MA, USA) are
embedded in the walkway. The force platforms were used in
this study for contact detection. To validate the acceleration
R
, Mega
estimates, data from a triaxial accelerometer (Meac-x
Electronics Ltd., Kuopio, Finland) were used as a reference.
The range of the accelerometers is ¬± 10 g, the resolution is
0.0015 g and the sampling rate is 1000 Hz. For validation of
the developed method, we performed two sets of measurements:
A) using a rigid test device and B) measuring the gait of test
persons.
A. Test Device
Measurements with a rigid body were performed using a test
device especially developed for the testing of motion laboratory
equipment accuracy [26]. The device consists of an aluminum
rod (length 101 cm), and two horizontal steel rods (length 17
cm). The rods have reflective markers fitted on the both ends. The
device has two plastic brackets for mounting of accelerometers
[see Fig. 1(left)].
During the measurement, the test device was moved by hand.
The rod was consecutively raised and then struck a force platform. 1-cm-thick foamed plastic carpet was used on the platform
to soften the collisions. Four measurement sets of 50 s duration
were performed. The total number of strikes was 108. The speed
at which the rod was struck to the platform was varied to obtain
acceleration peaks in range of 0.5 to 6 g.
Contact was detected using the force platform. An accelerometer was mounted on the lower bracket of the device. After the
measurements, acceleration data were resampled to 100 Hz and
gravitational acceleration was subtracted from the time series.
A geometrical model of the test device was constructed by
using the measured dimensions [see Fig. 1(right)]. The model
state was presented as a vector of the form (5). In this case, the
model had only one segment and no joints. Camera observations
of four markers on the rods served as input data for the motion
tracking algorithm.
The kinematic parameters of the model were then estimated
using the presented approach, i.e., a model-based UKF with
the contact constraint and smoother. The EKF was used as a
reference method. A fixed-interval smoother was executed after
filtering in both methods.
The contact constraint in this study was implemented by
inserting linear acceleration into the state estimate in such a
way that downward motion of the model decelerates instantly.
The acceleration inserted into the estimate at the floor contact
‚àí1)
, where
(time instant k) in the UKF was az (k) = ‚àí0.9 v z (k
Œît
vz (k ‚àí 1) is the vertical speed in the previous time frame and Œît
is the step duration. The coefficient ‚àí1 instead of ‚àí0.9 would
completely stop the downward motion in one time step. The

2172

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

1

0.8

0.6

0.4

0.2

1
0.2

0 0.6

0.8

Fig. 2. On the left: an accelerometer mounted on the foot of the subject. In the
calibration setup, additional sets of markers are attached on the accelerometer.
On the right: model used in human motion tracking.

smaller than one coefficient was selected to ensure that the rod
does not bounce back from the floor. The WPA model (7)‚Äì(9)
used in the UKF predict step transfers the effect of the modified
acceleration to the velocity and to the position of the model.
The smoothness of the KF estimate is adjusted by coefficients
of two covariance matrices (see Section II-C4). It can be noted
that when the appropriate order of magnitude for the coefficients
is found, estimation is not sensitive to slight changes in the coefficients. The values of covariances depend on the magnitudes of
state-vector elements and observation coordinates. In the results
2
2
= 200 and œÉR
= 0.1.
shown, the parameters used were œÉQ
The resampled accelerometer signal and the estimated accelerations were transformed to the laboratory coordinates. Vertical
components of the signal and the estimates were then analyzed.
Acceleration peaks were detected from the signal and estimates,
and peaks corresponding to each floor contact were compared.
B. Human Gait
Measurements of human walking were performed to test the
motion and acceleration estimation with a multisegment model.
Two series of measurements were performed with two adult
subjects, and 20 gait trials, each with one heel strike were analyzed. Gait speeds of 1.0, 1.2, and 1.5 m/s, with ¬±5% tolerance,
were used. These speed ranges are widely used in clinical gait
analysis.
Reflective markers were mounted on the skin and on tightfitting spandex trousers using double-sided adhesive tape.
Marker locations were: the first and fifth metatarsal heads, heel,
lateral and medial malleolus, the lateral and medial epicondyle
of the femur, greater trochanter, spina iliaca anterior superior,
and sacrum. An accelerometer was mounted on the right foot
using an adhesive bandage. The mounting location was on the
medial side of the heel [see Fig. 2(left)].

Similarly to the test device measurements, camera observations served as input data for estimation. Force platform signals
were used for contact detection. Accelerometer signal was used
as reference data.
A seven-segment model of the lower body was constructed,
as described in Section II-B: the pelvis segment was used as
the base segment and the pose of other segments was defined
through joint angles (5). Anchor points were defined to correspond to marker locations [see Fig. 2(right)]. The model segment lengths, joint point positions, and accelerometer positions
were determined in a calibration measurement, where the subject stood in a neutral position and good visibility of the markers
to the cameras was ensured. A set of three markers were attached
to the accelerometer case in a calibration measurement. Thus,
the position and orientation of the accelerometer with respect
to the foot segment could be determined. The same model was
used when performing the proposed method and the reference
method.
The contact constraint for the human model was implemented by inserting an acceleration impulse into the state of
the model. The magnitude of the vertical acceleration impulse
‚àí1)
, where vz (k ‚àí 1) is the velocity of the foot
was ‚àíc vz (k
Œît
segment prior to the floor contact. Coefficient c in the gait measurements was varied. The quantitative results reported were ob2
= 10
tained using c = ‚àí0.9 and the filter parameters were œÉQ
2
and œÉR = 0.1.
IV. RESULTS
A. Test Device
1) 3-D Trajectories: The reconstructed marker trajectories
in the test device measurements showed differences only during and after the impacts, as expected. The residuals between
directly reconstructed and estimated marker positions showed a
base level of some millimeters, which was due to the definition
of the model.
2) Peak Accelerations: A sample of estimated and measured
accelerations and detected peaks is presented in Fig. 3. The
figure shows that the accuracy of the constraint used is at its
best at accelerations below 4 g. With larger accelerations, the
measured signal is underestimated. However, the estimated peak
values are closer to the measured acceleration over the whole
range than estimates with the EKF method. To evaluate the
quality of peak acceleration, estimates aEKS and aUKS were
plotted as a function of am easured (see Fig. 4). A least squares
(LS) fit was performed to the estimates aUKS . The LS line is
aUKS = 0.62am easured + 0.88. The standard error of the fitting
ranges from 0.26 to 0.52 in range 0.62 g < am easured < 6.00 g.
The error is visualized in Fig. 4, which shows that error is
relatively small.
B. Human Gait
1) 3-D Trajectories: An example of the estimated and directly reconstructed trajectories during heel strike is shown
in Fig. 5. The constraint in the proposed method keeps the
heel point above the floor level, whereas the EKF estimate

VARTIAINEN* et al.: NONLINEAR STATE-SPACE MODELING OF HUMAN MOTION USING 2-D MARKER OBSERVATIONS

2173

Fig. 3. Measured and estimated accelerations in the test device measurement. On the left: Accelerations in a measurement where the device repeatedly strikes
the force platform. On the right: A closer examination of the accelerations during a strike on the force platform.

Fig. 4. Estimated accelerations with respect to measured accelerations in
the test device measurements. The equation of the fitted LS line is a U K S =
0.62a m e a su re d + 0.88. Dashed lines visualize the standard error of the fitting,
which ranges from 0.26 to 0.53 in the range 0.62 g < a m e a su re d < 6 g.

continues its path smoothly through the floor level. Fig. 6 shows
the vertical coordinates of the heel point estimates as a function
of time in four gait trials. The figure illustrates that the constraint
works systematically in the gait trials.
We calculated the difference in RMS errors between trajectories that can be seen clearly in the heel marker during heel
strikes. A window of eight time steps around the heel strike was
used in RMSE calculations. The mean RMS error of the heel
strikes in the four gait trials of 1.5 m/s was 4.4 mm for the EKF
method and 2.5 mm for the proposed method. During smooth
motion, i.e., outside the heel contact window, differences in trajectories were very small and thus there was no difference in the
RMS error (see Table I).

Fig. 5. Trajectories of reconstructed and estimated heel markers during one
heel strike event. Projections of the three trajectories on a vertical plane are also
shown.

TABLE I
ROOT MEAN SQUARE ERRORS BETWEEN DIRECTLY RECONSTRUCTED
OBSERVATIONS AND ESTIMATES OF MARKER TRAJECTORIES OF THE EKF
METHOD AND THE UKF WITH CONSTRAINT METHOD
Data
Heel marker
Heel strikes
Whole measurement
All markers on right foot
Heel strikes
Whole measurement

RMSE (EKF)

RMSE (UKF + constraint)

4.4
6.9

2.5
6.8

3.0
7.5

3.8
8.1

Mean of four gait trials (Person 2, v 3 ), values in millimeters.

2174

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 6. Z-coordinates of a marker on the right heel in four gait trials (subject
2, 1.5 m/s). Graphs synchronized, detected heel strike at t = 0.

Z‚àícoordinates of a heel point
UKF + constraint using complete data
UKF + constraint using incomplete data
EKF
reconstructions of input data
reconstructions of removed data

.03

z(m)

.02
Fig. 8. Measured and estimated vertical acceleration during heel strikes in the
gait trials of person 2. Graphs synchronized, detected heel strike at t = 0.

.01

0
‚àí0.1

‚àí0.05

0

0.05
0.1
time(s)

0.15

0.2

0.25

Fig. 7. Effects of missing observations. A marker on the heel and a marker
on lateral malleolus is removed from the input data at a time interval of 16 time
steps. The removed data are visualized as gray dots. Heel strike at t = 0.

The effect of missing data was tested by removing observations of the heel and the ankle marker for a time interval of 16
steps during heel strikes. The behavior of estimates is visualized by plotting the z-coordinates of the heel point in Fig. 7.
The figure shows that the proposed method also works with

incomplete data, since the contact constraint prevents the model
from penetrating through the floor, whereas the EKF estimation
is much worse due to the lack of data.
Estimates of anatomical knee and ankle angles were calculated using the EKF and UKF tracking results. The estimates
were compared to the angle values based on direct reconstructions of markers. The knee joints had two degrees of freedom on
EKF and UKF estimation; rotation was prevented. The angles
during the gait cycle are shown in Fig. 10. The constraint affects
most notably the knee adduction angle estimates.
2) Peak Accelerations: The vertical components of measured and estimated accelerations of the foot were compared
in the laboratory coordinate system. These components during
heel strike are plotted in Fig. 8. Peak accelerations at heel strike
were extracted to compare estimates with measured accelerations. An LS fit was applied to the points aUKS versus am easured ,

VARTIAINEN* et al.: NONLINEAR STATE-SPACE MODELING OF HUMAN MOTION USING 2-D MARKER OBSERVATIONS

2175

Fig. 9. Estimated accelerations with respect to measured accelerations in gait
measurements of two persons. The equation of the fitted LS line is a U K S =
0.51a m e a su re d + 0.59. Dashed lines visualize the standard error of the fitting,
which ranges from 0.49 to 0.95.
TABLE II
MEASURED AND ESTIMATED PEAK ACCELERATIONS IN GAIT EXPERIMENTS
(MEANS (¬±S.D.))
Speed
Person 1
v1
v2
v3
Person 2
v1
v2
v3

am e a su re d

aE K S

aU K S

Trials

4.07 (¬±0.64)
4.97 (¬±0.00)
3.36 (¬±0.39)

0.82 (¬±0.21)
0.64 (¬±0.07)
0.92 (¬±0.67)

2.69 (¬±0.73)
2.80 (¬±0.19)
3.22 (¬±0.85)

4
2
2

2.24 (¬±0.39)
2.87 (¬±0.56)
3.55 (¬±0.72)

0.14 (¬±0.07)
0.31 (¬±0.29)
0.06 (¬±0.25)

1.46 (¬±0.23)
2.13 (¬±0.51)
2.22 (¬±0.31)

4
4
4

Fig. 10. Estimates of the right knee and ankle joint angles. The contact constraint is triggered at the beginning of the gait cycle, (0%). Four gait trials
(Person 2, speed: 1.5 m/s) are shown.

Measured a m e a s u r e d , estimates by EKS (a E K S ) and the proposed
UKS (a U K S ). Speed classes are v 1 = 1.0 m/s, v 2 = 1.2 m/s, v 3 =
1.5 m/s (¬±5% ) .

the fitted line is plotted in Fig. 9. The equation of the line
is aUKS = 0.51 am easured + 0.59. The standard error of the
fitting is from 0.49 to 0.95. The range of accelerations was
1.89 g < am easured < 4.98 g. The mean and standard deviation
of the am easured and both estimates are presented in Table II.
V. DISCUSSION
In this study, a novel method for the estimation of rigid body
and multibody kinematics is presented. The method was evaluated with test device measurements and human gait measurements. Kinematic data were acquired using a camera system.
A triaxial accelerometer was used to evaluate the acceleration
estimate.
The experiments demonstrated that the proposed method has
a difference to the EKF method when the constraint is triggered
and during a few time steps after that, as expected. Tracking of
the trajectories showed that in case of the heel marker and other
points that changed the direction of motion at heel strike, the
proposed method was able to track the change instantly, unlike
the EKF method.

Measurements with a rigid rod provided data for validation of
the constraint. All acceleration peak estimates were generated by
a simple constraint, explained in Section III-A. This constraint
tended to underestimate large (>4 g) accelerations. However,
the estimates were essentially closer to the real accelerations
than estimates with the EKS algorithm at contacts, as can be
seen in Fig. 3.
Measurements of human gait showed similar differences between the proposed method and the EKF method. The EKS
cannot give reasonable estimates during heel strike. Constraint
acceleration, based on the velocity of the foot before the heel
strike, gave good estimates for upward acceleration at gait trials
of two subjects (see Fig. 8).
UKF-based methods have been used in markerless motion
capture applications [2], [3]. Thus far, their accuracy has not
been adequate for clinical motion analysis, where joint angles
and body segment kinematics are needed.
The proposed model-based approach has several advantages
in utilizing 2-D marker observations. The model geometry, including anchor points, is projected to camera image planes.
Projections of anchor points can be matched with 2-D observations. Moreover, the UKF predict step enables online marker

2176

identification; the filter predicts the model pose in the current
time step before any data from the time instant are used. Identified observation on the camera image planes can be directly
used. Thus, markers seen by only a single camera are also utilized. In traditional methods, only 3-D marker reconstructions
are used, and thus at least two camera observations per marker
are needed.
Marker configurations based on the Helen‚ÄìHayes marker set
[7] have been widely used in gait analysis. In these sets, the
orientation of thigh and shin segments are estimated separately
using three noncollinear markers for both segments. In practice,
one of the markers is placed on a muscle or mounted on a rod.
In model-based tracking, fewer markers are required for pose
estimation. In a hierarchical model, two markers and a joint point
are sufficient for segment pose determination. The possibility
to reduce the joint degrees of freedom is useful, depending on
the application and the quality of the marker data. For example,
preventing the knee joint from rotating may be useful, since the
actual rotation of the joint is small, and observation errors may
cause false rotations.
Fig. 10 shows that the constraint used in the experiments
causes differences between the knee adduction angle estimates.
Since the constraint in the estimation was optimized for accelerations, accurate angle estimates are not achieved simultaneously.
Graphs of angle estimates also illustrate the different nature of
direct reconstructions and model-based estimation. Quantitative
comparison is not meaningful, since the marker placement was
not designed for the direct angle calculations. None of the angle
curves can be considered as reference. We did not measure joint
angles directly to validate angle estimates.
As the reference for acceleration estimates, skin mounted accelerometers were used, which offer a noninvasive way to measure accelerations on the leg [27]. Understandably, mounting of
accelerometers on the skin introduces some artifacts [29].
A fixed-interval smoother is used after the UKF, and thus the
data from the past and future are utilized in the estimation. The
backward recursion removes time lag from velocity and acceleration estimates. The recursive estimation also suppresses highfrequency noise. For online applications, smoothing could be
implemented using a fixed-lag smoother, which yields smoothed
estimates with a lag of a few time steps. The filter algorithm was
implemented in the Matlab environment. Real-time implementation is possible using a more efficient programming language
and suitable hardware.
Reliable contact detection is essential when using contact
constraints. Force platforms provide an accurate signal for detection. Detection based on camera observations is also implementable, at least in offline applications. Thus, the use of
constraint is not confined to the force platforms. Online detection using only optical information requires high accuracy of
the whole system. The floor plane must be accurately localized
in the calibrated space. The dimensions of the model, especially
the foot segment, must be accurately defined.
A more advanced application of contact constraint to human motion analysis would require modeling of the propagation of acceleration through the bones and joints. Realistic
estimates of segment accelerations can be used in calculat-

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

ing joint contact forces and joint moments during impulsive
accelerations.
As a conclusion, the proposed method combines the UKF
with a multisegment 3-D model, contact constraint, and a fixedinterval smoother in a unique way. The pose of the model is
defined using unit quaternions. The contact constraint is incorporated into the UKF evolution model, which enables accurate
estimates during contact events. The smoother removes the time
lag from the final estimates. In the validation measurements of
the method, meaningful estimates for accelerations of a rigid
body and the human foot was acquired during floor contact
events.
APPENDIX
UT IN MATRIX FORM
The UT is a method for calculating the statistics of a random
variable x that undergoes a nonlinear mapping. It is based on
the idea that ‚Äúit is easier to approximate a Gaussian distribution
than it is to approximate an arbitrary nonlinear function‚Äù [18].
In the UT, a set of so-called sigma points is selected from the
distribution of x according to a deterministic algorithm. The
sigma points are propagated through a nonlinear function, and
these transformed points are used to estimate the mean and
covariance of the output variable.
The UT resembles Monte Carlo-type methods, where a large
number of random points are sampled. In the UT, the selection
of points and their weights enables the reliable estimation of
statistics with a relatively small number of points.
Let x have the dimension of n, mean Œ∑x , and covariance Cxx .
The set of sigma points consists of 2n + 1 points œÉ(i)
‚éß
Œ∑ ,
i=0
‚é™
‚é® x ‚àö

cCxx i ,
i = 1, . . . , n
(36)
œÉ(i) = Œ∑x +
‚é™

‚àö
‚é©
Œ∑x ‚àí
cCxx (i‚àín ) , i = n + 1, . . . , 2n
‚àö

where
cCxx i is the ith column of the square root of matrix cCxx . The
‚àö square root of the positive definite matrix P is
matrix A = P, which satisfies P = AAT . Matrix A can be
calculated, for example, with Cholesky decomposition [30].
The weights associated with each point œÉ(i) are essential in
the UT. Weights for mean computation wŒ∑ (i) and for covariance
computation wc(i) are
‚éßc‚àín
‚é™
,
i=0
‚é®
c
(37)
wŒ∑ (i) =
‚é™
‚é© 1,
i = 1, . . . , 2n
2c
‚éßc‚àín
‚é™
+ (1 ‚àí Œ±2 + Œ≤), i = 0
‚é®
c
wc(i) =
(38)
‚é™
‚é© 1,
i = 1, . . . , 2n.
2c
The constants Œ±, Œ≤, and Œ∫ are parameters of the transformation,
which also define the scaling parameter c
c = Œ±2 (n + Œ∫) .

(39)

VARTIAINEN* et al.: NONLINEAR STATE-SPACE MODELING OF HUMAN MOTION USING 2-D MARKER OBSERVATIONS

Values Œ± = 1, Œ≤ = 2, and Œ∫ = 3 ‚àí n were used for parameters.
Let f be a nonlinear mapping. Each sigma point œÉ(i) is propagated through the mapping to form a set of transformed points
y


(40)
y(i) = f œÉ(i) , i = 0, . . . , 2n.
To present the transformation in matrix form, the following
notations are used: vectors œÉ(i) are stacked in an n √ó (2n + 1)
 is the set, where the mean Œ∑x is subtracted from
matrix X and X
every vector


‚àö  
 = c 0 Cxx ‚àí Cxx
(41)
X
 + [Œ∑x ¬∑ ¬∑ ¬∑ Œ∑x ] .
X=X

(42)

Equation (40) in matrix form is
Y = f (X) .

(43)

Weights of the mean are stacked in the vector w and covariance weights in the diagonal matrix W

T
w = wŒ∑ (0) ¬∑ ¬∑ ¬∑ wŒ∑ (2n )
(44)


(45)
W = diag wc(0) ¬∑ ¬∑ ¬∑ wc(2n ) .
Now, the mean of points y(i) can be calculated in matrix form.
 is constructed for covariance calculation
In addition, matrix Y
Œ∑y = Yw

(46)

 = Y ‚àí [Œ∑y ¬∑ ¬∑ ¬∑ Œ∑y ] .
Y

(47)

The autocovariance of y is
 Y
 T , and
Cyy = YW

(48)

the cross-covariance of x and y is
 Y
T.
Cxy = XW

(49)

REFERENCES
[1] R. Poppe, ‚ÄúVision-based human motion analysis: An overview,‚Äù Comput.
Vision Image Understanding, vol. 108, pp. 4‚Äì18, 2007.
[2] J. del Rincon, D. Makris, C.UrunÃÉuela, and J.-C. Nebel, ‚ÄúTracking human
position and lower body parts using Kalman and particle filters constrained
by human biomechanics,‚Äù IEEE Trans. Syst., Man, Cybern.‚ÄîPart B: Cybern., vol. 41, no. 1, pp. 26‚Äì37, Feb. 2011.
[3] P. Agarwal, S. Kumar, J. Ryde, J. Corso, and V. Krovi, ‚ÄúEstimating human
dynamics on-the-fly using monocular video for pose estimation,‚Äù presented at the Robotics: Science and. Syst., Sydney, Australia, Jul. 2012.
[4] S. Corazza, L. MuÃàndermann, E. Gambaretto, G. Ferrigno, and T. Andriacchi, ‚ÄúMarkerless motion capture through visual hull, articulated icp and
subject specific model generation,‚Äù Int. J. Comput. Vis., vol. 87, no. 1‚Äì2,
pp. 156‚Äì169, Mar. 2010.
[5] C. Canton-Ferrer, J. R. Casas, and M. PardaÃÄs, ‚ÄúMarker-based human motion capture in multiview sequences,‚Äù EURASIP J. Adv. Signal Process,
vol. 2010, pp. 73:1‚Äì73:11, Feb. 2010.
[6] C. Vaughan, Dynamics of Human Gait, 2nd ed. Cape Town, South Africa:
Kiboho Publishers, 1999.
[7] M. P. Kadaba, H. K. Ramakrishna, and M. E. Wootten, ‚ÄúMeasurement of
Lower Extremity Kinematics During Level Walking,‚Äù J Orthop Res., vol.
25, pp. 383‚Äì392, 1990.
[8] A. Peters, B. Galna, M. Sangeux, M. Morris, and R. Baker, ‚ÄúQuantification
of soft tissue artifact in lower limb human motion analysis: A systematic
review,‚Äù Gait Posture, vol. 31, no. 1, pp. 1‚Äì8, 2010.

2177

[9] M. S. Andersen, D. L. Benoit, M. Damsgaard, D. K. Ramsey, and J. Rasmussen, ‚ÄúDo kinematic models reduce the effects of soft tissue artefacts in
skin marker-based motion analysis? an in vivo study of knee kinematics,‚Äù
J. Biomech., vol. 43, no. 2, pp. 268‚Äì273, 2010.
[10] L. Chiari, U. D. Croce, A. Leardini, and A. Cappozzo, ‚ÄúHuman movement
analysis using stereophotogrammetry part 2: Instrumental errors,‚Äù Gait
Posture, vol. 21, pp. 197‚Äì211, 2005.
[11] L. Herda, P. Fua, R. PlaÃànkers, R. Boulic, and D. Thalmann, ‚ÄúUsing
skeleton-based tracking to increase the reliability of optical motion capture,‚Äù Human Movement Sci., vol. 20, pp. 313‚Äì341, 2001.
[12] P. Cerveri, A. Pedotti, and G. Ferrigno, ‚ÄúRobust recovery of human motion
from video using kalman filters and virtual humans,‚Äù Human Movement
Sci., vol. 22, pp. 377‚Äì404, 2003.
[13] K. Halvorsen, ‚ÄúUsing an extended Kalman filter for rigid body pose estimation,‚Äù J. Biomech. Eng., vol. 127, pp. 475‚Äì483, 2005.
[14] F. D. Groote, T. D. Laet, I. Jonkers, and J. D. Schutter, ‚ÄúKalman smoothing
improves the estimation of joint kinematics in marker-based human gait
analysis,‚Äù J. Biomech., vol. 41, pp. 3390‚Äì3398, 2008.
[15] R. E. Kalman, ‚ÄúA New Approach to Linear Filtering and Prediction Problems,‚Äù J. Basic Eng., vol. 83, pp. 35‚Äì45, 1960.
[16] G. Welch and G. Bishop, (2003, Jul.). An introduction to the
Kalman Filter [Online]. Available: http://www.cs.unc.edu/ welch/media/
pdf/kalman_intro.pdf
[17] H. E. Rauch, F. Tung, and C. T. Striebel, ‚ÄúMaximum likelihood estimates
of linear dynamic systems,‚Äù AIAA J., vol. 3, pp. 1445‚Äì1450, 1965.
[18] S. J. Julier and J. K. Uhlmann, ‚ÄúA new extension of the Kalman filter
to nonlinear systems,‚Äù in Proc. Int. Symp. Aerospace/Defense Sensing,
Simulation Controls, Orlando, FL, USA, 1997, pp. 182‚Äì19.
[19] D. Eberly (2013, Oct. 16). Quaternion algebra and calculus
[Online]. Available: http://www.ann.jussieu.fr/frey/papers/scientificy%
20D.,%20Quaternion%20algebra%20and%20calculus.pdf
[20] E. Kraft, ‚ÄúA quaternion-based unscented Kalman filter for orientation
tracking,‚Äù in Proc. 6th Int. Conf. Inf. Fusion, Jul. 2003, vol. 1, pp. 47‚Äì54.
[21] S. SaÃàrkkaÃà, ‚ÄúUnscented Rauch‚ÄìTung‚ÄìStriebel Smoother,‚Äù IEEE Trans. Autom. Control, vol. 53, no. 3, pp. 845‚Äì848, Apr. 2008.
[22] J. Hartikainen and S. SaÃàrkkaÃà, ‚ÄúOptimal filtering with kalman filters and
smoothers - a manual for matlab toolbox ekf/ukf,‚Äù 2008.
[23] X. Rong Li, and V. Jilkov, ‚ÄúSurvey of maneuvering target tracking. part i.
dynamic models,‚Äù IEEE Trans. Aerospace Electron. Syst., vol. 39, no. 4,
pp. 1333‚Äì1364, Oct. 2003.
[24] P. Cerveri, A. Pedotti, and G. Ferrigno, ‚ÄúKinematical models to reduce
the effect of skin artifacts on marker-based human motion estimation,‚Äù J.
Biomechanics, vol. 38, pp. 2228‚Äì2236, 2005.
[25] Y. Bar-Shalom, and X.-R. Li, Estimation and Tracking: Principles, Techniques, and Software. Norwood, MA,USA: Artech House, 1993.
[26] M. J. Hakkarainen, T. Bragge, T. Liikavainio, J. Arokoski, P. A. Karjalainen, and M. Tarvainen, ‚ÄúMethod for testing motion analysis laboratory measurement systems,‚Äù J. Biomech Eng., vol. 132, no. 11, p. 114501,
2010.
[27] T. Liikavainio, T. Bragge, M. Hakkarainen, J. S. Jurvelin, P. A. Karjalainen,
and J. P. Arokoski, ‚ÄúReproducibility of loading measurements with skinmounted accelerometers during walking,‚Äù Archives Phys. Med. Rehabil.,
vol. 88, no. 7, pp. 907‚Äì915, 2007.
[28] P. Vartiainen, T. Bragge, T. Lyytinen, M. Hakkarainen, P. A. Karjalainen,
and J. P. Arokoski, ‚ÄúKinematic and kinetic changes in obese gait in bariatric
surgery-induced weight loss,‚Äù J. Biomech., vol. 45, no. 10, pp. 1769‚Äì1774,
2012.
[29] M. A. Lafortune, E. Henning, and G. A. Valiant, ‚ÄúTibial shock measured
with bone and skin mounted transducers,‚Äù J. Biomech., vol. 28, no. 8, pp.
989‚Äì993, 1995.
[30] S. SaÃàrkkaÃà, ‚ÄúRecursive Bayesian Inference on Stochastic Differential Equations,‚Äù Ph.D. thesis, Laboratory Comput. Eng., Helsinki Univ. Technol.,
Helsinki, Finland, 2006.

Paavo Vartiainen received the M.Sc. degree in
physics from the University of Eastern Finland,
Kuopio, Finland, in 2011.
Since then, he has been a Researcher in the Department of Applied Physics, University of Eastern
Finland. His current research interests include novel
methods in camera-based human motion analysis.
Current application is gait analysis of the obese and
osteoarthritic patients.

2178

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Timo Bragge received the M.Sc. degree in medical
physics in 2007 from the Department of Physics, University of Kuopio, Finland.
He is a Researcher at the University of Eastern
Finland. He has been developing motion laboratory
equipment and methods in Biosignal Analysis and
Medical Imaging Research Group. His current research interests include camera and inertial sensorbased methods in motion analysis and biomechanical
modeling with applications related to neurorehabilitation, knee osteoarthritis, and diabetic foot.

Jari P. Arokoski received the medical degree in 1990
and completed his specialization in physical and rehabilitation medicine in 1998 from the University of
Kuopio, Kuopio, Finland. He finished the Ph.D. thesis in 1996 at the University of Kuopio.
He is an Adjunct Professor in Physical and
Rehabilitation Medicine at the University of Eastern Finland, Kuopio, and a Consultant at the Department of Physical and Rehabilitation Medicine in
Kuopio University Hospital, Kuopio. He became an
Adjunct Professor (docent) of Physical and Rehabilitation Medicine at the University of Kuopio in 2001. He has published more than
100 peer-reviewed scientific publications on different aspects of musculoskeletal issues particularly on cartilage structure and function, joint loading, physical
function and gait in osteoarthritis and the effects of exercise and rehabilitation
in knee and hip osteoarthritis.
Dr. Arokoski is the Chairman of the Working group for Current Care Guideline for Treatment of Knee and Hip Osteoarthritis in Finland (Finnish Medical Society Duodecim) and the President of Finnish OsteoArthritis Research
Society.

Pasi A. Karjalainen received the Ph.D. degree
in 1997 from the University of Kuopio, Kuopio,
Finland.
Since 1998, he has been leading the research group
for Biosignal Analysis and Medical Imaging. He is
currently a Professor of signal and image analysis
with the Department of Applied Physics, University
of Eastern Finland, Kuopio. His research areas include biomedical signal analysis and medical imaging applications connected with human motion analysis. His research interest includes several clinical
applications. It includes the use of human motion analysis and signal analysis
in neurorehabilitation and diagnosis of neurological diseases.

