168

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 1, JANUARY 2016

Current Density Imaging During Transcranial Direct
Current Stimulation Using DT-MRI and MREIT:
Algorithm Development and Numerical Simulations
Oh In Kwon, Saurav Z. K. Sajib, Igor Sersa, Tong In Oh, Woo Chul Jeong, Hyung Joong Kim,
and Eung Je Woo ‚àó , Senior Member, IEEE

Abstract‚ÄîObjective: Transcranial direct current stimulation
(tDCS) is a neuromodulatory technique for neuropsychiatric diseases and neurological disorders. In the tDCS treatment, dc current
is injected into the head through a pair of electrodes attached on
the scalp over a target region. A current density imaging method
is needed to quantitatively visualize the internal current density
distribution during the tDCS treatment. Methods: We developed
a novel current density image reconstruction algorithm using 1)
a subject specific segmented 3-D head model, 2) diffusion tensor
data, and 3) magnetic flux density data induced by the tDCS current. We acquired T1 weighted and diffusion tensor images of the
head using the MRI scanner before the treatment. During the treatment, we can measure the induced magnetic flux density data using
a magnetic resonance electrical impedance tomography (MREIT)
pulse sequence. In this paper, the magnetic flux density data were
numerically generated. Results: Numerical simulation results show
that the proposed method successfully recovers the current density distribution including the effects of the anisotropic, as well
as isotropic conductivity values of different tissues in the head.
Conclusion: The proposed current density imaging method using
DT-MRI and MREIT can reliably recover cross-sectional images
of the current density distribution during the tDCS treatment.
Significance: Success of the tDCS treatment depends on a precise
determination of the induced current density distribution within
different anatomical structures of the brain. Quantitative visualization of the current density distribution in the brain will play
an important role in understanding the effects of the electrical
stimulation.
Index Terms‚ÄîConductivity tensor, current density, diffusion tensor, magnetic flux density, magnetic resonance electrical impedance tomography (MREIT), transcranial direct current
stimulation (tDCS).

I. INTRODUCTION
RANSCRANIAL direct current stimulation (tDCS) is a
neuromodulatory technique, which uses a constant dc current (typically 1‚Äì2 mA for 20 min or more) delivered to the head

T

Manuscript received February 14, 2015; revised May 5, 2015 and June 8,
2015; accepted June 11, 2015. Date of publication June 11, 2015; date of
current version December 17, 2015. This work was supported by the National Research Foundation of Korea Grant 2013R1A2A2A04016066 and Grant
2014R1A2A1A09006320. Asterisk indicates corresponding author.
O. I. Kwon is with the Konkuk University.
S. Z. K. Sajib, T. I. Oh, W. C. Jeong, and H. J. Kim are with the Kyung Hee
University.
I. Sersa is with the Jozef Stefan Institute.
* E. J. Woo is with the Department of Biomedical Engineering, Kyung Hee
University, Seoul 130-701, Korea (e-mail: ejwoo@khu.ac.kr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2448555

to affect brain functions [1]‚Äì[5]. Over the last several decades,
there have been numerous tDCS studies showing its potential
as a treatment tool for various neuropsychiatric diseases and
neurological disorders, such as depression, epilepsy, chronic
pain, recovery from stroke, and Parkinson‚Äôs disease [6]‚Äì[9]. In
most clinical tDCS studies, a pair of electrodes are attached as
an anode and a cathode on the scalp at empirically determined
positions over a target region. The injected current does not
actually activate neurons; instead, it adjusts the activation rate
of neurons by changing their membrane potentials [10], [11].
Several clinical studies have shown that anodic currents facilitate, while cathodic currents inhibit the neuronal excitability in
the cortex region [1], [2], [12], [13]. However, the underlying
mechanism is not clearly revealed yet. The induced voltage u
and the current density J = (Jx , Jy , Jz ) in different regions of
the brain should play an important role in understanding the
mechanism. Such information may also lead to a guideline for
a more refined tDCS treatment.
In the late 1980s, magnetic resonance current density imaging
(MRCDI) was proposed to use an MRI scanner to visualize a
current density distribution inside the human body produced
by an externally injected current. When we inject current into
an electrically conducting object, such as the human body, it
generates internal distributions of the current density J and
the magnetic flux density B = (Bx , By , Bz ). When the main
magnetic field of the MRI scanner is in the z-direction, the
component Bz perturbs the main field and produces spatially
varying extra phase accumulations in the MR phase image [14]‚Äì
[18]. Since we can extract only the Bz data from the acquired
MR phase images, we should rotate the imaging subject inside
the MRI scanner twice to acquire all three components of B.
Then, we can calculate the internal current density J by using
Ampere‚Äôs law Œº0 J = ‚àá √ó B [14]‚Äì[18]. Clinical applications of
this technique are, however, limited due to technical difficulties
associated with the requirement of subject rotations.
Magnetic resonance electrical impendence tomography
(MREIT), combing electrical impedance tomography and MRCDI techniques, was introduced to obtain cross-sectional images
of the conductivity distribution inside the human body [19]‚Äì
[27]. Recent MREIT techniques produce conductivity and/or
current density images using only one component Bz without
rotating the imaging subject [28]‚Äì[32].
In MREIT, at least two currents are injected to acquire the
corresponding Bz data to reconstruct isotropic or equivalent
isotropic conductivity images. At low frequencies, however,

0018-9294 ¬© 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KWON et al.: CURRENT DENSITY IMAGING DURING TRANSCRANIAL DIRECT CURRENT STIMULATION USING DT-MRI AND MREIT

some biological tissues, such as the white matter (WM) and
skeletal muscle exhibit quite strong anisotropic property [33].
In theory, one may use at least seven injection currents to recover anisotropic conductivity images as well [34]. In practice,
anisotropic conductivity imaging in MREIT has been deferred
since the method is too sensitive to the noise in measured Bz
data. To overcome this limitation, Kwon et al. [35] lately developed a practical method to reconstruct an anisotropic conductivity image by combining diffusion tensor MRI (DT-MRI) and
MREIT with at least two injection currents.
In this paper, we propose a new method to reconstruct crosssectional images of a current density distribution induced by
the tDCS current inside the brain with an unknown anisotropic
conductivity distribution. Though we may adopt the projected
current density method by Park et al. [36], it cannot properly
handle effects of the anisotropic conductivity. To overcome this
limitation, we incorporate a diffusion tensor map acquired by
the DT-MRI technique. The acquired Bz data induced by the
tDCS current are utilized to recover the transversal components
of the current density.
We will first describe a subject specific 3-D head model constructed by using anatomical MR images. The diffusion tensor
images will be incorporated into the model by aligning the conductivity tensor with the diffusion tensor. A novel current density
image reconstruction algorithm will be proposed, and tested by
using the simulated datasets from the model. We will show that
the new method can successfully recover the current density
image in the brain during tDCS. Finally, we will suggest a new
tDCS treatment procedure inside an MRI scanner for experimental validations of the proposed current density imaging method.
II. METHODS
A. Anatomical MRI and DT-MRI Scans
We acquired T1 weighted and diffusion tensor images of the
head from a healthy volunteer (26-year old female) using a clinical 3.0-T MRI scanner (Achieva TX, Philips Medical Systems,
The Netherlands). Each image set included 100 axial slices
with 1.5 mm thickness, 220 mm √ó 220 mm field-of-view, and
256 √ó 256 image matrix. The diffusion tensor dataset had 32
gradient directions with a b-value of 1000 s/mm2 . Each of them
comprised 256 √ó 256 √ó 100 voxels of 0.85 mm √ó 0.85 mm √ó
1.5 mm size.
From one MR image without diffusion weighting and at least
six images with diffusion weighing along different uniformly
distributed spatial directions, we obtained the echo signal attenuations along those directions. Incorporating the values into an
overdetermined system of equations, we computed the effective
diffusion tensor D for each voxel
‚éû
‚éõ
Dxx Dxy Dxz
‚éü
‚éú
(1)
D = ‚éù Dxy Dy y Dy z ‚é† = SD ŒõD STD
Dxz

Dy z

Dz z

where SD is a matrix of three orthogonal eigenvectors, and
ŒõD = diag(Œª1 , Œª2 , Œª3 ) is a diagonal matrix with the eigenvalues. Figure 1 shows the obtained diffusion tensor map.

169

Fig. 1. (a) Diffusion tensor map in the slice at 67.5 mm from the top of the
head. Top and bottom rows show the diagonal and off-diagonal components,
respectively, of the diffusion tensor map. (b)-I Color-coded fractional anisotropy
(FA) map. (b)-II Color-coded fractional anisotropy map overlaid on the T 1
weighted anatomical image. In (b), red, green, and blue colors indicate the
fiber orientations of left-to-right, anterior-to-posterior, and superior-to-inferior,
respectively.

Fig. 2. (a) T 1 -weighted MR image in the slice at 67.5 mm from the top of
the head. (b) Segmented image of (a). (c) Three-dimensional head model with
the attached electrodes. (d)‚Äì(f) Finite-element meshes of the entire head, GM
region, and WM region, respectively.

B. Three-Dimensional Model Construction
We manually segmented the T1 -weighted MR images into five
tissue regions: skin, skull, cerebrospinal fluid (CSF), gray matter
(GM), and WM. We imported the segmented data to a software
package SanFE (Simpleware Ltd., U.K.) for model construction.
and Œµ‚àí
In the model, we attached a pair of electrodes (Œµ+
1
1)
2
with 4 mm thickness and 25-cm surface area on the head at the
positions commonly used for tDCS of the primary motor cortex
and Œµ‚àí
[37]. We attached another electrode pair (Œµ+
2
2 ) with
the same dimension at the mirroring locations of the head to test
the algorithm with different electrode positions (not shown in
Fig. 2). Fig. 2(a) and (b) shows a T1 -weighted MR magnitude
image and it‚Äôs manually segmented image, respectively, in the
slice at 67.5 mm from the top of the head. Fig. 2(c) and (d) shows
the 3-D model with attached electrodes and its finite-element
mesh comprising 1 271 478 tetrahedral and 277 079 triangular
elements, respectively. The finite-element meshes of the GM
and WM regions are displayed separately in Fig. 2(e) and (f),
respectively.
Adopting the effective anisotropic tensor model [38]‚Äì[40]
proposed a method to estimate the anisotropic conductivity
tensor from the diffusion tensor. The method is based on a linear

170

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 1, JANUARY 2016

TABLE I
CONDUCTIVITY VALUES USED IN THE HEAD MODEL
IN FIG. 2 TO GENERATE THE SIMULATED TRUE DATA
Tissue

Conductivity C ‚àó [S/m] in (3)

Skin
Skull
GM

0.430 [4]
0.015 [42]
Œ∑ ‚àóD m
where D m is the measured diffusion
tensor from the DT-MRI scan and
Œ∑ ‚àó = 0.179 [S ¬∑ s/mm3 ] [41]
1.80 [43]
1.70 [44]

WM
CSF
Electrode

TABLE II
MR TISSUE PARAMETERS AT 3.0 T USED TO ESTIMATE
THE NOISE LEVEL IN B z DATA
Tissue
Skin [46], [47]
Skull [46]
GM [48], [49]
WM [48], [49]
CSF [46]

T 2 [ms]

œÅ

371
1240
1331
832
3620

133
37
80
110
767

0.100
0.010
0.832
0.708
1.000

The relative proton density œÅ is dimensionless
since it is normalized by the proton density of
CSF.

relationship between the water diffusion tensor D = SD ŒõD
STD and the conductivity tensor C = SD ŒõC STD with ŒõC =
f (œÉe , de , dŒΩ , di , œÉi )ŒõD . Here, SD is a matrix of the eigenvectors, ŒõD is a diagonal matrix of the eigenvalues, and
ŒõC = diag(ŒªœÉ1 , ŒªœÉ2 , ŒªœÉ3 ) is a diagonal matrix for the conductivity tensor with its eigenvalues ŒªœÉi , i = 1, 2, 3. Note that
f (œÉe , de , dŒΩ , di , œÉi ) denotes a function of the extracellular
conductivity (œÉe ), extracellular diffusion coefficient (de ),
eigenvalue of self-diffusion tensor (dŒΩ ), intracellular diffusion
coefficient (di ), and intracellular conductivity (œÉi ). By neglecting the intracellular conductivity at low frequency (below
1 kHz), Tuch et al. [39], [40] suggested an approximation of
f (œÉe , de , dŒΩ , di , œÉi ) ‚âà œÉd ee = Œ∑, which becomes a scale factor
between the conductivity tensor C and the diffusion tensor D,
that is,
C = Œ∑D.

T 1 [ms]

(2)

Even though the diffusion tensor D is known from the DTMRI experiment, the scale factor Œ∑ is unknown and varies at
every pixel position [35]. Since the conductivity distribution
(either isotropic or anisotropic) greatly affects the internal current flow during the tDCS treatment [4], [33], it is critical to
properly estimate the value of the position-dependent scale factor Œ∑ in the current density image reconstruction.
C. Generation of Simulated True Current Density Data
In this paper, we generated a simulated true current density
data of J‚àó using the model in Fig. 2. For the skin, skull, and CSF
regions, we used the isotropic conductivity values in Table I. For
the GM and WM regions, we set the anisotropic conductivity
tensor C‚àó as a scalar multiple of the measured water diffusion
tensor Dm , that is, C‚àó = Œ∑ ‚àó Dm . To set the scale factor Œ∑ ‚àó for
the generation of the simulated true current density data, we
adopted the approximation method of Rullmann et al. [41]. In
the current density image reconstruction described later in this
paper, we will estimate this scale factor by using the magnetic
flux density data produced by the tDCS injection current.
To generate a simulated data of the voltage u‚àó inside the head
during tDCS of 1 mA, we numerically solved the following
partial differential equation (PDE) for u‚àó using the ac‚Äìdc module
in COMSOL (COMSOL, Burlington, MA, USA):

‚àá ¬∑ C‚àó ‚àáu‚àó (r) = 0
in Œ©
(3)
‚àó
‚àó
on ‚àÇŒ©
‚àíC ‚àáu (r) ¬∑ n = g(r)

where C‚àó is the simulated true conductivity distribution inside
the head, n is the outward unit normal vector on the boundary
‚àÇŒ©, and g is the Neumann boundary condition of the injected
current. Using the computed simulated true voltage u‚àó , we calculated the simulated true current density J‚àó = ‚àíC‚àó ‚àáu‚àó .
D. Generation of Simulated Measured Magnetic Flux
Density Data
We denote the simulated measured magnetic flux density data
as Bzm . We set Bzm as a sum of the simulated true magnetic flux
density data and a noise, that is, Bzm = Bz‚àó + N , where N is the
added Gaussian noise. Using the numerical method developed
by Minhas et al. [45], we calculated the simulated true magnetic
flux density Bz‚àó using the Biot‚ÄìSavart law on a reduced mesh
of 256 √ó 256 √ó 100. It exactly matched the 3-D MR image
matrix with 0.85 mm √ó 0.85 mm √ó 1.5 mm voxel size used in
the anatomical and diffusion tensor MRI scans described in
Section II-A.
To add practically meaningful amounts of the zero-mean
Gaussian noise to the computed data of Bz‚àó , we first calculated
the root-mean-square (RMS) value of the computed Bz‚àó values
within the skull region as
	


1
Bzsk u ll =
(B ‚àó (r))2 dr.
(4)
Œ©skull Œ© skull z
We set the noise standard deviation of the magnetic flux density
data in the skull region to 20% and 40% of the RMS value.
Using the MR tissue parameters in Table II, we set the noise
standard deviations in other four regions as
sdB z =

sdB zskull
‚àíT R / T 1
( œÅ skull )( 1‚àíe
1‚àíe ‚àíT R / T 1 , skull

œÅ

)(

e ‚àíT E / T 2
e ‚àíT E / T 2 , skull

)

(5)

where sdB zskull is the noise standard deviation in the skull region,
and œÅ denotes the relative proton density of a chosen tissue
normalized by the CSF proton density, and œÅskull is the relative
proton density of the skull region.
E. Current Density Image Reconstruction
Our goal is to quantitatively visualize the internal current
density distribution JtDCS using the measured data of the diffusion tensor Dm before the tDCS treatment and the data
of the induced magnetic flux density Bzm during the tDCS.

KWON et al.: CURRENT DENSITY IMAGING DURING TRANSCRANIAL DIRECT CURRENT STIMULATION USING DT-MRI AND MREIT

We implemented the current density image reconstruction in
three steps.
In the first step, we determined a model-predicted current
density J0 . We assigned the isotropic conductivity values of
0.5160 and 0.0096 S/m for the skin and skull regions, respectively, which were 20% larger and 36% smaller than the values
in Table I. For each pixel in the brain regions of GM, WM,
and CSF, we set its conductivity tensor as a scalar multiple of
the measured diffusion tensor Dm . For all pixels in the brain
region, we used the same initial value for the scale factor as
Œ∑ 0 = 0.7S ¬∑ s/mm3 [40]. Note that the measured diffusion tensor data indicated that the CSF region was isotropic, the GM
region was a little anisotropic [33], and the WM region was
quite anisotropic. Since the diffusion tensor data were available
for all of these brain tissues, we just set the conductivity tensor
of these tissues as scalar multiples of the available diffusion tensors. The amount of anisotropy in each tissue was automatically
handled by the diffusion tensor data. Choosing the conductivity
values of the first step in this way, we could avoid committing
the inverse crime.
We defined the initial conductivity distribution C0 as follows:
‚éß
‚é™
‚é® 0.5160I inside Œ©skin
0
C = 0.0096I inside Œ©skull
‚é™
‚é©
0.7Dm inside Œ©CSF,GM ,W M
where I is the 3 √ó 3 identity matrix. We numerically solved the
following PDE for u0 :

in Œ©
‚àá ¬∑ C0 ‚àáu0 (r) = 0
‚àíC0 ‚àáu0 (r) ¬∑ n = g(r)

on ‚àÇŒ©.

The model-predicted current density of the first step was computed as J0 = ‚àíC0 ‚àáu0 . From the computed J0 , we calculated
the corresponding magnetic flux density Bz0 using the Biot‚Äì
Savart law [45].
In the second step, we improved the current density J0 by
using the data Bzm and the method of the projected current
density [36] as follows:


1 ‚àÇ(Bzm ‚àí Bz0 ) ‚àÇ(Bzm ‚àí Bz0 )
,‚àí
, 0 . (6)
J1 = J0 +
Œº0
‚àÇy
‚àÇx
The updated current density J1 = (Jx1 , Jy1 , Jz0 ) in (6) satisfies
‚àá ¬∑ J1 = 0, and the third component of ‚àá √ó J1 fulfills the following condition in Œ©t :
1
1
‚àá‚ä•
xy (Jx , Jy )(r)

 0 0

1 2  m
‚àáxy Bz (r) ‚àí Bz0 (r)
= ‚àá‚ä•
xy Jx , Jy (r) ‚àí
Œº0
1 2
1 2 0
‚àá Bz (r) ‚àí
‚àá (B m (r) ‚àí Bz0 (r))
Œº0
Œº0 xy z
 2 0

‚àÇ Bz (r) ‚àÇ 2 Bzm (r)
1 2 m
‚àí
= ‚àí ‚àá Bz (r) ‚àí
Œº0
‚àÇz 2
‚àÇz 2
 2 0

 ‚àó ‚àó
‚àÇ Bz (r) ‚àÇ 2 Bzm (r)
‚ä•
= ‚àáxy Jx , Jy (r) ‚àí
‚àí
.
‚àÇz 2
‚àÇz 2

=‚àí

171

Fig. 3. (a) Axial, sagittal, and coronal images of the magnitude of the simulated true current density distribution | J ‚àó | subject to the 1-mA current injection
through the electrode montage Œµ¬± in Fig. 2. (b) Images of the simulated true
magnetic flux density B z‚àó in the same imaging slices as (a).
‚àÇJ1

1

‚àÇ Jx
y
1
1
‚àó
‚àó
‚àó
‚àó
Here, ‚àá‚ä•
xy (Jx , Jy ) := ‚àÇ x ‚àí ‚àÇ y , J = (Jx , Jy , Jz ), and Œ©t
denotes the imaging region, which could be a part of the entire
domain Œ©. The relation (7) implies that the updated current
density matches to the measured Bzm data with the error term
depending on Bzm ‚àí Bz0 . The error between J1 and the true
current density J‚àó satisfies the following stability relation (see
Appendix):


 ‚àÇ 2 Bz0

 1
‚àÇ 2 Bzm 


 J‚ä• ‚àí J‚àó‚ä• 
‚â§C 
‚àí
Œ©t
‚àÇz 2
‚àÇz 2 Œ© t
 

 ‚àÇ(Jz1 ‚àí Jz‚àó ) 


+

‚àÇz
Œ©t

 
+C  J1‚ä• ¬∑ n ‚àí J‚àó‚ä• ¬∑ n ‚àÇ Œ© t

where J1‚ä• = (Jy1 , ‚àíJx1 ) and J‚àó‚ä• = (Jy‚àó , ‚àíJx‚àó ) and  . Œ© t denotes the L2 norm in Œ©t .
Finally, in the third step, we iteratively improved the current
density J1 by using Bzm to reduce the error difference of J1‚ä• ‚àí
J‚àó‚ä• as


1 ‚àÇ(Bzm ‚àí Bzn ) ‚àÇ(Bzm ‚àí Bzn )
,‚àí
,0
(8)
Jn +1 = Jn +
Œº0
‚àÇy
‚àÇx
where n is the index number of the iteration and Bzn is the computed magnetic flux density at the nth iteration. The iterative
step in (8) simply calculates the magnetic flux density Bzn with
the equipped current Jn using the discrete fast Fourier transform
based on the Biot‚ÄìSavart law. Using the iterative update procedure in (8), we produced the final value of the current density
 J n + 1 ‚àíJ n 
<  for a specified
during the tDCS treatment if
 Jn 
tolerance .
III. RESULTS

(7)

Fig. 3(a) shows the axial, sagittal, and coronal images of the
magnitude of the simulated true current density | J‚àó | during the
tDCS current injection through the electrode pair Œµ¬±
1 shown in
Fig. 2. Fig. 3(b) shows the axial, sagittal, and coronal images

172

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 1, JANUARY 2016

Fig. 5. Three components of Jx‚àó , Jy‚àó , and Jz‚àó of the true current density in
the axial slice at z = 67.5 mm from the top of the head are shown in (a), (b),
and (c), respectively. Corresponding three components Jx7 , Jy7 , and Jz7 of the
reconstructed current density after the seventh iteration are shown in (d), (e),
and (f), respectively.

Fig. 4. (a) Magnitude images of the true transversal current densities (|J ‚àóx y |)
inside the GM and WM regions in the five chosen axial slices at z = 75.0,
67.5, 52.5, 43.5, 39.0 mm from the top of the head. (b)‚Äì(d) are the magnitude
images of the reconstructed current densities (|J nx y |) in the same slices at the
first, second, and seventh iterations, respectively. (e)‚Äì(g) are the percentage error
plots between the true and reconstructed current densities at the first, second,
and seventh iterations, respectively. The errors were significantly reduced by
the iterative process.

of the simulated true magnetic flux density Bz‚àó during the same
tDCS current injection.
Using these simulated data, we computed J0 and Bz0 in the
first step and computed the current density J1 using (6). Then,
we iteratively updated x- and y-components of the current density using (8). The iteration converged to its tolerance limit
(10‚àí2 ) at the seventh iteration. Fig. 4 shows the magnitudes
of the transversal components of the true and recover current
densities at the zeroth, first, and seventh iteration steps in the
chosen five axial slices. We plotted the current densities in the
GM and WM regions only for better current density visualization in those clinically important regions. We can clearly see
that the iterative process significantly improved the accuracy of
the reconstructed current density. Fig. 5 plots the x-, y-, and
z-components of the true and recovered current density at the
seventh iteration step in the chosen single slice. Fig. 6 shows
the arrow plots of the true and reconstructed current density at
the seventh iteration step in the chosen three slices.
Fig. 7 shows the relative L2 -error plots of at the axial slice at
z = 67.5 mm from the top of the head for two different electrode
montages. From the plots in the upper row, the errors in the

Fig. 6. (a) Arrow plots of the true current densities in the chosen three slices
at z = 75.0, 67.5, and 52.5 mm from the top of the head. (b) Corresponding
arrow plots of the reconstructed current densities after the seventh iteration.

Fig. 7. Plots of the relative L 2 errors for the electrode montage Œµ¬±
1 (left
column) and Œµ¬±
2 (right column). Plots in the top and bottom rows are the noiseless and noisy cases, respectively. The errors in the transversal current density
Err(|J nx y |) are smaller than the errors in the 3-D current density Err (| J n |) for
both cases.

KWON et al.: CURRENT DENSITY IMAGING DURING TRANSCRANIAL DIRECT CURRENT STIMULATION USING DT-MRI AND MREIT

Fig. 8. Effects of the wrong conductivity values in the skin and skull regions
on the relative L 2 errors for two different electrode montages.

transversal current density Err(|Jnxy |) are relatively smaller than
those of the 3-D current density Err(|Jn |) since the error in the
z-component is not reduced by the iterative process. From the
plots in the bottom row of Fig. 7, we can see that the proposed
method is quite robust against the added measurement noise.
As an extreme case, we set both of the skin and skull conductivity values as 1 S/m in the first step to compute J0 and
Bz0 . The error in J0 increased due to these wrong conductivity
values. Since we could update the transversal current density
using the Bzm data, the L2 errors of the reconstructed transversal current densities were slightly increased as shown in Fig. 8.
However, since the z-component of the current density is not
correlated with Bz , the iterative process using the Bzm data
could not reduce the error in the reconstructed Jz . Therefore,
the total errors in the reconstructed 3-D current density J7 after
the seventh iteration increased more compared with the errors
in the reconstructed transversal current density J7xy after the
seventh iteration.
IV. DISCUSSION
During the tDCS treatment, constant direct current is injected
into the brain through a pair of electrodes attached on the surface of the head. Success of the tDCS treatment depends on
a precise determination of the current density distribution in
different anatomical structures of the brain. Quantitative visualization of the internal current density distribution is desirable to better understand the underlying mechanism and also
to improve the treatment efficacy. In this paper, we proposed
a novel current density image reconstruction method, which
can reliably recover the current density distribution during the
tDCS treatment.
The internal current density distribution is affected by the
object geometry, the electrode size and configuration, and the
internal conductivity distribution. Datta et al. [50], [51] and
Bikson et al. [52] proposed the geometrically subject specific
model to predict the current density distribution inside the brain
during the tDCS treatment. However, the methods did not take
into account of the subject specific conductivity distribution.
The proposed method in this paper is based on the geometrically
correct model, and at the same time it utilizes the magnetic flux
density data induced by the tDCS current. Furthermore, it incorporates the diffusion tensor data, which provides directional
information of the inhomogeneous anisotropic conductivity tensor. Since both the magnetic flux density and diffusion tensor

173

data convey critically important information of the internal conductivity distribution, the proposed method can significantly
improve the accuracy of the recovered current density.
There exists, however, a limitation of the proposed method,
which demands a careful choice of the electrode configuration
for the tDCS treatment. Note that we can measure only the zcomponent Bz of the magnetic flux density data without rotating
the subject and the component Bz does not contribute to the zcomponent Jz of the current density. For this reason, the iterative
step cannot improve the accuracy of the reconstructed Jz using
the Bz data, whereas the Bz data can significantly improve the
quality of both Jx and Jy . To take advantage of the proposed
method in practice, we, therefore, suggest attaching the pair of
electrodes on the head with a limited distance along z-direction.
For experimental validations of the proposed method, we
suggest the following procedure of the tDCS treatment. We
place a subject in a MRI scanner to perform T1 weighted and the
diffusion tensor imaging of the head without the tDCS current
injection. The scan time for both T1 weighted and diffusion
tensor imaging should be about 15 min for dozens of slices.
We should carefully choose the number of slices and also the
gap between slices to build a truncated 3-D model of the head,
which is large enough not to distort the current density by the
limited volume coverage. In this paper, we used 100 slices with
1.5 mm slice thickness and zero-mm gap between them and the
scan time for both T1 weighted and diffusion tensor imaging
was 20 min.
Then, we immediately begin a MREIT scan simultaneously
with the tDCS current injection. The time duration of this
MREIT scan should be adjusted to match the time duration
of the tDCS treatment, which could be between 10 and 20 min.
Since the current injection is continuous throughout the MREIT
scan, we may use a pulse sequence such as the spoiled multi gradient echo to acquire the k-space data. Since we have to extract
the Bz data from two k-space datasets acquired with and without the tDCS current, we need to perform another MREIT scan
without the tDCS current injection using the same MR imaging
parameters. Therefore, the total imaging time will be between
30 and 50 min. Getting all the image datasets, we perform the
segmentation, model construction, and image reconstruction,
which should be done in 10 min.
Using the novel image reconstruction algorithm proposed in
this paper, we can produce cross-sectional images of the current density distribution during the tDCS treatment. The algorithm utilizes both the Bz data from the MREIT scan during
the tDCS treatment and the diffusion tensor map from the prior
DT-MRI scan.
The proposed method is mainly for the monitoring of the internal current density distribution during the tDCS treatment.
For the planning, we may perform anisotropic conductivity
imaging of a subject‚Äôs head prior to the treatment using the recently proposed DT-MREIT method by Kwon et al. [35]. This
requires two independent current injections through two pairs
of electrodes. Once we obtain a 3-D anisotropic conductivity
distribution of the head, we can build a 3-D subject specific
head model including the anisotropic conductivity values. We
may then use the model for tDCS planning, where one can

174

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 63, NO. 1, JANUARY 2016

numerically calculate voltage and current density distributions
in the head for many different tDCS electrode configurations.
V. CONCLUSION
We developed a novel current density image reconstruction
method to produce current density images during the tDCS
treatment. We found that it is important to use a segmented 3-D
subject specific head model with properly estimated isotropic
and also anisotropic conductivity values of different brain tissues. This requires anatomical and diffusion tensor MRI scans
before the treatment. During the treatment in the MRI scanner,
an MREIT scan is needed to acquire the magnetic flux density
data induced by the tDCS current. Numerical simulation results
clearly show that the new method reliably reconstructs current
density images. We suggest in vivo tDCS treatments of animals
and human subjects in a clinical MRI scanner to quantitatively
visualize the current density distribution during tDCS using the
developed current density image reconstruction algorithm. The
new method proposed in this paper will be valuable to find relations between current density distributions in the brain and their
effects on various brain disorders, such as depression, anxiety,
Parkinson‚Äôs disease, and chronic pain.
APPENDIX


 1

The 2-D vectors
= Jy , ‚àíJx1 and J‚àó‚ä• = Jy‚àó , ‚àíJx‚àó can
be decomposed into a divergence free and curl free components,
respectively,
J1‚ä•

J1‚ä• = ‚àáxy f 1 + ‚àáxy √ó Œ®1
in Œ©t
J‚àó‚ä• = ‚àáxy f ‚àó + ‚àáxy √ó Œ®‚àó .

(9)

Here, the divergence free and the curl free components satisfy,

‚àá2xy f 1 = ‚àáxy ¬∑ J1‚ä• in Œ©t


‚àáxy f 1 ¬∑ n = J1‚ä• ¬∑ n

on ‚àÇŒ©t

‚àá2xy Œ®1 = ‚àí‚àáxy √ó J1‚ä•

in Œ©t

Œ®1 = 0

on ‚àÇŒ©t

and



‚àá2xy f ‚àó = ‚àáxy ¬∑ J‚àó‚ä•

in Œ©t

‚àáxy f ‚àó ¬∑ n = J‚àó‚ä• ¬∑ n on ‚àÇŒ©t
‚àá2xy Œ®‚àó = ‚àí‚àáxy √ó J‚àó‚ä•

in Œ©t

‚àó

Œ® =0

on ‚àÇŒ©t .
2

0

2

m

Since ‚àáxy ¬∑ (J1‚ä• ‚àí J‚àó‚ä• ) = ‚àí( ‚àÇ‚àÇ zB2z ‚àí ‚àÇ ‚àÇ Bz 2z ) by (7), the elliptic
stability theory leads to

 


‚àÇ 2 B z0
‚àÇ 2 B zm 
 ‚àáxy f 1 ‚àí ‚àáxy f ‚àó  ‚â§ C 
‚àí
 ‚àÇz2
‚àÇ z 2 Œ©
Œ©t
(10)
t
 1

‚àó

+C( J‚ä• ¬∑ n ‚àí J‚ä• ¬∑ n ‚àÇ Œ© t ).

Since ‚àá ¬∑ J1 = 0 and ‚àá ¬∑ J‚àó = 0, the divergence free
part satisfies



 1
‚àÇ Jz1 ‚àí Jz‚àó
‚àó
.
(11)
‚àáxy √ó J‚ä• ‚àí J‚ä• = ‚àí
‚àÇz
We have the following stability:

 
1
‚àó 



 ‚àáxy (Œ®1 ‚àí Œ®‚àó )  ‚â§ C  ‚àÇ(Jz ‚àí Jz ) 
.


Œ©t
‚àÇz
Œ©t
From the relations (10) and (12), we have

 1
 ‚àÇ 2 Bz0

‚àÇ 2 Bzm
‚àó
 J‚ä• ‚àí J ‚ä• 
‚â§C 
 ‚àÇz 2 ‚àí ‚àÇz 2
Œ©t
 

 ‚àÇ(Jz1 ‚àí Jz‚àó ) 

+


‚àÇz
Œ©t
 1

‚àó
+C( J‚ä• ¬∑ n ‚àí J‚ä• ¬∑ n 

(12)






Œ©t

‚àÇ Œ©t

).

REFERENCES
[1] M. A. Nitsche and W. Paulus, ‚ÄúExcitability changes induced in the human
motor cortex by weak transcranial direct current stimulation,‚Äù J. Physiol.,
vol. 527, no. 3, pp. 633‚Äì639, Sep. 2000.
[2] M. A. Nitsche and W. Paulus, ‚ÄúSustained excitability elevations induced
by transcranial DC motor cortex stimulation in humans,‚Äù Neurology, vol.
57, no. 10, pp. 1899‚Äì1901, Nov. 2001.
[3] T. Wagner et al., ‚ÄúThree-dimensional head model simulation of transcranial magnetic stimulation,‚Äù IEEE Trans. Bio. Eng., vol. 51, no. 9,
pp. 1586‚Äì1598, Sep. 2004.
[4] R. J. Sadleir et al., ‚ÄúTranscranial direct current stimulation (tDCS) in a
realistic head model,‚Äù NeuroImage, vol. 51, no. 4, pp. 1310‚Äì1318, Jul.
2010.
[5] T. C. Miranda et al., ‚ÄúThe electric field in the cortex during Transcranial
current stimulation,‚Äù Neuroimaging, vol. 70, no. 15, pp. 48‚Äì58, Apr. 2013.
[6] M. A. Nitsche and W. Paulus, ‚ÄúNoninvasive brain stimulation protocols
in the treatment of epilepsy: Current state and perspectives,‚Äù Neurotherapeutics, vol. 6, no. 2, pp. 244‚Äì250, Apr. 2009.
[7] F. Fregni et al., ‚ÄúA sham-controlled, phase II trial of transcranial direct
current stimulation for the treatment of central pain in traumatic spinal
cord injury,‚Äù Pain, vol. 122, pp. 197‚Äì209, May 2006.
[8] P. S. Boggio et al., ‚ÄúRepeated sessions of noninvasive brain DC stimulation is associated with motor function improvement in stroke patients,‚Äù
Restorative Neurol. Neurosci., vol. 25, no. 2, pp. 123‚Äì129, 2007.
[9] J. A. Williams and F. Fregni, ‚ÄúUpdates on the use of non-invasive brain
stimulation in physical and rehabilitation medicine,‚Äù J. Rehabil. Med., vol.
41, no. 5, pp. 305‚Äì311, Apr. 2009.
[10] D. P. Purpura and J. G. McMurtry, ‚ÄúIntracellular activities and evoked
potential changes during polarization of motor cortex,‚Äù J. Neurophysiol.,
vol. 28, no. 1, pp. 166‚Äì185, Jan. 1965.
[11] D. J. Albert, ‚ÄúThe effects of polarizing currents on the consolidation of
learning,‚Äù Neuropsychologia, vol. 4, no. 1, pp. 65‚Äì77, Feb. 1966.
[12] R. Sparing and F. Mottaghy, ‚ÄúNoninvasive brain stimulation with transcranial magnetic or direct current stimulation (TMS/tDCS) from insights
into human memory to therapy of its dysfunction,‚Äù Methods, vol. 44,
no. 4, pp. 329‚Äì337, Apr. 2008.
[13] T. Wagner et al., ‚ÄúTranscranial direct current stimulation: A computerbased human model study,‚Äù NeuroImage, vol. 35, no. 3, pp. 1113‚Äì1124,
Feb. 2007.
[14] M. L. G. Joy et al., ‚ÄúIn vivo detection of applied electric currents
by magnetic resonance imaging,‚Äù Magn. Reson. Imag., vol. 7, no. 1,
pp. 89‚Äì94, 1989.
[15] M. L. G. Joy et al.. ‚ÄúImaging of current density and current pathways
in rabbit brain during transcranial electrostimulation,‚Äù IEEE Trans. Bio.
Eng., vol. 46, no. 9, pp. 1139‚Äì1149, Sep. 1999.
[16] G. C. Scott et al., ‚ÄúMeasurement of nonuniform current density by magnetic resonance,‚Äù IEEE Trans. Med. Imag., vol. 10, no. 3, pp. 362‚Äì374,
Sep. 1991.

KWON et al.: CURRENT DENSITY IMAGING DURING TRANSCRANIAL DIRECT CURRENT STIMULATION USING DT-MRI AND MREIT

[17] G. C. Scott et al., ‚ÄúSensitivity of magnetic resonance current density
imaging,‚Äù J. Magn. Reson., vol. 97, no. 2, pp. 235‚Äì254, Apr. 1992.
[18] I. Sersa et al., ‚ÄúMagnetic resonance microscopy of electric currents,‚Äù J.
Magn. Reson. Ser. A, vol. 111, no. 1, pp. 93‚Äì99, Nov. 1994.
[19] E. J. Woo et al., ‚ÄúImpedance tomography using internal current density distribution measured by nuclear magnetic resonance,‚Äù Proc. SPIE,
vol. 2299, pp. 377‚Äì385, 1994.
[20] B. M. Eyuboglu et al., ‚ÄúImaging electrical current density using nuclear
magnetic resonance,‚Äù Elektrik, vol. 6, no. 3, pp. 201‚Äì214 1998.
[21] Y. Z. Ider et al., ‚ÄúUniqueness and reconstruction in magnetic resonance
electrical impedance tomography (MREIT),‚Äù Physiol. Meas., vol. 24,
no. 2, pp. 591‚Äì604, May 2003.
[22] O. I. Kwon et al., ‚ÄúEquipotential line method for magnetic resonance
electrical impedance tomography (MREIT),‚Äù Inverse Probl., vol. 18,
no. 4, pp. 1089‚Äì100, Aug. 2002.
[23] O. Kwon et al., ‚ÄúMagnetic resonance electrical impedance tomography
(MREIT): Simulation study of J -substitution algorithm,‚Äù IEEE Trans.
Biomed. Eng., vol. 48, no. 2, pp. 160‚Äì167, Feb. 2002.
[24] H. S. Khang et al., ‚ÄúJ -substitution algorithm in magnetic resonance electrical impedance tomography (MREIT): Phantom experiments for static
resistivity images,‚Äù IEEE Trans. Med. Imag., vol. 21, no. 6, pp. 695‚Äì702,
Jun. 2002.
[25] O. Birgul et al., ‚ÄúExperimental results for 2D magnetic resonance electrical impedance tomography (MREIT) using magnetic flux density in one
direction,‚Äù Phys. Med. Biol., vol. 48, no. 21, pp. 3485‚Äì3504, Nov. 2003.
[26] N. Gao et al., ‚ÄúNew magnetic resonance electrical impedance tomography
(MREIT) algorithm: The RSM-MREIT algorithm with applications to
estimation of human head conductivity,‚Äù Phys. Med. Biol., vol. 51, no. 12,
pp. 3067‚Äì3083, Jun. 2006.
[27] L. T. Muftuler et al., ‚ÄúIn vivo MRI electrical impedance tomography
(MREIT) of tumors,‚Äù Technol. Cancer Res. Treat., vol. 5, no. 4, pp. 381‚Äì
387, Aug. 2006.
[28] J. K. Seo et al., ‚ÄúReconstruction of conductivity and current density images
using only one component of magnetic field measurements,‚Äù IEEE Trans.
Med. Imag., vol. 50, no. 9, pp. 1121‚Äì1124, Sep. 2003.
[29] S. H. Oh et al., ‚ÄúConductivity and current density image reconstruction
using harmonic B z algorithm in magnetic resonance electrical impedance
tomography,‚Äù Phys. Med. Biol., vol. 48, no. 19, pp. 3101‚Äì3116, Oct. 2003.
[30] E. J. Woo and J. K. Seo, ‚ÄúMagnetic resonance electrical impedance tomography (MREIT) for high-resolution conductivity imaging,‚Äù Physiol.
Meas., vol. 29, no. 10, pp. 1‚Äì26, Oct. 2008.
[31] J. K. Seo and E. J. Woo, ‚ÄúMagnetic resonance electrical impedance tomography (MREIT),‚Äù SIAM Rev., vol. 53, no. 1, pp. 40‚Äì68, 2011.
[32] J. K. Seo and E. J. Woo, ‚ÄúElectrical tissue property imaging at low
frequency using MREIT,‚Äù IEEE Trans. Biomed. Eng., vol. 61, no. 5,
pp. 1390‚Äì1399, May 2014.
[33] S. Grimnes and O. G. Martinsen, Bioimpedance and Bioelectricity Basics.
London, U.K.: Academic, 2008, pp. 94‚Äì137.
[34] J. K. Seo et al., ‚ÄúImage reconstruction of anisotropic conductivity tensor
distribution in MREIT: computer simulation study,‚Äù Phys. Med. Biol.,
vol. 49, no. 18, pp. 4371‚Äì4382, Sep. 2004.
[35] O. I. Kwon et al., ‚ÄúAnisotropic conductivity tensor imaging in MREIT
using directional diffusion rate of water molecules,‚Äù Phys. Med. Biol., vol.
59, no. 12, pp. 2955‚Äì2974, May 2014.

175

[36] C. Park et al., ‚ÄúAnalysis of recoverable current from one component of
magnetic flux density in MREIT,‚Äù Phys. Med. Biol., vol. 52, no. 11, pp.
3001‚Äì3013, Jun. 2007.
[37] M. A. Nitche et al., ‚ÄúTranscaraniel direct current stimulation: State of the
art 2008,‚Äù Brain Stimul., vol. 1, no. 3, pp. 206‚Äì223, Jul. 2008.
[38] A. K. Sen and S. Torquato, ‚ÄúEffective conductivity of anisotropic twophase composite media,‚Äù Phys. Rev. B, vol. 39, no. 7, pp. 4504‚Äì4515,
Mar. 1989.
[39] D. S. Tuch et al., ‚ÄúConductivity tensor mapping of the human brain
using diffusion tensor MRI,‚Äù Proc. Nat. Acad. Sci., vol. 98 no. 20,
pp. 11697‚Äì11701, Sep. 2001.
[40] D. S. Tuch et al., ‚ÄúConductivity tensor mapping of biological tissue using
diffusion MRI,‚Äù Ann. N.Y. Acad. Sci., vol. 888, pp. 314‚Äì316, Nov. 1999.
[41] M. Rullman et al., ‚ÄúEEG source analysis of epileptiform activity using a 1
mm anisotropic hexahedra finite element head model,‚Äù NeuroImage, vol.
44, no. 2, pp. 399‚Äì410, Jan. 2009.
[42] T. F. Oostendorp et al., ‚ÄúThe conductivity of the human skull: Results
of in vivo and in vitro measurements,‚Äù IEEE Trans. Bio. Eng., vol. 47,
no. 11, pp. 1487‚Äì1492, Dec. 2000.
[43] S. B. Baumann et al., ‚ÄúThe electrical conductivity of human cerebrospinal
fluid at body temperature,‚Äù IEEE Trans. Bio. Eng., vol. 44, no. 3, pp.
220‚Äì223, Mar. 1997.
[44] K. Jeon et al., ‚ÄúMREIT conductivity imaging of the post-mortem canine
abdomen using CoReHA,‚Äù Physiol. Meas., vol. 30, no. 9, pp. 957‚Äì966,
Sep. 2009.
[45] A. S. Minhas et al., ‚ÄúThree dimensional MREIT simulator of static
bioelectromagnetism and MRI,‚Äù Biomed. Eng. Lett., vol. 1, no. 2,
pp. 129‚Äì136, May 2011.
[46] G. E. Gold et al., ‚ÄúMusculoskeletal MRI at 3.0 T: Relaxation times and
image contrast,‚Äù Am. J. Roentgenol., vol. 183, no. 2, pp. 343‚Äì351, Aug.
2004.
[47] B. M. Damon, ‚ÄúEffects of image noise in muscle diffusion-tensor (DT)MRI assessed using numerical simulations,‚Äù Magn. Reson. Imag., vol. 60,
no. 4, pp. 934‚Äì944, Oct. 2008.
[48] J. P. Wansapura et al., ‚ÄúNMR relaxation times in the human brain at 3.0
Tesla,‚Äù J. Magn. Reson. Imag., vol. 9, no. 4, pp. 531‚Äì538, Apr. 1999.
[49] K. P. Whittall et al., ‚ÄúIn-vivo measurement of T 2 distributions and water
contents in normal human brain,‚Äù Magn. Reson. Imag., vol. 37, no. 1,
pp. 34‚Äì43, Jan. 1997.
[50] A. Datta et al., ‚ÄúIndividual model predicts brain current flow during transcranial direct-current stimulation treatment in responsive stroke patient,‚Äù
Brain Stimul., vol. 4, no. 3, pp. 169‚Äì174, Jul. 2011.
[51] A. Datta et al., ‚ÄúInter-individual variation during transcranial direct current
stimulation and normalization of dose using MRI-derived computational
models,‚Äù Front. Psych., vol. 3, pp. 1‚Äì8, Oct. 2012.
[52] M. Bikson et al., ‚ÄúHigh-resolution modelling assisted design of customized and individualized transcranial direct current stimulation protocols,‚Äù J. Int. Neuromodulation Soc., vol. 15, no. 4, pp. 306‚Äì315, Jul.
2012.

Authors‚Äô photographs and biographies not available at the time of publication.

