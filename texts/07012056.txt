IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

1503

Accuracy of Femur Angles Estimated by IMUs
During Clinical Procedures Used to Diagnose
Femoroacetabular Impingement
Ryan S. McGinnis∗ , Stephen M. Cain, Sui Tao, David Whiteside, Grant C. Goulet, Elizabeth C. Gardner,
Asheesh Bedi, and Noel C. Perkins

Abstract—We present a novel method for quantifying femoral
orientation angles using a thigh-mounted inertial measurement
unit (IMU). The IMU-derived femoral orientation angles reproduce gold-standard motion capture angles to within mean (standard deviation) differences of 0.1 (1.1) degrees on cadaveric
specimens during clinical procedures used for the diagnosis of
Femoroacetabular Impingement (FAI). The method, which assumes a stationary pelvis, is easy to use, inexpensive, and provides femur motion trajectory data in addition to range of motion
measures. These advantages may accelerate the adoption of this
technology to inform FAI diagnoses and assess treatment efficacy.
To this end, we further investigate the accuracy of hip joint angles
calculated using this methodology and assess the sensitivity of our
estimates to skin motion artifact during these tasks.
Index Terms—Femoroacetabular impingement (FAI), hip angles, inertial measurement unit (IMU).

I. INTRODUCTION
EMOROACETABULAR impingement (FAI) is one of the
most common mechanical precursors to the development
of osteoarthritis of the nondysplastic hip [1]. FAI is caused by
surfeit acetabular coverage and/or asphericity of the femoral
head, leading to repetitive microtrauma to the labrum and/or the
acetabular cartilage [2], resulting in hip pain for patients of all
ages [2]–[4]. Diagnosis of FAI often proceeds from standard
clinical range of motion (ROM) tests (i.e., FABER, FADIR,
etc.) used to identify abnormal deficits in terminal joint motion
and/or specific, pain inducing hip angles [2]. The ROM values in
these tests are often estimated visually or from goniometers [2],
both of which exhibit poor intertester reliability [5]. Moreover,

F

Manuscript received July 3, 2014; revised December 7, 2014; accepted January 10, 2015. Date of publication January 16, 2015; date of current version
May 18, 2015. Asterisk indicates corresponding author.
∗ R. S. McGinnis was with the School of Kinesiology and the Department of
Mechanical Engineering, University of Michigan, Ann Arbor, MI 48109 USA.
He is now with MC10, Inc. Cambridge, MA 02140 USA (e-mail: ryanmcg@
umich.edu).
S. M. Cain is with the School of Kinesiology and the Department of Mechanical Engineering, University of Michigan.
S. Tao and N.C. Perkins are with the Department of Mechanical Engineering,
University of Michigan (e-mail: ncp@umich.edu).
D. Whiteside and G. C. Goulet are with the School of Kinesiology, University
of Michigan (e-mail: gcgoulet@umich.edu).
E. C. Gardner is with the Department of Orthopedic Surgery, Yale University.
A. Bedi is with the Department of Orthopedic Surgery, University of Michigan.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2392758

goniometric and visual assessments provide only an end measure of hip ROM in each motion plane and not the hip motion
trajectory that achieves that end position. Without trajectory information, clinicians potentially lose valuable diagnostic data.
Significant benefits would follow from the development of a
precise, noninvasive method for measuring hip angles (ROM
and motion trajectory) in clinical settings to reveal pathology.
Optical motion capture (MOCAP) is a common tracking
modality used to quantify joint angles [6]. MOCAP typically
employs an array of high-speed cameras arranged around the
perimeter of a measurement volume. The cameras record 3-D
position coordinates of a set of markers, which are often reflective targets (e.g., [6]–[8]). To estimate hip joint angles, markers
are affixed to bony anatomical landmarks, which are then used
to construct anatomical reference frames for the pelvis and femur [9]. The relative orientation of these reference frames can
be decomposed into joint angles following standard Euler decomposition [10]. These joint angle estimates are susceptible to
artifacts due to the additional movement of markers affixed to
soft tissue [11]. MOCAP systems are expensive, and the associated marker placement, calibration, data collection, and data
processing require considerable time and expertise. For these
reasons, MOCAP has not been widely adopted in clinical settings.
Fortunately, many of these shortcomings are addressable by
advancing an alternative technology for calculating joint angles,
namely miniaturized inertial measurement units (IMUs). Miniature IMUs, which incorporate microelectromechanical systems
(i.e., MEMS accelerometers and angular rate gyros), measure
the angular velocity and linear acceleration of any rigid body
to which they are attached. When deployed on body segments
adjacent to a joint, miniature IMUs provide data that can be used
to calculate joint angles [7], [8], [12]–[17]. Moreover, IMUs are
highly portable and can be deployed in the clinic for a small fraction of the cost of MOCAP [18], [19]. These advantages provide
substantial motivation for advancing IMUs for quantifying joint
angles in clinical settings.
Recent studies have investigated the validity of IMUtechnology for estimating joint angles. For example, [12], [13],
[16], [17], [20] and [21] employed IMUs for calculating knee
angle during gait and address the effects of drift error on the estimated joint angles by fusing separate estimates from accelerometer, gyro, and magnetometer data (if available). The accuracy
of orientation drift correction methods are evaluated in [7] by
comparing IMU and MOCAP estimates of pelvis, thigh, and

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1504

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

shank orientation during maximal hip flexion and abduction,
walking, squatting, and standing on one leg. The accuracy of a
commercially available IMU system (Xsens MVN BIOMECH,
Enschede, Netherlands) for estimating rotations across the hip,
knee, and ankle during level walking, stair ascent, and stair descent is revealed in [8]. Excellent agreement in flexion/extension
is observed with poor agreement in abduction/adduction and
internal/external rotation. Interestingly, few studies report inaccuracies due to the relative motion between soft tissue and the
underlying bony anatomy, which remains a potential source of
error. One excellent example [16] explores the error in IMUderived knee angles during gait trials from a transfemoral amputee, and cites skin motion as the primary source for larger
errors in the intact leg knee angle estimates as compared to the
prosthetic. However, no studies investigate the level of accuracy
achievable from this technology in the clinical tests used for
the diagnosis of FAI or how soft tissue motion may impact the
clinical relevance of these measurements.
We build upon this body of research by presenting a novel
IMU orientation drift correction technique for estimating hip
joint angles using optimization during the clinical tests used to
diagnose FAI, we establish the validity of this technique compared to gold standard MOCAP, and specifically investigate the
effects of soft tissue motion on angle estimates. The promising
results presented herein may accelerate the adoption of this technology to inform FAI diagnoses and assess treatment efficacy.
II. METHODS
Two fresh-frozen human cadaveric hemipelvises (one male
and one female, ages 55 and 76 years, respectively) were harvested for testing following a protocol approved by the University of Michigan Institutional Review Board. Specimens with a
history of illness, injury, or treatment affecting the hip or pelvis
were excluded. Specimens were stored at −29 °C and thawed
for a minimum of 24 h prior to testing. The intact pelvis of each
specimen was affixed to a custom base using external fixator
constructs (Smith and Nephew, Stryker Hoffman II) positioned
at the bilateral iliac wings, and further, secured with tensioned
nylon straps to restrict pelvis motion (see Fig. 1). Prior to testing, care was taken to ensure that fixation did not interfere with
rotation across the hip joint.
A. Dynamic Testing Protocol
Hips were precycled ten times in flexion, abduction, adduction, and internal and external rotation prior to data collection.
The right hip of each specimen was then taken through two
movement sequences designed to exercise the hip through its
full ROM. All hip manipulation was performed by the same
experienced clinician. In the first sequence, referred to as the
“combined” test, the hip was moved in isolated flexion, abduction, and adduction in approximately 0° flexion (leg flat on
table), as well as internal and external rotation in both 0° flexion
and 90° flexion. In the second sequence, referred to as the “clinicians” test, the hip was placed into a position of simultaneous
maximum flexion, abduction, and external rotation (FABER),
and subsequently, simultaneous maximum flexion, adduction,

Fig. 1. Hemipelvis specimen mounted to testing base using bilateral external
fixator constructs and tensioned nylon straps. MOCAP markers mounted to bone
pins inserted into the pelvis.

and internal rotation (FADIR) to replicate two commonly used
clinical tests for the diagnosis of FAI [2]. In both motion sequences, the hip was exercised to the point of terminal motion
and held in this position for at least 2 s. Each hip was taken
through the protocol three times in succession, before the hip
joint capsule was surgically altered for a separate, but related
study. Four capsular conditions were investigated for each hip,
yielding 12 “combined” and 12 “clinicians” tests. Issues with
MOCAP and IMU data precluded the use of two trials, resulting
in 46 tests for analysis (24 “combined” and 22 “clinicians”).
Following testing, anatomical hip angles and femoral orientation angles were calculated using data from two motion sensing
technologies: 1) optical motion capture, and 2) a femur-mounted
inertial measurement unit.
B. Anatomical Hip Angles From Motion Capture
Twenty-six retro-reflective markers (7 calibration; 19 tracking), 12 mm in diameter, were affixed to each specimen.
A 12-camera VICON MX system (VICON Motion Systems,

McGINNIS et al.: ACCURACY OF FEMUR ANGLES ESTIMATED BY IMUs DURING CLINICAL PROCEDURES

1505

TABLE I
ANATOMICAL REFERENCE FRAME DEFINITIONS FOR THE PELVIS AND FEMUR
Segment
Pelvis
Origin
x-axis
y-axis
z-axis
Femur
Origin
x-axis
y-axis
z-axis

Fig. 2. Mounting location of the two inertial sensors on MOCAP marker
frames affixed to each subject. The pin sensor is secured to an ex-fix pin inserted
into the femoral shaft while the skin sensor is secured to the soft tissue of the
thigh.

Definition

3-D midpoint of ASIS markers
Unit vector directed from mid-PSIS to pelvis origin
Cross product of z- and x-axes
Unit vector directed from left ASIS to right ASIS
Hip joint center
Cross product of y- and z-axes
Unit vector directed proximally from knee joint center to hip joint center
Unit vector directed from medial to lateral femoral condyles

filter [24] with the optimal mean squared error of 1 mm determined by a residual analysis. In accordance with [10], anatomical hip joint rotations were expressed using the Euler ZXY decomposition yielding flexion/extension, adduction /abduction,
and internal/external rotation angles.
C. Anatomical Hip Angles From an Inertial Sensor

Oxford, U.K.) operating at 240-Hz tracked 3-D marker trajectories. To eliminate the effect of soft tissue artifact, pelvis motion
was derived from three markers affixed to pins surgically inserted into the ilia (see Fig. 1). Similarly, a pin was inserted into
the femoral shaft and mounted with a frame containing four
markers (see Fig. 2) that were used to record the motion of the
underlying bone. An identical frame was superficially mounted
on the skin of the thigh using elastic, self-adhesive athletic tape,
congruent with typical in vivo motion capture conditions. In
previous and current studies, we have found that mounting devices to the skin in this fashion is simple and provides adequate
hold even for highly dynamic motions (e.g., running, cutting,
jumping). The markers on each frame were used to create arbitrary “bone-mounted” and “skin-mounted” segmental reference
frames from which hip joint kinematics were subsequently derived.
Prior to the dynamic protocol, a static trial was collected in
accordance with the calibrated anatomical systems technique
[22]. The bilateral anterior super iliac spines (ASIS) and the
midpoint of the posterior superior iliac spine (PSIS) markers
were stored in the reference frame created by the surgically attached iliac markers. Likewise, the medial and lateral femoral
condyles were stored in the arbitrary femoral reference frames.
The knee joint center was considered as the 3-D midpoint of
the femoral condyle markers. Hip joint center was calculated
for each motion using a “pivoting” algorithm [23]. The aforementioned landmarks and joint centers were then used to define
the anatomical reference frames in each trial according to the
standards outlined in [10] (see Table I).
Gaps in the raw marker trajectories were identified automatically within the VICON Nexus software (VICON Motion Systems, Oxford, U.K.). These gaps were infrequent, persisted for
no more than 15 frames and were ultimately interpolated using
a cubic spline. Data were subsequently filtered using a Woltring

The femur-mounted IMUs were commercially available YEI
3-Space sensors (Yost Engineering, Portsmouth, OH, USA).
Prior to use, the IMUs were calibrated following the procedure
detailed in [25]. Data were sampled at approximately 300 Hz,
written to flash memory on the device, and subsequently, downloaded to a computer via USB after each data collection session.
The devices were secured to the motion capture marker frames
used to define the “bone-mounted” and “skin-mounted” segmental reference frames (see Fig. 2). The IMUs were calibrated
while attached to the marker frames to ensure alignment between the sense axes of each IMU and the reference directions
of the attached frame.
Defining anatomical hip angles poses a challenge for inertial
sensor-based measurement techniques as the anatomical angles
rely on reference frames defined by the location of bony anatomical landmarks—locations the IMU has no means of sensing.
As an alternative, one can identify these reference frames using functional “calibration” motions before the anatomical hip
angles are calculated [12], [20]. Calibration motions were performed prior to each round of the dynamic protocol, where
the hip was moved in isolated internal and external rotation
with 0° flexion. A principle component analysis of the measured angular velocity yields the primary rotation axis during
this motion. This axis is assumed to define the mechanical axis
of the femur thereby establishing the relationship between the
“bone-mounted”/“skin-mounted” frames and the y-axis of the
anatomical femoral reference frame. This direction is then held
fixed in the femur for the following round of the dynamic protocol. The remaining anatomical reference directions are established by considering the initial orientation of the mechanical
axis of the femur. Specifically, we assume that the femur is
at rest at the beginning of each test, the anatomical femoral
and pelvic reference frames are aligned, and the z-axis of each
lies in the horizontal plane. Since the accelerometer measures
translational acceleration as well as gravity, when the IMU is at

1506

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

rest, the accelerometer establishes the direction of gravity in the
sensor frame of reference. The cross product of this direction
with the mechanical axis of the femur establishes the relationship between the “bone-mounted”/“skin-mounted” frames and
the z-axes of the anatomical frames. Finally, the x-axes of the
anatomical frames follow from right-handed frame convention.
This procedure establishes the (constant) direction cosine matrix
between the femoral anatomical frame (F) and either the “bonemounted” frame (B) or the “skin-mounted” frame (S) (CF /B
and CF /S , respectively). Acceleration and angular velocity data
from each IMU are then used to calculate the direction cosine
matrix between the pelvic and femoral anatomical frames CFP
for the duration of the trial beginning from an initially aligned
state as follows.
Assuming the pelvis is fixed, the evolution of the direction
cosine matrix is governed by the differential equation
d
CP /F = CP /F ω
 m |×
F
dt

(1)

where ω
 m |×
F is the measured angular velocity vector of the femur, resolved in the femoral anatomical frame (e.g., ω
 m |×
F =
 ×

CF /B ω
 m B ), in skew symmetric form, and CP /F is the direction cosine matrix describing the orientation of the anatomical frame of the femur relative to the fixed pelvis (P). Numerical
solution to (1) following [26] yields CP /F at every sampled
time during the trial using the trivial (3 × 3 identity) initial
condition. This solution for CP /F is subject to drift error, a
well-known phenomenon with inertial sensors [27], [28]. To
provide the best estimates of femur orientation, and therefore,
hip angle, this error needs to be estimated and removed. This is
often accomplished by fusing drift-prone orientation estimates
from the gyro with drift free but noisy or incomplete orientation
estimates from the accelerometer and/or magnetometer (e.g.,
[27] and [29]). Because of the possibility of locally changing
magnetic fields in clinical settings, we utilize orientation estimates from the accelerometer alone to correct for orientation
drift. This correction is accomplished via a novel optimization
approach, which uses estimates of the direction of gravity from
the accelerometer and rate gyros throughout the test to define
small corrections to the angular velocity data. The corrected
angular velocity is defined according to
⎤
⎡ ⎤
⎡
0
0
bx
1 + sx
0 ⎦ω
1 + sy
 m − ⎣ by ⎦
(2)
ω
 =⎣ 0
bz
0
0
1 + sz
where sx , sy , and sz are small adjustments to the scale factor
values for each sense axis, and bx , by , and bz are corresponding
small adjustments to the bias values identified for each trial.
To identify these six unknowns, we consider instances during
the trial when the femur is held at rest, which is readily indicated when the magnitude of the measured angular velocity falls
within the device noise floor, and the measured acceleration differs from 1 g by less than the magnitude of its noise floor. At
these sampled times (ti ), the gyro-derived direction of gravity
predicted by integration of (1) follows from
gg (ti ) = CPT /F (ti |sx , sy , sz , bx , by , bz ) ga (0)|P

(3)

where gg (ti ) is the gyro-derived direction of gravity
at time ti resolved in the femoral anatomical frame,
CPT /F (ti |sx , sy , sz , bx , by , bz ) is the transpose of the direction
cosine matrix at time ti parameterized by the six unknown gyro
corrections, and ga (0)|P is the direction of gravity determined
from the accelerometer while the femur was held at rest at the
start of the trial, resolved in the pelvic anatomical frame. The
accelerometer-derived direction of gravity is defined according
to
ga (ti ) = CF /B am (ti )

(4)

where ga (ti ) is resolved in the femoral anatomical frame, and
am (ti ) is the measured acceleration at time ti . Equation (4) is
written for an acceleration measured by the “bone-mounted”
IMU, one could also construct the analogous equation for the
“skin-mounted” sensor. The angular difference between these
two vectors is defined by the dot product
	


ga (ti ) · gg (ti )
e (ti |sx , sy , sz , bx , by , bz ) = cos−1
(5)
|ga (ti )| |gg (ti )|
where e (ti |sx , sy , sz , bx , by , bz ) is the angular difference at
time ti parameterized by the six unknown gyro corrections.
Drift, being a one-sided error, increases monotonically in
time. Thus, as ti increases, the contribution of drift error to
e (ti |sx , sy , sz , bx , by , bz ) increases and overwhelms contributions from all other sources (i.e., noise in the accelerometer
gravity estimate, small calibration misalignments, etc.). Accordingly, we minimize the objective function
E (sx , sy , sz , bx , by , bz ) =
n

(e (ti |sx , sy , sz , bx , by , bz ) · ti )2

(6)

i=1

for all (n > 2) sampled “still” times to solve for the six unknown gyro corrections. Here, E (sx , sy , sz , bx , by , bz ) denotes
the sum squared angle difference between gyro and accelerometer gravity directions weighted by the sampled “still” time to
consider differences primarily due to drift. This nonlinear minimization is accomplished in MATLAB (MathWorks, Natick,
MA, USA) using the lsqnonlin function with the Levenberg–
Marquardt (i.e., damped least squares) algorithm. Following
convergence of this numerical optimization, the corrected angular velocity follows from (2). The method of [26] is used
with this corrected angular velocity to define a corrected direction cosine matrix CP /F via numerical solution of (1). As
with MOCAP, the anatomical hip joint rotations are then calculated via an Euler decomposition yielding flexion/extension,
adduction/abduction, and internal/external rotation angles for
comparison.
D. Comparing Femoral Orientation Angles From IMU and
Motion Capture Data
As stated earlier, the definition of anatomical hip angles poses
a challenge for inertial sensor-based measurement techniques
because of difficulties identifying anatomical reference frames.
Significant errors in adduction/abduction and internal/external
rotation angles arise from small misalignments in the anatomical

McGINNIS et al.: ACCURACY OF FEMUR ANGLES ESTIMATED BY IMUs DURING CLINICAL PROCEDURES

1507

frames [8], [30]. To demonstrate the accuracy of the proposed
IMU orientation drift correction, we must first correct for misalignment in the IMU anatomical reference frames. To this end,
we define the femoral orientation angles (X, Y, Z) as the IMU
estimates of the anatomical hip angles defined previously (flexion/extension, adduction/abduction, and internal/external rotation). To calculate these same angles from MOCAP data, we
construct the direction cosine matrix CP /F by considering the
orientation of the “bone-mounted” or “skin-mounted” frames
defined using the attached reflective markers, which we denote
as M CP /F . Specifically, the 3-D position data for each of the
four markers is used to construct the direction cosine matrix,
which defines the orientation of the “bone-mounted” or “skinmounted” frame relative to the ground frame (G) of the motion
capture system (M CG /B for bone-mounted and M CG /S for
skin-mounted) established during system calibration. The fixed
rotation from the “bone-mounted” or “skin-mounted” frame to
the femur anatomical frame (CF /B for bone-mounted and CF /S
for skin-mounted), established by the IMU-based methodology,
is then used to define the orientation of the femur anatomical
frame relative to the ground motion capture frame per
M

CG /F = M CG /B CFT /B

(7)

where M CG /F defines the orientation of the femoral frame
relative to the motion capture ground frame. Since the pelvic
and femoral frames are aligned at the beginning of each test,
M
CG /F (0) defines the fixed rotation (M CP /G ) between the
MOCAP ground frame and the IMU-defined pelvis frame. Finally, the orientation of the IMU-defined femoral frame relative
to the pelvis frame is determined via
M

CP /F = M CP /G M CG /B CFT /B

(8)

where M CP /F defines the orientation of the femoral frame relative to the IMU-defined pelvic frame. Equations (7) and (8)
have been written for the “bone-mounted” frame, but analogous equations can be developed for the “skin-mounted” frame
as well. The matrix M CP /F can then be decomposed multiple
ways, but we follow the convention in [10]; namely, a ZXY decomposition, yielding X, Y, and Z femoral orientation angles for
direct comparison with those from the IMU-based method.

Fig. 3. Example flexion/extension (Flex/Ext), adduction/abduction (Ad/Ab),
and internal/external rotation (Ir/Er) angles as estimated from IMU (gray) and
MOCAP (black) data during the “combined” (a) and “clinicians” (b) tests.
Example still phases used to correct for drift error indicated by gray shading in
(b).

III. RESULTS
To establish the accuracy of the IMU orientation measurements, we report differences between 1) IMU and MOCAP
estimates of anatomical hip angles, 2) IMU and MOCAP estimates of femoral orientation angles, and 3) pin and skin IMU
estimates of femoral orientation angles.
A. Anatomical Hip Angles
Fig. 3 illustrates flexion/extension (Flex/Ext), adduction/abduction (Ad/Ab), and internal/external rotation (Ir/Er)
angles as estimated from IMU (gray) and MOCAP (black) data
during representative “combined” [see Fig. 3(a)] and “clinicians” [Fig. 3(b)] tests. Consistent with previous studies [8],
[13], the results of Fig. 3 confirm that, for both the “combined”

and “clinicians” tests, there is excellent agreement between IMU
and MOCAP estimates of Flex/Ext angle, but poorer agreement
in Ad/Ab and Ir/Er. These facts are further revealed in the correlation plots of Fig. 4 where IMU anatomical angles are plotted
against their MOCAP counterparts during the example “clinicians” test reported in Fig. 3(b). A reference (black) line with
unit slope and zero intercept is added. Table II provides summary results of the full dataset (N = 46) including the mean
(SD) of the mean and standard deviation of the difference in
the anatomical angles, as well as the mean (SD) of the slope,
intercept, and R2 of best-fit lines to the correlation plot data.
These results reveal that the IMU estimates for the Flex/Ext,
Ad/Ab, and Ir/Er hip angles exhibit mean (SD) differences
of −1.0 (1.1), 5.7 (5.8), and 3.4 (3.6) degrees, respectively,

1508

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

TABLE II
AGREEMENT BETWEEN IMU AND MOCAP ESTIMATES OF THE
FLEXION/EXTENSION (FLEX/EXT), ADDUCTION/ABDUCTION (AD/AB), AND
INTERNAL/EXTERNAL ROTATION (IR/ER) ANGLES OF THE HIP SUMMARIZED BY
THE MEAN (SD) OF THE MEAN AND SD OF THE DIFFERENCE, AND THE SLOPE,
INTERCEPT, AND R2 OF THE BEST-FIT LINE TO THE CORRELATION PLOT DATA
Angle

Mean (deg)

SD (deg)

Slope

Intercept

R2

Flex/Ext
Ad/Ab
Ir/Er

−1.00 (1.12)
5.72 (4.64)
3.42 (2.07)

2.64 (1.12)
5.78 (2.77)
3.58 (1.82)

1.01 (0.03)
0.96 (0.16)
0.83 (0.12)

0.63 (0.58)
−5.62 (4.56)
−2.26 (1.71)

1.00 (0.00)
0.74 (0.13)
0.92 (0.09)

relative to those estimated using MOCAP. The differences in
the anatomical angles derive from misalignment between IMU
and MOCAP anatomical reference frames as evidenced by the
accuracy of the femoral orientation angles reported next.
B. Femoral Orientation Angles
Fig. 5 illustrates example X, Y, and Z femoral orientation angles as calculated from IMU (gray) and MOCAP (black) data
from representative “combined” (A) and “clinicians” (B) tests.
For reference, the X angle is nearly flexion/extension, the Y is
nearly adduction/abduction, and the Z is nearly internal/external
rotation. The close agreement for all angles evident in Fig. 5 is
further confirmed by the correlation plots for the “clinicians” test
[see Fig. 5(b)] presented in Fig. 6(a)–(c), where IMU X, Y, and
Z angles are plotted against their MOCAP counterparts. Again a
reference (black) line with unit slope and zero intercept is added
for comparison. This agreement is consistent across all trials
considered (92 total: 46 pin and 46 skin) as evidenced by average
mean (SD) differences in the X, Y, and Z angles of −0.06(0.53),
0.02(0.96), and −0.09(1.12) degrees, respectively. Table III
summarizes the results for the 92 tests by reporting the mean
(SD) of the mean and standard deviation of the difference in the
three orientation angles, as well as the mean (SD) of the slope,
intercept, and R2 of best-fit lines to the correlation plot data.
C. Influence of Skin Artifact

Fig. 4. Correlation plots of flexion/extension (a), adduction/abduction (b),
and internal/external rotation (c) angles during the example “clinicians” test
reported in Fig. 3. A reference (black) line with unit slope and zero intercept is
added.

Consider next possible differences between the pin- and skinmounted IMU estimates of the femoral orientation angles due
to soft tissue artifact. Fig. 7 illustrates representative X, Y, and Z
femoral orientation angles as calculated from the pin (black) and
skin (gray) IMUs during the “combined” (A) and “clinicians”
(B) tests. For the X femoral orientation angle, the pin and skin
estimates are nearly identical. By contrast, there are observable
discrepancies in the Y and Z angles due to skin artifact. These
discrepancies are further revealed in the correlation plots for
the “clinicians” test [see 7(b)] presented in 8(a)–(c), where skin
X, Y, and Z angles are plotted against the corresponding pin
angles. As before, a reference (black) line with unit slope and
zero intercept is added. It is evident from the correlation plots
in 8, as well as from the time history plots in 7, that soft tissue
artifact influences the femoral orientation angles, particularly in
the frontal and transverse planes. This influence is consistent
across all trials (N = 46) as evidenced by average mean (SD)
differences in the X, Y, and Z orientation angles of −1.68(2.35),

McGINNIS et al.: ACCURACY OF FEMUR ANGLES ESTIMATED BY IMUs DURING CLINICAL PROCEDURES

1509

Fig. 5. Representative X, Y, and Z femoral orientation angles estimated from
IMU (gray) and MOCAP (black) data during the “combined” (a) and “clinicians”
(b) tests.

−2.63(3.13), and 6.41(6.44) degrees, respectively, reported with
other summary results in Table IV.
IV. DISCUSSION
A new IMU orientation drift correction algorithm is proposed herein for quantifying the angular displacement of the
femur during common clinical tests used for the diagnosis of
FAI and other morphological abnormalities of the prearthritic
hip (e.g., [2]). The validity of IMU-based hip angle measurements in these clinical tests has not previously been reported.
Below, we discuss the validity of 1) the estimated anatomical hip
joint angles, followed by 2) the estimated femoral orientation
angles. In so doing, we also comment on orientation estimates
reported in the literature. Finally, we discuss how soft tissue
motion influences the estimated femoral orientation angles and
the potential implications for clinical diagnosis of FAI.

Fig. 6. Correlation plots (IMU versus MOCAP) of X (a), Y (b), and Z (c)
femoral orientation angles during the representative “clinicians” test reported in
Fig. 5. A reference (black) line with unit slope and zero intercept is added for
comparison.

1510

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

TABLE III
AGREEMENT BETWEEN IMU AND MOCAP ESTIMATES OF THE X, Y, AND Z
FEMORAL ORIENTATION ANGLES SUMMARIZED BY THE MEAN (SD) OF THE
MEAN AND SD OF THE DIFFERENCE, AND THE SLOPE, INTERCEPT, AND R2 OF
THE BEST-FIT LINE TO THE CORRELATION PLOT DATA
Angle

Mean (deg)

SD (deg)

Slope

Intercept

R2

X
Y
Z

−0.06 (0.32)
0.02 (1.39)
−0.09 (0.85)

0.53 (0.18)
0.96 (0.49)
1.12 (0.68)

1.00 (0.01)
0.99 (0.04)
0.99 (0.06)

−0.03 (0.24)
0.00 (1.35)
0.18 (0.63)

1.00 (0.00)
0.99 (0.02)
0.99 (0.01)

Fig. 7. Representative X, Y, and Z femoral orientation angles as estimated
from the pin (black) and skin (gray) IMU data during the “combined” (a) and
“clinicians” (b) tests.

A. Validity of Anatomical Hip Angles
The validity of IMU-based measurements of anatomical hip
angles has previously been explored in the literature in the
context of gait analysis (e.g., [8], [17] and [31]). However, no
studies have investigated the validity of IMU-based measurements for estimating hip angles during the common clinical tests

Fig. 8. Correlation plots (Skin versus Pin) of X (a), Y (b), and Z (c) angles
during the example “clinicians” test reported in Fig. 7. A reference (black) line
with unit slope and zero intercept is added.

McGINNIS et al.: ACCURACY OF FEMUR ANGLES ESTIMATED BY IMUs DURING CLINICAL PROCEDURES

for FAI. Despite the simplification of a fixed pelvis, these tests
exercise the hip through very large ranges in each motion plane,
which is distinct from the gait-induced hip motions (largely restricted to the sagittal plane) considered in related studies [7],
[30]. According to [30], this increased ROM can significantly
amplify slight misalignments in the IMU anatomical frame, and
yield erroneous joint angle estimates. The proposed functional
calibration seeks to reduce this misalignment error, yet its success is also limited as evidenced by the average mean (SD) differences in the anatomical hip angles across all trials (N = 46)
of −1.0 (1.1) degrees in flexion/extension, 5.7 (5.8) degrees in
adduction/abduction, and 3.4 (3.6) degrees in internal/external
rotation. The effects of misalignment are further revealed by
considering the average slope and coefficient of determination
(R2 ) of the best-fit lines from the correlation plot data (IMU
versus MOCAP angles), which are 1.01 (1.00), 0.96 (0.74),
and 0.83 (0.92), for the flexion/extension, adduction/abduction,
and internal/external rotation angles, respectively. These results
suggest that, on average, the IMU overestimates the MOCAP
flexion/extension angle by 1%, and underestimates the adduction/abduction and internal/external rotation angles by 4% and
17%, respectively, relative to the MOCAP angle. Moreover, the
IMU-derived estimates explain nearly 100% of the variance in
the flexion/extension angle, 92% of the variance in the internal/external rotation angle, but only 74% of the variance in
the adduction/abduction angle. Simple correction for anatomical frame misalignment yields the femoral orientation angles
reported next having significantly improved levels of agreement.
B. Validity of Femoral Orientation Angles
The accuracy of the hip angle drift correction algorithm is
revealed after first correcting for the misalignment between the
IMU and MOCAP anatomical reference frames. Doing so allows
a direct comparison of femoral orientation angles (X, Y, Z) calculated from IMU and MOCAP data to within a small residual
misalignment error due to construction of the MOCAP marker
frames. The resulting X, Y, and Z orientation angles correspond
to IMU-estimated flexion/extension, adduction/abduction, and
internal/external rotation angles since the MOCAP anatomical frame is now aligned with the IMU anatomical frame at
the start of each test. Across all trials (N = 92), the average
mean (SD) differences between the X, Y, and Z angles estimated from IMU and MOCAP data remain far below one degree and are −0.06(0.53), 0.02(0.96), and −0.09(1.12) degrees,
respectively. This outstanding consistency is superior (by an
order of magnitude) to the reported accuracies of two widely
used IMU systems, the Xsens MVN and APDM Opal, which
advertise static (dynamic) orientation accuracies of 1.00(2.00)
and 1.50(2.80) degrees, respectively. These commercial systems
fuse orientation estimates from accelerometers and rate gyros,
as well as magnetometers. In contrast, the algorithm presented
herein achieves superior results while fusing estimates from
accelerometers and rate gyros alone. A recent study [7] also
compares IMU-derived orientation angles (fusing gyro and accelerometer estimates) to MOCAP-derived orientation angles
for quasi-static functional tasks, including maximum hip flex-

1511

TABLE IV
DIFFERENCE BETWEEN PIN AND SKIN IMU ESTIMATES OF THE X, Y, AND Z
FEMORAL ORIENTATION ANGLES SUMMARIZED BY THE MEAN (SD) OF THE
MEAN AND SD OF THE DIFFERENCE, AND THE SLOPE, INTERCEPT, AND R 2 OF
THE BEST-FIT LINE TO THE CORRELATION PLOT DATA
Angle

Mean (deg)

SD (deg)

Slope

Intercept

R2

X
Y
Z

−1.68 (1.92)
−2.63 (3.04)
6.41 (4.71)

2.35 (1.04)
3.13 (1.17)
6.44 (2.83)

1.03 (0.05)
1.02 (0.12)
0.83 (0.22)

0.45 (0.50)
2.52 (3.21)
−3.82 (2.70)

1.00 (0.00)
0.89 (0.07)
0.80 (0.15)

ion and adduction, gait, two leg squats, and one leg standing.
However, the most successful drift error correction algorithm
reported only achieves mean and standard deviation errors of
2–3 degrees in the most successful task. Thus, the drift correction algorithm reported herein may well set a new standard for
accuracy for the clinical tests for FAI considered.
When compared to the orientation drift algorithms presented
in [7], the aforementioned algorithms succeed by using data
from the entire clinical tests for FAI. Specifically, during the
clinical tests for FAI, a device mounted to the femur is held
stationary when each of its three sense axes nearly aligns with
gravity for some subset of the test. Data from these time periods
provide the measurements that enable identification of the optimal drift correction constants (scale factor and bias) for each of
the gyro sense axes as defined in (6). Doing so accounts for drift
present in all coordinate directions, including yaw, a limitation
noted for several of the tests and methodologies presented in
[7].
It is important to note that the accuracy of the algorithm described herein is accompanied by the loss of several generalities
maintained by the commercial IMU systems as well as the algorithms tested in [7]. Specifically, the described drift correction
algorithm relies on data collected over the entire duration of a
given test, and therefore, cannot be applied in real time. Moreover, the tests considered herein exercise each femur-mounted
device through its entire ROM, so these results may not extend
to general applications where a more limited ROM is expected.
C. Influence of Skin Artifact and Clinical Implications
The effects of skin artifact on measured hip angles during
clinical tests for FAI have not previously been investigated. In
this study, the differences between skin- and pin-mounted IMU
estimates of femur orientation were −1.68(2.35), −2.63(3.13),
and 6.41(6.44) degrees about the X-, Y-, and Z-axes, respectively
(see Table IV). The average slope and coefficient of determination (R2 ) of the best-fit lines to the correlation plot data
(skin-mounted versus pin-mounted orientation angles) were
1.03(1.00), 1.02(0.89), and 0.83(0.80), in the X, Y, and Z directions, respectively. These results reveal that the skin-mounted
IMU overestimates the X and Y orientation angles by only 3%
and 2%, respectively, but underestimates the Z orientation angle by 17% relative to the MOCAP angle estimates. Moreover,
based on the R2 results, the skin-mounted IMU explains nearly
100% of the variance in the X orientation angle, 89% of the

1512

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 6, JUNE 2015

variance in the Y angle, and only 80% of the variance in the Z
angle, on average, for the 46 trials considered.
The differences in femoral orientation angle trajectories translate to ROM differences that have direct clinical significance.
For the 46 tests analyzed, the mean (SD) range of motion differences are 1.68 (3.12), 0.76 (4.15), and −2.40 (9.18) degrees
in the X, Y, and Z angles, respectively. As illustrated in Fig. 2,
the skin-mounted IMU is secured approximately at mid-thigh
using self-adhesive, elastic, athletic tape. While this location is
convenient, it likely induces considerable skin artifact. Smaller
skin artifact, and therefore, smaller ROM differences, would
follow from mounting and indexing the IMU against the iliotibial band or the proximal end of the lateral femoral condyle [32].
Regardless, normative (flex/ext: 110–120°; Ir/Er: 30–40°) [33]
and surgically confirmed FAI (flex/ext: 97(9)°; Ir/Er: 9(8)°) [34]
cohorts have been shown to exhibit considerable discrepancies
in hip ROM. Thus, any mounting location would be expected
to resolve the large differences in ROM (13–23 and 21–31 degrees for flexion/extension and internal/external rotation, respectively) between healthy and FAI afflicted hips, irrespective
of any likely skin artifact.
V. CONCLUSION
This study presents compelling evidence of the validity of
the proposed IMU-based method for quantifying femoral orientation angles during the common clinical tests used to diagnose Femoroacetabular impingement. This method provides
levels of accuracy and precision superior to those advertised in
commercial IMU systems and previously published IMU-based
methods. Even after accounting for expected skin motion artifact, the method will likely discriminate between healthy and
FAI afflicted hips. The method is easy to use, inexpensive, and
provides hip motion trajectory data in addition to range of motion measures. These advantages may accelerate the adoption of
this technology to inform FAI diagnoses and assess treatment
efficacy.
ACKNOWLEDGMENT
The authors would like to thank A. Brunfeldt for preparation
of the cadaveric specimens.
REFERENCES
[1] M. Leunig and R. Ganz, “[FAI— Concept and etiology],” Orthop.,
vol. 38, no. 5, pp. 394–401, May 2009.
[2] C. Ratzlaff et al., “Reliability of hip examination tests for femoroacetabular impingement,” Arthritis Care Res., vol. 65, no. 10, pp. 1690–1696,
2013.
[3] A. Rimmasch and P. Ravert, “Femoroacetabular impingement: A guide
to diagnosis in primary care,” J. Nurse Pract., vol. 9, no. 9, pp. 606–611,
Oct. 2013.
[4] M. R. Safran, “Hip arthroscopy: The next frontier in orthopaedic surgery
and its challenges,” in Proc. ASME 4th Frontiers Biomed. Devices Conf.,
pp. 21–22, Jan. 2009.
[5] F. Dobson et al., “Clinimetric properties of observer-assessed impairment
tests used to evaluate hip and groin impairments: A systematic review,”
Arthritis Care Res., vol. 64, no. 10, pp. 1565–1575, 2012.
[6] J. M. Moreside and S. M. McGill, “Quantifying normal 3D hip ROM in
healthy young adult males with clinical and laboratory tools: Hip mobility
restrictions appear to be plane-specific,” Clin. Biomech., vol. 26, no. 8,
pp. 824–829, Oct. 2011.

[7] F. Öhberg et al., “Comparative analysis of different adaptive filters for
tracking lower segments of a human body using inertial motion sensors,”
Meas. Sci. Technol., vol. 24, no. 8, pp. 85703–85714, Aug. 2013.
[8] J.-T. Zhang et al., “Concurrent validation of Xsens MVN measurement
of lower limb joint angular kinematics,” Physiol. Meas., vol. 34, no. 8,
pp. N63–N69, Aug. 2013.
[9] J. E. Langenderfer et al., “An efficient probabilistic methodology for
incorporating uncertainty in body segment parameters and anatomical
landmarks in joint loadings estimated from inverse dynamics,” J. Biomech.
Eng., vol. 130, no. 1, pp. 014502–014507, Feb. 2008.
[10] G. Wu et al., “ISB recommendation on definitions of joint coordinate
system of various joints for the reporting of human joint motion—Part
I: Ankle, hip, and spine,” J. Biomech., vol. 35, no. 4, pp. 543–548,
Apr. 2002.
[11] A. Leardini et al., “Human movement analysis using stereophotogrammetry. Part 3. Soft tissue artifact assessment and compensation,” Gait Posture,
vol. 21, no. 2, pp. 212–225, Feb. 2005.
[12] J. Favre et al., “Functional calibration procedure for 3D knee joint angle
description using inertial sensors,” J. Biomech., vol. 42, no. 14, pp. 2330–
2335, Oct. 2009.
[13] J. Favre et al., “Ambulatory measurement of 3D knee joint angle,”
J. Biomech., vol. 41, no. 5, pp. 1029–1035, 2008.
[14] H. Rouhani et al., “Measurement of multi-segment foot joint angles during gait using a wearable system,” J. Biomech. Eng., vol. 134, no. 6,
pp. 061006-1–061006-8, Jun. 2012.
[15] A. V. Dowling et al., “A wearable system to assess risk for anterior cruciate
ligament injury during jump landing: Measurements of temporal events,
jump height, and sagittal plane kinematics,” J. Biomech. Eng., vol. 133,
no. 7, pp. 071008-1–071008-7, Jul. 2011.
[16] T. Seel et al., “IMU-based joint angle measurement for gait analysis,”
Sensors, vol. 14, no. 4, pp. 6891–6909, Apr. 2014.
[17] S. Šlajpah et al., “Kinematics based sensory fusion for wearable motion
assessment in human walking,” Comput. Methods Programs Biomed.,
vol. 116, no. 2, pp. 131–144, Sep. 2014.
[18] E. Jovanov et al., “A wireless body area network of intelligent motion sensors for computer assisted physical rehabilitation,” J. NeuroEng. Rehabil.,
vol. 2, no. 1, p. 6, Mar. 2005.
[19] W. Y. Wong et al., “Clinical applications of sensors for human posture
and movement analysis: a review,” Prosthet. Orthot. Int., vol. 31, no. 1,
pp. 62–75, Mar. 2007.
[20] A. Brennan et al., “Quantification of inertial sensor-based 3D joint angle measurement accuracy using an instrumented gimbal,” Gait Posture,
vol. 34, no. 3, pp. 320–323, Jul. 2011.
[21] R. Williamson and B. J. Andrews, “Detecting absolute human knee angle
and angular velocity using accelerometers and rate gyroscopes,” Med.
Biol. Eng. Comput., vol. 39, no. 3, pp. 294–302, May 2001.
[22] A. Cappozzo et al., “Position and orientation in space of bones during movement: anatomical frame definition and determination,” Clin.
Biomech., vol. 10, no. 4, pp. 171–178, Jun. 1995.
[23] R. A. Siston and S. L. Delp, “Evaluation of a new algorithm to determine
the hip joint center,” J. Biomech., vol. 39, no. 1, pp. 125–130, 2006.
[24] H. J. Woltring, “A Fortran package for generalized, cross-validatory spline
smoothing and differentiation,” Adv. Eng. Softw., vol. 8, no. 2, pp. 104–
113, Apr. 1986.
[25] K. W. King, “The design and application of wireless MEMS inertial
measurement units for the measurement and analysis of golf swings,”
Ph.D. dissertation, University of Michigan, Ann Arbor, MI, USA, 2008.
[26] R. S. McGinnis and N. C. Perkins, “A highly miniaturized, wireless inertial
measurement unit for characterizing the dynamics of pitched baseballs and
softballs,” Sensors, vol. 12, no. 9, pp. 11933–11945, Aug. 2012.
[27] J. Favre et al., “Quaternion-based fusion of gyroscopes and accelerometers to improve 3D angle measurement,” Electron. Lett., vol. 42, no. 11,
pp. 612– 614, May 2006.
[28] H. J. Luinge et al., “Ambulatory measurement of arm orientation,”
J. Biomech., vol. 40, no. 1, pp. 78–85, 2007.
[29] H. M. Schepers et al., “Ambulatory human motion tracking by fusion of
inertial and magnetic sensing with adaptive actuation,” Med. Biol. Eng.
Comput., vol. 48, no. 1, pp. 27–37, Jan. 2010.
[30] A. Brennan et al., “Assessment of anatomical frame variation effect on
joint angles: A linear perturbation approach,” J. Biomech., vol. 44, no. 16,
pp. 2838–2842, Nov. 2011.
[31] P. Picerno et al., “Joint kinematics estimate using wearable inertial and
magnetic sensing modules,” Gait Posture, vol. 28, no. 4, pp. 588–595,
Nov. 2008.

McGINNIS et al.: ACCURACY OF FEMUR ANGLES ESTIMATED BY IMUs DURING CLINICAL PROCEDURES

[32] A. Cappozzo et al., “Position and orientation in space of bones during
movement: experimental artefacts,” Clin. Biomech. Bristol Avon, vol. 11,
no. 2, pp. 90–100, Mar. 1996.
[33] D. J. Magee, Orthopedic Physical Assessment. New York, NY, USA:
Elsevier Health Sciences, 2008.

1513

[34] J. C. Clohisy et al., “Clinical presentation of patients with symptomatic
anterior hip impingement,” Clin. Orthop., vol. 467, no. 3, pp. 638–644,
Jan. 2009.
Authors’ photographs and biographies not available at the time of publication.

