446

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

Ambulatory Measurement of Three-Dimensional
Foot Displacement During Treadmill Walking Using
Wearable Wireless Ultrasonic Sensor Network
Yongbin Qi, Cheong Boon Soh, Erry Gunawan, and Kay-Soon Low

Abstractâ€”Techniques that could be used to monitor human motion precisely are helpful in various applications such as rehabilitation, gait analysis, and athletic performance analysis. This paper
focuses on the 3-D foot trajectory measurements based on a wearable wireless ultrasonic sensor network. The system consists of
an ultrasonic transmitter (mobile) and several receivers (anchors)
with fixed known positions. In order not to restrict the movement of
subjects, a radio frequency (RF) module is used for wireless data
transmission. The RF module also provides the synchronization
clock between mobile and anchors. The proposed system measures
the time-of-arrival (TOA) of the ultrasonic signal from mobile to
anchors. Together with the knowledge of the anchorâ€™s position, the
absolute distance that the signal travels can be computed. Then, the
range information defines a circle centered at this anchor with radius equal to the measured distance, and the mobile resides within
the intersections of several such circles. Based on the TOA-based
tracking technique, the 3-D foot trajectories are validated against
a camera-based motion capture system for ten healthy subjects
walking on a treadmill at slow, normal, and fast speeds. The experimental results have shown that the ultrasonic system has sufficient
accuracy of net root-mean-square error (4.2 cm) for 3-D displacement, especially for foot clearance with accuracy and standard
deviation (0.62 Â± 7.48 mm) compared to the camera-based motion capture system. The small form factor and lightweight feature
of the proposed system make it easy to use. Such a system is also
much lower in cost compared to the camera-based tracking system.
Index Termsâ€”Foot clearance, rehabilitation, ultrasound, walking assessment, wearable sensor, wireless sensor network.

I. INTRODUCTION
T is generally agreed that falls in the elderly population are
serious healthcare issues due to their financial cost and associated mortality and morbidity rates [1]. Some researchers have
investigated some basic gait variables such as stride length and
walking speed [2], while others have studied joint kinematics to
evaluate the ageing effects on gait [3]. In order to understand the
complex relationship between gait and falls, an accurate method
for the measurement of foot trajectory, such as foot clearance, is
required [4]. Foot clearance is defined as the vertical displace-

I

Manuscript received November 6, 2013; revised February 10, 2014; accepted
April 2, 2014. Date of publication April 14, 2014; date of current version March
2, 2015.
The authors are with the School of Electrical and Electronic Engineering,
Nanyang Technological University, Singapore 639798 (e-mail: qiyo0001@
e.ntu.edu.sg; ecbsoh@ntu.edu.sg; egunawan@ntu.edu.sg; ekslow@ntu.edu.sg).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2316998

ment during walking, which has been shown to be an important
kinematic parameter related to safe locomotion [5].
Foot movement can be measured using a wide variety of
techniques and sensors [6], [7]. The most accurate measurement system is optical tracking system, which uses one or more
cameras to capture the displacement of reflective markers placed
at specific anatomical sites on limb segments [8], [9]. The system allows for the assessment of a complete 3-D kinematic
analysis of human movement only within restrictive laboratory environments [10]. In addition, it is sensitive to changes
in lighting, clutter, and shadow [11]. Therefore, it is not suitable for routine applications because of the complexity and
cost.
An alternative method to the visual tracking system is to
utilize inertial sensors, such as the accelerometer and gyroscope
[12], [13]. An accelerometer can measure the component of
its acceleration along its sensitive axis, which is suitable for
measuring human movement [14]. A gyroscope is also a type
of inertial sensor that is used to measure angular velocity [15].
Usage of inertial sensors have become more and more popular
in a wireless sensor network due to its low cost and low form
factor, which allow unrestrained natural movement of the human
body limbs [16]. Although these inertial sensors do not suffer
from the disadvantages of the visual tracking system, they are
not ideal as well. The estimation of position and orientation
requires integration of angular velocities or double integration
of acceleration, respectively. This is a cumulative procedure that
in the presence of even small measurement errors could produce
significant drift over long measurement durations. Thus, the
integration should not be done over a long time or some other
techniques should be applied to minimize error accumulation
[4], [15].
Ultrawideband (UWB) radio is an emerging technology that
has attracted significant interest in recent years due to its robustness to fading, high temporal resolution, low loss penetration, and low power spectral density [17]. Particularly, wearable
UWB radios are good candidates for human motion tracking,
since they can provide high ranging and positioning accuracies and offer low-power consumption and robust performance
in multipath environment [18], [19]. It is, however, difficult to
sample the received signal in real time with current analog-todigital converter technology due to its large bandwidth of UWB
pulse. Furthermore, the clock between transmitter and receiver
should be strictly synchronized, because even small clock drift
would produce significant measurement error due to its high
transmission speed [20].

2168-2194 Â© 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

QI et al.: AMBULATORY MEASUREMENT OF THREE-DIMENSIONAL FOOT DISPLACEMENT DURING TREADMILL WALKING

Fig. 1.

447

Prototype of foot displacement measurement during gait [4].

It is, therefore, of interest to design a low-cost and accurate
motion tracking system for routine applications. In this paper, a
wireless wearable sensor system based on ultrasound for monitoring foot trajectory during walking is proposed. The objective
is to allow patients to be monitored under an unrestrained environment. The proposed approach makes use of the wireless
sensor network concept with all the mobile sensor nodes communicating wirelessly with the coordinator. These sensor nodes
are light and small for attaching to the human foot. Furthermore, it is low cost as compared to the camera-based motion
capture system.
This paper is organized as follows. A brief overview of the
configuration of the wireless wearable ultrasonic system is given
in Section II. Section III describes the proposed measurement
system using state-space methods to continuously track foot
displacement during walking. This is followed a by three-step
tracking algorithm using the combination of the Newtonâ€“Gauss
(NG) method and extended Kalman filter (EKF) to reduce the
effect of range measurement errors on the foot displacement
measurement in Section IV. Section V investigates the performance of the ultrasonic tracking system by comparing with the
camera-based motion capture system during different walking
speeds. Finally, conclusions are made in Section VI.

Fig. 2.

General configuration of the system.

Fig. 3. (a) Photograph of Embedream ultrasonic transmitter and (b) Embedream receiver module.

II. SYSTEM DESCRIPTION AND CONFIGURATION
A. System Description
The proposed foot displacement measurement system uses
ultrasonic sensor to track and localize the foot motion during
walking. As shown in Fig. 1, vertical displacement, also called
foot clearance, is defined as the height between a foot and the
ground during walking. The distance during walking is widely
used in many fields extending from gait analysis to rehabilitation. General requirements for gait analysis are that the device
attached to human body should be as small and as light as possible. Any bulky devices heavier than about 1â€“2% of the subjectâ€™s
mass may potentially disturb normal gait [21].
B. System Configuration
We developed a wearable ultrasonic motion analysis system
using a wireless sensor network. Fig. 2 shows the general configuration of the system. The system comprises of a number of
sensor nodes, coordinator, data transmission module, anchors,
and mobiles. The mobile consists of an ultrasound generator

Fig. 4. Embedream controller board comprising of microcontroller, an RF
front end, and a temperature sensor.

board, as shown in Fig. 3(a), and a controller board, shown in
Fig. 4, comprising of a microcontroller unit, a radio frequency
(RF) module, and a temperature sensor. The RF module embedded in the controller board provides synchronization clock
between mobiles and anchors. The RF module on the transmitter
will first send out a data package with Timer Starter Command
using broadcast address to notify the anchors that the ultrasound signal has been transmitted. The anchors will then start

448

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

position of the mobile can be located by the following localization and tracking technique, EKF together with the NG method,
as described in Section IV.
III. SYSTEM MODELING
A. Motion Model

Fig. 5. Single ranging cycle. Distance measurement is initiated by sending a
pulse to the trigger input. The receiver will respond with a pulse with a duration
corresponding to the propagation delay.

the timers to obtain propagation delays of the ultrasound signal. Due to the characteristics of ultrasonic sensor, the speed of
sound is sensitive to surrounding temperature, humidity, etc. In
most cases, temperature has the most pronounced effect. Therefore, a temperature sensor is added in the controller board to
measure the temperature and compensate for the temperature
effect on the velocity of ultrasound. The ultrasound velocity in
air can be approximated by [10]
âˆš
âˆš
(1)
vs = ÎºRT â‰ˆ 20.05 T
where Îº is the isentropic coefficient, which is equal to 1.4 in air,
R = 287.14 m2 /s2 Â· K is the general gas constant, and T is the
air temperature in degrees Kelvin.
An anchor is composed of an ultrasound receiver, as shown
in Fig. 3(b), and a controller board. The anchor receives ultrasonic signals from the mobile device and computes distance
estimates to the mobile using time-of-arrival (TOA) of the ultrasonic signal. These range information are forwarded to the
coordinator. The coordinator node communicates with the data
transmission module wirelessly to transfer data to computer for
postprocessing through RS232 wired link. The controller board
can be made more compact to reduce its form factor, since the
controller board was designed for both anchors and mobiles.
A single ranging cycle is shown in Fig. 5. Distance measurement is initiated by activating the trigger input with a pulse by
a mobile. The RF module in the mobile target will send out
its own address for coordinator to identify and synchronization
signal for anchors to start its corresponding timer. Meanwhile,
the ultrasound generator on the mobile target sends out a burst
of 40-kHz ultrasound. The timer on the anchor will stop counting when the ultrasound receiver detects the transmitted signal.
Then, a measurement of surrounding temperature by the temperature sensor is taken. Finally, the distance between the mobile
and anchor can be calculated as
D = t Â· vs

(2)

where D is the distance in meters, t is the ultrasound propagation delay from mobile to anchor in seconds, and vs is the
velocity of ultrasound in meters per second. After the anchor
has completed the range calibration, the RF module in anchor
transmits the distance information to PC via data transmission
module for postprocessing. Using the distance information, the

We assume that the mobile with position p = [x y z]T sends
out ultrasonic signals to anchors after each trigger signal. The
positions of anchors are known with pi = [xi yi zi ]T . Then, we
design an EKF using a state vector with six components, three
Cartesian coordinates (x, y, z), and their velocity components
(xÌ‡, yÌ‡, zÌ‡). Therefore, the state of the mobile target for time step
k can be expressed as
Ë™ y(k)
Ë™ z(k)]
Ë™ T.
x(k) = [x(k) y(k) z(k) x(k)

(3)

Then, the state transition equation from time step k âˆ’ 1 to k is
given by
x(k) = Ax(k âˆ’ 1) + q(k âˆ’ 1)

(4)

where the state transition matrix A from the respective kinematics equations is


I3Ã—3 T rI3Ã—3
A=
(5)
O3Ã—3
I3Ã—3
where I3Ã—3 is the identity matrix and O3Ã—3 is the matrix with all
elements zero. T is the sampling interval. The process noise is
q(k âˆ’ 1) âˆ¼ N (0, Q(k âˆ’ 1)). The covariance matrix Q(k âˆ’ 1)
accounts for the unmodeled factors of the system that will be
treated as random noise. It becomes
âŽ¤
âŽ¡ 3
T2
T
Qs
Qs
âŽ¥
âŽ¢ 3
2
âŽ¥
(6)
Q(k âˆ’ 1) = âŽ¢
âŽ¦
âŽ£ T2
Qs T Qs
2
where Qs = diag(qx2 , qy2 , qz2 ). In most cases, qx , qy , and qz can
be considered as standard deviations of the velocity noise in x-,
y-, and z-directions, respectively.
B. Measurement Model
We let di denote the absolute distance measured at ith anchor
using the following equation:
di = p âˆ’ pi  + dËœi = ri + dËœi

(7)

where dËœi is the range measurement noise and ri is the actual
distance. Stacking all the distance information, we have the
measurement model expressed as
D(k) = F (x(k))x(k) + DÌƒ(k)

(8)

where
D(k) = [ d1

d2

Â·Â·Â·

d n ]T

F (x(k)) = [ F1 F2 Â· Â· Â· Fn ]T


âˆ‚di âˆ‚di âˆ‚di
0
Fi =
âˆ‚x
âˆ‚y
âˆ‚z
DÌƒ(k) = [ dËœ1

dËœ2

Â·Â·Â·

dËœn ]T


0

0
(9)

QI et al.: AMBULATORY MEASUREMENT OF THREE-DIMENSIONAL FOOT DISPLACEMENT DURING TREADMILL WALKING

n is the number of anchors, and DÌƒ(k) âˆ¼ N (0, R(k)) is measurement errors. R(k) = diag(e21 , e22 , . . . , e2n ) is the covariance
matrix of measurement errors. ei is always considered as the
standard deviations of the measurement error of anchor i.
IV. TRACKING ALGORITHM

A. Prefiltering
Since the range measurements may have some large errors
or outliers, these outliers can result in significant errors for
mobile target tracking. It is not necessary to have a very rigorous prefiltering since EKF is a robust estimator. Extremely
large error in range measurements can be easily eliminated. The
method used involves combining past distance measurements
and the maximum moving speed at which the mobile is expected
to move.
First note that the previous distance measurement for ith anchors is stored in di . The mobile target can either be moving
away from the ith anchor or approaching it. In approaching case,
the distance between the mobile and ith anchor will decrease
as given by (10) for dâˆ’
im ax . Otherwise, the distance from the ith
anchor will increase over time as indicated by (11) for d+
im ax :
dâˆ’
im ax = di âˆ’ T Â· vm ax

(10)

= di + T Â· vm ax

(11)

d+
im ax

where vm ax is the maximum possible moving velocity of the
mobile. Subtracting (10) from (11) results in the following
equation:
âˆ’
Î”di = d+
im ax âˆ’ dim ax = 2 Â· T Â· vm ax .

(13)

The NG iterative method is commonly used to solve the
nonlinear optimization problem (7) [23]. It begins with an initial guess and is followed by least-sum-square-error minimization [24]. For the jth iteration, we have

is satisfied:

pj +1 = pj âˆ’ T j Î˜j

(14)

 j +1

p
âˆ’ pj  < Îµ

(15)


âˆ’1
T j = FT (pj )F(pj ) FT (pj )

âˆ‚y

 
F pj n ]T

âˆ‚ p j âˆ’p i 
(16)
âˆ‚z

where n is the number of anchors and Îµ is a prescribed threshold.
The initial value for kth step is
âŽ¡ 0âŽ¤ âŽ¡
âŽ¤
x
xÌ‚(k)
âŽ¢ 0âŽ¥ âŽ¢
âŽ¥
p0 = âŽ£ y âŽ¦ = âŽ£ yÌ‚(k) âŽ¦
(17)
0
z
zÌ‚(k)
where [xÌ‚(k) yÌ‚(k) zÌ‚(k)]T are the first three elements of the predicted state xÌ‚(k) of the EKF algorithm described in Section
IV-C.
Initial guess is important to guarantee the convergence of
such a recursive method. Therefore, the position information of
the predicted state of the Kalman filter, which will be discussed
in the following step, has been used as initial guess [25]. The
experiment shows that such a method converges after a few
iterations when the predicted state of the Kalman filter is used.
C. Extended Kalman Filter
While the NG method gives a pretracking position, we need to
use the position information to update the measurement model
in (7), where the new measurement is dÂ¯i = pn g âˆ’ pi  and pn g
is the prelocalization using the NG method.
Using the measurement model of the system under study, the
following equations can be used to evaluate iteratively to track
the mobile.
1) Prediction:
xÌ‚(k) = Ax(k âˆ’ 1)
PÌ‚ (k) = AP (k âˆ’ 1)AT + Q(k âˆ’ 1)

(18)

2) Update:
Î¦(k) = D(k) âˆ’ F (xÌ‚(k))xÌ‚(k)
S(k) = F (xÌ‚(k))PÌ‚ (k)F T (xÌ‚(k)) + R(k)
K(k) = PÌ‚ (k)F T (xÌ‚(k))S(k)âˆ’1
x(k) = xÌ‚(k) + K(k)Î˜(k)

B. Pretracking Using the NG Method

until the condition

Dj = [ dj1 dj2 Â· Â· Â· djn ]T
 
 
 
F pj = [ F pj 1 F pj 2 Â· Â· Â·

  j 
j
j
F p i = âˆ‚ p âˆ’p i  âˆ‚ p âˆ’p i 

(12)

Equation (12) provides a threshold to eliminate large range measurement errors. The current range measurement is only used for
tracking and localization when the absolute difference between
the current range measurement and the previous measurement is
smaller than the predefined threshold Î”di , as illustrated below:
|dik âˆ’ di(k âˆ’1) | â‰¤ Î”di = 2 Â· T Â· vm ax .

Î˜j = Dj âˆ’ p âˆ’ pi 

âˆ‚x

We first apply prefiltering of the range measurements to reduce the errors in tracking and localization. This is followed by
the prelocalization algorithm using the NG method and filtered
by EKF [22].

449

P (k) = PÌ‚ (k) âˆ’ K(k)S(k)K(k)T

(19)

where xÌ‚(k) and PÌ‚ (k) are the predicted mean and covariance
of the state, respectively, for time step k before getting measurement result; x(k) and P (k) are the estimated mean and
covariance of the state, respectively for time step k after getting
measurement result; and K(k) is the Kalman filter gain.
V. EXPERIMENTAL VALIDATION
In this section, we use the experimental results to compare
the proposed ultrasonic motion analysis system with the camerabased motion capture system. The foot 3-D displacements are

450

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

TABLE I
INFORMATION OF SUBJECTS UNDER EXPERIMENT

tion capture system. Ultrasonic and camera-based systems were
synchronized to start recording at the same time and sampled at
50 Hz, same as [26], [27].
B. Parameters Identification

Fig. 6. Wireless unit with embedded ultrasonic sensor attached on foot, and
three reflective markers fixed on toe, heel, and shank for reference camera-based
motion capture system.

estimated using different approaches, such as least-squares approach, purely NG method, purely EKF, and the combination of
NG and EKF.
A. Experiment Setup
In order to investigate the performance of the proposed system, various experiments have been conducted using the hardware platform described in Section II. The measurement was
conducted in a motion analysis lab with eight high-speed cameras in the School of Mechanical and Aerospace Engineering at
Nanyang Technological University. The eight-camera analysis
system was used to provide independent reference measurements and used for the validation of the ultrasonic system. Ten
healthy subjects were used to test the performance of the proposed system. The information of these subjects is given in
Table I. All subjects were required to walk on treadmill without
shoes or wear regular shoes without high heels, and repeat several times at slow, normal, and fast speeds. The camera system
tracked the position of three reflective markers placed on toe,
heel, and shank extremities of subjectsâ€™s foot or shoe according
to Fig. 6. Actually, one reflective marker on heel was enough to
provide a reference data for validation. The other two reflective
markers were used to create a template for better tracking in the
camera-based motion capture system.
There were four anchors used in our experiment with positions (p1 = [0 0 0]T , p2 = [324 0 0]T , p3 = [324 230 0]T ,
p4 = [0 230 0]T ). The ultrasonic transmitter was attached to
the heel of the foot pointing toward the four anchors, using
elastic straps. To benchmark the performance of the ultrasonic
tracking system, we compare the 3-D displacement estimated
by the ultrasonic tracker with those from the camera-based mo-

The process and measurement noise statistics should be estimated for the system models in Section III. We first conduct
experiments with the mobile target moving at a given trajectory.
These experiments help to find suitable values of process noise
Qs and measurement noise R(k). We take a sensor and run M
tests with the same trajectory. The actual distance for test i, ri ,
is known, and there are N measurement samples mji collected
for each test, where j = 1, . . . , N .
1) Process Noise Statistics in the Kalman Filter: As the process noise in EKF is an independent variable, it is difficult to get
an exact value [28]. Here, we consider it as a velocity noise in
x-, y- and z-directions with mm/s unit. A metric, net root-meansquare error (Net RMSE), as defined in (21), is used to select a
reasonable value of Qs :


(Actual âˆ’ Estimated)2
(20)
RMSE =
Number of Estimates

2
2
2
Net RMSE = XRM
(21)
SE + YRM SE + ZRM SE .
The process noise Qs was estimated by using numerical methods. By varying the values of qx , qy , and qz , we will get the corresponding trajectory of the mobile to compute the Net RMSE
value. Typical values of qx , qy , and qz will be selected when their
corresponding Net RMSE is minimal. The typical values of Qs
used in our experiments are qx = 36, qy = 30, and qz = 9.
2) Measurement Noise Statistics in the Kalman Filter: It
is reasonable to assume that all the anchors have independent
distributed noise. Then, the mean and covariance of the measurement noise can be evaluated. Using the data obtained from
the experiments, mean and variance of the measurement errors
given by
u=

M N

1  j
mi âˆ’ ri
M N i=1 j =1

2
 j
1
mi âˆ’ u
M (N âˆ’ 1) i=1 j =1
M

e2 =

N

(22)
are computed. Typical value of R(k) used in our experiments is
R(k) = diag(9, 9, 9, 9) with the units as mm2 .
C. Performance Comparison
To validate our models, we first investigate the performance
of purely EKF-based tracker, and then study the combination
of EKF and NG (EKF-NG) for target tracking. Finally, by
considering the four anchors, it was also possible to consider
having multiple equations with three unknowns, and the whole
TOA-based localization system was solved using a least-squares
(LS) approach.

QI et al.: AMBULATORY MEASUREMENT OF THREE-DIMENSIONAL FOOT DISPLACEMENT DURING TREADMILL WALKING

451

TABLE III
FOOT MOVEMENT IN 3-D SPACE AT DIFFERENT WALKING SPEEDS

Fig. 7. Foot trajectory during walking in 3-D space. (a) Horizontal displacement, (b) vertical displacement (foot clearance), and (c) lateral displacement
are compared with the camera-based motion capture system by using ultrasonic
sensors.
TABLE II
ERRORS OF FOOT MOVEMENT IN 3-D SPACE COMPARED WITH THE
CAMERA-BASED MOTION CAPTURE SYSTEM USING DIFFERENT APPROACHES

There are two metrics used to evaluate the performance of
our system. One, RMSE, is described in Section V. This metric
computes the tracking errors for x-, y-, and z-directions separately [28]. The other metric is the mean error and standard deviation of the discrepancy, considered as accuracy and precision,
between the 3-D displacement measured with the camera-based
system, for EKF, NG, EKF-NG, and LS approaches.
Good correspondence between the proposed system and the
reference camera-based system is shown in Fig. 7. Table II provides numerical comparison of the 3-D displacements in horizontal, vertical, and lateral directions by applying different approaches (LS, NG, EKF, and EKF-NG). LS and NG approaches
do not use the information of previous state and are sensitive
to the geometry distribution of anchors, while an EKF-based
tracker uses prior knowledge of noise characteristics to filter
out the noise. Furthermore, it is independent of the geometry
distribution of anchors. Here, we combine the NG and EKF
approaches, our new method called EKF-NG, to offer superior
tracking performance. It is shown in the numerical results that
the EKF-NG-based tracker has a better performance to track the
foot movement among all these approaches.

Horizontal displacement was obtained with an error of
âˆ’0.10 Â± 39.76 mm (expressed as the mean Â± STD of the set
of difference with the reference camera based system) for the
EKF-NG tracker and was smaller than other methods. The best
absolute accuracy and precision observed was the vertical displacement with 0.62 Â± 7.48 mm using the
 EKF-NG tracker.
2
2
The net RMSE value in the 2-D model ( XRM
SE + YRM SE )
of 40.46 mm shows that the EKF-NG-based method gives a
better estimate than the purely EKF- and NG-based methods of
50.96 and 63.39 mm, respectively, which are much better than
the LS-based estimation of 72.76 mm. The LS-based approach
fails to identify the displacement in lateral direction due to the
setup of the four anchors in xy plane. Therefore, there is no
degree of freedom in the lateral direction. In other words, the
result indicates that Kalman filters are robust and not sensitive
to the geometry distribution of anchors. In addition, the EKFNG-based tracker can achieve a net RMSE value of 41.79 mm
in the 3-D space.
D. Influence of Walking Speed on Foot Displacement
The subjects are instructed to vary the speed of walking on
treadmill at slow, normal, and fast speeds. Table III shows the
mean and STD value of the difference between foot trajectory
estimated using the ultrasonic system and the reference camerabased system. The influence of speed on the 3-D measurement of
foot trajectory was found to be insignificant for the Kalman filter,
whereas it was significant for the NG-based approach. Overall,
the STD and net RMSE were found to be smaller with a slight
increase in our proposed EKF-NG method at all walking speeds.
This can be interpreted as lower temporal resolution at higher
speed. The results show that the proposed EKF-NG method is
more robust than purely EKF- and NG-based approaches.
VI. DISCUSSION AND CONCLUSION
We use state-space methods together with the NG method
to estimate the 3-D displacements of foot during walking using one ultrasonic transmitter and four receivers. To estimate
the 3-D displacements of foot, we use the EKF that is more

452

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 2, MARCH 2015

computationally efficient compared to other filters like unscented Kalman filter (UKF). This is because the EKF estimates for our system are as accurate as the estimates obtained
with more complicated filters like UKF.
Some of the estimation errors might be attributed to the vibrations of reflective markers or sensors mounted on body, especially at high walking speed. Marker occlusion is another
factor that affects the results of the camera-based motion capture system. The recording of the marker will be discarded when
a significant percentage of markers have not been detected by
more than three cameras. When one of the three markers is invisible, the position of such marker will be estimated from the
other two markers by interpolation.
In our experiments, subjects are instructed to walk over several minutes period with slow, normal, and fast speeds. Other
researchers [29], [30] have also investigated foot displacement
using inertial sensors (accelerometers, gyroscopes, or both).
Their experiments were conducted under slow movements or
a limited number of consecutive strides to eliminate the error
accumulation over time, since the displacements are estimated
by either integrating the velocities or double integrating the
measured accelerations. However, our proposed system does
not have such limitations and does not have error accumulation
even for prolonged measurement durations.
In summary, this study proposes a novel measurement system using a wearable ultrasonic sensor to measure the foot
displacement continuously during walking in the 3-D space.
To evaluate the performance of the proposed system, the 3-D
foot displacement was measured and validated against the reference camera-based motion capture system. The experiments
have been conducted at different walking velocities with several healthy subjects. These experiments demonstrate that the
results from the proposed ultrasonic measurement system have
high correspondence with the results from the camera-based
motion capture system over long walking period. Additionally,
the proposed system is easy to wear and to use. It does not
restrict the movement of patients or subjects with bulky cables.

REFERENCES
[1] R. Begg, R. Best, L. DellOro, and S. Taylor, â€œMinimum foot clearance
during walking: Strategies for the minimisation of trip-related falls,â€ Gait
Post., vol. 25, no. 2, pp. 191â€“198, 2007.
[2] J. O. Judge, S. Ounpuu, and R. B. Davis, â€œEffects of age on the biomechanics and physiology of gait,â€ Clin. Geriatr. Med., vol. 12, no. 4, pp. 659â€“678,
1996.
[3] S. J. Allin, C. Beach, A. Mitz, and A. Mihailidis, â€œVideo based analysis of
standing balance in a community center,â€ in Proc. 30th Annu. Int. Conf.
Eng. Med. Biol. Soc., 2008, pp. 4531â€“4534.
[4] B. Mariani, S. Rochat, C. Bula, and K. Aminian, â€œHeel and toe clearance
estimation for gait analysis using wireless inertial sensors,â€ IEEE Trans.
Biomed. Eng., vol. 59, no. 11, pp. 3162â€“3168, Nov. 2012.
[5] A. Kerr, D. Rafferty, P. Dall, P. Smit, and P. Barrie, â€œUsing an optical
proximity sensor to measure foot clearance during gait: Agreement with
motion analysis,â€ J. Med. Devices, vol. 4, no. 3, pp. 31004-31009, 2010.
[6] W. Tao, T. Liu, R. Zheng, and H. Feng, â€œGait analysis using wearable
sensors,â€ Sensors, vol. 12, no. 2, pp. 2255â€“2283, 2012.
[7] T. Liu, Y. Inoue, and K. Shibata, â€œA wearable ground reaction force sensor
system and its application to the measurement of extrinsic gait variability,â€
Sensors, vol. 10, no. 11, pp. 10240â€“10255, 2010.
[8] H. A. Shaban, M. A. El-Nasr, and R. M. Buehrer, â€œToward a highly accurate ambulatory system for clinical gait analysis via UWB radios,â€ IEEE
Trans. Inf. Technol. Biomed., vol. 14, no. 2, pp. 284â€“291, Mar. 2010.

[9] Y. Qi, C. B. Soh, E. Gunawan, K.-S. Low, and A. Maskooki, â€œA novel
approach to joint flexion/extension angles measurement based on wearable
UWB radios,â€ IEEE J. Biomed. Health Informat., vol. 18, no. 1, pp. 300â€“
308, Jan. 2014.
[10] R. M. Kiss, L. Kocsis, and Z. Knoll, â€œJoint kinematics and spatial-temporal
parameters of gait measured by an ultrasound-based system,â€ Med. Eng.
Phys., vol. 26, no. 7, pp. 611â€“620, 2004.
[11] S. Bamberg, A. Y. Benbasat, D. M. Scarborough, D. E. Krebs, and
J. A. Paradiso, â€œGait analysis using a shoe-integrated wireless sensor system,â€ IEEE Trans. Inf. Technol. Biomed., vol. 12, no. 4, pp. 413â€“423, Jul.
2008.
[12] T. Liu, Y. Inoue, and K. Shibata, â€œDevelopment of a wearable sensor system for quantitative gait analysis,â€ Measurement, vol. 42, no. 7, pp. 978â€“
988, 2009.
[13] R. A. Hyde, L. P. Ketteringham, S. A. Neild, and R. J. S. Jones, â€œEstimation of upper-limb orientation based on accelerometer and gyroscope
measurements,â€ IEEE Trans. Biomed. Eng., vol. 55, no. 2, pp. 746â€“754,
Feb. 2008.
[14] C. V. C. Bouten, K. T. M. Koekkoek, M. Verduin, R. Kodde, and
J. D. Janssen, â€œA triaxial accelerometer and portable data processing unit
for the assessment of daily physical activity,â€ IEEE Trans. Biomed. Eng.,
vol. 44, no. 3, pp. 136â€“147, Mar. 1997.
[15] A. M. Sabatini, C. Martelloni, S. Scapellato, and F. Cavallo, â€œAssessment
of walking features from foot inertial sensing,â€ IEEE Trans. Biomed. Eng.,
vol. 52, no. 3, pp. 486â€“494, Mar. 2005.
[16] G. X. Lee and K.-S. Low, â€œA factorized quaternion approach to determine
the arm motions using triaxial accelerometers with anatomical and sensor
constraints,â€ IEEE Trans. Instrum. Meas., vol. 61, no. 6, pp. 1793â€“1802,
Jun. 2012.
[17] C. C. Chong, F. Watanabe, and M. Z. Win, â€œEffect of bandwidth on UWB
ranging error,â€ in Proc. IEEE Wireless Commun. Network. Conf., 2007,
pp. 1559â€“1564.
[18] Y. Qi, C. B. Soh, E. Gunawan, K.-S. Low, and A. Maskooki, â€œMeasurement of knee flexion/extension angle using wearable UWB radios,â€ in
Proc. 35th Annu. Int. Conf. Eng. Med. Biol. Soc., 2013, pp. 7213â€“7216.
[19] Y. Qi, C. B. Soh, E. Gunawan, K.-S. Low, and A. Maskooki, â€œUsing
wearable UWB radios to measure foot clearance during walking,â€ in Proc.
35th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., 2013, pp. 5199â€“5202.
[20] Y. Zhou, C. L. Law, and J. Xia, â€œUltra low-power UWB-RFID system for
precise location-aware applications,â€ in Proc. IEEE Wireless Commun.
Network. Conf. Workshop, 2012, pp. 154â€“158.
[21] Y. Wahab, A. Zayegh, and N. A. Bakar, â€œFoot-to-ground clearance measurement: Analysis and modelling of MEMS applicability,â€ Int. J. Res.
Rev. Signal Acquisit. Process., vol. 2, no. 1, pp. 56-64, 2012.
[22] J. Hartikainen, A. Solin, and S. SaÌˆrkkaÌˆ, Optimal Filtering with Kalman
Filters and Smoothers: A Manual for the Matlab Toolbox EKF/UKF, Dept.
Biomed. Eng. Comput. Sci., School Sci., Aalto Univ., Espoo, Finland,
Aug. 16, 2011.
[23] Y. Zhou, C.L. Law, Y.L. Guan, and F. Chin, â€œIndoor elliptical localization
based on asynchronous UWB range measurement,â€ IEEE Trans. Instrum.
Meas., vol. 60, no. 1, pp. 248â€“257, 2011.
[24] Y. Qi, C. B. Soh, E. Gunawan, K.-S. Low, and A. Maskooki, â€œAn accurate
3D UWB hyperbolic localization in indoor multipath environment using
iterative Taylor-series estimation,â€ in Proc. IEEE Veh. Technol. Conf.,
2013, pp. 1â€“5.
[25] X. Wang, M. Fu, and H. Zhang, â€œTarget tracking in wireless sensor networks based on the combination of KF and MLE using distance measurements,â€ IEEE Trans. Mobile Comput., vol. 11, no. 4, pp. 567â€“576, Apr.
2012.
[26] A. Mulder. (1998). Human movement tracking technology: Resources.
[Online]. Available: http://xspasm.com/x/sfu/vmi/HMTT.add.html
[27] E. Foxlin and M. Harrington, â€œWeartrack: A self-referenced head and hand
tracker for wearable computers and portable VR,â€ in Proc. 4th Int. Symp.
Wearable Comput., 2000, pp. 155â€“162.
[28] A. Shareef and Y. Zhu, â€œLocalization using extended Kalman filters in
wireless sensor networks,â€ in Graduate Student Scholarly and Creative
Submissions, 2009.
[29] G. X. Lee, K. S. Low, and T. Taher, â€œUnrestrained measurement of arm
motion based on a wearable wireless sensor network,â€ IEEE Trans. Instrum. Meas., vol. 59, no. 5, pp. 1309â€“1317, May 2010.
[30] H. M. Schepers, E. H. F. Van Asseldonk, C. Baten, and P. H. Veltink,
â€œAmbulatory estimation of foot placement during walking using inertial
sensors,â€ J. Biomech., vol. 43, no. 16, pp. 3138â€“3143, 2010.
Authorsâ€™, photographs and biographies not available at the time of publication.

