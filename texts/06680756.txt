966

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

A Model for Cancer Tissue Heterogeneity
Anwoy Kumar Mohanty, Student Member, IEEE, Aniruddha Datta∗ , Fellow, IEEE, and Vijayanagaram Venkatraj

Abstract—An important problem in the study of cancer is the
understanding of the heterogeneous nature of the cell population.
The clonal evolution of the tumor cells results in the tumors being
composed of multiple subpopulations. Each subpopulation reacts
differently to any given therapy. This calls for the development of
novel (regulatory network) models, which can accommodate heterogeneity in cancerous tissues. In this paper, we present a new
approach to model heterogeneity in cancer. We model heterogeneity as an ensemble of deterministic Boolean networks based on
prior pathway knowledge. We develop the model considering the
use of qPCR data. By observing gene expressions when the tissue
is subjected to various stimuli, the compositional breakup of the
tissue under study can be determined. We demonstrate the viability of this approach by using our model on synthetic data, and
real-world data collected from fibroblasts.

which subpopulation to target and how much of therapy should
be administered to the patient. Proponents of the cancer stem
cell theory [3], [4] say that the growth and progression of many
cancers are driven by small subpopulations of cancer stem cells,
and that therapies should be designed to target these stem cell
subpopulations. The second popular theory is that most of the
cells in the tumor are contributive to tumor maintenance [5], [6].
Such a view would imply that therapies should be aimed to target all the major subpopulations in the cancer tissue. Whichever
model may be closer to the true state of affairs, a mathematical
model which incorporates heterogeneity in the cancer tissue is
a vital tool in the treatment of a complex disease such as cancer.

Index Terms—Bayesian methods, heterogeneity, hierarchical
models, Markov chain Monte Carlo.

II. MODEL DESCRIPTION
I. INTRODUCTION
ANCER progression can be modeled as evolution among
cells which become neoplastic due to the accumulation of
mutations which give them a proliferative advantage over their
normal neighbors [1]. Although there is wide spread consensus
that most macroscopic tumors have a unicellular origin as described in [1] and [2], stepwise accumulation of mutations as
described in [1] causes the appearance of variant sublines which
makes the neoplastic cell population a heterogeneous one. The
heterogeneity of cancer cell populations raises certain issues in
the treatment strategy to be followed because a certain treatment which may be effective on a certain subpopulation of the
neoplastic cells but not on the others may show good results
on a particular patient, but not on another patient where the
sensitive neoplastic cell subpopulation is not a major fraction
of the entire cancerous cell population. Hence, estimating the
proportion wise breakup of the cell subpopulations in a cancer
for any given patient is a problem which needs to be addressed.
Once the dominant subpopulations have been identified, the
appropriate decisions regarding therapy can be taken such as

C

Manuscript received September 6, 2013; revised October 19, 2013; accepted
November 26, 2013. Date of publication December 11, 2013; date of current
version February 14, 2014. This work was supported by the National Science Foundation under Grant ECCS-1068628. Asterisk indicates corresponding
author.
A. K. Mohanty is with the Department of Electrical and Computer Engineering, Texas A&M University, College Station, TX 77843 USA (e-mail:
anwoy_kgp_123@neo.tamu.edu).
∗ A. Datta is with the Department of Electrical and Computer Engineering, Texas A&M University, College Station, TX 77843 USA (e-mail:
datta@ece.tamu.edu).
V. Venkatraj is with the Department of Veterinary Integrated Biosciences,
College of Veterinary Medicine, Texas A&M University, College Station, TX
77845 USA (e-mail: jvenkatraj@cvm.tamu.edu).
Digital Object Identifier 10.1109/TBME.2013.2294469

Cellular behavior is controlled through multivariate interactions between various biological molecules such as proteins and
DNA [2], [8]. Various methods have been proposed to model
such interactions. These include differential equations [9], deterministic and probabilistic Boolean networks [7], [8], and
Bayesian and dynamic Bayesian networks [10], [11]. For methods such as the probabilistic Boolean networks, the network
parameters are very difficult to learn from real-world data simply due to the huge search space for the parameters. The REVEAL algorithm [12] is a general method to learn deterministic Boolean networks from time-domain data. However, timedomain data is difficult to collect. In addition, a lot of previous methods rely on the discretization of real-world observations such as gene expression levels, which results in the loss
of valuable information. The ARACNE method [13] is a way
to use continuous-valued observations to determine regulatory
interactions.
In the biological literature, there is a wealth of information
regarding the marginal regulatory interactions, usually referred
to as pathway knowledge, which has been collected by biologists over a long period of time. Unfortunately most genetic
regulatory network modeling methodologies tend to ignore this
information. Using this information would result in methodologies which describe cellular behavior more accurately. A
method to use such prior pathway knowledge while designing networks was presented in [14]. Here, Boolean networks,
which are extensively used in digital logic design, were used to
model signal transduction networks. Boolean networks, which
involve discrete variables, are a good choice to model protein–
protein interaction networks since such reactions involve proteins changing from one state to another, usually by the addition
or removal of phosphate groups, and are generally accompanied
by ATP hydrolysis which pushes the reactions to completion.
When such a signal transduction network contains transcription
factors, then, the Boolean model can be used to model the

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

MOHANTY et al.: MODEL FOR CANCER TISSUE HETEROGENEITY

behavior of the genes whose mRNA are transcribed by these
transcription factors. This is where we cross over to the domain
of continuous variables. The information obtained by observing these gene expressions can be used to find out the relative
effect of various subpopulations in the tumor tissue on the observables. This inferred relative effect can be interpreted as the
combined effect of the proportion wise breakup of the tumor
cell subpopulations as well as other random factors.
In [15], the authors present a Boolean model of the mitogenactivated protein kinase (MAPK) signal transduction network,
as reproduced in Fig. 1, and represent cancer as a stuck-at fault in
the network. Such a treatment reduces the problem of the selection of kinase inhibitors for the combination therapy to a simple
case where the kinase inhibitors can be selected based on their
effect on the variables of interest (the ones which are responsible for cell proliferation or apoptosis). Analysis in [15] has been
done considering only single stuck at faults at a time which can
be extended to the scenario of multiple faults. However, in either
case, this approach assumes that the entire cancerous tissue can
be modeled by a single faulty network. However, in reality, each
faulty network models only one faulty cell type, that is, models
only one of the subpopulations. To model the entire cancer population, we need an ensemble of networks where the number
of networks required is equal to the number of major subpopulations in the cancer tissue. This ensemble has to be deduced
from expert knowledge. In our model, the subpopulations or
networks in the ensemble exert their effect on the observables in
a weighted average fashion. Our objective is to find out the extent to which each network influences the behavior of the tissue
by observing the behavior of the outputs, which is determined
by the set of parameters in the model.
A survey of the existing literature can give us prior knowledge
about the most likely points in a network where a stuck-at fault
may occur. For instance, in 30% of human breast cancers, we
see an over expression of the ERBB2 gene [2]. This may cause
ligand-independent firing translating to a stuck-at one fault in
the Boolean network. A stuck-at one fault at ERBB2 means that
the variable corresponding to ERBB2 in the Boolean network
shown in Fig. 1 is always upregulated regardless of the activity
status of the proteins upstream of it. Similarly 90% of pancreatic
cancer cases have a mutated Ras gene which causes it to lose
its gtpase activity [2]. In other words, we have a stuck-at one
fault associated with the Ras gene. Thus, based on information
such as the origin of the cancer tissue and prior knowledge of
the most likely locations where faults can take place, we can
reduce the number of networks in our ensemble.
A. Simple Example
Let us consider a hypothetical cancer where we have narrowed
down the number of major subpopulations to three. Let the
first subpopulation be modeled by a Boolean network with a
stuck-at one fault at ERK1/2, let the second subpopulation have
two stuck-at-one faults at ERBB2/3 and Raf, and let the final
subpopulation have a stuck-at-zero fault at PTEN. The different
fault locations corresponding to the different subpopulations
are shown as purple rectangles in the single Boolean network in

967

Fig. 1. Boolean network model of the MAPK signal transduction network
with target locations of inhibitory drugs shown.

Fig. 1. Suppose we expose the cell culture to the drug U0126.
This is a kinase inhibitor which targets MEK1 as shown in
Fig. 1. (All the drugs used in this example are kinase inhibitors
whose molecular targets are shown in Fig. 1.) Let us also assume
that the serum, as typically used in tissue cultures, has EGF,
HBEGF, IGF, and NRG1 in it. If we observe the behavior of the
transcription factor SP1 (shown at the bottom of the Boolean
network in Fig. 1 with green arrows), the first network predicts
no change in the behavior of SP1 while in the second and third
networks, SP1 will be downregulated. One way to observe the

968

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

activity of SP1 is to measure the expression of a gene activated
by the SP1 response element, for instance cMYC. In the second
experiment, if we expose the cell culture to a combination of
AG1024 and Lapatinib, then SP1 will be upregulated in the
first and second subpopulations but downregulated in the third
subpopulation.
In the control experiment with no drug exposure, it is clear that
all the subpopulations will have their SP1 transcription factors
upregulated. The usual practice followed to calculate the normalized gene expression ratio is by the delta-delta method [16].
This involves normalizing with respect to a housekeeping gene
such as glyceraldehyde-3-phosphate dehydrogenase (GAPDH)
followed by normalization with respect to the control experiment. The normalized gene expression ratio is the variable that
we are interested in following.
A simple and realistic approach for modeling the normalized gene expression ratio utilizes the ratio of two normally
distributed random variables, each with its standard deviation
being directly proportional to its mean. The constant of proportionality is called the coefficient of variation, which is assumed
to be constant for all the normally distributed random variables.
A biological justification for this assumption of constant coefficient of variation has been provided in [17], where the gene
expressions were measured using microarrays, while the observation of this phenomenon is reported in [18]. In this paper,
our results will be developed specific to the aforementioned
example where the observed variables are normalized gene expression ratios. However, the results could be extended to the
analysis of other observables where the relative effect of the
various subpopulations on their behavior is to be determined.
This would require the use of models other than the ratio of two
normal random variables, such as the gamma distribution, the
log-normal distribution, or any other model which best fits the
data. Though other models can be used, this model has certain
advantages when it comes to determining the unknown parameters from collected data as we will demonstrate in the later
sections.
Let us assume that we are observing the expression of a
reporter gene of SP1, say cMYC. Let the effect of three subpopulations on the normalized gene expression ratio of cMYC
be in the ratio of αcM YC,1 : αcM YC,2 : αcM YC,3 .We will call
these the relative ratio parameters of cMYC which represent
the extent to which each subpopulation manifests its effect on
an observable (cMYC in this case). Each term in the ratio represents the net effect of a subpopulation which includes various factors such as the cell population and the concentration
of the mRNA level in the cells. Thus, the normalized gene
expression ratio of cMYC for the first experiment, where the
cell culture is exposed to U0126, is a random variable, which
in turn is the ratio of two normally distributed random variables. The one in the numerator has a mean directly proportional to αcM YC,1 and standard deviation directly proportional
to αcM YC,1 ×c (where c is the coefficient of variation which
is considered constant for all genes). This is because the addition of U0126 shuts down the activity of the SP1 transcription factor in the other two subpopulations. The one in the
denominator has a mean directly proportional to αcM YC,1 +

αcM YC,2 + αcM YC,3 and standard deviation directly proportional to (αcM YC,1 + αcM YC,2 + αcM YC,3 )×c since the control experiment has no drugs added and, therefore, the activity
of SP1 is not suppressed in any of the subpopulations. For the
second experiment, following the same logic, the normalized
gene expression ratio of cMYC is a ratio of two normally distributed random variables. The random variable in the numerator
has a mean of αcM YC,1 + αcM YC,2 and a standard deviation of
(αcM YC,1 + αcM YC,2 )×c, while the random variable for the
denominator is the same as that for the first case.
For an intuitive understanding, let us consider that the data
points are generated by a model where the coefficient of variation is 0. In that case, we will simply get the following two equations from the two experiments as shown below. If rcM YC,1 and
rcM YC,2 denote the two measured normalized gene expression
ratios of cMYC from the two experiments, we have
αcM YC,1
= rcM YC,1
(1)
αcM YC,1 + αcM YC,2 + αcM YC,3
αcM YC,1 + αcM YC,2
= rcM YC,2 .
αcM YC,1 + αcM YC,2 + αcM YC,3

(2)

Since αcM YC,1 : αcM YC,2 : αcM YC,3 is a ratio, we can have
the terms of the ratio sum to 1 to get the following equation:
αcM YC,1 + αcM YC,2 + αcM YC,3 = 1

(3)

Equations (1), (2), and (3) will let us calculate the relative
ratio parameters assuming that the data points are drawn from a
model with coefficient of variation c equal to 0.
However, in biological experiments, a large sample size is
hard to come by and sometimes we cannot afford to do a sufficient number of experiments to generate enough information
just by observing a single observable (cMYC in our example
above). For instance, if instead of the two experiments (excluding the control experiment) for the case described previously,
we do one experiment where we expose the cell culture to a
combination of the two drugs LY294002 and U0126; then, from
the faulty networks ensemble, it is apparent that the transcription factor FOS-JUN (also known as activator protein 1 or AP1)
will be upregulated in the first and third subpopulations while it
will be downregulated in the second one. Looking at SP1, it will
be upregulated in the first subpopulation while it will be downregulated in the second and third subpopulations. Let us assume
that we are observing a reporter gene of FOS-JUN. If we consider the case where c is 0 and use the same method as shown in
(1) through (3), we will need to use the observed values of two
different variables (a reporter gene of SP1 and a reporter gene
of FOS-JUN) to estimate the relative influence of the subpopulations on the observables. However, this method rests on the
assumption that the relative effects of the different subpopulations are the same for all the observables, which in this example
are the genes transcribed by FOS-JUN and SP1. This is a strong
assumption since as mentioned earlier, the observed variables
are affected not only by the proportions of the subpopulations,
but also by individual random effects arising from many possible factors which make the assumption of equal relative ratio
parameters unrealistic. However, the data coming from different
observables should not be ignored since all the observable data

MOHANTY et al.: MODEL FOR CANCER TISSUE HETEROGENEITY

Fig. 2.
model.

Bayesian network representing the conditional dependencies in our

points contain information about the proportion wise breakup of
the subpopulations. This calls for a model which utilizes all the
information coming from various sources. Even though for each
individual observable variable, the proportion wise breakup of
the subpopulations is a small factor affecting its behavior, this
factor affects all the observed variables. Thus, taking information from all the observed variables will allow us to determine
the proportion wise breakup among the subpopulations with
better accuracy.
One such model is the multilevel hierarchical model. In this
model, the relative ratio parameters vector αi = (αi,1 αi,2 αi,3 )T
for each observable variable i (the genes transcribed by SP1 and
AP1 in our examples) is drawn from a governing Dirichlet distribution having a parameter vector which needs to be estimated
from the data points. Hence, the relative ratio parameters for
each observable variable i sum up to 1 and are all nonnegative.
The parameter vector of the governing Dirichlet distribution is
representative of the average of the information from all observed variables.
III. HIERARCHICAL MODEL FOR HETEROGENEOUS
CANCER TISSUE
Multilevel hierarchical models are important new tools which
are becoming increasingly popular in modern quantitative research. These models are useful in cases where the data are organized as a hierarchy of nested populations. In our case, such a
model is applicable since according to our requirement, the relative ratio parameters vector for gene i, αi = (αi,1 αi,2 αi,3 )T
determine the distribution of the gene expression ratio of the
gene i and αi will be a different vector for each gene. For the
purpose of presentation, the coefficient of variation is not made
to have a hierarchical structure and the same value is assumed
for all the observable variables, although it is possible to develop
a hierarchical structure for the coefficient of variation allowing
it to vary from gene to gene. A lot of literature is available on
multilevel hierarchical models [19]–[21]. So, we will not go into
an in-depth discussion about a general hierarchical model. Instead, in this section, we will only describe the details pertaining
to our model.
Fig. 2 shows the conditional dependencies of the model. All
the observations for each observable variable have a probability
distribution which depends on the “relative ratio parameters”
for that variable. These relative ratio parameters are drawn from
an underlying Dirichlet distribution, the parameter vector K
of which is to be estimated. A Dirichlet distribution generates

969

vectors with nonnegative values whose elements add up to 1.
With the appropriate parameter vector K, the distribution can
be made to take a variety of shapes and center around any
mode (peak value of the probability distribution). This mode
can be interpreted as the average effect of the subpopulations
on the observables. The larger the values of the elements of the
parameter vector K, the “sharper” the Dirichlet distribution is
around the mode.
Another big advantage of a hierarchical model is that it allows
for the sharing of information across observables. Consider the
experiment in Section II-A, where the hypothetical tissue was
exposed to LY294002 and U0126. Looking at SP1 and FOSJUN separately, there is not enough information to infer the
relative ratio parameters for these two observables, but combining the data from these two observables allows us to determine
the parameters of the underlying Dirichlet distribution. This will
be demonstrated using synthetic data derived from the model of
the MAPK signal transduction network in a simulation example
and applied to real data derived from experiments on fibroblasts.
The probability distribution of the normalized gene expression ratio for the jth data point collected from an experiment
involving the measurement of the ith gene is dependent on the
relative ratio parameters vector αi , the coefficient of variation
c, and the “expression profile” di,j . The expression profile is
simply a vector whose length is equal to the number of subpopulations in our ensemble. An element of this vector di,j is 1, if
the contribution to the jth data point collected from an experiment involving the ith gene is expected to be upregulated in
the corresponding subpopulation, 0 otherwise. This will change
from one experiment to the next for the same gene depending
upon the behavior of the Boolean networks in the ensemble.
For example, the expression profile for the gene transcribed
by SP1 in the first example in Section II-A is (1 0 0)T for the
case where exposure to U0126 has occurred, and (1 1 0)T for the
case where exposure to AG1024 and Lapatinib has occurred. We
make the reasonable assumption that the expression profile for
each observable variable is known for each experiment since
it is dependent on the deterministic behavior of the Boolean
networks in the ensemble. As explained in Section II-A, the
normalized gene expression ratio is a ratio of two normally distributed random variables. We will derive the probability density
function of the ratio of two normally distributed random variables below. Consider two normal random variables T1 and T2
with mean and standard deviations μ1 and c × μ1 and μ2 and
c × μ2 , respectively. Define
R :=

T1
T2

(4)

and define
X := T2 .

(5)

Following the standard procedure for computing, the joint density of functions of two random variables, the Jacobian comes
out to be


 X R 
 = |X|.
(6)
J = 
0 1 

970

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

Since X = T2 has very thin tails in the negative region, we get
J ≈ X.

(7)

PR ,X (r, x) = PT 1 (t1 ) × PT 2 (t2 ) × J

(8)

Thus, we have

can be difficult or impossible to perform analytically. So, we
will resort to Markov chain simulation to estimate the posterior
probability distribution of the elements in the parameter vector
K.
A. Estimating Parameter Values From Observed Data

or
PR ,X (r, x) ≈

× exp −

1
2πμ1 μ2 c2


1
1
2
2
(rx − μ1 ) − 2 2 (x − μ2 ) x. (9)
2c2 μ21
2c μ2

μ1
Define m = μ 2 . Since we have PR (r) = PR ,X (r, x)dx,
integrating the joint density over all x, we obtain


m(r + m)
1 (r − m)2
exp
−
PR (r) = √
. (10)
3
2c2 (r2 + m2 )
2πc(r2 + m2 ) 2
We note that the expression in (10) above agrees with the
ratio distribution derived in [17].
Define mi,j = dTi,j αi . Thus, the conditional probability distribution of the normalized gene expression ratio of the ith gene
in the jth experiment comes out to be
mi,j (ri,j + mi,j )
P (ri,j /αi , di,j , c) = √
2 + m2 ) 32
2πc(ri,j
i,j
	

1 (ri,j − mi,j )2
.
× exp − 2 2
2c (ri,j + m2i,j )

(11)

Let N be the number of networks in the ensemble. For our
examples, we have N = 3 since we have chosen to include
three networks in the ensemble. However, it is not a hard and
fast rule to include exactly three networks in the ensemble since
the number of subgroups can be more or less than three. The
probability distribution of the relative ratio parameters vector
αi of the ith gene is given by

N
K q −1
q =1 αi,q
(12)
P (αi /K) =
Beta(K)
where Beta(K) is the beta function defined as

N
q =1 Γ(Kq )
.
Beta(K) = 
N
Γ
K
q
q =1

(13)

Here, Γ represents the Gamma function. Let ni be the number
of data points of the ith gene from all experiments combined and
let V be the total number of observables (genes). Let r denote
the set of all the data points ri,j taken together. Let d denote the
set of all di,j taken together. Then, considering the parameters
of interest K and c, we get the likelihood function of the data
points to be
ni
V  

P (r/K, c, d) =
P (ri,j /αi , di,j , c) P (αi /K)dαi .
i=1

j =1

(14)
This needs to be maximized over K and c in order to obtain
the maximum likelihood estimate of K and c. The integrations

Once the ensemble of networks has been chosen from biological knowledge, experimental data about gene behavior in
response to kinase inhibitor drugs can be used to estimate the
parameters of the model. We will use the Metropolis–Hastings
(M–H) algorithm to generate samples from the posterior distributions of the unknown parameters, which are the parameter
vectors K, all the αi ’s and the coefficient of variation c, conditional on all the data r. The M–H algorithm generates a Markov
chain in the unknown parameter space whose stationary distribution is the required posterior distribution of the unknown
parameters. Letting this Markov chain run to stationarity and
drawing samples from the Markov chain is equivalent to drawing samples of the unknown parameters from their posterior
distribution. There is a lot of available general literature on this
algorithm [19]–[21] and so we will simply focus on the specifics
for our case.
The usual Bayesian method requires us to define priors over
the parameters K and c. For c, we choose the prior such that the
reciprocal of the square of c is gamma distributed with a shape
v c2
parameter of v20 and an inverse scale parameter of 02 0
1
∼Γ
c2



v0 v0 c20
,
2
2


.

(15)

Here, Γ represents the Gamma distribution and not the
Gamma function.
For K, we choose a proper prior where all the elements of
K are independently identically exponentially distributed. The
means for these exponential distributions can all be made equal
and arbitrarily large so that the prior is almost flat as compared
to the posterior. Choosing proper prior distributions ensures that
the posterior is also proper.
To run the M–H algorithm, we need the full conditionals of the unknown variables. Define α−i as the set
{α1 , α2 , . . . , αi−1 , αi+1 , . . . , αV }. Then, the full conditional of
αi is as follows:
P (αi /K, c, r, α−i , d) ∝

∝

ni




ni

j =1

mi,j (ri,j + mi,j )
3

j =1

×

N


2 + m2 ) 2
(ri,j
i,j
K −1

αi,qq

.

P (ri,j /αi , di,j , c)P (αi /K)


1 (ri,j − mi,j )2
exp − 2 2
2c (ri,j + m2i,j )

		

(16)

q =1

Define α as the set of all the relative ratio parameters vectors
αi ’s. Let P (K) be the prior over K. Then, the full conditional

MOHANTY et al.: MODEL FOR CANCER TISSUE HETEROGENEITY

971

of K is as follows:
P (K/α, c, r, d) ∝ P (K) ×

V


P (αi /K)

i=1
N

1
∝ P (K) ×
(Beta(K))V q =1



V


	K q −1
αi,q

.

(17)

i=1

The full conditional of c is such that
 
 (r −m ) 2  	


v0 c20 + i,j (ri2, j +mi 2, j )
v0 + Vi=1 ni
1
i,j
i,j
,
.
∼Γ
c2
2
2
(18)
The parameters are sampled from their full conditionals one
after the other and after each cycle the newly generated values
are stored. c can be generated from its full conditional simply
by taking a sample from the standard gamma distribution with
the aforementioned parameters as shown in (18) and taking the
reciprocal of the square root of the sample. This convenient
step is possible due to the specific form of P (ri,j /αi , di,j , c)
which results from the ratio of two normally distributed random
variables. But K and the αi ’s need to be sampled from nonstandard distributions. We use random walk proposal distributions
to generate new values of K and αi ’s from their previous values.
New values K ∗ are sampled from their proposal distributions
in the following manner. For the qth element Kq∗ of K ∗ , do the
following:
1) Sample t from uniform(Kq − UK ,Kq + UK ), where Kq
is the qth element of K.
2) If t < 0, then set Kq∗ = −t, else set Kq∗ = t.
UK is a tuning parameter which can be adjusted to improve the
behavior of the Markov chain. Using the method as described
earlier makes the proposal distribution symmetric [21]. The
acceptance ratio for K is calculated as
RK =

P (K ∗ /α, c, r, d)
P (K/α, c, r, d)

(19)

and K is updated to K ∗ with a probability of min(RK , 1).
New values αi∗ are generated from a Dirichlet proposal distribution with parameter value vector given by Uααi . Uα i is a
i
tuning parameter. Define D(x/y) to be the probability distribution of x which is Dirichlet distributed with parameter y. Since
the proposal distributions used for the αi ’s are not symmetric,
the acceptance ratio is calculated as
α∗

Rα i =

P (αi∗ /K, c, r, α−i , d)D(αi / U αi )
i

P (αi /K, c, r, α−i , d)D(αi∗ / Uααi )

(20)

i

αi∗

αi is updated to
with a probability of min(Rα i , 1).
The series of steps described previously results in a Markov
chain whose stationary distribution is the same as the posterior
distribution of the unknown parameters. Letting this Markov
chain run to stationarity and drawing samples from the Markov
chain is equivalent to drawing samples of the unknown parameters from their posterior distribution.

Once the draws from the posterior distribution of the unknown
parameters have been obtained, we can obtain the posterior
mean, the values with the maximum posterior distribution value
(the modes), and the confidence intervals of the parameters from
the kernel density estimate. Such estimates of the parameter
vector K can then be used to determine the proportion wise
breakup of the subpopulations corresponding to the networks
included in the ensemble. Such methods will be demonstrated
in the following sections.
B. Experiments With Synthetic Data
To demonstrate the working of the algorithm, we ran simulations of the algorithm on synthetic data. We generated synthetic
data from the example described in Section II-A which was derived from the MAPK signal transduction network, which is a
well-understood network. Three networks with the “stuck-at”
faults described in the example from Section II-A were taken in
the ensemble. One reporter gene for each of the four transcription factors was considered as an observable. Thus, we have
four observables with four different “relative ratio parameter
vectors.” K was fixed to be (10 6 3)T . This corresponds to a
Dirichlet distribution with a mode of (0.5625 0.3125 0.1250)T .
c was fixed to be 0.1 since typical values of the coefficient of
variation were reported in [17] to be close to 0.17. First the
“relative ratio parameters” for the four observables were generated from the Dirichlet distribution with parameter vector K
and then held fixed for each reporter gene for the four transcription factors FOS-JUN, SP1, SRF-ELK1, and SRF-ELK4.
Then, observations of the observables were generated for various combinations of drugs following the model of the ratio of
two normally distributed random variables. Twelve drug combinations were chosen out of the 63 possible combinations of
the six drugs in the model in such a way so that the “expression
profiles” for each gene cannot generate a sufficient number of
equations permitting calculation of the “relative ratio parameters” for that gene, in the event that the coefficient of variation c
were zero. For example, all observed data points corresponding
to the reporter of FOS-JUN had their corresponding expression
profiles as (1 0 1)T and all observed data points of the rest of
the observables had their corresponding expression profiles as
(1 0 0)T . This is done so as to demonstrate how the sharing of
information from all the observables can be used to obtain an
estimate of the parameter vector K of the underlying Dirichlet
distribution.
For the purposes of demonstrating the algorithm, the prior
for the elements of the parameter vector K were chosen to have
exponential distributions with means of 1000, and the parameters for the prior of c were chosen as follows. The value v0 was
taken as 1 and c0 was taken to be 0.
The Markov chain was run for 3000 iterations to make it
reach stationarity. The tuning parameters were adjusted to get
acceptance rates of close to 30% for the unknown parameters.
The Markov chain was run for 400 000 iterations and thinned
100 times (1 in 100 samples generated was stored for each
parameter). This resulted in a maximum inefficiency factor of
less than 4 among all the parameters. The reader is referred

972

Fig. 3.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

Marginal distribution of the elements of the parameter vector K.

Fig. 4.

Marginal distribution of the elements of α for simulation experiments.

TABLE I
TABLE SHOWING WHICH GROUPS WERE EXPOSED TO WHICH COMPOUNDS

to [19]–[21] for information on Markov chain Monte Carlo
diagnostics and the inefficiency factor.
Multivariate kernel density estimation for any general N dimensional parameter vector is made using the multivariate
Gaussian kernel with a diagonal covariance matrix, the jth el2
σ
ement of which is given by Cj = ( j1 ) , where σj is the
n N +4

standard deviation of the jth element of the parameter vector
under consideration, n is the number of samples drawn from the
posterior distribution, and N is the number of elements in the
parameter vector (3 for K in our example). This rule of thumb
is discussed in [22].
Fig. 3 shows the kernel density estimate of the marginal distributions of the elements of K along with their priors. The priors
are far too spread out and noninformative as compared to the
posteriors. Hence, the value of K with the maximum posterior
distribution is equivalent to the maximum likelihood estimate.
This estimate comes out to be (9.1367 5.1330 2.2130)T which
was estimated from the kernel density estimate of the joint distribution of the three elements of the parameter vector K using
gradient ascent with nonnegativity constraints. Comparing it to
the actual value of K, we can see that it is quite close. Confidence intervals can also be calculated from the kernel density
estimates, although we have not shown such calculations here.
The more the data fed to the model, the more accurate is the
estimate and the confidence intervals are narrower.
We are more interested in the posterior distribution from
which the relative ratio parameters of the observables come.
That is, if we know the parameter vector K, we would like to
know the distribution of the relative ratio parameters, which is
nothing but Dirichlet distributed with the parameter vector K.
But since Khas a posterior distribution, we would like to know
the value of P (α/K) P (K/r, d) dK, where α = (α1 α2 α3 )T
is Dirichlet distributed with parameter vector K, and r is the set
of all observed data points. This can be obtained by sampling α
from Dirichlet distributions with parameters set as the samples
drawn from the posterior of K. Repeating this process for all
the samples of K, we get the samples of α. The posteriors of
the elements of α for this example are shown in Fig. 4. The
mode is derived from the kernel density estimate using gradient
ascent subject to the constraint that the elements of α sum to
1 along with nonnegativity constraints. The mode obtained is

(0.59740.29300.1095)T . Comparing it to the original mode of
(0.5625 0.3125 0.1250 )T , we can see that it is quite close.
C. Verification Using Experimental Data
In order to test, if the theory developed so far would work,
we need to collect data from an experiment performed on a
tissue where the dominant population or the dominant network
is known. In a cancerous cell line, one cannot be sure which
network is dominant. But in a normal cell line, such as adult
fibroblasts, it is fair to assume that a network modeling a faultless
MAPK signal transduction network would be the most dominant
one, no matter what networks are included in the ensemble.
Hence, we performed a simple experiment on adult fibroblasts
to demonstrate the approach.
Adult fibroblasts were grown in fibroblast basal medium
(ATCC) in 60-mm tissue culture petri dishes till confluence. Following this, the cells were maintained in Dulbecco’s modified
Eagles medium-F12 (DMEM/F12) (Atlanta Biologicals), supplemented with 0.2% fetal bovine serum (Atlanta Biologicals)
for four days (All concentrations of the supplements used were
calculated with respect to plain DMEM/F12 medium without
serum). The medium was changed every day after wash with
phosphate buffer solution. All cell cultures were incubated at
37 ◦ C in a 5% CO2 incubator.
The cells were then exposed to DMEM/F12 supplemented
with 0.2% FBS and 100 μM Anisomycin for 30 min. Anisomycin is a protein synthesis inhibitor which activates the
MAPK signal transduction network and keeps it responsive to
kinase specific inhibitors [23], [24]. That is, with the addition
of Anisomycin, we anticipate the MAPK signal transduction
network to respond to the addition of a drug such as U0126.
Anisomycin, being a protein synthesis inhibitor, would also cut
of any feedback path which has a translation (protein synthesis) step in it. The tissue culture petri dishes were then grouped
into three groups (groups 0, 1, and 2). After the initial 30 min

MOHANTY et al.: MODEL FOR CANCER TISSUE HETEROGENEITY

973

TABLE II
TABLE SHOWING THE NORMALIZED GENE EXPRESSION RATIOS, THEIR REFERENCE SEQUENCE (REFSEQ) NUMBERS, AND THEIR “EXPRESSION PROFILES”

to lack of enough data points. The mode is derived from the
kernel density estimate using the gradient ascent subject to the
constraint that the elements of α sum to 1 and nonnegativity constraints. This mode comes out to be (0.6453 0.2255 0.1292)T .
As expected, the faultless network representing normal fibroblasts has the maximum influence on the behavior of the observables, close to 65% . This simple experiment is a demonstration
of how real world technology such as QPCR can be used to
determine the composition of a heterogeneous tissue.
IV. CONCLUDING REMARKS
Fig. 5. Marginal distribution of the elements of α for data derived from
experiments on fibroblasts.

of exposure to Anisomycin, each group was then exposed to
DMEF/F12 supplemented with 20% FBS,100-μM Anisomycin,
50μM of LY294002, and/or 10μM of U0126 as shown in Table I.
Group 0 is not exposed to LY294002 or U0126, which are
highly specific inhibitors of PI3 Kinase (PI3K in Fig. 1) and
MEK1, respectively. The molecular targets of LY294002 and
U0126 are shown in Fig. 1. Genes having the SP1 and SRF-ELK
response elements in their promoters were quantified through
real-time PCR and the delta-delta method [16] with GAPDH as
the reference gene and group 0 as the control.
EGR1 is measured as a reporter gene of SRF-ELK transcription factor [25]. JUN, BIRC5, and cMYC are measured as reporters of SP1 [26]–[28]. Other genes having the SP1 response
element in their promoters are Decorin, IRF3, and VEGFA
[29]–[32]. Four different alternative transcripts of Decorin were
measured. Thus, we have a total of ten observables. The expression values calculated are shown in Table II.
For the sake of demonstration, we assumed three networks
to be in the ensemble. Network 1 has no mutations, i.e., no
“stuck-at” faults. This network models the normally behaving
fibroblasts. Network 2 is assumed to have a “stuck-at 1” fault at
ERK1/2 and network 3 is assumed to have “stuck-at 1” faults
at SRF-ELK1 and SRF-ELK4. The “expression profiles” for all
the genes for the experimental conditions of groups 1 and 2
are known and depend on the behavior of the three networks
included in the ensemble. These are shown in Table II.
As described in the previous section, samples from the posterior distributions of the unknown parameters were drawn using
the M–H Algorithm. The number of samples was drawn until
the effective sample size was atleast 300 for all the parameters.
The reader is referred to [21] for information on effective sample
sizes
 in Markov chain Monte Carlo analysis.
P (α/K) P (K/r, d) dK was estimated as described in the
previous section. The marginals of the three components of α
are shown in Fig. 5. The spread of the distribution is large due

In this paper, we addressed the important problem of heterogeneity in cancer tissues and presented a model which has the
ability to use prior pathway knowledge and knowledge about
likely mutations in cancers to represent a heterogeneous cancer
tissue as an ensemble of faulty Boolean networks. We demonstrated the general idea of our approach by considering the
observed variables to be genes transcribed by key transcription
factors. We modeled the gene expression ratios as ratios of normally distributed random variables whose means were affected
by the networks in the ensemble to varying degrees. However,
if some other observables are used, then the ratio of normally
distributed random variables formulation may not hold and,
hence, the lowest level of the hierarchical model would have
to be altered. However, the overall approach of hierarchically
modeling the relative ratio parameters would remain the same.
We also demonstrated how the M–H MCMC method can be
used to estimate the relative effect that each subpopulation exerts on the observed variables. This estimate gives us an idea
about which subpopulation is the most dominant one among all
the subpopulations in the ensemble. Such estimates, if obtained
using data from individual patients, could help customize combination therapy design and could help improve the success rate
of such cancer therapies.
Future work could also focus on algorithms that allow the
addition of networks other than the ones with which the algorithm starts or the deletion of networks so as to better fit the
data. The results in this paper have been developed with qPCR
data in mind. However, we do believe that similar models could
be developed to integrate data from more modern technologies such as next generation sequencing and flow cytometry
combined with prior pathway knowledge in order to determine
the compositional breakup of the tissue. The details, of course,
would need to be worked out and could form the basis for future
investigations.
ACKNOWLEDGMENT
The authors would like to thank B. P. Mishra for his help in
setting up the experiments.

974

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 3, MARCH 2014

REFERENCES
[1] P. C. Nowel, “The clonal evolution of tumor cell populations,” Science,
vol. 194, no. 4260, pp. 23–28, 1976.
[2] R. A. Weinberg, The Biology of Cancer, 1st ed. Princeton, NJ, USA:
Garland Science,, 2006.
[3] T. Reya, S. J. Morrison, M. F. Clarke, and I. L. Weissman, “Stem cells,
cancer, and cancer stem cells,” Nature, vol. 414, no. 6859, pp. 105–111,
2001.
[4] F. Barabe, J. A. Kennedy, K. J. Hope, and J. E. Dick, “Modeling the
initiation and progression of human acute leukemia in mice,” Science,
vol. 316, no. 5824, pp. 600–604, 2007.
[5] J. C. Wang and J. E. Dick, “Cancer stem cells: Lessons from leukemia,”
Trends Cell. Biol., vol. 15, no. 9, pp. 494–501, 2005.
[6] L. L. Campbell and K. Polyak, “Breast tumor heterogeneity: Cancer stem
cells or clonal evolution?,” Cell Cycle, vol. 6, no. 19, pp. 2332–2338,
2007.
[7] I. Shmulevich, E. R. Dougherty, S. Kim, and W Zhang, “Probabilistic
Boolean networks: A rule-based uncertainty model for gene regulatory
networks,” Bioinformatics, vol. 18, no. 2, pp. 261–274, 2002.
[8] A. Datta and E. Dougherty, Introduction to Genomic Signal Processing
With Control. New York, NY, USA: CRC Press, 2007.
[9] J. M. Bower and H. Bolouri, Computational Modeling of Genetic and
Biochemical Networks, 1st ed. Boston, MA, USA: MIT Press, 2001.
[10] N. Friedman, M. Linial, I. Nachman, and D. Pe’er, “Using Bayesian
Networks to analyze expression data,” J. Comput. Biol., vol. 7, no. 3–4,
pp. 601–620, 2000.
[11] M. Zou and S. D. Conzen, “A new Dynamic Bayesian Network (DBN)
approach for identifying gene regulatory networks from time course microarray data,” Bioinformatics, vol. 21, no. 1, pp. 71–79, 2005.
[12] S. Liang, S. Fuhrman, and R. Somogyi, “REVEAL, a general reverse
engineering algorithm for inference of genetic network architectures,” in
Proc. Pac. Symp. Biocomput., 1998, pp. 18–29.
[13] A. A. Margolin, I. Nemenman, K. Basso, C. Wiggins, G. Stolovitzky, R.
D. Favera, and A. Califano, “ARACNE: An algorithm for the reconstruction of gene regulatory networks in a mammalian cellular context,” BMC
Bioinformat., vol. 7, suppl. 1, S7, 2006.
[14] R. K. Layek, A. Datta, and E. R. Dougherty, “From biological pathways
to regulatory networks,” Mol. BioSyst., vol. 7, pp. 843–851, 2011.
[15] R. K. Layek, A. Datta, M. Bittner, and E. R. Dougherty, “Cancer therapy
design based on pathway logic,” Bioinformatics, vol. 27, no. 4, pp. 548–
555, 2011.
[16] K. J. Livak and T. D. Schmittgen, “Analysis of relative gene expression
data using real-time quantitative PCR and the 2−Δ Δ C t method,” Methods,
vol. 25, no. 4, pp. 402–408, 2001.
[17] Y. Chen, E. R. Dougherty, and M. L. Bittner, “Ratio-based decisions and
the quantitative analysis of cDNA microarray images,” J. Biomed. Opt.,
vol. 2, no. 4, pp. 364–374, 1997.
[18] Y. Chen, V. Kamat, E. R. Dougherty, M. L. Bittner, P. S. Meltzer, and
J. M. Trent, “Ratio statistics of gene expression levels and applications to
microarray data analysis,” Bioinformatics, vol. 18, no. 9, pp. 1207–1215,
2002.
[19] A. Gelman, J. B. Carlin, H. S. Stern, and D. B. Rubin, Bayesian Data
Analysis, 2nd ed. Boca Raton, FL, USA: CRC Press, 2004.
[20] A. Gelman and J. Hill, Data Analysis Using Regression and Multilevel/Hierarchical Models. Cambridge, U.K.: Cambridge Univ. Press,
2007.
[21] P. D. Hoff, A First Course in Bayesian Statistical Methods. New York,
NY, USA: Springer Texts in Statistics, 2009.
[22] P. D. Scott, Multivariate Density Estimation: Theory, Practice, and Visualization. New York, NY, USA: Wiley, 1992.
[23] M. Bébien, S. Salinas, C. Becamel, V. Richard, L. Linares, and
R. A. Hipskind, “Immediate-early gene induction by the stresses anisomycin and arsenite in human osteosarcoma cells involves MAPK cascade signaling to Elk-1, CREB and SRF,” Oncogene, vol. 22, no. 12,
pp. 1836–1847, Mar. 2003.
[24] P. Dhawan, A. Bell, A. Kumar, C. Golden, and K. D. Mehta, “Critical role of p42/44(MAPK) activation in anisomycin and hepatocyte
growth factor-induced LDL receptor expression: Activation of Raf-1/Mek1/p42/44(MAPK) cascade alone is sufficient to induce LDL receptor expression,” J. Lipid Res., vol. 40, no. 10, pp. 1911–1919, Oct. 1999.
[25] R. W. Clarkson, C. A. Shang, L. K. Levitt, T. Howard, and M. J. Waters,
“Ternary complex factors Elk-1 and Sap-1a mediate growth hormone
induced transcription of Egr-1 (Early growth response factor-1) in 3T3F442A preadipocytes,” Mol. Endocrinol., vol. 13, no. 4, pp. 619–631,
1999.

[26] D. Rozek and G. P. Pfeifer, “In vivo protein-DNA interactions at the c jun
promoter: Preformed complexes mediate the UV response,” Mol. Cell.
Biol., vol. 13, no. 9, pp. 5490–5499, 1993.
[27] M. V. Mityaev, E. P. Kopantzev, A. A. Buzdin, T. V. Vinogradova, and
E. D. Sverdlov, “Functional significance of a putative Sp1 transcription factor binding site in the surviving gene promoter,” Biochemistry
(Moscow), vol. 73, no. 11, pp. 1183–1191, 2008.
[28] D. Levens, “How the c-MYC promoter works and why it sometimes does
not,” J. Nat. Cancer I. Monographs, vol. 39, pp. 41–43, 2008.
[29] F. Verrecchia, J. Rossert, and A. Mauviel, “Blocking sp1 transcription
factor broadly inhibits extracellular matrix gene expression in vitro and in
vivo: Implications for the treatment of tissue fibrosis,” J. Invest. Dermatol.,
vol. 116, no. 5, pp. 755–763, May 2001.
[30] H. G. Xu, R. Jin, W. Ren, L. Zou, Y. Wang, and G. P. Zhou, “Transcription
factors Sp1 and Sp3 regulate basal transcription of the human IRF-3 gene,”
Biochimie, vol. 94, no. 6, pp. 1390–1397, Jun. 2012.
[31] S. L. Samson and N. C. Wong, “Role of Sp1 in insulin regulation of gene
expression,” J. Mol. Endocrinol., vol. 29, no. 3, pp. 265–279, 2002.
[32] G. Pagès, and J. Pouysségur, “Transcriptional regulation of the vascular
endothelial growth factor gene-a concert of activating factors,” Cardiovasc. Res., vol. 65, no. 3, pp. 564–573, 2005.

Anwoy Kumar Mohanty (S’13) received the B.Tech. and M.Tech. degrees in
electronics and electrical communication engineering from the Indian Institute
of Technology, Kharagpur, West Bengal, India, in 2010, as part of a five year
integrated program. He is currently working toward the Ph.D. degree in the
Department of Electrical Engineering, Texas A&M University, College Station,
TX, USA.
He is also a Research Assistant in the Department of Electrical Engineering, Texas A&M University. His areas of interest include signal processing,
predictive modeling, machine learning, stochastic control, and genomic signal
processing.

Aniruddha Datta (F’09) received the B.Tech. degree in electrical engineering
from the Indian Institute of Technology Kharagpur, Kharagpur, India, in 1985,
the M.S.E.E. degree from Southern Illinois University, Carbondale, IL, USA, in
1987, and the M.S. in applied mathematics and Ph.D. degrees from the University of Southern California, Los Angeles, CA, USA, in 1991.
In August 1991, he joined the Department of Electrical and Computer Engineering, Texas A&M University, College Station, TX, USA, where he is
currently the J. W. Runyon, Jr. 35 Professor II. His areas of interest include
adaptive control, robust control, PID control, and genomic signal processing.
He has authored or coauthored five books and more than 100 journal and conference papers on these topics.
Dr. Datta has served as an Associate Editor of the IEEETRANSACTIONS
ON AUTOMATIC CONTROL (2001–2003), the IEEETRANSACTIONS ON SYSTEMS,
MAN AND CYBERNETICS, B (2005–2006), and is currently serving as an Associate Editor of the EURASIP Journal on Bioinformatics and Systems Biology,
the IEEETRANSACTIONS ON BIOMEDICAL ENGINEERING, and IEEE Access.

Vijayanagaram Venkatraj received B.V.Sc. degree in veterinary medicine
from Madras Veterinary College, Chennai, India, in 1979, and the M.Sc. and
Ph.D. degrees from New York University, New York, NY, USA, in 1987, and
1992, respectively.
The laboratory experiments for his thesis “Molecular Studies in Fanconi’s
Anemia” were accomplished at Rockefeller University Hospital, New York, NY,
USA. He was a clinical fellow in human genetics and underwent clinical training
for Board Certification in human clinical molecular and cytogenetic diagnosis
and counseling at the Department of Medical Genetics, College of Physicians
and Surgeons, Columbia University, New York, NY, USA, from 1993–1996.
During this time, he was also a Project Member of the First NIH Funded
Human Genome Project to map and sequence human chromosome 13 at the
Department of Genetics and Development, College of Physicians and Surgeons,
Columbia University. He has been a Diplomat of the AMERICAN BOARD OF
MEDICAL GENETICS, since 2000, and is currently a Genetics and Genomic
division faculty in the Department of Veterinary Integrated Biosciences, College
of Veterinary Medicine, Texas A& M University, College Station, TX, USA. His
research interest include genomic basis of cancer development and resistance
to chemotherapy, specifically in breast cancer.

