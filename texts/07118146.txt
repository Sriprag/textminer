IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

2665

Cup Implant Planning Based on 2-D/3-D
Radiographic Pelvis Reconstruction—First
Clinical Results
Steffen Schumann∗ , Member, IEEE, Yoshinobu Sato, Member, IEEE, Yuki Nakanishi, Futoshi Yokota, Masaki Takao,
Nobuhiko Sugano, and Guoyan Zheng, Member, IEEE

Abstract— Goal: In the following, we will present a newly developed X-ray calibration phantom and its integration for 2-D/3-D
pelvis reconstruction and subsequent automatic cup planning. Two
different planning strategies were applied and evaluated with clinical data. Methods: Two different cup planning methods were investigated: The first planning strategy is based on a combined pelvis
and cup statistical atlas. Thereby, the pelvis part of the combined
atlas is matched to the reconstructed pelvis model, resulting in an
optimized cup planning. The second planning strategy analyzes
the morphology of the reconstructed pelvis model to determine the
best fitting cup implant. Results: The first planning strategy was
compared to 3-D CT-based planning. Digitally reconstructed radiographs of THA patients with differently severe pathologies were
used to evaluate the accuracy of predicting the cup size and position. Within a discrepancy of one cup size, the size was correctly
identified in 100% of the cases for Crowe type I datasets and in
77.8% of the cases for Crowe type II, III, and IV datasets. The second planning strategy was analyzed with respect to the eventually
implanted cup size. In seven patients, the estimated cup diameter
was correct within one cup size, while the estimation for the remaining five patients differed by two cup sizes. Conclusion: While both
planning strategies showed the same prediction rate with a discrepancy of one cup size (87.5%), the prediction of the exact cup size
was increased for the statistical atlas-based strategy (56%) in contrast to the anatomically driven approach (37.5%). Significance:
The proposed approach demonstrated the clinical validity of using
2-D/3-D reconstruction technique for cup planning.
Index Terms—Cup, 2-D/3-D reconstruction, orthopedics, pelvis,
prosthesis, planning, X-ray radiograph.

I. INTRODUCTION

T

HE importance of preoperative planning for total
hip arthroplasty (THA) has long been recognized by

Manuscript received December 18, 2014; revised March 18, 2015 and April
29, 2015; accepted May 26, 2015. Date of publication June 4, 2015; date of current version October 16, 2015. This work was supported by in part by the Swiss
National Science Foundation (SNSF) via the Project IZK0Z3_149048/1, in part
by the Swiss KTI Project No. 13523.1 PFFLR-LS, and in part by KAKENHI
26108004 and 25242051. Asterisk indicates corresponding author.
∗ S. Schumann is with the Institute for Surgical Technology and Biomechanics, University of Bern, 3014 Bern, Switzerland (e-mail: steffen.schumann@
ieee.org).
Y. Sato and F. Yokota are with the Imaging-based Computational Biomedicine
Lab, Graduate School of Information Science, Nara Institute of Science and
Technology.
Y. Nakanishi is with the Graduate School of System Informatics, Kobe University and also with the Nara Institute of Science and Technology.
M. Takao and N. Sugano are with the Graduate School of Medicine, Osaka
University.
G. Zheng is with the Institute for Surgical Technology and Biomechanics,
University of Bern.
Digital Object Identifier 10.1109/TBME.2015.2441378

clinicians [1]–[4]. Many studies have revealed the benefit of
using medical imaging technologies such as plain X-ray radiography or computed tomography (CT) to determine the best
fitting prosthesis type and size prior to surgery [2], [5], [6]. A
tight fit of the implants reduces the risk of postoperative complications such as dislocation. Thus, the preoperative identification
of the optimal cup and stem size could be an essential step to
reduce this risk. Traditional plain films have been used in the
past to perform the planning for acetabular cup and femoral stem
components. These preoperative plans were made using acetate
templates with a fixed magnification factor of 115–120% [7].
But this magnification factor is only valid for a particular ratio
of x-ray source to patient distance and patient to film distance.
Therefore, the assumption of a fixed magnification factor introduces a certain error in predicting the correct implant size.
This prediction error is mainly affected by the habitus of the
patient and the actual image acquisition scenario. Potential consequences in wrong estimation of the magnification factor, and
hence, of the implant’s size are bone fractures, limb length inequality, or instability [3], [8].
Improved planning accuracy was reported by using 3-D imaging modalities such as CT [6], [9], [10]. Viceconti et al. [11]
compared acetate templating with CT-based planning. The prediction accuracy of the correct (within one size) acetabular cup
size was increased from 69% for templating to 93% for CTbased planning. Even though superior accuracy was shown for
CT-based planning, the costs and the exposure to higher radiation dose limit the use of CT for preoperative planning of
standard THAs. As conventional x-ray films are gradually replaced by digital image acquisition techniques, digital planning would allow correcting the fixed magnification factor of
templates. But the exact magnification factor of digital x-ray
still remains unknown. In order to determine the magnification factor many different concepts have been proposed in the
literature [3], [5], [7], [12]–[15]. They all share the idea of integrating an object of known size into the X-ray imaging pipeline.
By comparing the projected object size in pixels with the real
size in millimeter, a scaling factor can be derived and applied
to the implant templates. In order to get a precise estimation of
the magnification factor, the scaling object needs to be placed
as close as possible to the concerned hip joint. Ideally, the scaling object is placed in the same coronal plane as the hip joint
and at the same distance from the projection center. In the clinical routine, the correct positioning of the scaling object can
only be roughly accomplished [16]. Many studies have been

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2666

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

published in the literature comparing conventional acetate templating with digital scale-corrected planning. While Whiddon
et al. [13] reported a higher prediction accuracy using digital
planning [prediction accuracy within one size for digital (78%)
and analog planning (67%)], Iorio et al. [8], Della Valle et al. [5],
and The et al. [15] founded improved planning results for acetate
templating. Iorio et al. compared planning results with actually
implanted prostheses size of 50 patients. Acetate templating
predicted the correct cup size in 78% of the cases, whereas digital planning significantly overpredicted the cup size leading to a
success rate of 60% [8]. A similar study was performed by Della
Valle et al. They compared the preoperative values of analog and
digital plannings with the actual used prosthesis for 64 patients
undergoing THA. Acetate templating predicted the correct cup
size in 97% of the cases, while digital planning was successful
in only 81% of the cases [5]. The et al. compared the prediction accuracy of analog and digital planning for cemented and
uncemented cup in 182 patients. For cemented cups, the digital
planning resulted in similar prediction accuracies (digital: 72%,
analog: 73%), whereas digital planning was considerably less
frequently correct for uncemented cups (digital: 52%, analog:
64%) [15].
As the integration of a simple scaling does not necessarily
lead to precise planning results, a more sophisticated solution is
required. A possible solution using two separate radio-opaque
markers has been presented by King et al. [17]. In a series of
74 patients, the cup size was correctly predicted in 77% of the
cases and in 100% of the cases within one cup size. Another
approach using 3-D information from biplanar low-dose X-ray
imaging has been demonstrated by Journe et al. [18]. In an in
vitro study, the cup orientation inserted to a dry cadaver bone
was measured for a series of biplanar datasets showing higher
accuracy compared to the conventional X-ray radiography.
Most of the methods published in the literature proposed the
integration of a simple scaling object to determine the magnification factor. But as the correct positioning of the scaling
object is difficult to accomplish, its integration does not lead
to reproducible results. Moreover, the solutions to the actual
3-D problem of planning the optimal size and position of the
acetabular component are mostly proposed using 2-D X-ray images. In order to overcome these deficiencies, we propose an
integrated approach based on the 2-D/3-D reconstruction technique. Therefore, the objective of this study was to develop and
evaluate a complete system of X-ray image calibration, 2-D/3-D
pelvis reconstruction, and subsequent, automatic acetabular cup
planning. Thereby two different cup planning methods were investigated. The first planning strategy was directly compared to
3-D CT-based planning, while the accuracy of the second strategy was indirectly assessed by means of clinically implanted
cup sizes.
II. MATERIALS AND METHODS
A. X-ray Calibration
The computation of the calibration parameters is required to
obtain the spatial relationship of the acquired X-ray images. In
our previous approach for reconstructing an acetabular patch

from radiographs we proposed using a specifically designed
phantom to determine the camera parameters [19]. As this phantom was originally designed for the purpose of calibrating fluoroscopic images with a focal distance of approximately 800 mm,
a new calibration phantom was designed. In order to reflect the
larger field of view of a conventional X-ray device compared to a
fluoroscope, the dimensions of the phantom and the fiducial size
were increased by a factor of 1.6. In total 16 spherical fiducials
Fi , i = 1 − 16 of different diameter F1 –F7 : 8 mm, F8 –F16 :
5 mm were distributed among two planes. As previously proposed in [20] sets of three fiducials {FkA ; FkB ; FkC , k = 1 − 5}
are collinearly aligned, whereas the distance ratio of each fiducial triple is unique {Rk = |FkA FkB |/|FkB FkC |}. The specific
distance ratios are used for identifying corresponding fiducials
between 2-D projections and 3-D phantom coordinates using
a lookup-table method. For details of extracting the 2-D fiducials and establishing correspondences, we refer to our previous publication [19]. In contrast to the fluoroscopic calibration
phantom, where three unique line patterns were defined, the
fiducials of the new phantom were arranged in five unique line
patterns (k = 1 − 5). As one line needs to be uniquely identified
for successful calibration phantom detection, the probability of
line identification is increased, and thus, making the calibration
method more robust to outliers. After identification of corresponding fiducials, the precise fiducial center was previously
determined using circular hough transformation [19]. But as
oblique views (central X-ray beam not orthogonal to the detector) of the phantom are taken, the fiducial projections are elliptically distorted. Therefore, the circle detection was replaced by
ellipse fitting as presented by Fitzgibbon et al. [21]. Moreover,
the overall shape of the phantom was particularly designed to
match the human anatomy of the abdomen [see Fig. 1]. Thus, the
phantom could be conveniently attached to the patient’s waist
using a conventional belt.
B. 2-D/3-D Reconstruction
For a set of minimum two calibrated X-ray radiographs, a
2-D/3-D reconstruction pipeline is applied. The core part of this
algorithm has been presented by Zheng et al. [22]. Based on a set
of X-ray landmarks and 2-D outer bone contours, the algorithm
performs an iterative scaled registration of a statistical-shape
model (SSM) to the X-ray scene and generates a patient-specific
bone model by statistical instantiation and nonrigid deformation.
For an optimal initial scale and pose estimation, following
eight landmarks were predefined on the statistical mean model
and selected on the X-ray radiographs [see Fig. 2(a)]:
1) anterior superior iliac spine (left and right);
2) anterior pubic tubercle (left and right);
3) apex of arcuate line (left and right);
4) posterior superior iliac spine (left and right).
After initial landmark-based registration, the iterative scaled
registration matches the SSM to the X-ray scene based on correspondences between the 2-D outer bone contours and the 3-D
apparent silhouette of the mean model. In order to set up the
correspondences robustly, the 2-D contours and the vertices
of the mean model were assigned either to the left or right

SCHUMANN et al.: CUP IMPLANT PLANNING BASED ON 2-D/3-D RADIOGRAPHIC PELVIS RECONSTRUCTION—FIRST CLINICAL RESULTS

2667

Fig. 1. X-ray calibration phantom (here without belt) attached to the abdomen of the patient in AP (left) and lateral view (middle) and an exemplary AP
radiograph (right).

Fig. 2. a) Landmarks in AP-view visualized as dots: (1) left anterior superior iliac spine (ASIS), (2) right ASIS, (3) left pubic tubercle, (4) right pubic tubercle,
(5) apex of left arcuate line, (6) apex of right arcuate line, (7) left posterior superior iliac spine (PSIS), (8) right PSIS; b) 2-D bone contours; c) reconstructed
patient-specific pelvis model.

hemipelvis. Thus, the correspondences were restricted to the
hemipelvis only and cross matchings between the hemipelvises
could be avoided [22]. In addition to the outer pelvis contours,
the obturator foramen contours were extracted [see Fig. 2(b)].
The 2-D contours were drawn using a live-wire algorithm as
implemented by the visualization toolkit library (www.vtk.org).
Subsequent to the iterative scaled registration, the statistical
model is instantiated based on the inherent eigenmode information in two consecutive steps. After the first instantiation
step, the correspondences are updated and used as input for the
second instantiation step. By these instantiation steps, the statistical information of the underlying population is exploited to
fit the SSM to the patient-specific X-ray scene. In the final step,
the instantiated model is nonrigidly deformed in order to improve the matching to the X-ray scene, and thereby, recovering
the patient-specific bone model [see Fig. 2(c)]. A summary of
the steps is shown in Fig. 3.

C. Cup Planning Strategies
1) Statistical Atlas-Based Cup Planning: Acetabular cup
planning involves not only the estimation of the best fitting
cup size and pose but also the maximization of the acetabular
coverage and the preservation of sufficient acetabular bone. In
order to accomplish these requirements and to reduce preoperative planning time, the automatic cup planning technique as
proposed by Otomaru et al. [23] was applied. They have collected preoperative manual cup plannings based on CT datasets
and combined them to a pelvis and cup statistical shape model.
In order to obtain an automatically planned cup for a new patient dataset, the pelvis part of the combined atlas is matched
to the surface model extracted from the patient dataset. By this
optimization step, a shape parameter vector of SSM results,
which can be directly applied to instantiate the cup part of the
combined atlas. Fitting a parametric hemispherical cup model
to the instantiated cup resulted in the final implant position and

2668

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

Fig. 3. Illustration of the complete pipeline consisting of 2-D/3-D reconstruction and cup planning. Only the feature extraction step is performed interactively,
while the remaining steps are carried out automatically.

size. The cup planning step presumes a planned femoral stem
prosthesis. Recent studies have shown that the femoral anteversion could be reliably measured by means of radiographs [24],
[25]. Based on the anteversion angle of the planned stem implant, the optimal cup rotational parameters were determined
based on the mathematical model developed by Widmer and
Zurfluh [26]. An adequate summary of the complete stem and
cup planning pipeline was described by Morooka et al. [27].
2) Anatomically Driven Cup Planning: The anatomically
driven planning of the cup implant is purely based on the shape
of the reconstructed pelvis model. In order to select the best fitting cup, its size, position, and orientation need to be estimated.
The optimal cup is thereby determined based on the predefined
acetabular rim. Both bilateral acetabular rims were initially determined by picking points on the mean model. This information
is then transferred to the reconstructed pelvis and used to determine the acetabular diameter and opening normal. The diameter
is estimated by fitting a circle to the acetabular rim points, while
the acetabular normal is established by fitting a plane. In order to
determine the optimal cup position, the intersection of the plane
normal with the acetabular fossa is calculated. Accordingly, the
cup implant with a diameter closest to, but larger than the circle
diameter is selected. The selected cup is then positioned within
the acetabulum by aligning its apex with the fossa apex. Finally,
the orientation of the cup is adjusted by aligning the cup normal
with the acetabular rim normal.
D. Experiments
The proposed approach of combining 2-D/3-D pelvis reconstruction and automatic cup planning (see Fig. 3) was evaluated in two different studies. In the first study, the statistical
atlas-based cup planning was evaluated using digitally reconstructed radiographs and directly compared to the 3-D CT-based

planning technique. In the second study, the anatomically driven
planning of the cup implant was performed based on pelvis
models reconstructed from pre- and postoperative X-ray radiographs. Its accuracy was indirectly evaluated on the basis of the
actually implanted cup size. Thereby, a difference in planned
cup size by one increment (1-mm difference in cup radius) is
generally regarded as clinically acceptable.
1) Statistical Atlas-Based Cup Planning: Digitally reconstructed radiographs (DRRs) were computed from 16 CT
datasets of Japanese female patients scheduled for THA at Osaka
University Hospital. In order to simulate the real clinical scenario of the whole pipeline including the X-ray calibration, the
volume of each patient CT-scan was merged with the CT-volume
of the calibration phantom, which was independently acquired.
This merged CT-dataset was then used to generate DRRs in
anterior–posterior (AP) and outlet view. The outlet view was
obtained by tilting the X-ray source from an AP position around
the transversal body axis cranially by approximately 60◦ . Both
views are routinely used in clinics and can be conveniently acquired by the radiological team by only moving the X-ray source
and detector. The set of two X-ray images was further calibrated
and the features (landmarks, contours) were extracted accordingly. The 2-D/3-D reconstruction pipeline was further supplied
with an SSM constructed from 100 Japanese female CT-datasets
(nJap
pelv = 100) scheduled for THA. The datasets were of different pathologic severity and covered all four Crowe categories.
These respective surface models were obtained by application of
an automatic segmentation strategy [28]. The datasets used for
generating the DRR cases were not part of this training database.
Moreover, the statistical atlas-based cup planning requires information on the desired rotational parameters. These parameters are normally derived from the planned stem prosthesis.
As in the present case, a 3-D reconstucted model of the proximal femur was not available for planning the stem prosthesis,

SCHUMANN et al.: CUP IMPLANT PLANNING BASED ON 2-D/3-D RADIOGRAPHIC PELVIS RECONSTRUCTION—FIRST CLINICAL RESULTS

the best fitting stem had been estimated beforehand based on
the approach by Otomaru et al. [29]. The corresponding stem
anteversion angle was then used to predetermine cup rotation in
terms of pelvic anteversion and inclination angle.
The 3-D reconstructed pelvis model was further matched
with the combined statistical shape model for the purpose of
automatic cup planning. This combined SSM included 63 patient datasets (nJap
pelv+cup = 63), whereas the surface models were
also part of the SSM population for 2-D/3-D reconstruction
Jap
(nJap
pelv+cup ⊂ npelv ). All surgical plans comprising this atlas were
performed at Osaka University Hospital by different experienced surgeons. In order to have a consistent statistical atlas
of planned cups, the criteria of THA planning were commonly
shared among the surgeons. As the resolution of the SSM used
for 2-D/3-D reconstruction (50 000 vertices) differed from the
one used for automatic planning (3000 vertices), a direct matching based on one-to-one correspondences was not possible.
For each DRR dataset, the surface reconstruction error and
the cup planning accuracy was analyzed. The surface reconstruction error was determined in terms of the mean distance
between the two triangulated surfaces in Euclidean space. For
each vertex of the ground-truth surface, the closest point is computed on the reconstructed surface. From the resulting histogram
of these values, the mean distance is computed to determine the
surface reconstruction error. The error measurement was performed with commercial software (Amira, FEI, Hillsboro, OR,
USA). The surface reconstruction error was independently assessed for the complete pelvis model and for the local acetabular
region. The acetabular patch was manually extracted from each
ground-truth surface model and used to find closest points on
the (complete) reconstructed pelvis model. Thus, the surface reconstruction error was determined globally for the pelvis model
and locally for the concerned acetabular region.
The planning accuracy was evaluated by comparing the statistical atlas-based planning results with the manually planned cup
size and position. As the cup was modeled as a hemisphere, the
origin of the cup coordinate system was defined by the center of
the sphere. The difference in cup position was measured as the
length of the vector from the surgeon’s planned cup position to
the automatically calculated position. In addition, the automatic
cup planning procedure using the ground-truth surface model
was also assessed.
2) Anatomically Driven Cup Planning: Patients with hiprelated problems were randomly selected for the preliminary
clinical evaluation of our cup planning approach. This clinical study was carried out in accordance to the Declaration of
Helsinki and informed consent of participation in this study was
obtained from the patients. Before X-ray acquisition, the calibration unit (see Fig. 1) was wrapped with a belt around the
patient’s waist and slightly tightened to have a close fit with
the patient’s pelvic anatomy. First the standard AP radiograph
was acquired, followed directly by the acquisition of the inlet
view. Thereby, the inlet view was obtained by tilting the X-ray
source from an AP position around the transversal body axis
caudally by approximately 25◦ . As only the X-ray source needs
to be moved, the patient will remain in the supine position. The
X-ray acquisitions were performed at the hospital in Aarberg,

2669

Fig. 4. Ground-truth pelvis model (dataset 12) extracted from CT-scan with
surface distance error superimposed on acetabular region. The values besides
the color bar indicate the minimum, mean, and maximum error.

Switzerland. The patients were either scheduled for postoperative checkup or for preoperative diagnosis and planning. Each
set of radiographs was calibrated and the 2-D/3-D reconstruction
pipeline was applied using a gender-specific SSM constructed
from either 57 female or 57 male CT-datasets (nCauc
pelv = 114). All
CT-datasets were obtained from Caucasian patients, whereas the
majority of the patients (approximately 80%) were scheduled
for total hip replacement and the remaining part for treatment
of femoro-acetabular impingement. In general the datasets were
of mild pathologic severity. The average age of the patients was
50 ± 18 years with a minimal age of 17 years and a maximal
age of 86 years. About 30% of the patients were younger than
40-years old at the time of CT-acquisition, while about 70%
were equal or older than 40 years.
Subsequently to the 3-D reconstruction, anatomically driven
cup planning was carried out. For postoperative datasets, the cup
was planned for the contralateral patient side. The planned cup
sizes were then compared with the ipsi-laterally implanted cup
sizes (postoperative datasets) or the cup sizes manually planned
by means of an AP radiograph (preoperative datasets).
3) Comparison of Planning Approaches: In order to compare both cup planning approaches, the anatomically driven cup
planning was further applied to the pelvis models reconstructed
on the basis of the 16 digitally reconstructed radiographs. The
estimated cup size was then compared to the cup size of the
manual planning and the statistical atlas-based planning.
III. RESULTS
A. Statistical Atlas-Based Cup Planning
In total 16 DRR datasets (AP and outlet view) were generated from hip CT-datasets. The hips were categorized by the

2670

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

TABLE I
MEAN SURFACE RECONSTRUCTION ERRORS [MM] AS MEASURED BETWEEN GROUND-TRUTH
AND RECONSTRUCTED MODELS OF THE PELVIS AND ACETABULUM

Dataset 1
Dataset 2
Dataset 3
Dataset 4
Dataset 5
Dataset 6
Dataset 7

Pelvis

Acetabulum

Acetmax

1.52 ± 1.22
1.82 ± 1.47
1.16 ± 0.98
1.59 ± 1.33
1.60 ± 1.26
1.19 ± 1.01
1.15 ± 0.90

1.56 ± 1.44
1.94 ± 1.24
1.98 ± 1.40
2.27 ± 1.48
1.56 ± 1.40
1.78 ± 1.61
1.01 ± 0.70

7.97
6.67
6.16
6.58
7.81
9.32
4.85

Pelvis
Dataset 8
Dataset 9
Dataset 10
Dataset 11
Dataset 12
Dataset 13
Dataset 14
Dataset 15
Dataset 16

Crowe Type I

Acetabulum

1.71 ± 1.49
3.40 ± 2.69
2.02 ± 1.94
3.51 ± 3.46
2.00 ± 1.92
4.86 ± 3.51
1.56 ± 1.42
3.25 ± 2.25
1.61 ± 1.81
3.13 ± 3.39
1.89 ± 1.68
4.34 ± 3.59
1.58 ± 1.62
3.67 ± 3.38
1.50 ± 1.57
4.07 ± 3.53
1.72 ± 1.91
2.94 ± 2.33
Crowe Type II, III, IV

Acetmax
13.34
16.23
16.53
10.97
11.37
15.68
17.18
14.78
15.23

TABLE II
COMPARISON OF CUP PLANNING APPROACHES TO SURGEON’S MANUAL PLAN OF CROWE TYPE I DATASETS

Dataset 1
Dataset 2
Dataset 3
Dataset 4
Dataset 5
Dataset 6
Dataset 7

AtlasBased Planning Using Ground-Truth Surface Model

Atlas-Based Planning Using X-ray Reconstructed Surface Model

Cup Size Difference [mm]

Positional Difference [mm]

Cup Size Difference [mm]

Positional Difference [mm]

Cup Size Difference [mm]

+1
0
+1
+1
0
0
0

3.4
2.4
0.7
1.2
1.1
1.2
1.3

0
0
0
+1
0
0
0

4.3
6.0
1.5
6.5
2.6
5.7
5.3

-2
-2
0
0
+2
0
-4

clinicians according to the severity of hip dysplasia [30]. Out
of these 16 datasets, seven were generated from CT datasets of
patients with Crowe type I, while the remaining nine datasets
were generated from patients with Crowe type II, III, and IV.
On average, the pelvis was reconstructed with a surface reconstruction error of 1.60 ± 1.51 mm and the concerned acetabular
region with an error of 2.83 ± 2.58 mm. The maximum error of
the acetabular region was in the range of 4.85–17.18 mm.
While the surface reconstruction error was smaller for Crowe
I patients (1.42 ± 1.21 mm for the pelvis and 1.72 ± 1.36
mm for the acetabulum), the error was increased for severely
deformed pathologies of Crowe II, III, and IV patients (1.73 ±
1.77 mm for the pelvis and 3.68 ± 3.00 mm for the acetabulum).
At the same time, the maximum error range increased from
4.85 to 9.32 mm for the Crowe I datasets to a range of 10.97–
17.18 mm for the Crowe II, III, and IV datasets. The error
distribution of an acetabular region is shown for one dataset
in Fig. 4. The detailed errors for all datasets are presented in
Table I.
For all datasets a cementless cup (Stryker, Kalamazoo, MI,
USA) was used for manual CT-based and statistical atlas-based
2-D/3-D planning. The statistical atlas-based planning approach
using the X-ray reconstructed surface model predicted the exact
cup size in out 9 of 16 cases (56.25%). Within a discrepancy of
one cup size (corresponds to a difference of 2 mm at maximum),
the percentage increased to 87.5% (14/16 cases). While for
Crowe type I datasets, the cup size was correctly identified in
86% of the cases (100% within one cup size), the prediction
accuracy decreased to 33% (77.8% within one cup size) for
Crowe type II, III, and IV datasets. Using the CT-extracted

Anatomically Driven Cup Planning

surface model, the automatic planning correctly predicted the
cup size for 57% of Crowe type I (100% within one cup size)
and 56% for Crowe type II, III, and IV datasets (77.8% within
one cup size).
The difference in cup position was higher for X-ray reconstructed models. On average the positional difference for Crowe
type I datasets was 1.61 ± 0.87 mm for CT-extracted models
and 4.56 ± 1.73 mm for X-ray reconstructed surface models.
For Crowe type II, III, and IV datasets, an average error in cup
position of 3.94 ± 1.83 mm was found for CT-extracted models and 6.73 ± 3.38 mm for X-ray reconstructed models. The
detailed planning results are presented in Tables II and III.
B. Anatomically Driven Cup Planning
Biplanar radiographs of 12 patients were acquired. Ten of
them were scheduled for postoperative checkup, while for two
patients preoperative image acquisition was performed. For each
patient a pressfit cup implant (Mathys, Bettlach, Switzerland)
was automatically planned. While the cup size of three datasets
were correctly estimated, the cup size was overestimated in six
cases and underestimated in three cases (see Table IV). For five
datasets, the planned cup size differed from the implanted one
by two cup sizes, and for another four datasets by a single cup
size (step width of 2 mm). Within a discrepancy of one cup size,
the percentage of correctly estimated cup size was 58.3%.
C. Comparison of Planning Approaches
For Crowe type I datasets, the statistical atlas-based planning showed a better prediction rate for the exact cup size (86%)

SCHUMANN et al.: CUP IMPLANT PLANNING BASED ON 2-D/3-D RADIOGRAPHIC PELVIS RECONSTRUCTION—FIRST CLINICAL RESULTS

2671

TABLE III
COMPARISON OF CUP PLANNING APPROACHES TO SURGEON’S MANUAL PLAN OF CROWE TYPE II, III, AND IV DATASETS

Dataset 8
Dataset 9
Dataset 10
Dataset 11
Dataset 12
Dataset 13
Dataset 14
Dataset 15
Dataset 16

Atlas-Based Planning Using Ground-Truth Surface Model

AtlasBased Planning Using X-ray Reconstructed Surface Model

Anatomically Driven Cup Planning

Cup Size Difference [mm]

Positional Difference [mm]

Cup Size Difference [mm]

Positional Difference [mm]

Cup Size Difference [mm]

0
+4
0
0
0
−6
0
−4
+2

4.0
5.6
6.4
1.6
2.3
4.5
2.1
6.6
2.4

−2
0
−2
0
−2
−6
−2
−4
0

3.6
15.0
4.6
4.4
8.4
4.0
8.6
5.9
6.1

−2
+2
0
0
−2
+2
−2
0

TABLE IV
COMPARISON OF ANATOMICALLY DRIVEN CUP PLANNINGS WITH ACTUALLY IMPLANTED CUPS

Patient 1
Patient 2
Patient 3
Patient 4
Patient 5
Patient 6
Patient 7
Patient 8
Patient 9
Patient 10
Patient 11
Patient 12

Gender

Pre-/post-op

3-D Planned Cup Size [mm]

Implanted Cup Size [mm]

female
male
male
male
female
male
female
male
female
female
male
male

post-op
post-op
post-op
post-op
pre-op
pre-op
post-op
post-op
post-op
post-op
post-op
post-op

50
54
48
58
52
56
50
54
50
48
48
58

50
50
50
54
56
54
48
54
48
48
52
54

than the anatomically driven cup planning approach (43%). But
considering a discrepancy of one cup size, the difference in
prediction rate was less (100% for statistical atlas-based and
86% for anatomically driven planning). For Crowe type II, III,
and IV datasets, the prediction rate of the exact cup size was
the same for both approaches (33.3%), whereas the anatomically driven approach showed a slightly higher prediction rate
of 88.9% in comparison to the statistical atlas-based planning
of 77.8%. However, in case anatomically driven approach, the
planned cup of dataset 9 was regarded is invalid. Due to an
abnormal amount of osteophytes along the posterior superior
acetabular rim, the cup got misaligned with respect to the actual
opening of the acetabulum.
IV. DISCUSSION
We have proposed an integrated approach of X-ray image
calibration, 2-D/3-D reconstruction and automatic cup planning.
Two different cup planning strategies were applied and evaluated
with respect to CT-based planning and the finally implanted cup
prostheses.
The first strategy matches a patient-specific surface model to a
statistical atlas of planned cups. This planning strategy was evaluated based on digitally reconstructed radiographs computed
from CT-datasets of patients scheduled for THA. For Crowe
type I pathologies, the cup size could be correctly predicted
with a discrepancy of one cup size in 100% of the cases, while

for Crowe type II, III, and IV pathologies, the prediction rate
dropped to 77.8%. While similar prediction rates were found for
automatic planning based on the ground-truth CT-extracted surface models, the positional error was considerably higher based
on the 2-D/3-D reconstructed models. An explanation might be
that the overall shape of the acetabulum is reconstructed with a
reasonably good accuracy (prediction rate of cup size is in the
same range as with ground-truth models), but the reconstruction
of local areas of the acetabulum have certain deficiencies (negatively affecting the positional accuracy). Besides the analysis of
cup size selection and cup position, the surface reconstruction
error was determined for the global pelvic shape and the local acetabular region. As expected, the reconstruction error increased
for both inspections (pelvis and acetabulum) with the severity
of the deformation (Crowe type I ⇒ Crow type II/III/IV). In
case of the local acetabular region, a greater increase of error
was observed than for the overall pelvic shape. This observation might be related to the appearance of local osteophytes,
which are hardly recognizable in the radiograph, and therefore,
not fully considered during contour drawing and subsequent
2-D/3-D reconstruction. Moreover, the presented reconstruction approach focused on the complete pelvic shape. Thus, a
localized reconstruction of the acetabulum as proposed in [19]
might improve the reconstruction accuracy, but has not been
applied in this case.
The second strategy was based on the reconstructed pelvis
model and a predefined acetabular rim. The validity of this

2672

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

strategy was analyzed based on the finally implanted cup implants of 12 patients, demonstrating a cup size prediction rate
of 58.3%. As the planning accuracy could not directly be compared to the conventional 2-D templating within this study, we
would like to refer to similar studies published in the literature
(see [15], [17], and [8]). In these studies, prediction rates of
52%–78% were reported for digital and acetate planning. Thus,
similar prediction rates were achieved with planning strategies
using a single x-ray radiograph. Two main factors might largely
affect the accuracy of anatomically driven 2-D/3-D-based cup
planning. First, the X-ray acquisition protocol needs to be optimized. This protocol comprises the view angle between both
radiographs and the immobilization of the calibration phantom
with respect to the patient. A relatively small shift of the calibration phantom with respect to the pelvic anatomy might lead
to certain inaccuracies in the 3-D reconstruction process. More
trials need to be performed to investigate the optimal angle
between the AP and the oblique (e.g., inlet, outlet, ...) view.
Second, the planning method needs to be further improved. On
one hand, the cup planning relies on the acetabular rim that
needs to be preserved during reconstruction. Thus, abnormal
osteophytes and certain distortions of the surface mesh during
reconstruction will lead to an alteration of the morphology and
might consequently affect the planning accuracy. On the other
hand, more clinical information in terms of bone coverage or
residual bone thickness might need to be incorporated into the
planning process.
Both planning strategies were directly compared to each other
in terms of cup size prediction. Thereby, the prediction rate of
both strategies was the same (87.5%) for all 16 datasets, if a
maximum difference of one cup size is considered to be valid.
The prediction of the exact cup size was increased for the statistical atlas-based strategy (56%) in contrast to the anatomically
driven approach (37.5%). Thereby, a direct relationship between
the surface reconstruction error of the pelvis and the acetabulum
and the subsequent cup planning was not observed for none of
the two strategies. Even though the anatomical cup planningbased approach failed for one dataset, the cup size could be
estimated with a reasonably good accuracy for the remaining
datasets despite the presence of abnormal osteophytes.
In order to analyze the validity of the 2-D/3-D reconstruction
technique for preoperative planning, the next step will also focus on the estimation of the stem prosthesis. The planning of
the stem implant will include the compensation for potential leg
length discrepancy and the definition of the osteotomy plane
on the femoral bone. The automatic planning of all prosthesis
components will then finally be tested with clinical X-ray radiographs and compared to the conventional X-ray-based planning
and the finally implanted prostheses.
V. CONCLUSION
In this paper, we have demonstrated the application of
2-D/3-D reconstruction technique for preoperative planning of
the cup prosthesis. The proposed approach requires two calibrated X-ray radiographs in AP and oblique view (e.g., inlet,
outlet) of the pelvic anatomy to generate a patient-specific surface model of the pelvis. This patient-specific model was further

supplied to two different cup planning strategies. While the first
strategy is based on a statistical atlas of pelvis model and planned
cups, the second strategy only considers the pelvic morphology.
Different experiments were conducted to analyze the accuracy of
predicting the cup size and position. The first strategy predicted
the cup size with same accuracy as if the ground-truth model
would have been used. But certain deficiencies were found for
the positional alignment. The cup size prediction accuracy of the
second strategy was in a similar range as reported in the literature for the conventional templating. Although further clinical
trials will be required to further improve the X-ray acquisition
protocol and cup planning, these first clinical results showed
the potential of using conventional X-ray imaging and 2-D/3-D
reconstruction for cup planning.

REFERENCES
[1] J. Knight and R. Atwater, “Preoperative planning for total hip arthroplasty,” J. Arthroplasty, vol. 7, pp. 403–409, 1992.
[2] S. Eggli et al., “The value of preoperative planning for total hip arthroplasty,” J. Bone Joint Surg. Brit., vol. 80, pp. 382–390, 1998.
[3] J. Bono, “Digital templating in total hip arthroplasty,” J. Bone Joint Surg.
Am., vol. 86, pp. 118–122, 2004.
[4] A. Unnanuntana et al., “The accuracy of preoperative templating in cementless total hip arthroplasty,” J. Arthroplasty, vol. 24, pp. 180–186,
2009.
[5] A. D. Valle et al., “The utility and precision of analogue and digital
preoperative planning for total hip arthroplasty,” Int. Orthop., vol. 32,
pp. 289–294, 2008.
[6] N. Sugano et al., “Computed-tomography-based computer preoperative planning for total hip arthroplasty,” Comput. Aided Surg., vol. 3,
pp. 320–324, 1998.
[7] C. Bayne et al., “Evaluation of the accuracy and use of x-ray markers
in digital templating for total hip arthroplasty,” J. Arthroplasty, vol. 24,
pp. 407–413, 2009.
[8] R. Iorio et al., “A comparison of acetate vs digital templating for preoperative planning of total hip arthroplasty: Is digital templating accurate and
safe?” J. Arthroplasty, vol. 24, pp. 175–179, 2009.
[9] T. Kalteis et al., “Position of the acetabular cup accuracy of radiographic
calculation compared to CT-based measurement,” Eur. J. Radiol., vol. 58,
pp. 294–300, 2006.
[10] H. Hassani et al., “Comparisons of preoperative three-dimensional planning and surgical reconstruction in primary cementless total hip arthroplasty,” J. Arthroplasty, vol. 29, pp. 1273–1277, 2014.
[11] M. Viceconti et al., “CT-based surgical planning software improves the
accuracy of total hip replacement preoperative planning,” Med. Eng. Phys.,
vol. 25, pp. 371–377, 2003.
[12] S. Wimsey et al., “Accurate scaling of digital radiographs of the pelvis,”
J. Bone Joint Surg. Br., vol. 88, pp. 1508–1512, 2006.
[13] D. Whiddon et al., “Accuracy of digital templating in total hip arthroplasty,” Am. J. Orthop., vol. 40, pp. 395–398, 2011.
[14] K. Conn et al., “A simple guide to determine the magnification of radiographs and to improve the accuracy of preoperative templating,” J. Bone
Joint Surg. Br., vol. 84, pp. 269–272, 2002.
[15] B. The et al., “Comparison of analog and digital preoperative planning in
total hip and knee arthroplasties: A prospective study of 173 hips and 65
total knees,” Acta Orthop., vol. 76, pp. 78–84, 2005.
[16] R. Diercks et al., “Digital correction of magnification in pelvic X rays for
preoperative planning of hip joint replacements: Theoretical development
and clinical results of a new protocol,” Med. Phys., vol. 32, pp. 2580–2589,
2005.
[17] R. King et al., “A novel method of accurately calculating the radiological
magnification of the hip,” J. Bone Joint Surg. Brit., vol. 91, pp. 1217–1222,
2009.
[18] A. Journe et al., “New method for measuring acetabular component positioning with EOS imaging: Feasibility study on dry bone,” Int. Orthop.,
vol. 36, pp. 2205–2209, 2012.
[19] S. Schumann et al., “An integrated system for 3-D hip joint reconstruction
from 2-D x-rays: A preliminary validation study,” Ann. Biomed. Eng.,
vol. 41, pp. 2077–2087, 2013.

SCHUMANN et al.: CUP IMPLANT PLANNING BASED ON 2-D/3-D RADIOGRAPHIC PELVIS RECONSTRUCTION—FIRST CLINICAL RESULTS

[20] S. Schumann et al., “Calibration of c-arm for orthopedic interventions via statistical model-based distortion correction and robust phantom detection,” in Proc. IEEE 9th Int. Symp. Biomed. Imag., 2012,
pp. 1204–1207.
[21] A. Fitzgibbon et al., “Direct least square fitting of ellipses,” IEEE Trans.
Pattern Anal. Mach. Intell., vol. 21, no. 5, pp. 476–480, May 1999.
[22] G. Zheng et al., “A 2D/3D correspondence building method for reconstruction of a patient-specific 3D bone surface model using point distribution models and calibrated x-ray images,” Med. Image Anal., vol. 13,
pp. 883–899, 2009.
[23] I. Otomaru et al., “Automated 3d acetabular cup planning in total hip
arthroplasty based on expertise modeling using statistical shape models
(in japanese),” J. Jpn. Soc. Comput. Aid Surg., vol. 14, pp. 27–37, 2012.
[24] T. Viel et al., “Is radiographic measurement of distal femoral torsion
reliable?” Orthop. Traumatol. Surg. Res., vol. 99, pp. 517–522, 2013.
[25] D. Folinais et al., “Measuring femoral and rotational alignment: EOS
system versus computed tomography,” Orthop. Traumatol. Surg. Res.,
vol. 99, pp. 509–516, 2013.
[26] K.-H. Widmer and B. Zurfluh, “Compliant positoning of total hip components for optimal range of motion,” J. Ortho. Res., vol. 22, pp. 815–821,
2004.

2673

[27] K. Morooka et al., “A survey on statistical modeling and machine learning approaches to computer assisted medical intervention: Intraoperative
anatomy modeling and optimization of interventional procedures,” IEICE
Trans. Inform. Syst., vol. 96, pp. 784–797, 2013.
[28] F. Yokota et al., “Automated CT segmentation of diseased hip using hierarchical and conditional statistical shape models,” in Medical Image
Computing and Computer-Assisted Intervention. New York, NY, USA:
Springer, 2013, pp. 190–197.
[29] I. Otomaru et al., “Automated preoperative planning of femoral stem
in total hip arthroplasty from 3D CT data: Atlas-based approach and
comparative study,” Med. Image Anal., vol. 16, pp. 415–426, 2012.
[30] J. Crowe et al., “Total hip replacement in congenital dislocation and dysplasia of the hip,” J. Bone Joint Surg. Am., vol. 61, pp. 15–23, 1979.

Authors’ photographs and biographies not available at the time of publication.

