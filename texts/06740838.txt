332

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Carotid Intraplaque Neovascularization
Quantification Software (CINQS)
Zeynettin Akkus, Gerard van Burken, Stijn C. H. van den Oord, Arend F. L. Schinkel, Nico de Jong,
Antonius F. W. van der Steen, and Johan G. Bosch

Abstract—Intraplaque neovascularization (IPN) is an important biomarker of atherosclerotic plaque vulnerability. As IPN can
be detected by contrast enhanced ultrasound (CEUS), imagingbiomarkers derived from CEUS may allow early prediction of
plaque vulnerability. To select the best quantitative imagingbiomarkers for prediction of plaque vulnerability, a systematic
analysis of IPN with existing and new analysis algorithms is necessary. Currently available commercial contrast quantification tools
are not applicable for quantitative analysis of carotid IPN due to
substantial motion of the carotid artery, artifacts, and intermittent
perfusion of plaques. We therefore developed a specialized software
package called Carotid intraplaque neovascularization quantification software (CINQS). It was designed for effective and systematic
comparison of sets of quantitative imaging biomarkers. CINQS includes several analysis algorithms for carotid IPN quantification
and overcomes the limitations of current contrast quantification
tools and existing carotid IPN quantification approaches. CINQS
has a modular design which allows integrating new analysis tools.
Wizard-like analysis tools and its graphical-user-interface facilitate
its usage. In this paper, we describe the concept, analysis tools, and
performance of CINQS and present analysis results of 45 plaques of
23 patients. The results in 45 plaques showed excellent agreement
with visual IPN scores for two quantitative imaging-biomarkers
(The area under the receiver operating characteristic curve was
0.92 and 0.93).
Index Terms—Carotid plaques, contrast enhanced ultrasound,
microbubble, neovascularization, plaque perfusion analysis, quantification of neovascularization.

CEUS
CINQS
GUI
IPN

NOMENCLATURE
Contrast enhanced ultrasound.
Carotid intraplaque neovascularization software.
Graphical user interface.
Intraplaque neovascularization.

Manuscript received October 1, 2013; revised December 17, 2013 and January
27, 2014; accepted February 10, 2014. Date of publication February 14, 2014;
date of current version December 30, 2014. This work was supported within
the framework of CTMM, the Center for Translational Molecular Medicine
(www.ctmm.nl), Project PARISk under Grant 01 C-202, and by the Netherlands
Heart Foundation.
Z. Akkus, G. van Burken, and J. G. Bosch are with the Department of Biomedical Engineering, Thoraxcenter, Erasmus Medical Center, Rotterdam 3015 GE,
The Netherlands (e-mail: zetgate@gmail.com; g.vanburken@erasmusmc.nl;
j.bosch@erasmusmc.nl).
S. C. H. van den Oord and A. F. L. Schinkel are with the Department of Cardiology, Thoraxcenter, Erasmus Medical Center, Rotterdam 3015 GE, The Netherlands (e-mail: s.vandenoord@erasmusmc.nl; a.schinkel@erasmusmc.nl).
N. de Jong and A. F. W. van der Steen are with the Department of Biomedical
Engineering, Thoraxcenter, Erasmus Medical Center, Rotterdam 3015 GE, The
Netherlands and also with the Department of Applied Physics, Technical University of Delft, 2628 CN Delft, The Netherlands (e-mail: n.dejong@erasmusmc.nl;
a.vandersteen@erasmusmc.nl).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2306454

MIP
MIPNSA
MIPNSR
MPCP
MVN
SS
SSIPNSA
SSIPNSR
PE
PLER
PMI
ROI
TIC

Maximum intensity projection.
MIP-based IPN surface area.
MIP-based IPN surface ratio.
Mean plaque contrast percentage.
Number of microvessels.
Statistical segmentation.
SS-based IPN surface area.
SS-based IPN surface ratio.
Plaque enhancement.
Plaque to Lumen enhancement ratio.
Plaque mean intensity.
Region of interest.
Time intensity curve.
I. INTRODUCTION

EVERAL pathological studies have presented intraplaque
neovascularization (IPN) as an important biomarker for
plaque instability and rupture [1]–[3]. These small microvessels
within arterial atherosclerotic plaques can be visualized using
contrast enhanced ultrasound (CEUS). Therefore, quantitative
imaging biomarkers based on CEUS may allow early prediction
of plaque vulnerability. To select the best quantitative imaging
biomarkers, a systematic evaluation and optimization of existing
and new IPN analysis algorithms, and an effective and systematic comparison of sets of multiple imaging biomarkers need to
be done on patient populations.
IPN is seen in a CEUS image sequence as the subtle intermittent appearance of small moving contrast spots within
the dark plaque. Currently available commercial tools for contrast quantification, e.g., QLAB ROI quantification tool (Philips
Medical Systems, Bothell, USA) and VueBox (Bracco Suisse
SA, Geneva, Switzerland), are not suitable for quantitative analysis of IPN. These quantification tools have been developed
mainly for large organs such as heart, liver, and prostate, not for
plaques. Plaques are relatively small and weakly perfused structures, and directly adjacent to the bright artery lumen. Saturation
and shadowing artifacts are common. Plaques are also moving
substantially due to pulsation of the artery, breathing, or patient
motion. Therefore, accurate tracking of the motion of the plaque
is essential for intensity analysis to prevent contamination of
the ROI by contrast from the lumen and high intensity artifacts. Currently available contrast quantification tools are based
on time intensity curves (TIC). TICs of atherosclerotic plaques
are characterized by a number of short peaks corresponding
to the passage of single (or clusters of) contrast bubbles (see
Fig. 1) and do not resemble the typical massive bolus passage
or flash/replenishment curves seen in the lumen of an artery or

S

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

AKKUS et al.: CAROTID INTRAPLAQUE NEOVASCULARIZATION QUANTIFICATION SOFTWARE (CINQS)

333

Fig. 2. Side-by-side contrast (a) and B-mode (b) image of a carotid artery
with plaques.

Fig. 1. Time intensity curve (TIC) of a plaque and local density random walk
(LDRW) and gamma-variate curve fits obtained with QLAB ROI quantification tool. PE = plaque enhancement. PI = peak enhancement. BI = baseline
intensity, intensity at time 0.

in the perfusion pattern of large organs or tumors. As can be
seen in Fig. 1, fitting a curve model for bolus perfusion (such as
Gamma-Variate [4] or local density random walk (LDRW) [5])
to the TIC of IPN does not capture the true perfusion characteristics of IPN. In some studies [6], [7], such bolus passage
parameters such as plaque enhancement (PE) (PE = Peak intensity (PI)—Baseline intensity (BI, intensity at time 0)) and PE to
lumen enhancement ratio parameters were used to assess IPN.
They were derived from TIC curve fitting in the same way as
for large organs. In our opinion, this is not a suitable approach.
Therefore, there is a considerable demand for specialized IPN
quantification tools.
So far, assessment of IPN relies mostly on subjective visual
assessment as quantification tools for IPN are scarce. Recently, a
review paper [8] presented the methods used so far to assess IPN
and discussed the current status of CEUS in carotid atherosclerosis. There are some reported quantitative approaches [6] [7],
and [9] but they suffer from a number of limitations as described
in [10].
In our study, we focus on carotid artery plaques at risk of
rupture by using noninvasive CEUS imaging. Our paper is performed in the context of a large consortium project, CTMMParisK (Plaque at Risk), which investigates molecular, biological, morphological, biomechanical, and imaging biomarkers of
carotid artery atherosclerotic plaque to detect plaque at risk of
rupture. Our purpose is to compare existing and new IPN parameters derived from CEUS and to select suitable IPN parameters
for prediction of plaque vulnerability. For this purpose, we need
a platform which allows evaluation and optimization of IPN
quantification tools for CEUS images. Requirements for such a
platform include
1) Development and optimization of new and existing IPN
analysis algorithms.
2) Testing existing and new IPN analysis algorithms systematically on patient datasets.
3) Measuring intraobserver and interobserver variability for
reproducibility of results.
4) Open to integration of new analysis tools for comparison.
5) Reproducible and repeatable usage of analysis tools and
platform.

6) Tools should be usable by clinicians without programming
knowledge.
We therefore developed a software package called carotid intraplaque neovascularization quantification software (CINQS).
CINQS was developed for internal use within the CTMMParisK project. It contains a collection of different IPN analysis tools for carotid artery CEUS image sequences that can
overcome the limitations of currently available contrast quantification tools and reported IPN quantification approaches. It
enables systematic analysis of IPN with different analysis tools
on large datasets (up to several hundred patients), comparing
their outputs, and selecting suitable parameters for measuring
IPN degree. In this paper, we describe the concept, design, analysis tools, and performance of CINQS. We also present analysis
results of 45 plaques of 23 patients.
II. CONCEPTS OF CINQS
CINQS requires side-by-side simultaneously acquired contrast and B-mode image sequences. This choice was made because the plaque motion is a serious issue in IPN analysis,
and this motion can be obtained more accurately from B-mode
images than from contrast images. It was designed for the sideby-side carotid contrast images (see Fig. 2) of the Philips iU22
system but it could be easily extended for other ultrasound systems which provide such side-by-side images.
The features of CINQS are listed below:
1) Specialized IPN analysis tools for carotid CEUS image sequences: Currently available contrast quantification tools
(e.g., QLAB and VueBox) generally provide only TIC
analysis for a ROI (without motion compensation suitable for plaques). In addition to TIC perfusion analysis,
CINQS includes motion compensation tools tailored for
plaques; time integrated parametric images of plaque perfusion such as maximum intensity projection (MIP), and
analogously, minimum, mean, and standard deviation intensity projection images over time; detection and tracking
of individual contrast spots within a plaque ROI to detect
microvasculature paths; and segmentation of individual
contrast spots based on statistical models of intensity distributions, and their time integration to find neovascularization area.
2) Saving and retrieving of objects and analyses: Objects
(ROIs of plaque, lumen and background, or motion compensation points) and complete analyses (e.g., a MIP including ROI, motion compensation points, and all analysis settings) are saved separately into XML files and
can be retrieved separately as well. Objects can be reused

334

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

and assigned to multiple IPN analysis tools. Retrieving
previously defined objects for every patient allows systematic comparison of different IPN analysis tools over
patient datasets. Furthermore, this allows comparing different versions of IPN analysis algorithms and optimizing
their parameters for the same objects. CINQS also allows
retrieving complete analyses without displaying the previously defined objects. This allows observers to redefine
objects with previous analysis settings (e.g., frame interval, motion compensation pattern) while being blinded
to the previous objects, for measuring intraobserver and
interobserver variability. In currently available contrast
quantification tools, objects such as ROIs generally cannot
be shared between different analyses: for each analysis, a
user has to draw a new ROI. That makes it hard to perform
exact comparisons of methods. To compare intraobserver
or interobserver variability of different methods, the same
set of ROIs defined by observer(s) should be applied to
each of the methods. CINQS uses an independent database
for DICOM files. A local copy of DICOM files are obtained before analysis. Objects and analyses are also saved
to this database.
3) User-friendly operation: CINQS hosts an extensive toolbox of freely selectable analysis tools in a graphical user
interface (GUI), which makes it very versatile and flexible
in use and requires no scripting or programming for the
user. On the other hand, a very structured use of these tools
is desired to perform patient studies. To provide a structured interface for the clinical users, the different complex analyses are offered as a so-called wizard structure:
a checklist-like interface that provides different required
steps in a predefined order, with associated help and suggestions for each step. This enforces the clinical users to
use the analysis tools in a repeatable fashion throughout a
study.
4) Extendable with new analysis tools: CINQS has a modular design and this allows integrating new analysis tools
without restructuring software.
In addition to the features listed above, CINQS allows exporting output parameters, graphs, images, and clips. Numerical
output parameters and graphs can be exported as an Excel file
with specific time, date, and version number. This allows comparing parameters of different versions of analysis algorithms
in a systematic way and importing the results into a statistical
software package such as SPSS (SPSS Inc., Chicago, IL, USA)
for extensive statistical analyses and tests. Screenshots of CEUS
clips can be saved as JPEG format. Video clips with or without
overlaid objects can be recorded as AVI format.
Furthermore, CINQS allows creation of an overlay image
(contrast on B-mode, Fig. 3) for drawing ROIs, which helps to
delineate the inner and outer border of plaques more accurately
than the duplication of ROI in contrast or B-mode as used in
commercial tools (e.g., QLAB and VueBox).
III. SOFTWARE DESIGN
CINQS was mainly built in MevisLab (MeVis Medical Solutions AG and Fraunhofer MEVIS, Bremen, Germany), a development environment for medical image processing and visual-

Fig. 3. Example of a contrast image overlaid on B-mode for plaque ROI
drawing.

Fig. 4. Modules and interaction scheme of CINQS. GUI = Graphical User
Interface. I/O = Input/output. ROI = Region of Interest. GSM = Grayscale
Median.

ization. The IPN quantification algorithms were implemented
in MATLAB (The Mathworks Inc., Natick, Massachusetts,
US), and run through a MeVisLab-MATLAB interface module
(MatlabScriptWrapper). The communication between MevisLab modules and the graphical user interface (GUI) was controlled via Python scripts. The GUI (Fig. 8, 9) was designed
with the internal MevisLab definition language.
CINQS has a modular design as shown in Fig. 4. The main
modules are GUI, file input/output (I/O), objects and graph
management, and analyses.
A brief description of the CINQS framework components is
presented here. The file I/O module handles reading and writing
of DICOM image files, saving and retrieving objects and analysis files as XML files, and exporting numerical and graph data
as EXCEL files. All IPN analysis modules use motion compensation as a prerequisite step. All graphs, drawn objects, and their
properties are organized by the objects and graphs module. This
module also handles the conversion of log-compressed image
data into linearly scaled data for graph representation. The GUI
module allows general image and result viewing, user interactions, and guides the user to follow analysis procedures through
wizards as described in the following section.
IV. GRAPHICAL USER INTERFACE
The graphical user interface consists of two main parts, which
are the file I/O GUI and the analysis GUI. In the file I/O part,

AKKUS et al.: CAROTID INTRAPLAQUE NEOVASCULARIZATION QUANTIFICATION SOFTWARE (CINQS)

DICOM images, objects lists, and analysis lists can easily be
browsed and loaded. DICOM files can also be previewed before
loading. When an object or analysis list is loaded the related
DICOM images will be automatically loaded. A screenshot of
the file I/O GUI is seen in Fig 8. The analysis GUI is shown
in Fig. 9. It contains wizard-like analysis tools, and sections for
image and graph viewing, object handling, export, analysis tree,
and output parameters. The image viewer [see Fig. 9(E)], graph
viewer [see Fig. 9(F)], and image slider are synchronized with
each other. Selecting an image frame will show the corresponding graph point and vice versa. In the analysis tree section [see
Fig. 9(G)], a log of all user interactions is kept to remind the
user of changes in the analysis, e.g., a change in the selected
frame interval. To perform an analysis, the user is guided by its
specific analysis wizard to perform several interactions: defining the frame interval, drawing ROIs (e.g., for plaque, lumen,
background, or adventitia), and assigning meaning to each ROI,
placing a marker for tracking of plaque (motion compensation),
and running the analysis.

335

time average of plaque intensity (PMI: plaque mean intensity),
the ratio of PMI and average lumen intensity (PLER: plaque to
lumen enhancement ratio), and time average of the percentage
of plaque filled with contrast based on average background noise
threshold (MPCP: mean plaque contrast percentage). From the
MIP image, time integrated IPN surface area (MIPNSA) and
IPN to plaque ROI surface area ratio (MIPNSR) based on an
adaptive threshold are derived to estimate IPN degree [10]. The
adaptive threshold is calculated by taking into account background noise and lumen intensity to adjust for attenuation and
gain variations.
To compare our findings, we reproduced the PE parameter
explained in the introduction by using the QLAB ROI quantification tool. First, we redrew the plaque ROIs as similar as
possible to our analysis. Next, a gamma-variate curve was fitted
to the resulting TIC and the PE was obtained. The fit was considered invalid only if the peak occurred at the first or last frame
of the interval.
C. Microvascular Structure Analysis

V. ANALYSIS TOOLS
A. Motion Compensation
Carotid artery walls show considerable motion due to the
arterial pulsation, breathing, and probe motion. For accurate
quantification of IPN, motion compensation is a prerequisite
step. CINQS contains two motion compensation methods for
plaques, speckle tracking (SPT), and multidimensional dynamic
programming (MDP) combined with SPT. Both of them were
validated in vitro and in vivo [11], [12]. In addition to automated
motion compensation, CINQS allows manual indication or correction of tracking points in each frame. This allows users to
correct motion in long image sequences if there is any temporary
disturbance, such as swallowing or out-of-plane motion.
In SPT, the displacement of plaque is assessed by tracking
the positions of small regions of speckle pattern through consecutive frames of an ultrasound image sequence [11]. First, the
user chooses a point on the plaque in a B-Mode image of the
sequence. A small square region around this point containing
the speckle pattern is scanned over a defined search field in each
subsequent image to find the position where they best match.
The similarity of the template to the image, at each point in the
search field, is assessed by calculating their normalized cross
correlation (NCC). The point of highest correlation provides the
new template position for each subsequent image.
In the second motion compensation method, the results of
NCC obtained from as described in SPT for all positions are used
as a 3-D matrix input to MDP. The optimal plaque displacements
in X and Y-directions are obtained as a continuous path with
MDP as described in detail in [12].
B. Perfusion Analysis
In this analysis, a plaque’s perfusion is characterized by analyzing its TIC and maximum intensity projection image (MIP).
First, we draw three ROIs subsequently for the plaque, lumen,
and background. Next, motion compensation is applied to align
the plaque ROI over time. After that, the plaque MIP and TIC are
derived from the contrast images. From the TIC, we calculate the

In this analysis, we examine spatial structure of IPN. First,
the plaque ROI is drawn or chosen from the list of previously
drawn ones. Next, motion compensation is applied. After that
the microvascular structure analysis is performed. The image
sequence is divided into 10-frame groups with 80% overlap.
In the first frame of each 10-frame group, microbubbles within
the plaque ROI are detected by block matching with templates
mimicking contrast spots of several radii. The detected spots are
tracked over time in the 10-frame groups. Next, the tracked spots
are classified into moving contrast spots or stationary artifacts
based on their minimal displacement. In the final step, the paths
detected several times over time are merged. The number of
microvessels (MVN) is calculated as another estimate of IPN
degree [13].
D. Statistical Segmentation of Contrast Spots
In this analysis, intensities within the plaque ROI are classified into background, contrast spot, and artifact [14]. First,
the plaque ROI is manually drawn/selected and motion compensation is applied. Next, components within the plaque ROI
are found from the intensity histogram through an expectationmaximization algorithm [15]. The found components are assigned to four initial classes (i.e., background, contrast spot,
saturation artifact, and an intermediate class). The final classification is assigned after neighborhood operations. Then, spatiotemporal information is used to exclude stationary artifacts. In
a final step, contrast spots in each frame are integrated over time
with a logical-OR operation. Statistical segmentation-based IPN
surface area (SSIPNSA) and IPN to plaque surface area ratio
(SSIPNSR) are calculated as an estimate of IPN degree. Compared with MIP, this method will suppress stationary or saturation artifacts and will be less sensitive to artifacts nearby or
within the plaque ROI (see Fig. 5).
E. Grayscale-Median Analysis
GSM analysis of B-mode images was adopted from [16].
Plaque echogenicity is measured after grayscale normalization.

336

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

Fig. 5. Plaque ROI including artifacts. (a) Maximum intensity projection of
130 frames (6.5 s) with adaptive threshold. (b) Time integrated classes of statistical segmentation (blue = background, yellow = contrast spot class, cyan =
intermediate class, red = artifacts).
TABLE I
PERFORMANCE OF CINQS

Fig. 6. (a) Association of MIPNSA score and SSIPNSA with Visual IPN
scoring groups (n = 45) (p < 0.001). (b) Receiver operating characteristic
curve for the best two parameters. Blue asterisk shows the OPT for MIPINSA
(91% Sensitivity, 80% Specificity). Red asterisk shows the OPT for SSIPNSA
(82% Sensitivity, 83% Specificity).

sess the reproducibility of IPN parameters. We only analyzed
variability in the image analysis, caused by user interactions
(e.g., drawing ROIs). The study protocol was approved by the
ethical committee at Erasmus Medical Center and all study participants provided informed consent.
For a selected image in the sequence, three ROIs are drawn for
plaque, lumen, and adventitia. The image grayscale values are
normalized to the median values of blood and adventitia. After
normalization, the median grayscale value for the plaque ROI is
determined to estimate plaque echogenicity.
VI. VALIDATION OF OUTPUTS AND PERFORMANCE
EVALUATION
Numerical and graphical outputs of CINQS were validated
with synthetic image sequences with known gray values for each
pixel. The synthetic image sequences and some motion patterns
were generated by using MATLAB. The output results of the
CINQS were validated against the precalculated numerical results for these synthetic sequences.
All analyses were performed on a computer with Intel(R)
Core(TM) 2 Duo CPU (E8600 at 3.3 GHz) and 8 GB memory.
The performance of CINQS was evaluated based on these computer features and an image sequence of 400 frames (see Table I).
VII. STATISTICAL ANALYSIS
Recently, 45 plaques of 23 symptomatic patients were analyzed with CINQS [10]. In that study, the derived IPN parameters were compared to the consensus visual score of two
experienced physicians (at least 2 years of experience in carotid
CEUS analysis) based on a three-point scale (0: no IPN, 1:
mild/moderate IPN, 2: severe IPN). Spearman rank correlation
was used for testing the correlation between the visual IPN
score and an automated score derived from individual parameters. The Kruskal–Wallis test was used to compare the output
of individual parameters to the visual scoring groups. Receiver
operator characteristic (ROC) curve and c-statistic (area under
the curve (AUC)) were provided for the two best parameters
after dividing our data into no/weak-neovascularization (score
0 and 1) and robust neovascularization (score 2). The optimal
operating point (OPT) was obtained by finding the point on the
ROC curve with the smallest Euclidian distance to the optimum
(100% specificity and sensitivity). The intraobserver (n = 45
plaques) and interobserver (n = 15 plaques) variability were
measured using intraclass correlation coefficients (ICC) to as-

VIII. RESULTS
A. Application
Several parameters showed a good correlation with the visual score (correlations (r): MIPNSA r = 0.719, MIPSNSR
r = 0.538, MVN r = 0.484, all p < 0.05). Other parameters
showed nonsignificant correlations with the visual score (correlations: PMI r = 0.227, PLER r = 0.356, MPCP r = 0.151, all
p > 0.05). The PE parameter reported in previous studies [6], [7]
also showed nonsignificant correlation with the visual IPN score
in our dataset (r = 0.105). The MIPNSA was able to provide
a distinction between the different visual IPN scoring groups
(p < 0.05) [see Fig. 6(a)]. The PMI, PLER, and MPCP parameters were not able to provide a clear distinction between the
visual scoring groups [10]. In addition to the parameters and
results presented in [10], we included here two more parameters: SSIPNSA and SSIPNSR, from the statistical segmentation analysis of contrast spots. These two parameters showed a
good correlation with the visual score (correlations: SSIPNSA
r = 0.698, SSIPNSR r = 0.527, both p < 0.05). The SSIPNSA
was also able to provide a clear distinction between the different
visual scoring groups (p < 0.05) [see Fig. 6(a)]. As seen in ROC
curve [see Fig. 6(b)], AUC for MIPNSA and SSIPNSA are 0.93
and 0.92, respectively. Their performance is almost the same.
We selected eight plaques which had saturation artifacts
nearby or within the plaque ROI to verify if SSIPNSA improved
the suppression of artifacts. We analyzed them twice, with saturation artifacts included and excluded from the ROI. SSIPNSA
was 3.9 ± 3.2 mm2 (mean ± standard deviation) for artifacts
included and 3.8 ± 3.2 mm2 for artifacts excluded. MIPNSA
was 9 ± 3.3 mm2 for artifacts included and 3.2 ± 2.9 mm2 for
artifacts excluded.
Mean difference and standard deviation in calculation of MIPNSA with and without motion compensation was 0.34 ± 0.88
(mm2 ) for 45 plaques (see Fig. 7). The mean and standard deviation of MIPNSA with motion compensation for the dataset was
3.49 ± 3.44 (mm2 ). In the absence of motion compensation, the
found IPN surface area was considerably increased or decreased
(>50% for some cases) due to the lumen or artifact infiltration
(see Fig. 7).

AKKUS et al.: CAROTID INTRAPLAQUE NEOVASCULARIZATION QUANTIFICATION SOFTWARE (CINQS)

Fig. 7. Difference of MIPNSA with and without motion compensation (MC)
compared to MIPNSA with MC (units are mm2 ).

Fig. 8. CINQS GUI-file I/O part. A: User info. B: DICOM load panel.
C: Object list load panel. D: Analysis list load panel. E: Preview panel.

The intraobserver and interobserver variability for each parameter were presented in our previous study [10]. Intraobserver
and interobserver variability for parameters were low. The results showed good agreement in intraobserver (intraclass correlation (ICC) range: 0.84–0.98) and interobserver (ICC range:
0.68–0.96) for all parameters. The parameters which gave the
best distinction between visual scores (MIPNSA and SSIPNSA)
are reproducible with low intra- and interobserver variability
(ICC > 0.95). One parameter (MVN) showed less reproducibility compared to other parameters (ICC = 0.84 for intraobserver,
ICC = 0.68 for interobserver).
IX. DISCUSSION
CINQS is designed as a special-purpose platform for
IPN quantification tools for carotid plaques. CINQS replaces
subjective, qualitative, and tedious visual assessment with
reproducible quantitative IPN parameters. It allows selection
of suitable parameters for measuring the degree of IPN by
enabling comparison of existing and new IPN parameters with
a reference (e.g., visual IPN scoring or histology). The presented analysis tools overcome the limitations of the reported
IPN quantification approaches [6], [7], [9] and current contrast
quantification tools. CINQS could also be used to check changes

337

Fig. 9. CINQS GUI-analysis part. A: analysis tools panel structured as a
wizard. B: Object list panel. C: Saving object or analysis. D: Export results.
E: Viewer panel. F: Graph panel. G: Analysis tree panel. H: Parameter output
panel. I: Graph settings.

in neovascularization over time, and to check the outcome of
novel therapies on neovascularization.
The parameters are reproducible with low intraobserver and
interobserver variability for user-dependent selections. The image acquisition and bolus injection are standardized in our
study [10]. Small variations in this will cause variability in the
resulting IPN parameters, but it is beyond the scope of this study
to investigate this. For very different image acquisition or bolus
injections, the parameters of the IPN quantification algorithms
should be reoptimized. These issues could be investigated in
further studies.
The software can be run on Windows-compatible computers,
from a simple desktop pc up to a sophisticated high-end workstation. CINQS was developed in a modular and extensible way
and provides a user-friendly tool for analyzing carotid IPN in
CEUS. Using CINQS is quite easy because of its wizard-like
design for analysis tools and it requires no specialized knowledge apart from carotid ultrasound image knowledge. To the
best of our knowledge, this is the only dedicated software for
carotid IPN analysis so far.
The modularity and extensibility of CINQS is based on the
modular development framework in MevisLab. MevisLab allows easy integration of external algorithms (e.g., C++ or MATLAB code) into a module that can be simply used within the
MevisLab framework. To use the new modules within CINQS,
some lines need to be added to the Python script that controls
the communication between modules and GUI.
As stated before, TICs of plaque are not similar to the typical
TIC curves seen in heart, liver, prostate, or tumor perfusion.
Therefore, typical bolus and replenishment kinetics parameters
for large organs are not applicable to IPN quantification. The
PE parameter derived from the bolus curve models fitted to
TICs of plaques gave the lowest correlation with visual IPN
scores. In addition to TIC, we used MIP perfusion parameters
(MIPNSA, MIPNSR) which estimate vascularization of plaque
better than those of TIC.
The motion compensation is an important step in the calculation of MIPNSA of 45 plaques (see Fig. 7). Leaving out
the motion compensation caused on average 10% increase of

338

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 1, JANUARY 2015

MIPNSA. This increase of MIPNSA is mainly caused by contrast from lumen or saturation artifacts that infiltrate the plaque
ROI. As seen in Fig. 7, there are also some cases where MIPNSA is decreased. This is caused by some contrast spots that
move out of the plaque ROI when no motion compensation is
applied. Motion compensation will be especially crucial in case
of small plaques, plaques surrounded with saturation artifacts,
and adjacency of contrast from the jugular vein to the plaque.
Vavuranakis et al. [17] reported that enhancements in CEUS
do not always reflect neovascularization. If there are artifacts
within the atherosclerotic plaque ROI, SSIPNSA will suppress
artifacts and give more reliable results than MIPNSA. SSIPNSA
(3.9 ± 3.2 mm2 with artifact versus 3.8 ± 3.2 mm2 without artifact) gave slightly higher areas but proved to be almost insensitive to artifacts while MIPNSA was sensitive to artifacts (9 ±
3.3 mm2 with artifacts versus 3.2 ± 2.9 mm2 without artifacts).
CINQS was structured for systematic analysis of carotid IPN
but its structure may also be useful for microvasculature ROI
analysis of other organs such as liver, prostate, and myocardium.
Especially, CINQS may be useful for other small and relatively
poorly perfused structures that are subject to motion. Many tools
of CINQS can easily be adopted for analysis of other organs.
This will help to extend CINQS for other projects.
The use of consensus visual IPN scoring as the ground truth
for quantitative IPN parameters is a limitation. Future studies on
larger numbers of plaques including histological validation and
possibly long-term patient follow up are necessary to confirm
the present findings. Furthermore, dynamic contrast enhanced
MRI of plaques could also be used for comparison to the present
findings. However, this was beyond the scope of this study.
CINQS is limited by the required computation time for running the IPN analysis algorithms. IPN analysis algorithms were
written in MATLAB and the code was not optimized for speed.
Computation time would decrease if IPN analysis algorithms
were written in C or C++. Still, current computation time is satisfactory for clinical applications in datasets of a few hundred patients. For very large patient populations (thousands of patients),
speed optimization and integration of CINQS to PACS (Picture
Archiving and Communication System) would be desired.
X. CONCLUSION
We have developed and presented a software package,
CINQS, for systematic analysis of IPN in CEUS images of
carotid plaques. It is well structured, user-friendly, and requires
minimal user intervention. It enables systematic testing and
comparing different IPN analysis tools, and selecting the best
parameters for measuring the degree of IPN. This represents
an important step toward prediction of plaque vulnerability. As
it has a modular design, it is easily extendable with new IPN
analyses. It overcomes the limitations of current available contrast quantification tools for IPN quantification. MIPNSA and
SSIPNSA showed excellent agreement with visual IPN scores
for dichotomized data (no/weak IPN versus robust IPN).

[2] S. Coli, M. Magnoni, G. Sangiorgi, M. M. Marrocco-Trischitta,
G. Melisurgo, A. Mauriello, L. Spagnoli, R. Chiesa, D. Cianflone, and
A. Maseri, “Contrast-Enhanced ultrasound imaging of intraplaque neovascularization in carotid arteries correlation with histology and plaque
echogenicity,” J. Am. College Cardiology, vol. 52, pp. 223–230, 2008.
[3] D. Staub, M. B. Patel, A. Tibrewala, D. Ludden, M. Johnson, P. Espinosa,
B. Coll, K. A. Jaeger, and F. B. Feinstein, “Vasa vasorum and plaque
neovascularization on contrast-enhanced carotid ultrasound imaging correlates with cardiovascular disease and past cardiovascular events,” Stroke,
vol. 41, pp. 41–47, 2010.
[4] H. K. Thompson, C. F. Starmer, R. E. Whalen, and H. D. Mcintosh, “Indicator transit time considered as a gamma variate,” Circulation Res.,
vol. 14, pp. 502–515, 1964.
[5] M. P. J. Kuenen, M. Mischi, and H. Wijkstra, “Contrast-Ultrasound diffusion imaging for localization of prostate cancer,” IEEE Trans. Med. Imag.,
vol. 30, no. 8, pp. 1493–1502, Aug. 2011.
[6] P. T. Huang, F. G. Huang, C. P. Zou, H. Y. Sun, X. Q. Tian, Y. Yang,
J. F. Tang, P. L. Yang, and X. T. Wang, “Contrast-enhanced sonographic
characteristics of neovascularization in carotid atherosclerotic plaques,”
J. Clin. Ultrasound, vol. 36, pp. 346–351, 2008.
[7] L. Xiong, Y. B. Deng, Y. Zhu, Y. N. Liu, and X. J. Bi, “Correlation of
carotid plaque neovascularization detected by using contrast-enhanced us
with clinical symptoms,” Radiology, vol. 251, pp. 583–589, 2009.
[8] A. Hoogi, D. Adam, A. Hoffman, H. Kerner, S. Reisner, and D. Gaitini,
“Carotid plaque vulnerability: quantification of neovascularization on
contrast-enhanced ultrasound with histopathologic correlation,” Am. J.
Roentgenology, vol. 196, pp. 431–436, 2011.
[9] G. L. ten Kate, S. C. H. van den Oord, E. J. G. Sijbrands, A. van der Lugt,
N. de Jong, J. G. Bosch, A. F. W. van der Steen, and A. F. L. Schinkel,
“Current status and future developments of contrast-enhanced ultrasound
of carotid atherosclerosis,” J. Vascular Surg., vol. 57, pp. 539–546, 2013.
[10] Z. Akkus, A. Hoogi, G. Renaud, S. C. H. van den Oord, G. L. ten Kate,
A. F. L. Schinkel, N. de Jong, A. F. W. van der Steen, and J. G. Bosch,
“New quantification methods for carotid intraplaque neovascularization
using contrast enhanced ultrasound,” Ultrasound Med. Biol., vol. 40,
pp. 25–36, 2014.
[11] Z. Akkus, J. G. Bosch, G. Renaud, A. Hoogi, G. L. ten Kate, S. van den
Oord, A. Schinkel, N. De Jong, and A. F. W. Van der Steen, “Motion
compensation method for quantification of neovascularization in carotid
atherosclerotic plaques with contrast enhanced ultrasound (CEUS),” in
Proc. IEEE Int. Ultrasonics Symp., Orlando, FL, USA, 2011, pp. 1156–
1159.
[12] Z. Akkus, A. Hoogi, G. Renaud, G. L. ten Kate, S. C. H. van den Oord,
A. F. L. Schinkel, N. de Jong, A. F. W. van der Steen, and J. G. Bosch,
“Motion compensation method using dynamic programming for quantification of neovascularization in carotid atherosclerotic plaques with
contrast enhanced ultrasound (CEUS),” in Proc. SPIE, 2012, vol. 8320,
p. 83200C.
[13] A. Hoogi, Z. Akkus, S. C. H. van den Oord, G. L. ten Kate,
A. F. L. Schinkel, J. G. Bosch, N. de Jong, D. Adam, and A. F. W. van
der Steen, “Quantitative analysis of ultrasound contrast flow behavior in
carotid plaque neovasculature,” Ultrasound Med. Biol., vol. 38, pp. 2072–
2083, 2012.
[14] Z. Akkus, G. Vegas-Sánchez-Ferrero, D. D. B. Carvalho, G. Renaud,
S. C. H. van den Oord, G. L. ten Kate, A. F. L. Schinkel, N. de Jong,
A. F. W. van der Steen, and J. G. Bosch, “Statistical segmentation of
carotid plaque neovascularization,” Proc. SPIE, vol. 8675, p. 867506,
2013.
[15] A. T. F. Mario and K. J. Anil, “Unsupervised learning of finite mixture
models,” IEEE Trans. Pattern Anal. Mach. Intell., vol. 24, no. 3, pp. 381–
396, Mar. 2002.
[16] M. M. Sabetai, T. J. Tegos, A. N. Nicolaides, S. Dhanjil, G. J. Pare,
and J. M. Stevens, “Reproducibility of computer-quantified carotid
plaque echogenicity-Can we overcome the subjectivity?” Stroke, vol. 31,
pp. 2189–2196, 2000.
[17] M. Vavuranakis, F. Sigala, D. A. Vrachatis, T. G. Papaioannou,
K. Filis, N. Kavantzas, K. I. Kalogeras, C. Massoura, L. Toufektzian,
M. G. Kariori, I. Vlasseros, I. Kallikazaros, and C. Stefanadis, “Quantitative analysis of carotid plaque vasa vasorum by CEUS and correlation
with histology after endarterectomy,” Vasa, vol. 42, pp. 184–195, 2013.

REFERENCES
[1] W. E. Hellings, W. Peeters, F. L. Moll, S. R. D Piers, J. van Setten, P. J. Van
der Spek, J. P. P. M de Vries, K. A. Seldenrijk, P. C. De Bruin, A. Vink,
E. Velema, D. P. V. de Kleijn, and G. Pasterkamp, “Composition of carotid
atherosclerotic plaque is associated with cardiovascular outcome: A prognostic study,” Circulation, vol. 121, pp. 1941–1950, 2010.

Authors’ photographs and biographies not available at the time of publication.

