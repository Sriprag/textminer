IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

2499

Effects of Tracer Arrival Time on the Accuracy
of High-Resolution (Voxel-Wise) Myocardial
Perfusion Maps from Contrast-Enhanced
First-Pass Perfusion Magnetic Resonance
Niloufar Zarinabad∗ , Gilion L. T. F. Hautvast, Eva Sammut, Aruna Arujuna, Marcel Breeuwer, Eike Nagel,
and Amedeo Chiribiri

Abstract—First-pass perfusion cardiac magnetic resonance
(CMR) allows the quantitative assessment of myocardial blood flow
(MBF). However, flow estimates are sensitive to the delay between
the arterial and myocardial tissue tracer arrival time (tO n se t ) and
the accurate estimation of MBF relies on the precise identification of tO n se t . The aim of this study is to assess the sensitivity of
the quantification process to tO n se t at voxel level. Perfusion data
were obtained from series of simulated data, a hardware perfusion phantom, and patients. Fermi deconvolution has been used
for analysis. A novel algorithm, based on sequential deconvolution,
which minimizes the error between myocardial curves and fitted
curves obtained after deconvolution, has been used to identify the
optimal tO n se t for each region. Voxel-wise analysis showed to be
more sensitive to tO n se t compared to segmental analysis. The automated detection of the tO n se t allowed a net improvement of the
accuracy of MBF quantification and in patients the identification
of perfusion abnormalities in territories that were missed when a
constant user-selected tO n se t was used. Our results indicate that
high-resolution MBF quantification should be performed with optimized tO n se t values at voxel level.
Index Terms—Myocardial perfusion quantification, tracer
arrival time delay, voxel-wise.

Manuscript received November 18, 2013; revised April 29, 2014, March 13,
2014, and January 29, 2014; accepted December 17, 2013. Date of publication
May 9, 2014; date of current version August 18, 2014. The work of the Medical
Engineering Centre was funded by the Wellcome Trust and EPSRC under Grant
WT 088641/Z/09/Z. This work was supported by the Department of Health via
the National Institute for Health Research (NIHR) comprehensive Biomedical
Research Centre award to Guy’s and St Thomas’ NHS Foundation Trust in
partnership with King’s College London. The work of E. Nagel was supported
by Philips Healthcare and Bayer Schering Healthcare. The work of A. Chiribiri
was supported by Philips Healthcare. Asterisk indicates corresponding author.
∗ N. Zarinabad is with the Division of Imaging Sciences and Biomedical Engineering, The Rayne Institute, St. Thomas’ Hospital, London, SE1 7EH, U.K.
(e-mail: niloufar.zarinabad@kcl.ac.uk).
G. L. T. F. Hautvast is with the Philips Group Innovation–Healthcare Incubators, Philips Research High Tech Campus 34 5656 AE Eindhoven, The
Netherlands (e-mail: Gilion.Hautvast@Philips.Com).
E. Sammut, A. Arujuna, E. Nagel, and A. Chiribiri are with the Division
of Imaging Sciences and Biomedical Engineering, The Rayne Institute, St.
Thomas’ Hospital, London, SE1 7EH, U.K. (e-mail: eva.sammut@kcl.ac.uk;
aruna.arujuna@kcl.ac.uk; eike.nagel@kcl.ac.uk; amedeo.chiribiri@kcl.ac.uk).
M. Breeuwer is with the Philips Healthcare, Imaging Systems–MR 5680, DA
Best, The Netherlands and is also with the Biomedical Engineering, Biomedical
Image Analysis, Eindhoven University of Technology, PO Box 513 - NL-5600
MB Eindhoven, The Netherlands (e-mail: marcel.breeuwer@philips.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org
Digital Object Identifier 10.1109/TBME.2014.2322937

I. INTRODUCTION
IRST-PASS perfusion cardiac magnetic resonance (CMR)
allows the noninvasive and radiation-free assessment of
myocardial blood flow (MBF) and enables a far better spatial
resolution than nuclear medicine techniques [1]. Recently, the
feasibility of quantitative voxel-wise analysis has been demonstrated by us and by others using a hardware perfusion phantom
and microspheres in dogs, respectively [2], [3].
Voxel-wise quantification has the potential to combine the advantages of visual analysis with the objective and reproducible
evaluation made possible by true quantitative assessment. However, before voxel-wise quantification becomes a robust clinical
tool, there are several technical challenges to overcome. Voxelwise quantitative analysis involves lower signal-to-noise ratio
(SNR) levels, which affect the accuracy of the MBF estimation
[3].
Another source of error is the sensitivity of quantification
methods such as Fermi function modeling to the delay between tracer arrival time into the arterial input and the tissue
(tAIF and tOnset , respectively) and subsequently the data interval used for quantification [4]. Previously demonstrated for
segmental analysis, this issue is likely to be even more important on a voxel-wise analysis due to the reduced SNR, which
makes the selection of the real tOnset for each voxel even more
difficult, and to significant variations of tOnset among different
voxels within the same or different segments due to anatomical
and physiological factors. Therefore, an optimization of these
analysis parameters could potentially improve the accuracy of
voxel-wise quantification. However, the individual optimization
of tOnset for each voxel can be time consuming and warrants an
automated method.
In the present study, we aimed to explore the latter issue
systematically. In particular, we sought to demonstrate the importance of tOnset on voxel-wise MBF analysis and to propose a
method for voxel-wise tOnset optimization. A preliminary version of this study has been reported [5], [6]

F

II. THEORY
Prevalent available quantitative techniques for estimating
MBF use the central volume principle and deconvolve the tissue
signal during the first pass of a bolus of contrast agent with the
arterial input function sampled from the LV or aorta. According

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2500

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

to the central volume principle the concentration of the contrast
agent in the tissue region Ctiss (t) is related to the concentration of the contrast agent in the arterial input Caif (t) via the
following convolution problem [7]:
Ctiss (t) = Caif (t) ⊗ h(t)

(1)

where h(t) is the unknown tissue impulse response. Equation (1)
needs to be deconvolved to estimate h(t) and, therefore, quantify
the MBF according to h(t = 0).
The intensity values after arrival of the contrast agent into the
blood pool and tissue will be used for quantification.
Assuming that the tissue residual curve Ctiss (t) has been
delayed by trel dynamics respective to Caif (t), then (1) would
be rewritten as
∗
Ctiss
(t) = Ctiss (t − trel ) = Caif (t) ⊗ h∗ (t)

(2)

where trel (relative tOnset ) accounts for the delay time between the appearance of the signal in the LV blood pool and
myocardial region of interest (ROI) (trel = tOnset − tAIF ).
This implies that the delayed tissue residue curve can be
represented as convolution of the arterial input curve and a new
impulse response (h∗ (t)), which is not equal to h(t) and results
in a wrong estimation of MBF. If we line up the points in which
the onset of contrast agent occurs in the left ventricular blood
pool (tAIF ) and tissue (tOnset ), this delay will disappear and
trel = 0.
One of the most favorable and used deconvolution techniques
is Fermi function modeling. Jerosch-Herold et al. [8] and Wilke
et al. [9] fitted time curves for the tissue impulse response function h(t) to the Fermi function with the following analytical
expression:


1
(3)
u(t − trel )
h(t) = R (
e t − τ0 − trel )k + 1
using a Marquardt–Levenberg nonlinear least-square algorithm
by letting k, R, and τ0 vary and keeping trel fixed. In (3), u(t −
trel ) is the unit step function; τ0 characterizes the width of the
shoulder of the Fermi function during which little or no contrast
agent has left the ROI; R is the index of contrast agent influx
parameter; and k represents the decay rate of h(t) due to contrast
agent wash out.
Previous studies [10], [11] have fitted the h(t) to Fermi model,
keeping trel as a free global parameter and showed favorable
results. However, Jerosch-Herold et al. [4] demonstrated sensitivity of Fermi to onset time of the curves at segmental level. At
voxel level (i.e., high resolution), this sensitivity will be even
higher due to low contrast-to-noise ratio (CNR) of the data and
the significant variations of tOnset among different voxels. These
factors might result in quantification errors at high resolution if
not addressed correctly. It is therefore vital to evaluate the effects
of using individual voxel’s onset time and appropriate interval
of the data for high-resolution quantification.
Here, we developed an algorithm for the detection of individual voxel’s tOnset . The algorithm performs a sequential deconvolution to determine the dynamic with the smallest curve fit
error (optimized tOnset ).

The sequential deconvolution algorithm begins by using a starting tOnset equal to tAIF + 1dynamic. At each
stage of the process, the residual curve fit error (i.e., x =
Ctiss (t) − Caif (t) ∗ h(t)) for the obtained h(t) is calculated.
This process continues by incrementing the tOnset by one dynamic, and it stops when the current dynamic residual error is
greater than the 10 preceding dynamics. The dynamic with the
smallest residual curve fit error is considered as the optimized
tOnset . Ctiss (t) and Caif (t) will be aligned in time based on the
optimized tOnset , and it will be used for quantitative analysis.
III. METHODS
In the first set of experiments, we used synthetic data to
demonstrate the sensitivity of deconvolution and MBF estimation to the delay time between tAIF and tOnset .
Then we tested the accuracy of the tOnset detection algorithm
and validated it against gold standard perfusion measurements
using an MR-compatible perfusion phantom.
In both experiments, we evaluated the impact of CNR on the
detection of the onset arrival time and, thus, on the accuracy
of perfusion estimates. For this purpose, the original data were
corrupted by adding Rician noise of variable amplitudes to both
Caif (t) and Ctiss (t) [12], [13]. The range of noise amplitude
was chosen so that CNR in the both Caif (t) and Ctiss (t) would
be between 5 and 40. Equal noise amplitudes were added to
both Caif (t) and Ctiss (t) at each CNR level.
Finally, we compared the results of voxel-wise and segmental analysis performed with optimized tOnset with the results
obtained from considering tOnset a free global parameter in
phantom and in vivo.
All the analyses described in this study were performed using
house-made software programmed with MATLAB (Mathworks,
Natick, MA, USA, version R2010b). All data (phantom and
patient) were acquired on a Philips Achieva 3T (TX) system,
equipped with a 32-channel cardiac-phased array receiver coil
(Philips Healthcare, Best, The Netherlands).
A. Simulated Data
Simulated data with known perfusion values [MBFGS =
1 to 5mL/(g · min)] have been generated using published
methods [3].
For this propose, series of noiseless gold standard tissue impulse responses hGS (t) were constructed by using the following
pharmacokinetic model, described by Lindsey et al. [14]:
hGS (t) =

eλ1 t − eλ2 t
eλ1 t − eλ3 t
u(t) −
u(t)
λ1 − λ2
λ1 − λ3

(4)

where u(t) is the unit step function. The physiological parameters, i.e., λ1 , λ2 , and λ3 were chosen to generate tissue responses
of the same order as those obtained by the fitting of real series
of DCE-CMR acquisitions [3].
Caif (t) used in this experiment is a convolution of many
exponentials as suggested in [15] to model the propagation of
an impulsive bolus injection through several compartments of

ZARINABAD et al.: EFFECTS OF TRACER ARRIVAL TIME ON THE ACCURACY OF HIGH-RESOLUTION

the cardiovascular system
 




Caif (t) = δ(t) ∗ ve−v t 1 ∗ ve−v t 2 ∗ · · · ∗ ve−v t n . (5)
For simplicity, we assumed the same mean transit time
(1/v > 0) and, thus, the same compartment kernel ve−v t for
all compartments. Initial Ctiss (t) was then obtained by convolving hGS (t) with the simulated Caif (t) [15].
Subsequently, Rician noise of different amplitudes (CNR =
5 to 30) was added to the data and sensitivity of the Fermi
quantification method to the arrival time at different noise and
flow rates was tested. The results of Fermi deconvolution with
tOnset were compared with the outcome of quantification when
τd is assumed to be free global parameter.
Moreover, simulated data were used to quantitatively evaluate
the error in optimized tOnset estimation and efficiency of the automated tOnset detection algorithm. For this purpose, the actual
trel was kept fixed as 3 dynamics and the tOnset relative error
(rtrel ) in synthetic data for the CNR levels of 5, 10, 20, and 30
and perfusion rates of 1, 2.5, and 5 mL/(g·min) was calculated
as
rtrel =

|estimated trel − actual trel |
.
actual trel

(6)

At each flow rate and CNR level, an absolute error of (ea )
was calculated as
ea = |MBF − MBFGS |

(7)

where MBFGS is the gold standard perfusion value. The absolute error of the perfusion estimates at different flow and CNR
levels was used to demonstrate the importance of time delay.
For the phantom and human data, the residual curve fit error
is calculated as
x = Ctiss (t) − Caif (t) ∗ h (t) .

(8)

B. Hardware Perfusion Phantom
The second experiment was performed on validated perfusion
phantom data [3], [16], [17]. The perfusion phantom allows an
efficient and reproducible simulation of myocardial perfusion
acquisition, providing validated data suitable for quantification.
Unlike the noiseless synthetic data, the phantom datasets are acquired using the same hardware, software, and similar sequence
to those used in patients [17]. The perfusion phantom data were
used to validate the sequential deconvolution algorithm at different levels of CNR and perfusion rate.
For this purpose, Rician noise of different amplitudes
(CNR = 10 to 40) was added to the data. Sensitivity of the
Fermi to tOnset and its accuracy at various flow rates [MBFGS
= 1, 2.5, and 5 mL/(g·min)] under different CNR levels was
tested. The results were compared with the outcome of quantification when τd is assumed to be a free global parameter.
Phantom data were acquired in one slice in a transverse geometry, visualizing the progression of the bolus of contrast agent in
the large thoracic vessels and the myocardial compartments in
the same image, with a saturation recovery gradient echo method
(typical parameters: repetition time/echo time 3.0 ms/1.0 ms, flip
angle 15°; effective k–t SENSE acceleration 3.8-fold, spatial res-

2501

olution 1.2 × 1.2 × 10 mm, saturation delay 120 ms, matrix size
132 × 132, bandwidth 2.137 Hz, FOV 24 × 24 cm2 ) [18]–[20].
To avoid any confounding effects due to signal saturation,
a universal dual-bolus injection scheme was performed in the
perfusion phantom [21], similar to clinical data. In the phantom
experiments, we used a dosage of Gadolinium of 0.001 mEq/kg
of body weight as a prebolus and 0.01 mEq/kg of body weight
as bolus (Gadobutrol Gadovist, Bayer Schering, Germany) [17].
The boluses were injected at 4 mL/s followed by a 20 mL saline
flush. Here, the search for the inflection point in Ctiss (t) starts
from the dynamic in which the main bolus of contrast agent
appears in the aorta of the phantom.
C. Clinical MR Data
The feasibility of automated tOnset detection algorithm and a
comparison with using free global parameter for deconvolution
were performed in a small group of healthy volunteers (n = 5)
and patients (n = 5) with anginal symptoms and definite coronary artery disease on invasive coronary angiography. These
patients were scanned using a clinical adenosine-stress perfusion protocol (140 μg/(kg·min) of adenosine for at least 3 min
before the acquisition of the images). The study was performed
at Guy’s and St Thomas’ Hospital London (U.K.). The institutional review board approved the study, and all subjects signed
an informed consent to be included.
Patient’s perfusion data were acquired in three slices (apical, mid-cavity, and basal) in short-axis geometry with similar methods to the perfusion phantom experiment. Typical
parameters for the saturation-recovery gradient echo method
were: repetition time/echo time 3.0 ms/1.0 ms; flip angle 15°;
effective k--t SENSE acceleration 3.8-fold; spatial resolution
1.2 mm × 1.2 mm × 10 mm; saturation delay 120 ms; matrix
size 251 × 251; bandwidth 724 Hz; FOV 31 × 31 cm2 [18]–
[20].
Similarly to phantom experiments, a universal dual-bolus
injection scheme was performed [21]. We used a dosage of
Gadolinium of 0.0075 mEq/kg of body weight as a prebolus and
0.075 mEq/kg of body weight as bolus (Gadobutrol Gadovist).
The boluses were injected at 4 mL/s followed by a 20 mL saline
flush.
D. MR Image Processing
Accurate voxel-based MBF estimation requires respiratory
motion correction and myocardial contour delineation. We developed an automated approach based on published methods
[22], [23], in which respiratory motion was removed using
affine image registration by maximization of the joint correlation between consecutive dynamics within an automatically
determined region of interest. Then, a temporal maximum intensity projection was calculated to serve as a feature image for an
automatic contour delineation method based on active contour
models [22]–[25]. Signal intensities were then sampled using
bilinear interpolation at a grid of 60 angular positions and 10
transmural positions (or layers). The transmural positions were
located on chords perpendicular to the myocardial centerline
[24], [26]. To maximize reproducibility of MBF quantification,

2502

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

Fig. 1. Box plot representing the relative error (r) in estimation of MBF using
Fermi method when τ d has been kept as a free global parameter (Green/Dashed
box) and when optimized tO n se t has been used at different flow rates (Blue/Solid
box). At each flow rate the range of CNR varies from 5 to 30. Sensitivity of the
quantification methods has decreased as the flow rates increased.

care was taken to obtain Caif (t) in a robust and reproducible
way. Caif (t) was obtained by sampling the trimmed median
intensity within a region of interest in the blood pool of the
basal slice. To be robust against the presence of papillary muscles, the region of interest was obtained by downscaling the
endocardium contours. Furthermore, the trimmed median operator ignores 15% of outlier samples [25].
Prior to deconvolution analysis, baseline correction that includes scaling of the signal intensities proportional to coil sensitivity and correcting for an offset to shift the baseline signal
to zero has been performed. The constrained least-square problems were solved using lsqnonlin in MATLAB [15], [27]. The
perfusion estimates were computed by deconvolving the measured blood and tissue enhancement data during the first pass of
contrast agent in myocardium.
Absolute error (ea ) has been used to compare the outcome of
the quantification in synthetic and phantom data where a standard reference was available. Analysis of variance (ANOVA)
has been used in patients and phantom to compare the results of
using optimized tOnset for quantification with assuming τd as a
free global parameter.
IV. RESULTS
A. Simulated Data
The box plots in Fig. 1 represent the relative error(r =
ea /MBFGS ) in estimation of MBF at different perfusion rates
over a range of CNR level (CNR = 5 − −30). This figure
compares the accuracy and performance of Fermi with onset
(MBFonset ) and Fermi model with τd as a free global parameter
(MBFfree ) and examines their robustness to CNR level. Both of
the quantification approaches (i.e., Fermi with onset and Fermi
with τd as a free global parameter) showed to be more sensitive
to CNR level of the data at low flow rates. This sensitivity to
noise is higher when τd has been kept as a free global parameter.

Fig. 2. Surface plot representing the difference between estimated ro n se t and
rfre e (|ea fre e − ea onset| /MBF G S ) overflow rate of 1–5 mL/(g·min) and
CNR level of 5–30 for simulated data.

Fig. 3. Error bars representing the relative error in estimation of optimized
tO n se t (rt r e l ) in synthetic data for different levels of CNR and perfusion rates.
Actual tre l here is equal to 3 dynamics.

In Fig. 2, differences between relative error ronset and
rfree (|eafree − eaonset | /MBFGS = rfree − ronset ) at different
noise (CNR levels ranging from 5 to 30) and perfusion rates
[MBF ranging from 1 to 5 mL/(g·min)] is shown in a surface
plot.
Fig. 3 represents the relative error in estimation of optimized
tOnset (rtrel ) for the CNR levels of 5, 10, 20, and 30 and perfusion
rates of 1, 2.5, and 5 mL/(g·min). The automated tOnset detection
algorithm showed to be sensitive to CNR level and perfusion
rate. Best match to the actual onset of the data was achieved at
CNR = 30 for all flow rates.
B. Hardware Perfusion Phantom
In order to validate the tOnset detection algorithm in the perfusion phantom with MBFGS = 5 mL/(g·min), the estimated
MBF with its corresponding curve fit error at each step of the

ZARINABAD et al.: EFFECTS OF TRACER ARRIVAL TIME ON THE ACCURACY OF HIGH-RESOLUTION

Fig. 4. Estimated MBF (blue circles) with its corresponding curve fit error
(red triangles) for a random voxel in perfusion phantom with MBF G S =
5 mL/(g·min). The horizontal axis shows the shift of the starting tO n se t . The
dynamic that gives the smallest curve fit error corresponds to the smallest
absolute error. Here, tre l is equal to timeshift + 1 as the sequential process
starts form tA IF + 1 (tre l = timeshift + 1). These results demonstrate that
the sequential deconvolution algorithm can be used to detect the optimized
tO n se t .

Fig. 5. Scatter box plot representing the estimated voxel-wise MBF values
in the phantom [average MBF G S = 5 mL/(g·min)], comparing the results
obtained using an optimized tO n se t with keeping τ d as a free global parameter.
Each individual green dot shows the estimated MBF at each voxel, and they have
been spread for visualization reasons and clarity. On each blue box, the central
red mark is the median; the edges of the box are the 25th and 75th percentiles.
The CNR of the phantom data at voxel-wise analysis was equal to 19 ± 3.8.

sequential deconvolution in a random voxel has been calculated
and shown in Fig. 4. The deconvolution process has begun from
the starting tOnset (tAIF + 1) and it has been repeated for 10
consecutive dynamics.
The dynamic with the smallest curve fit error corresponded
to the smallest absolute error (ea /x = 0.4/0.15). This dynamic
was the optimal tOnset selected by the automatic tOnset detection
algorithm. Here, a small shift from the optimized tOnset resulted
in a significant error in estimated MBF value demonstrating
sensitivity of the deconvolution algorithm into tOnset .
Fig. 5 is a scatter box plot of the estimated MBF values in the phantom with MBFGS = 5 mL/(g · min), comparing MBFonset for voxel-wise quantification (low CNR) with
MBFfree . A significant difference between the MBFfree and
MBFonset for voxel-wise analysis was seen (P-values = 1.3E–
98).

2503

Fig. 6. Error bar plot representing the mean ± SD of MBF relative error
ro n se t (solid line/blue) and rfre e (dashed line/back), under different CNR (a)
and flow rates (b). Data in (a) are average over all flow rates (i.e. 1,2.5, and
5 mL/gr/min) at each CNR level and in (b) are averaged over all CNR levels
(10, 20, 30, and 40) for each flow rates. At all flow and CNR levels Fermi with
optimized tO n se t performed favorably compared to Fermi with τ d as a free
global parameter. The difference between the two approaches is more apparent
at CNR levels = 20 and 30 [see Fig. 6(a)] and high flow rates [see Fig. 6(b)].

The error bars in Fig. 6(a) and (b) represent the mean and
standard deviation of the relative error (r) for both MBFonset and
MBFfree in the perfusion phantom at various CNR (10–40) and
flow rates [1, 2.5, and 5 mL/(g·min)], respectively. Here, in both
figures, Fermi with optimized tOnset showed to have less error
and be more accurate at all conditions.
Fig. 6 demonstrates that keeping τd as a free global parameter
for deconvolution yields to a higher relative error compared to
when an optimized tOnset has been used at all CNR levels and
flow rates. This difference is more apparent at low CNR levels
[see Fig. 6(a)] and high flow rates [see Fig. 6(b)].
In Fig. 6(a), a significant difference between the obtained
values using optimized tOnset and with keeping τd as a free
global parameter at low CNR levels (P < 0.05) was observed.
These two approach, however, performed similarly at high CNR
levels (P > 0.05).
At low flow rates [Fig. 6(b)] [i.e., MBF1 mL/(g·min)], there
is not a significant difference between optimized tOnset and
with keeping τd as a free global parameter due to low level of
contrast enhancement, which has impaired the assessment of
tOnset . Similar results were observed for synthetic data at low
flow rates (see Fig. 2).
C. Clinical MR Data
In order to demonstrate the importance of tracer arrival time
detection for myocardial perfusion estimation in clinical MR
data, first we have examined the myocardial segmental analysis
sensitivity to tracer arrival time. Then the tOnset detection algorithm has been applied to voxel-wise analysis and sensitivity of
voxel-wise analysis to tracer arrival time has been tested. Voxel-

2504

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

Fig. 7. Box plot representing the difference between MBF o n se t and
MBF fre e from quantification in segmental and voxel-wise analysis in a group
of patients. The difference between the obtained MBF values in both normal and ischemic regions of myocardium in voxel-wise analysis (low CNR,
CNR = 17 ± 5.2) is higher than found in segmental analysis (high CNR,
CNR = 28 ± 3.7). This higher difference proves the sensitivity of voxel-wise
analysis to tracer arrival times. No significant difference between the results
obtained in segmental analysis with and without using optimized tO n se t was
observed.

wise results have been compared with the results obtained from
segmental analysis.
Fig. 7 compares (|MBFonset − MBFfree |) obtained from segmental analysis (high CNR) with voxel-wise analysis (low CNR)
in normal and ischemic regions of a group of patients. The results show a high discrepancy between MBFonset and MBFfree
in normal and ischemic regions in voxel-wise analysis compared to segmental analysis. This difference is more apparent in
normal regions of the voxel-wise analysis.
Histograms of relative tOnset (trel ) values in a group of healthy
volunteers and patients are represented in Fig. 8(a) and (b), respectively. In healthy volunteers group, relative tOnset has a
homogenous distribution with the majority of the values distributed between 1 and 4 s. This figure demonstrates that tOnset
detection algorithm does not lead to tOnset variations.
On the other hand, as it can be seen from Fig. 8(b), the
distribution of the values in patient’s pool is divided into two
groups: first one is between 0 and 4 s; second one is between 4
and 10 s. Here, more than 80% of the values, which are related
to normal voxels in this group, are distributed between 0 and 4 s.
Voxels with relative tOnset between 5 and 10 s are associated
with the ischemic areas in the group of patients.
The relative tOnset (trel ) in myocardial basal, mid-cavity, and
apical layers in a random patient with abnormal perfusion and
a healthy volunteer is represented in Fig. 9. The inhomogeneity
of the tOnset is apparent in the patient’s tOnset maps, whereas
the healthy volunteer showed to have a relatively homogeneous
distribution of tOnset , which is also shorter on average.
On a 2.8 GHz PC, optimized tOnset approach takes around
1.8 min and free parameter approach just less than a minute to
perform the analysis.
Table I represents the coefficient of variation of the tOnset
value for the five patients and five volunteers. A significant
difference between the CV in the patient group and healthy volunteer group was observed (P-value = 0.0004). Overall, patients
had a higher CV compared to healthy volunteers.

Fig. 8. Histogram of the relative tO n se t data in a group of (a) healthy volunteers and (b) patients. In the healthy volunteers group, relative tO n se t has
a homogenous distribution. The distribution of the values in patient’s pool is
divided into two groups. First one is between 0 and 4 s, which corresponds to
normal areas. Second group of values that are between 4 and 10 s are associated
with the ischemic areas in the patients.

Fig. 9. Delay maps illustrating the relative tO n se t (tre l ) in (top row) a patient
with right coronary artery (RCA) disease and (bottom row) a healthy volunteer.
The inhomogeneity of the tO n se t in the tissue is apparent in the patient’s tO n se t
map. The healthy volunteer delay map showed to have a relatively homogenous
distribution of tO n se t . The difference between tO n se t in voxels makes voxelwise quantification of MBF without using their real onset time inadequate.

TABLE I
tONSET COEFFICIENT OF VARIATION IN THE FIVE PATIENTS
AND FIVE VOLUNTEERS
Subject

Patients

1
2
3
4
5

0.59
0.62
0.55
0.78
0.53

Healthy Volunteers
0.45
0.24
0.31
0.19
0.27

ZARINABAD et al.: EFFECTS OF TRACER ARRIVAL TIME ON THE ACCURACY OF HIGH-RESOLUTION

2505

Similar results were reflected in our experiments and clinical
data, where the use of optimized tOnset allowed a significant
improvement in the accuracy of the voxel-wise perfusion maps.
Moreover, the difference between the delay times in arrival
of contrast agent in myocardium normal and ischemic voxels
allows for the evaluation of diseased areas of by estimating the
time point of tracer arrival at a particular voxel. This parameter,
which its estimation is less complex compared to deconvolution analysis, could also be used as an impaired flow reserve
marker with the ability distinguish between the arrival time at
endocardial and epicardial segments.
A. Limitations
Fig. 10. Scatter-box plot representing the estimated voxel wise MBF values
in a patient with RCA disease (empty circle/grey) and a healthy volunteer
(filled circles/green), comparing results obtained using an optimized tOnset
with keeping as a free global parameter. Each individual green dot shows the
estimated MBF at each voxel and they have been spread for visualization reasons
and clarity. On each blue box, the central red mark is the median; the edges of
the box are the 25th and 75th percentiles.

V. DISCUSSION
Based on the results obtained in vivo, in a hardware phantom
and in computer simulations, we have shown that quantification
of myocardial perfusion is sensitive to the delay between the
arrival of contrast agent into the LV blood pool and myocardial
tissue and consequently an inaccurate selection of tracer arrival
time can cause a significant error in estimation of MBF.
As our results demonstrated, this issue becomes even more
important in voxel-wise analysis as it is more sensitive to delay
time compared with a segmental analysis due to its higher spatial
detail and lower CNR level. Therefore, the use of an optimized
tOnset for deconvolution is needed to improve the accuracy of
MBF estimations.
This study proposes to improve flow estimates in voxel-wise
analysis by automatically finding the delay between tAIF and
tOnset in each voxel and use it for quantification of MBF.
In this study, the assessment of reconstructed tissue curve
goodness of fit as a function of the time shift was the basis for
determining the optimized tOnset and, consequently, improving
the accuracy of flow estimates. The algorithm introduced here
considers the interaction between the delay time and the fit error
to obtain an optimal estimate of the tOnset .
Our results demonstrated that the proposed algorithm for detection of tOnset is highly sensitive to noise level and flow rate.
The proposed method showed to be more accurate in estimating
the onset time of contrast agent at high CNR levels and flow
rates.
However, despite the hurdle in estimation of onset time, using the optimized tOnset approach for quantitative analysis at
low CNR levels (i.e., voxel-wise analysis) results in a higher
accuracy in estimation of MBF compared with when the delay
between tAIF and tOnset has been assumed as a free global parameter. Moreover, optimized tOnset method showed to be more
accurate in estimation of MBF at all flow rates compared with
when tOnset is assumed as a free global parameter.

The clinical findings presented here are preliminary and
meant to demonstrate the feasibility of tOnset optimization on
patients’ data. Additional studies involving a larger cohort of
patients are necessary to better determine the predictive power
of MBF maps.
To determine the impact of tOnset estimation on accurate
quantitative flow estimation in patients, future prognostic studies testing the importance of voxel-wise MBF analysis in patients will be required. Moreover, a systematic study needs to
be conducted to evaluate the impact of baseline correction on
the tOnset estimation algorithm and, consequently, the accuracy
of quantitative MBF assessment.
It is important to note that myocardium signal intensity curves
should always be aligned with the bolus of arterial input function
of interest, independent of the used method (i.e., main bolus
when dual-sequence or single-bolus techniques are used and
prebolus when dual bolus is used). This is, however, not shown
by the data presented in this paper, and a further study evaluating
effects of tOnset estimation on these techniques is required.
Also, it is expected to have longer relative tOnset at apical layer
compared to basal and mid-cavity slice. However, due to the
faster speed of blood at apical coronary arteries (200–500 cm/s
at rest) and more importantly the relatively low temporal resolution of the perfusion CMR, the capacitance effects of epicardial
vessels are masked. This issue has not been addressed in this
study and requires further investigations.
VI. CONCLUSION
Voxel-wise perfusion estimates based on first pass perfusion
CMR have many desirable characteristics including high sensitivity in identifying the tissue at risk. MBF estimates, however,
are biased by several factors, including the tracer arrival time
into myocardial tissue, and therefore attempts to quantify MBF
without using the tOnset may be premature. An accurate estimation of MBF and thus clearer delineation of the ischemic
region in the perfusion maps relies on the precise identification
of tOnset .
REFERENCES
[1] M. Ishida, G. Morton, A. Schuster, E. Nagel, and A. Chiribiri, “Quantitative assessment of myocardial perfusion MRI,” Curr. Cardiovasc Imag.
Rep., vol. 3, p. 8, 2010.

2506

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 9, SEPTEMBER 2014

[2] L. Y. Hsu, D. W. Groves, A. H. Aletras, P. Kellman, and A. E. Arai,
“A quantitative pixel-wise measurement of myocardial blood flow by
contrast-enhanced first-pass CMR perfusion imaging: Microsphere validation in dogs and feasibility study in humans,” JACC Cardiovasc. Imag.,
vol. 5, no. 2, pp. 154–166, Feb. 2012.
[3] N. Zarinabad, A. Chiribiri, G. L. Hautvast, M. Ishida, A. Schuster, Z.
Cvetkovic, P. G. Batchelor, and E. Nagel, “Voxel-wise quantification
of myocardial perfusion by cardiac magnetic resonance. Feasibility and
methods comparison,” Magn. Resonance Med., vol. 68, no. 6, pp. 1994–
2004, Dec. 2012.
[4] M. Jerosch-Herold, X. Hu, N. S. Murthy, and R. T. Seethamraju, “Time delay for arrival of MR contrast agent in collateral-dependent myocardium,”
IEEE Trans. Med. Imag., vol. 23, no. 7, pp. 881–890, Jul. 2004.
[5] N. Zarinabad, G. Hautvast, M. Breeuwer, E. Nagel, and A. Chiribiri,
“Effect of tracer arrival time on the estimation of the myocardial perfusion
in DCE-CMR,” J. Cardiovasc. Magn. Resonance, vol. 14, no. 1, p. 1, 2012.
[6] N. Zarinabad, G. Hautvast, M. Breeuwer, A. Chiribiri, and E. Nagel,
“Sensitivity of quantification methods to tracer arrival time for myocardial
perfusion estimation in DCE-MRI,” Eur. Heart J., vol. 33, p. 192, 2012.
[7] K. Zierler, “Indicator dilution methods for measuring blood flow, volume,
and other properties of biological systems: A brief history and memoir,”
Ann. Biomed. Eng., vol. 28, no. 8, pp. 836–48, Aug. 2000.
[8] M. Jerosch-Herold, N. Wilke, and A. E. Stillman, “Magnetic resonance
quantification of the myocardial perfusion reserve with a Fermi function
model for constrained deconvolution,” Med. Phys., vol. 25, no. 1, pp.
73–84, Jan. 1998.
[9] N. Wilke, M. Jerosch-Herold, Y. Wang, Y. Huang, B. V. Christensen, A.
E. Stillman, K. Ugurbil, K. McDonald, and R. F. Wilson, “Myocardial
perfusion reserve: Assessment with multisection, quantitative, first-pass
MR imaging,” Radiology, vol. 204, no. 2, pp. 373–384, Aug. 1997.
[10] L. Y. Hsu, K. L. Rhoads, J. E. Holly, P. Kellman, A. H. Aletras, and A.
E. Arai, “Quantitative myocardial perfusion analysis with a dual-bolus
contrast-enhanced first-pass MRI technique in humans,” J Magn. Reson.
Imag., vol. 23, no. 3, pp. 315–22, Mar. 2006.
[11] N. A. Pack and E. V. DiBella, “Comparison of myocardial perfusion
estimates from dynamic contrast-enhanced magnetic resonance imaging
with four quantitative analysis methods,” Magn. Reson. Med., vol. 64, no.
1, pp. 125–137, Jul. 2010.
[12] H. Gudbjartsson, and S. Patz, “The Rician distribution of noisy MRI data,”
Magn. Reson. Med., vol. 34, no. 6, pp. 910–914, Dec. 1995.
[13] J. Rajan, D. Poot, J. Juntu, and J. Sijbers, “Noise measurement from
magnitude MRI using local estimates of variance and skewness,” Phys.
Med. Biol., vol. 55, no. 16, pp. N441–N449, Aug. 21, 2010.
[14] J. K. Lindsey, W. D. Byrom, J. Wang, P. Jarvis, and B. Jones, “Generalized
nonlinear models for pharmacokinetic data,” Biometrics, vol. 56, no. 1,
pp. 81–88, Mar. 2000.
[15] S. L. Keeling, T. Kogler, and R. Stollberger, “Deconvolution for DCEMRI using an exponential approximation basis,” Med. Image Anal., vol.
13, no. 1, pp. 80–90, Feb. 2009.
[16] A. Chiribiri, A. Schuster, M. Ishida, G. Hautvast, N. Zarinabadnooralipour,
M. Paul, S. Hussain, P. Batchelor, M. Breeuwer, T. Schaeffter, and E.
Nagel, “Dynamic simulation of first pass myocardial perfusion MR with
a novel perfusion phantom,” J Cardiovasc. Magn. Reson., vol. 13, p. 46,
2011.

[17] A. Chiribiri, A. Schuster, M. Ishida, G. Hautvast, N. Zarinabad, G. Morton, J. Otton, S. Plein, M. Breeuwer, P. Batchelor, T. Schaeffter, and E.
Nagel, “Perfusion phantom: An efficient and reproducible method to simulate myocardial first-pass perfusion measurements with cardiovascular
magnetic resonance,” Magn. Resonance Med. Apr. 24, 2012.
[18] S. Plein, S. Ryf, and J. Schwitter , “Dynamic contrast-enhanced myocardial perfusion MRI accelerated with k-t sense,” Magn. Reson. Med., vol.
58, no. 4, pp. 777–785, Oct. 2007.
[19] S. Plein, J. Schwitter, D. Suerder, J. P. Greenwood, P. Boesiger, and S.
Kozerke, “k-Space and time sensitivity encoding-accelerated myocardial
perfusion MR imaging at 3.0 T: Comparison with 1.5 T,” Radiology, vol.
249, no. 2, pp. 493–500, Nov. 2008.
[20] R. Gebker, C. Jahnke, I. Paetsch, B. Schnackenburg, S. Kozerke, A. Bornstedt, E. Fleck, and E. Nagel, “MR myocardial perfusion imaging with
k-space and time broad-use linear acquisition speed-up technique: Feasibility study,” Radiology, vol. 245, no. 3, pp. 863–871, Dec. 2007.
[21] M. Ishida, A. Schuster, G. Morton, A. Chiribiri, S. Hussain, M. Paul, N.
Merkle, H. Steen, D. Lossnitzer, B. Schnackenburg, K. Alfakih, S. Plein,
and E. Nagel, “Development of a universal dual-bolus injection scheme
for the quantitative assessment of myocardial perfusion cardiovascular
magnetic resonance,” J. Cardiovasc. Magn. Reson., vol. 13, no. 1, p. 28,
May 24, 2011.
[22] M. Breeuwer, M. Quist, and L. Spreeuwers, “Automatic quantitative analysis of cardiac MR perfusion images,” in Proc. SPIE Med. Imag., San
Diego, CA, USA, 2001, vol. 4322, pp. 733–742.
[23] L. Spreeuwers and M. Breeuwer, “Automatic detection of myocardial
boundaries in MR cardio perfusion images,” in Proc. Med. Image Comput.
Comput.-Assisted Intervention, Utrecht, The Netherlands, 2001, pp. 1228–
1231.
[24] G. L. Hautvast, A. Chiribiri, T. Lockie, M. Breeuwer, E. Nagel, and
S. Plein, “Quantitative analysis of transmural gradients in myocardial
perfusion magnetic resonance images,” Magn. Resonance Med. Official J.
Soc. Magn. Resonance Med., vol. 66, no. 5, pp. 1477–1487, Nov. 2011.
[25] G. Hautvast, A. Chiribiri, N. Zarinabad, A. Schuster, M. Breeuwer, and E.
Nagel, “Myocardial blood flow quantification from MRI by deconvolution
using an exponential approximation basis,” IEEE Trans. Biomed. Eng., vol.
59, no. 7, pp. 2060–2067, Jul. 2012.
[26] A. Chiribiri, G. L. Hautvast, T. Lockie, A. Schuster, B. Bigalke, L. Olivotti,
S. R. Redwood, M. Breeuwer, S. Plein, and E. Nagel, “Assessment of
coronary artery stenosis severity and location: Quantitative analysis of
transmural perfusion gradients by high-resolution MRI versus FFR,” JACC
Cardiovasc. Imag., vol. 6, no. 5, pp. 600–609, May, 2013.
[27] P. E. Gill, W. Murray, and M. H. Wright, Practical Optimization. London,
U.K./New York, NY, USA Academic Press, 1981.

Authors’ photographs and biographies not available at the time of publication.

