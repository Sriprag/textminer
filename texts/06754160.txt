2264

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

Tissue Doppler Imaging Optical Flow (TDIOF):
A Combined B-Mode and Tissue Doppler
Approach for Cardiac Motion Estimation
in Echocardiographic Images
Vahid Tavakoli∗ , Nirman Bhatia, Rita A. Longaker, Marcus F. Stoddard, and Amir A. Amini, Fellow, IEEE

Abstract—The quantitative analysis of cardiac motion from
echocardiographic images helps clinicians in the diagnosis and
therapy of patients suffering from heart disease. Quantitative analysis is usually based on tissue Doppler imaging (TDI) or speckle
tracking. These methods are based on two techniques which to
a large degree are independent: the Doppler phenomenon and
image sequence processing. Herein, to increase the accuracy of
the speckle tracking technique and to cope with the angle dependence of TDI, a combined approach dubbed tissue Doppler
imaging optical flow (TDIOF) is proposed. TDIOF is formulated
based on the combination of B-mode and Doppler energy terms
minimized using algebraic equations and is validated on simulated images, and in vivo data. It was observed that the additional
Doppler term is able to increase the accuracy of speckle tracking,
compared to two popular motion estimation and speckle tracking
techniques (Horn–Schunck and block matching methods). This
observation was more pronounced when noise was present. The
magnitude and angular error for TDIOF applied to simulated images, when comparing estimated motion with ground-truth motion,
were 15% and 9.2◦ /frame, respectively. As an additional validation, echocardiography-derived strains were compared to tagged
MRI-derived myocardial strains in the same subjects. The correlation coefficient (r) between the TDIOF-derived radial strains and
tagged MRI-derived radial strains value was 0.83 (P < 0.001).
The correlation coefficient (r) for the TDIOF-derived circumferential strains compared to the tagged MRI-derived circumferential
strains was 0.86 (P < 0.001). The comparison of TDIOF-derived
and block matching speckle tracking and Horn–Schunck optical
flow strain values using student t-test demonstrated superiority of
TDIOF (95% confidence interval, P < 0.001).

Manuscript received April 26, 2013; revised December 2, 2013; accepted
December 9, 2013. Date of publication March 3, 2014; date of current version July 15, 2014. The work of V. Tavakoli was supported by the University
of Louisville Graduate Student Fellowship. Asterisk indicates corresponding
author.
∗ V. Tavakoli is with the Department of Electrical and Computer Engineering, University of Louisville, Louisville, KY 40202 USA (e-mail:
vahid.tavakoli@yale.edu).
N. Bhatia, R. A. Longaker, and M. F. Stoddard are with the University of Louisville Medical School, Louisville, KY 40202 USA, and
also with the Veterans’ Affairs Medical Center, Louisville, KY 40206
USA (e-mail: n0bhat01@louisville.edu; mfstod01@louisville.edu; ralong01@
louisville.edu).
A. A. Amini is with the Department of Electrical and Computer Engineering, University of Louisville, Louisville, KY 40202 USA and also with
the Veterans’ Affairs Medical Center, Louisville, KY 40206 USA (e-mail:
amir.amini@louisville.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2299551

Index Terms—Cardiac motion, cardiac strain, echocardiography, optical flow, tissue Doppler imaging (TDI).

I. INTRODUCTION
ARDIOVASCULAR disease (CVD) is the leading cause
of death in the modern world. The mortality rate associated with CVD was estimated to be 17 million in 2005 and
continues to be ranked as the top killer worldwide. CVD is the
result of undersupply of the cardiac tissue and can lead to malfunction of the involved myocardial territories and manifest as
hypokinesia or akinesia. Several imaging methods such as X-ray
CT, MRI, and Ultrasound have been used for visualization of
the heart function. MRI and X-ray CT provide excellent spatial
resolution but the cost and lack of widespread availability cause
challenges in the clinical settings. Echocardiography is a popular
technique for cardiac imaging due to its availability, ease of use,
and low cost. Echocardiography shows the motion and anatomy
of the heart in real time, enabling physicians to detect different
pathologies. However, analysis of motion of the myocardium
in echocardiographic images is based on visual grading by an
observer and suffers from inter- and intraobserver variability.
To overcome the inter- and intraobserver variability, computerized image analysis can help by quantitatively interpreting the
data. To that end, cardiac image processing techniques, mainly
categorized as segmentation and registration, have been widely
used for assessing the regional function of the heart [1]–[3]. To
perform such analysis, two independent techniques have been
utilized; these are tissue Doppler imaging (TDI) and speckle
tracking. TDI computes the tissue motion based on the Doppler
phenomenon and is dependent on the angle of insonification.
Speckle tracking, on the other hand, is an image processing
method based on the analysis of the ultrasound B-mode or RF
images. B-mode-based algorithms are robust to the variation of
the ultrasound beam angle but rely entirely on the properties of
echocardiographic images which may be noisy or suffer from
artifacts. The physical principle underlying B-mode and TDI is
to a large degree independent and, therefore, carries complementary information for myocardial motion estimation [4], [5].
Many methods such as optical flow [6], feature tracking
[7], level sets [8], block matching (BM) [9], and elastic registration [10] have been utilized for quantitative assessment
of myocardial motion in B-mode images. Table I shows a

C

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

2265

TABLE I
DESCRIPTION OF SOME OF THE CURRENT METHODS USED IN MOTION DETECTION IN ECHOCARDIOGRAPHY IMAGES

description of some of the current methods used in motion estimation in echocardiographic images [6]–[21]. Suhling et al. [6]
integrated rigid registration in an optical flow framework in order
to detect myocardial motion from 2-D echocardiographic images. B-spline moments invariants were applied to echo images
to achieve invariance to the translation and rotation. The motion
estimation algorithm was, then, applied to the B-spline moments
of the image instead of the image intensity in a coarse-to-fine
strategy and was validated using open chested dogs after ligation of a coronary artery. Additional validations were performed
on simulation and phantom images. Ellen et al. [10] used elastic
registration on 3-D B-mode echocardiography images to extract
myocardial motion and strain values. The method was validated using simulated and real ultrasound images. Esther-Leung
et al. [11] proposed two different methods (model-driven and
edge-driven) for tracking the left-ventricular wall in echocardiographic images. Their approach was motivated by the fact that
in echocardiography images, visibility of the myocardium depends on the imaging view; so the myocardium may be, partly,
invisible to the beam. Their technique relied on a local datadriven tracker using optical flow applied to the visible parts of
the myocardium and a global statistical model applied to the invisible parts. It was concluded that the shape model could render
good results for both the visible and the invisible tissues in ultrasound images. Myronenco et al. [12] proposed the so-called
coherent point drift (CPD) technique for myocardial motion
estimation, constraining the motion of the point set in the temporal direction for both rigid and nonrigid point set registration.
A set of point distribution was computed based on endocardium
and epicardium locations. The point set was modeled with a
Gaussian mixture model (GMM). The GMM centroids were
updated coherently in a global pattern using maximum likelihood to preserve the topological structure of the point sets. A
motion coherence constraint was added based on regularization
of the displacement fields. The purpose of regularization was to
increase the motion smoothness.

Most of the motion estimation techniques developed thus far
are either based on TDI or B-mode. Recently, Garcia et al. [22]
considered the combination of cardiac B-mode images and intracardiac blood flow data for computing the blood flow motion
in the heart using continuity equation and mass conservation
in polar coordinates. Their paper focused on the blood flow
computation and did not consider the cardiac tissue displacements. Dalen et al. [23] and Amundsen et al. [24] previously
combined TDI with speckle tracking by integrating TDI in the
beam direction and speckle tracking in the direction lateral to
the beam. However, this method discarded the speckle tracking
data in the beam direction. The authors reported that they were
unable to improve the motion estimation performance compared
to speckle tracking techniques. In this paper, we propose integration of tissue Doppler and speckle tracking within a novel optical flow framework, called tissue Doppler optical flow (TDIOF).
Our experimental results indicate that TDIOF outperforms the
speckle tracking approaches.
The organization of the rest of this paper is as follows: in
Section II, we review the mathematical and algorithmic basis
for the proposed method. Section III is a description of datasets
used for validation of the proposed method. These include computational simulations, and in vivo data collected in patients
recruited from the echocardiography laboratory at the Robley
Rex VA Medical Center to our IRB-approved study. In Section
IV, strain computations are discussed and, in Section V, results
from validation of the proposed method are described. Finally,
in Section VI, we discuss observations related to TDIOF and
our findings.
II. METHODS AND MATERIALS
TDI and B-mode speckle tracking are different in both their
physical underpinning and data type. In speckle tracking, tissue motion is determined from motion of speckles in ultrasound
images—typically, using a BM approach applied to 2-D B-mode

2266

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

images. Although speckle tracking provides both components
of the motion in the spatial domain, it is based on noisy B-mode
images. TDI, on the other hand, only computes the velocity of
tissue in one direction as moving toward (displayed as red) or
away (displayed as blue) from the transducer. This means that
the computed motion is the projection of the real motion in the
direction of the ultrasound beam and, therefore, TDI is angle
dependent. In this section, we first describe a novel energy minimization framework for estimation of myocardial motion from
B-mode images which incorporates a velocity constraint from
TDI. The proposed method is based on optimization of three energy functions: 1) intensity constancy assumption; 2) velocity
smoothness; and 3) similarity with Doppler data. The framework
is minimized using an incremental algebraic method [25], [26]
as described. In order to show the performance of TDIOF, it is
compared to two popular motion detection techniques: Horn–
Schunck (HS) optical flow [27] and BM [28]. BM may be applied to B-mode or raw RF data [29]. In this study, BM has been
applied to B-mode images.

(6)

2) The smoothness energy term forces the flow field to be
continuous:
Es = |∇(u + du)|2 + |∇(v + dv)|2
with


2

|∇(u + du)| =

∂(u + du)
∂x



2
+

∂(u + du)
∂y

(7)
2
.

(8)
3) TDI velocity term: The 2-D motion when projected in
the direction of the transducer should be similar to the
computed velocity. If v = (u, v) is the B-mode velocity,
vt = (ut , vt ) is the transducer orientation, and wtdi is the
TDI velocity acquired from the echo machine, then the
constraint is formulated as
2

Etdi = vT vt − wtdi = (ut u + vt v − wtdi )2 .

(9)

In order to keep the range of Etdi between 0 and 1, and to
reject outliers, we utilized a Geman–Mcclure penalizer (ψ) [26]:

A. Mathematical Framework for TDIOF
To determine myocardial motion, we propose a novel optical
flow energy function which combines three energy terms: Bmode intensity constancy, Doppler/B-mode velocity similarity,
and motion smoothness.
1) B-mode intensity constancy: If we assume that p =
(x, y, t) and the flow field is w(p) = (u(p), v(p), 1) where
u and v are the motion vectors and x, y, and t are the spatial and temporal dimensions, B-mode intensity constancy
term assumes that the pixel intensity is the same along the
motion vector. When I(p) is the pixel intensity at location
p and I(p + w) is the pixel intensity in the subsequent
frame at location p + w,
Edata = |I(p + w) − I(p)|2 .

It (p) = I(p + w) − I(p).

ψ(s) =

s2
.
s2 + σ 2

(10)

where s is the input data and σ is the scaling parameter.
The total energy function to be minimized is
E(u, v) = Edata + αEs + βψ(Etdi )

= (|I(P + w + dw) − I(p)|2
Ω

+ α(|∇(u + du)|2 + |∇(v + dv)|2 )
+ β · ψ((ut (u + du) + vt (v + dv) − wtdi )2 ))

(1)

(11)

Although optical flow is usually solved using calculus
of variation, we use the recent incremental flow framework [25] which provides significant computational savings. The incremental flow assumes that an estimate of
flow is already known (iteration 0) and, then, the best increment will be found at each iteration. With inclusion of
an incremental motion vector, the intensity constancy is
revised to be

where α is the smoothness weight and β is the TDI/velocity correspondence parameter—we note that setting β to 0 essentially
results in the Horn and Schunck optical flow frame case in the incremental flow framework. Next, we vectorize u, v, du, and dv
as U, V, dU, and dV :

Edata = |I(p + w + dw) − I(p)|2 .

(2)

The above equation can be linearized using Taylor series
expansion:
It (p + w + dw) − I(p)
= It (p) + Ix (p)du(p) + Iy (p)dv(p)

(3)

Ix = diag(Ix )

Iy = diag(Iy ).

Dx and Dy are denoted as matrices related to the x and y
derivative filters such that: Dx U = u ⊗ [0 − 1 1]. The derivative operator is used to compute the gradient of the image in
each direction. In addition, the column vector δp is defined as a
Dirac function with the only nonzero element at location p such
that δp Ix = Ix (p). Now, the discretized version of the energy
function (see (11)) becomes

E=
(δpT (It + Ix dU + Iy dV ))2
p

with
∂I(p + w)
∂x
∂I(p + w)
Iy (p) =
∂y

Ix (p) =

(4)

+ α[(δpT Dx (U + dU )2 + (δpT Dy (U + dU )2 )
+ (δpT Dx (V + dV )2 + (δpT Dy (V + dV )2 )]

(5)

+ β((δ T (ut (U + dU ) + vt (V + dV ) − wtdi ))2 ). (12)

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

To minimize (12), iterative reweighted
	 squares was used
 E least
E
= 0. Here, it is
; ∂∂dV
with the stopping criterion that ∂∂dU
noteworthy to state that since for matrix A and vectors x, b:
d T
x Ax = 2Ax
dx

2267

TABLE II
THIRTEEN K-PARAMETERS OF ART’S KINEMATIC MODEL FOR
LEFT-VENTRICULAR DEFORMATION USED IN OUR CARDIAC US
MOTION SIMULATOR

d T
x b = b.
dx

Therefore,




∂E
Ix δp δpT (I y dV + It ) + Ix δp δpT Ix dU
=2
∂dU
p
+ α[(DxT δp δpT Dx + DTy δp δpT Dy )(U + dU )]
+ βψ  (Etdi )[ut δp (δpT ((U + dU )ut
+ (V + dV )vt − wtdi ))] = 2((Ix2 + αL + βψ  u2t )dU
+ (Ix Iy + βψ  ut vt )dV + (αL + βψ  u2t )U
+ βψ  ut vt V + (Ix It − βψ  ut wtdi )

(13)

∂E
= 2((Ix2 + αL + βψ  u2t )dU
∂dU
+ (Ix Iy + βψ  ut vt )dV + (αL + βψ  u2t )U
+ βψ  ut vt V + (Ix It − βψ  ut wtdi )

(14)

where



L = DTx ψ  Dx + DTy ψ  Dy

(15)

ψ  = diag(ψ  (Etdi ))

(16)

T
p δp δp

is the identity matrix.
and
Similarly

MAD =

∂E
= ((Ix Iy + βψ  ut vt )dU
∂dV

N −1 N −1
1 
|Cij − Rij |.
N 2 i=0 j =0

(19)

where N is the size of macroblock while Cij and Rij define the
pixel locations within the blocks. The index i is the shift in x
and j is the shift toward y, when the main block is sliding over
the image [28].

+ (Iy2 + αL + βψ  vt2 )dV + βψ  ut vt U
+ (αL + βψ  vt2 )V + (Iy It − βψ  vt wtdi ).

match. To find the best matching block, it is necessary to have
a similarity metric that measures the similarity between two
blocks. There are several well-known BM algorithms based
on different cost functions, such as mean absolute difference
(MAD), mean square error, or correlation. MAD is utilized in
this paper because of its accuracy and computational efficiency
[28]. MAD is formulated as follows:

(17)

Finally, the following linear equation is derived as:
 2


Ix + αL + βψ  u2t
dU
Ix Iy + βψ  ut vt
dV
Ix Iy + βψ  ut vt
Iy2 + αL + βψ  vt2


Ix It + αLU − βψ  ut wtdi + βψ  u2t U + βψ  ut vt V
=
.
Iy It + αLV − βψ  vt wtdi + +βψ  ut vt U + βψ  vt2 V
(18)
In practice, u, v, dU, and dV are initialized as 0 with dU
and dV iteratively updated using linear least squares. In order to
cover a wide range of displacements and to reduce the computational time, the algorithm is applied in a multiscale strategy.
The coarse scale is tackled in the first step, while the fine scale
is computed in the last stage.
B. BM
The main idea in this type of motion estimation is that each
block of a frame moves toward a block with similar intensity in
the next frame, when the time interval between the two frames
is small. The general strategy is to slide each block of the first
frame over the next frame in order to locate the most similar

III. VALIDATIONS
A. Simulated Computerized Phantom
Echocardiographic images are the result of the mechanical interaction between the ultrasound field and the contractile heart
tissue. Previously, we reported on development and use of an ultrasound cardiac motion simulator [30]. In the current study, we
utilized the COLE convolution-based simulation technique reported in [31]. The significance of an ultrasound cardiac motion
simulator is the availability of both echocardiographic images
as well as the actual ground-truth vector field of deformations.
A moving 3-D heart was modeled based on a pair of prolatespheroidal representations and used for the ultrasound simulation. The 3-D forward model of cardiac motion was simulated
using 13 time-dependent kinematic parameters of Arts et al. [32]
(see Table II). The evolution of the 13 kinematic parameters was
previously derived by Arts following a temporal fit to actual location of tantalum markers in a canine heart [32]. In Arts’ model,
seven time-dependent parameters are applied to define the ventricular shape change, torsion, and shear, while six parameters
are used to model the rigid-body motions. To simulate the ultrasound imaging process, scatterers were randomly distributed in

2268

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

the simulated left ventricle (LV) wall and the motion prescribed
by Arts’ model was used to move the ultrasound scatterers.
To determine Ultrasonic B-mode intensities, the COLE method
was used [32]. COLE is an efficient convolution-based method
in the spatial domain, producing US simulations by convolving
the segmental point spread function (PSF) with the projected
amplitudes of the scatterers [31] with the segmental PSF derived using Field II [33], [34]. The COLE technique reduces
the computational complexity of the convolution-based techniques for ultrasound simulation by decomposing the requisite
3-D convolution into 1-D convolutions. In order to model the
Doppler effect, the frequency of the RF signal was shifted in the
frequency domain based on the attributed ground-truth motion
vector and mixed with additive Gaussian noise. If the velocity of
the particle is v, ultrasound velocity is c, transducer frequency
is f , and the angle between the ultrasound beam and direction
of motion at a specific point is θ, then the Doppler shift is
Δf =

2vf cos θ
.
c

(20)

The simulation parameters were selected close to those of
the Philips iE 33 system and S5-1 transducer: Phased-array
transducer with central frequency 3 MHz for both B-mode and
Doppler imaging and pulse repetition frequency of 8.5 kHz. The
resolution of the first simulated sequence was 0.1 mm/pixel for
both B-mode and TDI images and included 14 midventricular
temporal frames in the axial orientation. In order to analyze
the robustness of the method to noise, another set of simulated
images were produced by adding Gaussian noise of 1.12 dB to
the noise-less data.
B. Patient Studies
Two separate sets of data were utilized for in vivo validations
(sets A and B). Set A contained 15 patients and was used for
manual tracking validation. Set B was a joint echo and tagged
MRI set and was used for both manual tracking and comparison
with tagged MRI (as will be discussed in Section III-B2).
1) Set A: Echocardiography Studies: Data from 15 subjects
who had already undergone echocardiographic imaging as part
of their diagnostic evaluation were deidentified and transferred
to the laboratory following IRB approval. The data included 13
male, 4 female, average age 52.9 ± 7.3, consisting of hypertension (eight cases), coronary artery disease (four cases), left
ventricular hypertrophy (four cases), congestive heart failure
(one case), chronic obstructive pulmonary disease (two cases),
diabetes mellitus (two cases), and smokers (one case). At the
University of Louisville Hospital’s echocardiography laboratory, echocardiographic images were acquired with a commercially available system (iE33, Philips Health Care, Best, The
Netherlands) using a S5-1 transducer (3 MHz frequency) and
the operator was free to change the gain and filter as needed.
The full dataset included two-chamber, three-chamber, fourchamber, and long-axis views.
2) Set B: Echocardiography-MRI Studies: The prospective
protocol for patient selection and imaging was approved by
the Institutional Review Board of the Robley Rex Veterans’

Affairs Medical Center, and a written informed consent was
obtained from patients. Eight male subjects were prospectively
recruited to the study with average age 54.6 ± 8.5. The subjects included hypertension (five cases), coronary artery disease
(two cases), congestive heart failure (one case), chronic obstructive pulmonary disease (one case), diabetes mellitus (three
cases), and smokers (four cases). The imaging protocol included
a primary 2-D echocardiography, including short-axis, longaxis, three-chamber, four-chamber, and two-chamber B-mode
and TDI imaging as well as simultaneous B-mode/TDI imaging
(two-chamber, three-chamber, four-chamber, and long-axis). At
the Robley Rex Veterans Affair Medical Center’s echocardiography laboratory, Echocardiographic images were acquired with
an iE33 commercial echocardiography system (Philips Health
Care, Best, The Netherlands) using a S5-1 transducer (3 MHz
frequency) and the operator was free to change the gain and
filter as needed.
Following ultrasound imaging, cine and tagged MRI data
were collected in all subjects. Tagged MRI data acquisition was
performed using Philips Achieva, TFE/GR sequence, TE/TR
2/4 ms, flip angle 15◦ , spatial resolution 1.25 × 1.25 mm, slice
thickness 8 mm, and spatial size 256 × 256 × 8 pixels. In all subjects, both echocardiography and MR imaging were performed
within 2 h to decrease any confounding events that could cause
discrepancy between wall motion studies in echocardiography
and MRI. In order to ensure that the B-mode and TDI images
were matched, B-mode and TDI images were simultaneously
acquired. In addition, subjects were asked to hold their breath
during data collection.
3) In Vivo Comparison of TDIOF-Derived Strains With
Strains From Tagged MRI: Tagged MRI [35] is known to provide highly accurate displacement fields in the systolic portion
of the cardiac cycle while the tags are present. We analyzed
the strain field in echocardiography and tagged MR images of
slices similar in location in the two modalities in set B. In selecting corresponding slices, qualitative anatomical landmarks
such as the papillary muscles and cardiac contours as well as
cine MRI images were utilized. Anatomical landmarks such
as endocardial shape and papillary muscle were used to locate
the appropriate short axis sections of the heart. The recently
proposed SinMod (Sine wave Modeling) technique [36] was,
then, used to derive displacements from tagged MRI data in
the first few systolic phases of the cardiac cycle, while the tags
persisted. SinMod is an automated motion estimation technique
for tagged MRI that models the pixels as a moving sine wavefront. Since no pixel to pixel mapping between echo and MR
images was known, the ventricular geometry from 2-D echo and
tagged MRI was divided into 17 segments following the American Heart Association’s recommendations. Subsequently, the
averaged Lagrangian strain for each of the heart segments was
compared between the two modalities. As the apex (17th segment) is difficult to visualize on short-axis MRI and B-mode
images, it was excluded from the analysis. Since the frame rate
of echo and MRI is not the same and the heart rate may change,
it was necessary to align the images in the temporal dimension.
This was done by spline interpolation of the measured strain
data in the time domain.

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

2269

Fig. 1. Seventeen AHA prescribed segments for the heart (a) basal SAX view, (b) mid-LV SAX view, and (c) apical SAX view (antero-septal (AS), anterior (A),
lateral (L), posterior (P), inferior (I), and infero-septal (IS)) [38], [39].

IV. STRAIN ANALYSIS
Strain is a measure of deformation of the cardiac tissue. With
I representing the identity matrix, the Lagrangian strain tensor
at a given myocardial point and for a specific time point can be
expressed as
E=

1 T
(F F − I)
2

(21)

where the elements of the deformation gradient tensor, F , are
⎛ ∂x
∂x ∂x ⎞
⎜ ∂X
⎜
⎜ ∂y
F =⎜
⎜ ∂X
⎝
∂z
∂X

∂Y
∂y
∂Y
∂z
∂Y

∂Z
∂y
∂Z
∂z
∂Z

⎟
⎟
⎟
⎟
⎟
⎠

(22)

while x = X + V (X), X represents the spatial coordinates in
the undeformed coordinates (typically taken to be the enddiastolic frame), and V (X) is the accumulated motion vector
at the corresponding spatial location relative to the undeformed
state. For the echocardiography data, the reference frame for the
strain computation was considered to be the end diastolic frame
and was selected based on ECG trigger. The deformation field
was then computed between each two frames and was added to
the motion field from the previous frame in order to measure
the accumulated deformation and strain. Since the deformation
fields of the consecutive frames do not represent the motion
of the same pixels, spline interpolation was used to align the
deformation fields. For the tagged MRI data, the end-diastolic
frame was always the first acquired image which is collected
immediately after the R-wave trigger.
The normal strain in the direction of the unit vector n can
be calculated from the Lagrangian strain tensor through the
quadratic form nT n, where n is a unit vector and can point to any
direction on the unit sphere. Due to the geometry of the LV, the
normal strains are usually calculated in radial, circumferential,
and longitudinal directions. Regional analysis is performed on
17 American Heart Association (AHA) prescribed segments
[37]. Fig. 1 shows the different segments. The acronyms stand
for antero-septal (AS), anterior (A), lateral (L), posterior (P),
inferior (I), and infero-septal (IS). For a review of topics related
to determination of strain from cardiac images, the reader is
referred to [37], [39], and [40].

Fig. 2. Performance of TDIOF using different parameters based on relative
mean absolute error: X -axis is shown with a logarithmic scale in order to report
a wide range of parameter settings. The performance of TDIOF is plotted versus
smoothness coefficient for different TDI similarity coefficients (β). Changes of
performance is evident when smoothness parameter (α) changes. As seen from
the plots, performance was more dependent on the smoothness and insensitive
to the scale for the TDIOF term.

V. RESULTS
As noted in Sections III, TDIOF was applied to three different
datasets: simulated images and in vivo data (both sets A and B).
To further elucidate the effect of the Doppler term, results from
TDIOF were compared to HS optical flow (β = 0 in (11)) and
BM with the latter being the basis for most commercial speckle
tracking methods [29]. Since the performance of each technique
depends on the parameters of the method, it was necessary to
optimize the parameters. Based on simulated images, an exhaustive search was performed over the parameters of TDIOF, HS
optical flow, and BM speckle tracking method (a large range was
considered for each parameter) and the best values were selected
experimentally. To analyze the performance of the techniques
with different parameter settings, simulated images were compared to the next simulated frame after being warped using the
estimated motion field. Relative mean absolute error was used
for the
comparison. Relative mean absolute error was computed
ˆ
ˆ
as N1
i,j I − I/I, where I and I are the first and subsequent warped images, and N is the total number of points. The
three techniques were applied to the 14 simulated frames using
different parameter values (in each case, a large range was considered) and the best parameters, which minimized the relative
mean absolute error measure, were selected. Fig. 2 shows the

2270

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

Fig. 3. (a) Simulated cardiac model in diastole and systole. (b) Three-dimensional simulated B-mode image based on COLE. (c) Computed tissue Doppler image
using the simulated sequence.

Fig. 4.

(a) Results of TDIOF from a midventricular section of the 3-D simulated echo data. (b) Ground-truth motion field.

performance of the TDIOF technique using different parameters. The methods were, then, applied to all the datasets using
the resulting parameters: number of scales for multiscale implementation: 5, α (smoothness weight): 2000, β (TDI similarity
weight): 0.001, and σ (penalizer parameter): 0.1. The parameters for the HS technique were set as follows: number of scales
5, and smoothness weight 2000. MATLAB 2011 was the platform for developing TDIOF using 8 × 3.8 GHz AMD CPU
and 16 GHz RAM. The computational time for processing two
frames of the in vivo echo data was 38, 25, and 51 s using BM,
HS, and TDIOF, respectively.

A. Validations on Simulated Images
The simulated 3-D cardiac model built based on Arts’ et al.
[32] is shown in Fig. 3(a). The deformation shown in the figure
is that of a systolic motion. The 3-D B-mode image deformation
was computed based on [32] and is shown in Fig. 3(b). Fig. 3(c)
shows the computed TDI using the simulated sequence—the
red colors represent motion toward the transducer and the blue
colors represents motion away from the transducer. Fig. 4 shows
application of TDIOF to simulated data and comparison with
ground truth. Angular and magnitude error metrics were used

for validation of the proposed technique as stated in






V̂


  − V  
1


Magnitude Error =

N i,j 
V 


 



V,
V̂



1

  
Angular Error =
arc cos



N i,j 
V  . V̂  

(23)

(24)

where V and V̂ are the true and estimated displacement vectors,
respectively, and N is the total number of vectors.
To quantitatively analyze the proposed method, averaged performance of TDIOF, HS optical flow, and BM speckle tracking
are reported in Table III. The methods were applied to 14 simulated cardiac frames (one full cardiac cycle) of size 300 ×
300 × 150 pixels with and without noise. 100 slices out of the
150 simulated slices have the left ventricular cavity visible and,
therefore, can be considered as being a short-axis view slice,
since ventricular blood pool is not visible (see Fig. 3). The error
represents the angular or magnitude error averaged over all 100
slices and over all 14 temporal frames (averaged in both space
and time). Note that TDIOF was applied to 100 short-axis cross
sections of the simulated heart. Table III illustrates that TDIOF
has markedly improved performance on noisy images. Fig. 5

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

2271

TABLE III
TDIOF VERSUS HS OPTICAL FLOW AND BM SPECKLE TRACKING WHEN APPLIED TO SIMULATED IMAGES

Fig. 5.

Comparison of (a) magnitude (see (23)) and (b) angular error (see (24)) over one cardiac cycle for different techniques.

shows the magnitude and angular error over one cardiac cycle
for the three techniques—note that for each time point, the errors
have been averaged over all spatial positions and all slices. It is
evident that for all methods the errors are more pronounced in
systolic frames compared to diastolic frames. This, we believe,
is due to larger out of plane displacements causing errors for
the 2-D method. From the figure, it can also be observed that
TDIOF outperforms HS optical flow and BM speckle tracking
more significantly on noisy images.
B. Validation on In Vivo Images
The algorithm was also evaluated in a similar way using in
vivo images with 519 landmarks selected by an expert over 106
sets acquired from 23 patients (datasets A and B). Landmarks
were prominent regions in in vivo images such as speckles that
could easily be detected. Each landmark was delineated and the
center of mass of the landmark was defined to be the actual location. The average error for each of the three methods (TDIOF,
HS, and BM) applied to in vivo data was classified per segment
and is reported in Table IV. A movie that shows the motion
vectors over time is shown in movie 1.
C. Comparison of Strains From TDIOF and Tagged MRI
In this part of the study, radial and circumferential strains
derived from TDIOF, HS optical flow, and BM speckle tracking were computed from B-mode echo and were compared to
tagged MRI strains using dataset B. Anatomical landmarks such
as endocardial shape and papillary muscle locations were used
to locate the corresponding short-axis sections of the heart in
tagged MRI and echocardiography. In addition, since the papillary muscles could not be easily visualized in the tagged studies, nontagged cine MR images were used to better define the

papillary muscles locations. Despite these efforts to ensure correspondence of the data, alignment of the data based on landmarks could only be approximate (due to differences in slice
thickness and view orientation in echo and MRI), and the results reported here should only be qualitatively interpreted.
The image-derived strain values related to the same cardiac
phase and the same sections of the same patient were compared
by averaging the corresponding radial and circumferential strain
values for each of the 16 AHA segments. For alignment, the
short-axis tagged MR images were visually matched to the corresponding short axis echocardiographic images acquired from
basal, midventricular, and apical slices. Since the tag lines fade
after systole, only the first 3–4 systolic tagged frames and the
corresponding temporal extent in echo were considered in this
analysis. Furthermore, since the number of frames in echocardiography is several times that of tagged MRI (roughly 20
tagged MR frames versus 54 echocardiographic frames during the cardiac cycle), the strain fields derived from echo images were interpolated using spline interpolation to match the
systolic tagged MRI frames. Finally, 2-D strain maps from corresponding echocardiography and tagged MRI were computed
and averaged over 16 segments.
Fig. 6(a) shows B-mode and TDI images in early systole at the
high papillary muscle level of a subject. The computed motion of
the heart between these two frames is shown in Fig. 6(b) and (c)
based on HS optical flow and TDIOF, respectively. The cardiac
strain maps for the same cardiac phase and the same slice are
shown in Figs. 7 and 8. Fig. 7 compares the radial strain map with
the tagged MRI radial strain map. As expected and observed
from the tagged MRI results, the radial strains from TDIOF are
positive and gradually increase during systole. The increased
radial strain is more pronounced in AL and IL segments in both
SinMod-derived and TDIOF strain maps. The increased radial

2272

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

TABLE IV
COMPARISON OF DISPLACEMENT ERRORS FOR TDIOF, HS OPTICAL FLOW, AND BM SPECKLE TRACKING ON 17 AHA SEGMENTS AVERAGED
OVER 23 PATIENT DATASETS

strain is also prominent in the AS and IS segments. Fig. 8 shows
the circumferential strain map compared to the tagged MRI
circumferential strain map. As expected and observed from the
tagged MRI results, the circumferential strains from TDIOF are
negative and gradually increase in magnitude during systole.
This increase is more pronounced in AL and ANT segments in
both SinMod tagged MRI-derived and TDIOF strain maps.
To compare the performance of TDIOF and HS, statistical
analysis of the strain map results are helpful. Fig. 9 shows correlation studies of the radial and circumferential strain values
compared to tagged MRI. The correlation coefficient (r) for
the TDIOF radial strain values compared to the tagged MRI
radial strain values was 0.83 (P < 0.001), while the correlation coefficient (r) for the HS and BM radial strain values
compared to the tagged MRI radial strain values was 0.71
(P < 0.001) and 0.75 (P < 0.001), respectively. The correlation
coefficient (r) for the TDIOF circumferential strain values compared to the tagged MRI circumferential strain values was 0.86
(P < 0.001), while the correlation coefficient (r) for the HS and
BM circumferential strain values compared to the tagged MRI
circumferential strain values was 0.77 (P < 0.001) and 0.79
(P < 0.001). Therefore, it may be concluded that for both radial
and circumferential strains, TDIOF analysis achieves a more
significant correlation with the tagged MRI in comparison to
HS and BM analyses. This effect is believed to be due to the
additional Doppler term that is added to the TDIOF framework. The comparison of TDIOF and HS radial strain using
student t-test showed superiority of TDIOF (95% confidence interval, P < 0.001). Similarly, the comparison of TDIOF and HS

circumferential strain using student t-test showed superiority of
TDIOF (95% confidence interval, P < 0.001). The comparison of TDIOF and BM radial strain using student t-test was
statistically meaningful (95% confidence interval, P < 0.001).
The comparison of TDIOF and BM circumferential strain using
student t-test was prominent as well (95% confidence interval,
P < 0.001).
D. In Vivo Comparison of TDIOF-Derived Strains
With Strains From iE33 Q-lab
Ten patients of the dataset were analyzed using both TDIOF
and Philips iE 33 Q-lab speckle tracking methods. The strain
values were averaged for each longitudinal four-chamber and
three-chamber cardiac segment. Averaged cardiac strain values
derived from TDIOF were compared to the strain values derived
from iE33 STE. However, iE 33 Q-lab techniques are based
on B-mode images and, theoretically, cannot produce TDIOF
results. Therefore, iE 33 strain values cannot be considered
ground truth for this technique but may illustrate how combined
B-mode/TDI correlates with pure B-mode motion estimation.
Fig. 10(a) shows different segments of one subject and Fig. 10(b)
shows the averaged segmental strain curved derived from iE 33
and TDIOF. The correlation between the TDIOF strains and
iE 33 Q-lab strain values showed a high degree of correlation
between the two methods. The correlation between the averaged
segmental strain values of the two methods is shown in Fig. 11.
The correlation of the results using the fusion method was 0.76
(P < 0.001) compared to the STE.

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

2273

Fig. 6. (a) Short-axis B-mode image at the high papillary muscle level of a subject during early systole compared to TDI image for the same phase. (b) HS
motion field for the same phase and in the same subject as (a). (c) Corresponding TDIOF motion field. (d) Tagged MRI motion field for the same approximate
slice location in systole (antero-septal (AS), anterior (ANT), infero-lateral (IL), infero-lateral (IL), posterior (P), inferior (INF), and infero-septal (IS).

Fig. 7. (Top row) Lagrangian radial strain maps computed from BM. (Middle row) Lagrangian radial strain maps computed from TDIOF. (Lower row) Lagrangian
radial strain maps computed with SinMod from tagged MRI during the same cardiac phase at the high papillary muscle level in one subject. (Antero-septal (AS),
anterior (ANT), infero-lateral (IL), antero-lateral (AL), posterior (P), inferior (IN), and infero-septal (IS).) The tagged MR images are resized to match the echo
images with respect to the size.

VI. DISCUSSION
Improved clinical diagnosis and therapy of CVDs rely on
novel techniques for measuring the regional myocardial function. Increased accuracy, even in the range of 15–20%, as has

been demonstrated in this paper, has the potential to lead to
more accurate strain values and earlier diagnosis and therapy.
Early diagnosis and treatment of heart disease is indeed crucial
for reduction of morbidity as well as mortality associated with
CVD.

2274

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

Fig. 8. (Top row) Lagrangian circumferential strain maps computed from BM. (Middle row) Lagrangian circumferential strain maps computed from TDIOF.
(Lower row) Lagrangian circumferential strain maps computed with SinMod from tagged MRI during the same cardiac phase at the high papillary muscle level
in one subject. (Antero-septal (AS), anterior (ANT), infero-lateral (IL), antero-lateral (AL), posterior (P), inferior (IN), and infero-septal (IS).) The tagged MR
images have been resized to match the echo images with respect to size.

Fig. 9. (a) TDIOF radial strain value versus tagged MRI radial strain is shown as red, while HS radial strain value versus tagged MRI radial strain value is
shown as blue stars, and BM radial strain versus tagged MRI radial strain is shown as green dots. (b) TDIOF circumferential strain value versus tagged MRI
circumferential strain is shown as red, while HS circumferential strain value versus tagged MRI circumferential strain value is shown as blue stars, and BM
circumferential strain versus tagged MRI circumferential strain is shown as green dots. For both cases, it is evident that the blue dots (HS strain values) are more
scattered compared to the tagged strain values. The plots include corresponding average strain quantities for 17 segments in eight patients over four tagged MRI
frames. The correlation coefficient (r) for the TDIOF radial strain values compared to the tagged MRI radial strain values was 0.83 (P < 0.001), while the
correlation coefficient (r) for the HS and BM radial strain values compared to the tagged MRI radial strain values was 0.71 (P < 0.001) and 0.75 (P < 0.001),
respectively. The correlation coefficient (r) for the TDIOF circumferential strain values compared to the tagged MRI circumferential strain values was 0.86 (P <
0.001), while the correlation coefficient (r) for the HS and BM circumferential strain values compared to the tagged MRI circumferential strain values was 0.77
(P < 0.001) and 0.79 (P < 0.001). Since apex is excluded, we have 16 (segments) × 8 (patients) × 4 (tagged MRI frames) = 512 points for each technique.

Fig. 10. (a) Strain curves for different long-axis cardiac segments using iE 33 STE in a patient in set A (normal echocardiography and normal cardiac nuclear
scan). (b) Strain curves for different long-axis cardiac segments using the fusion technique in the same patient.

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

Fig. 11. Correlation value of the in vivo longitudinal strain derived from the
TDIOF fusion method with echo-machine derived strain in ten patients imaged
in four-chamber and three-chamber views.

2275

cumferential strains increase over the cardiac systole, while the
heart is contracting and peaks at end systole and, then, as the
heart recoils back to the original length the cardiac strain decreases to about 0 at end diastole. It should be noted that the
strain values for TDIOF and tagged MRI are not exactly the
same because it is not possible to perfectly align the images
in space and time due to differences in image slice thickness,
resolution, and precise image orientation. Unfortunately, we did
not have access to Philips iE 33 raw RF to analyze the effect
of TDI term, when used as part of RF-based motion estimation.
However, we believe the additional TDI term will prove useful in
ultrasound-based motion estimation techniques, including when
RF is available.
A. Comparison With Previous Work

In order to increase the accuracy of motion estimation and
speckle tracking techniques and to overcome the angle dependence of TDI, in this paper, fusion of the two techniques were
proposed. TDIOF makes use of the combination of B-mode
and Doppler energy terms, minimized using linear algebraic
methods. To show the superiority of TDIOF, two approaches to
validation were utilized.
1) Manual tracking by an expert in echocardiography images:
The proposed method has less averaged error in different
cardiac segments as shown in Table IV. Depending on the
cardiac segment, it was shown that TDIOF increased the
accuracy of motion estimation by 15–20%.
2) Correlation with tagged MRI: In order to compare the
similarity between the two modalities, in a correlative
patient study, the proposed technique was quantitatively
compared to tagged MRI. It was shown that in comparison to HS and BM methods, TDIOF correlated more
significantly with tagged MRI (see Fig. 9). Although we
have demonstrated that the additional Doppler term is able
to increase the accuracy of the intensity (B-mode)-based
methods in tracking the left-ventricular wall motion, the
additional Doppler term may very well be added to other
cardiac ultrasound image registration techniques and we
expect a corresponding improvement in performance. As
demonstrated in the simulation study, the improvement
in performance is more pronounced on noisy images. We
hypothesize that TDI and B-mode contribute to each other
in the presence of noise in the TDIOF framework. While
the B-mode image is noisy and incoherent compared to
the general cardiac motion, Doppler data drive the motion
vectors more effectively. Contrarily, when TDI is noisy, Bmode-based motion is coherent with the rest of the cardiac
motion and is more prominent.
TDIOF had better performance when compared to HS and
BM in simulated and in vivo data. Due to increased thickness
of the wall, the results were better in midventricular slices for
all three methods. Nevertheless, results at the basal and apical
slices were still acceptable. Due to poor acquisition at the apical sections, results for apical segments were not as good for
all three techniques. Similarly, in comparison to HS and BM,
results from TDIOF correlated more significantly with tagged
MRI. It is evident from Figs. 7 and 8 that both radial and cir-

A comparison of correlative strain results for TDIOF reported
in this paper can further illustrate the performance of the proposed technique. In [40], a comparison of MRI-derived strains
and speckle tracking-derived strains was reported. The authors
collected data in patients using a commercially available system (Vivid 7, GE Vingmed Ultrasound AS, Horten, Norway) and
performed offline analysis (EchoPac BT04, GE Vingmed Ultrasound AS). Subsequently, the same group of patients underwent
tagged MRI scan and HARP offline analysis to determine the
regional strains. The correlation between radial strain based on
B-mode speckle tracking and tagged MRI was reported to be
r = 0.60 (P < 0.001), while the correlation between circumferential and longitudinal strain values based on B-mode speckle
tracking and tagged MRI was reported to be r = 0.51 (P <
0.001) and r = 0.64 (P < 0.001). The authors concluded that
there is a modest correlation between echocardiographic and
tagged-MRI-derived strains.
B. Limitations
The present study has several limitations that should be stated.
Due to hardware limitations, in current systems, TDI and Bmode images cannot be acquired at exactly the same time point,
even if data capture is in the simultaneous mode. In fact, ultrasound pulses for B-mode image forming and TDI are interleaved
and depending on the specific approach to interleaving, the acquisition delay between B-mode and TDI images may vary. Despite this limitation, in a breath-hold acquisition, TDI images
are close to the B-mode images and the acquisition difference
is in the microsecond range, with both images being acquired in
15–20 ms (depending on heart rate, frame rate, etc.). Therefore,
TDIOF could potentially miss transient cardiac events that are
“very short-lived.” As another limitation, at this time it is not
possible to extend TDIOF to three dimensions because TDI is
only possible in two dimensions. The out-of-plane heart motion
contributes to the 2-D TDIOF magnitude and angular errors;
if and when 3-D Doppler were to become commercially available, combination of 3-D Doppler with B-mode could help to
further reduce the tracking errors. Another limitation is lack of
availability of ground truth applicable to in vivo images which
makes the validation more difficult. Tagged MRI is a good surrogate but it is not perfect. Tagged MRI slices do not exactly

2276

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 8, AUGUST 2014

overlap on echocardiographic slices and there is no accurate
pixel to pixel mapping from the cardiac tissue in tagged MRI
to the cardiac tissue in echocardiography. In addition, the orientation of the ultrasound transducer is not exactly the same
as image orientation in tagged MRI. Furthermore, echocardiography and tagged MRI have different resolutions in space and
time. An additional potential issue is that MRI and echocardiography cannot be performed simultaneously. In our study,
since MRI was performed immediately after echocardiography,
the cardiac physiologic changes are felt to be less significant.
However, heart rate variability may cause alignment problems
between the images. We attempted to overcome these issues by
careful image acquisition and matching of the slices in space
and time.
VII. CONCLUSION
In order to increase the accuracy of the speckle tracking technique and to cope with the angle dependence of TDI, a combined
approach dubbed TDIOF has been proposed. TDIOF is formulated based on the combination of B-mode and Doppler energy
terms minimized using linear algebraic methods. TDIOF was
validated extensively based on simulated images and in vivo
data. The performance of TDIOF was demonstrated to be better
than popular motion estimation and speckle tracking techniques
in echocardiography.
REFERENCES
[1] D. L. Kasper, E. Braunwald, and A. Fauci, Harrison’s Principles of Internal Medicine, 17th ed. New York, NY, USA: McGraw-Hill, 2008.
[2] V. Fuster, R. O’Rourke, R. Walsh, and P. Poole-Wilson, Hurst’s the Heart,
12th ed. New York, NY, USA: McGraw Hill, 2007.
[3] V. Tavakoli and A. Amini, A Survey of Shaped-Based Registration and
Segmentation Techniques for Cardiac Images, Computer Vision and Image
Understanding, vol. 117, no. 9, pp. 966–989.
[4] V. Tavakoli and A. Amini, The effect of PSF spatial-variance and nonlinear
transducer geometry on motion estimation from echocardiography, SPIE
Medical Imaging, vol. 79651K, pp. 79651–11, 2011.
[5] W. R. Hedrick, D. L. Hykes, and D. E. Starchman, Ultrasound Physics
and Instrumentation, 4th ed. Chicago, IL, USA: Mosby, 2004.
[6] M. Suhling, A. Arigovindan, C. Jansen, P. Hunziker, and M. Unser, “Myocardial motion analysis from B-mode echocardiograms,” IEEE Trans.
Image Process., vol. 14, no. 4, pp. 525–553, Apr. 2005.
[7] W. Yu, P. Yan, A. Sinusas, K. Thiele, and J. S. Duncan, “Towards pointwise motion tracking in echocardiographic image sequences—Comparing
the reliability of different features for speckle tracking,” Med. Image Anal.,
vol. 10, no. 4, pp. 495–508, 2006.
[8] N. Paragios, “A level set approach for shape-driven segmentation and
tracking of the left ventricle,” IEEE Trans. Med. Imag., vol. 22, no. 6,
pp. 773–776, Jun. 2003.
[9] D. Hayat, M. Kloeckner, J. Nahum, E. Ecochard-Dugelay, J. L. DuboisRande, D. Jean-Francois, P. Guéret, and P. Lim, “Comparison of realtime three-dimensional speckle tracking to magnetic resonance imaging in
patients with coronary heart disease,” Amer. J. Cardiol., vol. 109, pp. 180–
186, 2012.
[10] A. Elen, H. F. Choi, D. Loeckx, H. Gao, P. Claus, P. Suetens, F. Maes, and
J. D’hooge, “Three-dimensional cardiac strain estimation using spatiotemporal elastic registration of ultrasound images: A feasibility study,”
IEEE Trans. Med. Imag., vol. 27, no. 11, pp. 1580–1591, Nov. 2008.
[11] K. Y. Esther Leung, M. G. Danilouchkine, M. van Stralen, N. de Jong,
A. F. W. van der Steen, and J. G. Bosch, “Probabilistic framework for
tracking in artifact-prone 3D echocardiograms,” Med. Image Anal.,
vol. 14, no. 6, pp. 750–758, 2010.

[12] A. Myronenko and X. Song, “Point set registration: Coherent point drift,”
IEEE Trans. Pattern Anal. Mach. Intell., vol. 32, no. 12, pp. 2262–2275,
Dec. 2010.
[13] N. Duchateau, M. De Craene, G. Piella, E. Silva, A. Doltra, M. Sitges,
B. H. Bijnens, and A. F. Frangi, “A spatiotemporal statistical atlas of
motion for the quantification of abnormal myocardial tissue velocities,”
Med. Image Anal., vol. 15, no. 3, pp. 316–328, 2011.
[14] N. Bachner-Hinenzon, O. Ertracht, M. Lysiansky, O. Binah, and D. Adam,
“Layer-specific assessment of left ventricular function by utilizing wavelet
de-noising: A validation study,” Med. Biol. Eng. Comput., vol. 49, no. 1,
pp. 3–13, 2011.
[15] I. Dydenko, F. Jamal, O. Bernard, J. D’hooge, I. E. Magnin, and
D. Friboulet, “A level set framework with a shape and motion prior for segmentation and region tracking in echocardiography,” Med. Image Anal.,
vol. 10, no. 2, pp. 162–177, 2006.
[16] P. Yan, A. Sinusas, and J. S. Duncan, “Boundary element method-based
regularization for recovering of LV deformation,” Med. Image Anal.,
vol. 11, no. 6, pp. 540–554, 2007.
[17] M. De Craene, G. Piella, O. Camara, N. Duchateau, E. Silva, A. Doltra,
J. D’hooge, J. Brugada, M. Sitges, and A. Frangi, “Temporal diffeomorphic free form deformation application to motion and strain estimation
from 3D echocardiography,” Med. Image Anal., vol. 16, no. 2, pp. 427–
450, 2012.
[18] M. Ashraf, A. Myronenko, T. Nguyen, A. Inage, W. Smith, R. I. Lowe,
K. Thiele, C. A. Gibbons Kroeker, J. V. Tyberg, J. F. Smallhorn,
D. J. Sahn, and X. Song, “Defining left ventricular apex-to-base twist mechanics computed from high-resolution 3D echocardiography: Validation
against sonomicrometry,” JACC Cardiovasc. Imag., vol. 3, pp. 227–234,
2010.
[19] X. Papademetris, A. J. Sinusas, P. Dione, R. T. Constable, and
J. S. Duncan, “Estimation of 3-D left ventricular deformation from medical images using biomechnical models,” IEEE Trans. Med. Imag., vol. 21,
no. 7, pp. 786–800, Jul. 2002.
[20] X. Papademetris, A. J. Sinusas, D. P. Dione, and J. S. Duncan, “Estimation
of 3D left ventricular deformation from echocardiography,” Med. Image
Anal., vol. 5, no. 1, pp. 17–28, 2001.
[21] S. A. Kleijn, W. P. Brouwer, M. F. Aly, I. K. Russel, G. J. de Roest,
A. M. Beek, A. C. van Rossum, and O. Kamp, “Comparison between
three-dimensional speckle-tracking echocardiography and cardiac magnetic resonance imaging for quantification of left ventricular volumes and
function,” Eur. Heart J. Cardiovasc. Imag., vol. 13, pp. 834–839, 2012.
[22] D. Garcia, J. C. del Álamo, D. Tanne, R. Yotti, C. Cortina, E. Bertrand,
J. C. Antoranz, E. Perez-David, R. Rieu, F. Fernandez-Aviles, and
J. Bermejo, “Two-dimensional intraventricular flow mapping by digital
processing conventional color-Doppler echocardiography images,” IEEE
Trans. Med. Imag., vol. 29, no. 10, pp. 1701–1713, Oct. 2010.
[23] H. Dalen, A. Thorstensen, S. A. Aase, C. B. Ingul, H. Torp, L. J. Vatten,
and A. Stoylen, “Segmental and global longitudinal strain and strain rate
based on echocardiography of 1266 individuals: The HUNT study in
Norway,” Eur. J. Echocardiography, vol. 11, no. 2, pp. 76–83, 2010.
[24] B. H. Amundsen, J. Crosby, P. A. Steen, H. Torp, S. A. Slordahl, and
A. Stoylen, “Regional myocardial long-axis strain and strain rate measured by different tissue Doppler and speckle tracking echocardiography
methods: A comparison with tagged magnetic resonance imaging,” Eur.
J. Echocardiography, vol. 10, pp. 229–237, 2009.
[25] C. Liu, “Beyond pixels: Exploring new representations and applications
for motion analysis,” Ph.D. dissertation, Dept. Elect. Eng. Comput. Sci.,
Massachusetts Inst. Technol., Cambridge, MA, USA, May 2009.
[26] S. Geman and D. E. McClure, “Statistical methods for tomographic image
reconstruction,” Bull. Int. Statist. Int., vol. 52, pp. 5–21, 1987.
[27] B. K. P. Horn and B. G. Schunck, “Determining optical flow,” Artif. Intell.,
vol. 17, pp. 185–203, 1981.
[28] M. D. Abolhassani and V. Tavakoli, “Optimized thermal change monitoring in renal tissue during revascularization therapy,” J. Ultrasound Med.,
vol. 28, no. 11, pp. 1535–1547, 2009.
[29] R. Jasaityte, B. Heyde, and J. D’hooge, “Current state of three-dimensional
myocardial strain estimation using echocardiography,” J. Amer. Soc.
Echocardiography, vol. 26, no. 1, pp. 15–28, 2013.
[30] V. Tavakoli, J. Kemp, B. Dawn, M. Stoddard, and A. A. Amini, “Comparison of myocardial motion estimation methods based on simulated echocardiographic B-mode and RF data,” Proc. SPIE Med. Imag., vol. 7626,
pp. 76260-1–76260-12, 2010.
[31] H. Gao, H. F. Choi, P. Claus, and S. Boonen, “A fast convolution-based
methodology to simulate 2-D/3-D cardiac ultrasound images,” IEEE

TAVAKOLI et al.: TISSUE DOPPLER IMAGING OPTICAL FLOW (TDIOF): A COMBINED B-MODE AND TISSUE DOPPLER APPROACH

[32]
[33]
[34]

[35]
[36]

[37]
[38]
[39]
[40]

Trans. Ultrason., Ferroelectr., Freq. Control, vol. 56, no. 2, pp. 404–409,
Feb. 2009.
T. Arts, W. C. Hunter, A. Douglas, A. M. M. Muijtjens, and
R. S. Reneman, “Description of the deformation of the left ventricle by a
kinematic model,” J. Biomech., vol. 25, no. 10, pp. 1119–1127, 1992.
J. A. Jensen, “A model for the propagation and scattering of ultrasound in
tissue,” J. Acoust. Soc. Amer., vol. 89, pp. 182–191, 1991.
J. A. Jensen and N. B. Svendsen, “Calculation of pressure fields from
arbitrarily shaped, apodized, and excited ultrasound transducers,” IEEE
Trans. Ultrason., Ferroelectr., Freq. Control, vol. 39, no. 2, pp. 262–267,
Mar. 1992.
A. Amini and J. Prince (Eds), Measurement of Cardiac Deformations From
MRI: Physical and Mathematical Models. Dordrecht,, The Netherlands:
Kluwer, 2001.
T. Arts, F. W. Prinzen, T. Delhaas, J. Milles, A. Rossi, and P. Clarysse,
“Mapping displacement and deformation of the heart with local sine wave
modeling,” IEEE Trans Med. Imag., vol. 29, no. 5, pp. 1114–1123, May
2010.
ASE Guidelines and Standards—American Society of Echocardiography
(2009). [Online]. Available: www.asecho.org/guidelines/
N. J. Tustison, V. G. D. Roman, and A. A. Amini, “Myocardial kinematics
from tagged MRI based on a 4-D B-spline Model,” IEEE Trans. Biomed.
Eng., vol. 50, no. 8, pp. 1038–1040, Aug. 2003.
N. J. Tustison and A. A. Amini, “Biventricular myocardial strains via
nonrigid registration of anatomical NURBS models,” IEEE Trans. Med.
Imag., vol. 25, no. 1, pp. 94–112, Jan. 2006.
G. Y. Cho, J. Chan, R. Leano, M. Strudwick, and T. H. Marwick, “Comparison of two-dimensional speckle and tissue velocity based strain and
validation with harmonic phase magnetic resonance imaging,” Amer. J.
Cardiol., vol. 97, no. 11, pp. 1661–1666, 2006.

Vahid Tavakoli joined a joint degree track of
Medicine and Biomedical Engineering in 1998 at the
Isfahan University of Medical Science, Isfahan, Iran.
He received the M.S. degree in biomedical engineering from the Tehran University of Medical Science,
Tehran, Iran, in 2007.
He joined the Electrical Engineering Department,
University of Louisville, Louisville, KY, USA, and
continued his research on cardiac motion detection
using image processing techniques. He is currently
a Researcher in the Department of Radiology, Yale
University, New Haven, CT, USA.
Dr. Tavakoli received the University of Louisville Outstanding Graduate
Student Award and the University of Louisville Dean’s Citation Award and was
chosen as AHA-NASCI Young Investigator finalist. He has served as a Reviewer
in several reputable journals and as a Co-Chair in IEEE-EMBS conference.

Nirman Bhatia received the Graduation degree from
the Maulana Azad Medical College, Delhi University, New Delhi, India. He completed a research
internship from the MD Anderson Cancer Center,
Houston, TX, USA, before joining the University of
Louisville, Louisville, KY, USA, for training in Internal Medicine. He is currently a third year Internal Medicine resident at the University of Louisville.
He currently works with Dr. Marcus Stoddard in the
Echocardiography Laboratory at the University of
Louisville and is investigating the role of intrapulmonary shunts in cryptogenic strokes, early detection of diastolic dysfunction,
and improving accuracy of noninvasive measurement of aortic stenosis.
He will continue his training as a Cardiovascular Medicine Fellow at Vanderbilt University in 2014. He has a keen interest in cardiovascular research,
especially in cardiac imaging, cardio-oncology and cardiovascular outcomes
research.

2277

Rita A. Longaker received the certification in echocardiography from university
of Louisville in 1981. She is a Registered Certified Technician and Research
Sonographer. She is a Senior Research Coordinator. She has more than 60
manuscripts and abstracts published in peer review journals.

Marcus F. Stoddard received the MD from Johns
Hopkins University, School of Medicine in 1982.
He continued his education as a resident of internal medicine and fellow of cardiology in St. Louis
University Hospital. He is a Professor of Medicine
in the Division of Cardiovascular Medicine at the
University of Louisville, Louisville, KY, USA. He is
Director of noninvasive cardiology. He is certified in
internal medicine, cardiovascular diseases, echocardiography, nuclear cardiology, and cardiac computed
tomography. He has published more than 200 articles
and abstracts in peer review journals.

Amir A. Amini (M’82–SM’97–F’07) received the
B.S. degree in electrical engineering with honors
from the University of Massachusetts at Amherst,
Amherst, MA, USA, in 1983, where at 18 he was
the youngest member of his graduating class. He received the M.S. and Ph.D. degrees also in electrical
engineering from the University of Michigan, Ann
Arbor, MI, USA, in 1984 and 1990, respectively.
He is currently a Professor and Endowed Chair
in bioimaging with secondary appointments in radiation oncology and cardiology at the University of
Louisville, Louisville, KY, USA, where he leads the Medical Imaging Laboratory and performs research in the area of image-based mechanics for assessment
of cardiovascular and pulmonary functions. His prior faculty appointments were
at Yale (1992–1996) and Washington University in St. Louis (1996–2006).
Dr. Amini received the National Institutes of Health FIRST Award in 1998
and University of Louisville Delphi Center for Teaching and Learning Faculty
Favorite Award for his course on medical imaging. He served as the General Chair of SPIE Medical Imaging Conference on Physiology, Function, and
Structure from Medical Images between 2002 and 2006 and co-chaired the
SPIE Medical Imaging Symposium in 2007. He is on the editorial board of
IEEE TRANSACTIONS ON MEDICAL IMAGING and Computerized Medical Imaging and Graphics and is a Distinguished Lecturer of the IEEE Engineering in
Medicine and Biology Society.

