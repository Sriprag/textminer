IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

539

Virtual MEG Helmet: Computer Simulation of an
Approach to Neuromagnetic Field Sampling
Mordekhay Medvedovsky, Jukka Nenonen, Alexandra Koptelova, Anna Butorina, Ritva Paetau, Jyrki P. Mäkelä,
Antti Ahonen, Juha Simola, Tomer Gazit, and Samu Taulu

Abstract—Head movements during an MEG recording are commonly considered an obstacle. In this computer simulation study,
we introduce an approach, the virtual MEG helmet (VMH), which
employs the head movements for data quality improvement. With a
VMH, a denser MEG helmet is constructed by adding new sensors
corresponding to different head positions. Based on the Shannon’s
theory of communication, we calculated the total information as
a figure of merit for comparing the actual 306-sensor Elekta Neuromag helmet to several types of the VMH. As source models, we
used simulated randomly distributed source current (RDSC), simulated auditory and somatosensory evoked fields. Using the RDSC
model with the simulation of 360 recorded events, the total information (bits/sample) was 989 for the most informative single head
position and up to 1272 for the VMH (addition of 28.6%). Using
simulated AEFs, the additional contribution of a VMH was 12.6%
and using simulated SEF only 1.1%. For the distributed and bilateral sources, a VMH can provide a more informative sampling
of the neuromagnetic field during the same recording time than
measuring the MEG from one head position. VMH can, in some
situations, improve source localization of the neuromagnetic fields
related to the normal and pathological brain activity. This should
be investigated further employing real MEG recordings.
Index Terms—Internal magnetostatic multipole moments, magnetoencephalography, total information, virtual MEG helmet
(VMH).

Manuscript received August 23, 2014; revised November 12, 2014; accepted
January 8, 2015. Date of publication January 19, 2015; date of current version March 3, 2016. The work M. Medvedovsky was supported by Elekta
Instrument AB/HI2838, Stockholm Sweden and by a Grant for project development by HUSLAB MLE82TK005, Helsinki Finland, 2007–2009, and the work
of T. Gazit was supported by the European Union ACTIVE Grant FP7-ICT2009-270460. The Moscow MEG-Center was supported by The Ministry of
Education and Science of Russian Federation (Grant RFMEF161914×0006).
M. Medvedovsky and J. Nenonen contributed equally to this paper.
M. Medvedovsky is with the Brain Function Imaging Unit, Tel-Aviv Sourasky
Medical Center, 64239 Tel-Aviv, Israel and also with BioMag Laboratory, HUS
Medical Imaging Center, University of Helsinki and Helsinki University Hospital, 00029 Helsinki, Finland (e-mail: mamedvedovsky@gmail.com).
J. Nenonen, A. Ahonen, and J. Simola are with the Elekta Oy, 00531 Helsinki,
Finland (e-mail: jukka.nenonen@elekta.com; antti.ahonen9@gmail.com
juha.simola@elekta.com).
A. Koptelova and A. Butorina are with the Center of Neurocognitive Research
(MEG-center), Moscow State University of Psychology & Education, Moscow
127051, Russia (e-mail: koptelova.am@gmail.com; armature@yandex.ru).
R. Paetau is with the Department of Pediatric Neurology and also with
the Department of Clinical Neurophysiology, HUS Medical Imaging Centre,
HUS/HUCH , FIN-00029 Helsinki, Finland (e-mail: ritva.paetau@hus.fi).
J. P. Mäkelä is with the BioMag Laboratory, HUS Medical Imaging Center,
University of Helsinki and Helsinki University Hospital, FI-00029 Helsinki,
Finland (e-mail: jyrki.makela@hus.fi).
T. Gazit is with the Brain Function Imaging Unit, Tel-Aviv Sourasky Medical
Center, 64239 Tel-Aviv, Israel (e-mail: tomergazit@gmail.com).
S. Taulu is with the Institute for Learning and Brain Sciences and Department
of Physics, University of Washington, Seattle, WA 98195-58552 USA and also
with Elekta Oy, FIN-00531 Helsinki, Finland (e-mail: staulu@uw.edu).
Digital Object Identifier 10.1109/JBHI.2015.2392785

Fig. 1. Virtual MEG helmet construction. Upper row—translation. Lower
row—rotation.

I. INTRODUCTION
RAIN electrical activity is one of the most complex phenomena in human biological and medical research. To
characterize this activity, the selected imaging technique should
have as many independent information channels as possible.
The modern MEG devices measure weak magnetic fields with
hundreds of sensors. Nevertheless, the magnetic field sampling
using even whole head MEG systems can be improved further.
Nurminen et al. [1], [2] demonstrated in both simulations and
experimental studies that the quality of data can be improved by
supplementing, e.g., the 306-sensor MEG device (Elekta Neuromag, Elekta Oy, Finland), device with more sensors at different
angles and at different layers. Adding such sensors, however,
unavoidably increases device complexity and cost.
Alternatively, the number of sensors can be increased virtually
by reconstructing an MEG helmet from different head positions
and interpolating the recorded data. A change in head position
within a static sensor array can be equivalently regarded as a
change in sensor array position over a static head (see Fig. 1).
If activity from the same sources is recorded in different head
positions, this allows a virtual increase of the number of sensors
by a factor of the number of head positions. We called this
approach the virtual MEG helmet (VMH).
The influence of the MEG array sensor number (array density)
on the source localization accuracy was studied by Vrba et al.
[3]; it was demonstrated that equivalent current dipole (ECD)
source localization does not improve further when more than
100–200 sensors are added to the array. When beamformer was
used instead of ECD, addition of up to thousands sensors still
improved the source localization accuracy. Notably, with VMH
the increase in sensor number is expressed not only in higher

B

2168-2194 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

540

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

density of sensor array, but also in higher variability in the
sensor locations and directions: the VMH sensors are “placed”
at different layers and at different angles (see Fig. 1), which
potentially can enrich the neuromagnetic field sampling.
The disadvantage of the VMH is higher channel noise level
compared with recording the same number of events in one head
position. When MEG signals are measured in one head position,
there are more events for averaging than when the signals from
different head positions are used for the VMH construction. If g
is the number of events, then in a single head position, averaging
√
of g events reduces random noise by g. However, for the VMH
construction, signals recorded in h different head positions are
not averaged. If the events are equally distributed between head
positions, the number
of VMH averages is g/h and the noise

suppression is g/h. Hence, comparing VMH and single head
position recording, two oppositely directed tendencies can be
observed.
1) The VMH possibly increases the number of independent
MEG channels (increase of the forward model matrix
rank).
√
2) The VMH is associated with h times less efficient noise
suppression, where h is the number of head positions and
the recorded events are evenly distributed between recordings in different head positions.
The question addressed by this study is whether recording the
same brain activity in different head positions and subsequent
interpolation of the recorded data (VMH approach) can improve the data quality compared to recording the same number
of events in one head position. In order to evaluate this question, we employed the total information calculation (Shannon’s
channel capacity [4]), assessing the merit of the different MEG
sensor arrays [5], which was performed in two ways: 1) sensor
level orthogonalization (SLO) of the lead fields [5] and 2) internal magnetostatic multipole moments (IMMM) signal-to-noise
ratio (SNR). The IMMM SNR was calculated after modeling
the magnetic field by a spherical harmonic vector basis, as implemented in the signal space separation (SSS) method [6].
The idea of virtual reconstruction of the brain magnetic field
is not new. During the 1980s, MEG devices contained only one
or a few channels, and the same brain activity was recorded several times, changing the position of the sensor relative to head.
For example, Barth et al. [7] recorded several stereotypic epileptic interictal spikes in a patient with focal epilepsy by changing the position of one-sensor MEG device, and later, reported
source localization of stereotypic epileptic seizures recorded in
the same way [8]. Simultaneously recorded EEG was used to
confirm the similarity of the brain activations for MEG signal
interpolation. With the development of whole head MEG devices [9], the measurements were generally performed in one
stable head position. In this paper, we are testing the hypothesis
that changing the head position with respect to the whole head
MEG sensor array, still can add information.
It is important to note that the spatial source (and signal) stability is essential for the applicability of the VMH. A VMH can
be used with the spatiotemporally stable, especially externally
triggered data, such as evoked responses. A VMH cannot be
applied to spatiotemporally unstable data, which is often, but

probably not always, the case with the spontaneous activity. It
is clear that a VMH is not suitable for single event analysis.
A preliminary version of this study has been presented as an
abstract [10].
II. METHODS
A. Total Information Calculated Using SLO of Lead Fields
According to Shannon’s theory of communication, if the signal b(t) and the noise noise(t) are normally distributed and independent, the total information (Inftot ) provided by the single
noisy channel can be described as:
Inf tot = 1/2log2 (P + 1)

(1)

where P is the power SNR of the single channel. Then, the total
information provided by the system of m independent channels
can be represented as
Inf tot = 1/2

m


log2 (Pn + 1)

(2)

n =1

where Pn is the power SNR of each independent channel.
Thereby, an increase of the number of independent channels
will increase the total information, whereas increase of noise
will decrease it. The total information of MEG sensor arrays
was first suggested by Kemppainen and Ilmoniemi [5], and later
studied by Nenonen et al. [11], [12]. All these studies used the
assumption that the source current and the noise are randomly
distributed. This is actually a simplification, because in the reality neither the source current nor noise is distributed completely
randomly. In this study, we use the term “randomly distributed
source current” (RDSC) for this type of source model.
The source was assumed to be distributed throughout the
spherical brain model with a radius of 8 cm.
In a multichannel array, the coupling of channel n is quantified
in terms of the lead field Ln , according to

bn = Ln (r ) · jp (r ) dv 
(3)
where r’ is a vector, which indicates location of the neural
source, the center of the coordinate system is located at the center
of spherical conductor; jp (r’) is the primary current density
vector at r’; and v’ is a spherical conductor volume.
As in previous works dealing with total information of MEG
systems (see [5], [11], and [12]), in this study, we assume that
no a priori information of the sources exists, and that the primary currents have a Gaussian distribution, jp ∼ N(0, sp 2 ). In
addition, the noise is also assumed Gaussian, noisen ∼ N(0,
σ n 2 ). Thus, the power SNR for channel n is
Pn = ||Ln ||2 s2 /σn2 .

(4)

As stated, the total information, Inftot , can be evaluated as a
sum of log2 (Pn + 1) over independent channels. Because the
lead fields of the sensors are overlapping, sensor measurements
are dependant, and hence, the data must be orthogonalized.
For this purpose, a lead field product matrix (gram matrix) is

MEDVEDOVSKY et al.: VIRTUAL MEG HELMET: COMPUTER SIMULATION OF AN APPROACH TO NEUROMAGNETIC FIELD SAMPLING

constructed according to

Gj k = Lj (r ) · Lk (r ) dv  .

(5)

Next, we apply singular value decomposition of G according
to G = U SU T , S = diag(λ1 , λ2 , . . . λm ), where the columns
of matrix U are the eigenvectors and λn are the eigenvalues of
G. The orthogonalized lead fields become Ln ’ = U T Ln and the
orthogonalized SNR becomes

Pn = λn s2 /
(Un j σj )2 .
(6)
j

The total information of the m-channel magnetometer per
sample is thus
Inf tot = 1/2

m


log2 (Pn + 1) .

(7)

n =1

In the simulations, the nonaveraged
root mean square (RMS)
√
noise level
was
set
to
30
fT/
Hz
for
magnetometers
and to 10
√
fT/cm/ Hz for planar gradiometers—representing the situation
in which the human head is inside the MEG helmet and the noise
level is dominated by brain background activity.
In our simulations, the standard deviation of primary source
current density, jp was defined√as 0.6 μA/m2 so that the magnetic
field RMS value of 100 fT/ Hz can be measured at 20 mm
outside the scalp [9].
B. Total Information Calculated Using IMMM SNR
The SSS method transforms MEG data into sets of multipole moments, which correspond to different vector spherical
harmonic functions [6]. This method, together with its temporal
extension (spatio-temporal signal space separation – tSSS [13]),
is employed in interference suppression and in head movement
compensation [14], [15]. Typically, the noise-based truncation
of the harmonic bases leads to 80 internal and 15 external basis
functions. SSS transforms the sensor-level signals of interest
and part of the random noise into internal multipole moments
and their SNR values depend on both transformed noise and
transformed signal of interest. With h head positions, there are h
times less events
√ for averaging, and therefore, the VMH channel
noise level is h times higher than with one head position. The
overall amplitude of transformed noise depends linearly on the
noise amplitude of the MEG channels of a given sensor array.
However, SSS transformation of both signal and noise is influenced by the sensor array geometry, and therefore, multipole
moments SNR can be different in VMH when compared to real
MEG array. Because SSS transformation creates an orthogonal
basis, Pn in (2) can be also the power SNR of IMMM, therefore,
it can also serve to total information computing. The calculation
of total information using IMMM SNR was described in [12].
The SSS transformation was performed for both reference
head position in the 306-sensor helmet (Stand_1) and for
three types of the VMH: VMH_comb2_3, VMH_comb3, and
VMH7_2 (see Fig. 5). The IMMMs were calculated separately
for signal of interest and for random noise. Then, SNR of IMMMs was defined as the ratio of signal multipole moments and

541

noise multipole moments for every internal spherical harmonic.
The total information was calculated using (2), where Pn is
IMMM SNR. We compared the total information calculated
using SLO and IMMM SNR approaches (see Table II). In a
first set of simulations (see IIand Fig. 5), the signal of interest
was defined as RDSC. Here, we calculated a random overall
current distribution in the brain, followed by the calculation of
the associated internal multipole moments and transformed a
sensor-level noise matrix into the internal multipole moments.
The√magnetometer noise of nonaveraged data was set
√ on 30
fT/ Hz and planar gradiometer noise – on 10 fT/cm/ Hz (the
same as in total information computing). The absolute values
of the source current and sensor noise are irrelevant as we are
studying the relative differences of the SNRs between the 306channel and VMH constructions.
The channel noise was defined
√
for 306-sensor helmet h times lower than for the VMH, where
h is number of head positions.
In addition to RDSC, we simulated the auditory evoked fields
(AEFs) and the somatosensory evoked field (SEF). We assumed that the sources of AEFs can be represented by two
equivalent current dipoles (ECDs) located bilaterally, and the
source of SEF by a single unilateral ECD. The locations and
orientations of the ECDs were defined by fitting the dipoles
using the measured data published by Nenonen et al., 2010
[16]. The location of SEF source was x = −34.9, y = 5.1,
and z = 104.4. The locations of AEF sources (head coordinates, mm) were: x = −57.0, y = 2.5, z = 64.0, and x = 54.0,
y = 10.0, z = 62.0. The
were set at 50 nAm.
√ source amplitudes
√
The √
noise was √
set at h5 fT/cm/ Hz for planar gradiometers
and h20 fT / Hz for magnetometers, where h is the number
of head positions. In order to calculate total information for AEF
and SEF, we employed the SSS method and calculated power
SNR of IMMM as in [12]. The results of the AEF and SEF
simulations are presented in two last columns of Table I and in
Fig. 2.
C. VMH Construction
Sensor locations were introduced to the model according to
the Cartesian coordinates of the 306 MEG sensor (102 magnetometers and 204 planar gradiometers) positions and directions
of the Elekta Neuromag MEG device. The sensor position was
defined as a vector from the device coordinate system origin to
the geometrical center of the sensor. The sensor orientation was
defined by three unit vectors corresponding to Cartesian x- y-,
and z-axes of the sensor coordinate system translated into the
device coordinate system origin.
In the device coordinate system, the x-axis was directed to the
right, y-axis to forward, and z-axis to upward. The virtual arrays
were constructed by MEG array displacements in the coordinate
system of the head. The head coordinate system had the origin
in the center of the spherical brain model, which was located
at x = 0, y = 0, z = −40 mm point of the device coordinate
system in the reference head position. The x-, y-, z-axes of the
head and device coordinate systems had the same directions in
the reference head position. In such position, an adult-size head
has no space to move backward or upward; this was taken into
account in constructing the virtual arrays.

542

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

TABLE I
STANDARD AND VIRTUAL MEG SENSOR ARRAYS AND HEAD POSITIONS

Ref— reference head position; xtrans — translation along axis x; ytrans—translation along axis y; ztrans— translation along axis z; xrot—rotation around axis x, yrot — rotation
around axis y; zrot — rotation around axis z. RDSC — randomly distributed source current. AEF — auditory evoked fields. SEF — somatosensory evoked fields. The direction and
size of the head displacement is indicated by the number after the displacement name; for example, “xrot-30” means rotation minus 30 degrees around axis x, or “ytrans+10” means
translation plus 10 mm along axis y. Different head positions are separated by &, and the notation for different aspects of one combined head displacement is { . . . }; for example:
{xtrans+10; xrot-30; yrot-30; zrot -30}. The head displacements are expressed as displacement of the head in terms of device coordinate system, which have opposite direction
relative to sensor array virtual displacements (in a process of VMH construction. The name Stand_ means head position in the standard MEG array, and Virt . . . means virtual MEG
array. RMS — root mean square. The RMS of magnetometer noise is calculated according to 360, 720, or 1440 events.

Fourteen different virtual sensor arrays were constructed with
sensor numbers from 306 × 2 to 306 × 7 (see Table I: arrays 5–
19). In addition, we simulated nine head positions (one reference
and eight displaced ones) using the standard 306 sensor array

alone (see Table I: arrays 1–9). The head displacements included
10-mm translations in all directions except for backward and
upward (because of physical constraints set by the helmet) and
rotations to 15–30° around all axes. Translation of the helmet

MEDVEDOVSKY et al.: VIRTUAL MEG HELMET: COMPUTER SIMULATION OF AN APPROACH TO NEUROMAGNETIC FIELD SAMPLING

543

fT 
(9)
Noisevm h = 30 √ / number of events/h
Hz
where Noise306 is the magnetometer noise level for one head
position measurement in the 306-sensor MEG helmet and
Noisevm h the corresponding noise level for VMH, and h is
the number of head positions.
The planar gradiometer noise was
√ the
√ calculated employing
same formulae but using 10 fT/cm/ Hz instead of 30 fT/ Hz.
E. Computing the Percentage of Additional Information (PAI)
PAI of array A versus array B was defined as
PAI = ([Inf totA /Inf totB ] − 1) 100%
Fig. 2. Percent of additional information (PAI) computed for head positions
indexed from 1 to 9 and for virtual arrays indexed from 10 to 23, compared with
Stand_1 and with Stand_9. The description of virtual arrays and head positions
is detailed in Table I according to array index (x-axis of the Fig. 2 corresponds
to the first column of the Table I). In the case of RDSC, the results presented in
this figure were calculated based on situation with 360 recorded events.

origin was done first, and rotations in order z-rotation, y-rotation,
x-rotation were combined into a single rotation matrix. Some
of simulated head displacements (translations downward and
forward) were in the range of the spontaneous head movements
during MEG recording reported by Wehner et al. However,
translations in the x-axis (sidewise) exceeded the range reported
in [17]: 10 mm to one side in our study and 3.7 mm standard
deviation (maximum about 5 mm to one side) in the study of
Wehner et al.
The names,indices, and features of different head positions
in both the standard array and in virtual arrays are presented in
Table I. For a single head position in the standard MEG array,
we used names Stand_1 to 9 (standard MEG array). Stand_1
corresponds to reference head position and Stand_2 to 9 correspond to displaced head positions in a standard MEG array.
For different types of virtual arrays, constructed on the basis of
more than one head position, we used the name VMH.
For construction of the different VMHs, we simulated both
simple and combined head displacements. Simple head displacement was either translation along one axis or rotation
around one axis. Combined head displacement was a head
displacement, which included the combination of more than
one simple head displacements (for example: combination of
x-translation and z-rotation) in one head position.
D. Number of Recorded Events Used for Randomly
Distributed Source Current Simulation
For randomly distributed source current simulation, we considered three situations of MEG recording with different number
of events: 1) 360 events, 2) 720 events, 3) 1440 events.
The magnetometer noise of averaged data was calculated for
the standard array and the VMH as
fT √
Noise306 = 30 √ / number of events
Hz

(8)

(10)

where InftotA is the total information obtained using array A
and InftotB using array B.
PAI was calculated for different head positions and different types of VMH versus reference head position in a standard
helmet—Stand_1 and versus displaced head position in standard helmet—Stand_5 (see Fig. 2). The noise was estimated to
correspond to 3 h recording with 360 events. With a standard
306-sensor helmet, all events were averaged together as in one
head position, whereas with VMH events recorded in different
head positions are averaged separately.
The dependence of PAI on number of events was studied
(see Fig. 3) in one displaced head position in standard helmet
[Stand_5—Fig. 3 (a)] and two types of VMH [VMH_comb3—
Fig. 3 (b) and VMH7_2—Fig. 3 (c)] compared to the reference
head position in standard helmet (Stand_1). The calculations
were performed for three clinical situations with 360, 720, and
1440 events.
Thereafter, we calculated total information provided by three
types of VMH: VMH_comb2_3, VMH_comb3, and VMH7_2
and by the reference head position in a standard helmet as a √
function of magnetometer noise with RMS from 0.1 to 20 fT/ Hz
(see Fig. 4). In this calculation, the planar gradiometer noise was
corrected proportionally to changes in magnetometer noise.
III. RESULTS
A. Essential Findings (see Fig. 2)
1) Randomly Distributed Source: With 360 events (e.g.,
epileptic spikes), the total information (bits/sample) was 989
for the most informative head position in the standard helmet
and up to 1272 for VMH (additional 28.6%); with 720 events—
1103 for the most informative single head position in standard
helmet and up to 1448 for VMH (additional 31.3%); and with
1440 events—1221 for the most informative single head position in standard helmet and 1636 for VMH (additional 34.0%).
2) Simulated AEFs: The total information provided by the
most informative head position in standard array was 360
bit/sample. By the most informative VMH, it was 406 bit/sample
(additional 12.8%).
3) Simulated SEF: The total information provided by the
most informative single head position in standard array was 437
bit/sample. By the most informative VMH, it was 442 bit/sample
(additional 1.1%)

544

Fig. 3.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

Influence of numbers of events on the additional total information contribution by: (a) Stand_8, (b) VMH_comb3, and (c) VMH7_2 compared to Stand_1.

B. Total Information: SLO With RDSC (see Table I and Fig. 2)
1) Displaced Head Positions in the Standard MEG Array
Compared to Stand_1 (see Table I Arrays 2–9, and Fig. 2):
Translation along x-axis (sidewise shift) to 10 mm (see Table I
array 5) increased slightly the total information compared with
Stand_1; the PAI was 2.3% in the situation with 360 events. Ytranslation 10 mm forward (see Table I array 6) and z-translation
10 mm downward (see Table I array 7) were associated with total information reduction; with 360 events, PAI was −9.7% and
−13.4%, respectively. The single head positions in the standard MEG array that provided the highest PAI (15.4%) were
combined displacements: x-translation to +10 mm and x-, y-,
and z-rotations to −30° (see Table I array 8 [Stand_8]); and
x-translation to −10 mm and x-, y-, and z-rotations to +30° (see
Table I array 9 [Stand_9]). Stand_8 and Stand_9 had the same
values of total information with RDSC.
2) VMH (see Table I arrays 10–23 and Fig. 2): VMH versus the most informative single head position (Stand_8 or
Stand_9). Majority of VMHs based on simple head displacements provided less total information than Stand_9 (negative
PAI). Only two categories of VMHs had positive PAI compared
with Stand_8. One was VMH with simple head displacements
to opposite directions along x-axis (20-mm distance between
head positions): VMH2_4 (see Table I array 10), VMH3_2 (see
Table I array 11), and VMH7_2 (see Table I array 15). Another
category was VMHs with combined head displacements (see
Table I arrays 20–23); all had a positive PAI
3) PAI as a Function of Number of Events (see Fig. 3):
Stand_8 demonstrated a decrease of PAI when number of events
increased (and therefore, noise decreased) from 15.4% with 360
events to 11.6% with 1440 events [difference of −3.8%, Fig. 3
(a)]. The same test for VMH_comb3 revealed PAI increase from
48.4% with 360 events to 49.5% with 1440 events [difference
of 1.1%, Fig. 3(b)]; and for VMH7_2—increase from 27.4%
with 360 events to 32.1% with 1440 events [difference of 4.7%,
Fig. 3 (c)].
4) Total Information as a Function of Magnetometer Noise
(see Fig. 4): With increase in noise, the total information decreased, as can be predicted based on (1) and (2), which is due
to decrease of P. The arrays with higher number of sensors
provided more total information with the same level of noise,
which is due to increase of m in (2) and (7).

Fig. 4. Total information provided by Stand_1 and by three types of VMH
(VMH_comb2_3, VMH_comb3, VMH7_2) as a function of root mean square
of the magnetometer noise. The planar gradiometer noise in not shown, but it
was corrected in proportion to the change of magnetometer noise.

TABLE II
TOTAL INFORMATION: INTERNAL MAGNETOSTATIC MULTIPOLE MOMENTS
VERSUS SLO

TIIM M M
TISLO
PAIIM M M
PAISLO

Stand 1

VM H7 2

VM H comb2 3

VM H comb3

831
857

980
1092
17.9%
27.4%

1190
1256
43.2%
46.5%

1156
1272
34.9%
48.4%

TIIMMM denotes Total Information calculated using IMMM. TISLO denotes Total
Information calculated using SLO. PAIIMMM denotes PAI calculated using IMMM
and PAISLO denotes PAI calculated using SLO

C. Total Information: IMMM SNR With RDSC (see Table II
and Fig. 5)
The SNR was higher with all three types of VMH:
VMH_comb3 and VMH7_2 as compared to reference head position in the standard 306-sensor helmet (Stand_1) for all 80
IMMMs (see Fig. 5, Table II). VMH7_2 created by seven simple head displacements had lower IMMM SNR than VMH types
created by two or three combined movements (VMH-_comb2_3
and VMH_comb3). The total information computed based on
the IMMM SNR calculations using the RDSC model was also
higher with VMHs than with Stand_1 and was higher with
VMHs created by combined displacements than with the VMH

MEDVEDOVSKY et al.: VIRTUAL MEG HELMET: COMPUTER SIMULATION OF AN APPROACH TO NEUROMAGNETIC FIELD SAMPLING

Fig. 5. Log2 power SNR of IMMMs computed from the 306-sensor helmet
and from VMH using the RDSC model. P’—SNR power of IMMMs.

created by simple displacements (see Table II). There were small
differences in total information calculated using IMMM SNR
and SLO: Shannon’s numbers and PAI (relatively to Stan_1)
were somewhat lower using IMMM SNR, than SLO (see
Table II).
The comparison of total information calculated using IMMM
SNR [12] and using the orthogonalization process on the sensor level [5], [11]. The calculations were based on the RDSC
model. The SNR—signal to noise ratio; VMH_comb2_3—array
22 in Table I. VMH_comb3—array 23 in Table I; VMH7_2—
array 19 in the Table I. Stand_1—reference head position in
standard 306-sensor helmet. PAI—percent of additional information (in Table II, PAI was computed comparing to Stand_1);
TI—total information. IMMM—internal multipole moments.
SLO—sensor level orthogonalization.
D. Total Information With Simulated AEFs (see Table I
and Fig. 2)
In simulated AEFs, the single head position with the
highest Shannon number was the reference head position
(Stand_1). When compared with Stand_1, only one type of
VMH (VMH_comb3) had a positive PAI (12.8%). The same
VMH type was the most efficient with RDSC.
E. Total Information With Simulated SEF (see Table I
and Fig. 2)
With simulated SEF, the most informative single head position was Stand_9. When compared with Stand_9, only one type
of VMH (VMH4_1) had a positive PAI (1.1%).
IV. DISCUSSION
A. Source Model Limitations
We used two types of simulated neuromagnetic field sources.
The first type was RDSC, the source, which is randomly distributed throughout the spherical conductor. This type of source
was used in the previous studies in MEG array informatics [5],
[11], [12]. The advantage of such a model is its suitability for

545

Shannon’s channel capacity (total information) calculation [see
(1) and (2)], which requires independence of signals presented
in different channels. RDSC is a useful model, when the sampling ability of different MEG arrays is compared without an assumption regarding specific source location. The independence
of channel lead fields can be achieved by the orthogonalization
process on the sensor level (see (5)) or by SSS to transform the
data into magnetostatic multipole moments. The disadvantage
of the RDSC model is that such simulated source is quite far
from the real physiological sources. In reality, the source of interest is seldom or ever distributed through the whole brain and
always has some degree of spatial smoothness.
The second type of simulated sources were those of evoked
fields (AEF and SEF). The AEF sources were simulated by two
ECDs located bilaterally, and the SEF source by a single ECD.
The advantage of this type of sources is that it is more physiological than RDSC. However, the signal related to the source,
which is represented by only one or two dipoles is unavoidably
dependant on the multichannel system even after the lead field
orthogonalization. Therefore, such source model is not optimal
for the Shannon’s channel capacity calculation.
Using both types of source models, and taking into account
their advantages and disadvantages, enabled us to test VMH
concept from the different angles.
B. Noise Model Limitations
The calculation of channel capacity (total information) of
multichannel device requires that signal and noise are independent. In reality, however, the noise and signal are not independent and the main part of the noise is actually brain background
activity (“brain noise”). According to our model, when the head
moves closer to sensors, the signal amplitude increases and the
noise remains the same, resulting in improved SNR. However,
in the reality, the “brain noise” amplitude increases simultaneously with the amplitude increase of the signal of interest.
Therefore, the real SNR increase is not as prominent as in our
model when head comes closer to the sensors. However, when
the head moves away from the sensors, the SNR decrease is
less prominent in reality than in our model. This can affect the
informatics of different types of the VMH. For example, the
RDSC model most probably overestimates the contribution of
translations in the x-axis from the reference head position and
underestimates the contribution of translations in z-direction
downward or in y-direction forward from the reference head
position, as in the reference head position, adult sized brain is
located close to the posterior and upper walls of the helmet.
C. Lead Field Orthogonalization
In order to compute total information, the channels of MEG
array should be independent. In reality, however, the lead fields
of MEG array are overlapping. This problem can be solved by
lead field orthogonalization, which can be achieved either by
SLO [5], [11] or by SSS transformation that creates an orthogonal basis of magnetostatic multipole moments. The subset of
SSS basis, which corresponds to spherical harmonics inside the
MEG sensor sphere, is represented by IMMMs. Both SLO and

546

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

SSS create orthogonal basis suitable for total information calculation. There are, however, some differences. In this study, we
demonstrated that values of total information calculated using
SLO or SSS bases can be slightly different (see Table II). This
can influence to some degree the PAI calculation comparing
between VMH and standard array (two lower rows of Table II).
Taking into account the source and noise model limitations
and the lead field orthogonalization aspects, we see the role
of this study as presenting the general basis of VMH concept.
This simulation study cannot quantitatively evaluate the contribution of VMH to the real MEG measurements, which should
be investigated further in the studies with real data.
According to the results of our simulations, VMH provided
more information than the most informative single head position, in some situations. VMH and single head position were
approximately equal in other situations; in many cases, however, VMH provided less information, than the “best” single
head position. Several factors influenced the VMH efficiency.
1) Source distribution.
2) Using combined versus simple head displacements.
3) SNR.

E. Using Combined Versus Simple Head Displacements
The highest PAI with RDSC and the only positive PAI with
simulated AEF were achieved by VMH types using combined
head displacements (arrays 20–23). Increase in the number of
head positions by more than two or three did not necessarily increase the VMH efficiency, because the increase in virtual
channel number may not be enough to compensate the increased
MEG channel noise. Combined movements were more efficient
than simple ones, because they increased the MEG sensor position and orientation variety with minimum decrease in number
of averaged events, and therefore, with a minimum increase in
MEG channel noise.
F. SNR
We demonstrated that with higher number of recorded events,
and therefore, with higher SNR, the proportional contribution
of VMH increases when compared with the single head position
[see Fig. 3 (b) and (c)], whereas the differences in information
content between different single head positions decreases [see
Fig. 3 (a)]. Based on this, we can expect that application of the
data denoising algorithms, such as reported by Taulu et al. [18],
can enhance the contribution of the VMH.

D. Source Distribution
Using the RDSC model, we demonstrated that MEG recording in different head positions with subsequent VMH construction in some but not all situations can increase the total information extracted from an MEG measurement and increase the
IMMM SNR. This can be explained as resulting from addition of
channels measuring independent information. Translations correspond to addition of sensor layers and rotations to placement
of additional sensors at different angles (see Fig. 1). However,
events recorded in different head positions cannot be averaged
without movement compensation. Therefore, the noise of the
VMH channels is higher than that of the standard helmet channels (when the MEG was recorded in one head position) (see
Table I). Nevertheless, the increased number of independent
channels can compensate for the less efficient channel noise
suppression (see Table I and Fig. 2). The most prominent information gain was associated with VMH types constructed by
combined head displacements.
With simulated bilateral AEFs, the majority of VMH types
provided less information than the “best” single head position
(Stand_1). However, VMH_comb3 (array 23) provided 12.8%
more information than Stand_1. Interestingly the VMH_comb3
was also the most efficient VMH type with RDSC (see Fig. 2).
With simulated unilateral SEFs, VMH did not provide substantial contribution when compared with Stand_9 (the most informative single head position). Only VMH4_1 (array 17) had
slightly positive PAI (1.1%) (see Fig. 2). However, in Stand_9,
the source was located close to the sensors in the lateral wall of
the helmet, whereas in VMH4_1, the source was close to sensors only part of the time (see Table I). Thus, VMH4_preserved
the information content of the simulated MEG recording despite
movement of the source away from the sensors. This can be important in the MEG recordings in human subjects (e.g., young
children) who cannot keep their head position stable.

G. Practical Application of the VMH Concept
According to our simulations, VMH can improve the data
related to the distributed bilateral source current (RDSC), and
possibly also in some situations to the local bilateral sources
(AEFs). We, however, did not prove substantial benefit of VMH
in the focal unilateral source (SEF). Possibly, the area where
VMH can be most efficiently applied is connectivity studies of
the complex bilateral brain networks with stable spatiotemporal
hierarchy.
The sources located close to the head surface have higher spatial frequencies than deep sources. Because the signal amplitude
nonlinearly depends on the source-to-sensor distance, the higher
spatial frequencies (signals related to more superficial sources)
are more influenced by head displacements. Therefore, we expect that VMH will be more informative with more superficial
sources.
The VMH concept demonstrates how the information may
increase with different head positions. However, whether or not
the same information increment persists after transforming the
measurements into a single position by a suitable movement
compensation algorithm based on minimum norm estimate [19]
or on SSS [14], needs to be investigated in further studies.
In order to construct a VMH, the same brain activity should
be recorded in different head positions. This is relatively easy
with evoked responses, because the nature of the stimulus and
its timing are controlled by operator. With interictal epileptic
spikes, the situation is more complex. According to some studies, it is possible to classify and average epileptic spikes [20],
but the same type of spikes recorded in different head positions
have different amplitude distribution pattern across the MEG
channels. To classify spikes, the MEG trace can be recalculated into one head position using movement compensation [6],
[13], or the MEG data can be transformed into source montage

MEDVEDOVSKY et al.: VIRTUAL MEG HELMET: COMPUTER SIMULATION OF AN APPROACH TO NEUROMAGNETIC FIELD SAMPLING

[21]. Alternatively, spikes can be classified using simultaneously recorded EEG, because the amplitude distribution in EEG
does not depend on head position. Due to spatial instability,
however, the application of VMH to the epileptic spike analysis
is a controversial issue.
The observed increase of IMMM SNR proves that with VMH
the measured magnetic field can be represented by numerically
more stable vector space basis. This opens the perspective for
more robust source estimation, which should be evaluated by
further studies including real subject recordings.
Head movements inside MEG helmet are traditionally considered as an obstacle. On the contrary, our study shows that head
movements (or recording in different head positions) in some
situations can actually improve the quality of MEG data. Not
all movements are beneficial for MEG data. In our simulations,
several types of VMH actually reduced the total information
of MEG measurements. With large displacements of the head,
the distance between source and sensors can increase, thereby,
worsening SNR.
There are some specific issues, which should be taken into
account using a VMH approach. For example, experiments including visual stimulus, can be affected by changing head position. Therefore, visual stimulus parameters such as stimulus
position and size probably have to be updated according to different head position. Another example relates to the fact that
the MEG helmet is not complete sphere, and therefore, some
sources are located close to the sensor array margin. In such
cases, relatively small head displacements can remove those
“marginal” sources out of the sensor array, preventing adequate
field sampling. This can be true for anterior temporal and basal
frontal sources. On the other hand, however, VMH can optimize
evaluation of “marginal” sources. For example, when left and
right anterior temporal lobe are activated simultaneously, head
rotation to the left can improve left anterior temporal source
field sampling and vice versa. Subsequent data interpolation can
reconstruct the complete picture of bilateral anterior temporal
activity dynamics in space and in time.
The important question is how to test the VMH concept using
real data. Investigation of this question is not trivial. Because
the real source and real noise are not distributed randomly,
Shannon’s channel capacity computing can be not an optimal
way for the VMH concept evaluation using real data. Probably,
the best way is the source localization assessment. However, it
is also not trivial to compare between different source solutions.
Because MEG source localization is an ill-posed problem, the
criteria of the solution correctness are not always robust. The
interesting possibility is to compare the source solutions not
according to correctness, rather according to stability, changing
parameters of source localization process (e.g., using L1 and L2
norms). The more informative neuromagnetic field sampling is
expected to result in more stable source solutions. This, however,
should be tested in the further studies.
V. CONCLUSION
MEG recording in different head positions with subsequent
virtual helmet construction can in some circumstances increase

547

the total information and the vector space basis stability without
an increase in recording time. More distributed bilateral brain
activity, combined head movements and higher SNR can be
associated with higher VMH efficiency. We did not prove that
VMH is more efficient than single head position in the situations,
when the source current is restricted to a small brain area and
can be easily explained by one equivalent current dipole. These
results justify further studies of VMH in basic neuroscience and
clinical practice.
ACKNOWLEDGMENT
The authors would like to thank Prof. J. Sarvas, Prof. M.
Hämäläinen, Prof. R. Ilmoniemi, Prof. M. Scherg, and Prof. T.
Stroganova for important discussion and valuable suggestions
and Mrs. M. Ovadia for assistance in graphical work.
REFERENCES
[1] J. Nurminen, S. Taulu, and Y. Okada, “Improving the performance of the
signal space separation method by comprehensive spatial sampling,” Phys.
Med. Biol., vol. 55, no. 5, pp. 1491–1503, 2010.
[2] J. Nurminen, S. Taulu, J. Nenonen, L. Helle, J. Simola, and A. Ahonen,
“Improving MEG performance with additional tangential sensors,” IEEE
Trans. Biomed. Eng., vol. 60, no. 9, pp. 2559–2566, Sep. 2013.
[3] J. S. Vrba, E. Robinson, and J. McCubbin, “How many channels are
needed for MEG?” Neurol. Clin. Neurophysiol., vol. 2004, pp. 99–99,
2004.
[4] C. E. Shannon, “Communication in the presence of noise,” Proc IRE,
vol. 37, no. 1, pp. 10–21, Jan. 1949.
[5] P. Kemppainen and R. J. Ilmoniemi, “Channel capacity of multichannel
magnetometers,” in Advances in Biomagnetism, S. Williamson, M. Hoke,
G. Stroink, and M. Kotani, Eds. New York, NY, USA: Plenum Press, 1989,
pp. 635–638.
[6] S. Taulu and M. Kajola, “Presentation of electromagnetic multichannel data: The signal space separation method,” J. Appl. Phys., vol. 97,
pp. 124905-1–124905-10, 2005.
[7] D. S. Barth, W. Sutherling, J. Engel Jr, and J. Beatty, “Neuromagnetic
localization of epileptiform spike activity in the human brain,” Science,
vol. 218, pp. 891–894, 1982.
[8] W. W. Sutherling, P. H. Crandall, J. Engel, T. M. Darcey, L. D. Cahan,
and D. S. Barth, “The magnetic field of complex partial seizures agrees
with intracranial localizations,” Ann. Neurol., vol. 21, no. 6, pp. 548–558,
1987.
[9] J. E. T. Knuutila, A. I. Ahonen, M. S. Hämäläinen, M. J. Kajola, P.
P. Laine, O. V. Lounasmaa, L. T. Parkkonen, J. T. Simola, and C. D.
Tesche, “A 122-channel whole-cortex SQUID system for measuring the
brain’s magnetic fields,” IEEE Trans. Magn., vol. 29, no. 69, pp. 3315–20,
Nov. 1993.
[10] M. Medvedovsky, R. Paetau, J. P. Mäkelä, A. Ahonen, J. Nenonen, J.
Nurminen, J. Simola, and S. Taulu, “Virtual MEG helmet,” presented at
the ISACM meeting, Sapporo, Japan, Aug. 28–30, 2013.
[11] J. Nenonen, M. Kajola, J. Simola, and A. Ahonen, “Total information
of multichannel MEG sensor arrays,” in Proc. 14th Int. Conf. Biomagn.,
2004, pp. 630–638.
[12] J. Nenonen, S. Taulu, M. Kajola, and A. Ahonen, “Total information
extracted from MEG measurements,” Int. Congr. Ser., vol. 1300, pp. 245–
248, 2007.
[13] S. Taulu and J. Simola, “Spatiotemporal signal space separation method
for rejecting nearby interference in MEG measurements,” Phys. Med.
Biol., vol. 51, pp. 1759–1768, 2006.
[14] S. Taulu, J. Simola, and M. Kajola, “Applications of the signal space
separation method,” IEEE Trans. Signal Process., vol. 53, no. 9, pp. 3359–
3372, Sep. 2005.
[15] J. Nenonen, J. Nurminen, D. Kicic, R. Bikmullina, P. Lioumis, V.
Jousmäki, S. Taulu, L. Parkkonen, M. Putaala, and S. Kähkönen, “Validation of head movement correction and spatiotemporal signal space
separation in magnetoencephalography,” Clin. Neurophysiol., vol. 123,
pp. 2180–2191, 2012.
[16] J. Nenonen, L. Parkkonen, L. Helle, S. Taulu, and A. Ahonen, “Repeatability of AEF and SEF from static and moving head positions,” in 17th

548

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 20, NO. 2, MARCH 2016

International Conference on Biomagnetism Advances in Biomagnetism—
Biomag 2010. Berlin, Germany: Springer, Jan. 2010, pp. 306–309.
[17] D. T Wehner, M. S. Hämäläinen, M. Mody, and S. P. Ahlfors, “Head movements of children in MEG: Quantification, effects on source estimation,
and compensation,” Neuroimage, vol. 40, no. 2, pp. 541–550.
[18] S. Taulu, J. Simola, M. Kajola, L. Helle, A. Ahonen, and J. Sarvas, “Suppression of uncorrelated sensor noise and artifacts in multichannel MEG
data,” presented at the 18th Int. Conf. Biomagnetism, Paris, France, 2012.
[19] K. Uutela, S. Taulu, and M. Hämäläinen, “Detecting and correcting for
head movements in neuromagnetic measurements,” Neuroimage, vol. 14,
no. 6, pp. 1424–1431, 2001.

[20] T. Bast, O. Oezcan, S. Rona, C. Strippich, A. Seitz, A. Rupp, S. Fauser,
J. Zenter, D. Rating, and M. Scherg, “EEG and MEG source analysis of
single and averaged interictal spikes reveals intrinsic epileptogenicity in
focal cortical dysplasia,” Epilepsia, vol. 45, pp. 621–631, 2004.
[21] K. Hoechstetter, H. Bornfleth, D. Wecksler, N. Ille, P. Berg, and M. Scherg,
“BESA source coherence: A new method to study cortical oscillatory
coupling,” Brain Topogr., vol. 16, no. 4, pp. 233–238, 2004.

Authors’ photographs and biographies not available at the time of publication.

