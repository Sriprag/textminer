IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

2669

Motion Compensation for Ultrasound Thermal
Imaging Using Motion-Mapped Reference
Model: An in vivo Mouse Study
Joonho Seo, Sun Kwon Kim, Young-sun Kim∗ , Kiwan Choi, Dong Geon Kong, and Won-Chul Bang∗

Abstract—Ultrasound (US)-based thermal imaging is very sensitive to tissue motion, which is a major obstacle to apply US temperature monitoring to noninvasive thermal therapies of in vivo
subjects. In this study, we aim to develop a motion compensation method for stable US thermal imaging in in vivo subjects.
Based on the assumption that the major tissue motion is approximately periodic caused by respiration, we propose a motion compensation method for change in backscattered energy (CBE) with
multiple reference frames. Among the reference frames, the most
similar reference to the current frame is selected to subtract the
respiratory-induced motions. Since exhaustive reference searching
in all stored reference frames can impede real-time thermal imaging, we improve the reference searching by using a motion-mapped
reference model. We tested our method in six tumor-bearing mice
with high intensity focused ultrasound (HIFU) sonication in the
tumor volume until the temperature had increased by 7 ◦ C.
The proposed motion compensation was evaluated by root-meansquare-error (RMSE) analysis between the estimated temperature
by CBE and the measured temperature by thermocouple. As a result, the mean±SD RMSE in the heating range was 1.1 ± 0.1 ◦ C
with the proposed method, while the corresponding result without motion compensation was 4.3 ± 2.6 ◦ C. In addition, with the
idea of motion-mapped reference frame, total processing time to
produce a frame of thermal image was reduced in comparison
with the exhaustive reference searching, which enabled the motioncompensated thermal imaging in 15 frames per second with 150
reference frames under 50% HIFU duty ratio.
Index Terms—In vivo mouse experiment, motion compensation,
ultrasound based thermal imaging.

I. INTRODUCTION

I

N high-intensity focused ultrasound (HIFU) treatment, noninvasive temperature monitoring is an essential feature for

Manuscript received October 21, 2013; revised April 10, 2014; accepted May
6, 2014. Date of publication May 19, 2014; date of current version October 16,
2014. Asterisks indicate- corresponding authors.
J. Seo was with the Samsung Advanced Institute of Technology in Samsung
Electronics, Seoul, Korea. He is currently with Korea Institute of Machinery &
Materials, Daejon, Korea (e-mail: jhseo@kimm.re.kr).
S. K. Kim is with the Samsung Advanced Institute of Technology in Samsung
Electronics, Seoul, Korea (e-mail: sunkwonn.kim@gmail.com).
∗ Y.-S Kim is with the Department of Radiology and Center for Imaging
Science, Samsung Medical Center, Sungkyunkwan University School of
Medicine, Seoul, Korea (e-mail: ysrad.kim@samsung.com).
K. Choi and D. G. Kong are with the Health and Medical Equipment in Samsung Electronics, Seoul, Korea (e-mail: fastupz@gmail.com;
dgkong@samsung.com).
∗ W.-C. Bang is with the Samsung Advanced Institute of Technology in Samsung Electronics, Seoul, Korea (e-mail: wc.bang@samsung.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2325070

ensuring treatment safety. Magnetic resonance (MR) and ultrasound (US) imaging have been adopted in HIFU thermal
therapy systems to provide temperature change as well as target
information in the target tissue area. MR-based thermometry
using the water proton resonance frequency (PRF) has already
been applied in some commercial MR-guided HIFU systems.
However, MR system is expensive, occupies a large amount of
space, and requires MR-compatible therapy devices [1]–[3]. On
the other hand, the US system is small and flexible so it can be
easily integrated with a thermal therapy system. It is inexpensive
and can be maintained at low expense compared to MR system,
and also presents no issues concerning the materials of integrated therapy devices [3]. In spite of these advantages, no USbased thermometry has been commercialized due to the following potential limitations: 1) nonlinear temperature dependence
at high temperature greater than about 50 ◦ C [5], [6], 2) inconsistent acoustic response of different tissue types and structures
[4], [7], and 3) high sensitivity to tissue motion [17], [19], [20],
[27].
The HIFU heating in our developing system will be used to
activate drugs encapsulated by thermally sensitive liposomes.
To this end, the temperature that HIFU has to generate needs to
be in the range of 36 ◦ C to 43 ◦ C. Therefore, the first limitation
mentioned previously, high-temperature monitoring for tissue
ablation, is not an issue here. Regarding tissue characterization,
the second limitation, it is known to be very hard to estimate a
reliable scaling factor which converts the magnitude of acoustic
response to the temperature change in inhomogeneous tissue
contents [4]. The scaling factor should be empirically acquired
by averaging over a large set of experimental results. In the
present study, we focus on the third issue associated with motion
artifacts in in vivo subjects. The heat-induced acoustic signal
change is quite small, so a tissue motion becomes a serious
source of noise in US thermal imaging. For example, 1 ◦ C of
thermal change produces an echo strain of −0.1% for waterbased tissue and an echo strain of 0.17% for lipids [6]. Therefore,
a motion compensation scheme should be developed in order
to apply US thermal imaging to in vivo subjects. In particular,
we aim to compensate for the respiratory tissue motion that is
approximately periodic under respiratory organ motion.
As for the US thermal imaging techniques, echo-shift temperature imaging [8]–[11] measures the echo strain (axial gradient
of the displacement) which is directly proportional to the local
change in the speed of sound caused by temperature change.
Since this method produces the temperature by accumulating interframe echo strains, high-frame-rate imaging has been

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2670

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

exploited to overcome the issue of in vivo tissue motion. D.
Liu et al. has developed the M2D mode which accomplished
the 2-D echo-shift at 500 frames per second (FPS) in phantom
and in vitro experiments [12] and 100 FPS in in vivo mouse
experiments [13].
Another example of US-based temperature estimation
method is based on change in backscattered energy (CBE)
[14], [15]. Backscattered energy mainly depends on the tissue’s
backscatter coefficient and the attenuation coefficient. Since
CBE based method ignores the attenuation due to its small
change in the temperature range of 37 ◦ C to 50 ◦ C [16], CBE can
be obtained by reflecting the change of scattering that is nearly
monotonic with the temperature change. CBE is calculated by
comparing the current frame with an initially stored reference
frame prior to heating. Therefore, CBE-based thermal imaging
does not accumulate the interframe errors that echo-shift based
temperature imaging can suffer from. In this research, our thermal imaging is based on CBE but it is modified to use multiple
reference frames for the motion compensation.
R. M. Arthur et al. has studied in vivo motion compensation
for CBE in [17], where the in vivo tissue motion was limited
to 2-D translations on US imaging plane. They then extended
the motion compensation to 3-D dataset of in vitro turkey breast
muscle in [18]. Motion compensation for an in vivo mouse has
been studied by [19], where US thermometry was applied to
monitor mild hyperthermia. In this method, each frame was
assumed to only translate without any warping or rotation of the
imaging plane. However, respiratory-induced tissue motion is
not restricted to 2-D translation or scaling on the US imaging
plane but can be easily estimated as 3-D motion which includes
an out-of-plane motion in the orthogonal direction to the US
imaging plane.
In this study, we assume that the major tissue motion is induced by respiration. If the tissue motion is periodic with the
respiration, the 3-D motion can be compensated by our method.
We sample reference frames for some periods of respiration and
the motion can be subtracted by the reference frame that shows
the most similar or the same motion with the current frame.
However, respiratory-induced in vivo tissue motion is not exactly periodic. To overcome this irregularity in respiratory tissue
motion, we need to store as many reference frames as possible,
i.e., more reference frames may result in better compensation
results. However, the number of stored reference frames can be
limited by computational cost. Full searching of the reference
frame database, we refer this as exhaustive reference searching,
will take a long time and impede the real-time implementation of thermal imaging. In our method, reference searching is
accelerated by using the motion-mapped reference model.
II. METHODS
The proposed motion compensation method requires multiple reference frames to be acquired before heating. Similar ideas
using the multireference in US thermal imaging have been explored by some previous research. In [20], coarse-to-fine speckle
tracking was applied for the motion compensation of 2-D temperature estimation. The author mentioned that the proposed al-

Fig. 1. Flowchart of the proposed motion compensation for US thermal
imaging.

gorithm can be modified to use multiple reference frames for the
coarse speckle tracking when tissue motion can be assumed to
be periodic. M. J. Daniel et al. applied US-based thermal strain
imaging to radio frequency (RF) ablation, employing motion
compensation on in vivo subjects [21]. The proposed algorithm
searches through the subsequent frames to find the most similar
frame to the start frame. In this algorithm, a new frame becomes the postcompression frame which becomes the new start
frame for the frame-to-frame thermal strain calculation. These
approaches may be used for echo-shift based thermal imaging.
We propose a motion compensation method to calculate CBE.
The reference frames are sampled for some periods of respiration before heating and the respiratory motion artifacts are
suppressed in CBE calculation by finding the most similar reference frame to the current frame. Since the exhaustive reference searching takes long time, reference searching was accelerated by using motion-mapped reference model. To build the
model, we investigate the respiratory-induced tissue motion in
the form of motion parameters and store them with US data,
which gives the motion-mapped reference model. Here, the US
data are beam-formed radio frequency (RF) data and 2-D US
data are stored as a frame. To search the reference frame in the
motion-mapped reference model, motion parameters of the current frame are also investigated and become a key to search a
set of reference frames in the motion-mapped reference model.
Once a set of reference frames is selected, the most similar
reference frame to the current frame is sought in the set by
comparing the 2-D cross-correlation coefficients. The detailed
process of motion compensation is explained and is described
in the flowchart in Fig. 1.
A. Creation of Motion-Mapped Reference Model
Before Heating
Two-dimensional US imaging is inadequate for tracking 3-D
tissue motion that includes out-of-plane motion. Therefore, we
do not track features in 2-D US image to obtain tissue motion.

SEO et al.: MOTION COMPENSATION FOR US THERMAL IMAGING USING MOTION-MAPPED REFERENCE MODEL

2671

Instead, we regard that the tissue motion can be represented by
2-D speckle changes in a fixed user-defined region of interest
(ROI). This is possible because we assume that the tissue motion
of in vivo subjects is approximately periodic. The ROI should be
chosen to reflect the maximum speckle change caused only by
the respiratory tissue motion. Therefore, the ROI should include
neither the HIFU focal area nor the other organ motions. The
2-D speckle change (ε) is calculated by the normalized 2-D
cross-correlation between the initially stored US data (r0 ) and
the subsequent US data (ri ) as
 
x
z (r0 − r0 )ROI (ri − ri )ROI
εi = 1 − 
  

 
2
2
x
z (r0 − r0 )ROI
x
z (ri − ri )ROI
(1)
where ε is a function of time t, also defines the tissue motion in the ROI. The reference frame (ri ) is sampled with the
parameters (t, ε) in the reference frame database for some respiratory motions. Based on the tissue motion profile, the period
of the tissue motion (P ) is calculated by the frequency analysis.
Using the peaks of the profiles as a reference point, the periodic motions are segmented to fit in the range of [−P/2, P/2]
and transformed into the motion model domain (t∗ , ε), where
−P/2 < t∗ < P/2 and 0 < ε < 1. The segmented profiles are
overlaid and adjusted horizontally by aligning the peaks, which
is done by Gaussian curve fitting performed on the upper 50%
of the profiles. The motion-mapped reference model M (t∗ , ε)
is the accumulated reference frames with motion parameters.
B. Motion Compensation During Heating
As described in the right box of Fig. 1, a set of motion parameters (t, ε) for currently acquired US data (pi ) is investigated. ε
is calculated by 2-D cross-correlation with the initially stored
US data (r0 ) in the ROI, and t is converted into t∗ which is
determined by the time difference from the last time when the
cross-correlation reaches the peak (tlp ) to the current time (t) in
the motion profile as,
t∗ =



t − tlp ,
t − tlp − P,

if t − tlp ≤

P
2

otherwise.

(2)

The motion parameters (t∗ , ε) of the currently acquired
US data are used to search for a set of reference frames,
m(t∗ , ε) = {r1 , r2 , . . . , rn }, near the motion parameters in the
motion-mapped reference model. The reference frames in the
set are likely to be similar to the current US data (pi ). The most
similar reference frame (rm ax ) in the set is then determined by
rm ax = arg maxr ∈m (t ∗ ,ε) [corr2D (pi , r)]

(3)

where corr2D is a function of the 2-D cross-correlation between
the current frame and selected reference frames. Thermal imaging is skipped if its correlation coefficient, corr2D (pi , rm ax ), is
less than the user-specified threshold value (empirically chosen,
usually > 0.9). Otherwise, the temperature imaging is calculated by


BE
ΔT2D = α · std 10 log10 (pBE /rm
(4)
ax )

Fig. 2. Experimental setup: HIFU heating and temperature monitoring system
for tumor bearing mouse.

BE
where pBE and rm
ax are the 2-D backscattered energy of the
current frame and the reference frame respectively. CBE is calculated in dB, and converted into temperature by multiplying
by a scaling factor (α) as shown in (4). More theoretical background on the CBE and detailed equations can be found in [14]
and [15].

III. EXPERIMENTAL SETUP
We conducted the experiments of US thermal imaging on
tumor-bearing mice. HIFU system generated a heat in tumor
area, interleaving US data acquisition according to a pulse sequence plan. The captured US data were transferred to the main
control PC for thermal imaging. Overall configurations and the
picture of the experimental setup are depicted in the Fig. 2.
A. Tumor-Bearing Mouse
This animal study was reviewed and approved by the Institutional Animal Care and Use Committee (IACUC) of the
Samsung Biomedical Research Institute (SBRI) which is an

2672

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Association for Assessment and Accreditation of Laboratory
Animal Care International (AAALAC International, protocol
No. H-A9-003)-accredited facility that abides by the Institute
of Laboratory Animal Resource (ILAR) Guide for the Care and
Use of Laboratory Animals. Since the nude mouse itself does
not have enough tissue for thermal imaging, tumor cells (EMT6) were injected subcutaneously in the hind flank and grown
for 14 days. The tumor-bearing mice were fixed on a custommade bed equipped with an acoustic absorber. A thermocouple
wire (unsheathed, 50 μm in diameter, Physitemp Instrument
Inc., Clifton, NJ, USA) was inserted into the center of the tumor volume to measure the temperature changes in tissue. The
thermocouple wire was then fixed and sealed with tissue adhesive (VetvondTM Tissue Adhesive, 3MTM , St. Paul, MN, USA)
to avoid influx of water. During US thermal imaging, the mice
were anesthetized by inhalation of 2.0% of 7-isoflurane (Forane;
Baxter, Deerfield, IL), and submerged in water so that the US
wave from the HIFU transducer and the imaging probe could be
transmitted to the target area.
B. HIFU Generation System
A HIFU system (Therapy Imaging Probe System, Phillips
Research, Briarcliff Manor, NY, USA) was used to generate
pulsed HIFU. The natural focus and diameter of the annular
array transducer (eight elements) were both 80 mm. The focal zone was 1 mm × 1 mm × 6.0 mm (based on the center
sonication frequency of 1.5 MHz, at −6 dB), and the heating
power was chosen to be in the range of 5 − 10 W in the experiments considering the properties of each individual mouse.
Water was fully degassed before HIFU heating by using a standalone inline degasser (Philips Research, Briarcliff Manor, NY,
USA). A thermostat (NTT-2200, Eyela, Tokyo, Japan) was used
to maintain degassed water at 36 ◦ C. The sensing tip of the
thermocouple wire was located by scanning tentative area with
low-energy HIFU which induced a temporary and mild temperature increase (e.g., 1 ∼ 2 ◦ C). In fact, we could observe a
rapid temperature increase when HIFU was focused at the exact
sensing tip of thermocouple. This is caused by thermocouple
artifacts [22], [23], [25]. To minimize the artifacts, we slightly
shifted the HIFU focus (∼1 mm) from the sensing tip of thermocouple in the experiments. Once the thermocouple wire was
located, HIFU sonication was repeated at that point and stopped
automatically when the temperature measured by thermocouple was increased by 7 ◦ C from the base tissue temperature.
The temperature increase of 7 ◦ C was decided to encompass
the temperature range of mild hyperthermia, that is from 36 ◦ C
(average tissue temperature of mice) to 43 ◦ C (upper-bound of
mild hyperthermia).

Fig. 3.

Pulse sequence diagram for interleaving HIFU and US imaging.

Fig. 4.

B-mode image of a tumor-bearing mouse.

WA, USA), beam-formed, and stored as a frame. The US imaging size was chosen to be 26 mm in the lateral direction and
35 mm deep so that the imaging range can cover the tumor
area of mice. The speed of thermal imaging in the system was
set to 15 FPS which was chosen as an adequate speed in order to capture respiratory tissue motion of in vivo mice. Since
HIFU sonication can cause serious interference in US thermal
imaging, we interleaved US imaging and HIFU heating. 50%
HIFU duty ratio was applied as shown in the pulse sequence diagram of Fig. 3. After US data acquisition (Tx/Rx in Fig. 3) for
33 ms, a trigger was generated to start HIFU heating during the
remaining 33 ms. In the meantime, B-mode and thermal imaging with motion compensation was processed and displayed in
the main controller PC.

C. US Data Acquisition Unit
A linear diagnostic US probe (L7-4, Philps) was exploited
to receive RF data. Its operating frequency was set to 5 MHz.
The US imaging probe was fixed with a HIFU transducer so
that it could image the HIFU focal area, from a viewpoint perpendicular to the HIFU beam path. RF data was sampled at the
rate of 45 MSamples/s by a programmable data acquisition unit
(Verasonic Data Acquisition System, Verasonics Inc., Redmond,

IV. RESULTS
Fig. 4 shows an example of B-mode image of a tumor bearing
mouse. In the B-mode image, tumor area can be recognized by
the boundary that separates the tumor from other tissue layers,
and the thermocouple wire also appears in the image when the
US imaging plane is well-aligned with the thermocouple wire.
The rectangle defines the ROI when the speckle changes were

SEO et al.: MOTION COMPENSATION FOR US THERMAL IMAGING USING MOTION-MAPPED REFERENCE MODEL

2673

Fig. 5. Process of building a motion-mapped reference model: (a) tissue motion in 150 reference frames prior to heating, (b) result of periodic segmentation,
and (c) peak-aligned motion profiles: motion-mapped reference model.

recorded. The HIFU focus is marked with a cross in Fig. 4. Although the tumor was located in the hind limb that was far from
the respiratory organs, apparent tissue motion was observed in
the tumor area of the B-mode images. From the mouse, we
captured US data for about 15 s that is enough to cover a number of respiratory cycles of an anesthetized mouse. The US data
captured for 15 s produces 225 US frames, out of which 150 center frames were selected as reference frames and the remaining
frames in the beginning and end of the capturing were discarded.
Fig. 5 shows the process of creating a motion-mapped reference
model. The motion profile described in Fig. 5(a) was obtained
from the US data changes in the ROI of the selected reference
frames. In Fig. 5(a), the amplitude of the motion varies considerably and is relatively periodic. The triangles in the motion profile
represent the calculated peaks from the periodic segmentations.
Then the segmented profiles are overlaid and peak-aligned as
shown in Fig. 5(b) and Fig. 5(c) respectively. These aligned profiles in Fig. 5(c) are the motion-mapped reference model of the
mouse sample. Each small rectangle in the reference model represents a stored reference frame with motion parameters (t∗ , ε).
After building the motion-mapped reference model, motioncompensated CBE was calculated in real-time and we started
HIFU heating until the temperature had increased by 7 ◦ C.
Fig. 6 shows a comparison of the change in the 2-D thermal images that are ordered in time with and without the motion compensation. The first row of pictures shows the change
without the motion compensation while the second row shows
the result of the motion-compensated thermal imaging. In the
case without motion compensation, motion artifacts due to the
mouse’s respiration seriously affect the tumor area. Note that
the dotted region should be ignored because bowel motions are
represented as a temperature rise in the region. In the case with
motion compensation, as shown in the first picture of the second row of Fig. 6, a clean reading of the tissue temperature
in the tumor area is achieved prior to heating under motion
compensation. In the subsequent images, as a result of HIFU
heating, the focal area turns red, which proves that the proposed

method compensated the tissue motion successfully and detected the temperature increase in spite of the respiratory motion
artifacts.
Fig. 7 shows the temporal change of the measured temperature
and the scaled CBE profile at HIFU focus. The HIFU focus is
marked with a red cross in Fig. 6. To quantify the performance
of the proposed motion compensation method, we compared
root-mean-square-errors (RMSE) of the pairwise difference of
the thermocouple measurement and the scaled CBE profile sampled at the HIFU focus. Here, the scaling factor was calculated
by α = ΔTtherm o couple /ΔCBE ( ◦ C/dB) for each mouse experiment and was multiplied to the CBE profile for scaling to the
measured temperature profile. As shown in Fig. 7, the proposed
method can suppress the respiratory-induced noise very well. In
the thermal imaging of Fig. 7, the RMSE was 4.2 ◦ C without the
motion compensation [see Fig. 7(a)] and was reduced to 1.1 ◦ C
with the proposed motion compensation method [see Fig. 7(b)].
This motion compensation result was also compared with the
compensation by exhaustive reference searching. Its RMSE was
1.2 ◦ C which seems almost the same as the error by searching
with motion-mapped reference model. Table I lists the detailed
experimental results for the case of Fig. 7.
We conducted motion-compensated thermal imaging on six
nude mice in the same manner as described above. For each
mouse, the ROI was individually selected, to avoid the HIFU
focus and the local nonperiodic motion of other organs. After
scaling CBE profile to the measured temperature profile, the
RMSE results were also analyzed. The detail results are listed
in the Table II. For the experiments of six cases, the mean±SD
RMSE were 1.1 ± 0.1 ◦ C for the heating range and 2.3 ± 0.7 ◦ C
for the cooling range with the proposed motion compensation,
while the corresponding results were 4.3 ± 2.6 ◦ C for the heating range and 4.9 ± 2.8 ◦ C for the cooling range without motion
compensation.
We compared the RMSE results with the exhaustive reference searching as well. Although the RMSEs by two reference searching were not meaningfully different, the processing

2674

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Fig. 6. Temporal 2-D thermal images superimposed on B-mode images. The dotted region contains motion artifacts from bowel motion, and the red cross
presents the HIFU focus. The first row shows the 2-D thermal imaging results without motion compensation during HIFU heating. The second row shows the
results of the proposed motion compensation with HIFU heating. The estimated temperature change at HIFU focus are presented.

time was significantly reduced by using motion-mapped reference model. As shown in the Fig. 8, the proposed reference
searching method was about five times less sensitive to the increase of reference frames than the exhaustive reference searching. To achieve 15 FPS of thermal imaging, the proposed method
can store up to 500 reference frames, while the motion compensation by exhaustive reference searching can only store 100
reference frames.
V. DISCUSSION
The results of in vivo mouse experiments showed that the
proposed motion compensation method successfully suppress
the respiratory motion artifacts in US thermal imaging. To the
best of our knowledge, this is the first to propose a method
using multiple reference frames for CBE to reduce artifacts by
respiratory tissue motion. We further developed the basic idea
to the approach based on the motion-mapped reference model.
By in vivo mouse experiments, the effectiveness of the proposed
motion compensation was successfully proved. In the future, the
proposed method will be improved to be applied to human body

TABLE I
MOTION COMPENSATION RESULTS ( ◦ C) FOR THE HEATING RANGE
FOR THE CASE OF FIG. 5
Methods
Single ref. frame
(w/o motion
compensation)
Total searching in
ref. frame database
Motion-mapped ref.
frame (proposed
method)

Min.

Max.

Std.

Avg.

RMSE

−14.25

24.7

4.04

−1.3

4.24

−3.15

9.37

1.07

−0.56

1.21

−3.28

2.5

0.93

−0.54

1.08

with an automatic HIFU heating control of mild hyperthermia
system. To accomplish our final goal, we still have the following
issues to resolve.
A. Scaling Factors for Temperature Estimation
In this research, RMSE between measured temperature and
estimated temperature by scaling CBE profile was calculated

SEO et al.: MOTION COMPENSATION FOR US THERMAL IMAGING USING MOTION-MAPPED REFERENCE MODEL

2675

TABLE II
EXPERIMENTAL RESULTS FROM SIX MICE (RMS ERRORS, ◦ C)

No.

1
2
3
4
5
6
Avg.
±SD

Fig. 7. Comparison of CBE profiles at HIFU focus. Dotted line is the measured temperature by thermocouple and solid line presents the estimated temperature from the CBE (a) without motion compensation (b) and with motion
compensation.

to show how much motion artifacts can be suppressed by the
proposed method. However the RMSE results in this paper cannot be the temperature estimation accuracy of the developing
system due to the issues of scaling factor. In the experiments,
the scaling factors were not identical for six mice, varying from
1.65 to 5.02, which can be explained by some reasons. First
of all, individual difference of mouse can cause the variation
of scaling factors. Although the same tumor cells (EMT-6) are
implanted in the hind limb of mice and grown for the same
period, it cannot be said that the grown tumor’s tissue structure,
size, and shape are exactly same for the all mice. Therefore,
acoustic responses by temperature change will not be identical. Scaling factors should be decided adaptively considering
these variable tissue conditions, which is a subject of the tissue
characterization. The second reason is about thermocouple artifact. As explained in the experimental setup with a mouse, sensing tip of thermocouple was slightly shifted from the junction
with HIFU focus in order to minimize thermocouple artifacts.
It means that the measured temperature by thermocouple did

Without
motion compensation

With
motion compensation

Heating

Cooling

Heating

Cooling

α ( ◦ C/dB)

4.24
2.99
1.79
1.98
6.77
8.06
4.30
±2.59

5.6
3.51
1.43
2.87
6.82
9.0
4.87
±2.79

1.08
1.32
1.14
1.09
1.10
1.02
1.12
±0.10

2.66
3.23
1.62
2.59
2.42
1.53
2.34
±0.65

3.75
3.68
4.04
1.65
3.28
5.02
3.57
±1.10

not reflect the exact tissue temperature at the HIFU focus while
the CBE profile was acquired at the HIFU focus. Under these
conditions, the scaling factors are hard to be identical. The estimation of the reliable scaling factor is another research area and
also the next step of our research. In this research, we decided
to apply an individual scaling factor for RMSE calculation to
show the extent of noise suppression by our method that we are
focusing in this study.
There is another discussion about the scaling factor, which is
related to the discrepancy growth between measured and estimated temperature in cooling range as shown in Fig. 7(b). Although the sensing tip of thermocouple is shifted from the HIFU
focus considering the thermocouple artifacts, the temperature
measured by thermocouple might be higher than the surrounding tissue temperature. This is due to the fact that the difference
in density between the thermocouple wire and the surrounding
tissue caused “viscous heating” at the thermocouple–tissue interface [23]–[26]. Therefore, in the cooling stage, the measured
temperature decreases faster than the real tissue temperature,
which probably caused the growth of temperature discrepancy.
In addition, CBE profile was scaled to the measured temperature
only for heating range (i.e., the scaling factor α = ΔT /CBE,
where ΔT = THIFUend − THIFUstart ). This aggravated the discrepancy growth in the cooling range, while the CBE profile in
the heating range was scaled well.
B. Toward US Thermal Imaging for Human Body
In the human body, tissue motion is not limited to be periodic.
Some might be nonperiodic or unexpected random motions. In
the mouse experiments, we found that some parts of the thermal
images were degraded by bowel motion which is not related to
the respiration at all.
Since our motion compensation is tested only for respiratory
motion, we are currently planning to suspend thermal imaging
when the other motions invade the region to be monitored. Moreover, the speed and magnitude of tissue motion in human body
are certainly larger than that in mice. Therefore, the US acquisition speed should be increased so that the motion cycles can
be sampled with more reference frames. More reference frames
will lead to more computation time; from this point, the approach

2676

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Fig. 8. Processing times for thermal imaging according to the number of
stored reference frames.

using motion-mapped reference model is advantageous for increasing the number of reference frames. In addition, external
monitoring devices can be exploited for capturing human respiratory motion, while the tissue motion was sampled by the
US speckle change in the ROI in the mouse experiment. Motion
artifact reduction by electrocardiogram gating in thermal strain
imaging [27] is a good example of using external monitoring
device.
Pulsation is another representative source of periodic motion
in in vivo. In the mouse study, we ignored the speckle change
by pulsation because it was more localized and very small compared to the respiratory-induced tissue motion. However, pulsatory motion will be much larger in the human body than that in
the mouse. Therefore, the local pulsatory tissue motion should
be detected and compensated by 2-D speckle tracking after the
compensation of global tissue motion by respiration.

posed a motion compensation method for CBE with multiple
reference frames. We sampled reference frames for some respiratory cycles before heating, and the most similar reference
frame to the current frame was selected for calculating CBE.
In this approach, a larger number of reference frames provides
more accurate and stable temperature estimation. To store more
reference frames and to search the reference frame with low
computational cost, the initial idea of searching all reference
frames was improved with a method using motion-mapped reference model. We store reference frames with motion parameters and accumulate them in a motion model before heating,
and in the HIFU heating stage, the motion parameters for the
current US frame become a key to find the best reference frame
for the motion compensation.
We tested our method in six tumor-bearing mice with the
HIFU sonication in the tumor volume until the temperature had
increased by 7 ◦ C. The proposed motion compensation was evaluated by RMSE analysis between the estimated temperature by
CBE with the measured temperature by thermocouple. Based on
the experimental results, the mean±SD RMSE of the proposed
method for the heating range was 1.1 ± 0.1 ◦ C, while the corresponding result without motion compensation was 4.3 ± 2.6 ◦ C.
The results show that the proposed method successfully separated the thermal changes from the respiratory motion artifacts.
In addition, with the idea of motion-mapped reference frame,
total processing time to produce a frame of thermal image was
reduced in comparison with the exhaustive reference searching.
The rate of increase in the processing time with respect to the
number of reference frames was about five times smaller in our
method, which enabled the motion-compensated thermal imaging in 15 FPS with 150 reference frames under 50% HIFU duty
ratio.
REFERENCES

C. Motion Compensation Method and its Applications
In this study, the motion-compensated thermal imaging was
processed in 15 FPS. This processing speed is required for our
future system to enable a real-time HIFU control through the
continuous temperature feedback. If thermal imaging does not
need to be processed in real-time, gating with the references at
inter-phase points in the respiratory tissue motion can also be
feasible.
Recently, thermal imaging has been used for detection of lipid
pools in arterial plaques with intravascular ultrasound [6], [28],
where cardiac-induced tissue motion and deformation are the
major challenges. In response, Pereira et al.[29] proposed a motion compensation method based on a linear least squares fitting
strategy. Assuming that the cardiac motion is approximately
periodic, our method can be also applied.
VI. CONCLUSION
In this study, we proposed a motion compensation method
for US-based thermal imaging. We assumed that the major
tissue motion is caused by respiration and that such motion
is approximately periodic. Based on this assumption, we pro-

[1] R. Chopra, L. Curiel, R. Staruch, L. Morrison, and K. Hynynen, “An MRIcompatible system for focused ultrasound experiments in small animal
models,” Med. Phys., vol. 36, no. 5, pp. 1867–1874, Aug. 2009.
[2] E. B. Hutchinson and K. Hynynen, “Intracavitary ultrasound phased arrays
for prostate thermal therapies: MRI compatibility and in vivo testing,” Med.
Phys., vol. 25, no. 12, pp. 2392–2399, Dec. 1998.
[3] J. W. Jenne, T. Preusser, and M. Gnther, “High-intensity focused ultrasound: principles, therapy guidance, simulations and applications,” Z.
Med. Phys., vol. 22, no. 4, pp. 311–322, Dec. 2012.
[4] N. R. Miller, J. C. Bamber, and P. M. Meaney, “Fundamental limitations
of noninvasive temperature imaging by means of ultrasound echo strain
estimation,” Ultrasound Med. Biol. vol. 28, no. 10, pp. 1319–1333, Oct.
2003.
[5] J. C. Bamber and C. R. Hill, “Ultrasonic attenuation and propagation
speed in mammalian tissues as a function of temperature”, Ultrasound
Med. Biol., vol. 5, no. 2, pp. 149–157, 1979.
[6] C. H. Seo, Y. Shi, S. W. Huang, K. Kim, and M. O Donnell, “Thermal
strain imaging: A review,” Interface Focus, vol. 1, no. 4, pp. 649–664,
Aug. 2011.
[7] A. Anand, L. Byrd, and P. J. Kaczkowski, “In situ thermal parameter
estimation for HIFU therapy planning and treatment monitoring,” in Proc.
IEEE Ultrasonics Symp., Montreal, CA, USA, Aug. 2004, pp. 137–140.
[8] R. Seip and E. S. Ebbini, “Noninvasive estimation of tissue temperature response to heating fields using diagnostic ultrasound,” IEEE Trans.
Biomed. Eng. vol. 42, no. 8 pp. 828–839, Aug. 1995.
[9] N. R. Miller, J. C. Bamber, and G. R. Ter Haar, “Imaging of temperatureinduced echo strain: preliminary in vitro study to assess feasibility for
guiding focused ultrasound surgery,” Ultrasound Med. Biol., vol. 30,
no. 3, pp. 345–356, Mar. 2004.

SEO et al.: MOTION COMPENSATION FOR US THERMAL IMAGING USING MOTION-MAPPED REFERENCE MODEL

[10] R. Souchon, G. Bouchoux, E. Maciejko, C. Lafon, D. Cathignol, M.
Bertrand, and J.-Y. Chapelon, “Monitoring the formation of thermal lesions with heat-induced echo-strain imaging: a feasibility study,” Ultrasound Med. Biol. vol. 31, pp. 251–259, Feb. 2005.
[11] C. Simon, P. VanBaren, and E. S. Ebbini, “Two-dimensional temperature
estimation using diagnostic ultrasound,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control vol. 45, no. 4, pp. 989–1000, Jul. 1998.
[12] D. Liu and E. Ebbini, “Real-time 2D temperature imaging using ultrasound,” IEEE Trans. Biomed. Eng., vol. 57, no. 1, pp. 12–16, Jan.
2010.
[13] D. Liu, J. Jiang, J. Bischof, J. Ballard, and E. Ebbini, “Real-time monitoring of thermal and mechanical tissue response to sub-therapeutic HIFU
beams in vivo” in Proc. IEEE Ultrasonics Symp., San Diego, CA, USA,
Oct. 2010, pp. 2254–2257.
[14] R. M. Arthur, W. L. Straube, J. D. Starman, and E. G. Moros, “Noninvasive
temperature estimation based on the energy of backscattered ultrasound,”
Med. Phys., vol. 30, pp. 1021–1029, Jun. 2003.
[15] R. M. Arthur, J. W. Trobaugh, W. L. Straube, and E. G. Moros,
“Temperature dependence of ultrasonic backscattered energy in motioncompensated images,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control,
vol. 52, no. 10, pp. 1644–1652, Oct. 2005.
[16] C. A. Damianou, N. T. Sanghvi, F. J. Fry, and R. Maass-Moreno, “Dependence of ultrasonic attenuation and absorption in dog soft tissues on
temperature and thermal dose,” J. Acoust. Soc. Am. vol. 102, pp. 628–634,
Jul. 1997.
[17] R. M. Arthur, W. L. Straube, J. W. Trobaugh, and E. G. Moros, “In vivo
change in ultrasonic backscattered energy with temperature in motioncompensated images,” Int. J. Hyperthermia, vol. 24, no. 5, pp. 389–398,
Aug. 2008.
[18] R. M. Arthur, D. Basu, Y. Guo, J. W. Trobaugh, and E. G. Moros, “
3-D in vitro estimation of temperature using the change in backscattered
ultrasonic energy,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control, vol.
57, no. 8, pp. 1724–1733, Aug. 2010.
[19] C. Y. Lai, D. E. Kruse, C. F. Caskey, D. N. Stephens, P. L. Sutcliffe,
and K. W. Ferrara, “Noninvasive thermometry assisted by a dual-function
ultrasound transducer for mild hyperthermia,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control, vol. 57, no. 12, pp. 2671–2684, Dec. 2010.
[20] C. Simon, P. VanBaren, and E. Ebbini, “Motion compensation algorithm
for noninvasive two-dimensional temperature estimation using diagnostic
pulse-echo ultrasound,” in Proc. SPIE Surgical Appl. Energy, 1998, vol.
3249, pp. 182–192.
[21] M. J. Daniels and T. Varghese, “Dynamic frame selection for in vivo
ultrasound temperature estimation during radiofrequency ablation,” Phys.
Med. Biol. vol. 55, no. 16, pp. 4735–4753, Aug. 2010.
[22] S. Dasgupta, R. K. Banerjee, P. Hariharan, and M. R. Myers, “Beam
localization in HIFU temperature measurements using thermocouples,
with application to cooling by large blood vessels,” Ultrasonics, vol. 51,
no. 2, pp. 171–180, Feb. 2011.
[23] H. Morris, I. Rivens, A. Shaw, and G. R. Ter Haar, “Investigation of the
viscous heating artefact arising from the use of thermocouples in a focused
ultrasound field,” Phys. Med. Biol., vol. 53, no. 17, pp. 4759–4576, Sep.
2008.
[24] W. J. Fry and R. B. Fry, “Determination of absolute sound levels and
acoustic absorption coefficients by thermocouple probes PLBIBITALIC—
-Theory”, J. Acoust. Soc. Am. vol. 26, pp. 294–310, 1954.
[25] K. Hynynen, C. J. Martin, D. J. Watmough, and J. R. Mallard, “Errors
in temperature measurement by thermocouple probes during ultrasound
induced hyperthermia”, Ultrasound Med. Biol., vol. 56, no. 672, pp. 969–
970, 1983.
[26] P. Carnochan, R. J. Dickinson, and M. C. Joiner., “The practical use of
thermocouples for temperature measurement in clinical hyperthermia”,
Int. J. Hyperthermia, vol. 2, no. 1, pp. 1–19, 1986.
[27] K. Kim, S.-W. Huang, R. Olafsson, C. Jia, R. S. Witte, and M. O  Donnell,
“Motion artifact reduction by ECG gating in ultrasound induced thermal
strain imaging (TSI),” in Proc. IEEE Ultrasonics Symp., New York, NY,
USA, Oct. 2007, pp. 28–31.
[28] Y. Shi, F. J. de Ana, S. J. Chetcuti, and M. O  Donnell, “Motion artifact reduction for IVUS-based thermal strain imaging,” IEEE Trans.
Ultrason. Ferroelectr. Freq. Control, vol. 52, no. 8, pp. 1312–1319, Aug.
2008.
[29] F. R. Pereira, J. C. Machado, and F. S. Foster, “Ultrasound characterization
of coronary artery wall in vitro using temperature-dependent wave speed,”
IEEE Trans. Ultrason. Ferroelectr. Freq. Control, vol. 50, no. 11, pp. 1474–
1485, Nov. 2003.

2677

Joonho Seo received the M.S. degree from the School
of Mechanical and Aerospace Engineering in Seoul
National University, Seoul, Korea, in 2004. He received the Ph.D. degree from the Department of
Engineering Synthesis at the University of Tokyo,
Tokyo, Japan, in 2011, where he studied robotic systems for noninvasive high intensity focused ultrasound (HIFU) treatment.
From 2004 to 2008, he worked in 3D systems
Korea Inc., Seoul, as a Senior Software Engineer.
From 2012 to 2014, he worked as a Research Staff
Member for projects regarding robotic HIFU system, medical image fusion, and
ultrasound-based thermal imaging at Samsung Advanced Institute of Technology, Samsung Electronics, . He is currently working as a Senior Researcher at
the Medical Device Lab., Korea Institute of Machinery & Materials, Daejon,
Korea. His research interests include ultrasound-based theragnostic technology,
intermodality image registration, and image-guided robotic intervention.

Sun Kwon Kim received the Ph.D. degree for
medical image processing from the Department of
Biomedical Engineering from Seoul National University, Seoul, Korea, in 2011.
He is currently a Research Staff Member at
Samsung Advanced Institute of Techology, Samsung
Electronics, Seoul. His research interests include retinal oximetry, augmented reality surgery, medical image fusion, US-based temperature monitoring, and
image processing for 3-D time-of-flight camera. His
current research topic is a multimodal medical image
registration.

Young-sun Kim received the M.D., M.M.Sc., and
Ph.D. degrees from College of Medicine of Hanyang
University, Seoul, Korea, in 1997, 2000, and 2003
respectively.
From 2002 to 2005, he was appointed an Assistant Professor in the Department of Diagnostic
Radiology, College of Medicine of Hanyang University. In 2006, he was a Visiting Scholar in the
Ultrasound Laboratory, Research Institute of Sunnybrook Health Science Center, Department of Medical
Biophysics in University of Toronto, Toronto, ON,
Canada. He is currently an Associate Professor of the Department of Radiology
and Center for Imaging Science in Samsung Medical Center, Sungkyunkwan
University School of Medicine, Seoul. His research interests include imaging
of liver cancers, image-guided ablation of liver cancers, high-intensity focused
ultrasound, and targeted drug delivery to malignant neoplasm.

Kiwan Choi received the B.S. and M.S. degrees,
respectively, in mechanical design and production
engineering from Seoul National University, Seoul,
Korea, in 1997 and 1999, respectively.
In 2001, he joined the Samsung Advanced Institute of Technology, Seoul, and has studied a robot
navigation system, ultrasound temperature imaging
for high-intensity focused ultrasound monitoring, and
medical ultrasound imaging. He is currently a Principal Engineer of ultrasound R&D group in Samsung
Electronics Inc. His current research interests include
medical ultrasound imaging, reconstruction for shearwave elasticity imaging,
and GPU programming.

2678

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 11, NOVEMBER 2014

Dong Geon Kong received the B.Sc degree from
Pusan National University, Busan, Korea, in 1999,
and the M.Sc degree in electrical engineering at Korea Advanced Institute of Technology, Daejon, Korea,
in 2001.
From 2001 to 2013, he was a Research Staff Member at Samsung Advanced Institute of Technology,
Seoul, where he worked in microphone array signal
processing for speaker localization, thermal monitoring for high-intensity focused ultrasound, and ultrasound elastography. Since 2013, he has been working
with Ultrasound R&D Group, Heath and Medical Equipment, Samsung Electronics. His current research interests include ultrasound speckle tracking, strain
imaging, and shearwave elasticity imaging.

Won-Chul Bang received the Ph.D. degree for a
set-theoretic control system in electrical engineering
at Korea Advanced Institute of Technology, Daejon,
Korea, in 2001.
He is a Principal Researcher of Samsung Advanced Institute of Technology, Seoul, Korea, leading
the high-intensity focused ultrasound team, and then,
currently, the medical fusion imaging team. He developed the first motion sensing technology for mobiles,
which has been succeeded to the Galaxy S series. His
research interest is to combine the IT technologies
into medical imaging systems, including interventional ultrasound imaging,
multimodal image rigid/nonrigid registration, deformable organ modeling, and
motion compensation.

