IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

1989

Segmentation of Renal Perfusion Signals From Laser
Speckle Imaging Into Clusters With Phase
Synchronized Dynamics
Christopher G. Scully∗ , Member, IEEE, Nicholas Mitrou, Branko Braam, William A. Cupples,
and Ki H. Chon, Senior Member, IEEE

Abstract—Renal perfusion signals contain dynamics arising
from the renal autoregulation feedback mechanisms as the contraction and dilation of vessels alter flow patterns. We can capture
the time-varying dynamics at points across the renal surface using
laser speckle imaging. We segment an imaged area of the renal cortex into clusters with phase synchronized dynamics. Our approach
first uses phase coherence with a surrogate data derived threshold
to identify synchronized pixel pairs. Non-negative matrix factorization is then applied to segment phase coherence estimates into
phase synchronized regions. The method is applied to laser speckle
imaging of the renal cortex of anaesthetized rats to identify regions
on the renal surface with phase synchronized myogenic activity. In
three out of six animals imaged after bolus infusion of Nω -nitro-larginine methyl ester (NAM), the renal surfaces are segmented into
clusters with high phase coherence. No more than two clusters were
identified during control period for any animal. In the remaining
three animals, a strong myogenic signal could not be detected in
surface perfusion during control or NAM. This method can be
used to identify synchronization in renal autoregulation dynamics
across the renal surface.
Index Terms—Clustering, laser speckle imaging, renal autoregulation, synchronization.

I. INTRODUCTION
ENAL blood flow is regulated by at least two feedback
systems that operate within a nephron, the functional unit
of the kidney. Afferent arterioles protect the glomerular capillaries and maintain glomerular filtration rate during blood pressure
fluctuations by constricting and dilating in a process known as
renal autoregulation. The two feedback mechanisms, the myo-

R

Manuscript received October 11, 2013; accepted March 3, 2014. Date of publication March 11, 2014; date of current version June 14, 2014. This work was
supported by Canadian Institutes of Health Research under Grant MOP-102694.
The work of C. G. Scully was supported by an American Heart Association predoctoral fellowship. Asterisk indicates corresponding author.
∗ C. G. Scully was with the Department of Biomedical Engineering, Worcester Polytechnic Institute, Worcester, MA 01609 USA. He is now with the Office
of Science and Engineering Laboratories, Center for Devices and Radiological Health, US Food and Drug Administration, Silver Spring, MD 20993 USA
(e-mail: christopher.scully@fda.hhs.gov).
N. Mitrou and W. A. Cupples are with the Department of Biomedical Physiology and Kinesiology, Simon Fraser University, Burnaby, BC V5A 1S6, Canada
(e-mail: nmitrou@sfu.ca; wcupples@sfu.ca).
B. Braam is with the Departments of Medicine and Physiology, University of
Alberta, Edmonton, AB T6G 2R3, Canada (e-mail: branko.braam@ualberta.ca).
K. H. Chon is with the Department of Biomedical Engineering, Worcester
Polytechnic Institute, Worcester, MA 01609 USA (e-mail: kichon@wpi.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2311118

genic response (MR) and tubuloglomerular feedback (TGF),
generate self-sustained oscillations in normotensive rats within
ranges of 0.1–0.3 Hz and 0.02–0.05 Hz, respectively [1]. A human kidney contains ∼1 000 000 nephrons (∼30 000 in a rat).
Although each nephron can be thought of as an independent
unit, they are connected by a vascular tree stemming from the
renal artery which branches into increasingly smaller vascular segments till reaching the afferent arteriole preceding each
nephron [2]. Synchronization in TGF dynamics has previously
been reported between neighboring nephrons in tubule pressure
signals [3], [4] and renal perfusion signals obtained by laser
speckle perfusion imaging (LSPI) [5]. The vascular tree that
connects nephrons provides a cable for the transfer of information [6], and modeling studies have shown that vascular conduction can synchronize dynamics between nephrons [7], [8].
Such synchronization may contribute to renal autoregulation by
the development of vascular resistance and spatial and temporal
smoothing of blood flow and explain how autoregulation is able
to adjust for blood pressure over a range larger than explained
by the autoregulatory capacity of an individual nephron [9],
[10]. There is therefore interest in being able to identify kidney vascular territories that have synchronized autoregulatory
dynamics.
Evidence examining synchronization on a wide scale requires
imaging approaches to monitor flow with sufficient spatial and
temporal resolutions. LSPI provides information about temporal
perfusion changes in the superficial vasculature across an imaged region [11]. We investigated LSPI for measuring renal perfusion across the cortex and found time-series could be extracted
that contain the relevant autoregulation dynamics [12]. The operating frequencies of the MR and TGF can be tracked at each
location as they vary over time, and the time-varying dynamics
between any two locations can be analyzed by measures of phase
coherence (PC) to detect synchronization [13]. It is then necessary to develop a framework that allows identification of regions
with synchronized renal autoregulation to allow further investigations on the importance of synchronization in effective renal
autoregulation.
We present a method for segmenting laser speckle image sequences of the renal cortex into regions with phase synchronized
dynamics. Our two-step procedure first estimates PC from the
time-varying autoregulation phases extracted from each pair of
pixels, and these estimates are then clustered to identify synchronized regions. The method is illustrated with LSPI sequences of
the renal cortex from anaesthetized rats.

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1990

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

II. MATERIALS AND METHODS

B. Estimation of PC

A. Experimental Methods
Experiments were performed in accordance with the guidelines of the Canadian Council on Animal Care and approved by
the Animal Care Committee of Simon Fraser University. LongEvans rats (N = 7) (Harlan, Livermore, CA, USA) were given
buprenorphine (0.02 mg/kg i.p.) 20 min prior to being placed
under anaesthesia with 4% isoflurane in inspired gas, then reduced to 2%. Each animal was placed on a heated table (35 ◦ C)
and the trachea cannulated for ventilation by a small animal respirator (TOPO, Kent Scientific, Torrington, CT, USA). The left
kidney was exposed, freed from surrounding fat, and secured in
a kidney cup anchored to the table. Grease was placed in the
cup around the kidney to minimize motion.
LSPI was performed 1 h after kidney preparation using the
moorFLPI laser speckle contrast imager (Moor Instruments,
Axminster, UK). The moorFLPI illuminates the target surface
with a 785 nm laser providing flow information for the most
superficial nephrons in the renal cortex, ∼100 μm deep [14].
The resulting speckle pattern is captured with a charge-coupled
device camera at a frame rate of 25 Hz. Flow changes in the
tissue alter the speckle pattern such that higher flow blurs the
pattern reducing the contrast and lower flow increases the contrast [15]. Contrast statistics of the pattern were computed over
a spatial set of pixels resulting in a relative perfusion index
mapped across the surface at 113 × 152 pixels and 25 Hz [15].
The lens was positioned ∼20 cm away from the kidney resulting in an imaging window of ∼5 × 7 mm. A ∼4 mm hair was
placed on the renal surface to determine the pixel length, and
the renal surface was monitored for ∼300 s for each animal. In
N = 6 rats, imaging occurred before (CTL) and after bolus infusion of the nitric-oxide synthase inhibitor Nω -nitro-l-arginine
methyl ester (NAM) (Sigma-Aldrich, Oakville, ON, Canada) at
10 mg/kgBODY -W EIGHT .
After acquisition, flux image series were loaded into
MATLAB r2011b (The Mathworks, Natick, MA) for processing. A Gaussian spatial filter (width of 8 pixels corresponding
to –10 dB cutoff) was applied to each frame to increase the
signal–noise ratio of the time-series at each pixel [16], and the
filtered images were then spatially downsampled by a factor of 4
to reduce redundant information at adjacent pixels caused by the
spatial filter. The size of the spatial filter was determined from
a previous study where it was found to adequately identify autoregulation signals [12]. Time-series extracted from each pixel
were low-pass filtered (0.5 Hz cutoff frequency) and downsampled to 1 Hz because the pertinent autoregulation frequencies
are in the 0.01–0.3 Hz frequency range [1].
The peak power of the MR dynamic relative to background
noise was computed using the detection ratio [see (1)]. In (1),
Psig is the peak power of the dynamic within the MR frequency
range, 0.1–0.3 Hz, from the power spectrum. Pnoise is mean
power of the noise region, 0.3–0.5 Hz:

DR = 10 log10

Psig − P̄noise
SD(Pnoise )


.

(1)

The time-series extracted from each pixel within the LSPI
videos are analyzed for the changes in the temporal relationships in renal autoregulation dynamics between pixels. The first
step is to estimate PC for the MR or TGF dynamic between
every pixel pair. To the extent that perfusion dynamics from two
locations are synchronized, the phase difference between the
two should remain constant over time. PC is bounded by 0 (no
phase relationship) and 1 (signals are phase locked), but what
constitutes significant PC between these extremes can be open
ended. A significance threshold derived from surrogate data is
used to determine if the observed PC is statistically different
from the PC values of two signals with similar time-varying
dynamics but with phase relationships destroyed.
To determine PC between two signals, the instantaneous
phases for each are estimated. Each signal is bandpass filtered
for the MR range using a forwards–backwards Butterworth filter to preserve phase relationships in the signals. For the MR
frequency range, a 16th-order filter with low- and high-cutoff
frequencies of 0.09 and 0.32 Hz, respectively, is used to isolate
the dynamic. After bandpass filtering, the Hilbert transform is
applied to find the analytic signal and subsequently determine
the instantaneous frequency at all time points, f (t). Ideally, the
instantaneous frequency will remain between the cutoff frequencies of the bandpass filters, but phase slips can occur that cause
the frequency to jump outside of the range of the bandpass filter [13]. These phase slips are induced by noise present in the
signal that is unrelated to the autoregulation frequencies, interrupting the continuous autoregulation signal. Locations where
the instantaneous frequency has extended beyond the bandpass
filter cutoff frequencies are identified and linearly interpolated
to ensure that all instantaneous frequencies are within the passband of the filters [13]. The instantaneous phase, ϕ(t), is the
integral of the instantaneous frequency and wrapped between
–π and π. PC is then computed between two signals, m and j,
as the mean over N data points of their exponential difference
in phase [17]:


n

1 

i(ϕ j l −ϕ m l ) 
(2)
e
P Cm j = 
.

N
l=1

To determine the significance of PC between the extremes,
we apply a surrogate data-derived threshold to test the null hypothesis that the instantaneous phase relationships between the
signals are independent of time [13]. The surrogate data-derived
threshold provides an expected PC for the two signals that is dependent on the dynamics of the signals but independent of the
timing of the recorded signals. The instantaneous frequency of
one of the two signals is circularly shifted a random distance in
time (n) to destroy phase relationships between the two signals
as

f (t − n)
n+1≤t≤N
fsurr (t) =
(3)
f (N − n + t) 1 ≤ t ≤ n.
fsurr (t) is used to estimate the surrogate instantaneous phases,
ϕsurr (t). This procedure removes phase relationships between
the two signals but maintains the signal dynamics [13]. PC is

SCULLY et al.: SEGMENTATION OF RENAL PERFUSION SIGNALS FROM LASER SPECKLE IMAGING

1991

then estimated between ϕsurr (t) and ϕ(t) from the signal the
surrogate procedure is not performed on. Fifty surrogate PC
estimates are made, and the significance threshold is set as the
mean plus 2 standard deviations of the surrogate PC estimates.
Two signals are declared as having significant PC if greater than
this threshold.
C. Identification of Synchronized Clusters
PC and significance levels are determined between every pair
of pixels and combined into a single n × n synchronization matrix, where n represents the total number of pixels. The synchronization matrix, R, contains bivariate synchronization indices,
PC, between all pairs of pixels [18]. Rm j is the PC between
pixel m and j. If pixels m and j did not have significant PC
determined by the surrogate threshold, Rm j is set to 0.
The mean PC of R is reported for each animal. A high mean
PC indicates homogenous synchronization across the surface.
The interpretation of a low mean PC may be: 1) phase synchronization of the dynamics of interest is not present across the
surface; and 2) phase synchronization is present in local areas
only but low at locations further away. The coefficient of variation (CV, standard deviation of PC divided by mean PC) of R
is reported as a measure of the homogeneity of PC across the
kidney surface.
Non-negative matrix factorization (NMF) was used to reduce the n × n synchronization matrix R into two matrices W
(n × r) and H (r × n) using an iterative computation subject to
the constraint that all values in W and H are ≥ 0 [19]. Because
W and H are positive, only additive combinations are possible which allows sparse components to be generated. R is the
n × n symmetric synchronization matrix containing PC values
between 0 and 1. r represents the rank of the reduced matrices
to be determined. By varying the rank r, the number of clusters
to be identified can be adjusted
R ≈ W H.

(4)

NMF was performed with update equations based on the squared
error between R and WH [20]
Err = R − W H2 .

(5)

One hundred initial starting points were used and r was varied
from 1 to 10. The difference in (5) for increasing the rank by
1 was used as the criterion for determining the cluster number
[21]. When the result of increasing r by 1 was a change in the
residual error (|Errr +1 − Errr |) of less than 0.01, the number
of clusters was set to r.
To assign clusters, W is generally used to represent bases that
can be used to reconstruct R from the encoding in H [22]. Because the synchronization matrix is symmetric, the cluster that
makes up the largest contribution of the data at each pixel is used
to determine the cluster assignments, (6), where j represents the
pixel and r the cluster. In this way, each pixel is assigned to the
cluster that makes up the largest additive portion of the original
PC. If W and H are sparse and there is separation between
clusters, the additive component from the strongest cluster will

Fig. 1. (a) Time-averaged laser speckle perfusion image of the renal cortex. The gray bar represents the 4 mm hair placed across the renal cortex.
(b) Frequency spectra of the extracted time-series from the four locations denoted by a star in (a).

have a significant contribution
Cluster(j) = arg max(Wj r Hr j ).
r

(6)

III. RESULTS
A. Example Identification of Clusters
Fig. 1(a) shows the time-averaged flux at each downsampled pixel for the single animal that did not receive NAM, and
Fig. 1(b) shows the flux spectra from the four white star locations in Fig. 1(a). Locations were selected to demonstrate the
approach with two locations each sharing the same frequency.
Frequencies between 0.1 and 0.2 Hz in Fig. 1(b) can be identified
as the MR signature. Two signals have a dominant frequency
around 0.13 Hz and the other two signals have a dominant frequency >0.15 Hz. It might be expected that signals sharing
the same frequency are synchronized, but this is not guaranteed
since renal autoregulation dynamics are highly time varying and
instantaneous phase changes may be uncorrelated between the
two signals [23], [24]. For this reason, we estimate the PC by
evaluating the temporal variations in the phase difference between the two signals using PC and compare to a significance
test.
PC and significance level estimates are determined between
the time-series from all pixel pairs and maps of PC between each
pixel and all others are generated. Fig. 2(a)–(d) shows PC maps
for the four example locations marked in Fig. 1. In each frame
of Fig. 2, PC between the time-series from every pixel and the
pixel identified with the white star is displayed. Combinations
of pixels without significant PC are set to 0.
Fig. 2(a) shows that signal 1 has significant PC with all other
pixels within the large shaded region. From Fig. 2(b), we see that
signal 2 has significant PC with the same pixels as signal 1 and
this large shaded area corresponds to a synchronized cluster. In
Fig. 2(c) and (d), we see that signals 3 and 4 have significant PC
with each other within a second cluster. Visualizing these surface
maps is useful to gain an understanding of the PC distribution
across the surface, and clustering analysis can be applied to find
groups of synchronized pixels [25].
PC values between all pairs of pixels from our LSPI data of
the renal cortex were transformed into a single synchronization matrix and the clustering method applied. Fig. 3(a) shows
the frequency with the maximum spectral power in the MR

1992

Fig. 2. (a) PC between signal 1, marked by the white star, and all other pixels.
The gray bar represents the wire placed on the surface, and white space indicates nonsignificant PC as determined by the surrogate significance threshold.
(b)–(d) PC estimates relative to the pixel marked by the white star in each frame.
The stars and numbers correspond with the locations in Fig. 1.

Fig. 3. (a) Frequency with the maximum power within the MR range (0.09–
0.3 Hz) at each pixel location. (b) Cluster maps identified by NMF of the
synchronization matrix. Pixels with the same color are assigned to the same
cluster. Data are for the same animal as in Figs. 1 and 2.

frequency range for the time-series extracted from each pixel.
Fig. 3(b) displays the cluster map using NMF. Clusters < 9
adjacent pixels in size are ignored, as this size can correspond
to the Gaussian spatial filter. The method clusters the PC values
seen in Fig. 2 similar to the frequency mapping in Fig. 3(a). The
two large clusters are ∼8.1 and 17.2 mm2 .
B. Effect of Signal Characteristics on PC
Meaningful estimates of PC and the significance level depend on appropriate signal length and strength of the dynamic
relative to background noise. To demonstrate the influence of
these characteristics, we selected 100 pairs of signals within
the large synchronized region in Fig. 2(a) and (b), and another
100 pairs where one of the signals belongs to the synchronized
region in Fig. 2(a) and (b) and the other belongs to the region
in Fig. 2(c) and (d). The signals were selected from locations
evenly dispersed across each region.
PC and significance levels were determined between each
pair for data lengths increasing from the first 50 s of the signals
up until the full data length (340 s). Mean and 95% confidence
intervals over the pairs of synchronized and nonsynchronized
signals were determined for the PC and significance levels,

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 4. (a) Impact of data length on PC and significant thresholds. Solid lines
are mean and 95% confidence intervals for 100 pairs of signals belonging to
the same coupled region. Dashed lines are the same for 100 pairs of signals
belonging to different regions (nonphase coupled signals). Black lines represent
the PC and gray lines significance thresholds. (b) Impact of white noise on PC.
Solid black line is PC computed between pairs of pixels expected to belong to
the same cluster for varying levels of noise added with 95% confidence intervals
on PC (vertical error bars) and detection ratio (horizontal error bars). The gray
line represents significance thresholds with 95% confidence levels over the 100
pairs.

Fig. 4(a). PC and significance thresholds are higher at short
data lengths, and there is poor separation between the true PC
and surrogate-derived significance thresholds at this point. As
the data length increases to >250 s, there is clear identification
of the synchronized pairs. For nonsynchronized pairs, dashed
lines in Fig. 4(a), the separation between significance levels and
PC is relatively constant at data lengths greater than 150 s.
White noise was added in increasing amplitudes [0, 0.5, 1,
1.5, 2, 3, 4, 5] to the signals after normalization by the signal variance. PC and significance levels were estimated at each
noise level as was the detection ratio for each signal plus noise
combination. The detection ratio was averaged between the two
signals in each pair. Mean and 95% confidence intervals are
shown in Fig. 4(b) of PC and significance levels as functions
of the detection ratio for increasing noise levels for the pairs
with significant PC. Horizontal error bars represent 95% confidence intervals of the detection ratio for the 100 signal pairs.
With no noise added, the MR dynamic has a detection ratio
of ∼25 dB between all pairs of signals. As the detection ratio decreases due to added noise, PC and significance levels
decrease. At detection ratios <10 dB, there is poor separation
between PC and significance levels, and accurate estimates of
significant PC cannot be made. Results are not shown for the
nonsynchronized signal pairs as PC and significance levels had
insignificant changes for increasing levels of added noise. As
the signal characteristics change from data length and noise, PC
values vary. Surrogate data adapts the significance threshold to
varying signal characteristics.
C. Identified Clusters
The frequency spectrum for the mean laser speckle signal (average of time-series across all pixels) for the six animals before
and after NAM is presented in Fig. 5(a) and (b), respectively.

SCULLY et al.: SEGMENTATION OF RENAL PERFUSION SIGNALS FROM LASER SPECKLE IMAGING

1993

in Fig. 7(c) and (d). Even though the locations share a dominant
frequency, the time variance of each differs and therefore PC,
which tracks how consistent the phase relationships are over
time, is not significant.
Characteristics of the clusters were quantified and compared
to the detection ratios of the dynamics in Fig. 8. PC averaged
between all pairs of pixels within each cluster (PCM EAN ) is
shown on the y-axis in Fig. 8(a) with the x-axis representing the
detection ratio averaged across all pixels within that cluster. The
approximate physical areas (mm2 ) corresponding to each cluster
are presented in Fig. 8(b) against the detection ratio. Animals
A, B, and E form the most clusters (3, 6, and 4, respectively)
during NAM with high detection ratios and PCM EAN within
those clusters. More clusters are identified in B than A or E,
but the field of view is larger for B and clusters are similar in
physical size. No animal forms more than two clusters during
CTL.

Fig. 5. Power spectra of the laser speckle time-series averaged over all pixels
for six animals during (a) CTL and (b) NAM. Solid lines indicate animals with
maximum frequency power in the range of the MR, and thick dashed lines
indicate animals with maximum frequency power in the range of TGF.
TABLE I
STATISTICS OF SYNCHRONIZATION MATRIX

Three animals, A, B, and E, have dominant spectral power in the
MR range from 0.1 to 0.25 Hz during CTL and NAM, Fig. 5(b).
The remaining three animals, C, D, F, are dominated by lower
frequency content <0.05 Hz, representative of TGF during CTL
and NAM.
The mean PC and CV of the synchronization matrix for each
animal during CTL and NAM periods is reported in Table I.
Fig. 6 shows the dynamic characteristics during CTL and
NAM mapped for the three animals with strong MR signal. Each
row contains the dominant frequency in the MR range mapped
at each pixel, detection ratio of that frequency, cluster map, and
PC for each pixel with the pixel at the geometric centroid of the
cluster it belongs to for one animal either during CTL or NAM
as labeled.
Fig. 7(a) and (b) shows PC maps for the two locations labeled
by the white star in Fig. 6, row B (Animal A during NAM).
The two locations do not have significant PC with each other although they do share the same dominant frequency as seen in the
first column of Fig. 6, row B. The locations they do have significant PC with correspond to the cluster map in Fig. 6, row B. It has
previously been shown that the renal autoregulation dynamics
are highly time varying [23], and the time variance for the two
signals can be visualized in the time–frequency representations,
generated by Variable Frequency Complex Demodulation [26],

D. Limitation to Size of Cluster Identification
The smallest clusters that can be identified are a function of
the physical area captured by the pixels and the spatial averaging filter applied to increase signal strength for accurate PC
estimates. For each imaging file, two groups of 10 pixels from
the same cluster and another group of 10 pixels from a separate cluster were selected. The two groups of pixels from within
the same cluster were considered synchronized and the groups
from separate clusters were considered unsynchronized. The
selected pixels within each cluster were approximately equidistant apart. An N × N averaging window was applied to each
frame centered on the selected pixels from the original 113 ×
152 moorFLPI flux data to generate time-series for a range of
window sizes (N = 2:9). For each N , the detection ratio of the
MR in the time-series was determined for each pixel as was PC
between the pairs of synchronized and unsynchronized pixels.
The accuracy of identifying pixel pairs as either synchronized or
unsynchronized using the surrogate data threshold was found at
each N as the number of pairs from the same cluster identified
as synchronized plus the number of pixel pairs from separate
clusters identified as unsynchronized, divided by the total number of pairs. This procedure was performed on the NAM data
where an average detection ratio of the MR signal was >15 dB
using the Gaussian spatial filter. The remaining data files did not
have a detectable MR signal. This provided four datasets: the
control example describing the procedure in Section II-A and
records A, B, and E from the NAM group in Section II-C.
The amplitude of the MR signal increases when larger pixel
areas are averaged together, Fig. 9(a). PC between synchronized
pixel pairs (those identified within the same cluster using the
Gaussian spatial filter) increases as larger areas are averaged,
but PC between unsynchronized pixel pairs does not, Fig. 9(b).
Fig. 9(c) shows the relationship between the detection ratio and
PC as the size of the averaging window is adjusted. Fig. 9(d)
shows the accuracy of identifying pixel pairs as synchronized
or unsynchronized as a function of the averaging width.

1994

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 6. Characteristics of the MR signal and PC-based clustering during CTL and NAM for the three animals showing MR signal (A, B, and E). Each row
represents one imaging period. The first column shows the peak MR frequency, second column the detection ratio for that frequency relevant to background noise,
third column the maps of clusters determined using NMF, and the fourth column maps of the PC relative to the signal at the geometric centroid of each cluster.

IV. DISCUSSION
We have presented an approach for identifying phase synchronized regions in LSPI of the renal cortex by clustering
PC estimates between all pairs of pixels. The applied clustering algorithms utilize only the PC coefficients without any
spatial information and identified clusters consisted of adjacent pixels. When applying the method to renal autoregulation data, clusters with phase synchronized MR dynamics were
identified.
Efferent arterioles leave the glomerulus and approach the renal surface where they diverge into a series of vessels producing
a “star” structure [2]. Flow in efferent “star” vessels contain renal autoregulation dynamics [27]. Due to the penetration depth
of the lasers in this study, placement of “star” vessels in the subcapsule region, and higher red blood cell velocity in arterioles
than capillaries, efferent arterioles are likely the predominant
contributors to speckle signals of renal cortical blood flow [5].

In this way, two nephrons connected by preglomerular vasculature at a distance up to 600 μm may have efferent star vessels
that take up a significantly larger space on the renal surface that
is captured with LSPI. TGF synchronization between pairs of
nephrons connected in the preglomerular vasculature across distances up to 600 μm has previously been reported [3]. Additional
nephrons may synchronize their activity to form clusters [9].
The presented approach relies on the analysis of spontaneous
oscillations in blood flow generated by the renal autoregulation
feedback mechanisms, namely the MR as presented here. Such
spontaneous oscillations have been repeatedly reported in the
literature [1], [28], [29]. However, in the present set of six animals, the presence of the MR signal varied considerably. From
Fig. 8(a), it is seen that a higher detection ratio corresponds to
higher PCM EAN . In three animals, a strong MR was identified
during NAM with one of those three also showing a strong signal during CTL. In the remaining three animals, the MR signal
had a low detection ratio during CTL and NAM, but frequency

SCULLY et al.: SEGMENTATION OF RENAL PERFUSION SIGNALS FROM LASER SPECKLE IMAGING

1995

Fig. 9. (a) Detection ratio averaged over all selected pixels as a function of
the N × N window size. Thin lines represents individual NAM files with detection ratios >15 dB, the thick black lines represent the mean of the four files.
(b) PC between pixel pairs with significant PC (solid lines) and without significant PC (dashed lines) as a function of the N × N window size. (c) PC as a
function of the detection ratio. (d) Accuracy of correctly identifying pixel pairs
with significant PC using the surrogate data thresholds.
Fig. 7. (a) PC between time-series from pixel marked by the white star and
all other pixels from Fig. 6, second row. White space indicates locations that do
not have significant PC with the white star. (b) PC between pixel with second
white star and all other pixels. (c) and (d) Time–frequency spectra in the MR
frequency range for the time-series from the white stars in (a) and (b).

Fig. 8. Characteristics of identified clusters for the six animals during CTL
(open) and NAM (filled). Each animal is designated by a different symbol and
the results are plotted for each cluster from that animal. (a) Average PC within
each cluster versus the detection ratio averaged over all time-series from the
pixels within that cluster. (b) Measured physical area of each cluster versus the
average detection ratio. The enlarged markers (b) represent two overlapping
data points.

content in the expected TGF range was visible in the spectra,
Fig. 5. These animals were all of the same strain and received
the same bolus infusion of NAM; however, their renal autoregulation dynamics showed considerable differences. This lack
of a signal is representative only of the imaged region of the
vasculature and does not mean that the MR was lacking in the
animal.
Without a dominant MR signal, we cannot expect to identify
significant PC between locations. This is reinforced by looking
at the CV of PC values in the synchronization matrix. Although
all animals had relatively low mean PC across the synchroniza-

tion matrix ranging from 0.33 to 0.45 during NAM, the three
animals with a dominant MR signal each had a CV of the synchronization greater than any of the three animals lacking a
dominant MR signal during NAM. This indicates a difference
in the distribution of PC values across the renal surface. For the
three animals lacking the MR signal, less variability indicates a
more homogenous surface of low PC, while the three animals
with the MR signal a higher CV indicates that there is considerable variability across the surface with local areas with high PC.
A and B both showed higher PC across the surface during CTL
than NAM, but CV was less and resulting in a lower number
of clusters being identified. It is this pattern of PC across the
surface that is further described through clustering analysis.
The surface was segmented into more than two clusters for
the three animals showing an MR signal after NAM. The cluster
locations were not necessarily in agreement with the frequency
map generated by identifying the maximum frequency at each
location, showing the alternative information gained by considering the time-varying dynamics. Fig. 8(a) shows how the PC
within each cluster is higher for these animals than for the animals without an MR signal, and is also higher than the mean PC
for each animal. This indicates strong, localized synchronization
of the MR.
NAM has previously been shown to alter the MR response
[30], [31]. It is known that NAM affects vascular smooth muscle
cells a number of ways including sensitization of Ca2+ [32], activation of voltage dependent K+ channels [33] and potentially
influencing vascular communication through gap junctions [34].
For these reasons, we infused NAM with the expectation it
would alter the observed clusters. Although there tended to be
an increase in the number of clusters during NAM when an MR
signal was present, because only three animals showed a strong
MR signal, additional studies are needed to confirm that there
is an effect of NAM.

1996

Holstein-Rathlou et al. tracked the TGF dynamics in the superficial vasculature across the renal cortex with LSPI [5]. They
clustered the time-varying dynamics across the surface using
hierarchical clustering [5] to find signal pairs with similar time
variance. In this study, we identified synchronized MR regions
and generated images of the segmentation of perfusion dynamics
across the surface. The phase synchronized MR regions identified were on the scale of 5–10 mm2 during NAM which may
indicate the synchronization of greater than ten lobules. To accomplish this, communication may occur through electrotonic
responses that have shown to be present in renal vasculature or
hemodynamic coupling [6]. At this time, the exact mechanism
of synchronization requires further study. Synchronization of
the MR dynamic has not been extensively studied, although the
MR is both necessary and sufficient for effective autoregulation [1], [9].
A. Limitations
The detectable cluster size is restricted by our effective pixel
resolution and field of view allowed by the moorFLPI imaging
system. In this study, our field of view was set at ∼5 mm ×
7 mm corresponding to approximately one-third of the posterior
surface of the kidney. By reducing the zoom, we could capture
the entire surface, but in doing so would increase the size of
our effective spatial resolution. As presented, this resolution is
set to capture flow in efferent star vessels related to individual
nephron dynamics that are considered to be the independent unit
contributing to clusters. Although the physical distance captured
by a flux pixel in our imaging setup is ∼40 μm, individual pixels
do not provide MR signals with significant amplitude so an
averaging window must be applied. Low detection ratios lead
to low PC estimates, Fig. 4(b), resulting in poor accuracy of
cluster identification, Fig. 9. From Fig. 9, the smallest spatial
filter that provides a detection ratio >15 dB should be used and
this corresponded to a 4 × 4 pixel window that represents a
∼160 × 160 μm2 region on the renal surface.
When low detection ratios were present in real data, Fig. 6 C,
D, and F, the surfaces were segmented into one or two clusters
with low PC amongst the pixels in each cluster. These clusters
should not be interpreted as being synchronized, as the PC is
low and without a strong signal the PC is more representative
of noise than MR. Signal quality should be considered when
interpreting clusters.
We found it necessary to have at least 20 oscillations to determine significant PC using the surrogate data approach. This
translates to ∼3–5 min of data for the MR or ∼20–25 min for
TGF. For this reason, we only investigated the MR here. Given
longer datasets, TGF synchronization can be estimated alongside the MR.
Three clustering methods were initially investigated to apply
to the synchronization matrices. Simulation studies (not shown)
using the eigendecomposition or spectral clustering approaches
described in [18] and [25], respectively, showed equivalent results to the NMF method presented. NMF was reported because
it allows for sparse combinations of pixels, but various clustering approaches can be applied. Computational complexity

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

of NMF increases with the size of the synchronization matrix,
which grows with the size of the input image used. In this study,
we used the squared error update method, but alternative NMF
algorithms are available that may reduce processing time [20].
These, or other clustering methods, may be more appropriate
for larger images.
V. CONCLUSION
Renal surfaces can be segmented into regions with high coupling when strong dynamics are present by applying the described analytical approach to LSPI data. The approach identifies temporal synchronization between spatial locations by comparing time-varying changes in perfusion signals and then using
clustering analysis to segment the surface. Dynamics present
in surface perfusion signals are generated by the renal autoregulation mechanisms and synchronization across a large region
of the renal surface may signify coordinated activity among a
number of nephrons. The presented approach enables studies to
determine factors influencing synchronization across the renal
surface and to understand how coordinated renal autoregulation
contributes to highly effective kidney blood flow regulation.
REFERENCES
[1] W. A. Cupples and B. Braam, “Assessment of renal autoregulation,” Amer.
J. Physiol. Renal Physiol., vol. 292, pp. F1105–F1123, Apr. 2007.
[2] R. Beeuwkes III, “Efferent vascular patterns and early vascular-tubular
relations in the dog kidney,” Amer. J. Physiol., vol. 221, pp. 1361–1374,
1971.
[3] K. P. Yip, N. H. Holstein-Rathlou, and D. J. Marsh, “Dynamics of TGFinitiated nephron-nephron interactions in normotensive rats and SHR,”
Amer. J. Physiol. Renal Physiol., vol. 262, pp. F980–F988, Jun. 1, 1992.
[4] N. H. Holstein-Rathlou, “Synchronization of proximal intratubular pressure oscillations: Evidence for interaction between nephrons,” Pflugers
Arch., vol. 408, pp. 438–443, 1987.
[5] N. H. Holstein-Rathlou, O. V. Sosnovtseva, A. N. Pavlov, W. A. Cupples,
C. M. Sorensen, and D. J. Marsh, “Nephron blood flow dynamics measured by laser speckle contrast imaging,” Amer. J. Physiol. Renal Physiol.,
vol. 300, pp. F319–F329, Feb. 1, 2011.
[6] D. J. Marsh, I. Toma, O. V. Sosnovtseva, J. Peti-Peterdi, and
N.-H. Holstein-Rathlou, “Electrotonic vascular signal conduction and
nephron synchronization,” Amer. J. Physiol. Renal Physiol., vol. 296,
pp. F751–F761, Apr. 2009.
[7] D. D. Postnov, D. E. Postnov, D. J. Marsh, N. H. Holstein-Rathlou, and
O. V. Sosnovtseva, “Dynamics of nephron-vascular network,” Bull. Math.
Biol., vol. 74, pp. 2820–2841, 2012.
[8] D. J. Marsh, A. S. Wexler, A. Brazhe, D. E. Postnov, O. V. Sosnovtseva,
and N.-H. Holstein-Rathlou, “Multinephron dynamics on the renal vascular network,” Amer. J. Physiol. Renal Physiol., vol. 304, pp. F88–F102,
Jan. 2013.
[9] W. A. Cupples, “Interactions contributing to kidney blood flow autoregulation,” Curr. Opin. Nephrol. Hypertens., vol. 16, pp. 39–45, 2007.
[10] W. Cupples, A. S. Wexler, and D. J. Marsh, “Model of TGF-proximal
tubule interactions in renal autoregulation,” Amer. J. Physiol.-Renal Physiol., vol. 259, pp. F715–F726, 1990.
[11] D. A. Boas and A. K. Dunn, “Laser speckle contrast imaging in biomedical
optics,” J. Biomed. Opt., vol. 15, pp. 011109–011112, 2010.
[12] C. G. Scully, N. Mitrou, B. Braam, W. A. Cupples, and K. H. Chon, “Detecting physiological systems with laser speckle perfusion imaging of
the renal cortex,” Amer. J. Physiol. Regul. Integr. Comparative Physiol.,
vol. 304, pp. R929–R939, Jun. 1, 2013.
[13] J. M. Hurtado, L. L. Rubchinsky, and K. A. Sigvardt, “Statistical method
for detection of phase-locking episodes in neural oscillations,” J. Neurophysiol., vol. 91, pp. 1883–1898, 2004.
[14] R. Bezemer, M. Legrand, E. Klijn, M. Heger, I. C. Post, T. M. van
Gulik, D. Payen, and C. Ince, “Real-time assessment of renal cortical

SCULLY et al.: SEGMENTATION OF RENAL PERFUSION SIGNALS FROM LASER SPECKLE IMAGING

[15]

[16]

[17]

[18]
[19]
[20]

[21]
[22]
[23]

[24]

microvascular perfusion heterogeneities using near-infrared laser speckle
imaging,” Opt. Exp., vol. 18, pp. 15054–15061, 2010.
J. O’Doherty, P. McNamara, N. T. Clancy, J. G. Enfield, and M. J. Leahy,
“Comparison of instruments for investigation of microcirculatory blood
flow and red blood cell concentration,” J. Biomed. Opt., vol. 14, p. 034025,
2009.
S. Bricq, G. Mahé, D. Rousseau, A. Humeau-Heurtier, F. ChapeauBlondeau, J. Rojas Varela, and P. Abraham, “Assessing spatial resolution versus sensitivity from laser speckle contrast imaging: Application
to frequency analysis,” Med. Biol. Eng. Comput., vol. 50, pp. 1017–1023,
2012.
F. Mormann, K. Lehnertz, P. David, and C. E. Elger, “Mean phase coherence as a measure for phase synchronization and its application to the EEG
of epilepsy patients,” Phys. D: Nonlinear Phenom., vol. 144, pp. 358–369,
2000.
C. Allefeld, M. Müller, and J. Kurths, “Eigenvalue decomposition as a
generalized synchronization cluster analysis,” Int. J. Bifucation Chaos,
vol. 17, pp. 3493–3497, 2007.
D. D. Lee and H. S. Seung, “Learning the parts of objects by non-negative
matrix factorization,” Nature, vol. 401, pp. 788–791, 1999.
M. W. Berry, M. Browne, A. N. Langville, V. P. Pauca, and
R. J. Plemmons, “Algorithms and applications for approximate nonnegative matrix factorization,” Comput. Stat. Data Anal., vol. 52, pp. 155–173,
2007.
K. Devarajan, “Nonnegative matrix factorization: An analytical and interpretive tool in computational biology,” PLoS Comput. Biol., vol. 4,
p. e1000029, 2008.
J. P. Brunet, P. Tamayo, T. R. Golub, and J. P. Mesirov, “Metagenes and
molecular pattern discovery using matrix factorization,” Proc. Nat. Acad.
Sci. USA, vol. 101, pp. 4164–4169, 2004.
K. H. Chon, Y. Zhong, L. C. Moore, N. H. Holstein-Rathlou, and
W. A. Cupples, “Analysis of nonstationarity in renal autoregulation mechanisms using time-varying transfer and coherence functions,” Amer. J.
Physiol. Regul. Integr. Comparative Physiol., vol. 295, pp. R821–R828,
Sep. 2008.
C. G. Scully, K. L. Siu, W. A. Cupples, B. Braam, and K. H. Chon, “Time–
frequency approaches for the detection of interactions and temporal properties in renal autoregulation,” Ann. Biomed. Eng., vol. 41, pp. 172–184,
Jan. 1, 2013.

1997

[25] C. Allefeld and S. Bialonski, “Detecting synchronization clusters in multivariate time series via coarse-graining of Markov chains,” Phys. Rev. E,
vol. 76, p. 066207, 2007.
[26] H. Wang, K. L. Siu, K. Ju, and K. H. Chon, “A high resolution approach
to estimating time–frequency spectra and their amplitudes,” Ann. Biomed.
Eng., vol. 34, pp. 326–338, 2006.
[27] N. H. Holstein-Rathlou and P. P. Leyssac, “Oscillations in the proximal
intratubular pressure: A mathematical model,” Amer. J. Physiol. Renal
Physiol., vol. 252, pp. F560–F572, Mar. 1, 1987.
[28] K. P. Yip, N. H. Holstein-Rathlou, and D. J. Marsh, “Mechanisms of temporal variation in single-nephron blood flow in rats,” Amer. J. Physiol.
Renal Physiol., vol. 264, pp. F427–F434, Mar. 1, 1993.
[29] W. A. Cupples, P. Novak, V. Novak, and F. C. Salevsky, “Spontaneous
blood pressure fluctuations and renal blood flow dynamics,” Amer. J.
Physiol. Renal Physiol., vol. 270, pp. F82–F89, Jan. 1, 1996.
[30] X. Wang and W. A. Cupples, “Interaction between nitric oxide and renal
myogenic autoregulation in normotensive and hypertensive rats,” Can. J.
Physiol. Pharmacol., vol. 79, pp. 238–245, Mar. 3, 2001.
[31] A. Just and W. J. Arendshorst, “Nitric oxide blunts myogenic autoregulation in rat renal but not skeletal muscle circulation via tubuloglomerular
feedback,” J. Physiol., vol. 569, pp. 959–974, 2005.
[32] A. P. Somlyo and A. V. Somlyo, “Ca2 + sensitivity of smooth muscle
and nonmuscle myosin II: Modulated by G proteins, kinases, and myosin
phosphatase,” Physiol. Rev., vol. 83, pp. 1325–1358, 2003.
[33] V. M. Bolotina, S. Najibi, J. J. Palacino, P. J. Pagano, and R. A. Cohen,
“Nitric oxide directly activates calcium-dependent potassium channels in
vascular smooth muscle,” vol. 368, pp. 850–853, 1994.
[34] K. Tyml, “Role of connexins in microvascular dysfunction during inflammation,” Can. J. Physiol. Pharmacol., vol. 89, pp. 1–12, 2011.

Authors’, photographs and biographies not available at the time of publication.

