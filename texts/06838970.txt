IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

1087

Advanced Insulin Bolus Advisor Based on
Run-To-Run Control and Case-Based Reasoning
Pau Herrero, Peter Pesl, Monika Reddy, Nick Oliver, Pantelis Georgiou, Senior Member, IEEE,
and Christofer Toumazou, Fellow, IEEE

Abstract—This paper presents an advanced insulin bolus advisor for people with diabetes on multiple daily injections or insulin
pump therapy. The proposed system, which runs on a smartphone,
keeps the simplicity of a standard bolus calculator while enhancing its performance by providing more adaptability and flexibility.
This is achieved by means of applying a retrospective optimization of the insulin bolus therapy using a novel combination of
run-to-run (R2R) that uses intermittent continuous glucose monitoring data, and case-based reasoning (CBR). The validity of the
proposed approach has been proven by in-silico studies using the
FDA-accepted UVa-Padova type 1 diabetes simulator. Tests under more realistic in-silico scenarios are achieved by updating the
simulator to emulate intrasubject insulin sensitivity variations and
uncertainty in the capillarity measurements and carbohydrate intake. The CBR(R2R) algorithm performed well in simulations by
significantly reducing the mean blood glucose, increasing the time
in euglycemia and completely eliminating hypoglycaemia. Finally,
compared to an R2R stand-alone version of the algorithm, the
CBR(R2R) algorithm performed better in both adults and adolescent populations, proving the benefit of the utilization of CBR.
In particular, the mean blood glucose improved from 166 ± 39 to
150 ± 16 in the adult populations (p = 0.03) and from 167 ± 25
to 162 ± 23 in the adolescent population (p = 0.06). In addition,
CBR(R2R) was able to completely eliminate hypoglycaemia, while
the R2R alone was not able to do it in the adolescent population.
Index Terms—Artificial intelligence, decision support systems,
diabetes, iterative learning control, knowledge-based systems, runto-run control.

I. INTRODUCTION
YPE 1 diabetes mellitus (T1DM) is a chronic metabolic
disease characterized by an autoimmune destruction of
the insulin-secreting β-cells of the endocrine pancreas. The
resulting absolute insulin deficiency results in hyperglycemia
[i.e., high blood glucose (BG)]. At present, the majority of people with T1DM control their BG levels through multiple daily
injections (before meals and basally) in order to mimic the

T

Manuscript received October 16, 2013; revised May 16, 2014; accepted June
11, 2014. Date of publication June 18, 2014; date of current version May 7,
2015. This work was supported by the National Institute for Health Research
(NIHR) comprehensive biomedical research centres in England. This work was
also supported by the Imperial NIHR Biomedical Research Centre.
P. Herrero, P. Pesl, P. Georgiou, and C. Toumazou are with the Centre for Bio-Inspired Technology, Institute of Biomedical Engineering, Imperial College London, London SW7 2BT, U.K. (e-mail: pherrero@imperial.
ac.uk; peter.pesl@imperial.ac.uk; pantelis@imperial.ac.uk; c.toumazou@
imperial.ac.uk).
M. Reddy and N. Oliver are with the Charing Cross Hospital, Imperial College Healthcare NHS Trust, London W6 8RF, U.K. (e-mail:
nick.oliver@imperial.ac.uk; m.reddy@imperial.ac.uk).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2331896

natural insulin secretion of the pancreatic β-cells and by drawing blood from the fingertips and testing the glucose level with
an electronic glucose meter (self-monitoring of BG) [1], [2]. An
alternative therapy to multiple daily injections is provided by
continuous subcutaneous insulin infusion (insulin pump therapy), which allows variable basal rates of insulin and avoids
multiple uncomfortable injections.
Large intervention trials [3] have shown that tight glycaemic
control prevents long term micro- and macrovascular complications, at the expense of an increased frequency of hypoglycaemia, highlighting the importance of optimizing insulin doses
throughout the day, reducing diabetes complications which
place a heavy burden on health services [2]. Bolus insulin doses
with meals are calculated by estimating carbohydrate intake,
dividing by a fixed carbohydrate: insulin ratio and adding a
correction dose derived from the individuals insulin sensitivity
factor. To automate this process, several algorithms have been
developed [5]–[9]. However, with exception of insulin bolus
calculators incorporated in most of the commercially available
insulin pumps and in some glucose meters [9], none of these
algorithms have been adopted commercially. This lack of commercialization is partly down to economic risk, security issues,
and inertia to change [10], but the main reason for the lack
of available systems is the relatively small therapeutic benefit
achieved by these systems compared with the significant burden
required by the users. For this reason, additional effort toward
more intelligent autonomous systems is required.
The clinical benefit of run-to-run (R2R) control for automatically adjusting the insulin-to-carbohydrate ratio (ICR) parameter of a bolus calculator has been studied with some initial
promising results [11]. However, its applicability is limited by
the assumption of strict repetitiveness in the daily routine of
people with T1DM.
This paper presents an innovative decision support algorithm
for meal insulin dosing that provides enhanced adaptability and
flexibility to current bolus calculators by using R2R control [12]
and case-based reasoning (CBR) [13]. It is important to note that,
unlike existing closed-loop control algorithms for glucose control [14]–[16], which deliver an insulin dose every 5 min based
on a real-time optimization, our proposed algorithm is a decision
support system providing bolus insulin dose recommendations
based on retrospective optimization, which requires approval
by the user. The validity of the presented algorithm is demonstrated through an in-silico study using the UVa-Padova T1DM
simulator [17], which has been modified to incorporate intrasubject variability, noise in the capillary blood measurements,
and uncertainty in the carbohydrate intake. This algorithm has

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1088

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

now been integrated into a user-friendly smartphone platform
for use by subjects with diabetes in a clinical trial.
II. METHODS
A. Insulin Bolus Calculators
Insulin bolus calculators are simple decision support systems incorporated in most of the commercially available insulin
pumps [9], and more recently available within capillary BG
monitors [18]. These calculators consist of a relatively simple
formula [see (1)] that uses subject-specific metabolic parameters to calculate an insulin dose. The standard bolus calculator
is described as
CHO G − GT
+
− IOB
(1)
ICR
ISF
where B is the recommended dose of insulin (IU) to be taken;
CHO is the total amount of carbohydrate in the meal (gram),
ICR is the insulin-to-carbohydrate ratio (g/IU), which describes
how many grams correspond to one unit fast acting insulin; G
is the current capillary BG level (mg/dL); GT is the target BG
level (mg/dL); ISF is the insulin sensitivity factor (mg/l/IU),
which is a personal relation describing how large a drop in
BG one unit of insulin gives rise to; and IOB is the insulinon-board, which describes the amount of insulin still in the
body from previous injections. Different formulas are being
used by different manufacturers to estimate IOB (e.g., linear or
curvilinear), being the linear estimation the simplest one and
described as


t − TB
(2)
IOB = Bk −1 1 −
TIOB
B=

where Bk −1 is the previously administered bolus, t is the time
that IOB wants to be estimated, TB is the time the bolus was
administered, and TIOB is a predefined interval during which
the administered insulin is supposed to be active (e.g., 6 h).
It is important to note that parameters ISF and ICR are usually not constant and may vary depending on parameters such
as circadian rhythms, physical activity levels, hormone cycles,
psychological stress, alcohol consumption, and recurrent illness.
Although some of the most recent commercially available bolus
calculators [18] allow considering some of these effects (e.g.,
exercise and stress), this feature is rarely used due to the significant burden that represents. Although the clinical benefit of
using bolus calculators has been demonstrated [19], [20], their
performance remains suboptimal and to achieve a significant improvement in glycemic control, a more dynamic, personalized,
intelligent system is required. For this purpose, the utilization
of iterative learning control and CBR is proposed.
B. R2R Control
R2R is a control method designed to exploit repetitiveness in
the process that is being controlled [12]. Its purpose is to enhance
performance, using a mechanism of trial and error. Owens et al.
[8] used this idea to exploit the repetitive nature of the insulin
therapy regimen of the diabetic patient. This algorithm uses an
update law that corrects the ICR of (1) for the next day based on

Fig. 1. Graphical representation of the postprandial glucose area under the
curve (AUC) (i.e., striped area). Horizontal dashed line represents the baseline
to calculate the AUC. Vertical dashed line represents the meal ingestion time
(0 h) and the 5 h postprandial period. G is the BG value at the time of meal
ingestion (0 h) and G m in is the minimum glucose values during the postprandial
excursion (5 h).

a performance metric used to evaluate the postprandial glucose
excursion.
A pilot clinical study showed the efficacy of the R2R algorithm in T1DM subjects [11]. However, the R2R algorithm
presents some limitations that may restrict its scope of applicability. First of all, the algorithm requires two capillarity BG
samples to evaluate the postprandial excursion. On top of the
burden that this represents to the subject, the postprandial excursion of a mixed meal depends on the composition, and these
two measurement points may not be valid to evaluate certain
meals. Then, R2R assumes that the insulin therapy regimen of
the person with T1DM is repetitive, which is somewhat unrealistic in many cases. It is important to note that the original
R2R algorithm [11] only distinguishes between three situations
(breakfast, lunch, and dinner). Therefore, the utilization of the
R2R algorithm may be limited to subjects willing to carry out
at least nine capillarity measurements per day and with a very
repetitive daily routine.
C. R2R Using Continuous Glucose Monitoring (CGM) Data
In this study, we propose a new version of the R2R algorithm
that uses CGM data [21] to eliminate the need of the two postprandial measurements. Instead, the postprandial area under the
curve calculated using CGM data is employed. The new update
law to adjust the bolus calculator parameters ICR is as follows:
ICRk +1 = ICRk + K(AUCr − AUCk )

(3)

where K is a tunable gain that represents the aggressiveness of
adaptation of the R2R control algorithm; subindex k + 1 indicates the updated ICR and subindex k the previous ICR; AUCk
is the postprandial glucose area under the curve (e.g., at 5 h) and
AUCr is the reference glucose area under the curve (i.e., target),
which should be determined by an expert based on retrospective
CGM data or a meal tolerance test data. As depicted in Fig. 1,
the AUC is calculated considering the preprandial capillarity
glucose measurement (G) as the baseline.
It is important to note that this update law is based on the
hypothesis that AUC is reasonably linear with respect to the

HERRERO et al.: ADVANCED INSULIN BOLUS ADVISOR BASED ON R2R CONTROL AND CBR

Fig. 2. Glucose concentration resulting from applying the proposed R2R
algorithm over 14 days (single meal) on subject adult 6 of the T1DM simulator
with an initial nonoptimal ICR. Upper and lower dashed lines indicate hyper/hypoglycemia limits (i.e., target zone).

amount of ingested carbohydrates. This hypothesis has been
proven to be satisfied for small to moderate carbohydrate loads
(e.g., CHO < 80 g) [22], and it is also satisfied in the T1DM
simulator [18], even if the meal compositions are different.
Thus, for a known glucose area under the curve AUC1 corresponding to an amount of carbohydrates CHO1 , it is possible
to estimate the area under the curve AUC2 corresponding to a
carbohydrate load CHO2 using the following linear relation:
AUC2 =

AUC1 · CHO2
.
CHO1

(4)

Fig. 2 shows an in-silico example of utilization of the proposed
R2R algorithm, where the ICR of a virtual subject from the
T1DM simulator is initialized to a nonoptimal value, and it
converges toward an optimal value and remains stable in the
glucose target zone (i.e., [70, 180] mg/dl).
Although our novel R2R algorithm already provides more
flexibility in front of different meal composition than the original R2R, this may not be enough to deal with intrasubject insulin
sensitivity variations due to perturbations such as exercise, physiological stress, hormone cycles, or alcohol consumption. For
this reason, we propose the utilization multiples incidences of
the R2R algorithm for each one of the situations that a subject
with T1DM can face (e.g., early high glycemic breakfast with
moderate postexercise). It is worth noting that, even if a R2R
instance for current situation does not exist, a similar instance
could be employed. Dealing with all these possible instances can
be very challenging due to the high combinatorial complexity.
For this reason, we proposed the utilization of CBR.
D. Case-Based Reasoning
CBR [23] is an artificial intelligence technique, which has
been extensively applied in medicine [24]. CBR tries to solve
newly encountered problems by applying the solutions learned
from solving similar problems encountered in the past. This is

Fig. 3.

1089

CBR cycle proposed by Aamodt and Plaza [14].

equivalent to the way a human might solve a problem, recalling
a problem encountered in the past and, depending on whether
the solution was successful or unsuccessful, either applying or
avoiding that solution for the current situation. In CBR, past
situations are stored in cases, which contain knowledge related
to the various aspects of the situation. A case consists of three
major parts: the problem description, the solution to the problem,
and the outcome [23]. According to Aamodt and Plaza [13],
general CBR consists of four steps, as summarized below and,
illustrated in Fig. 3.
1) Retrieve the most similar case(s) from a case base.
2) Reuse the information and knowledge in that case(s) to
solve the problem.
3) Revise the proposed solution based on the obtained outcome.
4) Retain the parts of this experience likely to be useful for
future problem solving.
The use of CBR for diabetes has been centred on the prognosis and risk of developing diabetes [25]. The first project to
use CBR for recommending an insulin dose in diabetes management was the Telematic Management of Insulin-Dependent
Diabetes Mellitus project [26], where a CBR engine was integrated with a rule-based reasoning engine and a probabilistic
model of the effects of insulin on BG levels. More recently, the
4 Diabetes Support System (4DSS) project [27] used CBR as
the primary reasoning modality in a decision support tool for
patients on insulin pump therapy, and introduced other factors
into the calculations, such as life events that can influence BG
levels. However, both systems were focused on providing decision support to the physicians using retrospective data and
not real-time decision support for people with diabetes. In this
study, we propose to use CBR technology to provide to an insulin bolus calculator the required flexibility and adaptability in
diabetes management.

1090

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

III. CBR(R2R) ALGORITHM

average distance function defined as

The proposed CBR algorithm is as follows. A case is defined
by the triplet
C: = {P, S, O}

(5)

where P is a set of parameters describing the problem (i.e.,
meal insulin dose calculation), S is the solution to the problem (i.e., insulin dose), and O is the outcome of applying the
solution S to the problem described by P (i.e., postprandial
excursion evaluation).
Cases are stores in a case base defined as
CB := {C1 , . . . , Ck , . . . , Cn }

(6)

where Ck is the case k in the case base. It is important to note
that the case base is individualized for each subject.
A. Case Parameters
Among the parameters describing the problem of calculating
the insulin dose to cover the ingestion of a meal, we find parameters such as time of ingestion, glucose concentration, meal
information, physical activity, insulin-on-board, psychological
stress, illness, alcohol consumption, and hormone cycles. Although all these parameters may have an influence when calculating an insulin dose, the utilization of a T1DM simulator
for testing the validity of the proposed algorithm limited the
number of parameters that could be considered. The parameters
that could be taken into account are described by
P := {T, G, CHO, E, IOB}

(7)

where T is the time of the day; G is the capillary BG concentration from a capillary measurement at the time of meal intake;
CHO is the estimated amount of ingested carbohydrate, and E
is an external perturbation, such as physical activity; IOB is an
estimation of the insulin on board.
1) Case Solution: The solution S of a case are the parameters
of the bolus calculator and is represented as
S := {ICR, ISF}

(8)

where ICR is the ICR and ISF is the insulin sensitivity factor
reported in (1).
B. Case Outcome
The outcome O of the solution S is defined as
O := {AUC, Gm in }

(9)

where AUC is the area under the curve of the 5-h postprandial glucose excursion, and Gm in is the minimum postprandial
glucose value, both calculated using a CGM (see Fig. 1).
C. Retrieving Step
As stated in Section II-D, the first step of the CBR cycle
consists of retrieving the most similar case from the case base
(CB). Many different techniques have been proposed for retrieving cases from a case library [28]. The retrieving mechanism chosen in the current application is based on a weighted

D=

KP 1 d P 1 + · · · + KP j d P j + · · · + KP n d P n
KP 1 + · · · + K P j + · · · + K P n

(10)

where
dP j =

abs(Pj k − Pj )
[Pj ]

(11)

where Pj is a parameter from the current problem, Pj k is the
corresponding parameter of the retrieved case k from the case
memory, KP j is a weight associated to the parameter Pj , which
needs to be a priori specified by an expert, and allows to assign
the importance of a parameter on the retrieving procedure, and
[Pj ] is the range of feasible values for Pj . Note that some of
these ranges may be subject specific and need to be defined
a priori based on retrospective data. Then, the case from the
case library corresponding to the minimum distance D is the
retrieved case.
Although five parameters have been selected to describe a
case (7), not all of them are required in the retrieving phase.
The only parameters to be considered when comparing them
are the ones that are not used in the bolus calculator formula (1),
which correspond to the parameters that have an influence on the
insulin sensitivity and consequently on the solution of the case
(ICR and ISF). These parameters are: time of meal ingestion
(T ) and physical activity (E). Although these parameters have
a continuous range of variability (e.g., 0–24 h), for the sake of
simplicity and practicality, they were discretised as follows:
1) T:= {breakfast, lunch, dinner}.
2) E:= {none, moderate, intense}.
The decision to categorically divide the parameters into three
parts is motivated by the desire to avoid generating too many
cases because then the system would be very difficult to maintain. However, the number of divisions and their categorical
labeling is something that can be easily customized and personalized, since for certain subjects we may have more divisions
(e.g., subjects enjoying different types of sports). Although the
same parameter value (e.g., moderate exercise) can have a completely different effect on different subjects, the fact that the case
base is individualized makes that the only point that is important
is that the parameter is consistently reported.
Finally, the distance (dP j ) is defined to be equal to 0, 1, or 2
depending on if the values of the compared parameters are the
same (e.g., breakfast and breakfast), adjacent (e.g., breakfast and
lunch), or nonadjacent (e.g., breakfast and dinner); and the range
is 2 for both parameters. The weights for the selected parameters
are referred to as KT and KE and reported in Table III.
D. Reusing Step
Reusing the retrieved solution to solve the current problem is
done by applying the bolus calculator formula stated by (1).
However, in order to robustify the algorithm, the hyperglycaemia correction bolus corresponding to the second term of
(1) is only applied when the preprandial capillary glucose levels
(G) are above or below predefined hyperglycaemia (GH ) and
hypoglycaemia thresholds (GL ).

HERRERO et al.: ADVANCED INSULIN BOLUS ADVISOR BASED ON R2R CONTROL AND CBR

1091

TABLE I
VARIABILITY ON MEAL INGESTION TIME AND CARBOHYDRATE LOAD

E. Revising Step
The revising step consists of updating the solution
{ICR, ISF} of the retrieved case when the obtained outcome
{AUC, Gm in } is not considered satisfactory. Such update rule
is summarized as follows.
If the following condition is satisfied
Gm in ≤ GL

GL
ICRk +1 = ICRk ·
(13)
Gm in
where the subindices k and k + 1 indicate the current and updated ICR values, respectively. Otherwise, if the following condition is satisfied


AUCr
, AUCr · Tol (14)
/
(GL < G ≤ GH ) ∧ AUCk ∈
Tol
where G is the premeal capillary BG measurement and Tol is a
tolerance parameter to avoid unnecessary revisions due to error
measurements and uncertainty in the inputs, then, ICR is revised
using the update rule described by (3).
If none of the previous conditions holds true, no adaptation of
ICR is carried out. It is important to note that the reason why no
adaptation of ICR is done when the condition (GL < G ≤ GH )
does not hold is because a correction bolus is delivered together
with the meal bolus (see Section III-D). Hence, the nonoptimal
outcome cannot be only associated to a nonoptimal ICR, but
also to a nonoptimal ISF.
In order to provide robustness to the algorithm in front of
measurement noise and manual input uncertainty (e.g., CHO
estimation), (14) is required to be satisfied two consecutive times
for the same case in order to be able to update ICR using (3).
For this purpose, a counter associated to each case is employed
which is increased by one each time (14) is satisfied and set to
zero if not.
Finally, parameters ISF (mg/l/IU) is updated based on the
correlation with ICR (g/IU) reported in [30]. This correlation is
described by
(15)

F. Retaining Step
When no similar case to the problem being solved is found in
the case base, a new case is created with a predefined solution.
This new case is then incorporated into the case base for further
optimization and utilization.
G. Safety Constraints
To prevent insulin overdosing, two constraints were incorporated to avoid an excessive update of the solution ICRICRk +1
calculated by (3). The first constraint limits its increment (or
decrement) as follows:
ICRk +1 = min(ICRk +1 , ICRk + S · C · ICR0 )

Lunch

Dinner

[6 am, 8 am]
[30–50]

[12, 2 pm]
[40–70]

[8 pm,10 pm]
[30–60]

(12)

then, ICR is updated as

ISF = 4.44 · ICR.

Time
CHO (grams)

Breakfast

(16)

where C is a tuning constant (see Table III), subindex 0 refers
to initialization value, min is the minimum function, and S is

the sign function defined as S = sgn(ICRk +1 − ICRk ). Then,
another constraint limits the minimum and maximum values of
ICR can take as follows:
ICRk = min(max(ICRm , ICRk ), ICRM )

(17)

where the superindexes m and M refer to the minimum and
maximum predefined values, and min and max are minimum
and maximum functions (see Table III).
IV. In-Silico TESTING
The commercial version of the UVa-Padova T1DM simulator
[17] was used to test the presented CBR(R2R) algorithm. Ten
adult subjects and ten adolescent subjects were used for this
purpose. The ten paediatric subjects available in the simulator,
which have rarely been used in previous studies [30], [31],
were not taken into consideration due to their extreme glucose
dynamics. The chosen basal insulin infusion rate for the in-silico
subjects was the one provided by the default insulin therapy of
the simulator. The selected CGM and insulin pump models to
perform the simulations were the Abbot Freestyle Navigator and
Deltec Cozmo.
A. In-Silico Protocol
A scenario of one-month duration with realistic variability in
meal times (i.e., breakfast, lunch, and dinner) and carbohydrate
intakes was automatically generated. Table I shows the upper
and lower bounds of such variability.
Since the T1DM simulator does not incorporate intrasubject
variability of insulin sensitivity [32] and the effect of physical
activity, such changes were artificially introduced by multiplying the insulin delivery (i.e., bolus and basal) by correction
gains (18) and (19). Insulin sensitivity was considered to vary
along the day following the standard patterns used clinically to
adjust basal insulin rates [33]. Furthermore, insulin sensitivity
was considered to randomly change along the day in order to
simulate changes in lifestyle such as physical exercise and stress
B d = B · KD ,
BA = BA · KD · KA
d

(18)
(19)

where B and BA are calculated bolus and default basal insulin,
superindex d indicates delivered; KD is a gain to simulate intraday variability, which takes the values shown in Table II, and
KA is a gain to simulate interday variability, which randomly
takes a value from the interval [1; 0.8, 1.2] every day.

1092

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

TABLE II
VALUES AND TIME INTERVALS FOR GAIN K D

KD

D. Safety and Efficacy Measures

12 am–4 am

4 am–10 am

10 am–6 pm

6 pm–12 am

0.7

1

1.5

2.5

TABLE III
PARAMETERS VALUES USED FOR THE In Silico TESTING OF THE CBR(R2R)
ALGORITHM
T ol
1.3

K
0.002

C
0.3

ICR m
0.2 ·ICR 0

ICR M
4 ·ICR 0

GT
mg
120
dL

GL
mg
80
dL

GH
mg
180
dL

KT
1

KE
1

TIO B
6h

The following safety and efficacy measures [36] (presented
as Mean ± Standard Deviation) were used: The primary outcome was mean BG (mg/dL); secondary outcomes were percentage of time and incidence below range (any BG < 70
mg/dL), percentage of time within the 70–180 mg/dL target range, percentage of time above range in hyperglycemia
(BG > 180 mg/dL), and BG risk index and risk zones of
the control variability grid analysis (CVGA) [37]. CVGA is
a method for visualization of the extreme glucose excursions
caused by a control algorithm in a group of subjects, with
each subject presented by one data point for any given observation period. CVGA is divided into nine zones (A, B,
lower-B, upper-B, lower-C, upper-C, lower-D, upper-D, E),
being zones A+B (including lower and upper) considered
as optimal control and zones D+E considered as suboptimal
control.

B. Measurement Errors and Uncertainty
Real-time continuous glucose measurements obtained from
the T1DM simulator were used to determine Gm in and AUC
values. Capillary glucose measurements (G) were generated by
adding a 5% error (uniform distribution) to the plasma glucose value generated by the T1DM simulator. The selected 5%
error was based on the American Diabetes Association recommendation of CV < 5% bias [34]. Finally, because subjects
with T1DM introduce significant errors when counting carbohydrates, a 20% error (uniform distribution) was considered in
the estimation of carbohydrates.
C. Tuning and Initialization
Reference area under the curve parameter (AUCr ) was individually determined using a meal tolerance test functionality
provided by the T1DM simulator, which allows obtaining an optimal postprandial glucose excursion. In a real clinical setting,
this parameter could be determined by a clinical expert based on
retrospective CGM data or a meal tolerance test data. The gain
K was tuned to converge toward the solution in a reasonable
time frame (e.g., 1 week); the selection of the values for the remaining parameters, which were the same for all subjects, was
based on the combination of multiple simulations and clinical
knowledge. Note that, in a clinical setting, the gain K could be
calculated using linear regression to best match the clinically
determined dose adjustment as proposed in [11]. Parameter Tol
was chosen to cope with the error due to the CGM sensor, and
parameters GT , ICRm , ICRM , GL , GH , KT , and KE were selected based on clinical expertize. Finally, parameter TIOB was
selected based on the values reported by different pump manufacturers (i.e., 2 h ≤ TIOB ≤ 7 h). Although this parameter
may have a significant intrasubject and intersubject variability,
a conservative value of 6 h was selected for all subjects.
Table III shows the values for these parameters. The parameter ICR0 was initialized to a nonoptimal value obtained
multiplying by 2 the default subject-specific ICR value provided by the T1DM simulator, which allows us to achieve
optimal glycemic control.

V. RESULTS
A. Convergence Analysis
In their work [9], Owen et al. proposed a convergence analysis for their R2R algorithm. However, the same analysis cannot be directly applied to the presented CBR(R2R) algorithm
due to the different nature of the algorithms, i.e., addition of
a CBR algorithm. Nevertheless, it is important to note that
CBR(R2R) is equivalent to multiple incidences of an R2R algorithm. Therefore, by assuming that the information provided
to the CBR(R2R) algorithm is within realistic limits of uncertainty, which allow to correctly retrieve the correct case from
the case base, the convergence analysis of CBR(R2R) is reduced
to the analysis of a single incidence of R2R. Therefore, if the
proposed R2R algorithm is proven to converge, the CBR(R2R)
algorithm is, by extension, also convergent. To carry out a convergence analysis of the R2R algorithm, a scenario containing one meal with carbohydrate load variability of [40, 60]
gram (uniform distribution) was employed. The initial BG was
randomly selected within the range [70,140] mg/dl (uniform
distribution). The analysis was performed by isolating the parameters CHO, capillary BG and CGM measurements while
adding different levels of uncertainty to these parameters. Unlike the convergence analysis proposed in [8], we considered
uncertainties within their realistic bounds and the combination
of such uncertainties. The initial ICR0 for the R2R algorithm
was randomly selected within a range of [0.25 · ICR, 4 · ICR]
(uniform distribution), where ICR is the optimal ICR provided
by the T1DM simulator. Table IV shows the performance of
the R2R algorithm for each case study after 20 iterations together with the results for a bolus calculator without adaptation.
For this purpose, the ten adult subjects of the T1DM simulator
were employed. It can be seen that the algorithm is capable to
converge to the target range, i.e., [70, 180] mg/dl, even when
significant levels of uncertainty are added. Finally, no significant
variability was observed on the number of iterations needed to
converge to the glucose target range for the selected levels of
uncertainty.

HERRERO et al.: ADVANCED INSULIN BOLUS ADVISOR BASED ON R2R CONTROL AND CBR

TABLE IV
CONVERGENCE ANALYSIS

Bolus Calculator
R2R
No Uncertainty
CHO 10%
CHO 20%
CHO 30%
Capillary BG 5%
Capillary BG 10%
Capillary BG 15%
CGM (Freestyle Navigator)
CHO 20% + BG 5% + CGM

1093

VI. DISCUSSION

% time in target

Iterations to reach
90% time in target

63.8±26.3

-

100.0±0.0
99.0±3.3
98.3±5.3
97.6±5.3
100.0±0.0
98.2±5.6
98.1±4.2
98.9±3.3
98.5±3.2

5.3±5.4
5.2±5.1
4.1±4.7
3.3±3.1
3.5±3.2
4.3±4.3
4.5±4.2
3.6±3.3
3.4±2.7

B. CBR(R2R) In-Silico Validation
The CBR(R2R) algorithm was evaluated using the one-month
scenario presented in Section IV-A and four simulation runs.
First of all, an initial simulation run (Run 1) was carried out using the bolus calculator formula (1) with nonoptimal parameters
(ICR and ISF) and without any adaptation. Run 2 consisted of
applying the CBR(R2R) algorithm with a case base containing
a unique case with the same solution as the bolus calculator.
Runs 3 and 4 were like Run 2, but starting from the case base
generated in the corresponding previous runs. In order to evaluate the benefit of enhancing the R2R algorithm with CBR, the
R2R algorithm in a stand-alone mode was executed in the same
scenario. For this purpose, the R2R algorithm in a stand-alone
mode was configured with three instances of the algorithm corresponding to breakfast, lunch, and dinner.
Tables V and VI show the simulation results corresponding
to four runs of the R2R algorithm in a stand-alone mode and
the CBR(R2R) algorithm, respectively. Results are presented as
mean ± 1 standard deviation. Improvement on mean BG levels,
percentage of time in hyper-/hypoglycaemic range, risk index,
as well as percentage in risk zones A + B and D + E of the
CVGA, were analyzed using a paired t-test with a significance
established at p < 0.05.
In Table V (i.e., CBR stand-alone mode), a part from the percentage in time below target, all the metrics corresponding to
the adult population got worse. Although some improvements
were observed in the adolescent population, these ones were
not statistically significant. On the other hand, almost all safety
and efficacy measures showed statistically significant improvements in both populations when the CBR(R2R) algorithm was
employed (see Table VI ).
When comparing the two versions of the algorithm [i.e., R2R
versus CBR(R2R)], the mean BG (i.e., primary outcome) improved from 166 ± 39 to 150 ± 16 in the adult populations and
from 167 ± 25 to 162 ± 23 in the adolescent population. In
addition, CBR(R2R) was able to completely eliminate hypoglycaemia, while the R2R alone was not able to do it in the adolescent population. Fig. 4 shows an example for subject adult#010
comparing the R2R and the CBR(R2R) algorithm during Run 4
of the simulation.

We presented a novel decision support algorithm for insulin
dosing that enhances current standard bolus calculators through
the utilization of an R2R, CBR, and intermittent usage of CGM
data.
Good in-silico results using an FDA-accepted type 1 diabetes simulator were obtained with the presented CBR(R2R)
algorithm. First of all, a convergence analysis for the novel
R2R algorithm was successfully carried out. To evaluate the
incremental benefit of using R2R and CBR, the full version
of the algorithm [i.e., CBR(R2R)] was compared against the
R2R control algorithm in a stand-alone mode. This comparison
demonstrated a clear benefit of using CBR in combination with
R2R with respect to using R2R alone. The R2R stand-alone
version not only underperformed the CBR(R2R) version, but
in some cases (i.e., adult population) performed worse than the
standard bolus calculator. The reason for the poor performance
of the R2R stand-alone version can be explained by its inability to cope with the significant insulin variability introduced in
the simulations. It is important to note that R2R is based on
the assumption of daily repetitiveness in the process, which is
not the case for the employed scenario. The obtained results
demonstrate that the propose CBR(R2R) algorithm is able to
tackle with intrasubject variability and external perturbations,
and robustness in front of uncertain inputs, i.e., carbohydrate
intake and noisy CGM measurements.
It is important to remark that, although very useful for designing and testing purposes, simulators have their limitations.
In general, simulation environments tend to overestimate the
benefits of an intervention, since they do not incorporate all of
the uncertainty and perturbations that occur in the real world.
For this reason, clinical studies are required in order to fully
validate the proposed algorithm. Therefore, modifications in
the current version algorithm may be required when tested
in a real scenario.
Although the proposed algorithm showed robustness against
sensor noise in simulation, CGM technology still presents some
problems of accuracy and reliability that may affect the performance of the proposed algorithm in a real-life setting. One way
to reduce this problem would be the utilization of two sensors
[37]. However, this solution may be too cumbersome for the
subject. Another way to improve sensor accuracy would be to
ask for a postprandial recalibration (e.g., 2 h), which seems a
reasonable measure since it is the recommendation given for
the standard therapy. Finally, in order to deal with sensor failures (e.g., sensor drifts and communication problems), a fault
detection algorithm could be incorporated to the system [31].
It is important to note that the utilization of a CGM device
does not need to be continuous, since the decision support system can still provide advice during the days when no CGM data
are available by using the available cases in the case base, even
if they are not optimal. Obviously, the R2R control update law
can only be executed when these data are available. Therefore,
using the CGM sensor periodically, although it may take longer
to converge an optimal solution, may be beneficial in some cases
because of usability issues.

1094

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

TABLE V
EVALUATION OF THE R2R IN THE STAND-ALONE MODE

10 adults
Run1
Run2
Run3
Run4
p value
10 adolescents
Run1
Run2
Run3
Run4
p value

mean BG
[mg/dl]

% time
below 70

% time
above 180

% time
in target

risk index

% A+B

% D+E

156±12
158±21
163±33
166±39
0.34

0.3±0.5
0.1±0.2
0.0±0.1
0.0±0.0
0.17

24.6±11.5
25.6±16.5
27.0±20.9
28.2±22.7
0.51

75.2±11.7
74.3±16.5
73.0±20.9
71.8±22.7
0.52

5.4±2.2
5.9±3.9
6.9±6.2
7.7±7.6
0.28

44.5±10.7
45.0±15.3
45.1±18.3
44.5±18.6
1

1.9±3.3
2.6±4.8
4.0±7.6
4.7±9.2
0.19

170±20
166±23
167±25
167±25
0.53

0.0±0.0
0.1±0.3
0.1±0.1
0.1±0.1
0.19

36.5±17.8
34.8±19.1
35.2±19.8
35.3±20.2
0.69

63.5±17.8
65.1±19.0
64.7±19.7
64.6±20.2
0.7

7.8±3.5
7.3±3.8
7.5±4.0
7.4±4.0
0.52

38.1±16.2
40.6±18.8
40.3±19.7
39.7±20.4
0.59

3.1±2.6
2.6±2.8
3.0±3.5
2.7±3.5
0.16

*Significant with p < 0.05

TABLE VI
EVALUATION OF THE CBR(R2R) ALGORITHM

10 adults
Run1
Run2
Run3
Run4
p value
10 adolescents
Run1
Run2
Run3
Run4
p value

mean BG
[mg/dl]

% time
below 70

% time
above 180

% time
in target

risk index

% A+B

% D+E

156±12
154±15
151±16
150±16
0.031*

0.3±0.5
0.1±0.2
0.0±0.1
0.0±0.0
0.17

24.6±11.5
23.2±12.3
20.1±13.4
18.1±13.4
0.0032*

75.2±11.7
76.7±12.3
79.9±13.3
81.9±13.4
0.0029*

5.4±2.2
5.1±2.5
4.7±2.5
4.3 ±2.5
0.012*

44.5±10.7
47.2±13.4
51.1±14.5
52.7±15.1
0.019*

1.9±3.3
1.6±3.1
1.5±3.0
1.2±3.0
0.29

170±20
166±22
163±22
162±23
0.0056*

0.0±0.0
0.0±0.0
0.1±0.2
0.0±0.0
-

36.5±17.8
33.5±18.7
31.6±19.3
31.2±19.2
0.017*

63.5±17.8
66.5±18.7
68.3±19.2
68.8±19.2
0.017*

7.8±3.5
7.2±3.6
6.6±3.6
6.4±3.6
0.0021*

38.1±16.2
41.9±17.7
42.7±18.3
43.3±19.5
0.014*

3.1±2.6
2.7±2.6
2.1±2.1
1.4±1.8
0.011*

*Significant with p < 0.05

Fig. 4. Example of glucose traces (adult#010) corresponding to Run 4 for R2R algorithm (dashed line) and for CBR(R2R) algorithm (solid line). Upper and
lower horizontal dashed lines indicate hyper-/hypoglycaemia limits, respectively (i.e., target zone). Triangular markers indicate meals and their corresponding
carbohydrate load.

HERRERO et al.: ADVANCED INSULIN BOLUS ADVISOR BASED ON R2R CONTROL AND CBR

One could argue that the utilization of CBR is unnecessary to
solve the stated problem (i.e., only two parameters to compare)
and that a look-up table containing the multiples incidences of
the R2R algorithm could be used instead. However, it has to be
considered that in a real setting, the number of parameters is
going to be higher and that many problems are not going to be
in the case base. Therefore, CBR offers an elegant solution to
deal with this problem.
Finally, the presented system has been integrated into a smartphone platform with a user-friendly interface and is now being
clinically applied for the treatment of diabetes.

[19]

[20]

[21]

[22]

REFERENCES
[1] A. Schiffrin and M. Belmonte, “Multiple daily self-glucose monitoring:
Its essential role in long-term glucose control in insulin-dependent diabetic patients treated with pump and multiple subcutaneous injections,”
Diabetes Care, vol. 5, no. 5, pp. 479–484, 1982.
[2] A. Flyvbjerg, G. Holt, C. Cockram, and B. J. Goldstein, Textbook of Diabetes: A Clinical Approach, 4th ed. New York, NY, USA Wiley-Blackwell,
2010.
[3] Diabetes Control and Complications Trials Research Group, “The effect of intensive treatment of diabetes on the development and progression of long-term complications in insulin-dependent diabetes mellitus,”
N. Engl. J. Med., vol. 329, pp. 977–986, 1993.
[4] L. H. Chanoch, L. Jovanovic, and Ch. M. Peterson, “The evaluation of
a pocket computer as an aid to insulin dose determination by patients,”
Diabetes Care, vol. 8, no. 2, pp. 172–176, 1985.
[5] A. Schiffrin, M. Mihic, B. S. Leibel, and A. M. Albisser, “Computerassisted insulin dosage adjustment,” Diabetes Care, vol. 8, no. 6,
pp. 545–552, 1985.
[6] F. Chiarelli, S. Tumini, G. Morgese, and A. M. Albisser, “Controlled study
in diabetic children comparing insulin-dosage adjustment by manual and
computer algorithms,” Diabetes Care, vol. 13, no. 10, pp. 1080–1084,
1990.
[7] A. M. Albisser, “Analysis: Toward algorithms in diabetes selfmanagement,” Diabetes Technol. Ther., vol. 5, no. 3, pp. 371–373, 2003.
[8] C. L. Owens, H. Zisser, L. Jovanovic, B. Srinivasan, D. Bonvin, and F. J.
Doyle III, “Run-to-run control of blood glucose concentrations for people
with type 1 diabetes mellitus,” IEEE Trans. Biomed. Eng., vol. 53, no. 6,
pp. 996–1005, Jun. 2006.
[9] H. Zisser, L. Robinson, W. Bevier, E. Dassau, C. Ellingsen, F. J. Doyle,
and L. Jovanovic, “Bolus calculator: A review of four “smart” insulin
pumps,” Diabetes Technol. Ther., vol. 10, no. 6, pp. 441–444, 2008.
[10] B. Bellazzi, “Telemedicine and diabetes management: Current challenges
and future research directions,” J. Diabetes Sci. Technol., vol. 2, no. 1,
pp. 98–104, 2008.
[11] C. C. Palerm, H. Zisser, W. C. Bevier, L. Jovanovič, and F. J. Doyle III,
“Prandial insulin dosing using run-to-run control: application of clinical data and medical expertise to define a suitable performance metric,”
Diabetes Care, vol. 30, no. 5, pp. 1131–1136, 2007.
[12] F. Gao, Y. Wang, and F. J. Doyle, “Survey on iterative learning control,
repetitive control, and run-to-run control,” J. Process Control, vol. 19,
no. 10, pp. 1589–1600, 2009.
[13] A. Aamodt and E. Plaza, “Case-based reasoning: Foundational issues,
methodological variations, and system approaches,” AI Commun., vol. 7,
no. 1, pp. 39–59, 1994.
[14] R. Hovorka, “Closed-loop insulin delivery: From bench to clinical practice,” Nat. Rev. Endocrinol., vol. 7, no. 7, pp. 385–395, 2011.
[15] P. Herrero, P. Georgiou, N. Oliver, D. G. Johnston, and C. Toumazou, “A
bio-inspired glucose controller based on pancreatic beta-cell physiology,”
J. Diabetes Sci. Technol., vol. 6, no. 3, pp. 606–616, 2012.
[16] F. H. El-Khatib, S. J. Russell, D. M. Nathan, R. G. Sutherlin, and
E. R. Damiano, “A bihormonal closed-loop artificial pancreas for type
1 diabetes,” Sci. Transl. Med., vol. 2, no. 27, p. 27ra27, 2010.
[17] B. P. Kovatchev, M. Breton, C. Dalla-Man, and C. Cobelli, “In silico
preclinical trials: A proof of concept in closed-loop control of type 1
diabetes,” J. Diabetes Sci. Technol., vol. 3, no. 1, pp. 44–55, 2009.
[18] S. K. Garg, T. R. Bookout, K. K. McFann, W. C. Kelly, C. Beatson,
S. L. Ellis, R. S. Gutin, and P. A. Gottlieb, “Improved glycemic control
in intensively treated adult subjects with type 1 diabetes using insulin

[23]
[24]
[25]
[26]
[27]

[28]
[29]

[30]
[31]

[32]

[33]
[34]
[35]
[36]

[37]

[38]
[39]

1095

guidance software,” Diabetes Technol. Ther., vol. 10, no. 5, pp. 369–375,
2008.
T. M. Gross, D. Kayne, A. King, C. Rother, and S. Juth, “A bolus calculator
is an effective means of controlling postprandial glycemia in patients on
insulin pump therapy,” Diabetes Technol. Ther., vol. 5, no. 3, pp. 365–369,
2003.
B. Shashaj, E. Busetto, and N. Sulli, “Benefits of a bolus calculator in
pre- and postprandial glycaemic control and meal flexibility of paediatric
patients using continuous subcutaneous insulin infusion (CSII),” Diabet
Med., vol. 25, no. 9, pp. 1036–1042, 2008.
D. J. Keenan, J. J. Mastrototaro, H. Zisser, K. A. Cooper, G. Raghavendhar, S. W. Lee, J. Yusi, T. S. Bailey, R. L. Brazg, and R. V. Shah, “Accuracy of the enlite 6-day glucose sensor with guardian and Veo calibration algorithms,” Diabetes Technol. Ther., vol. 14, no. 3, pp. 225–231,
2012.
K. J. Marran, B. Davey, and D. G. Segal, “Exponential increase in postprandial blood-glucose exposure with increasing carbohydrate loads using
a linear carbohydrate-to-insulin ratio,” South African Med. J., vol. 103,
no. 7, pp. 461–463, 2013.
J. L. Kolodner, Case-based Reasoning. San Mateo, CA, USA: Morgan
Kaufmann, 1993.
R. Schmidt, A. Holt, I. Bichindaritz, and P. Perner, “Medical applications
in case-based reasoning,” Knowl. Eng. Rev., vol. 20, no. 3, pp. 289–292,
2006.
E. Armengol, A. . Palaudàries, and E. Plaza, “Individual prognosis of
diabetes long-term risks: A CBR approach,” Methods Inf. Med., vol. 40,
no. 1, pp. 46–51, 2001.
R. Bellazzit et al., “A telemedicine support for diabetes management:
The T-IDDM project,” Comput. Methods Programs Biomed., vol. 69,
no. 2, pp. 147–161, 2002.
F. L. Schwartz, S. J. Vernier, J. H. Shubrook, and C. R. Marling, “Evaluating the automated blood glucose pattern detection and case-retrieval
modules of the 4 diabetes support system,” J. Diabetes Sci. Technol.,
vol. 4, no. 6, pp. 1563–1569, 2010.
P. Cunningham, “A taxonomy of similarity mechanisms for case-based
reasoning,” IEEE Trans. Knowl. Data Eng., vol. 21, no. 11, pp. 1532–
1543, Nov. 2009.
A. B. King and D. U. Armstrong, “A prospective evaluation of insulin
dosing recommendations in patients with type 1 diabetes at near normal
glucose control: Bolus dosing,” J. Diabetes Sci. Technol., vol. 1, no. 1,
pp. 42–46, 2007.
P. Soru, G. De Nicolaoa, C. Toffanin, C. D. Man, C. Cobelli, and L. Magni,
“MPC based Artificial Pancreas: Strategies for individualization and meal
compensation,” Annu. Rev. Control, vol. 36, no. 1, pp. 118–128, 2012.
P. Herrero, R. Calm, J. Vehi, J. Armengol, P. Gerogiou, N. Oliver, and
C. Toumazou, “Robust fault detection system for insulin pump therapy
using continuous glucose monitoring,” J. Diabetes Sci. Technol., vol. 6,
no. 5, pp. 1131–1141, 2012.
S. S. Kanderian, S. Weinzimer, G. Voskanyan, and G. M. Steil, “Identification of intraday metabolic profiles during closed-loop glucose control
in individuals with type 1 diabetes,” J. Diabetes Sci. Technol., vol. 3,
no. 5, pp. 1047–1057, 2009.
C. C. Palerm, H. Zisser, L. Jovanovič, and F. J. Doyle III, “A run-to-run
control strategy to adjust basal insulin infusion rates in type 1 diabetes,”
J. Process Control, vol. 18, no. 3–4, pp. 258–265, 2008.
M. Cohen, E. Boyle, C. Delaney, and J. Shaw, “A comparison of blood
glucose meters in Australia,” J. Diabetes Res. Clin. Pract., vol. 71, no. 2,
pp. 113–118, 2006.
W. Clarke and B. Kovatchev, “Statistical tools to analyze continuous glucose monitor data,” Diabetes Technol. Ther., vol. 11, Suppl. 1,
pp. S45–S54, 2009.
L. Magni, D. M. Raimondo, C. Dalla-Man, M. Breton, S. Patek, J.
D. Nicolao, C. Cobelli, and B. P. Kovatchev, “Evaluating the efficacy
of closed-loop glucose regulation via control-variability grid analysis,”
J. Diabetes Sci. Technol., vol. 2, no. 4, pp. 630–635, 2008.
J. R. Castle, A. Pitts, K. Hanavan, R. Muhly, J. El-Youssef,
C. Hughes-Karvetski, B. Kovatchev, and W. K. Ward, “The accuracy
benefit of multiple amperometric glucose sensors in people with type 1
diabetes,” Diabetes Care, vol. 35, no. 4, pp. 706–710, 2012.
J. Shubrook, C. Marling, and F. Schwartz, “Case-based decision support
for patients with type 1 diabetes on insulin pump therapy,” Lecture Notes
Comput. Sci., vol. 5239, pp. 325–339, 2008.
B. P. Kovatchev, D. J. Cox, L. A. Gonder-Frederick, and W. Clarke, “Symmetrization of the blood glucose measurement scale and its applications,”
Diabetes Care, vol. 20, no. 11, pp. 1655–1658, 1997.

1096

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 19, NO. 3, MAY 2015

[40] H. Lee, B. A. Buckingham, D. M. Wilson, and B. W. Bequette, “A closedloop artificial pancreas using model predictive control and a sliding meal
size estimator,” J. Diabetes Sci. Technol., vol. 3, no. 5, pp. 1082–1090,
2009.
[41] G. A. Brunner, M. Ellmerer, G. Sendlhofer, A. Wutte, Z. Trajanoski,
L. Schaupp, F. Quehenberger, P. Wach, G. J. Krejs, and T. R. Pieber,
“Validation of home blood glucose meters with respect to clinical and
analytical approaches,” Diabetes Care, vol. 21, no. 4, pp. 585–590, 1998.
[42] R. L. Mantaras, D. M. McSherry, D. Bridge, D. Leake, B. Smyth, S. Craw,
B. Faltings, M. L. Maher, M. T. Cox, F. Forbus, M. Keane, A. Aamodt,
and I. Watson, “Retrieval, reuse, revision and retention in case-based
reasoning,” Knowl. Eng. Rev., vol. 20, no. 3, pp. 215–240, 2005.
[43] S. D. Patek, M. D. Breton, Y. Chen, C. Solomon, and B. Kovatchev,
“Linear quadratic Gaussian-based closed-loop control of type 1 diabetes,”
J. Diabetes Sci. Technol., vol. 1, no. 6, pp. 834–841, 2007.

Nick Oliver received the B.Sc. degree in molecular
endocrinology and the MBBS degree in medicine
from Imperial College London, London, U.K., in
1996 and 1999, respectively. He then got the MRCP
degree in medicine from the Royal College of Physicians, London, in 2003.
He is currently a Consultant Diabetologist in
Imperial College Healthcare and an Honorary Senior Clinical Lecturer in the Faculty of Medicine,
Imperial College, London. His clinical interest is type
1 diabetes and diabetes technologies including insulin
pumps, glucose sensing, closed-loop control, and telemedicine. He currently
holds several peer reviewed grants for diabetes technology research, including
funding from the Wellcome Trust for the development of a bio-inspired artificial
pancreas for type 1 diabetes. Other active research projects include validation of
a novel microprobe array for continuous glucose monitoring and type 2 diabetes
prevention using mobile phone technology.
Mr. Oliver received a number of Special Awards including the Diabetes UK
Innovator in diabetes.

Pau Herrero received the M.Eng. degree in industrial
engineering from the University of Girona, Girona,
Spain, in 2001, and the Ph.D. degree in control engineering from University of Angers, Angers, France,
and University of Girona, Girona, Spain, in 2006.
After completing his Ph.D., he spent one year
as a Postdoctoral Research Fellow at Doyle’s group,
University of California Santa Barbara, CA, USA,
working on an artificial pancreas project. After his
stay in California, he spent two years at Sant Pau
Hospital, Barcelona, Spain, working as a Research
Fellow within CIBER-BBN research network leading different eHealth projects
for the prevention and management of diabetes. He is currently a Research
Fellow within the Centre for Bio-inspired Technology, Department of Electrical and Electronic Engineering, Imperial College London, London, U.K. His
main research interests include diabetes technology and intelligent antibiotic
prescribing.

Pantelis Georgiou (AM’05–M’08–SM’13) received
the M.Eng. degree in electrical and electronic engineering in 2004, and the Ph.D. degree in 2008 both
from Imperial College London, London, U.K.
He is currently a Lecturer within the Department
of Electrical and Electronic Engineering and is also
the Head of the Bio-inspired Metabolic Technology
Laboratory in the Centre for Bio-Inspired Technology and part of the Medical Engineering Solutions
in Osteoarthritis Centre of Excellence. His research
includes bio-inspired circuits and systems, CMOSbased lab-on-chip technologies, and application of microelectronic technology
to create novel medical devices. He conducted pioneering work on the silicon
beta cell and is now leading the project forward to the development of the first
bio-inspired artificial pancreas for Type I diabetes.
Dr. Georgiou received the IET Mike Sergeant medal of outstanding contribution to engineering in 2013. He is a Member of the IEEE and IET and serves
on the BioCAS and Sensory Systems technical committees of the IEEE CAS
Society. He also serves on the IET Prizes and Awards committee.

Peter Pesl was born in Linz, Austria, in 1985.
He received the Dipl.-Ing. (FH) degree in medical engineering from the Upper Austrian University of Applied Sciences, Linz, Austria, in 2010.
He is currently working toward the Ph.D degree
in electrical and electronic engineering at the Centre for Bio-Inspired Technologies, Imperial College
London, London, U.K.
Since 2011, he has been working as a Research
Assistant in the Institute of Biomedical Engineering, Imperial College London. His research interest
includes emerging technologies in diabetes management such as intelligent decision support systems and closed-loop insulin delivery.

Christofer Toumazou (M’87–SM’99–F’01) received the B.Sc. degree in engineering and the Ph.D.
degree in electrical engineering from Oxford Brookes
University, Oxford, U.K.
He is the Founding Director and Chief Scientist
of the Institute of Biomedical Engineering, Imperial
College London, London, U.K., Research Director
of the Centre for Bio-Inspired Technology, and the
Winston Wong Chair in Biomedical Circuits in the
Department of Electrical and Electronic Engineering.
He is also the Founder of technology-based companies with applications spanning ultra low-power mobile technology and wireless glucose monitors. His research interests include high-frequency analogintegrated circuit design for RF electronics and low-power electronics for
biomedical applications. He has authored more than 700 research papers and
holds 40 patents in the field of semiconductors and healthcare, many of which
are now fully granted PCT.
Dr. Toumazou was the Chairman of the Analog Signal Processing Committee
and the Vice President of Technical Activities for the IEEE Circuits and Systems Society. He founded the IEEE Biomedical Circuits and Systems Society in
2000. He is a Fellow of the Royal Society, the Royal Academy of Engineering,
and the Institution of Electrical Engineers. He is also a Chartered Engineer,
U.K. He received the Royal Academy of Engineering Silver Medal in 2007
for pioneering contributions to British industry. In 2008, he was appointed the
Fellowship of the Royal Academy of Engineering and the Fellowship of the
Royal Society. In 2009, he received the World Technology Award sponsored by
Time Magazine for the Health and Medicine category, followed by the 2011 J.
J. Thomson Medal of the IET. In 2013, he was made a Fellow of the Academy
of Medical Sciences and was conferred the title of Regius Professor during the
Queens 2012 Diamond Jubilee. In 2014, he received the EPO European Inventor’s Award.

Monika Reddy received the MBChB (hons.) degree
from University of Liverpool, Liverpool, U.K., in
2004 and the MRCP degree from the Royal College
of Physicians London, London, U.K., in 2008.
From 2008 to 2011, she worked as a Specialist Registrar (ST3–ST5) in Diabetes and Endocrinology at Northwest London rotation. She is currently
a Clinical Research Fellow at the Department of
Diabetes, Endocrinology, and Metabolic Medicine,
Imperial College London, London. Her main research
interest includes diabetes technology and, in particular, in the clinical evaluation of a bio-inspired artificial pancreas.

