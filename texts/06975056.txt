990

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

A Kalman Filtering Framework for Physiological
Detection of Anxiety-Related Arousal in Children
With Autism Spectrum Disorder
Azadeh Kushki∗ , Ajmal Khan, Jessica Brian, and Evdokia Anagnostou

Abstract—Objective: Anxiety is associated with physiological
changes that can be noninvasively measured using inexpensive
and wearable sensors. These changes provide an objective and
language-free measure of arousal associated with anxiety, which
can complement treatment programs for clinical populations who
have difficulty with introspection, communication, and emotion
recognition. This motivates the development of automatic methods
for detection of anxiety-related arousal using physiology signals.
While several supervised learning methods have been proposed
for this purpose, these methods require regular collection and updating of training data and are, therefore, not suitable for clinical populations, where obtaining labelled data may be challenging
due to impairments in communication and introspection. In this
context, the objective of this paper is to develop an unsupervised
and real-time arousal detection algorithm. Methods: We propose
a learning framework based on the Kalman filtering theory for
detection of physiological arousal based on cardiac activity. The
performance of the system was evaluated on data obtained from
a sample of children with autism spectrum disorder. Results: The
results indicate that the system can detect anxiety-related arousal
in these children with sensitivity and specificity of 99% and 92%,
respectively. Conclusion and significance: Our results show that the
proposed method can detect physiological arousal associated with
anxiety with high accuracy, providing support for technical feasibility of augmenting anxiety treatments with automatic detection
techniques. This approach can ultimately lead to more effective
anxiety treatment for a larger and more diverse population.

I. INTRODUCTION
NXIETY is a state of apprehensive anticipation and is
associated with heightened tension, arousal, and negative valence [1]. Automatic detection of anxiety has received
attention in several fields [2] including human–computer interaction [3], [4], intelligent transport systems [5], security and
access control [6], workload assessment [7], [8], and health
monitoring [9]. More recently, automatic detection of anxiety
has been suggested as a means to provide an objective measure that can complement clinical anxiety treatment programs

A

Manuscript received April 30, 2014; revised August 15, 2014, October 17,
2014, and November 17, 2014; accepted November 23, 2014. Date of publication December 4, 2014; date of current version February 16, 2015. This
work was supported in part by the Ontario Brain Institute, an independent nonprofit corporation, by the Ontario government. Asterisk indicates corresponding
author.
∗ A. Kushki is with the Bloorview Research Institute and the Institute of
Biomaterials and Biomedical Engineering at the University of Toronto, Toronto,
ON M4G1R8, Canada (e-mail: akushki@hollandbloorview.ca).
A. Khan is with the Bloorview Research Institute.
J. Brian and E. Anagnostou are with the Bloorview Research Institute and
also with the Department of Pediatrics at the University of Toronto.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2377555

[10]. In fact, management of physiological symptoms is an integral part of existing treatments. These programs, however, rely
on the individual’s ability to self-reflect and self-recognize the
physiological signs of anxiety and are not well suited to the
needs of clinical populations who have intellectual disability
and/or deficits in communication, introspection, and emotional
self-awareness. An example of such population is individuals
with autism spectrum disorder (ASD). ASD is a prevalent and
complex neurodevelopmental disorder characterized by qualitative impairments in social communication, and by the presence
of restrictive and repetitive behaviors and/or interests. Anxiety is a prevalent, persistent, and disabling comorbidity in ASD
[11]. In addition to its profound negative impact on physical and
mental health [12], [13], anxiety interacts with the core deficits
of ASD to exacerbate symptomatology and increase functional
impairment [14]. Despite the urgency to treat comorbid anxiety in ASD, there is limited evidence supporting treatment
programs in higher functioning individuals, and no evidence
for those who are lower functioning. Key ASD-related barriers to anxiety treatment are impairments in cognitive ability,
communication, emotional awareness, and introspection [15].
Physiological anxiety markers, such as that proposed in this paper, can reduce these barriers to treatment by providing children
with an objective and real-time measure of their arousal level.
Despite this promise, automatic anxiety detection methods have
not been examined in the context of anxiety treatment in clinical
populations to date.
Conceptually, anxiety presents across three interconnected
dimensions: Behavioral (e.g., crying, avoidance, tantrums), subjective cognitive (e.g., maladaptive and negative thoughts), and
physiological [16]. The latter can be noninvasively measured
using inexpensive and wearable sensors and has, therefore, received much attention in studies examining automatic detection
of anxiety. The physiological response to anxiogenic stimuli is
well documented in neurotypical individuals: The stimulus is
perceived and interpreted as a threat by structures in the central nervous system, and peripheral and endocrine systems are
aroused to mobilize the body’s resources for responding to the
situation. This arousal response is often accompanied by a series
of physiological changes that can be measured noninvasively.
These changes include increased cardiovascular activity (e.g.,
increased heart rate), as well as changes in perspiration (measured through electrodermal activity) and skin temperature [17].
A key technical challenge in detection of physiological
arousal is inter- and intrapersonal variations in physiological measures. For example, across individuals, anatomical and

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

KUSHKI et al.: KALMAN FILTERING FRAMEWORK FOR PHYSIOLOGICAL DETECTION OF ANXIETY-RELATED AROUSAL IN CHILDREN

Fig. 1.

991

Overview of existing arousal detection systems.

neurochemical differences result in variability in basal heart rate
and in cardiac reactivity to anxiogenic stimuli. In the same individual, physiological processes (e.g., sinus rhythm) and external
factors such as diet, sleep, or mental and emotional states also
lead to additional heart-rate variability. To model this variability
in physiological responses, several studies have used supervised
methods that rely on training data and have shown that arousal
associated with anxiety can be detected physiologically with
high accuracy. For example, time- and frequency-domain features from 5-min segments of electrocardiography (ECG), electromyography, respiration, and skin conductivity measurements
were used in [5] to classify three stress levels (low, medium,
and high) using discriminant analysis. Leave-one-out classification with 112 samples was used to train and test the system.
Secondary analysis also showed that heart rate and skin conductance measurements provided the highest correlation with stress
levels. In the context of continuous stress monitoring, 60 1-min
segments of ECG, skin conductance, and accelerometery signals
were used in [9] to differentiate periods of physical activity from
mental stress using three classification schemes (decision trees,
Bayesian network, and support network machines). A fuzzy
logic system was proposed by de Santos Sierra et al. [6] to classify stress and baseline conditions using skin conductance and
heart rate measurements. The authors reported detection accuracies above 90% using 7 s of training data. However, it is unclear
whether or not training needed to be performed prior to every
task. Zhai and Barreto [3] proposed a support vector machine
classifier for detecting stress based on cardiac activity, skin conductance, skin temperature, and pupil diameter. In the context of
human–machine interaction, Rani et al. [4], [18], proposed two
classification methods (fuzzy logic and regression tree learning)
for detection of anxiety using cardiac, electrodermal, and electromyographic activity as well as skin temperature. Evaluating
the systems on data from five participants over six, 1-h sessions
[18], the authors concluded that while high accuracies (>90%)
were obtained by the regression tree, this method was sensitive
to the quality of training data. Liu et al. [19], [20], also explored the use of “affect-sensitive” human–machine interaction
to enhance robotic interventions for children with ASD. They
proposed a support vector machine to classify two intensity
levels (low, high) of three affective states (anxiety, liking, and
engagement) using autonomic nervous system (ANS) signals.
The system was evaluated using data from six participants with
ASD (six, 1-h sessions) and an average classification accuracy
of 79.5% was reported for the anxiety state.

The above approaches are supervised learning methods [2]—
that is, they rely on training data collected in known conditions
to learn the associations between physiological patterns and anxiety states. Collection of training data, however, presents several
challenges in clinical populations. For example, obtaining training labels in populations with communication and introspection
challenges is a very challenging task. Moreover, the collection
of training data may be cumbersome for participants, especially
since the data must be regularly updated to reflect time variations in physiological measures. For example, 6 h of training
data per participant were used to train the system proposed by
Liu et al. [19]. This is a requirement that is not suitable for
implementation in therapeutic settings, where the device is used
by a large number of users continuously over long periods of
time.
In this paper, we propose a real-time unsupervised method
for physiological detection of arousal associated with anxiety
and evaluate the performance of the algorithm using data from
children with ASD. To our knowledge, this is the first unsupervised and real-time implementation of a physiological arousal
detection system, and the first evaluation of such a detection
system in a clinical population.
II. BACKGROUND
The arousal detection problem is the problem of choosing
a class ζk ∈ {0, 1} (0: arousal, 1:baseline) at time k given a
set of physiological measurements. Fig. 1 shows an overview
of existing arousal detection systems. The input to the system
is a physiological signal known to change with anxiety-related
arousal as discussed in Section II-A. The signal is then processed to extract time, frequency, and time/frequency features
correlated with arousal. These features serve as the input into
a classification system which decides if the observed features
belongs to a baseline or arousal class. The classification system
involves learning a representation of the two classes and a decision rule for determining which of the two classes best explains
the measurement. Further details of classification algorithms are
discussed in Section II-B.
A. Physiological Features of Anxiety
The anxiety response involves both the central and peripheral
nervous systems. At the central level, cortical and subcortical structures (e.g., amygdala) perceive an anxiogenic stimulus
as a threat and mobilize the body’s fight or flight response.

992

Fig. 2.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Overview of the proposed system.

At the peripheral level, this response manifests as arousal of the
ANS. The ANS is involved in involuntary control of the viscera,
and as such its function can be indirectly quantified by measuring visceral functions. Examples of such functions include
cardiac activity, electrodermal activity (measuring function of
eccrine sweat glands), skin temperature (measuring cutaneous
vasoconstriction), and pupillary activity. Among these, cardiac
activity has received much attention in studies of the ANS fight
or flight response. Autonomic control of the heart is achieved
through sympathetic and parasympathetic influences on the cardiac muscle, regulating the length of time between consecutive
heartbeats. As such, the cardiac ANS effect is often quantified
by the length of the interbeat intervals, known as the R–R intervals. The fight or flight response arouses the sympathetic branch
of the ANS and suppresses the parasympathetic branch. This
leads to a decrease in R–R intervals and an increase in the heart
rate. Sympathetic influences on the heart occur rather slowly
(0.04–0.15 Hz), whereas parasympathetic influences have a
shorter response latency (0.15–0.4 Hz) [21].
B. Arousal Detection
Existing arousal detection systems learn statistical models
for baseline and arousal classes [5], [6], [9], or determine decision boundaries in the measurement space that separate these
classes [3], [9]. As previously mentioned, these approaches require training samples from both classes prior to and during
system use. In this paper, we propose an unsupervised algorithm for modeling time-varying and stochastic variations in
basal physiological activity and for detecting arousal-related
deviations from this baseline model. Our proposed method differs from previous approaches in that we build a single model
for baseline activity and detect arousal-related deviations from
this model. In particular, we use a Kalman filter to adaptively
estimate a model for baseline physiological signal of interest
given a set of noisy measurements of that signal. Mathematically, denote the physiological signal at time k as xk and its
noisy measurement as yk . The Kalman filter tracks the first two
moments of the density f (xk |yk , . . . , y0 ) over time.
At every time point, the Kalman filter operates in two phases.
In the first phase, a system equation modeling the time dynamics
of the state is used to predict the state variable based on previous
estimates. During the second phase, observed measurements are
used to further refine the state estimate. The second phase relies
on a measurement equation which relates the state variable to
the measurements. This step also produces a set of residuals
(i.e., innovations) that quantify how closely the measurement
matches the state prediction. We propose to use these residuals
to detect deviations from the baseline model.

III. PROPOSED METHOD
Fig. 2 shows an overview of the proposed system. The details
of each system block are discussed in the following sections.
A. Feature Extraction
This system uses R–R intervals obtained through ECG as the
physiological measure of arousal. This choice was based on the
previous work showing significant anxiety-related changes in
R–R intervals [10], which occur on a different time frame than
periodicities in cardiac activity (e.g., respiratory sinus arrhythmia). Cardiac activity along with electrodermal activity has been
suggested to have the highest correlations with perceived anxiety among the physiological signals used in the literature [5].
In this paper, we have chosen not to use electrodermal activity
in the interests of practicality of use in naturalistic settings. In
particular, the most commonly used site for measurement of
electrodermal activity is the palmar surface of the hand. Given
that hands are often used to accomplish daily-living tasks, this
sensing site may be associated with increased movement noise
and user inconvenience.
In terms of ECG, this paper focused on the use of R–R intervals. Given the real-time requirements of the proposed system,
frequency-based ECG features (e.g., respiratory sinus arrhythmia) were not considered. In particular, reliable calculation of
RSA requires buffering 2–5 min of data [21], suggesting that
this feature may be slow to change in presence of arousal.
As previously mentioned, sympathetic and parasympathetic
changes in R–R intervals are relatively slow varying. As such,
we use a slowly varying R–R trend calculated as the average of
R–R intervals in overlapping windows in time
yk 

1
W

k


RRt .

(1)

t=k −W

In the above equation, {RRi }Ti=0 are the R–R intervals extracted from the ECG signal, and W is the window length of
the running average used for computing the R–R trend. Given
that yk are computed from overlapping time windows, we have
k ≤ T.
B. Detection Algorithm
The basic Kalman filter assumes that the state xk can be
described by a single, linear Gaussian model. This assumption is violated in the application of interest where changes
occur in heart-rate dynamics due to switching between baseline and arousal (e.g., increased R–R mean and variance as
well as changes in persistent heart rate rhythms). The practical

KUSHKI et al.: KALMAN FILTERING FRAMEWORK FOR PHYSIOLOGICAL DETECTION OF ANXIETY-RELATED AROUSAL IN CHILDREN

Fig. 3.

993

Overview of the modified Kalman filter.

implication of this violation is that R–R values measured during
arousal states will continue to update the state, causing a drift
in the baseline model and potentially divergence of the filter.
Several extensions of the Kalman filter are proposed to deal
with switching models (e.g., multiple model estimators [22],
Markov jump linear models [23]). However, these approaches
require the a priori specification of system dynamics for both
the baseline and arousal classes. While system dynamics are
generally known for baseline heart rate activity [24], arousal
dynamics are subject to significant inter- and intrapersonal variations and cannot be easily modeled. To address this issue,
we propose to use a modified Kalman filtering algorithm. In
this approach, a single Kalman filter is used to track and update baseline activity, but R–R measurements during arousal
states are considered to be “unreliable” measurements, which
are not used for state refinement. This formulation essentially
models multiple system dynamics without the need for the explicit specification of multiple models.
C. Modified Kalman Filter
We begin by describing the state-space model that governs
the prediction and update steps of the Kalman filter. The state
model for the proposed formulation assumes a constant R–R
trend perturbed by zero mean white Gaussian noise [24]–[26].
This type of random walk model is commonly assumed for
slowly drifting signals where a statistical model based on domain knowledge is unavailable [26]. In this application, the
proposed linear-Gaussian model captures small variations related to the normal sinus rhythm [24]. The measurement model
relates the observed R–R measurement to the state hypothesized
by the state model. We again assume a linear model which accounts for measurement uncertainties through the inclusion of
additive white Gaussian noise. Mathematically, the system and
measurement equations are
xk = xk −1 + wk

(2)

yk = xk + vk

(3)

where, the state variable xk is the ideal slowly varying R–R
trend at time k, and y(k) is defined in (1). The system and
measurement noise processes wk and vk are traditionally defined
as zero-mean, white Gaussian noise with known covariances Qk
and Rk
f (wk ) = N (0, Qk )

(4)

f (vk ) = N (0, Rk ).

(5)

To deal with the switching model challenge, we formulate the
problem as estimating the state of a system in which the arrival
of arousal states is modeled as a Bernoulli process. Therefore,
at time k, the arrival of the arousal state, ζk , is a binary random
variable with parameter 0 < λ < 1 (i.e., pζ k (1) = λ). We also
assume independence of binary variables ζk and ζj for k = j.
We then manipulate the measurement covariance Rk based
on the state ζk . In particular, when the system is in an arousal
state (i.e., ζk = 0), Rk is increased. This increase in uncertainty
of measurements allows the system to reduce the influence of
measurements on the final estimate during the refinement step
of the Kalman filter. Mathematically, the measurement noise is
defined as

ζk −1 = 1
(0, Σk ),
f (Rk |ζk −1 ) =
(6)
(0, N Σk ), ζk −1 = 0
where N ≥ 1 is an integer multiplier of the noise covariance.
We follow the analysis in [27] to arrive at the formulation of a
modified Kalman filter for the model described above. Denote
the state estimate and its covariance at time j given observations
y0 . . . yi as x̂j |i and Pj |i , respectively. Then, given the above
formulation, the state estimate and its covariance are computed
by the modified Kalman filter as follows [27]:
Prediction
x̂k + 1|k = x̂k |k
Pk + 1|k = Pk |k + Qk .
Update
k = yk − x̂k +1|k
Gk = Pk + 1|k

−1
Pk + 1|k + ζk Σk + (1 − ζk )N Σk
x̂k + 1|k + 1 = x̂k + 1|k + Gk k

(7)

Pk + 1|k + 1 = Pk + 1|k − Gk Pk + 1|k .

(8)

The initial values x̂(0|0) and P (0|0), and the noise covariances Qk and Σk are determined from the data. An overview of
the modified Kalman filter is presented in Fig. 3.
D. Estimation of Arousal Level
As a by-product of the estimation procedure, the Kalman
filter provides an error term k , known as the innovation, that

994

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

quantifies deviations from the assumed baseline model. Note
that we expect a decrease in the R–R trend during arousal conditions. The magnitude of the decrease in innovations is used to
determine if deviations from the model are significant enough to
be considered arousal. To achieve this, we propose the following
detection algorithm:
⎧

k
⎨ 1, if ¯k −μ
≥τ
σ k
ζk =
(9)


¯
−μ
k
k
⎩ 0, if
<τ
σ

TABLE I
PARTICIPANT CHARACTERISTICS
Domain
Demographics
ASD Symptomatology

Anxiety Symptomatology

k

where τ is a detection threshold and
1
¯k =
W + 1

k


i

(10)

i = k −W

k


μk =

1
i
k + 1 i=0

(11)

σk =

k
1 
(μ − μ¯k )2 .
k i=0 k

(12)

The above algorithm estimates the short-term innovation
mean as well as the long-term distribution of the innovation
terms. The short-term mean ¯k is then compared against the
expected distribution for the baseline class.
In classical Kalman filtering, the innovation sequence is zero
mean and white with a known covariance. Assuming that innovations follow a Gaussian distribution with first and second
moments specified above, standard statistical tables can be used
to determine the threshold τ such that
Prob (¯
k < τ ) < 1 − α

(13)

where α is a prespecified level for statistical significance. Given
the modeling uncertainties in estimating Qk and Rk as well as
model violations during arousal states, however, we hypothesize that the innovations computed by the proposed filter will
not follow a standard parametric distribution and have opted to
determine τ experimentally.
E. Comments on the Proposed Filter
1) Stability: In the context of systems with intermittent observations, Sinopoli et al. [27] derived stability conditions for
the above filter for linear-Gaussian systems. Adopting that analysis for the proposed system when N → ∞, we note that if
the probability of arrival of a baseline state is λ > 0, then the
expectation of the estimation error covariance is finite.
2) Special Cases: For N = 1, the above modified Kalman
filter is equivalent to the traditional Kalman filter as the gain Gk
reduces to

−1
.
(14)
Gk = Pk + 1|k Pk + 1|k + R
For N → ∞, Gk → 0 when ζk = 0. Therefore, the above filter operates as a tradition Kalman filter in baseline states (i.e.,
ζk = 1). However, in an arousal state, the filter does not perform
any measurement updates. That is, the system prediction is simply propagated forward. This is equivalent to the filter proposed
by Sinopoli et al.[27].

Measure
Age
Full-scale IQ
Sex (male:female)

mean ± SD
11.7 ± 2.8
95.6 ± 18.6
17:7

SCQ
ADOS (modules 2 and 3)
ADOS (module 4)

18.6 ± 7.8
6.2 ± 3.2
8.5 ± 2.7

RCAD-SAD
RCAD-GAD
RCAD-PD
RCAD-SP
RCAD-OCD
RCAD-total anxiety

62.7 ± 18.3
56.9 ± 16.5
56.7 ± 18.6
49.3 ± 9.5
53.1 ± 8.3
56.5 ± 14.9

ADOS: Autism diagnostic observation schedule (comparison score reported for modules 2 and 3 (n = 18); Communication + Social Interaction
total reported for module 4 (n = 6)); SCQ: Social communication questionnaire; SAD: Separation anxiety disorder; GAD: Generalized anxiety
disorder; PD: Panic disorder; SP: Social phobia; OCD: Obsessive compulsive disorder.

3) Suboptimality: The above formulation relies on several
assumptions that may be violated in the application of interest.
These include the independence of system and measurement
noise, as well as that of the binary variables ζk . Nevertheless,
our results indicate that the proposed system provides excellent
accuracy in estimating arousal states.
IV. EXPERIMENTAL PARADIGM
A. Participants
The accuracy of the proposed algorithm was evaluated using
data from a sample of children with ASD (n = 24). All participants had an established clinical diagnosis of ASD based on
Diagnostic and Statistical Manual of Mental Disorders criteriaIV [28]. The diagnosis was further supported by the autism
diagnostic observation schedule (ADOS) [29] and the autism diagnostic interview-revised [30] administered by psychometrists
who had over 80% reliability with expert clinicians certified
on the instruments. Wechsler scales of intelligence (Wechsler
abbreviated scale of intelligence (I and II), and the Wechsler
intelligence scale for children IV) were used to assess intellectual functioning. ASD symptom severity was assessed using the social communication questionnaire and the severity
scores on the ADOS. Anxiety symptomatology was characterized with respect to five DSM-IV anxiety disorders (separation
anxiety disorder, social phobia, generalized anxiety disorder,
obsessive-compulsive disorder, and panic disorder) using the
parent version of the Revised Child Anxiety and Depression
Scale (RCADS-P) [31]. Participant characteristics are summarized in Table I.
The data used herein are a subset of data from a previous
study examining autonomic function in children with ASD [32].
This subset was created by excluding children who were on
medications that affect autonomic function (n = 8) and those
who did not exhibit an ANS response to anxiety (i.e., less than
2 beat/min change in heart rate in response to anxiogenic stimuli) (n = 5). This may have been due to ASD-related atypicalities

KUSHKI et al.: KALMAN FILTERING FRAMEWORK FOR PHYSIOLOGICAL DETECTION OF ANXIETY-RELATED AROUSAL IN CHILDREN

Fig. 4.

Experimental protocol.

or indifference to the particular anxiogenic stimuli used in this
study. Data from three additional participants were excluded as
one did not complete the public speaking task and for the other
two, the R–R noise removal algorithm detected over 5% noise
corruption in the ECG record. There were no statistically significant differences between the group of excluded participants and
those included on any of the demographic and symptomatology domains after correcting for multiple comparisons. Before
correction, the groups were different in scores on the Social
Phobia subscale of the RCADS (included 49.3 ± 2.0, excluded
58.7 ± 3.0; p = 0.02).
B. Tasks
Fig. 4 provides an overview of the experimental protocol.
The data were obtained as part of a larger protocol described
in detail in [32]. Participants completed two anxiogenic tasks,
while seated in front of a computer screen.
1) Color Stroop (color-word interference) test [33]: For this
task, participants completed a computerized single-trial
version of the task which involved the presentation of
words corresponding to color names, printed in differently colored letters. They were asked to name the color
of the letters while ignoring the printed word. The task
consisted of five 1-min blocks in which stimulus presentation frequency varied from 2 to 1.25 s/word (blocks one
and five: 2 s/word, blocks 2 and 4: 1.5 s/word, block 5:
1.25 s/word). During the first and last blocks, only congruent stimuli were presented, whereas the remaining blocks
consisted of only incongruent stimuli. The stroop task is
commonly used as an anxiogenic stimulus in studies of
ANS function [34], [35], including children with ASD
[36].
2) Public speaking: For this task, participants delivered a
3 min talk to a live audience comprising three strangers.
Public speaking tasks have been successfully used in previous studies examining cardiac responses to anxiogenic
stimuli in neurotypical individuals [37]–[39] and in children with ASD [40], [41].
Each task was followed by a baseline condition where participants watched clips of animated movies. Baseline tasks were
5 min in duration. Previous studies have shown that movie
watching is effective in returning heart rate data to baseline levels [10]. Prior to the experiment, participants watched a 15-min
movie clip to acclimate to the laboratory setting and sensors.
C. Measurements
Three-lead electrocardiogram (ECG) was measured using a
wearable sensor from Shimmer research. The ECG time series,

995

sampled at 256 Hz, was transmitted over bluetooth to a laptop
computer and stored. Analyses were carried out offline using
MATLAB. R–R intervals were extracted using a modified version of the algorithms presented in [42] and [43]. In particular,
the ECG signal was bandpass filtered between 5 and 15 Hz to
maximize the QRS energy and to remove artifact noise, including baseline wandering, motion artifacts, and electrical noise.
The signal was then differentiated, squared, and integrated using
a 200 ms window. Peaks of the integrated signals were detected
as R-waves using a detection threshold of 0.15 times the median
of the past ten beats and a blanking period of 200 ms. The RR
sequence then underwent an outlier filtering algorithm which
removed R–R values outside of acceptable limits. High and low
limits were computed as 75% and 150% of the average of the
median of all preceding beats and the median of eight preceding beats. This combination was used to allow for adaptation to
changes in median RR interval over time. The RR series was
uniformly resampled at 2 Hz using cubic interpolation.
D. Performance Evaluation
1) Performance Measure: The performance of the algorithm
was evaluated using classification sensitivity, specificity, and
accuracy defined below
TP
TP + FN
TN
speciﬁcity =
TN + FP
TP + TN
accuracy =
TP + FN + TN + FP

sensitivity =

(15)
(16)
(17)

where true positives (TP) and false negatives (FN) are anxiety
states that correctly and incorrectly identified, respectively. True
negatives (TN) and false positives (FP) are baseline states that
are correctly and incorrectly identified, respectively. To highlight the tradeoff between sensitivity and specificity, results are
presented in the form of receiver operating characteristic curves.
2) Ground Truth: In order to calculate the above measures,
a labeled ground truth set is needed. Two methods are typically used to validate that the tasks have successfully elicited an
arousal reaction namely, self-reports and observation by others
[2].
1) Self-reports: In this paradigm, participants can provide
self-reports of their arousal level throughout the experiment. This would require disengagement from the
anxiogenic stimuli and as such would provide limited
temporal resolution. Moreover, obtaining reliable selfreports of anxiety is a difficult task in the population of
interest as ASD is associated with impairments in emotional awareness, introspection, and communication.
2) Observer reports: The second method for validating the
task is to use other informants (e.g., clinicians or caregivers) to rate anxiety symptoms. This method is also
unreliable in children with ASD due to two key factors.
First, there is significant phenotypic overlap between anxiety and ASD (e.g., repetitive behaviors, compulsions,
avoidance behaviors) and this complicates the differentiation of ASD-related behaviors from those associated with

996

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

anxiety (see for example, [12], [44]). Moreover, anxiety
in ASD has been associated with atypical and idiosyncratic symptom presentation (see [45] and[11]). This also
makes recognition of anxiety symptoms challenging in
ASD as depending on the unique ability and sensory profile of each child, anxiety symptoms may be expressed
differently than those typically associated with anxiety.
In light of the above issues, the use of physiological indicators of arousal is recommended for determining arousal in
this population [12]. We, therefore, considered a physiological response to validating the effectiveness of the stimuli. In
particular, participants who showed a heart rate increase from
baseline that was greater than 2 beats/min were considered to
be in an arousal state. This increase was calculated as the difference between average heart rate during baseline and the task.
Given that the anxiogenic stimuli used in this study have been
validated by several other studies [36], [40], [41], we assume
that participants were in an arousal state associated with anxiety
when engaged in the Stroop and public speaking tasks. As such,
data obtained during these two tasks are labeled as those belonging to an arousal class, whereas data obtained during movie
watching were labeled as baseline. To ensure comparability of
results among tasks, the last 3 min of each task were used for
evaluation, except for the Stroop task where only the incongruent blocks were used (3 min). The filter was applied to the R–R
record from the entire session and the state labels ζk associated
with each measurement y(k) in the intervals of interest were
used to compute sensitivity, specificity, and accuracy.
V. RESULTS
In this section, we evaluate the performance sensitivity of the
proposed system to its parameters, and compare performance
of this system to other methods. Where applicable, the range
of system parameters was limited to ensure the delay in arousal
detection remains shorter than 10 s.

Fig. 5. Effect of the noise covariances on system performance (a) Effect of Q
(N = 5,W = 5s, overlap = 50%, W∈ = 75). (b) Effect of N (Q = 0.0001, W =
5s, overlap = 50%, W∈ = 75).

A. Effect of Model Parameters
The state-space model used in the proposed system [see (2)
and (3)] requires specification of the noise covariances Qk and
Σk . We use the measurements {yk } to estimate R(k) and determine Q(k) = M Σ(k). Fig. 5(a) shows the effect of changing
the ratio of the noise covariances M on system performance.
We see that performance improves as M decreases.
Next, we examine the effect of the parameter N on system
performance [see Fig. 5(a)]. This parameter governs the fading
out of the measurements from refinement of the state estimate
during arousal states and is used to mimic a multiple model
filtering approach. As seen in Fig. 5(b), the best system performance is achieved for N = 5.
B. Effect of Detection Threshold
The threshold τ is used to detect arousal states given the
innovation record from the proposed filter. Fig. 6 shows the
effect of this parameter on system performance. The range
1 < τ < 2 results in optimal system accuracy in this sample.

Fig. 6. Effect of detection threshold on system performance (Q = 0.0001,
N = 5, W = 5 s, overlap = 50%, W  = 75).

KUSHKI et al.: KALMAN FILTERING FRAMEWORK FOR PHYSIOLOGICAL DETECTION OF ANXIETY-RELATED AROUSAL IN CHILDREN

997

Fig. 8. Effect of innovations smoothing window length on system performance (Q = 0.0001, N = 5, W = 5 s, overlap = 50%).

Fig. 7. Effect of trend calculation parameters on system performance
(a) Smoothing window length (Q = 0.0001, N = 5, overlap = 50%, W∈
= 75) (b) (Q = 0.0001, N = 5 W = 5s, W∈ = 75) .
Fig. 9.

Example of the simulated signal.

C. Effect of Trend Parameters
Fig. 7 shows the effect of the parameters used for generating
the slowly varying R–R trend as input to the Kalman filter
(window length W and overlap). A window length of 5 s with
50% overlap provides the optimal performance.
D. Innovation Computation
To detect arousal, long-term and short-term sample mean
and variance of the innovation sequence are compared. Fig. 8
shows how the length of the estimation window W affects
system performance. As seen, W = 75 provides the best system
performance.
E. Delay
Because it is not possible to determine the exact onset of
arousal in our experimental data, the delay analysis used a sim-

ulated R–R signal. Starting with a 15-min baseline, the simulated signal alternated twice between states of baseline and
arousal. The signal was generated as random Gaussian noise
with means and variances determined based on average sample statistics from our participant data (baseline: 0.735 ± 0.06;
arousal: 0.649 ± 0.05). An example of such signal is shown in
Fig. 9. The simulated signal was processed by the filter and the
time of arousal detection was calculated as the time of the first
arousal state after the change in stimulus. The reported results
are averaged over 100 iterations.
The delay in arousal detection is shown in Fig. 10. As seen, the
delay in detecting arousal rises rapidly with increasing smoothing parameter values. To maintain the algorithm delay under
5 s, a value of W = 5 is recommended.
Fig. 11 shows an example of the filter operation using the
simulated signal.

998

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

Fig. 10. Effect of smoothing window lengths on system delay (Q = 0.0001,
N = 5, overlap = 50%).

techniques). Comparison to this technique highlights the
advantages of using a time-varying baseline model.
2) Sliding window baseline model: This approach is similar to the fixed baseline model with the exception that
the mean μ and standard deviation σ of baseline R–R
sequence are computed from a sliding window for every
measurement y(k). The difference between this approach
and the proposed technique is that a priori knowledge
about the system not incorporated in this approach. Therefore, comparison to this technique illustrates the benefits
of using the state-space model for characterizing baseline
activity.
For all algorithms, parameter selection is performed through
threefold cross-validation (data from 16 and 8 participants used
for training and testing, respectively). Average results are reported for ten iterations of cross-validation. The accuracy for
each method is reported in Table II along with the parameters
most frequently chosen during cross-validation, and the algorithm delayed estimated using the simulated signal discussed
in Section V-E. As seen, the proposed method provides the
best performance, followed by the sliding window method, and
the fixed baseline model. The proposed method also incurs the
shortest delay in detection of arousal.
VI. DISCUSSION AND CONCLUSION

Fig. 11. Example of system operation. Signals have been scaled to enhance
readability.

F. Comparison to Other Methods
This paper proposes a Kalman filtering framework for detection of anxiety-related cardiac changes. Through manipulation
of the measurement noise covariance, the proposed system affects the contribution of measurements obtained during arousal
states to the final system estimates. To our knowledge, no other
unsupervised online algorithms for physiological detection of
arousal have been proposed. For completeness, we have compared the performance of the proposed method to two other
algorithms that highlight the features of the proposed system.
1) Fixed baseline model: In this approach, mean μ and standard deviation σ of baseline R–R sequence are computed
from a ten-sample baseline R–R sequence. The detection
algorithm then detects an anxiety state if y(k) < μ − τ σ.
This approach mimics the situation where the baseline
model is assume to be time invariant (e.g., as in supervised

In this paper, we proposed a Kalman filtering framework for
automatic detection of arousal-related cardiac changes. At the
core of the Kalman filter is a state-space model which specifies
the a priori knowledge about system dynamics. As expected,
our results showed that the performance of the proposed system
is affected by the choice of state-space model parameters. In
particular, system performance is sensitive to the choice of the
noise covariances Qk and Rk which specify the uncertainty associated with the system and measurement models, respectively.
They affect the Kalman filter estimate as x̂k + 1|k + 1 is a linear
combination of the prediction x̂k + 1|k and the measurement yk
where the weights are controlled by the noise covariances Qk
and Rk . Our results show that performance improves with decreasing Q. Note that Q = 0 is a degenerate case corresponding
to a system model with no uncertainty. This is consistent with
our assumption of a constant baseline model and the model proposed in [24] for R–R intervals. However, this value may be
not be the best choice in naturalistic settings where baseline RR
activity is often time varying. A small but nonzero Q is, therefore, recommended to allow for some adaptation to changing
baseline conditions.
In the proposed approach, the measurement covariance Rk
is manipulated to mimic a multiple model system. When the
system is in an arousal state, the effect of the measurements is
“faded out” as they are no longer concordant with the baseline
model. As expected, our results show that this fading improves
the performance of the system. We also showed the degree
of fading, specified by the parameter N , affects performance.
Specifically, total fading of measurements was shown to be a
suboptimal approach. Two reasons may contribute to this. First,
recall that the proposed system uses feedback to adjust R(k)

KUSHKI et al.: KALMAN FILTERING FRAMEWORK FOR PHYSIOLOGICAL DETECTION OF ANXIETY-RELATED AROUSAL IN CHILDREN

999

TABLE II
PERFORMANCE COMPARISON

Fixed baseline model
Sliding window baseline model
Proposed method

Sensitivity

Specificity

Accuracy

Parameters

Delay (s)

0.89 ± 0.06
0.94 ± 0.03
0.99 ± 0.01

0.73 ± 0.08
0.87 ± 0.03
0.92 ± 0.03

0.81 ± 0.03
0.90 ± 0.01
0.95 ± 0.01

τ = −0.5, W = 85 s
τ = −0.5, W = 70 s, W  = 40
τ = 2, Q = 0.0001, N = 5, W = 5 s, W  = 75

35
36
4

using state choices ζ(k − 1). As such, detection errors propagate back to the system and affect the choice of R(k). Complete
fading out of measurements (i.e., N → ∞) does not allow recovery from such errors, whereas partial measurement fading
allows the system to slowly readjust its state estimates using
incoming measurements. Our results showed that the system
performance is relatively insensitive to the choice of N in that
a large range of values lead to near-optimal performance. An
interesting direction for future work is adaptive determination
of N based on the innovation signal.
System performance is also affected by parameters used for
generating the measurements y(k) from the R–R sequence. We
proposed to use a slowly varying R–R trend generated as a
moving average of the R–R sequence extracted from the ECG
record. Our results revealed a tradeoff between smoothing the
R–R intervals to remove high-frequency variability and oversmoothing the arousal-related changes in the R–R signal. Moreover, our results showed that this parameter strongly affects the
system delay.
Overall, our results show that the proposed method can detect
physiological arousal associated with anxiety with high accuracy, providing support for technical feasibility of augmenting
anxiety treatments with automatic arousal detection techniques.
While the tasks used in this study have been used extensively to
elicit anxiety-related arousal, we did not explicitly validate the
tasks in this particular study. A few limitations of the algorithm
are also of note. First, although our algorithm does not explicitly
use training data, it does assume that the user is in a baseline
state during the first few minutes of device usage. Given that
this baseline may be obtained relatively quickly (e.g., 5 min) in
everyday activities (e.g., movie watching), this issue does not
pose a significant limitation to functionality of the system. The
second limitation of the present study is that the data used for
system validation in the study were collected under controlled
laboratory settings. Looking forward to the use of such devices
in naturalistic settings, several additional technical challenges
must be addressed. For example, in this study, we have addressed differentiation of baseline from arousal. However, other
mental, cognitive, and affective processes are known to affect
cardiac activity. An interesting avenue for future research is the
development of techniques for differentiation of arousal related
to these processes from that related to anxiety, potentially using other physiological signals such as electrodermal activity.
Future work should examine the performance of this system in
naturalistic settings where environmental noise is present. Finally, we only included participants who showed an increase in
average heart rate from baseline during the anxiety task. This
was done because ASD is associated with atypical autonomic

reactivity to stress [32]. Additional work is needed to examine
the nature of this atypicality and design appropriate algorithms
for detecting different response patterns in this population. Ultimately, clinical trials are needed to examine the effectiveness
of this device in reducing anxiety symptoms in this population
and to determine ability profiles of individuals who can benefit
from this device.
ACKNOWLEDGMENT
The authors would like to thank K. Doyle-Thomas, S. Sobel,
D. D’Alessandro, T. Nantis, S. D. Fragiadakis, N. Peleg, and
J. Au for their contribution to data collection for this study. The
opinions, results, and conclusions are those of the authors and
no endorsement by the Ontario Brain Institute is intended or
should be inferred.
REFERENCES
[1] D. H. Barlow, “Unraveling the mysteries of anxiety and its disorders from
the perspective of emotion theory.” Amer. Psychologist, vol. 55, no. 11,
pp. 1247–1263, 2000.
[2] D. Novak et al., “A survey of methods for data fusion and system adaptation using autonomic nervous system responses in physiological computing,” Interact. Comput., vol. 24, no. 3, pp. 154–172, 2012.
[3] J. Zhai and A. Barreto, “Stress detection in computer users based on digital
signal processing of noninvasive physiological variables,” in Proc. IEEE
28th Annu. Int. Conf. Eng. Med. Biol. Soc., 2006, pp. 1355–1358.
[4] P. Rani et al., “Anxiety detecting robotic system–towards implicit humanrobot collaboration,” Robotica, vol. 22, no. 1, pp. 85–95, 2004.
[5] J. A. Healey and R. W. Picard, “Detecting stress during real-world driving tasks using physiological sensors,” IEEE Trans. Intell. Transp. Syst.,
vol. 6, no. 2, pp. 156–166, Jun. 2005.
[6] A. de Santos Sierra et al., “A stress-detection system based on physiological signals and fuzzy logic,” IEEE Trans. Ind. Electron., vol. 58, no. 10,
pp. 4857–4865, Oct. 2011.
[7] M. J. Skinner and P. A. Simpson, “Workload issues in military tactical
airlift,” Int. J. Aviation Psychol., vol. 12, no. 1, pp. 79–93, 2002.
[8] G. F. Wilson, “An analysis of mental workload in pilots during flight using
multiple psychophysiological measures,” Int. J. Aviation Psychol., vol. 12,
no. 1, pp. 3–18, 2002.
[9] F.-T. Sun et al., “Activity-aware mental stress detection using physiological sensors,” in Proc. Mobile Comput., Appl., Services, New York, NY,
USA, 2012, pp. 211–230.
[10] A. Kushki et al., “Investigating the autonomic nervous system response
to anxiety in children with autism spectrum disorders,” PLoS One, vol. 8,
no. 4, p. e59730, 2013.
[11] S. White et al., “Anxiety in children and adolescents with autism spectrum
disorders,” Clin. Psychol. Rev., vol. 29, no. 3, pp. 216–229, 2009.
[12] B. MacNeil et al., “Anxiety in children and adolescents with autism spectrum disorders,” Res. Autism Spectrum Disorders, vol. 3, no. 1, pp. 1–21,
2009.
[13] J. Reaven, “Children with high-functioning autism spectrum disorders and
co-occurring anxiety symptoms: Implications for assessment and treatment,” J. Spec. Pediatric Nursing, vol. 14, no. 3, pp. 192–199, 2009.
[14] D. Sukhodolsky et al., “Parent-rated anxiety symptoms in children with
pervasive developmental disorders: Frequency and association with core
autism symptoms and cognitive functioning,” J. Abnormal Child Psychol.,
vol. 36, no. 1, pp. 117–128, 2008.

1000

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 3, MARCH 2015

[15] A. Blakeley-Smith et al., “Parent–child agreement of anxiety symptoms in
youth with autism spectrum disorders,” Res. Autism Spectrum Disorders,
vol. 6, no. 2, pp. 707–716, 2012.
[16] P. J. Lang, “Fear reduction and fear behavior: Problems in treating a
construct,” in Proc. Res. Psychotherapy Conf., Chicago, IL, USA, Amer.
Psychological Assoc., 1968, pp. 90–102.
[17] D. Robertson et al., Primer on the Autonomic Nervous System. Amsterdam, The Netherlands: Elsevier, 2011.
[18] P. Rani et al., “Anxiety-based affective communication for implicit
human–machine interaction,” Adv. Eng. Informat., vol. 21, no. 3,
pp. 323–334, 2007.
[19] C. Liu et al., “Online affect detection and robot behavior adaptation for
intervention of children with autism,” IEEE Trans. Robot., vol. 24, no. 4,
pp. 883–896, Aug. 2008.
[20] C. Liu et al., “Physiology-based affect recognition for computer-assisted
intervention of children with autism spectrum disorder,” Int. J. HumanComput. Studies, vol. 66, no. 9, pp. 662–677, 2008.
[21] A. Camm et al., “Heart rate variability: Standards of measurement, physiological interpretation and clinical use. Task force of the European society
of cardiology and the north american society of pacing and electrophysiology,” Circulation, vol. 93, no. 5, pp. 1043–1065, 1996.
[22] Y. Bar-Shalom et al., Estimation With Applications to Tracking and Navigation: Theory Algorithms and Software. New York, NY, USA: Wiley,
2004.
[23] O. L. do Valle Costa et al., Discrete-Time Markov Jump Linear Systems.
New York, NY, USA: Springer, 2006.
[24] D. E. Gustafson et al., “ECG/VCG rhythm diagnosis using statistical signal analysis-I. Identification of persistent rhythms,” IEEE Trans. Biomed.
Eng., vol. BME-25, no. 4, pp. 344–353, Jul. 1978.
[25] D. F. Sittig and K.-H. Cheung, “A parallel implementation of a multistate Kalman filtering algorithm to detect ECG arrhythmias,” Int. J. Clin.
Monitor. Comput., vol. 9, no. 1, pp. 13–22, 1992.
[26] J. McNames and M. Aboy, “Statistical modeling of cardiovascular signals
and parameter estimation based on the extended Kalman filter,” IEEE
Trans. Biomed. Eng., vol. 55, no. 1, pp. 119–129, Jan. 2008.
[27] B. Sinopoli et al., “Kalman filtering with intermittent observations,” IEEE
Trans. Autom. Control, vol. 49, no. 9, pp. 1453–1464, Sep. 2004.
[28] A. P. Association et al., Diagnostic and Statistical Manual of Mental Disorders, Text Revision. Washington, DC, USA: Amer. Psychiatric Assoc.,
2000.
[29] C. Lord et al., “The autism diagnostic observation schedule generic:
A standard measure of social and communication deficits associated
with the spectrum of autism,” J. Autism Dev. Disorders, vol. 30, no. 3,
pp. 205–223, 2000.
[30] C. Lord et al., “Autism diagnostic interview-revised: A revised version of
a diagnostic interview for caregivers of individuals with possible pervasive developmental disorders,” J. Autism, Dev. Disorders, vol. 24, no. 5,
pp. 659–685, 1994.
[31] C. Ebesutani et al., “A psychometric analysis of the revised child anxiety
and depression scale-parent version in a clinical sample,” J. Abnormal
Child Psychol., vol. 38, no. 2, pp. 249–260, 2010.

[32] A. Kushki et al., “Functional autonomic nervous system profile in children
with ASD,” Molecular Autism, vol. 5, no. 39, pp. 1–10, 2014.
[33] J. Stroop, “Studies of interference in serial verbal reactions.” J. Exp.
Psychol., vol. 18, no. 6, pp. 643–662, 1935.
[34] M. Fechir et al., “Functional imaging of sympathetic activation during
mental stress,” Neuroimage, vol. 50, no. 2, pp. 847–854, 2010.
[35] Y. Boutcher and S. Boutcher, “Cardiovascular response to stroop: Effect
of verbal response and task difficulty,” Biol. Psychol., vol. 73, no. 3,
pp. 235–241, 2006.
[36] A. Kushki et al., “Investigating the autonomic nervous system response
to anxiety in children with autism spectrum disorders,” PloS One, vol. 8,
no. 4, p. e59730, 2013.
[37] R. R. Behnke and L. W. Carlile, “Special reports: Heart rate as an index of speech anxiety.” Speech Monographs, vol. 38, no. 1, pp. 65–69,
1971.
[38] M. J. Beatty and R. R. Behnke, “Effects of public speaking trait anxiety
and intensity of speaking task on heart rate during performance,” Human
Commun. Res., vol. 18, no. 2, pp. 147–176, 1991.
[39] M. Pörhölä, “Arousal styles during public speaking,” Commun. Edu.,
vol. 51, no. 4, pp. 420–438, 2002.
[40] L. Jansen et al., “Differentiation between autism and multiple complex
developmental disorder in response to psychosocial stress,” Neuropsychopharmacology, vol. 28, no. 3, pp. 582–590, 2003.
[41] T. P. Levine et al., “Physiologic arousal to social stress in children with
autism spectrum disorders: A pilot study,” Res. Autism Spectrum Disorders, vol. 6, no. 1, pp. 177–183, 2012.
[42] J. Pan and W. J. Tompkins, “A real-time QRS detection algorithm,”
IEEE Trans. Biomed. Eng., vol. BME-32, no. 3, pp. 230–236, Mar.
1985.
[43] P. S. Hamilton and W. J. Tompkins, “Quantitative investigation of
QRS detection rules using the MIT/BIH arrhythmia database,” IEEE
Trans. Biomed. Eng., vol. BME-33, no. 12, pp. 1157–1165, Dec.
1986.
[44] J. J. Wood et al., “Cognitive behavioral therapy for anxiety in children
with autism spectrum disorders: A randomized, controlled trial,” J. Child
Psychol. Psychiatry, vol. 50, no. 3, pp. 224–234, 2009.
[45] S. B. Helverschou and H. Martinsen, “Anxiety in people diagnosed with
autism and intellectual disability: Recognition and phenomenology,” Res.
Autism Spectrum Disorders, vol. 5, no. 1, pp. 377–387, 2011.

Authors’ photographs and biographies not available at the time of publication.

