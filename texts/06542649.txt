IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

3141

A Parametric Method to Measure Time-Varying
Linear and Nonlinear Causality With
Applications to EEG Data
Yifan Zhao, Steve A. Billings∗ , Hua-Liang Wei, and Ptolemaios G. Sarrigiannis

Abstract—A linear and nonlinear causality detection method
called the error-reduction-ratio causality (ERRC) test is introduced in this paper to investigate if linear or nonlinear models
should be considered in the study of human electroencephalograph
(EEG) data. In comparison to the traditional Granger methods,
one significant advantage of the ERRC approach is that it can effectively detect the time-varying linear and nonlinear causalities
between two signals without fitting a complete nonlinear model.
Two numerical simulation examples are employed to compare the
performance of the new method with other widely used methods
in the presence of noise and in tracking time-varying causality.
Finally, an application to measure the linear and nonlinear relationships between two EEG signals from different cortical sites for
patients with childhood absence epilepsy is discussed.
Index Terms—Childhood absence, epilepsy, NARMAX, OLS.

I. INTRODUCTION
PILEPSY is one of the most common neurological disorders with a prevalence of around 1% of the world’s population [1]. Many researchers have investigated the analysis of electroencephalograph (EEG) signals in the study of epilepsy in an
attempt to predict the onset of seizure and to aid in the diagnosis
and treatment of this condition. Traditional linear methods including cross correlation [2], coherency [3], power spectrum [4],
and linear statistics [5] have all been widely applied. More recently, some nonlinear methods have been introduced including
nonlinear predictability [6], correlation density [7], Lyapunov
exponents [8], cross-correlation integral [9], similarity measures [10], and recurrence quantification [11]. However, a recent
review by Mormann et al. [12] suggests that the linear and nonlinear methods do not always perform well when blindly applied

E

Manuscript received April 3, 2013; revised May 24, 2013; accepted June 10,
2013. Date of publication June 18, 2013; date of current version October 16,
2013. This work was supported in part by the Engineering and Physical Sciences Research Council, U.K., and by the European Research Council. Asterisk
indicates corresponding author.
Y. Zhao and H.-L. Wei are with the Department of Automatic Control and
System Engineering, University of Sheffield, Sheffield, S10 2TN, U.K. (e-mail:
y.zhao@sheffield.ac.uk; w.hualiang@sheffield.ac.uk).
∗ S. A. Billings is with the Department of Automatic Control and System Engineering, University of Sheffield, Sheffield, S10 2TN, U.K. (e-mail:
s.billings@sheffield.ac.uk).
P. G. Sarrigiannis is with the Department of Clinical Neurophysiology,
Sheffield Teaching Hospitals NHS Foundation Trust, Royal Hallamshire Hospital, Sheffield, S10 2JF, U.K. (e-mail: Ptolemaios.Sarrigiannis@sth.nhs.uk).
Digital Object Identifier 10.1109/TBME.2013.2269766

to EEG data where there are periods of seizure and nonseizure
states. Also the advantage and necessity of nonlinear measures
were questioned by some authors [13], [14], and some authors
started to investigate whether the EEG signals exhibited linear or
nonlinear relationships. Various methods of assessing the linear
or nonlinear interactions between two signals have been developed including the linear Granger causality (LGC) test [15],
directed coherence (DCOH) [3], and nonlinear Granger causality (NGC) test [16], etc. The LGC test which is based on an ARX
model (autoregressive model with external input) can only estimate the linear causality between two signals. To overcome this
limitation, a NARX (nonlinear autoregressive model with external input)-based Granger Causality (NARXGC) method [17]
was presented to detect both linear and nonlinear causalities by
fitting a full nonlinear polynomial model. Another approach,
the DCOH method, is based on the estimation of power spectral
densities using a discrete Fourier transform, but again is only
designed to detect linear relationships. The NGC method is a
nonparametric causality test based on statistics that has largely
been used in the field of finance with few applications to biomedical signals [18]. The advantage of the NGC method is that a full
knowledge of the system model is not required, so theoretically
this can be applied to nonlinear problems. However, several authors have suggested that the result is very sensitive to the value
of the norm tolerance [19], which will also be demonstrated
by an example in this paper. More recently, a few publications
have studied time-dependent directional interactions between
coupled dynamical channels rather than treating the influence
as stationarity [20]–[24] with the detection on very short time
scales.
This paper introduces a parametric causality detection method
in the time domain called the error-reduction-ratio causality
(ERRC) test and it is shown how this can track time-varying
linear and nonlinear causalities between two signals without
fitting a full nonlinear model. There are many potential applications for this new approach, but in this paper, the method is
applied to aid the understanding of the dynamical neural connections for epilepsy patients, and also to guide the selection
of model complexity for causal studies and seizure prediction.
Numerical examples are used to evaluate the performance of
the new algorithm by comparing the results with other methods.
Finally, a real application to EEG data during a typical absence
seizure from some patients with childhood absence epilepsy
is discussed to demonstrate the potential of the method in
neuroscience.

0018-9294 © 2013 IEEE

3142

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

II. METHOD

integral of order 2 [26] is

A. Review of Other Methods



1)
Linear
Granger
Causality:
Let
X
=
x(t)
and Y =


y(t) be two zero-mean discrete time signals, t = 1, . . . , M ,
where M is the data length. The model considered by Granger
[25] assumes that x(t) and y(t) are suitably represented by the
following bivariate ARX model of order c and d:
x(t) =

y(t) =

c


a1,k x(t − k) +

d


k =1

k =1

d


c


b1,k y(t − k) +

k =1

b2,k x(t − k) + ey (t)

(1)

var(Y |Y − )
var(Y |Y − , X − )

(6)

var(Y |Yl− )
var(Y |Yl− , Xl− )

var(Y |Xl− )
= ln
var(Y |Xl− , Xn− , (XY )−
n)

C 2 (Y f , Y p , X p ) C 2 (Y f , Y p )
−
C 2 (Y p , X p )
C 2 (Y p )

B. ERRC Method




Let X = x(t) and Y = y(t) be two zero-mean signals,
t = 1, . . . , M , where M is the data length. Assume that x(t) and
y(t) are suitably represented by the following th-order Volterra
model with a combination of d lagged inputs:
y(t) =

d


b1 (k1 )x(t − k1 )

d
d



+

(3)

(4)

where Xn− denotes the set of nonlinear terms from past information of X alone and (XY )−
n denotes the set of nonlinear terms
coupled by X − and Y − .
3) NGC Test: To simplify notations, let X p (t) = [x(t −
L), . . . , x(t − 1)] be the past of x(t) on the L last observations.
Let X f (t) = [x(t), . . . , x(t + τ )] be the current and future of
x(t) on the τ next observations. Similar notations are used for Y .
A statistic, N GCX →Y , was proposed by Baek and Brock [16]
to represent the causality between these two signals
N GCX →Y =

1x(t)−x(s)< r 1y (t)−y (s)< r

s=L +1,s= t

(2)

where Yl− denotes the set of linear terms from Y − and Xl−
denotes the set of linear terms from X − . The NGC can be
written as
(n )
N ARXGCX →Y

M


k 1 =0

where var(Y |Y − ) denotes the variance of the prediction error
depending only on its own past information, denoted by Y − , and
var(Y |Y − , X − ) denotes the variance of the prediction error
using the model (1), where the past information of X, denoted
by X − , along with Y − are both considered.
2) NARX-Based Granger Causality: Since the LGC method
can only accommodate the linear dynamic interaction, Zhao [17]
extended the Granger method by employing a NARX model,
where nonlinear terms are considered. The Granger causality of
X → Y based on the NARX model can then be written as
(l)

t=L +1

a2,k y(t − k) + ex (t)

where ex (t), ey (t) are white noise sequences.
The level of linear causality defined by Granger X → Y can
then be evaluated as

N ARXGCX →Y = ln

M

1
(M − L)(M − L − 1)

where  •  is the maximum norm and r is a positive scalar.

k =1

LGCX →Y = ln

C 2 (X, Y ) =

(5)

where C 2 is the correlation integral of order 2. For two 1-D
signals X and Y of a length M , a definition of the correlation

b2 (k1 , k2 )x(t − k1 )x(t − k2 )

k 1 =0 k 2 =0

+ ··· +

d


···

k 1 =0

d


b (k1 , · · · , k )

k  =0

× x(t − k1 ) · · · x(t − k )

(7)

where b (k1 , · · · , k ) is the th-order Volterra kernel. The
Volterra series model has been one of the most popular representations for nonlinear systems and has been widely studied
by many authors [27]–[30]. Billings et al. [31], [32] constructed
a linear-in-parameters form using basic function expansions to
express y(t) as
y(t) =

N


θi φi (t)

(8)

i=1

where θi are unknown parameters, N is the number of the
total potential model terms involved, and φi (t) are model terms
generated from a candidate term seed set ϕ(t), written as
ϕ(t) = {x(t), x(t − 1), . . . , x(t − d)}T .

(9)

The forward regression orthogonal least squares algorithm [33]
searches through all the possible candidate model terms to select the most significant model terms which are then included
to build the model term by term. The significance of each of the
selected model terms is measured by an index, called the error
reduction ratio (ERR), which indicates how much (in percentage) of the increment in output variance changes as each new
model term is added.
Equation (8) can be written as Y = P Θ, where
⎤
⎡
⎡
⎤
⎤
⎡ T
y(1)
θ(1)
P (1)
⎥
⎢
⎢ . ⎥
⎥
⎢
..
Y = ⎣ ... ⎦ , P = ⎣
(10)
⎦ , Θ = ⎣ .. ⎦
.
y(M )

P T (M )

θ(N )

ZHAO et al.: PARAMETRIC METHOD TO MEASURE TIME-VARYING LINEAR AND NONLINEAR CAUSALITY



and P T (t) = φ1 (t), . . . , φN (t) . Matrix P can be decomposed as P = W × A, where
⎡
⎤
w1 (1) . . . wN (1)
⎢
⎥
..
..
..
W =⎣
(11)
⎦
.
.
.
w1 (M ) . . . wN (M )
is an orthogonal matrix because
 M

M


T
2
2
w1 (t), . . . ,
wN (t)
W W = Diag
t=1

(12)

t=1

and A is an upper triangular matrix with unity diagonal elements
⎤
⎡
1 a12 a13 · · ·
a1N
1 a23 · · ·
a2N ⎥
⎢
⎥
⎢
..
..
..
⎥.
(13)
A=⎢
.
.
.
⎥
⎢
⎦
⎣
1 aN −1N
1
Therefore, Y = P Θ can be rewritten as Y = W G, where G =
AΘ = [g1 , . . . , gN ]T . The estimation of the original parameters
can be computed from
⎫
θ̂N = ĝN
⎪
⎬
N

.
(14)
aik θ̂k , i = N − 1, . . . , 1 ⎪
θ̂l = ĝi −
⎭

3143

M

3) Compute P ESRk using (15). The search procedure stops
when P ESRk arrives at a minimum.
Assume φi (i = 1, . . . , Nl ) are the linear terms and
φj (j = Nl + 1, . . . , Nl + Nn ) are the nonlinear terms, where
Nl , Nn (Nl + Nn = N ) denote the number of linear and nonlinear terms, respectively. The linear and nonlinear ERR causality
or ERRC from X to Y can be defined as
(l)

ERRCX →Y =
(n )

ERRCX →Y =

t=1

1

[err]i

(17)

N
l +N n

[err]i

(18)

i=N l +1

where [err]i denotes the calculated ERR for the ith term. The
total ERRC from X to Y is defined as
(t)

to monitor the regressor search procedure, where n denotes the
number of selected terms and M denotes the total number of
sampled data. The search procedure stops when P ESRn arrives
at a minimum. The effect of the adjustable parameter λ on the
results is discussed in [34], which suggested that λ should be
chosen between 5 and 10.
The new ERRC method can be summarized by the following. Initially, a set of candidate terms is chosen by selecting the
highest lags  and d in (7). Note that here the aim is to select
a value that is larger than the expected maximum lag, and not
to predetermine which specific lags are required. The latter is
determined by the search algorithm. If in doubt, therefore, a
larger range of lags can be selected initially. However, a large
candidate set requires a large computational time, and to assist in this process, a new fast CA-OLS method [35] has been
proposed that is able to adaptively search for the correct terms
without any preset tolerance and can also considerably reduce
the computational complexity and memory usage. The procedure to compute the values of ERR can then be summarized as
follows:
M
t = 1 w 1 (t)y (t)
.
1) a11 = 1, w1 (t) = φ1 (t), and ĝ1 = 
M
w 2 (t)

Nl

i=1

k =i+1

The cutoff value of ERR, Coﬀ , to stop the search procedure
and determine the number of significant terms is data dependent
and has to be carefully selected, especially when the level of
noise is unknown. The proposed method employs the penalized
error-to-signal ratio (PESR):


n

1
P ESRn =
[err]i
1−
(15)
(1 − λn/M )2
i=1

w (t)φ (t)

2) For k = 2, . . . , N : aik = t= 1M i w 2 (t)k , i = 1, . . . , k −
t=1
i
1, ak k = 1
M
k −1
t = 1 w k (t)y (t)
wk (t) = φk (t)− i=1 aik wi (t), and ĝk = 
.
M
2
t = 1 w k (t)
ERR is used as a criterion for model structure selection
and is defined as

ĝ 2 M w2 (t)
(16)
[err]k = kMt=1 k .
2
t=1 y (t)

ERRCX →Y =

N
l +N n

[err]i .

(19)

i=1

C. Statistical Significance
To determine the statistical significance of the causal influence between two signals, a time-varying threshold was constructed, representing the level of causality above which values had less than a 5% probability of occurring by chance.
The widely used amplitude-adjusted Fourier transform surrogates [36] was employed in this study. This procedure was repeated 100 times, and then, the 95% quantile was determined as
the threshold for each time point. This routine has been applied
in all examples in this paper.
III. SIMULATIONS
A. Example 1
This example aims to evaluate the performance of the proposed method against different levels of noise. Consider a unidirectional model: X causes Y , associated with the ARX model
√
x(t) = 0.95 2x(t − 1) − 0.9025x(t − 2) + ex (t)
y(t) = −0.5x(t − 1) + ey (t)

(20)

where ex (t) and ey (t) are white noise sequences with zero mean
and standard deviations σx and σy , respectively. A total 300
data points were generated with σx = 0.1 with varying signalto-noise-ratio (SNR) levels of the signal Y from −70 to 60 dB
by setting the value of σy . The causality results were obtained
by averaging 100 cases for the same noise level of Y .

3144

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

(a)

(b)

(c)

Fig. 1. Detected causality using the (a) LGC, (b) NGC, and (c) ERRC methods against the SNR level of Y for Example 1, where the solid plots depict the
detected causality and the dashed plots depict the corresponding surrogate threshold.

Because only the linear influence was involved in this example, the LGC, NGC, and ERRC methods were applied for
comparison in performance. For the LGC method, the parameters were set as c = 2 and d = 2. For the NGC method, the parameters were set as L = 2, τ = 1, and r = 0.1. For the ERRC
method, the parameter was set as d = 2. The results of the detected causalities from the three methods against the SNR level
are shown in Fig. 1. For performance comparison, the surrogate
thresholds for three methods were calculated by considering the
influence from the signal X to the signal Y without ey (t). For
the SNR level at −60 dB, all causalities were close to zero as
the contribution of the term x(t − 1) to y(t) was very small due
to high levels of noise. For the SNR level at 50 dB, the value of
ERRC almost arrives at the maximum 1 and the values of LGC
and NGC are highly significant in comparison with the threshold using the surrogates routine. It is expected that the detected
causalities for all three methods will decrease with increasing
noise levels. An important observation is that the tolerance to
detect a significant causality from X to Y for the LGC, NGC,
and ERRC method is −29, 4, and −58 dB, respectively, which
clearly indicates that the ERRC method has the best performance
against the influence of noise.

Fig. 2. Sampled raw data of the signals X and Y with 1000 data points for
Example 2.

B. Example 2
Now consider a case involving time-varying nonlinear connectivity, associated with the following equations:
√
x(t) = 0.95 2x(t − 1) − 0.9025x(t − 2) + ex (t)
y(t) = Cx(t − 1) + (1 − C)x2 (t − 1) + ey (t)

Fig. 3. Dashed plot depicts the linear component of the SNR level versus the
value of C for Example 2; the dotted plot depicts the nonlinear component of
the SNR level versus the value of C for Example 2; the solid plot depicts the
total SNR levels versus the value of C for Example 2.

(21)

where ex (t) and ey (t) were white noise sequences with zero
mean and a standard deviation 0.1. The value of C controls the
proportion of the linear and nonlinear influence from X and
t
, (t =
Y . A total of 1000 points were generated with C = 1000
1, . . . , 1000), which indicates no linear influence from X to Y
at time 0 and no nonlinear influence at time 1000. The raw data
for X and Y are shown in Fig. 2.
A sliding window of size 300 data points was used to track
the time-varying causality. The SNR level of the linear component was calculated for each window in terms of the values of
Cx(t − 1) and ey (t), where only Cx(t − 1) was considered as
the “signal.” This value reflects the true linear causality from X
to Y . The SNR level of the nonlinear component was calculated
for each window in terms of the values of (1 − C)x2 (t − 1)

and ey (t), where only (1 − C)x2 (t − 1) was considered as the
“signal.” This value reflects the true nonlinear causality from X
to Y . These results are illustrated in Fig. 3, where the x-axis
was expressed as C instead of time for ease of understanding.
The linear influence from X and Y , depicted by the dashed
plot, increases following the increase of C and the nonlinear
influence, depicted by the dotted plot, decreases following the
increase of C. The SNR when both linear and nonlinear components are considered as the “signal,” depicted by the solid plot,
floats around 0–10 dB when C < 0.5 and increases gradually
following the increase of C when C > 0.5 due to the higher
amplitude of Y , as shown in Fig. 2.
Since this example involves a nonlinear causal relationship, the NARXGC method was employed instead of the LGC

ZHAO et al.: PARAMETRIC METHOD TO MEASURE TIME-VARYING LINEAR AND NONLINEAR CAUSALITY

(a)

(b)

3145

(c)

Fig. 4. (a) Detected linear, nonlinear, and total causalities using the NARXGC method along with the corresponding surrogate threshold. The thick dashed plot
depicts the linear NARXGC and the thin dashed plot depicts corresponding threshold; the thick dotted plot depicts the nonlinear NARXGC and the thin dotted
plot depicts corresponding threshold; the thick solid plot depicts the total NARXGC and the thin solid plot depicts corresponding threshold. (b) Detected causality
using the NGC method along with the corresponding surrogates threshold for r = 0.1 and r = 0.2. The thick solid plot depicts the NGC when r = 0.2 and the
thin solid plot depicts corresponding threshold; The thick dashed plot depicts the NGC when r = 0.1 and the thin dashed plot depicts the corresponding threshold.
(c) Detected linear, nonlinear, and total causalities using the ERRC method along with the corresponding surrogates threshold with the same plots as those of the
NARXGC method.

method. To apply the NARXGC method, the candidate term set
was chosen as
Xl− = {x(t − 1), x(t − 2)}
Xn− = {x2 (t − 1), x2 (t − 2), x(t − 1)x(t − 2)}
Yl− = {y(t − 1), y(t − 2)}
(XY )−
n = {x(t − 1)y(t − 1), x(t − 1)y(t − 2),
x(t − 2)y(t − 1), x(t − 2)y(t − 2)}.

(22)

For the NGC method, the parameters were set as L = 2, τ = 1,
and r = 0.2. For the ERRC method, the parameter was set as
d = 2. The results of the causality from the three methods versus
the value of C are shown in Fig. 4, where T denotes the surrogate
threshold. It can be observed that both the linear and nonlinear
NARXGCs have an identical trend and follow the correct result
shown in Fig. 3. The linear NARXGC increases following the
increase of C and is statistically significant when C > 0.2. The
nonlinear NARXGC decreases following the increase in C and is
statistically significant when C < 0.85. However, the nonlinear
NARXGC is very close to the threshold when C is around 0.45
and 0.62. The total NARXGC is always statistically significant
over all the values of C.
For the NGC method, the overall causality is always statistically significant over all the values of C when r = 0.2. However,
the selection of r is sensitive to the results. For example, when
r = 0.1, the overall causality is not statistically significant when
C is larger than 0.7.
For the ERRC methods, both the linear and nonlinear causalities follow the correct trend. The linear ERRC is statistically
significant when C > 0.15. The nonlinear ERRC is statistically significant when C < 0.75. Although the tolerance of C
is smaller than that of NARXGC, all values of the nonlinear
ERRC are well above the threshold when C < 0.75. Moreover,
the total ERRC follows the correct values more faithfully than
that generated by the NARXGC method.
The two simulation examples clearly show the improved performance of the new method in comparison with other approaches. From a theoretical point view, the other parametric
methods (the LGC method and the NARXGC method) require

a full linear or nonlinear model to be fitted including modeling
the noise and estimating unbiased parameters. The performance
of these methods is highly dependent on the accuracy of the
fitted model, and if noise is present, this will mean that a recursive estimation procedure has to be implemented to both
estimate the prediction errors and then estimate a noise model
to ensure unbiased parameter estimates. But the ERRC method
does not require the estimation of a full nonlinear model but
selects the terms using the order of contribution of each term
that is independent of any noise and missing model terms. This
characteristic means that noise models do not have to be fitted
thus avoiding any recursion which in turn means shorter data
lengths and hence better fidelity in detecting causality changes
over time. As a statistical method, the performance of the NGC
method depends on the number and distribution of the sampled
data, and moreover, the selection of the parameter r appears to
be sensitive to the results.
IV. APPLICATION TO EEG DATA
This example dataset consists of epileptic samples of scalp
EEG’s recorded by the EEG Laboratory of Neurophysiology,
Sheffield Teaching Hospitals NHS Foundation Trust, Royal Hallamshire Hospital, and was studied to measure the time-varying
linear and nonlinear relationships of two channels using the
ERRC method to better understand the functional organization
of the brain, especially for the intervals before, during and after an epileptic seizure. This research also aims to prove the
necessity of applying nonlinear measures in EEG data.
All applications in this paper focus on data from patients
with childhood absence epilepsy. Scalp EEG signals are synchronous discharges from cerebral neurons detected by electrodes attached to the scalp. An XLTEK 32 channel head-box
(Excel-Tech Ltd.) with the international 10-20 electrode placement system was used. The sampling rate for the data used in
this study was 500 Hz. A total of 32 EEG series were recorded
in parallel from 32 electrodes located on the scalp of an epileptic
patient, while they were having a generalized epileptic seizure
(typical absence). Both bipolar and referential montages were
available. Two bipolar channels, T 3C3, T 4C4, which were located in the left and right sites of the brain, were considered in

3146

Fig. 5.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

Recorded EEG signals of the bipolar channel T 3C 3 and T 4C 4.

Fig. 7.

Recorded EEG signal of the bipolar channel F 7F 3 and F 8F 4.

Fig. 6. Detected time-varying linear and nonlinear causalities for both directions of the channels T 3C 3 and T 4C 4 based on the ERRC method, where
the solid plots depict the detected causality and the dashed plots depict the
corresponding surrogates threshold.

Fig. 8. Detected time-varying linear and nonlinear causalities for both directions of the channels F 7F 3 and F 8F 4 based on the ERRC method, where the
solid plots depict the detected causality and the dashed plots depict corresponding surrogates threshold.

this study. The channel T 3C3 represents the voltage difference
between the channel T 3 and C3.
A section of data with 15 s length was studied starting from
the 882th second of the recording and ending at the 895th second. The raw data are shown in Fig. 5, where the high amplitude
of the regular oscillation at around the frequency 2.80 Hz can be
observed starting around the 886th second and ending around
the 892th second. By studying the dynamics of the linear and
nonlinear relationships for both directions for a long data section including before, during and after the seizure, this study
aims to probe what kind of causality (linear or nonlinear) dominates these three intervals. This research also can help reveal
the dynamic interactions between these two channels from the
ordered state to the disordered state and the opposite directions.
Because it is known that the signals from the left site and
the right site are highly synchronized [37], the setting of p = 3
allows the influence within 6 ms before the considered time. Experimentation showed that a window size of 300 points (0.6 s),
chosen depending on the dominant frequency of the signals, was
appropriate. The results produced by the proposed time-varying
ERRC method are shown in Fig. 6, where the thresholds generated by the surrogates are also illustrated. Inspection of the linear
causalities of T 3C3 → T 4C4 and T 4C4 → T 3C3 shows that

the linear interaction is highly significant during the interval of
seizure, and much less significant or not significant outside of
the seizure period. This observation is not surprising because
the sine-wave-like signal during the seizure can always be approximated by a linear model, which explains why many linear
methods which study interactions of EEG data work well for
data in seizure. The absence of synchronization may cause the
relatively low linear causality outside of the seizure. The observation of the nonlinear causality is more interesting. The nonlinear causalities of both directions are not statistically significant
over all the sampled data, except during a short interval lasting
about 40 ms just before or during the early stages of the seizure
(depending on how to recognize the seizure). This observation
reveals that a strong nonlinear interaction between these two
channels may play an important role to construct the ignition of
seizure. It also proves that it is necessary to use nonlinear methods to investigate the data section just before and the beginning
stage of the seizure. To demonstrate that the above observations
are not occasional, two other bipolar channels F 7F 3 and F 8F 4
from the left and right sites of brain were studied. The raw data
are shown in Fig. 7 and results after applying the above routine
with the same settings are shown in Fig. 8, which tells the same
story.

ZHAO et al.: PARAMETRIC METHOD TO MEASURE TIME-VARYING LINEAR AND NONLINEAR CAUSALITY

(a)

3147

two bipolar channels from the left and right sides of the human
brain. One interesting observation for the studied patients is that
during the seizure, the linear interaction is highly significant,
but this is not the case outside of the seizure. The most striking
result is that a statistically significant nonlinear interaction has
been detected right before or at the beginning stage or at the
end stage of the seizure, but no significant nonlinear interaction
has been detected in the remaining intervals. The relationship
between two EEG signals may not represent the true causality
because the observed relationship could be due to generalized
nature of the process but not due to any causal influence of one
signal to another. There may be a common source to these two
signals that drives the observed relationship. However, inspecting the relationship of all possible channels can reveal the flow
map of signals, which can provide vital information for further
study, such as locating the possible source of the seizure, and
predicting the seizure. The results in this paper suggest that
for the analysis of seizure data, linear techniques are likely to
perform as well as nonlinear techniques. However, the interaction of seizure-free data is much more complex and nonlinear
techniques will be required to reveal the full story.
REFERENCES

(b)
Fig. 9. Recorded raw data and the detected time-varying nonlinear causality
based on the ERRC method for both directions of the channels T 3C 3 and
T 4C 4 for two selected patients. (a) Patient A. (b) Patient B.

The proposed method has been applied to epilepsy data from
20 patients. Different patients exhibit varying characteristics of
nonlinear causality, but similar linear causality. Due to limitations of space, results of nonlinear causality T 3C3 → T 4C4
and T 4C4 → T 3C3 of two selected patients along with the
raw data of T 3C3 and T 4C4 are shown in Fig. 9. For the patient A, the nonlinear causality is statistically significant only at
the end of the seizure. For patient B, the nonlinear causality is
statistically significant only before the seizure.
V. CONCLUSION
The time-varying linear and nonlinear causalities between
two signals have been investigated using a new ERRC method.
In comparison with the traditional Granger causality method,
this method produces causality in terms of a ranked ERR values
without depending on a full knowledge or estimation of a complete and unbiased system model. This is a significant advantage
when full nonlinear models including noise models would normally be required and which are complex to fit. Two simulation
examples demonstrated that the ERRC method has better performance against noise and in tracking time-varying linear and
nonlinear causalities by comparing with the LGC, NGC, and
NARXGC methods. An application of the method to real EEG
data from an epilepsy patient was then discussed by studying

[1] J. F. Annegers, “The treatment of epilepsy: Principle and practice,” in The
Epidemiology in Epilepsy. Baltimore, MD, USA: Williams & Wilkins,
1996.
[2] J. Theiler, “Spurious dimension from correlation algorithms applied to
limited time-series data,” Phys. Rev. A, vol. 34, no. 3, pp. 2427–2432,
1986.
[3] Y. Saito and H. Harashima, “Tracking of information within multichannel
EEG record? Causal analysis in EEG,” in Recent Advances in EEG and
EMG Data Processing, N. Yamaguchi and K. Fujisawa, Eds. New York,
NY, USA: Elsevier, 1981, pp. 133–146.
[4] S. Blanco, R. Q. Quiroga, O. A. Rosso, and S. Kochen, “Time-frequency
analysis of electroencephalogram series,” Phys. Rev. E, vol. 51, no. 3,
pp. 2624–2631, 1995.
[5] P. E. McSharry, L. A. Smith, and L. Tarassenko, “Prediction of epileptic
seizures: Are nonlinear methods relevant?,” Nat. Med., vol. 9, pp. 241–
242, 2003.
[6] K. J. Blinowska and M. Malinowski, “Non-linear and linear forecasting
of the eeg time series,” Biol. Cybern., vol. 66, pp. 159–165, 1991.
[7] D. E. Lerner, “Monitoring changing dynamics with correlation integrals:
Case study of an epileptic seizure,” Phys. Rev. A, vol. 97, pp. 563–576,
1996.
[8] L. D. Iasemidis and J. C. Sackellares, “Chaos theory and epilepsy,” Neuroscientist, vol. 2, pp. 118–126, 1996.
[9] C. E. Elger and K. Lehnertz, “Seizure prediction by non-linear time series
analysis of brain electrical activity,” Eur. J. Neurosci., vol. 10, pp. 786–
789, 1998.
[10] L. V. Quyen, C. Adam, J. Martinerie, M. Baulac, S. Clemenceau, and
F. Varela, “Spatio-temporal characterization of non-linear changes in intracranial activities prior to human temporal lobe seizures,” Eur. J. Neurosci., vol. 12, pp. 2124–2134, 2000.
[11] N. Thomasson, T. J. Hoeppner, C. L. Webber, and J. P. Zbilut, “Recurrence
quantification in epileptic EEGs,” Phys. Lett. A, vol. 279, pp. 94–101,
2001.
[12] F. Mormann, R. G. Andrzejak, C. E. Elge, and K. Lehnert, “Seizure prediction: The long and winding road,” Brain, vol. 130, pp. 314–333, 2007.
[13] P. E. McSharry, L. A. Smith, and L. Tarassenko, “Comparison of predictability of epileptic seizures by a linear and a nonlinear method,” IEEE
Trans. Biomed. Eng., vol. 50, no. 5, pp. 628–633, May 2003.
[14] M. Winterhalder, B. Schelter, T. Maiwald, R. AschenbrennerScheibe,
A. Brandt, A. S.-B. A, and J. Timmer, “Nonlinear dynamics in eeg from
epileptic patients: Is it possible to predict seizures?,” AIP Press Proc.,
vol. 742, pp. 216–221, 2004.
[15] J. Geweke, “Measures of conditional linear dependence and feedback
between time series,” J. Amer. Stat. Assoc., vol. 79, pp. 907–915, 1984.

3148

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 11, NOVEMBER 2013

[16] E. Baek and W. Brock, “A general test for nonlinear Granger causality,”
Working Paper University of Iowa, 1992.
[17] Y. Zhao, S. A. Billings, H. L. Wei, F. He, and P. G. Sarrigiannis, “A
new NARX-based Granger linear and nonlinear causal influence detection
method with applications to eeg data,” J. Neurosci. Methods, vol. 212,
pp. 79–86, 2013.
[18] B. P. Hoekstra, C. G. Diks, M. Allessie, and J. Degoede, “Nonlinear time
series analysis: Methods and applications to atrial fibrillation,” Ann. Ist.
Super. Sanita, vol. 37, no. 3, pp. 325–333, 1992.
[19] B. Gourévitch, R. L. Bouquin-Jeannès, G. Faucon, “Linear and nonlinear
causality between signals: Methods, examples and neurophysiological
applications,” Biol. Cybern., vol. 95, no. 4, pp. 349–369, 2006.
[20] R. G. Andrzajak, A. Ledberg, and G. Deco, “Detecting event-related timedependent directional couplings,” New J. Phys., vol. 8, 2006.
[21] D. Hemmelmann, M. Ungureanu, W. Hesse, T. Wustenberg,
J. R. Reichenbach, O. W. Witte, H. Witte, and L. Leistritz, “Modelling
and analysis of time-variant directed interrelations between brain regions
based on bold-signals,” NeuroImage, vol. 45, pp. 722–737, 2009.
[22] T. Wangner, J. Fell, and K. Lehnertz, “Detecting event-related timedependent directional couplings,” New J. Phys., vol. 12, p. 053031, 2010.
[23] M. Martini, T. A. Kranz, T. Wangner, and K. Lehnertz, “Inferring directional interactions from transient signals with symbolic transfer entropy,”
Phys. Rev. E, vol. 83, p. 011919, 2011.
[24] L. Sommerlade, M. Thiel, B. Platt, A. Plano, G. Riedel, C. Grebogi,
J. Timmer, and B. Schelter, “Inference of Granger causal time-dependent
influences in noisy multivariate time series,” J. Neurosci. Methods,
vol. 203, pp. 173–185, 2012.
[25] C. J. Granger, “Investigating causal relations by econometric models and
cross-spectral methods,” Econometrica, vol. 37, pp. 424–438, 1969.
[26] P. Grassberger and I. Procaccia, “Measuring the strangeness of strange
attractors,” Phy. D, vol. 9, no. 1–2, pp. 189–208, 1983.
[27] P. Marmarelis and V. Marmarelis, Analysis of Physiological Systems.
New York, NY, USA: Plenum, 1978.

[28] M. Schetzen, The Volterra and Wiener Theories of Nonlinear System.
New York, NY, USA: Wiley, 1980.
[29] W. J. Rugh, Nonlinear System Theory: The Volterra/Wiener Approach.
Baltimore, MD, USA: The John Hopkins Univ. Press, 1981.
[30] F. J. Doyle, R. K. Pearson, and B. A. Ogunnaike, Identification and Control Using Volterra Models. New York, NY, USA: Springer-Verlag,
2000.
[31] S. A. Billings, M. Korenberg, and S. Chen, “Identification of non-linear
output-affine systems using an orthogonal least squares algorithm,” Int. J.
Syst. Sci., vol. 19, pp. 1559–1568, 1988.
[32] S. Chen, S. A. Billings, and W. Luo, “Orthogonal least squares methods
and their application to nonlinear system identification,” Int. J. Control,
vol. 50, no. 5, pp. 1873–1896, 1989.
[33] S. A. Billings, S. Chen, and M. Korenberg, “Identification of MIMO nonlinear systems using a forward-regression orthogonal edtimator,” Int. J.
Control, vol. 49, no. 6, pp. 2157–2189, 1989.
[34] S. A. Billings and H. L. Wei, “An adaptive orthogonal search algorithm
for model subset selection and nonlinear system identification,” Int. J.
Control, vol. 81, no. 5, pp. 714–724, 2008.
[35] Y. Zhao, H. L. Wei, and S. A. Billings, “A new adaptive fast cellular automaton neighborhood detection and rule identification algorithm,” IEEE
Trans. Syst., Man., Cybern. B, Cybern., vol. 42, no. 4, pp. 1283–1287,
Aug. 2012.
[36] J. Theiler, S. Eubank, A. Longtin, B. Galdrikian, and J. D. Farmer, “Testing
for nonlinearity in time series: The method of surrogate data,” Physica D:
Nonlinear Phenomena, vol. 58, no. 1–4, pp. 77–94, 1992.
[37] A. K. Engel, P. Konig, A. K. Kreiter, and W. Singer, “Interhemispheric
synchronization of oscillatory neuronal responses in cat. Visual cortex,”
Science, vol. 252, pp. 1177–1179, 1991.

Authors’ photographs and biographies not available at the time of publication.

