IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

1339

Techniques to Improve the Accuracy of Presampling
MTF Measurement in Digital X-ray Imaging Based
on Constrained Spline Regression
Zhongxing Zhou*, Qingzhen Zhu, Huijuan Zhao, Lixin Zhang, Wenjuan Ma, and Feng Gao

Abstract—To develop an effective curve-fitting algorithm with a
regularization term for measuring the modulation transfer function (MTF) of digital radiographic imaging systems, in comparison
with representative prior methods, a C-spline regression technique
based upon the monotonicity and convex/concave shape restrictions of the edge spread function (ESF) was proposed for ESF
estimation in this study. Two types of oversampling techniques
and following four curve-fitting algorithms including the C-spline
regression technique were considered for ESF estimation. A simulated edge image with a known MTF was used for accuracy determination of algorithms. Experimental edge images from two
digital radiography systems were used for statistical evaluation of
each curve-fitting algorithm on MTF measurements uncertainties.
The simulation results show that the C-spline regression algorithm
obtained a minimum MTF measurement error (an average error of
0.12% ± 0.11% and 0.18% ± 0.17% corresponding to two types of
oversampling techniques, respectively, up to the cutoff frequency)
among all curve-fitting algorithms. In the case of experimental edge
images, the C-spline regression algorithm obtained the best uncertainty performance of MTF measurement among four curve-fitting
algorithms for both the Pixarray-100 digital specimen radiography system and Hologic full-field digital mammography system.
Comparisons among MTF estimates using four curve-fitting algorithms revealed that the proposed C-spline regression technique
outperformed other algorithms on MTF measurements accuracy
and uncertainty performance.

Manuscript received October 12, 2013; revised December 8, 2013 and January 15, 2014; accepted January 27, 2014. Date of publication February 6, 2014;
date of current version March 17, 2014. This work was supported in part by the
National Natural Science Foundation of China under Grant 81101106, Grant
61108081, and Grant 81271618, in part by the Tianjin Municipal Government
of China under Grant 12JCQNJC09400 and Grant 13JCZDJC28000, in part by
Research Fund for the Doctoral Program of Higher Education of China under
Grant 20100032120064, Grant 20110032120069, and Grant 20120032110056.
Asterisk indicates corresponding author.
∗ Z. Zhou is with the School of Precision Instrument and Optoelectronics Engineering, Tianjin University, Tianjin 300072 China, and also with the TEDA
ORKING Hi-Tech Co., Ltd., Tianjin 300072 China, and also with the Tianjin
Key Laboratory of Biomedical Detecting Techniques and Instruments, Tianjin
300072, China (e-mail: zhouzhongxing@tju.edu.cn).
Q. Zhu is with the School of Precision Instrument and Optoelectronics Engineering, Tianjin University, Tianjin 300072 China (e-mail: zhushouping@
life.xidian.edu.cn).
H. Zhao, L. Zhang, and F. Gao are with the School of Precision Instrument
and Optoelectronics Engineering, Tianjin University, Tianjin 300072 China,
and also with the Tianjin Key Laboratory of Biomedical Detecting Techniques
and Instruments, Tianjin 300072, China (e-mail: huijuanzhao@tju.edu.cn;
lxzhang@tju.edu.cn; gaofeng@tju.edu.cn).
W. Ma is with the Breast Imaging Department, Tianjin Medical University Cancer Institute and Hospital, Tianjin, 300072 China (e-mail:
mawenjuan2008@163.com).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2304955

Index Terms—C-spline regression, digital X-ray imaging, edge
spread function, modulation transfer function, oversampling
techniques.

I. INTRODUCTION
HE presampling modulation transfer function (MTF) was
introduced as a basis performance measure of a digital
imaging system, and describes the signal transfer characteristics of the system as a function of the spatial frequency [1], [2].
A commonly used technique to measure the MTF is based on the
use of the slanted sharp-edge object that is imaged to produce
an oversampled ESF [3], [4]. The ESF is then differentiated to
obtain the line spread function (LSF), from which the MTF is
calculated by using the Fourier transform [5]. A review of the literature indicates that various investigations have used different
processing algorithms to measure the MTF from such slanted
edge images [6]–[9]. These differences can easily influence the
results for evaluating the characteristics of a digital imaging system which is commonly represented by the detective quantum
efficiency (DQE) [10]. Since the DQE depends on the square
of the MTF, an accurate estimate of the MTF is of particular
importance for DQE determination [11].
Partly to address the previous problem, an international committee developed a standard for MTF calculation [12]. However, until recently there was no universally accepted standard
for measuring the presampling MTF. Given the large amount of
literature on MTF measurements, various processing algorithms
have been proposed to improve the accuracy of MTF estimation.
Among these processing algorithms, notable differences exist in
the procedure of oversampled ESF construction, including ESF
oversampling techniques and following curve fitting procedures
for ESF estimation [6]–[9]. Thus in this study, a comparison
study was made on MTF measurement results obtained by using different algorithms when analyzing the same image data.
The study further aimed to propose an effective method for
MTF estimation based on the underlying physical properties
of both ESF and LSF, in comparison with representative prior
processing algorithms.

T

II. MATERIALS AND METHODS
A. Imaging System
Two data acquisition systems in our institution were used in
this study. One is CMOS-based Pixarray-100 Digital Specimen
Radiography System manufactured by Bioptics, Inc., Tucson,

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1340

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

AZ, USA. Its design is based on a combination of highperformance, flat-panel CMOS detectors and high-resolution
columnar CsI scintillator technologies. The CMOS array is
1024 × 1024 with pixel size of 50 μm × 50 μm, 14 bits gray
levels. The X-ray source is a tungsten source with 0.2 mm beryllium filtration and the focus size of the X-ray tube is 50 μm. In
our study, the X-ray source was operated at 45 kVp, 0.5 mAs,
and the source-to-detector distance was maintained at 1200 mm.
Another data acquisition system is amorphous selenium TFTbased Hologic full-field digital mammography system manufactured by Hologic Inc., Bedford, MA, USA. The image matrix
size is 3328 × 4096 with pixel size of 70 μm × 70 μm, 16 bits
gray levels. The focus size of the X-ray tube is 300 μm. In our
study, the X-ray source was operated at 38 kVp, 4.8 mAs, and
the source-to-detector distance was maintained at 660 mm.
B. Edge Images
In this study, simulated and experimental edge images were
used to evaluate the accuracy and robustness of MTF measurement algorithms, respectively. The simulated edge image
was generated by stacking the lines of pixels. Each line has a
simple analytical exponential function for the edge spread function, resulting in a Lorentzian-shaped MTF [8]. The simulated
slanted-edge image was formed, assuming a 0.1 mm pixel size,
a maximum pixel value of 13 000, a minimum pixel value of
300, and a 2◦ edge angle. Uncorrelated Poisson noise was added
to the simulated edge image with a standard deviation equal to
the square root of the pixel value.
To acquire experimental edge images, the edge object was
placed directly in front of the detector surface and was sloped at
a slight angle(1.5–3◦ ) [12] to generate an oversampled ESF that
had a data interval smaller than the pixel pitch size. According to
the experimental edge images from Pixarray-100 digital dpecimen radiography system and Hologic full-field digital mammography system, the edge angles were determined as 1.61◦
and 1.55◦ , respectively, by Hough transformation [6], [7]. For
each digital radiography system, the edge device was imaged
a total of 15 times for uncertainty performance evaluation on
MTF measurement results.
C. Prior Algorithms
Two commonly used ESF oversampling techniques and three
representative prior curve fitting methods for ESF estimation
were considered and compared with our proposed method based
on C-spline regression.
As for ESF oversampling techniques, some investigations
derived the oversampled ESF by evaluating the entire region of
interest (ROI) in a single step [6], [7], making data reprojection along the edge transition angle and rebinning the raw ESF
data into a fixed bin size ranging from 0.05–0.25 pixel spacing
(we refer to it simply as “oversampling technique (A)” in this
study). Samei et al. suggested a subpixel spatial bin width of
0.1-pixel spacing [6], which was ascertained to provide an acceptable tradeoff between the frequency resolution and noise.
Other investigations derived average oversampled ESFs by analyzing partial ROIs [8], [13], using a “natural” subsampling

pixel spacing dependent on the edge angle (we refer to it simply
as “oversampling technique (B)”). The second type of the oversampling technique always obtained an oversampled ESF with
smaller subpixel spacing at the expense of stronger noise.
Considering curve-fitting procedures for ESF estimation,
three typical curve-fitting algorithms which have been cited as
having the potential to improve the MTF accuracy were evaluated in this study. In 1998, Samei et al. proposed a modestmoving, Gaussian-weighted, polynominal fit to smooth the raw
ESF data [6]. He suggested a fourth-order polynominal and
a window width of 17 subpixels (1.7 pixels) to reduce noise
while maintaining the dampening of high-frequency response
to an acceptable low level (we refer to it simply as “Gaussian
smoothing” method in the following content). In 2003, Samei
and Flynn proposed a new method to eliminate the noise in
the oversampled ESF [7]. In their work, a fourth-order moving
polynomial fit was applied to the ESF, and the window of this fit
was 7 subpixels (we refer to it simply as “moving polynominalfitting” method). According to the new method, Saunders and
Samei obtained more modest result than the previous one to
allow for more accurate MTF measurement of the higher frequency response at the expense of a higher sensitivity to noise.
Another curve-fitting procedure was proposed by Maidment and
Albert in 2002 [9], this method was based upon imposing the
constraint that the ESF was monotonic (we refer to it simply
as “monotonic fitting” method). By using this monotonic fitting
algorithm, ESF data far from the edge is highly constrained,
so that the noise in the MTF results does not increase with
increasing ESF length [9].
D. Constrained C-Spline Regression
Maidment and Albert deduced the monotonic constraint of
the ESF from edge images, and succeeded in imposing this underlying physical principle for MTF measurement. However,
introducing the monotonic constraint of ESF was still insufficient for obtaining the accurate MTF. To further improve
the accuracy of MTF measurements, more underlying physical principles should be introduced into the MTF measurement
algorithm.
Other important underlying physical principles for MTF measurement could be deduced from the natural properties of slit
images. When the slit device is imaged, the transmitted X-ray
intensity is strongest in the center along the slit width direction, and gradually decreasing as a function of distance from the
center. This physical principle leads to the natural properties of
the LSF: the left half of the LSF is monotone-nondecreasing,
and the right half of the LSF is monotone-nonincreasing. Since
the LSF is the first derivative of the ESF, the corresponding
properties of the ESF can be deduced from those of the LSF.
According to the central position of the edge, the left half of the
ESF is convex, while the right half of the ESF is concave.
In this study, we aimed at including the monotonicity and
convex/concave shape restrictions of the ESF into MTF measurement. A constrained spline regression technique was used
for this purpose [14]. Consider the regression problem where we
have the oversampled ESF yi at subpixel points xi , i = 1, . . . n

ZHOU et al.: TECHNIQUES TO IMPROVE THE ACCURACY OF PRESAMPLING MTF MEASUREMENT IN DIGITAL X-RAY IMAGING

1341

Fig. 1. Oversampling technique (a) with following four-curve fitting algorithms were applied on the simulated edge image with known LSF/MTF. Comparison of
(a) LSF results, (b) MTF results across different algorithms. (c) The enlarged view of MTF results in the frequency range of 5–10 mm−1 . (d) Detailed differences
between the true MTF and individual MTFs across four-curve fitting algorithms.

and the oversampled ESF is assumed to satisfy
yi = f (xi ) + εi .

(1)

In this study, the regression splines fitting method is adopted
to provide the estimate for f using minimal assumptions. The
subpixel points satisfy x1 < x2 < · · · xn and that the errors
εi are independent and identically distributed. For the noisy
ESF data, it is more appropriate to produce a good ESF estimator with considerations of smoothing and shape restrictions.
Such an estimator will minimize over the set of f satisfying the
constraints
 b
n
2

2
f (k ) (x) dx
[yi − f (xi )] + λ
i=1

straightforward to construct and recursively defined [17]. Other
basis functions include the truncated power function [18] and
M-splines [19]. To meet the monotone constraint of the observations, Ramsay proposed I-splines for regression splines construction by the integration of M-splines [20]. His work was later
extended by Meyer [14] to include other shape restrictions such
as convexity or concavity. In this study, in order to include both
monotonicity and convex/concave constraints of the ESF into
MTF measurement, C-splines were chosen as basis functions
for regression splines construction. C-spline is the integration
of I-spline. It provides a nice framework for imposing monotonicity and convex/concave shape restrictions, further details
about C-spline can be found in the appendix of this paper.

a

λ ≥ 0, [xm in , xm ax ] ⊆ [a, b] .

III. RESULTS

(2)

The parameter λ, called smoothing parameter, controls
the tradeoff between the closeness to the true data and the
smoothness of the solution. Several methods have been proposed for choosing the smoothing parameter. In this study, we
adopt a cross-validation technique to select the optimal λ [15].
The parameter k decides the degree of the spline function. Because the cubic version is flexible, and is able to follow the
steep rise in the data [16], we adopt the cubic smoothing spline
to minimize the expression (3) for k = 2.
Regression splines can be constructed using several different types of basis functions. B-splines functions are commonly
used to construct regression splines because they are rather

A. Simulations
Based on the oversampling technique (A) suggested by
Samei, a raw ESF with a fixed bin size of 0.1-pixel spacing
was obtained from the simulated edge image. Thereafter four
curve-fitting algorithms with following numerical differentiation were applied on the raw ESF to obtain the individual LSFs,
respectively [see Fig. 1(a)]. The true LSF of the simulated edge
image was also provided for comparison.
As shown in Fig. 1(a), the Gaussian smoothing algorithm
obtained a smooth LSF curve at the expense of relatively poor
closeness to the true LSF. The closeness to the true LSF got
improved by using the moving polynominal fitting method. The

1342

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

TABLE I
MEAN AND STANDARD DEVIATION OF THE DIFFFERENCE IN ΔM T F FOR
EACH ALGORITHM ACCORDING TO THE OVERSAMPLING TECHNIQUE (A)

monotonic fitting algorithm obtained an LSF with notable oscillations, and the reason for these oscillations would be presented
in the following content. The C-spline regression algorithm outperformed other algorithms according to both smoothness and
closeness to the true LSF.
Fig. 1(b) presents the corresponding MTFs of the LSFs in
Fig. 1(a). The enlarged view of MTFs within the frequency
range of 5–10 mm−1 was illustrated in Fig. 1(c). The differences
between the true MTF and individual MTF measurements from
four algorithms were illustrated in Fig. 1(d). The continuous
lines between data points in Fig. 1(d) did not represent measured data, the lines were only presented for clarity. According
to Fig. 1(d), the C-splines regression algorithm showed the superiority on MTF estimation accuracy upon the other three algorithms. The detailed insight can be gained by averaging the mean
and standard deviation of ΔM T F differences across frequencies for each algorithm. Table I presents the mean and standard
deviation of ΔM T F for each algorithm within the frequency
range of 0–5 mm−1 and 6–10 mm−1 . The result obtained by the
C-spline regression algorithm is, on average, closer to the true
MTF than those obtained by the other three algorithms up to the
sampling frequency.
Based on the oversampling technique (B) suggested by Buhr,
a raw ESF using a “natural” subsampling pixel spacing (0.035pixel spacing) dependent on the edge angle (2◦ ) was obtained
from the simulated edge image. Four different curve-fitting algorithms were separately applied on the raw ESF to obtain
individual LSFs (see Fig. 2). As shown in Fig. 2, the C-spline
regression algorithm outperformed three other algorithms with
respect to the smoothness of the LSF curve and the closeness to
the true data. Another phenomenon should be pointed out that
monotonic fitting algorithm obtained an LSF with more notable
oscillations than that in Fig. 1(a). These oscillations originated
from the steps in the monotonic-fitted ESF. Detailed illustration
on the monotonic-fitted ESF was shown in Fig. 3. As the oversampling technique (B) obtained noisier raw ESF than that from
the oversampling technique (A), the monotonic fitting algorithm
obtained the fitted ESF with more small steps in this case [see
Fig. 3(b)].
Fig. 4(a) presents the corresponding MTFs of the LSFs in
Fig. 2. The detailed differences between the true MTF and individual MTFs from four algorithms were illustrated in Fig. 4(b).
By averaging the mean and standard deviation of ΔM T F
across frequencies within the frequency range of 0–5 mm−1 and
6–10 mm−1 , Table II presents the comparison results on uncertainty performance of MTF measurements for each algorithm
according to the oversampling technique (B). In this case, the

Fig. 2. LSF results across four regularization algorithms based on oversampling technique (B). The true LSF of the simulated edge image was also given
out for comparison.

Fig. 3.

(a) Monotonic fitted ESF and (b) its partial zoomed view.

C-splines regression algorithm still showed the superiority on
MTF estimation accuracy upon the other three algorithms.

ZHOU et al.: TECHNIQUES TO IMPROVE THE ACCURACY OF PRESAMPLING MTF MEASUREMENT IN DIGITAL X-RAY IMAGING

Fig. 4. Oversampling technique (B) with following four regularization algorithms were applied on the simulated edge image with known LSF/MTF.
(a) MTF results across different algorithms. (b) Detailed differences between
the true MTF and individual MTFs across four regularization algorithms.
TABLE II
MEAN AND STANDARD DEVIATION OF THE DIFFFERENCE IN ΔM T F FOR
EACH ALGORITHM ACCORDING TO THE OVERSAMPLING TECHNIQUE (B)

B. Physical Experiment
Once the algorithms accuracy was preliminarily determined
by the simulated edge image with known MTF, further robustness assessments on MTF measurement algorithms were
conducted using experimental edge images. For each digital
imaging system, 15 experimental edge images under the same
X-ray exposure setting were used in this study. Individual LSFs
and corresponding MTFs based on two different oversampling
techniques and following four different curve-fitting algorithms
were separately calculated for each edge image. In other words,
considering each curve-fitting algorithm associated with a particular oversampling technique, 15 MTFs from 15 experimental
edge images of each digital imaging system were achieved for
algorithmic assessments. Since the true MTF of the X-ray dig-

1343

ital imaging system is unknown in this study, the variances of
15 LSF estimates and corresponding 15 MTF estimates for each
curve-fitting algorithm were calculated for MTF uncertainty
assessments. When MTF measurement with a single image
acquisition is highly desirable (e.g., routine quality assurance
for digital detectors), a good uncertainty performance of the
MTF measurement algorithm is of great importance. IEC have
set a standard for the uncertainty requirement of the measured
MTF [12].
Fig. 5(a) presents the average LSFs of Pixarray-100 digital specimen radiography system based on the oversampling
technique (A) and following four different curve-fitting algorithms. The variance curves of LSF estimates associated with
each curve-fitting algorithm were shown in Fig. 5(b). Since all
LSFs were normalized to the peak intensity of unity, the variance
was zero in the LSF peak position. According to the uncertainty
(variance) of LSF estimates, the C-spline regression algorithm
obtained the best performance (lowest LSF variance).
Fig. 5(c) presents the average normalized MTFs of Pixarray100 digital specimen radiography system from 15 experimental
edge images based on the oversampling technique (A) and
following four different curve-fitting algorithms. The relative
differences of average normalized MTFs are of comparable
magnitude for four curve-fitting algorithms (smaller than 0.5%
up to cutoff frequency and smaller than 0.9% up to sampling
frequency). Although the final MTF was required to be
normalized to unity at zero spatial frequency, the normalization
would prevent us from accurately estimating the uncertainty
performance of MTF measurements especially at low spatial
frequencies (e.g., the variance was zero for the normalized
MTF at zero spatial frequency). Therefore the unnormalized
MTFs were used for algorithmic assessments on uncertainty
performance of MTF measurements in this study. The percent
relative variances σΔ M T F /M T F of the unnormalized MTFs
for each algorithm were shown in Fig. 5(d). ΔM T F was
the difference between the individual and mean MTFs for all
images according to each particular algorithm. σΔ M T F was
the standard deviation of ΔM T F values for each algorithm.
The detailed insight can be gained by averaging the percent
relative variance σΔ M T F /M T F across frequencies for each
algorithm.
Table III presents the average relative MTF variances for
each algorithm within the frequency range of 0–10 mm−1 and
11–20 mm−1 . (Since the pixel size of the Pixarray-100 digital
specimen radiography system is 0.05 mm, the corresponding
Nyquist frequency of the detector system is 20 mm−1 .) The
results showed that the C-spline regression algorithm obtained
the best uncertainty performance (lowest MTF variance) of MTF
measurement among four curve-fitting algorithms.
Based on the oversampling technique (B) and following four
different curve-fitting algorithms, four groups of LSFs for each
curve-fitting algorithm were separately calculated from 15 edge
images of the Pixarray-100 digital specimen radiography system. The average LSFs from each group were shown in Fig. 6(a),
and the corresponding variance curves of each LSF group were
presented in Fig. 6(b). The C-spline regression algorithm still
obtained the best uncertainty performance according to the

1344

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

Fig. 5. Oversampling technique (A) with following four-curve fitting algorithms were applied on the practical edge images of Pixarray-100 digital specimen
radiography system. Comparison of (a) LSF results, (b) LSF variances, (c) MTF results, and (d) percent relative variances of MTF results across four curve fitting
algorithms.

TABLE III
AVERAGE RELATIVE MTF VARIANCE OF THE PIXARRAY-100 DIGITAL
SPECIMEN RADIOGRAPHY SYSTEM FOR EACH ALGORITHM
ACCORDING TO THE OVERSAMPLING TECHNIQUE (A)

variance of LSF estimate. In comparison with the LSF variances shown in Fig. 5(b), the oversampling technique (B) obtained noisier LSF estimate than that from the oversampling
technique (A) under the same curve-fitting algorithms. Fig. 6(c)
presents the average normalized MTFs of Pixarray-100 digital
specimen radiography system from 15 experimental edge images based on the oversampling technique (B) and following
four different curve-fitting algorithms. The relative differences
of average normalized MTFs are of comparable magnitude for
all algorithms (smaller than 0.7% up to cutoff frequency and
smaller than 1.2% up to sampling frequency). The percent relative variances σΔ M T F /M T F of the unnormalized MTFs for
each algorithm were shown in Fig. 6(d).
By averaging the percent relative variance σΔ M T F /M T F
across frequencies for each algorithm according to the over-

sampling technique (B), the average relative MTF variances
for each algorithm within the frequency range of 0–10 mm−1
and 11–20 mm−1 were presented in Table IV. Based on the
resampled ESF data from the oversampling technique (B), the
C-splines regression algorithm still showed the superiority on
uncertainty performance of MTF estimation upon the other three
algorithms.
Fig. 7(a) presents the average LSFs of Hologic full-field digital mammography system based on the oversampling technique
(A) and following four different curve-fitting algorithms. The
variance curves of LSF estimates associated with each curvefitting algorithm were shown in Fig. 7(b). The results demonstrated that the C-spline regression algorithm obtained the best
uncertainty performance of LSF estimate. The average normalized MTFs for each algorithm were presented in Fig. 7(c). The
relative differences of average normalized MTFs are of comparable magnitude for moving polynominal fitting method, monotonic fitting method, and C-spline regression method, while
the Gaussian smoothing method obtained an MTF with relative low magnitude than the other three methods. The percent
relative variance σΔ M T F /M T F of the unnormalized MTFs
for each algorithm were shown in Fig. 7(d). The detailed insight can be gained by averaging the percent relative variance
σΔ M T F /M T F across frequencies for each algorithm.

ZHOU et al.: TECHNIQUES TO IMPROVE THE ACCURACY OF PRESAMPLING MTF MEASUREMENT IN DIGITAL X-RAY IMAGING

1345

Fig. 6. Oversampling technique (B) with following four-curve fitting algorithms were applied on the practical edge images of Pixarray-100 digital specimen
radiography system. Comparison of (a) LSF results, (b) LSF variances, (c) MTF results, and (d) percent relative variances of MTF results across four-curve fitting
algorithms.

TABLE IV
AVERAGE RELATIVE MTF VARIANCE OF THE PIXARRAY-100 DIGITAL
SPECIMEN RADIOGRAPHY SYSTEM FOR EACH ALGORITHM
ACCORDING TO THE OVERSAMPLING TECHNIQUE (B)

Table V presents the average relative MTF variances for
each algorithm within the frequency range of 0–7 mm−1 and 8–
14 mm−1 . (Since the pixel size of the Hologic full-field digital
mammography system is 0.07 mm, the corresponding Nyquist
frequency of the detector system is 14 mm−1 .)
According to Table V, the C-spline regression algorithm obtained the best uncertainty performance (lowest MTF variance)
of MTF measurement among four curve-fitting algorithms.
Based on the oversampling technique (B) and following four
different curve-fitting algorithms, four groups of LSFs for each
curve fitting algorithm were separately calculated from 15 edge
images of the Hologic full-field digital mammography system.
The average LSFs from each group were shown in Fig. 8(a), and
the corresponding variance curves of each LSF group were presented in Fig. 8(b). The C-spline regression algorithm still obtained the best performance (lowest LSF variance) according to

the uncertainty (variance) of the LSF estimate. Fig. 8(c) presents
the average normalized MTFs of Hologic full-field digital mammography system. The percent relative variance σΔ M T F /M T F
of the unnormalized MTFs for each algorithm were shown in
Fig. 8(d).
By averaging the percent relative variance σΔ M T F /M T F
across frequencies for each algorithm, Table VI presents the
average relative MTF variances for each algorithm within the
frequency range of 0–7 mm−1 and 8–14 mm−1 according to the
oversampling technique (B). Based on the resampled ESF data
using the oversampling technique (B), C-splines regression algorithm still showed the superiority on uncertainty performance
of MTF estimation upon the other three algorithms.
IV. DISCUSSION AND CONCLUSION
The slanted-edge method has been recognized as a relatively
easy technique to measure the presampling MTF of a radiographic system. It has a less rigorous alignment requirement
than the slit technique and can provide an excellent estimation
of the low-frequency MTF. The limitation of the edge method
is understood to be a consequence of noise amplification associated with the numerical differentiation procedure, which can
result in a measured MTF with fluctuates significantly. Various processing algorithms have been proposed to reduce the

1346

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

Fig. 7. Oversampling technique (A) with following four-curve fitting algorithms were applied on the practical edge images of Hologic full-field digital
mammography system. Comparison of (a) LSF results, (b) LSF variances, (c) MTF results, and (d) percent relative variances of MTF results across four-curve
fitting algorithms.
TABLE V
AVERAGE RELATIVE MTF VARIANCE OF THE HOLOGIC FULL-FIELD DIGITAL
MAMMOGRAPHY SYSTEM FOR EACH ALGORITHM ACCORDING TO THE
OVERSAMPLING TECHNIQUE (A)

apparent noise in the MTF, including ESF oversampling techniques and the following curve-fitting procedures for the ESF
estimation.
In this study, two commonly used ESF oversampling techniques were applied on the slanted edge images, respectively,
for generating the raw ESF. To obtain a regular subsampling
ESF which was needed for further analysis, oversampling technique (A) suggested by Samei rebinned the raw ESF data into a
fixed subpixel spatial bin width of 0.1-pixel spacing, whereas the
oversampling technique (B) used a “natural” subsampling pixel
spacing dependent on the edge angle. According to the edge
angle suggested by International Electrotechnical Commission
(ranging from 1.5◦ to 3◦ ), oversampling technique (B) adopted a
maximum subpixel spatial bin width of 0.052-pixel spacing and

a minimum one of 0.026-pixel spacing. Although finer-sampled
ESF could be obtained using the oversampling technique (B),
noise amplification would be more serious in this case. According to the experimental edge images, the LSFs obtained
from the oversampling technique (B) had higher variances than
that from the oversampling technique (A) for each curve-fitting
algorithm [see Figs. 5(b)/6(b) and Figs. 7(b)/8(b)]. Correspondingly, within the frequencies up to the cutoff frequency, the
percent relative variances of the unnormalized MTFs for each
curve-fitting algorithm were lower by using the oversampling
technique (A) [see Figs. 5(d)/6(d) and 7(d)/8(d)]. The same
phenomenon could be found from the simulation experiments,
i.e., oversampling technique (B) obtained noisier LSFs than the
oversampling technique (A) for all curve-fitting algorithms (see
Figs. 1 and 2). The corresponding MTF measurement results for
the simulated edge image were shown in Figs. 1 and 4. Three
curve-fitting algorithms except the Gaussian smoothing technique obtained lower relative MTF error by using the oversampling technique (A). The Gaussian smoothing technique adopted
a window width of 17 subpixels, which corresponded to 1.7 pixels for the oversampling technique (A) and 0.59 pixels for the
oversampling technique (B). According to the Gaussian smoothing technique, a window width of 17 subpixels (1.7 pixels)

ZHOU et al.: TECHNIQUES TO IMPROVE THE ACCURACY OF PRESAMPLING MTF MEASUREMENT IN DIGITAL X-RAY IMAGING

1347

Fig. 8. Oversampling technique (B) with following four-curve fitting algorithms were applied on the practical edge images of the Hologic full-field digital
mammography system. Comparison of (a) LSF results, (b) LSF variances, (c) MTF results, and (d) percent relative variances of MTF results across four curve
fitting algorithms.

TABLE VI
AVERAGE RELATIVE MTF VARIANCE OF THE HOLOGIC FULL-FIELD DIGITAL
MAMMOGRAPHY SYSTEM FOR EACH ALGORITHM ACCORDING TO THE
OVERSAMPLING TECHNIQUE (B)

suggested by Samei led to a smooth LSF at the expense of the
closeness to the true data. The closeness to the true data could
be improved by using narrower window width at the expense of
LSF smoothness.
Four curve-fitting methods were applied on the raw oversampled ESFs, among which the C-spline regression method
with monotonicity and convex/concave shape restrictions was
proposed in this study. In the first part of this paper, we evaluated the accuracy of our MTF algorithm and compared with
three curve-fitting methods, which have been cited as having
the potential to improve the MTF accuracy. We used simulated edge image for which the true MTF was known. This
image contained simulated uncorrelated Poisson noise as observed in flat-field images obtained with various commercially

available full-field digital imaging system. The simulation results showed that the MTF derived with all curve-fitting methods
perfectly matched the theoretical MTF and the systematic error
ΔM T F /M T F is less than 2% for all frequencies up to the
Nyquist frequency. Among all the curve-fitting methods, the
C-spline regression method obtained an average MTF measurement error of 0.12% ± 0.11% and 0.18% ± 0.17% corresponding to the oversampling technique (A) and (B), respectively,
up to the cutoff frequency, which were better than those of
the Gaussian smoothing algorithm [average MTF measurement
error of 0.65% ± 0.40% for the oversampling technique (A)
and 0.53% ± 0.46% for the oversampling technique (B)], the
moving polynominal-fitting algorithm [average MTF measurement error of 0.29% ± 0.18% for the oversampling technique
(A) and 0.38% ± 0.23% for the oversampling technique (B)],
and the monotonic fitting algorithm [average MTF measurement error of 0.22% ± 0.14% for the oversampling technique
(A) and 0.34% ± 0.27% for the oversampling technique (B)].
Considering the oversampling technique (A), the maximum systematic error ΔM T F /M T F for the C-spline regression algorithm were 0.28% for all frequencies up to Nyquist frequency,
which outperformed the gaussian smoothing algorithm (maximum ΔM T F /M T F = 1.47%), the moving polynominal

1348

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 4, APRIL 2014

fitting algorithm(maximum ΔM T F /M T F = 0.92%), and
the monotonic fitting algorithm(maximum ΔM T F /M T F =
0.65%). Similar results could be found out according to the
oversampling technique (B), the maximum systematic MTF error derived from the C-spline regression algorithm (maximum
ΔM T F /M T F = 0.37%) is less than those derived from the
Gaussian smoothing algorithm(maximum ΔM T F /M T F =
1.76%), the moving polynominal fitting algorithm(maximum
ΔM T F /M T F = 1.48%), or the monotonic fitting algorithm(maximum ΔM T F /M T F = 0.85%).
To demonstrate the practical applicability of our proposed
algorithm and to compare it with other curve fitting methods
for MTF estimation, experimental edge images from Pixarray100 digital specimen radiography system and Hologic fullfield digital mammography system were used for MTF uncertainty assessments. In the case of Pixarray-100 digital specimen radiography system, the average relative MTF measurement variances σΔ M T F /M T F for all frequencies up to cutoff
frequency were 2.01% for the Gaussian smoothing algorithm,
1.65% for the moving polynominal fitting algorithm, 4.29% for
the monotonic fitting algorithm, and 0.83% for the C-spline regression method according to the oversampling technique (A).
The deviations from the mean MTF increased for all MTF
algorithms when using the oversampling technique (B). The
C-spline regression method obtained an average percent relative
variance of 1.65% within the frequency range of 0–10 mm−1 ,
which still outperformed other algorithms on uncertainty performance of MTF estimation. Monotonic fitting had poorest
uncertainty performance (an average percent relative variance
of 5.37%), while moving polynominal fitting gained a better
uncertainty performance on MTF measurement (an average
percent relative variance of 2.22%) than that of the Gaussian
smoothing algorithm (an average percent relative variance of
2.96%). In the case of Hologic full-field digital mammography system, the C-spline regression algorithm also showed the
smallest deviations from the mean MTFs among four curvefitting algorithms. The MTF uncertainty performances were
poorer for the oversampling technique (B) than those for the
oversampling technique (A) according to each curve-fitting
algorithm.
Within the frequency range from cut-off frequency (fs/2) to
sampling frequency (fs), the MTF uncertainties of Pixarray100 digital specimen radiography system were obviously higher
than those of Hologic full-field digital mammography system
[see Figs. 5(d)/7(d) and Figs. 6(d)/8(d)]. The reason for this
phenomenon was that the MTF values within the frequency
range from fs/2 to fs were very small (smaller than 0.05) for
Pixarray-100 digital specimen radiography system, but the MTF
values for Hologic full-field digital mammography system were
higher than 0.1 up to the sampling frequency. Similar results
can be found in Samei’s work [10], the variances from mean
MTF got increased with the decreasing of MTF value. Samei
only gave out the MTF variances with mean MTF values higher
than 0.1.
Based on the above results, the C-spline regression algorithm
with the oversampling technique (A) showed the superiority on
MTF estimation accuracy upon all other circumstances without

consideration on subpixel sampling rate. We should point out
that according to the edge angle ranging from 1.5◦ to 3◦ suggested by International Electrotechnical Commission, the subpixel sampling rate suggested by the oversampling technique
(A) was sufficient to prevent the aliasing in the estimation of
the presampled MTF [4]. The accuracy and robustness of the
C-spline regression technique makes it well suited for routine
application when the presampled MTF is to be determined for
frequencies below the Nyquist limit, an important example being the determination of DQE.
There is another thing which should also be concerned. Similarly to monotonic fitting algorithm, C-spline regression is only
useful when the ESF shape constraints are valid. Radiography
detectors with overshoot and undershoot in the ESF are improper
to use the C-spline regression algorithm for MTF measurement.
Fortunately, most digital radiography systems especially for
clinical use are at least approximately valid for monotonicity
and convex/concave shape restrictions of ESF. To sum up, the
proposed C-spline regression algorithm was an effective MTF
measurement approach for digital radiography systems owing
to its sufficient usage of underlying physical properties of ESF.
APPENDIX
In this appendix, we will provide a more detailed description of C-splines basis functions, including estimation of the
regression function using C-splines with shape restrictions.
Regression splines [14], [19], [20] have the benefit of providing estimates of regression functions without requiring the
assumption of a parametric form. They allow local effects to
parameter changes and provide a nice framework for imposing
shape restrictions in addition to providing great flexibility.
Consider a function of a covariate x where the covariate takes
on values in the interval [L, U]. Estimation of the function using
regression splines involves fitting piecewise polynomials of degree d over the interval [L, U]. Given knot points t = [t1 , . . . , tq ]
with L = t1 < · · · tq = U , regression splines are fitted within
the subintervals [ti , ti+1 ) for i = 1, . . . , q − 1 under the continuity constraints at the user-specified interior knot points. Regression splines can be constructed from several different types
of basis functions, such as M-splines, I-splines and C-splines.
Consider a covariate with range [L, U] and the subintervals
as defined previously. The M-splines of order q are founded
recursively by
Mi1 (x) =

⎧
⎨
⎩

1
,
ti + 1 − ti

for ti ≤ x ≤ ti + 1

0,

otherwise

Miq (x) =
⎧
q −1
q −1
⎪
⎨ q[(x − ti )Mi (x) + (ti + q − x)Mi + 1 (x)] ,
(q − 1)(ti + q − ti )
⎪
⎩
0,

(A.1)

for ti ≤ x ≤ ti + q
otherwise
(A.2)

where i = 1, . . . , q + k, x ∈ [L, U ] , k is the number of userspecified interior knots.

ZHOU et al.: TECHNIQUES TO IMPROVE THE ACCURACY OF PRESAMPLING MTF MEASUREMENT IN DIGITAL X-RAY IMAGING

M-splines of degree d or order q = d + 1 can be integrated
to create I-splines basis function for shape-restricted regression
spline [20]. One can estimate monotone functions using a linear combination of I-splines basis functions and requiring the
coefficients of these basis functions to be nonnegative. Thus, an
I-spline of order q + 1 is given by
 x
Miq (u) du.
(A.3)
Iiq +1 (x) =
t1

I-splines can be further integrated to get C-splines basis functions that are both increasing and convex or both decreasing
and concave. The C-splines of order q + 2 are constructed by
integrating I-splines of order q + 1, and are given by
 x
Iiq +1 (u) du
(A.4)
Iiq +2 (x) =

[6]
[7]
[8]
[9]
[10]

[11]

t1

where i = 1, . . . , q + k and x ∈ [L, U ]. A convex regression
function can be estimated using linear combinations of the basis functions with nonnegative coefficients, plus an unrestricted
linear combination of the constant function and identity function. If the underlying regression function is both increasing and
convex, the coefficient on the identity function should also be
restricted to be nonnegative.

[12]
[13]

[14]
[15]

REFERENCES
[1] P. F. Judy, “The line spread function and modulation transfer function of a
computed tomographic scanner,” Med. Phys., vol. 3, pp. 233–236, 1976.
[2] H. Fujita, D. Y. Tsai, T. Itoh, K. Doi, J. Morishita, K. Ueda, and A. Ohtsuka,
“A simple method for determining the modulation transfer function in
digital radiography,” IEEE Trans. Med. Imag., vol. 11, no. 1, pp. 34–39,
Mar. 1992.
[3] E. Samei, N. T. Ranger, J. T. Dobbins, and Y. Chen, “Intercomparison
of methods for image quality characterization,” I. Modulation Transfer
Function. Med. Phys., vol. 33, pp. 1454–1465, 2006.
[4] E. Samei, N. T. Ranger, A. MacKenzie, I. D. Honey, J. T. Dobbins, and
C. E. Ravin, “Detector or system? extending the concept of detective
quantum efficiency to characterize the performance of digital radiographic
imaging systems,” Radiology, vol. 249, pp. 926–937, 2008.
[5] J. Morishita, K. Doi, R. Bollen, P. C. Bunch, D. Hoeschen, G. Sirand-rey,
and Y. Sukenobu, “Comparison of two methods for accurate measurement

[16]
[17]
[18]
[19]
[20]

1349

of modulation transfer functions of screen-film systems,” Med. Phys.,
vol. 22, pp. 193–200, 1995.
E. Samei, M. J. Flynn, and D. A. Reimann, “A method for measuring
the presampled MTF of digital radiographic systems using an edge test
device,” Med. Phys., vol. 25, pp. 102–113, 1998.
E. Samei and M. J. Flynn, “An experimental comparison of detector performance for direct and indirect digital radiographic systems,” Med. Phys.,
vol. 30, pp. 608–622, 2003.
E. Buhr, S. Gunther-Kohfahl, and U. Neitzel, “Accuracy of a simple
method for deriving the presampled MTF of a digital radiographic system
from an edge image,” Med. Phys., vol. 30, pp. 2323–2331, 2003.
A. D. Maidment and M. Albert, “Conditioning data for calculation of the
modulation transfer function,” Med. Phys., vol. 30, pp. 248–253, 2003.
E. Samei, E. Buhr, P. Granfors, D. Vandenbroucke, and X. Wang, “Comparison of edge analysis techniques for the determination of the MTF of
digital radiographic systems,” Phys. Med. Biol., vol. 50, pp. 3613–3625,
2005.
N. T. Ranger, E. Samei, J. T. Dobbins, and C. E. Ravin, “Assessment of
detective quantum efficiency: Intercomparison of a recently introduced
international standard with prior methods,” Radiology, vol. 243, pp. 785–
795, 2007.
Medical Electrical Equipment-Characteristics of Digital X-ray Imaging Devices-Part 1: Determination of the Detective Quantum Efficiency.
Newark 2003; NY:IEC, IEC 62220-1.
A. K. Carton, D. Vandenbroucke, L. Struye, A. D. Maidment, Y. H. Kao,
M. Albert, H. Bosmans, and G. Marchal, “Validation of MTF measurement
for digital mammography quality control,” Med. Phys., vol. 32, pp. 1684–
1695, 2005.
M. C. Meyer, “Inference using shape-restricted regression splines,” Ann.
Appl. Stat., vol. 2, pp. 1013–1033, 2008.
B. W. Silvermana, “A fast and efficient cross-validation method for
smoothing parameter choice in spline regression,” J. Amer. Stat. Assoc.,
vol. 79, pp. 584–589, 1992.
B. W. Silverman, “Some aspects of the spline smoothing approach to
non-parametric curve fitting,” J. R. Statist. Soc. B, vol. 47, pp. 1–52, 1985.
P. H. C. Eilers and B. D. Marx, “Flexible smoothing with B-splines and
penalties,” Stat. Sci., vol. 11, pp. 89–102, 1996.
P. Smith, “Splines as a useful and convenient statisticst too,” Amer. Statist.,
vol. 33, pp. 57–62, 1979.
H. B. Curry and I. J. Schoenberg, “On polya frequency function—Part
IV: The fundamental spline functions and their limits,” J. Analyse. Math.,
vol. 17, pp. 71–107, 1966.
J. O. Ramsay, “Monotone regression splines in action,” Stat. Sci., vol. 3,
pp. 425–461, 1988.

Authors’ photographs and biographies not available at the time of publication.

