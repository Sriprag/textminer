IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

1333

Rapid Model Identification for Online Subcutaneous
Glucose Concentration Prediction for New Subjects
With Type I Diabetes
Chunhui Zhao∗ , Member, IEEE, and Chengxia Yu

Abstract—Goal: For conventional modeling methods, the work
of model identification has to be repeated with sufficient data for
each subject because different subjects may have different response
to exogenous inputs. This may cause repetitive cost and burden
for patients and clinicians and require a lot of modeling efforts.
Here, to overcome the aforementioned problems, a rapid model
development strategy for new subjects is proposed using the idea
of model migration for online glucose prediction. Methods: First,
a base model is obtained that can be empirically identified from
any subject or constructed by a priori knowledge. Then, parameters of inputs in the base model are properly revised based on a
small amount of new data from new subjects so that the updated
models can reflect the specific glucose dynamics excited by inputs
for new subjects. These problems are investigated by developing
autoregressive models with exogenous inputs (ARX) based on 30
in silico subjects using UVA/Padova metabolic simulator. Results:
The prediction accuracy of the rapid modeling method is comparable to that for subject-dependent modeling method for some
cases. Also, it can present better generalization ability. Conclusion:
The proposed method can be regarded as an effective and economic
modeling method instead of repetitive subject-dependent modeling
method especially for lack of modeling data.
Index Terms—Autoregressive models with exogenous inputs
(ARX), glucose prediction, model migration (MM), rapid model
identification, type I diabetes.

I. INTRODUCTION
IABETES mellitus type 1 (i.e., type 1 diabetes, or T1DM)
which has been recognized as one of the most serious
diseases in the world is a form of diabetes mellitus that is characterized by the inability of the body to regulate blood glucose concentration. Resulting from autoimmune destruction of
insulin-producing beta cells of the pancreas [1], people with
T1DM (once known as juvenile diabetes or insulin-dependent
diabetes) cannot successfully produce the necessary hormone

D

Manuscript received March 23, 2014; revised November 28, 2014; accepted
December 19, 2014. Date of publication December 19, 2014; date of current version April 17, 2015. This work was supported by the National Natural Science
Foundation of China under Grant 61273166 and Grant 61422306, Program
for New Century Excellent Talents in University (NCET-12–0492), Zhejiang
Provincial Natural Science Foundation of China (LR13F030001), and Specialized Research Fund for the Doctoral Program of Higher Education of China
(20120101120182). Asterisk indicates corresponding author.
∗ C. H. Zhao is with the State Key Laboratory of Industrial Control Technology, Department of Control Science and Engineering, Zhejiang University,
Hangzhou 310027, China (e-mail: chhzhao@zju.edu.cn).
C. X. Yu is with the State Key Laboratory of Industrial Control Technology,
Department of Control Science and Engineering, Zhejiang University.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2387293

insulin for any proper regulation of glucose level. They, thus,
may not maintain their blood glucose concentration within a
normal range (e.g., 70–120 mg/dL before meal and less than
160 mg/dL after meal) without proper treatment of exogenous
insulin injections. Subjects with T1DM, thus, often suffer from
drastic glycemic excursions, including episodes with very low
glucose (hypoglycemia) and very high glucose (hyperglycemia).
They have different health implications and will result in a variety of complications that are deleterious to one’s health [2].
Diabetes subjects in particular rely on exogenous insulin for survival and, thus, require intensive insulin treatment to improve
their life expectancy. In general, to keep the blood glucose within
a normal range, insulin treatment is necessary that may consist
of either several (from three to four) insulin injections per day
in conventional treatment or the use of insulin pumps for continuous and automatic injection in new treatment [3], [4].
Keeping glucose level within the normal region as best
as possible is a major challenge for subjects with T1DM,
which can reduce the risk of long-term complications [5]. To
successfully manage diabetes, a monitoring system is needed
to consistently check your glucose levels. They can provide information about glucose fluctuations that may be of particular
benefit to subjects with T1DM. Conventional self-monitoring
[6] allows subjects with diabetes to measure their blood glucose levels at home and adjust therapy appropriately. However,
it requires a finger-stick to draw blood several times a day that
may not provide adequate information. A newer alternative approach is continuous glucose monitoring (CGM) system [6]–[8],
which determines glucose levels on a continuous basis (every
few minutes) and allows a more thorough metabolic control.
Voluminous glucose time-series data are measured online and
displayed, which provide maximal information about shifting
blood glucose levels throughout the day and facilitate the making of optimal treatment decisions for the diabetes subjects.
Hyper/Hypoglycemia alarms will be alerted when the measured
glucose increases/decreases cross the predefined thresholds, resulting in “reactive” glucose regulatory intervention.
Previous work [9] has mentioned that if the recent glucose
history follows previous known patterns, future blood glucose
values might be anticipated from past measurements, which is
an important question about blood glucose control in diabetes.
Collection of CGM data enables development of mathematical forecasting models to produce near-future glucose prediction. In comparison with the corrective action based on direct
CGM measurements against the predefined thresholds that may
work too late to normalize the blood glucose, glucose prediction

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1334

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Glucose
Insulin
Meals

Fig. 1.

Predicted Values
Empirical Model

Glucose

Illustration of ARX prediction model.

can indicate early hypoglycemic alarms by checking predicted
glucose against thresholds, resulting in “proactive” glycemia
intervention. Therefore, the identification of simple, accurate
glucose prediction models has been drawing increasing attention. Many empirical (or “data-driven”) modeling techniques
[9]–[23], which can be divided into linear models [9]–[21] and
nonlinear models [22], [23], have been developed in combination with frequent and rich glucose measurements, trying
to provide an early warning of impending glucose excursions
and proactive regulatory interventions for diabetes subjects. For
nonlinear modeling techniques, a mass of data are in general
required to train the models and the model structures may be
complicated. On the contrary, linear models have been widely
used because of their simplicity.
In general, the prediction model has the form of a linear dynamic model as shown in Fig. 1, where the future glucose concentrations are calculated as the linear combination of current
and historical glucose signals, and available exogenous input
signals, which commonly include insulin delivery and meal carbohydrate (CHO) estimates. Autoregressive models (AR) and
AR with exogenous inputs (ARX) have been the most popular
linear models that have been widely used for TIDM applications.
For AR modeling method, only CGM data are employed in the
model and future glucose concentrations are simply expressed
as the linear combination of recent glucose measurements. The
ARX models are an extension of AR models that reflect the relationship between glucose and exogenous inputs by including
inputs signals into the model structures, e.g., insulin delivery and
meal CHO estimates. For different subjects, their glucose levels may response differently to the exogenous inputs, revealing
their different physiological reactions and life styles. Differences among subjects may make the existing ARX prediction
model developed from one subject invalid for new subjects. The
conventional modeling methods are to reconduct clinical trials,
recollect modeling data, and reidentify a new model for the new
subject. Subject-specific ARX models [10], [14], [19] have been
developed for in silico and clinical subjects, where the effects
of key design problems have been evaluated.
In contrast to the widespread development of personalized
glucose prediction models, there is a limited body of work concerning the analysis of intersubject variability for glucose prediction. In particular, Gani et al. [24] and Zhao et al. [16], [21]
have mentioned and verified the concept of a universal or global
AR model of glucose prediction for T1DM. If a universal/global
model is reasonably accurate, it would considerably reduce the
efforts associated with model development. The model can be
identified based on glucose data for a single subject and then
used to make short-term (30-min-ahead) glucose predictions for
other subjects without any need of model customization. Their
results indicated that the predictive capability of the AR models
(i.e., glucose autocorrelation) was not affected by intersubject

differences. In comparison, Gani’s method may not be useful
for online application since time-series data are smoothed retrospectively using a Tikhonov regularization method [25]. Zhao’s
method can be readily used for online glucose prediction by only
using a simple low-pass filter to remove signal noises. However,
for the development of glucose prediction model, exogenous
inputs are very important factors, which are also the basis for
the practical application of glucose control. Zhao et al. [16] have
pointed out that prediction models were not global when two exogenous inputs, insulin delivery and meal CHO estimates were
included in the model structures. This well supports the fact that
different subjects may give different glucose responses to exogenous inputs due to diverse physiques, changes of life styles
or physiological function. Correspondingly, the model parameters of inputs may be different across subjects. Based on the
aforesaid discussion, to get an accurate ARX prediction model,
conventional methods require repetitive model development for
different subjects with a large number of data, which may cause
burden for patients and clinicians and also may be inefficient,
time-consuming, and uneconomical.
In this paper, a rapid model development strategy is proposed for identification of prediction models for new subjects
with type 1 diabetes. First, the analysis of common and specific
glucose dynamic information reveals that a glucose prediction
model for one subject can be obtained quickly by proper model
parameter adjustment of the existing model. Here, the existing
model describing the old subject is defined as a base model and
the model to be identified for new subject as a new model. The
base model can be obtained by empirical modeling for one subject with a large number of data or can be a mechanistic model
with solid first-principle knowledge and good understanding of
one subject. In the current research, we focus on the empirical model development using measurement data. Considering
that responses to exogenous inputs may change across different
subjects due to their different excitations, the idea of model migration (MM) [26] is used and the parameters of the base model
are properly revised so that the updated model can be used for
a new subject. Starting from the base model, fewer data for a
new subject are required for MM than that required for new
model development. For successful MM algorithm, several important problems should be paid special attention, the required
data, influences of prediction horizon (PH), and the adjusting
algorithm. Of particular interest, are first how to determine adjusting step and adjusting direction to capture the differences
between the new subject and the base model; second what and
how much data are required for MM so that meaningful information can be extracted; and third to evaluate the influence of
different PHs. These problems are investigated by developing
ARX models based on 30 in silico subjects using UVA/Padova
metabolic simulator. The rapid modeling method is compared
with subject-dependent standard model for online short-term
(0–60 min) glucose prediction.
II. METHODOLOGY
A. Standard ARX Prediction Model
In this paper, ARX modeling technique based on least squares
(LS) algorithm [25] for the sake of simplicity is used to develop

ZHAO AND YU: RAPID MODEL IDENTIFICATION FOR ONLINE SUBCUTANEOUS GLUCOSE CONCENTRATION PREDICTION

1335

empirical prediction models. The general form of the ARX
model for this research is described below
 
 
A q −1 g (k) = Bin s q −1 uin s (k − kin s ) +
 
Bm eal q −1 um eal (k − km eal ) + β + ε (k)
(1)
where g (k) denotes the glucose concentration at sampling instant k. uin s (k − kin s ) and um eal (k − km eal ) are exogenous inputs, bolus insulin, and meal CHOs, consumed at time k − kin s
and k − km eal , respectively. kin s and km eal , which can be different for different subjects, are the input time delays. The
time delays are expressed as integer multiples of the sampling
periods. In this paper, the sampling period is 5 min. β is a
constant bias term and ε (k) is random
 disturbance at time k.
A(q −1 ), Bin s q −1 , and Bm eal q −1 represent the coefficients
of glucose concentration, bolus insulin, and CHOs, respectively,
which can be identified by LS algebra [27]. Note that this ARX
model is expressed in terms of physical variables and includes
a bias term, rather than being based on deviation variables. This
approach eliminates the need to specify an appropriate steadystate reference value for the glucose concentration, information
that may be difficult to determine in practice due to the inherent
dynamic behavior of blood
concentration.
 glucose

 
In (1), A(q −1 ), Bin s q −1 , and Bm eal q −1 denote polynomials in q −1 , where q −1 is the backward shift operator,
i.e., q −1 g (k) ≡ g (k − 1). For example, if the order of the
A(q −1 ) polynomial is n, then A(q −1 ) can be described as
follows:
 
A q −1 = a0 + a1 q −1 + a2 q −2 + . . . + an A q −n A . (2)
Previous work [28] has demonstrated that model accuracy
can be improved when the exogenous input data are preprocessed prior to model identification. The preprocessing consists
of passing each input impulse (i.e., the insulin boluses and CHO
estimates) through a simple transfer function model, thus producing time-smoothed inputs. In this paper, the second-order
transfer function models reported by Grossman et al. [28] are
used, producing time-smoothed inputs. In this way, the effects
of the two inputs can be separated to a certain extent, which
facilitates the model identification.
B. Rapid Model Development Using Model Migration
The major problem addressed in the present study is about
short-term online glucose prediction. So the key problem is
whether the proposed rapid modeling algorithm can provide a
prediction model that is suitable for online glucose prediction.
Of particular interest, is whether a prediction model developed
for data from one subject can be made valid for a new subject
with proper model parameter adjustment in comparison with
that subject-dependent standard model.
The idea of MM [26] was first proposed for developing a new
industrial process model by taking advantage of one type of
process similarity, which involves an existing base model, and
process attribute information. In the present study, the idea of
MM is adopted for the development of rapid modeling strategy.
In the present study, the foundation of MM is first to detect
how different or similar two subjects are and what kind of dif-

Fig. 2.

Illustration of MM to develop new prediction models for new subjects.

ferences they have. As mentioned before, despite that different
subjects may response differently to the exogenous inputs due
to their different physiological reactions and life styles, certain glucose dynamics remain the same. Previous work [16] has
demonstrated that an AR prediction model developed for data
from one subject is also valid for other subjects without any customization. That is, they revealed that glucose autocorrelations
are similar across subjects. Therefore, the glucose dynamics of
each subject can be separated into subject-dependent part and
subject-independent part in the present study. Correspondingly,
the model parameters of historical glucose data (i.e., A(q −1 ))
in ARX model are the same for different subjects. However,

the model
of exogenous inputs [i.e., Bin s q −1 and
 −1parameters

Bm eal q ] plus bias term (β) in ARX model may be different,
whose sizes directly reflect the response magnitude. In general,
larger model parameter of input means the concerned subject
responses with higher magnitude to this input signal. Therefore,
the three model parameters have to be customized for each specific subject. The aforesaid analysis reveals that there are both
common and specific information between different subjects for
the purpose of glucose prediction, which provides a good analysis platform for the proposed rapid modeling method. For the
common information, there is no need to do any changes. For
the specific information, some revision should be done to make
it suitable for the specific subject.
Here, the idea of MM as shown in Fig. 2 can be used to rapidly
develop the prediction model for a new subject by proper model
parameter adjustment. As shown in Fig. 2, for the original subject, we can get rich subject knowledge, expert experience, and
measurement data that are beneficial for model development.
On the contrary, for the new subject, we may be lack of subject knowledge, expert experience, and data that may make the
model development difficult or cannot guarantee the model accuracy. However, the old subject and the new subject share
similar characteristics and also have differences, which make
it possible to quickly get a new model for the new subject by
adjusting the original model using the MM idea. Clearly, analysis of these common and different glucose dynamics and taking
advantage of the existing prediction model can allow fewer data
and minimal priori knowledge to be required and make the
model development for a new subject more efficient and economical. By MM, it is hoped that the proposed rapid modeling

1336

Fig. 3.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Flowchart of new model development procedure for new subjects (PE: prediction errors (mg/dL)).

method can present similar prediction accuracy in comparison
with subject-dependent standard modeling method but cost less
modeling burden.
The general idea of MM for model development for glucose
prediction is described below. First, a base model is available
that can be empirically identified from any subject or constructed
by a priori knowledge of one subject. In the present study, we
focus on the data-driven method to develop a base model and
LS algebra is used to develop ARX prediction model for one
subject with a large number of data, including both glucose data
and two exogenous inputs. In general, the existing base model
is good for glucose prediction for the current subject but fails to
get high prediction accuracy for the other subjects although they
have the same model structure. To customize this base model
so that it can be used for glucose prediction for a new subject,
model parameters for Bin s , Bm eal and bias term (β) in (1)
should be adjusted based on only a small number of data from
the new subject. The small portion of data can be extracted after
each meal, for example, if you have lunch at 12 O’Clock and
you sample two hours’ data, then the data are samples from 12
to 14 O’Clock totalled 24 samples with 5 min as the sampling
interval. Given the base model as described as shown in (1),
the new model can be obtained by parameter adjustment, which
is implemented by determining adjusting step and direction. In
fact, the differences between subjects indicate that prediction
relationship of the new subject is simply a shift and rescale of
that for the old subject, then the new model can be described as
a slope and bias correction [26] to the base model.

The flowchart of model parameter adjustment procedure is
shown in Fig. 3. The specific MM procedure is described below.
1) The base model is obtained by ordinary LS algebra based
on a larger number of glucose and exogenous input data,
which is described as shown in (1). The two inputs and
bias term have different influences on glucose level. In
general, insulin can decrease glucose level, whereas meal
will increase glucose level.
2) The difference of input excitations between the old subject
and a new subject should be evaluated so as to determine
the adjusting direction of model parameters. For the new
subject, only a small number of measurement data are
available. The small number of measurement data can be
several hours’ data, which start from one meal and end before the next meal. In general, the available small number
of measurement data from the new subject should cover
information of inputs and their influences on glucose level
so that the differences of input excitation between the old
subject and the new subject can be captured and used to
guide model parameter adjustment. First, the base model
is directly applied to the new subject for glucose prediction
with a small number of data with no customization. In the
present study, 30-min PH is used, which indicates the steps
of ahead prediction forward. Also, to evaluate the glucose
prediction accuracy, we should use multiple values of glucose predictions, which are obtained for the same PH. The
predicted glucose values are indicated as Ŷ (N × 1) and
the measured glucose values are described as Y (N × 1),

ZHAO AND YU: RAPID MODEL IDENTIFICATION FOR ONLINE SUBCUTANEOUS GLUCOSE CONCENTRATION PREDICTION

where N is used to indicate the number of predicted glucose samples as well as thatof measured
glucose samples.

3) The average values [mean Ŷ and mean (Y)] are used
to compare the predictions and measurements. The prediction errors (mg/dL) are calculated as the difference
between predicted and measured glucose values, which
can be used to indicate how to adjust the concerned model
parameters. Based on the prediction errors, three cases
should be considered:
a) mean(Ŷ) > mean(Y); b) mean(Ŷ) < mean(Y);
c) mean(Ŷ) = mean(Y).
For Case (a), the predictions are larger than the real measurements. It may result from the fact that the absolute parameter
value of insulin in base model is comparatively smaller than the
real value for the new subject or the parameter of meal in base
model is comparatively larger than the real value for the new
subject or the bias term is positively larger.
For Case (b), the predictions are smaller than the real measurements. It may be caused by the oversized absolute parameter
of insulin, the undersized parameter of meal or the positively
smaller bias term in base model than the real value for the new
subject.
For Case (c), which is an ideal case with no prediction errors,
the base model is good for the new subject with no need of
model customization.
For the first two cases, the model parameters of two exogenous inputs and bias term should be revised. Considering that
the influences of two exogenous inputs are significant, their
model parameters should be adjusted first. After their correction, if necessary, the bias term can be adjusted to compensate
for the left prediction inaccuracy. During model parameter correction, it refers to two important adjusting parameters, i.e., the
size of adjusting step and the adjusting direction. Adjusting direction means whether the concerned parameter is increased or
decreased, whereas the size of adjusting step means how much
is allowed to be changed from the current parameter value.
4) Starting from the model formulation shown in (1), the
specific adjustment action can be taken based on the prediction errors:
a) If mean(Ŷ) > mean(Y), increase the absolute parameter value of insulin (Bin s ) or decrease the
absolute parameter value of meal (Bm eal ) with
the predefined step size so as to reduce the predicted
glucose values until mean(Ŷ) approaches mean(Y)
as much as possible;
b) If mean(Ŷ) < mean(Y), decrease the absolute parameter value of insulin (Bin s ) or increase the absolute parameter value of meal (Bm eal ) with the
predefined step size so as to increase the predicted
glucose values until mean(Ŷ) approaches mean(Y)
as much as possible;
c) If mean(Ŷ) = mean(Y) no model adjustment is
needed.
During the model parameter adjustment, the other model parameters should stay invariable when one parameter is adjusted.
The model parameter of insulin is first regulated (increased or

1337

decreased) with the predefined step size until prediction errors
cannot be further reduced or the reduction is less than one small
value, which is set to be 0.01 mg/dL in the present study; then
keep the model parameter of insulin invariable and regulate (increase or decrease) the model parameter of meal CHOs until
prediction error cannot be further reduced or the reduction is
less than one small value, which is set to be 0.01 mg/dL in the
present study. Also, the above regulation should be iteratively
implemented as shown in Fig. 3 for the two inputs until the convergence requirement is met, which is in general set to be the
improvement of prediction accuracy and means that any adjustment is of no avail for the improvement of prediction accuracy.
Also, it is noted that the sign of parameters for insulin should
be negative considering that the injection of insulin will reduce
the glucose level and the sign for meal should be positive since
intake of meal will increase the glucose level. Their signs should
not be changed during the adjustment procedure.
In the present study, the step size is set to be 0.1, which is set
by trials and errors. In general, a smaller step size means more
steps are required to reach the target but the corrected parameter
value may be more close to the real value. In contrast, a larger
step size means fewer steps are required to reach the target value
but the corrected parameter value is easy to go far away from
the real parameter value. Therefore, the step size reflects the
compromise between model accuracy and adjustment complexity. In general, the value of step size can be set by trial and error
during the adjustment process. A larger step size can be chosen
at the beginning of adjustment process and then a smaller step
size should be used when the parameter is around the target as
indicated by the improvement of prediction accuracy.
C. Prediction Performance Evaluation
In order to evaluate the feasibility of developing new models
for new subjects using MM, three approaches are considered
and compared:
a) MM with a small number of data: The new prediction
model is obtained by model parameter adjustment based
on a base model for one old subject. After MM based on
a small number of data from a new subject, this updated
model is then used to make glucose predictions for the
new subject.
b) Subject-dependent standard model development with a
large number of data (SM): A large number of data are
used for the new model development for a new subject
using standard LS algebra without using the information
from the base model. The new identified model is then
used to make glucose predictions for the new subject.
c) Global ARX model (GL) [16]: The new prediction models
are obtained by directly applying a base model (i.e., a
global model) to new subjects without any customization.
Based on the evaluation of prediction metrics, comparison is
made between the rapid modeling method by MM and subjectdependent standard modeling method with respect to the prediction performance for future glucose concentrations. It checks
whether an ARX prediction model can be rapidly obtained by
simple model parameter adjustment based on a small number

1338

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

TABLE I
DEFINITION OF TRUE POSITIVE (TP), FALSE NEGATIVE (FN), FALSE POSITIVE
(FP), TRUE NEGATIVE (TN)
Description
One measurement sample is in the
hyper/hypoglycemic region
One measurement sample is in the
hyper/hypoglycemic region
One measurement sample is not
in the hyper/hypoglycemic region
One measurement sample is not
in the hyper/hypoglycemic region

Definition

The corresponding prediction
is also in the
hyper/hypoglycemic region
The corresponding prediction
is not in the
hyper/hypoglycemic region
The corresponding prediction
is in the hyper/hypoglycemic
region
The corresponding prediction
is either not in the
hyper/hypoglycemic region

A TP sample

A FN sample

A FP sample

A TN sample

III. DATABASE

of data and whether it is comparable to the subject-dependent
standard models with a larger number of data.
Some measurements from new subjects are used as training
data for development of new prediction models and then the
other data are used as testing data to evaluate the accuracy of
prediction models. In order to evaluate the glucose prediction
performance, three metrics are used:
1) Root-Mean-Square Error (RMSE (mg/dL)) [24]:

RMSE =

1 
(y (i) − ŷ (i))2
N

way, the duration of hyper/hypoglycemic event is also employed
for the calculation.
Sensitivity [31] is defined as the percentage of all TP samples among all the measured hyper/hypoglycemic samples,
P
Sensitivity = T PT+F
N . Similarly, Specificity [31] is a measure
used to correctly identify the absence of hyper/hypoglycemic
N
alarms, Speciﬁcity = T NT+F
P . From the aforesaid definition,
we can see that the bigger the Sensitivity and Specificity, the
more accurate the predictions. The detailed description and significance of Sensitivity and Specificity can refer to the work by
Eren–Oruklu et al. [31]

(3)

i∈N

where ŷ (i) is the predicted value, y (i) is the measurement; and
N is the number of samples. RMSE is a frequently used measure
of the differences between values predicted by a model or an
estimator and the values actually observed.
2) Rate Error Grid Analysis (R-EGA) [29]: The R-EGA assesses the prediction ability to capture the direction and rate
of glucose fluctuations. The R-EGA scatterplot is divided into
zones A through E, which has a clinical meaning similar to the
original EGA [30].
3) Time Lag: The time lag is defined as the time difference between a measured hyper/hypoglycemia episode and a predicted
one. The hypoglycemic threshold is set to be 70 mg/dL and the
hyperglycemic threshold is set to be 160 mg/dL. If at least three
consecutive samples are below or equal to the hypoglycemic
threshold, a hypoglycemic alarm begins, termed hypoglycemic
starting point (HoSP) here. When at least three consecutive samples rise above the hypoglycemic threshold, the hypoglycemic
alarm stops, termed hypoglycemic ending point (HoEP) here.
The samples between HoSP and HoEP enclose a hypoglycemic
region. In a similar way, hyperglycemic starting point (HeSP)
and hyperglycemic ending point (HeEP) are also defined. Then
the samples between HeSP and HeEP enclose a hyperglycemic
region. All samples in each region will be compared between
the measurement and the prediction to check whether an alarm
is true or not. The definition of four metrics is shown in Table I.
For each metric defined in Table I, all the associated samples
will be added to count the value of each metric, which will be
used in the below to define Sensitivity and Specificity. In this

As a proof-of-concept study, the simulated data are generated from the FDA-accepted University of Virginia/University
of Padova (UVA/Padova) metabolic simulator with a 5-min sampling interval [32]. To simulate daily life, the study is performed
open-loop without adjustment for the prescribed daily routine. It
includes a three-meal scenario for breakfast, lunch, and dinner
taken at approximately 7:00, 12:00, and 18:00 with 40-, 85-,
and 60-g CHOs, respectively. In practice, the amount of CHOs
is in general estimated by subjects. Four cases are considered to
assess the performance of the MM method [11]:
Case I: The meal timing and CHO content were varied to represent variations daily life for more realistic simulations. Thus,
a 1-h forward or backward in meal timing and ±75% variation
in CHO amount were implemented. Bolus insulin was given simultaneously with CHOs based on the “optimal” subcutaneous
(SQ) insulin bolus.
Case II: It is the same as Case I except that a 30% increase
in insulin-to-carbohydrate ratio (I:C) was considered, which
resulted in significant number of hypoglycemic events.
Case III: It is the same as Case I except that a 30% decrease
in the I:C was considered, which resulted in significant number
of hyperglycemic events.
Case IV: It is the same as Case I except that bolus insulin
was given half an hour later after meal was taken based on the
“optimal” SQ insulin bolus.
Thirty in silico subjects, including three groups of subjects
(ten adolescents, ten adults, and ten children) are chosen as
representatives. Six days of data were simulated for each subject,
but the data of the first day were abandoned since they were not
reliable. To be more realistic, the data were obtained by adding
a noise sequence generated by an AR first-order model (with
pole in 0.95) driven by white Gaussian noise with zero mean
and variance equal to 2 [33], [34]. For training set and test set,
data did not undergo any preprocessing (e.g. digital filtering).
IV. RESULTS AND DISCUSSION
Thirty-min ahead glucose prediction is used to evaluate prediction performance. A preliminary investigation is made for
subject-dependent standard ARX models, where the model orders and time delays for two different inputs are determined to
achieve the best accuracy. Based on the results, the model orders
for glucose, insulin, and meals are set equal to 7, 1, and 1, respectively. The input time delays of both bolus insulin and meal

ZHAO AND YU: RAPID MODEL IDENTIFICATION FOR ONLINE SUBCUTANEOUS GLUCOSE CONCENTRATION PREDICTION

1339

Subject #3
300

Measurement
MM
SM
GL

CGM (mg/dL)

250

200

150

100

50

1

50

100

150

200

250
300
Samples

350

400

450

500

564

350

400

450

500

564

Subject #25
160

Measurement
MM
SM
GL

140

CGM (mg/dL)

120
100
80
60
40
20

1

50

100

150

200

250
300
Samples

Fig. 5. Comparison of representative measured and 30-min predicted glucose
profiles for Subjects #3 (top) and #25 (bottom) and Case I in same-case analysis
based on MM method, subject-dependent standard modeling method (SM), and
global ARX modeling method (GL).

Fig. 4. Effect of the amount of training data on prediction performance for
MM method for (a) P H = 6 (30 min) and (b) P H = 12 (60 min) evaluated
by average of RMSE values for ten adolescents (top), ten adults (middle), and
ten children (bottom) and Case I.

CHOs are set to be 5, which means kin s = 5 and km eal = 5.
The base model is then developed using LS algorithm for one in
silico subject, which is chosen randomly (the below results are
based on adult #1, i.e., Subjects #11, which is chosen randomly).
For each new subject, rapid model development is performed.
From the time when both inputs have been taken, the measured

data will cover important information about the influences of
inputs on glucose for the new subject. The data after that time
are then used as training data. Based on the adjustment strategy
described in previous section, a new prediction model is rapidly
identified for the new subject. The new model is then applied
to the other data of the new subject to evaluate the prediction
accuracy.
In the present study, two types of analyses are performed to
evaluate the performance of the proposed modeling method:
a) Same-case analysis where a prediction model is developed
based on training data from one case and then applied to
the testing data of the same case.
b) Cross-case analysis where a prediction model is developed
based on training data from one case and then applied to
the testing data of a different case.
Fig. 4 shows the influence of the amount of training data
(Ntr ), which start from the sample at lunch (breakfast or dinner
can have the similar results) and are consecutive Ntr samples,
on the prediction accuracy for Case I and three groups of subjects where the new model is developed based on data from
Case I and then tested based on data from the same case, which
is the same-case analysis. Here, two PH values are considered
for glucose prediction. For both 30- and 60-min ahead glucose
predictions, RMSE index is used to evaluate the prediction accuracy and its average is calculated for ten in silico subjects in each
group and two day of testing data. When Ntr = 13, only one
30-min-ahead glucose prediction value is available for model
parameter adjustment since the first seven samples are used as
predictors. For the similar reason, when Ntr = 19, only one

1340

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

TABLE II
GLUCOSE PREDICTION ACCURACY (MEAN ±STANDARD DEVIATION) WITH PH = 6 (30 MIN) FOR TEN ADOLESCENTS USING (A) MODEL MIGRATION METHOD,
(B) SUBJECT-DEPENDENT STANDARD MODELING METHOD, AND (C) GLOBAL ARX MODELING METHOD
Case No. For
testing data

RMSE (mg/dL)

R-EGA (% in
zone A)

Time Lag for
hyper alarm
(samples)

Case I
Case II
Case III
Case IV

14.85 ± 4.94
15.10 ± 4.78
15.92 ± 4.86
21.73 ± 5.46

70.76 ± 1.31
70.80 ± 2.24
69.59 ± 1.37
69.40 ± 2.12

4.33 ± 0.62
3.97 ± 0.81
3.53 ± 1.74
3.50 ± 1.59

Case I
Case II
Case III
Case IV

14.18 ± 5.75
15.50 ± 7.04
16.16 ± 7.14
24.64 ± 14.93

70.94 ± 9.52
70.89 ± 9.67
69.88 ± 9.21
70.39 ± 8.40

4.04 ± 1.02
3.40 ± 1.07
3.03 ± 1.88
3.67 ± 1.65

Case I
Case II
Case III
Case IV

17.84 ± 7.81
19.62 ± 11.67
17.24 ± 5.05
24.11 ± 8.63

70.71 ± 1.28
70.83 ± 2.49
69.54 ± 1.40
69.36 ± 2.08

4.46 ± 0.74
4.00 ± 0.93
3.80 ± 1.69
3.50 ± 1.59

Sensitivity for
hyper alarm (%)

(A)
92.79
85.59
93.73
78.44
(B)
93.21
75.55
90.72
77.22
(C)
92.06
58.08
91.03
75.08

Specificity for
hyper alarm (%)

Time Lag for
hypo alarm
(samples)

Sensitivity for
hypo alarm (%)

Specificity for
hyper alarm (%)

99.51
99.64
97.08
95.01

4.71 ± 2.21
3.40 ± 2.55
—
—

60.96
87.85
—
0

99.65
99.07
100
98.93

99.06
98.63
93.87
93.91

3.80 ± 2.28
2.64 ± 2.70
—
—

30.48
77.02
—
0

99.47
99.11
100
99.87

98.76
98.71
96.06
94.69

4.71 ± 2.21
3.63 ± 2.55
—
—

60.96
86.74
—
0

99.65
98.75
100
98.73

— indicates that no related alarm samples or no alarm samples can be predicted.

TABLE III
GLUCOSE PREDICTION ACCURACY (MEAN ±STANDARD DEVIATION) WITH PH = 6 (30 MIN) FOR TEN ADULTS USING (A) MODEL MIGRATION METHOD, (B)
SUBJECT-DEPENDENT STANDARD MODELING METHOD, AND (C) GLOBAL ARX MODELING METHOD
Case No. For
testing data

RMSE (mg/dL)

R-EGA (% in
zone A)

Time Lag for
hyper alarm
(samples)

Case I
Case II
Case III
Case IV

10.98 ± 2.10
11.71 ± 2.04
12.03 ± 2.34
17.68 ± 2.85

70.50 ± 0.57
70.85 ± 1.11
70.12 ± 1.67
68.83 ± 1.12

3.31 ± 1.42
3.80 ± 0.77
3.47 ± 1.61
3.41 ± 1.62

Case I
Case II
Case III
Case IV

9.93 ± 2.73
10.80 ± 2.80
11.08 ± 3.00
15.86 ± 5.44

77.35 ± 6.46
77.28 ± 5.93
76.80 ± 6.63
76.11 ± 5.45

3.14 ± 1.25
3.13 ± 1.41
3.62 ± 1.92
4.19 ± 1.51

Case I
Case II
Case III
Case IV

15.11 ± 5.17
18.38 ± 8.98
13.29 ± 3.28
21.50 ± 5.95

70.32 ± 0.95
71.05 ± 0.86
70.21 ± 1.59
69.18 ± 1.41

3.62 ± 1.40
3.90 ± 0.74
3.95 ± 1.45
3.41 ± 1.62

Sensitivity for
hyper alarm (%)

(A)
90.00
42.08
97.29
62.83
(B)
88.89
60.62
76.70
75.55
(C)
55.74
26.64
81.83
55.31

Specificity for
hyper alarm (%)

Time Lag for
hypo alarm
(samples)

Sensitivity for
hypo alarm (%)

Specificity for
hyper alarm (%)

99.49
99.50
98.27
96.36

5.00 ± 2.24
3.45 ± 2.54
—
6.00 ± 0

58.84
76.44
—
89.16

99.59
97.38
100
100

99.59
99.48
93.92
96.60

4.50 ± 2.51
3.22 ± 2.37
—
6.00 ± 0

64.97
72.83
—
81.93

99.46
97.68
100
100

97.98
99.16
94.22
96.55

5.00 ± 2.24
3.64 ± 2.57
—
6.00 ± 0

62.24
77.71
—
89.16

99.59
95.34
100
99.87

— indicates that no related alarm samples or no alarm samples can be predicted.

60-min-ahead glucose prediction value is available for model
parameter adjustment. As the amount of training data increases,
the prediction accuracy is improved for all three groups of subjects since more glucose prediction values are available for MM.
However, the prediction accuracy almost stays invariable after a
certain number of training data for each group based on the evaluation of RMSE metric. Based on the paired t-test (α = 0.05)
[35], the results for 30-min glucose prediction will not change
after Ntr = 20 samples for adolescents, Ntr = 15 samples for
adults, and Ntr = 13 samples for children, respectively. Considering the average results for three groups of subjects, the
difference between the case using Ntr = 20 and the other cases
using a larger Ntr is not statistically significant based on the
paired t-test (α = 0.05) [35]. For the results regarding 60-min
glucose prediction, a larger Ntr is required (about 25 sam-

ples) based on the average results for three groups of subjects.
For other cases, the similar conclusions can be drawn, which
are not shown here. For the subsequent rapid model development, we focus on glucose prediction with P H = 6 (30 min)
and a value of Ntr = 24 (2 h) is used from which 12 prediction samples are available to guide the adjustment of model
parameters.
Using models developed based on training data from Case I,
comparisons of the measured and predicted glucose profiles are
shown in Fig. 5 for MM method, subject-dependent standard
modeling method, and global ARX modeling method. These
results are for two different subjects and two day of testing data
from Case I, which indicates the same-case analysis. In general,
the evolving glucose trends are captured by MM method and
subject-dependent standard modeling method and the difference

ZHAO AND YU: RAPID MODEL IDENTIFICATION FOR ONLINE SUBCUTANEOUS GLUCOSE CONCENTRATION PREDICTION

1341

TABLE IV
GLUCOSE PREDICTIONACCURACY (MEAN ±STANDARD DEVIATION) WITH PH = 6 (30 MIN) FOR TEN CHILDREN USING (A) MODEL MIGRATION METHOD
(B) SUBJECT-DEPENDENT STANDARD MODELING METHOD AND (C) GLOBAL ARX MODELING METHOD
Case No. For
testing data

RMSE (mg/dL)

R-EGA (% in
zone A)

Time Lag for
hyper alarm
(samples)

Case I
Case II
Case III
Case IV

18.56 ± 10.29
17.87 ± 10.04
25.63 ± 12.83
29.77 ± 13.01

66.87 ± 5.71
64.96 ± 7.22
69.18 ± 1.66
66.82 ± 5.39

4.20 ± 0.77
4.46 ± 0.78
3.71 ± 1.55
3.52 ± 1.77

Case I
Case II
Case III
Case IV

16.15 ± 8.32
19.32 ± 11.17
24.18 ± 12.79
36.47 ± 24.05

65.19 ± 15.18
62.40 ± 16.60
69.11 ± 9.82
65.67 ± 11.91

4.13 ± 0.99
4.38 ± 1.04
3.61 ± 1.52
4.03 ± 1.61

Case I
Case II
Case III
Case IV

21.42 ± 10.08
21.05 ± 9.59
27.04 ± 13.60
31.20 ± 12.40

66.79 ± 5.78
64.51 ± 7.18
69.01 ± 1.71
66.87 ± 5.04

4.20 ± 0.77
4.46 ± 0.78
3.71 ± 1.55
3.52 ± 1.77

Sensitivity for
hyper alarm (%)

(A)
90.00
69.61
96.54
90.17
(B)
80.00
75.69
91.53
79.49
(C)
97.41
92.82
97.50
92.70

of prediction accuracy is not significant for the two methods.
However, the global ARX models are worse than the other two
methods based on paired t-test in particular for Subject #25.
Tables II– IV summarize the model prediction accuracy of
three different methods for three groups of in silico subjects
and 30-min ahead predictions. Three metrics, RMSE (mg/dL),
R-EGA (%) in zone A, time lag of hyper/hypo alarms plus
Sensitivity and Specificity are used to evaluate the prediction
performance. To calculate time lag for hyper/hypo alarm, only
the detected alarm samples are counted to calculate the average results (mean±standard deviation). It is noted that a smaller
time lag does not necessarily indicate better prediction performance, which may result from the fact that only some of abnormal alarm samples are detected. Therefore, Sensitivity and
Specificity should be combined with time lag index. For model
development, measurement data from Case I are chosen as training data. Then, the developed models are tested based on the last
two day data from Cases I–IV to evaluate model accuracy. In
this way, both same-case and cross-case analyses are conducted
and the model generalization ability can be studied in cross-case
analysis. For MM method, the base model is developed using an
LS algorithm based on three days (from the second day to the
fourth day) of simulated data covering 864 samples from Case
I for Subject #11, which is chosen randomly and 24 samples
(2 h) that are started from lunch (breakfast or dinner can have
the similar results) for Case I are used for model adjustment. For
subject-dependent standard modeling method, three days (from
the second day to the fourth day) of simulated data covering
864 samples from Case I are used for model development. For
global ARX modeling method, the base model (i.e., the global
model) is the same as that in MM method. Clearly, the number
of modeling data used for MM method is much smaller than that
used for subject-dependent standard modeling method. For MM
method and subject-dependent standard modeling method, the
testing results using models developed from Case I and tested
for Case I (i.e., same-case analysis) indicate comparable prediction accuracy, although the proposed MM method may give

Specificity for
hyper alarm (%)

Time Lag for
hypo alarm
(samples)

Sensitivity for
hypo alarm (%)

Specificity for
hyper alarm (%)

99.26
99.87
97.91
98.78

3.59 ± 2.45
3.91 ± 2.22
5.00 ± 2.55
3.33 ± 2.23

74.92
87.39
66.59
74.34

97.34
97.74
98.81
81.44

99.35
99.45
98.94
97.89

3.62 ± 2.61
3.95 ± 2.57
3.09 ± 2.14
2.39 ± 2.52

68.30
67.72
65.24
65.06

97.59
96.39
97.40
80.54

98.81
99.38
98.26
98.48

3.87 ± 2.36
3.91 ± 2.22
5.00 ± 2.14
3.60 ± 2.39

79.13
89.43
66.59
74.49

97.73
97.10
98.81
81.34

slightly lower accuracy than that for subject-dependent standard
modeling method for adults and children based on RMSE index.
However, the MM method may give better accuracy than that
for subject-dependent standard modeling method based on Sensitivity and Specificity. The difference of prediction accuracy is
not statistically significant for adolescents based on the paired
t-test (α = 0.05) [35] as indicated by RMSE, R-EGA (%) in
zone A, time lag, Sensitivity, and Specificity for hyperglycemic
alarm. However, the MM method can give better accuracy based
on time lag, Sensitivity, and Specificity for hypoglycemic alarm.
For global ARX modeling method, the prediction accuracy is
statistically worse than that of the other two methods based on
the paired t-test (α = 0.05) [35] as indicated by RMSE index,
which reveals that ARX model is not as global as AR model.
When the models are developed from Case I and then tested
for the other cases (i.e., cross-case analysis), the difference of
prediction accuracy of MM method and subject-dependent standard modeling method is not statistically significant based on
the paired t-test (α = 0.05) [35] as indicated by RMSE index,
which presents good generalization ability of the proposed MM
method. The prediction accuracy of the global ARX modeling
method for cross-case analysis is statistically worse than that
of MM method. However, the difference of prediction accuracy is not statistically significant in comparison with subjectdependent standard modeling method for Case IV based on the
paired t-test (α = 0.05) [35] as indicated by RMSE index.
In order to analyze the performance of the three methods for
cross-case analysis, predicted profiles are compared with measured profiles for Subjects #2 and #29 and two day of testing data
from Cases II–IV as shown in Fig. 6. The models are developed
based on data from Case I and then tested for data from Cases
II–IV. For subject-dependent standard modeling method, the
predicted profiles fail to capture the true glucose trends around
the glucose peaks especially for Case IV. It reveals that input
parameters of subject-dependent standard models that can well
reflect the glucose response to inputs in Case I, however, are not
suitable to reflect the glucose dynamics in Case IV. Global ARX

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

Measurement
MM
SM
GL

Subject #2

CGM (mg/dL)

300

200

100

The effect of PH on prediction accuracy in Case I
40
RMSE (mg/dL)

1342

30
20
10
0

0

1

50

100

150

200

250

300

350

400

450

500

MM1
MM2
SM
GL

0

2

4

6

8

10

12

4

6

8

10

12

4

6
PH (Samples)

8

10

12

564

30
RMSE (mg/dL)

500

CGM (mg/dL)

400
300
200

20

10

100
0

0
1

50

100

150

200

250

300

350

400

450

500

564

RMSE (mg/dL)

600
400
200
0

0

2

50

800

CGM (mg/dL)

MM1
MM2
SM
GL

30
20
10
0

1

50

100

150

200

250
300
Samples

350

400

450

500

MM1
MM2
SM
GL

40

564

0

2

(a)

(a)

The effect of PH on prediction accuracy in Case IV

Subject #29
Measurement
MM
SM
GL

CGM (mg/dL)

400
300
200

60
RMSE (mg/dL)

500

20

0
1

50

100

150

200

250

300

350

400

450

500

564

RMSE (mg/dL)

400
200
0
-200

0

2

4

6

8

10

12

4

6

8

10

12

4

6
PH (Samples)

8

10

12

50

600

CGM (mg/dL)

40

100
0

50

100

150

200

250

300

350

400

450

500

MM1
MM2
SM
GL

40
30
20
10
0

1

564

0

2

80

600

RMSE (mg/dL)

400
CGM (mg/dL)

MM1
MM2
SM
GL

200
0

MM1
MM2
SM
GL

60
40
20

-200
-400

0
1

50

100

200

300
Samples

400

500

564

(b)

Fig. 6. Comparison of representative measured and 30-min predicted glucose
profiles for (a) Subjects #2 and (b) # 29 and Case II (top), Case III (middle),
and Case IV (bottom) in cross-case analysis based on MM method, subjectdependent standard modeling method (SM), and global ARX modeling method
(GL).

model presents acceptable generalization ability for Subject #29
but worse generalization ability for Subject #2 in Case II.
Based on the results in Fig. 6, subject-dependent standard
modeling method may not present good generalization ability
when the conditions for training data and testing data are different. That is, the model parameters may overfit the training

0

2

(b)

Fig. 7. Effect of PH on prediction accuracy in (a) Case I and (b) Case IV evaluated by average of RMSE values using MM method with 24 training samples
(MM1), MM method with fixed 12 samples available for model parameter adjustment (MM2), subject-dependent standard modeling method (SM) and global
ARX modeling model (GL) for ten adolescents (top), ten adults (middle), and
ten children (bottom).

data but fail to reveal the response relationship in testing data.
ARX model is not as global as AR model [16], which may result
from such a fact that different subjects may give different response to the same exogenous inputs. In contrast, the proposed
MM method shows good generalization ability. It may result

ZHAO AND YU: RAPID MODEL IDENTIFICATION FOR ONLINE SUBCUTANEOUS GLUCOSE CONCENTRATION PREDICTION

from the fact that the parameters are obtained by simple adjustment based on a small number of training data, which thus may
overcome the problem of overfitting to a certain extent. Also, by
MM, the sign of model parameters for two exogenous inputs can
be set correctly. For example, for parameters of insulin, the sign
should be negative, which is constrained during the adjustment
procedure. However, for subject-dependent standard modeling
method, the sign may be falsely calculated since the models are
driven by pure measurement data. What is more, the amount of
training data for proposed MM method is much less than that
for subject-dependent standard modeling method.
The influence of PH on the prediction performance is also
assessed and compared for the three methods. The mean value
of RMSE index is calculated for each group of in silico subjects
and shown in Fig. 7 as a function of PH for the three methods.
Besides, to evaluate the influences of the sample size of training
data, two different values are tested for MM method, which are
denoted as MM1 and MM2, respectively. For MM1, a value of
Ntr = 24 (2 h) is used from which 16, 14, 12, 10, 8, 6 prediction
samples are available for P H = 2, 4, 6, 8, 10, 12, respectively,
to guide the adjustment of model parameters. For MM2, the Ntr
ranges from 20 to 30 for different PHs to keep 12 prediction
samples are available for model parameter adjustment since
the first seven samples are used as predictors. The prediction
models are developed from Case I and then tested for two day of
testing data from Cases I and IV, which correspond to same-case
analysis and cross-case analysis, respectively. As expected, the
prediction accuracy decreases as PH increases for all methods in
both analyses. Moreover, for MM2, when the number of training
data increases from 20 to 30 samples, the prediction accuracy is
nearly the same as that of MM1 because the results for glucose
prediction will not change after N tr = 25 for PH ࣘ 12, which
agrees with the scenario shown in Fig. 4. Furthermore, the MM
method is more accurate than subject-dependent standard model
when the training data and testing data are from different cases
as shown in Fig. 7(b). In particular, the difference between
MM method and subject-dependent standard modeling method
is not statistically significant for same-case analysis and crosscase analysis based on the paired t-test (α = 0.05) for small PH
values (<six samples). For Cases II and III, a similar conclusion
can be drawn with that for Case IV, which is not presented
here. Besides, the MM method and subject-dependent standard
modeling method, in general, show better prediction accuracy
than the global ARX modeling method when PH value is larger
than 6 in same-case analysis and cross-case analysis based on
the paired t-test (α = 0.05) except for children in Case IV.
V. CONCLUSION
In this paper, a rapid and economic modeling method is developed using the idea of MM. Starting from a base model for
one old subject and a small number of data for new subjects,
the input parameters of the base model are properly adjusted to
capture the differences between the old subject and new subjects. New prediction model are, thus, readily obtained and used
for online short-term ahead glucose prediction for type 1 diabetes mellitus. The results indicate that the prediction accuracy

1343

of the rapid modeling method is comparable to that for subjectdependent standard modeling method for some cases and better than global ARX model, which indicates the advantages of
adjusting model parameter. Also, MM method presents better
generalization ability. The proposed method can be regarded as
an effective and economic modeling method instead of repetitive subject-dependent standard modeling method especially
for lack of modeling data. Although the results are obtained for
in silico subjects, these promising analyses results encourage
extensions of this research methodology. For example, special
attentions may be required to evaluate the online prediction performance of the proposed strategy based on clinical data, where
some problems in real-world deserve attentions, such as CGM
measurement noise and CGM inaccuracy [36], [37]. Besides,
the rapid modeling method is derived based on ARX model.
It would be interesting to check whether it is suitable to other
modeling algorithms, such as Kalman filter [38], latent variable
algorithm [14], etc. In particular, a critical problem concerns
glucose controller based on online prediction of future glucose.
The feasibility of the rapid model development for online glucose control is another meaningful problem that deserves further
efforts.
REFERENCES
[1] (2008). [Online]. Available: http://en.wikipedia.org/wiki/Diabetes_
mellitus_type_1#cite_note-2
[2] R. R. Rubin and M. Peyrot, “Quality of life and diabetes,” Diabetes/Metab.
Res. Rev., vol. 15, no. 3, pp. 205–218, 1999.
[3] M. L. Misso et al., “Continuous subcutaneous insulin infusion (CSII)
versus multiple insulin injections for type 1 diabetes mellitus,” Cochrane
Database. Syst. Rev., vol. 1, pp. 1–94, 2010.
[4] R. Rabasa-Lhoret et al., “Effects of meal carbohydrate content on insulin
requirements in type 1 diabetic patients treated intensively with the basalbolus (ultralente-regular) insulin regimen,” Diabetes Care, vol. 22, no. 5,
pp. 667–673, 1999.
[5] (2013). [Online]. Available: http://www.uptodate.com/contents/preventingcomplications-in-diabetes-mellitus-beyond-the-basics
[6] E. Boland et al., “Limitations of conventional methods of self-monitoring
of blood glucose: Lessons learned from 3 days of continuous glucose
sensing in pediatric patients with type 1 diabetes,” Diabetes Care, vol. 24,
no. 11, pp. 1858–1862, 2001.
[7] S. L. Ellis et al., “Use of continuous glucose monitoring to improve
diabetes mellitus management,” Endocrin. Metab. Clin., vol. 36, pp. 46–
68, 2007.
[8] W. V. Tamborlane et al., “Continuous glucose monitoring and intensive
treatment of type 1 diabete,” N. Engl. J. Med., vol. 359, no. 14, pp. 1464–
1476, 2008.
[9] T. Bremer and D. A. Gough, “Is blood glucose predictable from previous
values? A solicitation for data,” Diabetes, vol. 48, no. 3, pp. 445–451,
1999.
[10] D. A. Finan et al., “Effect of input excitation on the quality of empirical
dynamic models for type 1 diabetes,” AIChE J., vol. 55, no. 5, pp. 1135–
1146, 2009.
[11] C. H. Zhao et al., “Predicting subcutaneous glucose concentration using
a latent-variable-based statistical method for type 1 diabetes mellitus,”
J. Diabetes Sci. Technol., vol. 6, no. 3, pp. 617–633, 2012.
[12] G. Sparacino et al., “Glucose concentration can be predicted ahead in
time from continuous glucose monitoring sensor time-series,” IEEE Trans.
Biomed. Eng., vol. 54, no. 5, pp. 931–937, May 2007.
[13] F. Zanderigo et al., “Glucose prediction algorithms from continuous
monitoring data: Assessment of accuracy via continuous glucose errorgrid analysis,” J. Diabetes Sci. Technol., vol. 1, no. 5, pp. 645–651, 2007.
[14] C. H. Zhao et al., “Predicting subcutaneous glucose concentration using
latent variable (LV)-based statistical analysis method for type 1 diabetes
mellitus,” J. Diabetes Sci. Technol., vol. 6, no. 3, pp. 617–633, 2012.
[15] J. Reifman et al., “Predictive monitoring for improved management of
glucose levels,” J. Diabetes Sci. Technol., vol. 1, no. 4, pp. 478–486, 2007.

1344

[16] C. H. Zhao et al., “Online prediction of subcutaneous glucose concentration for type 1 diabetes using empirical models and frequency-band
separation,” AIChE J., vol. 60, no. 2, pp. 574–584, 2014.
[17] M. Eren-Qruklu et al., “Estimation of future glucose concentrations with
subject-specific recursive linear models,” Diabetes Technol. Ther., vol. 11,
no. 4, pp. 243–253, 2009.
[18] A. Gani et al., “Predicting subcutaneous glucose concentration in humans:
Data-driven glucose modeling,” IEEE Trans. Biomed. Eng., vol. 56, no. 2,
pp. 246–254, Feb. 2009.
[19] D. A. Finan et al., “Practical issues in the identification of empirical
models from simulated type 1 diabetes data,” Diabetes Technol. Ther.,
vol. 9, no. 5, pp. 438–450, 2007.
[20] C. C. Palerm et al., “Hypoglycemia prediction and detection using optimal
estimation,” Diabetes Technol. Ther., vol. 7, no. 1, pp. 3–14, 2005.
[21] C. H. Zhao et al., “Interindividual glucose dynamics in different frequency
bands for online prediction of subcutaneous glucose concentration in type
1 diabetic subjects,” AIChE J., vol. 59, no. 11, pp. 4228–4240, 2013.
[22] C. Pérez-Gandı́a et al., “Artificial neural network algorithm for online
glucose prediction from continuous glucose monitoring,” Diabetes Tech.
Ther., vol. 12, no. 1, pp. 81–88, 2010.
[23] S. M. Pappada et al., “Neural network-based real-time prediction of
glucose in patients with insulin-dependent diabetes,” Diabetes Tech. Ther.,
vol. 13, no. 2, pp. 135–141, 2011.
[24] A. Gani et al., “Universal glucose models for predicting subcutaneous
glucose concentration in Humans,” IEEE Trans. Inf. Technol. Biomed.,
vol. 14, no. 1, pp. 157–165, Jan. 2010.
[25] A. N. Tikhonov and V. Y. Arsenin, Solutions of Ill-Posed Problems. Washington, D.C., USA: Winston, 1977.
[26] J. D. Lu et al., “Process similarity and developing new process models
through migration,” AIChE J., vol. 55, no. 9, pp. 2318–2328, 2009.
[27] L. Ljung. System Identification: Theory for the User. Upper Saddle River,
NJ, USA: Prentice-Hall, 1999.
[28] B. Grosman et al., “Zone model predictive control: A strategy to minimize hyper- and hypoglycaemic events,” J. Diabetes Sci. Technol., vol. 4,
no. 4, pp. 961–975, 2010.
[29] B. P. Kovatchev et al., “Evaluating the accuracy of continuous glucosemonitoring sensors,” Diabetes Care, vol. 27, no. 8, pp. 1922–1928, 2004.
[30] W. Clarke and B. Kovatchev, “Statistical tools to analyze continuous
glucose monitor data,” Diabetes Technol. Ther., vol. 11, no. S1, pp. S–
45–S-54, 2009.
[31] M. Eren-Oruklu et al., “Hypoglycemia prediction with subject-specific
recursive time-series models,” J. Diabetes Sci. Technol., vol. 4, no. 1,
pp. 25–33, 2010.
[32] B. P. Kovatchev et al., “In silico preclinical trials: A proof of concept in
closed-loop control of type 1 diabetes,” J. Diabetes. Sci. Technol., vol. 3,
no. 1, pp. 44–55, 2009.
[33] C. Zecchin et al. “Neural network incorporating meal information improves accuracy of short-time prediction of glucose concentration,” IEEE
Trans. Biomed. Eng., vol. 59, no. 6, pp. 1550–1560, Jun. 2012.

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 5, MAY 2015

[34] A. Facchinetti et al., “Modeling the error of continuous glucose monitoring sensor data: Critical aspects discussed through simulation studies,”
J. Diabetes Sci. Technol., vol. 4, no. 1, pp. 4–14, 2010.
[35] D. C. Montgomery and G. C. Runger, Applied Statistics and Probability
for Engineers. 4th ed. New York, NY, USA : Wiley, 2006.
[36] M Breton and B Kovatchev, “Analysis, modeling, and simulation of the
accuracy of continuous glucose sensors,” J. Diabetes Sci. Technol., vol. 2,
no. 5, pp. 853–862, 2008.
[37] A Facchinetti et al., “Modeling the glucose sensor error,” IEEE Trans.
Biomed. Eng., vol. 61, no. 3, pp. 620–629, Mar. 2014.
[38] E. J. Knobbe and B. Buckingham, “The extended Kalman filter for
continuous glucose monitoring,” Diabetes Technol. Ther., vol. 7, no. 1,
pp. 15–27, 2005.

Chunhui Zhao (M’12) received the B.Eng., M.Sci.,
and Ph.D. degrees from the Department of Automation, Northeastern University, Shenyang, China, in
2003, 2006, and 2009, respectively.
She is currently a Professor with the Department
of Control Science and Engineering, Zhejiang University, Hangzhou, China, since January 2012. She
has published more than 100 papers in peer-reviewed
international journals and conferences. Her research
interests include statistical process monitoring, fault
diagnosis, and glucose control.
Dr. Zhao received the National Top 100 Excellent Doctor Thesis Nomination
Award, New Century Excellent Talents in University, China, and National Science Fund for Excellent Young Scholars, respectively. She was a Postdoctoral
Fellow (January 2009–January 2012) at the Hong Kong University of Science
and Technology, and the University of California, Santa Barbara, Los Angeles,
CA, USA.

Chengxia Yu received the B.Eng. degree from the
Department of Information and Electrical Engineering, China University of Mining and Technology,
Xuzhou, China, in 2013. She is currently working
toward the M.Sci. degree at the State Key Laboratory of Industrial Control Technology, Department of
Control Science and Engineering, Zhejiang University, Hangzhou, China.
Her current research interests include glucose
monitoring, prediction, and control.

