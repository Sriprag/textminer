IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

2837

A μm-Scale Computational Model of Magnetic
Neural Stimulation in Multifascicular
Peripheral Nerves
Anil Kumar RamRakhyani∗ , Member, IEEE, Zachary B. Kagan, Student Member, IEEE,
David J. Warren, Senior Member, IEEE, Richard A. Normann, and Gianluca Lazzi, Fellow, IEEE

Abstract—There has been recurring interest in using magnetic
neural stimulation for implantable localized stimulation. However,
the large stimulation voltages and energies necessary to evoke neuronal activity have tempered this interest. To investigate the potential of magnetic stimulation as a viable methodology and to provide
the ability to investigate novel coil designs that can result in lower
stimulation threshold voltages and energies, there is a need for a
model that accurately predicts the magnetic field–tissue interaction that results in neuronal stimulation. In this study, we provide
a computational framework to accurately estimate the stimulation
threshold and have validated the model with in vivo magnetic stimulation experiments. To make such predictions, we developed a
micrometer-resolution anatomically driven computational model
of rat sciatic nerve and quantified the effect of tissue heterogeneity
(i.e., fascicular organization, axon distribution, and density) and
axonal membrane capacitance on the resulting threshold. Using
the multiresolution impedance method, we computed the spatialtemporal distribution of the induced electric field in the nerve and
applied this field to a Frankenhaeuser–Huxley axon model in NEURON to simulate the nonlinear mechanisms of the membrane channels. The computational model developed predicts the stimulation
thresholds for four magnetic coil designs with different geometrical parameters within the 95% confidence interval (experiments
count = 4) of measured in vivo stimulation thresholds for the rat
sciatic nerve.
Index Terms—Computational model, magnetic coil, magnetic
stimulation, multiresolution model, multiscale modeling, peripheral nerve, sciatic nerve.

I. INTRODUCTION
AGNETIC neural stimulation is emerging as a technique
for transcranial [1], [2] and peripheral nerve stimulation
[3], and for the investigation of cortical connectivity/reactivity
[4]. As most biological tissues have uniform relative magnetic
permeabilities (close to that of air), applied magnetic fields are

M

Manuscript received December 24, 2014; revised June 9, 2015;
accepted June 9, 2015. Date of publication June 17, 2015; date
of current version November 20, 2015. This work was supported
by the National Science Foundation under Grant ECCS-1202235.
A. K. RamRakhyani and Z. B. Kagan contributed equally to this work. Asterisk indicates corresponding author.
* A. K. RamRakhyani is with the Department of Electrical and Computer Engineering, University of Utah, Salt Lake City, UT 84112 USA (e-mail: akram84@
gmail.com).
Z. B. Kagan, D. J. Warren, and R. A. Normann are with the Department of
Bioengineering, University of Utah.
G. Lazzi is with the Department of Electrical and Computer Engineering,
University of Utah.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2446761

unaffected by tissue heterogeneity. Based on this property, noninvasive extracorporeal magnetic coils have been employed to
evoke neural activity using time-varying magnetic fields. Performance of these designs is primarily limited by the ability of
the magnetic coil and stimulator circuit to generate an effective spatial-temporal distribution of the induced electric fields
inside tissue. Even though many studies have pursued the goal
of optimizing coil designs [5] and circuit designs [6], the design
parameters in these studies were chosen on an ad hoc basis, or
by use of a simplified homogeneous (uniform conductivity) tissue model. The large sizes of the coils (∼ 5 cm diameter) used
in these studies [1], [7], the low stimulation focality [8], and
the high stimulation energy (∼100 J) [3], [7], [9] remain as key
challenges in designing a safe and efficient magnetic stimulator.
Accurate prediction of stimulator performance in animal or
human subjects is an important step in the design and optimization of coil and stimulator parameters. Previously, the understanding of the magnetic field’s interaction with biological
tissue had been based on in vitro experiments performed in
peripheral [10], [11] and central [12]–[14] nervous systems.
To study the effect of stimulation parameters (magnitude and
pulsewidth (PW) of coil current), many studies used frog sciatic nerve in in vitro experiments [11], [15], [16]. Other studies
focused on in vivo experiments, performing peripheral stimulation of rabbit sciatic nerve [7] and transcranial stimulation in
behaving primates [17]. These experiments established stimulation thresholds in terms of stimulation voltage [11] or induced
electric field magnitude [7]. However, these values are highly
susceptible to the operating conditions of the experiment (air–
tissue interface and the surrounding medium), which restricts
stimulation threshold predictions under new experimental circumstances. In contrast, we propose that the preexperiment performance of a magnetic stimulator can best be predicted using
anatomically driven computational models of the tissue and the
experimental arrangement.
Although computational models to study transcranial magnetic stimulation [18] and peripheral nerve stimulation [19] have
been developed, these models, with spatial resolution on the order of millimeters, did not include the interactions of neurons
or axons with the magnetic fields and were not validated using
in vivo experiments. Moreover, axonal membrane capacitance
was not included in these models, thus potentially affecting the
temporal distribution of the induced electric fields. Recently,
we presented the induced field distribution inside a heterogeneous tissue environment and studied the effect of axon packing

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2838

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

density on the magnitude of the induced field [20]. In the present
work, we introduce a modeling framework that accurately predicts the stimulation thresholds during in vivo magnetic stimulation of rat sciatic nerve. To make such predictions, we developed a multiresolution impedance method to compute the
induced electric fields resulting from an applied magnetic field
and we combined this method with the Frankenhaeuser–Huxley
(FH) axon model [21] to simulate active neuronal membrane
mechanisms. To improve the simulation’s prediction accuracy,
we created a detailed micrometer-scale computational model
of the rat sciatic nerve based on a histological image of the
sciatic nerve cross section. Moreover, the resulting modeling
approach was validated for a variety of solenoid-shaped magnetic coils (each with different geometrical parameters) with
in vivo magnetic stimulation experiments. Predicted magnetic
stimulation thresholds were within the 95% confidence interval
of the measured thresholds in magnetic stimulation experiments
in rat sciatic nerve.
The proposed modeling framework is divided into three steps.
First, a high-resolution computational model of the nerve was
created, which includes statistically distributed axon diameters
and densities. The nerve was positioned in the simulation model
in a manner that closely represents the setup for our in vivo magnetic neural stimulation experiments. Second, we implemented
a multiresolution field simulator to resolve fine biological features (axon myelination and axonal membranes) and used it to
solve the electric field distribution in the multifascicular nerve.
During this step, we also studied the effect of axon diameter and
membrane capacitance on the induced field distribution. Third,
we implemented the FH axon model in NEURON to estimate the
minimum magnetic stimulator voltage that can elicit an action
potential in the axon. Each step was individually validated by
comparing the simulation predictions with analytical solutions.
II. THEORY OF OPERATION AND SIMULATION APPROACH
Magnetic neural stimulation operates on Faraday’s induction
principle, which states that time-varying magnetic fields can induce electric field distributions inside a conductive medium, in
this case biological tissue. To predict action potential thresholds
in an axon, both the spatial and temporal distributions of the
induced electric field need to be calculated. The spatial distribution of the electric field depends on the coil geometry and
spatial distribution of the conductivities in the medium, particularly at boundaries between anatomical structures, while its
temporal distribution is controlled by the time distribution of
the current waveform in the magnetic coil. It is well accepted
that the charge accumulation at the medium boundaries can significantly alter the distributions of induced electric fields [22],
[23], and some studies have provided analytical solutions for the
induced electric fields, including the effect of the semi-infinite,
tissue–air interface [23], [24]. To predict the site of activation
and the effect of the extracellular field, some studies also included analytical solutions based on a volume conduction analysis [25]–[27]. However, these analytical models were proposed
for oversimplified boundary conditions (i.e., radial symmetry of
the axon or a single axon inside a large homogeneous medium),

which limited the accuracy of the predicted field distribution
inside a realistic heterogeneous tissue environment. In contrast,
we recently demonstrated that the induced electric field inside
a densely packed axon can be 30% lower than the electric field
for a single axon placed inside a homogeneous medium [20].
Therefore, we relied on a computational model instead of analytical solutions to quantify the spatial-temporal distribution of
the induced electric fields in a nerve.
Additionally, we recently demonstrated in vivo magnetic
stimulation of rat sciatic nerve [28]. Inside such multifascicular
sciatic nerves, axons are randomly located creating a random
heterogeneity in the tissue’s electrical properties. To validate
our modeling framework using in vivo experiments, we created
a computational model of sciatic nerve based on a histological
image of the nerve’s cross section. We discretized the simulation
space of the heterogeneous tissue environment using 3-D voxels and computed the electric fields induced inside the voxels
using a multiresolution impedance method. Our multiresolution
field simulation is derived from the impedance method that was
originally used to simulate the absorbed electromagnetic energy inside a conductive tissue caused by low-frequency magnetic fields [29]. The impedance method is a frequency-domain
field solver, which uses the 3-D magnetic field profile generated
by the source (i.e., coil) to compute the induced electric field
distribution inside the 3-D tissue model. We simulated the tissue model at multiple frequencies and used Fourier analysis to
create the temporal distributions of the induced electric fields.
Compared to other algorithms for field calculations (spatial and
temporal) such as the finite element method (FEM) or the finitedifference time-domain method, the impedance method presents
lower complexity for implementation, and it can be used to find
a stable solution for large computational problems. Results from
the field simulation were used to estimate the stimulus current
across axonal membranes. The nonlinear behavior of the active
ion channels were simulated using NEURON 7.3 software [30]
and stimulation thresholds were predicted based on the minimum voltage for the stimulator circuit (pulse discharge-based
stimulator) that can evoke an action potential in the nerve fiber.
III. METHODS
A. Computational Methods: Modeling of Heterogeneous
Sciatic Nerve With Densely Packed Fascicles
Mammalian sciatic nerves are multifascicular structures with
heterogeneous conductivities represented by boundaries between the nerve membrane and surrounding tissue, between
the perineurium and the epineurium, and between the axonal
membranes and the extraaxonal space. To make an accurate
prediction of stimulation thresholds, we employed an anatomically driven computational model that included densely packed
fascicles with statistically distributed axon diameters. As the basis for this computational model, we used the histological image
of the cross section of a rat’s sciatic nerve from a previous study
(see [31, Fig. 3d]). Additionally, we used this study’s statistical
parameterization of the axonal characteristics (distributions of
the axonal diameters, axonal densities, and g-ratios) to populate fascicles with axons. Although we have only utilized the

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

2839

TABLE I
TISSUE PROPERTIES
Tissue Type
Surrounding tissue
Nerve membrane
Epineurium
Perineurium
Intracellular space
Extracellular space
Myelination
Axon membrane
a
b

Fig. 1. Simulation setup. (a) Simulation model for magnetic stimulation consists of the sciatic nerve, the surrounding tissue, and the magnetic coil. The
sciatic nerve is embedded inside tissue, while the magnetic coil is located in
air. (b) Cross-sectional view of the sciatic nerve. (c) Random placement of the
different diameter axons inside a nerve fascicle. (d) Cross-sectional view of
the individual axon’s impedance network including the intracellular and the
extracellular spaces.

histological image found in [31], the fascicular arrangement is
similar to that shown in another study [32]. The resulting computational model preserves the cross-sectional areas and boundary locations of the fascicles within the nerve, as illustrated in
Fig. 1(b).
Similar multiphysics computational modeling frameworks
have been applied to the electrical stimulation of the peripheral nervous system (PNS) [32]–[35]. Notably, FEM-based approaches were used to predict the stimulation selectivity for
cuff electrodes [35] and penetrating microelectrodes [33]. Despite the advances in electrical stimulation modeling of the PNS,
there is a lack of similar work in magnetic stimulation of peripheral nerves. Compared to the previous studies [32]–[35], our
work differed in terms of the underlying application, adopted
algorithms, focus of the study, and excitation mechanisms. Using magnetic coils, we induce the stimulating currents directly
inside the intracellular space of the axon instead of applying an
extracellular potential as with electrical stimulation. Therefore,
this modeling framework quantifies the micrometer resolution
interaction between magnetic fields and groups of axons within
a whole multifascicular nerve.
To incorporate the random distribution of axons inside the fascicles, the axons were randomly positioned and their diameters
from 4 to 16 μm were randomly assigned [see Fig. 1(c)] based
on the fiber distribution data presented in [31]. This achieved
a high packing density of 67% or ∼11 000 axons/mm2 [31],
diameter of the axon
[36]. For this distribution, the g-ratio (= inner
outer diameter of the axon )
ranged from 0.45 to 0.7 [31]. To create the 3-D nerve model,
the cross-sectional model was extruded in the x-direction (along
the nerve). For each axon, the spacing between adjacent nodes
of Ranvier was set at 100 times the outer diameter of the axon,

Conductivity (σ x , σ y , σ z ) S/m

Reference

(0.5, 0.5, 0.5)
(0.02, 0.02, 0.02)
(0.1, 0.1, 0.1)
(0.01, 0.01, 0.01)
(0.91, 0.91, 0.91)
(0.33, 0.33, 0.33)
(2 × 10 −4 , 5 × 10 −9 , 5 × 10 −9 ) a
(2 × 10 −4 , 4 × 10 −6 , 4 × 10 −6 ) b

[39]
[39]
[34]
[34]
[40]
[40]
[41]

High impedance myelination.
Based on the membrane impedance of rat’s myelinated axon [41].

as suggested in previous work [37], [38]. Additionally, to create
a random distribution of nodes of Ranvier, the x position of the
node of Ranvier closest to the origin of the model (i.e., where the
coil is located) was uniformly distributed between ±0.5 times
the distance between nodes for each axon.
The relative positions of the coil, nerve, and surrounding tissue in the simulation were arranged to mimic that of our in vivo
experiments [see Fig. 1(a)]. Thus, the magnetic coils were located in air and placed in close proximity to the nerve and tissue.
The simulation model included an 88-mm-long nerve embedded
in the surface of a uniform tissue [see Fig. 1(a)]. The key focus
of this work was to accurately estimate the effect of anatomical
boundaries inside the heterogeneous nerve. Therefore, the surrounding tissue was represented as a uniform muscle medium
with a conductivity of 0.5 S/m [39].
Table I includes the conductivities of specific media inside
the nerve compiled from previous work [34], [39]–[41]. The
conductivity of the axon membrane was calculated based on
the transmembrane leakage conductance of ∼ 61.4 mS/cm2 at
an operating temperature of 37◦ C [41]. Fig. 1(b) shows a cross
section of the elliptical nerve (typical shape during the in vivo
experiments), with dimensions of 1.66 mm × 0.88 mm. Individual fascicles were populated with myelinated axons of different
diameters as shown in Fig. 1(c). To solve for the field distribution in the presence of different media boundaries, an impedance
network of individual axons was created as shown in Fig. 1(d)
(cross-sectional view).
To reduce the overall volume of the simulated space and the
resulting computation time, we constrained the simulated volume to where the magnetic field strength was negligible at its
boundaries, which we defined as 2% of the peak magnetic field
strength. For a coil positioned at the center of the model and
with an outer diameter around 2 cm (the largest tested here),
the region of simulation was a cube with 7 cm edges. In these
simulations, such tradeoffs were made to ensure that the boundary effects will have a negligible impact on the electric field
distribution. If a nerve were in a more constrained environment
such as a petri dish, this framework could easily be modified to
include those conditions.
To resolve micrometer feature sizes in a 7 × 7 × 7 cm
cube, the simulation will require more than 300 × 1012 voxels, which is computationally intensive. Therefore, we developed a multiresolution impedance method that was applied in

2840

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

TABLE II
MULITRESOLUTION MODEL SIMULATION PARAMETERS
Step
No.
1
2
3
4
5

Model Resolution
(x-, y -, z -)

Model Size
(x-, y -, z -)

Voxels Count
(×10 6 )

(1 mm, 1 mm, 1 mm)
(1 mm, 200 μm, 200 μm)
(1 mm, 40 μm, 40 μm)
(1 mm, 10 μm, 10 μm)
(0.2 mm, 1 μm, 1 μm)

(100, 80, 40)
(98, 50, 50)
(96, 110, 80)
(94, 188, 94)
(460, 92, 92)

0.32
0.245
0.845
1.66
3.89

multiple iterations. Simulation models were created with
fine resolution at the region of high heterogeneity [inside
a fascicle; see Fig. 1(b) and (c)] and with coarse resolution for the more homogeneous regions (outside the nerve)
[20]. To compute the field distribution inside the finer resolution model, the simulation results from the coarse resolution model were applied as the boundary conditions to
the finer resolution models. Successive simulations, with
resolutions 1 mm → 200 μm → 40 μm → 10 μm →
1 μm, were performed to increase resolution from 1 mm to
1 μm (see Table II, Steps 1–5). Table II shows the model resolution and size for each simulation step. For the tissue model with
∼4 × 106 voxels, the simulation took 16 h on a 24-CPU server
(Intel Xeon, 3.3. GHz) to achieve an absolute difference below
0.0001% between two sequential iterations. Therefore, using
this multistep approach, the voxel count of the peak computational model was kept below 5 million without sacrificing the
fine heterogeneous features of the nerve.
To include the effect of active ion channels of the axon and to
estimate the magnetic stimulation thresholds, we used an active
nerve model [21], [22]. As the ion channels open during the stimulus pulse, the effective membrane conductance increases nonlinearly. For the peak membrane conductance of 1200 mS/cm2
[37], the induced stimulus current increases only by 19% compared to the current at its resting conductance of 61.4 mS/cm2 .
Moreover, the peak conductance is achieved ∼100 μs after the
end of the stimulus pulse. Therefore, the effect of nonlinear
membrane conductance on the stimulus current is small and
was dismissed for the computation of the stimulus current.
Rat sciatic nerves primarily consist of myelinated fibers [31],
[36]. Multiple models have been proposed to simulate the behavior of the myelinated axon for electrical neural stimulation
[38], [40], [42]–[44]. Generally, electrical models of a myelinated axon characterize the active nodes of Ranvier with fixed
capacitance and variable conductances that represent voltage
gated ion channels (sodium, potassium, and leakage), and characterize the myelinated internodal regions with passive components (see Fig. 2). Two models commonly used to simulate
mammalian myelinated axons are the double cable model [44]
and the FH model [21]. The more complex double cable model
has been shown to accurately simulate the threshold fluctuations
that occur after spiking [44] and has been used in a multiphysics
model of extraneural electrical stimulation of human femoral
nerve [35]. The relatively simpler FH model has been used in
a multiphysics model of intrafascicular electrical stimulation of
rat sciatic nerves [33] and has been subsequently experimen-

Fig. 2. Circuit model of a myelinated axon including the nodes of Ranvier and
myelination. The active node of Ranvier includes voltage controlled ion gates
and membrane capacitance.

tally validated [32]. In this study, we chose to use the simpler
FH model because 1) we could directly compare our results
of modeling magnetic stimulation of the rat sciatic nerve to
the previous modeling study of electrical stimulation of rat sciatic nerve, including the use of similar conductance parameters
[33]; 2) we are principally interested in characterizing initiation
of an active response, which occurs at similar stimulus levels
for both the FH and the double cable models; and 3) the more
accurate characterization of the post-spike threshold fluctuations afforded by the cable model was of little value as the time
course of these fluctuations (<100 ms) is orders of magnitude
lower than our experimental interpulse period (>10 s). Nevertheless, our modeling framework can readily be modified to use
a double-cable model to support future studies. The mathematical representations of the ion channels are adopted from the
FH’s original work [21] and the model parameters of the FH
node (see Table V in Appendix B) are based on rat sciatic nerve
experiments [41]. We modeled active membrane ion channels
in the rat myelinated fiber using NEURON 7.3 software [30].
B. Experimental Methods
All procedures described here were approved by the University of Utah Institutional Animal Care and Use Committee.
Sciatic nerves were prepared via surgical exposure from adult
male Sprague-Dawley rats (n = 4). Anesthesia was induced and
maintained with Isofluorane gas (1–5%). Depth of anesthesia
and animal condition were evaluated via continuous monitoring
of heart rate, blood oxygen saturation, respiration, and rectal
temperature. A 5-cm section of the sciatic nerve was exposed
between the hip and knee. Surgical procedures for exposing the
nerve were similar to those previously described [45].
Stimulation was provided via a custom capacitive discharge
system [see Fig. 3(a)] similar to previous designs [46] with
a total capacitance of 6.85 mF. Four air-core solenoid shaped
magnetic coils with different geometrical and electrical parameters were built and used in sequence during all experiments.
Table III includes the mechanical and electrical properties of
these magnetic coils. As the key focus of this work is the creation and validation of the modeling toolset, the effectiveness
of individual coils for threshold reduction was kept outside the
scope of this work. The stimulating coils, which were insulated

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

2841

determined via whole nerve electrical excitation using bipolar
hook electrodes. Recruitment curves were generated by linearly
interpolating between adjacent points on EMG amplitude versus stimulus intensity plots. Stimulus threshold of a muscle was
defined as the stimulus intensity at which 20% of the maximal
EMG response was observed for that muscle in that experiment
for either magnetic or electrical stimulation (maximum EMG
value is expected when 100% of the motor fibers were excited).
IV. RESULTS
Fig. 3. Experimental setup. (a) Basic schematic of the pulse discharge circuit
that includes a dc voltage source, charging capacitor C , and a magnetic coil.
(b) Exposed sciatic nerve of the rat and the position of the magnetic coil with
respect to the nerve.

TABLE III
COIL GEOMETRICAL PARAMETERS OF FOUR COILS USED IN SIMULATIONS AND
In Vivo EXPERIMENTS
Coil a

O.D
(mm)

I.D.
(mm)

H
(mm)

Nt
turns

Na
layers

Lex p
(μ H)

Rex p
(mΩ)

C1
C2
C3
C4

16.4
16.0
11.7
11.8

8.00
3.00
7.00
2.24

13.3
10.7
27.4
16.8

9
8
23
13

3
5
2
4

4.28
5.34
5.27
4.38

17.3
28.0
39.0
26.0

a
O.D. = outer diameter, I.D. = inner diameter, and H = height of the coil.
Measured L e x p = inductance and R e x p = resistance of the coil. Wire Type:
single strand magnetic wire, C1:AWG 17; C2, C3, C4: AWG 18.

from tissue by a ∼5 cm × ∼5 cm square of 13-μm-thick insulating polyimide film, were positioned in place directly above
the nerve approximately halfway between the hip and knee with
a stereotactic 3-dimensional positioning system. The insulation
integrity of the film was verified before and after each experiment. During experiments, the magnetic coil was positioned to
within 0.5 mm of the optimal placement (location of minimum
stimulation threshold) by testing the coil at five positions, each
1 mm apart, perpendicular to the long axis of the nerve. Generally, this position was where the nerve ran parallel to solenoid
turns between the inner and outer diameters [see Fig. 3(b)]. Stimulation trials were performed with capacitor voltages between
60 and 160 V in 20-V increments.
Electromyography (EMG) data were recorded differentially
from the major extensor and flexor muscles of the ankle: Lateral gastrocnemius, medial gastrocnemius, tibialis anterior, and
soleus as natural indicators of neural activity. Fine wire EMG
electrodes were made as described in prior work [47] and inserted as pairs into each muscle. EMG recordings were bandpass
filtered between 10 Hz and 1 kHz with a differential ac amplifier
(Model 1700, A-M Systems, Sequim, WA) with a gain of 100.
Amplifier ground was provided via either a Ag/AgCl 15 AWG
wire or a deinsulated 18 AWG needle inserted under the skin
near the hip. Data were recorded using a Cerebus data acquisition system (Blackrock Microsystems, Salt Lake City, UT) at
a sampling rate of 30 kHz per channel. EMG amplitude for a
trial was defined as the peak minus trough value in a window
from 2 to 16 ms poststimulus. Maximal muscle activation was

Using this multiresolution hybrid model, we performed field
and neuronal simulations for all four magnetic coils described in
Table III. However, for purposes of brevity, in the first five subsections only the details of the simulation with coil C1 are shown
as a typical example of the collective results. In the first three
subsections, the effects of fascicle distribution, axon diameter,
and axon heterogeneity on the induced fields and transmembrane
current density (Jm ) at the nodes of Ranvier are investigated using the multiresolution impedance method model. In the fourth
subsection, the effect of transmembrane capacitance on the temporal distribution of Jm at the nodes of Ranvier is presented. In
the fifth subsection, the resulting spatial and temporal values of
Jm at the nodes of Ranvier are applied to a NEURON model to
investigate neuronal activation. In the last subsection, the stimulus thresholds produced by the modeling framework for all four
magnetic coils are compared to those arising from experiments
conducted in sciatic nerve of four rats.
A. Effect of Fascicle Distribution
To quantify the effect of fascicle boundaries in the heterogeneous model, the multiresolution impedance method was applied to a modeled rat sciatic nerve as described in Section III-A
and the 3-D distribution of the 3-D induced electric field at the
whole nerve level (see Table II, step 4) was studied. As the input
to the frequency domain impedance method model, we used
the magnetic field arising from exciting the coil with a 600-A
magnitude, 2-kHz sine wave. For reference, the cross-sectional
view of induced electric field along the nerve (Ex ) for the heterogeneous model and the fascicle boundaries are shown in
Fig. 4(a). To illustrate that the electric fields are affected by tissue boundaries having low conductivity (e.g., nerve membrane
and perineurium), the difference between Ex for the heterogeneous and homogeneous models is plotted in Fig. 4(b) and for
Ey in Fig. 4(c). These results demonstrate that the induced eddy
currents in the y- and z-directions are redirected towards the
x-direction at the medium boundaries, causing a change in the
induced electric field along the nerve. Clearly, the induced electric field in the heterogeneous model is substantively different
compared to the homogeneous model.
Between experiments, there may be variations in the preparation outside of our control such as fascicular arrangement
and perineurium thickness. According to previous work [48],
such variation can significantly alter stimulation thresholds of
electric stimulation. However, magnetic stimulation does not
require a direct conductive path between the magnetic coil and
region of stimulation, making the induced electric field less

2842

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

Fig. 4. Effect of fascicle distribution and heterogeneity on the induced electric fields. (a) x-directed electric field Ex distribution. Difference between
(b) the x-directed electric field Ex and (c) the y-directed electric field Ey for
the heterogeneous and homogeneous tissue models. (Difference defined as heterogeneous model minus homogeneous model.) Due to the low conductivity of
the nerve membrane and perineurium, the induced current in y- and z-direction
is redirected toward the x-direction resulting in the difference between the heterogeneous and homogeneous tissue model results. All fields are in V/m. Y-axis
and Z-axis are the voxel count in y- and z-direction, respectively (resolution
10 μm).

susceptible to fascicular organization inside the nerve and perinurium properties. To investigate the effect of fascicular organization on magnetic stimulation thresholds, the x-axis directed electric field (Ex ) of the initial organization [Model-1,
Fig. 1(b)] was compared to Ex for both a rotated version of the
initial model (Model-2) and a translated version of the initial
model (Model-3). For both the organizations, the difference in
Ex between Model-1 and Model-2, and Model-1 and Model-3
were 10% or less, as shown in Fig. 5(a) and (b), respectively.
This indicates that for centimeter-sized magnetic coils, the fascicular arrangement has little impact on the induced electric
field distribution inside the nerve. A similar sensitivity analysis was performed to quantify the effect of perineurium thickness on electric field variation. The perineurium thickness was
varied to 2%, 6%, and 12% of the effective fascicle diameter
√
D (D = 2 ∗ F a s c i cπl e A r e a ). It was found that the peak electric
field variation for both conditions (2% and 12% perineurium
thickness) from its nominal value (6% perineurium thickness,
Model-1) is less than 5%. This analysis of fascicular variation

Fig. 5. Effect of fascicle distribution inside the nerve. (a) Difference between the x-directed electric field Ex in Model-1 and Model-2 configurations.
(b) Difference between the x-directed electric field Ex in Model-1 and Model-3
configurations. Fascicle boundaries are highlighted. All fields are in V/m. Yaxis and Z-axis are the voxel count in y- and z-direction, respectively (resolution
10 μm).

suggests that variability in peak electric field distributions is not
strongly influenced by fascicular organization and perineurium
thickness.
Equally well, the results of this model are dependent upon the
tissue conductivities used. In particular, the conductivity values of the perineurium and epineurium we used were gathered
from prior work [34] (see Table I) that created a computational
model of a mammalian sciatic nerve. There were some differences in the conductivity values used from [49] (Perineurium =
0.002 S/m, epineurium = 0.083 S/m). Thus, we analyzed the
effect of these differences on the induced electric field distribution. The results showed that even if perineurium conductivity
was changed by a factor of 5 (0.01–0.002 S/m), the peak induced
electric field magnitude did not change by more than 10% of
the maximum magnitude of model 1. This limited dependency
of the induced field on the fascicle distribution, and perinurium
conductivity, and perienurium thickness is a key benefit of magnetic neural stimulation. This occurs because biological tissues
are highly permeable to magnetic fields.
B. Electric Field Distribution Inside a Myelinated Axon
To study the interaction between the different sized myelinated axons inside a densely populated fascicle, a 92 mm ×
92 μm × 92 μm subsection of the fascicle was taken as a simulation model. The micrometer-resolution model [see Fig. 1(c)] was
extracted from the highlighted fascicle shown in Fig. 1(b), which

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

2843

Fig. 7. Simulated peak transmembrane current density Jm as function
of axon inner radius. The simulated data can be fitted with curve Jm =
0.03 ∗ radius1 . 8 6 . The analytical solution: Jm = 0.0255 ∗ radius2 (see
Appendix A).

location of − ∂∂Exx |peak , which supports the performance of the
proposed computational model.
C. Effect of Axon Diameter on Induced Current Density

Fig. 6. (a) Transmembrane current density Jm at the nodes of Ranvier along
the selected axon. (b) Spatial derivative of the induced electric fields (intracellular and extracellular) along the axon (x-direction). The induced electric field
is maximum at the position x = 0. From simulations, Jm ∝ − ∂∂Exx .

is located 0.3 mm (in the z-direction) from the tissue-air interface. Fig. 1(c) shows a cross section (YZ plane) of the model with
a resolution of 0.2 mm, 1 μm, and 1μm in x-, y-, and z-directions,
respectively (see Table II, step 5). Using the impedance method,
the induced electric fields and the induced currents were computed in different regions (intracellular, extracellular, and axon
membrane). The induced transmembrane current im (intracellular to extracellular) for each axon was calculated at each segment
location along the nerve (x-direction). The transmembrane current density Jm for each axon was calculated based on the axon
radius and nodal length (δ) of 1 μm (Jm = im /2πaδ). Fig. 6(a)
shows the distribution of the transmembrane current density
Jm along the selected axon [see Fig. 1(c)] of 16 μm diameter. As expected, the membrane current (and Jm ) passes only
through the nodes of Ranvier which are separated by 1.6 mm.
The peak intracellular induced electric field value of 17.2 V/m
was achieved at the midpoint of the axon. In previous works, it
was shown that stimulation starts at the position where − ∂∂Exx is
a maximum [22], [25]. Fig. 6(b) shows the spatial derivative of
the induced electric field (intracellular and extracellular) along
the axon (x-direction). Comparing Fig. 6(a) and (b) indicates
that the peak positive Jm (stimulation site) is achieved at the

To study the recruitment order of axons inside the nerve, the
peak membrane current density was computed for all axons. Induced transmembrane current density Jm varies exponentially
with the axon radius, as shown in Fig. 7. The solution indicates
that larger axons experience higher induced current densities,
and as such are excited first. Field simulations were performed
for three different templates of randomly distributed axons to
study the effect of axon positions and their proximity on the
current density. For all the simulations, the simulated Jm was
well fit with the polynomial relationship Jm (mA/cm2 ) = Kan ,
where K = 0.03 ± 0.0012, n = 1.86 ± 0.0268, and a is the
radius of the axon in μm. We also derived an analytical solution for the transmembrane current density ((8) presented in
Appendix A). From this equation, the maximum current density Jm −max (mA/cm2 ) = 0.015 ∗ | ∂∂Exx |max ∗ a2 , where ∂∂Exx is
in mV/mm2 and a is axos radius in μm. For coil C1, ∂∂Exx =
1.7 mV/mm2 , which indicates K = 0.0255 and n = 2 using the
analytical solution. The analytical and simulated values of the
parameters (K, n) are in good agreement and indicate that the
present simulations are capable of predicting the behavior of axons with different radii in the presence of magnetic fields. There
is a small difference between the simulated and analytical values of induced Jm (see Fig. 7), which is due to the non-constant
value of the g-ratio ranging from 0.45 to 0.7, compared to the
value 0.6 used in the analytical solution.
D. Effect of Membrane Capacitance
Magnetic stimulation uses pulsed current in the magnetic
coil to induce transmembrane current across the axon membrane. For the charging capacitance of 6.85 mF, an overdamped
pulse current was delivered by the magnetic stimulator to the
coil C1 by discharging the capacitor from a voltage of 120 V.
To study the contribution of individual frequency components
of the current pulse, a Fourier transform was taken and is shown
in Fig. 8(a). To study the impact of membrane capacitance
on the temporal distribution of the induced electric fields (or

2844

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

Fig. 9. Stimulation thresholds for myelinated axons as a function of axon
radius. The axon model was created based on the FH model for rat sciatic nerve
[21], [41]. The threshold shows a linear relation (fitted curve: 0.249*radius +
0.637 mA/cm2 ).

Fig. 8. (a) Real and imaginary frequency components of the current pulse. Current pulse in the simulated magnetic coil (L = 4.32 μH, R = 45 mΩ, V c a p a c ito r
= 120 V. (b) Normalized temporal distribution of the induced electric fields
with and without including the effect of membrane capacitance. Comparison
between the capacitive (=2πf r 0 , f = frequency, r = 23) and resistive (=
conductivity σ) components of the transmembrane impedance showed that the
capacitive component reaches 10% of the resistive component for a frequency
as small as 500 Hz.

distribution of the myelination current has a negligible effect on
the stimulus current and only the effect of the axon membrane
was considered in this simulation. To achieve the empirical formulation of Jm versus frequency, transmembrane currents were
simulated for multiple frequencies ({0.5, 2, 4, 6, 8, 10, 20, 40}
kHz) for the real and imaginary components of the current pulse.
To recreate the temporal distribution of induced current densities, the contributions from each frequency component were
included in the inverse Fourier transform. The normalized (to
peak value) induced current densities, with and without the effect of membrane capacitance are shown in Fig. 8(b). Compared
to the traditional models of the temporal distribution of induced
current densities [5]–[7], [37], our simulations demonstrate that
membrane capacitance increases the PW of the stimulus current
and cannot be ignored for the correct estimation of the temporal
distribution of the induced current density.
E. Effect of Axon Radius on Stimulation Threshold

membrane current densities), the membrane’s capacitive and
resistive components need to be compared. In this simulation,
the nodes of Ranvier were modeled as parallel membrane resistances and capacitances. Based on the nerve model of rat
sciatic nerve at 37◦ C [41], the leakage transconductance gL of
43 nS (GL = 61.4 mS/cm2 ) and membrane capacitance cm of
1.4 pF (Cm = 2 μF/cm2 [37], node area = 70 μm2 ) were used
to calculate the resistivity and dielectric constant of the axon
membrane. This results in a time constant of 32.5 μs (3-db frequency of 4.8 kHz). The capacitive component (2πf r 0 , r
= 23) reaches 10% of the resistive component (conductivity
σ = 4 × 10−6 S/m) for a frequency as small as 500 Hz, and
therefore, the effect of the capacitance needs to be included for
frequencies above this. For other tissue media (fascicle membrane, intracellular and extracellular space) inside the nerve, the
resistive components are significantly larger than the capacitive
components for all the frequency components of the pulse. Due
to its high resistivity and low capacitivity, the myelination layer
has a comparable time constant as the axon membrane but with
high impedance at all frequencies. Consequently, the induced
stimulus current primarily exists through the node of Ranvier
and the current density across the myelination is four to five
orders of magnitude smaller than the transmembrane current
density [as seen in Fig. 6(a)]. Therefore, the spatial-temporal

For a fixed length nerve, the number of nodes of
Ranvier depends on the axon diameter (Node count =
Length of nerve ( = L n e r v e )
). To estimate the stimulation threshold
Internodal distance
as a function of axon radius (or diameter), neuron simulations
were performed for the magnetic coils’ field distributions (spatial and temporal), and stimulation thresholds were estimated
for axon radius varying from 1 to 5 μm (outer diameter 4–
16 μm). Fig. 9 shows the stimulation threshold Jm versus the
axon radius for coil C1’s field distribution. Compared to electric
stimulation in which the stimulating electrodes excite only one
or two nodes of Ranvier, a cm-sized magnetic coil induces transmembrane current at multiple nodes [see Fig. 6(b)]. As the node
count decreases with axon diameter, the field distribution around
the smaller axon spreads to higher numbers of nodes. This reduces stimulation threshold current densities Jm (threshold) for the
smaller axons. From the NEURON based simulations for different radii axons, the stimulation threshold Jm (threshold) is linearly
proportional to the axon radius (Jm (threshold) = 0.249*radius +
0.637 mA/cm2 ; see Fig. 9). Using the analysis presented in
Figs. 7 and 9, the recruitment order of the different radius axons
is deduced. Under the same electric field distributions (or same
operating voltage), the induced current density Jm ∝ a2 and
Jm (threshold) ∝ a. Therefore, Ex(threshold) (or Vstimulation ) ∝ 1/a.
This analysis shows that the larger radius axons tend to become

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

TABLE IV
STIMULATION THRESHOLD

2845

TABLE V
FH MODEL PARAMETERS

Coil
No.

Animal
1 (V)

Animal
2 (V)

Animal
3 (V)

Animal
4 (V)

Heterogen.
model (V)

Homogen.
model (V)

C1
C2
C3
C4

116
114
169
138

79
81
142
114

105
118
185
145

108
106
158
141

122
121
206
158

166
143
253
176

excited for lower stimulation voltages applied to the magnetic
stimulator. To validate the NEURON based simulation, the dynamics of the generated action potentials were recorded and
compared with the known neuronal behavior. For example, the
action potential starts at the location of peak depolarization and
propagates in both axonal directions. Moreover, the propagation velocity of the action potential increases with the increase
in axon radius as expected from previous work [50].

Temp:
Erest
[Na] i
[K] i
GL
P̄ Na
Q10 :

αm
βm
αh
βh
αn
βn
D axon
δ node

37 ◦ C
−78 mV
8.71 mM
155 mM
61.4 mS/cm2
7.32 × 10 −3 cm/sec
τ m = 2.2

VL
[Na] o
[K] o
Cm
P̄ K
τ h = 2.9

−78 mV
154 mM
5.9 mM
2 μF/cm2
0.288 × 10 −3 cm/s
τ n = 3.0

A
(m·s−1 )

B
(mV)

C
(mV)

0.49
1.04
0.09
3.7
0.02
0.05
4–16 μm
1 μm

25.41
21.0
−27.74
56
35
10
d node-node
L nerve

6.06
9.41
9.06
12.5
10
10
100*D out-axon
88 mm

F. Experimental Validation of the Modeling Framework
To validate our simulations we used experimental data to
compare the model’s ability to predict stimulation thresholds.
We performed experiments in four rat sciatic nerves as discussed
in Section III-B. Four magnetic coils were used in each experiment and measured stimulation thresholds were compared with
the predicted values. Simulations were performed based on the
proposed heterogeneous model and a traditional homogeneous
model. The heterogeneous model included the effects of fascicle and axon heterogeneity, axon proximity, and membrane
capacitance. In our simulations, we found that the effect of fascicle distribution and perineurium thickness was small (less than
10%) on the induced electric field. Therefore, the fascicular geometries in the model were not adjusted post hoc to match the
geometries of an experiment. Nevertheless, we experimentally
tested the coil at multiple positions perpendicular to the long
axis of the nerve to reduce the variability in response due to the
relative position of the coil to the unknown positions of fascicles within the nerve. The homogeneous model was based on
previous studies [22], [37], which considered an axon inside an
infinite homogeneous medium without including the membrane
capacitance and the axons’ interactions with other axons. For
all coils used, the stimulation thresholds were computed based
on the minimum charging voltage of the capacitor required
for excitation of 20% of the motor fibers (∼6% of total fiber
count [51], diameter 13–16 μm). Table IV and Fig. 10(a) provide the stimulation thresholds for the four experiments and the
simulations.
The variation in experimental data can be attributed to minor
surgical differences and animal size and weight. If the nerve
slightly curved in an experiment, stimulations thresholds were
reduced [16], [52], [53], which may also contribute to differences in the threshold values between experimental and predicted data. Despite this difference, the heterogeneous model’s
predictions were closer to the experimental values than those of
the homogeneous model [see Fig. 10(a)].

Fig. 10. Comparison between the (a) absolute and (b) normalized stimulation
threshold for the in vivo experiment and the proposed heterogeneous and homogeneous models. The experiments were performed for four magnetic coils
in four separate animals and normalization is done for the baseline coil C1.

In seeking to optimize size and stimulation parameters of
magnetic coils, it is important to know each coil’s performance
relative to one another. Therefore, we chose coil C1 as a baseline coil and normalized the stimulation thresholds of the other
investigated magnetic coils (C2, C3, and C4). Using such normalization, the effects of nonideal scenarios (i.e., nerve curvature, surrounding tissue of the nerve) can be mitigated without
increasing the complexity of the simulation. Moreover, with the
knowledge of C1’s stimulation threshold during one experiment,
the thresholds of the other magnetic coils can be predicted. The
normalized thresholds for coil C2, C3, and C4 with respect to
baseline coil C1 are shown in Fig. 10(b). Fig. 10(b) also shows

2846

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

that the heterogeneous model accurately predicts threshold voltages of our in vivo experiments. We also considered other coils
(C2, C3, and C4) as the reference coil and normalized the stimulation thresholds of the coils with respect to the threshold of
each reference coil. For all these cases, the heterogeneous model
based threshold prediction was a better indicator of the experimental thresholds. Moreover, predicted simulated thresholds
were within the 95% confidence interval of in vivo experimental
thresholds for all the investigated magnetic coils during four
separate experiments.
The design of the magnetic coil is a multivariable optimization problem that includes coil shape, total coil volume, wire
type, and capacitance of the charging capacitor. Each of these
parameters can significantly alter the spatial and temporal distribution of an induced electric field. Using this comprehensive model, there is a strong correlation between the predicted
threshold values and those observed in in vivo experiments.
Compared to previous models, the current study included the
effect of tissue heterogeneity, recruitment order of different diameter axons, and the effect of membrane capacitance on stimulation thresholds. We used this framework as a predictor of coil
performance before using various coils during in vivo experiments. In the future, we intend to develop an optimization algorithm to function in conjunction with this framework to develop
smaller, more energy efficient coils compared to those used in
this study.
V. CONCLUSION
In this study, a computational framework for the prediction of the threshold level for magnetic stimulation of peripheral nerve tissue is presented. To make these predictions, a
micrometer-resolution heterogeneous model of rat sciatic nerve
was simulated using a multiresolution impedance method to
quantify the magnetically induced electric fields. The proposed
model includes the effect of fascicle distribution, axon distribution including the spacing between adjacent axons, and axon
membrane resistance and capacitance in the estimation of the
spatial-temporal distribution of the induced fields. Using this
model, the transmembrane current density was computed as
a function of axon diameter and compared with an analytical solution. To estimate the magnetic stimulation thresholds
for the myelinated axon, an FH mechanism was used at the
axon’s nodes of Ranvier, and the behavior of the ion channels
were simulated in NEURON software. Using the impedance
method for the field simulation and NEURON for the active
ion channel mechanisms, stimulation thresholds were predicted
for four magnetic coils and compared with traditional homogeneous nerve models. Using in vivo magnetic stimulation in
four separate rat sciatic nerve experiments, it was shown that
in vivo measurements of magnetic stimulation thresholds can
be accurately predicted using the proposed heterogeneous modeling within a 95% confidence interval (trials count = 4). The
presented simulation toolset describes a multiscale model for
magnetic stimulation and therefore, is capable of studying the
interaction of individual neurons/axons or neuronal networks
with the incident magnetic field. This modeling toolset can be

Fig. 11. Drawing of the myelinated axon (inner radius a) with transmembrane
current density Jm . ri is the intracellular resistance between the adjacent nodes
of Ranvier.

effectively utilized in clinical settings (i.e., transcranial magnetic stimulation, spinal cord or peripheral nerve stimulation)
to generate specific neuronal response (e.g., stimulation selectivity) in the tissue depending on the coil’s shape, orientation,
and position.
APPENDIX A
MEMBRANE CURRENT DENSITY VERSUS AXON RADIUS
In this section, the relationship between the spatially distributed induced transmembrance current density and axon radius is derived. Fig. 11 shows a drawing of a section of a
myelinated axon containing one node of Ranvier surrounded
by myelinated internodal regions. The transmembrane current
(im ) is calculated from the intracellular currents I1 and I2 by
Kirchhoff’s Current Law and each intracellular current is calculated from its induced electric field distribution, (EK ) by Ohm’s
Law (1) and (2). Due to the high resistivity of the myelination
compared to the node of Ranvier, the induced intracellular current IK primarily passes through the node of Ranvier causing
IK to stay constant between each node. Therefore, for constant
conductivity σaxon inside the axon, EK stays constant between
consecutive nodes (IK = σaxon EK ∗ πa2 ):
im = I1 − I2
IK =

ΔV
=
ri

 XK + 1
XK

(1)
Edx

ri

=

EK Δx
ri

(2)

where ri is the intracellular resistance between the adjacent
nodes of Ranvier and can be represented as a function of the
intracellular resistivity Ri , the internodal distance Δx, and the
axon inner radius a (3).
ri =

Ri (Δx)
πa2

(3)

where inter-nodal distance Δx = 100Dout = 200
0.6 a ∼ 333a
Din
for D o u t = 0.6. Din and Dout are the inner diameter and outer
diameter of the myelinated axon, respectively.
Using (1)–(3), the induced transmembrane current im , in response to the applied time varying magnetic fields, is shown
as
im =
=

Δx
(E1 − E2 )
ri
πa2
πa2
(E1 − E2 ) =
ΔE1−2
Ri
Ri

(4)

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

where ΔE1−2 is the induced electric field difference between
consecutive nodes 1 and 2.
Multiplying Δx in the numerator and denominator of the (4)
and replacing Δx in the numerator by 333a, transmembrane
current im and current density Jm for a general node of Ranvier
can be written as
im =

333πa3 ΔE
Ri Δx

Jm =

333 a2
im
=−
2πaδ
2δ Ri

(5)


ΔE
Δx


(A/m2 )

(6)

where δ is the length of node of Ranvier. All parameters are in
SI units.
2
(as used by NEURON) and
To achieve Jm in units of

 ΔmA/cm
E
expressing the values for Δ x in mV/mm2 and axon radius a
in μm (typically used for magnetic stimulation [9], [11], [26]),
the following conversion factors were applied (1 A/m2 = 0.1
mA/cm2 , 1 V/m2 = 0.001 mV/mm2 , 1 m = 106 μm). Therefore


333 × 10−10 a2 ΔE
im
Jm =
=−
(mA/cm2 ).(7)
2πaδ
2δ
Ri Δx
For δ = 1 × 10−6 m, Ri = 1.1 Ω · m, transmembrane current
density Jm at the node of Ranvier is calculated as


ΔE
(8)
Jm = −0.015
a2 (mA/cm2 )
Δx


where ΔΔEx is the spatial derivative of intracellular electric
field in the long axis of the axon (x-direction in the model). The
spatial derivative of induced electric fields is in mV/mm2 and a
is the axon radius in μm.
APPENDIX B
FH MODEL
An FH model was first proposed to model the membrane’s ion
channel activity in myelinated axons [21]. Compared to the traditional Hodgkin–Huxley model, the myelinated axon has lower
contributions from the potassium channels [54]. The FH model
based node of Ranvier includes one sodium channel, potassium
channel, leakage channel, and the membrane capacitance [41].
Equation (9) includes the transmembrane current density contributed by sodium (JNa ), potassium (JK ), leakage (JL ), and
stimulation (Jm ) currents
Jm embrane = JNa + JK + JL + Cm dV /dt + Jm

(9)

Individual currents were calculated based on the sodium and
potassium concentrations in the intracellular ([Na]i or [K]i ) and
extracellular ([Na]o or [K]o ) spaces [21]. Table V includes the
parameter values used for the rat FH model.
REFERENCES
[1] M. Kobayashi and A. Pascual-Leone, “Transcranial magnetic stimulation
in neurology,” Lancet Neurol., vol. 2, no. 3, pp. 145–156, 2003.
[2] P. Rossini and S. Rossi, “Transcranial magnetic stimulation: Diagnostic,
therapeutic, and research potential,” Neurology, vol. 7, no. 68, pp. 484–
488, Feb. 2007.

2847

[3] J. Reilly, “Peripheral nerve stimulation by induced electric currents: Exposure to time-varying magnetic fields,” Med. Biol. Eng. Comput., vol. 2,
no. 27, pp. 101–110, Mar. 1989.
[4] R. J. Ilmoniemi et al., “Neuronal responses to magnetic stimulation
reveal cortical reactivity and connectivity,” NeuroReport, vol. 2, no. 171,
pp. 302–315, Jun. 1997.
[5] K.-H. Hsu et al., “Analysis of efficiency of magnetic stimulation,” IEEE
Trans. Biomed. Eng., vol. 50, no. 11, pp. 1276–1285, Nov. 2003.
[6] E. Basham et al., “Circuit and coil design for in-vitro magnetic neural
stimulation systems,” IEEE Trans. Biomed. Circuits Syst., vol. 3, no. 5,
pp. 321–331, Oct. 2009.
[7] M. Yamaguchi et al., “Electromagnetic mechanism of magnetic nerve
stimulation,” J. Appl. Phys., vol. 66, no. 3, pp. 1459–1465, 1989.
[8] T. Pashut et al., “Mechanisms of magnetic stimulation of central nervous
system neurons,” PLoS Comput. Biol., vol. 3, no. 7, p. e1002022, Mar.
2011.
[9] S. Nagarajan et al., “Effects of induced electric fields on finite neuronal structures: A simulation study,” IEEE Trans. Biomed. Eng., vol. 40,
no. 11, pp. 1175–1188, Nov. 1993.
[10] E. Lontis et al., “In vitro magnetic stimulation of pig phrenic nerve
with transverse and longitudinal induced electric fields: Analysis of the
stimulation site,” IEEE Trans. Biomed. Eng., vol. 56, no. 2, pp. 500–512,
Feb. 2009.
[11] S. Nagarajan et al., “Mapping location of excitation during magnetic
stimulation: Effects of coil position,” Ann. Biomed. Eng., vol. 1, no. 25,
pp. 112–125, Feb. 1997.
[12] H.-J. Park et al., “Activation of the central nervous system induced
by micro-magnetic stimulation,” Nature Commun., vol. 4, p. 2463,
Feb. 2013.
[13] G. Bonmassar et al., “Microscopic magnetic stimulation of neural tissue,”
Nature Commun., vol. 3, p. 921, Jun. 2012.
[14] T. Pashut et al., “Patch-clamp recordings of rat neurons from acute brain
slices of the somatosensory cortex during magnetic stimulation,” Frontiers
Cellular Neurosci., vol. 8, p. 145, Jun. 2014.
[15] E. Corthout et al., “Transcranial magnetic stimulation: Which part of
the current waveform causes the stimulation?” Exp. Brain Res., vol. 1,
no. 128–132, Nov. 2001.
[16] P. Maccabee et al., “Magnetic coil stimulation of straight and bent amphibian and mammalian peripheral nerve in vitro: Locus of excitation,” J.
Physiol., vol. 460, no. 2, pp. 201–219, 1993.
[17] H. Tischler et al., “Mini-coil for magnetic stimulation in the behaving primate,” J. Neurosci. Methods, vol. 2, no. 194, pp. 242–251,
Jan. 2011.
[18] T. Wagner et al., “Three-dimensional head model simulation of transcranial magnetic stimulation,” IEEE Trans. Biomed. Eng., vol. 51, no. 9,
pp. 1586–1598, Sep. 2004.
[19] V. T. Z. Krasteva et al., “Peripheral nerve magnetic stimulation:
Influence of tissue non-homogeneity,” BioMed. Eng. Online, vol. 2,
Dec. 2003.
[20] A. K. RamRakhyani et al., “A μm-resolution heterogeneous tissue
model for the magnetic stimulation of multifascicular sciatic nerve,”
in Proc. 36th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., Aug. 2014,
pp. 5679–5682.
[21] B. Frankenhaeuser and A. F. Huxley, “The action potential in the
myelinated nerve fibre of xenopus laevis as computed on the basis
of voltage clamp data,” J. Physiol., vol. 2, no. 171, pp. 302–315,
Jun. 1964.
[22] B. J. Roth and P. Basser, “A model of the stimulation of a nerve fiber
by electromagnetic induction,” IEEE Trans. Biomed. Eng., vol. 37, no. 6,
pp. 588–597, Jun. 1990.
[23] D. Durand et al., “Effect of surface boundary on neuronal magnetic
stimulation,” IEEE Trans. Biomed. Eng., vol. 39, no. 1, pp. 58–64, Jan.
1992.
[24] K. Esselle and M. Stuchly, “Neural stimulation with magnetic fields:
analysis of induced electric fields,” IEEE Trans. Biomed. Eng., vol. 39,
no. 7, pp. 693–700, Jul. 1992.
[25] J. Ruohonen et al., “A volume-conduction analysis of magnetic stimulation of peripheral nerves,” IEEE Trans. Biomed. Eng., vol. 43, no. 7,
pp. 669–678, Jul. 1996.
[26] S. Nagarajan and D. Durand, “A generalized cable equation for magnetic stimulation of axons,” IEEE Trans. Biomed. Eng., vol. 43, no. 3,
pp. 304–312, Mar. 1996.
[27] Nagarajan and D. Durand, “Analysis of magnetic stimulation of a concentric axon in a nerve bundle,” IEEE Trans. Biomed. Eng., vol. 42, no. 9,
pp. 926–933, Sep. 1995.

2848

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 12, DECEMBER 2015

[28] Z. B. Kagan et al., “Magnetic stimulation of mammalian peripheral
nerves in vivo: An alternative to functional electrical stimulation,” in
Proc. 36th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., Aug. 2014,
pp. 2573–2576.
[29] N. Orcutt and O. P. Gandhi, “A 3-d impedance method to calculate
power deposition in biological bodies subjected to time varying magnetic fields,” IEEE Trans. Biomed. Eng., vol. 35, no. 8, pp. 577–583,
Aug. 1988.
[30] N. Carnevale and M. Hines, The NEURON Book. Cambridge, U.K.: Cambridge Univ. Press, 2006.
[31] M. Christensen and P. Tresco, “Differences exist in the left and right sciatic
nerves of nave rats and cats,” Anatomical Rec. (2015, Apr.). [Online].
Available: http://dx.doi.org/10.1002/ar.23161
[32] S. Raspopovic et al., “Experimental validation of a hybrid computational
model for selective stimulation using transverse intrafascicular multichannel electrodes,” IEEE Trans. Neural Syst. Rehabil. Eng., vol. 20, no. 3,
pp. 395–404, May 2012.
[33] S. Raspopovic et al., “A computational model for the stimulation of rat
sciatic nerve using a transverse intrafascicular multichannel electrode,”
IEEE Trans. Neural Syst. Rehabil. Eng., vol. 19, no. 4, pp. 333–344, Aug.
2011.
[34] C. R. Butson et al., “Selective neural activation in a histologically
derived model of peripheral nerve,” J. Neural Eng., vol. 8, no. 3,
p. 036009, 2011.
[35] M. A. Schiefer et al., “A model of selective activation of the femoral nerve
with a flat interface nerve electrode for a lower extremity neuroprosthesis,”
IEEE Trans. Neural Syst. Rehabil. Eng., vol. 16, no. 2, pp. 195–204, Apr.
2008.
[36] P. Y. C. N. Mazzer et al., “Morphologic and morphometric evaluation of
experimental acute crush injuries of the sciatic nerve of rats,” J. Neuroscience Methods, vol. 173, no. 2, pp. 249–258, 2008.
[37] P. Basser and B. Roth, “Stimulation of a myelinated nerve axon by electromagnetic induction,” Med. Biol. Eng. Comput., vol. 3, no. 29, pp. 261–268,
May 1991.
[38] J. P. Reilly and R. H. Bauer, “Application of a neuroelectric model to
electrocutaneous sensory sensitivity: Parameter variation study,” IEEE
Trans. Biomed. Eng., vol. BME-34, no. 9, pp. 752–754, Sep. 1987.
[39] Italian National Research Council. (2007). Dielectric properties of body
tissue. [Online]. Available: http://niremf.ifac.cnr.it/tissprop/
[40] D. R. McNeal, “Analysis of a model for excitation of myelinated
nerve,” IEEE Trans. Biomed. Eng., vol. BE-23, no. 4, pp. 329–337,
Jul. 1976.
[41] J. Schwarz and G. Eikhof, “Na currents and action potentials in rat myelinated nerve fibres at 20 and 37 degrees c,” Pflugers Arch., vol. 6, no. 409,
pp. 569–577, Aug. 1987.
[42] F. Rattay and M. Aberham, “Modeling axon membranes for functional
electrical stimulation,” IEEE Trans. Biomed. Eng., vol. 40, no. 12,
pp. 1201–1209, Dec. 1993.
[43] J. H. M. Frijns et al., “A quantitative approach to modeling mammalian
myelinated nerve fibers for electrical prosthesis design,” IEEE Trans.
Biomed. Eng., vol. 41, no. 6, pp. 556–566, Jun. 1994.
[44] C. C. McIntyre et al., “Modeling the excitability of mammalian nerve
fibers: Influence of afterpotentials on the recovery cycle,” J. Neurophysiol.,
vol. 87, no. 2, pp. 995–1006, 2002.
[45] A. Branner and R. A. Normann, “A multielectrode array for intrafascicular recording and stimulation in sciatic nerve of cats,” Brain Res. Bull.,
vol. 51, no. 4, pp. 293–306, 2000.
[46] A. Barker, “An introduction to the basic principles of magnetic
nerve stimulation,” J. Clin. Neurophysiol, vol. 8, no. 1, pp. 26–37,
1991.
[47] H. A. C. Wark et al., “Selective activation of the muscles of micturition using intrafascicular stimulation of the pudendal nerve,” IEEE J.
Emerging Sel. Topics Circuits Syst., vol. 1, no. 4, pp. 631–636, Dec.
2011.
[48] Y. Grinberg et al., “Fascicular perineurium thickness, size, and position
affect model predictions of neural excitation,” IEEE Trans. Neural Syst.
Rehabil. Eng., vol. 16, no. 6, pp. 572–581, Dec. 2008.
[49] A. Choi et al., “Selectivity of multiple-contact nerve cuff electrodes:
a simulation analysis,” IEEE Trans. Biomed. Eng., vol. 48, no. 2,
pp. 165–172, Feb. 2001.
[50] L. Goldman and J. Albus, “Computation of impulse conduction in myelinated fibers; theoretical basis of the velocity-diameter relation,” Biophys.
J., vol. 8, no. 5, pp. 596–607, 1968.
[51] H. Schmalbruch, “Fiber composition of the rat sciatic nerve,” Anatomical
Rec., vol. 215, no. 1, pp. 71–81, 1986.

[52] J. Reilly and A. Diamant, “Spatial relationships in electrostimulation:
application to electromagnetic field standards,” IEEE Trans. Biomed. Eng.,
vol. 50, no. 6, pp. 783–785, Jun. 2003.
[53] A. Rotem and E. Moses, “Magnetic stimulation of curved nerves,”
IEEE Trans. Biomed. Eng., vol. 53, no. 3, pp. 414–420, Mar.
2006.
[54] S. Chiu et al., “A quantitative description of membrane current in rabbit
myelinated nerve,” J. Physiol., vols. 149–166, no. 292, Jun. 1979.

Anil Kumar RamRakhyani (S’09–M’14) received
the B.Tech. degree in electrical engineering from Indian Institute of Technology Kanpur, Kanpur, India, in 2006, the M.A.Sc. degree in electrical and
computer engineering from the University of British
Columbia, Vancouver, BC, Canada, in 2010, and the
Ph.D. degree in electrical and computer engineering
from the University of Utah, Salt Lake City, UT, USA,
in 2014.
He has been a Postdoctoral Fellow in electrical
and computer engineering at the University of Utah
since June 2015. In 2006, he joined Sarnoff Corporation as a Design Engineer,
where he worked as a Senior Design Engineer from 2007 to 2008. He worked
on software and hardware design of healthcare and RF-based products. For
summer 2013, he worked as an Research Intern in Boston Scientific’s neuromodulation division on the next-generation telemetry system. His main research
interests include wireless power transfer, bioelectromagnetics, metamaterials,
neural stimulator, wireless implantable biomedical systems, and integrated analog circuit design.

Zachary B. Kagan (S’12) received the B.S. degree in
electrical engineering from the University of Florida,
Gainesville, FL, USA, in 2012. He is currently working toward the Ph.D. degree at the University of Utah,
Salt Lake City, UT, USA.
His research interests include in vivo studies of
electromagnetic nerve stimulation and noise reduction techniques for neural data.

David J. Warren (M’76–SM’14) received the B.S.
degree in electrical engineering from Washington
State University, Pullman, WA, USA, in 1979, the
M.S. degree in electrical engineering from the University of Washington, Seattle, WA, in 1982, and the
Ph.D. degree in bioengineering from the University
of Utah, Salt Lake City, UT, USA, in 2006.
He is currently the Research Director for the Center for Neural Engineering and a Research Assistant
Professor in the Department of Bioengineering, University of Utah. His research interests include the
decoding of afferent and encoding of efferent neuronal signals in the peripheral
nervous system for use with neuroprostheses to restore sensory and motor function after spinal cord injury or limb loss.

RAMRAKHYANI et al.: COMPUTATIONAL MODEL OF MAGNETIC NEURAL STIMULATION IN MULTIFASCICULAR PERIPHERAL NERVES

Richard A. Normann received the Ph.D. degree
from the University of California, Berkeley, CA,
USA.
He is a Distinguished Professor (emeritus) in the
Departments of Bioengineering and Ophthalmology,
University of Utah, Salt Lake City, UT, USA. His
research interests include neuroengineering, sensory
and motor physiology, and interfaces to the nervous
system.

2849

Gianluca Lazzi (S’94–M’95–SM’99–F’08) received
the Dr.Eng. degree in electronics from the University of Rome La Sapienza, Rome, Italy, in 1994, the
Ph.D. degree in electrical engineering from the University of Utah, Salt Lake City, UT, USA, in 1998,
and the Executive M.B.A., specialized in Corporate
Finance, from IE Business School (Instituto de Empresa), Madrid, Spain, in 2015.
He is currently a USTAR Professor and Department Chair in the Department of Electrical and Computer Engineering, University of Utah. Prior to his
appointment at the University of Utah, he was a Professor (2006–2009), an
Associate Professor (2003–2006), and an Assistant Professor (1999–2003) in
the Department of Electrical and Computer Engineering, North Carolina State
University, Raleigh, NC, USA. He has been a Visiting Researcher with the Italian National Board for New Technologies, Energy, and Environment (1994),
a Visiting Researcher with the University of Rome La Sapienza (1994–1995),
and a Research Associate (1995–1998) and Research Assistant Professor (1998–
1999) with the University of Utah. He has authored or coauthored more than 200
international journal papers, conference presentations, and book chapters on implantable devices, medical applications of electromagnetics, wireless telemetry,
antenna design, computational modeling, dosimetry, and bioelectromagnetics.
Dr. Lazzi was the Chair of Commission K (Electromagnetics in Biology
and Medicine) (2006–2008) and a Member-at-Large (2009–2011) of the U.S.
National Committee of the International Union of Radio Science (URSI). He
was the recipient of the 1996 Curtis Carl Johnson Memorial Award for the best
student paper presented at the 18th Annual Technical Meeting of the Bioelectromagnetics Society, a 1996 URSI Young Scientist Award, a 2001 Whitaker
Foundation Biomedical Engineering Grant for Young Investigators, a 2001 National Science Foundation CAREER Award, a 2003 NCSU Outstanding Teacher
Award, the 2003 NCSU Alumni Outstanding Teacher Award, the 2003 ALCOA Foundation Engineering Research Award, the 2006 H.A. Wheeler Award
from the IEEE Antennas and Propagation Society for the best application paper published in IEEE TRANSACTIONS ON ANTENNAS AND PROPAGATION in
2005, a 2008 Best Paper Award at the IEEE GlobeCom Conference, the 2009
ALCOA Foundation Distinguished Engineering Research Award, a 2009 R&D
100 Award, and the 2009 Editors Choice Award from the R&D Magazine for
the Artificial Retina Project. He was an Associate Editor for the IEEE ANTENNAS AND WIRELESS PROPAGATION LETTERS (2001–2007) and served as the
Editor-in-Chief of the IEEE ANTENNAS AND WIRELESS PROPAGATION LETTERS
from 2008 to 2013. He also served as a Guest Editor for the Special Issue on
Biological Effects and Medical Applications of RF/Microwaves of the IEEE
TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES in 2004 and as the
Technical Program Chair of the IEEE Antennas and Propagation International
Symposium and URSI meeting in Charleston, SC, USA, in 2009. He is currently
a Member of the Editorial Board of the PROCEEDINGS OF THE IEEE, the Chair of
the IEEE Sensors Council Fellow Committee, and the Chair of the Publications
Committee of the IEEE AP Society. He was the General Co-Chair of the 2014
edition of the IEEE Microwave Symposium on RF and Wireless Technologies
for Biomedical Applications.

