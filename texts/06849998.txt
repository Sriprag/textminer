60

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Three-Dimensional Reconstruction of a Cardiac
Outline by Magnetocardiography
Taehoon Ha, Kiwoong Kim*, Member, IEEE, Sanghyun Lim, Kwon Kyu Yu, and Hyukchan Kwon

Abstract—A 3-D cardiac visualization is significantly helpful toward clinical applications of magnetocardiography (MCG), but
the cardiac reconstruction requires a segmentation process using additional image modalities. This paper proposes a 3-D cardiac outline reconstruction method using only MCG measurement
data without further imaging techniques. The cardiac outline was
reconstructed by a combination of both spatial filtering and coherence mapping method. The strength of cardiac activities was
first estimated by the array-gain constraint minimum-norm spatial filter with recursively updated gram matrix (AGMN-RUG).
Then, waveforms were reconstructed at whole source grids, and
the maximum source points of an atrium and ventricle were selected as a reference, respectively. Next, the coherence between
each maximum source point and whole source points was compared by the coherence mapping method. A reconstructed cardiac
outline was validated by comparing with an overlapped volume
ratio when the reconstructed volume was identically matched with
the original volume. The results obtained by the AGMN-RUG were
compared to the results by other spatial filters. The accuracy of numerical simulation and phantom experiment by the AGMN-RUG
was superior 10% and 8%, respectively, than the accuracy by
the standardized low-resolution electromagnetic tomography. This
accuracy demonstrated the efficacy of the proposed 3-D cardiac
reconstruction method.
Index Terms—Cardiac conductor model reconstruction, coherence mapping, magnetocardiography (MCG), spatial filtering.

I. INTRODUCTION
AGNETOCARDIOGRAPHY (MCG) is a promising
noninvasive technique to evaluate cardiac electromagnetic activities since the magnetic fields generated from the
myocardium are transparent to the human body structures. It
has been proved that MCG with its excellent temporal and

M

Manuscript received February 12, 2014; revised June 5, 2014; accepted June
25, 2014. Date of publication July 8, 2014; date of current version December 18,
2014. This work was supported by the World Class Laboratory grant from Korea
Research Institute of Standards and Science. Asterisk indicates corresponding
author.
T. Ha is with the Center for Biosignals, Korea Research Institute of Standards
and Science, Daejeon 305-340, Korea, and also with the Department of Medical Physics, University of Science and Technology, Daejeon 305-333, Korea
(e-mail: taehoon.ha@ust.ac.kr).
*K. Kim is with the Center for Biosignals, Korea Research Institute of Standards and Science, Daejeon 305-340, Korea, and also with the Department
of Medical Physics, University of Science and Technology, Daejeon 305-333,
Korea (e-mail: kwkim@kriss.re.kr).
S. Lim is with the Center for Biosignals, Korea Research Institute of Standards
and Science, Daejeon 305-340, Korea, and also with the Department of Medical Physics, University of Science and Technology, Daejeon 305-333, Korea
(e-mail: santagravity@ust.ac.kr).
K. K. Yu and H. Kwon are with the Center for Biosignals, Korea Research Institute of Standards and Science, Daejeon 305-340, Korea (e-mail:
kkyu@kriss.re.kr; hckwon@kriss.re.kr).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2336671

spatial resolution is especially useful for localizing myocardial ischemic regions and reentrant excitations causing cardiac
arrhythmia [1]–[4]. In particular, three-dimensional (3-D) localization of cardiac electric activities and 3-D visualization
of cardiac current distribution are significantly helpful in clinical applications. Kim et al. proposed a visualization method of
an action potential activity map to detect the atrial fibrillation
caused by cyclic reentrant myocardial excitation on the myocardial surface [5]. Therefore, the 3-D reconstruction of a heart is
essential for the 3-D analysis of cardiac electric activities and
clinical applications of MCG.
However, several drawbacks exist for the reconstruction of
3-D cardiac shape based on existing imaging techniques. First, a
complex segmentation process from anatomical imaging modalities such as X-ray computed tomography (CT) or magnetic resonance imaging (MRI) is required. Although several research
groups have suggested an automated segmentation method of
cardiac compartments to advance the manual segmentation, the
implementation of imaging techniques is inevitable [6]–[9]. Second, patients are exposed to an excessive radiation in X-ray or
high magnetic field in MRI. It has been reported that CT scanning is the major source of radiation exposure in the medical
dose, and the doses from CT may lead to the potential cancer
risk [10]. The last disadvantage is that patients feel a cost burden
for taking imaging modalities.
To overcome these downsides mentioned previously, a new
method using only the MCG measurement data was suggested.
Nakai et al. reported a 3-D outline construction method of a
heart using MCG with spatial filtering [11]. They estimated the
current density using a nonadaptive spatial filtering method,
specifically minimum norm estimation with Tikhonov regularization. Then, a 3-D heart polygon was generated from
the integrated current density. However, the nonadaptive spatial filter, depends only on the measurement geometry, generally has a large source localization bias to noise interferences
[12], [13].
On the contrary, the adaptive spatial filter is well known for
the high spatial resolution and low source localization bias [14]–
[19]. Since it depends not only on the measurement geometry
but also on the measurement covariance matrix, it is robust to
the noise interferences. The adaptive spatial filter is strong to
slightly correlated sources, but it causes significant localization
errors to highly correlated sources [17], [20]. Since the electrical
signals of the heart are highly correlated, the adaptive spatial
filtering for myocardial source localization generates inaccurate
results. Therefore, both the nonadaptive and adaptive spatial
filtering method have limitations in the reconstruction of 3-D
cardiac outline.

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

HA et al.: THREE-DIMENSIONAL RECONSTRUCTION OF A CARDIAC OUTLINE BY MAGNETOCARDIOGRAPHY

In order to improve the spatial resolution, Kumihashi et al.
proposed the array-gain constraint minimum-norm spatial filter
with recursively updated gram matrix (AGMN-RUG) [13]. The
AGMN-RUG spatial filter is based on the nonadaptive spatial
filter and designed to obtain comparable performance to the
adaptive spatial filter. Therefore, the AGMN-RUG spatial filter
circumvents highly correlated myocardial sources and generates
accurate cardiac outline.
We also applied a coherence mapping method to reconstruct
more accurate cardiac outline. Since the electrical signals generated from an atrium and ventricle are correlated individually,
the outline of atrium and ventricle can be reconstructed by comparing the regenerated cardiac waveforms. First, the strength of
myocardial current activities was estimated by the AGMN-RUG
spatial filter. Then, the maximum source positions of the atrium
and ventricle were pivoted as a reference point, respectively.
After the waveforms at whole source space were reconstructed,
the coherence between the each maximum reference point and
reconstructed waveforms at the whole source grid was calculated. Finally, both results of AGMN-RUG spatial filtering and
coherence mapping were normalized by thresholds decided on
the volume comparison between the reference and reconstruction of the atrium and ventricle. Then, the results obtained by
the AGMN-RUG were compared to the results by other spatial
filters.
The proposed 3-D cardiac reconstruction method could be
helpful in the clinical applications of MCG. In particular, the
ellipsoid cardiac model which simplifies a heart as an ellipsoid
shape to significantly reduce numerical calculation of forward
problem has been applied in diagnosing the coronary artery
diseases [21], [22]. However, it may cause erroneous results because the position of ellipsoid model is fixed, so incorrect information is provided to the calculation. Therefore, if the accurate
position of ellipsoid model is obtained from a patient using the
3-D cardiac reconstruction method, the diagnosis accuracy will
be enhanced.
In this paper, we present a 3-D reconstruction method of a
cardiac surface with MCG data based on cardiac source powers estimated from the spatial filtering and coherence mapping
obtained from the reconstructed cardiac waveforms. To validate
the suggested 3-D cardiac reconstruction method, we first performed simulation experiments in that a cardiac shape was reconstructed using magnetic fields measured from the artificially
created atrium and ventricle. Then, we implemented phantom
experiments using magnetic fields generated from cardiac and
torso phantoms. These results demonstrate the imaging capabilities of the 3-D reconstruction method of cardiac surface using
MCG.
II. METHODS
A. Array-Gain Constraint Minimum-Norm Spatial Filter
With Recursively Updated Gram Matrix
A spatial filtering method can reconstruct the cardiac shape,
since the output power of spatial filters can estimate the magnitude of myocardial electric activities. A source vector is defined as s(r, t) at location r = (x, y, z) and time t in a discrete

61

volume space V . The total number of sources is Q. The
generated magnetic fields from the sources measured by N channel sensors during time window t are denoted as b(t) =
[b1 (t), b2 (t), . . . , bn (t)]T where T is the matrix transpose. Then,
from the sensor configuration and conductivity geometry of the
source space, we can calculate the sensitivity distribution of
sensors responding to unit current sources. This is called the
lead-field vector [23] and defined as l(r) ≡ [lx (r), ly (r), lz (r)],
and the N×Q lead-field matrix is expressed as
L(r) = [l1 (r), l2 (r), . . . , lq (r)].

(1)

The measurement data are obtained from a combination of the
lead-field matrix and source vectors as follows:

L(r)s(r, t)dV.
(2)
b(t) =
V

The spatial filter is a weight vector which is linearly multiplied
to the measured magnetic fields for estimating source activities.
The estimated source vector ŝ(r, t) is derived from a linear
combination of the weight vector, W(r), and the measurement
data like
ŝ(r, t) = WT (r)b(t).

(3)

Then, combining (2) and (3), the estimated source vector is
derived as

WT (r)L(r )s(r , t)dV  .
(4)
ŝ(r, t) =
V


T

Here, W (r)L(r ) is referred to as the beam response that
stands for the gain of misleading leakage from not the filter
pointing location but other source locations [14]. To design an
ideal spatial filter, the gain from the beam response should be
minimized. Therefore, the minimum-norm-based spatial filter is
derived from solving an optimization problem with constraints
as follows:
W(r) = arg min C(W) subject to
W (r)

⎤
0
||lx || 0
WT (r)L(r) = Φ = ⎣ 0 ||ly || 0 ⎦
0
0 ||lz ||
⎡

(5)

where ||l(r)|| represents the gain of the sensor array. In (5),
C(W) is a cost function, and it represents the summation of
whole leakage powers. The cost function is denoted as follows:

C(W) =
tr{[WT (r)L(r ) − δ(r − r )Φ]H(r )
V

 T
T
W (r)L(r ) − δ(r − r )Φ }dV 

(6)

where tr{·} is the trace of the matrix in the curly brackets, δ(r)
is the delta function, and H(r ) is an arbitrary weighting matrix.
When the gram matrix is defined with the lead-field matrix and
the weighting matrix as follows:

L(r)H(r)LT (r)dV.
(7)
G≡
V

Then, the weight vector is obtained by a linear combination
of the depth-normalized lead-field matrix, L̃(r), and the gram

62

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

matrix as
W(r) =

L̃T (r)G−1
.
L̃T (r)G−1 L̃(r)

(8)

Since the sensitivity of sensors is decreased in proportion to the
square of the distance, the power of superficial sources is greater
than deep sources. To compensate the power of deep sources,
the depth-normalized lead-field matrix is employed, and it is
expressed as follows:
	


lx (r)
ly (r)
lz (r)
,
,
l̃(r) =
.
(9)
lx (r) ly (r) lz (r)
In the case of adaptive spatial filter, the minimum variance
(MV) spatial filter is widely applied in bioelectromagnetism.
The MV spatial filter is derived from solving an optimization
problem that minimizes the output power under the constraint,
i.e.,
T

W(r) = arg min W (r)DW(r)
W (r)

subject to

WT (r)L(r) = Φ

(10)

where D is a covariance matrix of measurement data and defined
as an ensemble average of data, D ≡ b(t)bT (t). After that,
the MV spatial filter is formulated by a combination of the
normalized lead-field and data covariance matrix as
W(r) =

L̃T (r)D−1
.
L̃T (r)D−1 L̃(r)

(11)

In comparison between (8) and (11), the only difference is the
gram matrix and data covariance matrix. The covariance matrix
is expressed using (2) as follows:

L(r)s(r, t)sT (r, t)LT (r)dV.
(12)
D=
V

Comparing (7) and (12), the arbitrary weighting matrix is
similar to the source power matrix. Therefore, if the weighting matrix H(r) is substituted for the source power matrix
s(r, t)sT (r, t), we can expect the performance of minimumnorm spatial filter is similar with the MV spatial filter.
In order to obtain more accurate results, we have to consider
the noise effects toward the gram matrix. Since the condition
number, an output value of a function according to the change of
an input argument, of the gram matrix in practical applications is
significantly large, calculating G−1 generates inaccurate results.
By applying the regularization method, the errors caused from
calculating G−1 can be reduced. Finally, the modified array-gain
constraint minimum-norm spatial filter is expressed as
W(r) =

L̃T (r)(G + λI)−1
L̃T (r)(G + λI)−1 L̃(r)

(13)

where λ is the regularization parameter that is determined by
the signal-to-noise ratio (SNR) of the measurement noise. In
(12), since the source vector s(r, t) is unknown, it is replaced
by the estimated source vector ŝ(r, t) for calculating the weight
matrix H(r). To obtain the optimum weight matrix, first, the
weight matrix is initialized as the identity matrix, I. Second,
the spatial filter output W(r) is produced from (13). Third, the

Fig. 1. Conceptual diagram of the relationship between a spatial filtering and
coherence mapping. The (black) solid line represents volumes of a simplified
atrium and ventricle. The (blue) long dashed line is reconstructed volume by
spatial filtering, and the (red) short dashed line is reconstructed volume by
coherence mapping method. The dense volumes are a combination of the spatial
filtering and coherence mapping method. The (green) mesh volume represents
positive volume whereas the (blue) filled volume represents negative volume
to the original cardiac volume. The (blue) rectangle and (red) triangle are the
maximum source power of the atrium and ventricle, respectively, and they are
used as a pivot point for coherence calculation.

estimated source vector ŝ(r, t) is derived from (3). Finally, the
weight matrix in (7) is updated by the estimated source vector.
The weight matrix is recursively updated based on the above
procedure until the updated weight is converged on a certain
criteria.
B. Coherence Mapping
Although the cardiac volume is reconstructed by using the
power of myocardial electrical activities, biological noises such
as respiration and digestion may negatively influence on the
calculation of source power [24]. To reconstruct the more accurate cardiac volume, we also propose the coherence mapping
method. The relationship of the spatial filtering and coherence
mapping is described as a conceptual diagram in Fig. 1. The estimated source power by the spatial filtering is generally localized
adjacent to the sensors and centered of the object. The depthnormalization by (9) compensates the power of deep sources,
but the spatial filtering results tend to still be localized close
to the sensors and centered of the object. On the other hand,
the coherence mapping method is to compare the similarity of
waveforms derived at between the pivot point of the heart and
the whole points. Since the coherence mapping method is independent to the source amplitude, it well represents the deep
sources but artifacts to the weak sources may generate spurious coherence. To overlap the reconstructed cardiac volume by
spatial filtering and coherence mapping method, the biased volume close to the sensor in the spatial filtering and the distorted
volume in the coherence mapping are removed.
The cardiac action potential in the atrium and ventricle represents different duration, strength, and shape, so these differences

HA et al.: THREE-DIMENSIONAL RECONSTRUCTION OF A CARDIAC OUTLINE BY MAGNETOCARDIOGRAPHY

63

Fig. 2. Diagram of the coherence mapping method by double pivot points.
The bullets are 3-D source space. The ŝ(ra , t) and ŝ(rv , t) are reconstructed
waveforms derived at the maximum source power of an atrium [(blue) rectangle] and ventricle [(red) triangle] by the AGMN-RUG spatial filtering method,
respectively. Then, the coherence between the maximum source point and whole
source space is calculated.

enable distinguishing the coherence between the atrium and ventricle. The waveforms in the source space are reconstructed by
multiplying the weight vector to the measured magnetic fields
in (3). Then, the time series of reconstructed waveform is represented as ŝ(rq , t) at the Qth position. And the ŝ(ra , t) and
ŝ(rv , t) are waveforms at the position of maximum source power
of the atrium and ventricle, respectively, as shown in Fig. 2. As
Sa (f ), Sv (f ), and Sq (f ) are the fast Fourier transforms (FFT)
of ŝ(ra , t) ŝ(rv , t), and ŝ(rq , t), respectively, the cross spectrum
is defined as follows [25]:
Γaq (f ) ≡ Sa (f )Sq∗ (f )
Γv q (f ) ≡ Sv (f )Sq∗ (f )

(14)

∗

where represents the complex conjugate. Then, the coherence
is defined with the absolute value of normalized cross spectrum
as




Γaq (f )


Cohaq (f ) ≡  

 Γaa (f )Γq q (f ) 




Γv q (f )


Cohv q (f ) ≡  
(15)
.
 Γv v (f )Γq q (f ) 
In general, the length of averaged MCG data is roughly
1000 ms to represent one cardiac cycle. However, the length of
reconstructed waveforms for the atrium and ventricle is shorter
than the averaged MCG data. If the waveform length is finite or
short for calculating power spectrum density, it causes large variances. To minimize the variance, we applied the Welchs method
[26]. The reconstructed waveforms are divided into overlapping
segments, then the Hanning window is applied to the segments.
C. MCG System and the Cardiac Conductor Model
We assumed the MCG system and cardiac conductor model
for the numerical simulation. The simulated MCG data were

Fig. 3. Setup for the phantom experiments. (a) Simplified cardiac phantom
with 12 current sources. The dipole is made of copper wire with 0.55 mm in
diameter, and the white plastics support the cardiac phantom. (b) Human torso
phantom with a 64-channel MCG system.

based on the KRISSMCG system (Center for Biosignals, Korea Research Institute of Standards and Science, Korea), and
the system was consisted of 64-channel double relaxation oscillation superconducting quantum interference devices sensors
[27]. The pickup coil was the first-order axial gradiometer type
with a baseline of 70 mm, and the noise level of each sensor was
approximated to 5 fTrm s /Hz1/2 at 100 Hz. The sampling rate
was 500 Hz. For solving the forward problem, the horizontally
layered model was used as the cardiac conductor model, and
the equivalent current dipole (ECD) was assumed as the source
model [28].
D. Phantom Model
To verify the 3-D cardiac reconstruction method, we conducted phantom experiments using a cardiac and human torso
model. The cardiac model was simplified by a cardiac phantom
using a goose egg, and 12 current dipoles were placed 5 mm
above on the surface of the cardiac phantom as shown in
Fig. 3(a). The length from the base to the apex of the cardiac
phantom was 95 mm, and the width was 65 mm. A realistically
shaped physical torso phantom has been applying for increasing the localization accuracy [29], [30]. Here, the physical torso
phantom made of fiberglass (Friedrich Schiller University Jena,
Germany) in Fig. 3(b) was filled with saline solution (0.9 %), and
the conductivity was approximately 0.16 S/m. The egg model

64

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Fig. 4. Source configurations for the numerical simulation shown in the
(a) XY, (b) YZ, (c) XZ, and (d) XYZ plane. The circle depicts an atrium, and
the bullet describes a ventricle. The source number of the atrium and ventricle is
199 and 248, respectively. The source spacing is 10 mm. The arrow and dashed
circle represent the position and direction of reference sources.

was placed inside of the torso phantom, and it was tilted 45◦
in the coronal plane and 30◦ in the sagittal plane, respectively.
The dipole positions with respect to the torso phantom were
measured by a 3-D digitizer (Patriot, Polhemus, U.S.) which
generates 3-D coordinates for the marker from a fiducial point.

Fig. 5. Simulation results of the atrium and ventricle by the combination
of AGMN-RUG spatial filtering and coherence mapping method, respectively.
(a) Magnetic fields generated from the atrium and ventricle measured by a
64-channel MCG system. The normalized results of multiplied source power
and coherence of the (b) atrium and (c) ventricle.

III. RESULTS
A. Simulation Experiments
For the numerical simulations of MCG signal, a voxel extent,
source position, and source shape were generated. An arbitrary
xiphoid position was fixed for the fiducial point. The coordinate
of covering source voxels was from −70 to 80 mm in the X-axis,
from −20 to 150 mm in the Y-axis, and from 0 to −150 mm in
the Z-axis, respectively. The voxel interval was 10 mm, and the
total number was 3314 that was derived from the point spread
function. Then, the source positions were predetermined in the
3-D space, and the differences in width and depth of sources
were decided to represent an approximation of the atrium and
ventricle as shown in Fig. 4.
We assumed the source as the ECD and applied the horizontally layered model as the volume conductor model (VCM) to
generate the magnetic fields from a heart. The measured MCG
data were summation of generated signals from the whole current dipole sources, in which the signal type was a sinusoidal excitation. Its strength was 0.25 μA·m for the atrium and 1 μA·m
for the ventricle. Then, the Gaussian white noise with SNR
20 dB was added. The reference source position and direction
were depicted in Fig. 4. Since cardiac action potentials represent

a slightly different duration and shape at different regions, the
frequency, and phase were set in a slightly different manner. The
center frequency of the atrium and ventricle were 10 and 8 Hz,
respectively. The phase was increased 26◦ to the next point
based on the proportion of the distance with the reference point
in the same transverse (XZ) plane, and sequentially increased
30◦ to the next transverse plane from the base to apex. These
phase increase represents an excitation of systole and diastole
in one cycle. As the correlation coefficient of source signals is
expressed as follows:
s(r, t)s(r , t)
α= 
s(r, t)2 s(r , t)2 

(16)

the averaged α of the adjacent source point was approximately
0.976. Fig. 5(a) depicts the generated MCG signals based on
the above conditions where the SQUID sensors were positioned
at (0, 0, 40) mm. The segment from 0 s to 500 ms indicates
generated signals from the atrium, whereas from 500 ms to
1000 ms, it indicates generated signals from the ventricle.
There are two crucial factors to reconstruct the cardiac outline
by the source power and coherence: regularization parameter
for the gram matrix, and threshold values for the normalized

HA et al.: THREE-DIMENSIONAL RECONSTRUCTION OF A CARDIAC OUTLINE BY MAGNETOCARDIOGRAPHY

65

B. Phantom Experiments

Fig. 6. Selected threshold based on the SNR, and an accuracy of reconstructed
outline in the numerical simulation. The (black) square and (red) circle represent
the normalized threshold of an atrium and ventricle, respectively. The PV-A
[(blue) mesh rectangle] and NV-A [light (gray) rectangle] are the positive and
negative volume ratio of the atrium, and the PV-V [(red) oblique rectangle]
and NV-V [dark (gray) rectangle] are the positive and negative volume ratio
of the ventricle, respectively. The threshold was determined as the volume of
reconstructed outline was identical with the volume of source outline.

source power, coherence, and multiplication. First, the λ was
determined by the noise level. In this simulation, the parameter
for the atrium and ventricle was set to 0.001 and 0.0001 times to
the maximum eigenvalue of each gram matrix in the SNR was
20 dB. Second, the thresholds of normalized source power and
coherence were determined as the volume was identical between
the reconstructed outline and original shape based on the SNR
as shown in Fig. 6. The threshold values for the atrium and
ventricle for source power were selected to 0.018 and 0.015, the
values for the coherence mapping method were selected to 0.041
and 0.034, and the values for the multiplication were selected
to 0.0058 and 0.0033, respectively.
The results of numerical simulation are shown in Fig. 7. The
source power of atrium and ventricle was conducted by the
AGMN-RUG spatial filtering method, and the normalized result
is described in Fig. 7(a). Then, the normalized source coherence
by (15) is depicted in Fig. 7(b). Finally, the multiplication of the
source power and coherence results is also normalized and depicted in Fig. 7(c). The accuracy of reconstructed outline was
explained by the ratio of positive and negative volume as depicted in Fig. 1. As the reconstructed volume is identical with
the original volume, the positive volume represents an overlapped volume between the two volume whereas the negative
volume indicates nonoverlapped volume. In numerical simulations, the accuracy of the atrium and ventricle exceeded 70%
and 80%, respectively, over the SNR 15 as depicted in Fig. 6.
To validate the performance by the AGMN-RUG, the results
obtained by the AGMN-RUG were compared to the results by
other spatial filters. In the case of a standardized low-resolution
electromagnetic tomography (sLORETA), nonadaptive spatial
filter, the accuracy of the atrium and ventricle was above 60%
and 70%, respectively, over the SNR 15, and they were approximately 10% lower than the AGMN-RUG. However, the results
by a linearly constrained minimum variance (LCMV) spatial filter, adaptive spatial filter, did not generate a reasonable outline
because sources were sparsely localized by the effect of source
correlations.

We defined the voxel extent, VCM, and source model for
the phantom experiments. The extent of covering source voxel
was identical with the condition of numerical simulation, and
the horizontally layered model was used for the VCM. Then,
the sinusoidal current source was generated with 100 μA·m
amplitude, and the frequency was mixture of 5 and 10 Hz.
Fig. 8 depicts the measured magnetic fields generated from
12 source positions with two different combination of frequency.
The reconstructed configuration resulting from the phantom
experiments is shown in Fig. 9. Fig. 9(a) is the reconstructed result by normalized source power from the AGMN-RUG spatial
filtering. Fig. 9(b) is the result by the normalized coherence mapping method. Finally, the results by both AGMN-RUG spatial
filtering and coherence mapping were multiplied that is illustrated in Fig. 9(c). The accuracy of the reconstructed outline
by the AGMN-RUG and sLORETA represented approximately
71% and 63%, respectively.
IV. DISCUSSION AND CONCLUSION
The purpose of this study is to reconstruct a 3-D cardiac
outline using a combination of the spatial filtering and coherence mapping method based on the measured magnetic fields.
To obtain more accurate source reconstruction, we applied the
LCMV spatial filter. Although the general adaptive spatial filter
represents high spatial resolution, it is significantly influenced
by highly correlated sources. However, the LCMV spatial filter
can reduce the influence of source correlation by separating the
interesting sources from other correlated sources using multiple
constraints [14], [31] . The multiple constraints indicate to suppress a region of correlated sources. If the suppression region is
defined as Ω and its size is M, the N × 3M constraint matrix is
expressed as LΩ = [l(rΩ 1 ), l(rΩ 2 ), . . . , l(rΩ M )]. Then, including the multiple constraints WT (r)LΩ = 0 to (10), the weight
vector of LCMV is derived as below


L̆T (r)D−1
W(r) =
e
(17)
L̆T (r)D−1 L̆(r)
where e is an unit vector for the lead-field of interest, and
L̆(r) is a modified N × 3(M+1) lead-field matrix expressed as
L̆(r) = [l̃(r), LΩ ].
The LCMV spatial filtering contains two major limitations
as applying to the reconstruction of cardiac outline. The first
drawback is that the suppression region for correlated cardiac
sources is quite large. The LCMV spatial filter is widely applied
in the source reconstruction for the auditory-evoked field [20],
[32] or brain connectivity [33], [34] by magnetoencephalography (MEG)/electroencephalography. In that case, since the
source number of the suppression region is generally smaller
than the number of sensors, the LCMV spatial filter successfully localizes the correlated sources. However, we should set
the suppression region as large in MCG because not only the
volume of a heart is significantly large compared to the source
voxel but also the location of a heart is uncertain. As the suppression is large, the accuracy of source estimation is decreasing.

66

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

Fig. 7. Simulation results of the cardiac outline reconstruction based on threshold values for source power, coherence, and multiplication of source power and
coherence by the AGMN-RUG spatial filtering and coherence mapping method. (a) The thresholds for normalized of the atrium and ventricle for source power
are 0.018 and 0.015, (b) these for coherence are 0.041 and 0.034, and (c) these for multiplication are 0.0058 and 0.0033, respectively. The upper volume in the
first column and the right volume in the second column represent the atrium, and the lower volume in the first column and the left volume in the second column
represent the ventricle. The black lined mesh depict the original source shape of the arbitrary atrium and ventricle. The first column is the anterior view, the second
one is the left lateral view, and the last one is the right lateral-anterior view.

matrix is reduced by using the singular value decomposition
[35]. Then, the lead-field matrix in (17) is replaced to


(18)
L̆(r) = l̃(r), u1 , u2 , . . . , uk

Fig. 8. Measured magnetic fields by a 64-channel MCG system. The magnetic
fields were generated from 12 current sources based on Fig. 3(a) with different
frequency for diminishing coherence, and they were averaged and performed
baseline correction. The input frequency was 5 Hz at four sources for the atrium
and 10 Hz at eight sources for the ventricle.

The second drawback is the determination of threshold for truncating singular vectors. If the number of suppression region
outnumbers than sensors, the dimension of modified lead-field

where u is a N×1 singular vector and k is a threshold value for
the truncation. To exactly represent the suppression region, the k
should be optimally determined but no strict method exists. Although we determined the k value based on the empirically, the
output of LCMV spatial filter did not reconstruct a reasonable
cardiac outline.
The regularization method significantly influences on the calculation of source power and waveform reconstruction. The
role of regularization is to stabilize a solution of ill-posed inverse problem [35]. To reconstruct the accurate cardiac outline, an optimum λ should be determined. The selection of λ
is based on the SNR. The SNR for the simulation is defined as
SNR = 20 log10 (Asignal /Anoise ) where A is root mean square
amplitude. Then, the λ is obtained from a ratio to the maximum
singular value of the gram matrix. As shown in Fig. 10, the λ
is almost linearly decreased from low SNR to high SNR data

HA et al.: THREE-DIMENSIONAL RECONSTRUCTION OF A CARDIAC OUTLINE BY MAGNETOCARDIOGRAPHY

67

(a)

(b)

(c)
Fig. 9. Phantom experiment results of the cardiac outline reconstruction based on threshold values for source power, coherence, and multiplication of source
power and coherence by the AGMN-RUG spatial filtering and coherence mapping method. (a) Threshold for normalized source power is 0.15, (b) threshold for
normalized coherence is 0.17, and (c) threshold for multiplication is 0.025 respectively. The first row represents power, the second row represents coherence, and
the third row represents multiplication. The black lined mesh depict the original source shape of the phantom. The first column is the anterior view, the second one
is the left lateral view, and the last one is the right lateral-anterior view.

Fig. 10. Ratio of regularization parameter based on the SNR. The ratio depends on the maximum singular value of measured MCG data. The rectangle
and circle are the ratio of λ of the atrium and ventricle, respectively.

in the log scale. In the case of low SNR data, large λ improves
the output SNR, whereas smaller λ attains the spatial resolution
maintaining the low SNR condition. Comparing the atrium and

ventricle, since the SNR of atrium data is lower than ventricle,
the value of λ is smaller than the λ of ventricle.
The reconstructed waveforms play the most important role in
comparing the coherence, but they cannot perfectly correspond
with the source signals because of two main reasons: power
leakage and regularization. The power leakage is caused by correlated sources, and the leakage produces errors in the waveform
reconstruction [14]. To design an optimal spatial filter, it only
passes the signal from a pointing location not others. However,
since the myocardial sources are highly correlated in large volume, the filter cannot suppress the power leakages. Furthermore,
the regularization parameter also causes errors in the waveform
reconstruction. The measured MCG data generally include a
certain level of noises, and it causes the source localization bias.
To minimize the bias, the regularization is applied in (13) which
represents adding an additional constant. Therefore, the artificially added constant may influence on the imperfect waveform
reconstruction.
The low-frequency components of MCG data can be excluded
in the coherence mapping method. Since the MCG data are

68

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 1, JANUARY 2015

generally averaged then segmented to one cardiac cycle for analysis, the length of MCG data is short for calculating power spectrum. Therefore, the Welchs method with the Hanning window
was implemented for the estimation of cross-spectral density by
the FFT [26]. As the length of window segment is L where the
sampling rate is K Hz, the signals below K/L Hz are ignored.
Here, we used the window size as 100 and the sampling rate as
500 Hz, so the slow varying signals under 5 Hz can be excluded.
In conclusion, we have developed a new method for the 3-D
reconstruction of cardiac outline using the combination of adaptive spatial filtering and coherence mapping method only based
on the measured MCG data without additional imaging modalities. The cardiac outline was reconstructed by the computer simulation and phantom experiment, and these results demonstrate
the feasibility of cardiac shape reconstruction. The proposed 3D cardiac reconstruction method promises to play an important
role in clinical applications in MCG.
The proposed method by numerical simulation and phantom
experiments shows that the 3-D cardiac outline reconstruction
using solely MCG data seems to be possible. This study, however, is a first pilot approach, not investigated sufficiently to
judge about the performance or even to use in clinical applications. Since the threshold crucially influences on the reconstruction of an exact cardiac shape, finding appropriate thresholds is
mandatory before providing any assessment on clinical value of
this proposed method. Therefore, we will evaluate the optimum
threshold for patients using the gold standard which should be
the realistic heart and torso by CT or MRI in significant number
of human subjects.
ACKNOWLEDGMENT
The authors would like to appreciate Dr. K. Sekihara of the
Tokyo Metropolitan University, Japan, for his kind comments
on the AGMN-RUG spatial filtering method.
REFERENCES
[1] R. Fenici, D. Brisinda, and A. M. Meloni, “Clinical application of magnetocardiography,” vol. 5, pp. 291–313, 2005.
[2] H. Koch, “Squid magnetocardiography: Status and perspectives,” IEEE
Trans. Appl. Supercond., vol. 11, no. 1, pp. 49–59, Mar. 2001.
[3] J.-W. Park, P. M. Hill, N. Chung, P. G. Hugenholtz, and F. Jung, “Magnetocardiography predicts coronary artery disease in patients with acute
chest pain,” Ann. Noninvasive Electrocardiol., vol. 10, no. 3, pp. 312–323,
2005.
[4] H. Hänninen, P. Takala, M. Mäkijärvi, J. Montonen, P. Korhonen,
L. Oikarinen, J. Nenonen, T. Katila, and L. Toivonen, “Detection of
exercise-induced myocardial ischemia by multichannel magnetocardiography in single vessel coronary artery disease,” Ann. Noninvasive Electrocardiol., vol. 5, no. 2, pp. 147–157, 2000.
[5] K. Kim, D. Kim, E.-B. Shim, Y.-H. Lee, H. Kwon, and Y.-K. Park, “Separative surface potential activation beamformer for localizing reentrant
excitation of atrial fibrillation,” in Proc. NFSI-ICFBI Joint Meet. 6th Int.
Symp. Noninvasive Funct. Source Imag. Brain Heart Int. Conf. Funct.
Biomed. Imag., 2007, pp. 316–319.
[6] Y. Zheng, A. Barbu, B. Georgescu, M. Scheuering, and D. Comaniciu,
“Four-chamber heart modeling and automatic segmentation for 3-D cardiac CT volumes using marginal space learning and steerable features,”
IEEE Trans. Med. Imag., vol. 27, no. 11, pp. 1668–1681, Nov. 2008.
[7] O. Ecabert, J. Peters, H. Schramm, C. Lorenz, J. von Berg, M. J. Walker,
M. Vembar, M. E. Olszewski, K. Subramanyan, G. Lavi, and J. Weese,
“Automatic model-based segmentation of the heart in CT images,” IEEE
Trans. Med. Imag., vol. 27, no. 9, pp. 1189–1201, Sep. 2008.

[8] M. R. Kaus, J. von Berg, J. Weese, W. Niessen, and V. Pekar, “Automated
segmentation of the left ventricle in cardiac MRI,” Med. Image Anal.,
vol. 8, no. 3, pp. 245–254, 2004.
[9] J. Kim, S. Kim, K. Kim, and J. Park, “Automated 3D heart segmentation
by search rays for building individual conductor models,” in Proc. SPIE
Int. Soc. Opt. Photon., 7261, p. 72 611W, 2009.
[10] P. W. Wiest, J. A. Locken, P. H. Heintz, and F. A. Mettler, Jr. , “Ct scanning:
A major source of radiation exposure,” Seminars in Ultrasound, CT and
MRI, vol. 23, no. 5, pp. 402–410, 2002.
[11] K. Nakai, K. Kawazoe, H. Izumoto, J. Tsuboi, Y. Oshima, T. Oka, K. Yoshioka, M. Shozushima, A. Suwabe, M. Itoh, K. Kobayashi, T. Shimizu, and
M. Yoshizawa, “Construction of a three-dimensional outline of the heart
and conduction pathway by means of a 64-channel magnetocardiogram
in patients with atrial flutter and fibrillation,” Int. J. Cardiovasc. Imag.,
vol. 21, no. 5, pp. 555–561, 2005.
[12] K. Sekihara, M. Sahani, and S. S. Nagarajan, “Localization bias and
spatial resolution of adaptive and non-adaptive spatial filters for meg
source reconstruction,” Neuroimage, vol. 25, no. 4, pp. 1056–1067, 2005.
[13] I. Kumihashi and K. Sekihara, “Array-gain constraint minimum-norm
spatial filter with recursively updated gram matrix for biomagnetic source
imaging,” IEEE Trans. Biomed. Eng., vol. 57, no. 6, pp. 1358–1365,
Jun. 2010.
[14] K. Sekihara and S. S. Nagarajan, Adaptive Spatial Filters for Electromagnetic Brain Imaging. New York, NY, USA : Springer, 2008.
[15] J. H. Hong, M. Ahn, K. Kim, and S. C. Jun, “Localization of coherent
sources by simultaneous MEG and EEG beamformer,” Med. Biol. Eng.
Comput., vol. 51, pp. 1–15, 2013.
[16] B. D. Van Veen and K. M. Buckley, “Beamforming: A versatile approach
to spatial filtering,” IEEE ASSP Mag., vol. 5, no. 2, pp. 4–24, Apr. 1988.
[17] K. Sekihara, K. E. Hild, and S. S. Nagarajan, “A novel adaptive beamformer for MEG source reconstruction effective when large background
brain activities exist,” IEEE Trans. Biomed. Eng., vol. 53, no. 9, pp. 1755–
1764, Sep. 2006.
[18] K. Sekihara, S. S. Nagarajan, D. Poeppel, and A. Marantz, “Performance
of an MEG adaptive-beamformer technique in the presence of correlated
neural activities: Effects on signal intensity and time-course estimates,”
IEEE Trans. Biomed. Eng., vol. 49, no. 12, pp. 1534–1546, Dec. 2002.
[19] K. Kim, “Source-space waveform reconstruction for coherent brain signals,” in Proc. Asia Pacific Signal Inf. Process. Assoc. Conf., 2011, pp.
402–405.
[20] S. S. Dalal, K. Sekihara, and S. S. Nagarajan, “Modified beamformers for
coherent source region suppression,” IEEE Trans. Biomed. Eng., vol. 53,
no. 7, pp. 1357–1363, Jul. 2006.
[21] M. Ziolkowski, J. Haueisen, H. Nowak, and H. Brauer, “Equivalent ellipsoid as an interpretation tool of extended current distributions in biomagnetic inverse problems,” IEEE Trans. Magn., vol. 36, no. 4, pp. 1692–1695,
Jul. 2000.
[22] J. S. Kwong, B. Leithäuser, J.-W. Park, and C.-M. Yu, “Diagnostic value of
magnetocardiography in coronary artery disease and cardiac arrhythmias:
A review of clinical data,” Int. J. Cardiol., vol. 167, 1835-1842, 2013.
[23] H. Burger and J. Van Milaan, “Heart-vector and leads,” British Heart J.,
vol. 8, no. 3, pp. 157–161, 1946.
[24] D. DiPietroPaolo, H. Müller, and S. Erné, “A novel approach for the
averaging of magnetocardiographically recorded heart beats,” Phys. Med.
Biol., vol. 50, no. 10, pp. 2415–2426, 2005.
[25] P. L. Nunez, R. Srinivasan, A. F. Westdorp, R. S. Wijesinghe, D. M.
Tucker, R. B. Silberstein, and P. J. Cadusch, “EEG coherency: I: Statistics, reference electrode, volume conduction, Laplacians, cortical imaging,
and interpretation at multiple scales,” Electroencephalogr. Clinical Neurophysiol., vol. 103, no. 5, pp. 499–515, 1997.
[26] P. Welch, “The use of fast Fourier transform for the estimation of power
spectra: A method based on time averaging over short, modified periodograms,” IEEE Trans. Audio Electroacoust., vol. AU-15, no. 2, pp.
70–73, Jun. 1967.
[27] Y. Lee, K. Yu, J. Kim, H. Kwon, K. Kim, and Y. Park, “64-channel
second-order axial gradiometer system based on DROS for magnetocardiogram in a thin shielded room,” Physica C, Supercond., vol. 468, no. 15,
pp. 1942–1945, 2008.
[28] J. Sarvas, “Basic mathematical and electromagnetic concepts of the biomagnetic inverse problem,” Phys. Med. Biol., vol. 32, no. 1, pp. 11–22,
1987.
[29] U. Tenner, J. Haueisen, H. Nowak, U. Leder, and H. Brauer, “Source
localization in an inhomogeneous physical thorax phantom,” Phys. Med.
Biol., vol. 44, no. 8, pp. 1969–1981, 1999.

HA et al.: THREE-DIMENSIONAL RECONSTRUCTION OF A CARDIAC OUTLINE BY MAGNETOCARDIOGRAPHY

[30] F. Wetterling, M. Liehr, P. Schimpf, H. Liu, and J. Haueisen, “The localization of focal heart activity via body surface potential measurements: Tests in a heterogeneous torso phantom,” Phys. Med. Biol., vol. 54,
no. 18, pp. 5395–5409, 2009.
[31] B. D. Van Veen, W. Van Drongelen, M. Yuchtman, and A. Suzuki, “Localization of brain electrical activity via linearly constrained minimum
variance spatial filtering,” IEEE Trans. Biomed. Eng., vol. 44, no. 9,
pp. 867–880, Sep. 1997.
[32] K. Sekihara, S. S. Nagarajan, D. Poeppel, A. Marantz, and Y. Miyashita,
“Application of an MEG eigenspace beamformer to reconstructing spatiotemporal activities of neural sources,” Human Brain Mapping, vol. 15,
no. 4, pp. 199–215, 2002.
[33] J.-M. Schoffelen and J. Gross, “Source connectivity analysis with MEG
and EEG,” Human Brain Mapping, vol. 30, no. 6, pp. 1857–1865, 2009.
[34] S. Haufe, V. V. Nikulin, K.-R. Müller, and G. Nolte, “A critical assessment
of connectivity measures for EEG data: A simulation study,” Neuroimage,
vol. 64, pp. 120–133, 2013.
[35] P. C. Hansen, “The truncatedSVD as a method for regularization,” BIT
Numerical Math., vol. 27, no. 4, pp. 534–553, 1987.

69

Sanghyun Lim received the B.S. and M.S. degrees
in physics from the Korea Advanced Institute of
Science and Technology, Daejeon, Korea, in 2008
and 2010, respectively. He is currently working
toward the Ph.D. degree in the Department of Medical Physics, University of Science and Technology,
Daejeon, Korea.
His research interests include electromagnetic brain signal processing/source activity
estimation/connectivity analysis, and recognition/procedural memory.

Taehoon Ha received the B.E. degree in electronics
and telecommunication engineering from Pukyong
National University, Busan, Korea, in 2006.
He is currently with the Center for Biosignals,
Korea Research Institute of Standards and Science,
Daejeon, Korea, and also with the Department of
Medical Physics, University of Science and Technology, Daejeon. His research interests include the
electromagnetic source imaging in MCG and inverse
problem in bioelectromagnetism, especially their application to modeling the cardiac electrophysiologi-

Kwon Kyu Yu received the B.S. and M.S. degrees in
electronic material engineering from Kyungsang National University, Jinju-si, Korea, in 1995 and 2000,
respectively.
Since 2003, he has been working in Korea Research Institute of Standards and Science, Daejeon,
Korea, to study high-Tc SQUIDs, low-Tc SQUIDs
and biomagnetic instrumentations.

Kiwoong Kim (M’13) was born in Seoul, Korea, in
1974. He received the B.S., M.S., and Ph.D. degrees
in physics from the Korea Advanced Institute of Science and Technology, Daejeon, Korea, in 1995, 1997,
and 2002, respectively.
Since 2002, he has been with the Korea Research
Institute of Standards and Science, Daejeon, as the
Head of research center for biosignals. Since 2006,
he has been a Professor with the Department of Medical Physics, University of Science and Technology,
Daejeon. From 2006 and 2012, he had been a Visiting Scholar with Princeton University, Princeton, NJ, USA and an Invited
Guest Scientist in Physikalisch-Technische Bundesanstalt, Berlin, respectively.
He is the author of more than 100 articles, and more than 80 inventions. His
research interests include magnetic resonance force microscopy, biomagnetic
signal processing and analysis, inverse problems in biomagnetism, clinical diagnoses and electrophysiological modeling in magnetocardiography and in magnetoencephalography, SQUID and atomic magnetometer instrumentation, and
micro-Tesla NMR/MRI. Especially, he invented biomagnetic resonance technology.
Dr. Kim received the International Conference on Biomagnetism Young
Investigator Award in 2008, Outstanding Article Award for the KRISS 34th
Anniversary in 2009, Award for KRISS Person of the Year (MCG Technology
Transfer to Germany) in 2011, and Award for a KRISS Distinguished Research
Scientist in 2013, etc.

Hyukchan Kwon received the B.S. and M.S. degrees
in nuclear engineering from Seoul National University, Seoul, Korea, in 1979 and 1981, respectively,
and Ph.D. degree in brain engineering from Hokkaido
University, Sapporo, Japan, in 2005.
Since 1981, he has been working at the Korea
Research Institute of Standards and Science, Daejeon, Korea, to study SQUID sensors for biomagnetic
measurements.

cal activity.

