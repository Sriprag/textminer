2648

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

Comparison Study for Whitney
(Raviart–Thomas)-Type Source Models
in Finite-Element-Method-Based EEG
Forward Modeling
Martin Bauer, Sampsa Pursiainen∗ , Johannes Vorwerk, Harald Köstler, and Carsten H. Wolters

Abstract—This study concentrates on finite-element-method
(FEM)-based electroencephalography (EEG) forward simulation
in which the electric potential evoked by neural activity in the
brain is to be calculated at the surface of the head. The main
advantage of the FEM is that it allows realistic modeling of tissue conductivity inhomogeneity. However, it is not straightforward
to apply the classical model of a dipolar source with the FEM,
due to its strong singularity and the resulting irregularity. The focus of this study is on comparing different methods to cope with
this problem. In particular, we evaluate the accuracy of Whitney
(Raviart–Thomas)-type dipole-like source currents compared to
two reference dipole modeling methods: the St. Venant and partial
integration approach. Common to all these methods is that they
enable direct approximation of the potential field utilizing linear
basis functions. In the present context, Whitney elements are particularly interesting, as they provide a simple means to model a
divergence-conforming primary current vector field satisfying the
square integrability condition. Our results show that a Whitneytype source model can provide simulation accuracy comparable to
the present reference methods. It can lead to superior accuracy under optimized conditions with respect to both source location and
orientation in a tetrahedral mesh. For random source orientations,
the St. Venant approach turns out to be the method of choice over
the interpolated version of the Whitney model. The overall moderate differences obtained suggest that practical aspects, such as the
focality, should be prioritized when choosing a source model.
Index Terms—Divergence conforming vector fields, electroencephalography (EEG), finite element method (FEM), RaviartThomas (Whitney) element, source modeling.

I. INTRODUCTION
HIS study concentrates on finite-element-method (FEM)based electroencephalography (EEG) forward simulation
in which the electric potential field evoked by neural activity

T

Manuscript received March 1, 2015; revised May 11, 2015; accepted May
19, 2015. Date of publication June 1, 2015; date of current version October 16,
2015. The work of S. Pursiainen was supported by the Academy of Finland
(Project 257288). The work of J. Vorwerk and C. H. Wolters was supported by
the Priority Program 1665 of the Deutsche Forschungsgemeinschaft (Project
WO1425/5-1) and by EU project ChildBrain (Marie Curie Innovative Training
Networks under Grant 641652. Asterisk indicates corresponding author.
M. Bauer and H. Köstler are with the Department of Computer Science,
Friedrich-Alexander-University Erlangen-Nürnberg.
* S. Pursiainen is with the Department of Mathematics and Systems Analysis,
Aalto University, Helsinki, Finland, and also with the Department of Mathematics, Tampere University of Technology, 33720 Tampere, Finland (e-mail:
sampsa.pursiainen@iki.fi).
J. Vorwerk and C. H. Wolters are with the Institute for Biomagnetism and
Biosignalanalysis, University of Münster.
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2439282

is to be approximated given the geometry, conductivity distribution, and a primary source current field of the target domain
[1]–[5]. With respect to the current standard in EEG forward
simulation, that is, the boundary element method coupled with
a compartmentwise isotropic and homogeneous volume conductor model [5]–[9], 3-D approaches such as the FEM or the
finite-difference method constitute a substantial improvement,
as they enable modeling of the strongly folded outer brain surface [10], [11], detailed structures of skull compacta and spongiosa [11], [12], and the distinctly anisotropic conductivity of
the white matter [11], [13], [14]. Today, the use of fully realistic 3-D conductivities is accessible even with a standard laptop
or desktop computer, making the FEM attractive regarding any
computational application of EEG. A crucial point in FEM forward simulation is the source current distribution. Namely, the
classical dipole source cannot be directly applied, since the forward problem in its weak form necessitates the divergence of
the source to be square integrable [15].
Several approaches to approximate a dipolar source in the
brain and calculate the resulting potential distribution have been
developed [16], [17], including the reference methods used here:
the St. Venant [18]–[20] and partial integration (PI) approaches
[21], [22]. The St. Venant method approximates a dipole source
via placing monopolar loads on all nodes neighboring the source
position, and in PI, the right-hand side of the potential field
equation is integrated by parts resulting in a nonsingular and
solvable form despite the presence of dipoles. Common to both
methods is that they enable direct approximation of the potential
field via linear finite-element basis functions.
Our study focuses on the accuracy of Whitney (Raviart–
Thomas)-type finite elements as dipole-like source currents introduced and previously studied in [23]–[25]. Whitney basis
functions span a piecewise linear and divergence-conforming
vector field. They are the simplest ones that are mathematically directly compatible with the potential equation, meaning
that their divergence is square integrable. One can use them to
simulate both highly localized dipole-like currents and globally
supported vector fields, which is beneficial regarding realistically modeling current distributions with finite support. Being
composed of first-order polynomials, they are also easily accessible from the implementation point of view.
The objective of this study is a detailed evaluation of the numerical accuracy of the Whitney source model and, in particular,
to find out how it performs in comparison to the St. Venant and
PI approaches. Our study includes analysis for both optimized

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

BAUER et al.: COMPARISON STUDY FOR WHITNEY (RAVIART–THOMAS)-TYPE SOURCE MODELS IN FEM-BASED EEG

sources with regard to location and orientation and arbitrary
ones to enable unbiased comparison to the reference models.
Performance of a source model is investigated both within a
single element as well as in a global scope via relative difference and magnitude measure (RDM and MAG) between a numerical and analytical solution within a four-layer spherical test
domain. The results are evaluated using a statistical approach
[26] in which accuracy and robustness of dipole approximation
are analyzed via box plots covering a wide range for the source
eccentricity, i.e., relative norm of the dipole position within the
brain compartment.
This paper has been organized as follows. Section II describes
the tested source models as well as our experimental setup.
Section III reports the outcome of the numerical experiments
followed by the discussion in Section IV. Finally, the Appendix
includes some essential theoretical background regarding the
Whitney source model.

II. MATERIALS AND METHODS
A. Forward Model
The goal of the EEG forward problem is to predict the (quasistatic) electric potential field u on the surface ∂Ω of the domain Ω, given the symmetric and positive-definite distribution of conductivity tensors σ and the primary current field
JP in Ω. This corresponds to solving the Poisson-type equation ∇ · (σ∇u) = ∇ · JP in Ω equipped with the homogeneous
Neumann boundary condition (σ∇u) · n = 0 on ∂Ω. This equation multiplied by a test function v and integrated by parts yields
the weak form




v(∇ · JP ) dV for all v ∈ H 1 (Ω)

∇v · (σ∇u) dV = −
Ω

Ω

(1)
in which H 1 (Ω) denotes the Sobolev space consisting of functions with all first-order partial derivatives square integrable,
i.e., in L2 (Ω). The weak form has a solution u ∈ H 1 (Ω) that
is unique up to choosing the zero level of the potential if
∇ · JP ∈ L2 (Ω) [3], [15], [27].
Whitney (Raviart–Thomas) basis functions are the simplest
piecewise first-order polynomials that have this property due
to continuous vector field normal component over the element
faces [3], [28], [29]. Consequently, they provide a mathematically rigorous framework for modeling finitely supported source
currents. The reference source models of this paper do not rely
on vector-valued basis functions. Instead, they approximate the
dipolar source by a distribution of electrical monopoles placed
on finite-element nodes in its vicinity. Note that an actual dipole
source does not have a square integrable divergence, meaning that it needs to be modeled asymptotically in a numerical
simulation.
In this paper, the potential distribution is approximated via

the sum uh = N
i=1 zi ψi in which ψ1 , ψ2 , . . . , ψN are linear nodal basis functions belonging to H 1 (Ω). The coefficient
to the solution of the linear
vector z = (z1 , z2 , . . . , zN ) refers

system Az = f with Ai,j = Ω ∇ψj · (σ∇ψi ) dV and with f
denoting a model-specific right-hand side vector.

2649

Fig. 1. Whitney basis function supported on two tetrahedra T 1 and T 2 with
source locations (A)–(D) and resulting synthetic dipole for (D) shown by the
arrow.

B. Whitney-Type Source Model


If the primary current field is a linear sum JP = M
k
k =1 xk w
of Whitney basis functions w
1, w
2, . . . , w
 M , the entries of f are
of the form

M

xk
ψi (∇ · w
 k ) dV.
(2)
fi = −
k =1

Ω

Following from (2), one can write f = Gx, where x =
(x1 , x2 , . . . , xM ) and G is a basis transfer matrix given by
 k ) ψi dV. Based on the solution uh , elecGi,k = − Ω (∇ · w
trode voltages on the surface ∂Ω can be obtained by restricting
uh to those cofficients that correspond to the targeted points
(electrodes), i.e., evaluating Tf = RA−1 f , where R is a restriction matrix. Essential in this procedure is the so-called transfer
matrix T = RA−1 which can be computed by solving a set of
linear systems, one for each electrode [30].
1) Whitney Basis Functions for a Tetrahedral Mesh: In a
tetrahedral mesh, the face-based Whitney basis function w
 is
supported in two adjacent tetrahedra T1 and T2 (see Fig. 1)
sharing the face F . As indicated in the Appendix, one can write
⎧
r4 − r
⎪
⎪
, if r ∈ T1
⎪
⎪
3
V
r4 − r1 
⎪
T 1 
⎨
r − r1
(3)
w(
 r) =
⎪
, if r ∈ T2
⎪
⎪
3
V

r
−

r

T2
4
1
⎪
⎪
⎩
0,
otherwise
in which r1 and r4 are the positions of vertices 1 and 4 in Fig. 1
and VT 1 and VT 2 are the volumes of T1 and T2 , respectively.
That is, the restriction of w
 to a single element is a first-order
polynomial, equivalent to the position vector field transferred
and scaled. The total vector field is zero at vertices 1 and 4
opposite to the face F . Its normal component is continuous on
F and vanishes on all other faces [3], [28], [29].
A basis function w
 is given a synthetic dipole moment

r4 − r1
with q = 1
(4)
w
 dV =
qw =

r4 − r1 
Ω

and position rw = 4i=0 αi ri , i.e., a linear combination of vertices r0 , r1 , . . . , r4 (see Fig. 1). Four different combinations
(A)–(D) for the coefficients α0 , α1 , . . . , α4 suggested in [24]
and listed in Table I are studied. In Fig. 1, the points corresponding to (A)–(D) lie in a respective order on a single line
between the center (A) of the face F and the midpoint (D) of

2650

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

TABLE I
CANDIDATES FOR SOURCE LOCATION [24]
Location

α0

α1

α2

α3

α4

A
B
C
D

1/3
1/5
1/9
0

0
1/5
1/3
1/2

1/3
1/5
1/9
0

1/3
1/5
1/9
0

0
1/5
1/3
1/2

Fig. 2. (Left) To approximate a dipole with an arbitrary orientation, the PBO
method utilizes a minimal symmetric combination of elements including a given
tetrahedron (dark gray) together with those that share a face with it (light gray).
(Right) In case that a very accurate tetrahedralization in the middle of the
gray matter compartment (light gray) has been produced, source locations and
radially inwards-pointing source orientations can be fixed [32], [33].

the line segment between r1 and r4 , i.e.,
(D )

rw

=

1
(r1 + r4 ).
2

(5)

Consequently, point (A) is located where the norm of the vector
field basis function w
 is large, whereas (D) approximates the
focus of the divergence distribution ∇ · w
 that is supported by
the nodal basis functions associated with the nodes r1 and r4
(see [24]). In applications, relevance of these points can vary
whether the source current distribution is handled directly as a
vector field or indirectly via its divergence.
A position-based optimization (PBO) strategy developed for
this study is applied for interpolation of the Whitney sources
[31]. A given dipole with moment (a coordinate vector) p =
(p1 , p2 , p3 ) and location r was approximated via the synthetic
parameters qw  (coordinate vector form) and rw  ,  = 1, 2, 3, 4
that can be associated with the four faces of the tetrahedron
containing r. In order to minimize piling of errors, the task was
to find a solution for the optimization problem
min
c

4


c2 ω2

subject to Qc = p,

(6)

=1

where c = (c1 , c2 , c3 , c4 ) and ω = rw  − r2 is a weighting
coefficient and Q = (qw 1 , qw 2 , qw 3 , qw 4 ). For the convexity of
4
2 2
=1 c ω , the solution of (6) can be obtained via the method
of Langrangian multipliers, which yields the here uniquely solvable linear system

  
 


c
0
D QT
=
(7)
d
p
Q 0
with diagonal matrix D = diag(ω12 , ω22 , ω32 , ω42 ) and an auxiliary multiplier vector d = (λ1 , λ2 , λ3 ). Consequently, the interpolated Whitney sources were formed using eight (the four
nodes of the tetrahedron that contains r and, for each of the
four faces of this tetrahedron the remaining node of the adjacent
tetrahedron, i.e., all nodes of overall five tetrahedra) nodal basis
functions per dipole approximation in a tetrahedral mesh (see
Table III). This minimal symmetric configuration was used to
keep the interpolation as local as possible, which is beneficial
when sources need to be placed in a narrow gray or white matter
layer within a brain geometry (see Fig. 2, right).
Note that in its current context, our Whitney source model can
be generalized to the complete set of piecewise linear tetrahedral
H(div) finite elements: It is valid for all Nédélec’s edge-based
face functions (see formula (15) in the Appendix).

C. Reference Methods
The reference methods give an alternative definition for the
right-hand side of (1).
1) Partial Integration: In the PI approach [21], [22], a dipole
moment p placed at r is approximated by calculating f via the
formula



p
p


∂n Jp · ψi dS
fi = − (∇ · J )ψi dV = J · ∇ψi dV −
Ω

Ω


Jp · ∇ψi dV =

=
Ω


p · ∇ψi |r ,
0,

∂Ω

if r in support of ψi
otherwise
(8)

which follows from the limit formulation of the mathematical
dipole [21], [31]. The boundary term in the above formula vanishes because the primary currents are limited to the cortical
compartment (see Fig. 2). One can see that a dipole located inside a given tetrahedral element results in precisely four nonzero
vector entries, i.e., the number of nodes on which charges are
placed, when the basis functions are linear (see Table III).
2) St. Venant Method: The St. Venant approximation
[18]–[20] of a dipole moment p at r was obtained by
placing monopolar loads m0 , m1 , m2 , . . . , mK at the finiteelement node closest to the source position, r0 , and at nodes
r1 , r2 , . . . , rK sharing an edge with r0 . The net effect of the
monopoles was required to be asymptotically a dipole field via
0=

K


mi

i=0
K

1
mi
p =
(ri − r)
α
α
i=0

0=

K

mi
i=0

α2

[(ri − r) · ej ]2

for

j = 1, 2, 3

(9)

where ej for j = 1, 2, 3 are the Cartesian unit vectors and α
is a suitably chosen reference distance (here α = 20 mm) such
that α > ri − r0 2 for all i. From top to bottom, these equations correspond to conservation of charge, approximation of the
dipole moment, and suppression of higher order moments. For
each simulated dipole, the load vector m = (m1 , m2 , . . . , mK )
was computed via the standard regularized least-squares

BAUER et al.: COMPARISON STUDY FOR WHITNEY (RAVIART–THOMAS)-TYPE SOURCE MODELS IN FEM-BASED EEG

2651

TABLE II
PARAMETERIZATION FOR THE ISOTROPIC FOUR-LAYER SPHERE MODEL
Compartment

Scalp

Skull

CSF

Brain

Outer shell radius (mm)
Conductivity (S/m)

92
0.33

86
0.0042

80
1.79

78
0.33

TABLE III
NUMBER OF FINITE-ELEMENT MESH NODES NEEDED TO MODEL A SINGLE
DIPOLE SOURCE
Source orientation

Whitney

St. Venant

PI

8
2

≈ 27
≈ 27

4
4

free
fixed

procedure given by m = (PT P + λD)−1 PT b, where
⎛ ⎞
⎛
⎞
b1
P1
⎜ ⎟
⎜
⎟
⎟
⎜
⎟
b=⎜
⎝ b2 ⎠ and P = ⎝ P2 ⎠
b3

(10)

P3

Fig. 3. Synthetic source positions for Whitney approach: RDM (top) and
MAG (bottom) for points (A)–(D) as synthetic source positions as shown in
Fig. 1.

−1

with bj = (0, α pj , 0) and
⎛
1
⎜ −1
Pj = ⎜
⎝ α (r1 − r) · ej
α−2 [(r1 − r) · ej ]2

···

1
−1

···

α (rK − r) · ej

···

α−2 [(rK − r) · ej ]2

⎞
⎟
⎟
⎠

(11)
and D = diag(r1 − r2 , r2 − r2 , . . . , rK − r2 ) is a regularization matrix multiplied by the parameter λ > 0 (here
λ = 10−6 ). In a tetrahedral mesh, the number of incorporated
nodes K is usually around 27 (see Table III).
D. Numerical Experiments
The numerical experiments of this study concern a four-layer
head model composed of concentric spherical origin-centric
scalp, skull, cerebrospinal fluid (CSF), and brain tissue compartments with radii and isotropic conductivity values given in
Table II. For such multicompartment sphere models, analytic
solutions exist for the potential of a mathematical point dipole
[34] to validate our numerical results.
A tetrahedral mesh was generated utilizing a constrained Delaunay tetrahedralization approach with maximal tetrahedron
volume of 1.12 mm3 using the software Tetgen [35]. The resulting mesh consists of 801 633 vertices and 4 985 234 elements.
To gather the data, 200 measurement electrodes were distributed regularly over the outer surface of the model. Evaluation of numerical versus analytical solutions will be carried out
at those electrode positions.
For the sources, the following eccentricities are studied: 0.2,
0.4, 0.6, 0.8, and 0.99.
E. Evaluation Method
A simulated potential vector usim ∈ R200 is compared to the
corresponding analytic solution uana ∈ R200 in terms of the

following relative difference and magnitude measures that are
here given on a percent scale:



100 
 uana − usim  (12)
RDM(uana , usim ) =

2 uana 2
usim 2 2



usim 2
MAG(uana , usim ) = 100
−1 .
(13)
uana 2
The first one of these estimates the difference due to positional
and directional inaccuracies between the analytical and numerical dipole approximation (i.e., topography changes), whereas
the latter one measures magnitude discrepancy.
Since the quality of the simulation is known to depend on the
local mesh geometry as well as on the intraelement position, it
is analyzed statistically via a sample of sources as suggested in
[26], including results for the different source eccentricities in
separate box plots. This statistical analysis includes maximum
and minimum, indicated by upper and lower error bars, and
thereby the total range. Furthermore, it includes the interval
between upper and lower quartile, i.e., the interquartile range
(IQR), also known as the spread, which is marked by a box with
a white dash showing the median (see, e.g., Fig. 3). A sample
size of 200 was utilized for each box-plot bar.
F. Implementation Aspects
To compute the EEG electrode voltages efficiently, the transfer matrix approach was applied [30]. Thereby, the large linear
equation system resulting from the finite-element discretization of (1) only had to be solved once for each electrode (not
including the reference electrode) instead of being solved once
per source. The forward solution is then obtained by setting up
the right-hand side vector f and a matrix-vector multiplication

2652

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

between the transfer matrix and f . This can be carried out very
fast for all considered forward approaches, since they all lead
to sparse right-hand sides. The number of nonzero entries in
f is shown in Table III. Consequently, the total forward simulation time was very similar for each tested source model. On
an Ubuntu 11.04 Linux PC with Intel Core i7-2600 3.40-GHz
CPU and 16-GB RAM, the CPU time for computing T for each
electrode (excluding the reference one) was 8.33 s, and for the
St. Venant model and a single dipole, it was 0.5 ms for Tf (including first the computation of f and then the multiplication
to T).
G. Synthetic Source Positions for the Whitney Approach
The first experiment concerns the accuracy of the Whitneytype source model for tetrahedral elements: Points (A)–(D) (see
Fig. 1) are tested as synthetic dipole positions under the condition that the Whitney and analytical test sources are parallel.
The latter is motivated by the fact that sources in the grey matter
compartment are radially inwards-oriented (see [32] and the cat
experiments by Creutzfeldt et al. [33]) as visualized in Fig. 2
(right). Here, our aim is to extend the previously existing knowledge of source positioning [24] as well as to support the current
interpolation experiments in which the positions of the analytical sources do not coincide with the synthetic ones.
H. Comparison of Source Modeling Approaches
In the second experiment, the Whitney source model is compared to the St. Venant and PI reference methods.
1) Fixed Source Positions and Orientations: In the first
phase, the source positions are fine-tuned so that they are optimal for each model: Given a desired position, the St. Venant
method is evaluated at the next node [26], PI approach at the next
tetrahedron barycenter [26], and the Whitney source model at
the closest mesh-based location of type (D). Dipole orientations
are again set to be parallel to the Whitney sources [32], [33]
(see Fig. 2, right), since the reference models do not include a
mesh-based vector field or special directions.
2) Random Source Positions and Orientations: In the second phase, the dipole positions and directions are random, i.e.,
not specifically adapted to a certain model. As the interpolation
method for the Whitney model, we use the PBO approach (see
Section II-B1).
III. RESULTS
A. Synthetic Source Positions for Whitney Approach
Fig. 3 presents RDM and MAG for synthetic source positions
(A) to (D) as shown in Fig. 1. Independently of the source
position and over all eccentricities, the RDM and MAG errors
are below 1.0% and 0.75%, respectively. Errors and their spread
get larger with increasing eccentricity. Overall, the RDM and
MAG results suggest that (D) provides the numerically most
stable approximation to the given dipole.
With regard to RDM (see Fig. 3, top) and eccentricity 0.99,
position (D) results in an RDM median value of 0.17%. From
position (A) to position (D), the IQR is reduced by about 70%.

Fig. 4. Fixed source positions and Orientations: RDM (top) and MAG
(bottom).

With regard to MAG (see Fig. 3, bottom) and eccentricity
0.99, the median values for positions (C) and (D) are nearly
identical, while the IQR for (D) is around 30% smaller than
for (C).
B. Comparison of Source Modeling Approaches
1) Fixed Source Positions and Orientations: Fig. 4 presents
the results for the case of fixed source locations and orientations.
RDM and MAG errors below 1.5% and 1.0%, respectively, indicate that all three approaches produce numerically accurate
results. For all three methods, errors and their spread increase
along with the eccentricity. The Whitney model shows the overall best results.
With regard to the RDM (see Fig. 4, top) and 0.99 eccentricity,
the maximal errors for the Whitney model are below 0.4% (St.
Venant: ≤ 0.7%; PI: ≤ 1.4%) and the median value is at 0.2%
(St. Venant: 0.3%; PI: 0.7%). The Whitney model yields also
the smallest IQR (only 58% and 28% of that of St. Venant and
PI, respectively).
With regard to the MAG (see Fig. 4, bottom)] and 0.99 eccentricity, the maximal errors for the Whitney model are below
0.5% (St. Venant: ≤ 0.5%; PI: ≤ 0.9%) and the median value is
nearly optimal for all three methods. The St. Venant approach
has the smallest IQR (76% and 39% of that of Whitney and PI,
respectively).
2) Random Source Positions and Orientations: In Fig. 5,
RDM and MAG errors for random source locations and orientations are shown. With RDMs and MAGs below 2.0% and 1.3%,
respectively, all three approaches produce again low errors. In
this comparison, the St. Venant model shows the overall best results. Comparing Figs. 4 and 5, one can see that the accuracy of
the Whitney model deteriorates significantly in the case of randomized orientations, when multiple basis functions are utilized

BAUER et al.: COMPARISON STUDY FOR WHITNEY (RAVIART–THOMAS)-TYPE SOURCE MODELS IN FEM-BASED EEG

Fig. 5. Random source positions and orientations: RDM (top) and MAG
(bottom).

to represent a single dipole via the PBO interpolation strategy.
This is particularly obvious for sources with high eccentricity.
The RDM median (see Fig. 5, top) increases along with the
eccentricity for all three models. At 0.99 eccentricity, the maximal error of the St. Venant model is below 1.6% (Whitney:
≤ 1.9%; PI: ≤ 2.0%) and the median value is at 0.6% (Whitney: 0.8%; PI: 0.9%). St. Venant and Whitney yield 0.4% and
PI 0.5% IQR.
With regard to the MAG (see Fig. 5, bottom) and 0.99 eccentricity, the maximal and median error for St. Venant are 1.1%
(Whitney and PI: 1.3%) and 0.1% (Whitney: 0.3%; PI: 0.2%),
respectively. St. Venant also yields the smallest IQR (85% and
59% of that of Whitney and PI, respectively).
IV. DISCUSSION
In this paper, the Whitney (Raviart–Thomas)-type source
model for FEM-based EEG forward modeling was validated
utilizing a four-layered spherical head model. A given dipole
was approximated as a combination of synthetic positions and
dipole moments associated with faces of a single tetrahedron.
The results were compared to two widely used direct FEM
dipole modeling techniques: the St. Venant [16], [18]–[20] and
the PI approach [16], [21], [22].
The results in Fig. 3 indicate that point (D) out of the tested
four positions (A)–(D) performs best as a synthetic source position in terms of both modeling accuracy and reliability. This
suggests that a Whitney basis function can be associated with
a dipole placed at the midpoint (D) of the two nodes r1 and r4
[see Fig. 1 and (5)] that also determine the synthetic dipole moment [see (4)]. Hence, a Whitney source corresponds to two
monopolar loads with opposite sign at locations r1 and r4 ,
i.e., the simplest possible combination to approximate a dipole
with monopolar loads. Moreover, all points (A)–(D) yielded an
appropriate modeling accuracy, which is important knowledge

2653

if the superposition of the Whitney basis functions is treated as a
vector field rather than a set of dipoles, that is, if the location of
a source is estimated, instead of (D), based on where the actual
vector field is strong (see Section II-B1).
Further experiments (see Fig. 4) showed that, in approximation of a dipole with fixed location and orientation given by (5)
and (4), the Whitney model was overall superior compared to
the references. Besides numerical accuracy, another important
aspect is the focality of the source model. Also here, the Whitney is the superior one (two nodes; see Table III), followed by PI
(four nodes) and St. Venant (≈ 27 nodes). From our experience,
numerical accuracy is spoiled if monopoles are positioned closer
than one element layer from the next conductivity discontinuity.
Therefore, if an optimal segmentation and tetrahedralization of
the gray matter compartment following the normal constraint
can be produced, i.e., sources are only allowed to point radially
into the cortex [32], [33] (see Fig. 2, right), then the Whitney
model seems the currently preferable one.
To produce a cortical segmentation and tetrahedralization as
shown in Fig. 2(right) is currently still a challenging task and
the normal constraint can thus not always be recommended.
Therefore, further experiments with random locations and orientations were performed (see Fig. 5). In this case, the numerical
accuracy of the St. Venant approach was slightly superior. However, maximal RDM and MAG errors for all three approaches
were smaller than 2%, indicating that other aspects, e.g., with
regard to practical applicability such as the focality, should be
prioritized. In this aspect, the PI is the best (four nodes; see
Table III), followed by Whitney (eight nodes) and St. Venant
(≈ 27 nodes).
For approximation of arbitrary dipoles in a tetrahedral mesh,
we used the quadratic elementwise PBO interpolation of the
synthetic dipole moments [31]. The PBO method is an improvement to the pseudoinverse interpolation [25], which guarantees a
stable approximation of the dipole moment with a minimal symmetric configuration of four basis functions to allow sources to
be positioned in narrow gray or white matter layers. The more
accurate PBO strategy takes, in addition to the source orientations, also the positions into account [31], as it tries to find a
matching dipole as close as possible to the given position. Since
the PBO algorithm is rather heuristic than implied by the theory
of interpolation, it can be a suboptimal one and accuracies above
the currently already high level in the percent range might be
strived for.
We could, e.g., think of using higher order St. Venant conditions within the Whitney model. Producing a significant improvement to PBO is, however, likely to be difficult, since due
to the lack of degrees of freedom, St. Venant-type conditions
cannot be filled, other than the one for the dipole moment.
Consequently, it seems that the current vector sources can be
improved by including a larger set of basis functions in approximation of a single dipole, so that additional conditions
can be satisfied. Furthermore, the question arises: What would
be an optimal number of basis functions in approximation of
a single dipole for a realistic head model in which conductivity discontinuities affect the source modeling accuracy? Finding an answer necessitates improvement of the current analysis technique relying on analytic solution that exists for a

2654

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

spherical layered head model. An obvious solution would be
to produce an extremely high-resolution reference FEM solution corresponding to a realistic head model, which one can use
for evaluation of different interpolation techniques. In addition
to these aspects, also the order of interpolation, e.g., quadratic
versus cubic, is a central factor affecting the quality of the
results.
Better results can be obtained also by extending the polynomial basis utilized in dipole approximation. This could mean,
for instance, complementing the current Whitney-type sources
with higher order Nédélec elements [28], [29], which would
require also increasing the polynomial order of the potential
field [36] to avoid mapping of the added degrees of freedom to
zero right-hand side vector entries. In such a context, the cost
of the assembly procedure will be significantly larger, such as
in the case of the subtraction approach [15], [16], [37]. The
source modeling methods of this paper can, in contrast, be considered computationally fast as the right-hand side vectors of
the forward problem are sparse due to the linearity of the applied finite-element basis. Moreover, implementation of higher
order elements would require not only technical but also theoretical work, since it is not immediately obvious, for example,
whether and how the additional degrees of freedom can be associated with dipoles or multipoles: the current case of linear
basis functions is special in the sense that it allows a direct
(synthetic) dipole interpretation. The same reasoning further
motivates development of techniques for handling a vector field
independently of the mathematical interpretation of the vector
basis, that is here a set of dipoles. An obvious argument supporting such a future direction is also that real neural sources
have a finite support. Hence, more crucial than approximation
of a single pointwise source can be that of a complete field under a priori knowledge on the neural fiber structure such as the
previously discussed normal constraint.
The Whitney (Raviart–Thomas) model can potentially be
used in any application context where a highly focal source
placement is needed, e.g., in a narrow part of the grey matter regarding both noninterpolated and interpolated modalities.
Of these, the preferable one depends on several factors, such
as the applied inverse methodology. Noninterpolated Whitneytype sources have been applied to EEG inversion previously in
[38]. The use of a tetrahedral mesh is not necessary for the validity of the Whitney approach. The final section of the Appendix
shows how Whitney sources can be defined also for a hexahedral mesh. Based on our preliminary experiments in a regular
hexahedral grid, the differences to the reference approaches are,
however, minor to the tetrahedral case.
Summarizing the above ideas, directions of the future work
can include further development of the divergence conforming
basis functions in the context of EEG source modeling, e.g.,
regarding higher polynomial or interpolation orders. Important
topics related to the interpolation quality include also investigation of the effect of the conductivity jumps within the brain
as well as St. Venant-type conditions applied to vector basis
functions. Additionally, developing methodology for handling
finitely supported divergence conforming source currents as vector fields, e.g., for advanced inversion purposes [38], [39], is an
attractive future objective.

Fig. 6. Two views of a linear Nédélec’s edge-based face function restricted to
a single tetrahedron T . The face F and edge E ⊂ F determining the function
have been visualized with light blue and red (bold line) color, respectively.

APPENDIX
Linear Nédélec’s edge-based face functions span the piecewise linear subspace of H(div) = {w
 |∇ · w
 ∈ L2 (Ω)} for a
tetrahedral mesh [28], [29]. Given face F and edge E ⊂ F , a
single basis function restricted to a tetrahedron T (see Fig. 6) is
of the form
w
 {E ,F ,T } = c{E ,F } ψ{E ,F ,T }

{E ,T }
VT

(14)

where VT is the volume of T , the vector E ,T is the edge opposite
to E, oriented according to the right-hand rule with respect to
E, and ψ{E ,F ,T } is the basis function for the node on F not
belonging to E, restricted to a single tetrahedron. Denoting the
three edges of face F by E1 , E2 , and E3 , a Whitney (Raviart–
Thomas) basis function associated with F can be expressed in
T as the mean
w
 {F ,T } =

1
(w
 {E 1 ,F ,T } + w
 {E 2 ,F ,T } + w
 {E 3 ,F ,T } ).
3

(15)

Hence, Whitney basis functions form a subspace inside the space
of linear edge-based face functions: the former has one degree
of freedom per face, whereas the latter has three. In the current
context, both function bases, however, result in the same dipole
model, which is shown below.
Each linear edge-based face function is supported on two
tetrahedra T1 and T2 sharing the face F as shown in Fig. 1.
Defining
c{E ,F } :=

4
{E ,T 1 } + {E ,T 2 } 

(16)

the synthetic dipole moment is a unit vector given by

qw =


w
 {E , F } dV
Ω

=

c{E , F }
+ c{E , F }

{E , T } VT
{E , T } VT
1
2
1
2
+ c{E , F }
VT 1
4
VT 2
4

= c{E , F }
=

{E , T } 
1
ψ{E , F , T 1 } dV
VT 1
T1
{E , T } 
2
ψ{E , F , T 2 } dV
VT 2
T2

{E , T } + {E , T }
1
2
.
{E , T } + {E , T } 
1

2

(17)

BAUER et al.: COMPARISON STUDY FOR WHITNEY (RAVIART–THOMAS)-TYPE SOURCE MODELS IN FEM-BASED EEG

Fig. 7.

mial with the normal component continuous on the shared face
and zero on all other faces. As dipole position x0 , we chose
the midpoint of S with coordinates (0, 2b , 2c ) in the reference
element (see Fig. 7). Note
 that the synthetic dipole moment for
 dV = e1 . The other coordinate di(20) is given by q = Ω w
rections follow analogously. In a hexahedral mesh, 20 Whitney
basis functions are needed to approximate a dipole.

Two reference hexahedrons.


Here, the fact that T ψ dV = VT /4, i.e., any linear nodal basis function ψ integrated over T equals VT /4, has been used.
Assuming that the vector flux is inbound in T1 and outbound in
T2 , it holds that ∇ψ{E ,F ,T 1 } · {E ,T 1 } = −∇ψ{E ,F ,T 2 } · {E ,T 2 }
= 1, since the linear function ψ{E ,F ,T } grows from zero to one
on a path corresponding to (positive or negative) vector {E ,T 1 } .
Consequently, it follows that the entry of matrix G corresponding to (global) basis functions ψ and w
 is of the form

 ψ dV
Gψ , w = − (∇ · w)
Ω

{E ,T } 
1
ψ dV
VT 1
T1
{E ,T } 
2
∇ψ{E ,F ,T 2 } ·
ψ dV
VT 2
T2

= −c{E ,F } ∇ψ{E ,F ,T 1 } ·
−c{E ,F }
=

s{ψ ,T 1 } −s{ψ ,T 2 }

{E ,T 1 } + {E ,T 2 } 

(18)

in which s{ψ ,T } = 1, if ψ is supported on T , and otherwise
s{ψ ,T } = 0. Using the node indices of Fig. 1, one can write
qw =
Gψ , w =

r4 − r1
r4 − r1 
s{ψ ,T 1 } − s{ψ ,T 2 }
.
r4 − r1 

(19)

Consequently, the Whitney source model of this paper is, in fact,
a general one in the current context of divergence conforming
H(div) vector fields, piecewise linear basis functions and a
tetrahedral mesh. Notice also that (3) follows from the formulae
above, and that the formulation for qw given in [25] simplifies
to the current one due to similarity under scaling.
1) Whitney Elements for a Hexahedral Mesh: A Whitney
basis function of a hexahedral mesh is supported on two adjacent
hexahedra Q1 and Q2 (see Fig. 7) sharing a face and aligned with
coordinate axes. For x-direction, it can be defined as follows:
w
 k (x, y, z)

⎧
2
⎪
⎪
1−
⎪
⎪
⎪
⎨ (a1 − a2 )bc

=
2
⎪
1+
⎪
⎪
(a1 − a2 )bc
⎪
⎪
⎩
0,

x
a1
x
a2

2655


e1 ,

if (x, y, z) ∈ Q1

e1 ,

if (x, y, z) ∈ Q2



(20)

otherwise

where constants a1 > 0, a2 < 0, b > 0, and c > 0 are as in
Fig. 7. The basis function is a piecewise first order polyno-

REFERENCES
[1] E. Niedermeyer and F. L. da Silva, Electroencephalography: Basic Principles, Clinical Applications, and Related Fields, 5th ed. Philadelphia, PA,
USA: Williams & Wilkins, 2004.
[2] M. A. B. Brazier, Computer Techniques in EEG Analysis (ser. Electroencephalography and clinical neurophysiology: Supplement). Amsterdam,
The Netherlands: Elsevier, 1961.
[3] D. Braess, Finite Elements. Cambridge,U.K.: Cambridge Univ. Press,
2001.
[4] C. Wolters et al., “Comparing regularized and non-regularized nonlinear dipole fit methods: A study in a simulated sulcus structure,” Brain
Topography, vol. 12, no. 1, pp. 3–18, 1999.
[5] J. de Munck et al., “EEG & MEG forward modeling,” in Handbook of
Neural Activity Measurement, R. Brette and A. Destexhe, Eds. New York,
NY, USA: Cambridge Univ. Press, 2012.
[6] J. Kybic et al., “A common formalism for the integral formulations
of the forward EEG problem,” IEEE Trans. Med. Imag., vol. 24, no. 1,
pp. 12–18, Jan. 2005.
[7] Y. Ataseven et al., “Parallel implementation of the accelerated BEM
approach for EMSI of the human brain,” Med. Biol. Eng. Comput.,
vol. 46, no. 7, pp. 671–679, 2008.
[8] M. Stenroos and J. Sarvas, “Bioelectromagnetic forward problem: Isolated source approach revis(it)ed,” Phys. Med. Biol., vol. 57, no. 11,
pp. 3517–3535, 2012.
[9] J. Ermer et al., “Rapidly recomputable EEG forward models for realistic
head shapes,” Phys. Med. Biol., vol. 46, pp. 1265–1281, 2001.
[10] K. Wendel et al., “The influence of CSF on EEG sensitivity distributions
of multilayered head models,” IEEE Trans. Biomed. Eng., vol. 55, no. 4,
pp. 1454–1456, Apr. 2008.
[11] J. Vorwerk et al., “A guideline for head volume conductor modeling in
EEG and MEG,” NeuroImage, vol. 100, pp. 590–607, 2014.
[12] M. Dannhauer et al., “Modeling of the human skull in EEG source
analysis,” Human Brain Mapping, vol. 32, no. 9, pp. 1383–1399, 2011.
[13] H. Hallez et al., “Dipole estimation errors due to differences in modeling anisotropic conductivities in realistic head models for EEG source
analysis,” Phys. Med. Biol., vol. 53, pp. 1877–1894, 2008.
[14] D. Güllmar, et al., “Influence of anisotropic electrical conductivity in
white matter tissue on the EEG/MEG forward and inverse solution.
A high-resolution whole head simulation study,” NeuroImage, vol. 51,
pp. 145–163, 2010.
[15] C. Wolters et al., “Numerical mathematics of the subtraction method for
the modeling of a current dipole in EEG source reconstruction using finite
element head models,” SIAM J. Sci. Comput., vol. 30, no. 1, pp. 24–45,
2007.
[16] S. Lew et al., “Accuracy and run-time comparison for differential potential
approaches and iterative solvers in finite element method based EEG
source analysis,” Appl. Numerical Math., vol. 59, pp. 1970–1988, 2009.
[17] T. Medani et al., “Study of modeling of current dipoles in the finite element
method for EEG forward problem,” presented at the Conf. Numerical
Methods Electromagn., Marseille, France, Jul. 2012.
[18] R. Schönen et al., “Dipolabbildung im FEM-Netz, Teil I,” RWTH Aachen,
Arbeitspapier zum Projekt Anatomische Abbildung elektrischer Aktivität
des Zentralnervensystems, Jul. 1994.
[19] H. Buchner et al., “Inverse localization of electric dipole current sources
in finite element models of the human head,” Electroencephalography
Clin. Neurophysiol., vol. 102, pp. 267–278, 1997.
[20] R. Toupin, “Saint-Venant’s principle,” Archive Rational Mechan. Anal.,
vol. 18, no. 2, pp. 83–96, 1965.
[21] Y. Yan et al., “Finite-element model of the human head: Scalp potentials
due to dipole sources,” Med. Biol. Eng. Comput., vol. 29, no. 5, pp. 475–81,
1991.
[22] D. Weinstein et al., “Lead-field bases for electroencephalography source
imaging,” Ann. Biomed. Eng., vol. 28, no. 9, pp. 1059–65, 2000.

2656

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 11, NOVEMBER 2015

[23] O. Tanzer et al., “Representation of bioelectric current sources using Whitney elements in the finite element method,” Phys. Med. Biol.,
vol. 50, pp. 3023–3039, 2005.
[24] S. Pursiainen et al., “Forward simulation and inverse dipole localization
with lowest order Raviart-Thomas elements for electroencephalography,”
Inverse Problems, vol. 27, no. 4, pp. 045003-1–045003-18, 2011.
[25] S. Pursiainen, “Raviart-Thomas -type sources adapted to applied eeg
and meg: implementation and results,” Inverse Problems, vol. 28, no. 6,
p. 065013, 2012.
[26] J. Vorwerk, “Comparison of numerical approaches to the EEG forward
problem,” Master’s thesis, Univ. Münster, Münster, Germany, 2011.
[27] L. Evans, Partial Differential Equations (ser. Graduate studies in mathematics). Providence, RI, USA: Amer. Math. Soc., 1998.
[28] M. Ainsworth and J. Coyle, “Hierarchic finite elements for unstructured
tetrahedral meshes,” Int. J. Numer. Meth. Eng., vol. 58, pp. 2103–2130,
2003.
[29] P. Monk, Finite Element Methods for Maxwell’s Equations. Oxford, U.K.:
Clarendon Press, 2003.
[30] C. Wolters et al., “Efficient computation of lead field bases and influence matrix for the FEM-based EEG and MEG inverse problem,” Inverse
Problems, vol. 20, no. 4, pp. 1099–1116, 2004.
[31] M. Bauer, “Special Finite Elements for Dipole Modelling,” Master’s thesis, Univ. Erlangen-Nuremberg, Erlangen, Germany, 2012.
[32] R. Schmidt and G. Thews, Physiologie des Menschen. Berlin, Germany:
Springer-Verlag, 1990.
[33] O. Creutzfeldt et al., “Influence of transcranial dc currents on cortical
neuronal activity,” Exp. Neurol., vol. 5, pp. 436–452, 1962.
[34] J. de Munck and M. Peters, “A fast method to compute the potential
in the multi sphere model,” IEEE Trans. Biomed. Eng., vol. 40, no. 11,
pp. 1166–1174, Nov. 1993.
[35] H. Si, “TetGen: A quality tetrahedral mesh generator and threedimensional delaunay triangulator,” Weierstrass Inst. Appl. Anal. Stochastic, Berlin, Germany, 2006.
[36] S. Pursiainen, “EEG/MEG forward simulation through h- and p-type finite
elements,” J. Phys.: Conf. Series, vol. 124, no. 1, p. 012041, 2008.
[37] F. Drechsler et al., “A full subtraction approach for finite element method
based source analysis using constrained delaunay tetrahedralisation,” NeuroImage, vol. 46, no. 4, pp. 1055–1065, 2009.
[38] D. Calvetti et al., “Conditionally Gaussian hypermodels for cerebral
source localization,” SIAM J. Imaging Sci., vol. 2, no. 3, pp. 879–909,
2009.
[39] F. Lucka et al., “Hierarchical Bayesian inference for the EEG inverse problem using realistic FE head models: Depth localization and
source separation for focal primary currents,” NeuroImage, vol. 61, no. 4,
pp. 1364–1382, 2012.

Martin Bauer received the M.Sc. degree in computational engineering from the Friedrich-Alexander
University, Erlangen, Germany, in 2012.
He is currently a Research Assistant at the Chair
for System Simulation. His main research interests
include high-performance computing and development of massively parallel algorithms and software
packages, especially in the context of fluid dynamics
simulations using the lattice Boltzmann method.

Sampsa Pursiainen received the M.Sc.(Eng.)
and Ph.D.(Eng.) degrees (mathematics) from the
Helsinki University of Technology (Aalto University since 2010), Espoo, Finland, in 2003 and 2009,
respectively.
He focuses on forward and inversion techniques
of applied mathematics. In 2010–2011, he was with
the Department of Mathematics, University of Genoa,
Genova, Italy, collaborating also with the Institute for
Biomagnetism and Biosignalanalysis, University of
Münster, Münster, Germany. He has been a Postdoctoral Researcher of the Academy of Finland (257288) in 2012–2015. In 2015, he
continues his work as an Assistant Professor at the Department of Mathematics,
Tampere University of Technology, Tampere, Finland.

Johannes Vorwerk received the M.Sc. degree in
mathematics with a minor in physics from the University of Münster, Münster, Germany, in 2011. Since
then, he has been working toward the Ph.D. degree
at the Institute for Biomagnetism and Biosignalanalysis, University of Münster.
His research interests include EEG/MEG source
localization with a focus on solving the EEG/MEG
forward problem using FE methods and tCS
optimization.

Harald Köstler received the Ph.D. degree in parallel multigrid methods in medical image processing in
2008.
He is currently a Researcher at the Chair for System Simulation, Erlangen, Germany. His research interests include software engineering concepts for simulation software on HPC clusters, multigrid methods,
and programming techniques for parallel hardware,
especially GPUs.

Carsten H. Wolters received the M.Sc. degree in
mathematics with a minor in medicine from the
RWTH Aachen, Aachen, Germany, the Ph.D. degree in mathematics from the University of Leipzig,
Leipzig, Germany, and the Habilitation in mathematics from the University of Münster, Münster,
Germany, in 1997, 2003, and 2008, respectively.
From 1997 to 2004, he was with the Max Planck
Institutes for Human Cognitive and Brain Sciences
and Mathematics in the Sciences, Leipzig, Germany.
In 2004, he joined the Scientific Computing and
Imaging Institute, University of Utah, Salt Lake City, UT, USA. Since 2005, he
has been a Research Associate with the Institute for Biomagnetism and Biosignalanalysis (IBB), University of Münster, Münster, Germany. Since 2008, he
has been heading the research group “Methods in Bioelectromagnetism” at IBB.
His research interests include the field of neuroscience with a focus on reconstructing and manipulating neuronal networks in the human brain.

