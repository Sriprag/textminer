2308

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Monte Carlo Investigation of Optical Coherence
Tomography Retinal Oximetry
Siyu Chen, Student Member, IEEE, Ji Yi, Wenzhong Liu, Student Member, IEEE, Vadim Backman, and Hao F. Zhang∗

Abstract—Optical coherence tomography (OCT) oximetry explores the possibility to measure retinal hemoglobin oxygen saturation level (sO2 ). We investigated the accuracy of OCT retinal
oximetry using Monte Carlo simulation in a commonly used fourlayer retinal model. After we determined the appropriate number
of simulated photon packets, we studied the effects of blood vessel
diameter, signal sampling position, physiological sO2 level, and the
blood packing factor on the accuracy of sO2 estimation in OCT
retinal oximetry. The simulation results showed that a packing factor between 0.2 and 0.4 yields a reasonably accurate estimation
of sO2 within a 5% error tolerance, which is independent of vessel diameter and sampling position, when visible-light illumination
is used in OCT. We further explored the optimal optical spectral
range for OCT retinal oximetry. The simulation results suggest
that visible spectral range around 560 nm is better suited than
near-infrared spectral range around 800 nm for OCT oximetry to
warrant accurate measurements.
Index Terms—Monte Carlo simulation, optical coherent tomography, retinal oximetry.

I. INTRODUCTION
EMOGLOBIN oxygen saturation (sO2 ) is an essential
physiological parameter involved in the pathophysiology
of various retinal diseases, including retinitis pigmentosa, diabetic retinopathy, and glaucoma [1]–[3]. It has been reported
that aberrant retinal sO2 is present before the onset of noticeable
visual degradation and can be aggravated during the disease progression [4]. Thus, measuring retinal sO2 can be invaluable in
clinical applications as a potential biomarker for early diagnosis
and prediction of several retinal diseases.
Numerous attempts have been made to achieve noninvasive
label-free measurement of retinal sO2 . The most promising
ones are based on the distinct optical properties of oxygenated
hemoglobin (HbO2 ) and deoxygenated hemoglobin (HbR) [5].
Since the two molecules have characteristic optical absorption
spectra, their relative abundances can be determined optically,
which, in turn, are used to estimate sO2 [5]. The current approach being used for clinical applications is multiwavelength

H

Manuscript received October 24, 2014; revised January 14, 2015 and March
11, 2015; accepted April 15, 2015. Date of publication May 4, 2015; date of
current version August 18, 2015. This work was supported in part by National Institute of Health Grants 1R01EY019951 and 1R24EY022883, and National Science Foundation Grants CBET-1055379, CBET-1066776, and DBI-1353952. J.
Yi is supported in part by a postdoctoral fellowship award from the Juvenile
Diabetes Research Foundation. Asterisks indicates corresponding author.
S. Chen, J. Yi, W. Liu, and V. Backman are with Northwestern University.
∗ H. F. Zhang is with the Department of Biomedical Engineering, Northwestern University, Evanston, IL 60208 USA and also with the Department
of Opthamology, Northwestern University, Chicago IL 60611 USA (e-mail:
hfzhang@northwestern.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2015.2424689

fundus ophthalmoscopy [6]–[8]. In this approach, multiwavelength illumination is integrated into a conventional fundus imager, offering a convenient cost-effective solution of measuring
retinal sO2 level. However, this diffusive backscattered-lightbased imaging method lacks depth resolution, which leads to
inaccurate sO2 estimation under the influences of vessel size
and retinal pigmentation [5], [9]–[11].
Another approach, photoacoustic ophthalmoscope (PAOM),
has been proposed to measure retinal sO2 . PAOM detects laserinduced ultrasonic waves generated from the light absorption
by chromophores, yielding sensitivity to spectral-dependent absorption differences between HbO2 and HbR. The technique
offers 3-D mapping of retinal vasculature and is less vulnerable
to optical scattering in tissues [11], [12]. However, the PAOM
requires physical contact between the ultrasonic transducer and
the eye, which makes its clinical adoption challenging.
Retinal oximetry based on optical coherence tomography
(OCT) was also recently explored [13]. OCT, being regarded
as the “gold standard” in ophthalmic imaging, can provide 3-D
imaging of both retinal structure and functions at a microscopic
scale. The advantage of OCT retinal oximetry is its 3-D imaging
capability, allowing spectroscopic information to be extracted
from selected localized regions [14]. Using a broadband lowcoherence light source, OCT signals intrinsically contain spectroscopic information from tissue and, thus, have the potential
to quantify sO2 based on the spectral differences in the optical properties of HbO2 and HbR. Several experiments using
near infrared (NIR) light OCT have been attempted, showing
that artery and venous blood have a different attenuation curve
within selected OCT spectra [14]–[17]. However, no quantitative sO2 value was reported in vivo. Recently, several studies
suggested that OCT working within visible-light spectral range
could achieve improved accuracy in quantifying sO2 in vitro
[18], [19]. Furthermore, Robles et al. demonstrated sO2 measurement in an intravital system [20], and Yi et al. implemented
visible-light OCT to measure sO2 in rat retina, showing a great
promise for in vivo oximetry [13].
Although OCT oximetry has shown great potential, several
uncertainties need to be thoroughly investigated for accurate
sO2 measurement before OCT retinal oximetry can be successfully translated into clinics. First, it is not clear how to extract
OCT signals from the imaged retinal vessels to analyze optical absorption properties from the backscattered OCT signals.
Biological tissues, including whole blood, are highly optically
scattering media and will lead to multiple scattering of the OCT
probing light. A photon that goes through multiple scattering
may have different accumulative optical path length from its
penetration depth, which leads to inaccurate localization, image
blurring, and signal reduction [21].

0018-9294 © 2015 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

CHEN et al.: MONTE CARLO INVESTIGATION OF OPTICAL COHERENCE TOMOGRAPHY RETINAL OXIMETRY

Second, it is not clear which spectral band is optimal for OCT
retinal oximetry. Currently, two spectral bands of light sources
(NIR and visible) have been reported for OCT oximetry. While
the majority of clinical systems use NIR OCT for its deeper
penetration depth and less phototoxicity, visible-light OCT has
the advantage of higher axial resolution and, arguably, a better
contrast between HbO2 and HbR [5], [22], [23]. Since the molar
extinction coefficients of HbO2 and HbR behave dramatically
differently in these two spectral bands, it is worthwhile to investigate which spectral region can offer better accuracy in OCT
oximetry.
We adopted a Monte Carlo approach to investigate the effects
of the aforementioned factors on the accuracy of OCT oximetry. Monte Carlo simulation is a statistical numeric method to
identify approximated solutions of stochastic processes. This
method is often used to study light-tissue interactions, where
finding analytic solutions is technically challenging. Although
Monte Carlo simulation does not usually track phase information of photons, the feasibility of Monte Carlo simulation of
OCT was demonstrated by several groups [24]–[26]. By simulating the behavior of photon packets traveling across different
layers and blood vessels in the retina, we can achieve a numerical approximation of spectrometric OCT signals.
In this paper, we first constructed our Monte Carlo simulation
algorithm using a layered eye model. To investigate the accuracy
of retinal OCT oximetry under physiological and pathological
complexities, we varied the blood vessel diameter and OCT
signal sampling position in our simulation, and compared the
calculated sO2 with the preset values. We also investigated the
effect of the packing factor (a scaling coefficient taking into
account the scattering changes due to the densely packed blood
cells) on the sO2 estimation accuracy. To further verify the
numerical simulation results, we apply the same analysis procedure on the packing factor using in vivo animal experiment
data. Finally, we compared the performances of OCT oximetry
between NIR and visible spectral bands.
II. METHODS AND MATERIALS
A. Eye Model
We used a 3-D four-layer model to mimic the posterior ocular
structure in our Monte Carlo simulation. The overall geometry
is shown in Fig. 1(a). The four layers include retina, retinal pigment epithelium (RPE), choroid, and sclera [27]. The respective
thicknesses of these layers are 200, 10, 250, and 700 μm as
reported in the literatures [see Fig. 1(b)] [11], [27]. The lateral
boundary of each layer extended to infinity during the simulation. It has been shown that this simplified model is sufficient for
retinal photon-tissue interaction simulation since other posterior
ocular tissues (such as vitreous humor) are either relatively thin
or optically transparent [11], [28].
We placed an infinitely long cylindrical blood vessel segment
in the retina in parallel to the surface [see Fig. 1(a)]. The vessel
diameter was varied from 40 to 160 μm to study the effect of
vessel size [29]. Inside the blood vessel, we assumed that blood
is optically homogeneous. The vessel wall thickness was set to

2309

Fig. 1. Simplified eye model used in the simulation study. (a) Schematic
diagram of a human eyeball. (b) Dimensions and relative positions of the layers
and the blood vessel being simulated (not to scale).

TABLE I
OPTICAL PROPERTIES OF OCULAR TISSUE IN THE MONTE CARLO SIMULATION
Wavelength range [nm]

Retina

RPE

Choroid

Sclera

Blood vessel

μa [cm−1 ]
μs [cm−1 ]
g [-]
μa [cm−1 ]
μs [cm−1 ]
g [-]
μa [cm−1 ]
μs [cm−1 ]
g [-]
μa [cm−1 ]
μs [cm−1 ]
g [-]
μa [cm−1 ]
μs [cm−1 ]
g [-]

Visible (520–610)

Near infrared (750–840)

5
319
0.97
938
1068
0.84
224
711
0.94
4
966
0.90
9
284
0.84

1
224
0.97
385
1469
0.84
27
484
0.94
0.4
614
0.90
2
140
0.84

be 10% of the lumen diameter [30]. The optical properties of
solid tissues, including absorption coefficient μa [cm–1 ], scattering coefficient μs [cm–1 ], and anisotropy g [dimensionless],
can be found in the literatures [31], [32]. We treated these optical properties as constant values inside each simulated spectrum
band despite their slight wavelength dependency (see Table I).
The manipulation is compatible with major oximetry algorithms
to date, which do not consider the wavelength-dependent optical attenuation caused by tissues other than blood [5], [9], [13].
In addition, the optical sectioning ability of OCT allowed us
to separate the backscattered signals originated from blood and
other tissues. The exact way of how light propagates in deeper
ocular tissues will not affect the OCT signal extracted from the
blood vessels above, and thus will not affect the subsequent calculation of sO2 . However, we still modeled these layers for the
completeness of the simulation.
The manipulation is also valid due to the fact that the variation in optical properties of these solid tissues are limited inside each of the simulated spectrum band (520–610 and 750–
840 nm) [31], [32]. When compared with the drastic fluctuations
in whole-blood optical properties, the merely 15% variations
found in these non-blood retinal tissues can be neglected. We
will discuss the details of absorption and scattering properties
of whole blood in the next section.

2310

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

B. Absorption and Scattering Properties of Whole Blood
The absorption coefficients of the whole blood within the
simulated spectral ranges were calculated by [33]
μa = 2.3 × [HbT] ×

εHbO 2 × sO2 + εHb × (1 − sO2 )
(1)
WHbR

where [HbT] [g/L] is the concentration of total hemoglobin;
εHbO 2 [cm-1 · L/Mole] and εHb [cm–1 · L/Mole] are the molar
extinction coefficient of oxyhemoglobin (HbO2 ) and HbR, respectively; sO2 [dimensionless] is the hemoglobin oxygen saturation, which was predefined before each simulation within the
physiological range from 0.4 to 0.98 [34]; WHbR is the molecular weight of the hemoglobin, which is 64 500 [g/Mole]. The
absorption coefficients of fully oxygenated μa OxyB and deoxygenated μa DeOxyB whole blood can be obtained using a sO2
value of 1 and 0 in (1), respectively.
Because of the interrelationship between the optical absorption and scattering coefficients, the spectrum of scattering coefficient of the whole blood also depends on sO2 . Using the
method reported in [35], we calculated the scattering coefficients of oxygenated μs OxyB and deoxygenated μs DeOxyB
whole blood based on Mie theory assuming that particles scatter light independently in whole blood. The results we obtained
showed similar spectral shape to what was previously reported
but with considerably larger values [36]–[38]. The reason is that
when the erythrocytes are densely packed as in whole blood, optical scattering from blood cells are no longer independent. A
scaling coefficient was needed to connect the independent and
dependent scattering coefficients. We referred to this hematocritdependent scaling coefficient as packing factor W [dimensionless]. The relationship between hematocrit H [dimensionless]
and W within the simulated spectral regions can be approximated using the relationship [38]
W = (1 − H)2 .

(2)

Based on normal physiological value of H = 0.45, a packing
factor W = 0.3 was used to scale the spectrum. Finally, the
expression for the sO2 -dependent scattering coefficient of whole
blood is
μs = W · μs

× (1 − sO2 ) .
(3)
We also derived the anisotropic factor g of whole blood from
the Mie theory [38]. The calculated results showed that the
variation of g was always less than 0.3% in each of the simulated
spectral range, which is within the error margin of our simulation
algorithm. As a result, we used the mean value of g within each
simulated spectral band, which greatly improved the efficiency
of computation. We used g = 0.988 for visible-light spectral
range and g = 0.982 for NIR spectral range.
OxyB

× sO2 + W · μs

DeOxyB

C. Monte Carlo Simulation
The Monte Carlo simulation algorithm was revised from
Wang’s MCML program [24]. Fig. 2 shows the flowchart of
our simulation. At each optical wavelength, we first initialized
the absorption and scattering coefficients of blood and ocular tissue accordingly. Then, a photon packet with unit initial weight

Fig. 2.

Simulation flowchart of OCT oximetry.

was launched and traced. The initial propagation direction of
the photon packet was set based on the current A-line location,
and was scaled to a fraction of total scanning angel of ±1.0°.
The path length and energy deposition of the photon packet at
every scattering event site were recorded. Once a photon packet
exited the tissue boundary or its weight was sufficiently small
(< 0.0001) and did not survive the roulette test, the tracing was
terminated [24]. To speed up the simulation, we monitored the
path length of each photon packet and terminated tracing once
it traveled well beyond (100 μm below the retina layer) the
depth of interest. Since OCT signal is depth resolved and photon packets backscattered from deeper regions do not contribute
much to the simulated OCT signals from the blood vessel, the
speeding process did not affect our final results [25], [39]. Once
a photon packet exited the tissue from the upper surface, we
compared the exiting position and angle of emergence with its
incidence position. If the photon packet falls into a collection
angle of 4.2°, which equals to a numerical aperture (NA) of 0.1
for tissue with a refractive index n = 1.38, the weights and path
length of this photon packet were recorded for OCT image construction and sO2 estimation. Otherwise, the photon packet was
discarded (undetected) and a new iteration started. This cycle
continued until we reached a stable outcome. The simulation
was executed on a workstation equipped with Intel Xeon E5645
CPU at 2.40 GHz and 24 GB of memory. It took roughly 30 min
to generate one A-line consisting of 4 million photons. Parallel computing technique was implemented. The generation of a
single wavelength B-scan with 128 A-lines took about 10 h.
To simulate the wideband light used in OCT, we ran the simulation for multiple wavelengths. For visible spectral range, the

CHEN et al.: MONTE CARLO INVESTIGATION OF OPTICAL COHERENCE TOMOGRAPHY RETINAL OXIMETRY

TABLE II
OPTICAL PROPERTIES OF WHOLE BLOOD IN THE MONTE CARLO SIMULATION
λ [nm]

Visible

Near
infrared

μa O x y B
[cm−1 ]
520
525
530
535
540
545
550
555
560
565
570
575
580
585
590
595
600
605
610
750
755
760
765
770
775
780
785
790
795
800
805
810
815
820
825
830
835
840

121.0
150.7
189.4
224.0
241.9
234.0
204.1
174.0
160.8
172.9
210.3
244.0
224.8
150.7
77.9
36.9
18.5
10.8
7.8
2.7
2.9
3.0
3.2
3.4
3.5
3.7
3.8
3.9
4.1
4.2
4.4
4.5
4.6
4.7
4.9
5.0
5.2
5.3

μa

[cm−1 ]

μs O x y B
[cm−1 ]

152.6
168.1
185.0
201.3
217.4
233.0
244.7
249.1
244.6
230.3
211.6
193.4
176.9
160.6
136.6
104.7
77.2
60.6
48.3
7.3
7.9
7.9
7.4
6.7
6.1
5.5
5.0
4.6
4.2
3.9
3.8
3.7
3.6
3.6
3.6
3.6
3.6
3.6

3626.3
3547.2
3459.0
3387.4
3353.1
3365.5
3407.4
3436.1
3427.1
3373.5
3289.4
3238.0
3291.1
3415.2
3504.6
3527.5
3513.4
3485.3
3452.7
2653.2
2628.3
2603.7
2579.4
2555.3
2531.5
2508.0
2484.8
2461.8
2439.1
2416.5
2394.0
2372.1
2350.4
2328.9
2307.6
2286.6
2265.8
2245.3

D eO xyB

μs

Once we obtained the spectrum, we recovered sO2 using the
following model to fit the spectrum of reflected intensity [40]:
I = I0 · r · exp (−2d · μt

D eO xyB

[cm−1 ]
3396.6
3339.5
3283.0
3230.1
3180.6
3136.1
3103.3
3085.9
3085.1
3097.8
3112.0
3121.5
3126.7
3132.4
3150.2
3172.7
3178.0
3163.6
3144.2
2366.0
2341.9
2319.1
2296.9
2274.8
2252.8
2230.9
2209.1
2187.5
2166.1
2144.6
2123.2
2102.3
2081.7
2061.3
2041.1
2021.2
2001.6
1982.2

wavelength band covers from 520 to 610 nm; for NIR spectral
range, the bands covers from 750 to 840 nm. We sampled the
broad band spectrum at a 5 nm interval. At each sampled wavelength, the optical properties were averaged from the neighbor
±5 nm wavelength range. The exact unscaled values of μa OxyB ,
μa DeOxyB , μs OxyB , and μs DeOxyB used in the simulation are
summarized in Table II.
The stated process allowed us to generate the wavelengthdependent photon distribution inside the medium, analogous to
OCT B-scan images.

D. Estimating sO2 Value
In order to obtain the sO2 -dependent backscattered intensity
spectrum, we sampled each simulated OCT B-scan within a
rectangular region of interest (ROI). The dimensions of the ROI
were 3 and 20 μm along the lateral and axial directions, respectively. We varied the depth position of the ROI within the vessel
to examine the effect of sampling position on the accuracy of
sO2 estimation.

2311

− 2d · μt

DeOxyB

OxyB

· sO2

· (1 − sO2 ))

(4)

where I0 [arb. u.] is the intensity of incident light; d (cm) is the
vessel diameter; r (dimensionless) is the reflectance from the
vessel wall. The spectrum of r can be expressed by a power law
r (λ) = Aλ−α under the first Born approximation, where A is a
constant [41], [42]. μt OxyB [cm–1 ] and μt DeOxyB [cm−1 ] are
the compound attenuation coefficients of fully oxygenated and
fully deoxygenated whole blood, respectively. The compound
attenuation coefficient spectrum of μt OxyB and μt DeOxyB were
obtained as the linear combination of the absorption coefficients, scattering coefficients, and the packing factor of whole
blood [43]

μt

+ W · μs

OxyB

= μa

OxyB

DeOxyB

= μa

DeOxyB

μt

OxyB

+ W · μs

DeOxyB .

(5)

After applying a logarithm operation to both sides of (4) and
expanding r (λ), we have
 
I
ln
= 2d [sO2 · (−μt OxyB + μt DeOxyB ) − μt DeOxyB ]
I0
+ ln (A) − α · ln(λ)

(6)

which is a function of λ. Based on the notion that sO2 cannot be
less than zero or greater than one, a constrained least-squares
fitting can be performed to estimate sO2 , d, ln(A), and α. The
value of I was obtained by summing all photon packets’ weights
reflected back from the ROI. I0 was calculated by sampling and
averaging the backscattered intensity in a region immediately
above the blood vessel. The dimension of the region was the
same as the ROI for calculating I.
III. RESULTS
A. Stability
To verify our Monte Carlo code, we compared results from
both our program and the MCML using the same eye model
described above but without the embedded blood vessel. The
optical properties of the tissue were selected for 610 nm. The
two simulation results agreed with each other very well (data
not shown). Fig. 3(a) is a whole OCT B-scan image simulated
using our algorithm rendered in logarithmic scale. The layered
anatomic structures of retina, RPE, and the blood vessels can be
clearly identified in the simulated imaging and are identical to
our eye model.
To determine the optimal number of simulated photon packets, we performed a stability test by varying the number of
simulated photon packets from 0.5 to 5 million per A-line. We
recorded and localized the back-scattered energy, and the mean
intensity of an area 3 μm × 20 μm (lateral×axial) at the bottom
of the blood vessel was calculated. Blood sO2 was fixed at 70%
and vessel diameter was fixed at 100 μm. We plotted the mean
values and the standard deviations of the ten simulations against

2312

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

Fig. 3. (a) Sample-simulated depth-resolved broadband OCT B-scan image.
(b) Stability test of backscattered OCT signal intensity Ib on different simulated
photon packet numbers per scan line. (c) Estimated sO2 value versus packing
factor W range. The red box showed the real experiment result adopted from
Ji et al. The black line is the Monte Carlo simulation result. The blue-dashed
line indicates the preset sO2 of 0.7. Exp: experimental data. Sim: data points
simulated by the Monte Carlo method.

their corresponding number of photon packets in Fig. 3(b). The
mean value of the reflected energy does not fluctuate with increased photon packet number. The standard deviation decreases
with increased number of photon packets, which indicates the
simulation gives more stable results with more simulated photon packets. When the number of photon packets exceeded four
million per A-line, the standard deviation remains unchanged,
indicating that we have reached a stable simulation. Based on
the stability test, we chose a total photon packet number of four
million per A-line, which should give us both robust simulation
results and optimal simulation performance.
B. Packing Factor W
When we composed the total attenuation spectra to retrieve
sO2 , the choice of an appropriate W becomes critical for accurate sO2 estimation. Since W depends on hematocrit that varies
among individuals, its true value is not always available in clinical applications. As a result, it is important to evaluate the
influence of W on the accuracy of sO2 estimation and to identify
an optimal W value. After we obtained the spectra from the bottom of the blood vessel, we estimated the sO2 values using W
values from 0 to 1 with a 0.1 increment. The simulated results
are shown in Fig. 3(c). As can be seen from the curve, the fitted
sO2 reaches a plateau when W is between 0.2 and 0.4 and leads
to an sO2 estimation within 5% error range from the preset value
of 0.7. An underestimation of 5% to 10% can be found when we
used a W value less than 0.2. The accuracy of sO2 estimation
deteriorated quickly as we increased W beyond 0.4. Within this
range, significant underestimation over 20% can be found.
To verify the selected range of W, we examined sO2 estimation using in vivo experimental data from rat eyes. The optical

properties of rat blood were considered to be similar to that of
human blood. The detailed description of the experimental procedures can be found in [13]. Briefly, we performed OCT imaging on wild-type Long Evans rat in vivo. The animal was anesthetized using 1.5% isoflurane mixture with oxygen/nitrogen
compound gas similar to normal air. We placed the animal securely on a holder for imaging purpose. Before imaging, we
applied 0.5% Tetracaine hydrochloride ophthalmic solution for
local eye anesthesia and 1% Tropicamide ophthalmic solution
for pupil dilation.
We used a homemade OCT system working within the
visible-light spectral range. The illumination spectrum centered
at 585 nm and had an 85 nm bandwidth. We acquired the three
dimensional retina OCT image by raster scanning the optical
illumination at 25-kHz A-line rate. The image consisted of 256
B-scans, where each B-scan had 256 A-lines. The 2-D scan
covered an area of about 2 mm × 2 mm. During experiments,
the inhalation gas compound was deliberately controlled and
the arterial sO2 was monitored to be exactly 0.7 by a pulse
oximeter attached to the rat’s rear feet. All experimental procedures were approved by the Northwestern University IACUC
and conformed to the Association for Research in Vision and
Ophthalmology Statement on Animal Research.
We recovered depth-resolved spectroscopic fundus image by
using a series of short-time Fourier transforms [13]. We averaged the signals along the center axial of each blood vessel
to improve SNR and improve estimation accuracy. Then, we
extracted the backscattering spectrum in the same manner as
we used in the simulation, i.e., from a rectangular ROI at the
very bottom of the blood vessel manually. The spectrum was
normalized by the reference spectrum. We applied the same
least-squares algorithm as in simulation to extract sO2 information in order to study the impact of empirical choice of W value
from 0 to 1.
We plotted the experimental results against our simulation
results in Fig. 3(c). The two results are compatible with each
other. The comparison suggested that a W between 0.2 and 0.4
should be used. In addition, the choice of W should be compatible with the physiological value of blood hematocrits H, whose
value normally varies from 40% (in women) to 45% (in men)
in systemic circulations. Even lower values may be encountered
in smaller vessels such as in the retina [44]. Combining these
factors, we chose the lower value of 0.4 for H, which results a
packing factor W = 0.36.
C. Accuracy of sO2 Estimation
We first examined how the selected sampling ROI location
affects sO2 estimation. The first sampling position was placed
at the center of the blood vessel. The second sampling position was placed near the bottom of the blood vessel, with the
lower boundary of the region nearly overlapped with the posterior wall of the vessel [see Fig. 4(a)]. The same dimension
was used for both sampling ROIs and the vessel diameter was
fixed at 100 μm. We changed the preset sO2 value from 0.4
to 0.98 and compared them with estimated sO2 values from
OCT oximetry. The comparison between the estimated sO2 and

CHEN et al.: MONTE CARLO INVESTIGATION OF OPTICAL COHERENCE TOMOGRAPHY RETINAL OXIMETRY

2313

Fig. 4. (a) Influence of ROI sampling position on sO2 estimation. The ROI
positions were placed near the bottom of the vessel (highlighted by red box
“BT”) or at the center of the vessel (highlighted by blue box “MD”). The
estimated sO2 are plotted against the true value (black solid line), where the
red square represents data calculated by sampling near the bottom and the blue
circle for sampling at the center of the vessel, respectively. (b) Influence of
vessel diameter on sO2 estimation. The preset sO2 value was 70% (blue-dashed
line). The ROI sampling position was near the bottom of the vessel. Sim: data
points simulated by the Monte Carlo method.

preset sO2 values is shown in Fig. 4(a). As the figure indicates,
the estimated value and the preset value show strong positive
correlation (R2 = 0.99), and the deviation from the preset values is always constrained within a 5% error range. In addition,
no significant difference was found between the two sampling
ROI locations (BT and MD) and we selected BT ROI in the rest
of our simulation.
We also evaluated the influence of blood vessel diameter on
the accuracy of sO2 estimation. Blood vessel diameter, a highly
variable parameter [45] in a normal eye, can potentially affect
the accuracy of OCT oximetry in a profound manner [5], [11].
Based on anatomical findings, we simulated the vessel diameter
from 40 to 160 μm [29] with a 20 μm increment to investigate the
influence of vessel diameter on OCT oximetry. The blood sO2
level was set to 0.7, which is close to the physiological value of
venous blood. We chose this specific value because variations
in venous blood sO2 are of greater interests to physicians. It
was reported that during early pathological progress, retinal
venous sO2 showed greater changes, while arterial sO2 remains
unchanged [8], [46].
The simulation result of vessel diameter influence is shown in
Fig. 4(b). No statistically significant difference was seen among
the estimated sO2 values within the simulated range of vessel diameters. However, a gradually descending trend can be observed
as the vessel diameter increases. A careful examination on the
simulated data revealed that the detected energy was extremely
low due to higher optical absorption and scattering experienced
inside the blood when vessel diameter increases. The deteriorated SNR caused underestimation in our least-squares fitting
algorithm.
D. Influence From OCT Spectral Range
Currently, two spectral ranges (NIR and visible-light) were
tested for OCT oximetry [13], [14], [16], [17], [19]. As both
scattering and absorption properties of blood are drastically
different between these two spectral bands, we carried out simulations in each band to assess their respective accuracies in sO2
measurement.
The simulated spectral range for NIR OCT was from 750
to 840 nm, with a center wavelength at 795 nm. The selected

Fig. 5. Compound attenuation coefficient μ t and Monte Carlo simulation
results of NIR and visible light OCT intensities. The μ t spectra of fully oxygenated, fully deoxygenated, and 70% oxygenated blood at NIR and visible
spectral ranges are shown in (a) and (b), respectively. The spectra of normalized
reflected intensities sampled at NIR and visible spectral ranges, are shown in
(c) and (d), respectively. The solid line indicates the fitted curve calculated by
least-square fitting.

range is slightly shorter than the spectral range currently being
used in NIR OCT systems because we wanted to include the
isosbestic point at 797 nm, which created maximum stability in
inverse calculation of sO2 [5], [38]. The diameter of the blood
vessel was fixed at 100 μm and the sO2 was set at 0.7. For comparison, the compound attenuation coefficient spectra of fully
oxygenated blood, deoxygenated blood, and the corresponding
value of whole blood at 70% sO2 level was shown in Fig. 5(a)
and (b) for the simulated NIR and visible spectral ranges, respectively. We can clearly see that the spectra of HbO2 and HbR
are almost in parallel within the NIR spectral region.
For OCT oximetry, we used W = 0.36 as mentioned above
for both NIR and visible spectral ranges. Within the simulated
NIR range, the least-squares fitting algorithm was ill-posed as
the two inputs were almost linear dependent [see Fig. 5(a)]. We
attempted to solve the coefficients in (6) using the same leastsquares fitting algorithm as we used for the visible spectral
range. But the algorithm failed to converge. The algorithm gave
us infinitely many solutions that could reproduce exactly the
same solid fitting curve in Fig. 5(c). As a result, converged sO2
estimation cannot be established. On the other hand, the leastsquares fitting algorithm converged nicely within the simulated
visible spectral range, resulting a sO2 = 0.69 ± 0.027, as shown
in Fig. 5(d).
IV. DISCUSSION AND CONCLUSION
In this paper, we demonstrated that OCT oximetry is able
to measure blood sO2 with a high accuracy within the simulated visible-light spectral range. The simulation results showed
that the estimated sO2 values are consistent with the predefined
values varied from 0.4 to 0.98 at various vessel diameters. We
also observed one exception in the simulated OCT oximetry:
increasing vessel diameter causes decreased SNR and underestimation of sO2 . We believe this effect was majorly caused by the

2314

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 62, NO. 9, SEPTEMBER 2015

limitation of the least-squares fitting algorithm used. A more robust fitting algorithm will enhance the estimation accuracy and
avoid such situations.
In addition, we included parameter α in our least-squares fitting to compensate for the tissue (i.e., vessel wall) scattering
background that is governed by the local refractive index fluctuation [42], [47]. The values of α in the various tissue types have
been previously characterized to be ∼1 with variations around
±0.2 [41]. Because α and sO2 were independent factors in our
model, the small variation of α should only had negligible effect
to the sO2 calculation.
Although the blood vessel diameter and location of ROI (i.e.,
inside blood vessels or at the bottom boundaries of vessels) did
not seem to affect the accuracy of sO2 estimation in our simulation, caution should be given in practical experimental setup. A
proper selection of ROI position at different blood vessel diameters could greatly improve the measured backscattered intensity
contrast caused by the differences in μt OxyB and μt DeOxyB
and, thus, the accuracy of sO2 estimation. For example, in small
blood vessels, the bottom surface of the vessel provides good
reflectance signal due to the refractive index mismatch between
the blood and the vessel wall. The photons sampled at the bottom finished one entire round-trip inside the blood vessel, and
such a double passing improves spectral contrast due to longer
absorption length. In larger blood vessels, however, strong attenuation reduced photon packets survive such longer path lengths,
which leads to drastic drops in signal strength and makes it more
vulnerable to detection noises. To compensate for this, choosing
a ROI position closer to the vessel surface within larger vessels
(rather than at the bottom of the vessel) may be a good strategy
for more robust inverse calculation at the cost of less absorption
contrast. Taking these effects into consideration, we think that
the ROI can be empirically chosen as long as it has sufficient
absorption process and SNR, however, more rigorous studies
could be conducted to explore whether an optimal ROI location
can be identified.
Our simulation also indicates that the packing factor W could
be chosen empirically but within the range from 0.2 to 0.4,
which will yield an sO2 estimation within a 5% error from the
true value. The W value is compatible with the manipulation
we performed to bridge the difference in scattering coefficients
obtained from the Mie theory and the reported data found in the
literature [38]. For in vivo experiments, we recommend that a W
value should be selected after being calibrated of the estimated
sO2 in arterial blood because arterial sO2 value can usually be
acquired by a systemic oximeter. Further, the W value should
be consistent with the physiological value of hematocrit, which
can be determined through blood sampling if necessary.
Finally, we compared OCT oximetry within visible light and
NIR spectral ranges. We failed to solve quantitatively for an sO2
level using NIR light in the simulation. An examination of the
fully oxygenated and fully deoxygenated blood scattering coefficients, calculated by Mie theory, indicates a parallel (dependent)
relationship within the NIR spectral range from 750 to 840 nm.
When we used W = 0.3 to scale the scattering coefficients for
simulation, μs for oxygenated whole blood ranges from 643.3
to 770.4 cm−1 and μs for deoxygenated whole blood ranges

Fig. 6. Compound attenuation coefficients μ t with respect to different packing
factor W. The spectra are independently normalized. (a) to (d) are arranged based
on increasing W values at 0, 0.01, 0.02, 0.1, 0.36, and 1.

from 563.0 to 676.2 cm−1 . Within the same range, absorption
coefficients μa are in the range of 2.4 – 4.2 cm−1 , which is less
than one-tenth of the corresponding scattering coefficients [38].
As a result, scattering, rather than absorption, dominate the light
attenuation process in the NIR region.
Fig. 6 shows the calculated compound attenuation coefficient
spectrum with different W over the selected NIR wavelength
range from 750 to 840 nm to recover sO2 . When W = 0, the
compound attenuation coefficient degraded to absorption coefficient [see Fig. 6(a)], from which the isosbesitic point at
797 nm can be clearly identified. However, as W increases from
0.01 to 0.1, the isosbesitic point shifted to a shorter wavelength
[see Fig. 6(b)], and further moves out of the selected range
[see Fig. 6(c) and (d)]. When W approaches 0.36, the shape of
compound attenuation coefficient approaches the shape of scattering coefficient within the selected wavelength range, where
the μt OxyB spectrum is almost parallel to μt DeOxyB spectrum
[see Fig. 6(e)]. The same conclusion holds when using W greater
than 0.36, as Fig. 6(e) shows the extreme case where W = 1.
For W = 0.36 used to extract sO2 information, the leastsquares fitting failed to converge due to the two linearly dependent inputs. The result indicates that OCT oximetry may only
work when there is an obvious isosbestic point in the compound
attenuation coefficients at the given packing factor. Though the
wavelength we simulated are slightly shorter than the wavelength currently being used in the NIR OCT systems, they fall
into the same absorption and scattering intensity range, and the
two spectra have even less contrast in the longer wavelengths.
Based on our data, visible light is clearly a better choice for
OCT oximetry, unless more advanced signal processing techniques are developed.

CHEN et al.: MONTE CARLO INVESTIGATION OF OPTICAL COHERENCE TOMOGRAPHY RETINAL OXIMETRY

REFERENCES
[1] T. W. Gardner et al., “Diabetic retinopathy: More than meets the eye,”
Surv. Ophthalmol., vol. 47, no. Suppl. 2, pp. S253–S262, 2002.
[2] D.-Y. Yu and S. J. Cringle, “Retinal degeneration and local oxygen
metabolism,” Exp. Eye Res., vol. 80, no. 6, pp. 745–751, 2005.
[3] A. Harris et al., “Measuring and interpreting ocular blood flow
and metabolism in glaucoma,” Can. J. Ophthalmol., vol. 43, no. 3,
pp. 328–336, 2008.
[4] N. D. Wangsa-Wirawan and R. A. Linsenmeier, “Retinal oxygen: Fundamental and clinical aspects,” Arch. Ophthalmol., vol. 121, no. 4,
pp. 547–557, 2003.
[5] A. Harris et al., “A review of methods for human retinal oximetry,”
Ophthalmic Surg. Lasers Imaging, vol. 34, no. 2, pp. 152–164, 2003.
[6] S. H. Hardarson and E. Stefánsson, “Retinal oxygen saturation is altered
in diabetic retinopathy,” Brit. J. Ophthalmol., vol. 96, no. 4, pp. 560–563,
2012.
[7] O. B. Olafsdottir et al., “Retinal oximetry in primary open-angle glaucoma,” Invest. Ophthalmol. Vis. Sci., vol. 52, no. 9, pp. 6409–6413, 2011.
[8] T. Eysteinsson et al., “Retinal vessel oxygen saturation and vessel diameter in retinitis pigmentosa,” Acta Ophthalmol., vol. 92, no. 5, pp. 449–453,
2014.
[9] J. M. Beach et al., “Oximetry of retinal vessels by dual-wavelength
imaging: calibration and influence of pigmentation,” J. Appl. Physiol.,
vol. 86, no. 2, pp. 748–758, 1999.
[10] M. H. Smith et al., “Effect of multiple light paths on retinal vessel
oximetry,” Appl. Opt., vol. 39, no. 7, pp. 1183–1193, 2000.
[11] W. Liu et al., “Accuracy of retinal oximetry: A Monte Carlo investigation,”
J. Biomed. Opt., vol. 18, no. 6, pp. 0660031–06600310, 2013.
[12] H. F. Zhang et al., “Functional photoacoustic microscopy for highresolution and noninvasive in vivo imaging,” Nature Biotech., vol. 24,
no. 7, pp. 848–851, 2006.
[13] J. Yi et al., “Visible-light optical coherence tomography for retinal oximetry,” Opt. Lett., vol. 38, no. 11, pp. 1796–1798, 2013.
[14] L. Kagemann et al., “Spectral oximetry assessed with high-speed ultrahigh-resolution optical coherence tomography,” J. Biomed. Opt., vol. 12,
no. 4, pp. 0412121–041218, 2007.
[15] D. J. Faber et al., “Light absorption of (oxy-)hemoglobin assessed by
spectroscopic optical coherence tomography,” Opt. Lett., vol. 28, no. 16,
pp. 1436–1438, 2003.
[16] D. J. Faber et al., “Toward assessment of blood oxygen saturation by
spectroscopic optical coherence tomography,” Opt. Lett., vol. 30, no. 9,
pp. 1015–1017, 2005.
[17] C.-W. Lu et al., “Measurement of the hemoglobin oxygen saturation level
with spectroscopic spectral-domain optical coherence tomography,” Opt.
Lett., vol. 33, no. 5, pp. 416–418, 2008.
[18] F. E. Robles et al., “Assessing hemoglobin concentration using spectroscopic optical coherence tomography for feasibility of tissue diagnostics,”
Biomed. Opt. Exp., vol. 1, no. 1, pp. 310–317, 2010.
[19] J. Yi and X. Li, “Estimation of oxygen saturation from erythrocytes by
high-resolution spectroscopic optical coherence tomography,” Opt. Lett.,
vol. 35, no. 12, pp. 2094–2096, 2010.
[20] F. E. Robles et al., “Molecular imaging true-colour spectroscopic optical
coherence tomography,” Nature Photon., vol. 5, no. 12, pp. 744–747,
2011.
[21] R. K. Wang, “Signal degradation by multiple scattering in optical coherence tomography of dense tissue: A Monte Carlo study towards optical
clearing of biotissues,” Phys. Med. Biol., vol. 47, no. 13, pp. 2281–2299,
2002.
[22] J. M. Schmitt, “Optical coherence tomography (OCT): A review,” IEEE
J. Sel. Topics Quantum, vol. 5, no. 4, pp. 1205–1215, Jul./Aug. 1999.
[23] X. Zhang et al., “Visible light optical coherence tomography for in vivo
imaging the spectral contrasts of the retinal nerve fiber layer,” Proc. SPIE,
vol. 8213, pp. 82130H1–82130H7, 2012.
[24] L. V. Wang et al., “MCML—Monte Carlo modeling of light transport
in multi-layered tissues,” Comput. Methods Programs Biomed., vol. 47,
no. 2, pp. 131–146, 1995.

2315

[25] G. Yao and L. V. Wang, “Monte Carlo simulation of an optical coherence tomography signal in homogeneous turbid media,” Phys. Med. Biol.,
vol. 44, no. 9, pp. 2307–2320, 1999.
[26] A. Tycho et al., “Derivation of a Monte Carlo method for modeling
heterodyne detection in optical coherence tomography systems,” Appl.
Opt., vol. 41, no. 31, pp. 6676–6691, 2002.
[27] M. Hammer et al., “Light paths in retinal vessel oximetry,” IEEE Trans.
Biomed. Eng., vol. 48, no. 5, pp. 592–598, May 2001.
[28] C. W. Oyster, The Human Eye. Sunderland, MA, USA: Sinauer Associates,
1999.
[29] C. E. Riva et al., “Blood velocity and volumetric flow rate in human retinal
vessels,” Invest. Ophthalmol. Vis. Sci., vol. 26, no. 8, pp. 1124–1132, 1985.
[30] M. Ritt and R. E. Schmieder, “Wall-to-lumen ratio of retinal arterioles as a tool to assess vascular changes,” Hypertension, vol. 54, no. 2,
pp. 384–387, 2009.
[31] M. Keijzer et al., “Fluorescence spectroscopy of turbid media: Autofluorescence of the human aorta,” Appl. Opt., vol. 28, no. 20, pp. 4286–4292,
1989.
[32] M. Hammer et al., “Optical properties of ocular fundus tissues-an in vitro
study using the double-integrating-sphere technique and inverse Monte
Carlo simulation,” Phys. Med. Biol., vol. 40, no. 6, pp. 963–978, 1995.
[33] S. Prahl. (1998, Mar.). Tabulated molar extinction coefficient for
hemoglobin in water. [Online] Available: http://omlc.org/spectra/
hemoglobin/summary.html
[34] A. Geirsdottir et al., “Retinal vessel oxygen saturation in healthy individuals,” Invest. Ophthalmol. Vis. Sci., vol. 53, no. 9, pp. 5433–5442,
2012.
[35] D. J. Faber et al., “Oxygen saturation-dependent absorption and scattering
of blood,” Phys. Rev. Lett., vol. 93, no. 2, p. 028102, 2004.
[36] A. Roggan et al., “Optical properties of circulating human blood in the
wavelength range 400–2500 nm,” J. Biomed. Opt., vol. 4, no. 1, pp. 36–46,
1999.
[37] D. K. Sardar and L. B. Levy, “Optical properties of whole blood,” Laser.
Med. Sci., vol. 13, no. 2, pp. 106–111, 1998.
[38] N. Bosschaart et al., “A literature review and novel theoretical approach
on the optical properties of whole blood,” Laser. Med. Sci., vol. 29, no. 2,
pp. 453–479, 2013.
[39] Q. Lu et al., “Monte Carlo modeling of optical coherence tomography
imaging through turbid media,” Appl. Opt., vol. 43, no. 8, pp. 1628–1637,
2004.
[40] R. Leitgeb et al., “Spectral measurement of absorption by spectroscopic
frequency-domain optical coherence tomography,” Opt. Lett., vol. 25,
no. 11, pp. 820–822, 2000.
[41] J. D. Rogers et al., “Nonscalar elastic light scattering from continuous media in the Born approximation,” Opt. Lett., vol. 34, no. 12,
pp. 1891–1893, 2009.
[42] J. Yi and V. Backman, “Imaging a full set of optical scattering properties of
biological tissue by inverse spectroscopic optical coherence tomography,”
Opt. Lett., vol. 37, no. 21, pp. 4443–4445, 2012.
[43] D. J. Faber et al., “Hematocrit-dependence of the scattering coefficient of blood determined by optical coherence tomography,” Proc. SPIE,
vol. 6163, pp. 61630Y1–61630Y9, 2006.
[44] F. Sakai et al., “Regional cerebral blood volume and hematocrit measured in normal human volunteers by single-photon emission computed
tomography,” J. Cereb. Blood Flow Metab., vol. 5, no. 2, pp. 207–213,
1985.
[45] L. Pedersen et al., “Quantitative measurement of changes in retinal vessel diameter in ocular fundus images,” Pattern Recogn. Lett., vol. 21,
no. 13/14, pp. 1215–1223, 2000.
[46] J. S. Tiedeman et al., “Retinal oxygen consumption during hyperglycemia
in patients with diabetes without retinopathy,” Ophthalmology, vol. 105,
no. 1, pp. 31–36, 1998.
[47] J. Yi et al., “Can OCT be sensitive to nanoscale structural alterations in
biological tissue?,” Opt. Exp., vol. 21, no. 7, pp. 9043–9059, 2013.
Authors’ photographs and biography not available at the time of publication.

