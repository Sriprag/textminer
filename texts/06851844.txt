1750

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

A Machine Learning System to Improve Heart
Failure Patient Assistance
Gabriele Guidi, Maria Chiara Pettenati, Paolo Melillo, Member, IEEE, and Ernesto Iadanza, Member, IEEE

Abstract—In this paper, we present a clinical decision support
system (CDSS) for the analysis of heart failure (HF) patients, providing various outputs such as an HF severity evaluation, HF-type
prediction, as well as a management interface that compares the
different patients’ follow-ups. The whole system is composed of a
part of intelligent core and of an HF special-purpose management
tool also providing the function to act as interface for the artificial
intelligence training and use. To implement the smart intelligent
functions, we adopted a machine learning approach. In this paper,
we compare the performance of a neural network (NN), a support
vector machine, a system with fuzzy rules genetically produced,
and a classification and regression tree and its direct evolution,
which is the random forest, in analyzing our database. Best performances in both HF severity evaluation and HF-type prediction
functions are obtained by using the random forest algorithm. The
management tool allows the cardiologist to populate a “supervised
database” suitable for machine learning during his or her regular outpatient consultations. The idea comes from the fact that in
literature there are a few databases of this type, and they are not
scalable to our case.
Index Terms—Heart failure (HF), machine learning, telemonitoring.

I. MEDICAL BACKGROUND
EART FAILURE (HF) is an alteration of the structure
and functionality of heart that results in an inadequate
pumping function. Because of this insufficient pumping function, organs and tissues receive an insufficient amount of oxygen
for their metabolic needs. The reaction of the organism to the
heart insufficient function causes an accumulation of sodium
and water in the lungs and tissues. The consequences of this can
be summarized in shortened breath, reduced exercise capacity,
fatigue, and edema. The patient condition can worsen and lead
to acute pulmonary edema and death. The clinical course of the
disease consists of a chronic phase in which the patient is stable,
often alternating with exacerbations phases that require hospitalization. In some cases, these acute episodes could be avoided
by promptly acting on therapy. Being able to predict these decompensations would be very important for the patient’s health.

H

Manuscript received November 27, 2013; revised April 14, 2014 and June 10,
2014; accepted July 2, 2014. Date of publication July 10, 2014; date of current
version November 3, 2014.
G. Guidi and E. Iadanza are with the Department of Information Engineering,
University of Florence, 50039 Florence, Italy (e-mail: gabriele.guidi@unifi.it;
ernesto.iadanza@unifi.it).
M. C. Pettenati is with the International Center of Computational Neurophotonics (ICON) Foundation, 50019 Florence, Italy (e-mail:
mc.pettenati@iconfoundation.net).
P. Melillo is with the Department of Electrical Energy and Information Engineering, University of Bologna, 40126 Bologna, Italy, and also with the Second
University of Naples 81100, Caserta Italy (e-mail: paolo.melillo@unina2.it).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2014.2337752

The overall prevalence of HF is increasing because of the population’s aging and because of the success in prolonging survival
in patients suffering from coronary events [1]. A systematic
review by the Cochrane Collaboration asserts that monitoring
scenarios can reduce up to 30% the rehospitalizations for HF
[2], [3]. We think that in this scenario, a decision support system
that improves HF patients’ assistance is necessary, and this is
the aim of this study.
II. INTRODUCTION
In this work we present an HF clinical decision support system
(CDSS) that, combined with a portable kit for the acquisition of a
set of clinical parameters, enables the support to telemonitoring
functions. The system provides smart functions using various
machine learning techniques that we compared to determine
which is the one that better behaves with the data in our database
that are typical for the HF field. This system provides many
outputs, visible through a management interface tool named
HF_manager. This tool has a double scope: to manage the patient
demographics and the follow-up checks and to train artificial
intelligence (AI) methods using patient data. Once the AI has
been sufficiently trained, the tool can be used to display the
smart output that the system provides. In this paper, we describe
the tool in all its functions and then we show the comparison
of the machine learning methods and the choice of the most
appropriate method [4], [5].
A. Project Goals—System Output
The main goal of this project is to provide the final users with
the following outputs: HF severity assessment, HF-type prediction, short-term prediction, chronological follow-up comparison, and score-based prognosis:
1) Severity assessment: It is a three-level evaluation of actual
HF severity (mild, moderate, and severe).
2) Score-based prognosis: It is a risk stratification that provides percentage of mortality according with four literature models that are SHFM [6], EFFECT [7], CHARM
[8], and ADHERE [9].
3) Chronological follow-up comparison: It is a graphic view
of parameters of the selected patient in the various dates
of follow-up. Follow-ups are displayed as histograms or
line charts.
4) HF type: It is a predictive indication of the type of the HF
of the patient in terms of the number of acute events that
he or she is likely to develop within a year. Acute events
are hospitalizations, ambulance calls, or unplanned cardiological examinations. Classes for this features are stable,

2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

GUIDI et al.: MACHINE LEARNING SYSTEM TO IMPROVE HEART FAILURE PATIENTS ASSISTANCE

rare exacerbations (ࣘ2 per year), frequent exacerbations
(>2 per year).
5) Long-term predictivity: It is an indication about the possible evolution of the disease in the next follow-up basing
on the past trend of follow-ups. The patient may worsen,
remain stable, or improve.
6) Short-term predictivity: It is an indication of the occurrence of an impending acute episode. By its nature, this
type of output requires special training in which the patient
is monitored on a daily basis.
7) Therapy guidelines: It is an output that indicates to the
doctor if for each patient the “target dose” general principle expressed in the guidelines is applied. In fact, the
guidelines [1] for certain classes of drugs such as beta
blockers or ACE inhibitors indicate that in the various
follow-up it is necessary to increase the dose up to the
“maximum dose tolerated by the patient.” Once reached
this target dose, patients are usually able to continue without any problems the beta-blocker therapy. This system
output assists the physician and helps him or her to make
sure that, during each follow-up, all the actions are carried
out to go to the target dose.
Outputs 1, 4, 5, and 6 of the above are obtained using machine
learning techniques that must be properly trained (details about
training of each output are in Section IV). The final users of this
system may vary depending on the application scenarios and
may be cardiologists or nonspecialist staff. In the last case, the
“severity assessment” output is very useful, for example, in a
home monitoring scenario in which a nurse periodically goes to
the patient’s home, performs some measurements, and inputs the
results using a tablet device. Intelligent core will respond with
the severity classification that may also be sent to his general
practitioner or to a cardiologist, who will be able to see check
his or her patients sorted by severity. More details about the
possible scenarios are illustrated in [10]–[12].
B. Supervised Training
In this section, we introduce the concept of supervised training, needed in machine learning methods. This training technique consists of providing as input to a machine learning algorithm a series of “examples” of the phenomenon we are observing, together with the desired output. Then, the input of a
supervised training process is a series of n pairs of {inputs, desired output} as in Fig. 1. As a result of the training process,
we get a reusable model to which, during the use phase, new
inputs that the system has never seen during the training phase
can be submitted, then providing an output based on how it
has learned to behave with inputs similar to the one provided.
Remarkably, the learned phenomenon should not necessarily be
known; in fact, the system learns from the evidence of the data,
and it independently discovers the rules that link the inputs to
the desired output. As shown in Fig. 1, in the train phase some
input vectors and the respective desired outputs are supplied to
the machine. The machine produces the model by organizing its
internal parameters. In the use phase, when the user enters as
input the vector {15 34 20 62}, the model provides the output

Fig. 1.

1751

Supervised training schema.

(that during the training phase was associated with the input
pattern) more similar to the one entered by the user (input {14
35 23 64} – output 3).
III. HF_MANAGER TOOL
A. Tool’s scope
The tool’s main purpose is to recover parametric data of real
patients during outpatient visits suitable for training a machine
learning technique. Thus, in agreement with Fig. 1, each followup (parametric tab of the patient) must be accompanied by a
“desired output,” which is nothing more than the evaluation of
the HF by the cardiologist. As a secondary goal, the system acts
as a special-purpose dashboard for the treatment of HF patients,
including a master management and many more useful functions
related to the disease.
B. Tool Design
This tool has been designed in close cooperation with physicians in order to satisfy practical needs (in terms of both contents and usability) that they have during outpatient visits. The
requirement of usability aims to reduce as much as possible the
system’s impact on the outpatient visits workflow. To make sure
that the physician can take real and immediate advantage from
the use of the tool in cardiology outpatient visits, the tool includes also some practical features such as the modification of
diet in renal disease calculation (MDRD), smart therapy module
(discovery of drug molecules to prescribe basing on dose, and
a tutor that ensures that treatment guidelines are correctly followed), and also some score based models. In this section, we
will describe in detail all the tool parts of the tool: parameters
acquisition, patient’s follow-up displaying, severity assessment
(using AI), smart therapy module, module for asynchronous
compiling, score-based prognosis, and enrollment calculation.
All these parts are supported by a management module for the
patient demographics.
C. Patient Management
Through this section, it is possible to select a patient, if he or
she has already included in the database, or add new ones. In
addition to standard biographical data, it is possible to insert and
then visualize the data related to patient’s general practitioner

1752

Fig. 2.

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

Patient management interface.

Fig. 4.

Fig. 3.

Score-based prognosis interface.

(GP). As shown in Fig. 2, this interface allows access to the
section dedicated to the parameters input, follow-ups display,
and calculation of score-based prognosis.
D. Enrolment Score
This feature is for the calculation of the risk of rehospitalization according to a custom score. This model requires the input
of some physiological parameters such as the brain natriuretic
peptide (BNP) and heart’s ejection fraction (EF) together with
other organizational parameters such as the number of patient
hospitalizations for HF or the required complexity of care. The
model provides a risk score. If the patient appears to be at high
risk of rehospitalization, he or she is suitable to be enrolled into
the project and may be useful for the training of the machine
(see Fig. 3).
E. Score-Based Models for Prognosis
We included in the tool four prognostic models known in the
literature [6]–[9]. Much of the data needed for the models are
directly retrieved from the database.
F. Parameters Acquisition
This is section is for use by the cardiologist during the visit.
With reference to Fig. 4, we notice that in Section I the patient’s personal details are shown. In Section II, the cardiologist
can specify whether the patient is to date classified as stable,
or if in the past he or she has developed rare or frequent exacerbations; this is useful in training the system to provide the
output denominated “HF type.” In the part of Fig. 4 labeled

Input mask.

with the number “3,” it is possible to input the patient’s parameters. In HF pathology, there are some parameters that need a
“frequent update” and others such as the BNP or EF that, in
case of a close follow-up, are not to be reentered but are retrieved automatically from previous follow-up records. On this
numerical form, there are controls that prevent from entering
nonnumeric values or out-of-range numbers. The user can then
enter other report parameters related to the ECG (for example, the presence of ICD pacemaker or ventricular tachycardia),
the etiology and comorbidities. In case of renal failure as a
comorbidity, it is possible to calculate the MDRD by entering
race and creatinine value (age and sex are retrieved from the
database) using an abbreviated formula [13]. Section IV refers
to the module of smart therapy detailed in Section III-H. Section V is dedicated to attributing the status of HF patients in the
three provided classes, by the visiting a cardiologist. This will
act as “desired output” in the process of supervised training.
All various input parameters entered by this acquisition mask
will then be associated with these desired outputs that are mildmoderate-severe and improvement-stable-worsening, useful for
outputs 1 and 5 described earlier in Section II. Using buttons
marked with the number 6, it is possible to save the followup or analyze it. If the “save” button is pressed, the system
will highlight, in red, the possible blank fields before adding the
follow-up to the database. When the “analyze” button is clicked,
the user is prompted to choose either AI trained with the local
database (if it is consistent) or with a default database embedded
in the system. The last guarantees the performance showed in
Section IV-D.
G. Follow-Ups Display
Using this interface, shown in Fig. 5, a user can choose a
follow-up of the selected patient (frame 1), view its numerical
values (frame 3), and create a summary report of comorbidity,
etiology, and treatment (frame 4). It is also possible to have a
graphical view of all the patient’s follow-ups, with the option
whether to display or not some parameters and to select one out
of three different types of chart (frame 2). This is the output
named “Chronological follow-up comparison.” A follow up can
also be analyzed by using AI (5), if it was not processed during
the related outpatient visit.

GUIDI et al.: MACHINE LEARNING SYSTEM TO IMPROVE HEART FAILURE PATIENTS ASSISTANCE

1753

TABLE I
CLASS DISTRIBUTION
Severity Assessment

Fig. 5.

Graphical view of follow-ups.

H. Smart Therapy Module
1) Smart Molecula Discovering: In the parameters acquisition mask, there is also a part dedicated to therapy management,
in which the physician can enter the therapy prescribed to the
patient. For some drugs categories (ACE inhibitors, angiotensin
receptor blockers, beta blockers, and diuretics) by filling the
dose in milligrams, the system, on the basis of preset thresholds,
automatically recognizes the active ingredient and highlights if
the dose for that drug is considered as high, medium, or low.
2) Therapy Guidelines Module: As explained in Section II,
this module helps the cardiologist to make sure that the principle
of “maximum tolerated dose” as required by the guidelines is applied to the patient. In particular, using the information obtained
from the present in the form of smart molecula discovery module, for the categories of drugs beta blockers, ACE inhibitors,
diuretics, and angiotensin receptor blockers, therapy is categorized as low-medium-high for that patient. Then, the trend in the
various follow-up doses of these drugs is displayed as a target. If
therapy remains unchanged through several follow-ups without
dose increase, an alarm sounds and the cardiologist is asked to
assess whether this is desired or not.
I. Asynchronous Doctor/Nurse Compiling
From the “clinical practice” of outpatient visits in our case
study at the Santa Maria Nuova Hospital, it was found that
filling the input forms during the visit was made by a nurse,
while the cardiologist performs specialist operations on patients
(ultrasound, ECG, etc.). The “desired output” (mild-moderatesevere), however, needed to be inserted by the cardiologist, who
preferred to insert it at the same time for all patients after finishing all visits. It was therefore necessary to create a special
interface that highlighted the patients for whom there were some
follow-up with empty fields to be completed (including the “desired output”).
IV. INTELLIGENT CORE
Using the supervised training method described in Section IIB, and our database, we trained the system to provide the outputs
1 (severity assessment) and 4 (HF type). Until now, we could
not set up outputs 5 and 6 that required training, i.e., long- and
short-term worsening prediction. In fact, short-term prediction
output is currently a work in progress because of the difficulty

Mild

Moderate

Severe

No. of patients

51

37

48

Type prediction

Stable

Rare

Frequent

No. of patients

110

14

12

in monitoring a patient on a daily basis. Attaining this objective
requires monitoring the patient in the days just preceding the
acute event. Long-term output instead is not yet ready for use
because the standard outpatient follow-up is six months, obtaining an adequate number of follow-ups to train this feature would
require three to four years. Outputs 2, 3, and 6 are not properly
“smart outputs” since they do not require the intervention of the
intelligent core technology but only database operations management. Severity assessment and HF-type functions are instead
trained retrospectively using our database.
A. Database
The two functions mentioned earlier are trained using an
anonymized database of HF patients, with varying severity
degrees, all treated by the Cardiology Department at the St.
Maria Nuova Hospital, Florence, Italy, in the period 2001–2008.
The database consists of a total of 136 records from 90 patients,
including baseline and follow-up data (when available). At the
time of the data collection, the specialist physician provided
the mentioned HF severity assessment in the desired three
levels: 1 (mild), 2 (moderate), and 3 (severe), which was stored
in the database. Moreover, after 12–24 months from the data
collection, the status of each patient in terms of HF type was
assessed and associated with the correspondent record. Thanks
to these target-output assignment operations, performed by a
specialist cardiologist, we can perform supervised machine
learning. Along with our clinical partners, we chose to use as
machine learning input parameters that from literature are more
related with HF. Physicians who cooperated with us consider
that the following 12 parameters are a good compromise
between number and completeness. For a correct diagnosis
of the patient, however, the instrumental parameters must
be accompanied by medical history parameters. Variables
in database that are used as input for the machine learning
techniques are the following 12:
1) Anamnestic data: age, gender, and New York Heart Association (NYHA) class.
2) Instrumental data: weight, systolic blood pressure, diastolic blood pressure, EF, BNP, heart rate, ECG parameters (atrial fibrillation true/false, left bundle branch block
true/false, and ventricular tachycardia true/false).
Table I shows how the classes of severity assessment and type
prediction are distributed in database.
B. Machine Learning Methods Details
We compare five machine learning techniques—a neural network (NN), a support vector machine, a fuzzy-genetic expert

1754

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

TABLE II
PARAMETERS THAT WE VARIED TO OBTAIN BEST RESULTS
Method
NN
SVM
Fuzzy genetic
CART
Random forest

Investigated Parameter
No. of hidden neurons (by automatic cycle)
Combination order of the two SVM
No. of fuzzy rules, no. of generation
Level of pruning (by automatic cycle)
No. of features (m) to be used for each tree, no. of trees,
class cutoff levels

system using Pittsburg approach [14], a classification and regression tree (CART), and a random forest [15]. For each machine
learning technique, we have recursively varied internal parameters in order to obtain a good compromise between learning
ability and generalization capability. In Table II, the inspected
parameters are summarized. Note that SVM is a binary classificator, so we have to combine two SVM to obtain a three-level
output, building an “SVM tree.” Best performances are obtained
by setting the parameters shown in Table II as follows:
NN: We cyclically trained the NN by varying hidden neurons
from 2 to 8. The best configurations are the following: five
hidden neurons for HF severity assessment and eight hidden
neurons for HF-type prediction.
SVM: We tried all the possible permutations of SVM tree,
and we obtained the best results with the combination that first
detects the non-severe versus severe status, then recognizing the
mild and moderate.
Fuzzy Genetic: The best results are achieved with a population
of 30 individuals, each composed by 45 rules. The algorithm
evolves for 600 generations.
CART: The system automatically tests the CART with various
levels of pruning. Best results in assessing severity are obtained
with a prune level = 2.
Random Forest: We performed various tests obtaining the
best performances with a number of features (m) to be used for
each tree equals to 4. Analyzing the out-of-bag (OOB) error
rate, related to the increasing of number of trees, we chose the
value of 2000 trees, because above that value the error rate is
sufficiently stabilized. We performed several tests, cycling the
thresholds for the three classes and establishing the combination,
which generated better accuracy, and the resulting cut offs are:
stable class, 50; rare class, 20; frequent class, 30.
Each tests are made using MATLAB R2010b. Once the best
technique has been chosen, we have integrated it in the Microsoft
.NET framework to include it in the HF_Manager tool.

TABLE III
PERFORMANCE IN SEVERITY ASSESSMENT
Machine Learning Method

Accuracy (%)

STH

Critical Errors

77.8
80.3
69.9
81.8
83.3

7.4
9.4
9.9
8.9
7.5

0
3
1
2
1

NN
SVM
Fuzzy genetic
CART
Random forest

TABLE IV
PERFORMANCE IN TYPE PREDICTION
AI Method
NN
SVM
Fuzzy genetic
CART
Random forest

Accuracy (%)

STH

Critical Errors

84.73
85.2
85.9
87.6
85.6

10.9
11.7
11.5
11.2
11.1

0
8
6
9
5

period of time (1–2–3 years) and the parametric situation and
health of the patient was changed so as to justify the approximation described. Moreover, no significant correlation between repeated measurements was detected. During the cross-validation
process, we have taken precautions so that follow-ups of the
same patient are grouped within the same fold, thus our assumption does not affect the independence of the folds. Since
we have to evaluate the performance of a three classes classifier,
rather than sensitivity and specificity, we use the multiclass accuracy formula shown later, according to the systematic analysis
[16] (TP: true positive, TN: true negative, FN: false negative,
FP: false positive)
Accuracy
N ◦
class((TPi + TNi )/(TPi + TNi + FPi + FNi ))
.
= i=1
N
(1)
In addition, we reported for each method the number of “critical errors,” meaning the classification of a severe HF patient as
mild and vice versa.
D. Results

C. Performance Measurement
In order to measure and compare the performance of the machine learning methods, we adopted a person independent tenfold cross validation. To better exploit all the available data, we
made the assumption of considering each record of the database,
i.e., “follow-up information,” as if it were a patient. In this way,
we have considered to have a database composed of 136 different patients each with a single follow-up (instead having
90 patients with a total of 136 follow-ups). This assumption is
justified by the fact that the follow-ups are spread on a large

Tenfold cross-validation results of various machine learning
techniques are summarized in Tables III and IV. RF outperformed the other methods for the automatic severity assessment.
However, the CART achieved a slightly lower performance than
RF but had the advantage to provide an intelligible model. In
Fig. 6, the selected CART is shown: the paths from the first
node to each terminal one are a graphical representation of a set
of “if . . . then . . . ” rules. For instance, if BNP was higher than
95 and EF was lower than 27.5, the subject was classified as a
severe CHF cases.

GUIDI et al.: MACHINE LEARNING SYSTEM TO IMPROVE HEART FAILURE PATIENTS ASSISTANCE

1755

that a well-balanced value for m is the square root of the number
of input features [12]. A class cut-off values was set in order to
rebalance the database. This is particularly important in determining the HF type because, as shown in Table I, the database
is very unbalanced in these data. The fact that the cutoffs with
which we obtain best results are “stable-rare-frequent: 50–20–
30” confirms the known rule that lowering the cutoff makes a
class an easy winner.
C. Discussion of Results

Fig. 6.

Decision process of pruned CART in HF severity assessment.

V. DISCUSSION
A. Choice of AI Outputs
The relevant outputs were decided along with our clinical
partners. In determining the HF severity level, we decided that
physicians have to evaluate the patient in his general condition
and not just relying on the levels of the best known HF severity
markers such as the BNP, EF, or NYHA class that are often
conflicting, in patients with complex situations. In this way, we
loose a little bit of objectivity but the system will train itself to
find a model for assessing general HF condition not just setting
simple thresholds on individual parameters.
B. Choice of Parameters
In each machine learning method, we varied some parameters
in order to contain overtraining and obtained a good generalization capability. Best results are obtained with parameters
configuration summarized in Table II, and, in this section, we
justified our choices and results. For the NN, we selected five to
eight hidden neurons as the best compromise between learning
ability and generalization capability; this is conceivable by using
a pattern of 12 inputs. The distribution of the three states of HF
type, shown in Table I, requires a strong learning ability (therefore eight hidden neurons) to prevent the system from training
itself to always say “stable.” Regarding SVM, the solution of
splitting first between “severe” versus “others” class showed the
best results. This means that there is a greater separation of parameters from severe state against others. Regarding the CART,
in the cross-validation process are produced trees with different
split levels that use multiple variables up to a maximum of 5,
but BNP, EF, and weight are always present as main variables.
This confirms that these three variables are the most important
in describing the HF severity. Fuzzy-genetic technique is the
one which is more affected by having relatively few patients
in the database. We consider 45 rules and 600 generations as a
good compromise. Adding rules or further evolving the algorithm produces overfitting, while too few rules or generations
are not sufficient for a correct system training. With the random
forest algorithm, we obtained better results with m = 4; as we
have 12 inputs, this figure is in line with the literature that states

Random Forest and CART produced good results in severity assessment if compared with other studies that assess HF
severity such as [17] that classify HF patients in three groups
(78.8%–87.5%–65.6% accuracy to classify healthy–HF prone–
HF, respectively). As shown in cross-validation tables, the standard deviation in assessing the severity is very high. This means
that there are some lucky folds where accuracy is 92% or 100%
and some folds where accuracy is <50%, except for best models
(i.e., random forest and NN). These unlucky folds have a high
percentage of “moderate” patients and this fact cause worse results, revealing the difficulty that the system has in classifying
patients whose parameters are in a “gray zone.” So the system
performance is quite fold-dependent, because the system fails
in detecting moderate status. The tests made with the leave one
out method confirm these results. We reported results of tenfold
cross-validation method because we consider it more appropriate to maintain independence between folds as explained in
Section IV-C. Although the random forest is the technique that
better combines good accuracy and a few critical errors committed (more information about random forest setting up for HF in
[18]), the accuracy is not the only important factor for the performance of a system. In decision support systems of this type,
it is important that the decision-making process of the machine
is humanly understandable. In this aspect, CART is the only
one who makes this possible, and since it has accuracy slightly
lower than the random forest, we have elected it as winner algorithm of this study. Moreover, the sets of rules of the CART
models are clinically consistent, even if CART did not use any
medical a priori knowledge [19]. In fact, the expert physicians
involved in the project confirmed that the CART selected the
most relevant features (see Fig. 6), which they consider for the
medical decision making, thus suggesting the proposed algorithm could learn the decision making of an expert physician
[1], [20]. About HF-type prediction results are quite distorted
because of the high asymmetry between the number of patients
with “chronic stable HF” and those with frequent or rare exacerbations, as shown in Table I (unbalanced dataset). Moreover,
the dataset consists of clustered data (i.e., repeated measurement of the same subject); for that reason, we adopted the most
updated methods to deal with clustered data. In particular, as
described in Section IV-C, we adopted a subject based crossvalidation approach, which has been shown to result in increased
efficiency of the estimation of the misclassification rate [21]. Finally, the adopted data-mining methods, in particular tree-based
classifiers, have been shown to achieve satisfactory performance
in the analysis of cluster-correlated data [22]. A correct HF

1756

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 6, NOVEMBER 2014

prediction would require a more balanced database with a higher
number of independent instances (patients).

[10]

VI. CONCLUSION
In this paper, we present a decision support system to improve assistance for patients affected by HF. The need for this
system arises from the ever increasing number of patients suffering from chronic diseases, due to various factors, including the
aging of society. In particular, HF is a chronic disease with high
prevalence, the management of which can be improved by enabling remote monitoring scenarios. In case of HF, to monitor the
progress of parameters and perform a timely intervention in therapy may be decisive for the outcome of the patient. The proposed
system aims to facilitate monitoring scenarios by automatically
providing outputs readable even by noncardiologist physicians
and nurses about the severity and type of HF. To provide these
outputs, we compare several types of machine learning techniques, finding the CART method as the most adequate to our
goal. As well as providing a humanly understandable decisionmaking process, CART provides a cross-validation multiclass
accuracy of 81.8% in severity assessment and 87.6% in type prediction. Unfortunately, it is difficult to generalize these findings
due to a small sample size.

[11]

[12]

[13]

[14]
[15]
[16]
[17]
[18]
[19]

ACKNOWLEDGMENT
The authors would like to thank Dr. M. Milli for his important
and continuous contribution to this project.
REFERENCES
[1] K. Dickstein, A. Cohen-Solal, G. Filippatos, J. J. V McMurray,
P. Ponikowski, P. A. Poole-Wilson, A. Strömberg, D. J. van Veldhuisen,
D. Atar, A. W. Hoes, A. Keren, A. Mebazaa, M. Nieminen, S. G. Priori,
and K. Swedberg, “ESC guidelines for the diagnosis and treatment of
acute and chronic heart failure 2008,” Eur. J. Heart Failure, vol. 10,
no. 10, pp. 933–989, Oct. 2008.
[2] S. C. Inglis, R. A. Clark, F. A. McAlister, J. Ball, C. Lewinter, D. Cullington, and J. G. Cleland, “Structured telephone support or telemonitoring
programmes for patients with chronic heart failure,” Cochrane Database
Syst. Rev., (2009). [Online]. vol. 8, CD007228-CD007228.
[3] A. A. Louis, T. Turner, M. Gretton, A. Baksh, and J. G. F. Cleland, “A
systematic review of telemonitoring for the management of heart failure,”
Eur. J. Heart Failure, vol. 5, pp. 583–590, 2003.
[4] G. Guidi, P. Melillo, M. Pettenati, M. Milli, and E. Iadanza, “Performance
assessment of a clinical decision support system for analysis of heart
failure,” in IFMBE Proc., 2014, vol. 41, pp. 1354–1357.
[5] G. Guidi, M. C. Pettenati, M. Milli, and E. Iadanza, “A tool for patient
data recovering aimed to machine learning supervised training,” in IFMBE
Proc., 2014, vol. 41, pp. 1899–1902.
[6] W. C. Levy, D. Mozaffarian, D. T. Linker, S. C. Sutradhar, S. D. Anker,
A. B. Cropp, I. Anand, A. Maggioni, P. Burton, M. D. Sullivan, B. Pitt,
P. A. Poole-Wilson, D. L. Mann, and M. Packer, “The Seattle heart failure model: Prediction of survival in heart failure,” Circulation, vol. 113,
no. 11, pp. 1424–1433, Mar. 2006.
[7] D. S. Lee, P. C. Austin, J. L. Rouleau, P. P. Liu, and D. Naimark, “Predicting mortality among patients hospitalized for heart failure derivation
and validation of a clinical model (EFFECT),” Hospitals, vol. 290, no. 19,
pp. 2581–2587, 2003.
[8] S. J. Pocock, D. Wang, M. A. Pfeffer, S. Yusuf, J. J. V McMurray,
K. B. Swedberg, J. Ostergren, E. L. Michelson, K. S. Pieper, and C.
B. Granger, “Predictors of mortality and morbidity in patients with
chronic heart failure.(CHARM),” Eur. Heart J., vol. 27, no. 1, pp. 65–75,
Jan. 2006.
[9] G. C. Fonarow, K. F. Adams, W. T. Abraham, C. W. Yancy, and W. J.
Boscardin, “Risk stratification for in-hospital mortality in acutely decom-

[20]

[21]
[22]

pensated heart failure: Classification and regression tree analysis,” JAMA,
vol. 293, no. 5, pp. 572–580, Feb. 2005.
G. Guidi, P. Melillo, M. C. Pettenati, M. Milli, and E. Iadanza, “A system
to improve continuity of care in heart failure patients,” IFMBE Proc., vol.
42, pp. 155–158, 2014.
G. Guidi, E. Iadanza, M. C. Pettenati, M. Milli, F. Pavone, and G. B.
Gentili, “Heart failure artificial intelligence-based computer aided diagnosis telecare system,” in Proc. ICOST (Lecture Notes Comput. Sci.) 7251,
2012, pp. 278–281.
G. Guidi, M. C. Pettenati, R. Miniati, and E. Iadanza, “Heart failure
analysis dashboard for patient’s remote monitoring combining multiple
artificial intelligence technologies,” in Proc. Annu. Int. Conf. IEEE Eng.
Med. Biol. Soc., 2012, pp. 2210–2213.
A. S. Levey, J. Coresh, E. Balk, A. T. Kausz, A. Levin, M. W. Steffes, R. J.
Hogg, R. D. Perrone, J. Lau, and G. Eknoyan, “National kidney foundation
practice guidelines for chronic kidney disease: Evaluation, classification,
and stratification,” Ann. Internal Med., vol. 139, no. 2, pp. 137–147, 2003.
S. F. Smith, “A learning system based on genetic adaptive algorithms,”
Ph.D. dissertation, Dept. Comput. Sci., Univ. Pittsburgh, Pittsburgh, PA,
USA, 1980.
L. Breiman, “Random forests,” Mach. Learning, vol. 45, no. 1, pp. 5–32,
2001.
M. Sokolova and G. Lapalme, “A systematic analysis of performance
measures for classification tasks,” Inf. Process. Manage., vol. 45, no. 4,
pp. 427–437, Jul. 2009.
G. Yang, Y. Ren, Q. Pan, and G. Ning, “A heart failure diagnosis model
based on support vector machine,” in Proc. IEEE Int. Conf. Biomed. Eng.
Informat., 2010, pp. 1105–1108.
G. Guidi, M. C. Pettenati, R. Miniati, and E. Iadanza, “Random forest
for automatic assessment of heart failure severity in a telemonitoring
scenario,” in Proc. EMBC, 2013, pp. 3230–3233.
P. Melillo, N. De Luca, M. Bracale, and L. Pecchia, “Classification tree
for risk assessment in patients suffering from congestive heart failure via
long-term heart rate variability,” IEEE J. Biomed. Health Inform., vol. 17,
pp. 727–733, May 2013.
M. A. Silver et al., “BNP consensus panel 2004: A clinical approach for the
diagnostic, prognostic, screening, treatment monitoring, and therapeutic
roles of natriuretic peptides in cardiovascular diseases,” Congest Heart
Fail., vol. 10, no. 5, suppl. 3, pp. 1–10, Sep./Oct. 2004.
W. Adler, A. Brenning, S. Potapov, M. Schmid, and B. Lausen, “Ensemble classification of paired data,” Comput. Statist. Data Anal., vol. 55,
pp. 1933–1941, Jan. 5, 2011.
Y. V. Karpievitch, E. G. Hill, A. P. Leclerc, A. R. Dabney, and J. S.
Almeida, “An introspective comparison of random forest based classifiers
for the analysis of cluster-correlated data by way of RF++,” PLoS One,
vol. 4, p. e7087, 2009.

Gabriele Guidi received the M.Sc. degree in biomedical engineering form the
University of Florence, Florence, Italy, in 2011.
He is currently a Research Fellow in the Department of Information Engineering, University of Florence funded by ICON Foundation. His current research
interests include studies concerning image processing, machine learning, and
heart failure models.

Maria Chiara Pettenati received the Ph.D. degree in telematics and information from the University of Florence, Florence, Italy.
She is currently a Program Manager at the International Center of Computational Neurophotonics (ICON) Foundation, Florence.

Paolo Melillo (M’12) was born in Naples, Italy, on June 29, 1985. He received
the Ph.D. degree from the University of Naples “Federico II,” Naples, in 2012.
He is currently an Assistant Professor in the Multidisciplinary Department
of Medical and Dental Sciences, Second University of Naples, Naples, Italy.
Ernesto Iadanza (M’07) received the Ph.D. degree in telematics and information from the University of Florence, Florence, Italy, in 2013.
He was the Secretary of the Board of the IFMBE/Clinical Engineering Division. He received the IBM Faculty Award in 2013. He is currently an Adjunct
Professor in Clinical Engineering in the Department of Information Engineering, University of Florence. His current research interests include healthcare
engineering, clinical engineering, and risk management in healthcare.

