IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

2041

Computer Simulation of Cardiac Propagation:
Effects of Fiber Rotation, Intramural Conductivity,
and Optical Mapping
A. Ghazanfari*, M. P. Rodriguez, E. Vigmond, and A. Nygren

Abstract—Cardiac propagation characteristics such as anisotropy ratio and conduction velocities are often determined experimentally from epicardial measurements. We hypothesize that these
measurements have inaccuracies due to intramural fiber rotation
and transmural electrotonic interactions. We also hypothesize that
optical mapping (OM) recordings compound the error, due to contributions from deeper layers. In this study, we studied propagation in a three-dimensional computer model of a slab of tissue with
varying thickness and a 120◦ fiber rotation. Simulation results
were further processed to reconstruct OM signals. As expected,
simulation results demonstrated that the direction of wave propagation on the epicardial surface is not aligned with the epicardial
fiber orientation. This angle difference was most pronounced for
thin tissue, and decreased with decreasing intramural conductivity
and increasing tissue thickness. This difference also increased with
time elapsed poststimulus, as the contribution from deeper layers increased. Observations were confirmed experimentally with
OM measurements from isolated rat hearts. Simulations also predicted that OM causes an additional error in measurements due
to activity in deeper layers being less aligned. Several alternative
approaches for the estimation of fiber orientation and anisotropy
ratio were evaluated. Those based on conduction velocity measurements yielded the most accurate estimates when applied to
noise-free simulated data.
Index Terms—Anisotropic propagation, anisotropy ratio,
cardiac conduction velocity, cardiac measurements.

Manuscript received July 23, 2013; revised October 19, 2013 and January 20,
2014; accepted February 28, 2014. Date of publication March 17, 2014; date of
current version June 14, 2014. This work was supported by the Natural Sciences
and Engineering Research Council of Canada. Asterisk indicates corresponding
author.
∗ A. Ghazanfari is with the Department of Electrical and Computer Engineering, University of Calgary, AB T2N1N4, Canada (e-mail: a.ghazanfari@
ucalgary.ca).
M. P. Rodriguez is with the Department of Electrical and Computer Engineering, University of Calgary, AB T2N1N4, Canada (e-mail: mprodrig@
ucalgary.ca).
E. Vigmond is with the Department of Electrical and Computer Engineering, and LIRYC, University of Bordeaux 1, Talence 33400, France (e-mail:
edward.vigmond@u-bordeaux1.fr).
A. Nygren is with the Department of Electrical and Computer Engineering,
and Centre for Bioengineering Research and Education, Schulich School of
Engineering. University of Calgary, AB T2N1N4, Canada (e-mail: nygren@
ucalgary.ca).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2014.2311371

I. INTRODUCTION
HYSIOLOGICAL characteristics of heart tissue such
as fiber rotation, anisotropy, cell coupling, and fiber
curvature are known to have major effects on wave propagation
patterns in the heart. One way to obtain information about these
structural properties is to measure epicardial potential patterns.
There have been several studies designed to determine myocardial anisotropy and conduction velocity based on epicardial
potential measurements. While some studies have accounted
for the effect of fiber rotation [1], many have assumed that
epicardial conduction patterns directly reflect epicardial fiber
orientation [2], [3]. Known effects of fiber curvature [4] and
transmural fiber rotation on epicardial surface wavefront propagation patterns [5], [6] have frequently not been accounted for.
Cells are connected internally by gap junctions, which are
mainly located at intercalated disks in healthy tissue [7], leading
to a higher conductivity in the direction of myocardial fibers.
Therefore, wave propagation is anisotropic and faster in the
myocardial fiber direction (longitudinal) than in the direction
across the fibers within the sheet (transverse) and across sheets
(transmural). Also, fiber orientation is known to change from
epicardium to endocardium [8], [9]. Therefore, anisotropy and
fiber orientation have to be considered in designing measurement approaches for conduction velocity.
Taccardi et al. [10] studied the effect of the myocardial structure on wave propagation patterns in the canine left ventricle
and showed that activation isochrones resulting from epicardial
stimuli differed from activation patterns when the wavefront was
limited to only the epicardium. They also showed both superficial and transmural fiber directions were reflected in potential
distributions [11]. Finally, they analyzed how the features of
epicardial potential distribution were affected by pacing site,
pacing depth, and time elapsed after the stimulus.
Nygren et al. [12], [13] used optical mapping (OM) to record
high-resolution optical maps of activation times and conduction
in the mouse heart. They showed that central stimulation resulted
in an elliptical pattern demonstrating that conduction velocities
are anisotropic. Knisely [14] used OM and showed that changes
in a transmembrane voltage depend on fiber orientation.
However, OM does not measure the transmembrane potential on the surface, but a weighted average of potential over the
depth of the tissue due to light intensity decay in the tissue.
Fluorescent photon scattering is known to distort OM. Bishop
et al. [15] provided a model that accurately synthesizes the
3-D photon scattering effect over the irregular geometry of the

P

0018-9294 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

2042

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

rabbit ventricles. They also studied the effect of photon scattering in optical signal distortion during ventricular tachycardia
and defibrillation and showed that photon scattering causes the
difference in amplitude of optically recorded and simulated virtual electrode polarization induced by a defibrillation-strength
shock [16].
In this paper, we extend our previously published work [17]
about the effect of fiber rotation on epicardial measurements. We
showed previously that the electrotonic loading effect of underlying layers distorts propagation on the surface and causes misalignment between the wave propagation and fiber direction and
causes an error in cardiac structural parameter measurements.
We demonstrated that this mismatch between the fiber direction
and the direction of propagation increases with time poststimulus. In the present study, we have made experimental observations to confirm this model prediction. We have studied the
effect of transmural conductivity on wave propagation patterns
and its effects on the measurements. We have also modeled the
effect of OM recordings on the measurements. We simulated
the effects of OM on the recorded wave propagation pattern
and discussed how this affects the measurements of structural
parameters.
II. METHODS
A. Computational Model
The Pandit [18] mathematical model of rat ventricular myocytes was used as the base single-cell model. 2 × 2 cm tissue
slabs were created with different thicknesses (1 mm, 2 mm,
4 mm, and 1 cm). The myocardial tissue included fiber orientation that varied continuously and linearly 120◦ from epicardium to endocardium [19]–[21]. Simulations were run as a
monodomain model using Cardiac Arrhythmia Research Package [22] with a time step of 1 μs and spatial discretization step
of 100 μm. Tissue was stimulated with a 50 μA/cm2 current
density injected into a 0.5 × 0.5 × 0.25 mm cube for 5 ms at
the center of an epicardial surface. Simulations were run for all
tissues, and the membrane potential of each point was recorded.
Transmural conductivity (denoted by gn ) is defined as the
conductivity between different layers of the tissue and is perpendicular to the plane of longitudinal and transverse conductivity directions. This conductivity affects the wave propagation
speed from epicardium to endocardium. Higher transmural conductivity results in more electrotonic loading from underlying
layers of cardiac tissue on the epicardial surface. Coli Franzone
et al. [21] considered transmural conductivity to be equal to
one tenth of the transverse conductivity so that the associated
propagation velocity (θn ) was in accordance with the findings
reported by LeGrice et al. [23]. Therefore, to determine the
effect of transmural electrotonic interactions on the epicardial
surface, simulations were run with different transmural conductivities (gn = gt , gt /2, gt /4, and gt /8).
B. Data Processing
Activation time was defined for each point as the moment
when membrane potential crossed zero in the action potential

upstroke. Isochrones were defined as contour plots of the activation time which represent the points that have the same activation
time. Since the action potential propagates faster in the fiber direction, isochrones were expected to have an elliptic shape. A
least-squares error algorithm was implemented in MATLAB to
fit ellipses to each isochrone. Coordinates of all the points (X
and Y ) in the isochrones are used to find the parameters in (1):
A (X − h)2 + B (X − h) (Y − k) + C (Y − k)2 = 1

(1)

where “h” and “k” are the coordinates of the ellipse center. The
angle of rotation, along with the major and minor axes of each
ellipse, was determined.
Conduction velocity vectors for each point were calculated
using the gradient of the activation times as described in detail
by Morley et al. [24]. Briefly, a plane was fitted by the leastsquares method to a 7 × 7 point neighborhood of the activation
times to obtain a smooth approximation to the activation times in
the neighborhood. The direction of the gradient of this approximating plane was taken to be the local direction of propagation,
while the inverse of the magnitude of this gradient was used as
an estimate of the local velocity [24]. This approach is similar
to that used by Bayly et al. [25], with the exception that these
authors fitted a quadratic surface, rather than a linear plane, to
the activation times. These methods share the advantage that
they factor in activation times over a neighborhood in a leastsquares sense, and thus can be expected to be relatively robust in
the presence of measurement noise in a small number of points.
This is in contrast to simpler methods such as the one proposed
by Mazeh et al. [26], which relies on activation time measurements in only four or five points. Another robust approach for
conduction velocity measurement is that of Kay and Gray [27].
However, this method depends on absolute measurements of
membrane potential and is thus not directly applicable to optical mapping data (which only provides relative measurements
of membrane voltage).
Velocity vectors at the apices of the fitted ellipse (intersection
between the long and short axes and the ellipse itself) were considered to be the longitudinal and transverse conduction velocities, denoted θl and, θt , respectively in this paper. The maximum
and minimum velocities along isochrones (not necessarily on the
fitted ellipse) were also determined as an alternative estimate of
longitudinal and transverse conduction velocities and are denoted θm ax and θm in , respectively. In all cases, velocities were
calculated using the method described previously. The largest
conduction velocity vector in any point along the isochrone was
considered to be equal to the longitudinal conduction velocity,
θm ax . The minimum conduction velocity in any point along the
isochrone was used as an estimate for transverse propagation
velocity θm in .
C. Estimation of Epicardial Fiber Orientation
The angle of wave propagation was considered to be the angle
of the major axis of the ellipse relative to the epicardial fiber
orientation. This angle provides one possible estimate of epicardial fiber orientation. Fig. 1 depicts an ellipse fit to an isochrone
(in 1-mm-thick tissue) and its major and minor axes. Isochrones

GHAZANFARI et al.: COMPUTER SIMULATION OF CARDIAC PROPAGATION

2043

After electrical simulations were completed, measured membrane potential with the effect of OM (VOM ) was calculated
based on the following equation:
VOM (x, y) =

∫0∞ Vm (x, y, z) w (z) dz
∫0∞ w (z) dz

(2)

where Vm (x, y, z) is the membrane potential at each point, z is
the depth below the surface, and w(z) is the weighting function
which can be considered as a product of two exponentials for
excitation (Φex ) and emission lights (Φem ) derived from [26]:
Fig. 1. Isochrone (black solid line) and the corresponding least-squares fitted ellipse (dashed line). Major and minor axes are shown with “a” and “b,”
respectively. Angle of rotation is ϕ. Anisotropy ratio is equal to “a/b.”

w (z) = Φex (z) Φem (z)
−z/0.8m m

Φex = 927e

− 702e

−z/1.34m m

Φem = e
in thin tissues are not completely elliptical, but are “skewed”
and have notches along the sides. As a result, the best-fit ellipse
is not completely aligned with the perceived “long axis” of the
isochrone, potentially contributing to the error in this estimate
(see Discussion). As an alternative, fiber orientation may be estimated based on the direction of maximum conduction velocity
along a particular isochrone, i.e., at a particular time poststimulus. In this study, this time was selected to be 20 ms to ensure
that measurements were obtained well after the end of the stimulus pulse (to ensure that they represent conduction rather than
the passive response to stimulation) and before the activation
wavefront reached the edge of the tissue slab. In this alternative measure, fiber direction was considered to be the direction
of maximum conduction velocity along the 20-ms isochrones
(θm ax , as defined above).
D. Estimation of an Anisotropy Ratio
The ratio of longitudinal to transverse conduction velocity
is a dimensionless parameter called the anisotropy ratio (AR).
Three measures of AR were considered in this study: 1) the
AR can be calculated based on the distance traveled by the activation wavefront, as the ratio of the major to minor axis of
the best-fit ellipse to an isochrone (i.e., a/b in Fig. 1). In this
paper, we used the 20-ms isochrone unless otherwise noted.
2) Alternatively, the AR can be estimated as the ratio of the conduction velocities observed at the apices of the best-fit ellipse,
i.e., AR is estimated as θls /θt with θl and θt as defined above.
3) Finally, we considered a third estimate of AR based on the
ratio of maximum to minimum conduction velocity along the
20-ms isochrone (θm ax /θm in ).

(3)
−z/0.44m m

(4)
(5)

The second term in (4) accounts for photons leaking out of
the tissue near the surface [26]. Using (2)–(5) on the membrane
potential of the tissue, the measured membrane potential on the
epicardium was calculated offline for analysis.
F. Experimental Methods
All experiments followed the guidelines of the University
of Calgary Animal Care and the Canadian Council for Animal
Care. Rat hearts were isolated as described by Nygren et al. [13].
For OM protocols, the optical mapping dye Di-4-ANEPPS was
added after a 20-min normalization period. After normalization,
the dye was perfused for 5 min, followed by a 10-min washout.
Di-4-ANEPPS was diluted from a 10 mM stock solution in
dimethyl sulfoxide (DMSO) to a 1 μM concentration in a Krebs–
Henseleit buffer solution. To override sinus, activation of the
heart pacing with a pulse cycle of 200 ms was used. The pacing
current was initiated at 1 μA, and increased until the tissue was
activated, overriding sinus rhythm. Once the minimum pacing
current needed (threshold) was determined, the pacing current
was set to twice threshold for the remainder of the experiment. If
the current became insufficient to initiate tissue activation then
the current was again increased until activation occurred.
Data processing is described in detail elsewhere [16]. Data
were processed offline and activation time for each pixel was
detected. Ellipses were fitted to each isochrone using the same
method used for simulation data. The angle of each ellipse was
found and the angle difference of isochrones was calculated for
each activation time.
III. RESULTS

E. Optical Mapping Model

A. Simulation Results

Fluorescent photon scattering distorts the recordings of cardiac membrane potential [28], [29]. Excitation light intensity
decays as it penetrates through the tissue and as it goes back
out through the tissue to the camera. Due to penetration and
emission, OM does not measure only surface membrane potential. The simplest way to model and implement this effect is to
assume that the excitation light decays exponentially on the way
in and that emitted light also decays exponentially on the way
out, modeling the process as the product of two exponentials.

Observations based on isochrones: Fig. 2 shows the contour
plot of activation time (isochrones) for different tissue thicknesses. The direction and speed of wave propagation can be
seen from the isochrones. Fibers on the epicardial surface are
oriented in the horizontal direction in all slabs. It can be seen
from Fig. 2 that the direction of wave propagation is not aligned
with epicardial fiber orientation. This misalignment is more evident in thinner tissues. It can also be noted that for a specific
thickness, subsequent isochrones are not oriented in the same

2044

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 4. Angle of wave propagation versus tissue thickness for different transmural conductivities (based on the best-fit ellipse, 20 ms after stimulation).
Fig. 2. Activation time isochrones on the epicardial surface. Fibers are oriented
in the horizontal direction. Isochrones are less aligned with the fiber direction
in thinner tissues.

Fig. 5. Anisotropy ratio versus tissue thickness for different transmural conductivities. Anisotropy ratios are measured based on the best-fit ellipse to the
activation isochrone 20 ms after the stimulation. Measurements are more accurate for thicker tissues. Electrical coupling between the layers are less effective
for thicker tissues.

Fig. 3. Angle of wave propagation versus time for different transmural conductivities and thicknesses. As electrical coupling between layers decreases (gn
decreases), impulse propagation is more aligned with the epicardial fiber orientation. The angle of propagation is increasing with the time elapsed since the
stimulus. This increment is less for thicker tissues and smaller couplings. Angle
of propagation was estimated as the orientation of the long axis of the best-fit
ellipse to the activation isochrone at the time indicated post stimulus.

direction and the angle of propagation increases with time poststimulus.
Fig. 3 shows the angle of wave propagation, as determined
by the orientation of the long axis of the best-fit ellipse to the
20-ms isochrone, for different values of the transmural electrical coupling. The angle of propagation increased with the time
elapsed from the stimulus application. The difference between
the angle of propagation and fiber direction was smaller for
thicker tissues. Also, as electrical coupling between layers decreased, this angle discrepancy decreased. It can be noted that
for tissues with the lowest transmural conductivity (gn = 18 gt ),
the wavefront tended to propagate in a constant direction (slope
of the blue line is almost zero in all thicknesses).
Fig. 4 shows the angle of wave propagation 20 ms after stimulation for different thicknesses and different transmural conductivities (different “gn /gt ” ratios). Lower gn /gt ratios resulted

in less misalignment of wave propagation with epicardial fiber
orientation for all thicknesses.
Fig. 5 shows the diagram of the measured anisotropy ratio,
determined as the ratio of the long axis to the short axis of
the best-fit ellipse, versus tissue thickness for different transmural conductivities. With thicker slabs, the AR increased and
approached the “true” AR value of tissue with no fiber rotation [17]. It can be noted from Fig. 5 that less transmural
conductivity caused less electrical interaction between the tissue layers; therefore, measurements in cardiac tissues would be
more accurate under these conditions. However, errors are still
substantial for thin tissues.
Conduction velocities: Fig. 6 shows the longitudinal and
transverse conduction velocities (θl and θt ) for different tissue thicknesses and transmural conductivities. Nominal values
of longitudinal and transverse conduction velocities are 51 and
17 cm/s, respectively (θl threefold higher than θt ). These values
are calculated for a tissue with no fiber rotation. Estimated longitudinal conduction velocities are smaller than the nominal value
of θl and transverse ones are greater than the true value of θt .
As tissues become thicker, measurements for both longitudinal
and transverse velocities approach the true value.
The effect of transmural conductivity on measurements is
clearly visible in Fig. 6. Measurements from the tissues with
smaller transmural conductivity are closer to the nominal values
for both θl and θt .

GHAZANFARI et al.: COMPUTER SIMULATION OF CARDIAC PROPAGATION

2045

TABLE II
MEASURED WAVE PROPAGATION PARAMETERS

Fig. 6. Transverse (θt ) and longitudinal (θl ) conduction velocity versus tissue
thickness for different transmural to transverse conductivity ratios. As tissues
get thicker and transmural conductivity decreases, measurements approach the
nominal conduction velocity (which is 17 and 51 cm/s for transverse and longitudinal conduction velocity respectively). θl and θt were obtained at the apices
of the 20-ms activation isochrones as described in methods.
TABLE I
MEASURED EPICARDIAL FIBER DIRECTION AND ANISOTROPY RATIO

Alternative estimates based on conduction velocities: The
estimates of epicardial fiber orientation and anisotropy ratio
presented in the previous section were determined based on the
best-fit ellipse to the isochrones. To determine whether the alternative measures based on conduction velocities discussed in
methods can be expected to produce more accurate estimates,
the same simulation results were subjected to additional analysis. Table I shows the values of estimated AR for the different
methods considered. Table I shows that using the θm ax /θm in ratio results in the most accurate measurements (see Discussion).
Similarly, Table I shows that measurement of fiber orientation
based on θm ax yields a more accurate estimate than that based on
the long axis of the best-fit ellipse to the isochrone. However,
attempts to apply these alternative measures to experimental
data demonstrated that they are highly sensitive to experimental
noise and thus unsuitable for practical application. The remainder of the analysis in this paper is therefore based on fitting of
ellipses to isochrones.

Effect of optical mapping: The measured membrane potential
on the epicardium was calculated with the effect of OM. Angle of propagation, anisotropy ratio, and conduction velocities
were measured and compared to the ones with no OM effect
considered. Table II shows a complete comparison between all
the parameters with and without considering OM.
Table II shows that the OM caused more error (compared to
the nominal AR of 3) in AR measurement for thicker tissues,
i.e., for the 1-mm slab, AR is measured as 1.63 and 1.72 with and
without the effect of OM, respectively. These values are 2.76
and 2.94 for the 10-mm slab (see Discussion). This shows that
OM is the dominant cause of error in the thick tissues, while the
fiber rotation causes the major part of error in the thin tissues.
The angle of wave propagation is also affected by the OM.
The error is increased from 24◦ to 32◦ for the thinnest tissue and
from 2◦ to 5◦ for the thickest tissue.
OM did not significantly change the measurements of θl
(2–3% additional error) for any tissue thickness. Transverse
conduction velocities were affected more by the OM (1–10% additional error) but the main cause of error was the fiber rotation.
The difference between simulations that did or did not account
for OM was again more pronounced in the thicker slabs. However, for all parameters considered, the errors observed in thick
tissues (due to either fiber rotation or OM) are relatively small
and unlikely to substantially affect experimental conclusions.
B. Experimental Results
Fig. 7 shows an activation map of a rat heart in the left panel.
The right panel shows the measurements of the angle of rotation
of each isochrone versus time elapsed after stimulation. The
time scale starts 7 ms after stimulus application to allow accurate
detection of activation and wave propagation. Since the exact
epicardial fiber direction is unknown, the angle difference is
calculated by finding the angle of the fitted ellipse relative to the
angle of the 7-ms isochrone. The rotation appeared to continue
at a similar rate, but isochrones reached to the boundary of the
field of view after 12 ms and made it difficult to measure the
angle of propagation reliably. The angle of wave propagation
changed with elapsed time, consistent with the simulation results
in Fig. 3. Experiments were performed on rat left ventricle with

2046

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

Fig. 7. (a) Activation map of a rat heart. Isochrones are shown with black lines.
(b) Angle difference of wave propagation versus elapsed time after stimulus. The
angle of wave propagation has an increasing trend as the time passes after the
stimulation (n = 6). Simulation results for 2 and 4 mm tissues are also provided.
The angle of wave propagation was determined based on the orientation of the
long axis of the best-fit ellipse to the activation time isochrones at the time
indicated post stimulus.

a thickness of 3.5 ± 0.3 mm. The change in angle difference
between the 7 and 10 ms isochrones was 6.8 ± 2.1. The change
in angle was 6◦ and 2.3◦ in simulation results with the OM effect
included for 2- and 4-mm tissues.
IV. DISCUSSION
A. Effect of Fiber Rotation and Wall Thickness
It is clear that the cardiac tissue transmural fiber rotation has a
significant effect on the wave propagation patterns observed on
the epicardium [17]. Thinner tissues have fewer layers so there
is a larger angle difference between layers. Electrical coupling
between nonaligned layers causes surface wave propagation to
not follow fiber orientation. This misalignment is more significant in thinner tissues due to more angle difference between the
layers.
Fig. 1 illustrates an ellipse fitted to the 20-ms isochrone in
the 1-mm-thick tissue (largest error). The fitted ellipse is not
exactly directed to the direction of wave propagation. The reason
is the shape of isochrone (notches) which causes the deviation
between the direction of the isochrone and the ellipse. However
this mismatch actually reduces the error, since the fitted ellipse
is better aligned with the epicardial fiber direction than the
perceived “long axis” of the isochrone.
As the thickness of the tissue increases, adjacent layers have
less angle difference. Deeper layers are less electrically coupled
to the epicardium and, thus, have less effect on surface wave
propagation. This is demonstrated in Fig. 2.
Fig. 3 shows that the angle of propagation not only depends
on thickness but also varies with time after stimulation. It takes
some time for activity to propagate through the tissue to reach
deeper layers. As the epicardial stimulus is delivered, the electrotonic loading from deeper layers that have yet to activate
initially limits the epicardial conduction velocity. As deeper
layers activate, current contributed by the deeper layers interacts with epicardial conduction and the wavefront observed on
the epicardium begins to rotate toward the fiber orientation of
deeper layers. This causes the epicardial wave front to change
the direction over time. The angle of propagation approaches the
steady state as the wavefront propagates through the whole tis-

sue. Our experimental recordings confirmed that the isochrones
rotate with time after the stimulus application (see Fig. 7). These
recordings are qualitatively consistent with the simulations as
depicted in Fig. 3. The simulations appear to underestimate
the size of this response, i.e., the results of a simulation using 2-mm-thick tissue agree quantitatively with experimental
results obtained in a 3.5-mm-thick rat left ventricular free wall.
Possible reasons include the difference between the idealized
model with uniform epicardial fiber orientation and the real
heart, which most likely exhibits some change in epicardial
fiber orientation over the field of view. It is also possible that
our measurement overestimated the left ventricular wall thickness, as these measurements were obtained by slicing the heart
open after the experiment, which may have allowed the heart to
contract somewhat compared to its state during perfusion.
B. Effect of Transmural Conductivity
Another parameter that affects electrotonic loading is the
amount of electrical coupling between the layers, which is
described by transmural conductivity (gn ). Lower transmural
conductivity results in less coupling between the layers and,
therefore, less electrotonic effect from the layers beneath the
epicardium. As depicted in Figs. 3 and 4, in all thicknesses,
tissues with lower transmural conductivity have smaller angle
of deviation from the epicardial fiber direction. However, even
in the extreme case of gn = 18 gt , thinner tissues still show substantial deviation. The effect of transmural conductivity is more
pronounced with time. As time passes and other layers become
excited, underlying layers have more electrotonic loading effect
on the epicardium so the effect of transmural conductivity is
more visible. Reducing transmural conductivity is mathematically equivalent to increasing tissue thickness. It is therefore not
surprising that the effects of changing transmural conductivity
parallel the effects of changing tissue thickness.
C. Effect of Optical Mapping
Table II shows a complete comparison between all the parameters with and without considering the effect of OM. It can
be seen from Table II that when taking OM effects into account,
measurement errors in the structural parameters of cardiac tissue
(AR, angle of propagation, θl , and θt ) are exacerbated due to
light decay effects. Therefore, in general, OM effects increase
error in measurements.
It can be also noted from Table II that for thicker tissues,
the dominant cause of error is OM, and in a thinner tissue the
dominant cause of error is electrotonic loading from underlying
layers. In a 1-mm-thick tissue, OM has a negligible effect on
the measurements and the measurement error arises primarily
from electrotonic effects due to fiber rotation. In a 1-cm slab,
fiber rotation causes small error when OM is not considered.
Accounting for OM increased the measurement error significantly. This is due to the fact that in thin tissues, electrotonic
loading effects are stronger and, also, photons decay less, and
recorded light intensity is affected more by the light intensity of
underlying layers.

GHAZANFARI et al.: COMPUTER SIMULATION OF CARDIAC PROPAGATION

D. Implication for Experimental Measurements
Distortion of wave propagation causes errors in the estimates
of epicardial fiber direction, as well as in measurements of conduction velocities and anisotropy ratio [17]. Our simulations
and experimental observations show that the error in the estimated fiber orientation increases as time elapses poststimulus.
Measurements should therefore be done as soon as possible after stimulation to ensure that electrotonic effects are minimized.
Additional simulation results (not shown) confirmed that this
observation applies not only to the estimated fiber orientation,
but to measurements of AR as well (whether based on the ratio
of long to short axis of the fitted ellipse or based on conduction
velocities). However, it is important to recognize that measurements obtained during, or immediately after, the stimulus pulse
mainly reflect passive depolarization due to the injected stimulus
rather than true propagation of the action potential. Also, during
the early stages of propagation, there is a significant component
of transmural propagation (perpendicular to the plane of imaging) as deeper layers are activated. For both these reasons, sufficient time must be allowed between the stimulus pulse and measurement of fiber orientation, conduction velocities, and AR.
The nominal AR value of the tissue in Fig. 5 is equal to 3,
calculated in a tissue with no fiber rotation. Fitting ellipses to the
activation time isochrones and considering the direction of propagation equal to the direction of those ellipses, not only yields
an inaccurate estimate of the fiber orientation (see Figs. 2–4)
but also results in an error of the AR (see Fig. 5). As previously
explained, when transmural conductivity decreases, epicardial
wave propagation is less distorted. Therefore, AR measurements
are more accurate for tissues with smaller transmural conductivity, especially for thicker tissues. Measurements in thinner tissues are more accurate when transmural conductivity decreases
but there is still a significant error (even in the extreme case of
gn = 18 gt ) due to high electrical coupling. Errors in 1-cm-thick
tissue are not large enough to be considered physiologically relevant, and are presented in this paper for the sake of comparison
and to support the observation that fiber rotation has more effect
in thinner tissues. However errors in thinner tissues are relevant
to experiments in rat or mouse ventricles.
Measurement of conduction velocities is also affected by the
tissue fiber rotation. As the fitted ellipse is not aligned with fiber
orientation on the epicardium, measured velocities are not in the
longitudinal and transverse directions either so measured θl has
a component of transverse conduction and is smaller than the
true θl . Measured θt has a component of longitudinal conduction
and is larger than the nominal θt . Measured θt in thinner tissues
with higher gn has a significant error that can be attributed to the
notch in the isochrones of activation maps for these tissues. This
notch is clearly shown in Fig 2, in 1- and 2-mm-thick tissues, and
has been observed in previous studies [20], [21]. The larger the
notch is, the less accurate the measured transverse conduction
velocities.
In an attempt to reduce the errors incurred in estimating
fiber orientation and AR experimentally, we investigated alternative measurement approaches based on conduction velocity
measurements rather than isochrones. In particular, estimates

2047

based on maximum and minimum conduction velocities along
an isochrone (20 ms in this study), appeared to yield significantly improved estimates of fiber orientation (based on the
direction of θm ax ) and AR (based on the ratio θm ax /θm in ) when
applied to simulated (noise free) data. However, in practice,
these measures proved to be too sensitive to experimental noise
and low pixel resolution to be of practical use. Among the methods considered in this study, our recommendation is thus that
experimental measurements of fiber orientation and AR should
be based on the best-fit ellipse to a suitable activation isochrone.
The measurement errors identified should be taken into account
when interpreting these observations. We cannot rule out that alternative methods, providing a smoother estimate of conduction
velocities, may yield a better estimate of fiber orientation and/or
AR. However, it is worth noting that our estimate of conduction
velocities, being based on a 7 × 7 pixel (approximately 1.75 ×
1.75 mm) area, already employ significant smoothing.
Our results also showed that the reduced coupling between the
layers (in the direction normal to the epicardial surface) result in
more accurate measurements. One may therefore be tempted to
use an uncoupler (e.g., Heptanol) during experiments. However,
application of a gap junction uncoupler will clearly affect the
coupling in all directions. In addition, the effect of an uncoupler may be somewhat different in different directions since the
conductivity along the fibers is due to both myoplasm and gap
junction conductivity, while across the fibers, the conductivity is
mainly due to the gap junctions. Thus, using an uncoupler is not
likely to improve estimates of AR, θl , θt , and fiber orientation
in a predictable manner.
It is also worth noting that using near-infrared dyes as described by Walton et al. [30] will cause increased optical contributions from the underlying layers in the recordings and, therefore, will result in less accurate measurements in this context.
These dyes do have useful applications due to their ability to
penetrate deeper into the tissue. However, for the measurements
discussed in this paper, a shorter penetration depth (shorterwavelength dyes) is preferable.
E. Study Limitations
The experimental optical mapping data has limited spatial
and temporal resolution due to the characteristics of optical
system which are not considered in the simulations. Derived
images also have motion artifacts that can cause inaccuracy
in the data processing step, in particular for the repolarization
phase. Since our calculation and measurements are based solely
on the activation times, the impact of these motion artifacts on
our results expected to be minimal.
The 100-μm spatial step size used in this study is a tradeoff
between computational speed and accuracy as in any numerical
simulation. To assess the sensitivity of the results presented in
this paper to the spatial step size, we repeated three simulations
with a refined step size of 50 μm. We chose a tissue thickness
of 1 mm and repeated the simulations for 1) no fiber rotation
and gn = gt , 2) with fiber rotation and gn = gt , and 3) with
fiber rotation and gn = 1/8 gt . This ensured that the “worstcase” scenario, with the most pronounced transmural voltage

2048

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 7, JULY 2014

gradients (case 3), was included. Values for angle of propagation, anisotropy ratio, and conduction velocities remained within
5% of the values obtained with 100-μm step size, confirming
that the conclusions of this paper do not depend on the exact
spatial discretization. As expected, the largest differences were
observed for a transverse conduction velocity in case 3).
Our model of tissue does not include all the structural details
such as curvature, cleavage planes, and Purkinje system. Tissue
slabs used in our simulations are rectangular parallelepipeds
which have no curvature. Cleavage planes, which are located
between muscle layers, are not included in the model. Purkinje
fibers, which are located in ventricular walls and conduct action
potential more quickly, are not included in our model. These
limitations can be addressed by considering a model with more
detail but this would result in higher computational cost.
V. CONCLUSION
This paper showed that fiber rotation causes an error in conventional measurement methods used to estimate fiber orientation and anisotropy ratio. These errors are affected by the tissue thickness and intramural conductivity and are increased by
optical effects during optical mapping recordings. Despite significant errors in thin tissue preparations, the most appropriate
method (at least of the ones considered here) for estimating fiber
orientation and AR experimentally appears to be least-squares
fitting of an ellipse to an activation time isochrone.
REFERENCES
[1] C. S. Henriquez, A. L. Muzikant, and C. K. Smoak, “Anisotropy, fiber
curvature, and bath loading effects on activation in thin and thick cardiac
tissue preparations: Simulations in a three-dimensional bidomain model,”
J. Cardiovasc. Electrophysiol., vol. 7, no. 5, pp. 424–44, May 1996.
[2] M. Stein, T. A. B. van Veen, R. N. W. Hauer, J. M. T. de Bakker, and
H. V. M. van Rijen, “A 50% reduction of excitability but not of intercellular coupling affects conduction velocity restitution and activation delay
in the mouse heart,” PLoS One, vol. 6, no. 6, p. e20310, Jan. 2011.
[3] M. Stein, T. A. B. van Veen, C. A. Remme, M. Boulaksil, M. Noorman,
L. van Stuijvenberg, R. van der Nagel, C. R. Bezzina, R. N. W. Hauer,
J. M. T. de Bakker, and H. V. M. van Rijen, “Combined reduction of intercellular coupling and membrane excitability differentially affects transverse and longitudinal cardiac conduction,” Cardiovasc. Res., vol. 83,
no. 1, pp. 52–60, Jul. 2009.
[4] E. B. Bourgeois, V. G. Fast, R. L. Collins, J. D. Gladden, and J. M. Rogers,
“Change in conduction velocity due to fiber curvature in cultured neonatal
rat ventricular myocytes,” IEEE Trans. Biomed. Eng., vol. 56, no. 3,
pp. 855–861, Mar. 2009.
[5] C. J. Hyatt, C. W. Zemlin, R. M. Smith, A. Matiukas, A. M. Pertsov,
and O. Bernus, “Reconstructing subsurface electrical wave orientation
from cardiac epi-fluorescence recordings: Monte Carlo versus diffusion
approximation,” Opt. Exp., vol. 16, no. 18, pp. 13758–13772, Sep. 2008.
[6] A. E. Pollard, M. J. Burgess, and K. W. Spitzer, “Computer simulations
of three-dimensional propagation in ventricular myocardium. Effects of
intramural fiber rotation and inhomogeneous conductivity on epicardial
activation,” Circ. Res., vol. 72, no. 4, pp. 744–756, Apr. 1993.
[7] A. Nygren, M. L. Olson, K. Y. Chen, T. Emmett, G. Kargacin, and
Y. Shimoni, “Propagation of the cardiac impulse in the diabetic rat heart:
Reduced conduction reserve,” J. Physiol., vol. 580, Pt. 2, pp. 543–560,
Apr. 2007.
[8] E. W. Hsu, A. L. Muzikant, S. A. Matulevicius, R. C. Penland, and
C. S. Henriquez, “Magnetic resonance myocardial fiber-orientation mapping with direct histological correlation,” Amer. J. Physiol., vol. 274, no. 5,
Pt 2, pp. H1627–H1634, 1998.
[9] D. E. Roberts, L. T. Hersh, and A. M. Scher, “Influence of cardiac fiber
orientation on wavefront voltage, conduction velocity, and tissue resistivity
in the dog,” Circ. Res., vol. 44, no. 5, pp. 701–712, 1979.

[10] B. Taccardi, B. B. Punske, E. Macchi, R. S. Macleod, and P. R. Ershler,
“Epicardial and intramural excitation during ventricular pacing: Effect of
myocardial structure,” Amer. J. Physiol. Heart Circ. Physiol., vol. 294,
no. 4, pp. H1753–H1766, Apr. 2008.
[11] B. Taccardi, E. Macchi, R. L. Lux, P. R. Ershler, S. Spaggiari, S. Baruffi,
and Y. Vyhmeister, “Effect of myocardial fiber direction on epicardial
potentials,” Circulation, vol. 90, no. 6, pp. 3076–3090, Dec. 1994.
[12] A. Nygren, R. B. Clark, D. D. Belke, C. Kondo, W. R. Giles, and
F. X. Witkowski, “Voltage-sensitive dye mapping of activation and conduction in adult mouse hearts,” Ann. Biomed. Eng., vol. 28, no. 8, pp. 958–
967, Aug. 2000.
[13] A. Nygren, C. Kondo, R. B. Clark, and W. R. Giles, “Voltage-sensitive
dye mapping in Langendorff-perfused rat hearts,” Amer. J. Physiol. Heart
Circ. Physiol., vol. 284, no. 3, pp. H892–H902, Mar. 2003.
[14] S. B. Knisley, “Optical mapping of cardiac electrical stimulation,” J.
Electrocardiol., vol. 30, pp. 11–18, Jan. 1998.
[15] M. J. Bishop, B. Rodriguez, J. Eason, J. P. Whiteley, N. Trayanova, and
D. J. Gavaghan, “Synthesis of voltage-sensitive optical signals: Application to panoramic optical mapping,” Biophys. J., vol. 90, no. 8, pp. 2938–
2945, Apr. 2006.
[16] M. J. Bishop, B. Rodriguez, F. Qu, I. R. Efimov, D. J. Gavaghan, and
N. A. Trayanova, “The role of photon scattering in optical signal distortion during arrhythmia and defibrillation,” Biophys. J., vol. 93, no. 10,
pp. 3714–3726, Nov. 2007.
[17] A. Ghazanfari, E. Vigmond, and A. Nygren, “Cardiac fiber rotation distorts
surface measurements of anisotropic propagation,” in Proc. IEEE Eng.
Med. Biol. Soc. Conf., Aug. 2012, vol. 2012, pp. 685–688.
[18] S. V Pandit, R. B. Clark, W. R. Giles, and S. S. Demir, “A mathematical model of action potential heterogeneity in adult rat left ventricular
myocytes,” Biophys. J., vol. 81, no. 6, pp. 3029–3051, Dec. 2001.
[19] O. Bernus, M. Wellner, and A. M. Pertsov, “Intramural wave propagation
in cardiac tissue: Asymptotic solutions and cusp waves,” Phys. Rev. E,
vol. 70, no. 6, pp. 1–7, Dec. 2004.
[20] P. Colli Franzone, L. F. Pavarino, and B. Taccardi, “Effects of transmural
electrical heterogeneities and electrotonic interactions on the dispersion of
cardiac repolarization and action potential duration: A simulation study,”
Math. Biosci., vol. 204, no. 1, pp. 132–165, Nov. 2006.
[21] P. Colli Franzone, L. F. Pavarino, and B. Taccardi, “Monodomain simulations of excitation and recovery in cardiac blocks with intramural heterogeneity,” Funct. Imag. Model., vol. 3504, pp. 267–277, 2005.
[22] E. J. Vigmond, M. Hughes, G. Plank, and L. J. Leon, “Computational
tools for modeling electrical activity in cardiac tissue,” J. Electrocardiol.,
vol. 36, pp. 69–74, Dec. 2003.
[23] I. J. Legrice, P. J. Hunter, and B. H. Smaill, “Laminar structure of the
heart: A mathematical model,” Amer. J. Physiol., vol. 272, no. 5, Pt 2,
pp. H2466–H2476, May 1997.
[24] G. E. Morley, D. Vaidya, and J. Jalife, “Characterization of conduction
in the ventricles of normal and heterozygous Cx43 knockout mice using
optical mapping,” J. Cardiovasc. Electrophysiol., vol. 11, no. 3, pp. 375–
377, Mar. 2000.
[25] P. V Bayly, B. H. KenKnight, J. M. Rogers, R. E. Hillsley, R. E. Ideker,
and W. M. Smith, “Estimation of conduction velocity vector fields from
epicardial mapping data,” IEEE Trans. Biomed. Eng., vol. 45, no. 5,
pp. 563–571, May 1998.
[26] N. Mazeh, D. E. Haines, M. W. Kay, and B. J. Roth, “A simplified approach for simultaneous measurements of wavefront velocity and curvature in the heart using activation times,” Cardiovasc. Eng. Technol., vol. 4,
no. 4, pp. 520–534, Jun. 2013.
[27] M. W. Kay and R. A. Gray, “Measuring curvature and velocity vector
fields for waves of cardiac excitation in 2-D media,” IEEE Trans. Biomed.
Eng., vol. 52, no. 1, pp. 50–63, Jan. 2005.
[28] D. Janks and B. Roth, “Averaging over depth during optical mapping of
unipolar stimulation,” IEEE Trans. Biomed. Eng., vol. 49, no. 9, pp. 1051–
1054, Sep. 2002.
[29] W. T. Baxter, S. F. Mironov, A. V. Zaitsev, J. Jalife, and A. M. Pertsov,
“Visualizing excitation waves inside cardiac muscle using transillumination,” Biophys. J., vol. 80, no. 1, pp. 516–530, Jan. 2001.
[30] R. D. Walton, D. Benoist, C. J. Hyatt, S. H. Gilbert, E. White, and
O. Bernus, “Dual excitation wavelength epifluorescence imaging of transmural electrophysiological properties in intact hearts,” Heart Rhythm,
vol. 7, no. 12, pp. 1843–1849, Dec. 2010.

Authors’ photographs and biographies not available at the time of publication.

