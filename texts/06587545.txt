IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

381

Beam Position and Energy Monitoring in Compact
Linear Accelerators for Radiotherapy
Marcel Ruf∗ , Sven Müller, Stefan Setzer, and Lorenz-Peter Schmidt, Senior Member, IEEE

Abstract—The experimental verification of a novel sensor topology capable of measuring both the position and energy of an electron beam inside a compact electron linear accelerator for radiotherapy is presented. The method applies microwave sensing
techniques and allows for the noninterceptive monitoring of the
respective beam parameters within compact accelerators for medical or industrial purposes. A state space feedback approach is described with the help of which beam displacements, once detected,
can be corrected within a few system macropulses. The proofof-principle experiments have been conducted with a prototype
accelerator and customized hardware. Additionally, closed-loop
operation with high accuracy is demonstrated.
Index Terms—Beam diagnostics, capacitive sensors, electron accelerators, linear accelerators, microwave sensors, state feedback.

I. INTRODUCTION
ADIOTHERAPY is one of the major treatment options
for patients suffering from cancer [1]. Despite upcoming
new techniques like proton, carbon or oxygen ion therapy [2],
conventional radiotherapy based on high-energy photon radiation is still widely applied due to its high efficiency at reasonable
cost and size of the required machinery.
Gamma radiation sources for radiotherapy applications employ high-energy electrons in the energy range from 6 to 25
MeV which are commonly generated by compact linear accelerators (linacs). After the accelerator section, the electrons are
directed onto a flat high-Z target where they are converted into
hard gamma radiation. To flatten the radiation behind the target,
a cone-shaped filter is used in most treatment cases. The homogeneity of the dose profile behind the flattening filter is strongly
affected both by the location and the impinging angle of the
gamma radiation at the tip of the cone. Thus, a well-defined

R

Manuscript received April 11, 2013; revised June 22, 2013; accepted July 31,
2013. Date of publication August 28, 2013; date of current version January 16,
2014. This work was supported in part by the Bayerische Forschungsstiftung
in the project “MEDieMAS—Effiziente Bestrahlungsgeräte für Krebstherapie
(Efficient radiation systems for cancer therapy).” Asterisk indicates corresponding author.
∗ M. Ruf is with the Institute of Microwaves and Photonics, University
of Erlangen-Nuremberg, Erlangen 91058, Germany (e-mail: marcel@lhft.eei.
uni-erlangen.de).
S. Müller is with the Siemens AG, Healthcare Sector, Rudolstadt 07407,
Germany (e-mail: sven.svm.mueller@siemens.com).
S. Setzer is with Siemens AG, Healthcare Sector, Erlangen 91054, Germany
(e-mail: stefan.setzer@siemens.com).
L.-P. Schmidt is with the Institute of Microwaves and Photonics, University of Erlangen-Nuremberg, Erlangen 91058, Germany (e-mail: lps@lhft.eei.
uni-erlangen.de).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/TBME.2013.2279793

and stable trajectory of the electron beam being the source for
the gamma radiation is crucial to maintain optimal treatment
conditions.
In modern radiotherapy machines, segmented ionization
chambers mounted between the radiation source and the patient are used as a final monitoring device to ensure patient
safety throughout the treatment. However, the electron beam
position inside the accelerating structure being the cause for inhomogeneous dose profiles has not been accessible up to now
as it cannot be measured by those means. Thus, equipping an
electron linac with beam position sensors could be an important
contribution in the development of future radiotherapy devices.
Beam instrumentation is a vital task in every accelerator facility [3]. When it comes to beam position monitoring (BPM),
multiple approaches to derive information about the beam position can be found in the literature, each having individual pros
and cons regarding size, sensitivity, and complexity. The button electrode [4] is the smallest of all pickups and is widely
used in electron accelerator facilities due to its small size and
ease of manufacturing. Stripline sensors [5] offer higher signal
amplitudes and directional operation for counterrotating beams
at the expense of greater dimensions. Excellent accuracy can
be obtained by a BPM cavity [6] in which the beam excites
a resonant waveguide mode with a position-dependent amplitude and phase. There are multiple other sensor concepts which
are optimized for circular accelerators or proton and hadron
beams, such as the diagonal-cut sensor [7] as well as sensors
based on synchrotron radiation [8] or residual gas interaction
[9].
In the predominant majority of high-energy physics accelerators, individual sensor sections are used which are separated
from the accelerating sections. This concept cannot be transferred to compact linacs used in radiotherapy systems in most
cases because of spatial limitations. The approach of evaluating
the output signals of higher order mode dampers for BPM purposes [10] would require major modification of compact linacs.
Consequently, the direct integration of the sensors into the accelerating structure is the only option when increasing length is
prohibited.
A novel approach to gather information about the beam position inside an accelerator was described in [11]. The concept is
based on pickups of the button type integrated in a low-field region of the accelerator [12]. An experimental investigation of a
suitable probe geometry can be found in [13]. The signals which
can be extracted from the probes contain BPM information at
microwave frequencies. Suitable RF receiver architectures have
been developed from scratch and are partly described and validated both in [14] and [15].

0018-9294 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

382

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

At this point, the standing wave of the accelerating field shows
a node resulting in a low-field area compared to the accelerating
field within the cells. Moreover, as the bunches follow each
other periodically in time, the spectral content of a signal s(t)
derived from the beam by means of the probes is a line at the
accelerating frequency ωRF and whole-number harmonics:
Fig. 1. Concept of a standing wave linac with integrated beam position sensors. The Coulomb field of the electron bunches is disk-like due to Lorentzcontraction at relativistic energies. Separation of beam-induced field components and interfering parasitics is possible by locating the probes in a low-field
region and processing higher beam harmonics.

In this paper, experimental evidence is presented showing that
the proposed method is feasible. A linac with four integrated
buttons is described. It is demonstrated that the beam position
in both the horizontal and the vertical planes can be extracted
independently from each other and with virtually no effect on the
performance of the accelerator. Furthermore, evidence is given
that a multidimensional state space feedback approach can be
used to steer a beam back on track once displacements have
been detected. To the best knowledge of the authors, similar
results have not been published before.
II. CONCEPT DISCUSSION
A linear accelerator used in radiotherapy devices consists of
a stack of waveguide resonators (or cells). The geometry of the
cells is designed such that, comparable to the well-known E010
field pattern, the field distribution contains a strong longitudinal
component of the electric field in the geometrical center of the
cell. As this is also the beam propagation axis, the electric field
can be used to efficiently accelerate electrons.
Every cell is tuned to the same accelerating frequency. From
the theory of coupled waveguide resonators [16], it is known that
a set of N coupled resonators results in N different modes of the
same field pattern, each differing slightly in the resonance frequency and phase advance between adjacent resonators. Compact linacs of the biperiodic structure are typically run in the
π/2-mode, where adjacent resonators show a phase difference
of 180◦ . When an electron enters such a coupled resonator structure at the correct phase and the resonator length is tailored to
the electron velocity, the particle is accelerated in every individual cell until it reaches the design energy at the end of the linac.
However, as some electrons approach the decelerating phase
while entering the linac, a dc-like injected electron beam is split
into discrete bunches which are separated in time by the period
of the RF used for acceleration.
To accelerate electrons to a maximum energy of 25 MeV
within just about 1 m of length, an electric field strength in the
range of 25 MV/m is necessary. This gradient implies that the
coupling to the beam’s Coulomb field in order to derive beam
position information inside the linac has to be carried out in
presence of the very strong accelerating field.
However, beam-induced signals within the accelerator can be
separated from parasitic-field-induced signals if the probes are
located between two main resonating cells as depicted in Fig. 1.

s (t) = savg +

∞


sm cos (mωRF t)

(1)

m =1

where sm indicates the amplitude of the mth harmonic in the
Fourier expansion of s(t). In contrast to that, the accelerator
shows waveguide dispersion, so that higher structure harmonics do not necessarily coincide with beam harmonics. Consequently, narrow-band processing of a beam harmonic at mωRF
prevents the measurement from being falsified by any parasitic
coupled out of the linac.
III. LINEAR ACCELERATOR WITH INTEGRATED SENSORS
A commercially available linac from Siemens company (multienergy S-Band side-coupled standing-wave type) has been
modified in a way that one main cell has been equipped with
four pickup probes. We decided to use button electrodes as this
is the only probe type small enough to meet the space limitations
given by the linac geometry.
The button geometry has been designed from scratch both for
high beam position sensitivity and low probe-to-probe crosscoupling (see Section IV). A major concern for the integration
of the buttons into the linac has been vacuum tightness. Linacs
have to be operated in the ultrahigh vacuum pressure range so
that the mean free path of the electrons exceeds the accelerator
length by some orders of magnitude. On the other hand, a coaxial
waveguide structure contacting the probes is necessary to be able
to couple signals outward from the accelerator’s interior via the
probes.
These constraints are both solved by using one ceramic
(Al2 O3 ) bushing for each probe which is metallized both on
the inner and the outer surfaces. Firstly, the probe is brazed into
the bushing employing the bushing’s inner metallization. After
that, at a lower temperature, four probe-bushing assemblies are
brazed into one main cell of the accelerator using the bushing’s
outside metallization. Finally, the modified cell is used together
with all other cells in the fabrication process of the accelerator. Vacuum seals produced this way are compatible with the
required vacuum pressure in the linac due to negligible leakage
rate.
Fig. 2 shows a computer simulation technology (CST) model
of the probes, the fabricated main cell with four integrated
probes as well as the whole accelerator with one coaxial
subminiature-A (SMA) probe connector.
IV. PICKUP PROBE PERFORMANCE
A button electrode for BPM purposes can be interpreted as
a slot antenna operated far below its fundamental resonance,
thus showing primarily capacitive impedance. When an electron bunch passes the button, the button gently couples to its

RUF et al.: BEAM POSITION AND ENERGY MONITORING IN COMPACT LINEAR ACCELERATORS FOR RADIOTHERAPY

(a)

383

(b)

Fig. 3. Linearization of the sensitivity map for both transversal planes. Gray
dots mark the initial map and the circles the linearization result. The solid black
dot indicates the mapping result of the measurement value −2 mm/−1.5 mm.

(c)
Fig. 2. Linear accelerator with integrated pickup probes. Panel (a) depicts the
CST (computer simulation technology AG) model including a cutaway view
of both the bushings and the probes of the sensor quad. Panel (b) shows the
modified linac cell which actually is a back-to-back configuration of two halfresonators. The probe surfaces as well as the coaxial connecting structure are
clearly visible. Panel (c) is a photograph of the linac with the SMA connector
of one probe as an inset.
TABLE I
PROBE PARAMETERS AT 5.996 GHz

level difference between opposing probes in dB/mm of beam
displacement. It is an important value as it also defines the influence of noise on the measurement accuracy. Due to the close
vicinity of the probes with regards to the beam, the sensitivity
is high enough to ensure accurate beam position determination
as demonstrated in Section VIII-A.
The sensitivity does not remain constant for all locations
in the transversal plane. Instead, nonlinear distortions in the
sensitivity value can be observed if the beam goes far off-center.
However, the sensitivity map can be linearized by using N thorder polynomials as described in [18]. (2) shows how the real
x-value can be derived from the measured x- and y-readings:
xreal =

N
N 


n
am n xm
m eas ym eas .

(2)

m =0 n =0

Coulomb field. The connecting rod shown in Fig. 2(a) acts as
an inner conductor of a coaxial transmission line which guides
the signal out of the structure. It can be shown that this signal
is the time derivative of the electron bunch shape consisting of
periodic pulses in the time domain, where the pulse repetition
rate equals the bunch repetition rate and the pulse amplitude
scales with the beam current and the bunch–probe distance. In
the frequency domain, beam position information for each plane
can be derived from each line in the spectrum by comparing the
amplitudes of the signals extracted from two opposing probes.
The modified accelerator shows a resonant frequency of
2.998 GHz. According to Section II, a higher harmonic must be
processed to prevent the beam-induced signal from being superimposed by higher structure harmonics. The second harmonic
(m = 2 in (1)) at 5.996 GHz has been chosen as evaluation
frequency. Table I lists the most important parameters of the
probes for this frequency. The sensitivity determines the power-

(2) requires that the coefficients am n be obtained from a
calibration measurement. Therefore, a stretched wire is excited
at mωRF (see (1)) and moved at known locations on the beam
propagation axis (xreal and yreal ) between the probes to emulate
the beam. Recording xm eas and ym eas , (2) can be solved for the
am n coefficients applying least-squares fitting. The equation
for the real y-value reads as (2) except a set of coefficients bm n
has to be used and derived from stretched wire calibration data
beforehand.
Fig. 3 depicts the sensitivity map of the integrated button
quad before and after linearization. Each gray dot on the maps
represents one beam position measurement value taken over a
±3 mm range in steps of 1 mm. The circles are the linearization
result for the respective dots. The images also show how an
exemplary measurement value xm eas = −2 mm and ym eas =
−1.5 mm is mapped onto a slightly different location in the map
after linearization.
V. RF RECEIVER TOPOLOGY
As dedicated hardware in the frequency range of interest
is currently not available, an RF receiver has been built from
scratch [14]. It employs an eight-channel architecture as two
pickup sections with four probes each are required to measure
both the beam position and trajectory angle.
Each receiver channel comprises a heterodyning section for
downconversion of the 5.996-GHz beam harmonic, after which
amplitude detection is conducted by logarithmic amplifiers of
the AD 8317 type. The error signal for one plane is obtained
as the difference between the dc voltages of two channels

384

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

Fig. 4. Schematic overview of developed eight-channel receiver (the LNA
behind the pickups is optional and has not been used in the experiments described
in Section VIII due to sufficient power levels). A photograph of the receiver can
be found in [14].

representing opposing probes. This so-called log-ratio principle [19] is a well-known signal processing method for BPM purposes as the required circuitry is fairly easy to implement and the
dc error output voltage is independent of the beam current over a
dynamic range of more than 50 dB. A signal processing topology
based on the amplitude modulation–phase modulation principle
(AM-PM, [20]) has also been investigated [15]. However, log
ratio is preferred over AM-PM due to the latter’s low dynamic
range and calibration complexity.
Fig. 4 is a schematic overview of the developed receiver. The
conversion gain of the heterodyning section is 4.7 dB with a
standard deviation (σ) of 0.6 dB. Input compression and thirdorder intercept occur at −1.5 dBm (σ = 1.2 dBm) and 9.1 dBm
(σ = 2.3 dBm), respectively. The RF frontend works at quite
a high noise figure of 13.4 dB (σ = 0.5 dB), because in the
experiments, no low-noise amplifiers (LNAs) have been used
due to sufficient power levels. Thus, the noise figure includes
the full mixer conversion loss which is about 10 dB.
The modified accelerator of Section III shows a higher eigenresonance at a frequency of 6100 MHz which is quite close
to the signal processing frequency of 5996 MHz. Thus, input
bandpass filters are required to preselect the desired beam harmonic and attenuate parasitic signals at 6100 MHz. From the
plethora of available RF filter concepts, rectangular waveguide
resonator bandpass filters have been chosen because of their low
insertion loss and high selectivity. Moreover, waveguide filters
can effectively suppress any signal at the accelerator’s fundamental frequency if the waveguide dimensions are chosen such
that its cutoff frequency significantly exceeds the accelerating
frequency. The filter is based on a fourth-order Chebyshev bandpass design. Measurement data reveal a passband insertion loss
of less than 0.5 dB and excellent return loss of slightly more than
20 dB for each of the eight filters manufactured. The stopband
attenuation values exceed 30 dB at 6100 MHz and 120 dB at
2998 MHz.
As the high-power RF tube source driving the linac operates
in pulsed mode, beam position data are only available for pulse
lengths of 3–5 μs. Two synchronized ADC cards from Spectrum Company, each running at 20 MS/s/ch, are used to digitize
the voltages off the logarithmic amplifier outputs and collect
roughly about 100 samples per pulse. The data are averaged so
that one error value is generated for each measurement plane
and system macropulse. It is fed into a LabVIEW tool which
displays the data, applies the control algorithm, and sends feed-

Fig. 5. Measurement setup comprising modified linac, external pickup quad,
corrector coils, and dose profile monitor. The configuration of the coils is exemplary for deflection and correction in the y–z plane.

back signals to the coils which are used as corrector devices for
the beam position (see Fig. 5).
VI. STATE SPACE FEEDBACK
One goal of the work has been that beam displacements, once
detected, be corrected within only a few macropulses with the
help of corrector coils attached to the accelerator. There is more
than one sensor and more than one corrector in each transversal
plane. To solve this multiple-input-multiple-output problem, we
investigated a state space representation of the system which
combines all beam position errors (the state variables) in one
error vector Δx and all currents through the corrector magnets
 The error vector
(the actuating variables) in another vector ΔI.
in the (k + 1)th cycle of the control loop is calculated from
the respective vector of the kth cycle and a correction vector
comprising the coil currents as
Δxk +1 = Δxk + RΔIk .

(3)

In (3), the matrix R is the beam response matrix. The individual entries of this matrix can be interpreted as beam position changes induced by magnet current changes. They can
be obtained by setting small correction currents at all coils
sequentially and recording the resulting changes in the beam
position [21].
In the kth cycle of the control loop, the vector of the actuating
variables is calculated from the error vector using the control
matrix K:
ΔIk = −KΔxk .

(4)

Combining (3) and (4), the state space representation of the
closed feedback loop reads [22]
Δxk +1 = (I − RK) Δxk

(5)

where I is the identity matrix. The entries of the control matrix
K in (5) can be obtained by using the condition that a feedback
loop shows stability if all eigenvalues of the closed feedback
are located inside the complex unit circle. Thus, by deliberately
setting the eigenvalues inside the unit circle, the entries of K
can be calculated:
n

det (λI − (I − RK)) = Π (λ − λv )
v =1

(6)

where λν are the eigenvalues of the closed loop. It can be derived from the pole assignment (6) that using the inverted beam
response matrix R−1 as control matrix K leads to deadbeat

RUF et al.: BEAM POSITION AND ENERGY MONITORING IN COMPACT LINEAR ACCELERATORS FOR RADIOTHERAPY

385

(a)
Fig. 6. Beam position inside the accelerator measured at 5.996 GHz versus
dose profile offsets for a 6-MeV/20-mA electron beam.

control behavior, where the error vector vanishes in the least
possible number of cycles. Placing the eigenvalues at other locations within the unit circle affects both the control speed as
well as the control loop attenuation. If the rules for robust pole
assignment given in [23] are obeyed, the control loop dynamics
can be manually adjusted, as demonstrated in Section VIII.
VII. MEASUREMENT SETUP
The measurement setup used for experiments with the modified linear accelerator described in Section III is depicted in
Fig. 5.
It comprises the linac which allows for variations in both
electron beam energy and current. The modified accelerator cell
is mounted in close vicinity to the beam bending section which
in treatment operation directs the electron beam to the patient.
Two Helmholtz coils are used as beam position corrector devices
in one of the two transversal planes (x or y). The third coil is
used to deliberately deflect the beam from its ideal trajectory
within the accelerator to test the feedback loop.
Two setups have been used on top of the beam bending section. Setup 1 consists of a photon target and a dose profile
monitor and allows for comparing beam displacements inside
the accelerator with an averaged offset of the gamma radiation
dose profile. Setup 2 comprises a second pickup quad which
can be used as an external BPM device to test the multidimensional state space feedback approach with two state variables
(the position errors at the two measurement locations) and two
actuators (the correction coils), respectively. No photon target
is used in this case as the electron beam behind the bending
section is subject of investigation.
VIII. MEASUREMENT RESULTS
A. Proof-of-Principle and Accuracy
To compare beam position measurements with dose profile
deviations, a 6-MeV electron beam with an averaged beam current of 20 mA has been used. With the help of the deflection
coil, a beam position offset of ±5 mm (the range of the diameter of the aperture between adjacent cells) in the x-plane has
been set at the location of the integrated probes. Fig. 6 depicts
the resulting dose profile offset as well as the beam position
in x- and y-planes which was measured at 5.996 GHz by the
receiver described in Section V. The figure primarily indicates

(b)
Fig. 7. (a) Closed-loop operation of the digital feedback architecture. Panel
(b) shows the feedback current for different control dynamic settings.

that the beam position sensing concept described in Section II
is feasible.
Moreover, Fig. 6 reveals that, after a suitable receiver calibration has been applied [24], the beam position is measured
correctly by the integrated probes. Obviously, quite a linear correlation exists between the dose profile offset and beam displacements which can be used for stabilization of the dose profile by
stabilizing the beam. In the orthogonal plane, as expected from
the buttons’ high x–y-decoupling value given in Table I, only a
negligible reaction in the measured y-plane beam position can
be observed which can be traced back to a slight parasitic field
component in the x-plane generated by the Helmholtz coils.
Fig. 6 also depicts the noise of the measurement readings
expressed as standard deviation of the respective error voltages generated by the logarithmic amplifiers. The beam position noise can be derived by dividing this value by the probe
sensitivity given in Table I times the RF-dc-conversion constant
of the logarithmic amplifiers which, in the case of the used
AD 8317 devices, is 25 mV/dB. Taking those values into consideration, the voltage noise readings measured at small beam
displacements reveal a beam position noise as low as 20 μm. The
noise goes up in the case of an off-center beam position because
the RF power at the farther pickups drops below the detection
threshold of the logarithmic amplifiers for the used beam current. At this point, we deliberately challenged our measurement
setup as beam currents considerably higher than the used 20 mA
can be expected in treatment operation of the linac.
B. Beam Position Feedback
Setup 2 (see Section VII) was used to test the performance
of the state space feedback. At first, the beam response matrix
was recorded as described in Section VI with the matrix entries
spanning a range from 0.15 to 3.34 mm/A. In this representation,
the control path is described as static and the beam bending
section is treated as a parasitic field component the influence
of which is covered by the matrix entries R21 and R22 . Fig. 7

386

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 61, NO. 2, FEBRUARY 2014

shows the results of the closed-loop operation of the feedback
architecture.
Fig. 7(a) depicts the measured beam displacements from center position at the two measurement locations 1 and 2 for arbitrary deflections caused by the deflection coil. Fig. 7(a) indicates
that the control loop is able to correct beam displacements independent of amplitude and direction quickly and accurately.
Stability of the control loop is achieved by calculating the control matrix K from two eigenvalues inside the complex unit
circle as predicted in (6). The curve tip cutoff at D1, D4, D5,
and D6 occurs due to the axis scaling and can be traced back to
beam displacements exceeding ±1 mm.
Fig. 7(b) depicts the control loop dynamics for four different eigenvalue settings. As expected, a double-zero eigenvalue
results in deadbeat control. Choosing positive real eigenvalues
and placing them closer to the edge of the unit circle results
in a lower control speed as indicated by the dash-dotted and
the dashed curve. Still, the control loop attenuation equals 1 in
these cases and no overshoots can be observed. This behavior
changes with adding an imaginary part to the eigenvalues. It
follows both from theory and the results in Fig 7(b) that the
control loop attenuation remains below 1 which results in overshoots in the coil current. In summary, Fig 7(b) suggests that
deadbeat control should be chosen for real-life applications as
it guarantees both robust and fast feedback.
C. Beam Energy Measurement
The integrated probes not only allow for measuring beam
position, but also beam energy due to the behavior of relativistic
electrons. It is well known that electrons leaving a thermionic
gun already travel at relativistic velocities and approach speed
of light very rapidly when accelerated. Thus, with a further
increase in energy, the electrons travel at a constant speed and
only gain mass.
In a linac, a substantial increase in the electron speed can
only be observed in the first few cells (the “buncher” cells as
also the bunching process takes place at this location). After
the buncher section, it is assumed in accelerator design that
the electrons travel constantly at the speed of light. When an
increase in the final electron energy is desired, a higher RF
power is fed into the accelerator which also increases the electric
field strength in the buncher cells. This leads to the electrons
approaching speed of light at a slightly earlier location in the
linac, as in the buncher cells energy gain is still connected
to velocity gain. Consequently, the phase relation between the
electron and the standing wave within the linac changes with
electron energy [10].
To verify this theory, the signal from one of the integrated
pickups and a fraction of the input RF power have been used as
input signals of a double-balanced ring mixer which is known
for phase-discriminating properties. The mixer’s dc output was
set to zero at a reference energy of 17 MeV by means of a
phase shifter. We then changed the beam energy and obtained
the phase difference to the reference value by the phase shifter
position necessary for vanishing dc output voltage of the mixer.
Fig. 8 depicts the result of this experiment.

Fig. 8. Phase between electron bunch arrival at accelerator cell center and the
maximum of the standing wave’s electric field at this location as a function of
the electron energy showing monotonic relation.

Fig. 8 reveals both the feasibility of the method and a monotonic relation between the measured phase and the electron
energy. The curve is nonlinear as also the electron energy does
not show a linear dependence from the input RF power. Measuring beam energy as described could be especially useful in
linac configurations where no bending magnet is used and energy monitoring via bending radius is not possible. However, the
averaged slope in Fig. 8 of 4◦ /MeV indicates that resolving the
typically small energy variations in practice requires extremely
stable phase discriminating characteristics of the RF topology
in use.
IX. CONCLUSION
The performance of a beam position and an energy monitoring
system for compact linear accelerators has been investigated.
For the first time, it allows for monitoring critical electron beam
parameters within a compact linac for industrial or medical
purposes.
Further investigation might be conducted on miniaturization
of the RF receiver. Moreover, placing the receiver frontend in
direct vicinity of the linac in a radiation hard packaging could
contribute to the overall noise performance. Manufacturing a
linac with two integrated probe sections instead of one would
be a worthwhile next developmental step.
ACKNOWLEDGMENT
The first author would like to thank the Siemens AG for the
fabrication of the modified linac and the granted time in the
bunker.
REFERENCES
[1] R. Sauer, Strahlentherapie und Onkologie. Munich, Germany: Elsevier,
2010.
[2] M. Schwickert and A. Peters, “Diagnostic instrumentation for medical
accelerator facilities,” in Proc. 8th Eur. Workshop Beam Diagn. Instrum.
Part. Accel., Venice, Italy, 2007, pp. 381–385.
[3] P. Strehl, Beam Instrumentation and Diagnostics. Berlin, Germany:
Springer-Verlag, 2006.
[4] S. R. Marques et al., “Design of button beam position monitor for the
Brazilian synchrotron light source,” in Proc. 22nd Part. Accel. Conf.,
Albuquerque, NM, USA, 2007, pp. 3871–3873.
[5] M. Dehler, G. Behrmann, and S. Vilcins, “Stripline devices for FLASH
and European XFEL,” in Proc. 13th Beam Instrum. Workshop, Tahoe City,
CA, USA, 2008, pp. 110–114.
[6] A. Lunin, G. Romanov, N. Solyak, and M. Wendt, “Design of a submicron
resolution cavity BPM for the ILC main linac,” in Proc. 8th Eur. Workshop
Beam Diagn. Instrum. Part. Accel., Venice, Italy, 2007, pp. 192–194.

RUF et al.: BEAM POSITION AND ENERGY MONITORING IN COMPACT LINEAR ACCELERATORS FOR RADIOTHERAPY

[7] J. Harasimowicz and C. P. Welsch, “Beam position monitor development
for the USR,” in Proc. 14th Beam Instrum. Workshop, Santa Fe, NM,
USA, 2010, pp. 252–256.
[8] P. Bergonzo et al., “Diamond-based semi-transparent beam-position monitor for synchrotron radiation applications,” J. Synchrotron Rad., vol. 6,
pp. 1–5, Jan. 1999.
[9] P. Ilinski, U. Hahn, H. Schulte-Schrepping, and M. Degenhardt, “Residual
gas X-ray beam position monitor development,” AIP Conf. Proc., vol. 879,
pp. 782–785, May 2006.
[10] S. Molloy, J. Frisch, D. McCormick, J. May, M. Ross, and T. Smith, “High
precision superconducting cavity diagnostics with higher order mode measurements,” Phys. Rev. Spec. Topics Accel. Beams, vol. 9, no. 112802,
pp. 1–13, 2006.
[11] M. Ruf, L.-P. Schmidt, and S. Setzer, “Beam Position monitoring based on
higher beam harmonics for application in compact medical and industrial
linear electron accelerators,” in Proc. 1st Int. Part. Accel. Conf., Kyoto,
Japan, 2010, pp. 900–902.
[12] S. Setzer, M. Ruf, and L.-P. Schmidt, “Method and device for measuring
the location of a particle beam present in packets in a linear accelerator,”
Patent WO 2011/061060, May 26, 2011.
[13] M. Ruf, L.-P. Schmidt, and S. Setzer, “Validation of electron beam position
monitoring probes by comparison of dose profile measurements with beam
displacement sensing in the micowave range,” in Proc. 25th Asia Pac.
Microw. Conf., Melbourne, Australia, 2011, pp. 1410–1413.
[14] M. Ruf, L.-P. Schmidt, and S. Setzer, “Beam position monitoring based on
RF heterodyning and log-ratio signal processing for electron accelerator
systems,” in Proc. 41st Eur. Microw. Conf., Manchester, U.K., 2011,
pp. 603–606.
[15] M. Ruf, P. Quednau, L.-P. Schmidt, and S. Setzer, “Applicability of
the AM-PM conversion method to beam position monitoring of electron beams accelerated in S-band frequency range,” in Proc. 10th Eur.
Workshop Beam Diagn. Instrum. Part. Accel, Hamburg, Germany, 2011,
pp. 86–88.
[16] D. E. Nagle, E. A. Knapp, and B. C. Knapp, “Coupled resonator model
for standing wave accelerator tanks,” Rev. Sci. Instrum., vol. 38, no. 11,
pp. 1583–1587, Nov. 1967.
[17] Q. Luo, B. G. Sun, J. Fang, and D. H. He, “Cold test of S-band re-entrant
cavity BPM for HLS,” in Proc. 1st Int. Part. Accel. Conf., Kyoto, Japan,
2010, pp. 1032–1034.
[18] T. Suwada, N. Kamikubota, H. Fukuma, N. Akasaka, and H. Kobayashi,
“Stripline-type beam-position-monitor system for single-bunch electron/positron beams,” Nucl. Instrum. Methods Phys. Res., vol. A 440,
pp. 307–319, Feb. 2000.
[19] F. D. Wells, R. E. Shafer, and J. D. Gilpatrick, “Beam position monitoring
in the 100-MHz to 500-MHz frequency range,” in Proc. 15th Part. Accel.
Conf., Washington, DC, USA, 1993, pp. 2316–2318.
[20] M. Wendt, “BPM read-out electronics based on the broadband AM/PM
normalisation scheme,” in Proc. 5th Eur. Workshop Diagn. Beam Instrum.,
Grenoble, France, 2001, pp. 63–65.
[21] Y. Chung, G. Decker, and K. Evans Jr., “Closed orbit correction using
singular-value decomposition of the response matrix,” in Proc. 15th Part.
Accel. Conf., Washington, DC, USA, 1993, pp. 2263–2265.
[22] R. C. Dorf and R. H. Bishop, Modern Control Systems. Upper Saddle
River, NJ, USA: Prentice–Hall, 2008.
[23] J. Kautsky, N. K. Nichols, and P. van Dooren, “Robust pole assignment in
linear state feedback,” Int. J. Control., vol. 41, no. 5, pp. 1129–1155, Oct.
1985.
[24] E. A. Medvedko, R. G. Johnson, and S. Smith, “LCLS stripline BPM
system commissioning,” in Proc. 23rd Part. Accel. Conf., Vancouver, BC,
Canada, 2009, pp. 4027–4029.

387

Marcel Ruf received the Dipl.-Ing. and Ph.D. degrees in electrical engineering
from the Friedrich-Alexander-University of Erlangen–Nuremberg, Erlangen,
Germany, in 2006 and 2013, respectively.
Since October 2006, he has been with the Institute of Microwaves and
Photonics, University of Erlangen-Nuremberg. His research interests include
the development and fabrication of submillimeter wavelength multipliers and
mixers, as well as, more recently, beam instrumentation for medical linear
electron accelerators.

Sven Müller received the Dipl.-Physiker and Ph.D. degrees in physics from the
Technical University of Clausthal, Clausthal, Germany and the University of
Heidelberg, Heidelberg, Germany, in 2003 and 2006, respectively.
From 2006, he was a Postdoctoral Research Associate with the German
Cancer Research Center, Heidelberg, Germany. Since 2007, he has been with
Siemens Healthcare, Rudolstadt, Germany. His research interests include magnetic resonance imaging and accelerators for medical applications.

Stefan Setzer received the Dipl.-Ing. and Ph.D. degrees in electrical engineering from the Technical University of Darmstadt, Darmstadt, Germany, in 1997
and 2003, respectively.
From 2003, he was a Postdoctoral Research Associate with the Technical
University of Darmstadt. Mid of 2004 he joined Siemens Healthcare, Erlangen,
Germany. His research interests include theoretical electrodynamics, accelerators, as well as the generation of X-rays for medical applications.

Lorenz-Peter Schmidt (M’87–SM’02) received the Dipl.-Ing. and Ph.D.
degrees in electrical engineering from the Technical University of Aachen
(RWTH), Aachen, Germany, in 1974 and 1979, respectively.
In 1979, he was a Postdoctoral Research Associate with The University of
Texas, Austin, TX, USA, dealing with the full-wave analysis of quasi-planar
transmission lines. From 1980, he was with AEG–Telefunken (later DASA
and now EADS), Ulm, Germany, where he later became the Head of the Corporate Advanced Microwave and Millimeter Wave Development Department.
His R&D activities included GaAs monolithic microwave-integrated circuit design up to 100 GHz, millimeter-wave interconnect and packaging technologies,
radar sensors, transceiver front-end technology, and antennas in the range of 10–
100 GHz. Since 1998, he has been a Full Professor with the Friedrich-AlexanderUniversity, Erlangen–Nuremberg, Germany, where he holds the Chair of the
Institute of Microwave and Photonics. His main research interests include the
field of mmW and THz components and antenna technologies as well as active
and passive imaging systems, laser technology, and the microwave/photonic
interaction.
Dr. Schmidt is a member of the Association for Electrical, Electronic and
Information Technologies (VDE) and the German IEEE Microwave Theory and
Techniques/Antennas and Propagation Chapter Commission. He is the Chairman of the Expert Group on Microwave Techniques of the VDE/Information
Technology Society. He served as the General Chairman of the European Microwave Week and the Chairman of the European Microwave Conference in
Munich in 2003 and has been a member of the European Microwave Association General Assembly, representing the German microwave professional
organizations.

