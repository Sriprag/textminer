920

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

Treatment Planning and Image Guidance for
Radiofrequency Ablation of Large Tumors
Hongliang Ren, Member, IEEE, Enrique Campos-Nanez, Ziv Yaniv, Member, IEEE, Filip Banovac,
Hernan Abeledo, Nobuhiko Hata, and Kevin Cleary, Member, IEEE

Abstract—This article addresses the two key challenges in
computer-assisted percutaneous tumor ablation: planning multiple overlapping ablations for large tumors while avoiding critical
structures, and executing the prescribed plan. Toward semiautomatic treatment planning for image-guided surgical interventions,
we develop a systematic approach to the needle-based ablation
placement task, ranging from preoperative planning algorithms
to an intraoperative execution platform. The planning system incorporates clinical constraints on ablations and trajectories using
a multiple objective optimization formulation, which consists of
optimal path selection and ablation coverage optimization based
on integer programming. The system implementation is presented
and validated in both phantom and animal studies. The presented
system can potentially be further extended for other ablation techniques such as cryotherapy.
Index Terms—Image guidance, open source, optimization, radiofrequency ablation (RFA), treatment planning.

I. INTRODUCTION
HE latest statistics from the World Health Organization
indicates that lung and liver cancer are among the top
five most frequent cancer related deaths worldwide [1]. Percutaneous radiofrequency ablation (RFA) has emerged as a commonly used technique for the minimally invasive treatment of
numerous organ cancers [2], including lung and liver. Though

T

Manuscript received October 19, 2012; revised May 17, 2013; accepted
October 14, 2013. Date of publication October 24, 2013; date of current version
May 1, 2014. This work was supported in part by the U.S.A. National Institutes
of Health (NIH) under Grant 7R01CA124377-05 and in part by Singapore Academic Research Fund, under Grant R397000139133.
H. Ren is with the Department of Biomedical Engineering, National University of Singapore, 119077 Singapore, and was with the Bioengineering Initiative,
Sheikh Zayed Institute for Pediatric Surgical Innovation, Children’s National
Medical Center, Washington, DC 20310, USA (e-mail: ren@nus.edu.sg).
E. Campos-Nanez is with the Epsilon Group, An Alere Inc. Company, 615
Woodbrook Dr., Suite B, Charlottesville, VA 22901, USA (e-mail: ecamposn@
gmail.com).
Z. Yaniv and K. Cleary are with the Bioengineering Initiative, Sheikh Zayed
Institute for Pediatric Surgical Innovation, Children’s National Medical Center,
Washington, DC 20310 USA (e-mail: kcleary@cnmc.org, zyaniv@cnmc.org).
F. Banovac is the Chief of Interventional Radiology, Department of Radiology, Georgetown University Hospital, Washington, DC 20007, USA (e-mail:
fb2@gunet.georgetown.edu).
H. Abeledo is with the Department of Engineering Management and Systems
Engineering, The George Washington University, Washington, DC 20052, USA
(e-mail:abeledo@gwu.edu)
N. Hata is with the Surgical Planning Laboratory, Department of Radiology,
Brigham and Women’s Hospital and Harvard Medical School, Boston, MA
02115 USA (e-mail: hata@bwh.harvard.edu).
Color versions of one or more of the figures in this paper are available online
at http://ieeexplore.ieee.org.
Digital Object Identifier 10.1109/JBHI.2013.2287202

surgical resection provides the best way to treat cancer, it is
estimated that only 10–15% of patients with lung or liver neoplasms are surgical candidates [3], [4], due to the extent of the
disease or concurrent medical conditions. Approximately 80%
of unresectable tumors may be amenable to image-guided ablative techniques, which have been established as primary ablative
procedures at most institutions.
The current tumor ablation techniques use needle-like probes
that deliver “thermotherapy” to kill the cancerous tissue. These
probes either increase tissue temperature by techniques such as
focused ultrasound, laser, radiofrequency, and microwave, or
decrease tissue temperature by cryotherapy [5].
Two important clinical considerations are tumor size and accessibility to the lesion. Multiple overlapping ablations need to
be planned to cover irregular and large tumors through a series of single probe ablations. In addition, the planned ablations
should be accessible by the needle-based probe, should avoid
critical structures, and minimize damage to healthy tissue.
Manual treatment planning and execution is dependent on the
operator’s experience and relies on a trial and error approach,
which is error prone and time consuming without the assistance of semiautomatic planning and navigation. To address the
aforementioned key challenges, this article focuses on a semiautomatic approach for RFA of liver tumors. The primary contribution in this article is the systematic approach that incorporates
practical clinical constraints in planning and navigation.
The rest of this paper is organized as follows. Section II summarizes the challenges, significance and related work in RFA
procedures. Section III presents the proposed system approach,
which is validated in Section IV. Finally, Section V concludes
the paper.
II. SIGNIFICANCE AND RELATED WORK
A. Clinical Concerns and Challenges
The current procedure of RFA mainly has two clinical concerns described as follows.
1) Adequate Ablation Coverage of the Tumor: Despite the
availability of larger electrodes, many procedures require multiple ablations to obtain the desired ablation margin. Multiple
ablations are difficult to execute as there is no good way to
visualize the overlapping areas or to distinguish ablated areas
from nonablated ones. Due to the lack of real-time image guidance, repeated insertions and positioning of the electrode may
be required to hit the target lesion. Unablated tissue containing
residual tumor may result in tumor recurrence. Residual tumor
tissue often grows in scattered, nodular, or eccentric patterns [6],

2168-2194 © 2013 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

REN et al.: TREATMENT PLANNING AND IMAGE GUIDANCE FOR RADIOFREQUENCY ABLATION OF LARGE TUMORS

making it difficult to treat after an initial ablation. Some studies
have shown that complete necrosis of the tumor was achieved
in only 29%–47.6% of lesions with diameters of 3.1 cm or
greater [7].
2) Accurate Real-Time Targeting: RFA typically relies on
image guidance to manually place the radiofrequency needle
within the tumor, such as ultrasound for guiding liver tumor ablation [8], and computed tomography (CT) for guiding lung tumor ablation. However, ultrasound imaging can be problematic
for monitoring the ablation region due to hyperechogenicity [7]
and imaging artifacts [9], especially in the presence of a metallic
RFA probe. In comparison, CT offers better imaging quality but
increases the radiation exposure to the patient and potentially
the operator. To avoid radiation, one solution is to employ a
tracking system to obtain the relative position between ablation
probe and target, by landmark registration to a preoperative CT
image [10]. This approach assumes the target organ deformation is acceptable for treatment purposes by using preoperative
images for intraoperative treatment.
B. Prior Art on Computerized Treatment Planning
for Overlapping Ablations
Planning of ablation procedures has been previously addressed by several groups. Baegert [11] employed a visibility
graph method to optimize the entry point and avoid the critical structures, but did not address overlapping ablation issues.
Overlapping spherical ablations have been studied by Dodd and
Chen [12], [13]. Dodd [13] developed geometrical models to
cover spherical tumors including a margin. Chen [12] explores
an alternative approach by inscribing a regular polyhedron in the
target sphere and circumscribing each face of the polyhedron
with an ablation sphere. Yang et al. [14] focused on the robotic
ablation system development and suggested a voxel growing
algorithm for the large tumor treatment. Villard et al. [11] used
a local search optimization technique to place a single ablation.
Butz et al. [15] addressed several key issues in cryotherapy:
finding a feasible trajectory, ablating all cancerous cells, and
minimizing the damage to healthy tissue. A treatment measure
was proposed to guide the plan optimization procedures. However, the optimization of multiple overlapping ablations was not
addressed.
We further extended the problem in this article to develop
a clinically robust treatment planning system by incorporating
realistic constraints that are encountered in clinical practice but
were not fully addressed before, including: 1) relaxation of the
assumption of spherical tumors, i.e., no preselected geometric
models of particular arrangements on tumors and 2) minimize
the number of probe insertions and ablations while covering all
tumor regions. Most tumors are not spherical and it is often not
practical to regularly space overlapping ablations due to other
nearby anatomical structures that should be avoided. Also, the
number of probe insertions that can be performed in practice
is limited by time considerations and the risk of complications
with each insertion.
Earlier investigations were also done by our group [10],
[16] and two approaches were proposed for treatment planning.

921

Fig. 1. Overall system schematic of a planning and image-based navigation
system for tumor ablation: first in (block 1), the CT data are acquired for
diagnosis and for patient specific modeling (block 2), which is done using a
semiautomatic segmentation approach. Given identified entry points, critical
structures, and tumor regions, the ablation planning (block 3) is performed by
the preoperative planning station and the planned ablation spheres are overlaid
in the scene with evaluation (block 4) on the coverage of the whole tumor while
avoiding critical zone. Then, the surgical navigation (block 5) is performed
using an image-guided surgery navigation platform (IGSTK, www.igstk.org)
with fiducial marker registration to the preoperative CT scans. (Refer to the web
version of this paper for the color figure.)

Powell’s method and simulated annealing algorithms [16] were
used to find the solution for synthetic tumor data based on precomputed mask volumes and Euclidean distance transform. In
that work, we were only concerned with tumor coverage and
did not limit the number of probe insertions nor attempt to minimize damage to healthy tissue. Furthermore, the open-source
image-guided surgery toolkit (IGSTK) [10] was developed to
provide guidance capability for needle-based interventions including vertebroplasty, lung biopsy, and lung RFA. In that work,
we performed an animal survival study for lung RFA and two
navigation measures were evaluated in [10] including the execution time to reach target and distance from target. The mathematical model used for planning was similar to the current one,
but we only provided the physician with a single “optimal” plan
based on the problem formulation. We now build upon this prior
work to develop a comprehensive planning, evaluation, and execution system. Instead of providing a single plan, we present the
physician with a number of feasible plans from which they select one based on their preference with regard to the importance
of the quantitative evaluation measures. In the clinical practice
of our interventional radiologist, RFA probe placement is performed under CT-fluoroscopy in a freehand manner. The probe
repositioning is likewise performed by the mental triangulation
of the interventional radiologist. After the initial ablation, the
tissue imaging characteristics around the tumor change in real
time due to physiologic phenomena such as hyperemia, nitrogen gas release during ablation, etc. The tumor margins almost
always become obscured. Therefore, it is almost impossible for
the interventional radiologist to plan overlapping ablations by
hand, which motivated the integrated system development described here.
III. METHODS
A. System Overview
The overall system concept is shown in Fig. 1, with the
key components including treatment optimization, treatment

922

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

TABLE I
NOMENCLATURE

Fig. 2.

Treatment planning flowchart.

evaluation, and surgical navigation. Specifically, the planning
workstation implements patient-specific modeling through segmentation, margin addition, optimization, and plan evaluation
as illustrated in Fig. 2.
Semiautomatic segmentation based on geodesic active contour method [17] is used to identify the key structures including:
the tumor; structures that should not be traversed such as the ribs,
liver vasculature, and adjacent critical anatomical structures,
collectively referred to as a no-fly-zone; and surgeon preferred
entry points.
Additional margins are created for tumor tissue, ablation margin, and critical tissue, which includes safety margins that should
be avoided. This is realized by applying a binary image morphological operator, dilation, to the segmented tumor and critical
structures.
Following the flowchart given in Fig. 2 and notations in Table
I, we next describe the optimization-based planning and the
evaluation modules.
B. Treatment Planning Including Path Planning
and Overlapping Optimization
As illustrated in Fig. 2, a semiautomatic treatment planning
module for optimized probe placement is developed to guide
the RFA ablation probe. For a given irregular liver tumor, the
solution of a mathematical optimization problem provides 1)
optimized probe trajectories, 2) location of multiple overlapping ablations in order to cover the tumor, and 3) a tumor-free
margin, while avoiding the no-fly zone. Hence, the treatment
planning is a multiple-objective optimization problem guided
by the following five clinical considerations.
1) Minimize the number of ablations. Fewer ablations mean
shorter treatment times and less chance for complications.
2) Limit the number of probe insertions. This reduces the
perforations to the liver capsule decreasing the chances of
intraperitoneal haemorrhage.
3) Probe trajectory constraints. The model includes physical constraints imposed by ribs, vessels, and other organs
which restrict possible trajectories.
4) Irregular shaped tumor coverage. The optimization uses
segmented tumor data from patients and does not

presuppose a particular tumor shape. This makes this planning method more general.
5) Minimize unnecessary damage to healthy tissue while
fully covering the tumor and margin.
The optimization module uses integer programming techniques to model and solve the planning problem. Considering
a voxelized tumor region, the possible choices for trajectories
and ablations are represented by binary decision variables and
the clinical constraints are modeled algebraically using linear
inequalities [18]. This methodology has also been applied for
radiotherapy treatment planning problems involving brachytherapy [19], [20].
Aiming at optimizing multiple measures of RFA planning
performance simultaneously, we present a decomposition approach that solves this decision problem by repeatedly solving
two integer programming models. Initially, a set of entry points
is specified by the clinician and each entry point is tested for
feasibility in avoiding direct puncture of critical structures to
the tumor. Then, for each feasible entry point, we define the
following two optimization models: the minimal trajectories integer program (MTIP) to find a minimal number of trajectories
necessary to cover the tumor, and the minimal ablations integer
program (MAIP) to find a minimal number of ablations along
the selected trajectories necessary to cover the tumor. In each of
these integer programs, we employ a weighted formulation to
reduce healthy tissue damage, while keeping as main objective
the minimization of the number of trajectories and ablations
that are needed to guarantee coverage of the tumor and safety
margin.
1) MTIP is
min



wt xt

{t∈T R }

subject to



xt ≥ 1 ∀c ∈ T ∪ M

{t:K (t,c)=1}

xt ∈ {0, 1} ∀t ∈ T R

(1)

REN et al.: TREATMENT PLANNING AND IMAGE GUIDANCE FOR RADIOFREQUENCY ABLATION OF LARGE TUMORS

where xt is the binary decision variable indicating if a candidate
trajectory is used or not, TR is the set of candidate trajectories, T
is the set of tumor points, and M the set of margin points. Since
individual trajectories may cover a partial tumor volume; the
weight wt is used to indicate the penalty associated with each
trajectory. By default, their values can all be set equal to 1 (or
to any other constant). In this case, the objective function looks
for a smallest set of directions that can cover the target region.
Alternatively, a trajectory can be given additional weight if it
covers a volume of healthy tissue. For example, we can choose
wt = 1 + 0.01 pt , where pt is the proportion of healthy cells
among the cells ablated if trajectory t were chosen. The portion
of the weight associated with healthy tissue damage (0.01 pt )
is orders of magnitude smaller than the unit weight assigned to
using the direction t. This preserves the main goal of minimizing
the total number of trajectories needed while penalizing the use
of trajectories that ablate more healthy tissue. The constraints
in the model assure that each tumor or margin point is covered
by at least one suitable trajectory. The function K(t, c) = 1 if
trajectory t can cover cell c, indicates the coverage provided by
trajectory t. We model the region that a probe trajectory can
ablate as a cylinder with axis along the trajectory and radius
smaller than the radius of a single ablation.
2) MAIP is formulated as

wa ya
min
{a∈A }

subject to



ya ≥ 1 ∀c ∈ T ∪ M

{a:||a−c||< R }

ya ∈ {0, 1} ∀a ∈ A

(2)

where A is the set of proposed ablation centers. The points in
the set A are generated along the set of trajectories obtained
from solving MTIP. As before, T is the set of tumor points, and
M the set of margin points. The constraints in the model require
that each tumor or margin point be covered at least once by an
ablation. The weights wa can be chosen to minimize the number
of ablations as main goal and, simultaneously, reduce healthy
tissue damage by giving more weight to an ablation if it covers a
larger volume of healthy tissue. Similar to the weights in MTIP,
we can choose wa = 1 + 0.01 pa , where pa is the proportion
of healthy cells among the cells ablated if an ablation centered
at point a is selected. By using the condition a − c < R, we
are assuming that ablations are spherical. We did this because
spheres are commonly used to model ablations in the literature
and it also simplified the software implementation for our computational experiments. However, ablations that vary arbitrarily
in shape at each possible placement point can just as well be
represented in the MAIP model. Finally, we note that finding an
optimal solution to an integer program can be computationally
very challenging. To solve our integer programming models,
we used Gurobi version 4.0.2, an optimization package with
the branch and bound algorithm [18]. Since the original decision problem was decomposed into two subproblems, the solutions that we obtain are not guaranteed to be globally optimal.
Our computational experiments, discussed later, show that the

923

Fig. 3. (Left) Venn diagram illustrating the evaluation measures by regional
overlapping of ablations (A) and tumor (T). (Right) Model of multiple overlapping ablations generated from treatment plan. (Refer to the web version of this
paper for the color figure.)

solutions obtained are of good quality and useful in a clinical
setting.
C. Evaluation Measures
After the candidate plans are generated by the optimizer,
statistical evaluation on the quality of the plans is further developed. Assuming each ablation covers a spherical region, the
model with multiple ablations can be generated from the treatment plan as in Fig. 3 (Right). Given the multiple spherical
planned ablations and tumor model in Fig. 3 (Left), the evaluation measures are defined by
1) Ablation Coverage (AC): AC = A ∩ T/T;
2) Unablated Percentage (UP): UP = (T\A)/T;
3) Over-Ablation (OA) Volume:
OA = (Ablation Volume)∗ (A\T)/A, in mm3 ;
4) NA: Number of Ablations;
5) NT: Number of Trajectories.
IV. EXPERIMENTAL EVALUATION
A. Phantom Study
An abdominal CT of a torso phantom [see Fig. 4(a)] was
obtained in the Radiology Department. Then, a semiautomatic
segmentation [see Fig. 4(b)] was done to obtain an anatomical
model, particularly, the structures of tumor, ribs, entry points,
and no-fly-zone. Given identified structures, the planning algorithm generates needle trajectories and ablation locations represented by pink spheres (see electronic version) to show the
coverage on the whole tumor. Finally, the intervention is carried out using a navigation program based on the IGSTK, with
electromagnetic tracking of the probes.
The planning system allows the user to fix the values of key
decision variables in the model prior to executing the optimization algorithm, as shown in Fig. 5. Prior to the execution of
the optimization algorithm, it allows the user to manually input
criteria that must be satisfied by the solutions, such as probe
information, patient sample data spacing, maximal number of
ablations, maximal number of trajectories, maximal number
of punctures, and tumor margin. This feature is also used to

924

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

Fig. 6. Preoperative experiment setup including animal placed in V-trough
under general anaesthesia, fiducial marker placement, and CT scan.

Fig. 4. Ablation planning and navigation. (a) Phantom with markers. (b) Chest
CT scan and tumor segmentation in red. (c) Treatment planning (yellow line:
RFA probe; green: tumor; pink sphere: ablations; brown: non-fly-zone; green:
tumor to be ablated). (d) Navigation screenshot in IGSTK. (Refer to the web
version of this paper for the color figure.)

periments demonstrate that the planning approach is able to
generate feasible treatment plans effectively. Multiple ablations
can be constrained along the same trajectory to reduce the number of punctures. Note that while these experiments demonstrate
the feasibility of the proposed approach for large tumors, such
a large number of ablations would not be practical in current
clinical practice.
B. Animal Study

Fig. 5. Open-source RFA planning module implemented in 3-D slicer. (Refer
to the web version of this paper for the color figure.)
TABLE II
STATISTICAL MEASURES FOR THE CANDIDATE PLANS
FOR TUMOR SIZE OF 35-mm DIAMETER

iteratively update the treatment plan after each actual insertion
and ablation is realized.
For simulation purposes, two types of simulated tumors were
used, including a spherical one and a cylindrical one, which do
not represent real pathological examples but demonstrate algorithmic feasibility. The ablation probe used in this experiment
has an ablation sphere of 30 mm in diameter.
For a simulated spherical tumor with 35-mm diameter, the
planning system generated four candidate treatment plans with
an average ablation coverage rate of 99% and over-ablation
rate of 40% as shown in Table II. For a simulated cylindrical
shape tumor with 65-mm long and 45-mm diameter, ten treatment plans were generated with an average ablation coverage
rate of 98% and over-ablation rate of 44%. The phantom ex-

1) Preoperative Experiment Setup: A swine study was completed to validate the system feasibility in clinical environment.
A 40-kg swine was used under an approved animal protocol of
the Guide for the Care and Use of Laboratory Animals. The
in vivo tumor-mimicing model was prepared using a mixture
of agarose, cellulose, glycerol, and methylene blue as described
in [21]. Under general anesthesia, an artificial tumor was created
by injecting the prepared agar in the liver percutaneously under
CT guidance. Six surface fiducial markers were placed on the
abdomen for later use in paired-point registration. A volumetric
CT scan was then performed using a Siemens Somatom Emotion 16 CT Scanner system to obtain the preoperative images
for planning and navigation. The preoperative experiment setup
is shown in Fig. 6.
Similar to the workflow of the phantom study described earlier, the CT data with dimension of 512 × 512 × 301 and spacing
of 0.58 × 0.58 × 1 mm were then transferred to the planning
workstation, where the segmentation and ablation planning were
performed. The semiautomatic segmentation took 6 min to generate the models of tumor, rib, and entry points (in Fig. 7) as
validated by the radiologists. An ablation margin of 5 mm [22]
was created around the tumor. This results in an ablation region whose long axis is approximately 35 mm, which requires
multiple ablations for complete coverage.
2) Treatment Planning Experiment Results: Interventional
planning was then applied to the preoperative model of key
anatomical structures, such as tumor, safety margin, ribs, and
entry regions. Together with visualization and ablation coverage evaluation, the whole planning procedure took 3 min and
generated 15 candidate plans as shown in Table III.
The ablation coverage on the tumor is 100%, average coverage on the tumor with margin is 99.05%, average over-ablation

REN et al.: TREATMENT PLANNING AND IMAGE GUIDANCE FOR RADIOFREQUENCY ABLATION OF LARGE TUMORS

925

Fig. 9. (Left) Navigation setup and (right) navigator projected view. (Refer to
the web version of this paper for the color figure.)

Fig. 7. Preoperative CT scan overlaid by tumor region, ribs, preferred ablation
probe entry region and safety margin. The region with red denotes the tumor
within liver. Green represents the entry region and blue for no-fly-zone. (Refer
to the web version of this paper for the color figure.)
TABLE III
STATISTICAL MEASURES FOR THE CANDIDATE PLANS FOR
SIMULATED TUMOR SIZE OF 25-mm DIAMETER
Fig. 10. Procedure of ablation probe deployment: tracked needle insertion on
the left picture, and probe deployment on the right picture.

Fig. 8. Treatment plan visualization module for surgeons to evaluate the plan
before execution. The long axis is approximately 35 mm calculated by Slicer’s
measurement module (www.slicer.org). The planned ablation spheres were overlaid onto the preoperative CT images as shown in the three lower slice views,
which make it easy to examine slice-by-slice performance. (Refer to the web
version of this paper for the color figure.)

rate is 45.99%, and two ablations were required. This validated the proposed planning algorithm and was confirmed by the
radiologist. Fig. 8 visualizes the planned ablation coverage in
3-D slicer [23] using our implemented multiple plan visualization module, which can load in multiple plans for visual compar-

ison. The visibility of individual candidate plans can be toggled
ON or OFF in 3-D view and slice view for comparison. Within
the same spatial coordinate system, the raw CT DICOM series, the multiple treatment plans, the segmented structures and
measurements can be overlaid in the same workspace, which is
preferred by the radiologists.
3) Ablation Under Image Guidance: The ablation plan with
highest tumor coverage rate was selected for execution under
image guidance. The navigation experiment setup is shown in
Fig. 9, which shows the electromagnetic tracking system used
for image guidance. The tracked needle was registered to preoperative image space via paired-point registration with a fiducial
registration error of 3.8 mm. The navigation module was implemented based on the IGSTK and the needle pose (position and
orientation) relative to image space was presented in the navigator. A projected view is shown in Fig. 9, which denotes the
relative orientation of needle hub, needle tip, and target point
in image space. The 16-gauge tracked trocar and needle was
then navigated to the target lesion. The ablation probe (Boston
Scientific, Natick, MA, USA) was inserted along the trocar to
the target, and then, the RFA was applied by turning on the
radiofrequency generator, as shown in Fig. 10.
After the second ablation was completed, the probe was left
in place and the swine was moved back to the CT scanner for a
postoperative evaluation. The scan has an image dimension of
512 × 512 × 155 slices and spatial spacing of 0.67 × 0.67 ×
1 mm. Due to the pig position and acquisition parameters had
been changed, the postoperative scan could not be directly overlaid to preoperative scan or treatment plans for computation.
Alternatively, we segmented the tumor and applied a safety
margin again. Meanwhile, we manually identified the ablation
sphere with a radius of 15 mm as shown in Fig. 11 (left), which

926

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

Fig. 11. (Left) Postoperative CT scan to check the spatial relationship between
the ablation probe with the region of tumor and safety margin. The virtual
ablation sphere is generated via image processing cantered at the probe tip and
then overlaid onto the postoperative CT scan. The distance of delivered probe
to tumor surface is approximately 5 mm. (Right) Postoperative evaluation on
the second accomplished RFA. Yellow color represents the tumor surrounded
by safety margin and the sphere denotes the virtual ablation. (Refer to the web
version of this paper for the color figure.)

shows overlapping region between the tumor margin and actual
ablations. The target ablation coverage by the second ablation
is 34% by calculation of the ratio of overlapping ablation over
the total tumor and margin volume. Fig. 11 (right) demonstrates
that the second needle insertion avoids the ribs and reaches the
target tumor.
C. Discussion
The planning module yielded 100% coverage over the large
tumor using multiple ablations and can generate multiple feasible plans (e.g., Table III for animal study) with evaluation
parameters for physicians to choose. Both numerical evaluation
and visual evaluation (e.g., Fig. 8) can be performed to determine the execution plan from those candidates. The number of
trajectories and ablations are reduced to a minimum at the same
time. In our previous approach for planning ablations for lung
tumors [10], we only generated an “optimal” solution, which removed the specific perspective of the interventionalist. We now
provide the physician with multiple feasible plans that satisfy
to some degree the optimization requirements. This is a cooperative approach to planning in which the computational burden
is automated, and the clinician selects from a small set of plans
which satisfy the clinical criteria such as maximum number of
trajectories, maximum number of ablations, overlap of ablation
spheres, etc.
This approach yields comprehensive and clinically feasible
planning results. Given the requirement of 100% coverage on
the tumor, the over-ablation rate is found relevant to the size and
shape of the tumor, the size of ablation probe and the maximum
number of ablations. As illustrated in Fig. 12, even one ablation
can result in a high over-ablation rate if the tumor is far smaller
than the spherical coverage. Similarly in the animal study, the
long axis of the ellipsoidal tumor is slightly bigger than probe
diameter and the short axis is much shorter than the probe diameter, which can result in the two ablations covering more
healthy tissue. The over-ablation rate can be decreased using
a smaller probe size and a larger number of ablations. Hence,
physicians can consider the tradeoff between over-ablation and
the allowable number of ablations.
The navigation module based on the electromagnetic tracking system is susceptible to interference from the CT scanner.
In earlier phantom studies on the CT table directly, the fiducial

Fig. 12. Illustration of the factors effecting over-ablation including tumor
shape and size, choices of ablation probe sizes, and maximum number of ablations. Left figure shows the bigger probe used only one ablation to cover the
tumor, resulting in over-ablation of more than 60%. Middle figure achieves less
over-ablation rate but uses more ablations. Right figures demonstrate the similar
case as animal study where the balance of probe size and number of ablations
needs to be determined.

registration error was up to 10 mm, which is too large for accurate targeting. Once we moved the phantom to a metal-free
environment, the fiducial registration error could be decreased
to 1 mm and yield accurate targeting performance. For this reason, in our animal study the swine was moved to a table in
the CT room away from the CT gantry, where we were able to
obtain a registration error from 3.6 to 3.9 mm for several trials.
This makes the postoperative CT evaluation difficult for each
ablation, as the animal cannot be moved back to CT and moved
out for performing the subsequent planned ablations without
potentially changing its position relative to the V-trough. The
final targeting error is difficult to evaluate as the planned trajectory cannot be mapped to the postoperative image coordinate
system. Instead, we measure the distance from the probe to the
tumor margin region surface in 3-D slicer and found the distance
from the probe to the closest tumor surface was approximately
5 mm. For the future study, a preoperative image to postoperative image registration method can be developed to overcome
this limit in ablation evaluation.
According to the planning results and evaluation results on
the second ablation, we show the feasibility of semiautomatic
planning and navigation procedures overseen by the radiologist.
The presented ablation planning and navigation approach provides a comprehensive solution for treating large tumors using
RFA, while keeping the physician in the loop. The planning system uses a patient specific model and an optimization approach
to produce potential plans that satisfy multiple clinical criteria
to certain degrees. The clinicians then select the plan which they
judge to be most appropriate. The navigation system provides
the precise guidance required to carry out the plan, which currently is all but impossible to do using the standard free hand
technique.
V. CONCLUSION
A new treatment planning and navigation system was developed for liver tumor ablations, particularly for multiple overlapping RFAs. The treatment planning is composed of needle-like
probe trajectory planning and overlapping ablation planning.
Multiple-objective optimization for probe insertions incorporates both clinical and technical constraints. Additional validation is required prior to introducing our system into a clinical
trial. Systematic evaluations were presented to check the candidate plans by both statistical measures and visualization. The
presented semiautomatic planning and guidance method can be

REN et al.: TREATMENT PLANNING AND IMAGE GUIDANCE FOR RADIOFREQUENCY ABLATION OF LARGE TUMORS

applied to tumor ablation in other organs using the proposed
techniques. In its current form, the system in combination with
a phantom can also be used as a training aid for interventional
radiologists.
ACKNOWLEDGMENT
The authors would like to thank the assistance of L. Chauvin,
A. Yamada, and S. Piper from Brigham Women’s Hospital and
Harvard Medical School in using 3-D slicer; the useful discussions with P. Cheng and O. Guler in using IGSTK; and animal
care from J. Gnadt and R. Tucker in the Georgetown University.
REFERENCES
[1] R. Siegel, D. Naishadham, and A. Jemal, “Cancer statistics,” CA: A Cancer
J. Clinicians, vol. 62, no. 1, pp. 10–29, 2012.
[2] M. Howenstein and K. Sato, “Complications of radiofrequency ablation
of hepatic, pulmonary, and renal neoplasms,” Semin. Intervent. Radiol.,
vol. 27, no. 3, pp. 285–295, 2010.
[3] E. Abdalla, J. Vauthey, L. Ellis, V. Ellis, R. Pollock, K. Broglio, K. Hess,
and S. Curley, “Recurrence and outcomes following hepatic resection,
radiofrequency ablation, and combined resection/ablation for colorectal
liver metastases,” Ann. Surg., vol. 239, no. 6, pp. 818–827, 2004.
[4] T. G. Simon and D. E. Dupuy, “Radiofrequency ablation, microwave
ablation, and cryoablation for lung tumors,” in Interventional Oncology,
P. Mueller and A. Adam, Eds. New York, NY, USA: Springer, 2012,
pp. 149–159.
[5] J. P. McWilliams, S. Yamamoto, S. S. Raman, C. T. Loh, E. W. Lee,
D. M. Liu, and S. T. Kee, “Percutaneous ablation of hepatocellular carcinoma: Current status,” J. Vascular Int. Radiol., vol. 21, no. 8 Suppl,
pp. S204–S213, 2010.
[6] S. Goldberg, C. Grassi, J. Cardella, J. Charboneau, G. Dodd, II, D. Dupuy,
D. Gervais, A. Gillams, R. Kane, F. Lee, Jr. et al., “Image-guided tumor
ablation: Standardization of terminology and reporting criteria1,” Radiology, vol. 235, no. 3, pp. 728–739, 2005.
[7] T. Livraghi, S. Goldberg, S. Lazzaroni, F. Meloni, T. Ierace, L. Solbiati,
and G. Gazelle, “Hepatocellular carcinoma: Radio-frequency ablation of
medium and large lesions1,” Radiology, vol. 214, no. 3, pp. 761–768,
2000.
[8] N. Nesher, M. Ben Haim, D. Pevni, A. Kessler, and Y. Paz, “Ultrasoundguided, video-assisted transdiaphragmatic radiofrequency ablation for
primary liver malignancy or metastatic nodules,” Innovations: Technol.
Techn. Cardiothoracic Vascular Surg., vol. 6, no. 5, pp. 337–340, 2011.
[9] J. Stoll, H. Ren, and P. E. Dupont, “Passive markers for tracking surgical
instruments in real-time 3D ultrasound imaging,” IEEE Trans. Med. Imag.,
vol. 31, no. 3, pp. 563–575, Mar. 2012.
[10] Z. Yaniv, P. Cheng, E. Wilson, T. Popa, D. Lindisch, E. Campos-Nanez,
H. Abeledo, V. Watson, K. Cleary, and F. Banovac, “Needle-based interventions with the image-guided surgery toolkit (IGSTK): From phantoms
to clinical trials,” IEEE Trans. Biomed. Eng., vol. 57, no. 4, pp. 922–933,
Apr. 2010.
[11] C. Baegert, C. Villard, P. Schreck, L. Soler, and A. Gangi, “Trajectory
optimization for the planning of percutaneous radiofrequency ablation of
hepatic tumors,” Comput. Aided Surg., vol. 12, no. 2, pp. 82–90, 2007.
[12] M. Chen, W. Yang, K. Yan, M. Zou, L. Solbiati, J. Liu, and Y. Dai,
“Large liver tumors: Protocol for radiofrequency ablation and its clinical
application in 110 patients mathematic model, overlapping mode, and
electrode placement process,” Radiology, vol. 232, no. 1, pp. 260–271,
2004.
[13] G. Dodd, M. Frank, M. Aribandi, S. Chopra, and K. Chintapalli, “Radiofrequency thermal ablation,” Amer. J. Roentgenol., vol. 177, no. 4,
pp. 777–782, 2001.
[14] L. Yang, R. Wen, J. Qin, C. Chui, K. Lim, and S. Chang, “A robotic
system for overlapping radiofrequency ablation in large tumor treatment,”
IEEE/ASME Trans. Mechatron., vol. 15, no. 6, pp. 887–897, Dec. 2010.
[15] T. Butz, S. Warfield, K. Tuncali, S. Silverman, E. van Sonnenberg,
F. Jolesz, and R. Kikinis, “Pre- and intra-operative planning and simulation of percutaneous tumor ablation,” vol. 3, pp. 317–326, Oct. 2000.
[16] H. Zhang, F. Banovac, S. Munuo, E. Campos-Nanez, H. Abeledo, and
K. Cleary, “Treatment planning and image guidance for radiofrequency
ablation of liver tumors,” in Proc. SPIE, 2007, vol. 6509, pp. 650922-1–
650922-10.

927

[17] P. Yushkevich, J. Piven, H. Hazlett, R. Smith, S. Ho, J. Gee, and G. Gerig,
“User-guided 3D active contour segmentation of anatomical structures:
Significantly improved efficiency and reliability,” Neuroimage, vol. 31,
no. 3, pp. 1116–1128, 2006.
[18] L. Wolsey, Integer programming. New York, NY, USA: Wiley, 1998.
[19] E. Lee, R. Gallagher, D. Silvern, C. Wuu, and M. Zaider, “Treatment
planning for brachytherapy: An integer programming model, two computational approaches and experiments with permanent prostate implant
planning,” Phys. Med. Biol., vol. 44, pp. 145–165, 1999.
[20] W. D’Souza, R. Meyer, B. Thomadsen, and M. Ferris, “An iterative
sequential mixed-integer approach to automated prostate brachytherapy
treatment plan optimization,” Phys. Med. Biology, vol. 46, pp. 297–322,
2001.
[21] D. Scott, W. Young, L. Watumull, G. Lindberg, J. Fleming, R. Rege,
R. Brawn, and D. Jones, “Development of an in vivo tumor-mimic model
for learning radiofrequency ablation,” J. Gastrointestinal Surg., vol. 4,
no. 6, pp. 620–625, 2000.
[22] K. Yamakado, A. Nakatsuka, S. Ohmori, K. Shiraki, T. Nakano, J. Ikoma,
Y. Adachi, and K. Takeda, “Radiofrequency ablation combined with
chemoembolization in hepatocellular carcinoma: Treatment response
based on tumor size and morphology,” J. Vascular Int. Radiol., vol. 13,
no. 12, pp. 1225–1232, 2002.
[23] S. Pieper, M. Halle, and R. Kikinis, “3D slicer,” in Proc. IEEE Int. Symp.
Biomed. Imag.: Nano to Macro, 2004, pp. 632–635.
Hongliang Ren (M’06) received the Ph.D. degree
in electronic engineering (Biomedical Engineering
Lab) from the Chinese University of Hong Kong,
Hong Kong, in 2008.
He is currently an Assistant Professor and leading a research group on medical mechatronics in the
Biomedical Engineering Department, National University of Singapore (NUS), Singapore. He worked
as a Postdoctoral Researcher in the Laboratory for
Computational Sensing and Robotics (LCSR) and the
Engineering Center for Computer-Integrated Surgical
Systems and Technology (ERC-CISST), Department of Biomedical Engineering and Department of Computer Science, The Johns Hopkins University, Baltimore, MD, USA, from 2008 to 2010. In 2010, he joined the Pediatric Cardiac
Biorobotics Lab, Department of Cardiovascular Surgery, Children’s Hospital
Boston & Harvard Medical School, USA, for investigating the beating heart
robotic surgery system. Prior to joining NUS, he also worked in 2012 on a
collaborative computer integrated surgery project, at the Surgical Innovation
Institute of Children’s National Medical Center, Washington, DC, USA.
Enrique Campos-Nanez received the B.Sc. degree in mathematics from the Universidad Nacional
Autónoma de México (UNAM), Mexico, the M.Sc.
degree in operations research from Stanford University, Stanford, CA, USA, and the Ph. D. degree in
systems and information engineering from the University of Virginia, Charlottesville, VA, USA.
He is currently a Senior Software Engineer at
The Epsilon Group, an Alere Inc. company, Charlottesville, VA, USA, where he is a Development
Lead on the company’s modeling and simulation software for pharmacokinetics. His research interests include healthcare analytics,
mathematical modeling in medicine, and systems and software engineering.
Ziv Yaniv (M’04) received the Ph.D. degree in
computer science from The Hebrew University of
Jerusalem, Jerusalem, Israel, in 2004.
He is a Principal Investigator at the Sheikh Zayed Institute for Pediatric Surgical Innovation, Children’s National Hospital, Washington, DC, USA. His
main research interests are image-guided interventions, medical image analysis, computer vision, and
software engineering. He actively supports the development of open source software, and leads the
development of the free open source Image-Guided
Surgery Toolkit (IGSTK).
Dr. Yaniv is a member of the IEEE Engineering in Medicine and Biology
and IEEE Computer societies.

928

IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 18, NO. 3, MAY 2014

Filip Banovac received the B.S.E. degree in biomedical engineering from Duke University, Durham, NC,
USA, followed by the Medical degree from the Medical College of Virginia, Richmond, VA, USA and
the Clinical Residency Training in radiology and interventional radiology from Georgetown University,
Washington, DC, USA and Stanford University, Stanford, CA, USA, respectively, in 2003 and 2004.
He is currently the Chief of Vascular and Interventional Radiology at Georgetown University Hospital,
Washington. His research interests include the field
of image guided navigation and targeting for tissue ablation of liver and lung
tumors.

Hernan Abeledo received the Ph.D. degree in operations research from Rutgers University, New
Brunswick, NJ, USA, in 2003.
He is an Associate Professor at the Department
of Engineering Management and Systems Engineering, George Washington University, Washington, DC,
USA. His main research interests are mathematical
optimization and operations research applications.

Nobuhiko Hata received the B.E. degree in precision
machinery engineering in 1993, the M.E. degree in
1995, and the Doctor of Engineering degrees in 1998
from the University of Tokyo, Tokyo, Japan.
He is currently an Associate Professor of Radiology, Harvard Medical School and Brigham and
Women’s Hospital, Boston, MA, USA. In the Image
Guided Therapy Program and Surgical Navigation
and Robotics Laboratory at Brigham and Women’s
Hospital, he leads research team on medical image
processing and robotics in image-guided surgery. His
major achievements include neurosurgical navigation combined with ultrasound
imaging, surgical robot for magnetic resonance imager, and motion-adaptable
surgical robot for image-guided therapy.

Kevin Cleary (M’86) received the B.S. and M.S.
degrees in mechanical engineering and materials science from the Duke University, Durham, NC, USA,
followed by the Ph.D. degree from the University of
Texas, Austin, TX, USA.
He was an NSF-sponsored Postdoctoral Researcher at the Mechanical Engineering Laboratory,
Tsukuba, Japan. He is currently the Technical Director of the Bioengineering Initiative in the Sheikh Zayed Institute for Pediatric Surgical Innovation, Children’s National Medical Center, Washington, DC,
USA. He leads a research team developing technology to make pediatric surgery
more precise and less invasive, including robotics, navigation, and image fusion.

